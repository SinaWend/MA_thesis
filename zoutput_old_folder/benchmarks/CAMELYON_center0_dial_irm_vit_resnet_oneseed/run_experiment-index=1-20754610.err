Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 23 16:29:37 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dial_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610

 Experiment start at: 2024-05-23 16:41:27.978729
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9727119, 'precision': 0.7874595, 'recall': 0.8060882, 'specificity': 0.8060882, 'f1': 0.7964511, 'auroc': 0.96297795, 'binary_precision': 0.5878981, 'binary_recall': 0.6274643, 'binary_specificity': 0.98471206, 'binary_f1_score': 0.6070371}
confusion matrix:
       0    1
0  41674  647
1    548  923
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.7985871, 'recall': 0.8093223, 'specificity': 0.8093223, 'f1': 0.8038502, 'auroc': 0.9633994, 'binary_precision': 0.6101949, 'binary_recall': 0.63297045, 'binary_specificity': 0.98567414, 'binary_f1_score': 0.6213741}
confusion matrix:
       0    1
0  17889  260
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9745925, 'precision': 0.8734158, 'recall': 0.7778573, 'specificity': 0.7778573, 'f1': 0.81791294, 'auroc': 0.9501369, 'binary_precision': 0.765625, 'binary_recall': 0.5632184, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.64900666}
confusion matrix:
      0    1
0  5952   45
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-23 17:24:29.817559,epoch time: 0:43:01.838830,used: 0:43:01.838830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788546, 'precision': 0.9242567, 'recall': 0.71740097, 'specificity': 0.71740097, 'f1': 0.7852638, 'auroc': 0.97743475, 'binary_precision': 0.8677463, 'binary_recall': 0.4371176, 'binary_specificity': 0.99768436, 'binary_f1_score': 0.5813743}
confusion matrix:
       0    1
0  42223   98
1    828  643
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.953598, 'recall': 0.691545, 'specificity': 0.691545, 'f1': 0.7660694, 'auroc': 0.97626483, 'binary_precision': 0.9285714, 'binary_recall': 0.38413686, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.54345435}
confusion matrix:
       0    1
0  18130   19
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8595127, 'recall': 0.5698807, 'specificity': 0.5698807, 'f1': 0.60968745, 'auroc': 0.9532191, 'binary_precision': 0.75510204, 'binary_recall': 0.14176245, 'binary_specificity': 0.997999, 'binary_f1_score': 0.23870967}
confusion matrix:
      0   1
0  5985  12
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 2,now: 2024-05-23 18:11:13.394863,epoch time: 0:46:43.577304,used: 1:29:45.416134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9824854, 'precision': 0.9009452, 'recall': 0.8073369, 'specificity': 0.8073369, 'f1': 0.8474755, 'auroc': 0.9819065, 'binary_precision': 0.8150134, 'binary_recall': 0.6195652, 'binary_specificity': 0.9951087, 'binary_f1_score': 0.70397526}
confusion matrix:
       0    1
0  42113  207
1    560  912
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.9376607, 'recall': 0.77253234, 'specificity': 0.77253234, 'f1': 0.83454406, 'auroc': 0.9795784, 'binary_precision': 0.89113927, 'binary_recall': 0.5474339, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.67822737}
confusion matrix:
       0    1
0  18106   43
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.9546349, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 3,now: 2024-05-23 18:53:04.249799,epoch time: 0:41:50.854936,used: 2:11:36.271070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9806586, 'precision': 0.94627035, 'recall': 0.7345906, 'specificity': 0.7345906, 'f1': 0.80538297, 'auroc': 0.9870416, 'binary_precision': 0.9106439, 'binary_recall': 0.47078803, 'binary_specificity': 0.9983932, 'binary_f1_score': 0.62068963}
confusion matrix:
       0    1
0  42252   68
1    779  693
---- Validation: 
scalar performance:
{'acc': 0.97722435, 'precision': 0.92416793, 'recall': 0.6956872, 'specificity': 0.6956872, 'f1': 0.7650389, 'auroc': 0.9813798, 'binary_precision': 0.8694158, 'binary_recall': 0.3934681, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.54175586}
confusion matrix:
       0    1
0  18111   38
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.85361785, 'recall': 0.5867886, 'specificity': 0.5867886, 'f1': 0.6329422, 'auroc': 0.958424, 'binary_precision': 0.7419355, 'binary_recall': 0.17624521, 'binary_specificity': 0.997332, 'binary_f1_score': 0.28482974}
confusion matrix:
      0   1
0  5981  16
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9772243499755859, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9610099196434021 / 0.9745925068855286
after epoch: 4,now: 2024-05-23 19:33:48.381648,epoch time: 0:40:44.131849,used: 2:52:20.402919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98680127, 'precision': 0.90242815, 'recall': 0.8918626, 'specificity': 0.8918626, 'f1': 0.8970692, 'auroc': 0.99071205, 'binary_precision': 0.81215084, 'binary_recall': 0.7900815, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.8009642}
confusion matrix:
       0     1
0  42051   269
1    309  1163
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.89184, 'recall': 0.87594485, 'specificity': 0.87594485, 'f1': 0.88371384, 'auroc': 0.98218143, 'binary_precision': 0.7922078, 'binary_recall': 0.7589425, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.7752184}
confusion matrix:
       0    1
0  18021  128
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.81190187, 'recall': 0.63476276, 'specificity': 0.63476276, 'f1': 0.6847247, 'auroc': 0.95749056, 'binary_precision': 0.6545454, 'binary_recall': 0.27586207, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.38814014}
confusion matrix:
      0   1
0  5959  38
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 5,now: 2024-05-23 20:13:02.406285,epoch time: 0:39:14.024637,used: 3:31:34.427556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9859335, 'precision': 0.91948867, 'recall': 0.8514148, 'specificity': 0.8514148, 'f1': 0.882213, 'auroc': 0.9893711, 'binary_precision': 0.8491028, 'binary_recall': 0.70720106, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.77168274}
confusion matrix:
       0     1
0  42135   185
1    431  1041
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.93766963, 'recall': 0.8088869, 'specificity': 0.8088869, 'f1': 0.8613563, 'auroc': 0.9789017, 'binary_precision': 0.8886414, 'binary_recall': 0.62052876, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7307692}
confusion matrix:
       0    1
0  18099   50
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.88912225, 'recall': 0.62135476, 'specificity': 0.62135476, 'f1': 0.67952967, 'auroc': 0.96081465, 'binary_precision': 0.8101266, 'binary_recall': 0.24521072, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3764706}
confusion matrix:
      0   1
0  5982  15
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9843550324440002, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9637264013290405 / 0.9745925068855286
after epoch: 6,now: 2024-05-23 20:52:19.888575,epoch time: 0:39:17.482290,used: 4:10:51.909846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.931146, 'recall': 0.8939922, 'specificity': 0.8939922, 'f1': 0.9116671, 'auroc': 0.9927558, 'binary_precision': 0.8695004, 'binary_recall': 0.79211956, 'binary_specificity': 0.99586487, 'binary_f1_score': 0.8290082}
confusion matrix:
       0     1
0  42145   175
1    306  1166
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.917199, 'recall': 0.84919083, 'specificity': 0.84919083, 'f1': 0.8799381, 'auroc': 0.98336524, 'binary_precision': 0.84485984, 'binary_recall': 0.7029549, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7674024}
confusion matrix:
       0    1
0  18066   83
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.92122036, 'recall': 0.5818752, 'specificity': 0.5818752, 'f1': 0.6295339, 'auroc': 0.9623688, 'binary_precision': 0.877551, 'binary_recall': 0.16475096, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.27741933}
confusion matrix:
      0   1
0  5991   6
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 7,now: 2024-05-23 21:33:04.332711,epoch time: 0:40:44.444136,used: 4:51:36.353982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98627603, 'precision': 0.97671956, 'recall': 0.805888, 'specificity': 0.805888, 'f1': 0.8714202, 'auroc': 0.99375004, 'binary_precision': 0.9667382, 'binary_recall': 0.6125085, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.74989593}
confusion matrix:
       0    1
0  42290   31
1    570  901
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.9678788, 'recall': 0.7631397, 'specificity': 0.7631397, 'f1': 0.83495235, 'auroc': 0.98417145, 'binary_precision': 0.9522472, 'binary_recall': 0.5272162, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.67867875}
confusion matrix:
       0    1
0  18132   17
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.9583937, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9829182624816895, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.964205801486969 / 0.9745925068855286
after epoch: 8,now: 2024-05-23 22:13:32.911880,epoch time: 0:40:28.579169,used: 5:32:04.933151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.990021, 'precision': 0.931647, 'recall': 0.9115021, 'specificity': 0.9115021, 'f1': 0.92131484, 'auroc': 0.9949299, 'binary_precision': 0.8692857, 'binary_recall': 0.8273283, 'binary_specificity': 0.9956759, 'binary_f1_score': 0.8477882}
confusion matrix:
       0     1
0  42138   183
1    254  1217
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.90913373, 'recall': 0.8728007, 'specificity': 0.8728007, 'f1': 0.89005363, 'auroc': 0.98389715, 'binary_precision': 0.8270548, 'binary_recall': 0.7511664, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.78728604}
confusion matrix:
       0    1
0  18048  101
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8247339, 'recall': 0.60886, 'specificity': 0.60886, 'f1': 0.6581806, 'auroc': 0.9601085, 'binary_precision': 0.68235296, 'binary_recall': 0.22222222, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.33526012}
confusion matrix:
      0   1
0  5970  27
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 9,now: 2024-05-23 22:54:18.230921,epoch time: 0:40:45.319041,used: 6:12:50.252192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889706, 'precision': 0.95863116, 'recall': 0.8637136, 'specificity': 0.8637136, 'f1': 0.90529734, 'auroc': 0.9943744, 'binary_precision': 0.9265976, 'binary_recall': 0.72943574, 'binary_specificity': 0.99799156, 'binary_f1_score': 0.81628}
confusion matrix:
       0     1
0  42236    85
1    398  1073
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.93739104, 'recall': 0.7972779, 'specificity': 0.7972779, 'f1': 0.8530048, 'auroc': 0.9831086, 'binary_precision': 0.8888889, 'binary_recall': 0.59720063, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7144186}
confusion matrix:
       0    1
0  18101   48
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.84384453, 'recall': 0.55463845, 'specificity': 0.55463845, 'f1': 0.5863987, 'auroc': 0.9498507, 'binary_precision': 0.725, 'binary_recall': 0.11111111, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5986  11
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9632470607757568 / 0.9745925068855286
after epoch: 10,now: 2024-05-23 23:34:47.256203,epoch time: 0:40:29.025282,used: 6:53:19.277474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988217, 'precision': 0.90229285, 'recall': 0.9207396, 'specificity': 0.9207396, 'f1': 0.911292, 'auroc': 0.9939517, 'binary_precision': 0.80986375, 'binary_recall': 0.84840244, 'binary_specificity': 0.99307674, 'binary_f1_score': 0.8286853}
confusion matrix:
       0     1
0  42028   293
1    223  1248
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.90789557, 'recall': 0.87044036, 'specificity': 0.87044036, 'f1': 0.88819253, 'auroc': 0.98400474, 'binary_precision': 0.82474226, 'binary_recall': 0.7465008, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.78367347}
confusion matrix:
       0    1
0  18047  102
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8869103, 'recall': 0.66866386, 'specificity': 0.66866386, 'f1': 0.7312598, 'auroc': 0.94368416, 'binary_precision': 0.8018018, 'binary_recall': 0.34099618, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.4784946}
confusion matrix:
      0   1
0  5975  22
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 2
val acc:0.9858982563018799, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9632470607757568 / 0.9745925068855286
after epoch: 11,now: 2024-05-24 00:15:04.766483,epoch time: 0:40:17.510280,used: 7:33:36.787754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9725664, 'recall': 0.88520795, 'specificity': 0.88520795, 'f1': 0.9241184, 'auroc': 0.99690175, 'binary_precision': 0.95302016, 'binary_recall': 0.7717391, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.8528528}
confusion matrix:
       0     1
0  42264    56
1    336  1136
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.95524895, 'recall': 0.81710374, 'specificity': 0.81710374, 'f1': 0.87294, 'auroc': 0.9858184, 'binary_precision': 0.92325056, 'binary_recall': 0.63608086, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.7532229}
confusion matrix:
       0    1
0  18115   34
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8680984, 'recall': 0.56430036, 'specificity': 0.56430036, 'f1': 0.60177106, 'auroc': 0.9513842, 'binary_precision': 0.77272725, 'binary_recall': 0.1302682, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.22295083}
confusion matrix:
      0   1
0  5987  10
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 3
val acc:0.9857386350631714, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9632470607757568 / 0.9745925068855286
after epoch: 12,now: 2024-05-24 00:53:46.654423,epoch time: 0:38:41.887940,used: 8:12:18.675694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9926242, 'precision': 0.9544097, 'recall': 0.92962843, 'specificity': 0.92962843, 'f1': 0.941645, 'auroc': 0.997572, 'binary_precision': 0.9136069, 'binary_recall': 0.8620924, 'binary_specificity': 0.9971645, 'binary_f1_score': 0.88710237}
confusion matrix:
       0     1
0  42200   120
1    203  1269
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.92083305, 'recall': 0.87710196, 'specificity': 0.87710196, 'f1': 0.8976726, 'auroc': 0.9828122, 'binary_precision': 0.8501742, 'binary_recall': 0.7589425, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8019721}
confusion matrix:
       0    1
0  18063   86
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8856087, 'recall': 0.6307665, 'specificity': 0.6307665, 'f1': 0.6902598, 'auroc': 0.9464204, 'binary_precision': 0.8023256, 'binary_recall': 0.26436782, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.39769453}
confusion matrix:
      0   1
0  5980  17
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 13,now: 2024-05-24 01:33:13.009242,epoch time: 0:39:26.354819,used: 8:51:45.030513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9904092, 'precision': 0.9786792, 'recall': 0.86979556, 'specificity': 0.86979556, 'f1': 0.9167597, 'auroc': 0.99745035, 'binary_precision': 0.96631205, 'binary_recall': 0.7404891, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.8384615}
confusion matrix:
       0     1
0  42282    38
1    382  1090
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9533994, 'recall': 0.7907203, 'specificity': 0.7907203, 'f1': 0.8530371, 'auroc': 0.98166126, 'binary_precision': 0.92137593, 'binary_recall': 0.58320373, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.71428573}
confusion matrix:
       0    1
0  18117   32
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8534349, 'recall': 0.6226034, 'specificity': 0.6226034, 'f1': 0.67724663, 'auroc': 0.9469393, 'binary_precision': 0.7386364, 'binary_recall': 0.24904214, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.37249282}
confusion matrix:
      0   1
0  5974  23
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9840357303619385, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9666027426719666 / 0.9745925068855286
after epoch: 14,now: 2024-05-24 02:13:38.416085,epoch time: 0:40:25.406843,used: 9:32:10.437356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.994314, 'precision': 0.9520757, 'recall': 0.96127117, 'specificity': 0.96127117, 'f1': 0.95662355, 'auroc': 0.9984733, 'binary_precision': 0.90672886, 'binary_recall': 0.92585033, 'binary_specificity': 0.996692, 'binary_f1_score': 0.9161899}
confusion matrix:
       0     1
0  42182   140
1    109  1361
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.91270757, 'recall': 0.88913035, 'specificity': 0.88913035, 'f1': 0.9005437, 'auroc': 0.9805175, 'binary_precision': 0.8330579, 'binary_recall': 0.7838258, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.8076923}
confusion matrix:
       0    1
0  18048  101
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.83206874, 'recall': 0.6728268, 'specificity': 0.6728268, 'f1': 0.72484064, 'auroc': 0.9437436, 'binary_precision': 0.6917293, 'binary_recall': 0.35249043, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.46700507}
confusion matrix:
      0   1
0  5956  41
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 15,now: 2024-05-24 02:54:16.474656,epoch time: 0:40:38.058571,used: 10:12:48.495927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99216753, 'precision': 0.97549444, 'recall': 0.90054053, 'specificity': 0.90054053, 'f1': 0.9345784, 'auroc': 0.9978137, 'binary_precision': 0.95782644, 'binary_recall': 0.8023098, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.8731978}
confusion matrix:
       0     1
0  42268    52
1    291  1181
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.9353422, 'recall': 0.79722285, 'specificity': 0.79722285, 'f1': 0.8523139, 'auroc': 0.97598493, 'binary_precision': 0.8847926, 'binary_recall': 0.59720063, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7130919}
confusion matrix:
       0    1
0  18099   50
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8818928, 'recall': 0.56821513, 'specificity': 0.56821513, 'f1': 0.6080648, 'auroc': 0.94778013, 'binary_precision': 0.8, 'binary_recall': 0.13793103, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2352941}
confusion matrix:
      0   1
0  5988   9
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9835568070411682, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9664429426193237 / 0.9745925068855286
after epoch: 16,now: 2024-05-24 03:34:53.545548,epoch time: 0:40:37.070892,used: 10:53:25.566819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9930124, 'precision': 0.9627647, 'recall': 0.92682964, 'specificity': 0.92682964, 'f1': 0.94401646, 'auroc': 0.99822366, 'binary_precision': 0.93052477, 'binary_recall': 0.8558804, 'binary_specificity': 0.9977789, 'binary_f1_score': 0.8916431}
confusion matrix:
       0     1
0  42227    94
1    212  1259
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9293145, 'recall': 0.83646744, 'specificity': 0.83646744, 'f1': 0.87683165, 'auroc': 0.9797394, 'binary_precision': 0.87, 'binary_recall': 0.67651635, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.76115483}
confusion matrix:
       0    1
0  18084   65
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9297644, 'recall': 0.6105275, 'specificity': 0.6105275, 'f1': 0.6693005, 'auroc': 0.94272166, 'binary_precision': 0.8923077, 'binary_recall': 0.22222222, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.3558282}
confusion matrix:
      0   1
0  5990   7
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 2
val acc:0.985472559928894, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9664429426193237 / 0.9745925068855286
after epoch: 17,now: 2024-05-24 04:15:32.335792,epoch time: 0:40:38.790244,used: 11:34:04.357063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99378884, 'precision': 0.97850096, 'recall': 0.9236738, 'specificity': 0.9236738, 'f1': 0.94929904, 'auroc': 0.9982984, 'binary_precision': 0.96224964, 'binary_recall': 0.84850544, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.90180504}
confusion matrix:
       0     1
0  42271    49
1    223  1249
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.95479655, 'recall': 0.834906, 'specificity': 0.834906, 'f1': 0.8850894, 'auroc': 0.9811833, 'binary_precision': 0.9211087, 'binary_recall': 0.6718507, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.77697843}
confusion matrix:
       0    1
0  18112   37
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9090909, 'recall': 0.5342326, 'specificity': 0.5342326, 'f1': 0.55377585, 'auroc': 0.89537966, 'binary_precision': 0.85714287, 'binary_recall': 0.06896552, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5994   3
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 3
val acc:0.986802875995636, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9664429426193237 / 0.9745925068855286
after epoch: 18,now: 2024-05-24 04:55:29.587645,epoch time: 0:39:57.251853,used: 12:14:01.608916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9939258, 'precision': 0.95114356, 'recall': 0.95587486, 'specificity': 0.95587486, 'f1': 0.95349586, 'auroc': 0.9979431, 'binary_precision': 0.9052419, 'binary_recall': 0.9150815, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.91013503}
confusion matrix:
       0     1
0  42179   141
1    125  1347
---- Validation: 
scalar performance:
{'acc': 0.9887718, 'precision': 0.92537165, 'recall': 0.9004301, 'specificity': 0.9004301, 'f1': 0.91249347, 'auroc': 0.98436546, 'binary_precision': 0.8576159, 'binary_recall': 0.80559874, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8307938}
confusion matrix:
       0    1
0  18063   86
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8051715, 'recall': 0.66816163, 'specificity': 0.66816163, 'f1': 0.7147177, 'auroc': 0.95164293, 'binary_precision': 0.63829786, 'binary_recall': 0.3448276, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.4477612}
confusion matrix:
      0   1
0  5946  51
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
better model found
persisted
after epoch: 19,now: 2024-05-24 05:34:12.075219,epoch time: 0:38:42.487574,used: 12:52:44.096490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.995433, 'precision': 0.9809934, 'recall': 0.9474746, 'specificity': 0.9474746, 'f1': 0.96358395, 'auroc': 0.9991245, 'binary_precision': 0.965593, 'binary_recall': 0.8960598, 'binary_specificity': 0.9988894, 'binary_f1_score': 0.9295278}
confusion matrix:
       0     1
0  42273    47
1    153  1319
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.93532765, 'recall': 0.85907304, 'specificity': 0.85907304, 'f1': 0.89325833, 'auroc': 0.9808711, 'binary_precision': 0.88045543, 'binary_recall': 0.7216174, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7931624}
confusion matrix:
       0    1
0  18086   63
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.83346313, 'recall': 0.5883708, 'specificity': 0.5883708, 'f1': 0.6336931, 'auroc': 0.9401665, 'binary_precision': 0.70149255, 'binary_recall': 0.18007663, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2865854}
confusion matrix:
      0   1
0  5977  20
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 1
val acc:0.9871221780776978, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 20,now: 2024-05-24 06:13:28.612678,epoch time: 0:39:16.537459,used: 13:32:00.633949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938573, 'precision': 0.95862067, 'recall': 0.94567585, 'specificity': 0.94567585, 'f1': 0.9520484, 'auroc': 0.99839735, 'binary_precision': 0.9209237, 'binary_recall': 0.89402175, 'binary_specificity': 0.9973299, 'binary_f1_score': 0.90727335}
confusion matrix:
       0     1
0  42207   113
1    156  1316
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.91623706, 'recall': 0.8483857, 'specificity': 0.8483857, 'f1': 0.8790617, 'auroc': 0.979447, 'binary_precision': 0.84299064, 'binary_recall': 0.7013997, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7657046}
confusion matrix:
       0    1
0  18065   84
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8580371, 'recall': 0.5962838, 'specificity': 0.5962838, 'f1': 0.645702, 'auroc': 0.94928116, 'binary_precision': 0.75, 'binary_recall': 0.1954023, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3100304}
confusion matrix:
      0   1
0  5980  17
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 2
val acc:0.9853128790855408, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 21,now: 2024-05-24 06:54:06.001693,epoch time: 0:40:37.389015,used: 14:12:38.022964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9942912, 'precision': 0.9607715, 'recall': 0.95049036, 'specificity': 0.95049036, 'f1': 0.95556843, 'auroc': 0.998748, 'binary_precision': 0.9248957, 'binary_recall': 0.9035326, 'binary_specificity': 0.997448, 'binary_f1_score': 0.9140894}
confusion matrix:
       0     1
0  42212   108
1    142  1330
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9143748, 'recall': 0.87068826, 'specificity': 0.87068826, 'f1': 0.89121723, 'auroc': 0.98157555, 'binary_precision': 0.8376963, 'binary_recall': 0.7465008, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7894737}
confusion matrix:
       0    1
0  18056   93
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.85619575, 'recall': 0.5509738, 'specificity': 0.5509738, 'f1': 0.5809656, 'auroc': 0.9321, 'binary_precision': 0.75, 'binary_recall': 0.10344828, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5988   9
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 3
val acc:0.9863771796226501, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 22,now: 2024-05-24 07:34:41.233907,epoch time: 0:40:35.232214,used: 14:53:13.255178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99493057, 'precision': 0.95398796, 'recall': 0.9694699, 'specificity': 0.9694699, 'f1': 0.96158886, 'auroc': 0.9987372, 'binary_precision': 0.90998685, 'binary_recall': 0.9421769, 'binary_specificity': 0.99676293, 'binary_f1_score': 0.9258021}
confusion matrix:
       0     1
0  42185   137
1     85  1385
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.8999428, 'recall': 0.8855241, 'specificity': 0.8855241, 'f1': 0.8925899, 'auroc': 0.9759486, 'binary_precision': 0.80775446, 'binary_recall': 0.777605, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.7923931}
confusion matrix:
       0    1
0  18030  119
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.88312614, 'recall': 0.598533, 'specificity': 0.598533, 'f1': 0.6504034, 'auroc': 0.933504, 'binary_precision': 0.8, 'binary_recall': 0.19923371, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.31901842}
confusion matrix:
      0   1
0  5984  13
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 4
val acc:0.9860578775405884, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 23,now: 2024-05-24 08:15:23.047372,epoch time: 0:40:41.813465,used: 15:33:55.068643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941313, 'precision': 0.95550764, 'recall': 0.95401406, 'specificity': 0.95401406, 'f1': 0.95475954, 'auroc': 0.9985148, 'binary_precision': 0.9141104, 'binary_recall': 0.91100544, 'binary_specificity': 0.9970227, 'binary_f1_score': 0.9125553}
confusion matrix:
       0     1
0  42194   126
1    131  1341
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.9141522, 'recall': 0.8729935, 'specificity': 0.8729935, 'f1': 0.8924092, 'auroc': 0.9797106, 'binary_precision': 0.8370884, 'binary_recall': 0.7511664, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.7918033}
confusion matrix:
       0    1
0  18055   94
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9117125, 'recall': 0.65400517, 'specificity': 0.65400517, 'f1': 0.71955115, 'auroc': 0.93723905, 'binary_precision': 0.85263157, 'binary_recall': 0.31034482, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.45505616}
confusion matrix:
      0   1
0  5983  14
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 5
val acc:0.986483633518219, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 24,now: 2024-05-24 08:56:09.439763,epoch time: 0:40:46.392391,used: 16:14:41.461034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9968716, 'precision': 0.97487473, 'recall': 0.97705555, 'specificity': 0.97705555, 'f1': 0.97596246, 'auroc': 0.999648, 'binary_precision': 0.95128554, 'binary_recall': 0.9558124, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.9535436}
confusion matrix:
       0     1
0  42249    72
1     65  1406
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9271611, 'recall': 0.87501705, 'specificity': 0.87501705, 'f1': 0.8992597, 'auroc': 0.98118484, 'binary_precision': 0.8629893, 'binary_recall': 0.7542768, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.80497926}
confusion matrix:
       0    1
0  18072   77
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.87118036, 'recall': 0.59836626, 'specificity': 0.59836626, 'f1': 0.6493472, 'auroc': 0.9277506, 'binary_precision': 0.7761194, 'binary_recall': 0.19923371, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.31707317}
confusion matrix:
      0   1
0  5982  15
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 6
val acc:0.987494707107544, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 25,now: 2024-05-24 09:36:05.462048,epoch time: 0:39:56.022285,used: 16:54:37.483319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99406284, 'precision': 0.9668567, 'recall': 0.9398405, 'specificity': 0.9398405, 'f1': 0.9529156, 'auroc': 0.99849176, 'binary_precision': 0.9378163, 'binary_recall': 0.8817131, 'binary_specificity': 0.9979679, 'binary_f1_score': 0.9088998}
confusion matrix:
       0     1
0  42235    86
1    174  1297
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9275808, 'recall': 0.8364123, 'specificity': 0.8364123, 'f1': 0.87613916, 'auroc': 0.976984, 'binary_precision': 0.8665339, 'binary_recall': 0.67651635, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7598253}
confusion matrix:
       0    1
0  18082   67
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.8529674, 'recall': 0.7280489, 'specificity': 0.7280489, 'f1': 0.7757207, 'auroc': 0.94099367, 'binary_precision': 0.7289157, 'binary_recall': 0.46360153, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.5667447}
confusion matrix:
      0    1
0  5952   45
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 7
val acc:0.9853661060333252, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 26,now: 2024-05-24 10:17:50.616799,epoch time: 0:41:45.154751,used: 17:36:22.638070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9965975, 'precision': 0.9897739, 'recall': 0.9572572, 'specificity': 0.9572572, 'f1': 0.9729161, 'auroc': 0.999519, 'binary_precision': 0.98249453, 'binary_recall': 0.9150815, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.94759053}
confusion matrix:
       0     1
0  42296    24
1    125  1347
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.9528095, 'recall': 0.86040163, 'specificity': 0.86040163, 'f1': 0.90096354, 'auroc': 0.97741497, 'binary_precision': 0.9153543, 'binary_recall': 0.7231726, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.80799305}
confusion matrix:
       0    1
0  18106   43
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.844252, 'recall': 0.60736114, 'specificity': 0.60736114, 'f1': 0.6583665, 'auroc': 0.93478096, 'binary_precision': 0.721519, 'binary_recall': 0.21839081, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.33529413}
confusion matrix:
      0   1
0  5975  22
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 8
val acc:0.9882397055625916, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 27,now: 2024-05-24 10:57:53.854193,epoch time: 0:40:03.237394,used: 18:16:25.875464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99493057, 'precision': 0.95076066, 'recall': 0.9737712, 'specificity': 0.9737712, 'f1': 0.9619567, 'auroc': 0.99922276, 'binary_precision': 0.9032258, 'binary_recall': 0.95108694, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.9265387}
confusion matrix:
       0     1
0  42170   150
1     72  1400
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.8961437, 'recall': 0.8830535, 'specificity': 0.8830535, 'f1': 0.8894792, 'auroc': 0.98039716, 'binary_precision': 0.80032206, 'binary_recall': 0.7729393, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7863924}
confusion matrix:
       0    1
0  18025  124
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8724407, 'recall': 0.62485266, 'specificity': 0.62485266, 'f1': 0.68195933, 'auroc': 0.94141597, 'binary_precision': 0.7764706, 'binary_recall': 0.25287357, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3815029}
confusion matrix:
      0   1
0  5978  19
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 9
val acc:0.9856321811676025, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 28,now: 2024-05-24 11:40:38.859879,epoch time: 0:42:45.005686,used: 18:59:10.881150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.995707, 'precision': 0.9806077, 'recall': 0.95214224, 'specificity': 0.95214224, 'f1': 0.96590817, 'auroc': 0.99941474, 'binary_precision': 0.96449274, 'binary_recall': 0.9054422, 'binary_specificity': 0.99884224, 'binary_f1_score': 0.93403506}
confusion matrix:
       0     1
0  42273    49
1    139  1331
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.96132433, 'recall': 0.7723057, 'specificity': 0.7723057, 'f1': 0.84082556, 'auroc': 0.97899544, 'binary_precision': 0.93850267, 'binary_recall': 0.5458787, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.6902654}
confusion matrix:
       0    1
0  18126   23
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8904933, 'recall': 0.615691, 'specificity': 0.615691, 'f1': 0.67276275, 'auroc': 0.9513718, 'binary_precision': 0.81333333, 'binary_recall': 0.23371647, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.36309525}
confusion matrix:
      0   1
0  5983  14
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 10
val acc:0.9832375645637512, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 29,now: 2024-05-24 12:37:24.980393,epoch time: 0:56:46.120514,used: 19:55:57.001664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99646056, 'precision': 0.9705724, 'recall': 0.97520244, 'specificity': 0.97520244, 'f1': 0.97287524, 'auroc': 0.9995427, 'binary_precision': 0.94279945, 'binary_recall': 0.9524133, 'binary_specificity': 0.99799156, 'binary_f1_score': 0.947582}
confusion matrix:
       0     1
0  42236    85
1     70  1401
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.92159843, 'recall': 0.8917938, 'specificity': 0.8917938, 'f1': 0.9061056, 'auroc': 0.9784068, 'binary_precision': 0.8506711, 'binary_recall': 0.7884914, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.8184019}
confusion matrix:
       0    1
0  18060   89
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8662672, 'recall': 0.63984483, 'specificity': 0.63984483, 'f1': 0.6980676, 'auroc': 0.92323685, 'binary_precision': 0.7628866, 'binary_recall': 0.2835249, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4134078}
confusion matrix:
      0   1
0  5974  23
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754610.png
early stop counter: 11
val acc:0.9880267977714539, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9645254015922546 / 0.9745925068855286
after epoch: 30,now: 2024-05-24 13:20:57.876207,epoch time: 0:43:32.895814,used: 20:39:29.897478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_16_41_27_seed_0_20754610
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:39:29.897478 at 2024-05-24 13:20:57.876207
persisted model performance metric: 

scalar performance:
{'acc': 0.9645254, 'precision': 0.80902255, 'recall': 0.66083235, 'specificity': 0.66083235, 'f1': 0.70911723, 'auroc': 0.9454301, 'binary_precision': 0.6466165, 'binary_recall': 0.32950193, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.43654823}
confusion matrix:
      0   1
0  5950  47
1   175  86
oracle model performance metric: 

scalar performance:
{'acc': 0.97315437, 'precision': 0.8619206, 'recall': 0.7679453, 'specificity': 0.7679453, 'f1': 0.80719644, 'auroc': 0.9434469, 'binary_precision': 0.74345547, 'binary_recall': 0.5440613, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.62831855}
confusion matrix:
      0    1
0  5948   49
1   119  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dial_irm/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413550 GiB | 413549 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400660 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152165 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152165 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2871    |   90109 K  |   90109 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      32    |    2759    |   42834 K  |   42834 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413551 GiB | 413551 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |      0 KiB |     25 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2871    |   90111 K  |   90111 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2759    |   42835 K  |   42835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 24 13:24:14 2024]
Finished job 0.
1 of 1 steps (100%) done
