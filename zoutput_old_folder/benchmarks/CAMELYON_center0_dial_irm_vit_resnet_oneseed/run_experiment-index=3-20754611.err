Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 23 20:39:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dial_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611

 Experiment start at: 2024-05-23 20:52:02.157306
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684189, 'precision': 0.7573638, 'recall': 0.74366724, 'specificity': 0.74366724, 'f1': 0.75030804, 'auroc': 0.9425534, 'binary_precision': 0.53199136, 'binary_recall': 0.5027174, 'binary_specificity': 0.9846172, 'binary_f1_score': 0.51694024}
confusion matrix:
       0    1
0  41669  651
1    732  740
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.75566214, 'recall': 0.72445315, 'specificity': 0.72445315, 'f1': 0.7389327, 'auroc': 0.9373091, 'binary_precision': 0.5302491, 'binary_recall': 0.46345258, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.4946058}
confusion matrix:
       0    1
0  17885  264
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.9352981, 'recall': 0.7248864, 'specificity': 0.7248864, 'f1': 0.79377913, 'auroc': 0.91719586, 'binary_precision': 0.8939394, 'binary_recall': 0.45210728, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.60050887}
confusion matrix:
      0    1
0  5983   14
1   143  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-23 21:28:14.746048,epoch time: 0:36:12.588742,used: 0:36:12.588742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96910393, 'precision': 0.76015484, 'recall': 0.8312323, 'specificity': 0.8312323, 'f1': 0.7909273, 'auroc': 0.9545772, 'binary_precision': 0.5314316, 'binary_recall': 0.68342394, 'binary_specificity': 0.9790406, 'binary_f1_score': 0.5979198}
confusion matrix:
       0     1
0  41433   887
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.76176965, 'recall': 0.80003726, 'specificity': 0.80003726, 'f1': 0.7794508, 'auroc': 0.95360106, 'binary_precision': 0.537112, 'binary_recall': 0.61897355, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.5751445}
confusion matrix:
       0    1
0  17806  343
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.922387, 'recall': 0.787271, 'specificity': 0.787271, 'f1': 0.84078395, 'auroc': 0.9316369, 'binary_precision': 0.86285716, 'binary_recall': 0.5785441, 'binary_specificity': 0.995998, 'binary_f1_score': 0.69266057}
confusion matrix:
      0    1
0  5973   24
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-23 21:59:05.215120,epoch time: 0:30:50.469072,used: 1:07:03.057814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97351116, 'precision': 0.7917706, 'recall': 0.82302105, 'specificity': 0.82302105, 'f1': 0.8065189, 'auroc': 0.9619132, 'binary_precision': 0.5953545, 'binary_recall': 0.6616848, 'binary_specificity': 0.9843573, 'binary_f1_score': 0.6267696}
confusion matrix:
       0    1
0  41658  662
1    498  974
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.78507733, 'recall': 0.7978848, 'specificity': 0.7978848, 'f1': 0.7913255, 'auroc': 0.9593762, 'binary_precision': 0.5839524, 'binary_recall': 0.61119753, 'binary_specificity': 0.9845722, 'binary_f1_score': 0.59726447}
confusion matrix:
       0    1
0  17869  280
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.9339927, 'recall': 0.77052987, 'specificity': 0.77052987, 'f1': 0.8316287, 'auroc': 0.93000686, 'binary_precision': 0.8875, 'binary_recall': 0.5440613, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6745843}
confusion matrix:
      0    1
0  5979   18
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 3,now: 2024-05-23 22:29:26.533983,epoch time: 0:30:21.318863,used: 1:37:24.376677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.7858366, 'recall': 0.812042, 'specificity': 0.812042, 'f1': 0.7983049, 'auroc': 0.96835726, 'binary_precision': 0.5842138, 'binary_recall': 0.6398911, 'binary_specificity': 0.98419297, 'binary_f1_score': 0.61078626}
confusion matrix:
       0    1
0  41654  669
1    529  940
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.77748036, 'recall': 0.81475043, 'specificity': 0.81475043, 'f1': 0.7948134, 'auroc': 0.96124256, 'binary_precision': 0.5675307, 'binary_recall': 0.64696735, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.60465115}
confusion matrix:
       0    1
0  17832  317
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.92299026, 'recall': 0.7796916, 'specificity': 0.7796916, 'f1': 0.83539915, 'auroc': 0.93854094, 'binary_precision': 0.86470586, 'binary_recall': 0.5632184, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.68213457}
confusion matrix:
      0    1
0  5974   23
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9710515141487122, best validation acc: 0.9717965126037598, corresponding to test acc:                         0.9781080484390259 / 0.9785873889923096
after epoch: 4,now: 2024-05-23 22:59:57.004992,epoch time: 0:30:30.471009,used: 2:07:54.847686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9772333, 'precision': 0.82493037, 'recall': 0.8242911, 'specificity': 0.8242911, 'f1': 0.82461035, 'auroc': 0.97239286, 'binary_precision': 0.6616746, 'binary_recall': 0.66032606, 'binary_specificity': 0.98825616, 'binary_f1_score': 0.66099966}
confusion matrix:
       0    1
0  41823  497
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.9783418, 'precision': 0.84184945, 'recall': 0.8207749, 'specificity': 0.8207749, 'f1': 0.83094615, 'auroc': 0.96978474, 'binary_precision': 0.6960133, 'binary_recall': 0.65163296, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.67309237}
confusion matrix:
       0    1
0  17966  183
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.9357766, 'recall': 0.7268021, 'specificity': 0.7268021, 'f1': 0.7955959, 'auroc': 0.92596555, 'binary_precision': 0.8947368, 'binary_recall': 0.4559387, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6040609}
confusion matrix:
      0    1
0  5983   14
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 5,now: 2024-05-23 23:30:32.482927,epoch time: 0:30:35.477935,used: 2:38:30.325621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97682226, 'precision': 0.81984127, 'recall': 0.82801276, 'specificity': 0.82801276, 'f1': 0.8238705, 'auroc': 0.97628903, 'binary_precision': 0.6512244, 'binary_recall': 0.66847825, 'binary_specificity': 0.9875473, 'binary_f1_score': 0.6597385}
confusion matrix:
       0    1
0  41793  527
1    488  984
---- Validation: 
scalar performance:
{'acc': 0.9773308, 'precision': 0.8470032, 'recall': 0.78199863, 'specificity': 0.78199863, 'f1': 0.8108473, 'auroc': 0.97042453, 'binary_precision': 0.7090559, 'binary_recall': 0.57231724, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.6333907}
confusion matrix:
       0    1
0  17998  151
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8820022, 'recall': 0.6988149, 'specificity': 0.6988149, 'f1': 0.7589079, 'auroc': 0.9531771, 'binary_precision': 0.7894737, 'binary_recall': 0.40229884, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5329949}
confusion matrix:
      0    1
0  5969   28
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9773308038711548, best validation acc: 0.978341817855835, corresponding to test acc:                         0.975071907043457 / 0.9785873889923096
after epoch: 6,now: 2024-05-24 00:01:34.172921,epoch time: 0:31:01.689994,used: 3:09:32.015615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98040736, 'precision': 0.86719847, 'recall': 0.8115076, 'specificity': 0.8115076, 'f1': 0.8368759, 'auroc': 0.9805756, 'binary_precision': 0.74718195, 'binary_recall': 0.6304348, 'binary_specificity': 0.99258035, 'binary_f1_score': 0.6838615}
confusion matrix:
       0    1
0  42006  314
1    544  928
---- Validation: 
scalar performance:
{'acc': 0.9800979, 'precision': 0.87419844, 'recall': 0.8006824, 'specificity': 0.8006824, 'f1': 0.83310187, 'auroc': 0.9759477, 'binary_precision': 0.76218325, 'binary_recall': 0.60808706, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.6764706}
confusion matrix:
       0    1
0  18027  122
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8145914, 'recall': 0.5524726, 'specificity': 0.5524726, 'f1': 0.5822971, 'auroc': 0.9468149, 'binary_precision': 0.6666667, 'binary_recall': 0.107279696, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.18481848}
confusion matrix:
      0   1
0  5983  14
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 7,now: 2024-05-24 00:32:33.744747,epoch time: 0:30:59.571826,used: 3:40:31.587441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9812523, 'precision': 0.87506795, 'recall': 0.8173967, 'specificity': 0.8173967, 'f1': 0.8436315, 'auroc': 0.98220986, 'binary_precision': 0.7625202, 'binary_recall': 0.6417403, 'binary_specificity': 0.9930531, 'binary_f1_score': 0.69693613}
confusion matrix:
       0    1
0  42027  294
1    527  944
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.9070682, 'recall': 0.8041173, 'specificity': 0.8041173, 'f1': 0.8475615, 'auroc': 0.97376513, 'binary_precision': 0.8277311, 'binary_recall': 0.61275274, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.70420015}
confusion matrix:
       0    1
0  18067   82
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8081609, 'recall': 0.5355647, 'specificity': 0.5355647, 'f1': 0.5552113, 'auroc': 0.9280617, 'binary_precision': 0.6551724, 'binary_recall': 0.07279693, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.13103448}
confusion matrix:
      0   1
0  5987  10
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 8,now: 2024-05-24 01:03:39.746980,epoch time: 0:31:06.002233,used: 4:11:37.589674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9810239, 'precision': 0.8542986, 'recall': 0.8531368, 'specificity': 0.8531368, 'f1': 0.8537166, 'auroc': 0.98494613, 'binary_precision': 0.7184731, 'binary_recall': 0.7160326, 'binary_specificity': 0.990241, 'binary_f1_score': 0.7172507}
confusion matrix:
       0     1
0  41907   413
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.90028936, 'recall': 0.8362533, 'specificity': 0.8362533, 'f1': 0.8652612, 'auroc': 0.97779536, 'binary_precision': 0.8119181, 'binary_recall': 0.67807156, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.73898304}
confusion matrix:
       0    1
0  18048  101
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82802624, 'recall': 0.5676315, 'specificity': 0.5676315, 'f1': 0.60514134, 'auroc': 0.94498336, 'binary_precision': 0.6923077, 'binary_recall': 0.13793103, 'binary_specificity': 0.997332, 'binary_f1_score': 0.23003194}
confusion matrix:
      0   1
0  5981  16
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 9,now: 2024-05-24 01:34:46.611657,epoch time: 0:31:06.864677,used: 4:42:44.454351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98259956, 'precision': 0.8886879, 'recall': 0.8255234, 'specificity': 0.8255234, 'f1': 0.85408646, 'auroc': 0.9840869, 'binary_precision': 0.7892157, 'binary_recall': 0.6571429, 'binary_specificity': 0.9939039, 'binary_f1_score': 0.71714926}
confusion matrix:
       0    1
0  42064  258
1    504  966
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.892009, 'recall': 0.78206885, 'specificity': 0.78206885, 'f1': 0.8273679, 'auroc': 0.9790824, 'binary_precision': 0.7991266, 'binary_recall': 0.56920683, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.6648501}
confusion matrix:
       0    1
0  18057   92
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.796738, 'recall': 0.54480976, 'specificity': 0.54480976, 'f1': 0.569995, 'auroc': 0.9355628, 'binary_precision': 0.6315789, 'binary_recall': 0.09195402, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16053513}
confusion matrix:
      0   1
0  5983  14
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9803639650344849, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9614893198013306 / 0.9785873889923096
after epoch: 10,now: 2024-05-24 02:06:04.851667,epoch time: 0:31:18.240010,used: 5:14:02.694361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794483, 'precision': 0.83065426, 'recall': 0.87723887, 'specificity': 0.87723887, 'f1': 0.85226464, 'auroc': 0.9833668, 'binary_precision': 0.66943127, 'binary_recall': 0.76766306, 'binary_specificity': 0.98681474, 'binary_f1_score': 0.7151899}
confusion matrix:
       0     1
0  41762   558
1    342  1130
---- Validation: 
scalar performance:
{'acc': 0.9802576, 'precision': 0.83991003, 'recall': 0.881021, 'specificity': 0.881021, 'f1': 0.8591795, 'auroc': 0.9773729, 'binary_precision': 0.6878453, 'binary_recall': 0.7744945, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.72860277}
confusion matrix:
       0    1
0  17923  226
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7599709, 'recall': 0.53514785, 'specificity': 0.53514785, 'f1': 0.55389214, 'auroc': 0.9269004, 'binary_precision': 0.5588235, 'binary_recall': 0.07279693, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.12881355}
confusion matrix:
      0   1
0  5982  15
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 2
val acc:0.9802575707435608, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9614893198013306 / 0.9785873889923096
after epoch: 11,now: 2024-05-24 02:36:52.274401,epoch time: 0:30:47.422734,used: 5:44:50.117095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98374134, 'precision': 0.8661169, 'recall': 0.89388585, 'specificity': 0.89388585, 'f1': 0.87944835, 'auroc': 0.98820543, 'binary_precision': 0.7392947, 'binary_recall': 0.7975544, 'binary_specificity': 0.9902174, 'binary_f1_score': 0.76732033}
confusion matrix:
       0     1
0  41906   414
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.8686589, 'recall': 0.88025856, 'specificity': 0.88025856, 'f1': 0.8743608, 'auroc': 0.9803502, 'binary_precision': 0.7454819, 'binary_recall': 0.7698289, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.7574599}
confusion matrix:
       0    1
0  17980  169
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83818096, 'recall': 0.54705894, 'specificity': 0.54705894, 'f1': 0.574394, 'auroc': 0.9331013, 'binary_precision': 0.71428573, 'binary_recall': 0.09578544, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5987  10
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 3
val acc:0.9831311106681824, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9614893198013306 / 0.9785873889923096
after epoch: 12,now: 2024-05-24 03:07:46.304600,epoch time: 0:30:54.030199,used: 6:15:44.147294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98326176, 'precision': 0.8587393, 'recall': 0.90019494, 'specificity': 0.90019494, 'f1': 0.8782305, 'auroc': 0.98902225, 'binary_precision': 0.7240752, 'binary_recall': 0.8111413, 'binary_specificity': 0.9892486, 'binary_f1_score': 0.76513934}
confusion matrix:
       0     1
0  41865   455
1    278  1194
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.8861908, 'recall': 0.8687811, 'specificity': 0.8687811, 'f1': 0.87726784, 'auroc': 0.981719, 'binary_precision': 0.78140295, 'binary_recall': 0.7449456, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.7627388}
confusion matrix:
       0    1
0  18015  134
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8428042, 'recall': 0.5395629, 'specificity': 0.5395629, 'f1': 0.5622715, 'auroc': 0.9013148, 'binary_precision': 0.7241379, 'binary_recall': 0.08045977, 'binary_specificity': 0.998666, 'binary_f1_score': 0.14482759}
confusion matrix:
      0   1
0  5989   8
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 13,now: 2024-05-24 03:37:54.183116,epoch time: 0:30:07.878516,used: 6:45:52.025810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847461, 'precision': 0.8781689, 'recall': 0.89105606, 'specificity': 0.89105606, 'f1': 0.8844951, 'auroc': 0.9907881, 'binary_precision': 0.7636244, 'binary_recall': 0.7906186, 'binary_specificity': 0.9914936, 'binary_f1_score': 0.77688706}
confusion matrix:
       0     1
0  41961   360
1    308  1163
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.8863132, 'recall': 0.85725474, 'specificity': 0.85725474, 'f1': 0.8711677, 'auroc': 0.9805258, 'binary_precision': 0.78246206, 'binary_recall': 0.7216174, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7508091}
confusion matrix:
       0    1
0  18020  129
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.80997634, 'recall': 0.54680884, 'specificity': 0.54680884, 'f1': 0.5734213, 'auroc': 0.9000238, 'binary_precision': 0.65789473, 'binary_recall': 0.09578544, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.16722408}
confusion matrix:
      0   1
0  5984  13
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9836100339889526, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9603707194328308 / 0.9785873889923096
after epoch: 14,now: 2024-05-24 04:07:56.829347,epoch time: 0:30:02.646231,used: 7:15:54.672041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98629886, 'precision': 0.9100125, 'recall': 0.87061965, 'specificity': 0.87061965, 'f1': 0.8892422, 'auroc': 0.9909197, 'binary_precision': 0.8288084, 'binary_recall': 0.74660325, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.7855611}
confusion matrix:
       0     1
0  42093   227
1    373  1099
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.91294473, 'recall': 0.83747166, 'specificity': 0.83747166, 'f1': 0.8711121, 'auroc': 0.98029745, 'binary_precision': 0.83716476, 'binary_recall': 0.67962676, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7502146}
confusion matrix:
       0    1
0  18064   85
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8622442, 'recall': 0.56613266, 'specificity': 0.56613266, 'f1': 0.60430056, 'auroc': 0.92685264, 'binary_precision': 0.76086956, 'binary_recall': 0.13409962, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.22801304}
confusion matrix:
      0   1
0  5986  11
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 15,now: 2024-05-24 04:38:10.334469,epoch time: 0:30:13.505122,used: 7:46:08.177163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9872123, 'precision': 0.9060995, 'recall': 0.89437026, 'specificity': 0.89437026, 'f1': 0.90014184, 'auroc': 0.9932889, 'binary_precision': 0.8193277, 'binary_recall': 0.79483694, 'binary_specificity': 0.9939036, 'binary_f1_score': 0.80689657}
confusion matrix:
       0     1
0  42062   258
1    302  1170
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9236249, 'recall': 0.86485314, 'specificity': 0.86485314, 'f1': 0.8918749, 'auroc': 0.98306775, 'binary_precision': 0.8566243, 'binary_recall': 0.7340591, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.79061973}
confusion matrix:
       0    1
0  18070   79
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8566543, 'recall': 0.5623013, 'specificity': 0.5623013, 'f1': 0.5984104, 'auroc': 0.93772817, 'binary_precision': 0.75, 'binary_recall': 0.12643678, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.21639346}
confusion matrix:
      0   1
0  5986  11
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 16,now: 2024-05-24 05:08:10.299275,epoch time: 0:29:59.964806,used: 8:16:08.141969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9849059, 'precision': 0.8726827, 'recall': 0.90655905, 'specificity': 0.90655905, 'f1': 0.8888185, 'auroc': 0.99155533, 'binary_precision': 0.7515528, 'binary_recall': 0.82256967, 'binary_specificity': 0.99054843, 'binary_f1_score': 0.7854593}
confusion matrix:
       0     1
0  41921   400
1    261  1210
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.8705218, 'recall': 0.8849517, 'specificity': 0.8849517, 'f1': 0.8775865, 'auroc': 0.9805119, 'binary_precision': 0.7488789, 'binary_recall': 0.7791602, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.7637195}
confusion matrix:
       0    1
0  17981  168
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.78411984, 'recall': 0.593034, 'specificity': 0.593034, 'f1': 0.6353259, 'auroc': 0.8852526, 'binary_precision': 0.60240966, 'binary_recall': 0.19157088, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.2906977}
confusion matrix:
      0   1
0  5964  33
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9835036396980286, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9618088603019714 / 0.9785873889923096
after epoch: 17,now: 2024-05-24 05:36:57.851185,epoch time: 0:28:47.551910,used: 8:44:55.693879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98789734, 'precision': 0.9042305, 'recall': 0.9111177, 'specificity': 0.9111177, 'f1': 0.9076426, 'auroc': 0.9929652, 'binary_precision': 0.8144192, 'binary_recall': 0.8288044, 'binary_specificity': 0.993431, 'binary_f1_score': 0.8215489}
confusion matrix:
       0     1
0  42042   278
1    252  1220
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.8836794, 'recall': 0.89402884, 'specificity': 0.89402884, 'f1': 0.88877916, 'auroc': 0.9815096, 'binary_precision': 0.77458394, 'binary_recall': 0.7962675, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.7852761}
confusion matrix:
       0    1
0  18000  149
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.85950965, 'recall': 0.564217, 'specificity': 0.564217, 'f1': 0.60136503, 'auroc': 0.9259411, 'binary_precision': 0.75555557, 'binary_recall': 0.1302682, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5986  11
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 2
val acc:0.9851000308990479, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9618088603019714 / 0.9785873889923096
after epoch: 18,now: 2024-05-24 06:05:00.606303,epoch time: 0:28:02.755118,used: 9:12:58.448997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.8665124, 'recall': 0.9219911, 'specificity': 0.9219911, 'f1': 0.8921207, 'auroc': 0.99333024, 'binary_precision': 0.73810923, 'binary_recall': 0.85452074, 'binary_specificity': 0.9894615, 'binary_f1_score': 0.7920605}
confusion matrix:
       0     1
0  41875   446
1    214  1257
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.8768431, 'recall': 0.91289043, 'specificity': 0.91289043, 'f1': 0.89396924, 'auroc': 0.9824645, 'binary_precision': 0.7595474, 'binary_recall': 0.83514774, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.79555565}
confusion matrix:
       0    1
0  17979  170
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82936835, 'recall': 0.54322755, 'specificity': 0.54322755, 'f1': 0.5680857, 'auroc': 0.91431236, 'binary_precision': 0.6969697, 'binary_recall': 0.08812261, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5987  10
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 3
val acc:0.9853128790855408, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9618088603019714 / 0.9785873889923096
after epoch: 19,now: 2024-05-24 06:33:27.018371,epoch time: 0:28:26.412068,used: 9:41:24.861065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9872351, 'precision': 0.89599586, 'recall': 0.91131544, 'specificity': 0.91131544, 'f1': 0.90349793, 'auroc': 0.9935116, 'binary_precision': 0.7979071, 'binary_recall': 0.829932, 'binary_specificity': 0.99269885, 'binary_f1_score': 0.81360453}
confusion matrix:
       0     1
0  42013   309
1    250  1220
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.8887972, 'recall': 0.866586, 'specificity': 0.866586, 'f1': 0.8773371, 'auroc': 0.9806679, 'binary_precision': 0.78677684, 'binary_recall': 0.7402799, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7628205}
confusion matrix:
       0    1
0  18020  129
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8795425, 'recall': 0.56629944, 'specificity': 0.56629944, 'f1': 0.6051316, 'auroc': 0.9130432, 'binary_precision': 0.79545456, 'binary_recall': 0.13409962, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5988   9
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 4
val acc:0.9842486381530762, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9618088603019714 / 0.9785873889923096
after epoch: 20,now: 2024-05-24 07:01:50.002669,epoch time: 0:28:22.984298,used: 10:09:47.845363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9884454, 'precision': 0.89740855, 'recall': 0.9343094, 'specificity': 0.9343094, 'f1': 0.91496956, 'auroc': 0.9943949, 'binary_precision': 0.79913205, 'binary_recall': 0.87627465, 'binary_specificity': 0.9923442, 'binary_f1_score': 0.83592737}
confusion matrix:
       0     1
0  41997   324
1    182  1289
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.8983991, 'recall': 0.9085492, 'specificity': 0.9085492, 'f1': 0.90340483, 'auroc': 0.9838189, 'binary_precision': 0.8030303, 'binary_recall': 0.82426125, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.8135073}
confusion matrix:
       0    1
0  18019  130
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8311237, 'recall': 0.5864551, 'specificity': 0.5864551, 'f1': 0.63103294, 'auroc': 0.93821925, 'binary_precision': 0.6969697, 'binary_recall': 0.17624521, 'binary_specificity': 0.996665, 'binary_f1_score': 0.28134558}
confusion matrix:
      0   1
0  5977  20
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
better model found
persisted
after epoch: 21,now: 2024-05-24 07:30:12.615448,epoch time: 0:28:22.612779,used: 10:38:10.458142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9857737, 'precision': 0.87176895, 'recall': 0.9296905, 'specificity': 0.9296905, 'f1': 0.8984456, 'auroc': 0.9935647, 'binary_precision': 0.7481005, 'binary_recall': 0.8695652, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.80427265}
confusion matrix:
       0     1
0  41889   431
1    192  1280
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.8582742, 'recall': 0.8973445, 'specificity': 0.8973445, 'f1': 0.87670434, 'auroc': 0.9826654, 'binary_precision': 0.7234637, 'binary_recall': 0.80559874, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.76232517}
confusion matrix:
       0    1
0  17951  198
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82936835, 'recall': 0.54322755, 'specificity': 0.54322755, 'f1': 0.5680857, 'auroc': 0.9361825, 'binary_precision': 0.6969697, 'binary_recall': 0.08812261, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5987  10
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 22,now: 2024-05-24 07:58:19.816547,epoch time: 0:28:07.201099,used: 11:06:17.659241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9899297, 'precision': 0.9292176, 'recall': 0.91315275, 'specificity': 0.91315275, 'f1': 0.92101973, 'auroc': 0.9954517, 'binary_precision': 0.864311, 'binary_recall': 0.8308424, 'binary_specificity': 0.99546313, 'binary_f1_score': 0.8472463}
confusion matrix:
       0     1
0  42128   192
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9186458, 'recall': 0.87007594, 'specificity': 0.87007594, 'f1': 0.892745, 'auroc': 0.9824265, 'binary_precision': 0.84628975, 'binary_recall': 0.7449456, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7923904}
confusion matrix:
       0    1
0  18062   87
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7886378, 'recall': 0.5447264, 'specificity': 0.5447264, 'f1': 0.5696857, 'auroc': 0.91700447, 'binary_precision': 0.61538464, 'binary_recall': 0.09195402, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.16}
confusion matrix:
      0   1
0  5982  15
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 2
val acc:0.9866432547569275, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 23,now: 2024-05-24 08:26:42.831604,epoch time: 0:28:23.015057,used: 11:34:40.674298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.9107338, 'recall': 0.9376194, 'specificity': 0.9376194, 'f1': 0.9237147, 'auroc': 0.99598444, 'binary_precision': 0.8255888, 'binary_recall': 0.8817131, 'binary_specificity': 0.9935257, 'binary_f1_score': 0.8527285}
confusion matrix:
       0     1
0  42047   274
1    174  1297
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.88895434, 'recall': 0.9011926, 'specificity': 0.9011926, 'f1': 0.8949704, 'auroc': 0.9839201, 'binary_precision': 0.7846386, 'binary_recall': 0.8102644, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.7972456}
confusion matrix:
       0    1
0  18006  143
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8318612, 'recall': 0.5996149, 'specificity': 0.5996149, 'f1': 0.6477865, 'auroc': 0.9155644, 'binary_precision': 0.69736844, 'binary_recall': 0.20306513, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3145401}
confusion matrix:
      0   1
0  5974  23
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 3
val acc:0.9858982563018799, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 24,now: 2024-05-24 08:54:59.597821,epoch time: 0:28:16.766217,used: 12:02:57.440515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9889706, 'precision': 0.8949488, 'recall': 0.94993913, 'specificity': 0.94993913, 'f1': 0.9204974, 'auroc': 0.99624676, 'binary_precision': 0.79310346, 'binary_recall': 0.9081007, 'binary_specificity': 0.99177754, 'binary_f1_score': 0.84671533}
confusion matrix:
       0     1
0  41975   348
1    135  1334
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8633191, 'recall': 0.90834117, 'specificity': 0.90834117, 'f1': 0.88439393, 'auroc': 0.984342, 'binary_precision': 0.73278236, 'binary_recall': 0.8273717, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.7772097}
confusion matrix:
       0    1
0  17955  194
1    111  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7803109, 'recall': 0.5687969, 'specificity': 0.5687969, 'f1': 0.6043403, 'auroc': 0.9248168, 'binary_precision': 0.5967742, 'binary_recall': 0.14176245, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.22910216}
confusion matrix:
      0   1
0  5972  25
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 4
val acc:0.9837697148323059, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 25,now: 2024-05-24 09:23:51.274379,epoch time: 0:28:51.676558,used: 12:31:49.117073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9895643, 'precision': 0.90169764, 'recall': 0.94968396, 'specificity': 0.94968396, 'f1': 0.9242213, 'auroc': 0.99679065, 'binary_precision': 0.8066465, 'binary_recall': 0.9069294, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.8538536}
confusion matrix:
       0     1
0  42000   320
1    137  1335
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.8799925, 'recall': 0.89308596, 'specificity': 0.89308596, 'f1': 0.88641846, 'auroc': 0.98289955, 'binary_precision': 0.7672673, 'binary_recall': 0.7947123, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.7807487}
confusion matrix:
       0    1
0  17994  155
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8778784, 'recall': 0.5719632, 'specificity': 0.5719632, 'f1': 0.61343366, 'auroc': 0.9456785, 'binary_precision': 0.7916667, 'binary_recall': 0.14559387, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.24595469}
confusion matrix:
      0   1
0  5987  10
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 5
val acc:0.9847275614738464, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 26,now: 2024-05-24 09:52:15.492597,epoch time: 0:28:24.218218,used: 13:00:13.335291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98705244, 'precision': 0.87497926, 'recall': 0.95231867, 'specificity': 0.95231867, 'f1': 0.90970135, 'auroc': 0.9957492, 'binary_precision': 0.7529346, 'binary_recall': 0.9150815, 'binary_specificity': 0.9895558, 'binary_f1_score': 0.82612693}
confusion matrix:
       0     1
0  41878   442
1    125  1347
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.85327524, 'recall': 0.9169562, 'specificity': 0.9169562, 'f1': 0.8822293, 'auroc': 0.9819094, 'binary_precision': 0.7120419, 'binary_recall': 0.8460342, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.77327645}
confusion matrix:
       0    1
0  17929  220
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74602973, 'recall': 0.5313164, 'specificity': 0.5313164, 'f1': 0.54742575, 'auroc': 0.9170847, 'binary_precision': 0.53125, 'binary_recall': 0.0651341, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.11604095}
confusion matrix:
      0   1
0  5982  15
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 6
val acc:0.9830247163772583, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 27,now: 2024-05-24 10:21:13.440222,epoch time: 0:28:57.947625,used: 13:29:11.282916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99132264, 'precision': 0.9168464, 'recall': 0.9577536, 'specificity': 0.9577536, 'f1': 0.9362626, 'auroc': 0.99729264, 'binary_precision': 0.83641976, 'binary_recall': 0.9217687, 'binary_specificity': 0.9937385, 'binary_f1_score': 0.8770227}
confusion matrix:
       0     1
0  42057   265
1    115  1355
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.8787225, 'recall': 0.90761244, 'specificity': 0.90761244, 'f1': 0.89258885, 'auroc': 0.9833102, 'binary_precision': 0.76368874, 'binary_recall': 0.82426125, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.79281974}
confusion matrix:
       0    1
0  17985  164
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8277662, 'recall': 0.6276836, 'specificity': 0.6276836, 'f1': 0.67967534, 'auroc': 0.928681, 'binary_precision': 0.68686867, 'binary_recall': 0.2605364, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.37777776}
confusion matrix:
      0   1
0  5966  31
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 7
val acc:0.9852597117424011, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 28,now: 2024-05-24 10:51:30.902621,epoch time: 0:30:17.462399,used: 13:59:28.745315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99045485, 'precision': 0.90871143, 'recall': 0.95467806, 'specificity': 0.95467806, 'f1': 0.9303664, 'auroc': 0.9975227, 'binary_precision': 0.82034105, 'binary_recall': 0.9163265, 'binary_specificity': 0.99302965, 'binary_f1_score': 0.86568123}
confusion matrix:
       0     1
0  42027   295
1    123  1347
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.86853844, 'recall': 0.91475487, 'specificity': 0.91475487, 'f1': 0.8901566, 'auroc': 0.98240626, 'binary_precision': 0.74277854, 'binary_recall': 0.83981335, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.78832114}
confusion matrix:
       0    1
0  17962  187
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8650768, 'recall': 0.65492034, 'specificity': 0.65492034, 'f1': 0.7137839, 'auroc': 0.9452852, 'binary_precision': 0.7592593, 'binary_recall': 0.31417623, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.44444442}
confusion matrix:
      0   1
0  5971  26
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 8
val acc:0.9845678806304932, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 29,now: 2024-05-24 11:31:29.918287,epoch time: 0:39:59.015666,used: 14:39:27.760981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99219036, 'precision': 0.9257134, 'recall': 0.9602227, 'specificity': 0.9602227, 'f1': 0.94224, 'auroc': 0.9980285, 'binary_precision': 0.85401005, 'binary_recall': 0.92595106, 'binary_specificity': 0.9944943, 'binary_f1_score': 0.8885267}
confusion matrix:
       0     1
0  42087   233
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.88868845, 'recall': 0.909636, 'specificity': 0.909636, 'f1': 0.8988632, 'auroc': 0.9809277, 'binary_precision': 0.78350514, 'binary_recall': 0.8273717, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.80484116}
confusion matrix:
       0    1
0  18002  147
1    111  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7788737, 'recall': 0.5706292, 'specificity': 0.5706292, 'f1': 0.6067106, 'auroc': 0.9089055, 'binary_precision': 0.59375, 'binary_recall': 0.14559387, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.23384614}
confusion matrix:
      0   1
0  5971  26
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20754611.png
early stop counter: 9
val acc:0.9862707257270813, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9624480605125427 / 0.9785873889923096
after epoch: 30,now: 2024-05-24 12:17:51.351972,epoch time: 0:46:21.433685,used: 15:25:49.194666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_23_20_52_02_seed_0_20754611
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:25:49.194666 at 2024-05-24 12:17:51.351972
persisted model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.85000813, 'recall': 0.60369647, 'specificity': 0.60369647, 'f1': 0.654413, 'auroc': 0.94225335, 'binary_precision': 0.73333335, 'binary_recall': 0.21072797, 'binary_specificity': 0.996665, 'binary_f1_score': 0.32738096}
confusion matrix:
      0   1
0  5977  20
1   206  55
oracle model performance metric: 

scalar performance:
{'acc': 0.97810805, 'precision': 0.90967023, 'recall': 0.7925179, 'specificity': 0.7925179, 'f1': 0.84039265, 'auroc': 0.93209505, 'binary_precision': 0.8369565, 'binary_recall': 0.5900383, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.69213486}
confusion matrix:
      0    1
0  5967   30
1   107  154
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dial_irm/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dial_irm/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491419 KiB |   1765 MiB | 771361 GiB | 771360 GiB |
|       from large pool | 401600 KiB |   1695 MiB | 767879 GiB | 767878 GiB |
|       from small pool |  89819 KiB |    125 MiB |   3482 GiB |   3482 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 491419 KiB |   1765 MiB | 771361 GiB | 771360 GiB |
|       from large pool | 401600 KiB |   1695 MiB | 767879 GiB | 767878 GiB |
|       from small pool |  89819 KiB |    125 MiB |   3482 GiB |   3482 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1739 MiB | 765130 GiB | 765130 GiB |
|       from large pool | 387840 KiB |   1670 MiB | 761667 GiB | 761667 GiB |
|       from small pool |  88733 KiB |    124 MiB |   3462 GiB |   3462 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2038 MiB |   2038 MiB |   2038 MiB |      0 B   |
|       from large pool |   1912 MiB |   1912 MiB |   1912 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 381028 KiB | 448446 KiB | 460866 GiB | 460866 GiB |
|       from large pool | 374592 KiB | 446400 KiB | 456969 GiB | 456969 GiB |
|       from small pool |   6436 KiB |  14672 KiB |   3897 GiB |   3897 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  130640 K  |  130636 K  |
|       from large pool |      87    |     177    |   48524 K  |   48524 K  |
|       from small pool |    3642    |    6612    |   82116 K  |   82112 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  130640 K  |  130636 K  |
|       from large pool |      87    |     177    |   48524 K  |   48524 K  |
|       from small pool |    3642    |    6612    |   82116 K  |   82112 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     112    |     112    |       0    |
|       from large pool |      49    |      49    |      49    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    2764    |   57982 K  |   57982 K  |
|       from large pool |      18    |      36    |   21960 K  |   21960 K  |
|       from small pool |      33    |    2746    |   36022 K  |   36022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1765 MiB | 771361 GiB | 771361 GiB |
|       from large pool |  16640 KiB |   1695 MiB | 767879 GiB | 767879 GiB |
|       from small pool |      0 KiB |    125 MiB |   3482 GiB |   3482 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1765 MiB | 771361 GiB | 771361 GiB |
|       from large pool |  16640 KiB |   1695 MiB | 767879 GiB | 767879 GiB |
|       from small pool |      0 KiB |    125 MiB |   3482 GiB |   3482 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1739 MiB | 765130 GiB | 765130 GiB |
|       from large pool |  16640 KiB |   1670 MiB | 761667 GiB | 761667 GiB |
|       from small pool |      0 KiB |    124 MiB |   3462 GiB |   3462 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    852 MiB |   2038 MiB |   2038 MiB |   1186 MiB |
|       from large pool |    758 MiB |   1912 MiB |   1912 MiB |   1154 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB | 485690 KiB | 460867 GiB | 460867 GiB |
|       from large pool |  50944 KiB | 468800 KiB | 456969 GiB | 456969 GiB |
|       from small pool |      0 KiB |  29381 KiB |   3897 GiB |   3897 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  130640 K  |  130640 K  |
|       from large pool |       2    |     177    |   48524 K  |   48524 K  |
|       from small pool |       0    |    6612    |   82116 K  |   82116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  130640 K  |  130640 K  |
|       from large pool |       2    |     177    |   48524 K  |   48524 K  |
|       from small pool |       0    |    6612    |   82116 K  |   82116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     112    |     112    |      42    |
|       from large pool |      23    |      49    |      49    |      26    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   57983 K  |   57983 K  |
|       from large pool |       4    |      36    |   21960 K  |   21960 K  |
|       from small pool |       0    |    2746    |   36023 K  |   36023 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 24 12:21:05 2024]
Finished job 0.
1 of 1 steps (100%) done
