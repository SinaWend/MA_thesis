Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892

 Experiment start at: 2024-05-27 19:33:07.143594
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.72647357, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7565746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.63344574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 20:01:11.476489,epoch time: 0:28:04.332895,used: 0:28:04.332895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.48320392, 'recall': 0.49997637, 'specificity': 0.49997637, 'f1': 0.4914471, 'auroc': 0.78184164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42319  2
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.7967037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.66251373, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-05-27 20:27:58.401474,epoch time: 0:26:46.924985,used: 0:54:51.257880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.7801311, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7907859, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.671535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-05-27 20:54:26.184088,epoch time: 0:26:27.782614,used: 1:21:19.040494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.48318598, 'recall': 0.49977553, 'specificity': 0.49977553, 'f1': 0.49134073, 'auroc': 0.80209947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42301  19
1   1472   0
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.48288164, 'recall': 0.49969694, 'specificity': 0.49969694, 'f1': 0.4911454, 'auroc': 0.80881786, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18138  11
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.673379, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 3
val acc:0.9651979804039001, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-05-27 21:21:14.071332,epoch time: 0:26:47.887244,used: 1:48:06.927738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.8568486, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8643904, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8000073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-05-27 21:48:32.197984,epoch time: 0:27:18.126652,used: 2:15:25.054390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96449125, 'precision': 0.7192736, 'recall': 0.66163754, 'specificity': 0.66163754, 'f1': 0.6855958, 'auroc': 0.9162899, 'binary_precision': 0.46139535, 'binary_recall': 0.33695653, 'binary_specificity': 0.9863185, 'binary_f1_score': 0.38947782}
confusion matrix:
       0    1
0  41741  579
1    976  496
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.728918, 'recall': 0.74433136, 'specificity': 0.74433136, 'f1': 0.7363428, 'auroc': 0.9300127, 'binary_precision': 0.4752907, 'binary_recall': 0.5085537, 'binary_specificity': 0.9801091, 'binary_f1_score': 0.49135986}
confusion matrix:
       0    1
0  17788  361
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91002303, 'recall': 0.5893713, 'specificity': 0.5893713, 'f1': 0.6396358, 'auroc': 0.87459266, 'binary_precision': 0.8545455, 'binary_recall': 0.18007663, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5989   8
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
new oracle model saved
early stop counter: 5
val acc:0.9639740586280823, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9645254015922546
after epoch: 6,now: 2024-05-27 22:15:07.682052,epoch time: 0:26:35.484068,used: 2:42:00.538458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.8363922, 'recall': 0.5247867, 'specificity': 0.5247867, 'f1': 0.5386528, 'auroc': 0.9241518, 'binary_precision': 0.7047619, 'binary_recall': 0.050305914, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.09390863}
confusion matrix:
       0   1
0  42290  31
1   1397  74
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.96430326, 'recall': 0.5194126, 'specificity': 0.5194126, 'f1': 0.5289851, 'auroc': 0.93562186, 'binary_precision': 0.96153843, 'binary_recall': 0.038880248, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.07473841}
confusion matrix:
       0   1
0  18148   1
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.8880428, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
better model found
persisted
after epoch: 7,now: 2024-05-27 22:41:42.196338,epoch time: 0:26:34.514286,used: 3:08:35.052744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96741414, 'precision': 0.9068741, 'recall': 0.5185639, 'specificity': 0.5185639, 'f1': 0.527492, 'auroc': 0.9063371, 'binary_precision': 0.84615386, 'binary_recall': 0.03736413, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.07156798}
confusion matrix:
       0   1
0  42310  10
1   1417  55
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.8674534, 'recall': 0.5253855, 'specificity': 0.5253855, 'f1': 0.5397034, 'auroc': 0.9198179, 'binary_precision': 0.76744187, 'binary_recall': 0.051321927, 'binary_specificity': 0.999449, 'binary_f1_score': 0.09620991}
confusion matrix:
       0   1
0  18139  10
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8436363, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 1
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 8,now: 2024-05-27 23:08:27.348133,epoch time: 0:26:45.151795,used: 3:35:20.204539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.73551345, 'recall': 0.53443706, 'specificity': 0.53443706, 'f1': 0.55390084, 'auroc': 0.8968018, 'binary_precision': 0.50239235, 'binary_recall': 0.07133152, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.12492565}
confusion matrix:
       0    1
0  42216  104
1   1367  105
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.77814174, 'recall': 0.5432215, 'specificity': 0.5432215, 'f1': 0.56853175, 'auroc': 0.9110214, 'binary_precision': 0.58762884, 'binary_recall': 0.08864697, 'binary_specificity': 0.997796, 'binary_f1_score': 0.15405406}
confusion matrix:
       0   1
0  18109  40
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.861723, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 2
val acc:0.9666879773139954, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 9,now: 2024-05-27 23:34:51.729124,epoch time: 0:26:24.380991,used: 4:01:44.585530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9169547, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.92973125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.87671244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 10,now: 2024-05-28 00:01:21.753280,epoch time: 0:26:30.024156,used: 4:28:14.609686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9006741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9264057, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.88761747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 11,now: 2024-05-28 00:27:50.194571,epoch time: 0:26:28.441291,used: 4:54:43.050977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.87232316, 'recall': 0.5070671, 'specificity': 0.5070671, 'f1': 0.505562, 'auroc': 0.92394185, 'binary_precision': 0.7777778, 'binary_recall': 0.0142760025, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.02803738}
confusion matrix:
       0   1
0  42315   6
1   1450  21
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.9538905, 'recall': 0.51241416, 'specificity': 0.51241416, 'f1': 0.5157385, 'auroc': 0.9376764, 'binary_precision': 0.9411765, 'binary_recall': 0.02488336, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.04848485}
confusion matrix:
       0   1
0  18148   1
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89691603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 5
val acc:0.9665815234184265, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 12,now: 2024-05-28 00:54:33.774727,epoch time: 0:26:43.580156,used: 5:21:26.631133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96729994, 'precision': 0.7482569, 'recall': 0.71915466, 'specificity': 0.71915466, 'f1': 0.7327008, 'auroc': 0.9331249, 'binary_precision': 0.51545596, 'binary_recall': 0.453125, 'binary_specificity': 0.9851843, 'binary_f1_score': 0.4822849}
confusion matrix:
       0    1
0  41693  627
1    805  667
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7334795, 'recall': 0.721548, 'specificity': 0.721548, 'f1': 0.72733885, 'auroc': 0.94168806, 'binary_precision': 0.48604268, 'binary_recall': 0.46034214, 'binary_specificity': 0.9827539, 'binary_f1_score': 0.47284347}
confusion matrix:
       0    1
0  17836  313
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.83233297, 'recall': 0.578959, 'specificity': 0.578959, 'f1': 0.621124, 'auroc': 0.90088916, 'binary_precision': 0.7, 'binary_recall': 0.16091955, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5979  18
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 6
val acc:0.9648786783218384, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9581335783004761 / 0.9645254015922546
after epoch: 13,now: 2024-05-28 01:21:25.415250,epoch time: 0:26:51.640523,used: 5:48:18.271656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.7398053, 'recall': 0.7331896, 'specificity': 0.7331896, 'f1': 0.73644584, 'auroc': 0.9384124, 'binary_precision': 0.49755073, 'binary_recall': 0.48334467, 'binary_specificity': 0.98303443, 'binary_f1_score': 0.49034485}
confusion matrix:
       0    1
0  41603  718
1    760  711
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.75471216, 'recall': 0.71086955, 'specificity': 0.71086955, 'f1': 0.73050404, 'auroc': 0.9490283, 'binary_precision': 0.5293006, 'binary_recall': 0.43545878, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.47781572}
confusion matrix:
       0    1
0  17900  249
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.905317, 'recall': 0.5931194, 'specificity': 0.5931194, 'f1': 0.64454544, 'auroc': 0.9107755, 'binary_precision': 0.8448276, 'binary_recall': 0.18773946, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.30721006}
confusion matrix:
      0   1
0  5988   9
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-05-28 01:47:56.665731,epoch time: 0:26:31.250481,used: 6:14:49.522137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.8197681, 'recall': 0.53675157, 'specificity': 0.53675157, 'f1': 0.5590467, 'auroc': 0.9352282, 'binary_precision': 0.6707317, 'binary_recall': 0.07477906, 'binary_specificity': 0.99872404, 'binary_f1_score': 0.13455658}
confusion matrix:
       0    1
0  42267   54
1   1361  110
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.8472914, 'recall': 0.56060433, 'specificity': 0.56060433, 'f1': 0.5969896, 'auroc': 0.94501567, 'binary_precision': 0.72477067, 'binary_recall': 0.12286159, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.21010639}
confusion matrix:
       0   1
0  18119  30
1    564  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8931741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
better model found
persisted
after epoch: 15,now: 2024-05-28 02:14:22.844336,epoch time: 0:26:26.178605,used: 6:41:15.700742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9697205, 'precision': 0.7809152, 'recall': 0.66641444, 'specificity': 0.66641444, 'f1': 0.7076739, 'auroc': 0.9390044, 'binary_precision': 0.5844005, 'binary_recall': 0.34126446, 'binary_specificity': 0.99156445, 'binary_f1_score': 0.43090132}
confusion matrix:
       0    1
0  41964  357
1    969  502
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.78549296, 'recall': 0.6366078, 'specificity': 0.6366078, 'f1': 0.6824929, 'auroc': 0.9501957, 'binary_precision': 0.5960265, 'binary_recall': 0.2799378, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3809524}
confusion matrix:
       0    1
0  18027  122
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.9107394, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
better model found
persisted
after epoch: 16,now: 2024-05-28 02:41:14.229899,epoch time: 0:26:51.385563,used: 7:08:07.086305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.7643015, 'recall': 0.62546074, 'specificity': 0.62546074, 'f1': 0.66790646, 'auroc': 0.9365493, 'binary_precision': 0.5539359, 'binary_recall': 0.2581522, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.35217795}
confusion matrix:
       0    1
0  42014  306
1   1092  380
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7728554, 'recall': 0.58177733, 'specificity': 0.58177733, 'f1': 0.62159723, 'auroc': 0.9448223, 'binary_precision': 0.5744681, 'binary_recall': 0.16796267, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.25992778}
confusion matrix:
       0    1
0  18069   80
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.8851485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 1
val acc:0.9672732949256897, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 17,now: 2024-05-28 03:07:40.366556,epoch time: 0:26:26.136657,used: 7:34:33.222962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96873856, 'precision': 0.76582164, 'recall': 0.675638, 'specificity': 0.675638, 'f1': 0.7106215, 'auroc': 0.94233024, 'binary_precision': 0.55359, 'binary_recall': 0.36141303, 'binary_specificity': 0.989863, 'binary_f1_score': 0.43732017}
confusion matrix:
       0    1
0  41891  429
1    940  532
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.77803284, 'recall': 0.6447207, 'specificity': 0.6447207, 'f1': 0.6884446, 'auroc': 0.9450406, 'binary_precision': 0.5805471, 'binary_recall': 0.2970451, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.39300412}
confusion matrix:
       0    1
0  18011  138
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.81413656, 'recall': 0.5412285, 'specificity': 0.5412285, 'f1': 0.5646025, 'auroc': 0.9121221, 'binary_precision': 0.6666667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14965987}
confusion matrix:
      0   1
0  5986  11
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 2
val acc:0.9686036705970764, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 18,now: 2024-05-28 03:34:35.103865,epoch time: 0:26:54.737309,used: 8:01:27.960271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.86361986, 'recall': 0.5127746, 'specificity': 0.5127746, 'f1': 0.51658857, 'auroc': 0.9368481, 'binary_precision': 0.76, 'binary_recall': 0.025832767, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.049967125}
confusion matrix:
       0   1
0  42309  12
1   1433  38
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.8319595, 'recall': 0.5176094, 'specificity': 0.5176094, 'f1': 0.525489, 'auroc': 0.9517258, 'binary_precision': 0.6969697, 'binary_recall': 0.035769828, 'binary_specificity': 0.999449, 'binary_f1_score': 0.06804734}
confusion matrix:
       0   1
0  18139  10
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9129947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 3
val acc:0.9664750695228577, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 19,now: 2024-05-28 04:01:00.781849,epoch time: 0:26:25.677984,used: 8:27:53.638255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9677567, 'precision': 0.75356305, 'recall': 0.67786586, 'specificity': 0.67786586, 'f1': 0.7083965, 'auroc': 0.93604165, 'binary_precision': 0.52889323, 'binary_recall': 0.3670972, 'binary_specificity': 0.98863447, 'binary_f1_score': 0.43338683}
confusion matrix:
       0    1
0  41840  481
1    931  540
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7578815, 'recall': 0.69147825, 'specificity': 0.69147825, 'f1': 0.7192625, 'auroc': 0.9475752, 'binary_precision': 0.5369979, 'binary_recall': 0.39502332, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.45519713}
confusion matrix:
       0    1
0  17930  219
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.9030787, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 4
val acc:0.9676458239555359, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 20,now: 2024-05-28 04:27:27.859312,epoch time: 0:26:27.077463,used: 8:54:20.715718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96876144, 'precision': 0.76701456, 'recall': 0.6694205, 'specificity': 0.6694205, 'f1': 0.70625657, 'auroc': 0.92006326, 'binary_precision': 0.5563991, 'binary_recall': 0.34850544, 'binary_specificity': 0.9903355, 'binary_f1_score': 0.4285714}
confusion matrix:
       0    1
0  41911  409
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75788695, 'recall': 0.675672, 'specificity': 0.675672, 'f1': 0.7081884, 'auroc': 0.93041253, 'binary_precision': 0.53810626, 'binary_recall': 0.3623639, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.43308553}
confusion matrix:
       0    1
0  17949  200
1    410  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77133363, 'recall': 0.5129931, 'specificity': 0.5129931, 'f1': 0.5150635, 'auroc': 0.885296, 'binary_precision': 0.5833333, 'binary_recall': 0.026819924, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.05128205}
confusion matrix:
      0  1
0  5992  5
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 5
val acc:0.967539370059967, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 21,now: 2024-05-28 04:54:16.207939,epoch time: 0:26:48.348627,used: 9:21:09.064345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.967848, 'precision': 0.8138489, 'recall': 0.5443614, 'specificity': 0.5443614, 'f1': 0.5712558, 'auroc': 0.94121146, 'binary_precision': 0.65841585, 'binary_recall': 0.09035326, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.15890083}
confusion matrix:
       0    1
0  42251   69
1   1339  133
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.8124709, 'recall': 0.519082, 'specificity': 0.519082, 'f1': 0.5281613, 'auroc': 0.95055234, 'binary_precision': 0.65789473, 'binary_recall': 0.038880248, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.07342144}
confusion matrix:
       0   1
0  18136  13
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9117506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 6
val acc:0.966421902179718, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 22,now: 2024-05-28 05:20:55.114151,epoch time: 0:26:38.906212,used: 9:47:47.970557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96787083, 'precision': 0.7526281, 'recall': 0.76403886, 'specificity': 0.76403886, 'f1': 0.7581933, 'auroc': 0.9442329, 'binary_precision': 0.5210902, 'binary_recall': 0.5455163, 'binary_specificity': 0.9825614, 'binary_f1_score': 0.5330236}
confusion matrix:
       0    1
0  41582  738
1    669  803
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.77087843, 'recall': 0.69283444, 'specificity': 0.69283444, 'f1': 0.7246342, 'auroc': 0.95062375, 'binary_precision': 0.5629139, 'binary_recall': 0.39657855, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.46532845}
confusion matrix:
       0    1
0  17951  198
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.83100665, 'recall': 0.56954724, 'specificity': 0.56954724, 'f1': 0.6079999, 'auroc': 0.90823656, 'binary_precision': 0.6981132, 'binary_recall': 0.14176245, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2356688}
confusion matrix:
      0   1
0  5981  16
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 7
val acc:0.9688165187835693, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 23,now: 2024-05-28 05:47:33.709480,epoch time: 0:26:38.595329,used: 10:14:26.565886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9679622, 'precision': 0.75590825, 'recall': 0.68179345, 'specificity': 0.68179345, 'f1': 0.711938, 'auroc': 0.93854487, 'binary_precision': 0.53333336, 'binary_recall': 0.375, 'binary_specificity': 0.98858696, 'binary_f1_score': 0.440367}
confusion matrix:
       0    1
0  41837  483
1    920  552
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75694287, 'recall': 0.688423, 'specificity': 0.688423, 'f1': 0.7168631, 'auroc': 0.9491651, 'binary_precision': 0.5353319, 'binary_recall': 0.3888025, 'binary_specificity': 0.9880434, 'binary_f1_score': 0.45045045}
confusion matrix:
       0    1
0  17932  217
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.89614487, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 8
val acc:0.967539370059967, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 24,now: 2024-05-28 06:14:17.305785,epoch time: 0:26:43.596305,used: 10:41:10.162191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9677567, 'precision': 0.8237209, 'recall': 0.5380848, 'specificity': 0.5380848, 'f1': 0.56129754, 'auroc': 0.9434458, 'binary_precision': 0.6785714, 'binary_recall': 0.07744565, 'binary_specificity': 0.998724, 'binary_f1_score': 0.13902439}
confusion matrix:
       0    1
0  42266   54
1   1358  114
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.98322594, 'recall': 0.5101089, 'specificity': 0.5101089, 'f1': 0.511287, 'auroc': 0.9488125, 'binary_precision': 1.0, 'binary_recall': 0.02021773, 'binary_specificity': 1.0, 'binary_f1_score': 0.039634146}
confusion matrix:
       0   1
0  18149   0
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9013562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 9
val acc:0.9664750695228577, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 25,now: 2024-05-28 06:41:06.900332,epoch time: 0:26:49.594547,used: 11:07:59.756738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9686929, 'precision': 0.8096514, 'recall': 0.5736502, 'specificity': 0.5736502, 'f1': 0.6139052, 'auroc': 0.9365716, 'binary_precision': 0.6480938, 'binary_recall': 0.15013587, 'binary_specificity': 0.9971645, 'binary_f1_score': 0.24379481}
confusion matrix:
       0    1
0  42200  120
1   1251  221
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.80548865, 'recall': 0.5464972, 'specificity': 0.5464972, 'f1': 0.5742967, 'auroc': 0.949134, 'binary_precision': 0.6421053, 'binary_recall': 0.09486781, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.16531166}
confusion matrix:
       0   1
0  18115  34
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.91082597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 10
val acc:0.9672200679779053, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9646852016448975
after epoch: 26,now: 2024-05-28 07:07:40.007969,epoch time: 0:26:33.107637,used: 11:34:32.864375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7410389, 'recall': 0.80240136, 'specificity': 0.80240136, 'f1': 0.76783574, 'auroc': 0.9391327, 'binary_precision': 0.49517167, 'binary_recall': 0.62703806, 'binary_specificity': 0.97776467, 'binary_f1_score': 0.55335724}
confusion matrix:
       0    1
0  41379  941
1    549  923
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7459438, 'recall': 0.74409854, 'specificity': 0.74409854, 'f1': 0.7450173, 'auroc': 0.9480483, 'binary_precision': 0.50940436, 'binary_recall': 0.5054432, 'binary_specificity': 0.9827539, 'binary_f1_score': 0.5074161}
confusion matrix:
       0    1
0  17836  313
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.83234197, 'recall': 0.6371788, 'specificity': 0.6371788, 'f1': 0.69040006, 'auroc': 0.9118397, 'binary_precision': 0.6952381, 'binary_recall': 0.27969348, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3989071}
confusion matrix:
      0   1
0  5965  32
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
new oracle model saved
early stop counter: 11
val acc:0.966421902179718, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9648450016975403
after epoch: 27,now: 2024-05-28 07:34:13.048772,epoch time: 0:26:33.040803,used: 12:01:05.905178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.7415799, 'recall': 0.78206325, 'specificity': 0.78206325, 'f1': 0.7600706, 'auroc': 0.9419652, 'binary_precision': 0.4976852, 'binary_recall': 0.58463633, 'binary_specificity': 0.9794901, 'binary_f1_score': 0.53766805}
confusion matrix:
       0    1
0  41453  868
1    611  860
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7500012, 'recall': 0.74662423, 'specificity': 0.74662423, 'f1': 0.74829996, 'auroc': 0.952644, 'binary_precision': 0.51735014, 'binary_recall': 0.5101089, 'binary_specificity': 0.9831396, 'binary_f1_score': 0.513704}
confusion matrix:
       0    1
0  17843  306
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.87964773, 'recall': 0.68740404, 'specificity': 0.68740404, 'f1': 0.7480227, 'auroc': 0.91994596, 'binary_precision': 0.78571427, 'binary_recall': 0.37931034, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.51162785}
confusion matrix:
      0   1
0  5970  27
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
new oracle model saved
early stop counter: 12
val acc:0.9669540524482727, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9697986841201782
after epoch: 28,now: 2024-05-28 08:01:04.041684,epoch time: 0:26:50.992912,used: 12:27:56.898090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96921813, 'precision': 0.7644362, 'recall': 0.7386625, 'specificity': 0.7386625, 'f1': 0.7508197, 'auroc': 0.94333696, 'binary_precision': 0.54648525, 'binary_recall': 0.49150237, 'binary_specificity': 0.9858226, 'binary_f1_score': 0.5175376}
confusion matrix:
       0    1
0  41721  600
1    748  723
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7617612, 'recall': 0.7202834, 'specificity': 0.7202834, 'f1': 0.73904824, 'auroc': 0.9528364, 'binary_precision': 0.54275095, 'binary_recall': 0.4541213, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.49449617}
confusion matrix:
       0    1
0  17903  246
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.86963034, 'recall': 0.5397296, 'specificity': 0.5397296, 'f1': 0.5628578, 'auroc': 0.9079829, 'binary_precision': 0.7777778, 'binary_recall': 0.08045977, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.14583334}
confusion matrix:
      0   1
0  5991   6
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 13
val acc:0.9682311415672302, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9697986841201782
after epoch: 29,now: 2024-05-28 08:27:47.299108,epoch time: 0:26:43.257424,used: 12:54:40.155514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.8004537, 'recall': 0.59448254, 'specificity': 0.59448254, 'f1': 0.63969415, 'auroc': 0.9463163, 'binary_precision': 0.6283186, 'binary_recall': 0.19293478, 'binary_specificity': 0.9960303, 'binary_f1_score': 0.2952183}
confusion matrix:
       0    1
0  42152  168
1   1188  284
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.7912369, 'recall': 0.5836081, 'specificity': 0.5836081, 'f1': 0.62545574, 'auroc': 0.94754684, 'binary_precision': 0.6111111, 'binary_recall': 0.1710731, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.2673147}
confusion matrix:
       0    1
0  18079   70
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9099995, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897892.png
early stop counter: 14
val acc:0.9679118990898132, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9597315192222595 / 0.9697986841201782
after epoch: 30,now: 2024-05-28 08:54:21.147062,epoch time: 0:26:33.847954,used: 13:21:14.003468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_07_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:21:14.003468 at 2024-05-28 08:54:21.147062
persisted model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.9093332, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
oracle model performance metric: 

scalar performance:
{'acc': 0.9715564, 'precision': 0.9058223, 'recall': 0.6956505, 'specificity': 0.6956505, 'f1': 0.7608932, 'auroc': 0.9196311, 'binary_precision': 0.83739835, 'binary_recall': 0.394636, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5364584}
confusion matrix:
      0    1
0  5977   20
1   158  103
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14476 MiB |  14476 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473243 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197544 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94914 K  |   94911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197544 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94914 K  |   94911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2805    |  132524 K  |  132524 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      43    |    2765    |   48697 K  |   48697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197544 K  |  197544 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94914 K  |   94914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197544 K  |  197544 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94914 K  |   94914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  132525 K  |  132525 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   48699 K  |   48699 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197544 K  |  197544 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94914 K  |   94914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197544 K  |  197544 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94914 K  |   94914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  132525 K  |  132525 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   48699 K  |   48699 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892

 Experiment start at: 2024-05-28 09:03:34.346126
before training, model accuracy: 0.701374351978302
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.6630962, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.6853638, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5170154, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 09:33:04.611048,epoch time: 0:29:30.264922,used: 0:29:30.264922,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.67054695, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.6944825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.4773121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 2,now: 2024-05-28 10:00:05.846298,epoch time: 0:27:01.235250,used: 0:56:31.500172,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.69135606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7099184, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.46142966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 2
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 3,now: 2024-05-28 10:27:03.896668,epoch time: 0:26:58.050370,used: 1:23:29.550542,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.70269525, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7287718, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.47045046, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 3
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 4,now: 2024-05-28 10:54:17.707738,epoch time: 0:27:13.811070,used: 1:50:43.361612,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.7829183, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.812234, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5666451, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 4
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 5,now: 2024-05-28 11:21:22.444794,epoch time: 0:27:04.737056,used: 2:17:48.098668,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8699106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.89240015, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.77044797, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 5
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 6,now: 2024-05-28 11:48:08.280396,epoch time: 0:26:45.835602,used: 2:44:33.934270,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95331186, 'precision': 0.95443225, 'recall': 0.5128827, 'specificity': 0.5128827, 'f1': 0.51318, 'auroc': 0.8996845, 'binary_precision': 0.95555556, 'binary_recall': 0.025825826, 'binary_specificity': 0.9999396, 'binary_f1_score': 0.050292403}
confusion matrix:
       0   1
0  33117   2
1   1622  43
---- Validation: 
scalar performance:
{'acc': 0.95233315, 'precision': 0.976141, 'recall': 0.510989, 'specificity': 0.510989, 'f1': 0.5092843, 'auroc': 0.91517943, 'binary_precision': 1.0, 'binary_recall': 0.021978023, 'binary_specificity': 1.0, 'binary_f1_score': 0.043010753}
confusion matrix:
       0   1
0  14209   0
1    712  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.81880134, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 7,now: 2024-05-28 12:15:16.837281,epoch time: 0:27:08.556885,used: 3:11:42.491155,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9516732, 'precision': 0.7320567, 'recall': 0.6891334, 'specificity': 0.6891334, 'f1': 0.70804346, 'auroc': 0.90054893, 'binary_precision': 0.4940476, 'binary_recall': 0.3987988, 'binary_specificity': 0.979468, 'binary_f1_score': 0.44134265}
confusion matrix:
       0    1
0  32439  680
1   1001  664
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.74833703, 'recall': 0.6763074, 'specificity': 0.6763074, 'f1': 0.7052571, 'auroc': 0.91546863, 'binary_precision': 0.5284872, 'binary_recall': 0.3695055, 'binary_specificity': 0.9831093, 'binary_f1_score': 0.43492317}
confusion matrix:
       0    1
0  13969  240
1    459  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99371725, 'precision': 0.5637228, 'recall': 0.53568006, 'specificity': 0.53568006, 'f1': 0.5455936, 'auroc': 0.8000908, 'binary_precision': 0.13157895, 'binary_recall': 0.073529415, 'binary_specificity': 0.9978307, 'binary_f1_score': 0.094339624}
confusion matrix:
       0   1
0  15179  33
1     63   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 8,now: 2024-05-28 12:42:24.391285,epoch time: 0:27:07.554004,used: 3:38:50.045159,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.90600073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.91177726, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8265816, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9532034397125244, corresponding to test acc:                         0.9937172532081604 / 0.995549738407135
after epoch: 9,now: 2024-05-28 13:09:18.709300,epoch time: 0:26:54.318015,used: 4:05:44.363174,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9514719, 'precision': 0.7214581, 'recall': 0.589777, 'specificity': 0.589777, 'f1': 0.62365633, 'auroc': 0.91448724, 'binary_precision': 0.48244274, 'binary_recall': 0.18978979, 'binary_specificity': 0.98976415, 'binary_f1_score': 0.2724138}
confusion matrix:
       0    1
0  32780  339
1   1349  316
---- Validation: 
scalar performance:
{'acc': 0.9517306, 'precision': 0.73630416, 'recall': 0.5940802, 'specificity': 0.5940802, 'f1': 0.6302264, 'auroc': 0.9266813, 'binary_precision': 0.5124555, 'binary_recall': 0.1978022, 'binary_specificity': 0.99035823, 'binary_f1_score': 0.28543112}
confusion matrix:
       0    1
0  14072  137
1    584  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956152, 'precision': 0.7581973, 'recall': 0.5951938, 'specificity': 0.5951938, 'f1': 0.6386854, 'auroc': 0.82165325, 'binary_precision': 0.52, 'binary_recall': 0.19117647, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.2795699}
confusion matrix:
       0   1
0  15200  12
1     55  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
new oracle model saved
early stop counter: 2
val acc:0.9517306089401245, best validation acc: 0.9532034397125244, corresponding to test acc:                         0.9937172532081604 / 0.9956151843070984
after epoch: 10,now: 2024-05-28 13:36:26.068695,epoch time: 0:27:07.359395,used: 4:32:51.722569,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9489995, 'precision': 0.7268223, 'recall': 0.782702, 'specificity': 0.782702, 'f1': 0.7511164, 'auroc': 0.915529, 'binary_precision': 0.47408465, 'binary_recall': 0.5987988, 'binary_specificity': 0.96660525, 'binary_f1_score': 0.5291932}
confusion matrix:
       0     1
0  32013  1106
1    668   997
---- Validation: 
scalar performance:
{'acc': 0.9548102, 'precision': 0.75668037, 'recall': 0.74426925, 'specificity': 0.74426925, 'f1': 0.7502956, 'auroc': 0.9268466, 'binary_precision': 0.5383502, 'binary_recall': 0.510989, 'binary_specificity': 0.97754943, 'binary_f1_score': 0.52431285}
confusion matrix:
       0    1
0  13890  319
1    356  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99234295, 'precision': 0.6075828, 'recall': 0.6374708, 'specificity': 0.6374708, 'f1': 0.6206566, 'auroc': 0.82015014, 'binary_precision': 0.21839081, 'binary_recall': 0.27941176, 'binary_specificity': 0.99552983, 'binary_f1_score': 0.2451613}
confusion matrix:
       0   1
0  15144  68
1     49  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 11,now: 2024-05-28 14:03:27.129607,epoch time: 0:27:01.060912,used: 4:59:52.783481,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9525356, 'precision': 0.79381347, 'recall': 0.50962305, 'specificity': 0.50962305, 'f1': 0.5070532, 'auroc': 0.91629887, 'binary_precision': 0.63461536, 'binary_recall': 0.01981982, 'binary_specificity': 0.9994263, 'binary_f1_score': 0.03843914}
confusion matrix:
       0   1
0  33100  19
1   1632  33
---- Validation: 
scalar performance:
{'acc': 0.9516637, 'precision': 0.833086, 'recall': 0.5067274, 'specificity': 0.5067274, 'f1': 0.5010852, 'auroc': 0.9255569, 'binary_precision': 0.71428573, 'binary_recall': 0.013736264, 'binary_specificity': 0.9997185, 'binary_f1_score': 0.02695418}
confusion matrix:
       0   1
0  14205   4
1    718  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.4977731, 'recall': 0.49960557, 'specificity': 0.49960557, 'f1': 0.49868765, 'auroc': 0.8267844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15200  12
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.9516636729240417, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9956151843070984
after epoch: 12,now: 2024-05-28 14:30:16.013608,epoch time: 0:26:48.884001,used: 5:26:41.667482,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9553818, 'precision': 0.758694, 'recall': 0.6870881, 'specificity': 0.6870881, 'f1': 0.71627885, 'auroc': 0.9252464, 'binary_precision': 0.547599, 'binary_recall': 0.3903904, 'binary_specificity': 0.98378575, 'binary_f1_score': 0.45582047}
confusion matrix:
       0    1
0  32582  537
1   1015  650
---- Validation: 
scalar performance:
{'acc': 0.95393986, 'precision': 0.7690376, 'recall': 0.5984996, 'specificity': 0.5984996, 'f1': 0.6392076, 'auroc': 0.93316096, 'binary_precision': 0.57751936, 'binary_recall': 0.20467032, 'binary_specificity': 0.9923288, 'binary_f1_score': 0.30223125}
confusion matrix:
       0    1
0  14100  109
1    579  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.74809957, 'recall': 0.5732007, 'specificity': 0.5732007, 'f1': 0.6125206, 'auroc': 0.8373466, 'binary_precision': 0.5, 'binary_recall': 0.14705883, 'binary_specificity': 0.9993426, 'binary_f1_score': 0.22727273}
confusion matrix:
       0   1
0  15202  10
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 2
val acc:0.9539398550987244, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9956151843070984
after epoch: 13,now: 2024-05-28 14:57:23.795259,epoch time: 0:27:07.781651,used: 5:53:49.449133,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9549218, 'precision': 0.793572, 'recall': 0.5690576, 'specificity': 0.5690576, 'f1': 0.6044523, 'auroc': 0.9192435, 'binary_precision': 0.6286472, 'binary_recall': 0.14234234, 'binary_specificity': 0.99577284, 'binary_f1_score': 0.23212539}
confusion matrix:
       0    1
0  32979  140
1   1428  237
---- Validation: 
scalar performance:
{'acc': 0.9527348, 'precision': 0.8014487, 'recall': 0.53205216, 'specificity': 0.53205216, 'f1': 0.5477081, 'auroc': 0.92948174, 'binary_precision': 0.6486486, 'binary_recall': 0.06593407, 'binary_specificity': 0.9981702, 'binary_f1_score': 0.11970075}
confusion matrix:
       0   1
0  14183  26
1    680  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958115, 'precision': 0.9146043, 'recall': 0.53673184, 'specificity': 0.53673184, 'f1': 0.56651795, 'auroc': 0.8169704, 'binary_precision': 0.8333333, 'binary_recall': 0.073529415, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.13513514}
confusion matrix:
       0  1
0  15211  1
1     63  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
new oracle model saved
early stop counter: 3
val acc:0.9527348279953003, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 14,now: 2024-05-28 15:25:54.380769,epoch time: 0:28:30.585510,used: 6:22:20.034643,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95578426, 'precision': 0.7667453, 'recall': 0.6556419, 'specificity': 0.6556419, 'f1': 0.694554, 'auroc': 0.92259586, 'binary_precision': 0.5667718, 'binary_recall': 0.32372373, 'binary_specificity': 0.98756003, 'binary_f1_score': 0.41207954}
confusion matrix:
       0    1
0  32707  412
1   1126  539
---- Validation: 
scalar performance:
{'acc': 0.95467633, 'precision': 0.79423237, 'recall': 0.58259606, 'specificity': 0.58259606, 'f1': 0.62236106, 'auroc': 0.92868507, 'binary_precision': 0.6294416, 'binary_recall': 0.17032968, 'binary_specificity': 0.99486244, 'binary_f1_score': 0.2681081}
confusion matrix:
       0    1
0  14136   73
1    604  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99384815, 'precision': 0.6321879, 'recall': 0.6089465, 'specificity': 0.6089465, 'f1': 0.6194235, 'auroc': 0.8155638, 'binary_precision': 0.26785713, 'binary_recall': 0.22058824, 'binary_specificity': 0.99730474, 'binary_f1_score': 0.24193548}
confusion matrix:
       0   1
0  15171  41
1     53  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 4
val acc:0.9546763300895691, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 15,now: 2024-05-28 15:53:36.569675,epoch time: 0:27:42.188906,used: 6:50:02.223549,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95405936, 'precision': 0.7576388, 'recall': 0.5991214, 'specificity': 0.5991214, 'f1': 0.63860583, 'auroc': 0.9276519, 'binary_precision': 0.55394524, 'binary_recall': 0.20660661, 'binary_specificity': 0.9916362, 'binary_f1_score': 0.3009624}
confusion matrix:
       0    1
0  32842  277
1   1321  344
---- Validation: 
scalar performance:
{'acc': 0.9541407, 'precision': 0.77922666, 'recall': 0.58622426, 'specificity': 0.58622426, 'f1': 0.6257268, 'auroc': 0.9313735, 'binary_precision': 0.59907836, 'binary_recall': 0.17857143, 'binary_specificity': 0.9938771, 'binary_f1_score': 0.2751323}
confusion matrix:
       0    1
0  14122   87
1    598  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.73490906, 'recall': 0.56584775, 'specificity': 0.56584775, 'f1': 0.60231614, 'auroc': 0.81811893, 'binary_precision': 0.47368422, 'binary_recall': 0.13235295, 'binary_specificity': 0.9993426, 'binary_f1_score': 0.20689659}
confusion matrix:
       0   1
0  15202  10
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 5
val acc:0.9541407227516174, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 16,now: 2024-05-28 16:20:28.120893,epoch time: 0:26:51.551218,used: 7:16:53.774767,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9542606, 'precision': 0.7594493, 'recall': 0.60407555, 'specificity': 0.60407555, 'f1': 0.6442463, 'auroc': 0.92556894, 'binary_precision': 0.55709875, 'binary_recall': 0.21681681, 'binary_specificity': 0.99133426, 'binary_f1_score': 0.31214872}
confusion matrix:
       0    1
0  32832  287
1   1304  361
---- Validation: 
scalar performance:
{'acc': 0.95460933, 'precision': 0.7814582, 'recall': 0.59754825, 'specificity': 0.59754825, 'f1': 0.63950527, 'auroc': 0.9301184, 'binary_precision': 0.602459, 'binary_recall': 0.20192307, 'binary_specificity': 0.99317336, 'binary_f1_score': 0.30246913}
confusion matrix:
       0    1
0  14112   97
1    581  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.7480346, 'recall': 0.5585606, 'specificity': 0.5585606, 'f1': 0.5941225, 'auroc': 0.8308611, 'binary_precision': 0.5, 'binary_recall': 0.11764706, 'binary_specificity': 0.9994741, 'binary_f1_score': 0.1904762}
confusion matrix:
       0  1
0  15204  8
1     60  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 6
val acc:0.9546093344688416, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 17,now: 2024-05-28 16:48:14.062333,epoch time: 0:27:45.941440,used: 7:44:39.716207,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9526219, 'precision': 0.798607, 'recall': 0.5110944, 'specificity': 0.5110944, 'f1': 0.5098962, 'auroc': 0.90953976, 'binary_precision': 0.6440678, 'binary_recall': 0.022822823, 'binary_specificity': 0.9993659, 'binary_f1_score': 0.04408353}
confusion matrix:
       0   1
0  33098  21
1   1627  38
---- Validation: 
scalar performance:
{'acc': 0.9519984, 'precision': 0.8570854, 'recall': 0.51081306, 'specificity': 0.51081306, 'f1': 0.5090528, 'auroc': 0.9173161, 'binary_precision': 0.7619048, 'binary_recall': 0.021978023, 'binary_specificity': 0.9996481, 'binary_f1_score': 0.042723633}
confusion matrix:
       0   1
0  14204   5
1    712  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9953534, 'precision': 0.49777442, 'recall': 0.49990138, 'specificity': 0.49990138, 'f1': 0.49883565, 'auroc': 0.83637893, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15209  3
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 7
val acc:0.9519984126091003, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 18,now: 2024-05-28 17:15:53.470317,epoch time: 0:27:39.407984,used: 8:12:19.124191,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95561177, 'precision': 0.7562467, 'recall': 0.76849174, 'specificity': 0.76849174, 'f1': 0.7622026, 'auroc': 0.9313221, 'binary_precision': 0.5345912, 'binary_recall': 0.5615616, 'binary_specificity': 0.97542197, 'binary_f1_score': 0.54774463}
confusion matrix:
       0    1
0  32305  814
1    730  935
---- Validation: 
scalar performance:
{'acc': 0.95460933, 'precision': 0.7560282, 'recall': 0.7291763, 'specificity': 0.7291763, 'f1': 0.74173814, 'auroc': 0.93199974, 'binary_precision': 0.53858024, 'binary_recall': 0.4793956, 'binary_specificity': 0.978957, 'binary_f1_score': 0.5072674}
confusion matrix:
       0    1
0  13910  299
1    379  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99482983, 'precision': 0.68118787, 'recall': 0.60943955, 'specificity': 0.60943955, 'f1': 0.6363175, 'auroc': 0.83488655, 'binary_precision': 0.36585367, 'binary_recall': 0.22058824, 'binary_specificity': 0.99829084, 'binary_f1_score': 0.27522936}
confusion matrix:
       0   1
0  15186  26
1     53  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 8
val acc:0.9546093344688416, best validation acc: 0.9548102021217346, corresponding to test acc:                         0.9923429489135742 / 0.9958115220069885
after epoch: 19,now: 2024-05-28 17:44:50.033542,epoch time: 0:28:56.563225,used: 8:41:15.687416,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95558304, 'precision': 0.75592434, 'recall': 0.7798848, 'specificity': 0.7798848, 'f1': 0.76727843, 'auroc': 0.93520033, 'binary_precision': 0.5327869, 'binary_recall': 0.5855856, 'binary_specificity': 0.974184, 'binary_f1_score': 0.55794}
confusion matrix:
       0    1
0  32264  855
1    690  975
---- Validation: 
scalar performance:
{'acc': 0.95487714, 'precision': 0.7567761, 'recall': 0.75342715, 'specificity': 0.75342715, 'f1': 0.7550888, 'auroc': 0.9345529, 'binary_precision': 0.53760445, 'binary_recall': 0.5302198, 'binary_specificity': 0.9766345, 'binary_f1_score': 0.53388655}
confusion matrix:
       0    1
0  13877  332
1    342  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9928011, 'precision': 0.6263932, 'recall': 0.6596611, 'specificity': 0.6596611, 'f1': 0.6410483, 'auroc': 0.8760706, 'binary_precision': 0.25581396, 'binary_recall': 0.32352942, 'binary_specificity': 0.9957928, 'binary_f1_score': 0.2857143}
confusion matrix:
       0   1
0  15148  64
1     46  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 20,now: 2024-05-28 18:12:20.445721,epoch time: 0:27:30.412179,used: 9:08:46.099595,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95753795, 'precision': 0.777319, 'recall': 0.68764997, 'specificity': 0.68764997, 'f1': 0.72262573, 'auroc': 0.9370285, 'binary_precision': 0.58483756, 'binary_recall': 0.38918918, 'binary_specificity': 0.9861107, 'binary_f1_score': 0.46736386}
confusion matrix:
       0    1
0  32659  460
1   1017  648
---- Validation: 
scalar performance:
{'acc': 0.9564839, 'precision': 0.7905102, 'recall': 0.63697934, 'specificity': 0.63697934, 'f1': 0.6826936, 'auroc': 0.9389271, 'binary_precision': 0.61676645, 'binary_recall': 0.28296703, 'binary_specificity': 0.99099165, 'binary_f1_score': 0.38794726}
confusion matrix:
       0    1
0  14081  128
1    522  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9926702, 'precision': 0.5762191, 'recall': 0.5717545, 'specificity': 0.5717545, 'f1': 0.5739172, 'auroc': 0.8324088, 'binary_precision': 0.15625, 'binary_recall': 0.14705883, 'binary_specificity': 0.9964502, 'binary_f1_score': 0.15151516}
confusion matrix:
       0   1
0  15158  54
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 21,now: 2024-05-28 18:39:17.156386,epoch time: 0:26:56.710665,used: 9:35:42.810260,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9592341, 'precision': 0.7810014, 'recall': 0.7415885, 'specificity': 0.7415885, 'f1': 0.75958824, 'auroc': 0.93706536, 'binary_precision': 0.5869106, 'binary_recall': 0.5009009, 'binary_specificity': 0.982276, 'binary_f1_score': 0.5405055}
confusion matrix:
       0    1
0  32532  587
1    831  834
---- Validation: 
scalar performance:
{'acc': 0.957622, 'precision': 0.8084191, 'recall': 0.6356226, 'specificity': 0.6356226, 'f1': 0.6844039, 'auroc': 0.93812686, 'binary_precision': 0.65273315, 'binary_recall': 0.27884614, 'binary_specificity': 0.99239916, 'binary_f1_score': 0.39076036}
confusion matrix:
       0    1
0  14101  108
1    525  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9929974, 'precision': 0.5640347, 'recall': 0.54995865, 'specificity': 0.54995865, 'f1': 0.55609363, 'auroc': 0.8499948, 'binary_precision': 0.13207547, 'binary_recall': 0.10294118, 'binary_specificity': 0.9969761, 'binary_f1_score': 0.11570249}
confusion matrix:
       0   1
0  15166  46
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 22,now: 2024-05-28 19:06:09.890316,epoch time: 0:26:52.733930,used: 10:02:35.544190,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.957423, 'precision': 0.7694613, 'recall': 0.7315108, 'specificity': 0.7315108, 'f1': 0.74882936, 'auroc': 0.93872565, 'binary_precision': 0.56478876, 'binary_recall': 0.48168167, 'binary_specificity': 0.98134, 'binary_f1_score': 0.5199352}
confusion matrix:
       0    1
0  32501  618
1    863  802
---- Validation: 
scalar performance:
{'acc': 0.95561355, 'precision': 0.76871645, 'recall': 0.67627096, 'specificity': 0.67627096, 'f1': 0.71149784, 'auroc': 0.9400941, 'binary_precision': 0.56929636, 'binary_recall': 0.36675823, 'binary_specificity': 0.98578364, 'binary_f1_score': 0.44611526}
confusion matrix:
       0    1
0  14007  202
1    461  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9943717, 'precision': 0.6156793, 'recall': 0.557969, 'specificity': 0.557969, 'f1': 0.5770196, 'auroc': 0.8631544, 'binary_precision': 0.23529412, 'binary_recall': 0.11764706, 'binary_specificity': 0.99829084, 'binary_f1_score': 0.15686275}
confusion matrix:
       0   1
0  15186  26
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.9556135535240173, best validation acc: 0.9576219916343689, corresponding to test acc:                         0.992997407913208 / 0.9958115220069885
after epoch: 23,now: 2024-05-28 19:33:14.374497,epoch time: 0:27:04.484181,used: 10:29:40.028371,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9573942, 'precision': 0.77699685, 'recall': 0.6830112, 'specificity': 0.6830112, 'f1': 0.71906376, 'auroc': 0.92778695, 'binary_precision': 0.58464384, 'binary_recall': 0.37957957, 'binary_specificity': 0.9864428, 'binary_f1_score': 0.46030593}
confusion matrix:
       0    1
0  32670  449
1   1033  632
---- Validation: 
scalar performance:
{'acc': 0.9562161, 'precision': 0.791711, 'recall': 0.6270642, 'specificity': 0.6270642, 'f1': 0.6730237, 'auroc': 0.9359257, 'binary_precision': 0.6201299, 'binary_recall': 0.26236263, 'binary_specificity': 0.9917658, 'binary_f1_score': 0.36872587}
confusion matrix:
       0    1
0  14092  117
1    537  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98933244, 'precision': 0.5642084, 'recall': 0.6213187, 'specificity': 0.6213187, 'f1': 0.58361024, 'auroc': 0.81033313, 'binary_precision': 0.13178295, 'binary_recall': 0.25, 'binary_specificity': 0.9926374, 'binary_f1_score': 0.17258884}
confusion matrix:
       0    1
0  15100  112
1     51   17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 2
val acc:0.9562160968780518, best validation acc: 0.9576219916343689, corresponding to test acc:                         0.992997407913208 / 0.9958115220069885
after epoch: 24,now: 2024-05-28 20:00:22.766785,epoch time: 0:27:08.392288,used: 10:56:48.420659,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.956273, 'precision': 0.7589399, 'recall': 0.80933785, 'specificity': 0.80933785, 'f1': 0.7815198, 'auroc': 0.9409754, 'binary_precision': 0.5358209, 'binary_recall': 0.64684683, 'binary_specificity': 0.9718289, 'binary_f1_score': 0.58612245}
confusion matrix:
       0     1
0  32186   933
1    588  1077
---- Validation: 
scalar performance:
{'acc': 0.9571534, 'precision': 0.76677096, 'recall': 0.8067535, 'specificity': 0.8067535, 'f1': 0.78513104, 'auroc': 0.9451605, 'binary_precision': 0.5521327, 'binary_recall': 0.6401099, 'binary_specificity': 0.97339714, 'binary_f1_score': 0.59287536}
confusion matrix:
       0    1
0  13831  378
1    262  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98782724, 'precision': 0.543322, 'recall': 0.5912824, 'specificity': 0.5912824, 'f1': 0.55825627, 'auroc': 0.85721993, 'binary_precision': 0.090277776, 'binary_recall': 0.19117647, 'binary_specificity': 0.9913884, 'binary_f1_score': 0.122641504}
confusion matrix:
       0    1
0  15081  131
1     55   13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 3
val acc:0.9571533799171448, best validation acc: 0.9576219916343689, corresponding to test acc:                         0.992997407913208 / 0.9958115220069885
after epoch: 25,now: 2024-05-28 20:27:31.405154,epoch time: 0:27:08.638369,used: 11:23:57.059028,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9565892, 'precision': 0.7605474, 'recall': 0.8023738, 'specificity': 0.8023738, 'f1': 0.7796428, 'auroc': 0.9422534, 'binary_precision': 0.539764, 'binary_recall': 0.6318318, 'binary_specificity': 0.9729158, 'binary_f1_score': 0.58218044}
confusion matrix:
       0     1
0  32222   897
1    613  1052
---- Validation: 
scalar performance:
{'acc': 0.9581576, 'precision': 0.7771819, 'recall': 0.7499384, 'specificity': 0.7499384, 'f1': 0.76274705, 'auroc': 0.9453733, 'binary_precision': 0.5788668, 'binary_recall': 0.5192308, 'binary_specificity': 0.9806461, 'binary_f1_score': 0.5474294}
confusion matrix:
       0    1
0  13934  275
1    350  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9865183, 'precision': 0.5610095, 'recall': 0.66382575, 'specificity': 0.66382575, 'f1': 0.5878714, 'auroc': 0.82633674, 'binary_precision': 0.125, 'binary_recall': 0.3382353, 'binary_specificity': 0.98941624, 'binary_f1_score': 0.18253969}
confusion matrix:
       0    1
0  15051  161
1     45   23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 26,now: 2024-05-28 20:54:13.769188,epoch time: 0:26:42.364034,used: 11:50:39.423062,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9549506, 'precision': 0.7527543, 'recall': 0.7738486, 'specificity': 0.7738486, 'f1': 0.7628072, 'auroc': 0.9376125, 'binary_precision': 0.527042, 'binary_recall': 0.5735736, 'binary_specificity': 0.9741236, 'binary_f1_score': 0.54932415}
confusion matrix:
       0    1
0  32262  857
1    710  955
---- Validation: 
scalar performance:
{'acc': 0.9571534, 'precision': 0.77612865, 'recall': 0.7090099, 'specificity': 0.7090099, 'f1': 0.7372396, 'auroc': 0.94142604, 'binary_precision': 0.5808824, 'binary_recall': 0.43406594, 'binary_specificity': 0.98395383, 'binary_f1_score': 0.4968553}
confusion matrix:
       0    1
0  13981  228
1    412  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9818063, 'precision': 0.521813, 'recall': 0.57361835, 'specificity': 0.57361835, 'f1': 0.53207314, 'auroc': 0.80794966, 'binary_precision': 0.047413792, 'binary_recall': 0.16176471, 'binary_specificity': 0.985472, 'binary_f1_score': 0.07333333}
confusion matrix:
       0    1
0  14991  221
1     57   11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.9571533799171448, best validation acc: 0.9581575989723206, corresponding to test acc:                         0.9865183234214783 / 0.9958115220069885
after epoch: 27,now: 2024-05-28 21:21:15.197076,epoch time: 0:27:01.427888,used: 12:17:40.850950,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.956618, 'precision': 0.8191261, 'recall': 0.5870605, 'specificity': 0.5870605, 'f1': 0.63004327, 'auroc': 0.93620896, 'binary_precision': 0.67808217, 'binary_recall': 0.17837837, 'binary_specificity': 0.9957426, 'binary_f1_score': 0.28245363}
confusion matrix:
       0    1
0  32978  141
1   1368  297
---- Validation: 
scalar performance:
{'acc': 0.9552788, 'precision': 0.8239948, 'recall': 0.57313836, 'specificity': 0.57313836, 'f1': 0.6115028, 'auroc': 0.9419217, 'binary_precision': 0.6898734, 'binary_recall': 0.14972527, 'binary_specificity': 0.99655145, 'binary_f1_score': 0.24604966}
confusion matrix:
       0    1
0  14160   49
1    619  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9939136, 'precision': 0.51632226, 'recall': 0.50649834, 'specificity': 0.50649834, 'f1': 0.509, 'auroc': 0.8599045, 'binary_precision': 0.037037037, 'binary_recall': 0.014705882, 'binary_specificity': 0.99829084, 'binary_f1_score': 0.02105263}
confusion matrix:
       0   1
0  15186  26
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 2
val acc:0.9552788138389587, best validation acc: 0.9581575989723206, corresponding to test acc:                         0.9865183234214783 / 0.9958115220069885
after epoch: 28,now: 2024-05-28 21:48:13.871491,epoch time: 0:26:58.674415,used: 12:44:39.525365,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9558705, 'precision': 0.75713825, 'recall': 0.84049886, 'specificity': 0.84049886, 'f1': 0.79196906, 'auroc': 0.94417036, 'binary_precision': 0.5289661, 'binary_recall': 0.7129129, 'binary_specificity': 0.9680848, 'binary_f1_score': 0.6073165}
confusion matrix:
       0     1
0  32062  1057
1    478  1187
---- Validation: 
scalar performance:
{'acc': 0.958894, 'precision': 0.7791954, 'recall': 0.7711775, 'specificity': 0.7711775, 'f1': 0.7751188, 'auroc': 0.9422308, 'binary_precision': 0.5807365, 'binary_recall': 0.5631868, 'binary_specificity': 0.9791681, 'binary_f1_score': 0.57182705}
confusion matrix:
       0    1
0  13913  296
1    318  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9826571, 'precision': 0.5441138, 'recall': 0.6545664, 'specificity': 0.6545664, 'f1': 0.5668174, 'auroc': 0.8155508, 'binary_precision': 0.09128631, 'binary_recall': 0.32352942, 'binary_specificity': 0.98560345, 'binary_f1_score': 0.14239483}
confusion matrix:
       0    1
0  14993  219
1     46   22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
better model found
persisted
after epoch: 29,now: 2024-05-28 22:15:15.845305,epoch time: 0:27:01.973814,used: 13:11:41.499179,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9582854, 'precision': 0.7744754, 'recall': 0.73994946, 'specificity': 0.73994946, 'f1': 0.75587845, 'auroc': 0.9391786, 'binary_precision': 0.57399726, 'binary_recall': 0.4984985, 'binary_specificity': 0.98140043, 'binary_f1_score': 0.53359056}
confusion matrix:
       0    1
0  32503  616
1    835  830
---- Validation: 
scalar performance:
{'acc': 0.95876014, 'precision': 0.8174938, 'recall': 0.6479501, 'specificity': 0.6479501, 'f1': 0.6981962, 'auroc': 0.9456673, 'binary_precision': 0.669697, 'binary_recall': 0.30357143, 'binary_specificity': 0.9923288, 'binary_f1_score': 0.4177694}
confusion matrix:
       0    1
0  14100  109
1    507  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99345547, 'precision': 0.56614715, 'recall': 0.5428686, 'specificity': 0.5428686, 'f1': 0.5519293, 'auroc': 0.8183806, 'binary_precision': 0.13636364, 'binary_recall': 0.0882353, 'binary_specificity': 0.99750197, 'binary_f1_score': 0.10714286}
confusion matrix:
       0   1
0  15174  38
1     62   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897892.png
early stop counter: 1
val acc:0.958760142326355, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9826570749282837 / 0.9958115220069885
after epoch: 30,now: 2024-05-28 22:42:02.686238,epoch time: 0:26:46.840933,used: 13:38:28.340112,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_03_34_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:38:28.340112 at 2024-05-28 22:42:02.686238
persisted model performance metric: 

scalar performance:
{'acc': 0.9828534, 'precision': 0.54812384, 'recall': 0.6693052, 'specificity': 0.6693052, 'f1': 0.57308877, 'auroc': 0.81918883, 'binary_precision': 0.09917355, 'binary_recall': 0.3529412, 'binary_specificity': 0.9856692, 'binary_f1_score': 0.15483871}
confusion matrix:
       0    1
0  14994  218
1     44   24
oracle model performance metric: 

scalar performance:
{'acc': 0.9956152, 'precision': 0.7836191, 'recall': 0.52931315, 'specificity': 0.52931315, 'f1': 0.5522344, 'auroc': 0.7935294, 'binary_precision': 0.5714286, 'binary_recall': 0.05882353, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.10666667}
confusion matrix:
       0  1
0  15209  3
1     64  4
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458180 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458180 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 448177 KiB |  13213 MiB |   2147 TiB |   2147 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2121 TiB |   2121 TiB |
|       from small pool |  41102 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28046 MiB |  13568 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444988 KiB |   1233 MiB |   1530 TiB |   1530 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1504 TiB |   1504 TiB |
|       from small pool |   9871 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6866    |    7237    |  381895 K  |  381888 K  |
|       from large pool |     187    |    1413    |  198397 K  |  198397 K  |
|       from small pool |    6679    |    6975    |  183498 K  |  183491 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6866    |    7237    |  381895 K  |  381888 K  |
|       from large pool |     187    |    1413    |  198397 K  |  198397 K  |
|       from small pool |    6679    |    6975    |  183498 K  |  183491 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1208    |     573    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    2805    |  255043 K  |  255043 K  |
|       from large pool |      38    |     605    |  156829 K  |  156829 K  |
|       from small pool |      35    |    2765    |   98214 K  |   98214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2147 TiB |   2147 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2121 TiB |   2121 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1233 MiB |   1530 TiB |   1530 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1504 TiB |   1504 TiB |
|       from small pool |      0 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381895 K  |  381895 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381895 K  |  381895 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  255046 K  |  255046 K  |
|       from large pool |       4    |     605    |  156829 K  |  156829 K  |
|       from small pool |       0    |    2765    |   98217 K  |   98217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2155 TiB |   2155 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2129 TiB |   2129 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2147 TiB |   2147 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2121 TiB |   2121 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1233 MiB |   1530 TiB |   1530 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1504 TiB |   1504 TiB |
|       from small pool |      0 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381895 K  |  381895 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381895 K  |  381895 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  255046 K  |  255046 K  |
|       from large pool |       4    |     605    |  156829 K  |  156829 K  |
|       from small pool |       0    |    2765    |   98217 K  |   98217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892

 Experiment start at: 2024-05-28 22:54:39.393181
before training, model accuracy: 0.7692731618881226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.74112725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.77434623, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.56102335, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 23:20:57.686516,epoch time: 0:26:18.293335,used: 0:26:18.293335,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.77718127, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.80208, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.60845697, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 2,now: 2024-05-28 23:45:45.322741,epoch time: 0:24:47.636225,used: 0:51:05.929560,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8156767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8268477, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.6493249, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 2
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 3,now: 2024-05-29 00:11:01.724054,epoch time: 0:25:16.401313,used: 1:16:22.330873,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8329006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8366524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.66252947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 3
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 4,now: 2024-05-29 00:36:03.346718,epoch time: 0:25:01.622664,used: 1:41:23.953537,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.89562595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.90418935, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.82706404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 4
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 5,now: 2024-05-29 01:00:53.549965,epoch time: 0:24:50.203247,used: 2:06:14.156784,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.9192376, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.935013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.83303785, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 5
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 6,now: 2024-05-29 01:26:07.333257,epoch time: 0:25:13.783292,used: 2:31:27.940076,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671028, 'precision': 0.7512466, 'recall': 0.6143176, 'specificity': 0.6143176, 'f1': 0.65472776, 'auroc': 0.9232469, 'binary_precision': 0.5286822, 'binary_recall': 0.23598616, 'binary_specificity': 0.992649, 'binary_f1_score': 0.3263158}
confusion matrix:
       0    1
0  41051  304
1   1104  341
---- Validation: 
scalar performance:
{'acc': 0.9662406, 'precision': 0.8170698, 'recall': 0.53817254, 'specificity': 0.53817254, 'f1': 0.5610292, 'auroc': 0.936401, 'binary_precision': 0.6666667, 'binary_recall': 0.077760495, 'binary_specificity': 0.9985846, 'binary_f1_score': 0.13927576}
confusion matrix:
       0   1
0  17638  25
1    593  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.80215263, 'recall': 0.51526594, 'specificity': 0.51526594, 'f1': 0.5198013, 'auroc': 0.8412124, 'binary_precision': 0.64285713, 'binary_recall': 0.03125, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.059602648}
confusion matrix:
      0  1
0  6958  5
1   279  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-29 01:51:18.926631,epoch time: 0:25:11.593374,used: 2:56:39.533450,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.9250816, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.93860555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.8440213, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9662405848503113, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 8,now: 2024-05-29 02:16:35.366186,epoch time: 0:25:16.439555,used: 3:21:55.973005,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.6081526, 'recall': 0.50031024, 'specificity': 0.50031024, 'f1': 0.4921055, 'auroc': 0.92093277, 'binary_precision': 0.25, 'binary_recall': 0.0006930007, 'binary_specificity': 0.99992746, 'binary_f1_score': 0.00138217}
confusion matrix:
       0  1
0  41354  3
1   1442  1
---- Validation: 
scalar performance:
{'acc': 0.96482027, 'precision': 0.48243648, 'recall': 0.4999717, 'specificity': 0.4999717, 'f1': 0.4910476, 'auroc': 0.9366898, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999434, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17662  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.8374878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 2
val acc:0.9648202657699585, best validation acc: 0.9662405848503113, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 9,now: 2024-05-29 02:41:52.298521,epoch time: 0:25:16.932335,used: 3:47:12.905340,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95817757, 'precision': 0.70622075, 'recall': 0.8192936, 'specificity': 0.8192936, 'f1': 0.74886453, 'auroc': 0.9310728, 'binary_precision': 0.4241893, 'binary_recall': 0.6703601, 'binary_specificity': 0.9682271, 'binary_f1_score': 0.51959205}
confusion matrix:
       0     1
0  40042  1314
1    476   968
---- Validation: 
scalar performance:
{'acc': 0.9646564, 'precision': 0.74169064, 'recall': 0.79660845, 'specificity': 0.79660845, 'f1': 0.7659937, 'auroc': 0.94295615, 'binary_precision': 0.49748743, 'binary_recall': 0.61586314, 'binary_specificity': 0.9773538, 'binary_f1_score': 0.5503822}
confusion matrix:
       0    1
0  17263  400
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9575231, 'precision': 0.70965034, 'recall': 0.6416939, 'specificity': 0.6416939, 'f1': 0.6681839, 'auroc': 0.82145745, 'binary_precision': 0.44791666, 'binary_recall': 0.2986111, 'binary_specificity': 0.9847767, 'binary_f1_score': 0.3583333}
confusion matrix:
      0    1
0  6857  106
1   202   86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 3
val acc:0.964656412601471, best validation acc: 0.9662405848503113, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 10,now: 2024-05-29 03:07:12.654843,epoch time: 0:25:20.356322,used: 4:12:33.261662,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9682944, 'precision': 0.8045645, 'recall': 0.5688518, 'specificity': 0.5688518, 'f1': 0.60705155, 'auroc': 0.9319775, 'binary_precision': 0.6383648, 'binary_recall': 0.14048442, 'binary_specificity': 0.9972192, 'binary_f1_score': 0.23028925}
confusion matrix:
       0    1
0  41240  115
1   1242  203
---- Validation: 
scalar performance:
{'acc': 0.9650388, 'precision': 0.79033595, 'recall': 0.5060793, 'specificity': 0.5060793, 'f1': 0.50329536, 'auroc': 0.9451916, 'binary_precision': 0.61538464, 'binary_recall': 0.01244168, 'binary_specificity': 0.99971694, 'binary_f1_score': 0.024390245}
confusion matrix:
       0  1
0  17658  5
1    635  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.73020416, 'recall': 0.50166434, 'specificity': 0.50166434, 'f1': 0.493316, 'auroc': 0.85546136, 'binary_precision': 0.5, 'binary_recall': 0.0034722222, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.006896552}
confusion matrix:
      0  1
0  6962  1
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 4
val acc:0.9650387763977051, best validation acc: 0.9662405848503113, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 11,now: 2024-05-29 03:32:16.060082,epoch time: 0:25:03.405239,used: 4:37:36.666901,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96918225, 'precision': 0.78585446, 'recall': 0.62924397, 'specificity': 0.62924397, 'f1': 0.67549276, 'auroc': 0.9273833, 'binary_precision': 0.596875, 'binary_recall': 0.26472625, 'binary_specificity': 0.99376166, 'binary_f1_score': 0.3667787}
confusion matrix:
       0    1
0  41099  258
1   1061  382
---- Validation: 
scalar performance:
{'acc': 0.9669507, 'precision': 0.837394, 'recall': 0.54978, 'specificity': 0.54978, 'f1': 0.58000386, 'auroc': 0.9383569, 'binary_precision': 0.70652175, 'binary_recall': 0.10108865, 'binary_specificity': 0.9984714, 'binary_f1_score': 0.17687076}
confusion matrix:
       0   1
0  17636  27
1    578  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.7805276, 'recall': 0.51012945, 'specificity': 0.51012945, 'f1': 0.5100666, 'auroc': 0.8555279, 'binary_precision': 0.6, 'binary_recall': 0.020833334, 'binary_specificity': 0.99942553, 'binary_f1_score': 0.04026846}
confusion matrix:
      0  1
0  6959  4
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
better model found
persisted
after epoch: 12,now: 2024-05-29 03:57:22.373892,epoch time: 0:25:06.313810,used: 5:02:42.980711,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9496729, 'precision': 0.6823026, 'recall': 0.8440583, 'specificity': 0.8440583, 'f1': 0.73429704, 'auroc': 0.9335604, 'binary_precision': 0.37433535, 'binary_recall': 0.73079586, 'binary_specificity': 0.95732075, 'binary_f1_score': 0.4950774}
confusion matrix:
       0     1
0  39590  1765
1    389  1056
---- Validation: 
scalar performance:
{'acc': 0.9639462, 'precision': 0.73939306, 'recall': 0.8284602, 'specificity': 0.8284602, 'f1': 0.77602696, 'auroc': 0.94436085, 'binary_precision': 0.4905028, 'binary_recall': 0.6827372, 'binary_specificity': 0.9741833, 'binary_f1_score': 0.5708713}
confusion matrix:
       0    1
0  17207  456
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94649017, 'precision': 0.65498173, 'recall': 0.6642424, 'specificity': 0.6642424, 'f1': 0.65945184, 'auroc': 0.83603215, 'binary_precision': 0.33660132, 'binary_recall': 0.3576389, 'binary_specificity': 0.9708459, 'binary_f1_score': 0.34680134}
confusion matrix:
      0    1
0  6760  203
1   185  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9639462232589722, best validation acc: 0.9669507145881653, corresponding to test acc:                         0.9605571627616882 / 0.9608330130577087
after epoch: 13,now: 2024-05-29 04:22:32.287721,epoch time: 0:25:09.913829,used: 5:27:52.894540,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9690654, 'precision': 0.7697215, 'recall': 0.68658113, 'specificity': 0.68658113, 'f1': 0.71983624, 'auroc': 0.9331825, 'binary_precision': 0.5607287, 'binary_recall': 0.3836565, 'binary_specificity': 0.98950577, 'binary_f1_score': 0.4555921}
confusion matrix:
       0    1
0  40922  434
1    890  554
---- Validation: 
scalar performance:
{'acc': 0.9674424, 'precision': 0.7941246, 'recall': 0.5942433, 'specificity': 0.5942433, 'f1': 0.63858795, 'auroc': 0.9446444, 'binary_precision': 0.6169154, 'binary_recall': 0.19284603, 'binary_specificity': 0.9956406, 'binary_f1_score': 0.29383886}
confusion matrix:
       0    1
0  17586   77
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.83386457, 'recall': 0.5204743, 'specificity': 0.5204743, 'f1': 0.52944785, 'auroc': 0.8448565, 'binary_precision': 0.7058824, 'binary_recall': 0.041666668, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.078688525}
confusion matrix:
      0   1
0  6958   5
1   276  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-05-29 04:47:31.741618,epoch time: 0:24:59.453897,used: 5:52:52.348437,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9695327, 'precision': 0.81327623, 'recall': 0.6018839, 'specificity': 0.6018839, 'f1': 0.64977294, 'auroc': 0.9323261, 'binary_precision': 0.6535948, 'binary_recall': 0.20761245, 'binary_specificity': 0.99615526, 'binary_f1_score': 0.31512603}
confusion matrix:
       0    1
0  41196  159
1   1145  300
---- Validation: 
scalar performance:
{'acc': 0.9662952, 'precision': 0.8292487, 'recall': 0.535953, 'specificity': 0.535953, 'f1': 0.557511, 'auroc': 0.9361094, 'binary_precision': 0.6911765, 'binary_recall': 0.07309487, 'binary_specificity': 0.99881107, 'binary_f1_score': 0.13220815}
confusion matrix:
       0   1
0  17642  21
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.6468681, 'recall': 0.5015925, 'specificity': 0.5015925, 'f1': 0.49326822, 'auroc': 0.82303435, 'binary_precision': 0.33333334, 'binary_recall': 0.0034722222, 'binary_specificity': 0.99971277, 'binary_f1_score': 0.0068728523}
confusion matrix:
      0  1
0  6961  2
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9662951827049255, best validation acc: 0.9674423933029175, corresponding to test acc:                         0.9612467288970947 / 0.9612467288970947
after epoch: 15,now: 2024-05-29 05:12:48.549691,epoch time: 0:25:16.808073,used: 6:18:09.156510,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.966986, 'precision': 0.7768886, 'recall': 0.5371192, 'specificity': 0.5371192, 'f1': 0.5589466, 'auroc': 0.9185301, 'binary_precision': 0.5851064, 'binary_recall': 0.076124564, 'binary_specificity': 0.9981139, 'binary_f1_score': 0.13472137}
confusion matrix:
       0    1
0  41277   78
1   1335  110
---- Validation: 
scalar performance:
{'acc': 0.96804327, 'precision': 0.80498374, 'recall': 0.6020477, 'specificity': 0.6020477, 'f1': 0.64891285, 'auroc': 0.93035275, 'binary_precision': 0.63809526, 'binary_recall': 0.20839813, 'binary_specificity': 0.9956972, 'binary_f1_score': 0.31418523}
confusion matrix:
       0    1
0  17587   76
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.98047197, 'recall': 0.5086806, 'specificity': 0.5086806, 'f1': 0.5071064, 'auroc': 0.82017064, 'binary_precision': 1.0, 'binary_recall': 0.017361112, 'binary_specificity': 1.0, 'binary_f1_score': 0.034129694}
confusion matrix:
      0  1
0  6963  0
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
better model found
persisted
after epoch: 16,now: 2024-05-29 05:38:00.832019,epoch time: 0:25:12.282328,used: 6:43:21.438838,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96897197, 'precision': 0.77319765, 'recall': 0.66170114, 'specificity': 0.66170114, 'f1': 0.70182014, 'auroc': 0.9330558, 'binary_precision': 0.569395, 'binary_recall': 0.33217993, 'binary_specificity': 0.9912223, 'binary_f1_score': 0.41958043}
confusion matrix:
       0    1
0  40992  363
1    965  480
---- Validation: 
scalar performance:
{'acc': 0.9682071, 'precision': 0.79082024, 'recall': 0.63060594, 'specificity': 0.63060594, 'f1': 0.67759067, 'auroc': 0.9428235, 'binary_precision': 0.60777384, 'binary_recall': 0.2674961, 'binary_specificity': 0.9937157, 'binary_f1_score': 0.37149027}
confusion matrix:
       0    1
0  17552  111
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611088, 'precision': 0.77316356, 'recall': 0.5353812, 'specificity': 0.5353812, 'f1': 0.55486983, 'auroc': 0.8363799, 'binary_precision': 0.5833333, 'binary_recall': 0.072916664, 'binary_specificity': 0.99784577, 'binary_f1_score': 0.12962963}
confusion matrix:
      0   1
0  6948  15
1   267  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
better model found
persisted
after epoch: 17,now: 2024-05-29 06:03:03.846501,epoch time: 0:25:03.014482,used: 7:08:24.453320,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8996889, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.92129207, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.81746566, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9682071208953857, corresponding to test acc:                         0.9611088037490845 / 0.9612467288970947
after epoch: 18,now: 2024-05-29 06:28:03.003155,epoch time: 0:24:59.156654,used: 7:33:23.609974,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9698832, 'precision': 0.7781068, 'recall': 0.69756925, 'specificity': 0.69756925, 'f1': 0.7303625, 'auroc': 0.93172467, 'binary_precision': 0.5767717, 'binary_recall': 0.40553632, 'binary_specificity': 0.9896022, 'binary_f1_score': 0.47622916}
confusion matrix:
       0    1
0  40925  430
1    859  586
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.78661966, 'recall': 0.68428725, 'specificity': 0.68428725, 'f1': 0.7232643, 'auroc': 0.9442223, 'binary_precision': 0.5955882, 'binary_recall': 0.377916, 'binary_specificity': 0.99065846, 'binary_f1_score': 0.46241677}
confusion matrix:
       0    1
0  17498  165
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.84752625, 'recall': 0.51881, 'specificity': 0.51881, 'f1': 0.52640855, 'auroc': 0.85676694, 'binary_precision': 0.73333335, 'binary_recall': 0.038194444, 'binary_specificity': 0.99942553, 'binary_f1_score': 0.072607264}
confusion matrix:
      0   1
0  6959   4
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
better model found
persisted
after epoch: 19,now: 2024-05-29 06:53:23.038351,epoch time: 0:25:20.035196,used: 7:58:43.645170,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9697664, 'precision': 0.7867987, 'recall': 0.65710324, 'specificity': 0.65710324, 'f1': 0.7013227, 'auroc': 0.9403267, 'binary_precision': 0.5969191, 'binary_recall': 0.3217993, 'binary_specificity': 0.9924072, 'binary_f1_score': 0.41816545}
confusion matrix:
       0    1
0  41041  314
1    980  465
---- Validation: 
scalar performance:
{'acc': 0.9696821, 'precision': 0.81228274, 'recall': 0.6456069, 'specificity': 0.6456069, 'f1': 0.69606346, 'auroc': 0.9477441, 'binary_precision': 0.6496599, 'binary_recall': 0.2970451, 'binary_specificity': 0.9941686, 'binary_f1_score': 0.40768412}
confusion matrix:
       0    1
0  17560  103
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.82202685, 'recall': 0.52553904, 'specificity': 0.52553904, 'f1': 0.5385224, 'auroc': 0.849246, 'binary_precision': 0.6818182, 'binary_recall': 0.052083332, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.0967742}
confusion matrix:
      0   1
0  6956   7
1   273  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-05-29 07:18:40.069892,epoch time: 0:25:17.031541,used: 8:24:00.676711,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9666355, 'precision': 0.74604714, 'recall': 0.8117626, 'specificity': 0.8117626, 'f1': 0.77456737, 'auroc': 0.93927443, 'binary_precision': 0.50459707, 'binary_recall': 0.64567477, 'binary_specificity': 0.9778503, 'binary_f1_score': 0.5664845}
confusion matrix:
       0    1
0  40439  916
1    512  933
---- Validation: 
scalar performance:
{'acc': 0.967497, 'precision': 0.7635017, 'recall': 0.7081648, 'specificity': 0.7081648, 'f1': 0.73223925, 'auroc': 0.94512695, 'binary_precision': 0.54761904, 'binary_recall': 0.42923796, 'binary_specificity': 0.98709166, 'binary_f1_score': 0.48125547}
confusion matrix:
       0    1
0  17435  228
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590401, 'precision': 0.72058564, 'recall': 0.62251216, 'specificity': 0.62251216, 'f1': 0.65572804, 'auroc': 0.8406609, 'binary_precision': 0.4713376, 'binary_recall': 0.25694445, 'binary_specificity': 0.98807985, 'binary_f1_score': 0.3325843}
confusion matrix:
      0   1
0  6880  83
1   214  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9674969911575317, best validation acc: 0.9696820974349976, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 21,now: 2024-05-29 07:43:54.085042,epoch time: 0:25:14.015150,used: 8:49:14.691861,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9679439, 'precision': 0.7877579, 'recall': 0.5713419, 'specificity': 0.5713419, 'f1': 0.6094287, 'auroc': 0.93925655, 'binary_precision': 0.6045845, 'binary_recall': 0.14602076, 'binary_specificity': 0.99666303, 'binary_f1_score': 0.23522852}
confusion matrix:
       0    1
0  41217  138
1   1234  211
---- Validation: 
scalar performance:
{'acc': 0.9662406, 'precision': 0.8057295, 'recall': 0.54266834, 'specificity': 0.54266834, 'f1': 0.56810075, 'auroc': 0.94710714, 'binary_precision': 0.6436782, 'binary_recall': 0.08709176, 'binary_specificity': 0.99824494, 'binary_f1_score': 0.15342467}
confusion matrix:
       0   1
0  17632  31
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.9091071, 'recall': 0.51034486, 'specificity': 0.51034486, 'f1': 0.51037914, 'auroc': 0.8615972, 'binary_precision': 0.85714287, 'binary_recall': 0.020833334, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.04067797}
confusion matrix:
      0  1
0  6962  1
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 2
val acc:0.9662405848503113, best validation acc: 0.9696820974349976, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 22,now: 2024-05-29 08:08:53.346305,epoch time: 0:24:59.261263,used: 9:14:13.953124,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96925235, 'precision': 0.7793251, 'recall': 0.6541658, 'specificity': 0.6541658, 'f1': 0.6970402, 'auroc': 0.9423964, 'binary_precision': 0.5821656, 'binary_recall': 0.316263, 'binary_specificity': 0.99206865, 'binary_f1_score': 0.4098655}
confusion matrix:
       0    1
0  41027  328
1    988  457
---- Validation: 
scalar performance:
{'acc': 0.9692451, 'precision': 0.8040875, 'recall': 0.6446311, 'specificity': 0.6446311, 'f1': 0.6935926, 'auroc': 0.95023847, 'binary_precision': 0.6333333, 'binary_recall': 0.29548988, 'binary_specificity': 0.99377227, 'binary_f1_score': 0.40296924}
confusion matrix:
       0    1
0  17553  110
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615225, 'precision': 0.9353466, 'recall': 0.51728934, 'specificity': 0.51728934, 'f1': 0.52362293, 'auroc': 0.8843311, 'binary_precision': 0.90909094, 'binary_recall': 0.034722224, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.066889636}
confusion matrix:
      0   1
0  6962   1
1   278  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
new oracle model saved
early stop counter: 3
val acc:0.9692450761795044, best validation acc: 0.9696820974349976, corresponding to test acc:                         0.961384654045105 / 0.9615225195884705
after epoch: 23,now: 2024-05-29 08:34:01.670078,epoch time: 0:25:08.323773,used: 9:39:22.276897,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9703271, 'precision': 0.78153205, 'recall': 0.7062817, 'specificity': 0.7062817, 'f1': 0.73754394, 'auroc': 0.9392583, 'binary_precision': 0.58301526, 'binary_recall': 0.42313018, 'binary_specificity': 0.9894332, 'binary_f1_score': 0.49036917}
confusion matrix:
       0    1
0  40919  437
1    833  611
---- Validation: 
scalar performance:
{'acc': 0.96979135, 'precision': 0.8018336, 'recall': 0.66889167, 'specificity': 0.66889167, 'f1': 0.7149044, 'auroc': 0.9484856, 'binary_precision': 0.62711865, 'binary_recall': 0.3452566, 'binary_specificity': 0.99252677, 'binary_f1_score': 0.44533598}
confusion matrix:
       0    1
0  17531  132
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.7302677, 'recall': 0.5033286, 'specificity': 0.5033286, 'f1': 0.4967156, 'auroc': 0.81753826, 'binary_precision': 0.5, 'binary_recall': 0.0069444445, 'binary_specificity': 0.99971277, 'binary_f1_score': 0.013698631}
confusion matrix:
      0  1
0  6961  2
1   286  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
better model found
persisted
after epoch: 24,now: 2024-05-29 08:59:14.763720,epoch time: 0:25:13.093642,used: 10:04:35.370539,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96635514, 'precision': 0.7787286, 'recall': 0.50439256, 'specificity': 0.50439256, 'f1': 0.5003099, 'auroc': 0.9295976, 'binary_precision': 0.59090906, 'binary_recall': 0.00900277, 'binary_specificity': 0.9997824, 'binary_f1_score': 0.017735334}
confusion matrix:
       0   1
0  41347   9
1   1431  13
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9393821, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.82524526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9697913527488708, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 25,now: 2024-05-29 09:24:27.738214,epoch time: 0:25:12.974494,used: 10:29:48.345033,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663084, 'precision': 0.983153, 'recall': 0.5010381, 'specificity': 0.5010381, 'f1': 0.49350402, 'auroc': 0.94368297, 'binary_precision': 1.0, 'binary_recall': 0.0020761245, 'binary_specificity': 1.0, 'binary_f1_score': 0.0041436465}
confusion matrix:
       0  1
0  41355  0
1   1442  3
---- Validation: 
scalar performance:
{'acc': 0.9649295, 'precision': 0.81582254, 'recall': 0.5015269, 'specificity': 0.5015269, 'f1': 0.49417087, 'auroc': 0.95286274, 'binary_precision': 0.6666667, 'binary_recall': 0.00311042, 'binary_specificity': 0.9999434, 'binary_f1_score': 0.0061919508}
confusion matrix:
       0  1
0  17662  1
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.85882556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 2
val acc:0.9649295210838318, best validation acc: 0.9697913527488708, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 26,now: 2024-05-29 09:49:38.204198,epoch time: 0:25:10.465984,used: 10:54:58.811017,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9681308, 'precision': 0.7549748, 'recall': 0.8100747, 'specificity': 0.8100747, 'f1': 0.7795252, 'auroc': 0.9434389, 'binary_precision': 0.52259886, 'binary_recall': 0.6405817, 'binary_specificity': 0.97956765, 'binary_f1_score': 0.5756067}
confusion matrix:
       0    1
0  40511  845
1    519  925
---- Validation: 
scalar performance:
{'acc': 0.9687534, 'precision': 0.7716869, 'recall': 0.74553144, 'specificity': 0.74553144, 'f1': 0.75787604, 'auroc': 0.9523531, 'binary_precision': 0.5613126, 'binary_recall': 0.5054432, 'binary_specificity': 0.98561966, 'binary_f1_score': 0.5319149}
confusion matrix:
       0    1
0  17409  254
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573026, 'precision': 0.6892855, 'recall': 0.62078875, 'specificity': 0.62078875, 'f1': 0.6463452, 'auroc': 0.86243397, 'binary_precision': 0.4088398, 'binary_recall': 0.25694445, 'binary_specificity': 0.9846331, 'binary_f1_score': 0.31556502}
confusion matrix:
      0    1
0  6856  107
1   214   74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897892.png
early stop counter: 3
val acc:0.9687533974647522, best validation acc: 0.9697913527488708, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 27,now: 2024-05-29 10:14:57.323259,epoch time: 0:25:19.119061,used: 11:20:17.930078,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_22_54_39_seed_0_20897892
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96990657, 'precision': 0.8091819, 'recall': 0.61757994, 'specificity': 0.61757994, 'f1': 0.66704595, 'auroc': 0.9418271, 'binary_precision': 0.6443203, 'binary_recall': 0.23977824, 'binary_specificity': 0.99538165, 'binary_f1_score': 0.34949496}
confusion matrix:
       0    1
0  41166  191
1   1097  346
---- Validation: 
slurmstepd: error: *** JOB 20897892 ON gpusrv30 CANCELLED AT 2024-05-29T10:35:44 ***
