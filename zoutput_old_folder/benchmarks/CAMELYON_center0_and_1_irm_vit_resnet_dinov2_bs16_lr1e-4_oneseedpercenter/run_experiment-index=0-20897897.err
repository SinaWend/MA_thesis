Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897

 Experiment start at: 2024-05-27 19:33:17.489021
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.7805819, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.79566777, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6828146, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 20:02:56.249809,epoch time: 0:29:38.760788,used: 0:29:38.760788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.81682485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8337853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.74776804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-05-27 20:31:13.247173,epoch time: 0:28:16.997364,used: 0:57:55.758152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.924887, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.93628573, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8922178, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-05-27 20:58:17.739469,epoch time: 0:27:04.492296,used: 1:25:00.250448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.858226, 'recall': 0.5010072, 'specificity': 0.5010072, 'f1': 0.49349672, 'auroc': 0.9244958, 'binary_precision': 0.75, 'binary_recall': 0.0020380435, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0040650405}
confusion matrix:
       0  1
0  42319  1
1   1469  3
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.98299444, 'recall': 0.5031104, 'specificity': 0.5031104, 'f1': 0.49753252, 'auroc': 0.93606794, 'binary_precision': 1.0, 'binary_recall': 0.00622084, 'binary_specificity': 1.0, 'binary_f1_score': 0.012364761}
confusion matrix:
       0  1
0  18149  0
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8920212, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
better model found
persisted
after epoch: 4,now: 2024-05-27 21:26:02.549326,epoch time: 0:27:44.809857,used: 1:52:45.060305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.7587768, 'recall': 0.6055293, 'specificity': 0.6055293, 'f1': 0.64703804, 'auroc': 0.93064, 'binary_precision': 0.5442177, 'binary_recall': 0.2173913, 'binary_specificity': 0.9936673, 'binary_f1_score': 0.3106796}
confusion matrix:
       0    1
0  42052  268
1   1152  320
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.7953166, 'recall': 0.5829131, 'specificity': 0.5829131, 'f1': 0.6249156, 'auroc': 0.9433652, 'binary_precision': 0.6193182, 'binary_recall': 0.16951789, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.26617828}
confusion matrix:
       0    1
0  18082   67
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.89209294, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
better model found
persisted
after epoch: 5,now: 2024-05-27 21:55:23.153725,epoch time: 0:29:20.604399,used: 2:22:05.664704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96761966, 'precision': 0.77886355, 'recall': 0.55902624, 'specificity': 0.55902624, 'f1': 0.5920758, 'auroc': 0.935989, 'binary_precision': 0.5874587, 'binary_recall': 0.121006116, 'binary_specificity': 0.9970464, 'binary_f1_score': 0.20067644}
confusion matrix:
       0    1
0  42196  125
1   1293  178
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.8864097, 'recall': 0.5223577, 'specificity': 0.5223577, 'f1': 0.5342964, 'auroc': 0.9440466, 'binary_precision': 0.8055556, 'binary_recall': 0.045101088, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.08541974}
confusion matrix:
       0   1
0  18142   7
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89830804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9581335783004761 / 0.9582933783531189
after epoch: 6,now: 2024-05-27 22:23:31.318020,epoch time: 0:28:08.164295,used: 2:50:13.828999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96892124, 'precision': 0.7744273, 'recall': 0.644258, 'specificity': 0.644258, 'f1': 0.68728006, 'auroc': 0.9338264, 'binary_precision': 0.57293034, 'binary_recall': 0.29619566, 'binary_specificity': 0.9923204, 'binary_f1_score': 0.39050606}
confusion matrix:
       0    1
0  41995  325
1   1036  436
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7747322, 'recall': 0.63402706, 'specificity': 0.63402706, 'f1': 0.6779715, 'auroc': 0.94490623, 'binary_precision': 0.5746753, 'binary_recall': 0.27527216, 'binary_specificity': 0.992782, 'binary_f1_score': 0.37223974}
confusion matrix:
       0    1
0  18018  131
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.90455043, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-27 22:50:56.719371,epoch time: 0:27:25.401351,used: 3:17:39.230350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.78871095, 'recall': 0.5448281, 'specificity': 0.5448281, 'f1': 0.5714033, 'auroc': 0.93815565, 'binary_precision': 0.6081081, 'binary_recall': 0.09171195, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.15938607}
confusion matrix:
       0    1
0  42233   87
1   1337  135
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7830423, 'recall': 0.5045554, 'specificity': 0.5045554, 'f1': 0.50051, 'auroc': 0.9457656, 'binary_precision': 0.6, 'binary_recall': 0.00933126, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.018376721}
confusion matrix:
       0  1
0  18145  4
1    637  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.8966249, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9608501195907593
after epoch: 8,now: 2024-05-27 23:17:53.647073,epoch time: 0:26:56.927702,used: 3:44:36.158052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.76253223, 'recall': 0.50793326, 'specificity': 0.50793326, 'f1': 0.5073357, 'auroc': 0.9396068, 'binary_precision': 0.55813956, 'binary_recall': 0.016315432, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.031704098}
confusion matrix:
       0   1
0  42302  19
1   1447  24
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.76504576, 'recall': 0.5378058, 'specificity': 0.5378058, 'f1': 0.5597312, 'auroc': 0.94895643, 'binary_precision': 0.56179774, 'binary_recall': 0.077760495, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.13661201}
confusion matrix:
       0   1
0  18110  39
1    593  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89387417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 2
val acc:0.9663686752319336, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9608501195907593
after epoch: 9,now: 2024-05-27 23:45:26.346930,epoch time: 0:27:32.699857,used: 4:12:08.857909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.784974, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8066478, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6714833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9608501195907593
after epoch: 10,now: 2024-05-28 00:12:58.938153,epoch time: 0:27:32.591223,used: 4:39:41.449132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.74353325, 'recall': 0.63923675, 'specificity': 0.63923675, 'f1': 0.67574894, 'auroc': 0.9233676, 'binary_precision': 0.5114596, 'binary_recall': 0.28804347, 'binary_specificity': 0.99043006, 'binary_f1_score': 0.3685354}
confusion matrix:
       0    1
0  41915  405
1   1048  424
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7692741, 'recall': 0.61497265, 'specificity': 0.61497265, 'f1': 0.658377, 'auroc': 0.93223035, 'binary_precision': 0.5650558, 'binary_recall': 0.23639192, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.33333334}
confusion matrix:
       0    1
0  18032  117
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.9024307, 'recall': 0.5702976, 'specificity': 0.5702976, 'f1': 0.61185277, 'auroc': 0.8967241, 'binary_precision': 0.84090906, 'binary_recall': 0.14176245, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.24262294}
confusion matrix:
      0   1
0  5990   7
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
new oracle model saved
early stop counter: 4
val acc:0.9676458239555359, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.963087260723114
after epoch: 11,now: 2024-05-28 00:39:51.736692,epoch time: 0:26:52.798539,used: 5:06:34.247671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96332663, 'precision': 0.7262652, 'recall': 0.799592, 'specificity': 0.799592, 'f1': 0.7571621, 'auroc': 0.932232, 'binary_precision': 0.46575344, 'binary_recall': 0.6240653, 'binary_specificity': 0.97511876, 'binary_f1_score': 0.53341085}
confusion matrix:
       0     1
0  41268  1053
1    553   918
---- Validation: 
scalar performance:
{'acc': 0.96333545, 'precision': 0.72660214, 'recall': 0.7627522, 'specificity': 0.7627522, 'f1': 0.74317306, 'auroc': 0.94284004, 'binary_precision': 0.46933332, 'binary_recall': 0.5474339, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.505384}
confusion matrix:
       0    1
0  17751  398
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8223706, 'recall': 0.7398747, 'specificity': 0.7398747, 'f1': 0.7743952, 'auroc': 0.89690053, 'binary_precision': 0.6666667, 'binary_recall': 0.49042144, 'binary_specificity': 0.989328, 'binary_f1_score': 0.56512135}
confusion matrix:
      0    1
0  5933   64
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
new oracle model saved
early stop counter: 5
val acc:0.9633354544639587, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9685202836990356
after epoch: 12,now: 2024-05-28 01:07:20.184424,epoch time: 0:27:28.447732,used: 5:34:02.695403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7356725, 'recall': 0.60914165, 'specificity': 0.60914165, 'f1': 0.6469033, 'auroc': 0.93504417, 'binary_precision': 0.49775785, 'binary_recall': 0.22622283, 'binary_specificity': 0.9920605, 'binary_f1_score': 0.3110696}
confusion matrix:
       0    1
0  41984  336
1   1139  333
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7293745, 'recall': 0.52172405, 'specificity': 0.52172405, 'f1': 0.53258, 'auroc': 0.94430566, 'binary_precision': 0.4915254, 'binary_recall': 0.045101088, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.082621075}
confusion matrix:
       0   1
0  18119  30
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9090909, 'recall': 0.5342326, 'specificity': 0.5342326, 'f1': 0.55377585, 'auroc': 0.8986463, 'binary_precision': 0.85714287, 'binary_recall': 0.06896552, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5994   3
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 6
val acc:0.9657300710678101, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9685202836990356
after epoch: 13,now: 2024-05-28 01:34:23.656491,epoch time: 0:27:03.472067,used: 6:01:06.167470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.73848253, 'recall': 0.59349895, 'specificity': 0.59349895, 'f1': 0.6313374, 'auroc': 0.9303651, 'binary_precision': 0.50442475, 'binary_recall': 0.19361413, 'binary_specificity': 0.99338377, 'binary_f1_score': 0.27982327}
confusion matrix:
       0    1
0  42040  280
1   1187  285
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7506741, 'recall': 0.542946, 'specificity': 0.542946, 'f1': 0.56736666, 'auroc': 0.9423355, 'binary_precision': 0.53271025, 'binary_recall': 0.08864697, 'binary_specificity': 0.997245, 'binary_f1_score': 0.15200001}
confusion matrix:
       0   1
0  18099  50
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9124147, 'recall': 0.5361483, 'specificity': 0.5361483, 'f1': 0.5571239, 'auroc': 0.8994243, 'binary_precision': 0.8636364, 'binary_recall': 0.07279693, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.13427562}
confusion matrix:
      0   1
0  5994   3
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 7
val acc:0.9661558270454407, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9685202836990356
after epoch: 14,now: 2024-05-28 02:03:02.081048,epoch time: 0:28:38.424557,used: 6:29:44.592027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9681449, 'precision': 0.7744773, 'recall': 0.59631675, 'specificity': 0.59631675, 'f1': 0.639045, 'auroc': 0.9402847, 'binary_precision': 0.5762376, 'binary_recall': 0.19769022, 'binary_specificity': 0.99494326, 'binary_f1_score': 0.29438543}
confusion matrix:
       0    1
0  42106  214
1   1181  291
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7710406, 'recall': 0.5567776, 'specificity': 0.5567776, 'f1': 0.58842325, 'auroc': 0.9506964, 'binary_precision': 0.57251906, 'binary_recall': 0.11664075, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.19379845}
confusion matrix:
       0   1
0  18093  56
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89021456, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 8
val acc:0.9667943716049194, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9685202836990356
after epoch: 15,now: 2024-05-28 02:31:37.400277,epoch time: 0:28:35.319229,used: 6:58:19.911256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.7480373, 'recall': 0.7542119, 'specificity': 0.7542119, 'f1': 0.7510823, 'auroc': 0.9403751, 'binary_precision': 0.5125828, 'binary_recall': 0.5258152, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.5191146}
confusion matrix:
       0    1
0  41584  736
1    698  774
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7573472, 'recall': 0.69972885, 'specificity': 0.69972885, 'f1': 0.72452354, 'auroc': 0.9496383, 'binary_precision': 0.53535354, 'binary_recall': 0.41213062, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.46572936}
confusion matrix:
       0    1
0  17919  230
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.93554664, 'recall': 0.6239374, 'specificity': 0.6239374, 'f1': 0.6868639, 'auroc': 0.8989899, 'binary_precision': 0.9027778, 'binary_recall': 0.24904214, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.3903904}
confusion matrix:
      0   1
0  5990   7
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 9
val acc:0.9676458239555359, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9608501195907593 / 0.9685202836990356
after epoch: 16,now: 2024-05-28 03:00:12.470455,epoch time: 0:28:35.070178,used: 7:26:54.981434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9681449, 'precision': 0.7549584, 'recall': 0.74171627, 'specificity': 0.74171627, 'f1': 0.7481415, 'auroc': 0.92871016, 'binary_precision': 0.52729887, 'binary_recall': 0.49898028, 'binary_specificity': 0.9844522, 'binary_f1_score': 0.51274884}
confusion matrix:
       0    1
0  41663  658
1    737  734
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.76565546, 'recall': 0.722754, 'specificity': 0.722754, 'f1': 0.74212253, 'auroc': 0.93780017, 'binary_precision': 0.55037314, 'binary_recall': 0.45878693, 'binary_specificity': 0.98672104, 'binary_f1_score': 0.5004241}
confusion matrix:
       0    1
0  17908  241
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8728617, 'recall': 0.6191889, 'specificity': 0.6191889, 'f1': 0.6753391, 'auroc': 0.88256884, 'binary_precision': 0.7777778, 'binary_recall': 0.2413793, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.36842105}
confusion matrix:
      0   1
0  5979  18
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
better model found
persisted
after epoch: 17,now: 2024-05-28 03:28:40.704040,epoch time: 0:28:28.233585,used: 7:55:23.215019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9679394, 'precision': 0.7790586, 'recall': 0.576211, 'specificity': 0.576211, 'f1': 0.6152011, 'auroc': 0.9405794, 'binary_precision': 0.5867347, 'binary_recall': 0.15625, 'binary_specificity': 0.996172, 'binary_f1_score': 0.24678113}
confusion matrix:
       0    1
0  42158  162
1   1242  230
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.75961024, 'recall': 0.5324727, 'specificity': 0.5324727, 'f1': 0.5510264, 'auroc': 0.9479921, 'binary_precision': 0.55128205, 'binary_recall': 0.06687403, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.11927878}
confusion matrix:
       0   1
0  18114  35
1    600  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.8806854, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9662090539932251, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9654842019081116 / 0.9685202836990356
after epoch: 18,now: 2024-05-28 03:57:06.430241,epoch time: 0:28:25.726201,used: 8:23:48.941220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9694693, 'precision': 0.77355325, 'recall': 0.685524, 'specificity': 0.685524, 'f1': 0.7202884, 'auroc': 0.94263375, 'binary_precision': 0.56838906, 'binary_recall': 0.38111413, 'binary_specificity': 0.98993385, 'binary_f1_score': 0.45628303}
confusion matrix:
       0    1
0  41894  426
1    911  561
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.7974912, 'recall': 0.62096685, 'specificity': 0.62096685, 'f1': 0.66894436, 'auroc': 0.9554544, 'binary_precision': 0.62109375, 'binary_recall': 0.24727838, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.35372633}
confusion matrix:
       0    1
0  18052   97
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.8740865, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
better model found
persisted
after epoch: 19,now: 2024-05-28 04:25:18.338502,epoch time: 0:28:11.908261,used: 8:52:00.849481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96882993, 'precision': 0.7797391, 'recall': 0.62191635, 'specificity': 0.62191635, 'f1': 0.66717064, 'auroc': 0.9447168, 'binary_precision': 0.58505565, 'binary_recall': 0.25, 'binary_specificity': 0.9938327, 'binary_f1_score': 0.35030937}
confusion matrix:
       0    1
0  42059  261
1   1104  368
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.83028847, 'recall': 0.5497454, 'specificity': 0.5497454, 'f1': 0.5799586, 'auroc': 0.9497757, 'binary_precision': 0.69148934, 'binary_recall': 0.10108865, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.17639078}
confusion matrix:
       0   1
0  18120  29
1    578  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.92481303, 'recall': 0.5304846, 'specificity': 0.5304846, 'f1': 0.54725534, 'auroc': 0.8990172, 'binary_precision': 0.8888889, 'binary_recall': 0.06130268, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11469534}
confusion matrix:
      0   1
0  5995   2
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9676989912986755, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 20,now: 2024-05-28 04:53:43.194755,epoch time: 0:28:24.856253,used: 9:20:25.705734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.79429126, 'recall': 0.5448754, 'specificity': 0.5448754, 'f1': 0.5716157, 'auroc': 0.9428109, 'binary_precision': 0.61926603, 'binary_recall': 0.09171195, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.1597633}
confusion matrix:
       0    1
0  42237   83
1   1337  135
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7252776, 'recall': 0.5216965, 'specificity': 0.5216965, 'f1': 0.5325074, 'auroc': 0.9516636, 'binary_precision': 0.48333332, 'binary_recall': 0.045101088, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.08250356}
confusion matrix:
       0   1
0  18118  31
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9146217, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 21,now: 2024-05-28 05:22:01.110579,epoch time: 0:28:17.915824,used: 9:48:43.621558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.7715319, 'recall': 0.68907136, 'specificity': 0.68907136, 'f1': 0.7222035, 'auroc': 0.9503881, 'binary_precision': 0.5641026, 'binary_recall': 0.38858697, 'binary_specificity': 0.9895558, 'binary_f1_score': 0.46017703}
confusion matrix:
       0    1
0  41878  442
1    900  572
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.77216005, 'recall': 0.6437778, 'specificity': 0.6437778, 'f1': 0.6863187, 'auroc': 0.95558083, 'binary_precision': 0.56886226, 'binary_recall': 0.29548988, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.38894576}
confusion matrix:
       0    1
0  18005  144
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.84123933, 'recall': 0.5244873, 'specificity': 0.5244873, 'f1': 0.5362575, 'auroc': 0.91597956, 'binary_precision': 0.7222222, 'binary_recall': 0.049808428, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.093189955}
confusion matrix:
      0   1
0  5992   5
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 3
val acc:0.9682311415672302, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 22,now: 2024-05-28 05:50:15.650271,epoch time: 0:28:14.539692,used: 10:16:58.161250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.7807482, 'recall': 0.6845424, 'specificity': 0.6845424, 'f1': 0.7217704, 'auroc': 0.9470211, 'binary_precision': 0.5828092, 'binary_recall': 0.37848878, 'binary_specificity': 0.9905961, 'binary_f1_score': 0.4589352}
confusion matrix:
       0    1
0  41925  398
1    913  556
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.8302676, 'recall': 0.57652074, 'specificity': 0.57652074, 'f1': 0.61891353, 'auroc': 0.9530789, 'binary_precision': 0.6896552, 'binary_recall': 0.15552099, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.2538071}
confusion matrix:
       0    1
0  18104   45
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.891505, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 4
val acc:0.9687100648880005, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 23,now: 2024-05-28 06:18:42.408216,epoch time: 0:28:26.757945,used: 10:45:24.919195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.8429979, 'recall': 0.53149223, 'specificity': 0.53149223, 'f1': 0.55041146, 'auroc': 0.9443998, 'binary_precision': 0.71755725, 'binary_recall': 0.063858695, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.1172801}
confusion matrix:
       0   1
0  42283  37
1   1378  94
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.8012498, 'recall': 0.505333, 'specificity': 0.505333, 'f1': 0.5020383, 'auroc': 0.956638, 'binary_precision': 0.6363636, 'binary_recall': 0.01088647, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.021406727}
confusion matrix:
       0  1
0  18145  4
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.890914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 5
val acc:0.9659429788589478, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 24,now: 2024-05-28 06:47:04.616276,epoch time: 0:28:22.208060,used: 11:13:47.127255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96773386, 'precision': 0.7517529, 'recall': 0.72837996, 'specificity': 0.72837996, 'f1': 0.7394357, 'auroc': 0.9363077, 'binary_precision': 0.5218045, 'binary_recall': 0.4717879, 'binary_specificity': 0.984972, 'binary_f1_score': 0.49553734}
confusion matrix:
       0    1
0  41685  636
1    777  694
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.783719, 'recall': 0.57741475, 'specificity': 0.57741475, 'f1': 0.6170123, 'auroc': 0.9435042, 'binary_precision': 0.5964912, 'binary_recall': 0.15863141, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.25061426}
confusion matrix:
       0    1
0  18080   69
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.90510666, 'recall': 0.61210966, 'specificity': 0.61210966, 'f1': 0.6695075, 'auroc': 0.8889702, 'binary_precision': 0.8428571, 'binary_recall': 0.22605364, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3564955}
confusion matrix:
      0   1
0  5986  11
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 6
val acc:0.967539370059967, best validation acc: 0.9690825939178467, corresponding to test acc:                         0.9584531784057617 / 0.9685202836990356
after epoch: 25,now: 2024-05-28 07:15:33.752623,epoch time: 0:28:29.136347,used: 11:42:16.263602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9693323, 'precision': 0.77429694, 'recall': 0.6692729, 'specificity': 0.6692729, 'f1': 0.70818794, 'auroc': 0.94769025, 'binary_precision': 0.57094973, 'binary_recall': 0.34761906, 'binary_specificity': 0.9909267, 'binary_f1_score': 0.4321353}
confusion matrix:
       0    1
0  41938  384
1    959  511
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.78889394, 'recall': 0.67007864, 'specificity': 0.67007864, 'f1': 0.7127061, 'auroc': 0.9569117, 'binary_precision': 0.60053617, 'binary_recall': 0.34836704, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.44094488}
confusion matrix:
       0    1
0  18000  149
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.9043139, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
better model found
persisted
after epoch: 26,now: 2024-05-28 07:43:57.726442,epoch time: 0:28:23.973819,used: 12:10:40.237421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9701315, 'precision': 0.77198076, 'recall': 0.74979913, 'specificity': 0.74979913, 'f1': 0.76036954, 'auroc': 0.9485198, 'binary_precision': 0.56083083, 'binary_recall': 0.51358694, 'binary_specificity': 0.9860113, 'binary_f1_score': 0.5361702}
confusion matrix:
       0    1
0  41728  592
1    716  756
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.7852632, 'recall': 0.6714685, 'specificity': 0.6714685, 'f1': 0.7128804, 'auroc': 0.953802, 'binary_precision': 0.5931758, 'binary_recall': 0.35147744, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.44140625}
confusion matrix:
       0    1
0  17994  155
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.9092759, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 1
val acc:0.9695615172386169, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9589325785636902 / 0.9685202836990356
after epoch: 27,now: 2024-05-28 08:12:10.355015,epoch time: 0:28:12.628573,used: 12:38:52.865994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9680992, 'precision': 0.7712747, 'recall': 0.60028565, 'specificity': 0.60028565, 'f1': 0.6431112, 'auroc': 0.9294133, 'binary_precision': 0.56954885, 'binary_recall': 0.20598233, 'binary_specificity': 0.994589, 'binary_f1_score': 0.30254617}
confusion matrix:
       0    1
0  42092  229
1   1168  303
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.78055745, 'recall': 0.5614432, 'specificity': 0.5614432, 'f1': 0.59545034, 'auroc': 0.943091, 'binary_precision': 0.5912409, 'binary_recall': 0.125972, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.2076923}
confusion matrix:
       0   1
0  18093  56
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.889768, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9589325785636902 / 0.9685202836990356
after epoch: 28,now: 2024-05-28 08:40:34.190642,epoch time: 0:28:23.835627,used: 13:07:16.701621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.745107, 'recall': 0.51119053, 'specificity': 0.51119053, 'f1': 0.5136053, 'auroc': 0.9284683, 'binary_precision': 0.52307695, 'binary_recall': 0.023113528, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.044270832}
confusion matrix:
       0   1
0  42290  31
1   1437  34
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7332143, 'recall': 0.5097507, 'specificity': 0.5097507, 'f1': 0.5107228, 'auroc': 0.9402603, 'binary_precision': 0.5, 'binary_recall': 0.02021773, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.03886398}
confusion matrix:
       0   1
0  18136  13
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.8823379, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9589325785636902 / 0.9685202836990356
after epoch: 29,now: 2024-05-28 09:08:53.195098,epoch time: 0:28:19.004456,used: 13:35:35.706077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9687157, 'precision': 0.7959312, 'recall': 0.5877599, 'specificity': 0.5877599, 'f1': 0.63109946, 'auroc': 0.94267845, 'binary_precision': 0.6197183, 'binary_recall': 0.17934783, 'binary_specificity': 0.996172, 'binary_f1_score': 0.27818757}
confusion matrix:
       0    1
0  42158  162
1   1208  264
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7439314, 'recall': 0.51880646, 'specificity': 0.51880646, 'f1': 0.52749217, 'auroc': 0.9537927, 'binary_precision': 0.5208333, 'binary_recall': 0.038880248, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.0723589}
confusion matrix:
       0   1
0  18126  23
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.88836855, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897897.png
early stop counter: 4
val acc:0.9658897519111633, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9589325785636902 / 0.9685202836990356
after epoch: 30,now: 2024-05-28 09:35:55.266071,epoch time: 0:27:02.070973,used: 14:02:37.777050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:02:37.777050 at 2024-05-28 09:35:55.266071
persisted model performance metric: 

scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.90428084, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
oracle model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.79869264, 'recall': 0.73121136, 'specificity': 0.73121136, 'f1': 0.76014596, 'auroc': 0.8903866, 'binary_precision': 0.62, 'binary_recall': 0.47509578, 'binary_specificity': 0.987327, 'binary_f1_score': 0.53796095}
confusion matrix:
      0    1
0  5921   76
1   137  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2272 MiB |   2272 MiB |   2272 MiB |      0 B   |
|       from large pool |   2202 MiB |   2202 MiB |   2202 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 294019 KiB | 361588 KiB | 756239 GiB | 756239 GiB |
|       from large pool | 286555 KiB | 357150 KiB | 743248 GiB | 743247 GiB |
|       from small pool |   7464 KiB |  12776 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180478 K  |  180475 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92539 K  |   92535 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180478 K  |  180475 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92539 K  |   92535 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    2781    |   95442 K  |   95442 K  |
|       from large pool |      26    |      89    |   59622 K  |   59622 K  |
|       from small pool |      29    |    2755    |   35820 K  |   35820 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 751616 KiB |   2272 MiB |   2272 MiB |   1538 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  49152 KiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 410731 KiB | 756239 GiB | 756239 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743248 GiB | 743248 GiB |
|       from small pool |      0 KiB |  20484 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92539 K  |   92539 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92539 K  |   92539 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     127    |     127    |      72    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |   95444 K  |   95444 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2755    |   35821 K  |   35821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 751616 KiB |   2272 MiB |   2272 MiB |   1538 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  49152 KiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 410731 KiB | 756239 GiB | 756239 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743248 GiB | 743248 GiB |
|       from small pool |      0 KiB |  20484 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92539 K  |   92539 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92539 K  |   92539 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     127    |     127    |      72    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |   95444 K  |   95444 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2755    |   35821 K  |   35821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897

 Experiment start at: 2024-05-28 09:45:02.952911
before training, model accuracy: 0.701374351978302
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.70637727, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7212572, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.50566334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 10:14:56.787392,epoch time: 0:29:53.834481,used: 0:29:53.834481,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.786188, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7902871, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.57517236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 2,now: 2024-05-28 10:40:58.471434,epoch time: 0:26:01.684042,used: 0:55:55.518523,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9519894, 'precision': 0.47606313, 'recall': 0.4999245, 'specificity': 0.4999245, 'f1': 0.4877021, 'auroc': 0.83386266, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999849, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33114  5
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.951195, 'precision': 0.47562936, 'recall': 0.4999648, 'specificity': 0.4999648, 'f1': 0.48749357, 'auroc': 0.85842097, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999296, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14208  1
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99443716, 'precision': 0.4977724, 'recall': 0.49944124, 'specificity': 0.49944124, 'f1': 0.49860546, 'auroc': 0.6559032, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15195  17
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 2
val acc:0.9511950016021729, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 3,now: 2024-05-28 11:07:13.163525,epoch time: 0:26:14.692091,used: 1:22:10.210614,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95207566, 'precision': 0.47606522, 'recall': 0.4999698, 'specificity': 0.4999698, 'f1': 0.48772478, 'auroc': 0.8175747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999396, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33117  2
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.951195, 'precision': 0.47562936, 'recall': 0.4999648, 'specificity': 0.4999648, 'f1': 0.48749357, 'auroc': 0.8448447, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999296, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14208  1
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.4977731, 'recall': 0.49960557, 'specificity': 0.49960557, 'f1': 0.49868765, 'auroc': 0.62367827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15200  12
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 3
val acc:0.9511950016021729, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 4,now: 2024-05-28 11:34:20.642988,epoch time: 0:27:07.479463,used: 1:49:17.690077,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9519607, 'precision': 0.5760885, 'recall': 0.5004798, 'specificity': 0.5004798, 'f1': 0.4888879, 'auroc': 0.863986, 'binary_precision': 0.2, 'binary_recall': 0.0012012012, 'binary_specificity': 0.9997584, 'binary_f1_score': 0.0023880599}
confusion matrix:
       0  1
0  33111  8
1   1663  2
---- Validation: 
scalar performance:
{'acc': 0.951195, 'precision': 0.47562936, 'recall': 0.4999648, 'specificity': 0.4999648, 'f1': 0.48749357, 'auroc': 0.8889284, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999296, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14208  1
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942408, 'precision': 0.49777195, 'recall': 0.49934262, 'specificity': 0.49934262, 'f1': 0.49855605, 'auroc': 0.70248044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99868524, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15192  20
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 4
val acc:0.9511950016021729, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 5,now: 2024-05-28 12:00:34.749502,epoch time: 0:26:14.106514,used: 2:15:31.796591,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95328313, 'precision': 0.80077195, 'recall': 0.52570176, 'specificity': 0.52570176, 'f1': 0.53687215, 'auroc': 0.9088725, 'binary_precision': 0.64705884, 'binary_recall': 0.052852854, 'binary_specificity': 0.99855065, 'binary_f1_score': 0.097723484}
confusion matrix:
       0   1
0  33071  48
1   1577  88
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.8386431, 'recall': 0.53164685, 'specificity': 0.53164685, 'f1': 0.54725045, 'auroc': 0.9260171, 'binary_precision': 0.72307694, 'binary_recall': 0.06456044, 'binary_specificity': 0.9987332, 'binary_f1_score': 0.11853721}
confusion matrix:
       0   1
0  14191  18
1    681  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.56030643, 'recall': 0.5071229, 'specificity': 0.5071229, 'f1': 0.5119441, 'auroc': 0.82913256, 'binary_precision': 0.125, 'binary_recall': 0.014705882, 'binary_specificity': 0.99953985, 'binary_f1_score': 0.02631579}
confusion matrix:
       0  1
0  15205  7
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
better model found
persisted
after epoch: 6,now: 2024-05-28 12:26:29.485487,epoch time: 0:25:54.735985,used: 2:41:26.532576,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9551518, 'precision': 0.7558972, 'recall': 0.70065707, 'specificity': 0.70065707, 'f1': 0.7244203, 'auroc': 0.92362005, 'binary_precision': 0.54066616, 'binary_recall': 0.41921923, 'binary_specificity': 0.9820949, 'binary_f1_score': 0.47225982}
confusion matrix:
       0    1
0  32526  593
1    967  698
---- Validation: 
scalar performance:
{'acc': 0.9580237, 'precision': 0.7951888, 'recall': 0.67036986, 'specificity': 0.67036986, 'f1': 0.71384853, 'auroc': 0.93590474, 'binary_precision': 0.62287104, 'binary_recall': 0.35164836, 'binary_specificity': 0.9890914, 'binary_f1_score': 0.44951716}
confusion matrix:
       0    1
0  14054  155
1    472  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941099, 'precision': 0.6501107, 'recall': 0.62371814, 'specificity': 0.62371814, 'f1': 0.6356182, 'auroc': 0.8427758, 'binary_precision': 0.30357143, 'binary_recall': 0.25, 'binary_specificity': 0.9974362, 'binary_f1_score': 0.27419353}
confusion matrix:
       0   1
0  15173  39
1     51  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
better model found
persisted
after epoch: 7,now: 2024-05-28 12:53:16.579416,epoch time: 0:26:47.093929,used: 3:08:13.626505,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.66427255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.6997148, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.55888855, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 8,now: 2024-05-28 13:21:49.165855,epoch time: 0:28:32.586439,used: 3:36:46.212944,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.6806233, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7111769, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.600338, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 2
val acc:0.9512619376182556, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 9,now: 2024-05-28 13:48:09.672728,epoch time: 0:26:20.506873,used: 4:03:06.719817,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.7698609, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.77272576, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.65656734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 3
val acc:0.9512619376182556, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 10,now: 2024-05-28 14:14:34.711691,epoch time: 0:26:25.038963,used: 4:29:31.758780,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8734212, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.8924594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8011122, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 4
val acc:0.9512619376182556, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 11,now: 2024-05-28 14:43:25.533612,epoch time: 0:28:50.821921,used: 4:58:22.580701,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9510695, 'precision': 0.7231535, 'recall': 0.63605374, 'specificity': 0.63605374, 'f1': 0.66735625, 'auroc': 0.88375545, 'binary_precision': 0.48140705, 'binary_recall': 0.2876877, 'binary_specificity': 0.9844198, 'binary_f1_score': 0.3601504}
confusion matrix:
       0    1
0  32603  516
1   1186  479
---- Validation: 
scalar performance:
{'acc': 0.95280176, 'precision': 0.7520661, 'recall': 0.59334, 'specificity': 0.59334, 'f1': 0.6313758, 'auroc': 0.8969174, 'binary_precision': 0.5440613, 'binary_recall': 0.19505495, 'binary_specificity': 0.991625, 'binary_f1_score': 0.28715876}
confusion matrix:
       0    1
0  14090  119
1    586  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99443716, 'precision': 0.5454564, 'recall': 0.51408136, 'specificity': 0.51408136, 'f1': 0.52107716, 'auroc': 0.7760966, 'binary_precision': 0.0952381, 'binary_recall': 0.029411765, 'binary_specificity': 0.998751, 'binary_f1_score': 0.04494382}
confusion matrix:
       0   1
0  15193  19
1     66   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 5
val acc:0.9528017640113831, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 12,now: 2024-05-28 15:13:06.922625,epoch time: 0:29:41.389013,used: 5:28:03.969714,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95259315, 'precision': 0.7491235, 'recall': 0.52876186, 'specificity': 0.52876186, 'f1': 0.541908, 'auroc': 0.8961172, 'binary_precision': 0.54347825, 'binary_recall': 0.06006006, 'binary_specificity': 0.9974637, 'binary_f1_score': 0.108166575}
confusion matrix:
       0    1
0  33035   84
1   1565  100
---- Validation: 
scalar performance:
{'acc': 0.952467, 'precision': 0.8449296, 'recall': 0.5188789, 'specificity': 0.5188789, 'f1': 0.5243576, 'auroc': 0.9154969, 'binary_precision': 0.7368421, 'binary_recall': 0.03846154, 'binary_specificity': 0.99929625, 'binary_f1_score': 0.07310705}
confusion matrix:
       0   1
0  14199  10
1    700  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9948953, 'precision': 0.5692669, 'recall': 0.51431143, 'specificity': 0.51431143, 'f1': 0.5231106, 'auroc': 0.81934154, 'binary_precision': 0.14285715, 'binary_recall': 0.029411765, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.04878049}
confusion matrix:
       0   1
0  15200  12
1     66   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 6
val acc:0.9524670243263245, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 13,now: 2024-05-28 15:42:28.040464,epoch time: 0:29:21.117839,used: 5:57:25.087553,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9538006, 'precision': 0.749189, 'recall': 0.63064307, 'specificity': 0.63064307, 'f1': 0.6687873, 'auroc': 0.9026147, 'binary_precision': 0.53403753, 'binary_recall': 0.27327326, 'binary_specificity': 0.9880129, 'binary_f1_score': 0.36154148}
confusion matrix:
       0    1
0  32722  397
1   1210  455
---- Validation: 
scalar performance:
{'acc': 0.952467, 'precision': 0.76356864, 'recall': 0.5475504, 'specificity': 0.5475504, 'f1': 0.5720762, 'auroc': 0.91200125, 'binary_precision': 0.5714286, 'binary_recall': 0.0989011, 'binary_specificity': 0.9961996, 'binary_f1_score': 0.16861828}
confusion matrix:
       0   1
0  14155  54
1    656  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.7121578, 'recall': 0.52192736, 'specificity': 0.52192736, 'f1': 0.5388683, 'auroc': 0.8017558, 'binary_precision': 0.42857143, 'binary_recall': 0.04411765, 'binary_specificity': 0.999737, 'binary_f1_score': 0.08}
confusion matrix:
       0  1
0  15208  4
1     65  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 7
val acc:0.9524670243263245, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 14,now: 2024-05-28 16:08:28.584035,epoch time: 0:26:00.543571,used: 6:23:25.631124,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9529094, 'precision': 0.7697525, 'recall': 0.5269315, 'specificity': 0.5269315, 'f1': 0.5388972, 'auroc': 0.902457, 'binary_precision': 0.5849057, 'binary_recall': 0.055855855, 'binary_specificity': 0.9980072, 'binary_f1_score': 0.10197368}
confusion matrix:
       0   1
0  33053  66
1   1572  93
---- Validation: 
scalar performance:
{'acc': 0.95206535, 'precision': 0.86252856, 'recall': 0.5114999, 'specificity': 0.5114999, 'f1': 0.51037437, 'auroc': 0.911124, 'binary_precision': 0.77272725, 'binary_recall': 0.023351649, 'binary_specificity': 0.9996481, 'binary_f1_score': 0.045333333}
confusion matrix:
       0   1
0  14204   5
1    711  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.49777427, 'recall': 0.4998685, 'specificity': 0.4998685, 'f1': 0.49881923, 'auroc': 0.7892245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999737, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15208  4
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 8
val acc:0.9520653486251831, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 15,now: 2024-05-28 16:34:38.671565,epoch time: 0:26:10.087530,used: 6:49:35.718654,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9537718, 'precision': 0.76354825, 'recall': 0.56816846, 'specificity': 0.56816846, 'f1': 0.6015483, 'auroc': 0.89613044, 'binary_precision': 0.5686747, 'binary_recall': 0.14174174, 'binary_specificity': 0.9945952, 'binary_f1_score': 0.22692308}
confusion matrix:
       0    1
0  32940  179
1   1429  236
---- Validation: 
scalar performance:
{'acc': 0.9534043, 'precision': 0.818416, 'recall': 0.5402235, 'specificity': 0.5402235, 'f1': 0.56155336, 'auroc': 0.91322714, 'binary_precision': 0.6818182, 'binary_recall': 0.082417585, 'binary_specificity': 0.9980294, 'binary_f1_score': 0.14705883}
confusion matrix:
       0   1
0  14181  28
1    668  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99149215, 'precision': 0.5199224, 'recall': 0.5199224, 'specificity': 0.5199224, 'f1': 0.5199224, 'auroc': 0.8084941, 'binary_precision': 0.04411765, 'binary_recall': 0.04411765, 'binary_specificity': 0.99572706, 'binary_f1_score': 0.04411765}
confusion matrix:
       0   1
0  15147  65
1     65   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 9
val acc:0.9534043073654175, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 16,now: 2024-05-28 17:01:49.022028,epoch time: 0:27:10.350463,used: 7:16:46.069117,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95365685, 'precision': 0.7839081, 'recall': 0.5421546, 'specificity': 0.5421546, 'f1': 0.5643241, 'auroc': 0.91763127, 'binary_precision': 0.6118143, 'binary_recall': 0.08708709, 'binary_specificity': 0.9972221, 'binary_f1_score': 0.15247108}
confusion matrix:
       0    1
0  33027   92
1   1520  145
---- Validation: 
scalar performance:
{'acc': 0.95293564, 'precision': 0.77720046, 'recall': 0.5504032, 'specificity': 0.5504032, 'f1': 0.57677615, 'auroc': 0.92156553, 'binary_precision': 0.5984252, 'binary_recall': 0.104395606, 'binary_specificity': 0.9964107, 'binary_f1_score': 0.17777777}
confusion matrix:
       0   1
0  14158  51
1    652  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99541885, 'precision': 0.622807, 'recall': 0.5072543, 'specificity': 0.5072543, 'f1': 0.5127409, 'auroc': 0.811795, 'binary_precision': 0.25, 'binary_recall': 0.014705882, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.027777776}
confusion matrix:
       0  1
0  15209  3
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 10
val acc:0.9529356360435486, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 17,now: 2024-05-28 17:28:54.900125,epoch time: 0:27:05.878097,used: 7:43:51.947214,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9530244, 'precision': 0.7407937, 'recall': 0.6721603, 'specificity': 0.6721603, 'f1': 0.69987786, 'auroc': 0.90429544, 'binary_precision': 0.513214, 'binary_recall': 0.36156157, 'binary_specificity': 0.9827591, 'binary_f1_score': 0.42424244}
confusion matrix:
       0    1
0  32548  571
1   1063  602
---- Validation: 
scalar performance:
{'acc': 0.9536721, 'precision': 0.7565063, 'recall': 0.6322433, 'specificity': 0.6322433, 'f1': 0.67170715, 'auroc': 0.9075347, 'binary_precision': 0.5491803, 'binary_recall': 0.2760989, 'binary_specificity': 0.98838764, 'binary_f1_score': 0.36745888}
confusion matrix:
       0    1
0  14044  165
1    527  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99482983, 'precision': 0.62840295, 'recall': 0.5435589, 'specificity': 0.5435589, 'f1': 0.56463766, 'auroc': 0.7665378, 'binary_precision': 0.26086956, 'binary_recall': 0.0882353, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.13186814}
confusion matrix:
       0   1
0  15195  17
1     62   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 11
val acc:0.9536721110343933, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 18,now: 2024-05-28 17:56:00.784017,epoch time: 0:27:05.883892,used: 8:10:57.831106,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9549506, 'precision': 0.76867944, 'recall': 0.60843074, 'specificity': 0.60843074, 'f1': 0.65019685, 'auroc': 0.91748714, 'binary_precision': 0.57515335, 'binary_recall': 0.22522523, 'binary_specificity': 0.9916362, 'binary_f1_score': 0.32369444}
confusion matrix:
       0    1
0  32842  277
1   1290  375
---- Validation: 
scalar performance:
{'acc': 0.95293564, 'precision': 0.80261374, 'recall': 0.5360674, 'specificity': 0.5360674, 'f1': 0.5544901, 'auroc': 0.9303259, 'binary_precision': 0.6506024, 'binary_recall': 0.07417583, 'binary_specificity': 0.997959, 'binary_f1_score': 0.13316894}
confusion matrix:
       0   1
0  14180  29
1    674  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.58114004, 'recall': 0.5071886, 'specificity': 0.5071886, 'f1': 0.5123327, 'auroc': 0.84813, 'binary_precision': 0.16666667, 'binary_recall': 0.014705882, 'binary_specificity': 0.99967134, 'binary_f1_score': 0.027027028}
confusion matrix:
       0  1
0  15207  5
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 12
val acc:0.9529356360435486, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 19,now: 2024-05-28 18:22:36.835873,epoch time: 0:26:36.051856,used: 8:37:33.882962,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95512307, 'precision': 0.7837336, 'recall': 0.58541983, 'specificity': 0.58541983, 'f1': 0.6252309, 'auroc': 0.9254718, 'binary_precision': 0.607438, 'binary_recall': 0.17657657, 'binary_specificity': 0.9942631, 'binary_f1_score': 0.27361563}
confusion matrix:
       0    1
0  32929  190
1   1371  294
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.83269703, 'recall': 0.5652133, 'specificity': 0.5652133, 'f1': 0.60057336, 'auroc': 0.9367167, 'binary_precision': 0.7080292, 'binary_recall': 0.13324176, 'binary_specificity': 0.9971849, 'binary_f1_score': 0.22427745}
confusion matrix:
       0   1
0  14169  40
1    631  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.59783894, 'recall': 0.5144429, 'specificity': 0.5144429, 'f1': 0.5244272, 'auroc': 0.87140954, 'binary_precision': 0.2, 'binary_recall': 0.029411765, 'binary_specificity': 0.9994741, 'binary_f1_score': 0.051282052}
confusion matrix:
       0  1
0  15204  8
1     66  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 13
val acc:0.9550780057907104, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 20,now: 2024-05-28 18:48:46.172661,epoch time: 0:26:09.336788,used: 9:03:43.219750,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95420307, 'precision': 0.8206384, 'recall': 0.539019, 'specificity': 0.539019, 'f1': 0.55978024, 'auroc': 0.9232862, 'binary_precision': 0.685567, 'binary_recall': 0.07987988, 'binary_specificity': 0.99815816, 'binary_f1_score': 0.14308769}
confusion matrix:
       0    1
0  33058   61
1   1532  133
---- Validation: 
scalar performance:
{'acc': 0.95467633, 'precision': 0.8472775, 'recall': 0.55327296, 'specificity': 0.55327296, 'f1': 0.58295405, 'auroc': 0.93079793, 'binary_precision': 0.7383177, 'binary_recall': 0.108516484, 'binary_specificity': 0.9980294, 'binary_f1_score': 0.18922158}
confusion matrix:
       0   1
0  14181  28
1    649  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.56030643, 'recall': 0.5071229, 'specificity': 0.5071229, 'f1': 0.5119441, 'auroc': 0.7383154, 'binary_precision': 0.125, 'binary_recall': 0.014705882, 'binary_specificity': 0.99953985, 'binary_f1_score': 0.02631579}
confusion matrix:
       0  1
0  15205  7
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 14
val acc:0.9546763300895691, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 21,now: 2024-05-28 19:16:12.205305,epoch time: 0:27:26.032644,used: 9:31:09.252394,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95713544, 'precision': 0.777619, 'recall': 0.669756, 'specificity': 0.669756, 'f1': 0.70890987, 'auroc': 0.92333364, 'binary_precision': 0.58717436, 'binary_recall': 0.35195196, 'binary_specificity': 0.98756003, 'binary_f1_score': 0.44010514}
confusion matrix:
       0    1
0  32707  412
1   1079  586
---- Validation: 
scalar performance:
{'acc': 0.9552788, 'precision': 0.8012955, 'recall': 0.5900806, 'specificity': 0.5900806, 'f1': 0.63238055, 'auroc': 0.93195593, 'binary_precision': 0.64285713, 'binary_recall': 0.18543956, 'binary_specificity': 0.99472165, 'binary_f1_score': 0.2878465}
confusion matrix:
       0    1
0  14134   75
1    593  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.6692484, 'recall': 0.5947665, 'specificity': 0.5947665, 'f1': 0.62132806, 'auroc': 0.81578785, 'binary_precision': 0.34210527, 'binary_recall': 0.19117647, 'binary_specificity': 0.9983566, 'binary_f1_score': 0.24528302}
confusion matrix:
       0   1
0  15187  25
1     55  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 15
val acc:0.9552788138389587, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 22,now: 2024-05-28 19:42:21.750047,epoch time: 0:26:09.544742,used: 9:57:18.797136,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9547493, 'precision': 0.82756805, 'recall': 0.54700637, 'specificity': 0.54700637, 'f1': 0.57284796, 'auroc': 0.9267652, 'binary_precision': 0.69868994, 'binary_recall': 0.0960961, 'binary_specificity': 0.9979166, 'binary_f1_score': 0.1689546}
confusion matrix:
       0    1
0  33050   69
1   1505  160
---- Validation: 
scalar performance:
{'acc': 0.95373905, 'precision': 0.85407376, 'recall': 0.5371413, 'specificity': 0.5371413, 'f1': 0.5567803, 'auroc': 0.93178535, 'binary_precision': 0.75342464, 'binary_recall': 0.07554945, 'binary_specificity': 0.9987332, 'binary_f1_score': 0.13732834}
confusion matrix:
       0   1
0  14191  18
1    673  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.74780726, 'recall': 0.50732005, 'specificity': 0.50732005, 'f1': 0.5131706, 'auroc': 0.87346554, 'binary_precision': 0.5, 'binary_recall': 0.014705882, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.028571429}
confusion matrix:
       0  1
0  15211  1
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 16
val acc:0.9537390470504761, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 23,now: 2024-05-28 20:08:32.473292,epoch time: 0:26:10.723245,used: 10:23:29.520381,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9539731, 'precision': 0.83278394, 'recall': 0.53176814, 'specificity': 0.53176814, 'f1': 0.54762334, 'auroc': 0.93062806, 'binary_precision': 0.7105263, 'binary_recall': 0.06486487, 'binary_specificity': 0.9986715, 'binary_f1_score': 0.11887727}
confusion matrix:
       0    1
0  33075   44
1   1557  108
---- Validation: 
scalar performance:
{'acc': 0.9538729, 'precision': 0.8348136, 'recall': 0.54372793, 'specificity': 0.54372793, 'f1': 0.5675082, 'auroc': 0.934651, 'binary_precision': 0.71428573, 'binary_recall': 0.08928572, 'binary_specificity': 0.9981702, 'binary_f1_score': 0.15873015}
confusion matrix:
       0   1
0  14183  26
1    663  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99541885, 'precision': 0.49777457, 'recall': 0.49993426, 'specificity': 0.49993426, 'f1': 0.4988521, 'auroc': 0.8144381, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998685, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15210  2
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 17
val acc:0.9538729190826416, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 24,now: 2024-05-28 20:34:28.667850,epoch time: 0:25:56.194558,used: 10:49:25.714939,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95293814, 'precision': 0.74402404, 'recall': 0.80102694, 'specificity': 0.80102694, 'f1': 0.769007, 'auroc': 0.92346275, 'binary_precision': 0.5067308, 'binary_recall': 0.63303304, 'binary_specificity': 0.9690208, 'binary_f1_score': 0.56288385}
confusion matrix:
       0     1
0  32093  1026
1    611  1054
---- Validation: 
scalar performance:
{'acc': 0.95306957, 'precision': 0.7482495, 'recall': 0.80916834, 'specificity': 0.80916834, 'f1': 0.77477163, 'auroc': 0.9390435, 'binary_precision': 0.51468986, 'binary_recall': 0.64972526, 'binary_specificity': 0.9686114, 'binary_f1_score': 0.57437766}
confusion matrix:
       0    1
0  13763  446
1    255  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9882199, 'precision': 0.5666282, 'recall': 0.6500402, 'specificity': 0.6500402, 'f1': 0.591628, 'auroc': 0.8285078, 'binary_precision': 0.13636364, 'binary_recall': 0.30882353, 'binary_specificity': 0.9912569, 'binary_f1_score': 0.18918921}
confusion matrix:
       0    1
0  15079  133
1     47   21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 18
val acc:0.9530695676803589, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 25,now: 2024-05-28 21:00:29.767890,epoch time: 0:26:01.100040,used: 11:15:26.814979,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9546343, 'precision': 0.8442273, 'recall': 0.54038626, 'specificity': 0.54038626, 'f1': 0.5623225, 'auroc': 0.9317838, 'binary_precision': 0.7326203, 'binary_recall': 0.08228228, 'binary_specificity': 0.9984903, 'binary_f1_score': 0.14794816}
confusion matrix:
       0    1
0  33069   50
1   1528  137
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.8810854, 'recall': 0.52578217, 'specificity': 0.52578217, 'f1': 0.5370215, 'auroc': 0.93607295, 'binary_precision': 0.80851066, 'binary_recall': 0.052197803, 'binary_specificity': 0.9993666, 'binary_f1_score': 0.09806452}
confusion matrix:
       0   1
0  14200   9
1    690  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99051046, 'precision': 0.4977636, 'recall': 0.4974691, 'specificity': 0.4974691, 'f1': 0.49761632, 'auroc': 0.8145226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9949382, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15135  77
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 19
val acc:0.9532034397125244, best validation acc: 0.958023726940155, corresponding to test acc:                         0.9941099286079407 / 0.995549738407135
after epoch: 26,now: 2024-05-28 21:26:42.941345,epoch time: 0:26:13.173455,used: 11:41:39.988434,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95702046, 'precision': 0.7923529, 'recall': 0.6272003, 'specificity': 0.6272003, 'f1': 0.67334235, 'auroc': 0.9374887, 'binary_precision': 0.6207386, 'binary_recall': 0.26246247, 'binary_specificity': 0.9919382, 'binary_f1_score': 0.36893204}
confusion matrix:
       0    1
0  32852  267
1   1228  437
---- Validation: 
scalar performance:
{'acc': 0.9585593, 'precision': 0.8256172, 'recall': 0.63416046, 'specificity': 0.63416046, 'f1': 0.68554485, 'auroc': 0.93858576, 'binary_precision': 0.68728524, 'binary_recall': 0.2747253, 'binary_specificity': 0.9935956, 'binary_f1_score': 0.39254174}
confusion matrix:
       0    1
0  14118   91
1    528  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469894, 'precision': 0.57681775, 'recall': 0.52153295, 'specificity': 0.52153295, 'f1': 0.5331537, 'auroc': 0.859556, 'binary_precision': 0.15789473, 'binary_recall': 0.04411765, 'binary_specificity': 0.9989482, 'binary_f1_score': 0.06896552}
confusion matrix:
       0   1
0  15196  16
1     65   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
better model found
persisted
after epoch: 27,now: 2024-05-28 21:52:36.509950,epoch time: 0:25:53.568605,used: 12:07:33.557039,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.955813, 'precision': 0.80294055, 'recall': 0.58264494, 'specificity': 0.58264494, 'f1': 0.6231786, 'auroc': 0.9325938, 'binary_precision': 0.6461187, 'binary_recall': 0.16996998, 'binary_specificity': 0.9953199, 'binary_f1_score': 0.26913935}
confusion matrix:
       0    1
0  32964  155
1   1382  283
---- Validation: 
scalar performance:
{'acc': 0.9564839, 'precision': 0.84168017, 'recall': 0.58484936, 'specificity': 0.58484936, 'f1': 0.62847185, 'auroc': 0.936406, 'binary_precision': 0.7241379, 'binary_recall': 0.17307693, 'binary_specificity': 0.99662185, 'binary_f1_score': 0.27937916}
confusion matrix:
       0    1
0  14161   48
1    602  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.74793714, 'recall': 0.53660035, 'specificity': 0.53660035, 'f1': 0.5629872, 'auroc': 0.8194841, 'binary_precision': 0.5, 'binary_recall': 0.073529415, 'binary_specificity': 0.99967134, 'binary_f1_score': 0.12820514}
confusion matrix:
       0  1
0  15207  5
1     63  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 1
val acc:0.9564839005470276, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9946989417076111 / 0.995549738407135
after epoch: 28,now: 2024-05-28 22:18:38.919508,epoch time: 0:26:02.409558,used: 12:33:35.966597,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.7911061, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.837484, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.7077795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 2
val acc:0.9512619376182556, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9946989417076111 / 0.995549738407135
after epoch: 29,now: 2024-05-28 22:44:37.968846,epoch time: 0:25:59.049338,used: 12:59:35.015935,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95681924, 'precision': 0.8112788, 'recall': 0.5977187, 'specificity': 0.5977187, 'f1': 0.6427742, 'auroc': 0.936761, 'binary_precision': 0.66138613, 'binary_recall': 0.2006006, 'binary_specificity': 0.9948368, 'binary_f1_score': 0.3078341}
confusion matrix:
       0    1
0  32948  171
1   1331  334
---- Validation: 
scalar performance:
{'acc': 0.957689, 'precision': 0.8139603, 'recall': 0.6297932, 'specificity': 0.6297932, 'f1': 0.6792444, 'auroc': 0.93582904, 'binary_precision': 0.6643836, 'binary_recall': 0.26648352, 'binary_specificity': 0.99310297, 'binary_f1_score': 0.38039216}
confusion matrix:
       0    1
0  14111   98
1    534  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9943717, 'precision': 0.56036973, 'recall': 0.52136856, 'specificity': 0.52136856, 'f1': 0.53119737, 'auroc': 0.81585383, 'binary_precision': 0.125, 'binary_recall': 0.04411765, 'binary_specificity': 0.9986195, 'binary_f1_score': 0.06521739}
confusion matrix:
       0   1
0  15191  21
1     65   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897897.png
early stop counter: 3
val acc:0.9576889872550964, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9946989417076111 / 0.995549738407135
after epoch: 30,now: 2024-05-28 23:10:41.486147,epoch time: 0:26:03.517301,used: 13:25:38.533236,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_09_45_02_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:25:38.533236 at 2024-05-28 23:10:41.486147
persisted model performance metric: 

scalar performance:
{'acc': 0.99469894, 'precision': 0.59314096, 'recall': 0.528853, 'specificity': 0.528853, 'f1': 0.5436147, 'auroc': 0.856709, 'binary_precision': 0.1904762, 'binary_recall': 0.05882353, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.08988764}
confusion matrix:
       0   1
0  15195  17
1     64   4
oracle model performance metric: 

scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.46413654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458551 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |  43376 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458551 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |  43376 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 448177 KiB |   1998 MiB |   1761 TiB |   1761 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1737 TiB |   1737 TiB |
|       from small pool |  41102 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2260 MiB |   2272 MiB |   3798 MiB |   1538 MiB |
|       from large pool |   2196 MiB |   2202 MiB |   3712 MiB |   1516 MiB |
|       from small pool |     64 MiB |     70 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 370889 KiB | 410731 KiB |   1397 TiB |   1397 TiB |
|       from large pool | 361017 KiB | 402413 KiB |   1372 TiB |   1372 TiB |
|       from small pool |   9871 KiB |  20484 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6866    |    7237    |  343602 K  |  343595 K  |
|       from large pool |     187    |     311    |  167251 K  |  167251 K  |
|       from small pool |    6679    |    6975    |  176350 K  |  176344 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6866    |    7237    |  343602 K  |  343595 K  |
|       from large pool |     187    |     311    |  167251 K  |  167251 K  |
|       from small pool |    6679    |    6975    |  176350 K  |  176344 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     196    |      72    |
|       from large pool |      92    |      92    |     153    |      61    |
|       from small pool |      32    |      35    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    2781    |  182110 K  |  182110 K  |
|       from large pool |      34    |      89    |  114010 K  |  114010 K  |
|       from small pool |      26    |    2755    |   68099 K  |   68099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1761 TiB |   1761 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1737 TiB |   1737 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    810 MiB |   2272 MiB |   3798 MiB |   2988 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 410731 KiB |   1397 TiB |   1397 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1372 TiB |   1372 TiB |
|       from small pool |      0 KiB |  30938 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  343602 K  |  343602 K  |
|       from large pool |       2    |     311    |  167251 K  |  167251 K  |
|       from small pool |       0    |    6975    |  176350 K  |  176350 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  343602 K  |  343602 K  |
|       from large pool |       2    |     311    |  167251 K  |  167251 K  |
|       from small pool |       0    |    6975    |  176350 K  |  176350 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     127    |     196    |     136    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |  182113 K  |  182113 K  |
|       from large pool |       3    |      89    |  114010 K  |  114010 K  |
|       from small pool |       0    |    2755    |   68102 K  |   68102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1764 TiB |   1764 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1740 TiB |   1740 TiB |
|       from small pool |      0 KiB |     61 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1761 TiB |   1761 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1737 TiB |   1737 TiB |
|       from small pool |      0 KiB |     60 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    810 MiB |   2272 MiB |   3798 MiB |   2988 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 410731 KiB |   1397 TiB |   1397 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1372 TiB |   1372 TiB |
|       from small pool |      0 KiB |  30938 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  343602 K  |  343602 K  |
|       from large pool |       2    |     311    |  167251 K  |  167251 K  |
|       from small pool |       0    |    6975    |  176350 K  |  176350 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  343602 K  |  343602 K  |
|       from large pool |       2    |     311    |  167251 K  |  167251 K  |
|       from small pool |       0    |    6975    |  176350 K  |  176350 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     127    |     196    |     136    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |  182113 K  |  182113 K  |
|       from large pool |       3    |      89    |  114010 K  |  114010 K  |
|       from small pool |       0    |    2755    |   68102 K  |   68102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897

 Experiment start at: 2024-05-28 23:23:07.591919
before training, model accuracy: 0.7692731618881226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.7998073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.80195355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.57216966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 23:51:04.281999,epoch time: 0:27:56.690080,used: 0:27:56.690080,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8377489, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8621425, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.51072395, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 2,now: 2024-05-29 00:17:55.689887,epoch time: 0:26:51.407888,used: 0:54:48.097968,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.87812966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8912386, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.74725735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 2
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 3,now: 2024-05-29 00:44:24.823153,epoch time: 0:26:29.133266,used: 1:21:17.231234,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96703273, 'precision': 0.7480211, 'recall': 0.64867616, 'specificity': 0.64867616, 'f1': 0.68465817, 'auroc': 0.9178738, 'binary_precision': 0.51990634, 'binary_recall': 0.30726644, 'binary_specificity': 0.99008584, 'binary_f1_score': 0.38625494}
confusion matrix:
       0    1
0  40945  410
1   1001  444
---- Validation: 
scalar performance:
{'acc': 0.9649842, 'precision': 0.73755103, 'recall': 0.56824267, 'specificity': 0.56824267, 'f1': 0.6016158, 'auroc': 0.9301523, 'binary_precision': 0.50555557, 'binary_recall': 0.1415241, 'binary_specificity': 0.9949612, 'binary_f1_score': 0.22114214}
confusion matrix:
       0   1
0  17574  89
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.814515, 'recall': 0.5272033, 'specificity': 0.5272033, 'f1': 0.5414159, 'auroc': 0.7649256, 'binary_precision': 0.6666667, 'binary_recall': 0.055555556, 'binary_specificity': 0.99885106, 'binary_f1_score': 0.1025641}
confusion matrix:
      0   1
0  6955   8
1   272  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-29 01:11:09.532638,epoch time: 0:26:44.709485,used: 1:48:01.940719,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9678972, 'precision': 0.8542021, 'recall': 0.5369367, 'specificity': 0.5369367, 'f1': 0.5597469, 'auroc': 0.9297261, 'binary_precision': 0.739726, 'binary_recall': 0.07479224, 'binary_specificity': 0.99908113, 'binary_f1_score': 0.13584906}
confusion matrix:
       0    1
0  41318   38
1   1336  108
---- Validation: 
scalar performance:
{'acc': 0.96656835, 'precision': 0.8371521, 'recall': 0.5405903, 'specificity': 0.5405903, 'f1': 0.56529105, 'auroc': 0.941983, 'binary_precision': 0.70666665, 'binary_recall': 0.08242613, 'binary_specificity': 0.99875444, 'binary_f1_score': 0.14763232}
confusion matrix:
       0   1
0  17641  22
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.48013794, 'recall': 0.4999282, 'specificity': 0.4999282, 'f1': 0.48983327, 'auroc': 0.76308787, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6962  1
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
better model found
persisted
after epoch: 5,now: 2024-05-29 01:37:49.066668,epoch time: 0:26:39.534030,used: 2:14:41.474749,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9696963, 'precision': 0.7729192, 'recall': 0.71311253, 'specificity': 0.71311253, 'f1': 0.738969, 'auroc': 0.93270147, 'binary_precision': 0.56529516, 'binary_recall': 0.43797645, 'binary_specificity': 0.98824865, 'binary_f1_score': 0.4935572}
confusion matrix:
       0    1
0  40871  486
1    811  632
---- Validation: 
scalar performance:
{'acc': 0.96809787, 'precision': 0.77478766, 'recall': 0.6762564, 'specificity': 0.6762564, 'f1': 0.71369374, 'auroc': 0.9456108, 'binary_precision': 0.5724816, 'binary_recall': 0.3623639, 'binary_specificity': 0.9901489, 'binary_f1_score': 0.44380954}
confusion matrix:
       0    1
0  17489  174
1    410  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.842101, 'recall': 0.5222104, 'specificity': 0.5222104, 'f1': 0.53262174, 'auroc': 0.7975091, 'binary_precision': 0.7222222, 'binary_recall': 0.045138888, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.084967315}
confusion matrix:
      0   1
0  6958   5
1   275  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
better model found
persisted
after epoch: 6,now: 2024-05-29 02:04:24.361789,epoch time: 0:26:35.295121,used: 2:41:16.769870,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96752334, 'precision': 0.8752652, 'recall': 0.52472353, 'specificity': 0.52472353, 'f1': 0.5386688, 'auroc': 0.93837327, 'binary_precision': 0.7826087, 'binary_recall': 0.04993065, 'binary_specificity': 0.9995164, 'binary_f1_score': 0.09387223}
confusion matrix:
       0   1
0  41338  20
1   1370  72
---- Validation: 
scalar performance:
{'acc': 0.96476567, 'precision': 0.607461, 'recall': 0.50069267, 'specificity': 0.50069267, 'f1': 0.49257857, 'auroc': 0.9487437, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998301, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  17660  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.8258921, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 1
val acc:0.9647656679153442, best validation acc: 0.9680978655815125, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 7,now: 2024-05-29 02:31:05.986473,epoch time: 0:26:41.624684,used: 3:07:58.394554,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9700934, 'precision': 0.7971403, 'recall': 0.6459189, 'specificity': 0.6459189, 'f1': 0.6935453, 'auroc': 0.93108, 'binary_precision': 0.6183644, 'binary_recall': 0.2982699, 'binary_specificity': 0.9935679, 'binary_f1_score': 0.4024276}
confusion matrix:
       0    1
0  41089  266
1   1014  431
---- Validation: 
scalar performance:
{'acc': 0.9686988, 'precision': 0.8308718, 'recall': 0.5971423, 'specificity': 0.5971423, 'f1': 0.645561, 'auroc': 0.9423675, 'binary_precision': 0.6902174, 'binary_recall': 0.19751166, 'binary_specificity': 0.99677294, 'binary_f1_score': 0.3071342}
confusion matrix:
       0    1
0  17606   57
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.85533667, 'recall': 0.50513655, 'specificity': 0.50513655, 'f1': 0.50021064, 'auroc': 0.8556078, 'binary_precision': 0.75, 'binary_recall': 0.010416667, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.020547945}
confusion matrix:
      0  1
0  6962  1
1   285  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
better model found
persisted
after epoch: 8,now: 2024-05-29 02:58:49.992955,epoch time: 0:27:44.006482,used: 3:35:42.401036,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9687383, 'precision': 0.797476, 'recall': 0.59117335, 'specificity': 0.59117335, 'f1': 0.63539964, 'auroc': 0.94231355, 'binary_precision': 0.6226852, 'binary_recall': 0.18628809, 'binary_specificity': 0.9960586, 'binary_f1_score': 0.2867804}
confusion matrix:
       0    1
0  41193  163
1   1175  269
---- Validation: 
scalar performance:
{'acc': 0.96656835, 'precision': 0.87976336, 'recall': 0.53234804, 'specificity': 0.53234804, 'f1': 0.551825, 'auroc': 0.94943047, 'binary_precision': 0.7924528, 'binary_recall': 0.065318815, 'binary_specificity': 0.99937725, 'binary_f1_score': 0.120689645}
confusion matrix:
       0   1
0  17652  11
1    601  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.9802069, 'recall': 0.5017361, 'specificity': 0.5017361, 'f1': 0.49336383, 'auroc': 0.85593694, 'binary_precision': 1.0, 'binary_recall': 0.0034722222, 'binary_specificity': 1.0, 'binary_f1_score': 0.0069204154}
confusion matrix:
      0  1
0  6963  0
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 1
val acc:0.9665683507919312, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 9,now: 2024-05-29 03:25:35.101610,epoch time: 0:26:45.108655,used: 4:02:27.509691,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96404207, 'precision': 0.7323271, 'recall': 0.8203232, 'specificity': 0.8203232, 'f1': 0.76842535, 'auroc': 0.9312093, 'binary_precision': 0.4764735, 'binary_recall': 0.666205, 'binary_specificity': 0.9744414, 'binary_f1_score': 0.55558765}
confusion matrix:
       0     1
0  40299  1057
1    482   962
---- Validation: 
scalar performance:
{'acc': 0.964711, 'precision': 0.74227476, 'recall': 0.8033805, 'specificity': 0.8033805, 'f1': 0.7689717, 'auroc': 0.9376005, 'binary_precision': 0.49815497, 'binary_recall': 0.62986004, 'binary_specificity': 0.9769009, 'binary_f1_score': 0.55631864}
confusion matrix:
       0    1
0  17255  408
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.7312162, 'recall': 0.58813626, 'specificity': 0.58813626, 'f1': 0.62393403, 'auroc': 0.85149556, 'binary_precision': 0.49532712, 'binary_recall': 0.18402778, 'binary_specificity': 0.9922447, 'binary_f1_score': 0.26835442}
confusion matrix:
      0   1
0  6909  54
1   235  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 2
val acc:0.9647110104560852, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 10,now: 2024-05-29 03:52:16.427978,epoch time: 0:26:41.326368,used: 4:29:08.836059,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.8693868, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.88054377, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.7190814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 3
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 11,now: 2024-05-29 04:18:50.219136,epoch time: 0:26:33.791158,used: 4:55:42.627217,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9624766, 'precision': 0.7180463, 'recall': 0.75451195, 'specificity': 0.75451195, 'f1': 0.73469204, 'auroc': 0.92393786, 'binary_precision': 0.45256335, 'binary_recall': 0.5314879, 'binary_specificity': 0.97753596, 'binary_f1_score': 0.4888606}
confusion matrix:
       0    1
0  40426  929
1    677  768
---- Validation: 
scalar performance:
{'acc': 0.96416473, 'precision': 0.7364202, 'recall': 0.749148, 'specificity': 0.749148, 'f1': 0.74259675, 'auroc': 0.9372572, 'binary_precision': 0.4904271, 'binary_recall': 0.5178849, 'binary_specificity': 0.98041105, 'binary_f1_score': 0.5037822}
confusion matrix:
       0    1
0  17317  346
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.7676637, 'recall': 0.54710317, 'specificity': 0.54710317, 'f1': 0.57316726, 'auroc': 0.8019099, 'binary_precision': 0.5714286, 'binary_recall': 0.097222224, 'binary_specificity': 0.99698406, 'binary_f1_score': 0.16617212}
confusion matrix:
      0   1
0  6942  21
1   260  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 4
val acc:0.9641647338867188, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 12,now: 2024-05-29 04:45:29.666768,epoch time: 0:26:39.447632,used: 5:22:22.074849,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.892421, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8908397, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.7593597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 5
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 13,now: 2024-05-29 05:12:14.956250,epoch time: 0:26:45.289482,used: 5:49:07.364331,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96752334, 'precision': 0.7588235, 'recall': 0.609993, 'specificity': 0.609993, 'f1': 0.65166265, 'auroc': 0.9366139, 'binary_precision': 0.5440932, 'binary_recall': 0.22661123, 'binary_specificity': 0.99337476, 'binary_f1_score': 0.31996086}
confusion matrix:
       0    1
0  41083  274
1   1116  327
---- Validation: 
scalar performance:
{'acc': 0.9665137, 'precision': 0.7747629, 'recall': 0.5832719, 'specificity': 0.5832719, 'f1': 0.6234864, 'auroc': 0.9469514, 'binary_precision': 0.57894737, 'binary_recall': 0.1710731, 'binary_specificity': 0.99547076, 'binary_f1_score': 0.26410565}
confusion matrix:
       0    1
0  17583   80
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600055, 'precision': 0.6678258, 'recall': 0.5048493, 'specificity': 0.5048493, 'f1': 0.4999282, 'auroc': 0.8153074, 'binary_precision': 0.375, 'binary_recall': 0.010416667, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.020270271}
confusion matrix:
      0  1
0  6958  5
1   285  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 6
val acc:0.9665136933326721, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 14,now: 2024-05-29 05:38:50.639882,epoch time: 0:26:35.683632,used: 6:15:43.047963,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.7857952, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.806064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.5193982, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 7
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 15,now: 2024-05-29 06:05:34.169414,epoch time: 0:26:43.529532,used: 6:42:26.577495,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.8276888, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.84008545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.5776658, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 8
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 16,now: 2024-05-29 06:32:09.397150,epoch time: 0:26:35.227736,used: 7:09:01.805231,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8832495, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.89575064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.64466834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 9
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 17,now: 2024-05-29 06:58:52.324459,epoch time: 0:26:42.927309,used: 7:35:44.732540,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.7488568, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.7504766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.4378736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 10
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 18,now: 2024-05-29 07:25:47.662143,epoch time: 0:26:55.337684,used: 8:02:40.070224,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.87433255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.88610506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.6289123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 11
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 19,now: 2024-05-29 07:52:16.827902,epoch time: 0:26:29.165759,used: 8:29:09.235983,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.91120994, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.92203295, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.73263836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 12
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 20,now: 2024-05-29 08:18:58.284977,epoch time: 0:26:41.457075,used: 8:55:50.693058,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96313083, 'precision': 0.7132399, 'recall': 0.6880644, 'specificity': 0.6880644, 'f1': 0.6997661, 'auroc': 0.9161376, 'binary_precision': 0.44759652, 'binary_recall': 0.39307958, 'binary_specificity': 0.9830492, 'binary_f1_score': 0.41857037}
confusion matrix:
       0    1
0  40654  701
1    877  568
---- Validation: 
scalar performance:
{'acc': 0.96482027, 'precision': 0.7410941, 'recall': 0.7562313, 'specificity': 0.7562313, 'f1': 0.74840415, 'auroc': 0.9361981, 'binary_precision': 0.49927008, 'binary_recall': 0.5318818, 'binary_specificity': 0.98058087, 'binary_f1_score': 0.51506025}
confusion matrix:
       0    1
0  17320  343
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582127, 'precision': 0.65133435, 'recall': 0.52555174, 'specificity': 0.52555174, 'f1': 0.5370673, 'auroc': 0.83952916, 'binary_precision': 0.34042552, 'binary_recall': 0.055555556, 'binary_specificity': 0.9955479, 'binary_f1_score': 0.09552239}
confusion matrix:
      0   1
0  6932  31
1   272  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 13
val acc:0.9648202657699585, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 21,now: 2024-05-29 08:45:47.038487,epoch time: 0:26:48.753510,used: 9:22:39.446568,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.9042071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9212735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.73421407, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 14
val acc:0.9648749232292175, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 22,now: 2024-05-29 09:12:30.916087,epoch time: 0:26:43.877600,used: 9:49:23.324168,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96621495, 'precision': 0.7305542, 'recall': 0.513679, 'specificity': 0.513679, 'f1': 0.5182327, 'auroc': 0.92600286, 'binary_precision': 0.4939759, 'binary_recall': 0.028373701, 'binary_specificity': 0.9989844, 'binary_f1_score': 0.053664923}
confusion matrix:
       0   1
0  41313  42
1   1404  41
---- Validation: 
scalar performance:
{'acc': 0.96585816, 'precision': 0.7564636, 'recall': 0.58742803, 'specificity': 0.58742803, 'f1': 0.6266159, 'auroc': 0.94281936, 'binary_precision': 0.5420561, 'binary_recall': 0.18040435, 'binary_specificity': 0.9944517, 'binary_f1_score': 0.27071178}
confusion matrix:
       0    1
0  17565   98
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.7303313, 'recall': 0.5049929, 'specificity': 0.5049929, 'f1': 0.50006896, 'auroc': 0.7797395, 'binary_precision': 0.5, 'binary_recall': 0.010416667, 'binary_specificity': 0.9995692, 'binary_f1_score': 0.020408163}
confusion matrix:
      0  1
0  6960  3
1   285  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 15
val acc:0.9658581614494324, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 23,now: 2024-05-29 09:40:58.291153,epoch time: 0:28:27.375066,used: 10:17:50.699234,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96654207, 'precision': 0.7415278, 'recall': 0.65119004, 'specificity': 0.65119004, 'f1': 0.68489397, 'auroc': 0.9253224, 'binary_precision': 0.50672644, 'binary_recall': 0.3130194, 'binary_specificity': 0.9893607, 'binary_f1_score': 0.3869863}
confusion matrix:
       0    1
0  40916  440
1    992  452
---- Validation: 
scalar performance:
{'acc': 0.96782476, 'precision': 0.78205985, 'recall': 0.6341542, 'specificity': 0.6341542, 'f1': 0.67944235, 'auroc': 0.9421589, 'binary_precision': 0.59, 'binary_recall': 0.27527216, 'binary_specificity': 0.99303627, 'binary_f1_score': 0.37539765}
confusion matrix:
       0    1
0  17540  123
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.75187755, 'recall': 0.5452234, 'specificity': 0.5452234, 'f1': 0.5698562, 'auroc': 0.7101686, 'binary_precision': 0.54, 'binary_recall': 0.09375, 'binary_specificity': 0.9966968, 'binary_f1_score': 0.15976332}
confusion matrix:
      0   1
0  6940  23
1   261  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897897.png
early stop counter: 16
val acc:0.9678247570991516, best validation acc: 0.9686987996101379, corresponding to test acc:                         0.9605571627616882 / 0.961384654045105
after epoch: 24,now: 2024-05-29 10:10:30.553817,epoch time: 0:29:32.262664,used: 10:47:22.961898,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_23_23_07_seed_0_20897897
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9676635, 'precision': 0.77704793, 'recall': 0.5721986, 'specificity': 0.5721986, 'f1': 0.60984266, 'auroc': 0.9282086, 'binary_precision': 0.5831063, 'binary_recall': 0.14809689, 'binary_specificity': 0.99630034, 'binary_f1_score': 0.23620307}
confusion matrix:
       0    1
0  41202  153
1   1231  214
---- Validation: 
scalar performance:
{'acc': 0.9679886, 'precision': 0.8040911, 'recall': 0.6012701, 'specificity': 0.6012701, 'f1': 0.64790976, 'auroc': 0.9412025, 'binary_precision': 0.6363636, 'binary_recall': 0.20684293, 'binary_specificity': 0.9956972, 'binary_f1_score': 0.3122066}
confusion matrix:
       0    1
0  17587   76
1    510  133
---- Test Domain (oracle): 
slurmstepd: error: *** JOB 20897897 ON gpusrv39 CANCELLED AT 2024-05-29T10:35:53 ***
