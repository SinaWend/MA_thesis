Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890

 Experiment start at: 2024-05-27 19:33:11.821442
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663409, 'precision': 0.74161714, 'recall': 0.759313, 'specificity': 0.759313, 'f1': 0.75011605, 'auroc': 0.94183636, 'binary_precision': 0.4993687, 'binary_recall': 0.5373641, 'binary_specificity': 0.9812618, 'binary_f1_score': 0.51767015}
confusion matrix:
       0    1
0  41527  793
1    681  791
---- Validation: 
scalar performance:
{'acc': 0.962963, 'precision': 0.72763, 'recall': 0.79781187, 'specificity': 0.79781187, 'f1': 0.7574257, 'auroc': 0.9387275, 'binary_precision': 0.46886018, 'binary_recall': 0.62052876, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.53413653}
confusion matrix:
       0    1
0  17697  452
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.8895354, 'recall': 0.78985184, 'specificity': 0.78985184, 'f1': 0.8316554, 'auroc': 0.925901, 'binary_precision': 0.796875, 'binary_recall': 0.5862069, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.6754967}
confusion matrix:
      0    1
0  5958   39
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 19:53:35.815288,epoch time: 0:20:23.993846,used: 0:20:23.993846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.74058807, 'recall': 0.7258831, 'specificity': 0.7258831, 'f1': 0.73297757, 'auroc': 0.9518997, 'binary_precision': 0.49963742, 'binary_recall': 0.46807066, 'binary_specificity': 0.9836956, 'binary_f1_score': 0.48333916}
confusion matrix:
       0    1
0  41630  690
1    783  689
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7310969, 'recall': 0.6818226, 'specificity': 0.6818226, 'f1': 0.70318455, 'auroc': 0.94419694, 'binary_precision': 0.48406374, 'binary_recall': 0.377916, 'binary_specificity': 0.9857292, 'binary_f1_score': 0.42445415}
confusion matrix:
       0    1
0  17890  259
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.8671223, 'recall': 0.7662797, 'specificity': 0.7662797, 'f1': 0.8078544, 'auroc': 0.9437083, 'binary_precision': 0.7540107, 'binary_recall': 0.54022986, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.62946427}
confusion matrix:
      0    1
0  5951   46
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
better model found
persisted
after epoch: 2,now: 2024-05-27 20:12:51.148120,epoch time: 0:19:15.332832,used: 0:39:39.326678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9678252, 'precision': 0.75212204, 'recall': 0.79404527, 'specificity': 0.79404527, 'f1': 0.77128863, 'auroc': 0.9612355, 'binary_precision': 0.5179606, 'binary_recall': 0.6077498, 'binary_specificity': 0.9803407, 'binary_f1_score': 0.55927426}
confusion matrix:
       0    1
0  41489  832
1    577  894
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7382541, 'recall': 0.7921083, 'specificity': 0.7921083, 'f1': 0.7621081, 'auroc': 0.956931, 'binary_precision': 0.49056605, 'binary_recall': 0.60653186, 'binary_specificity': 0.97768474, 'binary_f1_score': 0.54242}
confusion matrix:
       0    1
0  17744  405
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.8887371, 'recall': 0.7614497, 'specificity': 0.7614497, 'f1': 0.8114337, 'auroc': 0.9448337, 'binary_precision': 0.7976879, 'binary_recall': 0.52873564, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6359447}
confusion matrix:
      0    1
0  5962   35
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
better model found
persisted
after epoch: 3,now: 2024-05-27 20:31:54.670049,epoch time: 0:19:03.521929,used: 0:58:42.848607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9686244, 'precision': 0.75730646, 'recall': 0.8204927, 'specificity': 0.8204927, 'f1': 0.7850437, 'auroc': 0.9564506, 'binary_precision': 0.5264865, 'binary_recall': 0.6616848, 'binary_specificity': 0.97930056, 'binary_f1_score': 0.5863938}
confusion matrix:
       0    1
0  41444  876
1    498  974
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74736136, 'recall': 0.8131037, 'specificity': 0.8131037, 'f1': 0.7759066, 'auroc': 0.9512748, 'binary_precision': 0.50729924, 'binary_recall': 0.64852256, 'binary_specificity': 0.97768474, 'binary_f1_score': 0.56928325}
confusion matrix:
       0    1
0  17744  405
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8660417, 'recall': 0.7058941, 'specificity': 0.7058941, 'f1': 0.7614156, 'auroc': 0.9433874, 'binary_precision': 0.7569444, 'binary_recall': 0.41762453, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.53827167}
confusion matrix:
      0    1
0  5962   35
1   152  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
better model found
persisted
after epoch: 4,now: 2024-05-27 20:51:07.883273,epoch time: 0:19:13.213224,used: 1:17:56.061831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9679165, 'precision': 0.75275767, 'recall': 0.7727667, 'specificity': 0.7727667, 'f1': 0.76233816, 'auroc': 0.95588005, 'binary_precision': 0.52072865, 'binary_recall': 0.5635622, 'binary_specificity': 0.98197114, 'binary_f1_score': 0.5412994}
confusion matrix:
       0    1
0  41558  763
1    642  829
---- Validation: 
scalar performance:
{'acc': 0.9633887, 'precision': 0.72914195, 'recall': 0.7890316, 'specificity': 0.7890316, 'f1': 0.7551826, 'auroc': 0.9546983, 'binary_precision': 0.47252747, 'binary_recall': 0.60186625, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.5294118}
confusion matrix:
       0    1
0  17717  432
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.86514604, 'recall': 0.66058415, 'specificity': 0.66058415, 'f1': 0.7195233, 'auroc': 0.9521785, 'binary_precision': 0.7589286, 'binary_recall': 0.3256705, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.45576406}
confusion matrix:
      0   1
0  5970  27
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 1
val acc:0.9633886814117432, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9701182246208191 / 0.9765100479125977
after epoch: 5,now: 2024-05-27 21:10:14.489249,epoch time: 0:19:06.605976,used: 1:37:02.667807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9656787, 'precision': 0.7397042, 'recall': 0.8101164, 'specificity': 0.8101164, 'f1': 0.7698488, 'auroc': 0.9616141, 'binary_precision': 0.49194804, 'binary_recall': 0.6433424, 'binary_specificity': 0.9768904, 'binary_f1_score': 0.5575508}
confusion matrix:
       0    1
0  41342  978
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7359911, 'recall': 0.82769775, 'specificity': 0.82769775, 'f1': 0.7734249, 'auroc': 0.96047854, 'binary_precision': 0.4834437, 'binary_recall': 0.68118197, 'binary_specificity': 0.9742135, 'binary_f1_score': 0.5655261}
confusion matrix:
       0    1
0  17681  468
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8135841, 'recall': 0.70022845, 'specificity': 0.70022845, 'f1': 0.74303925, 'auroc': 0.9373754, 'binary_precision': 0.652439, 'binary_recall': 0.4099617, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.5035294}
confusion matrix:
      0    1
0  5940   57
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 2
val acc:0.9641869068145752, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9701182246208191 / 0.9765100479125977
after epoch: 6,now: 2024-05-27 21:29:30.422516,epoch time: 0:19:15.933267,used: 1:56:18.601074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9692866, 'precision': 0.76081073, 'recall': 0.8677192, 'specificity': 0.8677192, 'f1': 0.8040929, 'auroc': 0.96738946, 'binary_precision': 0.53013766, 'binary_recall': 0.7588315, 'binary_specificity': 0.9766068, 'binary_f1_score': 0.6241967}
confusion matrix:
       0     1
0  41330   990
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.74445057, 'recall': 0.86141646, 'specificity': 0.86141646, 'f1': 0.79020023, 'auroc': 0.9614892, 'binary_precision': 0.4979339, 'binary_recall': 0.7496112, 'binary_specificity': 0.97322166, 'binary_f1_score': 0.5983861}
confusion matrix:
       0    1
0  17663  486
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.84808075, 'recall': 0.6864869, 'specificity': 0.6864869, 'f1': 0.74049157, 'auroc': 0.9394394, 'binary_precision': 0.72262776, 'binary_recall': 0.37931034, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.49748743}
confusion matrix:
      0   1
0  5959  38
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9701182246208191 / 0.9765100479125977
after epoch: 7,now: 2024-05-27 21:48:55.834450,epoch time: 0:19:25.411934,used: 2:15:44.013008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.75076276, 'recall': 0.83597887, 'specificity': 0.83597887, 'f1': 0.786439, 'auroc': 0.9604635, 'binary_precision': 0.5122684, 'binary_recall': 0.6949728, 'binary_specificity': 0.97698486, 'binary_f1_score': 0.58979535}
confusion matrix:
       0     1
0  41346   974
1    449  1023
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.739244, 'recall': 0.838474, 'specificity': 0.838474, 'f1': 0.77924526, 'auroc': 0.95569605, 'binary_precision': 0.4891775, 'binary_recall': 0.7029549, 'binary_specificity': 0.97399306, 'binary_f1_score': 0.5768986}
confusion matrix:
       0    1
0  17677  472
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8172798, 'recall': 0.72654814, 'specificity': 0.72654814, 'f1': 0.7635015, 'auroc': 0.9314809, 'binary_precision': 0.6576087, 'binary_recall': 0.46360153, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.5438202}
confusion matrix:
      0    1
0  5934   63
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 4
val acc:0.9647190570831299, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9701182246208191 / 0.9765100479125977
after epoch: 8,now: 2024-05-27 22:08:26.309241,epoch time: 0:19:30.474791,used: 2:35:14.487799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97015435, 'precision': 0.7674911, 'recall': 0.81505495, 'specificity': 0.81505495, 'f1': 0.7891145, 'auroc': 0.9678341, 'binary_precision': 0.5472779, 'binary_recall': 0.6487772, 'binary_specificity': 0.9813327, 'binary_f1_score': 0.59372085}
confusion matrix:
       0    1
0  41530  790
1    517  955
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7582701, 'recall': 0.8177906, 'specificity': 0.8177906, 'f1': 0.78459334, 'auroc': 0.9601507, 'binary_precision': 0.52882206, 'binary_recall': 0.6562986, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.58570445}
confusion matrix:
       0    1
0  17773  376
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.80482674, 'recall': 0.6140235, 'specificity': 0.6140235, 'f1': 0.6617266, 'auroc': 0.9311278, 'binary_precision': 0.6421053, 'binary_recall': 0.23371647, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.3426966}
confusion matrix:
      0   1
0  5963  34
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
better model found
persisted
after epoch: 9,now: 2024-05-27 22:27:43.253857,epoch time: 0:19:16.944616,used: 2:54:31.432415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9693551, 'precision': 0.7654544, 'recall': 0.7416862, 'specificity': 0.7416862, 'f1': 0.7529548, 'auroc': 0.9459089, 'binary_precision': 0.54831463, 'binary_recall': 0.49762067, 'binary_specificity': 0.98575175, 'binary_f1_score': 0.5217391}
confusion matrix:
       0    1
0  41718  603
1    739  732
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7449834, 'recall': 0.80541027, 'specificity': 0.80541027, 'f1': 0.7714743, 'auroc': 0.9545696, 'binary_precision': 0.50309026, 'binary_recall': 0.63297045, 'binary_specificity': 0.97785, 'binary_f1_score': 0.56060606}
confusion matrix:
       0    1
0  17747  402
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8004977, 'recall': 0.5784588, 'specificity': 0.5784588, 'f1': 0.6184724, 'auroc': 0.9382622, 'binary_precision': 0.6363636, 'binary_recall': 0.16091955, 'binary_specificity': 0.995998, 'binary_f1_score': 0.25688073}
confusion matrix:
      0   1
0  5973  24
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 1
val acc:0.9660493731498718, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9626078605651855 / 0.9765100479125977
after epoch: 10,now: 2024-05-27 22:46:46.983876,epoch time: 0:19:03.730019,used: 3:13:35.162434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97453874, 'precision': 0.80600524, 'recall': 0.7953568, 'specificity': 0.7953568, 'f1': 0.8005775, 'auroc': 0.96587026, 'binary_precision': 0.6257928, 'binary_recall': 0.6032609, 'binary_specificity': 0.98745275, 'binary_f1_score': 0.6143203}
confusion matrix:
       0    1
0  41789  531
1    584  888
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.7831589, 'recall': 0.82119167, 'specificity': 0.82119167, 'f1': 0.80084836, 'auroc': 0.96274704, 'binary_precision': 0.5784447, 'binary_recall': 0.65940905, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.61627907}
confusion matrix:
       0    1
0  17840  309
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8689884, 'recall': 0.60211426, 'specificity': 0.60211426, 'f1': 0.6539914, 'auroc': 0.9429758, 'binary_precision': 0.7714286, 'binary_recall': 0.20689656, 'binary_specificity': 0.997332, 'binary_f1_score': 0.326284}
confusion matrix:
      0   1
0  5981  16
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
better model found
persisted
after epoch: 11,now: 2024-05-27 23:05:56.218610,epoch time: 0:19:09.234734,used: 3:32:44.397168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9731001, 'precision': 0.820773, 'recall': 0.69998777, 'specificity': 0.69998777, 'f1': 0.7451918, 'auroc': 0.87163234, 'binary_precision': 0.66187847, 'binary_recall': 0.40720597, 'binary_specificity': 0.99276954, 'binary_f1_score': 0.50420874}
confusion matrix:
       0    1
0  42015  306
1    872  599
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.7873553, 'recall': 0.6776067, 'specificity': 0.6776067, 'f1': 0.71833026, 'auroc': 0.8697965, 'binary_precision': 0.5969388, 'binary_recall': 0.36391914, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.45217392}
confusion matrix:
       0    1
0  17991  158
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.86350316, 'recall': 0.6076946, 'specificity': 0.6076946, 'f1': 0.66052955, 'auroc': 0.95210665, 'binary_precision': 0.76, 'binary_recall': 0.21839081, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.33928573}
confusion matrix:
      0   1
0  5979  18
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 1
val acc:0.9698275923728943, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 12,now: 2024-05-27 23:25:07.687086,epoch time: 0:19:11.468476,used: 3:51:55.865644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97008586, 'precision': 0.76582795, 'recall': 0.8431161, 'specificity': 0.8431161, 'f1': 0.79900503, 'auroc': 0.9706856, 'binary_precision': 0.5419489, 'binary_recall': 0.70700204, 'binary_specificity': 0.97923017, 'binary_f1_score': 0.6135693}
confusion matrix:
       0     1
0  41442   879
1    431  1040
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.76000893, 'recall': 0.8344571, 'specificity': 0.8344571, 'f1': 0.7920184, 'auroc': 0.9653925, 'binary_precision': 0.53110045, 'binary_recall': 0.6905132, 'binary_specificity': 0.978401, 'binary_f1_score': 0.6004057}
confusion matrix:
       0    1
0  17757  392
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.82334554, 'recall': 0.7174699, 'specificity': 0.7174699, 'f1': 0.75892156, 'auroc': 0.94172513, 'binary_precision': 0.67052025, 'binary_recall': 0.44444445, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.53456223}
confusion matrix:
      0    1
0  5940   57
1   145  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 2
val acc:0.968550443649292, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 13,now: 2024-05-27 23:44:10.427962,epoch time: 0:19:02.740876,used: 4:10:58.606520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9702457, 'precision': 0.76805794, 'recall': 0.8109238, 'specificity': 0.8109238, 'f1': 0.7877281, 'auroc': 0.96750903, 'binary_precision': 0.54868805, 'binary_recall': 0.64013606, 'binary_specificity': 0.9817116, 'binary_f1_score': 0.59089476}
confusion matrix:
       0    1
0  41548  774
1    529  941
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.75596285, 'recall': 0.8190979, 'specificity': 0.8190979, 'f1': 0.7836528, 'auroc': 0.96231854, 'binary_precision': 0.5241038, 'binary_recall': 0.65940905, 'binary_specificity': 0.9787867, 'binary_f1_score': 0.584022}
confusion matrix:
       0    1
0  17764  385
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.799401, 'recall': 0.602696, 'specificity': 0.602696, 'f1': 0.6482662, 'auroc': 0.9170096, 'binary_precision': 0.6321839, 'binary_recall': 0.21072797, 'binary_specificity': 0.994664, 'binary_f1_score': 0.31609195}
confusion matrix:
      0   1
0  5965  32
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 3
val acc:0.9678586721420288, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 14,now: 2024-05-28 00:03:14.456720,epoch time: 0:19:04.028758,used: 4:30:02.635278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96853304, 'precision': 0.7566892, 'recall': 0.8306091, 'specificity': 0.8306091, 'f1': 0.7884519, 'auroc': 0.97042584, 'binary_precision': 0.5245303, 'binary_recall': 0.68274456, 'binary_specificity': 0.97847354, 'binary_f1_score': 0.59327036}
confusion matrix:
       0     1
0  41409   911
1    467  1005
---- Validation: 
scalar performance:
{'acc': 0.962963, 'precision': 0.730687, 'recall': 0.8360647, 'specificity': 0.8360647, 'f1': 0.772285, 'auroc': 0.96251166, 'binary_precision': 0.47219306, 'binary_recall': 0.6998445, 'binary_specificity': 0.972285, 'binary_f1_score': 0.56390977}
confusion matrix:
       0    1
0  17646  503
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.89586747, 'recall': 0.71813875, 'specificity': 0.71813875, 'f1': 0.7789705, 'auroc': 0.95085263, 'binary_precision': 0.81560284, 'binary_recall': 0.44061303, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5721393}
confusion matrix:
      0    1
0  5971   26
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 4
val acc:0.9629629850387573, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 15,now: 2024-05-28 00:22:34.147168,epoch time: 0:19:19.690448,used: 4:49:22.325726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9653133, 'precision': 0.7396791, 'recall': 0.84795904, 'specificity': 0.84795904, 'f1': 0.78258413, 'auroc': 0.96405894, 'binary_precision': 0.48918545, 'binary_recall': 0.72214675, 'binary_specificity': 0.9737713, 'binary_f1_score': 0.5832647}
confusion matrix:
       0     1
0  41210  1110
1    409  1063
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.737872, 'recall': 0.84653175, 'specificity': 0.84653175, 'f1': 0.78079164, 'auroc': 0.9593167, 'binary_precision': 0.4858342, 'binary_recall': 0.7200622, 'binary_specificity': 0.97300124, 'binary_f1_score': 0.5802005}
confusion matrix:
       0    1
0  17659  490
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.8324281, 'recall': 0.7759397, 'specificity': 0.7759397, 'f1': 0.80126536, 'auroc': 0.95063806, 'binary_precision': 0.68372095, 'binary_recall': 0.5632184, 'binary_specificity': 0.988661, 'binary_f1_score': 0.61764705}
confusion matrix:
      0    1
0  5929   68
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 5
val acc:0.9643465280532837, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 16,now: 2024-05-28 00:42:09.483191,epoch time: 0:19:35.336023,used: 5:08:57.661749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96773386, 'precision': 0.7530987, 'recall': 0.89806235, 'specificity': 0.89806235, 'f1': 0.8074357, 'auroc': 0.97723126, 'binary_precision': 0.5124736, 'binary_recall': 0.82336956, 'binary_specificity': 0.9727552, 'binary_f1_score': 0.63174355}
confusion matrix:
       0     1
0  41167  1153
1    260  1212
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7424406, 'recall': 0.8880603, 'specificity': 0.8880603, 'f1': 0.79622924, 'auroc': 0.9660864, 'binary_precision': 0.49192783, 'binary_recall': 0.80559874, 'binary_specificity': 0.9705218, 'binary_f1_score': 0.610849}
confusion matrix:
       0    1
0  17614  535
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.79233277, 'recall': 0.71971714, 'specificity': 0.71971714, 'f1': 0.75026184, 'auroc': 0.9300876, 'binary_precision': 0.6082474, 'binary_recall': 0.45210728, 'binary_specificity': 0.987327, 'binary_f1_score': 0.51868135}
confusion matrix:
      0    1
0  5921   76
1   143  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 6
val acc:0.9648786783218384, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 17,now: 2024-05-28 01:02:07.820709,epoch time: 0:19:58.337518,used: 5:28:55.999267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97168434, 'precision': 0.7826365, 'recall': 0.77781487, 'specificity': 0.77781487, 'f1': 0.78020275, 'auroc': 0.963467, 'binary_precision': 0.5802213, 'binary_recall': 0.5699728, 'binary_specificity': 0.9856569, 'binary_f1_score': 0.57505137}
confusion matrix:
       0    1
0  41713  607
1    633  839
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7748122, 'recall': 0.7632507, 'specificity': 0.7632507, 'f1': 0.7688941, 'auroc': 0.9580875, 'binary_precision': 0.56585366, 'binary_recall': 0.54121304, 'binary_specificity': 0.98528844, 'binary_f1_score': 0.5532592}
confusion matrix:
       0    1
0  17882  267
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.79624754, 'recall': 0.67340857, 'specificity': 0.67340857, 'f1': 0.7169837, 'auroc': 0.9342463, 'binary_precision': 0.62, 'binary_recall': 0.35632184, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.45255476}
confusion matrix:
      0   1
0  5940  57
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 7
val acc:0.9700936675071716, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 18,now: 2024-05-28 01:21:57.515594,epoch time: 0:19:49.694885,used: 5:48:45.694152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7500887, 'recall': 0.9009528, 'specificity': 0.9009528, 'f1': 0.8058396, 'auroc': 0.97622144, 'binary_precision': 0.5062189, 'binary_recall': 0.8300476, 'binary_specificity': 0.97185796, 'binary_f1_score': 0.6288952}
confusion matrix:
       0     1
0  41130  1191
1    250  1221
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.7412019, 'recall': 0.8864224, 'specificity': 0.8864224, 'f1': 0.79480076, 'auroc': 0.9651694, 'binary_precision': 0.48956355, 'binary_recall': 0.8024883, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.60813195}
confusion matrix:
       0    1
0  17611  538
1    127  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8132277, 'recall': 0.7412902, 'specificity': 0.7412902, 'f1': 0.7720572, 'auroc': 0.95228827, 'binary_precision': 0.6482412, 'binary_recall': 0.49425286, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.5608696}
confusion matrix:
      0    1
0  5927   70
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 8
val acc:0.964612603187561, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 19,now: 2024-05-28 01:41:48.330073,epoch time: 0:19:50.814479,used: 6:08:36.508631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.7783774, 'recall': 0.90748763, 'specificity': 0.90748763, 'f1': 0.82937974, 'auroc': 0.9797152, 'binary_precision': 0.5625, 'binary_recall': 0.8376359, 'binary_specificity': 0.9773393, 'binary_f1_score': 0.67303497}
confusion matrix:
       0     1
0  41361   959
1    239  1233
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7542321, 'recall': 0.8744091, 'specificity': 0.8744091, 'f1': 0.8014027, 'auroc': 0.969769, 'binary_precision': 0.5165975, 'binary_recall': 0.7744945, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.6197884}
confusion matrix:
       0    1
0  17683  466
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.8452769, 'recall': 0.746539, 'specificity': 0.746539, 'f1': 0.7868019, 'auroc': 0.95308924, 'binary_precision': 0.7119565, 'binary_recall': 0.5019157, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.5887641}
confusion matrix:
      0    1
0  5944   53
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 9
val acc:0.9674861431121826, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 20,now: 2024-05-28 02:01:31.851022,epoch time: 0:19:43.520949,used: 6:28:20.029580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97083944, 'precision': 0.7702751, 'recall': 0.85278535, 'specificity': 0.85278535, 'f1': 0.80544484, 'auroc': 0.9711733, 'binary_precision': 0.55018014, 'binary_recall': 0.7262228, 'binary_specificity': 0.9793478, 'binary_f1_score': 0.6260615}
confusion matrix:
       0     1
0  41446   874
1    403  1069
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.73705715, 'recall': 0.83228064, 'specificity': 0.83228064, 'f1': 0.7756819, 'auroc': 0.9552909, 'binary_precision': 0.4852459, 'binary_recall': 0.6905132, 'binary_specificity': 0.97404814, 'binary_f1_score': 0.5699615}
confusion matrix:
       0    1
0  17678  471
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.76378155, 'recall': 0.6221013, 'specificity': 0.6221013, 'f1': 0.663967, 'auroc': 0.92340004, 'binary_precision': 0.55932206, 'binary_recall': 0.25287357, 'binary_specificity': 0.991329, 'binary_f1_score': 0.34828496}
confusion matrix:
      0   1
0  5945  52
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 10
val acc:0.9643465280532837, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 21,now: 2024-05-28 02:21:15.729372,epoch time: 0:19:43.878350,used: 6:48:03.907930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9732371, 'precision': 0.78855157, 'recall': 0.8299824, 'specificity': 0.8299824, 'f1': 0.80773294, 'auroc': 0.9729961, 'binary_precision': 0.58840925, 'binary_recall': 0.6764106, 'binary_specificity': 0.98355424, 'binary_f1_score': 0.6293485}
confusion matrix:
       0    1
0  41625  696
1    476  995
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75012827, 'recall': 0.8103514, 'specificity': 0.8103514, 'f1': 0.77661467, 'auroc': 0.9568126, 'binary_precision': 0.51304346, 'binary_recall': 0.64230174, 'binary_specificity': 0.978401, 'binary_f1_score': 0.570442}
confusion matrix:
       0    1
0  17757  392
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8513453, 'recall': 0.70164585, 'specificity': 0.70164585, 'f1': 0.7542436, 'auroc': 0.9500668, 'binary_precision': 0.72789115, 'binary_recall': 0.4099617, 'binary_specificity': 0.99333, 'binary_f1_score': 0.5245098}
confusion matrix:
      0    1
0  5957   40
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 11
val acc:0.9669008255004883, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 22,now: 2024-05-28 02:40:53.958385,epoch time: 0:19:38.229013,used: 7:07:42.136943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9741277, 'precision': 0.79782397, 'recall': 0.8171107, 'specificity': 0.8171107, 'f1': 0.80713415, 'auroc': 0.97966844, 'binary_precision': 0.60789305, 'binary_recall': 0.6487772, 'binary_specificity': 0.98544425, 'binary_f1_score': 0.6276701}
confusion matrix:
       0    1
0  41704  616
1    517  955
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.76603687, 'recall': 0.79583997, 'specificity': 0.79583997, 'f1': 0.780059, 'auroc': 0.9630413, 'binary_precision': 0.545961, 'binary_recall': 0.6096423, 'binary_specificity': 0.9820376, 'binary_f1_score': 0.576047}
confusion matrix:
       0    1
0  17823  326
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8287809, 'recall': 0.64459145, 'specificity': 0.64459145, 'f1': 0.6974168, 'auroc': 0.9007933, 'binary_precision': 0.6875, 'binary_recall': 0.29501915, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.41286862}
confusion matrix:
      0   1
0  5962  35
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 12
val acc:0.9692954421043396, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 23,now: 2024-05-28 03:00:42.970896,epoch time: 0:19:49.012511,used: 7:27:31.149454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9736025, 'precision': 0.7839192, 'recall': 0.9073281, 'specificity': 0.9073281, 'f1': 0.8333595, 'auroc': 0.9834986, 'binary_precision': 0.5736253, 'binary_recall': 0.8362772, 'binary_specificity': 0.978379, 'binary_f1_score': 0.68048644}
confusion matrix:
       0     1
0  41405   915
1    241  1231
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.75351644, 'recall': 0.8795768, 'specificity': 0.8795768, 'f1': 0.80242336, 'auroc': 0.9670476, 'binary_precision': 0.5147808, 'binary_recall': 0.785381, 'binary_specificity': 0.97377264, 'binary_f1_score': 0.6219212}
confusion matrix:
       0    1
0  17673  476
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7963582, 'recall': 0.6678282, 'specificity': 0.6678282, 'f1': 0.71234375, 'auroc': 0.92398196, 'binary_precision': 0.62068963, 'binary_recall': 0.3448276, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.44334975}
confusion matrix:
      0   1
0  5942  55
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 13
val acc:0.9673265218734741, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 24,now: 2024-05-28 03:20:22.792041,epoch time: 0:19:39.821145,used: 7:47:10.970599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97104496, 'precision': 0.7694093, 'recall': 0.91349554, 'specificity': 0.91349554, 'f1': 0.8244437, 'auroc': 0.98242015, 'binary_precision': 0.5440729, 'binary_recall': 0.8518015, 'binary_specificity': 0.9751896, 'binary_f1_score': 0.6640169}
confusion matrix:
       0     1
0  41271  1050
1    218  1253
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.73923326, 'recall': 0.89214736, 'specificity': 0.89214736, 'f1': 0.7947094, 'auroc': 0.9654747, 'binary_precision': 0.48518518, 'binary_recall': 0.81493, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.60824144}
confusion matrix:
       0    1
0  17593  556
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8293855, 'recall': 0.73271215, 'specificity': 0.73271215, 'f1': 0.77183384, 'auroc': 0.9447353, 'binary_precision': 0.6813187, 'binary_recall': 0.47509578, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.5598194}
confusion matrix:
      0    1
0  5939   58
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 14
val acc:0.9640804529190063, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 25,now: 2024-05-28 03:39:44.757728,epoch time: 0:19:21.965687,used: 8:06:32.936286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9704284, 'precision': 0.76646686, 'recall': 0.8990687, 'specificity': 0.8990687, 'f1': 0.81798625, 'auroc': 0.9805248, 'binary_precision': 0.5392157, 'binary_recall': 0.82256967, 'binary_specificity': 0.9755677, 'binary_f1_score': 0.6514132}
confusion matrix:
       0     1
0  41287  1034
1    261  1210
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.7433635, 'recall': 0.86577904, 'specificity': 0.86577904, 'f1': 0.7906877, 'auroc': 0.9650078, 'binary_precision': 0.49543148, 'binary_recall': 0.7589425, 'binary_specificity': 0.9726156, 'binary_f1_score': 0.5995086}
confusion matrix:
       0    1
0  17652  497
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.7906539, 'recall': 0.8234951, 'specificity': 0.8234951, 'f1': 0.80607927, 'auroc': 0.9496367, 'binary_precision': 0.5958904, 'binary_recall': 0.6666667, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.6292948}
confusion matrix:
      0    1
0  5879  118
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 15
val acc:0.9653043746948242, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 26,now: 2024-05-28 03:58:58.052615,epoch time: 0:19:13.294887,used: 8:25:46.231173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9752238, 'precision': 0.7995094, 'recall': 0.86128306, 'specificity': 0.86128306, 'f1': 0.8272064, 'auroc': 0.9684514, 'binary_precision': 0.608161, 'binary_recall': 0.73913044, 'binary_specificity': 0.98343575, 'binary_f1_score': 0.6672799}
confusion matrix:
       0     1
0  41619   701
1    384  1088
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.7646127, 'recall': 0.843871, 'specificity': 0.843871, 'f1': 0.7984729, 'auroc': 0.9595458, 'binary_precision': 0.53964496, 'binary_recall': 0.70917577, 'binary_specificity': 0.9785663, 'binary_f1_score': 0.6129032}
confusion matrix:
       0    1
0  17760  389
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.83945286, 'recall': 0.7500369, 'specificity': 0.7500369, 'f1': 0.7872334, 'auroc': 0.94936454, 'binary_precision': 0.7, 'binary_recall': 0.5095785, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.5898004}
confusion matrix:
      0    1
0  5940   57
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 16
val acc:0.969348669052124, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 27,now: 2024-05-28 04:18:07.765716,epoch time: 0:19:09.713101,used: 8:44:55.944274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97138745, 'precision': 0.77155894, 'recall': 0.9045428, 'specificity': 0.9045428, 'f1': 0.82343507, 'auroc': 0.9839199, 'binary_precision': 0.54903716, 'binary_recall': 0.83288044, 'binary_specificity': 0.9762051, 'binary_f1_score': 0.6618084}
confusion matrix:
       0     1
0  41313  1007
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.7382295, 'recall': 0.88234156, 'specificity': 0.88234156, 'f1': 0.79133224, 'auroc': 0.9702734, 'binary_precision': 0.4839015, 'binary_recall': 0.7947123, 'binary_specificity': 0.9699708, 'binary_f1_score': 0.60153025}
confusion matrix:
       0    1
0  17604  545
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8186302, 'recall': 0.76211286, 'specificity': 0.76211286, 'f1': 0.7873035, 'auroc': 0.94740486, 'binary_precision': 0.657277, 'binary_recall': 0.5363985, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.59071726}
confusion matrix:
      0    1
0  5924   73
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 17
val acc:0.9639740586280823, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 28,now: 2024-05-28 04:37:19.352255,epoch time: 0:19:11.586539,used: 9:04:07.530813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9744702, 'precision': 0.7900628, 'recall': 0.8934828, 'specificity': 0.8934828, 'f1': 0.83308905, 'auroc': 0.98364854, 'binary_precision': 0.5869242, 'binary_recall': 0.8066712, 'binary_specificity': 0.9802944, 'binary_f1_score': 0.6794724}
confusion matrix:
       0     1
0  41489   834
1    284  1185
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.75491947, 'recall': 0.86324096, 'specificity': 0.86324096, 'f1': 0.79841936, 'auroc': 0.96968913, 'binary_precision': 0.518797, 'binary_recall': 0.7511664, 'binary_specificity': 0.97531545, 'binary_f1_score': 0.613723}
confusion matrix:
       0    1
0  17701  448
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7440208, 'recall': 0.6195186, 'specificity': 0.6195186, 'f1': 0.65784144, 'auroc': 0.935164, 'binary_precision': 0.52, 'binary_recall': 0.24904214, 'binary_specificity': 0.989995, 'binary_f1_score': 0.33678755}
confusion matrix:
      0   1
0  5937  60
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 18
val acc:0.9676458239555359, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 29,now: 2024-05-28 04:56:00.109945,epoch time: 0:18:40.757690,used: 9:22:48.288503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.75122166, 'recall': 0.88706577, 'specificity': 0.88706577, 'f1': 0.80288994, 'auroc': 0.97590995, 'binary_precision': 0.50950736, 'binary_recall': 0.80095106, 'binary_specificity': 0.97318053, 'binary_f1_score': 0.6228209}
confusion matrix:
       0     1
0  41185  1135
1    293  1179
---- Validation: 
scalar performance:
{'acc': 0.9640272, 'precision': 0.73675644, 'recall': 0.8531169, 'specificity': 0.8531169, 'f1': 0.7819597, 'auroc': 0.9620022, 'binary_precision': 0.48311156, 'binary_recall': 0.7340591, 'binary_specificity': 0.97217476, 'binary_f1_score': 0.58271605}
confusion matrix:
       0    1
0  17644  505
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.765661, 'recall': 0.81391466, 'specificity': 0.81391466, 'f1': 0.78749084, 'auroc': 0.9352778, 'binary_precision': 0.54662377, 'binary_recall': 0.651341, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.5944056}
confusion matrix:
      0    1
0  5856  141
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897890.png
early stop counter: 19
val acc:0.9640272259712219, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9643656015396118 / 0.9765100479125977
after epoch: 30,now: 2024-05-28 05:14:52.715828,epoch time: 0:18:52.605883,used: 9:41:40.894386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_11_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:41:40.894386 at 2024-05-28 05:14:52.715828
persisted model performance metric: 

scalar performance:
{'acc': 0.9642058, 'precision': 0.8536277, 'recall': 0.6075279, 'specificity': 0.6075279, 'f1': 0.6594422, 'auroc': 0.9444655, 'binary_precision': 0.74025977, 'binary_recall': 0.21839081, 'binary_specificity': 0.996665, 'binary_f1_score': 0.33727813}
confusion matrix:
      0   1
0  5977  20
1   204  57
oracle model performance metric: 

scalar performance:
{'acc': 0.97746885, 'precision': 0.9040708, 'recall': 0.78851974, 'specificity': 0.78851974, 'f1': 0.8357326, 'auroc': 0.93489355, 'binary_precision': 0.82608694, 'binary_recall': 0.58237547, 'binary_specificity': 0.994664, 'binary_f1_score': 0.68314606}
confusion matrix:
      0    1
0  5965   32
1   109  152
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1339 MiB |   1726 MiB | 593347 GiB | 593346 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590408 GiB | 590407 GiB |
|       from small pool |      6 MiB |      8 MiB |   2938 GiB |   2938 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137760 K  |  137756 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72866 K  |   72862 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137760 K  |  137756 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72866 K  |   72862 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    2768    |   70703 K  |   70703 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      49    |    2747    |   38525 K  |   38525 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1822 MiB |  11226 MiB |  11226 MiB |   9404 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593348 GiB | 593347 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     20 MiB |   2938 GiB |   2938 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137760 K  |  137760 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72866 K  |   72866 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137760 K  |  137760 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72866 K  |   72866 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     232    |     232    |     155    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70704 K  |   70704 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38527 K  |   38527 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1822 MiB |  11226 MiB |  11226 MiB |   9404 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593348 GiB | 593347 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     20 MiB |   2938 GiB |   2938 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137760 K  |  137760 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72866 K  |   72866 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137760 K  |  137760 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72866 K  |   72866 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     232    |     232    |     155    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70704 K  |   70704 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38527 K  |   38527 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890

 Experiment start at: 2024-05-28 05:23:27.324857
before training, model accuracy: 0.2590968608856201
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9592054, 'precision': 0.7893414, 'recall': 0.7019301, 'specificity': 0.7019301, 'f1': 0.73679125, 'auroc': 0.9362499, 'binary_precision': 0.6075175, 'binary_recall': 0.4174174, 'binary_specificity': 0.9864428, 'binary_f1_score': 0.49483803}
confusion matrix:
       0    1
0  32670  449
1    970  695
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9558144, 'precision': 0.7650391, 'recall': 0.715474, 'specificity': 0.715474, 'f1': 0.73730385, 'auroc': 0.93428504, 'binary_precision': 0.5580205, 'binary_recall': 0.44917583, 'binary_specificity': 0.9817721, 'binary_f1_score': 0.49771687}
confusion matrix:
       0    1
0  13950  259
1    401  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99456805, 'precision': 0.6186898, 'recall': 0.55074745, 'specificity': 0.55074745, 'f1': 0.5708027, 'auroc': 0.7910638, 'binary_precision': 0.2413793, 'binary_recall': 0.10294118, 'binary_specificity': 0.99855375, 'binary_f1_score': 0.1443299}
confusion matrix:
       0   1
0  15190  22
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 05:45:12.118948,epoch time: 0:21:44.794091,used: 0:21:44.794091,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95842916, 'precision': 0.7675772, 'recall': 0.8618067, 'specificity': 0.8618067, 'f1': 0.80640423, 'auroc': 0.95388055, 'binary_precision': 0.54771245, 'binary_recall': 0.75495493, 'binary_specificity': 0.96865845, 'binary_f1_score': 0.63484854}
confusion matrix:
       0     1
0  32081  1038
1    408  1257
---- Validation: 
scalar performance:
{'acc': 0.96016604, 'precision': 0.77827513, 'recall': 0.85851204, 'specificity': 0.85851204, 'f1': 0.8124697, 'auroc': 0.94941664, 'binary_precision': 0.56977963, 'binary_recall': 0.7458791, 'binary_specificity': 0.97114503, 'binary_f1_score': 0.64604396}
confusion matrix:
       0    1
0  13799  410
1    185  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9897251, 'precision': 0.5930513, 'recall': 0.69471663, 'specificity': 0.69471663, 'f1': 0.6253755, 'auroc': 0.83793974, 'binary_precision': 0.18881118, 'binary_recall': 0.3970588, 'binary_specificity': 0.9923744, 'binary_f1_score': 0.25592414}
confusion matrix:
       0    1
0  15096  116
1     41   27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
better model found
persisted
after epoch: 2,now: 2024-05-28 06:04:42.806109,epoch time: 0:19:30.687161,used: 0:41:15.481252,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96512765, 'precision': 0.80539405, 'recall': 0.82396984, 'specificity': 0.82396984, 'f1': 0.8143668, 'auroc': 0.9569569, 'binary_precision': 0.6275395, 'binary_recall': 0.66786784, 'binary_specificity': 0.98007184, 'binary_f1_score': 0.64707595}
confusion matrix:
       0     1
0  32459   660
1    553  1112
---- Validation: 
scalar performance:
{'acc': 0.96424985, 'precision': 0.8067825, 'recall': 0.8091803, 'specificity': 0.8091803, 'f1': 0.80797607, 'auroc': 0.950318, 'binary_precision': 0.6321526, 'binary_recall': 0.63736266, 'binary_specificity': 0.980998, 'binary_f1_score': 0.63474697}
confusion matrix:
       0    1
0  13939  270
1    264  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99103403, 'precision': 0.6060527, 'recall': 0.68805397, 'specificity': 0.68805397, 'f1': 0.6353107, 'auroc': 0.85459405, 'binary_precision': 0.21487603, 'binary_recall': 0.38235295, 'binary_specificity': 0.9937549, 'binary_f1_score': 0.27513227}
confusion matrix:
       0   1
0  15117  95
1     42  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
better model found
persisted
after epoch: 3,now: 2024-05-28 06:24:04.811659,epoch time: 0:19:22.005550,used: 1:00:37.486802,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9581704, 'precision': 0.766765, 'recall': 0.8485515, 'specificity': 0.8485515, 'f1': 0.8012804, 'auroc': 0.95807517, 'binary_precision': 0.54746836, 'binary_recall': 0.72732735, 'binary_specificity': 0.9697757, 'binary_f1_score': 0.6247098}
confusion matrix:
       0     1
0  32118  1001
1    454  1211
---- Validation: 
scalar performance:
{'acc': 0.95614916, 'precision': 0.7614627, 'recall': 0.836852, 'specificity': 0.836852, 'f1': 0.79355913, 'auroc': 0.9501965, 'binary_precision': 0.5383001, 'binary_recall': 0.7046703, 'binary_specificity': 0.9690337, 'binary_f1_score': 0.61035097}
confusion matrix:
       0    1
0  13769  440
1    215  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.6049463, 'recall': 0.6952425, 'specificity': 0.6952425, 'f1': 0.6361398, 'auroc': 0.8978254, 'binary_precision': 0.21259843, 'binary_recall': 0.3970588, 'binary_specificity': 0.99342626, 'binary_f1_score': 0.2769231}
confusion matrix:
       0    1
0  15112  100
1     41   27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 1
val acc:0.956149160861969, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 4,now: 2024-05-28 06:43:37.720881,epoch time: 0:19:32.909222,used: 1:20:10.396024,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96041286, 'precision': 0.7768374, 'recall': 0.84887344, 'specificity': 0.84887344, 'f1': 0.8080139, 'auroc': 0.96265996, 'binary_precision': 0.56766915, 'binary_recall': 0.7255255, 'binary_specificity': 0.9722214, 'binary_f1_score': 0.6369628}
confusion matrix:
       0     1
0  32199   920
1    457  1208
---- Validation: 
scalar performance:
{'acc': 0.95755506, 'precision': 0.76708245, 'recall': 0.8558365, 'specificity': 0.8558365, 'f1': 0.80401015, 'auroc': 0.9599938, 'binary_precision': 0.5475708, 'binary_recall': 0.7431319, 'binary_specificity': 0.9685411, 'binary_f1_score': 0.63053614}
confusion matrix:
       0    1
0  13762  447
1    187  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9908377, 'precision': 0.61238205, 'recall': 0.7172356, 'specificity': 0.7172356, 'f1': 0.64769435, 'auroc': 0.85131776, 'binary_precision': 0.22727273, 'binary_recall': 0.44117647, 'binary_specificity': 0.9932948, 'binary_f1_score': 0.29999998}
confusion matrix:
       0    1
0  15110  102
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 2
val acc:0.9575550556182861, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 5,now: 2024-05-28 07:03:02.608534,epoch time: 0:19:24.887653,used: 1:39:35.283677,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9589179, 'precision': 0.7696011, 'recall': 0.862919, 'specificity': 0.862919, 'f1': 0.8081795, 'auroc': 0.9634204, 'binary_precision': 0.55166376, 'binary_recall': 0.7567568, 'binary_specificity': 0.96908116, 'binary_f1_score': 0.63813627}
confusion matrix:
       0     1
0  32095  1024
1    405  1260
---- Validation: 
scalar performance:
{'acc': 0.9557475, 'precision': 0.759789, 'recall': 0.855538, 'specificity': 0.855538, 'f1': 0.79885226, 'auroc': 0.9563743, 'binary_precision': 0.53294003, 'binary_recall': 0.74450547, 'binary_specificity': 0.9665705, 'binary_f1_score': 0.6212034}
confusion matrix:
       0    1
0  13734  475
1    186  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9929974, 'precision': 0.64605135, 'recall': 0.70368016, 'specificity': 0.70368016, 'f1': 0.6700191, 'auroc': 0.7895931, 'binary_precision': 0.29473683, 'binary_recall': 0.4117647, 'binary_specificity': 0.9955956, 'binary_f1_score': 0.34355828}
confusion matrix:
       0   1
0  15145  67
1     40  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 3
val acc:0.9557474851608276, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 6,now: 2024-05-28 07:22:29.621009,epoch time: 0:19:27.012475,used: 1:59:02.296152,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96124655, 'precision': 0.7791288, 'recall': 0.87497956, 'specificity': 0.87497956, 'f1': 0.8188369, 'auroc': 0.9666965, 'binary_precision': 0.5695481, 'binary_recall': 0.7795796, 'binary_specificity': 0.97037953, 'binary_f1_score': 0.65821505}
confusion matrix:
       0     1
0  32138   981
1    367  1298
---- Validation: 
scalar performance:
{'acc': 0.95782286, 'precision': 0.7679976, 'recall': 0.86509997, 'specificity': 0.86509997, 'f1': 0.80776906, 'auroc': 0.9585812, 'binary_precision': 0.548419, 'binary_recall': 0.76236266, 'binary_specificity': 0.9678373, 'binary_f1_score': 0.637931}
confusion matrix:
       0    1
0  13752  457
1    173  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98841625, 'precision': 0.5894188, 'recall': 0.72333956, 'specificity': 0.72333956, 'f1': 0.6267883, 'auroc': 0.83238995, 'binary_precision': 0.18128654, 'binary_recall': 0.45588234, 'binary_specificity': 0.99079674, 'binary_f1_score': 0.25941423}
confusion matrix:
       0    1
0  15072  140
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 4
val acc:0.957822859287262, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 7,now: 2024-05-28 07:41:55.587433,epoch time: 0:19:25.966424,used: 2:18:28.262576,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9609303, 'precision': 0.7774735, 'recall': 0.88080275, 'specificity': 0.88080275, 'f1': 0.8196347, 'auroc': 0.9667913, 'binary_precision': 0.5656089, 'binary_recall': 0.7921922, 'binary_specificity': 0.96941334, 'binary_f1_score': 0.65999496}
confusion matrix:
       0     1
0  32106  1013
1    346  1319
---- Validation: 
scalar performance:
{'acc': 0.95849234, 'precision': 0.7704061, 'recall': 0.87848437, 'specificity': 0.87848437, 'f1': 0.8138283, 'auroc': 0.9571917, 'binary_precision': 0.55182344, 'binary_recall': 0.78983516, 'binary_specificity': 0.9671335, 'binary_f1_score': 0.6497175}
confusion matrix:
       0    1
0  13742  467
1    153  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9825262, 'precision': 0.56943065, 'recall': 0.7789419, 'specificity': 0.7789419, 'f1': 0.6086251, 'auroc': 0.8589659, 'binary_precision': 0.14079422, 'binary_recall': 0.5735294, 'binary_specificity': 0.98435444, 'binary_f1_score': 0.22608694}
confusion matrix:
       0    1
0  14974  238
1     29   39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 5
val acc:0.9584923386573792, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 8,now: 2024-05-28 08:01:13.993183,epoch time: 0:19:18.405750,used: 2:37:46.668326,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9620228, 'precision': 0.78717285, 'recall': 0.8237654, 'specificity': 0.8237654, 'f1': 0.8041998, 'auroc': 0.9622106, 'binary_precision': 0.59100527, 'binary_recall': 0.6708709, 'binary_specificity': 0.9766599, 'binary_f1_score': 0.62841076}
confusion matrix:
       0     1
0  32346   773
1    548  1117
---- Validation: 
scalar performance:
{'acc': 0.9586262, 'precision': 0.7715969, 'recall': 0.85639954, 'specificity': 0.85639954, 'f1': 0.8072678, 'auroc': 0.9556794, 'binary_precision': 0.55658436, 'binary_recall': 0.7431319, 'binary_specificity': 0.96966714, 'binary_f1_score': 0.6364706}
confusion matrix:
       0    1
0  13778  431
1    187  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9903141, 'precision': 0.5993928, 'recall': 0.69501245, 'specificity': 0.69501245, 'f1': 0.63122576, 'auroc': 0.84579825, 'binary_precision': 0.20149253, 'binary_recall': 0.3970588, 'binary_specificity': 0.99296606, 'binary_f1_score': 0.26732674}
confusion matrix:
       0    1
0  15105  107
1     41   27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 6
val acc:0.9586262106895447, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 9,now: 2024-05-28 08:20:35.639473,epoch time: 0:19:21.646290,used: 2:57:08.314616,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96783006, 'precision': 0.82092994, 'recall': 0.83280426, 'specificity': 0.83280426, 'f1': 0.8267437, 'auroc': 0.9635245, 'binary_precision': 0.6578035, 'binary_recall': 0.6834835, 'binary_specificity': 0.98212504, 'binary_f1_score': 0.6703977}
confusion matrix:
       0     1
0  32527   592
1    527  1138
---- Validation: 
scalar performance:
{'acc': 0.9641829, 'precision': 0.7995846, 'recall': 0.84563607, 'specificity': 0.84563607, 'f1': 0.8207061, 'auroc': 0.94233024, 'binary_precision': 0.61393154, 'binary_recall': 0.71428573, 'binary_specificity': 0.9769864, 'binary_f1_score': 0.6603175}
confusion matrix:
       0    1
0  13882  327
1    208  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.989267, 'precision': 0.59286666, 'recall': 0.7091267, 'specificity': 0.7091267, 'f1': 0.6279277, 'auroc': 0.84116375, 'binary_precision': 0.18831168, 'binary_recall': 0.42647058, 'binary_specificity': 0.9917828, 'binary_f1_score': 0.26126125}
confusion matrix:
       0    1
0  15087  125
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 7
val acc:0.9641829133033752, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 10,now: 2024-05-28 08:39:46.567894,epoch time: 0:19:10.928421,used: 3:16:19.243037,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96052784, 'precision': 0.7776792, 'recall': 0.8440854, 'specificity': 0.8440854, 'f1': 0.80674607, 'auroc': 0.96728694, 'binary_precision': 0.56985646, 'binary_recall': 0.71531534, 'binary_specificity': 0.97285545, 'binary_f1_score': 0.63435423}
confusion matrix:
       0     1
0  32220   899
1    474  1191
---- Validation: 
scalar performance:
{'acc': 0.9580237, 'precision': 0.76900464, 'recall': 0.857386, 'specificity': 0.857386, 'f1': 0.8058553, 'auroc': 0.9561502, 'binary_precision': 0.55126905, 'binary_recall': 0.7458791, 'binary_specificity': 0.96889293, 'binary_f1_score': 0.63397545}
confusion matrix:
       0    1
0  13767  442
1    185  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99208117, 'precision': 0.62712204, 'recall': 0.70322, 'specificity': 0.70322, 'f1': 0.6562008, 'auroc': 0.8134863, 'binary_precision': 0.25688073, 'binary_recall': 0.4117647, 'binary_specificity': 0.9946753, 'binary_f1_score': 0.31638417}
confusion matrix:
       0   1
0  15131  81
1     40  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 8
val acc:0.958023726940155, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 11,now: 2024-05-28 08:59:32.534948,epoch time: 0:19:45.967054,used: 3:36:05.210091,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.956158, 'precision': 0.7584905, 'recall': 0.8648921, 'specificity': 0.8648921, 'f1': 0.80096614, 'auroc': 0.9632076, 'binary_precision': 0.5291181, 'binary_recall': 0.76396394, 'binary_specificity': 0.96582025, 'binary_f1_score': 0.62521505}
confusion matrix:
       0     1
0  31987  1132
1    393  1272
---- Validation: 
scalar performance:
{'acc': 0.9560822, 'precision': 0.7611253, 'recall': 0.86679155, 'specificity': 0.86679155, 'f1': 0.8034345, 'auroc': 0.951627, 'binary_precision': 0.53441685, 'binary_recall': 0.76785713, 'binary_specificity': 0.96572596, 'binary_f1_score': 0.6302142}
confusion matrix:
       0    1
0  13722  487
1    169  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99149215, 'precision': 0.61954707, 'recall': 0.71024424, 'specificity': 0.71024424, 'f1': 0.6521152, 'auroc': 0.84077775, 'binary_precision': 0.24166666, 'binary_recall': 0.42647058, 'binary_specificity': 0.9940179, 'binary_f1_score': 0.3085106}
confusion matrix:
       0   1
0  15121  91
1     39  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 9
val acc:0.9560822248458862, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 12,now: 2024-05-28 09:19:19.459722,epoch time: 0:19:46.924774,used: 3:55:52.134865,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9604703, 'precision': 0.7755663, 'recall': 0.8799908, 'specificity': 0.8799908, 'f1': 0.8180241, 'auroc': 0.9691541, 'binary_precision': 0.5618601, 'binary_recall': 0.790991, 'binary_specificity': 0.9689906, 'binary_f1_score': 0.6570217}
confusion matrix:
       0     1
0  32092  1027
1    348  1317
---- Validation: 
scalar performance:
{'acc': 0.957689, 'precision': 0.7673296, 'recall': 0.8728491, 'specificity': 0.8728491, 'f1': 0.8098222, 'auroc': 0.9538866, 'binary_precision': 0.5462428, 'binary_recall': 0.77884614, 'binary_specificity': 0.966852, 'binary_f1_score': 0.64212906}
confusion matrix:
       0    1
0  13738  471
1    161  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9921466, 'precision': 0.63053274, 'recall': 0.71057296, 'specificity': 0.71057296, 'f1': 0.6609465, 'auroc': 0.8165917, 'binary_precision': 0.26363635, 'binary_recall': 0.42647058, 'binary_specificity': 0.9946753, 'binary_f1_score': 0.3258427}
confusion matrix:
       0   1
0  15131  81
1     39  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 10
val acc:0.9576889872550964, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 13,now: 2024-05-28 09:39:13.013450,epoch time: 0:19:53.553728,used: 4:15:45.688593,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9589754, 'precision': 0.76970863, 'recall': 0.8680828, 'specificity': 0.8680828, 'f1': 0.8099847, 'auroc': 0.9633799, 'binary_precision': 0.55133736, 'binary_recall': 0.7675676, 'binary_specificity': 0.96859807, 'binary_f1_score': 0.6417274}
confusion matrix:
       0     1
0  32079  1040
1    387  1278
---- Validation: 
scalar performance:
{'acc': 0.9582915, 'precision': 0.7694936, 'recall': 0.88489497, 'specificity': 0.88489497, 'f1': 0.8151759, 'auroc': 0.9530412, 'binary_precision': 0.5492958, 'binary_recall': 0.8035714, 'binary_specificity': 0.9662186, 'binary_f1_score': 0.65253764}
confusion matrix:
       0    1
0  13729  480
1    143  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98979056, 'precision': 0.6059859, 'recall': 0.73866993, 'specificity': 0.73866993, 'f1': 0.64607763, 'auroc': 0.86231625, 'binary_precision': 0.21428572, 'binary_recall': 0.4852941, 'binary_specificity': 0.99204576, 'binary_f1_score': 0.2972973}
confusion matrix:
       0    1
0  15091  121
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 11
val acc:0.9582914710044861, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 14,now: 2024-05-28 09:59:03.647252,epoch time: 0:19:50.633802,used: 4:35:36.322395,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96564513, 'precision': 0.8044934, 'recall': 0.8453467, 'specificity': 0.8453467, 'f1': 0.8234394, 'auroc': 0.9679687, 'binary_precision': 0.62355417, 'binary_recall': 0.71231234, 'binary_specificity': 0.978381, 'binary_f1_score': 0.66498464}
confusion matrix:
       0     1
0  32403   716
1    479  1186
---- Validation: 
scalar performance:
{'acc': 0.9581576, 'precision': 0.77076983, 'recall': 0.82552683, 'specificity': 0.82552683, 'f1': 0.795204, 'auroc': 0.94846153, 'binary_precision': 0.5581921, 'binary_recall': 0.6785714, 'binary_specificity': 0.9724822, 'binary_f1_score': 0.61252326}
confusion matrix:
       0    1
0  13818  391
1    234  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9894633, 'precision': 0.5947376, 'recall': 0.7092253, 'specificity': 0.7092253, 'f1': 0.62976694, 'auroc': 0.87322074, 'binary_precision': 0.19205298, 'binary_recall': 0.42647058, 'binary_specificity': 0.99198, 'binary_f1_score': 0.2648402}
confusion matrix:
       0    1
0  15090  122
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 12
val acc:0.9581575989723206, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 15,now: 2024-05-28 10:19:00.161453,epoch time: 0:19:56.514201,used: 4:55:32.836596,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9625115, 'precision': 0.78265643, 'recall': 0.909583, 'specificity': 0.909583, 'f1': 0.8324711, 'auroc': 0.97371674, 'binary_precision': 0.5729883, 'binary_recall': 0.85105103, 'binary_specificity': 0.968115, 'binary_f1_score': 0.68487185}
confusion matrix:
       0     1
0  32063  1056
1    248  1417
---- Validation: 
scalar performance:
{'acc': 0.9600321, 'precision': 0.77630085, 'recall': 0.8877648, 'specificity': 0.8877648, 'f1': 0.8210189, 'auroc': 0.9568435, 'binary_precision': 0.5626794, 'binary_recall': 0.8076923, 'binary_specificity': 0.9678373, 'binary_f1_score': 0.6632826}
confusion matrix:
       0    1
0  13752  457
1    140  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9895288, 'precision': 0.59742826, 'recall': 0.71657825, 'specificity': 0.71657825, 'f1': 0.63372684, 'auroc': 0.81402135, 'binary_precision': 0.19736843, 'binary_recall': 0.44117647, 'binary_specificity': 0.99198, 'binary_f1_score': 0.27272728}
confusion matrix:
       0    1
0  15090  122
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 13
val acc:0.9600321054458618, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 16,now: 2024-05-28 10:39:02.592122,epoch time: 0:20:02.430669,used: 5:15:35.267265,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96377647, 'precision': 0.79102695, 'recall': 0.8717449, 'specificity': 0.8717449, 'f1': 0.8256684, 'auroc': 0.9681017, 'binary_precision': 0.59379345, 'binary_recall': 0.76996994, 'binary_specificity': 0.97351974, 'binary_f1_score': 0.6705021}
confusion matrix:
       0     1
0  32242   877
1    383  1282
---- Validation: 
scalar performance:
{'acc': 0.95949656, 'precision': 0.7749543, 'recall': 0.8659797, 'specificity': 0.8659797, 'f1': 0.8128726, 'auroc': 0.95477504, 'binary_precision': 0.56231004, 'binary_recall': 0.76236266, 'binary_specificity': 0.96959674, 'binary_f1_score': 0.6472303}
confusion matrix:
       0    1
0  13777  432
1    173  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9872382, 'precision': 0.5807847, 'recall': 0.7227479, 'specificity': 0.7227479, 'f1': 0.61740506, 'auroc': 0.8288365, 'binary_precision': 0.16402116, 'binary_recall': 0.45588234, 'binary_specificity': 0.9896135, 'binary_f1_score': 0.24124514}
confusion matrix:
       0    1
0  15054  158
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 14
val acc:0.9594965577125549, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 17,now: 2024-05-28 10:59:02.342157,epoch time: 0:19:59.750035,used: 5:35:35.017300,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9584004, 'precision': 0.766971, 'recall': 0.914269, 'specificity': 0.914269, 'f1': 0.82178134, 'auroc': 0.97140896, 'binary_precision': 0.5409159, 'binary_recall': 0.86546546, 'binary_specificity': 0.96307254, 'binary_f1_score': 0.66574264}
confusion matrix:
       0     1
0  31896  1223
1    224  1441
---- Validation: 
scalar performance:
{'acc': 0.9487849, 'precision': 0.7389926, 'recall': 0.9053115, 'specificity': 0.9053115, 'f1': 0.7962562, 'auroc': 0.9606602, 'binary_precision': 0.48560312, 'binary_recall': 0.85714287, 'binary_specificity': 0.9534802, 'binary_f1_score': 0.6199702}
confusion matrix:
       0    1
0  13548  661
1    104  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.985733, 'precision': 0.5735716, 'recall': 0.729312, 'specificity': 0.729312, 'f1': 0.6098752, 'auroc': 0.8287244, 'binary_precision': 0.1495327, 'binary_recall': 0.47058824, 'binary_specificity': 0.98803574, 'binary_f1_score': 0.22695036}
confusion matrix:
       0    1
0  15030  182
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 15
val acc:0.9487848877906799, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 18,now: 2024-05-28 11:19:05.015997,epoch time: 0:20:02.673840,used: 5:55:37.691140,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9641789, 'precision': 0.79159546, 'recall': 0.885646, 'specificity': 0.885646, 'f1': 0.8310138, 'auroc': 0.9720457, 'binary_precision': 0.59348506, 'binary_recall': 0.7987988, 'binary_specificity': 0.9724931, 'binary_f1_score': 0.6810036}
confusion matrix:
       0     1
0  32208   911
1    335  1330
---- Validation: 
scalar performance:
{'acc': 0.9592957, 'precision': 0.77360415, 'recall': 0.8795582, 'specificity': 0.8795582, 'f1': 0.81645966, 'auroc': 0.9599039, 'binary_precision': 0.55813956, 'binary_recall': 0.7912088, 'binary_specificity': 0.96790767, 'binary_f1_score': 0.65454555}
confusion matrix:
       0    1
0  13753  456
1    152  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98658377, 'precision': 0.5730663, 'recall': 0.70777905, 'specificity': 0.70777905, 'f1': 0.606883, 'auroc': 0.87793887, 'binary_precision': 0.14871795, 'binary_recall': 0.42647058, 'binary_specificity': 0.9890876, 'binary_f1_score': 0.22053234}
confusion matrix:
       0    1
0  15046  166
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 16
val acc:0.9592956900596619, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 19,now: 2024-05-28 11:39:01.627586,epoch time: 0:19:56.611589,used: 6:15:34.302729,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9665651, 'precision': 0.81852555, 'recall': 0.80960894, 'specificity': 0.80960894, 'f1': 0.813995, 'auroc': 0.9670708, 'binary_precision': 0.6553218, 'binary_recall': 0.63603604, 'binary_specificity': 0.98318183, 'binary_f1_score': 0.64553493}
confusion matrix:
       0     1
0  32562   557
1    606  1059
---- Validation: 
scalar performance:
{'acc': 0.9619736, 'precision': 0.7928692, 'recall': 0.8073323, 'specificity': 0.8073323, 'f1': 0.7998992, 'auroc': 0.95366275, 'binary_precision': 0.60443866, 'binary_recall': 0.635989, 'binary_specificity': 0.9786755, 'binary_f1_score': 0.61981255}
confusion matrix:
       0    1
0  13906  303
1    265  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9872382, 'precision': 0.5877385, 'recall': 0.7520282, 'specificity': 0.7520282, 'f1': 0.62885714, 'auroc': 0.8611852, 'binary_precision': 0.17766498, 'binary_recall': 0.5147059, 'binary_specificity': 0.9893505, 'binary_f1_score': 0.26415095}
confusion matrix:
       0    1
0  15050  162
1     33   35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 17
val acc:0.9619736075401306, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 20,now: 2024-05-28 11:59:12.277166,epoch time: 0:20:10.649580,used: 6:35:44.952309,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96248275, 'precision': 0.78463364, 'recall': 0.87534356, 'specificity': 0.87534356, 'f1': 0.8227132, 'auroc': 0.9725517, 'binary_precision': 0.58057296, 'binary_recall': 0.778979, 'binary_specificity': 0.97170806, 'binary_f1_score': 0.6652988}
confusion matrix:
       0     1
0  32182   937
1    368  1297
---- Validation: 
scalar performance:
{'acc': 0.95588136, 'precision': 0.7603124, 'recall': 0.8438791, 'specificity': 0.8438791, 'f1': 0.7952732, 'auroc': 0.9487319, 'binary_precision': 0.53524005, 'binary_recall': 0.7197802, 'binary_specificity': 0.96797806, 'binary_f1_score': 0.61394256}
confusion matrix:
       0    1
0  13754  455
1    204  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9883508, 'precision': 0.58889174, 'recall': 0.72330666, 'specificity': 0.72330666, 'f1': 0.6262313, 'auroc': 0.8601039, 'binary_precision': 0.18023255, 'binary_recall': 0.45588234, 'binary_specificity': 0.990731, 'binary_f1_score': 0.25833333}
confusion matrix:
       0    1
0  15071  141
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 18
val acc:0.9558813571929932, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 21,now: 2024-05-28 12:19:23.148555,epoch time: 0:20:10.871389,used: 6:55:55.823698,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96300024, 'precision': 0.78511363, 'recall': 0.901854, 'specificity': 0.901854, 'f1': 0.8318734, 'auroc': 0.97364235, 'binary_precision': 0.57875, 'binary_recall': 0.83423424, 'binary_specificity': 0.9694737, 'binary_f1_score': 0.68339485}
confusion matrix:
       0     1
0  32108  1011
1    276  1389
---- Validation: 
scalar performance:
{'acc': 0.95849234, 'precision': 0.7706126, 'recall': 0.87001324, 'specificity': 0.87001324, 'f1': 0.81122744, 'auroc': 0.9506682, 'binary_precision': 0.5531496, 'binary_recall': 0.771978, 'binary_specificity': 0.9680484, 'binary_f1_score': 0.6444954}
confusion matrix:
       0    1
0  13755  454
1    166  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9859293, 'precision': 0.58112943, 'recall': 0.7586909, 'specificity': 0.7586909, 'f1': 0.6218845, 'auroc': 0.8154149, 'binary_precision': 0.16438356, 'binary_recall': 0.5294118, 'binary_specificity': 0.98797, 'binary_f1_score': 0.2508711}
confusion matrix:
       0    1
0  15029  183
1     32   36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 19
val acc:0.9584923386573792, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 22,now: 2024-05-28 12:39:57.298632,epoch time: 0:20:34.150077,used: 7:16:29.973775,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96800256, 'precision': 0.8178818, 'recall': 0.84943664, 'specificity': 0.84943664, 'f1': 0.832803, 'auroc': 0.9554297, 'binary_precision': 0.65, 'binary_recall': 0.71831834, 'binary_specificity': 0.980555, 'binary_f1_score': 0.68245363}
confusion matrix:
       0     1
0  32475   644
1    469  1196
---- Validation: 
scalar performance:
{'acc': 0.9623753, 'precision': 0.7919345, 'recall': 0.82969856, 'specificity': 0.82969856, 'f1': 0.8094857, 'auroc': 0.9278904, 'binary_precision': 0.60024154, 'binary_recall': 0.6826923, 'binary_specificity': 0.9767049, 'binary_f1_score': 0.6388174}
confusion matrix:
       0    1
0  13878  331
1    231  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98979056, 'precision': 0.5891598, 'recall': 0.6801094, 'specificity': 0.6801094, 'f1': 0.61878955, 'auroc': 0.8730353, 'binary_precision': 0.18115942, 'binary_recall': 0.36764705, 'binary_specificity': 0.99257165, 'binary_f1_score': 0.24271844}
confusion matrix:
       0    1
0  15099  113
1     43   25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897890.png
early stop counter: 20
val acc:0.962375283241272, best validation acc: 0.964249849319458, corresponding to test acc:                         0.9910340309143066 / 0.9945680499076843
after epoch: 23,now: 2024-05-28 13:00:55.611367,epoch time: 0:20:58.312735,used: 7:37:28.286510,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_23_27_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 7:37:28.286510 at 2024-05-28 13:00:55.611367
persisted model performance metric: 

scalar performance:
{'acc': 0.9915576, 'precision': 0.6086416, 'recall': 0.6736767, 'specificity': 0.6736767, 'f1': 0.63347036, 'auroc': 0.8413242, 'binary_precision': 0.22018349, 'binary_recall': 0.3529412, 'binary_specificity': 0.9944123, 'binary_f1_score': 0.27118644}
confusion matrix:
       0   1
0  15127  85
1     44  24
oracle model performance metric: 

scalar performance:
{'acc': 0.99528795, 'precision': 0.7124499, 'recall': 0.5877094, 'specificity': 0.5877094, 'f1': 0.6238183, 'auroc': 0.7658696, 'binary_precision': 0.42857143, 'binary_recall': 0.1764706, 'binary_specificity': 0.9989482, 'binary_f1_score': 0.25}
confusion matrix:
       0   1
0  15196  16
1     56  12
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498548 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |  91508 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 498548 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |  91508 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476996 KiB |  10962 MiB |   2850 TiB |   2850 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   2845 TiB |   2845 TiB |
|       from small pool |  89156 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11392 MiB |  11392 MiB |  20796 MiB |   9404 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    126 MiB |    126 MiB |    158 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1485 MiB |   2595 MiB |    960 TiB |    960 TiB |
|       from large pool |   1472 MiB |   2593 MiB |    954 TiB |    954 TiB |
|       from small pool |     12 MiB |     20 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    7107    |    7764    |  235451 K  |  235444 K  |
|       from large pool |      87    |     909    |  111505 K  |  111504 K  |
|       from small pool |    7020    |    7642    |  123946 K  |  123939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    7107    |    7764    |  235451 K  |  235444 K  |
|       from large pool |      87    |     909    |  111505 K  |  111504 K  |
|       from small pool |    7020    |    7642    |  123946 K  |  123939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     390    |     155    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      63    |      63    |      79    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2768    |  123870 K  |  123870 K  |
|       from large pool |      24    |      65    |   57774 K  |   57774 K  |
|       from small pool |      48    |    2747    |   66096 K  |   66096 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   2850 TiB |   2850 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   2845 TiB |   2845 TiB |
|       from small pool |      0 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1972 MiB |  11392 MiB |  20796 MiB |  18824 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    102 MiB |    126 MiB |    158 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |    960 TiB |    960 TiB |
|       from large pool | 134912 KiB |   2593 MiB |    954 TiB |    954 TiB |
|       from small pool |      0 KiB |     35 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  235451 K  |  235451 K  |
|       from large pool |       2    |     909    |  111505 K  |  111505 K  |
|       from small pool |       0    |    7642    |  123946 K  |  123946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  235451 K  |  235451 K  |
|       from large pool |       2    |     909    |  111505 K  |  111505 K  |
|       from small pool |       0    |    7642    |  123946 K  |  123946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      86    |     235    |     390    |     304    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      51    |      63    |      79    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  123873 K  |  123873 K  |
|       from large pool |       4    |      65    |   57774 K  |   57774 K  |
|       from small pool |       0    |    2747    |   66099 K  |   66099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   2862 TiB |   2862 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   2850 TiB |   2850 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   2845 TiB |   2845 TiB |
|       from small pool |      0 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1972 MiB |  11392 MiB |  20796 MiB |  18824 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    102 MiB |    126 MiB |    158 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |    960 TiB |    960 TiB |
|       from large pool | 134912 KiB |   2593 MiB |    954 TiB |    954 TiB |
|       from small pool |      0 KiB |     35 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  235451 K  |  235451 K  |
|       from large pool |       2    |     909    |  111505 K  |  111505 K  |
|       from small pool |       0    |    7642    |  123946 K  |  123946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  235451 K  |  235451 K  |
|       from large pool |       2    |     909    |  111505 K  |  111505 K  |
|       from small pool |       0    |    7642    |  123946 K  |  123946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      86    |     235    |     390    |     304    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      51    |      63    |      79    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  123873 K  |  123873 K  |
|       from large pool |       4    |      65    |   57774 K  |   57774 K  |
|       from small pool |       0    |    2747    |   66099 K  |   66099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890

 Experiment start at: 2024-05-28 13:12:44.654158
before training, model accuracy: 0.6810094714164734
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9718458, 'precision': 0.78261244, 'recall': 0.7956227, 'specificity': 0.7956227, 'f1': 0.7889558, 'auroc': 0.94729376, 'binary_precision': 0.5789822, 'binary_recall': 0.6066482, 'binary_specificity': 0.98459715, 'binary_f1_score': 0.5924924}
confusion matrix:
       0    1
0  40719  637
1    568  876
---- Validation: 
scalar performance:
{'acc': 0.97126627, 'precision': 0.7871604, 'recall': 0.7940393, 'specificity': 0.7940393, 'f1': 0.79055476, 'auroc': 0.9397501, 'binary_precision': 0.58877087, 'binary_recall': 0.60342145, 'binary_specificity': 0.98465717, 'binary_f1_score': 0.59600616}
confusion matrix:
       0    1
0  17392  271
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615225, 'precision': 0.7495543, 'recall': 0.6437763, 'specificity': 0.6437763, 'f1': 0.6807592, 'auroc': 0.8835287, 'binary_precision': 0.5276074, 'binary_recall': 0.2986111, 'binary_specificity': 0.98894155, 'binary_f1_score': 0.38137472}
confusion matrix:
      0   1
0  6886  77
1   202  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 13:32:32.359275,epoch time: 0:19:47.705117,used: 0:19:47.705117,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97114486, 'precision': 0.7867421, 'recall': 0.7282759, 'specificity': 0.7282759, 'f1': 0.753868, 'auroc': 0.94408363, 'binary_precision': 0.591944, 'binary_recall': 0.46782008, 'binary_specificity': 0.98873174, 'binary_f1_score': 0.52261305}
confusion matrix:
       0    1
0  40889  466
1    769  676
---- Validation: 
scalar performance:
{'acc': 0.9600131, 'precision': 0.71105766, 'recall': 0.7425008, 'specificity': 0.7425008, 'f1': 0.72554064, 'auroc': 0.9289176, 'binary_precision': 0.44010767, 'binary_recall': 0.5085537, 'binary_specificity': 0.97644794, 'binary_f1_score': 0.47186148}
confusion matrix:
       0    1
0  17247  416
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.80215263, 'recall': 0.51526594, 'specificity': 0.51526594, 'f1': 0.5198013, 'auroc': 0.8678994, 'binary_precision': 0.64285713, 'binary_recall': 0.03125, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.059602648}
confusion matrix:
      0  1
0  6958  5
1   279  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 1
val acc:0.9600130915641785, best validation acc: 0.9712662696838379, corresponding to test acc:                         0.9615225195884705 / 0.9615225195884705
after epoch: 2,now: 2024-05-28 13:51:32.784438,epoch time: 0:19:00.425163,used: 0:38:48.130280,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97121495, 'precision': 0.7854055, 'recall': 0.73899794, 'specificity': 0.73899794, 'f1': 0.75994563, 'auroc': 0.9532162, 'binary_precision': 0.5885287, 'binary_recall': 0.4899654, 'binary_specificity': 0.9880305, 'binary_f1_score': 0.5347432}
confusion matrix:
       0    1
0  40860  495
1    737  708
---- Validation: 
scalar performance:
{'acc': 0.96787935, 'precision': 0.76365274, 'recall': 0.75257146, 'specificity': 0.75257146, 'f1': 0.75797975, 'auroc': 0.9502667, 'binary_precision': 0.54471546, 'binary_recall': 0.5209953, 'binary_specificity': 0.98414767, 'binary_f1_score': 0.5325914}
confusion matrix:
       0    1
0  17383  280
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.87371933, 'recall': 0.5188818, 'specificity': 0.5188818, 'f1': 0.5265647, 'auroc': 0.89285624, 'binary_precision': 0.78571427, 'binary_recall': 0.038194444, 'binary_specificity': 0.9995692, 'binary_f1_score': 0.07284769}
confusion matrix:
      0   1
0  6960   3
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 2
val acc:0.9678793549537659, best validation acc: 0.9712662696838379, corresponding to test acc:                         0.9615225195884705 / 0.9615225195884705
after epoch: 3,now: 2024-05-28 14:10:48.544549,epoch time: 0:19:15.760111,used: 0:58:03.890391,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97093457, 'precision': 0.7708448, 'recall': 0.8714232, 'specificity': 0.8714232, 'f1': 0.81234705, 'auroc': 0.9600482, 'binary_precision': 0.55002487, 'binary_recall': 0.7647059, 'binary_specificity': 0.9781405, 'binary_f1_score': 0.63983786}
confusion matrix:
       0     1
0  40451   904
1    340  1105
---- Validation: 
scalar performance:
{'acc': 0.97011906, 'precision': 0.7721205, 'recall': 0.88560843, 'specificity': 0.88560843, 'f1': 0.8178805, 'auroc': 0.9636979, 'binary_precision': 0.55183583, 'binary_recall': 0.7947123, 'binary_specificity': 0.97650456, 'binary_f1_score': 0.65137035}
confusion matrix:
       0    1
0  17248  415
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.7417987, 'recall': 0.5734447, 'specificity': 0.5734447, 'f1': 0.60787684, 'auroc': 0.8934633, 'binary_precision': 0.5176471, 'binary_recall': 0.15277778, 'binary_specificity': 0.9941117, 'binary_f1_score': 0.23592493}
confusion matrix:
      0   1
0  6922  41
1   244  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 3
val acc:0.970119059085846, best validation acc: 0.9712662696838379, corresponding to test acc:                         0.9615225195884705 / 0.9615225195884705
after epoch: 4,now: 2024-05-28 14:32:12.830129,epoch time: 0:21:24.285580,used: 1:19:28.175971,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9738318, 'precision': 0.80305153, 'recall': 0.7827612, 'specificity': 0.7827612, 'f1': 0.79252064, 'auroc': 0.9651835, 'binary_precision': 0.62081784, 'binary_recall': 0.5778547, 'binary_specificity': 0.98766774, 'binary_f1_score': 0.5985663}
confusion matrix:
       0    1
0  40845  510
1    610  835
---- Validation: 
scalar performance:
{'acc': 0.9696821, 'precision': 0.7764785, 'recall': 0.7752353, 'specificity': 0.7752353, 'f1': 0.7758553, 'auroc': 0.95635694, 'binary_precision': 0.56875, 'binary_recall': 0.5660964, 'binary_specificity': 0.9843741, 'binary_f1_score': 0.5674201}
confusion matrix:
       0    1
0  17387  276
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.7610407, 'recall': 0.5235157, 'specificity': 0.5235157, 'f1': 0.53468543, 'auroc': 0.8825214, 'binary_precision': 0.56, 'binary_recall': 0.048611112, 'binary_specificity': 0.99842024, 'binary_f1_score': 0.08945687}
confusion matrix:
      0   1
0  6952  11
1   274  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 4
val acc:0.9696820974349976, best validation acc: 0.9712662696838379, corresponding to test acc:                         0.9615225195884705 / 0.9615225195884705
after epoch: 5,now: 2024-05-28 14:52:44.944282,epoch time: 0:20:32.114153,used: 1:40:00.290124,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97418225, 'precision': 0.8029709, 'recall': 0.7975, 'specificity': 0.7975, 'f1': 0.8002081, 'auroc': 0.9666021, 'binary_precision': 0.6196189, 'binary_recall': 0.60803324, 'binary_specificity': 0.98696685, 'binary_f1_score': 0.61377144}
confusion matrix:
       0    1
0  40817  539
1    566  878
---- Validation: 
scalar performance:
{'acc': 0.971157, 'precision': 0.78118217, 'recall': 0.83968985, 'specificity': 0.83968985, 'f1': 0.80736375, 'auroc': 0.9626431, 'binary_precision': 0.5734355, 'binary_recall': 0.6982893, 'binary_specificity': 0.9810904, 'binary_f1_score': 0.62973356}
confusion matrix:
       0    1
0  17329  334
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.7305859, 'recall': 0.51165015, 'specificity': 0.51165015, 'f1': 0.513038, 'auroc': 0.9104017, 'binary_precision': 0.5, 'binary_recall': 0.024305556, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.046357613}
confusion matrix:
      0  1
0  6956  7
1   281  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 5
val acc:0.9711570143699646, best validation acc: 0.9712662696838379, corresponding to test acc:                         0.9615225195884705 / 0.9615225195884705
after epoch: 6,now: 2024-05-28 15:12:47.460489,epoch time: 0:20:02.516207,used: 2:00:02.806331,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.973271, 'precision': 0.7919451, 'recall': 0.81373703, 'specificity': 0.81373703, 'f1': 0.80240834, 'auroc': 0.96741486, 'binary_precision': 0.59640104, 'binary_recall': 0.6426593, 'binary_specificity': 0.98481476, 'binary_f1_score': 0.61866665}
confusion matrix:
       0    1
0  40728  628
1    516  928
---- Validation: 
scalar performance:
{'acc': 0.97164863, 'precision': 0.7845948, 'recall': 0.8391953, 'specificity': 0.8391953, 'f1': 0.809235, 'auroc': 0.9641856, 'binary_precision': 0.5803109, 'binary_recall': 0.6967341, 'binary_specificity': 0.98165655, 'binary_f1_score': 0.6332155}
confusion matrix:
       0    1
0  17339  324
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.7304585, 'recall': 0.5083215, 'specificity': 0.5083215, 'f1': 0.50664055, 'auroc': 0.8393824, 'binary_precision': 0.5, 'binary_recall': 0.017361112, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.03355705}
confusion matrix:
      0  1
0  6958  5
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
better model found
persisted
after epoch: 7,now: 2024-05-28 15:32:34.199438,epoch time: 0:19:46.738949,used: 2:19:49.545280,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9721963, 'precision': 0.78111124, 'recall': 0.83557034, 'specificity': 0.83557034, 'f1': 0.80567396, 'auroc': 0.97034454, 'binary_precision': 0.57315665, 'binary_recall': 0.6890582, 'binary_specificity': 0.9820824, 'binary_f1_score': 0.6257861}
confusion matrix:
       0    1
0  40615  741
1    449  995
---- Validation: 
scalar performance:
{'acc': 0.96957284, 'precision': 0.7719738, 'recall': 0.8201365, 'specificity': 0.8201365, 'f1': 0.793869, 'auroc': 0.9648262, 'binary_precision': 0.55643046, 'binary_recall': 0.65940905, 'binary_specificity': 0.9808639, 'binary_f1_score': 0.6035588}
confusion matrix:
       0    1
0  17325  338
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.78169465, 'recall': 0.54051775, 'specificity': 0.54051775, 'f1': 0.56329346, 'auroc': 0.88484156, 'binary_precision': 0.6, 'binary_recall': 0.083333336, 'binary_specificity': 0.9977021, 'binary_f1_score': 0.14634147}
confusion matrix:
      0   1
0  6947  16
1   264  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 1
val acc:0.9695728421211243, best validation acc: 0.971648633480072, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 8,now: 2024-05-28 15:51:12.781550,epoch time: 0:18:38.582112,used: 2:38:28.127392,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97324765, 'precision': 0.78886503, 'recall': 0.8362217, 'specificity': 0.8362217, 'f1': 0.8105583, 'auroc': 0.9721788, 'binary_precision': 0.5886525, 'binary_recall': 0.68927336, 'binary_specificity': 0.9831701, 'binary_f1_score': 0.6350016}
confusion matrix:
       0    1
0  40659  696
1    449  996
---- Validation: 
scalar performance:
{'acc': 0.970283, 'precision': 0.7757927, 'recall': 0.8339918, 'specificity': 0.8339918, 'f1': 0.801793, 'auroc': 0.9661871, 'binary_precision': 0.5630573, 'binary_recall': 0.6874028, 'binary_specificity': 0.98058087, 'binary_f1_score': 0.6190476}
confusion matrix:
       0    1
0  17320  343
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.7703227, 'recall': 0.51852274, 'specificity': 0.51852274, 'f1': 0.5257919, 'auroc': 0.87488365, 'binary_precision': 0.57894737, 'binary_recall': 0.038194444, 'binary_specificity': 0.99885106, 'binary_f1_score': 0.07166124}
confusion matrix:
      0   1
0  6955   8
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 2
val acc:0.9702829718589783, best validation acc: 0.971648633480072, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 9,now: 2024-05-28 16:09:32.195493,epoch time: 0:18:19.413943,used: 2:56:47.541335,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97371495, 'precision': 0.7950518, 'recall': 0.81843126, 'specificity': 0.81843126, 'f1': 0.8062501, 'auroc': 0.97459227, 'binary_precision': 0.6023018, 'binary_recall': 0.6519031, 'binary_specificity': 0.9849595, 'binary_f1_score': 0.6261216}
confusion matrix:
       0    1
0  40733  622
1    503  942
---- Validation: 
scalar performance:
{'acc': 0.97033757, 'precision': 0.77554, 'recall': 0.84301174, 'specificity': 0.84301174, 'f1': 0.805166, 'auroc': 0.9668067, 'binary_precision': 0.5618812, 'binary_recall': 0.7060653, 'binary_specificity': 0.9799581, 'binary_f1_score': 0.62577534}
confusion matrix:
       0    1
0  17309  354
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.78640723, 'recall': 0.51859456, 'specificity': 0.51859456, 'f1': 0.5259449, 'auroc': 0.8782115, 'binary_precision': 0.6111111, 'binary_recall': 0.038194444, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.07189543}
confusion matrix:
      0   1
0  6956   7
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 3
val acc:0.9703375697135925, best validation acc: 0.971648633480072, corresponding to test acc:                         0.9602813124656677 / 0.9615225195884705
after epoch: 10,now: 2024-05-28 16:27:43.360506,epoch time: 0:18:11.165013,used: 3:14:58.706348,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9716355, 'precision': 0.77569485, 'recall': 0.8555716, 'specificity': 0.8555716, 'f1': 0.8100111, 'auroc': 0.9697394, 'binary_precision': 0.5608719, 'binary_recall': 0.73111576, 'binary_specificity': 0.98002756, 'binary_f1_score': 0.6347774}
confusion matrix:
       0     1
0  40531   826
1    388  1055
---- Validation: 
scalar performance:
{'acc': 0.9668961, 'precision': 0.7554661, 'recall': 0.87419736, 'specificity': 0.87419736, 'f1': 0.80220675, 'auroc': 0.96589106, 'binary_precision': 0.5192909, 'binary_recall': 0.7744945, 'binary_specificity': 0.97390026, 'binary_f1_score': 0.6217228}
confusion matrix:
       0    1
0  17202  461
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619363, 'precision': 0.7546774, 'recall': 0.6423274, 'specificity': 0.6423274, 'f1': 0.6807651, 'auroc': 0.8847859, 'binary_precision': 0.53797466, 'binary_recall': 0.2951389, 'binary_specificity': 0.989516, 'binary_f1_score': 0.38116592}
confusion matrix:
      0   1
0  6890  73
1   203  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
new oracle model saved
early stop counter: 4
val acc:0.966896116733551, best validation acc: 0.971648633480072, corresponding to test acc:                         0.9602813124656677 / 0.9619362950325012
after epoch: 11,now: 2024-05-28 16:46:11.851108,epoch time: 0:18:28.490602,used: 3:33:27.196950,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9728738, 'precision': 0.79249465, 'recall': 0.7879927, 'specificity': 0.7879927, 'f1': 0.79022443, 'auroc': 0.9608414, 'binary_precision': 0.5992958, 'binary_recall': 0.5897436, 'binary_specificity': 0.98624176, 'binary_f1_score': 0.5944813}
confusion matrix:
       0    1
0  40788  569
1    592  851
---- Validation: 
scalar performance:
{'acc': 0.96804327, 'precision': 0.7625748, 'recall': 0.8028593, 'specificity': 0.8028593, 'f1': 0.78111255, 'auroc': 0.9518249, 'binary_precision': 0.538874, 'binary_recall': 0.62519443, 'binary_specificity': 0.98052424, 'binary_f1_score': 0.57883364}
confusion matrix:
       0    1
0  17319  344
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.77643394, 'recall': 0.5219232, 'specificity': 0.5219232, 'f1': 0.53192985, 'auroc': 0.8248503, 'binary_precision': 0.59090906, 'binary_recall': 0.045138888, 'binary_specificity': 0.9987075, 'binary_f1_score': 0.08387096}
confusion matrix:
      0   1
0  6954   9
1   275  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 5
val acc:0.9680432677268982, best validation acc: 0.971648633480072, corresponding to test acc:                         0.9602813124656677 / 0.9619362950325012
after epoch: 12,now: 2024-05-28 17:04:41.033110,epoch time: 0:18:29.182002,used: 3:51:56.378952,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9752337, 'precision': 0.80407155, 'recall': 0.839253, 'specificity': 0.839253, 'f1': 0.82060206, 'auroc': 0.9744741, 'binary_precision': 0.61890054, 'binary_recall': 0.6934256, 'binary_specificity': 0.9850804, 'binary_f1_score': 0.65404695}
confusion matrix:
       0     1
0  40738   617
1    443  1002
---- Validation: 
scalar performance:
{'acc': 0.97334206, 'precision': 0.7945242, 'recall': 0.85580814, 'specificity': 0.85580814, 'f1': 0.8219574, 'auroc': 0.9684139, 'binary_precision': 0.5989783, 'binary_recall': 0.7293935, 'binary_specificity': 0.98222274, 'binary_f1_score': 0.657784}
confusion matrix:
       0    1
0  17349  314
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96386707, 'precision': 0.798059, 'recall': 0.6083824, 'specificity': 0.6083824, 'f1': 0.65481967, 'auroc': 0.9108502, 'binary_precision': 0.627451, 'binary_recall': 0.22222222, 'binary_specificity': 0.9945426, 'binary_f1_score': 0.32820514}
confusion matrix:
      0   1
0  6925  38
1   224  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-05-28 17:23:08.676648,epoch time: 0:18:27.643538,used: 4:10:24.022490,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97028035, 'precision': 0.76990205, 'recall': 0.8036307, 'specificity': 0.8036307, 'f1': 0.7856653, 'auroc': 0.94935405, 'binary_precision': 0.55297, 'binary_recall': 0.6249135, 'binary_specificity': 0.98234797, 'binary_f1_score': 0.58674467}
confusion matrix:
       0    1
0  40625  730
1    542  903
---- Validation: 
scalar performance:
{'acc': 0.96935433, 'precision': 0.7709594, 'recall': 0.8125303, 'specificity': 0.8125303, 'f1': 0.7900926, 'auroc': 0.95748484, 'binary_precision': 0.5549598, 'binary_recall': 0.64385694, 'binary_specificity': 0.9812037, 'binary_f1_score': 0.5961123}
confusion matrix:
       0    1
0  17331  332
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.7691824, 'recall': 0.55216783, 'specificity': 0.55216783, 'f1': 0.58075625, 'auroc': 0.8827699, 'binary_precision': 0.5740741, 'binary_recall': 0.10763889, 'binary_specificity': 0.9966968, 'binary_f1_score': 0.18128654}
confusion matrix:
      0   1
0  6940  23
1   257  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 1
val acc:0.9693543314933777, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 14,now: 2024-05-28 17:41:49.558050,epoch time: 0:18:40.881402,used: 4:29:04.903892,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9740187, 'precision': 0.7956747, 'recall': 0.830276, 'specificity': 0.830276, 'f1': 0.81191957, 'auroc': 0.9625261, 'binary_precision': 0.60271436, 'binary_recall': 0.6761246, 'binary_specificity': 0.9844275, 'binary_f1_score': 0.6373125}
confusion matrix:
       0    1
0  40711  644
1    468  977
---- Validation: 
scalar performance:
{'acc': 0.97214025, 'precision': 0.7898751, 'recall': 0.82446414, 'specificity': 0.82446414, 'f1': 0.8060887, 'auroc': 0.9597421, 'binary_precision': 0.5919779, 'binary_recall': 0.66562986, 'binary_specificity': 0.9832984, 'binary_f1_score': 0.6266472}
confusion matrix:
       0    1
0  17368  295
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.70261437, 'recall': 0.5065854, 'specificity': 0.5065854, 'f1': 0.50329554, 'auroc': 0.8379617, 'binary_precision': 0.44444445, 'binary_recall': 0.013888889, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.026936026}
confusion matrix:
      0  1
0  6958  5
1   284  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 2
val acc:0.9721402525901794, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 15,now: 2024-05-28 18:00:30.421378,epoch time: 0:18:40.863328,used: 4:47:45.767220,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9707009, 'precision': 0.77086544, 'recall': 0.8382432, 'specificity': 0.8382432, 'f1': 0.8004067, 'auroc': 0.9723675, 'binary_precision': 0.5524437, 'binary_recall': 0.69619375, 'binary_specificity': 0.9802926, 'binary_f1_score': 0.6160441}
confusion matrix:
       0     1
0  40540   815
1    439  1006
---- Validation: 
scalar performance:
{'acc': 0.9692997, 'precision': 0.768957, 'recall': 0.845471, 'specificity': 0.845471, 'f1': 0.80188024, 'auroc': 0.9607202, 'binary_precision': 0.548503, 'binary_recall': 0.7122862, 'binary_specificity': 0.97865593, 'binary_f1_score': 0.61975646}
confusion matrix:
       0    1
0  17286  377
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615225, 'precision': 0.79244375, 'recall': 0.53892523, 'specificity': 0.53892523, 'f1': 0.56092936, 'auroc': 0.8031507, 'binary_precision': 0.6216216, 'binary_recall': 0.07986111, 'binary_specificity': 0.99798936, 'binary_f1_score': 0.14153847}
confusion matrix:
      0   1
0  6949  14
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 3
val acc:0.9692996740341187, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 16,now: 2024-05-28 18:18:46.196105,epoch time: 0:18:15.774727,used: 5:06:01.541947,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97390187, 'precision': 0.7887498, 'recall': 0.87963724, 'specificity': 0.87963724, 'f1': 0.8273337, 'auroc': 0.9771841, 'binary_precision': 0.5853278, 'binary_recall': 0.7785467, 'binary_specificity': 0.98072785, 'binary_f1_score': 0.6682507}
confusion matrix:
       0     1
0  40558   797
1    320  1125
---- Validation: 
scalar performance:
{'acc': 0.9702283, 'precision': 0.77311814, 'recall': 0.87592417, 'specificity': 0.87592417, 'f1': 0.8153968, 'auroc': 0.9674019, 'binary_precision': 0.5545657, 'binary_recall': 0.7744945, 'binary_specificity': 0.9773538, 'binary_f1_score': 0.6463335}
confusion matrix:
       0    1
0  17263  400
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96248794, 'precision': 0.81556296, 'recall': 0.55440664, 'specificity': 0.55440664, 'f1': 0.5856376, 'auroc': 0.89467454, 'binary_precision': 0.6666667, 'binary_recall': 0.11111111, 'binary_specificity': 0.9977021, 'binary_f1_score': 0.1904762}
confusion matrix:
      0   1
0  6947  16
1   256  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 4
val acc:0.9702283143997192, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 17,now: 2024-05-28 18:37:04.076141,epoch time: 0:18:17.880036,used: 5:24:19.421983,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97689253, 'precision': 0.8303715, 'recall': 0.80003977, 'specificity': 0.80003977, 'f1': 0.814409, 'auroc': 0.96411943, 'binary_precision': 0.67431194, 'binary_recall': 0.61038065, 'binary_specificity': 0.98969895, 'binary_f1_score': 0.6407556}
confusion matrix:
       0    1
0  40929  426
1    563  882
---- Validation: 
scalar performance:
{'acc': 0.97290504, 'precision': 0.8004364, 'recall': 0.79863507, 'specificity': 0.79863507, 'f1': 0.7995327, 'auroc': 0.9585529, 'binary_precision': 0.6150235, 'binary_recall': 0.61119753, 'binary_specificity': 0.9860726, 'binary_f1_score': 0.6131045}
confusion matrix:
       0    1
0  17417  246
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.8555329, 'recall': 0.51027304, 'specificity': 0.51027304, 'f1': 0.5102745, 'auroc': 0.84575367, 'binary_precision': 0.75, 'binary_recall': 0.020833334, 'binary_specificity': 0.99971277, 'binary_f1_score': 0.040540542}
confusion matrix:
      0  1
0  6961  2
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 5
val acc:0.9729050397872925, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 18,now: 2024-05-28 18:55:20.772343,epoch time: 0:18:16.696202,used: 5:42:36.118185,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9773832, 'precision': 0.8184438, 'recall': 0.85739577, 'specificity': 0.85739577, 'f1': 0.83668566, 'auroc': 0.96994674, 'binary_precision': 0.64640886, 'binary_recall': 0.7287197, 'binary_specificity': 0.9860718, 'binary_f1_score': 0.6851009}
confusion matrix:
       0     1
0  40779   576
1    392  1053
---- Validation: 
scalar performance:
{'acc': 0.971157, 'precision': 0.77967775, 'recall': 0.8584223, 'specificity': 0.8584223, 'f1': 0.81362456, 'auroc': 0.95162857, 'binary_precision': 0.5690276, 'binary_recall': 0.7371695, 'binary_specificity': 0.97967505, 'binary_f1_score': 0.6422764}
confusion matrix:
       0    1
0  17304  359
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96290165, 'precision': 0.8377926, 'recall': 0.55462205, 'specificity': 0.55462205, 'f1': 0.5866035, 'auroc': 0.8826623, 'binary_precision': 0.7111111, 'binary_recall': 0.11111111, 'binary_specificity': 0.998133, 'binary_f1_score': 0.1921922}
confusion matrix:
      0   1
0  6950  13
1   256  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 6
val acc:0.9711570143699646, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 19,now: 2024-05-28 19:13:39.458064,epoch time: 0:18:18.685721,used: 6:00:54.803906,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9716355, 'precision': 0.7738029, 'recall': 0.89576495, 'specificity': 0.89576495, 'f1': 0.82238185, 'auroc': 0.97519886, 'binary_precision': 0.55419415, 'binary_recall': 0.8144044, 'binary_specificity': 0.97712547, 'binary_f1_score': 0.6595625}
confusion matrix:
       0     1
0  40410   946
1    268  1176
---- Validation: 
scalar performance:
{'acc': 0.9652027, 'precision': 0.74771035, 'recall': 0.88455933, 'specificity': 0.88455933, 'f1': 0.7993654, 'auroc': 0.9609258, 'binary_precision': 0.5029412, 'binary_recall': 0.7978227, 'binary_specificity': 0.97129595, 'binary_f1_score': 0.61695737}
confusion matrix:
       0    1
0  17156  507
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96290165, 'precision': 0.77517915, 'recall': 0.61453694, 'specificity': 0.61453694, 'f1': 0.6583602, 'auroc': 0.8949348, 'binary_precision': 0.5811966, 'binary_recall': 0.2361111, 'binary_specificity': 0.9929628, 'binary_f1_score': 0.33580247}
confusion matrix:
      0   1
0  6914  49
1   220  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 7
val acc:0.9652026891708374, best validation acc: 0.9733420610427856, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 20,now: 2024-05-28 19:32:03.400081,epoch time: 0:18:23.942017,used: 6:19:18.745923,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.976986, 'precision': 0.89482474, 'recall': 0.7060515, 'specificity': 0.7060515, 'f1': 0.76869535, 'auroc': 0.9653328, 'binary_precision': 0.8097166, 'binary_recall': 0.41551247, 'binary_specificity': 0.99659055, 'binary_f1_score': 0.5491991}
confusion matrix:
       0    1
0  41215  141
1    844  600
---- Validation: 
scalar performance:
{'acc': 0.9744346, 'precision': 0.8491888, 'recall': 0.72075146, 'specificity': 0.72075146, 'f1': 0.76928306, 'auroc': 0.9490102, 'binary_precision': 0.7182045, 'binary_recall': 0.44790047, 'binary_specificity': 0.99360245, 'binary_f1_score': 0.5517241}
confusion matrix:
       0    1
0  17550  113
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96235, 'precision': 0.85261595, 'recall': 0.5393561, 'specificity': 0.5393561, 'f1': 0.5624761, 'auroc': 0.90873337, 'binary_precision': 0.7419355, 'binary_recall': 0.07986111, 'binary_specificity': 0.99885106, 'binary_f1_score': 0.14420062}
confusion matrix:
      0   1
0  6955   8
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
better model found
persisted
after epoch: 21,now: 2024-05-28 19:50:23.279381,epoch time: 0:18:19.879300,used: 6:37:38.625223,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97593457, 'precision': 0.83248276, 'recall': 0.7658171, 'specificity': 0.7658171, 'f1': 0.7951075, 'auroc': 0.97270864, 'binary_precision': 0.6809067, 'binary_recall': 0.5404844, 'binary_specificity': 0.9911498, 'binary_f1_score': 0.6026234}
confusion matrix:
       0    1
0  40989  366
1    664  781
---- Validation: 
scalar performance:
{'acc': 0.971157, 'precision': 0.79249895, 'recall': 0.7572671, 'specificity': 0.7572671, 'f1': 0.7736381, 'auroc': 0.9565709, 'binary_precision': 0.6021314, 'binary_recall': 0.5272162, 'binary_specificity': 0.9873181, 'binary_f1_score': 0.5621891}
confusion matrix:
       0    1
0  17439  224
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615225, 'precision': 0.77982676, 'recall': 0.54724675, 'specificity': 0.54724675, 'f1': 0.57373524, 'auroc': 0.87476945, 'binary_precision': 0.59574467, 'binary_recall': 0.097222224, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.16716419}
confusion matrix:
      0   1
0  6944  19
1   260  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 1
val acc:0.9711570143699646, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 22,now: 2024-05-28 20:08:43.831342,epoch time: 0:18:20.551961,used: 6:55:59.177184,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9727336, 'precision': 0.78214103, 'recall': 0.86659205, 'specificity': 0.86659205, 'f1': 0.8182582, 'auroc': 0.97618556, 'binary_precision': 0.57301, 'binary_recall': 0.75277007, 'binary_specificity': 0.980414, 'binary_f1_score': 0.6507034}
confusion matrix:
       0     1
0  40546   810
1    357  1087
---- Validation: 
scalar performance:
{'acc': 0.9669507, 'precision': 0.7556039, 'recall': 0.8592398, 'specificity': 0.8592398, 'f1': 0.7975837, 'auroc': 0.96392226, 'binary_precision': 0.5206972, 'binary_recall': 0.7433904, 'binary_specificity': 0.9750892, 'binary_f1_score': 0.61242795}
confusion matrix:
       0    1
0  17223  440
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95917803, 'precision': 0.69455254, 'recall': 0.5377045, 'specificity': 0.5377045, 'f1': 0.5567995, 'auroc': 0.782049, 'binary_precision': 0.42592594, 'binary_recall': 0.07986111, 'binary_specificity': 0.9955479, 'binary_f1_score': 0.13450292}
confusion matrix:
      0   1
0  6932  31
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 2
val acc:0.9669507145881653, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 23,now: 2024-05-28 20:26:51.254989,epoch time: 0:18:07.423647,used: 7:14:06.600831,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.973014, 'precision': 0.7807272, 'recall': 0.9149084, 'specificity': 0.9149084, 'f1': 0.83338124, 'auroc': 0.9798098, 'binary_precision': 0.56669736, 'binary_recall': 0.85259515, 'binary_specificity': 0.9772216, 'binary_f1_score': 0.6808511}
confusion matrix:
       0     1
0  40413   942
1    213  1232
---- Validation: 
scalar performance:
{'acc': 0.9668961, 'precision': 0.75588536, 'recall': 0.9056679, 'specificity': 0.9056679, 'f1': 0.8116092, 'auroc': 0.9679792, 'binary_precision': 0.51773727, 'binary_recall': 0.83981335, 'binary_specificity': 0.9715224, 'binary_f1_score': 0.6405694}
confusion matrix:
       0    1
0  17160  503
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.7471167, 'recall': 0.5434873, 'specificity': 0.5434873, 'f1': 0.56709135, 'auroc': 0.8239334, 'binary_precision': 0.53061223, 'binary_recall': 0.090277776, 'binary_specificity': 0.9966968, 'binary_f1_score': 0.15430266}
confusion matrix:
      0   1
0  6940  23
1   262  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 3
val acc:0.966896116733551, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 24,now: 2024-05-28 20:45:06.313929,epoch time: 0:18:15.058940,used: 7:32:21.659771,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.80375975, 'recall': 0.83044994, 'specificity': 0.83044994, 'f1': 0.81648624, 'auroc': 0.9772618, 'binary_precision': 0.61889666, 'binary_recall': 0.6754325, 'binary_specificity': 0.9854673, 'binary_f1_score': 0.6459299}
confusion matrix:
       0    1
0  40754  601
1    469  976
---- Validation: 
scalar performance:
{'acc': 0.9699552, 'precision': 0.7737489, 'recall': 0.83232343, 'specificity': 0.83232343, 'f1': 0.79987586, 'auroc': 0.96168536, 'binary_precision': 0.55908513, 'binary_recall': 0.6842924, 'binary_specificity': 0.9803544, 'binary_f1_score': 0.61538464}
confusion matrix:
       0    1
0  17316  347
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582127, 'precision': 0.6805889, 'recall': 0.5471877, 'specificity': 0.5471877, 'f1': 0.5696189, 'auroc': 0.8195195, 'binary_precision': 0.39726028, 'binary_recall': 0.10069445, 'binary_specificity': 0.9936809, 'binary_f1_score': 0.16066481}
confusion matrix:
      0   1
0  6919  44
1   259  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 4
val acc:0.9699552059173584, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 25,now: 2024-05-28 21:03:19.678969,epoch time: 0:18:13.365040,used: 7:50:35.024811,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96997666, 'precision': 0.76480865, 'recall': 0.8962432, 'specificity': 0.8962432, 'f1': 0.81589144, 'auroc': 0.9788455, 'binary_precision': 0.53611994, 'binary_recall': 0.8171745, 'binary_specificity': 0.97531193, 'binary_f1_score': 0.64746225}
confusion matrix:
       0     1
0  40335  1021
1    264  1180
---- Validation: 
scalar performance:
{'acc': 0.96640444, 'precision': 0.7531178, 'recall': 0.8776891, 'specificity': 0.8776891, 'f1': 0.80151427, 'auroc': 0.9673055, 'binary_precision': 0.51431495, 'binary_recall': 0.7822706, 'binary_specificity': 0.97310764, 'binary_f1_score': 0.6206046}
confusion matrix:
       0    1
0  17188  475
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.73617953, 'recall': 0.6032586, 'specificity': 0.6032586, 'f1': 0.6406678, 'auroc': 0.8712629, 'binary_precision': 0.50406504, 'binary_recall': 0.21527778, 'binary_specificity': 0.9912394, 'binary_f1_score': 0.30170316}
confusion matrix:
      0   1
0  6902  61
1   226  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 5
val acc:0.9664044380187988, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 26,now: 2024-05-28 21:21:37.080857,epoch time: 0:18:17.401888,used: 8:08:52.426699,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97647196, 'precision': 0.8059367, 'recall': 0.88389826, 'specificity': 0.88389826, 'f1': 0.84004974, 'auroc': 0.9775744, 'binary_precision': 0.61946416, 'binary_recall': 0.78462607, 'binary_specificity': 0.9831705, 'binary_f1_score': 0.6923312}
confusion matrix:
       0     1
0  40660   696
1    311  1133
---- Validation: 
scalar performance:
{'acc': 0.9699552, 'precision': 0.771946, 'recall': 0.86679107, 'specificity': 0.86679107, 'f1': 0.8114797, 'auroc': 0.96138173, 'binary_precision': 0.552901, 'binary_recall': 0.755832, 'binary_specificity': 0.9777501, 'binary_f1_score': 0.6386334}
confusion matrix:
       0    1
0  17270  393
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611088, 'precision': 0.7691253, 'recall': 0.5387098, 'specificity': 0.5387098, 'f1': 0.56017417, 'auroc': 0.8489814, 'binary_precision': 0.575, 'binary_recall': 0.07986111, 'binary_specificity': 0.99755853, 'binary_f1_score': 0.1402439}
confusion matrix:
      0   1
0  6946  17
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 6
val acc:0.9699552059173584, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 27,now: 2024-05-28 21:39:56.495525,epoch time: 0:18:19.414668,used: 8:27:11.841367,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9720561, 'precision': 0.77565515, 'recall': 0.9100716, 'specificity': 0.9100716, 'f1': 0.82814735, 'auroc': 0.9706585, 'binary_precision': 0.5568753, 'binary_recall': 0.8435986, 'binary_specificity': 0.97654456, 'binary_f1_score': 0.6708861}
confusion matrix:
       0     1
0  40385   970
1    226  1219
---- Validation: 
scalar performance:
{'acc': 0.9671692, 'precision': 0.7571151, 'recall': 0.9043108, 'specificity': 0.9043108, 'f1': 0.81220925, 'auroc': 0.96300566, 'binary_precision': 0.52030945, 'binary_recall': 0.83670294, 'binary_specificity': 0.9719187, 'binary_f1_score': 0.64162195}
confusion matrix:
       0    1
0  17167  496
1    105  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634533, 'precision': 0.7762935, 'recall': 0.63812447, 'specificity': 0.63812447, 'f1': 0.681727, 'auroc': 0.8940666, 'binary_precision': 0.58156025, 'binary_recall': 0.2847222, 'binary_specificity': 0.99152666, 'binary_f1_score': 0.38228437}
confusion matrix:
      0   1
0  6904  59
1   206  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 7
val acc:0.9671692252159119, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 28,now: 2024-05-28 21:58:13.127998,epoch time: 0:18:16.632473,used: 8:45:28.473840,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.95549065, 'precision': 0.7033988, 'recall': 0.8687743, 'specificity': 0.8687743, 'f1': 0.75862205, 'auroc': 0.96765673, 'binary_precision': 0.41487786, 'binary_recall': 0.77577853, 'binary_specificity': 0.96177006, 'binary_f1_score': 0.5406318}
confusion matrix:
       0     1
0  39774  1581
1    324  1121
---- Validation: 
scalar performance:
{'acc': 0.94378895, 'precision': 0.6733651, 'recall': 0.8479866, 'specificity': 0.8479866, 'f1': 0.72620773, 'auroc': 0.94735706, 'binary_precision': 0.35639882, 'binary_recall': 0.7449456, 'binary_specificity': 0.9510276, 'binary_f1_score': 0.4821339}
confusion matrix:
       0    1
0  16798  865
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597297, 'precision': 0.7033726, 'recall': 0.5263416, 'specificity': 0.5263416, 'f1': 0.5390851, 'auroc': 0.8300351, 'binary_precision': 0.44444445, 'binary_recall': 0.055555556, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.09876543}
confusion matrix:
      0   1
0  6943  20
1   272  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 8
val acc:0.9437889456748962, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 29,now: 2024-05-28 22:16:32.664269,epoch time: 0:18:19.536271,used: 9:03:48.010111,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96700937, 'precision': 0.7489649, 'recall': 0.84367937, 'specificity': 0.84367937, 'f1': 0.78782845, 'auroc': 0.9376054, 'binary_precision': 0.5081562, 'binary_recall': 0.7114187, 'binary_specificity': 0.97594005, 'binary_f1_score': 0.59284884}
confusion matrix:
       0     1
0  40360   995
1    417  1028
---- Validation: 
scalar performance:
{'acc': 0.9644379, 'precision': 0.74277616, 'recall': 0.84894603, 'specificity': 0.84894603, 'f1': 0.78508544, 'auroc': 0.93882895, 'binary_precision': 0.49574468, 'binary_recall': 0.7247278, 'binary_specificity': 0.97316426, 'binary_f1_score': 0.58875555}
confusion matrix:
       0    1
0  17189  474
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.7309947, 'recall': 0.58480763, 'specificity': 0.58480763, 'f1': 0.62019455, 'auroc': 0.85722524, 'binary_precision': 0.49514562, 'binary_recall': 0.17708333, 'binary_specificity': 0.99253196, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  6911  52
1   237  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897890.png
early stop counter: 9
val acc:0.9644379019737244, best validation acc: 0.9744346141815186, corresponding to test acc:                         0.9623500108718872 / 0.9638670682907104
after epoch: 30,now: 2024-05-28 22:34:34.988120,epoch time: 0:18:02.323851,used: 9:21:50.333962,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_12_44_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:21:50.333962 at 2024-05-28 22:34:34.988120
persisted model performance metric: 

scalar performance:
{'acc': 0.9627638, 'precision': 0.82236356, 'recall': 0.55787885, 'specificity': 0.55787885, 'f1': 0.5910605, 'auroc': 0.90820515, 'binary_precision': 0.68, 'binary_recall': 0.11805555, 'binary_specificity': 0.9977021, 'binary_f1_score': 0.20118344}
confusion matrix:
      0   1
0  6947  16
1   254  34
oracle model performance metric: 

scalar performance:
{'acc': 0.96414286, 'precision': 0.80177665, 'recall': 0.6118546, 'specificity': 0.6118546, 'f1': 0.65915406, 'auroc': 0.905969, 'binary_precision': 0.63461536, 'binary_recall': 0.22916667, 'binary_specificity': 0.9945426, 'binary_f1_score': 0.3367347}
confusion matrix:
      0   1
0  6925  38
1   222  66
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496085 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |  90005 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496085 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |  90005 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476619 KiB |  10962 MiB |   4364 TiB |   4364 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4357 TiB |   4357 TiB |
|       from small pool |  88779 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11238 MiB |  11392 MiB |  30062 MiB |  18824 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    126 MiB |    126 MiB |    182 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1435 TiB |   1435 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1427 TiB |   1427 TiB |
|       from small pool |      8 MiB |     35 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4101    |    7764    |  362540 K  |  362536 K  |
|       from large pool |      87    |     909    |  170626 K  |  170626 K  |
|       from small pool |    4014    |    7642    |  191914 K  |  191910 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4101    |    7764    |  362540 K  |  362536 K  |
|       from large pool |      87    |     909    |  170626 K  |  170626 K  |
|       from small pool |    4014    |    7642    |  191914 K  |  191910 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     539    |     304    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      63    |      63    |      91    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2768    |  191494 K  |  191494 K  |
|       from large pool |      24    |      65    |   89522 K  |   89522 K  |
|       from small pool |      54    |    2747    |  101971 K  |  101971 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4364 TiB |   4364 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4357 TiB |   4357 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30062 MiB |  28230 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    182 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1435 TiB |   1435 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1427 TiB |   1427 TiB |
|       from small pool |      0 KiB |     35 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  362540 K  |  362540 K  |
|       from large pool |       2    |     909    |  170626 K  |  170626 K  |
|       from small pool |       0    |    7642    |  191914 K  |  191914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  362540 K  |  362540 K  |
|       from large pool |       2    |     909    |  170626 K  |  170626 K  |
|       from small pool |       0    |    7642    |  191914 K  |  191914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     539    |     457    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      91    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  191496 K  |  191496 K  |
|       from large pool |       4    |      65    |   89523 K  |   89522 K  |
|       from small pool |       0    |    2747    |  101973 K  |  101973 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4375 TiB |   4375 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4364 TiB |   4364 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4357 TiB |   4357 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30062 MiB |  28230 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    182 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1435 TiB |   1435 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1427 TiB |   1427 TiB |
|       from small pool |      0 KiB |     35 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  362540 K  |  362540 K  |
|       from large pool |       2    |     909    |  170626 K  |  170626 K  |
|       from small pool |       0    |    7642    |  191914 K  |  191914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  362540 K  |  362540 K  |
|       from large pool |       2    |     909    |  170626 K  |  170626 K  |
|       from small pool |       0    |    7642    |  191914 K  |  191914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     539    |     457    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      91    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  191496 K  |  191496 K  |
|       from large pool |       4    |      65    |   89523 K  |   89522 K  |
|       from small pool |       0    |    2747    |  101973 K  |  101973 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890

 Experiment start at: 2024-05-28 22:43:45.201391
before training, model accuracy: 0.2902069687843323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97020257, 'precision': 0.7833716, 'recall': 0.7859246, 'specificity': 0.7859246, 'f1': 0.78464174, 'auroc': 0.9434897, 'binary_precision': 0.5820257, 'binary_recall': 0.587473, 'binary_specificity': 0.98437625, 'binary_f1_score': 0.58473665}
confusion matrix:
       0    1
0  36921  586
1    573  816
---- Validation: 
scalar performance:
{'acc': 0.96738154, 'precision': 0.76240504, 'recall': 0.78483534, 'specificity': 0.78483534, 'f1': 0.773106, 'auroc': 0.93819964, 'binary_precision': 0.54012346, 'binary_recall': 0.5882353, 'binary_specificity': 0.98143536, 'binary_f1_score': 0.5631536}
confusion matrix:
       0    1
0  15754  298
1    245  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629961, 'precision': 0.7037368, 'recall': 0.7599691, 'specificity': 0.7599691, 'f1': 0.7280221, 'auroc': 0.9258572, 'binary_precision': 0.42212188, 'binary_recall': 0.5436047, 'binary_specificity': 0.97633356, 'binary_f1_score': 0.47522235}
confusion matrix:
       0    1
0  10561  256
1    157  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 23:04:37.980860,epoch time: 0:20:52.779469,used: 0:20:52.779469,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96655184, 'precision': 0.7565311, 'recall': 0.7871514, 'specificity': 0.7871514, 'f1': 0.7708745, 'auroc': 0.94532645, 'binary_precision': 0.52816904, 'binary_recall': 0.5939525, 'binary_specificity': 0.9803503, 'binary_f1_score': 0.5591325}
confusion matrix:
       0    1
0  36770  737
1    564  825
---- Validation: 
scalar performance:
{'acc': 0.9660599, 'precision': 0.75359726, 'recall': 0.77201223, 'specificity': 0.77201223, 'f1': 0.7624432, 'auroc': 0.9316915, 'binary_precision': 0.5234375, 'binary_recall': 0.56302524, 'binary_specificity': 0.98099923, 'binary_f1_score': 0.54251015}
confusion matrix:
       0    1
0  15747  305
1    260  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698952, 'precision': 0.74823606, 'recall': 0.6762779, 'specificity': 0.6762779, 'f1': 0.7055814, 'auroc': 0.9386677, 'binary_precision': 0.5165289, 'binary_recall': 0.3633721, 'binary_specificity': 0.98918366, 'binary_f1_score': 0.42662114}
confusion matrix:
       0    1
0  10700  117
1    219  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
new oracle model saved
early stop counter: 1
val acc:0.9660599231719971, best validation acc: 0.9673815369606018, corresponding to test acc:                         0.9629961252212524 / 0.9698951840400696
after epoch: 2,now: 2024-05-28 23:23:42.303561,epoch time: 0:19:04.322701,used: 0:39:57.102170,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97009975, 'precision': 0.7807838, 'recall': 0.80077684, 'specificity': 0.80077684, 'f1': 0.79039776, 'auroc': 0.9524975, 'binary_precision': 0.57573724, 'binary_recall': 0.61843055, 'binary_specificity': 0.9831231, 'binary_f1_score': 0.5963207}
confusion matrix:
       0    1
0  36874  633
1    530  859
---- Validation: 
scalar performance:
{'acc': 0.9672013, 'precision': 0.7615486, 'recall': 0.77422243, 'specificity': 0.77422243, 'f1': 0.76771796, 'auroc': 0.9441157, 'binary_precision': 0.5392, 'binary_recall': 0.5663866, 'binary_specificity': 0.9820583, 'binary_f1_score': 0.55245906}
confusion matrix:
       0    1
0  15764  288
1    258  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96729684, 'precision': 0.71681386, 'recall': 0.64960665, 'specificity': 0.64960665, 'f1': 0.6764079, 'auroc': 0.9399839, 'binary_precision': 0.45531914, 'binary_recall': 0.3110465, 'binary_specificity': 0.98816675, 'binary_f1_score': 0.36960277}
confusion matrix:
       0    1
0  10689  128
1    237  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 2
val acc:0.967201292514801, best validation acc: 0.9673815369606018, corresponding to test acc:                         0.9629961252212524 / 0.9698951840400696
after epoch: 3,now: 2024-05-28 23:42:53.132955,epoch time: 0:19:10.829394,used: 0:59:07.931564,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96848005, 'precision': 0.76709306, 'recall': 0.8439603, 'specificity': 0.8439603, 'f1': 0.80009985, 'auroc': 0.952425, 'binary_precision': 0.5450525, 'binary_recall': 0.7098632, 'binary_specificity': 0.97805744, 'binary_f1_score': 0.6166354}
confusion matrix:
       0    1
0  36684  823
1    403  986
---- Validation: 
scalar performance:
{'acc': 0.9660599, 'precision': 0.75385785, 'recall': 0.85212183, 'specificity': 0.85212183, 'f1': 0.7939944, 'auroc': 0.9474838, 'binary_precision': 0.51789975, 'binary_recall': 0.7294118, 'binary_specificity': 0.9748318, 'binary_f1_score': 0.6057222}
confusion matrix:
       0    1
0  15648  404
1    161  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96371293, 'precision': 0.7132384, 'recall': 0.8025569, 'specificity': 0.8025569, 'f1': 0.7492152, 'auroc': 0.94481534, 'binary_precision': 0.43838385, 'binary_recall': 0.63081396, 'binary_specificity': 0.9742997, 'binary_f1_score': 0.5172825}
confusion matrix:
       0    1
0  10539  278
1    127  217
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 3
val acc:0.9660599231719971, best validation acc: 0.9673815369606018, corresponding to test acc:                         0.9629961252212524 / 0.9698951840400696
after epoch: 4,now: 2024-05-29 00:02:05.524732,epoch time: 0:19:12.391777,used: 1:18:20.323341,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9715652, 'precision': 0.7898091, 'recall': 0.8178288, 'specificity': 0.8178288, 'f1': 0.8031008, 'auroc': 0.95837116, 'binary_precision': 0.59254414, 'binary_recall': 0.6522678, 'binary_specificity': 0.9833898, 'binary_f1_score': 0.6209732}
confusion matrix:
       0    1
0  36884  623
1    483  906
---- Validation: 
scalar performance:
{'acc': 0.96912354, 'precision': 0.773034, 'recall': 0.81082344, 'specificity': 0.81082344, 'f1': 0.7905626, 'auroc': 0.9517517, 'binary_precision': 0.55947137, 'binary_recall': 0.64033616, 'binary_specificity': 0.9813107, 'binary_f1_score': 0.5971787}
confusion matrix:
       0    1
0  15752  300
1    214  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622794, 'precision': 0.71187145, 'recall': 0.8454425, 'specificity': 0.8454425, 'f1': 0.76061296, 'auroc': 0.9452834, 'binary_precision': 0.43280977, 'binary_recall': 0.7209302, 'binary_specificity': 0.9699547, 'binary_f1_score': 0.5408942}
confusion matrix:
       0    1
0  10492  325
1     96  248
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
better model found
persisted
after epoch: 5,now: 2024-05-29 00:21:16.419094,epoch time: 0:19:10.894362,used: 1:37:31.217703,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9678887, 'precision': 0.7631999, 'recall': 0.8622821, 'specificity': 0.8622821, 'f1': 0.8039068, 'auroc': 0.9627225, 'binary_precision': 0.5358432, 'binary_recall': 0.74855906, 'binary_specificity': 0.97600514, 'binary_f1_score': 0.62458664}
confusion matrix:
       0     1
0  36608   900
1    349  1039
---- Validation: 
scalar performance:
{'acc': 0.9682225, 'precision': 0.76582974, 'recall': 0.84110534, 'specificity': 0.84110534, 'f1': 0.7982261, 'auroc': 0.95839167, 'binary_precision': 0.5427461, 'binary_recall': 0.7042017, 'binary_specificity': 0.978009, 'binary_f1_score': 0.61302125}
confusion matrix:
       0    1
0  15699  353
1    176  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618314, 'precision': 0.7089673, 'recall': 0.8367678, 'specificity': 0.8367678, 'f1': 0.75598633, 'auroc': 0.9515567, 'binary_precision': 0.42756185, 'binary_recall': 0.70348835, 'binary_specificity': 0.9700472, 'binary_f1_score': 0.5318681}
confusion matrix:
       0    1
0  10493  324
1    102  242
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 1
val acc:0.9682224988937378, best validation acc: 0.9691235423088074, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 6,now: 2024-05-29 00:40:26.544880,epoch time: 0:19:10.125786,used: 1:56:41.343489,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9723108, 'precision': 0.792396, 'recall': 0.8385574, 'specificity': 0.8385574, 'f1': 0.8135982, 'auroc': 0.95730186, 'binary_precision': 0.5961657, 'binary_recall': 0.69452447, 'binary_specificity': 0.9825904, 'binary_f1_score': 0.64159733}
confusion matrix:
       0    1
0  36855  653
1    424  964
---- Validation: 
scalar performance:
{'acc': 0.96834266, 'precision': 0.76716405, 'recall': 0.8241747, 'specificity': 0.8241747, 'f1': 0.79258955, 'auroc': 0.9551295, 'binary_precision': 0.5467033, 'binary_recall': 0.6689076, 'binary_specificity': 0.9794418, 'binary_f1_score': 0.6016629}
confusion matrix:
       0    1
0  15722  330
1    197  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691784, 'precision': 0.7402725, 'recall': 0.68575895, 'specificity': 0.68575895, 'f1': 0.7091841, 'auroc': 0.9422338, 'binary_precision': 0.5, 'binary_recall': 0.38372093, 'binary_specificity': 0.98779696, 'binary_f1_score': 0.43421054}
confusion matrix:
       0    1
0  10685  132
1    212  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 2
val acc:0.968342661857605, best validation acc: 0.9691235423088074, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 7,now: 2024-05-29 00:59:39.663724,epoch time: 0:19:13.118844,used: 2:15:54.462333,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97220796, 'precision': 0.79393256, 'recall': 0.8233617, 'specificity': 0.8233617, 'f1': 0.807868, 'auroc': 0.9657586, 'binary_precision': 0.60039115, 'binary_recall': 0.663067, 'binary_specificity': 0.9836564, 'binary_f1_score': 0.6301745}
confusion matrix:
       0    1
0  36894  613
1    468  921
---- Validation: 
scalar performance:
{'acc': 0.968643, 'precision': 0.7700203, 'recall': 0.80652833, 'specificity': 0.80652833, 'f1': 0.7869823, 'auroc': 0.95664835, 'binary_precision': 0.5537555, 'binary_recall': 0.6319328, 'binary_specificity': 0.98112386, 'binary_f1_score': 0.59026694}
confusion matrix:
       0    1
0  15749  303
1    219  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654153, 'precision': 0.7160834, 'recall': 0.749959, 'specificity': 0.749959, 'f1': 0.73164713, 'auroc': 0.9475713, 'binary_precision': 0.4475, 'binary_recall': 0.52034885, 'binary_specificity': 0.9795692, 'binary_f1_score': 0.4811828}
confusion matrix:
       0    1
0  10596  221
1    165  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 3
val acc:0.9686430096626282, best validation acc: 0.9691235423088074, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 8,now: 2024-05-29 01:18:53.691695,epoch time: 0:19:14.027971,used: 2:35:08.490304,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96580625, 'precision': 0.7530069, 'recall': 0.88451743, 'specificity': 0.88451743, 'f1': 0.8034024, 'auroc': 0.96556115, 'binary_precision': 0.5136891, 'binary_recall': 0.79697627, 'binary_specificity': 0.97205853, 'binary_f1_score': 0.62471783}
confusion matrix:
       0     1
0  36459  1048
1    282  1107
---- Validation: 
scalar performance:
{'acc': 0.96317655, 'precision': 0.74065596, 'recall': 0.8668104, 'specificity': 0.8668104, 'f1': 0.7888413, 'auroc': 0.9603161, 'binary_precision': 0.49028078, 'binary_recall': 0.7630252, 'binary_specificity': 0.97059554, 'binary_f1_score': 0.5969757}
confusion matrix:
       0    1
0  15580  472
1    141  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95842665, 'precision': 0.6969509, 'recall': 0.8448621, 'specificity': 0.8448621, 'f1': 0.74797434, 'auroc': 0.9461802, 'binary_precision': 0.40291262, 'binary_recall': 0.7238372, 'binary_specificity': 0.965887, 'binary_f1_score': 0.5176715}
confusion matrix:
       0    1
0  10448  369
1     95  249
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 4
val acc:0.9631765484809875, best validation acc: 0.9691235423088074, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 9,now: 2024-05-29 01:38:06.772773,epoch time: 0:19:13.081078,used: 2:54:21.571382,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9715395, 'precision': 0.78975767, 'recall': 0.81677556, 'specificity': 0.81677556, 'f1': 0.80259776, 'auroc': 0.9707058, 'binary_precision': 0.5925197, 'binary_recall': 0.650108, 'binary_specificity': 0.9834431, 'binary_f1_score': 0.61997944}
confusion matrix:
       0    1
0  36886  621
1    486  903
---- Validation: 
scalar performance:
{'acc': 0.96744156, 'precision': 0.7619096, 'recall': 0.8123789, 'specificity': 0.8123789, 'f1': 0.78465676, 'auroc': 0.95838034, 'binary_precision': 0.53706294, 'binary_recall': 0.6453782, 'binary_specificity': 0.97937953, 'binary_f1_score': 0.58625954}
confusion matrix:
       0    1
0  15721  331
1    211  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9649673, 'precision': 0.7185742, 'recall': 0.7933531, 'specificity': 0.7933531, 'f1': 0.7498512, 'auroc': 0.9529086, 'binary_precision': 0.4496788, 'binary_recall': 0.6104651, 'binary_specificity': 0.9762411, 'binary_f1_score': 0.5178791}
confusion matrix:
       0    1
0  10560  257
1    134  210
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 5
val acc:0.9674415588378906, best validation acc: 0.9691235423088074, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 10,now: 2024-05-29 01:57:16.840388,epoch time: 0:19:10.067615,used: 3:13:31.638997,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9748303, 'precision': 0.81284475, 'recall': 0.8351206, 'specificity': 0.8351206, 'f1': 0.8235593, 'auroc': 0.9694493, 'binary_precision': 0.63739944, 'binary_recall': 0.6846652, 'binary_specificity': 0.98557603, 'binary_f1_score': 0.6601874}
confusion matrix:
       0    1
0  36966  541
1    438  951
---- Validation: 
scalar performance:
{'acc': 0.97062534, 'precision': 0.78231406, 'recall': 0.8245492, 'specificity': 0.8245492, 'f1': 0.801793, 'auroc': 0.954466, 'binary_precision': 0.5770349, 'binary_recall': 0.6672269, 'binary_specificity': 0.9818714, 'binary_f1_score': 0.61886203}
confusion matrix:
       0    1
0  15761  291
1    198  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622794, 'precision': 0.7161676, 'recall': 0.88484585, 'specificity': 0.88484585, 'f1': 0.7737988, 'auroc': 0.9530494, 'binary_precision': 0.43879172, 'binary_recall': 0.8023256, 'binary_specificity': 0.96736616, 'binary_f1_score': 0.56731755}
confusion matrix:
       0    1
0  10464  353
1     68  276
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
better model found
persisted
after epoch: 11,now: 2024-05-29 02:16:25.103430,epoch time: 0:19:08.263042,used: 3:32:39.902039,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.973442, 'precision': 0.7968831, 'recall': 0.8655984, 'specificity': 0.8655984, 'f1': 0.82727295, 'auroc': 0.95748734, 'binary_precision': 0.6031286, 'binary_recall': 0.74946004, 'binary_specificity': 0.9817367, 'binary_f1_score': 0.66837883}
confusion matrix:
       0     1
0  36822   685
1    348  1041
---- Validation: 
scalar performance:
{'acc': 0.9696642, 'precision': 0.77454525, 'recall': 0.8418529, 'specificity': 0.8418529, 'f1': 0.8040854, 'auroc': 0.9148487, 'binary_precision': 0.5601604, 'binary_recall': 0.7042017, 'binary_specificity': 0.9795041, 'binary_f1_score': 0.6239762}
confusion matrix:
       0    1
0  15723  329
1    176  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95555955, 'precision': 0.6956874, 'recall': 0.9024881, 'specificity': 0.9024881, 'f1': 0.7582704, 'auroc': 0.9538709, 'binary_precision': 0.39645776, 'binary_recall': 0.8459302, 'binary_specificity': 0.95904595, 'binary_f1_score': 0.5398887}
confusion matrix:
       0    1
0  10374  443
1     53  291
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 1
val acc:0.9696642160415649, best validation acc: 0.9706253409385681, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 12,now: 2024-05-29 02:35:28.059486,epoch time: 0:19:02.956056,used: 3:51:42.858095,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97063965, 'precision': 0.7783097, 'recall': 0.8741979, 'specificity': 0.8741979, 'f1': 0.81835735, 'auroc': 0.9649886, 'binary_precision': 0.5652404, 'binary_recall': 0.77033836, 'binary_specificity': 0.97805744, 'binary_f1_score': 0.6520415}
confusion matrix:
       0     1
0  36684   823
1    319  1070
---- Validation: 
scalar performance:
{'acc': 0.96437794, 'precision': 0.74532795, 'recall': 0.8472037, 'specificity': 0.8472037, 'f1': 0.7863469, 'auroc': 0.93189496, 'binary_precision': 0.50116825, 'binary_recall': 0.7210084, 'binary_specificity': 0.9733989, 'binary_f1_score': 0.5913164}
confusion matrix:
       0    1
0  15625  427
1    166  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546636, 'precision': 0.69104266, 'recall': 0.88795316, 'specificity': 0.88795316, 'f1': 0.75120497, 'auroc': 0.9569768, 'binary_precision': 0.38812155, 'binary_recall': 0.81686044, 'binary_specificity': 0.95904595, 'binary_f1_score': 0.52621716}
confusion matrix:
       0    1
0  10374  443
1     63  281
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 2
val acc:0.9643779397010803, best validation acc: 0.9706253409385681, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 13,now: 2024-05-29 02:54:28.909403,epoch time: 0:19:00.849917,used: 4:10:43.708012,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9723365, 'precision': 0.7888339, 'recall': 0.871958, 'specificity': 0.871958, 'f1': 0.8245575, 'auroc': 0.96550024, 'binary_precision': 0.5865119, 'binary_recall': 0.7638589, 'binary_specificity': 0.98005706, 'binary_f1_score': 0.6635397}
confusion matrix:
       0     1
0  36759   748
1    328  1061
---- Validation: 
scalar performance:
{'acc': 0.96810234, 'precision': 0.7648194, 'recall': 0.8531809, 'specificity': 0.8531809, 'f1': 0.8018974, 'auroc': 0.9544278, 'binary_precision': 0.539801, 'binary_recall': 0.7294118, 'binary_specificity': 0.97694993, 'binary_f1_score': 0.62044317}
confusion matrix:
       0    1
0  15682  370
1    161  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9520652, 'precision': 0.68290883, 'recall': 0.882391, 'specificity': 0.882391, 'f1': 0.74221253, 'auroc': 0.9529747, 'binary_precision': 0.37215528, 'binary_recall': 0.80813956, 'binary_specificity': 0.9566423, 'binary_f1_score': 0.5096242}
confusion matrix:
       0    1
0  10348  469
1     66  278
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 3
val acc:0.9681023359298706, best validation acc: 0.9706253409385681, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 14,now: 2024-05-29 03:13:07.084232,epoch time: 0:18:38.174829,used: 4:29:21.882841,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9741362, 'precision': 0.8027742, 'recall': 0.8590255, 'specificity': 0.8590255, 'f1': 0.8282441, 'auroc': 0.972175, 'binary_precision': 0.615431, 'binary_recall': 0.73506117, 'binary_specificity': 0.98298985, 'binary_f1_score': 0.6699475}
confusion matrix:
       0     1
0  36869   638
1    368  1021
---- Validation: 
scalar performance:
{'acc': 0.97014475, 'precision': 0.7767999, 'recall': 0.85343075, 'specificity': 0.85343075, 'f1': 0.80989915, 'auroc': 0.9595628, 'binary_precision': 0.56380206, 'binary_recall': 0.7277311, 'binary_specificity': 0.9791303, 'binary_f1_score': 0.6353631}
confusion matrix:
       0    1
0  15717  335
1    162  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96353376, 'precision': 0.71901405, 'recall': 0.8629768, 'specificity': 0.8629768, 'f1': 0.7709631, 'auroc': 0.957515, 'binary_precision': 0.44596913, 'binary_recall': 0.75581396, 'binary_specificity': 0.9701396, 'binary_f1_score': 0.5609493}
confusion matrix:
       0    1
0  10494  323
1     84  260
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 4
val acc:0.9701447486877441, best validation acc: 0.9706253409385681, corresponding to test acc:                         0.9622793793678284 / 0.9698951840400696
after epoch: 15,now: 2024-05-29 03:31:43.561406,epoch time: 0:18:36.477174,used: 4:47:58.360015,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97503597, 'precision': 0.80433285, 'recall': 0.8896498, 'specificity': 0.8896498, 'f1': 0.8411548, 'auroc': 0.97447234, 'binary_precision': 0.61624026, 'binary_recall': 0.7976962, 'binary_specificity': 0.98160344, 'binary_f1_score': 0.6953248}
confusion matrix:
       0     1
0  36817   690
1    281  1108
---- Validation: 
scalar performance:
{'acc': 0.97182673, 'precision': 0.7860562, 'recall': 0.86886823, 'specificity': 0.86886823, 'f1': 0.82161117, 'auroc': 0.96032405, 'binary_precision': 0.5811856, 'binary_recall': 0.7579832, 'binary_specificity': 0.9797533, 'binary_f1_score': 0.6579139}
confusion matrix:
       0    1
0  15727  325
1    144  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9594122, 'precision': 0.7063861, 'recall': 0.89040303, 'specificity': 0.89040303, 'f1': 0.766217, 'auroc': 0.9618072, 'binary_precision': 0.41877794, 'binary_recall': 0.81686044, 'binary_specificity': 0.9639456, 'binary_f1_score': 0.55369455}
confusion matrix:
       0    1
0  10427  390
1     63  281
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
better model found
persisted
after epoch: 16,now: 2024-05-29 03:50:24.812476,epoch time: 0:18:41.251070,used: 5:06:39.611085,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9707939, 'precision': 0.7783587, 'recall': 0.88849014, 'specificity': 0.88849014, 'f1': 0.82322073, 'auroc': 0.9765954, 'binary_precision': 0.5642458, 'binary_recall': 0.799856, 'binary_specificity': 0.9771243, 'binary_f1_score': 0.66170335}
confusion matrix:
       0     1
0  36649   858
1    278  1111
---- Validation: 
scalar performance:
{'acc': 0.96732146, 'precision': 0.7604522, 'recall': 0.86167693, 'specificity': 0.86167693, 'f1': 0.80178344, 'auroc': 0.96177256, 'binary_precision': 0.5303933, 'binary_recall': 0.7478992, 'binary_specificity': 0.97545475, 'binary_f1_score': 0.6206416}
confusion matrix:
       0    1
0  15658  394
1    150  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590539, 'precision': 0.69237196, 'recall': 0.80015326, 'specificity': 0.80015326, 'f1': 0.7328844, 'auroc': 0.95678836, 'binary_precision': 0.39670932, 'binary_recall': 0.63081396, 'binary_specificity': 0.9694925, 'binary_f1_score': 0.48709315}
confusion matrix:
       0    1
0  10487  330
1    127  217
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 1
val acc:0.9673214554786682, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 17,now: 2024-05-29 04:09:03.617387,epoch time: 0:18:38.804911,used: 5:25:18.415996,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9716423, 'precision': 0.7864695, 'recall': 0.84931165, 'specificity': 0.84931165, 'f1': 0.8144262, 'auroc': 0.9639253, 'binary_precision': 0.58347976, 'binary_recall': 0.71757925, 'binary_specificity': 0.98104405, 'binary_f1_score': 0.64361876}
confusion matrix:
       0    1
0  36797  711
1    392  996
---- Validation: 
scalar performance:
{'acc': 0.9670811, 'precision': 0.7592794, 'recall': 0.84375024, 'specificity': 0.84375024, 'f1': 0.79485404, 'auroc': 0.9412964, 'binary_precision': 0.5294118, 'binary_recall': 0.7109244, 'binary_specificity': 0.97657615, 'binary_f1_score': 0.6068867}
confusion matrix:
       0    1
0  15676  376
1    172  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9617418, 'precision': 0.7142422, 'recall': 0.88597584, 'specificity': 0.88597584, 'f1': 0.7723607, 'auroc': 0.9523672, 'binary_precision': 0.43485087, 'binary_recall': 0.8052326, 'binary_specificity': 0.96671903, 'binary_f1_score': 0.56472987}
confusion matrix:
       0    1
0  10457  360
1     67  277
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 2
val acc:0.9670811295509338, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 18,now: 2024-05-29 04:27:41.546302,epoch time: 0:18:37.928915,used: 5:43:56.344911,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9755759, 'precision': 0.808838, 'recall': 0.88473016, 'specificity': 0.88473016, 'f1': 0.8421707, 'auroc': 0.9681586, 'binary_precision': 0.62564397, 'binary_recall': 0.78689706, 'binary_specificity': 0.98256326, 'binary_f1_score': 0.69706637}
confusion matrix:
       0     1
0  36853   654
1    296  1093
---- Validation: 
scalar performance:
{'acc': 0.9697243, 'precision': 0.77382195, 'recall': 0.8613045, 'specificity': 0.8613045, 'f1': 0.8108064, 'auroc': 0.94092643, 'binary_precision': 0.5572327, 'binary_recall': 0.74453783, 'binary_specificity': 0.9780713, 'binary_f1_score': 0.6374101}
confusion matrix:
       0    1
0  15700  352
1    152  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95555955, 'precision': 0.6876943, 'recall': 0.84760475, 'specificity': 0.84760475, 'f1': 0.74036884, 'auroc': 0.93767345, 'binary_precision': 0.38414633, 'binary_recall': 0.73255813, 'binary_specificity': 0.9626514, 'binary_f1_score': 0.504}
confusion matrix:
       0    1
0  10413  404
1     92  252
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 3
val acc:0.9697242975234985, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 19,now: 2024-05-29 04:46:12.873137,epoch time: 0:18:31.326835,used: 6:02:27.671746,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9752931, 'precision': 0.8100195, 'recall': 0.8665582, 'specificity': 0.8665582, 'f1': 0.83566844, 'auroc': 0.97592586, 'binary_precision': 0.6293833, 'binary_recall': 0.74946004, 'binary_specificity': 0.9836564, 'binary_f1_score': 0.68419325}
confusion matrix:
       0     1
0  36894   613
1    348  1041
---- Validation: 
scalar performance:
{'acc': 0.97014475, 'precision': 0.77685237, 'recall': 0.85262156, 'specificity': 0.85262156, 'f1': 0.8096317, 'auroc': 0.9574226, 'binary_precision': 0.56396866, 'binary_recall': 0.72605044, 'binary_specificity': 0.9791926, 'binary_f1_score': 0.6348274}
confusion matrix:
       0    1
0  15718  334
1    163  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553803, 'precision': 0.695526, 'recall': 0.90521014, 'specificity': 0.90521014, 'f1': 0.7585709, 'auroc': 0.9550295, 'binary_precision': 0.39594594, 'binary_recall': 0.8517442, 'binary_specificity': 0.95867616, 'binary_f1_score': 0.5405904}
confusion matrix:
       0    1
0  10370  447
1     51  293
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 4
val acc:0.9701447486877441, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 20,now: 2024-05-29 05:04:46.946288,epoch time: 0:18:34.073151,used: 6:21:01.744897,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9728507, 'precision': 0.80364263, 'recall': 0.79943013, 'specificity': 0.79943013, 'f1': 0.8015201, 'auroc': 0.96499777, 'binary_precision': 0.6216216, 'binary_recall': 0.61267096, 'binary_specificity': 0.98618925, 'binary_f1_score': 0.6171139}
confusion matrix:
       0    1
0  36989  518
1    538  851
---- Validation: 
scalar performance:
{'acc': 0.96894336, 'precision': 0.77342916, 'recall': 0.78888196, 'specificity': 0.78888196, 'f1': 0.78091884, 'auroc': 0.9260626, 'binary_precision': 0.5619048, 'binary_recall': 0.594958, 'binary_specificity': 0.9828059, 'binary_f1_score': 0.57795924}
confusion matrix:
       0    1
0  15776  276
1    241  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96236897, 'precision': 0.7104126, 'recall': 0.83000875, 'specificity': 0.83000875, 'f1': 0.7553004, 'auroc': 0.95134926, 'binary_precision': 0.4309091, 'binary_recall': 0.68895346, 'binary_specificity': 0.9710641, 'binary_f1_score': 0.5302013}
confusion matrix:
       0    1
0  10504  313
1    107  237
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 5
val acc:0.9689433574676514, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 21,now: 2024-05-29 05:23:19.250400,epoch time: 0:18:32.304112,used: 6:39:34.049009,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9710253, 'precision': 0.77906847, 'recall': 0.89686394, 'specificity': 0.89686394, 'f1': 0.8264464, 'auroc': 0.97347176, 'binary_precision': 0.5650224, 'binary_recall': 0.8170029, 'binary_specificity': 0.976725, 'binary_f1_score': 0.6680413}
confusion matrix:
       0     1
0  36635   873
1    254  1134
---- Validation: 
scalar performance:
{'acc': 0.96587974, 'precision': 0.7531358, 'recall': 0.86497533, 'specificity': 0.86497533, 'f1': 0.797616, 'auroc': 0.9456563, 'binary_precision': 0.5154639, 'binary_recall': 0.75630254, 'binary_specificity': 0.97364813, 'binary_f1_score': 0.613079}
confusion matrix:
       0    1
0  15629  423
1    145  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9565451, 'precision': 0.70049345, 'recall': 0.9170692, 'specificity': 0.9170692, 'f1': 0.7654891, 'auroc': 0.955121, 'binary_precision': 0.4051144, 'binary_recall': 0.875, 'binary_specificity': 0.9591384, 'binary_f1_score': 0.55381787}
confusion matrix:
       0    1
0  10375  442
1     43  301
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 6
val acc:0.9658797383308411, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 22,now: 2024-05-29 05:41:58.907875,epoch time: 0:18:39.657475,used: 6:58:13.706484,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9747532, 'precision': 0.8054322, 'recall': 0.8693104, 'specificity': 0.8693104, 'f1': 0.8340125, 'auroc': 0.97780156, 'binary_precision': 0.61997634, 'binary_recall': 0.7557637, 'binary_specificity': 0.982857, 'binary_f1_score': 0.68116885}
confusion matrix:
       0     1
0  36865   643
1    339  1049
---- Validation: 
scalar performance:
{'acc': 0.96960413, 'precision': 0.774171, 'recall': 0.8418218, 'specificity': 0.8418218, 'f1': 0.8038373, 'auroc': 0.9631524, 'binary_precision': 0.55941254, 'binary_recall': 0.7042017, 'binary_specificity': 0.9794418, 'binary_f1_score': 0.6235119}
confusion matrix:
       0    1
0  15722  330
1    176  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961473, 'precision': 0.7103782, 'recall': 0.86050636, 'specificity': 0.86050636, 'f1': 0.76314783, 'auroc': 0.95690143, 'binary_precision': 0.42880794, 'binary_recall': 0.752907, 'binary_specificity': 0.96810573, 'binary_f1_score': 0.54641354}
confusion matrix:
       0    1
0  10472  345
1     85  259
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 7
val acc:0.9696041345596313, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 23,now: 2024-05-29 06:00:31.384903,epoch time: 0:18:32.477028,used: 7:16:46.183512,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97097385, 'precision': 0.78316045, 'recall': 0.8386673, 'specificity': 0.8386673, 'f1': 0.8081496, 'auroc': 0.9731128, 'binary_precision': 0.5776583, 'binary_recall': 0.6961843, 'binary_specificity': 0.9811502, 'binary_f1_score': 0.6314071}
confusion matrix:
       0    1
0  36800  707
1    422  967
---- Validation: 
scalar performance:
{'acc': 0.9661801, 'precision': 0.75424004, 'recall': 0.8125339, 'specificity': 0.8125339, 'f1': 0.78001463, 'auroc': 0.9509415, 'binary_precision': 0.52168024, 'binary_recall': 0.64705884, 'binary_specificity': 0.978009, 'binary_f1_score': 0.57764447}
confusion matrix:
       0    1
0  15699  353
1    210  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681393, 'precision': 0.6988174, 'recall': 0.8975061, 'specificity': 0.8975061, 'f1': 0.7604477, 'auroc': 0.95657647, 'binary_precision': 0.40308988, 'binary_recall': 0.8343023, 'binary_specificity': 0.96071, 'binary_f1_score': 0.5435606}
confusion matrix:
       0    1
0  10392  425
1     57  287
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 8
val acc:0.9661800861358643, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 24,now: 2024-05-29 06:19:11.011853,epoch time: 0:18:39.626950,used: 7:35:25.810462,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97274786, 'precision': 0.78975844, 'recall': 0.88881004, 'specificity': 0.88881004, 'f1': 0.8312033, 'auroc': 0.9757352, 'binary_precision': 0.5870831, 'binary_recall': 0.79841614, 'binary_specificity': 0.9792039, 'binary_f1_score': 0.6766321}
confusion matrix:
       0     1
0  36727   780
1    280  1109
---- Validation: 
scalar performance:
{'acc': 0.96840274, 'precision': 0.76625186, 'recall': 0.8630468, 'specificity': 0.8630468, 'f1': 0.8062768, 'auroc': 0.95903957, 'binary_precision': 0.5419198, 'binary_recall': 0.74957985, 'binary_specificity': 0.9765138, 'binary_f1_score': 0.6290551}
confusion matrix:
       0    1
0  15675  377
1    149  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590539, 'precision': 0.7048005, 'recall': 0.8874036, 'specificity': 0.8874036, 'f1': 0.76415265, 'auroc': 0.9566915, 'binary_precision': 0.41579732, 'binary_recall': 0.81104654, 'binary_specificity': 0.96376073, 'binary_f1_score': 0.5497537}
confusion matrix:
       0    1
0  10425  392
1     65  279
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 9
val acc:0.9684027433395386, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 25,now: 2024-05-29 06:37:27.204233,epoch time: 0:18:16.192380,used: 7:53:42.002842,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9751902, 'precision': 0.80628985, 'recall': 0.88229406, 'specificity': 0.88229406, 'f1': 0.83962965, 'auroc': 0.98181283, 'binary_precision': 0.62070936, 'binary_recall': 0.7822639, 'binary_specificity': 0.98232424, 'binary_f1_score': 0.69218504}
confusion matrix:
       0     1
0  36846   663
1    302  1085
---- Validation: 
scalar performance:
{'acc': 0.9690635, 'precision': 0.7708858, 'recall': 0.8407322, 'specificity': 0.8407322, 'f1': 0.8013392, 'auroc': 0.9598223, 'binary_precision': 0.55291003, 'binary_recall': 0.702521, 'binary_specificity': 0.9789434, 'binary_f1_score': 0.6188009}
confusion matrix:
       0    1
0  15714  338
1    177  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569035, 'precision': 0.69528663, 'recall': 0.86940706, 'specificity': 0.86940706, 'f1': 0.7517668, 'auroc': 0.9510269, 'binary_precision': 0.39791358, 'binary_recall': 0.7761628, 'binary_specificity': 0.9626514, 'binary_f1_score': 0.52610844}
confusion matrix:
       0    1
0  10413  404
1     77  267
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 10
val acc:0.9690635204315186, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 26,now: 2024-05-29 06:55:47.552888,epoch time: 0:18:20.348655,used: 8:12:02.351497,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97462463, 'precision': 0.80634165, 'recall': 0.8592788, 'specificity': 0.8592788, 'f1': 0.8304741, 'auroc': 0.9781046, 'binary_precision': 0.622561, 'binary_recall': 0.73506117, 'binary_specificity': 0.9834964, 'binary_f1_score': 0.6741499}
confusion matrix:
       0     1
0  36888   619
1    368  1021
---- Validation: 
scalar performance:
{'acc': 0.96894336, 'precision': 0.77008224, 'recall': 0.8422883, 'specificity': 0.8422883, 'f1': 0.8014122, 'auroc': 0.958472, 'binary_precision': 0.5511811, 'binary_recall': 0.7058824, 'binary_specificity': 0.97869426, 'binary_f1_score': 0.6190126}
confusion matrix:
       0    1
0  15710  342
1    175  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95484275, 'precision': 0.6927708, 'recall': 0.89648926, 'specificity': 0.89648926, 'f1': 0.7543716, 'auroc': 0.96129227, 'binary_precision': 0.39100817, 'binary_recall': 0.8343023, 'binary_specificity': 0.95867616, 'binary_f1_score': 0.53246754}
confusion matrix:
       0    1
0  10370  447
1     57  287
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 11
val acc:0.9689433574676514, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 27,now: 2024-05-29 07:14:22.410801,epoch time: 0:18:34.857913,used: 8:30:37.209410,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97395617, 'precision': 0.80307484, 'recall': 0.84922624, 'specificity': 0.84922624, 'f1': 0.8243383, 'auroc': 0.96330166, 'binary_precision': 0.6167702, 'binary_recall': 0.7149028, 'binary_specificity': 0.9835497, 'binary_f1_score': 0.6622208}
confusion matrix:
       0    1
0  36890  617
1    396  993
---- Validation: 
scalar performance:
{'acc': 0.9688833, 'precision': 0.7716628, 'recall': 0.8066529, 'specificity': 0.8066529, 'f1': 0.7879753, 'auroc': 0.9206956, 'binary_precision': 0.55703706, 'binary_recall': 0.6319328, 'binary_specificity': 0.981373, 'binary_f1_score': 0.592126}
confusion matrix:
       0    1
0  15753  299
1    219  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960129, 'precision': 0.7010331, 'recall': 0.82885313, 'specificity': 0.82885313, 'f1': 0.74749327, 'auroc': 0.9583616, 'binary_precision': 0.41217393, 'binary_recall': 0.68895346, 'binary_specificity': 0.96875286, 'binary_f1_score': 0.515778}
confusion matrix:
       0    1
0  10479  338
1    107  237
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 12
val acc:0.9688832759857178, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 28,now: 2024-05-29 07:33:01.254705,epoch time: 0:18:38.843904,used: 8:49:16.053314,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9747532, 'precision': 0.8052006, 'recall': 0.87147784, 'specificity': 0.87147784, 'f1': 0.83473265, 'auroc': 0.9802935, 'binary_precision': 0.61935484, 'binary_recall': 0.76025915, 'binary_specificity': 0.9826966, 'binary_f1_score': 0.6826115}
confusion matrix:
       0     1
0  36858   649
1    333  1056
---- Validation: 
scalar performance:
{'acc': 0.97062534, 'precision': 0.78199357, 'recall': 0.8277859, 'specificity': 0.8277859, 'f1': 0.80297196, 'auroc': 0.9531405, 'binary_precision': 0.5761494, 'binary_recall': 0.6739496, 'binary_specificity': 0.9816222, 'binary_f1_score': 0.62122387}
confusion matrix:
       0    1
0  15757  295
1    194  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618314, 'precision': 0.70826304, 'recall': 0.83113873, 'specificity': 0.83113873, 'f1': 0.7539141, 'auroc': 0.946627, 'binary_precision': 0.4265233, 'binary_recall': 0.69186044, 'binary_specificity': 0.97041696, 'binary_f1_score': 0.52771616}
confusion matrix:
       0    1
0  10497  320
1    106  238
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 13
val acc:0.9706253409385681, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 29,now: 2024-05-29 07:51:59.115796,epoch time: 0:18:57.861091,used: 9:08:13.914405,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9747532, 'precision': 0.8033614, 'recall': 0.88326365, 'specificity': 0.88326365, 'f1': 0.8381394, 'auroc': 0.9768084, 'binary_precision': 0.6147772, 'binary_recall': 0.7847372, 'binary_specificity': 0.98179007, 'binary_f1_score': 0.6894371}
confusion matrix:
       0     1
0  36824   683
1    299  1090
---- Validation: 
scalar performance:
{'acc': 0.96852285, 'precision': 0.7681165, 'recall': 0.82831407, 'specificity': 0.82831407, 'f1': 0.7948108, 'auroc': 0.9452572, 'binary_precision': 0.5482993, 'binary_recall': 0.67731094, 'binary_specificity': 0.97931725, 'binary_f1_score': 0.606015}
confusion matrix:
       0    1
0  15720  332
1    192  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607562, 'precision': 0.70842326, 'recall': 0.8671729, 'specificity': 0.8671729, 'f1': 0.7630372, 'auroc': 0.95544654, 'binary_precision': 0.42443728, 'binary_recall': 0.76744187, 'binary_specificity': 0.9669039, 'binary_f1_score': 0.54658383}
confusion matrix:
       0    1
0  10459  358
1     80  264
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897890.png
early stop counter: 14
val acc:0.968522846698761, best validation acc: 0.9718267321586609, corresponding to test acc:                         0.9594122171401978 / 0.9698951840400696
after epoch: 30,now: 2024-05-29 08:11:06.713838,epoch time: 0:19:07.598042,used: 9:27:21.512447,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_43_45_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:27:21.512447 at 2024-05-29 08:11:06.713838
persisted model performance metric: 

scalar performance:
{'acc': 0.9621898, 'precision': 0.71751857, 'recall': 0.9016868, 'specificity': 0.9016868, 'f1': 0.77868223, 'auroc': 0.95936656, 'binary_precision': 0.44036698, 'binary_recall': 0.8372093, 'binary_specificity': 0.96616435, 'binary_f1_score': 0.57715434}
confusion matrix:
       0    1
0  10451  366
1     56  288
oracle model performance metric: 

scalar performance:
{'acc': 0.9693576, 'precision': 0.7419274, 'recall': 0.673186, 'specificity': 0.673186, 'f1': 0.70131576, 'auroc': 0.93567246, 'binary_precision': 0.50409836, 'binary_recall': 0.35755813, 'binary_specificity': 0.9888139, 'binary_f1_score': 0.41836733}
confusion matrix:
       0    1
0  10696  121
1    221  123
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496817 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496817 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476803 KiB |  10962 MiB |   5898 TiB |   5898 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   5889 TiB |   5889 TiB |
|       from small pool |  88963 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11400 MiB |  11400 MiB |  39630 MiB |  28230 MiB |
|       from large pool |  11274 MiB |  11274 MiB |  39418 MiB |  28144 MiB |
|       from small pool |    126 MiB |    126 MiB |    212 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1346 MiB |   2595 MiB |   1922 TiB |   1922 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1911 TiB |   1911 TiB |
|       from small pool |      7 MiB |     35 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5565    |    7764    |  489624 K  |  489618 K  |
|       from large pool |      87    |     909    |  230494 K  |  230494 K  |
|       from small pool |    5478    |    7642    |  259129 K  |  259124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5565    |    7764    |  489624 K  |  489618 K  |
|       from large pool |      87    |     909    |  230494 K  |  230494 K  |
|       from small pool |    5478    |    7642    |  259129 K  |  259124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     239    |     239    |     696    |     457    |
|       from large pool |     176    |     176    |     590    |     414    |
|       from small pool |      63    |      63    |     106    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    2768    |  260335 K  |  260335 K  |
|       from large pool |      23    |      65    |  122467 K  |  122467 K  |
|       from small pool |      47    |    2747    |  137867 K  |  137867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5898 TiB |   5898 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5889 TiB |   5889 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11400 MiB |  39630 MiB |  37798 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     96 MiB |    126 MiB |    212 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1922 TiB |   1922 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1911 TiB |   1911 TiB |
|       from small pool |      0 KiB |     35 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  489624 K  |  489624 K  |
|       from large pool |       2    |     909    |  230494 K  |  230494 K  |
|       from small pool |       0    |    7642    |  259129 K  |  259129 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  489624 K  |  489624 K  |
|       from large pool |       2    |     909    |  230494 K  |  230494 K  |
|       from small pool |       0    |    7642    |  259129 K  |  259129 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     239    |     696    |     614    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      48    |      63    |     106    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  260337 K  |  260337 K  |
|       from large pool |       4    |      65    |  122467 K  |  122467 K  |
|       from small pool |       0    |    2747    |  137869 K  |  137869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5923 TiB |   5923 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5914 TiB |   5914 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5898 TiB |   5898 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5889 TiB |   5889 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11400 MiB |  39630 MiB |  37798 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     96 MiB |    126 MiB |    212 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1922 TiB |   1922 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1911 TiB |   1911 TiB |
|       from small pool |      0 KiB |     35 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  489624 K  |  489624 K  |
|       from large pool |       2    |     909    |  230494 K  |  230494 K  |
|       from small pool |       0    |    7642    |  259129 K  |  259129 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  489624 K  |  489624 K  |
|       from large pool |       2    |     909    |  230494 K  |  230494 K  |
|       from small pool |       0    |    7642    |  259129 K  |  259129 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     239    |     696    |     614    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      48    |      63    |     106    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  260337 K  |  260337 K  |
|       from large pool |       4    |      65    |  122467 K  |  122467 K  |
|       from small pool |       0    |    2747    |  137869 K  |  137869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890

 Experiment start at: 2024-05-29 08:21:19.460078
before training, model accuracy: 0.5330235362052917
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9802434, 'precision': 0.8186604, 'recall': 0.68812346, 'specificity': 0.68812346, 'f1': 0.7355961, 'auroc': 0.9369875, 'binary_precision': 0.6524064, 'binary_recall': 0.38125, 'binary_specificity': 0.9949969, 'binary_f1_score': 0.48126233}
confusion matrix:
       0    1
0  38781  195
1    594  366
---- Validation: 
scalar performance:
{'acc': 0.9785956, 'precision': 0.77658904, 'recall': 0.74464595, 'specificity': 0.74464595, 'f1': 0.759569, 'auroc': 0.9487382, 'binary_precision': 0.56557375, 'binary_recall': 0.49879518, 'binary_specificity': 0.9904967, 'binary_f1_score': 0.5300896}
confusion matrix:
       0    1
0  16572  159
1    208  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.653267, 'recall': 0.5313454, 'specificity': 0.5313454, 'f1': 0.53994554, 'auroc': 0.78579843, 'binary_precision': 0.3783784, 'binary_recall': 0.07253886, 'binary_specificity': 0.990152, 'binary_f1_score': 0.121739134}
confusion matrix:
      0   1
0  9250  92
1   716  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 08:41:16.801856,epoch time: 0:19:57.341778,used: 0:19:57.341778,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9809946, 'precision': 0.8125131, 'recall': 0.74008393, 'specificity': 0.74008393, 'f1': 0.7712518, 'auroc': 0.9467969, 'binary_precision': 0.63760215, 'binary_recall': 0.48699272, 'binary_specificity': 0.9931751, 'binary_f1_score': 0.55221236}
confusion matrix:
       0    1
0  38709  266
1    493  468
---- Validation: 
scalar performance:
{'acc': 0.98011196, 'precision': 0.8127899, 'recall': 0.70077544, 'specificity': 0.70077544, 'f1': 0.74382305, 'auroc': 0.94655883, 'binary_precision': 0.6401515, 'binary_recall': 0.40722892, 'binary_specificity': 0.99432194, 'binary_f1_score': 0.49779087}
confusion matrix:
       0    1
0  16636   95
1    246  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9162547, 'precision': 0.65127885, 'recall': 0.5595596, 'specificity': 0.5595596, 'f1': 0.578753, 'auroc': 0.7894763, 'binary_precision': 0.3702422, 'binary_recall': 0.13860103, 'binary_specificity': 0.9805181, 'binary_f1_score': 0.2016965}
confusion matrix:
      0    1
0  9160  182
1   665  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
better model found
persisted
after epoch: 2,now: 2024-05-29 08:59:50.427066,epoch time: 0:18:33.625210,used: 0:38:30.966988,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9810948, 'precision': 0.8362353, 'recall': 0.6944636, 'specificity': 0.6944636, 'f1': 0.745348, 'auroc': 0.9589232, 'binary_precision': 0.6872727, 'binary_recall': 0.39334026, 'binary_specificity': 0.99558693, 'binary_f1_score': 0.50033087}
confusion matrix:
       0    1
0  38803  172
1    583  378
---- Validation: 
scalar performance:
{'acc': 0.9812201, 'precision': 0.8212595, 'recall': 0.73306644, 'specificity': 0.73306644, 'f1': 0.76971495, 'auroc': 0.9517195, 'binary_precision': 0.6555184, 'binary_recall': 0.47228914, 'binary_specificity': 0.99384373, 'binary_f1_score': 0.5490196}
confusion matrix:
       0    1
0  16628  103
1    219  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92070395, 'precision': 0.5952503, 'recall': 0.50849485, 'specificity': 0.50849485, 'f1': 0.4996563, 'auroc': 0.8411412, 'binary_precision': 0.265625, 'binary_recall': 0.022020726, 'binary_specificity': 0.99496895, 'binary_f1_score': 0.04066986}
confusion matrix:
      0   1
0  9295  47
1   755  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 09:18:16.040490,epoch time: 0:18:25.613424,used: 0:56:56.580412,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98297274, 'precision': 0.8775117, 'recall': 0.7067939, 'specificity': 0.7067939, 'f1': 0.7659331, 'auroc': 0.96939003, 'binary_precision': 0.7692308, 'binary_recall': 0.41666666, 'binary_specificity': 0.9969212, 'binary_f1_score': 0.5405405}
confusion matrix:
       0    1
0  38856  120
1    560  400
---- Validation: 
scalar performance:
{'acc': 0.98232824, 'precision': 0.86556625, 'recall': 0.70308596, 'specificity': 0.70308596, 'f1': 0.7598833, 'auroc': 0.9686141, 'binary_precision': 0.74561405, 'binary_recall': 0.40963855, 'binary_specificity': 0.9965334, 'binary_f1_score': 0.5287714}
confusion matrix:
       0    1
0  16673   58
1    245  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.6193911, 'recall': 0.5058398, 'specificity': 0.5058398, 'f1': 0.49342063, 'auroc': 0.8243755, 'binary_precision': 0.31428573, 'binary_recall': 0.014248705, 'binary_specificity': 0.997431, 'binary_f1_score': 0.027261462}
confusion matrix:
      0   1
0  9318  24
1   761  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-29 09:37:01.347755,epoch time: 0:18:45.307265,used: 1:15:41.887677,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.817881, 'recall': 0.8433155, 'specificity': 0.8433155, 'f1': 0.8300758, 'auroc': 0.9697473, 'binary_precision': 0.64326924, 'binary_recall': 0.6961498, 'binary_specificity': 0.9904811, 'binary_f1_score': 0.66866565}
confusion matrix:
       0    1
0  38604  371
1    292  669
---- Validation: 
scalar performance:
{'acc': 0.98180336, 'precision': 0.7983572, 'recall': 0.8555585, 'specificity': 0.8555585, 'f1': 0.82427394, 'auroc': 0.96208423, 'binary_precision': 0.6036217, 'binary_recall': 0.72289157, 'binary_specificity': 0.98822546, 'binary_f1_score': 0.65789473}
confusion matrix:
       0    1
0  16534  197
1    115  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210006, 'precision': 0.6833267, 'recall': 0.55262226, 'specificity': 0.55262226, 'f1': 0.572006, 'auroc': 0.8317981, 'binary_precision': 0.43540668, 'binary_recall': 0.11787565, 'binary_specificity': 0.9873689, 'binary_f1_score': 0.18552499}
confusion matrix:
      0    1
0  9224  118
1   681   91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
early stop counter: 1
val acc:0.9818033576011658, best validation acc: 0.9823282361030579, corresponding to test acc:                         0.9223847985267639 / 0.9223847985267639
after epoch: 5,now: 2024-05-29 09:55:33.995008,epoch time: 0:18:32.647253,used: 1:34:14.534930,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.8205973, 'recall': 0.80137, 'specificity': 0.80137, 'f1': 0.81066704, 'auroc': 0.95632035, 'binary_precision': 0.650776, 'binary_recall': 0.6108221, 'binary_specificity': 0.9919179, 'binary_f1_score': 0.6301664}
confusion matrix:
       0    1
0  38660  315
1    374  587
---- Validation: 
scalar performance:
{'acc': 0.97987866, 'precision': 0.78314716, 'recall': 0.8169744, 'specificity': 0.8169744, 'f1': 0.7990368, 'auroc': 0.95162976, 'binary_precision': 0.5751073, 'binary_recall': 0.6457831, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.6083995}
confusion matrix:
       0    1
0  16533  198
1    147  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92050624, 'precision': 0.71218884, 'recall': 0.6747489, 'specificity': 0.6747489, 'f1': 0.6910975, 'auroc': 0.8741125, 'binary_precision': 0.4744409, 'binary_recall': 0.38471502, 'binary_specificity': 0.9647827, 'binary_f1_score': 0.42489272}
confusion matrix:
      0    1
0  9013  329
1   475  297
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
early stop counter: 2
val acc:0.9798786640167236, best validation acc: 0.9823282361030579, corresponding to test acc:                         0.9223847985267639 / 0.9223847985267639
after epoch: 6,now: 2024-05-29 10:14:13.857806,epoch time: 0:18:39.862798,used: 1:52:54.397728,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9811699, 'precision': 0.79529524, 'recall': 0.8233976, 'specificity': 0.8233976, 'f1': 0.80866265, 'auroc': 0.9690803, 'binary_precision': 0.59905213, 'binary_recall': 0.65764827, 'binary_specificity': 0.9891469, 'binary_f1_score': 0.6269841}
confusion matrix:
       0    1
0  38552  423
1    329  632
---- Validation: 
scalar performance:
{'acc': 0.98186165, 'precision': 0.80869424, 'recall': 0.8050662, 'specificity': 0.8050662, 'f1': 0.8068688, 'auroc': 0.96455514, 'binary_precision': 0.62682927, 'binary_recall': 0.6192771, 'binary_specificity': 0.9908553, 'binary_f1_score': 0.6230303}
confusion matrix:
       0    1
0  16578  153
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8888669, 'precision': 0.6526728, 'recall': 0.7182249, 'specificity': 0.7182249, 'f1': 0.6768959, 'auroc': 0.85273075, 'binary_precision': 0.34695652, 'binary_recall': 0.5168394, 'binary_specificity': 0.9196104, 'binary_f1_score': 0.4151925}
confusion matrix:
      0    1
0  8591  751
1   373  399
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897890.png
early stop counter: 3
val acc:0.9818616509437561, best validation acc: 0.9823282361030579, corresponding to test acc:                         0.9223847985267639 / 0.9223847985267639
after epoch: 7,now: 2024-05-29 10:32:44.980808,epoch time: 0:18:31.123002,used: 2:11:25.520730,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_08_21_19_seed_0_20897890
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 20897890 ON gpusrv27 CANCELLED AT 2024-05-29T10:35:40 ***
