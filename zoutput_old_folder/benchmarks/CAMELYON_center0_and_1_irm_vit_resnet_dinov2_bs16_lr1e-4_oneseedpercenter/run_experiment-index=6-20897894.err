Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894

 Experiment start at: 2024-05-27 19:33:02.893945
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96714014, 'precision': 0.82686985, 'recall': 0.5197354, 'specificity': 0.5197354, 'f1': 0.5295297, 'auroc': 0.9311292, 'binary_precision': 0.68604654, 'binary_recall': 0.04010877, 'binary_specificity': 0.999362, 'binary_f1_score': 0.07578677}
confusion matrix:
       0   1
0  42294  27
1   1412  59
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.92671573, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.90033686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 20:12:05.118447,epoch time: 0:39:02.224502,used: 0:39:02.224502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.93765426, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9456691, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9122336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 20:49:33.035305,epoch time: 0:37:27.916858,used: 1:16:30.141360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.77962816, 'recall': 0.6334978, 'specificity': 0.6334978, 'f1': 0.6784644, 'auroc': 0.9466393, 'binary_precision': 0.584058, 'binary_recall': 0.2737772, 'binary_specificity': 0.99321836, 'binary_f1_score': 0.37280297}
confusion matrix:
       0    1
0  42033  287
1   1069  403
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.8062495, 'recall': 0.5724123, 'specificity': 0.5724123, 'f1': 0.6119338, 'auroc': 0.94851387, 'binary_precision': 0.6418919, 'binary_recall': 0.14774494, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.24020226}
confusion matrix:
       0   1
0  18096  53
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.956761, 'recall': 0.6566712, 'specificity': 0.6566712, 'f1': 0.7280714, 'auroc': 0.9444349, 'binary_precision': 0.9425287, 'binary_recall': 0.31417623, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.4712644}
confusion matrix:
      0   1
0  5992   5
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-27 21:27:01.333599,epoch time: 0:37:28.298294,used: 1:53:58.439654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.7957473, 'recall': 0.5016629, 'specificity': 0.5016629, 'f1': 0.4948422, 'auroc': 0.9509111, 'binary_precision': 0.625, 'binary_recall': 0.003396739, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.0067567565}
confusion matrix:
       0  1
0  42317  3
1   1467  5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.95449734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93710804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9705976247787476
after epoch: 4,now: 2024-05-27 22:04:48.328809,epoch time: 0:37:46.995210,used: 2:31:45.434864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.74291086, 'recall': 0.6411803, 'specificity': 0.6411803, 'f1': 0.6772133, 'auroc': 0.93198633, 'binary_precision': 0.510083, 'binary_recall': 0.29211956, 'binary_specificity': 0.990241, 'binary_f1_score': 0.3714903}
confusion matrix:
       0    1
0  41907  413
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7410142, 'recall': 0.6763732, 'specificity': 0.6763732, 'f1': 0.70314324, 'auroc': 0.9483572, 'binary_precision': 0.50429183, 'binary_recall': 0.36547434, 'binary_specificity': 0.987272, 'binary_f1_score': 0.42380524}
confusion matrix:
       0    1
0  17918  231
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74493575, 'recall': 0.5533878, 'specificity': 0.5533878, 'f1': 0.5811984, 'auroc': 0.90368956, 'binary_precision': 0.5272727, 'binary_recall': 0.11111111, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.18354431}
confusion matrix:
      0   1
0  5971  26
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 2
val acc:0.9659961462020874, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9705976247787476
after epoch: 5,now: 2024-05-27 22:42:21.581240,epoch time: 0:37:33.252431,used: 3:09:18.687295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9684189, 'precision': 0.76441693, 'recall': 0.6536017, 'specificity': 0.6536017, 'f1': 0.6929282, 'auroc': 0.9513421, 'binary_precision': 0.5522565, 'binary_recall': 0.31611148, 'binary_specificity': 0.9910919, 'binary_f1_score': 0.4020752}
confusion matrix:
       0    1
0  41944  377
1   1006  465
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7793077, 'recall': 0.5788598, 'specificity': 0.5788598, 'f1': 0.6185059, 'auroc': 0.95232326, 'binary_precision': 0.5875706, 'binary_recall': 0.16174184, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.25365853}
confusion matrix:
       0    1
0  18076   73
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9226193, 'recall': 0.5571378, 'specificity': 0.5571378, 'f1': 0.59208035, 'auroc': 0.93970424, 'binary_precision': 0.88235295, 'binary_recall': 0.11494253, 'binary_specificity': 0.999333, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5993   4
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 3
val acc:0.967432975769043, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9705976247787476
after epoch: 6,now: 2024-05-27 23:20:15.712598,epoch time: 0:37:54.131358,used: 3:47:12.818653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9685102, 'precision': 0.78198266, 'recall': 0.60011226, 'specificity': 0.60011226, 'f1': 0.64423966, 'auroc': 0.9608238, 'binary_precision': 0.59099805, 'binary_recall': 0.20516305, 'binary_specificity': 0.99506146, 'binary_f1_score': 0.304589}
confusion matrix:
       0    1
0  42111  209
1   1170  302
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.79008615, 'recall': 0.5395263, 'specificity': 0.5395263, 'f1': 0.56296325, 'auroc': 0.9616623, 'binary_precision': 0.6117647, 'binary_recall': 0.08087092, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.14285713}
confusion matrix:
       0   1
0  18116  33
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9590949, 'recall': 0.5420622, 'specificity': 0.5420622, 'f1': 0.56765443, 'auroc': 0.94661474, 'binary_precision': 0.95652175, 'binary_recall': 0.08429119, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5996   1
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9705976247787476
after epoch: 7,now: 2024-05-27 23:58:07.956153,epoch time: 0:37:52.243555,used: 4:25:05.062208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96798503, 'precision': 0.75345016, 'recall': 0.7424483, 'specificity': 0.7424483, 'f1': 0.74781376, 'auroc': 0.95122784, 'binary_precision': 0.52421653, 'binary_recall': 0.50068027, 'binary_specificity': 0.9842163, 'binary_f1_score': 0.5121781}
confusion matrix:
       0    1
0  41654  668
1    734  736
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.75341594, 'recall': 0.7047864, 'specificity': 0.7047864, 'f1': 0.7262431, 'auroc': 0.9507513, 'binary_precision': 0.5271318, 'binary_recall': 0.4230171, 'binary_specificity': 0.98655576, 'binary_f1_score': 0.46937016}
confusion matrix:
       0    1
0  17905  244
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.9103788, 'recall': 0.72613513, 'specificity': 0.72613513, 'f1': 0.78925085, 'auroc': 0.9412997, 'binary_precision': 0.8439716, 'binary_recall': 0.4559387, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.59203976}
confusion matrix:
      0    1
0  5975   22
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
early stop counter: 5
val acc:0.9672732949256897, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9737935662269592
after epoch: 8,now: 2024-05-28 00:36:00.554720,epoch time: 0:37:52.598567,used: 5:02:57.660775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96892124, 'precision': 0.7718828, 'recall': 0.6550774, 'specificity': 0.6550774, 'f1': 0.69602257, 'auroc': 0.9536898, 'binary_precision': 0.56711006, 'binary_recall': 0.31861413, 'binary_specificity': 0.9915407, 'binary_f1_score': 0.40800348}
confusion matrix:
       0    1
0  41962  358
1   1003  469
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.77829015, 'recall': 0.6114152, 'specificity': 0.6114152, 'f1': 0.65605533, 'auroc': 0.9548236, 'binary_precision': 0.5833333, 'binary_recall': 0.22861587, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.32849163}
confusion matrix:
       0    1
0  18044  105
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.93772924, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 6
val acc:0.9680182933807373, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9737935662269592
after epoch: 9,now: 2024-05-28 01:13:31.073968,epoch time: 0:37:30.519248,used: 5:40:28.180023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.790326, 'recall': 0.50898284, 'specificity': 0.50898284, 'f1': 0.509352, 'auroc': 0.9563357, 'binary_precision': 0.6136364, 'binary_recall': 0.018367346, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.035667103}
confusion matrix:
       0   1
0  42305  17
1   1443  27
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.961149, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9458987, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9737935662269592
after epoch: 10,now: 2024-05-28 01:50:55.726430,epoch time: 0:37:24.652462,used: 6:17:52.832485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9681449, 'precision': 0.93260515, 'recall': 0.5294335, 'specificity': 0.5294335, 'f1': 0.54734033, 'auroc': 0.9575141, 'binary_precision': 0.8969072, 'binary_recall': 0.05910326, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.110898666}
confusion matrix:
       0   1
0  42310  10
1   1385  87
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.98291737, 'recall': 0.5007776, 'specificity': 0.5007776, 'f1': 0.49286303, 'auroc': 0.95957553, 'binary_precision': 1.0, 'binary_recall': 0.00155521, 'binary_specificity': 1.0, 'binary_f1_score': 0.0031055901}
confusion matrix:
       0  1
0  18149  0
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9519932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 8
val acc:0.9658365249633789, best validation acc: 0.9680182933807373, corresponding to test acc:                         0.9705976247787476 / 0.9737935662269592
after epoch: 11,now: 2024-05-28 02:28:24.837659,epoch time: 0:37:29.111229,used: 6:55:21.943714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.969926, 'precision': 0.7698953, 'recall': 0.7501838, 'specificity': 0.7501838, 'f1': 0.759627, 'auroc': 0.953478, 'binary_precision': 0.5566176, 'binary_recall': 0.5146159, 'binary_specificity': 0.98575175, 'binary_f1_score': 0.5347933}
confusion matrix:
       0    1
0  41718  603
1    714  757
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.76391363, 'recall': 0.70683753, 'specificity': 0.70683753, 'f1': 0.73155606, 'auroc': 0.95374507, 'binary_precision': 0.548, 'binary_recall': 0.42612752, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.47944003}
confusion matrix:
       0    1
0  17923  226
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.9571663, 'recall': 0.658587, 'specificity': 0.658587, 'f1': 0.73030204, 'auroc': 0.92511106, 'binary_precision': 0.9431818, 'binary_recall': 0.31800765, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.47564468}
confusion matrix:
      0   1
0  5992   5
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
better model found
persisted
after epoch: 12,now: 2024-05-28 03:06:04.032164,epoch time: 0:37:39.194505,used: 7:33:01.138219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9694693, 'precision': 0.7775307, 'recall': 0.6649721, 'specificity': 0.6649721, 'f1': 0.70561755, 'auroc': 0.9565204, 'binary_precision': 0.57772624, 'binary_recall': 0.3385452, 'binary_specificity': 0.99139905, 'binary_f1_score': 0.42691812}
confusion matrix:
       0    1
0  41957  364
1    973  498
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.79587543, 'recall': 0.59660697, 'specificity': 0.59660697, 'f1': 0.64167947, 'auroc': 0.9578439, 'binary_precision': 0.6195122, 'binary_recall': 0.19751166, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.2995283}
confusion matrix:
       0    1
0  18071   78
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.970031, 'recall': 0.57654494, 'specificity': 0.57654494, 'f1': 0.62336236, 'auroc': 0.95017374, 'binary_precision': 0.9756098, 'binary_recall': 0.1532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.26490065}
confusion matrix:
      0   1
0  5996   1
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
better model found
persisted
after epoch: 13,now: 2024-05-28 03:43:54.282903,epoch time: 0:37:50.250739,used: 8:10:51.388958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97047406, 'precision': 0.7830492, 'recall': 0.7014532, 'specificity': 0.7014532, 'f1': 0.73472846, 'auroc': 0.9604937, 'binary_precision': 0.58630663, 'binary_recall': 0.41304347, 'binary_specificity': 0.989863, 'binary_f1_score': 0.48465523}
confusion matrix:
       0    1
0  41891  429
1    864  608
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.80463994, 'recall': 0.6066607, 'specificity': 0.6066607, 'f1': 0.6542866, 'auroc': 0.9592891, 'binary_precision': 0.6363636, 'binary_recall': 0.21772939, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.3244496}
confusion matrix:
       0    1
0  18069   80
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.9589566, 'recall': 0.6929863, 'specificity': 0.6929863, 'f1': 0.76762414, 'auroc': 0.9534801, 'binary_precision': 0.94392526, 'binary_recall': 0.38697317, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.54891306}
confusion matrix:
      0    1
0  5991    6
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
better model found
persisted
after epoch: 14,now: 2024-05-28 04:21:41.906307,epoch time: 0:37:47.623404,used: 8:48:39.012362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9689898, 'precision': 0.8357226, 'recall': 0.56659085, 'specificity': 0.56659085, 'f1': 0.60541457, 'auroc': 0.95935845, 'binary_precision': 0.7007042, 'binary_recall': 0.13519022, 'binary_specificity': 0.9979915, 'binary_f1_score': 0.22665147}
confusion matrix:
       0    1
0  42235   85
1   1273  199
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.8479538, 'recall': 0.5429673, 'specificity': 0.5429673, 'f1': 0.56953126, 'auroc': 0.9617656, 'binary_precision': 0.72727275, 'binary_recall': 0.08709176, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.15555556}
confusion matrix:
       0   1
0  18128  21
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.94217956, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9689761400222778, corresponding to test acc:                         0.9734739661216736 / 0.9737935662269592
after epoch: 15,now: 2024-05-28 04:59:11.063293,epoch time: 0:37:29.156986,used: 9:26:08.169348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96839607, 'precision': 0.90106887, 'recall': 0.5371042, 'specificity': 0.5371042, 'f1': 0.5605301, 'auroc': 0.9624475, 'binary_precision': 0.8333333, 'binary_recall': 0.07472826, 'binary_specificity': 0.9994801, 'binary_f1_score': 0.1371571}
confusion matrix:
       0    1
0  42298   22
1   1362  110
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.93769336, 'recall': 0.5077485, 'specificity': 0.5077485, 'f1': 0.5067067, 'auroc': 0.96443665, 'binary_precision': 0.90909094, 'binary_recall': 0.0155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.03058104}
confusion matrix:
       0   1
0  18148   1
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94636714, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 2
val acc:0.9662622213363647, best validation acc: 0.9689761400222778, corresponding to test acc:                         0.9734739661216736 / 0.9737935662269592
after epoch: 16,now: 2024-05-28 05:37:06.980491,epoch time: 0:37:55.917198,used: 10:04:04.086546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97157013, 'precision': 0.7923293, 'recall': 0.7193968, 'specificity': 0.7193968, 'f1': 0.75017697, 'auroc': 0.964128, 'binary_precision': 0.60365295, 'binary_recall': 0.4490489, 'binary_specificity': 0.9897448, 'binary_f1_score': 0.5149981}
confusion matrix:
       0    1
0  41886  434
1    811  661
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.8308673, 'recall': 0.6262386, 'specificity': 0.6262386, 'f1': 0.67932916, 'auroc': 0.96406794, 'binary_precision': 0.6875, 'binary_recall': 0.25660965, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.37372595}
confusion matrix:
       0    1
0  18074   75
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.95754075, 'recall': 0.75212324, 'specificity': 0.75212324, 'f1': 0.8226623, 'auroc': 0.9549954, 'binary_precision': 0.9361702, 'binary_recall': 0.50574714, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.6567164}
confusion matrix:
      0    1
0  5988    9
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-05-28 06:14:49.417198,epoch time: 0:37:42.436707,used: 10:41:46.523253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96997166, 'precision': 0.7997147, 'recall': 0.6310314, 'specificity': 0.6310314, 'f1': 0.6796596, 'auroc': 0.9613857, 'binary_precision': 0.6244057, 'binary_recall': 0.26766303, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.37470278}
confusion matrix:
       0    1
0  42083  237
1   1078  394
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7927746, 'recall': 0.5319431, 'specificity': 0.5319431, 'f1': 0.5505696, 'auroc': 0.96220523, 'binary_precision': 0.61764705, 'binary_recall': 0.065318815, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.118143454}
confusion matrix:
       0   1
0  18123  26
1    601  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.93409777, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9705725908279419, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 18,now: 2024-05-28 06:52:36.245711,epoch time: 0:37:46.828513,used: 11:19:33.351766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9680307, 'precision': 0.7538606, 'recall': 0.84903705, 'specificity': 0.84903705, 'f1': 0.7930347, 'auroc': 0.96245944, 'binary_precision': 0.51754385, 'binary_recall': 0.7214674, 'binary_specificity': 0.9766068, 'binary_f1_score': 0.60272413}
confusion matrix:
       0     1
0  41330   990
1    410  1062
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.7880343, 'recall': 0.7231059, 'specificity': 0.7231059, 'f1': 0.7510437, 'auroc': 0.9629482, 'binary_precision': 0.5951417, 'binary_recall': 0.45723173, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.5171504}
confusion matrix:
       0    1
0  17949  200
1    349  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98178333, 'precision': 0.9158355, 'recall': 0.8420762, 'specificity': 0.8420762, 'f1': 0.8750134, 'auroc': 0.9525241, 'binary_precision': 0.8450704, 'binary_recall': 0.6896552, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.75949365}
confusion matrix:
      0    1
0  5964   33
1    81  180
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-05-28 07:30:21.633259,epoch time: 0:37:45.387548,used: 11:57:18.739314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96867007, 'precision': 0.7572395, 'recall': 0.8360461, 'specificity': 0.8360461, 'f1': 0.79079497, 'auroc': 0.957932, 'binary_precision': 0.5252317, 'binary_recall': 0.6938776, 'binary_specificity': 0.9782146, 'binary_f1_score': 0.59788984}
confusion matrix:
       0     1
0  41400   922
1    450  1020
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.7565566, 'recall': 0.78987324, 'specificity': 0.78987324, 'f1': 0.77208173, 'auroc': 0.96338487, 'binary_precision': 0.5273973, 'binary_recall': 0.59875584, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.56081575}
confusion matrix:
       0    1
0  17804  345
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.9251508, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9679118990898132, best validation acc: 0.9707854390144348, corresponding to test acc:                         0.9817833304405212 / 0.9817833304405212
after epoch: 20,now: 2024-05-28 08:08:02.015201,epoch time: 0:37:40.381942,used: 12:34:59.121256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97026855, 'precision': 0.806075, 'recall': 0.6315129, 'specificity': 0.6315129, 'f1': 0.6811998, 'auroc': 0.9600055, 'binary_precision': 0.63709676, 'binary_recall': 0.2683424, 'binary_specificity': 0.9946834, 'binary_f1_score': 0.3776291}
confusion matrix:
       0    1
0  42095  225
1   1077  395
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.8178425, 'recall': 0.5801884, 'specificity': 0.5801884, 'f1': 0.62305254, 'auroc': 0.9637434, 'binary_precision': 0.664557, 'binary_recall': 0.16329704, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.26217228}
confusion matrix:
       0    1
0  18096   53
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.9438547, 'recall': 0.62976795, 'specificity': 0.62976795, 'f1': 0.6948166, 'auroc': 0.9490564, 'binary_precision': 0.9189189, 'binary_recall': 0.2605364, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.40597016}
confusion matrix:
      0   1
0  5991   6
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 2
val acc:0.968550443649292, best validation acc: 0.9707854390144348, corresponding to test acc:                         0.9817833304405212 / 0.9817833304405212
after epoch: 21,now: 2024-05-28 08:45:51.813462,epoch time: 0:37:49.798261,used: 13:12:48.919517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97207254, 'precision': 0.7800542, 'recall': 0.8294896, 'specificity': 0.8294896, 'f1': 0.8025499, 'auroc': 0.964358, 'binary_precision': 0.5714286, 'binary_recall': 0.67663044, 'binary_specificity': 0.9823488, 'binary_f1_score': 0.61959565}
confusion matrix:
       0    1
0  41573  747
1    476  996
---- Validation: 
scalar performance:
{'acc': 0.97318006, 'precision': 0.8055135, 'recall': 0.7603483, 'specificity': 0.7603483, 'f1': 0.78095496, 'auroc': 0.9673847, 'binary_precision': 0.62752295, 'binary_recall': 0.5318818, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.57575756}
confusion matrix:
       0    1
0  17946  203
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.81894946, 'recall': 0.614357, 'specificity': 0.614357, 'f1': 0.6638413, 'auroc': 0.9475239, 'binary_precision': 0.6703297, 'binary_recall': 0.23371647, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34659088}
confusion matrix:
      0   1
0  5967  30
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
better model found
persisted
after epoch: 22,now: 2024-05-28 09:23:33.929677,epoch time: 0:37:42.116215,used: 13:50:31.035732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97262055, 'precision': 0.81435156, 'recall': 0.6979738, 'specificity': 0.6979738, 'f1': 0.7418113, 'auroc': 0.96395266, 'binary_precision': 0.64918035, 'binary_recall': 0.4035326, 'binary_specificity': 0.99241495, 'binary_f1_score': 0.49769583}
confusion matrix:
       0    1
0  41999  321
1    878  594
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.84373397, 'recall': 0.62034833, 'specificity': 0.62034833, 'f1': 0.67444825, 'auroc': 0.9691716, 'binary_precision': 0.71363634, 'binary_recall': 0.24416797, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.36384705}
confusion matrix:
       0    1
0  18086   63
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.949285, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9707854390144348, best validation acc: 0.9731800556182861, corresponding to test acc:                         0.9632470607757568 / 0.9817833304405212
after epoch: 23,now: 2024-05-28 10:01:11.579031,epoch time: 0:37:37.649354,used: 14:28:08.685086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97072524, 'precision': 0.79164696, 'recall': 0.6810422, 'specificity': 0.6810422, 'f1': 0.7222415, 'auroc': 0.9646494, 'binary_precision': 0.6048835, 'binary_recall': 0.37049627, 'binary_specificity': 0.9915881, 'binary_f1_score': 0.45952785}
confusion matrix:
       0    1
0  41965  356
1    926  545
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8051822, 'recall': 0.6226598, 'specificity': 0.6226598, 'f1': 0.67186475, 'auroc': 0.96654713, 'binary_precision': 0.6363636, 'binary_recall': 0.2503888, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.359375}
confusion matrix:
       0    1
0  18057   92
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8323385, 'recall': 0.5958669, 'specificity': 0.5958669, 'f1': 0.6431724, 'auroc': 0.95054984, 'binary_precision': 0.69863015, 'binary_recall': 0.1954023, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3053892}
confusion matrix:
      0   1
0  5975  22
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 2
val acc:0.9694550633430481, best validation acc: 0.9731800556182861, corresponding to test acc:                         0.9632470607757568 / 0.9817833304405212
after epoch: 24,now: 2024-05-28 10:39:46.596795,epoch time: 0:38:35.017764,used: 15:06:43.702850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97396785, 'precision': 0.79561424, 'recall': 0.82227373, 'specificity': 0.82227373, 'f1': 0.8083098, 'auroc': 0.9659176, 'binary_precision': 0.6031056, 'binary_recall': 0.65964675, 'binary_specificity': 0.9849008, 'binary_f1_score': 0.6301104}
confusion matrix:
       0    1
0  41681  639
1    501  971
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.8055928, 'recall': 0.7770699, 'specificity': 0.7770699, 'f1': 0.79056495, 'auroc': 0.9704916, 'binary_precision': 0.62650603, 'binary_recall': 0.5660964, 'binary_specificity': 0.9880434, 'binary_f1_score': 0.59477127}
confusion matrix:
       0    1
0  17932  217
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8282572, 'recall': 0.5469756, 'specificity': 0.5469756, 'f1': 0.57406783, 'auroc': 0.9485819, 'binary_precision': 0.6944444, 'binary_recall': 0.09578544, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5986  11
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
better model found
persisted
after epoch: 25,now: 2024-05-28 11:17:13.619651,epoch time: 0:37:27.022856,used: 15:44:10.725706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9718213, 'precision': 0.8631669, 'recall': 0.6192019, 'specificity': 0.6192019, 'f1': 0.6754086, 'auroc': 0.9684596, 'binary_precision': 0.75211865, 'binary_recall': 0.24116848, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.36522636}
confusion matrix:
       0    1
0  42203  117
1   1117  355
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.91084236, 'recall': 0.5664608, 'specificity': 0.5664608, 'f1': 0.6078281, 'auroc': 0.9686928, 'binary_precision': 0.85148513, 'binary_recall': 0.13374805, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.23118278}
confusion matrix:
       0   1
0  18134  15
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.95147765, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 1
val acc:0.9695615172386169, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9605305194854736 / 0.9817833304405212
after epoch: 26,now: 2024-05-28 11:54:45.785104,epoch time: 0:37:32.165453,used: 16:21:42.891159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97035986, 'precision': 0.7675224, 'recall': 0.84696364, 'specificity': 0.84696364, 'f1': 0.80152035, 'auroc': 0.9630502, 'binary_precision': 0.54507774, 'binary_recall': 0.71467394, 'binary_specificity': 0.9792533, 'binary_f1_score': 0.61845976}
confusion matrix:
       0     1
0  41442   878
1    420  1052
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.76285076, 'recall': 0.81139827, 'specificity': 0.81139827, 'f1': 0.7848357, 'auroc': 0.96520454, 'binary_precision': 0.53846157, 'binary_recall': 0.64230174, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.58581567}
confusion matrix:
       0    1
0  17795  354
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8245988, 'recall': 0.68382084, 'specificity': 0.68382084, 'f1': 0.7327088, 'auroc': 0.9428522, 'binary_precision': 0.6758621, 'binary_recall': 0.37547892, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.48275858}
confusion matrix:
      0   1
0  5950  47
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 2
val acc:0.9689229726791382, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9605305194854736 / 0.9817833304405212
after epoch: 27,now: 2024-05-28 12:32:10.436367,epoch time: 0:37:24.651263,used: 16:59:07.542422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9743104, 'precision': 0.8434628, 'recall': 0.69766116, 'specificity': 0.69766116, 'f1': 0.7493693, 'auroc': 0.96780396, 'binary_precision': 0.70743406, 'binary_recall': 0.4010877, 'binary_specificity': 0.99423456, 'binary_f1_score': 0.51193064}
confusion matrix:
       0    1
0  42077  244
1    881  590
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.9054117, 'recall': 0.62278515, 'specificity': 0.62278515, 'f1': 0.6838698, 'auroc': 0.97006106, 'binary_precision': 0.8368421, 'binary_recall': 0.24727838, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.3817527}
confusion matrix:
       0    1
0  18118   31
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.95079136, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 3
val acc:0.9725947380065918, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9605305194854736 / 0.9817833304405212
after epoch: 28,now: 2024-05-28 13:10:19.105553,epoch time: 0:38:08.669186,used: 17:37:16.211608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9726891, 'precision': 0.89809334, 'recall': 0.6184087, 'specificity': 0.6184087, 'f1': 0.6779525, 'auroc': 0.9694955, 'binary_precision': 0.82201403, 'binary_recall': 0.23861319, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.369863}
confusion matrix:
       0    1
0  42245   76
1   1120  351
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.95844454, 'recall': 0.5426856, 'specificity': 0.5426856, 'f1': 0.5704475, 'auroc': 0.96887517, 'binary_precision': 0.94827586, 'binary_recall': 0.08553655, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.15691869}
confusion matrix:
       0   1
0  18146   3
1    588  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.94973123, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 4
val acc:0.968550443649292, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9605305194854736 / 0.9817833304405212
after epoch: 29,now: 2024-05-28 13:47:50.136002,epoch time: 0:37:31.030449,used: 18:14:47.242057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97417337, 'precision': 0.8140253, 'recall': 0.7523813, 'specificity': 0.7523813, 'f1': 0.7795427, 'auroc': 0.9655777, 'binary_precision': 0.64480406, 'binary_recall': 0.5146159, 'binary_specificity': 0.99014676, 'binary_f1_score': 0.5724007}
confusion matrix:
       0    1
0  41904  417
1    714  757
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.8508817, 'recall': 0.66953653, 'specificity': 0.66953653, 'f1': 0.7262166, 'auroc': 0.96942985, 'binary_precision': 0.7245902, 'binary_recall': 0.3437014, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.46624476}
confusion matrix:
       0    1
0  18065   84
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9385972, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897894.png
early stop counter: 5
val acc:0.9730736613273621, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9605305194854736 / 0.9817833304405212
after epoch: 30,now: 2024-05-28 14:28:12.733236,epoch time: 0:40:22.597234,used: 18:55:09.839291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:55:09.839291 at 2024-05-28 14:28:12.733236
persisted model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7807167, 'recall': 0.5390626, 'specificity': 0.5390626, 'f1': 0.56055313, 'auroc': 0.9494529, 'binary_precision': 0.6, 'binary_recall': 0.08045977, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.1418919}
confusion matrix:
      0   1
0  5983  14
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.98050493, 'precision': 0.9032685, 'recall': 0.8377446, 'specificity': 0.8377446, 'f1': 0.8673177, 'auroc': 0.9536162, 'binary_precision': 0.8202765, 'binary_recall': 0.68199235, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.74476993}
confusion matrix:
      0    1
0  5958   39
1    83  178
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413552 GiB | 413551 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152171 K  |  152167 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89843 K  |   89840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152171 K  |  152167 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89843 K  |   89840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |    2870    |   90493 K  |   90493 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      38    |    2758    |   43218 K  |   43218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413553 GiB | 413553 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     25 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152171 K  |  152171 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152171 K  |  152171 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2870    |   90495 K  |   90495 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2758    |   43219 K  |   43219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413553 GiB | 413553 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     25 MiB |  12889 GiB |  12889 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152171 K  |  152171 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152171 K  |  152171 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89843 K  |   89843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2870    |   90495 K  |   90495 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2758    |   43219 K  |   43219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894

 Experiment start at: 2024-05-28 14:39:01.721461
before training, model accuracy: 0.9934555292129517
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.93550295, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.9412006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.84217614, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 15:19:59.007085,epoch time: 0:40:57.285624,used: 0:40:57.285624,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.956388, 'precision': 0.7780274, 'recall': 0.6394171, 'specificity': 0.6394171, 'f1': 0.682724, 'auroc': 0.9502173, 'binary_precision': 0.59090906, 'binary_recall': 0.2888889, 'binary_specificity': 0.98994535, 'binary_f1_score': 0.38805974}
confusion matrix:
       0    1
0  32786  333
1   1184  481
---- Validation: 
scalar performance:
{'acc': 0.9544085, 'precision': 0.8167976, 'recall': 0.56030005, 'specificity': 0.56030005, 'f1': 0.59279346, 'auroc': 0.95069635, 'binary_precision': 0.6766917, 'binary_recall': 0.12362637, 'binary_specificity': 0.99697375, 'binary_f1_score': 0.20905924}
confusion matrix:
       0   1
0  14166  43
1    638  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9953534, 'precision': 0.5978069, 'recall': 0.50722146, 'specificity': 0.50722146, 'f1': 0.51253414, 'auroc': 0.86567056, 'binary_precision': 0.2, 'binary_recall': 0.014705882, 'binary_specificity': 0.999737, 'binary_f1_score': 0.02739726}
confusion matrix:
       0  1
0  15208  4
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 2,now: 2024-05-28 15:57:02.350355,epoch time: 0:37:03.343270,used: 1:18:00.628894,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.9508541, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.9495578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.87009895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9544085264205933, corresponding to test acc:                         0.9953534007072449 / 0.995549738407135
after epoch: 3,now: 2024-05-28 16:34:17.483121,epoch time: 0:37:15.132766,used: 1:55:15.761660,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9580267, 'precision': 0.7662335, 'recall': 0.84448314, 'specificity': 0.84448314, 'f1': 0.7994777, 'auroc': 0.9560427, 'binary_precision': 0.54682505, 'binary_recall': 0.7189189, 'binary_specificity': 0.9700474, 'binary_f1_score': 0.62117285}
confusion matrix:
       0     1
0  32127   992
1    468  1197
---- Validation: 
scalar performance:
{'acc': 0.9552788, 'precision': 0.75791645, 'recall': 0.80251014, 'specificity': 0.80251014, 'f1': 0.7781283, 'auroc': 0.94981587, 'binary_precision': 0.5348028, 'binary_recall': 0.6332418, 'binary_specificity': 0.97177845, 'binary_f1_score': 0.5798742}
confusion matrix:
       0    1
0  13808  401
1    267  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918848, 'precision': 0.5535829, 'recall': 0.55671996, 'specificity': 0.55671996, 'f1': 0.55510473, 'auroc': 0.8807477, 'binary_precision': 0.11111111, 'binary_recall': 0.11764706, 'binary_specificity': 0.9957928, 'binary_f1_score': 0.114285715}
confusion matrix:
       0   1
0  15148  64
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 4,now: 2024-05-28 17:12:04.940842,epoch time: 0:37:47.457721,used: 2:33:03.219381,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9523919, 'precision': 0.9761898, 'recall': 0.5027027, 'specificity': 0.5027027, 'f1': 0.49318087, 'auroc': 0.95624053, 'binary_precision': 1.0, 'binary_recall': 0.0054054055, 'binary_specificity': 1.0, 'binary_f1_score': 0.010752688}
confusion matrix:
       0  1
0  33119  0
1   1656  9
---- Validation: 
scalar performance:
{'acc': 0.95139587, 'precision': 0.97569466, 'recall': 0.50137365, 'specificity': 0.50137365, 'f1': 0.49028435, 'auroc': 0.95335746, 'binary_precision': 1.0, 'binary_recall': 0.0027472528, 'binary_specificity': 1.0, 'binary_f1_score': 0.0054794517}
confusion matrix:
       0  1
0  14209  0
1    726  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8728572, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9513958692550659, best validation acc: 0.9552788138389587, corresponding to test acc:                         0.9918848276138306 / 0.995549738407135
after epoch: 5,now: 2024-05-28 17:49:09.708775,epoch time: 0:37:04.767933,used: 3:10:07.987314,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9596941, 'precision': 0.86620396, 'recall': 0.61092174, 'specificity': 0.61092174, 'f1': 0.6638584, 'auroc': 0.9632702, 'binary_precision': 0.77002054, 'binary_recall': 0.22522523, 'binary_specificity': 0.9966183, 'binary_f1_score': 0.348513}
confusion matrix:
       0    1
0  33007  112
1   1290  375
---- Validation: 
scalar performance:
{'acc': 0.95588136, 'precision': 0.8735651, 'recall': 0.5636807, 'specificity': 0.5636807, 'f1': 0.5996284, 'auroc': 0.9567914, 'binary_precision': 0.789916, 'binary_recall': 0.12912089, 'binary_specificity': 0.99824053, 'binary_f1_score': 0.22195986}
confusion matrix:
       0   1
0  14184  25
1    634  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.49777427, 'recall': 0.4998685, 'specificity': 0.4998685, 'f1': 0.49881923, 'auroc': 0.89937025, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999737, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15208  4
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 6,now: 2024-05-28 18:26:26.109812,epoch time: 0:37:16.401037,used: 3:47:24.388351,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9629715, 'precision': 0.7991622, 'recall': 0.78547597, 'specificity': 0.78547597, 'f1': 0.79213536, 'auroc': 0.96033704, 'binary_precision': 0.6189274, 'binary_recall': 0.5891892, 'binary_specificity': 0.9817627, 'binary_f1_score': 0.6036923}
confusion matrix:
       0    1
0  32515  604
1    684  981
---- Validation: 
scalar performance:
{'acc': 0.96304476, 'precision': 0.8232383, 'recall': 0.7290487, 'specificity': 0.7290487, 'f1': 0.7670615, 'auroc': 0.9589554, 'binary_precision': 0.6732283, 'binary_recall': 0.4697802, 'binary_specificity': 0.98831725, 'binary_f1_score': 0.5533981}
confusion matrix:
       0    1
0  14043  166
1    386  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905759, 'precision': 0.55424523, 'recall': 0.5780228, 'specificity': 0.5780228, 'f1': 0.5638961, 'auroc': 0.85922277, 'binary_precision': 0.1122449, 'binary_recall': 0.16176471, 'binary_specificity': 0.9942808, 'binary_f1_score': 0.13253011}
confusion matrix:
       0   1
0  15125  87
1     57  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 7,now: 2024-05-28 19:04:03.966302,epoch time: 0:37:37.856490,used: 4:25:02.244841,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95630175, 'precision': 0.7592727, 'recall': 0.885217, 'specificity': 0.885217, 'f1': 0.8076782, 'auroc': 0.9566652, 'binary_precision': 0.5285321, 'binary_recall': 0.8066066, 'binary_specificity': 0.96382743, 'binary_f1_score': 0.6386115}
confusion matrix:
       0     1
0  31921  1198
1    322  1343
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.7572658, 'recall': 0.8610507, 'specificity': 0.8610507, 'f1': 0.7988336, 'auroc': 0.95624405, 'binary_precision': 0.5272727, 'binary_recall': 0.7568681, 'binary_specificity': 0.9652333, 'binary_f1_score': 0.6215454}
confusion matrix:
       0    1
0  13715  494
1    177  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98979056, 'precision': 0.5867826, 'recall': 0.6727893, 'specificity': 0.6727893, 'f1': 0.61507756, 'auroc': 0.8614515, 'binary_precision': 0.1764706, 'binary_recall': 0.3529412, 'binary_specificity': 0.9926374, 'binary_f1_score': 0.23529412}
confusion matrix:
       0    1
0  15100  112
1     44   24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9550780057907104, best validation acc: 0.9630447626113892, corresponding to test acc:                         0.990575909614563 / 0.995549738407135
after epoch: 8,now: 2024-05-28 19:41:25.793223,epoch time: 0:37:21.826921,used: 5:02:24.071762,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95943534, 'precision': 0.86500674, 'recall': 0.6076486, 'specificity': 0.6076486, 'f1': 0.6597101, 'auroc': 0.9585409, 'binary_precision': 0.7679325, 'binary_recall': 0.21861862, 'binary_specificity': 0.99667865, 'binary_f1_score': 0.34034595}
confusion matrix:
       0    1
0  33009  110
1   1301  364
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.9389204, 'recall': 0.55607235, 'specificity': 0.55607235, 'f1': 0.5891307, 'auroc': 0.95626104, 'binary_precision': 0.92134833, 'binary_recall': 0.11263736, 'binary_specificity': 0.99950737, 'binary_f1_score': 0.20073439}
confusion matrix:
       0   1
0  14202   7
1    646  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8396489, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 2
val acc:0.9562830328941345, best validation acc: 0.9630447626113892, corresponding to test acc:                         0.990575909614563 / 0.995549738407135
after epoch: 9,now: 2024-05-28 20:18:37.755482,epoch time: 0:37:11.962259,used: 5:39:36.034021,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9649839, 'precision': 0.8161841, 'recall': 0.7776915, 'specificity': 0.7776915, 'f1': 0.7955177, 'auroc': 0.96349055, 'binary_precision': 0.6538197, 'binary_recall': 0.5705706, 'binary_specificity': 0.9848123, 'binary_f1_score': 0.609365}
confusion matrix:
       0    1
0  32616  503
1    715  950
---- Validation: 
scalar performance:
{'acc': 0.964116, 'precision': 0.825439, 'recall': 0.7472056, 'specificity': 0.7472056, 'f1': 0.7802683, 'auroc': 0.9634756, 'binary_precision': 0.67582417, 'binary_recall': 0.5068681, 'binary_specificity': 0.9875431, 'binary_f1_score': 0.5792779}
confusion matrix:
       0    1
0  14032  177
1    359  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99345547, 'precision': 0.5373414, 'recall': 0.5209084, 'specificity': 0.5209084, 'f1': 0.5266601, 'auroc': 0.858678, 'binary_precision': 0.078947365, 'binary_recall': 0.04411765, 'binary_specificity': 0.9976992, 'binary_f1_score': 0.056603774}
confusion matrix:
       0   1
0  15177  35
1     65   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 10,now: 2024-05-28 20:55:20.017140,epoch time: 0:36:42.261658,used: 6:16:18.295679,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96495515, 'precision': 0.8661915, 'recall': 0.691545, 'specificity': 0.691545, 'f1': 0.74856424, 'auroc': 0.9651519, 'binary_precision': 0.76235294, 'binary_recall': 0.38918918, 'binary_specificity': 0.9939008, 'binary_f1_score': 0.51530814}
confusion matrix:
       0    1
0  32917  202
1   1017  648
---- Validation: 
scalar performance:
{'acc': 0.9633795, 'precision': 0.8790209, 'recall': 0.6666688, 'specificity': 0.6666688, 'f1': 0.7272811, 'auroc': 0.96531606, 'binary_precision': 0.7909968, 'binary_recall': 0.33791208, 'binary_specificity': 0.99542546, 'binary_f1_score': 0.47353223}
confusion matrix:
       0    1
0  14144   65
1    482  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927356, 'precision': 0.5451011, 'recall': 0.535187, 'specificity': 0.535187, 'f1': 0.539499, 'auroc': 0.8553452, 'binary_precision': 0.094339624, 'binary_recall': 0.073529415, 'binary_specificity': 0.9968446, 'binary_f1_score': 0.082644634}
confusion matrix:
       0   1
0  15164  48
1     63   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9633795022964478, best validation acc: 0.9641159772872925, corresponding to test acc:                         0.9934554696083069 / 0.995549738407135
after epoch: 11,now: 2024-05-28 21:32:14.938431,epoch time: 0:36:54.921291,used: 6:53:13.216970,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9666513, 'precision': 0.80652285, 'recall': 0.86669487, 'specificity': 0.86669487, 'f1': 0.833503, 'auroc': 0.9698198, 'binary_precision': 0.6254347, 'binary_recall': 0.75615615, 'binary_specificity': 0.9772336, 'binary_f1_score': 0.6846112}
confusion matrix:
       0     1
0  32365   754
1    406  1259
---- Validation: 
scalar performance:
{'acc': 0.9655888, 'precision': 0.8098717, 'recall': 0.83399415, 'specificity': 0.83399415, 'f1': 0.82141227, 'auroc': 0.9683286, 'binary_precision': 0.63578683, 'binary_recall': 0.6881868, 'binary_specificity': 0.97980154, 'binary_f1_score': 0.6609499}
confusion matrix:
       0    1
0  13922  287
1    227  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99090314, 'precision': 0.585541, 'recall': 0.6367477, 'specificity': 0.6367477, 'f1': 0.6050572, 'auroc': 0.87193257, 'binary_precision': 0.17431192, 'binary_recall': 0.27941176, 'binary_specificity': 0.99408364, 'binary_f1_score': 0.21468927}
confusion matrix:
       0   1
0  15122  90
1     49  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 12,now: 2024-05-28 22:09:04.964520,epoch time: 0:36:50.026089,used: 7:30:03.243059,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9648114, 'precision': 0.81936854, 'recall': 0.76419634, 'specificity': 0.76419634, 'f1': 0.78882205, 'auroc': 0.9616747, 'binary_precision': 0.6615385, 'binary_recall': 0.54234236, 'binary_specificity': 0.9860503, 'binary_f1_score': 0.59603965}
confusion matrix:
       0    1
0  32657  462
1    762  903
---- Validation: 
scalar performance:
{'acc': 0.96157193, 'precision': 0.81150377, 'recall': 0.72240996, 'specificity': 0.72240996, 'f1': 0.7585253, 'auroc': 0.9608311, 'binary_precision': 0.6503906, 'binary_recall': 0.45741758, 'binary_specificity': 0.9874024, 'binary_f1_score': 0.53709674}
confusion matrix:
       0    1
0  14030  179
1    395  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.49777427, 'recall': 0.4998685, 'specificity': 0.4998685, 'f1': 0.49881923, 'auroc': 0.89537114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999737, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15208  4
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9615719318389893, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 13,now: 2024-05-28 22:45:56.111252,epoch time: 0:36:51.146732,used: 8:06:54.389791,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9626265, 'precision': 0.78450763, 'recall': 0.8862567, 'specificity': 0.8862567, 'f1': 0.8263632, 'auroc': 0.96889365, 'binary_precision': 0.5791757, 'binary_recall': 0.8018018, 'binary_specificity': 0.97071165, 'binary_f1_score': 0.6725441}
confusion matrix:
       0     1
0  32149   970
1    330  1335
---- Validation: 
scalar performance:
{'acc': 0.96498626, 'precision': 0.8013022, 'recall': 0.8630006, 'specificity': 0.8630006, 'f1': 0.8288268, 'auroc': 0.96488225, 'binary_precision': 0.6155581, 'binary_recall': 0.75, 'binary_specificity': 0.97600114, 'binary_f1_score': 0.67616093}
confusion matrix:
       0    1
0  13868  341
1    182  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910995, 'precision': 0.59101075, 'recall': 0.64416635, 'specificity': 0.64416635, 'f1': 0.61139834, 'auroc': 0.8530357, 'binary_precision': 0.18518518, 'binary_recall': 0.29411766, 'binary_specificity': 0.9942151, 'binary_f1_score': 0.22727273}
confusion matrix:
       0   1
0  15124  88
1     48  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 2
val acc:0.964986264705658, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 14,now: 2024-05-28 23:23:00.321747,epoch time: 0:37:04.210495,used: 8:43:58.600286,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96702504, 'precision': 0.817624, 'recall': 0.82468104, 'specificity': 0.82468104, 'f1': 0.8211082, 'auroc': 0.96577847, 'binary_precision': 0.6519953, 'binary_recall': 0.66726726, 'binary_specificity': 0.9820949, 'binary_f1_score': 0.6595429}
confusion matrix:
       0     1
0  32526   593
1    554  1111
---- Validation: 
scalar performance:
{'acc': 0.96478546, 'precision': 0.80731773, 'recall': 0.82249427, 'specificity': 0.82249427, 'f1': 0.81469536, 'auroc': 0.96518975, 'binary_precision': 0.63185376, 'binary_recall': 0.66483516, 'binary_specificity': 0.98015344, 'binary_f1_score': 0.647925}
confusion matrix:
       0    1
0  13927  282
1    244  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9920157, 'precision': 0.5750812, 'recall': 0.58606595, 'specificity': 0.58606595, 'f1': 0.5801861, 'auroc': 0.84766555, 'binary_precision': 0.15384616, 'binary_recall': 0.1764706, 'binary_specificity': 0.9956613, 'binary_f1_score': 0.16438358}
confusion matrix:
       0   1
0  15146  66
1     56  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 3
val acc:0.9647854566574097, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 15,now: 2024-05-29 00:00:10.790204,epoch time: 0:37:10.468457,used: 9:21:09.068743,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96124655, 'precision': 0.9306033, 'recall': 0.6066033, 'specificity': 0.6066033, 'f1': 0.6631486, 'auroc': 0.9631241, 'binary_precision': 0.8992443, 'binary_recall': 0.21441442, 'binary_specificity': 0.99879223, 'binary_f1_score': 0.34626576}
confusion matrix:
       0    1
0  33079   40
1   1308  357
---- Validation: 
scalar performance:
{'acc': 0.9580237, 'precision': 0.94492805, 'recall': 0.57458115, 'specificity': 0.57458115, 'f1': 0.6181946, 'auroc': 0.96322733, 'binary_precision': 0.93162394, 'binary_recall': 0.14972527, 'binary_specificity': 0.999437, 'binary_f1_score': 0.25798815}
confusion matrix:
       0    1
0  14201    8
1    619  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.49777472, 'recall': 0.49996713, 'specificity': 0.49996713, 'f1': 0.49886853, 'auroc': 0.8348974, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15211  1
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 4
val acc:0.958023726940155, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 16,now: 2024-05-29 00:37:23.380910,epoch time: 0:37:12.590706,used: 9:58:21.659449,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96406394, 'precision': 0.8309262, 'recall': 0.72216415, 'specificity': 0.72216415, 'f1': 0.76452273, 'auroc': 0.96436894, 'binary_precision': 0.688808, 'binary_recall': 0.45465466, 'binary_specificity': 0.9896736, 'binary_f1_score': 0.5477569}
confusion matrix:
       0    1
0  32777  342
1    908  757
---- Validation: 
scalar performance:
{'acc': 0.9629109, 'precision': 0.86707807, 'recall': 0.66902894, 'specificity': 0.66902894, 'f1': 0.72758025, 'auroc': 0.96277726, 'binary_precision': 0.76687115, 'binary_recall': 0.3434066, 'binary_specificity': 0.99465126, 'binary_f1_score': 0.4743833}
confusion matrix:
       0    1
0  14133   76
1    478  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910995, 'precision': 0.5242111, 'recall': 0.52704525, 'specificity': 0.52704525, 'f1': 0.52554214, 'auroc': 0.85961306, 'binary_precision': 0.05263158, 'binary_recall': 0.05882353, 'binary_specificity': 0.9952669, 'binary_f1_score': 0.055555556}
confusion matrix:
       0   1
0  15140  72
1     64   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 5
val acc:0.9629108905792236, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 17,now: 2024-05-29 01:14:34.409061,epoch time: 0:37:11.028151,used: 10:35:32.687600,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96673757, 'precision': 0.8642419, 'recall': 0.72185695, 'specificity': 0.72185695, 'f1': 0.77379096, 'auroc': 0.9667252, 'binary_precision': 0.7555332, 'binary_recall': 0.45105106, 'binary_specificity': 0.99266285, 'binary_f1_score': 0.56487405}
confusion matrix:
       0    1
0  32876  243
1    914  751
---- Validation: 
scalar performance:
{'acc': 0.9650532, 'precision': 0.91362053, 'recall': 0.6675485, 'specificity': 0.6675485, 'f1': 0.7335599, 'auroc': 0.9686285, 'binary_precision': 0.86013985, 'binary_recall': 0.33791208, 'binary_specificity': 0.9971849, 'binary_f1_score': 0.4852071}
confusion matrix:
       0    1
0  14169   40
1    482  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9945026, 'precision': 0.61466664, 'recall': 0.5507146, 'specificity': 0.5507146, 'f1': 0.57004976, 'auroc': 0.86772215, 'binary_precision': 0.23333333, 'binary_recall': 0.10294118, 'binary_specificity': 0.998488, 'binary_f1_score': 0.14285715}
confusion matrix:
       0   1
0  15189  23
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 6
val acc:0.9650532007217407, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 18,now: 2024-05-29 01:51:43.918216,epoch time: 0:37:09.509155,used: 11:12:42.196755,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9609303, 'precision': 0.7764255, 'recall': 0.9084675, 'specificity': 0.9084675, 'f1': 0.8274733, 'auroc': 0.97105694, 'binary_precision': 0.56057006, 'binary_recall': 0.85045046, 'binary_specificity': 0.9664845, 'binary_f1_score': 0.6757337}
confusion matrix:
       0     1
0  32009  1110
1    249  1416
---- Validation: 
scalar performance:
{'acc': 0.9617058, 'precision': 0.7845436, 'recall': 0.8690958, 'specificity': 0.8690958, 'f1': 0.8204219, 'auroc': 0.96982795, 'binary_precision': 0.58125, 'binary_recall': 0.76648355, 'binary_specificity': 0.97170806, 'binary_f1_score': 0.6611375}
confusion matrix:
       0    1
0  13807  402
1    170  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9844895, 'precision': 0.557429, 'recall': 0.68476707, 'specificity': 0.68476707, 'f1': 0.58605075, 'auroc': 0.88840395, 'binary_precision': 0.11764706, 'binary_recall': 0.38235295, 'binary_specificity': 0.9871812, 'binary_f1_score': 0.1799308}
confusion matrix:
       0    1
0  15017  195
1     42   26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 7
val acc:0.9617058038711548, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 19,now: 2024-05-29 02:28:53.140681,epoch time: 0:37:09.222465,used: 11:49:51.419220,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96702504, 'precision': 0.820618, 'recall': 0.81384337, 'specificity': 0.81384337, 'f1': 0.81718934, 'auroc': 0.9709121, 'binary_precision': 0.65909094, 'binary_recall': 0.64444447, 'binary_specificity': 0.9832423, 'binary_f1_score': 0.65168536}
confusion matrix:
       0     1
0  32564   555
1    592  1073
---- Validation: 
scalar performance:
{'acc': 0.96538794, 'precision': 0.8318328, 'recall': 0.75960344, 'specificity': 0.75960344, 'f1': 0.7907238, 'auroc': 0.96326673, 'binary_precision': 0.687389, 'binary_recall': 0.5315934, 'binary_specificity': 0.9876135, 'binary_f1_score': 0.5995352}
confusion matrix:
       0    1
0  14033  176
1    341  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949607, 'precision': 0.5432606, 'recall': 0.5070242, 'specificity': 0.5070242, 'f1': 0.51139516, 'auroc': 0.86855435, 'binary_precision': 0.09090909, 'binary_recall': 0.014705882, 'binary_specificity': 0.9993426, 'binary_f1_score': 0.025316456}
confusion matrix:
       0   1
0  15202  10
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 8
val acc:0.9653879404067993, best validation acc: 0.9655888080596924, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 20,now: 2024-05-29 03:06:09.906750,epoch time: 0:37:16.766069,used: 12:27:08.185289,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96676636, 'precision': 0.8115026, 'recall': 0.8436538, 'specificity': 0.8436538, 'f1': 0.82667124, 'auroc': 0.9695345, 'binary_precision': 0.63779104, 'binary_recall': 0.7075075, 'binary_specificity': 0.9798001, 'binary_f1_score': 0.6708428}
confusion matrix:
       0     1
0  32450   669
1    487  1178
---- Validation: 
scalar performance:
{'acc': 0.9676642, 'precision': 0.8358515, 'recall': 0.7966392, 'specificity': 0.7966392, 'f1': 0.81486416, 'auroc': 0.9673887, 'binary_precision': 0.69170576, 'binary_recall': 0.60714287, 'binary_specificity': 0.98613554, 'binary_f1_score': 0.64667153}
confusion matrix:
       0    1
0  14012  197
1    286  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99090314, 'precision': 0.561314, 'recall': 0.5855072, 'specificity': 0.5855072, 'f1': 0.5713332, 'auroc': 0.86709166, 'binary_precision': 0.12631579, 'binary_recall': 0.1764706, 'binary_specificity': 0.9945438, 'binary_f1_score': 0.14723927}
confusion matrix:
       0   1
0  15129  83
1     56  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 21,now: 2024-05-29 03:43:16.464157,epoch time: 0:37:06.557407,used: 13:04:14.742696,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96777254, 'precision': 0.86393285, 'recall': 0.7389422, 'specificity': 0.7389422, 'f1': 0.7869762, 'auroc': 0.96795034, 'binary_precision': 0.7532588, 'binary_recall': 0.4858859, 'binary_specificity': 0.99199855, 'binary_f1_score': 0.59072655}
confusion matrix:
       0    1
0  32854  265
1    856  809
---- Validation: 
scalar performance:
{'acc': 0.96271, 'precision': 0.8584988, 'recall': 0.67348474, 'specificity': 0.67348474, 'f1': 0.7302935, 'auroc': 0.9629097, 'binary_precision': 0.74927115, 'binary_recall': 0.35302198, 'binary_specificity': 0.9939475, 'binary_f1_score': 0.47992527}
confusion matrix:
       0    1
0  14123   86
1    471  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469894, 'precision': 0.61796784, 'recall': 0.54349315, 'specificity': 0.54349315, 'f1': 0.5631868, 'auroc': 0.8743721, 'binary_precision': 0.24, 'binary_recall': 0.0882353, 'binary_specificity': 0.998751, 'binary_f1_score': 0.12903225}
confusion matrix:
       0   1
0  15193  19
1     62   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9627100229263306, best validation acc: 0.9676641821861267, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 22,now: 2024-05-29 04:20:22.790964,epoch time: 0:37:06.326807,used: 13:41:21.069503,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96829003, 'precision': 0.87795305, 'recall': 0.7306579, 'specificity': 0.7306579, 'f1': 0.7845043, 'auroc': 0.9717046, 'binary_precision': 0.7821285, 'binary_recall': 0.46786788, 'binary_specificity': 0.99344784, 'binary_f1_score': 0.5854942}
confusion matrix:
       0    1
0  32902  217
1    886  779
---- Validation: 
scalar performance:
{'acc': 0.9658566, 'precision': 0.87448955, 'recall': 0.7064166, 'specificity': 0.7064166, 'f1': 0.7634531, 'auroc': 0.96834075, 'binary_precision': 0.7780612, 'binary_recall': 0.41895604, 'binary_specificity': 0.9938771, 'binary_f1_score': 0.54464287}
confusion matrix:
       0    1
0  14122   87
1    423  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9908377, 'precision': 0.55243844, 'recall': 0.57083416, 'specificity': 0.57083416, 'f1': 0.56019735, 'auroc': 0.81660354, 'binary_precision': 0.10869565, 'binary_recall': 0.14705883, 'binary_specificity': 0.99460953, 'binary_f1_score': 0.125}
confusion matrix:
       0   1
0  15130  82
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 2
val acc:0.9658566117286682, best validation acc: 0.9676641821861267, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 23,now: 2024-05-29 04:57:16.350403,epoch time: 0:36:53.559439,used: 14:18:14.628942,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96725506, 'precision': 0.9158761, 'recall': 0.68647826, 'specificity': 0.68647826, 'f1': 0.7533375, 'auroc': 0.96900666, 'binary_precision': 0.862259, 'binary_recall': 0.37597597, 'binary_specificity': 0.9969806, 'binary_f1_score': 0.52363026}
confusion matrix:
       0    1
0  33019  100
1   1039  626
---- Validation: 
scalar performance:
{'acc': 0.9645846, 'precision': 0.92364657, 'recall': 0.6568762, 'specificity': 0.6568762, 'f1': 0.7234012, 'auroc': 0.9646083, 'binary_precision': 0.88122606, 'binary_recall': 0.31593406, 'binary_specificity': 0.9978183, 'binary_f1_score': 0.4651163}
confusion matrix:
       0    1
0  14178   31
1    498  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9953534, 'precision': 0.5978069, 'recall': 0.50722146, 'specificity': 0.50722146, 'f1': 0.51253414, 'auroc': 0.8548572, 'binary_precision': 0.2, 'binary_recall': 0.014705882, 'binary_specificity': 0.999737, 'binary_f1_score': 0.02739726}
confusion matrix:
       0  1
0  15208  4
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 3
val acc:0.9645845890045166, best validation acc: 0.9676641821861267, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 24,now: 2024-05-29 05:34:00.704435,epoch time: 0:36:44.354032,used: 14:54:58.982974,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9642077, 'precision': 0.8331531, 'recall': 0.7210988, 'specificity': 0.7210988, 'f1': 0.76440215, 'auroc': 0.96357524, 'binary_precision': 0.69337016, 'binary_recall': 0.45225224, 'binary_specificity': 0.98994535, 'binary_f1_score': 0.5474373}
confusion matrix:
       0    1
0  32786  333
1    912  753
---- Validation: 
scalar performance:
{'acc': 0.96090245, 'precision': 0.8462091, 'recall': 0.6555924, 'specificity': 0.6555924, 'f1': 0.71071225, 'auroc': 0.95525897, 'binary_precision': 0.7264151, 'binary_recall': 0.31730768, 'binary_specificity': 0.9938771, 'binary_f1_score': 0.4416826}
confusion matrix:
       0    1
0  14122   87
1    497  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9818717, 'precision': 0.51786405, 'recall': 0.5590111, 'specificity': 0.5590111, 'f1': 0.5259322, 'auroc': 0.79171634, 'binary_precision': 0.039647575, 'binary_recall': 0.13235295, 'binary_specificity': 0.9856692, 'binary_f1_score': 0.06101695}
confusion matrix:
       0    1
0  14994  218
1     59    9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 4
val acc:0.9609024524688721, best validation acc: 0.9676641821861267, corresponding to test acc:                         0.9909031391143799 / 0.995549738407135
after epoch: 25,now: 2024-05-29 06:10:44.883774,epoch time: 0:36:44.179339,used: 15:31:43.162313,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96966994, 'precision': 0.84499943, 'recall': 0.80439454, 'specificity': 0.80439454, 'f1': 0.8232609, 'auroc': 0.9749372, 'binary_precision': 0.7089041, 'binary_recall': 0.6216216, 'binary_specificity': 0.9871675, 'binary_f1_score': 0.6624}
confusion matrix:
       0     1
0  32694   425
1    630  1035
---- Validation: 
scalar performance:
{'acc': 0.9684676, 'precision': 0.8851801, 'recall': 0.73385394, 'specificity': 0.73385394, 'f1': 0.78895575, 'auroc': 0.96851337, 'binary_precision': 0.79676676, 'binary_recall': 0.4739011, 'binary_specificity': 0.9938067, 'binary_f1_score': 0.59431523}
confusion matrix:
       0    1
0  14121   88
1    383  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937827, 'precision': 0.5550438, 'recall': 0.52839285, 'specificity': 0.52839285, 'f1': 0.5372754, 'auroc': 0.85109234, 'binary_precision': 0.114285715, 'binary_recall': 0.05882353, 'binary_specificity': 0.9979621, 'binary_f1_score': 0.0776699}
confusion matrix:
       0   1
0  15181  31
1     64   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 26,now: 2024-05-29 06:47:46.920998,epoch time: 0:37:02.037224,used: 16:08:45.199537,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97125113, 'precision': 0.86206985, 'recall': 0.79952085, 'specificity': 0.79952085, 'f1': 0.827469, 'auroc': 0.9739825, 'binary_precision': 0.74358976, 'binary_recall': 0.6096096, 'binary_specificity': 0.98943204, 'binary_f1_score': 0.669967}
confusion matrix:
       0     1
0  32769   350
1    650  1015
---- Validation: 
scalar performance:
{'acc': 0.9703421, 'precision': 0.87647593, 'recall': 0.7713301, 'specificity': 0.7713301, 'f1': 0.81435144, 'auroc': 0.9690337, 'binary_precision': 0.7756286, 'binary_recall': 0.55082417, 'binary_specificity': 0.99183613, 'binary_f1_score': 0.6441767}
confusion matrix:
       0    1
0  14093  116
1    327  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918848, 'precision': 0.58155656, 'recall': 0.60064036, 'specificity': 0.60064036, 'f1': 0.5900663, 'auroc': 0.8784919, 'binary_precision': 0.16666667, 'binary_recall': 0.20588236, 'binary_specificity': 0.99539834, 'binary_f1_score': 0.18421054}
confusion matrix:
       0   1
0  15142  70
1     54  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
better model found
persisted
after epoch: 27,now: 2024-05-29 07:24:39.543450,epoch time: 0:36:52.622452,used: 16:45:37.821989,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9569342, 'precision': 0.8707362, 'recall': 0.5684031, 'specificity': 0.5684031, 'f1': 0.60677856, 'auroc': 0.9604875, 'binary_precision': 0.78305084, 'binary_recall': 0.13873874, 'binary_specificity': 0.99806756, 'binary_f1_score': 0.23571429}
confusion matrix:
       0    1
0  33055   64
1   1434  231
---- Validation: 
scalar performance:
{'acc': 0.95347124, 'precision': 0.86691076, 'recall': 0.5311359, 'specificity': 0.5311359, 'f1': 0.5465029, 'auroc': 0.95781213, 'binary_precision': 0.779661, 'binary_recall': 0.06318682, 'binary_specificity': 0.99908507, 'binary_f1_score': 0.116899624}
confusion matrix:
       0   1
0  14196  13
1    682  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9945026, 'precision': 0.5255828, 'recall': 0.50679415, 'specificity': 0.50679415, 'f1': 0.5102497, 'auroc': 0.87534976, 'binary_precision': 0.055555556, 'binary_recall': 0.014705882, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.023255814}
confusion matrix:
       0   1
0  15195  17
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 1
val acc:0.9534712433815002, best validation acc: 0.9703420996665955, corresponding to test acc:                         0.9918848276138306 / 0.995549738407135
after epoch: 28,now: 2024-05-29 08:01:42.577260,epoch time: 0:37:03.033810,used: 17:22:40.855799,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9644664, 'precision': 0.8707315, 'recall': 0.6798802, 'specificity': 0.6798802, 'f1': 0.73875284, 'auroc': 0.9676825, 'binary_precision': 0.772554, 'binary_recall': 0.36516517, 'binary_specificity': 0.9945952, 'binary_f1_score': 0.49592167}
confusion matrix:
       0    1
0  32940  179
1   1057  608
---- Validation: 
scalar performance:
{'acc': 0.961505, 'precision': 0.8756033, 'recall': 0.64222497, 'specificity': 0.64222497, 'f1': 0.7010999, 'auroc': 0.96403384, 'binary_precision': 0.78651685, 'binary_recall': 0.28846154, 'binary_specificity': 0.9959884, 'binary_f1_score': 0.42211056}
confusion matrix:
       0    1
0  14152   57
1    518  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99456805, 'precision': 0.6186898, 'recall': 0.55074745, 'specificity': 0.55074745, 'f1': 0.5708027, 'auroc': 0.85697025, 'binary_precision': 0.2413793, 'binary_recall': 0.10294118, 'binary_specificity': 0.99855375, 'binary_f1_score': 0.1443299}
confusion matrix:
       0   1
0  15190  22
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 2
val acc:0.9615049958229065, best validation acc: 0.9703420996665955, corresponding to test acc:                         0.9918848276138306 / 0.995549738407135
after epoch: 29,now: 2024-05-29 08:38:51.516641,epoch time: 0:37:08.939381,used: 17:59:49.795180,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9685775, 'precision': 0.82545567, 'recall': 0.834908, 'specificity': 0.834908, 'f1': 0.8301045, 'auroc': 0.97067523, 'binary_precision': 0.6666667, 'binary_recall': 0.68708706, 'binary_specificity': 0.98272896, 'binary_f1_score': 0.6767228}
confusion matrix:
       0     1
0  32547   572
1    521  1144
---- Validation: 
scalar performance:
{'acc': 0.9667269, 'precision': 0.8369658, 'recall': 0.7752946, 'specificity': 0.7752946, 'f1': 0.80261165, 'auroc': 0.96391785, 'binary_precision': 0.69609505, 'binary_recall': 0.5631868, 'binary_specificity': 0.9874024, 'binary_f1_score': 0.62262714}
confusion matrix:
       0    1
0  14030  179
1    318  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9861911, 'precision': 0.53407544, 'recall': 0.5831407, 'specificity': 0.5831407, 'f1': 0.54758483, 'auroc': 0.8402811, 'binary_precision': 0.07185629, 'binary_recall': 0.1764706, 'binary_specificity': 0.9898107, 'binary_f1_score': 0.102127664}
confusion matrix:
       0    1
0  15057  155
1     56   12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897894.png
early stop counter: 3
val acc:0.9667268991470337, best validation acc: 0.9703420996665955, corresponding to test acc:                         0.9918848276138306 / 0.995549738407135
after epoch: 30,now: 2024-05-29 09:15:58.661895,epoch time: 0:37:07.145254,used: 18:36:56.940434,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_14_39_01_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:36:56.940434 at 2024-05-29 09:15:58.661895
persisted model performance metric: 

scalar performance:
{'acc': 0.9928011, 'precision': 0.60242414, 'recall': 0.6084206, 'specificity': 0.6084206, 'f1': 0.6053348, 'auroc': 0.85251725, 'binary_precision': 0.20833333, 'binary_recall': 0.22058824, 'binary_specificity': 0.99625295, 'binary_f1_score': 0.2142857}
confusion matrix:
       0   1
0  15155  57
1     53  15
oracle model performance metric: 

scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8240572, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1665 MiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      8 MiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1665 MiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      8 MiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1901 TiB |   1901 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1876 TiB |   1876 TiB |
|       from small pool |      5 MiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 395477 KiB |    905 MiB |    779 TiB |    779 TiB |
|       from large pool | 377232 KiB |    904 MiB |    754 TiB |    754 TiB |
|       from small pool |  18245 KiB |     25 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6744    |    7065    |  293907 K  |  293900 K  |
|       from large pool |     247    |     989    |  120004 K  |  120003 K  |
|       from small pool |    6497    |    6719    |  173903 K  |  173896 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6744    |    7065    |  293907 K  |  293900 K  |
|       from large pool |     247    |     989    |  120004 K  |  120003 K  |
|       from small pool |    6497    |    6719    |  173903 K  |  173896 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |    2870    |  173816 K  |  173816 K  |
|       from large pool |     107    |     516    |   90656 K  |   90656 K  |
|       from small pool |      32    |    2758    |   83159 K  |   83159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1901 TiB |   1901 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1876 TiB |   1876 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    779 TiB |    779 TiB |
|       from large pool |  24320 KiB |    904 MiB |    754 TiB |    754 TiB |
|       from small pool |      0 KiB |     25 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7065    |  293907 K  |  293907 K  |
|       from large pool |       2    |     989    |  120004 K  |  120004 K  |
|       from small pool |       0    |    6719    |  173903 K  |  173903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7065    |  293907 K  |  293907 K  |
|       from large pool |       2    |     989    |  120004 K  |  120004 K  |
|       from small pool |       0    |    6719    |  173903 K  |  173903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2870    |  173819 K  |  173819 K  |
|       from large pool |       2    |     516    |   90656 K  |   90656 K  |
|       from small pool |       0    |    2758    |   83162 K  |   83162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15808 MiB |   1906 TiB |   1906 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1881 TiB |   1881 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1901 TiB |   1901 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1876 TiB |   1876 TiB |
|       from small pool |      0 KiB |     26 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    779 TiB |    779 TiB |
|       from large pool |  24320 KiB |    904 MiB |    754 TiB |    754 TiB |
|       from small pool |      0 KiB |     25 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7065    |  293907 K  |  293907 K  |
|       from large pool |       2    |     989    |  120004 K  |  120004 K  |
|       from small pool |       0    |    6719    |  173903 K  |  173903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7065    |  293907 K  |  293907 K  |
|       from large pool |       2    |     989    |  120004 K  |  120004 K  |
|       from small pool |       0    |    6719    |  173903 K  |  173903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2870    |  173819 K  |  173819 K  |
|       from large pool |       2    |     516    |   90656 K  |   90656 K  |
|       from small pool |       0    |    2758    |   83162 K  |   83162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_09_29_34_seed_0_20897894

 Experiment start at: 2024-05-29 09:29:34.669086
before training, model accuracy: 0.9471796751022339
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.966986, 'precision': 0.7965059, 'recall': 0.52710134, 'specificity': 0.52710134, 'f1': 0.54245025, 'auroc': 0.93699765, 'binary_precision': 0.625, 'binary_recall': 0.055363324, 'binary_specificity': 0.9988393, 'binary_f1_score': 0.101716466}
confusion matrix:
       0   1
0  41307  48
1   1365  80
---- Validation: 
scalar performance:
{'acc': 0.96476567, 'precision': 0.649153, 'recall': 0.501442, 'specificity': 0.501442, 'f1': 0.4941141, 'auroc': 0.939948, 'binary_precision': 0.33333334, 'binary_recall': 0.00311042, 'binary_specificity': 0.99977356, 'binary_f1_score': 0.006163329}
confusion matrix:
       0  1
0  17659  4
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.897136, 'recall': 0.50860876, 'specificity': 0.50860876, 'f1': 0.5070124, 'auroc': 0.85639954, 'binary_precision': 0.8333333, 'binary_recall': 0.017361112, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.034013607}
confusion matrix:
      0  1
0  6962  1
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897894.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 10:06:23.713748,epoch time: 0:36:49.044662,used: 0:36:49.044662,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_09_29_34_seed_0_20897894
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96635514, 'precision': 0.7990414, 'recall': 0.5040676, 'specificity': 0.5040676, 'f1': 0.49963912, 'auroc': 0.9500718, 'binary_precision': 0.6315789, 'binary_recall': 0.008304498, 'binary_specificity': 0.9998307, 'binary_f1_score': 0.016393444}
confusion matrix:
       0   1
0  41348   7
1   1433  12
---- Validation: 
slurmstepd: error: *** JOB 20897894 ON gpusrv30 CANCELLED AT 2024-05-29T10:35:48 ***
