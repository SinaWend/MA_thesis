Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893

 Experiment start at: 2024-05-27 19:33:34.572686
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9651306, 'precision': 0.7277836, 'recall': 0.6849185, 'specificity': 0.6849185, 'f1': 0.70387167, 'auroc': 0.8880714, 'binary_precision': 0.47683236, 'binary_recall': 0.38451087, 'binary_specificity': 0.9853261, 'binary_f1_score': 0.42572394}
confusion matrix:
       0    1
0  41699  621
1    906  566
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.72423315, 'recall': 0.6829095, 'specificity': 0.6829095, 'f1': 0.7012279, 'auroc': 0.89427364, 'binary_precision': 0.47024953, 'binary_recall': 0.38102645, 'binary_specificity': 0.98479253, 'binary_f1_score': 0.4209622}
confusion matrix:
       0    1
0  17873  276
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.86998785, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 20:11:15.035836,epoch time: 0:37:40.463150,used: 0:37:40.463150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9321922, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9412061, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89554787, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
better model found
persisted
after epoch: 2,now: 2024-05-27 20:47:55.412868,epoch time: 0:36:40.377032,used: 1:14:20.840182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.92343855, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.93260914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8904984, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 3,now: 2024-05-27 21:23:53.666344,epoch time: 0:35:58.253476,used: 1:50:19.093658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.9220425, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9304653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8767673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 4,now: 2024-05-27 22:00:22.716580,epoch time: 0:36:29.050236,used: 2:26:48.143894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9348248, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.94539034, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.90744495, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 5,now: 2024-05-27 22:36:18.227198,epoch time: 0:35:55.510618,used: 3:02:43.654512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.7673718, 'recall': 0.53835064, 'specificity': 0.53835064, 'f1': 0.5607609, 'auroc': 0.9390846, 'binary_precision': 0.56585366, 'binary_recall': 0.07880435, 'binary_specificity': 0.99789697, 'binary_f1_score': 0.13834228}
confusion matrix:
       0    1
0  42231   89
1   1356  116
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74700904, 'recall': 0.556447, 'specificity': 0.556447, 'f1': 0.5867781, 'auroc': 0.9473728, 'binary_precision': 0.5244755, 'binary_recall': 0.11664075, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.1908397}
confusion matrix:
       0   1
0  18081  68
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.9086162, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
better model found
persisted
after epoch: 6,now: 2024-05-27 23:12:11.122505,epoch time: 0:35:52.895307,used: 3:38:36.549819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7437464, 'recall': 0.7668556, 'specificity': 0.7668556, 'f1': 0.75471723, 'auroc': 0.9404005, 'binary_precision': 0.5030941, 'binary_recall': 0.55268526, 'binary_specificity': 0.981026, 'binary_f1_score': 0.526725}
confusion matrix:
       0    1
0  41518  803
1    658  813
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74549305, 'recall': 0.74107075, 'specificity': 0.74107075, 'f1': 0.7432595, 'auroc': 0.94762504, 'binary_precision': 0.50871634, 'binary_recall': 0.4992224, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.50392467}
confusion matrix:
       0    1
0  17839  310
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971077, 'precision': 0.8805165, 'recall': 0.70822674, 'specificity': 0.70822674, 'f1': 0.76684415, 'auroc': 0.90778816, 'binary_precision': 0.78571427, 'binary_recall': 0.42145595, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.5486284}
confusion matrix:
      0    1
0  5967   30
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-27 23:48:24.178809,epoch time: 0:36:13.056304,used: 4:14:49.606123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9677567, 'precision': 0.75681347, 'recall': 0.640049, 'specificity': 0.640049, 'f1': 0.6796123, 'auroc': 0.9460448, 'binary_precision': 0.53797466, 'binary_recall': 0.2887228, 'binary_specificity': 0.9913752, 'binary_f1_score': 0.37577364}
confusion matrix:
       0    1
0  41955  365
1   1047  425
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7631563, 'recall': 0.69700414, 'specificity': 0.69700414, 'f1': 0.7248359, 'auroc': 0.9498191, 'binary_precision': 0.5471698, 'binary_recall': 0.4059098, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.46607143}
confusion matrix:
       0    1
0  17933  216
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.88066745, 'recall': 0.5378973, 'specificity': 0.5378973, 'f1': 0.5598728, 'auroc': 0.9196998, 'binary_precision': 0.8, 'binary_recall': 0.07662835, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13986014}
confusion matrix:
      0   1
0  5992   5
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
better model found
persisted
after epoch: 8,now: 2024-05-28 00:24:41.994008,epoch time: 0:36:17.815199,used: 4:51:07.421322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.7615821, 'recall': 0.697194, 'specificity': 0.697194, 'f1': 0.7244109, 'auroc': 0.93778044, 'binary_precision': 0.5436364, 'binary_recall': 0.40625, 'binary_specificity': 0.988138, 'binary_f1_score': 0.46500778}
confusion matrix:
       0    1
0  41818  502
1    874  598
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7551346, 'recall': 0.6800622, 'specificity': 0.6800622, 'f1': 0.71045166, 'auroc': 0.9460259, 'binary_precision': 0.532294, 'binary_recall': 0.3716952, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.4377289}
confusion matrix:
       0    1
0  17939  210
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.91401833, 'recall': 0.5951184, 'specificity': 0.5951184, 'f1': 0.6477622, 'auroc': 0.90579855, 'binary_precision': 0.86206895, 'binary_recall': 0.19157088, 'binary_specificity': 0.998666, 'binary_f1_score': 0.3134796}
confusion matrix:
      0   1
0  5989   8
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 1
val acc:0.9673265218734741, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 9,now: 2024-05-28 01:00:48.079682,epoch time: 0:36:06.085674,used: 5:27:13.506996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9397093, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.94600725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89924556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 10,now: 2024-05-28 01:37:01.517065,epoch time: 0:36:13.437383,used: 6:03:26.944379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.7469629, 'recall': 0.7868797, 'specificity': 0.7868797, 'f1': 0.7652542, 'auroc': 0.94395554, 'binary_precision': 0.50813955, 'binary_recall': 0.59375, 'binary_specificity': 0.98000944, 'binary_f1_score': 0.54761904}
confusion matrix:
       0    1
0  41474  846
1    598  874
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7416469, 'recall': 0.7445456, 'specificity': 0.7445456, 'f1': 0.7430866, 'auroc': 0.94997275, 'binary_precision': 0.50076807, 'binary_recall': 0.5069984, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.503864}
confusion matrix:
       0    1
0  17824  325
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.9090643, 'recall': 0.67674357, 'specificity': 0.67674357, 'f1': 0.7430576, 'auroc': 0.912282, 'binary_precision': 0.8454546, 'binary_recall': 0.35632184, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5013478}
confusion matrix:
      0   1
0  5980  17
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 3
val acc:0.9658365249633789, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 11,now: 2024-05-28 02:12:58.091795,epoch time: 0:35:56.574730,used: 6:39:23.519109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.9425493, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9530489, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91513586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 12,now: 2024-05-28 02:48:50.776682,epoch time: 0:35:52.684887,used: 7:15:16.203996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.74405, 'recall': 0.53517544, 'specificity': 0.53517544, 'f1': 0.55524546, 'auroc': 0.92612714, 'binary_precision': 0.51941746, 'binary_recall': 0.07269022, 'binary_specificity': 0.9976607, 'binary_f1_score': 0.12753278}
confusion matrix:
       0    1
0  42221   99
1   1365  107
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7989834, 'recall': 0.5091384, 'specificity': 0.5091384, 'f1': 0.50948703, 'auroc': 0.94418466, 'binary_precision': 0.6315789, 'binary_recall': 0.01866252, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.036253776}
confusion matrix:
       0   1
0  18142   7
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.89179003, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 5
val acc:0.9660493731498718, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 13,now: 2024-05-28 03:25:05.355609,epoch time: 0:36:14.578927,used: 7:51:30.782923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96846455, 'precision': 0.75871813, 'recall': 0.7220522, 'specificity': 0.7220522, 'f1': 0.7388395, 'auroc': 0.9448521, 'binary_precision': 0.5361973, 'binary_recall': 0.45788044, 'binary_specificity': 0.986224, 'binary_f1_score': 0.49395385}
confusion matrix:
       0    1
0  41737  583
1    798  674
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7617731, 'recall': 0.65775335, 'specificity': 0.65775335, 'f1': 0.69560075, 'auroc': 0.95254004, 'binary_precision': 0.5471204, 'binary_recall': 0.32503888, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.4078049}
confusion matrix:
       0    1
0  17976  173
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.90966666, 'recall': 0.6197725, 'specificity': 0.6197725, 'f1': 0.67948073, 'auroc': 0.92421746, 'binary_precision': 0.8513514, 'binary_recall': 0.2413793, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3761194}
confusion matrix:
      0   1
0  5986  11
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 6
val acc:0.9676989912986755, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9606903195381165 / 0.971077024936676
after epoch: 14,now: 2024-05-28 04:01:17.510986,epoch time: 0:36:12.155377,used: 8:27:42.938300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96729994, 'precision': 0.7716452, 'recall': 0.55161864, 'specificity': 0.55161864, 'f1': 0.58110845, 'auroc': 0.93319744, 'binary_precision': 0.5735294, 'binary_recall': 0.10597826, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.17889908}
confusion matrix:
       0    1
0  42204  116
1   1316  156
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7917096, 'recall': 0.6048851, 'specificity': 0.6048851, 'f1': 0.6507275, 'auroc': 0.9477847, 'binary_precision': 0.6106195, 'binary_recall': 0.21461898, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.31760645}
confusion matrix:
       0    1
0  18061   88
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.98014414, 'recall': 0.5249042, 'specificity': 0.5249042, 'f1': 0.53731614, 'auroc': 0.89229065, 'binary_precision': 1.0, 'binary_recall': 0.049808428, 'binary_specificity': 1.0, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5997   0
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
better model found
persisted
after epoch: 15,now: 2024-05-28 04:37:33.050699,epoch time: 0:36:15.539713,used: 9:03:58.478013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96819055, 'precision': 0.7656512, 'recall': 0.62690824, 'specificity': 0.62690824, 'f1': 0.66954195, 'auroc': 0.945029, 'binary_precision': 0.5565217, 'binary_recall': 0.26104692, 'binary_specificity': 0.99276954, 'binary_f1_score': 0.355391}
confusion matrix:
       0    1
0  42015  306
1   1087  384
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7728249, 'recall': 0.59766626, 'specificity': 0.59766626, 'f1': 0.6403105, 'auroc': 0.95116186, 'binary_precision': 0.5733333, 'binary_recall': 0.20062208, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.297235}
confusion matrix:
       0    1
0  18053   96
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.9143325, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 1
val acc:0.967539370059967, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 16,now: 2024-05-28 05:13:50.957370,epoch time: 0:36:17.906671,used: 9:40:16.384684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96554166, 'precision': 0.7360265, 'recall': 0.75562084, 'specificity': 0.75562084, 'f1': 0.7453869, 'auroc': 0.9348448, 'binary_precision': 0.48843026, 'binary_recall': 0.5305706, 'binary_specificity': 0.98067105, 'binary_f1_score': 0.5086291}
confusion matrix:
       0    1
0  41502  818
1    691  781
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7391379, 'recall': 0.7301568, 'specificity': 0.7301568, 'f1': 0.73455137, 'auroc': 0.94549865, 'binary_precision': 0.49676377, 'binary_recall': 0.47744945, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.48691514}
confusion matrix:
       0    1
0  17838  311
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.85410035, 'recall': 0.61319166, 'specificity': 0.61319166, 'f1': 0.6663208, 'auroc': 0.8927607, 'binary_precision': 0.7407407, 'binary_recall': 0.22988506, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3508772}
confusion matrix:
      0   1
0  5976  21
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 2
val acc:0.9655704498291016, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 17,now: 2024-05-28 05:49:41.426702,epoch time: 0:35:50.469332,used: 10:16:06.854016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.9232497, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9405435, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8755163, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 18,now: 2024-05-28 06:25:55.866453,epoch time: 0:36:14.439751,used: 10:52:21.293767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.87617064, 'recall': 0.503701, 'specificity': 0.503701, 'f1': 0.4989005, 'auroc': 0.95012736, 'binary_precision': 0.78571427, 'binary_recall': 0.007472826, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.014804845}
confusion matrix:
       0   1
0  42317   3
1   1461  11
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9546125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91188544, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 19,now: 2024-05-28 07:02:05.438194,epoch time: 0:36:09.571741,used: 11:28:30.865508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96780235, 'precision': 0.7537734, 'recall': 0.6837951, 'specificity': 0.6837951, 'f1': 0.7126142, 'auroc': 0.9416902, 'binary_precision': 0.52891, 'binary_recall': 0.3793338, 'binary_specificity': 0.9882564, 'binary_f1_score': 0.44180524}
confusion matrix:
       0    1
0  41824  497
1    913  558
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.75382876, 'recall': 0.7416218, 'specificity': 0.7416218, 'f1': 0.74755806, 'auroc': 0.9508264, 'binary_precision': 0.5253683, 'binary_recall': 0.4992224, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.5119617}
confusion matrix:
       0    1
0  17859  290
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.92082787, 'recall': 0.54189545, 'specificity': 0.54189545, 'f1': 0.56702936, 'auroc': 0.906692, 'binary_precision': 0.88, 'binary_recall': 0.08429119, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.15384614}
confusion matrix:
      0   1
0  5994   3
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 5
val acc:0.967432975769043, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 20,now: 2024-05-28 07:38:09.846476,epoch time: 0:36:04.408282,used: 12:04:35.273790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.968122, 'precision': 0.78322774, 'recall': 0.5779873, 'specificity': 0.5779873, 'f1': 0.6177949, 'auroc': 0.9447063, 'binary_precision': 0.5949367, 'binary_recall': 0.15975527, 'binary_specificity': 0.9962194, 'binary_f1_score': 0.25187567}
confusion matrix:
       0    1
0  42161  160
1   1236  235
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.77977145, 'recall': 0.6106927, 'specificity': 0.6106927, 'f1': 0.655501, 'auroc': 0.9498202, 'binary_precision': 0.5863454, 'binary_recall': 0.22706065, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.32735425}
confusion matrix:
       0    1
0  18046  103
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.9165312, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 6
val acc:0.9680715203285217, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 21,now: 2024-05-28 08:14:19.081967,epoch time: 0:36:09.235491,used: 12:40:44.509281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.62366164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5032377, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5307504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 22,now: 2024-05-28 08:50:17.310554,epoch time: 0:35:58.228587,used: 13:16:42.737868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.79580134, 'recall': 0.5033258, 'specificity': 0.5033258, 'f1': 0.49819502, 'auroc': 0.8909238, 'binary_precision': 0.625, 'binary_recall': 0.006793478, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.0134408595}
confusion matrix:
       0   1
0  42314   6
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.81204426, 'recall': 0.51755434, 'specificity': 0.51755434, 'f1': 0.525361, 'auroc': 0.90623116, 'binary_precision': 0.6571429, 'binary_recall': 0.035769828, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.0678466}
confusion matrix:
       0   1
0  18137  12
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8485199, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 8
val acc:0.9663686752319336, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 23,now: 2024-05-28 09:26:12.672324,epoch time: 0:35:55.361770,used: 13:52:38.099638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9671858, 'precision': 0.8683554, 'recall': 0.5168065, 'specificity': 0.5168065, 'f1': 0.52418077, 'auroc': 0.9109772, 'binary_precision': 0.7692308, 'binary_recall': 0.03396739, 'binary_specificity': 0.99964553, 'binary_f1_score': 0.06506181}
confusion matrix:
       0   1
0  42305  15
1   1422  50
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.89221215, 'recall': 0.50694335, 'specificity': 0.50694335, 'f1': 0.50515056, 'auroc': 0.92466134, 'binary_precision': 0.8181818, 'binary_recall': 0.01399689, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.027522936}
confusion matrix:
       0  1
0  18147  2
1    634  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.87610716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 9
val acc:0.9661558270454407, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 24,now: 2024-05-28 10:02:11.247225,epoch time: 0:35:58.574901,used: 14:28:36.674539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.9149287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9312717, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.87064236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 25,now: 2024-05-28 10:39:22.506984,epoch time: 0:37:11.259759,used: 15:05:47.934298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.98328197, 'recall': 0.50237936, 'specificity': 0.50237936, 'f1': 0.49623495, 'auroc': 0.92433655, 'binary_precision': 1.0, 'binary_recall': 0.0047586677, 'binary_specificity': 1.0, 'binary_f1_score': 0.009472259}
confusion matrix:
       0  1
0  42321  0
1   1464  7
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.98291737, 'recall': 0.5007776, 'specificity': 0.5007776, 'f1': 0.49286303, 'auroc': 0.9361049, 'binary_precision': 1.0, 'binary_recall': 0.00155521, 'binary_specificity': 1.0, 'binary_f1_score': 0.0031055901}
confusion matrix:
       0  1
0  18149  0
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8604007, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 11
val acc:0.9658365249633789, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 26,now: 2024-05-28 11:16:16.748858,epoch time: 0:36:54.241874,used: 15:42:42.176172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.6482493, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6459129, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6380836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 27,now: 2024-05-28 11:52:41.012840,epoch time: 0:36:24.263982,used: 16:19:06.440154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.78200805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8152739, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6966517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 28,now: 2024-05-28 12:28:46.808787,epoch time: 0:36:05.795947,used: 16:55:12.236101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.8844944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.90200305, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.83999836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 29,now: 2024-05-28 13:06:35.967653,epoch time: 0:37:49.158866,used: 17:33:01.394967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.91023076, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.92184246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.87572587, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897893.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.9603707194328308 / 0.971077024936676
after epoch: 30,now: 2024-05-28 13:43:48.503749,epoch time: 0:37:12.536096,used: 18:10:13.931063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_34_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:10:13.931063 at 2024-05-28 13:43:48.503749
persisted model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.8977744, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
oracle model performance metric: 

scalar performance:
{'acc': 0.9755513, 'precision': 0.9264598, 'recall': 0.73987854, 'specificity': 0.73987854, 'f1': 0.80479455, 'auroc': 0.9056095, 'binary_precision': 0.875, 'binary_recall': 0.4827586, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.62222224}
confusion matrix:
      0    1
0  5979   18
1   135  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   3518 MiB |   3518 MiB |      0 B   |
|       from large pool |   3506 MiB |   3506 MiB |   3506 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258190 KiB | 316551 KiB | 479310 GiB | 479310 GiB |
|       from large pool | 254640 KiB | 313088 KiB | 467815 GiB | 467815 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140835 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140835 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     140    |       0    |
|       from large pool |     134    |     134    |     134    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |    2824    |   71405 K  |   71405 K  |
|       from large pool |      78    |     119    |   33483 K  |   33483 K  |
|       from small pool |      18    |    2746    |   37921 K  |   37921 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479312 GiB | 479312 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467816 GiB | 467816 GiB |
|       from small pool |      0 KiB |   9144 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71406 K  |   71406 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   37923 K  |   37923 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479312 GiB | 479312 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467816 GiB | 467816 GiB |
|       from small pool |      0 KiB |   9144 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140835 K  |  140835 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71406 K  |   71406 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   37923 K  |   37923 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893

 Experiment start at: 2024-05-28 13:53:36.797110
before training, model accuracy: 0.9934555292129517
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.7502835, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.76035947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.51485837, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 14:31:59.002601,epoch time: 0:38:22.205491,used: 0:38:22.205491,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9539443, 'precision': 0.74748075, 'recall': 0.6923225, 'specificity': 0.6923225, 'f1': 0.7158985, 'auroc': 0.9019762, 'binary_precision': 0.52462864, 'binary_recall': 0.403003, 'binary_specificity': 0.98164195, 'binary_f1_score': 0.4558424}
confusion matrix:
       0    1
0  32511  608
1    994  671
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.76421714, 'recall': 0.6740346, 'specificity': 0.6740346, 'f1': 0.70848346, 'auroc': 0.9050935, 'binary_precision': 0.56050956, 'binary_recall': 0.36263737, 'binary_specificity': 0.9854318, 'binary_f1_score': 0.44036698}
confusion matrix:
       0    1
0  14002  207
1    464  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.6228714, 'recall': 0.521763, 'specificity': 0.521763, 'f1': 0.5362861, 'auroc': 0.76041114, 'binary_precision': 0.25, 'binary_recall': 0.04411765, 'binary_specificity': 0.99940836, 'binary_f1_score': 0.074999996}
confusion matrix:
       0  1
0  15203  9
1     65  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
better model found
persisted
after epoch: 2,now: 2024-05-28 15:08:23.485620,epoch time: 0:36:24.483019,used: 1:14:46.688510,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95472056, 'precision': 0.7516534, 'recall': 0.74777436, 'specificity': 0.74777436, 'f1': 0.74969625, 'auroc': 0.9222468, 'binary_precision': 0.52747256, 'binary_recall': 0.51891893, 'binary_specificity': 0.97662973, 'binary_f1_score': 0.52316076}
confusion matrix:
       0    1
0  32345  774
1    801  864
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.74762917, 'recall': 0.7440763, 'specificity': 0.7440763, 'f1': 0.7458377, 'auroc': 0.9279139, 'binary_precision': 0.52022314, 'binary_recall': 0.51236266, 'binary_specificity': 0.97578996, 'binary_f1_score': 0.51626295}
confusion matrix:
       0    1
0  13865  344
1    355  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937827, 'precision': 0.62983817, 'recall': 0.6089136, 'specificity': 0.6089136, 'f1': 0.61843926, 'auroc': 0.8283331, 'binary_precision': 0.2631579, 'binary_recall': 0.22058824, 'binary_specificity': 0.997239, 'binary_f1_score': 0.24}
confusion matrix:
       0   1
0  15170  42
1     53  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 1
val acc:0.9532034397125244, best validation acc: 0.9550780057907104, corresponding to test acc:                         0.9951570630073547 / 0.995549738407135
after epoch: 3,now: 2024-05-28 15:43:42.138770,epoch time: 0:35:18.653150,used: 1:50:05.341660,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95699173, 'precision': 0.7831503, 'recall': 0.646579, 'specificity': 0.646579, 'f1': 0.69036245, 'auroc': 0.93425107, 'binary_precision': 0.6004756, 'binary_recall': 0.3033033, 'binary_specificity': 0.98985475, 'binary_f1_score': 0.40303272}
confusion matrix:
       0    1
0  32783  336
1   1160  505
---- Validation: 
scalar performance:
{'acc': 0.9548102, 'precision': 0.7893681, 'recall': 0.5917892, 'specificity': 0.5917892, 'f1': 0.6334415, 'auroc': 0.9353842, 'binary_precision': 0.6188341, 'binary_recall': 0.18956044, 'binary_specificity': 0.9940179, 'binary_f1_score': 0.29022083}
confusion matrix:
       0    1
0  14124   85
1    590  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99443716, 'precision': 0.6192445, 'recall': 0.5580018, 'specificity': 0.5580018, 'f1': 0.5778126, 'auroc': 0.82996905, 'binary_precision': 0.24242425, 'binary_recall': 0.11764706, 'binary_specificity': 0.9983566, 'binary_f1_score': 0.15841585}
confusion matrix:
       0   1
0  15187  25
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 2
val acc:0.9548102021217346, best validation acc: 0.9550780057907104, corresponding to test acc:                         0.9951570630073547 / 0.995549738407135
after epoch: 4,now: 2024-05-28 16:18:18.984787,epoch time: 0:34:36.846017,used: 2:24:42.187677,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95575553, 'precision': 0.7676228, 'recall': 0.6499227, 'specificity': 0.6499227, 'f1': 0.6899104, 'auroc': 0.9323018, 'binary_precision': 0.5690789, 'binary_recall': 0.3117117, 'binary_specificity': 0.9881337, 'binary_f1_score': 0.40279394}
confusion matrix:
       0    1
0  32726  393
1   1146  519
---- Validation: 
scalar performance:
{'acc': 0.9564839, 'precision': 0.7883842, 'recall': 0.6415407, 'specificity': 0.6415407, 'f1': 0.6866699, 'auroc': 0.9322753, 'binary_precision': 0.61206895, 'binary_recall': 0.29258242, 'binary_specificity': 0.99049896, 'binary_f1_score': 0.39591077}
confusion matrix:
       0    1
0  14074  135
1    515  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.64806557, 'recall': 0.5654862, 'specificity': 0.5654862, 'f1': 0.5905236, 'auroc': 0.842283, 'binary_precision': 0.3, 'binary_recall': 0.13235295, 'binary_specificity': 0.9986195, 'binary_f1_score': 0.18367349}
confusion matrix:
       0   1
0  15191  21
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
better model found
persisted
after epoch: 5,now: 2024-05-28 16:52:38.102186,epoch time: 0:34:19.117399,used: 2:59:01.305076,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95572674, 'precision': 0.7564235, 'recall': 0.8156107, 'specificity': 0.8156107, 'f1': 0.7824205, 'auroc': 0.94354427, 'binary_precision': 0.5301205, 'binary_recall': 0.6606607, 'binary_specificity': 0.9705607, 'binary_f1_score': 0.5882353}
confusion matrix:
       0     1
0  32144   975
1    565  1100
---- Validation: 
scalar performance:
{'acc': 0.95460933, 'precision': 0.7548446, 'recall': 0.80280983, 'specificity': 0.80280983, 'f1': 0.77639884, 'auroc': 0.94527376, 'binary_precision': 0.5286041, 'binary_recall': 0.63461536, 'binary_specificity': 0.9710043, 'binary_f1_score': 0.576779}
confusion matrix:
       0    1
0  13797  412
1    266  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9928665, 'precision': 0.5904674, 'recall': 0.58649325, 'specificity': 0.58649325, 'f1': 0.5884344, 'auroc': 0.8470374, 'binary_precision': 0.18461539, 'binary_recall': 0.1764706, 'binary_specificity': 0.9965159, 'binary_f1_score': 0.18045114}
confusion matrix:
       0   1
0  15159  53
1     56  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 1
val acc:0.9546093344688416, best validation acc: 0.9564839005470276, corresponding to test acc:                         0.9947643876075745 / 0.995549738407135
after epoch: 6,now: 2024-05-28 17:27:30.325456,epoch time: 0:34:52.223270,used: 3:33:53.528346,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9595791, 'precision': 0.7858818, 'recall': 0.7295059, 'specificity': 0.7295059, 'f1': 0.75416684, 'auroc': 0.9477215, 'binary_precision': 0.5978836, 'binary_recall': 0.47507507, 'binary_specificity': 0.9839367, 'binary_f1_score': 0.52945113}
confusion matrix:
       0    1
0  32587  532
1    874  791
---- Validation: 
scalar performance:
{'acc': 0.958894, 'precision': 0.7839482, 'recall': 0.7398995, 'specificity': 0.7398995, 'f1': 0.7597947, 'auroc': 0.94645923, 'binary_precision': 0.5934426, 'binary_recall': 0.49725273, 'binary_specificity': 0.98254627, 'binary_f1_score': 0.5411061}
confusion matrix:
       0    1
0  13961  248
1    366  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942408, 'precision': 0.60094064, 'recall': 0.5505831, 'specificity': 0.5505831, 'f1': 0.56718284, 'auroc': 0.86095583, 'binary_precision': 0.20588236, 'binary_recall': 0.10294118, 'binary_specificity': 0.9982251, 'binary_f1_score': 0.13725491}
confusion matrix:
       0   1
0  15185  27
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
better model found
persisted
after epoch: 7,now: 2024-05-28 18:03:02.693617,epoch time: 0:35:32.368161,used: 4:09:25.896507,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95630175, 'precision': 0.797469, 'recall': 0.600299, 'specificity': 0.600299, 'f1': 0.64451444, 'auroc': 0.9368887, 'binary_precision': 0.6335175, 'binary_recall': 0.20660661, 'binary_specificity': 0.9939914, 'binary_f1_score': 0.31159422}
confusion matrix:
       0    1
0  32920  199
1   1321  344
---- Validation: 
scalar performance:
{'acc': 0.9564839, 'precision': 0.82477015, 'recall': 0.5952754, 'specificity': 0.5952754, 'f1': 0.6408041, 'auroc': 0.94466645, 'binary_precision': 0.6893204, 'binary_recall': 0.19505495, 'binary_specificity': 0.9954958, 'binary_f1_score': 0.30406854}
confusion matrix:
       0    1
0  14145   64
1    586  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9948953, 'precision': 0.5692669, 'recall': 0.51431143, 'specificity': 0.51431143, 'f1': 0.5231106, 'auroc': 0.86819375, 'binary_precision': 0.14285715, 'binary_recall': 0.029411765, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.04878049}
confusion matrix:
       0   1
0  15200  12
1     66   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 1
val acc:0.9564839005470276, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 8,now: 2024-05-28 18:37:52.355123,epoch time: 0:34:49.661506,used: 4:44:15.558013,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95877415, 'precision': 0.77208173, 'recall': 0.7952503, 'specificity': 0.7952503, 'f1': 0.78311634, 'auroc': 0.94352716, 'binary_precision': 0.56363636, 'binary_recall': 0.6144144, 'binary_specificity': 0.97608626, 'binary_f1_score': 0.58793104}
confusion matrix:
       0     1
0  32327   792
1    642  1023
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.7635247, 'recall': 0.77892786, 'specificity': 0.77892786, 'f1': 0.77097094, 'auroc': 0.94536227, 'binary_precision': 0.5485123, 'binary_recall': 0.5824176, 'binary_specificity': 0.9754381, 'binary_f1_score': 0.5649567}
confusion matrix:
       0    1
0  13860  349
1    304  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9928011, 'precision': 0.57306176, 'recall': 0.56450015, 'specificity': 0.56450015, 'f1': 0.56850517, 'auroc': 0.85163975, 'binary_precision': 0.15, 'binary_recall': 0.13235295, 'binary_specificity': 0.99664736, 'binary_f1_score': 0.14062501}
confusion matrix:
       0   1
0  15161  51
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 2
val acc:0.9562830328941345, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 9,now: 2024-05-28 19:12:14.813346,epoch time: 0:34:22.458223,used: 5:18:38.016236,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95771044, 'precision': 0.79045963, 'recall': 0.6512345, 'specificity': 0.6512345, 'f1': 0.6961205, 'auroc': 0.9341004, 'binary_precision': 0.6146572, 'binary_recall': 0.3123123, 'binary_specificity': 0.9901567, 'binary_f1_score': 0.41417763}
confusion matrix:
       0    1
0  32793  326
1   1145  520
---- Validation: 
scalar performance:
{'acc': 0.9572203, 'precision': 0.7940723, 'recall': 0.6503989, 'specificity': 0.6503989, 'f1': 0.6960491, 'auroc': 0.93568695, 'binary_precision': 0.6225895, 'binary_recall': 0.31043956, 'binary_specificity': 0.99035823, 'binary_f1_score': 0.41429883}
confusion matrix:
       0    1
0  14072  137
1    502  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.676508, 'recall': 0.53646886, 'specificity': 0.53646886, 'f1': 0.5597944, 'auroc': 0.8242687, 'binary_precision': 0.35714287, 'binary_recall': 0.073529415, 'binary_specificity': 0.99940836, 'binary_f1_score': 0.12195122}
confusion matrix:
       0  1
0  15203  9
1     63  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 3
val acc:0.9572203159332275, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 10,now: 2024-05-28 19:46:36.265815,epoch time: 0:34:21.452469,used: 5:52:59.468705,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9530819, 'precision': 0.85766673, 'recall': 0.51418793, 'specificity': 0.51418793, 'f1': 0.51574945, 'auroc': 0.9393491, 'binary_precision': 0.7619048, 'binary_recall': 0.02882883, 'binary_specificity': 0.99954706, 'binary_f1_score': 0.05555556}
confusion matrix:
       0   1
0  33104  15
1   1617  48
---- Validation: 
scalar performance:
{'acc': 0.95206535, 'precision': 0.94032943, 'recall': 0.5088934, 'specificity': 0.5088934, 'f1': 0.5052313, 'auroc': 0.9415513, 'binary_precision': 0.9285714, 'binary_recall': 0.017857144, 'binary_specificity': 0.9999296, 'binary_f1_score': 0.03504043}
confusion matrix:
       0   1
0  14208   1
1    715  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.497774, 'recall': 0.4998028, 'specificity': 0.4998028, 'f1': 0.4987863, 'auroc': 0.8284534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996056, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15206  6
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 4
val acc:0.9520653486251831, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 11,now: 2024-05-28 20:20:47.045896,epoch time: 0:34:10.780081,used: 6:27:10.248786,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95558304, 'precision': 0.80350065, 'recall': 0.5768201, 'specificity': 0.5768201, 'f1': 0.6155468, 'auroc': 0.94556415, 'binary_precision': 0.6477833, 'binary_recall': 0.15795796, 'binary_specificity': 0.99568224, 'binary_f1_score': 0.2539836}
confusion matrix:
       0    1
0  32976  143
1   1402  263
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.8080936, 'recall': 0.5795491, 'specificity': 0.5795491, 'f1': 0.61933017, 'auroc': 0.94578743, 'binary_precision': 0.65745854, 'binary_recall': 0.16346154, 'binary_specificity': 0.9956366, 'binary_f1_score': 0.2618262}
confusion matrix:
       0    1
0  14147   62
1    609  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.6978396, 'recall': 0.51460725, 'specificity': 0.51460725, 'f1': 0.5262656, 'auroc': 0.8770577, 'binary_precision': 0.4, 'binary_recall': 0.029411765, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.05479452}
confusion matrix:
       0  1
0  15209  3
1     66  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 5
val acc:0.9550780057907104, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 12,now: 2024-05-28 20:55:08.423292,epoch time: 0:34:21.377396,used: 7:01:31.626182,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9534556, 'precision': 0.82629263, 'recall': 0.5237959, 'specificity': 0.5237959, 'f1': 0.5335382, 'auroc': 0.93737423, 'binary_precision': 0.69827586, 'binary_recall': 0.048648648, 'binary_specificity': 0.9989432, 'binary_f1_score': 0.09096014}
confusion matrix:
       0   1
0  33084  35
1   1584  81
---- Validation: 
scalar performance:
{'acc': 0.9536721, 'precision': 0.85232925, 'recall': 0.5364545, 'specificity': 0.5364545, 'f1': 0.55559933, 'auroc': 0.94439673, 'binary_precision': 0.75, 'binary_recall': 0.07417583, 'binary_specificity': 0.9987332, 'binary_f1_score': 0.135}
confusion matrix:
       0   1
0  14191  18
1    674  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99541885, 'precision': 0.49777457, 'recall': 0.49993426, 'specificity': 0.49993426, 'f1': 0.4988521, 'auroc': 0.829244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998685, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15210  2
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 6
val acc:0.9536721110343933, best validation acc: 0.9588940143585205, corresponding to test acc:                         0.9942408204078674 / 0.995549738407135
after epoch: 13,now: 2024-05-28 21:29:33.884112,epoch time: 0:34:25.460820,used: 7:35:57.087002,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9597229, 'precision': 0.7885035, 'recall': 0.72302175, 'specificity': 0.72302175, 'f1': 0.75097823, 'auroc': 0.94642687, 'binary_precision': 0.6037736, 'binary_recall': 0.46126127, 'binary_specificity': 0.98478216, 'binary_f1_score': 0.52298266}
confusion matrix:
       0    1
0  32615  504
1    897  768
---- Validation: 
scalar performance:
{'acc': 0.9596304, 'precision': 0.7944089, 'recall': 0.7200862, 'specificity': 0.7200862, 'f1': 0.7511214, 'auroc': 0.9468976, 'binary_precision': 0.6163873, 'binary_recall': 0.45467034, 'binary_specificity': 0.9855021, 'binary_f1_score': 0.52332014}
confusion matrix:
       0    1
0  14003  206
1    397  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941754, 'precision': 0.5888759, 'recall': 0.5432302, 'specificity': 0.5432302, 'f1': 0.55794495, 'auroc': 0.88607895, 'binary_precision': 0.18181819, 'binary_recall': 0.0882353, 'binary_specificity': 0.9982251, 'binary_f1_score': 0.11881189}
confusion matrix:
       0   1
0  15185  27
1     62   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
better model found
persisted
after epoch: 14,now: 2024-05-28 22:04:07.012766,epoch time: 0:34:33.128654,used: 8:10:30.215656,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9606428, 'precision': 0.7974882, 'recall': 0.719512, 'specificity': 0.719512, 'f1': 0.7518148, 'auroc': 0.94343853, 'binary_precision': 0.6221122, 'binary_recall': 0.45285285, 'binary_specificity': 0.98617107, 'binary_f1_score': 0.5241571}
confusion matrix:
       0    1
0  32661  458
1    911  754
---- Validation: 
scalar performance:
{'acc': 0.9593627, 'precision': 0.7939452, 'recall': 0.7134292, 'specificity': 0.7134292, 'f1': 0.746403, 'auroc': 0.94191504, 'binary_precision': 0.61612284, 'binary_recall': 0.44093406, 'binary_specificity': 0.9859244, 'binary_f1_score': 0.5140112}
confusion matrix:
       0    1
0  14009  200
1    407  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99482983, 'precision': 0.63800067, 'recall': 0.55087894, 'specificity': 0.55087894, 'f1': 0.57397234, 'auroc': 0.8848742, 'binary_precision': 0.28, 'binary_recall': 0.10294118, 'binary_specificity': 0.9988167, 'binary_f1_score': 0.15053764}
confusion matrix:
       0   1
0  15194  18
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 1
val acc:0.9593626856803894, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 15,now: 2024-05-28 22:38:47.894788,epoch time: 0:34:40.882022,used: 8:45:11.097678,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96018285, 'precision': 0.78427905, 'recall': 0.7626213, 'specificity': 0.7626213, 'f1': 0.77295697, 'auroc': 0.9466949, 'binary_precision': 0.5913838, 'binary_recall': 0.54414415, 'binary_specificity': 0.9810985, 'binary_f1_score': 0.5667814}
confusion matrix:
       0    1
0  32493  626
1    759  906
---- Validation: 
scalar performance:
{'acc': 0.9586932, 'precision': 0.7791047, 'recall': 0.7619492, 'specificity': 0.7619492, 'f1': 0.77021253, 'auroc': 0.9515008, 'binary_precision': 0.5814978, 'binary_recall': 0.54395604, 'binary_specificity': 0.97994226, 'binary_f1_score': 0.56210077}
confusion matrix:
       0    1
0  13924  285
1    332  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99430627, 'precision': 0.62630236, 'recall': 0.5725762, 'specificity': 0.5725762, 'f1': 0.5920295, 'auroc': 0.8741473, 'binary_precision': 0.25641027, 'binary_recall': 0.14705883, 'binary_specificity': 0.9980936, 'binary_f1_score': 0.1869159}
confusion matrix:
       0   1
0  15183  29
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 2
val acc:0.9586932063102722, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 16,now: 2024-05-28 23:13:18.651524,epoch time: 0:34:30.756736,used: 9:19:41.854414,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.6438549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.6816685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.49408242, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 3
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 17,now: 2024-05-28 23:47:49.485355,epoch time: 0:34:30.833831,used: 9:54:12.688245,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8090849, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.818258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.69300526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 4
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 18,now: 2024-05-29 00:22:19.463407,epoch time: 0:34:29.978052,used: 10:28:42.666297,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.74772143, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7954673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5346246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 5
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 19,now: 2024-05-29 00:56:54.322614,epoch time: 0:34:34.859207,used: 11:03:17.525504,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9525644, 'precision': 0.8335451, 'recall': 0.5073565, 'specificity': 0.5073565, 'f1': 0.5025499, 'auroc': 0.8925932, 'binary_precision': 0.71428573, 'binary_recall': 0.015015015, 'binary_specificity': 0.99969804, 'binary_f1_score': 0.029411765}
confusion matrix:
       0   1
0  33109  10
1   1640  25
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.90177536, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.49777472, 'recall': 0.49996713, 'specificity': 0.49996713, 'f1': 0.49886853, 'auroc': 0.7590902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15211  1
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 6
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 20,now: 2024-05-29 01:31:16.220751,epoch time: 0:34:21.898137,used: 11:37:39.423641,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.90436554, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.9123578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.49777472, 'recall': 0.49996713, 'specificity': 0.49996713, 'f1': 0.49886853, 'auroc': 0.82305205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15211  1
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 7
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 21,now: 2024-05-29 02:05:47.109322,epoch time: 0:34:30.888571,used: 12:12:10.312212,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95417434, 'precision': 0.7486704, 'recall': 0.7549027, 'specificity': 0.7549027, 'f1': 0.75174147, 'auroc': 0.91385925, 'binary_precision': 0.5207724, 'binary_recall': 0.5345345, 'binary_specificity': 0.975271, 'binary_f1_score': 0.52756375}
confusion matrix:
       0    1
0  32300  819
1    775  890
---- Validation: 
scalar performance:
{'acc': 0.9571534, 'precision': 0.77840656, 'recall': 0.69728065, 'specificity': 0.69728065, 'f1': 0.72992635, 'auroc': 0.9229328, 'binary_precision': 0.5866142, 'binary_recall': 0.40934065, 'binary_specificity': 0.9852206, 'binary_f1_score': 0.48220062}
confusion matrix:
       0    1
0  13999  210
1    430  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99339, 'precision': 0.5862982, 'recall': 0.564796, 'specificity': 0.564796, 'f1': 0.5739713, 'auroc': 0.8047739, 'binary_precision': 0.1764706, 'binary_recall': 0.13235295, 'binary_specificity': 0.997239, 'binary_f1_score': 0.15126051}
confusion matrix:
       0   1
0  15170  42
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 8
val acc:0.9571533799171448, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 22,now: 2024-05-29 02:40:16.224776,epoch time: 0:34:29.115454,used: 12:46:39.427666,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9535131, 'precision': 0.7455274, 'recall': 0.7679601, 'specificity': 0.7679601, 'f1': 0.7561687, 'auroc': 0.91559863, 'binary_precision': 0.5131435, 'binary_recall': 0.56276274, 'binary_specificity': 0.9731574, 'binary_f1_score': 0.5368089}
confusion matrix:
       0    1
0  32230  889
1    728  937
---- Validation: 
scalar performance:
{'acc': 0.95655084, 'precision': 0.76751435, 'recall': 0.741926, 'specificity': 0.741926, 'f1': 0.75397563, 'auroc': 0.92882323, 'binary_precision': 0.56030536, 'binary_recall': 0.5041209, 'binary_specificity': 0.97973114, 'binary_f1_score': 0.53073037}
confusion matrix:
       0    1
0  13921  288
1    361  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99384815, 'precision': 0.61271226, 'recall': 0.5796662, 'specificity': 0.5796662, 'f1': 0.5932838, 'auroc': 0.80326414, 'binary_precision': 0.22916667, 'binary_recall': 0.16176471, 'binary_specificity': 0.9975677, 'binary_f1_score': 0.18965518}
confusion matrix:
       0   1
0  15175  37
1     57  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 9
val acc:0.9565508365631104, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 23,now: 2024-05-29 03:14:37.578132,epoch time: 0:34:21.353356,used: 13:21:00.781022,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9530531, 'precision': 0.7421065, 'recall': 0.6091455, 'specificity': 0.6091455, 'f1': 0.6469263, 'auroc': 0.91798174, 'binary_precision': 0.5219178, 'binary_recall': 0.22882883, 'binary_specificity': 0.98946226, 'binary_f1_score': 0.31816286}
confusion matrix:
       0    1
0  32770  349
1   1284  381
---- Validation: 
scalar performance:
{'acc': 0.9524001, 'precision': 0.7515069, 'recall': 0.5670639, 'specificity': 0.5670639, 'f1': 0.5991995, 'auroc': 0.9202563, 'binary_precision': 0.54545456, 'binary_recall': 0.1401099, 'binary_specificity': 0.9940179, 'binary_f1_score': 0.22295083}
confusion matrix:
       0    1
0  14124   85
1    626  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.6730013, 'recall': 0.5510433, 'specificity': 0.5510433, 'f1': 0.57833123, 'auroc': 0.81953275, 'binary_precision': 0.35, 'binary_recall': 0.10294118, 'binary_specificity': 0.9991454, 'binary_f1_score': 0.15909092}
confusion matrix:
       0   1
0  15199  13
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 10
val acc:0.9524000883102417, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 24,now: 2024-05-29 03:48:59.792302,epoch time: 0:34:22.214170,used: 13:55:22.995192,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9523057, 'precision': 0.81996375, 'recall': 0.50322783, 'specificity': 0.50322783, 'f1': 0.49432492, 'auroc': 0.91887283, 'binary_precision': 0.6875, 'binary_recall': 0.0066066068, 'binary_specificity': 0.999849, 'binary_f1_score': 0.013087449}
confusion matrix:
       0   1
0  33114   5
1   1654  11
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.92787194, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8481252, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 11
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 25,now: 2024-05-29 04:23:18.228795,epoch time: 0:34:18.436493,used: 14:29:41.431685,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95449054, 'precision': 0.80070484, 'recall': 0.55343014, 'specificity': 0.55343014, 'f1': 0.582189, 'auroc': 0.919196, 'binary_precision': 0.6443662, 'binary_recall': 0.10990991, 'binary_specificity': 0.9969504, 'binary_f1_score': 0.18778862}
confusion matrix:
       0    1
0  33018  101
1   1482  183
---- Validation: 
scalar performance:
{'acc': 0.95233315, 'precision': 0.8317381, 'recall': 0.5181569, 'specificity': 0.5181569, 'f1': 0.52301776, 'auroc': 0.92762786, 'binary_precision': 0.7105263, 'binary_recall': 0.037087914, 'binary_specificity': 0.99922585, 'binary_f1_score': 0.07049609}
confusion matrix:
       0   1
0  14198  11
1    701  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99456805, 'precision': 0.4977727, 'recall': 0.49950698, 'specificity': 0.49950698, 'f1': 0.49863836, 'auroc': 0.8347659, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99901396, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15197  15
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 12
val acc:0.9523331522941589, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 26,now: 2024-05-29 04:57:36.650965,epoch time: 0:34:18.422170,used: 15:03:59.853855,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.912243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.92604035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.80507064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 13
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 27,now: 2024-05-29 05:32:04.908342,epoch time: 0:34:28.257377,used: 15:38:28.111232,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9522194, 'precision': 0.8761207, 'recall': 0.5011861, 'specificity': 0.5011861, 'f1': 0.49015623, 'auroc': 0.9224511, 'binary_precision': 0.8, 'binary_recall': 0.0024024025, 'binary_specificity': 0.9999698, 'binary_f1_score': 0.0047904192}
confusion matrix:
       0  1
0  33118  1
1   1661  4
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.92785347, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8413327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 14
val acc:0.9512619376182556, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 28,now: 2024-05-29 06:06:43.300886,epoch time: 0:34:38.392544,used: 16:13:06.503776,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9528806, 'precision': 0.76474726, 'recall': 0.52891284, 'specificity': 0.52891284, 'f1': 0.5422777, 'auroc': 0.923182, 'binary_precision': 0.57471263, 'binary_recall': 0.06006006, 'binary_specificity': 0.99776566, 'binary_f1_score': 0.10875476}
confusion matrix:
       0    1
0  33045   74
1   1565  100
---- Validation: 
scalar performance:
{'acc': 0.95132893, 'precision': 0.73470736, 'recall': 0.50980955, 'specificity': 0.50980955, 'f1': 0.50733095, 'auroc': 0.9283213, 'binary_precision': 0.51724136, 'binary_recall': 0.020604396, 'binary_specificity': 0.99901474, 'binary_f1_score': 0.03963012}
confusion matrix:
       0   1
0  14195  14
1    713  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99358636, 'precision': 0.4977705, 'recall': 0.49901393, 'specificity': 0.49901393, 'f1': 0.49839142, 'auroc': 0.82968986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99802786, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15182  30
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 15
val acc:0.9513289332389832, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 29,now: 2024-05-29 06:41:12.418106,epoch time: 0:34:29.117220,used: 16:47:35.620996,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95529556, 'precision': 0.75762117, 'recall': 0.69160604, 'specificity': 0.69160604, 'f1': 0.7190293, 'auroc': 0.92271256, 'binary_precision': 0.5450082, 'binary_recall': 0.4, 'binary_specificity': 0.98321205, 'binary_f1_score': 0.4613786}
confusion matrix:
       0    1
0  32563  556
1    999  666
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.77094215, 'recall': 0.6408017, 'specificity': 0.6408017, 'f1': 0.68250734, 'auroc': 0.9326093, 'binary_precision': 0.57723576, 'binary_recall': 0.29258242, 'binary_specificity': 0.98902106, 'binary_f1_score': 0.3883318}
confusion matrix:
       0    1
0  14053  156
1    515  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9945026, 'precision': 0.5255828, 'recall': 0.50679415, 'specificity': 0.50679415, 'f1': 0.5102497, 'auroc': 0.81361556, 'binary_precision': 0.055555556, 'binary_recall': 0.014705882, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.023255814}
confusion matrix:
       0   1
0  15195  17
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897893.png
early stop counter: 16
val acc:0.9550780057907104, best validation acc: 0.9596304297447205, corresponding to test acc:                         0.994175374507904 / 0.995549738407135
after epoch: 30,now: 2024-05-29 07:15:49.658324,epoch time: 0:34:37.240218,used: 17:22:12.861214,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_13_53_36_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:22:12.861214 at 2024-05-29 07:15:49.658324
persisted model performance metric: 

scalar performance:
{'acc': 0.99482983, 'precision': 0.6695919, 'recall': 0.5874793, 'specificity': 0.5874793, 'f1': 0.61520797, 'auroc': 0.88567823, 'binary_precision': 0.34285715, 'binary_recall': 0.1764706, 'binary_specificity': 0.998488, 'binary_f1_score': 0.23300971}
confusion matrix:
       0   1
0  15189  23
1     56  12
oracle model performance metric: 

scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5138221, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1671 MiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      8 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1671 MiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      8 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1580 TiB |   1580 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1558 TiB |   1558 TiB |
|       from small pool |      5 MiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3500 MiB |   3518 MiB |   5096 MiB |   1596 MiB |
|       from large pool |   3488 MiB |   3506 MiB |   5082 MiB |   1594 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 220117 KiB | 316551 KiB |    895 TiB |    895 TiB |
|       from large pool | 216208 KiB | 313088 KiB |    873 TiB |    873 TiB |
|       from small pool |   3909 KiB |   9144 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6744    |    7065    |  267927 K  |  267920 K  |
|       from large pool |     247    |     352    |  102941 K  |  102941 K  |
|       from small pool |    6497    |    6719    |  164986 K  |  164979 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6744    |    7065    |  267927 K  |  267920 K  |
|       from large pool |     247    |     352    |  102941 K  |  102941 K  |
|       from small pool |    6497    |    6719    |  164986 K  |  164979 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     187    |      47    |
|       from large pool |     134    |     134    |     180    |      46    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |    2824    |  142377 K  |  142377 K  |
|       from large pool |      76    |     119    |   64130 K  |   64130 K  |
|       from small pool |      17    |    2746    |   78246 K  |   78246 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1580 TiB |   1580 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1558 TiB |   1558 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |   3518 MiB |   5096 MiB |   3210 MiB |
|       from large pool |   1874 MiB |   3506 MiB |   5082 MiB |   3208 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    895 TiB |    895 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    873 TiB |    873 TiB |
|       from small pool |      0 KiB |  10285 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7065    |  267927 K  |  267927 K  |
|       from large pool |       2    |     352    |  102941 K  |  102941 K  |
|       from small pool |       0    |    6719    |  164986 K  |  164986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7065    |  267927 K  |  267927 K  |
|       from large pool |       2    |     352    |  102941 K  |  102941 K  |
|       from small pool |       0    |    6719    |  164986 K  |  164986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     187    |      94    |
|       from large pool |      87    |     134    |     180    |      93    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |  142380 K  |  142380 K  |
|       from large pool |       3    |     119    |   64130 K  |   64130 K  |
|       from small pool |       0    |    2746    |   78249 K  |   78249 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1581 TiB |   1581 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1559 TiB |   1559 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1580 TiB |   1580 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1558 TiB |   1558 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |   3518 MiB |   5096 MiB |   3210 MiB |
|       from large pool |   1874 MiB |   3506 MiB |   5082 MiB |   3208 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    895 TiB |    895 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    873 TiB |    873 TiB |
|       from small pool |      0 KiB |  10285 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7065    |  267927 K  |  267927 K  |
|       from large pool |       2    |     352    |  102941 K  |  102941 K  |
|       from small pool |       0    |    6719    |  164986 K  |  164986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7065    |  267927 K  |  267927 K  |
|       from large pool |       2    |     352    |  102941 K  |  102941 K  |
|       from small pool |       0    |    6719    |  164986 K  |  164986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     187    |      94    |
|       from large pool |      87    |     134    |     180    |      93    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |  142380 K  |  142380 K  |
|       from large pool |       3    |     119    |   64130 K  |   64130 K  |
|       from small pool |       0    |    2746    |   78249 K  |   78249 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893

 Experiment start at: 2024-05-29 07:29:45.746096
before training, model accuracy: 0.9471796751022339
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96502334, 'precision': 0.6690603, 'recall': 0.5250967, 'specificity': 0.5250967, 'f1': 0.5377223, 'auroc': 0.8734966, 'binary_precision': 0.37019232, 'binary_recall': 0.053361055, 'binary_specificity': 0.99683243, 'binary_f1_score': 0.093276806}
confusion matrix:
       0    1
0  41226  131
1   1366   77
---- Validation: 
scalar performance:
{'acc': 0.9644379, 'precision': 0.71778363, 'recall': 0.5432328, 'specificity': 0.5432328, 'f1': 0.5665385, 'auroc': 0.8713956, 'binary_precision': 0.46774194, 'binary_recall': 0.090202175, 'binary_specificity': 0.9962634, 'binary_f1_score': 0.15123859}
confusion matrix:
       0   1
0  17597  66
1    585  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.73020416, 'recall': 0.50166434, 'specificity': 0.50166434, 'f1': 0.493316, 'auroc': 0.65408266, 'binary_precision': 0.5, 'binary_recall': 0.0034722222, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.006896552}
confusion matrix:
      0  1
0  6962  1
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897893.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 08:07:19.050486,epoch time: 0:37:33.304390,used: 0:37:33.304390,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.9113414, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9345092, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.7724389, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897893.png
better model found
persisted
after epoch: 2,now: 2024-05-29 08:43:21.553676,epoch time: 0:36:02.503190,used: 1:13:35.807580,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96621495, 'precision': 0.73086274, 'recall': 0.51501477, 'specificity': 0.51501477, 'f1': 0.5206963, 'auroc': 0.93517214, 'binary_precision': 0.4945055, 'binary_recall': 0.031141868, 'binary_specificity': 0.99888766, 'binary_f1_score': 0.05859375}
confusion matrix:
       0   1
0  41309  46
1   1400  45
---- Validation: 
scalar performance:
{'acc': 0.96678686, 'precision': 0.79946065, 'recall': 0.56468105, 'specificity': 0.56468105, 'f1': 0.6007709, 'auroc': 0.9426819, 'binary_precision': 0.6296296, 'binary_recall': 0.13219285, 'binary_specificity': 0.9971692, 'binary_f1_score': 0.21850899}
confusion matrix:
       0   1
0  17613  50
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.880403, 'recall': 0.50687265, 'specificity': 0.50687265, 'f1': 0.503623, 'auroc': 0.85546696, 'binary_precision': 0.8, 'binary_recall': 0.013888889, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.027303753}
confusion matrix:
      0  1
0  6962  1
1   284  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897893.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 09:19:26.555997,epoch time: 0:36:05.002321,used: 1:49:40.809901,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96810746, 'precision': 0.76395285, 'recall': 0.6422198, 'specificity': 0.6422198, 'f1': 0.68313164, 'auroc': 0.93637323, 'binary_precision': 0.55221933, 'binary_recall': 0.29273355, 'binary_specificity': 0.99170595, 'binary_f1_score': 0.3826323}
confusion matrix:
       0    1
0  41012  343
1   1022  423
---- Validation: 
scalar performance:
{'acc': 0.9682618, 'precision': 0.79378796, 'recall': 0.62688774, 'specificity': 0.62688774, 'f1': 0.6743757, 'auroc': 0.94996095, 'binary_precision': 0.6139706, 'binary_recall': 0.25972006, 'binary_specificity': 0.9940554, 'binary_f1_score': 0.3650273}
confusion matrix:
       0    1
0  17558  105
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.77270997, 'recall': 0.52358747, 'specificity': 0.52358747, 'f1': 0.5348648, 'auroc': 0.8501476, 'binary_precision': 0.5833333, 'binary_recall': 0.048611112, 'binary_specificity': 0.9985638, 'binary_f1_score': 0.08974359}
confusion matrix:
      0   1
0  6953  10
1   274  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897893.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-29 09:55:24.303401,epoch time: 0:35:57.747404,used: 2:25:38.557305,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96689254, 'precision': 0.79324967, 'recall': 0.5247154, 'specificity': 0.5247154, 'f1': 0.5382742, 'auroc': 0.9397696, 'binary_precision': 0.61864406, 'binary_recall': 0.05051903, 'binary_specificity': 0.99891186, 'binary_f1_score': 0.093410105}
confusion matrix:
       0   1
0  41310  45
1   1372  73
---- Validation: 
scalar performance:
{'acc': 0.96662295, 'precision': 0.83910847, 'recall': 0.5413679, 'specificity': 0.5413679, 'f1': 0.5665929, 'auroc': 0.9513278, 'binary_precision': 0.7105263, 'binary_recall': 0.083981335, 'binary_specificity': 0.99875444, 'binary_f1_score': 0.15020862}
confusion matrix:
       0   1
0  17641  22
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.9802731, 'recall': 0.5034722, 'specificity': 0.5034722, 'f1': 0.49683464, 'auroc': 0.8757055, 'binary_precision': 1.0, 'binary_recall': 0.0069444445, 'binary_specificity': 1.0, 'binary_f1_score': 0.013793104}
confusion matrix:
      0  1
0  6963  0
1   286  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897893.png
early stop counter: 1
val acc:0.9666229486465454, best validation acc: 0.9682617783546448, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 5,now: 2024-05-29 10:31:35.977923,epoch time: 0:36:11.674522,used: 3:01:50.231827,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_07_29_45_seed_0_20897893
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 20897893 ON gpusrv30 CANCELLED AT 2024-05-29T10:35:46 ***
