Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue May 28 12:52:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899

 Experiment start at: 2024-05-28 13:04:12.117013
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.7470783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7752106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.645764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 13:25:42.996950,epoch time: 0:21:30.879937,used: 0:21:30.879937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.48322752, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49147072, 'auroc': 0.79779506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42323  0
1   1469  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.80384195, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.69904554, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-05-28 13:44:15.255301,epoch time: 0:18:32.258351,used: 0:40:03.138288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.8056457, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8180617, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.71888673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-05-28 14:04:10.775682,epoch time: 0:19:55.520381,used: 0:59:58.658669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.8607054, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8681116, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.845596, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-05-28 14:27:24.234076,epoch time: 0:23:13.458394,used: 1:23:12.117063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.7774186, 'recall': 0.503314, 'specificity': 0.503314, 'f1': 0.49818465, 'auroc': 0.9133946, 'binary_precision': 0.5882353, 'binary_recall': 0.006793478, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.013431832}
confusion matrix:
       0   1
0  42313   7
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.91519594, 'recall': 0.5146918, 'specificity': 0.5146918, 'f1': 0.52007985, 'auroc': 0.92854655, 'binary_precision': 0.8636364, 'binary_recall': 0.02954899, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.057142854}
confusion matrix:
       0   1
0  18146   3
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8861037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
better model found
persisted
after epoch: 5,now: 2024-05-28 14:48:54.754218,epoch time: 0:21:30.520142,used: 1:44:42.637205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.7496081, 'recall': 0.582272, 'specificity': 0.582272, 'f1': 0.6200262, 'auroc': 0.92998195, 'binary_precision': 0.5274262, 'binary_recall': 0.16983695, 'binary_specificity': 0.994707, 'binary_f1_score': 0.2569373}
confusion matrix:
       0    1
0  42096  224
1   1222  250
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.83960056, 'recall': 0.52835816, 'specificity': 0.52835816, 'f1': 0.5448203, 'auroc': 0.93990254, 'binary_precision': 0.71153843, 'binary_recall': 0.057542767, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.106474824}
confusion matrix:
       0   1
0  18134  15
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.891214, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
better model found
persisted
after epoch: 6,now: 2024-05-28 15:08:57.651428,epoch time: 0:20:02.897210,used: 2:04:45.534415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.7377196, 'recall': 0.6873773, 'specificity': 0.6873773, 'f1': 0.70924115, 'auroc': 0.9204638, 'binary_precision': 0.49652174, 'binary_recall': 0.38843536, 'binary_specificity': 0.9863192, 'binary_f1_score': 0.4358779}
confusion matrix:
       0    1
0  41743  579
1    899  571
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.75548327, 'recall': 0.6657835, 'specificity': 0.6657835, 'f1': 0.7001128, 'auroc': 0.9325522, 'binary_precision': 0.5339806, 'binary_recall': 0.3421462, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.41706163}
confusion matrix:
       0    1
0  17957  192
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.8813144, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-28 15:28:34.855935,epoch time: 0:19:37.204507,used: 2:24:22.738922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.83393407, 'recall': 0.53345937, 'specificity': 0.53345937, 'f1': 0.5536898, 'auroc': 0.9285997, 'binary_precision': 0.6993007, 'binary_recall': 0.06793478, 'binary_specificity': 0.9989839, 'binary_f1_score': 0.123839}
confusion matrix:
       0    1
0  42277   43
1   1372  100
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.90006924, 'recall': 0.5154419, 'specificity': 0.5154419, 'f1': 0.52149296, 'auroc': 0.9432373, 'binary_precision': 0.8333333, 'binary_recall': 0.0311042, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.059970014}
confusion matrix:
       0   1
0  18145   4
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.90511507, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 8,now: 2024-05-28 15:45:59.137095,epoch time: 0:17:24.281160,used: 2:41:47.020082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.825799, 'recall': 0.5324167, 'specificity': 0.5324167, 'f1': 0.5518404, 'auroc': 0.93288004, 'binary_precision': 0.6830986, 'binary_recall': 0.06589674, 'binary_specificity': 0.99893665, 'binary_f1_score': 0.120198265}
confusion matrix:
       0   1
0  42275  45
1   1375  97
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.9029111, 'recall': 0.52008, 'specificity': 0.52008, 'f1': 0.53014976, 'auroc': 0.9421355, 'binary_precision': 0.83870965, 'binary_recall': 0.04043546, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.077151336}
confusion matrix:
       0   1
0  18144   5
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89067173, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 9,now: 2024-05-28 16:01:40.740902,epoch time: 0:15:41.603807,used: 2:57:28.623889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7466823, 'recall': 0.6623287, 'specificity': 0.6623287, 'f1': 0.6949148, 'auroc': 0.9308139, 'binary_precision': 0.5161964, 'binary_recall': 0.3355978, 'binary_specificity': 0.98905957, 'binary_f1_score': 0.40675172}
confusion matrix:
       0    1
0  41857  463
1    978  494
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7547424, 'recall': 0.60478115, 'specificity': 0.60478115, 'f1': 0.6455965, 'auroc': 0.9405569, 'binary_precision': 0.53667957, 'binary_recall': 0.21617419, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.308204}
confusion matrix:
       0    1
0  18029  120
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.90183115, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 3
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 10,now: 2024-05-28 16:17:04.488377,epoch time: 0:15:23.747475,used: 3:12:52.371364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9649251, 'precision': 0.7323397, 'recall': 0.76054764, 'specificity': 0.76054764, 'f1': 0.7455389, 'auroc': 0.9383612, 'binary_precision': 0.48069963, 'binary_recall': 0.5414402, 'binary_specificity': 0.979655, 'binary_f1_score': 0.5092652}
confusion matrix:
       0    1
0  41459  861
1    675  797
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7684448, 'recall': 0.6104172, 'specificity': 0.6104172, 'f1': 0.6535478, 'auroc': 0.94654536, 'binary_precision': 0.5637066, 'binary_recall': 0.22706065, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.32372507}
confusion matrix:
       0    1
0  18036  113
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.90622115, 'recall': 0.63301575, 'specificity': 0.63301575, 'f1': 0.6951085, 'auroc': 0.9076166, 'binary_precision': 0.8433735, 'binary_recall': 0.26819924, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.40697673}
confusion matrix:
      0   1
0  5984  13
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-05-28 16:32:16.353061,epoch time: 0:15:11.864684,used: 3:28:04.236048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96334946, 'precision': 0.71951246, 'recall': 0.73201716, 'specificity': 0.73201716, 'f1': 0.7255702, 'auroc': 0.933205, 'binary_precision': 0.45699614, 'binary_recall': 0.48402447, 'binary_specificity': 0.9800099, 'binary_f1_score': 0.47012213}
confusion matrix:
       0    1
0  41475  846
1    759  712
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.75969803, 'recall': 0.68328273, 'specificity': 0.68328273, 'f1': 0.7142243, 'auroc': 0.9457582, 'binary_precision': 0.54120266, 'binary_recall': 0.377916, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.44505495}
confusion matrix:
       0    1
0  17943  206
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8211576, 'recall': 0.5750442, 'specificity': 0.5750442, 'f1': 0.6151607, 'auroc': 0.8983336, 'binary_precision': 0.6779661, 'binary_recall': 0.1532567, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24999999}
confusion matrix:
      0   1
0  5978  19
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
better model found
persisted
after epoch: 12,now: 2024-05-28 16:50:14.580860,epoch time: 0:17:58.227799,used: 3:46:02.463847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.7996698, 'recall': 0.5385988, 'specificity': 0.5385988, 'f1': 0.5617623, 'auroc': 0.9363315, 'binary_precision': 0.6304348, 'binary_recall': 0.07880435, 'binary_specificity': 0.9983932, 'binary_f1_score': 0.14009662}
confusion matrix:
       0    1
0  42252   68
1   1356  116
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.8137264, 'recall': 0.5251926, 'specificity': 0.5251926, 'f1': 0.53912103, 'auroc': 0.9404941, 'binary_precision': 0.66, 'binary_recall': 0.051321927, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.0952381}
confusion matrix:
       0   1
0  18132  17
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8979862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 13,now: 2024-05-28 17:06:59.298525,epoch time: 0:16:44.717665,used: 4:02:47.181512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96410304, 'precision': 0.7293957, 'recall': 0.78602314, 'specificity': 0.78602314, 'f1': 0.75420964, 'auroc': 0.9397799, 'binary_precision': 0.47300217, 'binary_recall': 0.5951087, 'binary_specificity': 0.9769376, 'binary_f1_score': 0.5270758}
confusion matrix:
       0    1
0  41344  976
1    596  876
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7416476, 'recall': 0.7325722, 'specificity': 0.7325722, 'f1': 0.73701304, 'auroc': 0.94789064, 'binary_precision': 0.50161815, 'binary_recall': 0.4821151, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.4916733}
confusion matrix:
       0    1
0  17841  308
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8790831, 'recall': 0.6476744, 'specificity': 0.6476744, 'f1': 0.70827574, 'auroc': 0.9040031, 'binary_precision': 0.7878788, 'binary_recall': 0.29885057, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.4333333}
confusion matrix:
      0   1
0  5976  21
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 2
val acc:0.9658897519111633, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 14,now: 2024-05-28 17:23:38.769338,epoch time: 0:16:39.470813,used: 4:19:26.652325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9676653, 'precision': 0.7522099, 'recall': 0.69147563, 'specificity': 0.69147563, 'f1': 0.7172524, 'auroc': 0.9389508, 'binary_precision': 0.52527076, 'binary_recall': 0.39538044, 'binary_specificity': 0.9875709, 'binary_f1_score': 0.45116282}
confusion matrix:
       0    1
0  41794  526
1    890  582
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7845912, 'recall': 0.5834979, 'specificity': 0.5834979, 'f1': 0.62475395, 'auroc': 0.94377375, 'binary_precision': 0.59782606, 'binary_recall': 0.1710731, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.26602176}
confusion matrix:
       0    1
0  18075   74
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.88818324, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 3
val acc:0.9676989912986755, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 15,now: 2024-05-28 17:40:27.258804,epoch time: 0:16:48.489466,used: 4:36:15.141791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9683275, 'precision': 0.7660515, 'recall': 0.63804936, 'specificity': 0.63804936, 'f1': 0.6799099, 'auroc': 0.94090235, 'binary_precision': 0.5565912, 'binary_recall': 0.2839674, 'binary_specificity': 0.99213135, 'binary_f1_score': 0.37606835}
confusion matrix:
       0    1
0  41987  333
1   1054  418
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.78639925, 'recall': 0.5577205, 'specificity': 0.5577205, 'f1': 0.5904499, 'auroc': 0.94585764, 'binary_precision': 0.6031746, 'binary_recall': 0.11819596, 'binary_specificity': 0.997245, 'binary_f1_score': 0.1976593}
confusion matrix:
       0   1
0  18099  50
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.91361403, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 16,now: 2024-05-28 17:58:07.541034,epoch time: 0:17:40.282230,used: 4:53:55.424021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.74983513, 'recall': 0.70561177, 'specificity': 0.70561177, 'f1': 0.7253469, 'auroc': 0.9406011, 'binary_precision': 0.51953447, 'binary_recall': 0.42488104, 'binary_specificity': 0.9863425, 'binary_f1_score': 0.46746448}
confusion matrix:
       0    1
0  41743  578
1    846  625
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.76756215, 'recall': 0.6292788, 'specificity': 0.6292788, 'f1': 0.67210925, 'auroc': 0.95064735, 'binary_precision': 0.5606557, 'binary_recall': 0.2659409, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.3607595}
confusion matrix:
       0    1
0  18015  134
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.88423884, 'recall': 0.57771033, 'specificity': 0.57771033, 'f1': 0.6219871, 'auroc': 0.9024651, 'binary_precision': 0.8039216, 'binary_recall': 0.15708812, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2628205}
confusion matrix:
      0   1
0  5987  10
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 5
val acc:0.96775221824646, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 17,now: 2024-05-28 18:14:03.205282,epoch time: 0:15:55.664248,used: 5:09:51.088269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.9832043, 'recall': 0.5003397, 'specificity': 0.5003397, 'f1': 0.49213758, 'auroc': 0.919994, 'binary_precision': 1.0, 'binary_recall': 0.00067934784, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0  1
0  42320  0
1   1471  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9357807, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8669025, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 18,now: 2024-05-28 18:29:34.771034,epoch time: 0:15:31.565752,used: 5:25:22.654021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.9832043, 'recall': 0.5003397, 'specificity': 0.5003397, 'f1': 0.49213758, 'auroc': 0.9467792, 'binary_precision': 1.0, 'binary_recall': 0.00067934784, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0  1
0  42320  0
1   1471  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9516215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9121975, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 19,now: 2024-05-28 18:44:43.047024,epoch time: 0:15:08.275990,used: 5:40:30.930011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.78064847, 'recall': 0.606377, 'specificity': 0.606377, 'f1': 0.6510278, 'auroc': 0.9423647, 'binary_precision': 0.5879121, 'binary_recall': 0.21807066, 'binary_specificity': 0.9946834, 'binary_f1_score': 0.31813678}
confusion matrix:
       0    1
0  42095  225
1   1151  321
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.85827297, 'recall': 0.51152635, 'specificity': 0.51152635, 'f1': 0.5140521, 'auroc': 0.9511425, 'binary_precision': 0.75, 'binary_recall': 0.02332815, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.045248874}
confusion matrix:
       0   1
0  18144   5
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9047079, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 8
val acc:0.9663154482841492, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 20,now: 2024-05-28 19:00:46.045006,epoch time: 0:16:02.997982,used: 5:56:33.927993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.8517784, 'recall': 0.5046996, 'specificity': 0.5046996, 'f1': 0.5009053, 'auroc': 0.9487215, 'binary_precision': 0.7368421, 'binary_recall': 0.009517335, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.018791948}
confusion matrix:
       0   1
0  42316   5
1   1457  14
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.98294306, 'recall': 0.5015552, 'specificity': 0.5015552, 'f1': 0.4944243, 'auroc': 0.95552665, 'binary_precision': 1.0, 'binary_recall': 0.00311042, 'binary_specificity': 1.0, 'binary_f1_score': 0.0062015504}
confusion matrix:
       0  1
0  18149  0
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.89852875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 9
val acc:0.9658897519111633, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 21,now: 2024-05-28 19:18:13.588602,epoch time: 0:17:27.543596,used: 6:14:01.471589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.88218933, 'recall': 0.5171698, 'specificity': 0.5171698, 'f1': 0.5248705, 'auroc': 0.940475, 'binary_precision': 0.796875, 'binary_recall': 0.03464674, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.06640625}
confusion matrix:
       0   1
0  42307  13
1   1421  51
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.98296875, 'recall': 0.5023328, 'specificity': 0.5023328, 'f1': 0.4959808, 'auroc': 0.9487947, 'binary_precision': 1.0, 'binary_recall': 0.00466563, 'binary_specificity': 1.0, 'binary_f1_score': 0.009287926}
confusion matrix:
       0  1
0  18149  0
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9059619, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 10
val acc:0.9659429788589478, best validation acc: 0.96775221824646, corresponding to test acc:                         0.9616490602493286 / 0.9674017429351807
after epoch: 22,now: 2024-05-28 19:34:06.247745,epoch time: 0:15:52.659143,used: 6:29:54.130732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9686929, 'precision': 0.761132, 'recall': 0.7182361, 'specificity': 0.7182361, 'f1': 0.7375648, 'auroc': 0.9416865, 'binary_precision': 0.5412919, 'binary_recall': 0.44972825, 'binary_specificity': 0.98674387, 'binary_f1_score': 0.49128014}
confusion matrix:
       0    1
0  41759  561
1    810  662
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7671439, 'recall': 0.6979471, 'specificity': 0.6979471, 'f1': 0.7268748, 'auroc': 0.95403576, 'binary_precision': 0.55508476, 'binary_recall': 0.407465, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.46995515}
confusion matrix:
       0    1
0  17939  210
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7834997, 'recall': 0.5428107, 'specificity': 0.5428107, 'f1': 0.5665687, 'auroc': 0.9078184, 'binary_precision': 0.6052632, 'binary_recall': 0.08812261, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5982  15
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
better model found
persisted
after epoch: 23,now: 2024-05-28 19:50:07.660620,epoch time: 0:16:01.412875,used: 6:45:55.543607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96962917, 'precision': 0.76995885, 'recall': 0.72181445, 'specificity': 0.72181445, 'f1': 0.74329114, 'auroc': 0.94705623, 'binary_precision': 0.5587011, 'binary_recall': 0.4561523, 'binary_specificity': 0.98747665, 'binary_f1_score': 0.5022455}
confusion matrix:
       0    1
0  41791  530
1    800  671
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.7745868, 'recall': 0.67183286, 'specificity': 0.67183286, 'f1': 0.71025145, 'auroc': 0.9504936, 'binary_precision': 0.57178843, 'binary_recall': 0.35303265, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.43653846}
confusion matrix:
       0    1
0  17979  170
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9145036, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
better model found
persisted
after epoch: 24,now: 2024-05-28 20:05:58.043614,epoch time: 0:15:50.382994,used: 7:01:45.926601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9670716, 'precision': 0.9418899, 'recall': 0.5111738, 'specificity': 0.5111738, 'f1': 0.51350695, 'auroc': 0.94472396, 'binary_precision': 0.9166667, 'binary_recall': 0.022418479, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.043766577}
confusion matrix:
       0   1
0  42317   3
1   1439  33
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.98294306, 'recall': 0.5015552, 'specificity': 0.5015552, 'f1': 0.4944243, 'auroc': 0.95084107, 'binary_precision': 1.0, 'binary_recall': 0.00311042, 'binary_specificity': 1.0, 'binary_f1_score': 0.0062015504}
confusion matrix:
       0  1
0  18149  0
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9095357, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 25,now: 2024-05-28 20:21:48.531997,epoch time: 0:15:50.488383,used: 7:17:36.414984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.745417, 'recall': 0.7486361, 'specificity': 0.7486361, 'f1': 0.7470149, 'auroc': 0.94860303, 'binary_precision': 0.50771296, 'binary_recall': 0.5146159, 'binary_specificity': 0.98265636, 'binary_f1_score': 0.5111411}
confusion matrix:
       0    1
0  41587  734
1    714  757
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.749491, 'recall': 0.69781554, 'specificity': 0.69781554, 'f1': 0.72034526, 'auroc': 0.9524794, 'binary_precision': 0.5197629, 'binary_recall': 0.40902022, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.45778942}
confusion matrix:
       0    1
0  17906  243
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9000323, 'recall': 0.6044468, 'specificity': 0.6044468, 'f1': 0.65929425, 'auroc': 0.91862154, 'binary_precision': 0.8333333, 'binary_recall': 0.21072797, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.33639142}
confusion matrix:
      0   1
0  5986  11
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 26,now: 2024-05-28 20:37:29.030625,epoch time: 0:15:40.498628,used: 7:33:16.913612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9699032, 'precision': 0.7809571, 'recall': 0.67667973, 'specificity': 0.67667973, 'f1': 0.715839, 'auroc': 0.9480606, 'binary_precision': 0.5837897, 'binary_recall': 0.36233854, 'binary_specificity': 0.991021, 'binary_f1_score': 0.44714764}
confusion matrix:
       0    1
0  41941  380
1    938  533
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7877569, 'recall': 0.60708016, 'specificity': 0.60708016, 'f1': 0.6526707, 'auroc': 0.95226836, 'binary_precision': 0.6025641, 'binary_recall': 0.21928461, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.32155076}
confusion matrix:
       0    1
0  18056   93
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9080944, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 3
val acc:0.9683375954627991, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 27,now: 2024-05-28 20:53:10.480372,epoch time: 0:15:41.449747,used: 7:48:58.363359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9705197, 'precision': 0.7858456, 'recall': 0.6911067, 'specificity': 0.6911067, 'f1': 0.7281941, 'auroc': 0.9528251, 'binary_precision': 0.5925926, 'binary_recall': 0.39157036, 'binary_specificity': 0.99064296, 'binary_f1_score': 0.4715514}
confusion matrix:
       0    1
0  41925  396
1    895  576
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7651491, 'recall': 0.59825104, 'specificity': 0.59825104, 'f1': 0.6400113, 'auroc': 0.9566916, 'binary_precision': 0.5579399, 'binary_recall': 0.2021773, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.29680365}
confusion matrix:
       0    1
0  18046  103
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8680667, 'recall': 0.5453934, 'specificity': 0.5453934, 'f1': 0.5722114, 'auroc': 0.9282799, 'binary_precision': 0.7741935, 'binary_recall': 0.09195402, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5990   7
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 4
val acc:0.9672200679779053, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 28,now: 2024-05-28 21:08:55.583269,epoch time: 0:15:45.102897,used: 8:04:43.466256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9673685, 'precision': 0.7488804, 'recall': 0.7526318, 'specificity': 0.7526318, 'f1': 0.7507404, 'auroc': 0.9485998, 'binary_precision': 0.5143813, 'binary_recall': 0.5224185, 'binary_specificity': 0.982845, 'binary_f1_score': 0.5183687}
confusion matrix:
       0    1
0  41594  726
1    703  769
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.756963, 'recall': 0.7064794, 'specificity': 0.7064794, 'f1': 0.728679, 'auroc': 0.9550211, 'binary_precision': 0.53411305, 'binary_recall': 0.42612752, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.47404844}
confusion matrix:
       0    1
0  17910  239
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8237244, 'recall': 0.52065593, 'specificity': 0.52065593, 'f1': 0.52929366, 'auroc': 0.9072156, 'binary_precision': 0.6875, 'binary_recall': 0.042145595, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07942238}
confusion matrix:
      0   1
0  5992   5
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 5
val acc:0.9676458239555359, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 29,now: 2024-05-28 21:24:58.954021,epoch time: 0:16:03.370752,used: 8:20:46.837008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96988034, 'precision': 0.82847476, 'recall': 0.5949197, 'specificity': 0.5949197, 'f1': 0.6428077, 'auroc': 0.95379204, 'binary_precision': 0.6843374, 'binary_recall': 0.19293478, 'binary_specificity': 0.99690455, 'binary_f1_score': 0.3010069}
confusion matrix:
       0    1
0  42189  131
1   1188  284
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.81665415, 'recall': 0.5572735, 'specificity': 0.5572735, 'f1': 0.5909789, 'auroc': 0.95920855, 'binary_precision': 0.6637168, 'binary_recall': 0.11664075, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.19841269}
confusion matrix:
       0   1
0  18111  38
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.91663104, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897899.png
early stop counter: 6
val acc:0.96775221824646, best validation acc: 0.9688165187835693, corresponding to test acc:                         0.9606903195381165 / 0.9674017429351807
after epoch: 30,now: 2024-05-28 21:40:46.525486,epoch time: 0:15:47.571465,used: 8:36:34.408473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_13_04_12_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:36:34.408473 at 2024-05-28 21:40:46.525486
persisted model performance metric: 

scalar performance:
{'acc': 0.9589326, 'precision': 0.7800417, 'recall': 0.5223215, 'specificity': 0.5223215, 'f1': 0.53220195, 'auroc': 0.91455805, 'binary_precision': 0.6, 'binary_recall': 0.04597701, 'binary_specificity': 0.998666, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5989   8
1   249  12
oracle model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.91007316, 'recall': 0.61027735, 'specificity': 0.61027735, 'f1': 0.66755295, 'auroc': 0.90341836, 'binary_precision': 0.85294116, 'binary_recall': 0.22222222, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.35258362}
confusion matrix:
      0   1
0  5987  10
1   203  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14520 MiB |  14520 MiB |  14520 MiB |      0 B   |
|       from large pool |  14450 MiB |  14450 MiB |  14450 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 535635 KiB |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool | 526122 KiB |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |   9512 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197545 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94664 K  |   94661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197545 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94664 K  |   94661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |    2811    |  110222 K  |  110221 K  |
|       from large pool |      46    |     600    |   60596 K  |   60596 K  |
|       from small pool |      39    |    2764    |   49625 K  |   49625 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1014 MiB |  14520 MiB |  14520 MiB |  13506 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     42 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94664 K  |   94664 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94664 K  |   94664 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     638    |     638    |     570    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  110223 K  |  110223 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   49626 K  |   49626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1014 MiB |  14520 MiB |  14520 MiB |  13506 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     42 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94664 K  |   94664 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94664 K  |   94664 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     638    |     638    |     570    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  110223 K  |  110223 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   49626 K  |   49626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899

 Experiment start at: 2024-05-28 21:48:13.622628
before training, model accuracy: 0.701374351978302
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.6325354, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.69231594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.4811737, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 22:06:32.785074,epoch time: 0:18:19.162446,used: 0:18:19.162446,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.7207453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7344929, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.47072577, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 2,now: 2024-05-28 22:22:57.891863,epoch time: 0:16:25.106789,used: 0:34:44.269235,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.79625124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.7977953, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5924679, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 2
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 3,now: 2024-05-28 22:39:22.642225,epoch time: 0:16:24.750362,used: 0:51:09.019597,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8757373, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.873778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.757569, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 3
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 4,now: 2024-05-28 22:55:49.753019,epoch time: 0:16:27.110794,used: 1:07:36.130391,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9537144, 'precision': 0.80617845, 'recall': 0.5336287, 'specificity': 0.5336287, 'f1': 0.55061424, 'auroc': 0.89785075, 'binary_precision': 0.6571429, 'binary_recall': 0.06906907, 'binary_specificity': 0.9981884, 'binary_f1_score': 0.125}
confusion matrix:
       0    1
0  33059   60
1   1550  115
---- Validation: 
scalar performance:
{'acc': 0.9526009, 'precision': 0.8402697, 'recall': 0.5215558, 'specificity': 0.5215558, 'f1': 0.5292866, 'auroc': 0.90521944, 'binary_precision': 0.72727275, 'binary_recall': 0.043956045, 'binary_specificity': 0.99915546, 'binary_f1_score': 0.08290156}
confusion matrix:
       0   1
0  14197  12
1    696  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956152, 'precision': 0.99780744, 'recall': 0.50735295, 'specificity': 0.50735295, 'f1': 0.51339406, 'auroc': 0.7731372, 'binary_precision': 1.0, 'binary_recall': 0.014705882, 'binary_specificity': 1.0, 'binary_f1_score': 0.028985508}
confusion matrix:
       0  1
0  15212  0
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-28 23:12:15.082744,epoch time: 0:16:25.329725,used: 1:24:01.460116,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.9049983, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.9108696, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.78290963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.95260089635849, corresponding to test acc:                         0.9956151843070984 / 0.9956151843070984
after epoch: 6,now: 2024-05-28 23:28:36.844924,epoch time: 0:16:21.762180,used: 1:40:23.222296,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9539156, 'precision': 0.7856916, 'recall': 0.54827976, 'specificity': 0.54827976, 'f1': 0.57393736, 'auroc': 0.9170842, 'binary_precision': 0.6148148, 'binary_recall': 0.0996997, 'binary_specificity': 0.9968598, 'binary_f1_score': 0.17157623}
confusion matrix:
       0    1
0  33015  104
1   1499  166
---- Validation: 
scalar performance:
{'acc': 0.9524001, 'precision': 0.8478747, 'recall': 0.51754045, 'specificity': 0.51754045, 'f1': 0.5218642, 'auroc': 0.9264705, 'binary_precision': 0.74285716, 'binary_recall': 0.035714287, 'binary_specificity': 0.9993666, 'binary_f1_score': 0.06815203}
confusion matrix:
       0   1
0  14200   9
1    702  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99397904, 'precision': 0.49777138, 'recall': 0.49921116, 'specificity': 0.49921116, 'f1': 0.4984902, 'auroc': 0.7962121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984223, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15188  24
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 2
val acc:0.9524000883102417, best validation acc: 0.95260089635849, corresponding to test acc:                         0.9956151843070984 / 0.9956151843070984
after epoch: 7,now: 2024-05-28 23:44:57.178565,epoch time: 0:16:20.333641,used: 1:56:43.555937,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95466304, 'precision': 0.7645932, 'recall': 0.60742414, 'specificity': 0.60742414, 'f1': 0.6485503, 'auroc': 0.9147048, 'binary_precision': 0.56707317, 'binary_recall': 0.22342342, 'binary_specificity': 0.99142486, 'binary_f1_score': 0.32055146}
confusion matrix:
       0    1
0  32835  284
1   1293  372
---- Validation: 
scalar performance:
{'acc': 0.9552119, 'precision': 0.7821276, 'recall': 0.6154587, 'specificity': 0.6154587, 'f1': 0.6594998, 'auroc': 0.9227225, 'binary_precision': 0.6020761, 'binary_recall': 0.23901099, 'binary_specificity': 0.9919065, 'binary_f1_score': 0.3421829}
confusion matrix:
       0    1
0  14094  115
1    554  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952225, 'precision': 0.60895014, 'recall': 0.5144758, 'specificity': 0.5144758, 'f1': 0.52477664, 'auroc': 0.7590519, 'binary_precision': 0.22222222, 'binary_recall': 0.029411765, 'binary_specificity': 0.99953985, 'binary_f1_score': 0.05194805}
confusion matrix:
       0  1
0  15205  7
1     66  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
better model found
persisted
after epoch: 8,now: 2024-05-29 00:01:31.835075,epoch time: 0:16:34.656510,used: 2:13:18.212447,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9519319, 'precision': 0.66586006, 'recall': 0.50303155, 'specificity': 0.50303155, 'f1': 0.49417657, 'auroc': 0.9114306, 'binary_precision': 0.37931034, 'binary_recall': 0.0066066068, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.012987014}
confusion matrix:
       0   1
0  33101  18
1   1654  11
---- Validation: 
scalar performance:
{'acc': 0.951195, 'precision': 0.6900057, 'recall': 0.5019197, 'specificity': 0.5019197, 'f1': 0.49157262, 'auroc': 0.9177792, 'binary_precision': 0.42857143, 'binary_recall': 0.0041208793, 'binary_specificity': 0.9997185, 'binary_f1_score': 0.008163266}
confusion matrix:
       0  1
0  14205  4
1    725  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99384815, 'precision': 0.49777108, 'recall': 0.49914542, 'specificity': 0.49914542, 'f1': 0.49845728, 'auroc': 0.7652936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99829084, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15186  26
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 1
val acc:0.9511950016021729, best validation acc: 0.955211877822876, corresponding to test acc:                         0.9952225089073181 / 0.9956151843070984
after epoch: 9,now: 2024-05-29 00:17:56.728050,epoch time: 0:16:24.892975,used: 2:29:43.105422,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9538006, 'precision': 0.7628964, 'recall': 0.5707504, 'specificity': 0.5707504, 'f1': 0.60492474, 'auroc': 0.9199946, 'binary_precision': 0.5671296, 'binary_recall': 0.14714715, 'binary_specificity': 0.9943537, 'binary_f1_score': 0.23366712}
confusion matrix:
       0    1
0  32932  187
1   1420  245
---- Validation: 
scalar performance:
{'acc': 0.95487714, 'precision': 0.83396155, 'recall': 0.561198, 'specificity': 0.561198, 'f1': 0.5946949, 'auroc': 0.92572635, 'binary_precision': 0.7109375, 'binary_recall': 0.125, 'binary_specificity': 0.997396, 'binary_f1_score': 0.21261682}
confusion matrix:
       0   1
0  14172  37
1    637  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469894, 'precision': 0.49777296, 'recall': 0.4995727, 'specificity': 0.4995727, 'f1': 0.4986712, 'auroc': 0.8063731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991454, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15199  13
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 2
val acc:0.9548771381378174, best validation acc: 0.955211877822876, corresponding to test acc:                         0.9952225089073181 / 0.9956151843070984
after epoch: 10,now: 2024-05-29 00:34:20.816619,epoch time: 0:16:24.088569,used: 2:46:07.193991,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9558418, 'precision': 0.7811414, 'recall': 0.61260635, 'specificity': 0.61260635, 'f1': 0.65640104, 'auroc': 0.9251145, 'binary_precision': 0.59969085, 'binary_recall': 0.23303303, 'binary_specificity': 0.9921797, 'binary_f1_score': 0.33564016}
confusion matrix:
       0    1
0  32860  259
1   1277  388
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.8175632, 'recall': 0.5730328, 'specificity': 0.5730328, 'f1': 0.61103475, 'auroc': 0.9316946, 'binary_precision': 0.67701864, 'binary_recall': 0.14972527, 'binary_specificity': 0.99634033, 'binary_f1_score': 0.24521935}
confusion matrix:
       0    1
0  14157   52
1    619  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.6978396, 'recall': 0.51460725, 'specificity': 0.51460725, 'f1': 0.5262656, 'auroc': 0.81778777, 'binary_precision': 0.4, 'binary_recall': 0.029411765, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.05479452}
confusion matrix:
       0  1
0  15209  3
1     66  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 3
val acc:0.9550780057907104, best validation acc: 0.955211877822876, corresponding to test acc:                         0.9952225089073181 / 0.9956151843070984
after epoch: 11,now: 2024-05-29 00:50:47.507119,epoch time: 0:16:26.690500,used: 3:02:33.884491,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9488558, 'precision': 0.72959083, 'recall': 0.81884736, 'specificity': 0.81884736, 'f1': 0.7655443, 'auroc': 0.92296183, 'binary_precision': 0.4758679, 'binary_recall': 0.67507505, 'binary_specificity': 0.96261966, 'binary_f1_score': 0.5582319}
confusion matrix:
       0     1
0  31881  1238
1    541  1124
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.7482009, 'recall': 0.7831738, 'specificity': 0.7831738, 'f1': 0.76433146, 'auroc': 0.93479466, 'binary_precision': 0.5173238, 'binary_recall': 0.5947802, 'binary_specificity': 0.97156733, 'binary_f1_score': 0.5533547}
confusion matrix:
       0    1
0  13805  404
1    295  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99051046, 'precision': 0.5809931, 'recall': 0.6365505, 'specificity': 0.6365505, 'f1': 0.60143846, 'auroc': 0.8050033, 'binary_precision': 0.16521738, 'binary_recall': 0.27941176, 'binary_specificity': 0.9936892, 'binary_f1_score': 0.20765027}
confusion matrix:
       0   1
0  15116  96
1     49  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 4
val acc:0.9532034397125244, best validation acc: 0.955211877822876, corresponding to test acc:                         0.9952225089073181 / 0.9956151843070984
after epoch: 12,now: 2024-05-29 01:07:12.658798,epoch time: 0:16:25.151679,used: 3:18:59.036170,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95541054, 'precision': 0.78002775, 'recall': 0.6004014, 'specificity': 0.6004014, 'f1': 0.64273894, 'auroc': 0.9253309, 'binary_precision': 0.59861594, 'binary_recall': 0.20780781, 'binary_specificity': 0.99299496, 'binary_f1_score': 0.30851537}
confusion matrix:
       0    1
0  32887  232
1   1319  346
---- Validation: 
scalar performance:
{'acc': 0.95320344, 'precision': 0.7752615, 'recall': 0.5609699, 'specificity': 0.5609699, 'f1': 0.59213483, 'auroc': 0.93199515, 'binary_precision': 0.59354836, 'binary_recall': 0.12637363, 'binary_specificity': 0.9955662, 'binary_f1_score': 0.20838052}
confusion matrix:
       0   1
0  14146  63
1    636  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952225, 'precision': 0.682212, 'recall': 0.5510762, 'specificity': 0.5510762, 'f1': 0.579262, 'auroc': 0.85002816, 'binary_precision': 0.36842105, 'binary_recall': 0.10294118, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.16091955}
confusion matrix:
       0   1
0  15200  12
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 5
val acc:0.9532034397125244, best validation acc: 0.955211877822876, corresponding to test acc:                         0.9952225089073181 / 0.9956151843070984
after epoch: 13,now: 2024-05-29 01:23:41.427842,epoch time: 0:16:28.769044,used: 3:35:27.805214,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9559855, 'precision': 0.7602271, 'recall': 0.7244815, 'specificity': 0.7244815, 'f1': 0.74083024, 'auroc': 0.9200365, 'binary_precision': 0.54698455, 'binary_recall': 0.46846846, 'binary_specificity': 0.98049456, 'binary_f1_score': 0.50469106}
confusion matrix:
       0    1
0  32473  646
1    885  780
---- Validation: 
scalar performance:
{'acc': 0.95782286, 'precision': 0.81308687, 'recall': 0.6337734, 'specificity': 0.6337734, 'f1': 0.683254, 'auroc': 0.9303704, 'binary_precision': 0.66225165, 'binary_recall': 0.2747253, 'binary_specificity': 0.99282146, 'binary_f1_score': 0.38834953}
confusion matrix:
       0    1
0  14107  102
1    528  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9948953, 'precision': 0.68576115, 'recall': 0.6094724, 'specificity': 0.6094724, 'f1': 0.6376082, 'auroc': 0.80651283, 'binary_precision': 0.375, 'binary_recall': 0.22058824, 'binary_specificity': 0.9983566, 'binary_f1_score': 0.2777778}
confusion matrix:
       0   1
0  15187  25
1     53  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
better model found
persisted
after epoch: 14,now: 2024-05-29 01:40:09.588725,epoch time: 0:16:28.160883,used: 3:51:55.966097,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9523919, 'precision': 0.7366927, 'recall': 0.6880848, 'specificity': 0.6880848, 'f1': 0.70915353, 'auroc': 0.9196309, 'binary_precision': 0.50343776, 'binary_recall': 0.3957958, 'binary_specificity': 0.9803738, 'binary_f1_score': 0.44317418}
confusion matrix:
       0    1
0  32469  650
1   1006  659
---- Validation: 
scalar performance:
{'acc': 0.95501107, 'precision': 0.76249504, 'recall': 0.6824705, 'specificity': 0.6824705, 'f1': 0.71420944, 'auroc': 0.9301045, 'binary_precision': 0.5562249, 'binary_recall': 0.3804945, 'binary_specificity': 0.98444647, 'binary_f1_score': 0.45187598}
confusion matrix:
       0    1
0  13988  221
1    451  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949607, 'precision': 0.66473264, 'recall': 0.56558484, 'specificity': 0.56558484, 'f1': 0.59347314, 'auroc': 0.8050035, 'binary_precision': 0.33333334, 'binary_recall': 0.13235295, 'binary_specificity': 0.9988167, 'binary_f1_score': 0.1894737}
confusion matrix:
       0   1
0  15194  18
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 1
val acc:0.9550110697746277, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 15,now: 2024-05-29 01:56:36.142084,epoch time: 0:16:26.553359,used: 4:08:22.519456,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95684797, 'precision': 0.76637244, 'recall': 0.72236764, 'specificity': 0.72236764, 'f1': 0.7420869, 'auroc': 0.9324539, 'binary_precision': 0.55950654, 'binary_recall': 0.46306306, 'binary_specificity': 0.98167217, 'binary_f1_score': 0.50673676}
confusion matrix:
       0    1
0  32512  607
1    894  771
---- Validation: 
scalar performance:
{'acc': 0.9570195, 'precision': 0.7840023, 'recall': 0.67049366, 'specificity': 0.67049366, 'f1': 0.71114063, 'auroc': 0.93634105, 'binary_precision': 0.60046726, 'binary_recall': 0.35302198, 'binary_specificity': 0.98796535, 'binary_f1_score': 0.44463667}
confusion matrix:
       0    1
0  14038  171
1    471  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941099, 'precision': 0.6285968, 'recall': 0.5871178, 'specificity': 0.5871178, 'f1': 0.60378516, 'auroc': 0.84044504, 'binary_precision': 0.26086956, 'binary_recall': 0.1764706, 'binary_specificity': 0.99776495, 'binary_f1_score': 0.21052633}
confusion matrix:
       0   1
0  15178  34
1     56  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 2
val acc:0.9570195078849792, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 16,now: 2024-05-29 02:13:04.412458,epoch time: 0:16:28.270374,used: 4:24:50.789830,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9553818, 'precision': 0.75490695, 'recall': 0.7797791, 'specificity': 0.7797791, 'f1': 0.7666665, 'auroc': 0.931471, 'binary_precision': 0.53075665, 'binary_recall': 0.5855856, 'binary_specificity': 0.9739726, 'binary_f1_score': 0.5568246}
confusion matrix:
       0    1
0  32257  862
1    690  975
---- Validation: 
scalar performance:
{'acc': 0.9568856, 'precision': 0.7704407, 'recall': 0.7349341, 'specificity': 0.7349341, 'f1': 0.75124574, 'auroc': 0.9340302, 'binary_precision': 0.566879, 'binary_recall': 0.489011, 'binary_specificity': 0.9808572, 'binary_f1_score': 0.52507377}
confusion matrix:
       0    1
0  13937  272
1    372  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9907068, 'precision': 0.56318843, 'recall': 0.5927286, 'specificity': 0.5927286, 'f1': 0.5750449, 'auroc': 0.78536534, 'binary_precision': 0.13, 'binary_recall': 0.19117647, 'binary_specificity': 0.9942808, 'binary_f1_score': 0.15476191}
confusion matrix:
       0   1
0  15125  87
1     55  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 3
val acc:0.956885576248169, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 17,now: 2024-05-29 02:29:28.470616,epoch time: 0:16:24.058158,used: 4:41:14.847988,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9570492, 'precision': 0.77431166, 'recall': 0.6802632, 'specificity': 0.6802632, 'f1': 0.71619433, 'auroc': 0.92635906, 'binary_precision': 0.5795349, 'binary_recall': 0.37417418, 'binary_specificity': 0.98635226, 'binary_f1_score': 0.45474452}
confusion matrix:
       0    1
0  32667  452
1   1042  623
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.78717226, 'recall': 0.63817704, 'specificity': 0.63817704, 'f1': 0.6832396, 'auroc': 0.93217146, 'binary_precision': 0.6099707, 'binary_recall': 0.2857143, 'binary_specificity': 0.99063975, 'binary_f1_score': 0.38914877}
confusion matrix:
       0    1
0  14076  133
1    520  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.70967007, 'recall': 0.5803893, 'specificity': 0.5803893, 'f1': 0.61583966, 'auroc': 0.8327544, 'binary_precision': 0.42307693, 'binary_recall': 0.16176471, 'binary_specificity': 0.99901396, 'binary_f1_score': 0.23404257}
confusion matrix:
       0   1
0  15197  15
1     57  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 4
val acc:0.9562830328941345, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 18,now: 2024-05-29 02:45:58.691796,epoch time: 0:16:30.221180,used: 4:57:45.069168,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9558705, 'precision': 0.8141703, 'recall': 0.57525986, 'specificity': 0.57525986, 'f1': 0.61405987, 'auroc': 0.92903006, 'binary_precision': 0.6692708, 'binary_recall': 0.15435435, 'binary_specificity': 0.99616534, 'binary_f1_score': 0.25085407}
confusion matrix:
       0    1
0  32992  127
1   1408  257
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.8379264, 'recall': 0.58344054, 'specificity': 0.58344054, 'f1': 0.62635577, 'auroc': 0.93477976, 'binary_precision': 0.716763, 'binary_recall': 0.17032968, 'binary_specificity': 0.99655145, 'binary_f1_score': 0.27524972}
confusion matrix:
       0    1
0  14160   49
1    604  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99541885, 'precision': 0.49777457, 'recall': 0.49993426, 'specificity': 0.49993426, 'f1': 0.4988521, 'auroc': 0.83542764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998685, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15210  2
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 5
val acc:0.9562830328941345, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 19,now: 2024-05-29 03:02:45.352119,epoch time: 0:16:46.660323,used: 5:14:31.729491,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9587454, 'precision': 0.79463995, 'recall': 0.6717422, 'specificity': 0.6717422, 'f1': 0.7149049, 'auroc': 0.93424517, 'binary_precision': 0.6210526, 'binary_recall': 0.35435435, 'binary_specificity': 0.9891301, 'binary_f1_score': 0.4512428}
confusion matrix:
       0    1
0  32759  360
1   1075  590
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.8232646, 'recall': 0.59256333, 'specificity': 0.59256333, 'f1': 0.6372668, 'auroc': 0.94124424, 'binary_precision': 0.6865672, 'binary_recall': 0.18956044, 'binary_specificity': 0.9955662, 'binary_f1_score': 0.29709366}
confusion matrix:
       0    1
0  14146   63
1    590  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99456805, 'precision': 0.62706494, 'recall': 0.55806756, 'specificity': 0.55806756, 'f1': 0.5794457, 'auroc': 0.8129196, 'binary_precision': 0.2580645, 'binary_recall': 0.11764706, 'binary_specificity': 0.998488, 'binary_f1_score': 0.16161616}
confusion matrix:
       0   1
0  15189  23
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 6
val acc:0.9562830328941345, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 20,now: 2024-05-29 03:19:10.944162,epoch time: 0:16:25.592043,used: 5:30:57.321534,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95506555, 'precision': 0.7934951, 'recall': 0.5728407, 'specificity': 0.5728407, 'f1': 0.6096058, 'auroc': 0.92903626, 'binary_precision': 0.6281407, 'binary_recall': 0.15015015, 'binary_specificity': 0.99553126, 'binary_f1_score': 0.24236548}
confusion matrix:
       0    1
0  32971  148
1   1415  250
---- Validation: 
scalar performance:
{'acc': 0.9536051, 'precision': 0.8805921, 'recall': 0.5312063, 'specificity': 0.5312063, 'f1': 0.546687, 'auroc': 0.93561876, 'binary_precision': 0.80701756, 'binary_recall': 0.06318682, 'binary_specificity': 0.99922585, 'binary_f1_score': 0.11719746}
confusion matrix:
       0   1
0  14198  11
1    682  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949607, 'precision': 0.5432606, 'recall': 0.5070242, 'specificity': 0.5070242, 'f1': 0.51139516, 'auroc': 0.8084489, 'binary_precision': 0.09090909, 'binary_recall': 0.014705882, 'binary_specificity': 0.9993426, 'binary_f1_score': 0.025316456}
confusion matrix:
       0   1
0  15202  10
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 7
val acc:0.9536051154136658, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 21,now: 2024-05-29 03:35:39.742716,epoch time: 0:16:28.798554,used: 5:47:26.120088,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95454806, 'precision': 0.75122905, 'recall': 0.8124249, 'specificity': 0.8124249, 'f1': 0.7779155, 'auroc': 0.9284762, 'binary_precision': 0.52001905, 'binary_recall': 0.65525526, 'binary_specificity': 0.9695945, 'binary_f1_score': 0.57985646}
confusion matrix:
       0     1
0  32112  1007
1    574  1091
---- Validation: 
scalar performance:
{'acc': 0.95635, 'precision': 0.7658658, 'recall': 0.7463818, 'specificity': 0.7463818, 'f1': 0.7556938, 'auroc': 0.9333111, 'binary_precision': 0.55654764, 'binary_recall': 0.51373625, 'binary_specificity': 0.9790274, 'binary_f1_score': 0.53428566}
confusion matrix:
       0    1
0  13911  298
1    354  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98697644, 'precision': 0.55459166, 'recall': 0.6347756, 'specificity': 0.6347756, 'f1': 0.5768874, 'auroc': 0.8226458, 'binary_precision': 0.112426035, 'binary_recall': 0.27941176, 'binary_specificity': 0.99013937, 'binary_f1_score': 0.16033755}
confusion matrix:
       0    1
0  15062  150
1     49   19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 8
val acc:0.9563500285148621, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 22,now: 2024-05-29 03:52:07.478095,epoch time: 0:16:27.735379,used: 6:03:53.855467,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9576529, 'precision': 0.76637787, 'recall': 0.78981304, 'specificity': 0.78981304, 'f1': 0.7775206, 'auroc': 0.9402688, 'binary_precision': 0.55274725, 'binary_recall': 0.6042042, 'binary_specificity': 0.97542197, 'binary_f1_score': 0.57733136}
confusion matrix:
       0     1
0  32305   814
1    659  1006
---- Validation: 
scalar performance:
{'acc': 0.95614916, 'precision': 0.76385874, 'recall': 0.7580055, 'specificity': 0.7580055, 'f1': 0.76089394, 'auroc': 0.9435606, 'binary_precision': 0.55133617, 'binary_recall': 0.53846157, 'binary_specificity': 0.97754943, 'binary_f1_score': 0.5448228}
confusion matrix:
       0    1
0  13890  319
1    336  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9931283, 'precision': 0.6013674, 'recall': 0.5939448, 'specificity': 0.5939448, 'f1': 0.5975113, 'auroc': 0.82860494, 'binary_precision': 0.20634921, 'binary_recall': 0.19117647, 'binary_specificity': 0.9967131, 'binary_f1_score': 0.19847329}
confusion matrix:
       0   1
0  15162  50
1     55  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 9
val acc:0.956149160861969, best validation acc: 0.957822859287262, corresponding to test acc:                         0.9948952794075012 / 0.9956151843070984
after epoch: 23,now: 2024-05-29 04:08:29.958498,epoch time: 0:16:22.480403,used: 6:20:16.335870,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95759547, 'precision': 0.76568043, 'recall': 0.798339, 'specificity': 0.798339, 'f1': 0.78090715, 'auroc': 0.93748236, 'binary_precision': 0.5504782, 'binary_recall': 0.62222224, 'binary_specificity': 0.9744558, 'binary_f1_score': 0.5841557}
confusion matrix:
       0     1
0  32273   846
1    629  1036
---- Validation: 
scalar performance:
{'acc': 0.9585593, 'precision': 0.7818686, 'recall': 0.7377687, 'specificity': 0.7377687, 'f1': 0.757666, 'auroc': 0.94064987, 'binary_precision': 0.58949095, 'binary_recall': 0.49313188, 'binary_specificity': 0.98240554, 'binary_f1_score': 0.5370232}
confusion matrix:
       0    1
0  13959  250
1    369  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99319375, 'precision': 0.61189455, 'recall': 0.6086178, 'specificity': 0.6086178, 'f1': 0.6102312, 'auroc': 0.84011316, 'binary_precision': 0.22727273, 'binary_recall': 0.22058824, 'binary_specificity': 0.99664736, 'binary_f1_score': 0.2238806}
confusion matrix:
       0   1
0  15161  51
1     53  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
better model found
persisted
after epoch: 24,now: 2024-05-29 04:24:53.374659,epoch time: 0:16:23.416161,used: 6:36:39.752031,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9590904, 'precision': 0.79223, 'recall': 0.6887504, 'specificity': 0.6887504, 'f1': 0.72787154, 'auroc': 0.9374991, 'binary_precision': 0.6145833, 'binary_recall': 0.3897898, 'binary_specificity': 0.98771095, 'binary_f1_score': 0.4770305}
confusion matrix:
       0    1
0  32712  407
1   1016  649
---- Validation: 
scalar performance:
{'acc': 0.95809066, 'precision': 0.80526805, 'recall': 0.651508, 'specificity': 0.651508, 'f1': 0.69931483, 'auroc': 0.938402, 'binary_precision': 0.6448864, 'binary_recall': 0.31181318, 'binary_specificity': 0.9912028, 'binary_f1_score': 0.42037034}
confusion matrix:
       0    1
0  14084  125
1    501  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99528795, 'precision': 0.676508, 'recall': 0.53646886, 'specificity': 0.53646886, 'f1': 0.5597944, 'auroc': 0.8049631, 'binary_precision': 0.35714287, 'binary_recall': 0.073529415, 'binary_specificity': 0.99940836, 'binary_f1_score': 0.12195122}
confusion matrix:
       0  1
0  15203  9
1     63  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 1
val acc:0.9580906629562378, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9931937456130981 / 0.9956151843070984
after epoch: 25,now: 2024-05-29 04:41:16.998092,epoch time: 0:16:23.623433,used: 6:53:03.375464,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9576529, 'precision': 0.7864064, 'recall': 0.6597604, 'specificity': 0.6597604, 'f1': 0.7027649, 'auroc': 0.9382831, 'binary_precision': 0.6057269, 'binary_recall': 0.33033034, 'binary_specificity': 0.9891905, 'binary_f1_score': 0.42751655}
confusion matrix:
       0    1
0  32761  358
1   1115  550
---- Validation: 
scalar performance:
{'acc': 0.9569525, 'precision': 0.8065269, 'recall': 0.62288994, 'specificity': 0.62288994, 'f1': 0.67085916, 'auroc': 0.9408129, 'binary_precision': 0.6501767, 'binary_recall': 0.25274727, 'binary_specificity': 0.9930326, 'binary_f1_score': 0.36399606}
confusion matrix:
       0    1
0  14110   99
1    544  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9940445, 'precision': 0.6143758, 'recall': 0.57244474, 'specificity': 0.57244474, 'f1': 0.5885958, 'auroc': 0.8369222, 'binary_precision': 0.23255815, 'binary_recall': 0.14705883, 'binary_specificity': 0.9978307, 'binary_f1_score': 0.18018019}
confusion matrix:
       0   1
0  15179  33
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 2
val acc:0.9569525122642517, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9931937456130981 / 0.9956151843070984
after epoch: 26,now: 2024-05-29 04:57:47.009725,epoch time: 0:16:30.011633,used: 7:09:33.387097,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95900416, 'precision': 0.78667164, 'recall': 0.70496166, 'specificity': 0.70496166, 'f1': 0.73808193, 'auroc': 0.9384755, 'binary_precision': 0.60187554, 'binary_recall': 0.42402402, 'binary_specificity': 0.9858993, 'binary_f1_score': 0.4975335}
confusion matrix:
       0    1
0  32652  467
1    959  706
---- Validation: 
scalar performance:
{'acc': 0.9568856, 'precision': 0.79097724, 'recall': 0.64761645, 'specificity': 0.64761645, 'f1': 0.6928581, 'auroc': 0.93769944, 'binary_precision': 0.6166667, 'binary_recall': 0.30494505, 'binary_specificity': 0.99028784, 'binary_f1_score': 0.40808824}
confusion matrix:
       0    1
0  14071  138
1    506  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.5812039, 'recall': 0.5215658, 'specificity': 0.5215658, 'f1': 0.5335711, 'auroc': 0.82252884, 'binary_precision': 0.16666667, 'binary_recall': 0.04411765, 'binary_specificity': 0.99901396, 'binary_f1_score': 0.069767445}
confusion matrix:
       0   1
0  15197  15
1     65   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 3
val acc:0.956885576248169, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9931937456130981 / 0.9956151843070984
after epoch: 27,now: 2024-05-29 05:14:14.817254,epoch time: 0:16:27.807529,used: 7:26:01.194626,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9579979, 'precision': 0.7844065, 'recall': 0.67762417, 'specificity': 0.67762417, 'f1': 0.7170109, 'auroc': 0.93967974, 'binary_precision': 0.6, 'binary_recall': 0.36756757, 'binary_specificity': 0.9876808, 'binary_f1_score': 0.45586595}
confusion matrix:
       0    1
0  32711  408
1   1053  612
---- Validation: 
scalar performance:
{'acc': 0.957622, 'precision': 0.81844753, 'recall': 0.62324184, 'specificity': 0.62324184, 'f1': 0.67285436, 'auroc': 0.94195414, 'binary_precision': 0.6739927, 'binary_recall': 0.25274727, 'binary_specificity': 0.9937364, 'binary_f1_score': 0.3676324}
confusion matrix:
       0    1
0  14120   89
1    544  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9925393, 'precision': 0.592819, 'recall': 0.600969, 'specificity': 0.600969, 'f1': 0.59671766, 'auroc': 0.81782424, 'binary_precision': 0.1891892, 'binary_recall': 0.20588236, 'binary_specificity': 0.9960557, 'binary_f1_score': 0.1971831}
confusion matrix:
       0   1
0  15152  60
1     54  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 4
val acc:0.9576219916343689, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9931937456130981 / 0.9956151843070984
after epoch: 28,now: 2024-05-29 05:30:39.026417,epoch time: 0:16:24.209163,used: 7:42:25.403789,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9527369, 'precision': 0.8186941, 'recall': 0.51144, 'specificity': 0.51144, 'f1': 0.51053244, 'auroc': 0.93329394, 'binary_precision': 0.68421054, 'binary_recall': 0.023423424, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.045296166}
confusion matrix:
       0   1
0  33101  18
1   1626  39
---- Validation: 
scalar performance:
{'acc': 0.9516637, 'precision': 0.8509129, 'recall': 0.50607574, 'specificity': 0.50607574, 'f1': 0.49977115, 'auroc': 0.94026124, 'binary_precision': 0.75, 'binary_recall': 0.012362638, 'binary_specificity': 0.9997889, 'binary_f1_score': 0.024324324}
confusion matrix:
       0  1
0  14206  3
1    719  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.49777472, 'recall': 0.49996713, 'specificity': 0.49996713, 'f1': 0.49886853, 'auroc': 0.82245296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15211  1
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
early stop counter: 5
val acc:0.9516636729240417, best validation acc: 0.9585592746734619, corresponding to test acc:                         0.9931937456130981 / 0.9956151843070984
after epoch: 29,now: 2024-05-29 05:47:05.467049,epoch time: 0:16:26.440632,used: 7:58:51.844421,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95900416, 'precision': 0.7767636, 'recall': 0.7602911, 'specificity': 0.7602911, 'f1': 0.76823586, 'auroc': 0.9412088, 'binary_precision': 0.57655346, 'binary_recall': 0.5405405, 'binary_specificity': 0.9800417, 'binary_f1_score': 0.5579665}
confusion matrix:
       0    1
0  32458  661
1    765  900
---- Validation: 
scalar performance:
{'acc': 0.9586262, 'precision': 0.7917065, 'recall': 0.6980548, 'specificity': 0.6980548, 'f1': 0.7346879, 'auroc': 0.9432817, 'binary_precision': 0.6131687, 'binary_recall': 0.40934065, 'binary_specificity': 0.98676896, 'binary_f1_score': 0.49093908}
confusion matrix:
       0    1
0  14021  188
1    430  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9947644, 'precision': 0.65434813, 'recall': 0.5728063, 'specificity': 0.5728063, 'f1': 0.59868675, 'auroc': 0.8364222, 'binary_precision': 0.3125, 'binary_recall': 0.14705883, 'binary_specificity': 0.99855375, 'binary_f1_score': 0.2}
confusion matrix:
       0   1
0  15190  22
1     58  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897899.png
better model found
persisted
after epoch: 30,now: 2024-05-29 06:03:31.240824,epoch time: 0:16:25.773775,used: 8:15:17.618196,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_21_48_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:15:17.618196 at 2024-05-29 06:03:31.240824
persisted model performance metric: 

scalar performance:
{'acc': 0.9945026, 'precision': 0.60511035, 'recall': 0.5433945, 'specificity': 0.5433945, 'f1': 0.56112134, 'auroc': 0.8389275, 'binary_precision': 0.21428572, 'binary_recall': 0.0882353, 'binary_specificity': 0.99855375, 'binary_f1_score': 0.125}
confusion matrix:
       0   1
0  15190  22
1     62   6
oracle model performance metric: 

scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.79096633, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 503940 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 503940 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 497073 KiB |  13261 MiB |   2170 TiB |   2170 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   2144 TiB |   2144 TiB |
|       from small pool |  41102 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14506 MiB |  14520 MiB |  28012 MiB |  13506 MiB |
|       from large pool |  14438 MiB |  14450 MiB |  27924 MiB |  13486 MiB |
|       from small pool |     68 MiB |     70 MiB |     88 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 515964 KiB |   1244 MiB |   1621 TiB |   1621 TiB |
|       from large pool | 506092 KiB |   1235 MiB |   1595 TiB |   1595 TiB |
|       from small pool |   9871 KiB |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6866    |    7237    |  381894 K  |  381887 K  |
|       from large pool |     187    |    1413    |  198895 K  |  198895 K  |
|       from small pool |    6679    |    6975    |  182999 K  |  182992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6866    |    7237    |  381894 K  |  381887 K  |
|       from large pool |     187    |    1413    |  198895 K  |  198895 K  |
|       from small pool |    6679    |    6975    |  182999 K  |  182992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |    1208    |     570    |
|       from large pool |     604    |     604    |    1164    |     560    |
|       from small pool |      34    |      35    |      44    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2811    |  228060 K  |  228060 K  |
|       from large pool |      42    |     600    |  128197 K  |  128197 K  |
|       from small pool |      36    |    2764    |   99863 K  |   99863 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2170 TiB |   2170 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14520 MiB |  28012 MiB |  27016 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     70 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1621 TiB |   1621 TiB |
|       from large pool |      0 B   |   1235 MiB |   1595 TiB |   1595 TiB |
|       from small pool |      0 B   |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381894 K  |  381894 K  |
|       from large pool |       2    |    1413    |  198895 K  |  198895 K  |
|       from small pool |       0    |    6975    |  182999 K  |  182999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381894 K  |  381894 K  |
|       from large pool |       2    |    1413    |  198895 K  |  198895 K  |
|       from small pool |       0    |    6975    |  182999 K  |  182999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |    1208    |    1139    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      35    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  228063 K  |  228063 K  |
|       from large pool |       0    |     600    |  128197 K  |  128197 K  |
|       from small pool |       0    |    2764    |   99866 K  |   99866 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2174 TiB |   2174 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2148 TiB |   2148 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2170 TiB |   2170 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14520 MiB |  28012 MiB |  27016 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     70 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1621 TiB |   1621 TiB |
|       from large pool |      0 B   |   1235 MiB |   1595 TiB |   1595 TiB |
|       from small pool |      0 B   |     42 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381894 K  |  381894 K  |
|       from large pool |       2    |    1413    |  198895 K  |  198895 K  |
|       from small pool |       0    |    6975    |  182999 K  |  182999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381894 K  |  381894 K  |
|       from large pool |       2    |    1413    |  198895 K  |  198895 K  |
|       from small pool |       0    |    6975    |  182999 K  |  182999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |    1208    |    1139    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      35    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  228063 K  |  228063 K  |
|       from large pool |       0    |     600    |  128197 K  |  128197 K  |
|       from small pool |       0    |    2764    |   99866 K  |   99866 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899

 Experiment start at: 2024-05-29 06:13:13.028035
before training, model accuracy: 0.7692731618881226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.7406874, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.77559924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.5552243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 06:29:06.040529,epoch time: 0:15:53.012494,used: 0:15:53.012494,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.75770223, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.79151124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.59331656, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 2,now: 2024-05-29 06:44:11.538472,epoch time: 0:15:05.497943,used: 0:30:58.510437,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.7697124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8208083, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.5503789, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 2
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 3,now: 2024-05-29 06:59:09.416365,epoch time: 0:14:57.877893,used: 0:45:56.388330,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8033616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8118844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.59051204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 3
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 4,now: 2024-05-29 07:14:11.334482,epoch time: 0:15:01.918117,used: 1:00:58.306447,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8373121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8597802, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.61175394, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 4
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 5,now: 2024-05-29 07:29:11.618409,epoch time: 0:15:00.283927,used: 1:15:58.590374,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96574765, 'precision': 0.70594406, 'recall': 0.5274623, 'specificity': 0.5274623, 'f1': 0.5421283, 'auroc': 0.8842144, 'binary_precision': 0.44385028, 'binary_recall': 0.057439446, 'binary_specificity': 0.99748516, 'binary_f1_score': 0.101715684}
confusion matrix:
       0    1
0  41251  104
1   1362   83
---- Validation: 
scalar performance:
{'acc': 0.9654758, 'precision': 0.8638072, 'recall': 0.51230013, 'specificity': 0.51230013, 'f1': 0.51530594, 'auroc': 0.9049727, 'binary_precision': 0.7619048, 'binary_recall': 0.02488336, 'binary_specificity': 0.99971694, 'binary_f1_score': 0.048192777}
confusion matrix:
       0   1
0  17658   5
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95931596, 'precision': 0.6704776, 'recall': 0.5178047, 'specificity': 0.5178047, 'f1': 0.524302, 'auroc': 0.62327147, 'binary_precision': 0.37931034, 'binary_recall': 0.038194444, 'binary_specificity': 0.9974149, 'binary_f1_score': 0.06940063}
confusion matrix:
      0   1
0  6945  18
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
better model found
persisted
after epoch: 6,now: 2024-05-29 07:44:14.445706,epoch time: 0:15:02.827297,used: 1:31:01.417671,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.69154125, 'recall': 0.5016491, 'specificity': 0.5016491, 'f1': 0.49485844, 'auroc': 0.9004245, 'binary_precision': 0.41666666, 'binary_recall': 0.0034674064, 'binary_specificity': 0.9998307, 'binary_f1_score': 0.0068775793}
confusion matrix:
       0  1
0  41351  7
1   1437  5
---- Validation: 
scalar performance:
{'acc': 0.96476567, 'precision': 0.48243552, 'recall': 0.49994338, 'specificity': 0.49994338, 'f1': 0.49103343, 'auroc': 0.9057127, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99988675, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17661  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.48013794, 'recall': 0.4999282, 'specificity': 0.4999282, 'f1': 0.48983327, 'auroc': 0.7888428, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6962  1
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 1
val acc:0.9647656679153442, best validation acc: 0.9654757976531982, corresponding to test acc:                         0.9593159556388855 / 0.9602813124656677
after epoch: 7,now: 2024-05-29 07:59:17.269036,epoch time: 0:15:02.823330,used: 1:46:04.241001,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96621495, 'precision': 0.70538455, 'recall': 0.50132364, 'specificity': 0.50132364, 'f1': 0.4941588, 'auroc': 0.9238703, 'binary_precision': 0.44444445, 'binary_recall': 0.0027681661, 'binary_specificity': 0.9998791, 'binary_f1_score': 0.005502064}
confusion matrix:
       0  1
0  41350  5
1   1441  4
---- Validation: 
scalar performance:
{'acc': 0.96482027, 'precision': 0.48243648, 'recall': 0.4999717, 'specificity': 0.4999717, 'f1': 0.4910476, 'auroc': 0.9352102, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999434, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17662  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.73947537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 2
val acc:0.9648202657699585, best validation acc: 0.9654757976531982, corresponding to test acc:                         0.9593159556388855 / 0.9602813124656677
after epoch: 8,now: 2024-05-29 08:14:21.039239,epoch time: 0:15:03.770203,used: 2:01:08.011204,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96785045, 'precision': 0.7786382, 'recall': 0.57834965, 'specificity': 0.57834965, 'f1': 0.617873, 'auroc': 0.9269391, 'binary_precision': 0.5858586, 'binary_recall': 0.16066483, 'binary_specificity': 0.99603444, 'binary_f1_score': 0.25217393}
confusion matrix:
       0    1
0  41192  164
1   1212  232
---- Validation: 
scalar performance:
{'acc': 0.9659674, 'precision': 0.8012227, 'recall': 0.5357831, 'specificity': 0.5357831, 'f1': 0.5568728, 'auroc': 0.9396856, 'binary_precision': 0.6351351, 'binary_recall': 0.07309487, 'binary_specificity': 0.9984714, 'binary_f1_score': 0.13110182}
confusion matrix:
       0   1
0  17636  27
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.48013794, 'recall': 0.4999282, 'specificity': 0.4999282, 'f1': 0.48983327, 'auroc': 0.8024832, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6962  1
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
better model found
persisted
after epoch: 9,now: 2024-05-29 08:29:45.671680,epoch time: 0:15:24.632441,used: 2:16:32.643645,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9673365, 'precision': 0.7919953, 'recall': 0.5416591, 'specificity': 0.5416591, 'f1': 0.5664917, 'auroc': 0.92708707, 'binary_precision': 0.615, 'binary_recall': 0.08518006, 'binary_specificity': 0.9981381, 'binary_f1_score': 0.14963505}
confusion matrix:
       0    1
0  41279   77
1   1321  123
---- Validation: 
scalar performance:
{'acc': 0.9654212, 'precision': 0.8716918, 'recall': 0.51077324, 'specificity': 0.51077324, 'f1': 0.51237637, 'auroc': 0.9392221, 'binary_precision': 0.7777778, 'binary_recall': 0.02177294, 'binary_specificity': 0.99977356, 'binary_f1_score': 0.04236006}
confusion matrix:
       0   1
0  17659   4
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.7574165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 1
val acc:0.965421199798584, best validation acc: 0.9659674167633057, corresponding to test acc:                         0.9601434469223022 / 0.9602813124656677
after epoch: 10,now: 2024-05-29 08:44:48.540602,epoch time: 0:15:02.868922,used: 2:31:35.512567,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.93156147, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9443244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.830438, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 2
val acc:0.9648749232292175, best validation acc: 0.9659674167633057, corresponding to test acc:                         0.9601434469223022 / 0.9602813124656677
after epoch: 11,now: 2024-05-29 08:59:57.475013,epoch time: 0:15:08.934411,used: 2:46:44.446978,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9657009, 'precision': 0.7360702, 'recall': 0.7167766, 'specificity': 0.7167766, 'f1': 0.72596526, 'auroc': 0.93332326, 'binary_precision': 0.49130765, 'binary_recall': 0.449827, 'binary_specificity': 0.98372626, 'binary_f1_score': 0.4696532}
confusion matrix:
       0    1
0  40682  673
1    795  650
---- Validation: 
scalar performance:
{'acc': 0.96585816, 'precision': 0.7485298, 'recall': 0.6765944, 'specificity': 0.6765944, 'f1': 0.7058133, 'auroc': 0.9448484, 'binary_precision': 0.5199115, 'binary_recall': 0.36547434, 'binary_specificity': 0.9877144, 'binary_f1_score': 0.42922375}
confusion matrix:
       0    1
0  17446  217
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.750692, 'recall': 0.59203935, 'specificity': 0.59203935, 'f1': 0.6307082, 'auroc': 0.81143856, 'binary_precision': 0.5339806, 'binary_recall': 0.19097222, 'binary_specificity': 0.9931064, 'binary_f1_score': 0.28132993}
confusion matrix:
      0   1
0  6915  48
1   233  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
new oracle model saved
early stop counter: 3
val acc:0.9658581614494324, best validation acc: 0.9659674167633057, corresponding to test acc:                         0.9601434469223022 / 0.9612467288970947
after epoch: 12,now: 2024-05-29 09:15:09.130245,epoch time: 0:15:11.655232,used: 3:01:56.102210,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9682243, 'precision': 0.78486496, 'recall': 0.58784956, 'specificity': 0.58784956, 'f1': 0.6301756, 'auroc': 0.9382868, 'binary_precision': 0.59770113, 'binary_recall': 0.17993079, 'binary_specificity': 0.99576837, 'binary_f1_score': 0.27659574}
confusion matrix:
       0    1
0  41180  175
1   1185  260
---- Validation: 
scalar performance:
{'acc': 0.96585816, 'precision': 0.8581418, 'recall': 0.52074057, 'specificity': 0.52074057, 'f1': 0.5310676, 'auroc': 0.9487746, 'binary_precision': 0.75, 'binary_recall': 0.041990668, 'binary_specificity': 0.99949044, 'binary_f1_score': 0.07952872}
confusion matrix:
       0   1
0  17654   9
1    616  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.73020416, 'recall': 0.50166434, 'specificity': 0.50166434, 'f1': 0.493316, 'auroc': 0.8234415, 'binary_precision': 0.5, 'binary_recall': 0.0034722222, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.006896552}
confusion matrix:
      0  1
0  6962  1
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 4
val acc:0.9658581614494324, best validation acc: 0.9659674167633057, corresponding to test acc:                         0.9601434469223022 / 0.9612467288970947
after epoch: 13,now: 2024-05-29 09:30:23.193720,epoch time: 0:15:14.063475,used: 3:17:10.165685,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96642524, 'precision': 0.73952913, 'recall': 0.5769438, 'specificity': 0.5769438, 'f1': 0.61266017, 'auroc': 0.9312953, 'binary_precision': 0.50772625, 'binary_recall': 0.15927978, 'binary_specificity': 0.9946078, 'binary_f1_score': 0.24248815}
confusion matrix:
       0    1
0  41133  223
1   1214  230
---- Validation: 
scalar performance:
{'acc': 0.96804327, 'precision': 0.78829706, 'recall': 0.62902236, 'specificity': 0.62902236, 'f1': 0.67558753, 'auroc': 0.9434476, 'binary_precision': 0.6028369, 'binary_recall': 0.2643857, 'binary_specificity': 0.9936591, 'binary_f1_score': 0.3675676}
confusion matrix:
       0    1
0  17551  112
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.9091071, 'recall': 0.51034486, 'specificity': 0.51034486, 'f1': 0.51037914, 'auroc': 0.7767192, 'binary_precision': 0.85714287, 'binary_recall': 0.020833334, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.04067797}
confusion matrix:
      0  1
0  6962  1
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
better model found
persisted
after epoch: 14,now: 2024-05-29 09:45:58.362485,epoch time: 0:15:35.168765,used: 3:32:45.334450,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96817756, 'precision': 0.77616876, 'recall': 0.6021844, 'specificity': 0.6021844, 'f1': 0.6458206, 'auroc': 0.93706167, 'binary_precision': 0.5793499, 'binary_recall': 0.20968857, 'binary_specificity': 0.9946802, 'binary_f1_score': 0.30792683}
confusion matrix:
       0    1
0  41135  220
1   1142  303
---- Validation: 
scalar performance:
{'acc': 0.9671146, 'precision': 0.8267611, 'recall': 0.5581072, 'specificity': 0.5581072, 'f1': 0.59240156, 'auroc': 0.94881713, 'binary_precision': 0.6846847, 'binary_recall': 0.11819596, 'binary_specificity': 0.99801844, 'binary_f1_score': 0.2015915}
confusion matrix:
       0   1
0  17628  35
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.81360376, 'recall': 0.50340044, 'specificity': 0.50340044, 'f1': 0.49677506, 'auroc': 0.8025446, 'binary_precision': 0.6666667, 'binary_recall': 0.0069444445, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.013745705}
confusion matrix:
      0  1
0  6962  1
1   286  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 1
val acc:0.9671146273612976, best validation acc: 0.9680432677268982, corresponding to test acc:                         0.9609708786010742 / 0.9612467288970947
after epoch: 15,now: 2024-05-29 10:01:19.274165,epoch time: 0:15:20.911680,used: 3:48:06.246130,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96990657, 'precision': 0.78306353, 'recall': 0.67687774, 'specificity': 0.67687774, 'f1': 0.7165806, 'auroc': 0.939134, 'binary_precision': 0.58810323, 'binary_recall': 0.36262977, 'binary_specificity': 0.99112564, 'binary_f1_score': 0.44863012}
confusion matrix:
       0    1
0  40988  367
1    921  524
---- Validation: 
scalar performance:
{'acc': 0.96842563, 'precision': 0.8316531, 'recall': 0.5895078, 'specificity': 0.5895078, 'f1': 0.636016, 'auroc': 0.94883275, 'binary_precision': 0.6923077, 'binary_recall': 0.18195957, 'binary_specificity': 0.997056, 'binary_f1_score': 0.28817737}
confusion matrix:
       0    1
0  17611   52
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.75823903, 'recall': 0.50839335, 'specificity': 0.50839335, 'f1': 0.506733, 'auroc': 0.7977276, 'binary_precision': 0.5555556, 'binary_recall': 0.017361112, 'binary_specificity': 0.99942553, 'binary_f1_score': 0.033670034}
confusion matrix:
      0  1
0  6959  4
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
better model found
persisted
after epoch: 16,now: 2024-05-29 10:16:37.039346,epoch time: 0:15:17.765181,used: 4:03:24.011311,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9664486, 'precision': 0.78341717, 'recall': 0.50912493, 'specificity': 0.50912493, 'f1': 0.50958437, 'auroc': 0.9392011, 'binary_precision': 0.6, 'binary_recall': 0.018685121, 'binary_specificity': 0.99956477, 'binary_f1_score': 0.036241613}
confusion matrix:
       0   1
0  41337  18
1   1418  27
---- Validation: 
scalar performance:
{'acc': 0.96476567, 'precision': 0.6825372, 'recall': 0.5029406, 'specificity': 0.5029406, 'f1': 0.49715704, 'auroc': 0.9489777, 'binary_precision': 0.4, 'binary_recall': 0.00622084, 'binary_specificity': 0.9996603, 'binary_f1_score': 0.012251149}
confusion matrix:
       0  1
0  17657  6
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.73020416, 'recall': 0.50166434, 'specificity': 0.50166434, 'f1': 0.493316, 'auroc': 0.8402136, 'binary_precision': 0.5, 'binary_recall': 0.0034722222, 'binary_specificity': 0.9998564, 'binary_f1_score': 0.006896552}
confusion matrix:
      0  1
0  6962  1
1   287  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897899.png
early stop counter: 1
val acc:0.9647656679153442, best validation acc: 0.9684256315231323, corresponding to test acc:                         0.960419237613678 / 0.9612467288970947
after epoch: 17,now: 2024-05-29 10:31:47.004349,epoch time: 0:15:09.965003,used: 4:18:33.976314,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_13_13_seed_0_20897899
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 20897899 ON supergpu15 CANCELLED AT 2024-05-29T10:35:58 ***
