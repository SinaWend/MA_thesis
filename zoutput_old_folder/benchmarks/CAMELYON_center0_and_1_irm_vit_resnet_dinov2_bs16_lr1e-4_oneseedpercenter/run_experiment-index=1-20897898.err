Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue May 28 06:18:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898

 Experiment start at: 2024-05-28 06:30:04.232477
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.7213495, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.753008, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6211548, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 06:53:48.087251,epoch time: 0:23:43.854774,used: 0:23:43.854774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.74529815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.76711285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6733148, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-05-28 07:16:01.258744,epoch time: 0:22:13.171493,used: 0:45:57.026267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.85240084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8638092, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.79672164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-05-28 07:38:25.515635,epoch time: 0:22:24.256891,used: 1:08:21.283158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.4832043, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.491453, 'auroc': 0.9158399, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  1
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.98296875, 'recall': 0.5023328, 'specificity': 0.5023328, 'f1': 0.4959808, 'auroc': 0.92740774, 'binary_precision': 1.0, 'binary_recall': 0.00466563, 'binary_specificity': 1.0, 'binary_f1_score': 0.009287926}
confusion matrix:
       0  1
0  18149  0
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8795932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
better model found
persisted
after epoch: 4,now: 2024-05-28 08:00:43.031853,epoch time: 0:22:17.516218,used: 1:30:38.799376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9162952, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.93214595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8966924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-05-28 08:22:57.554533,epoch time: 0:22:14.522680,used: 1:52:53.322056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.9448638, 'recall': 0.50406426, 'specificity': 0.50406426, 'f1': 0.4995964, 'auroc': 0.8932857, 'binary_precision': 0.9230769, 'binary_recall': 0.008152174, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.016161615}
confusion matrix:
       0   1
0  42319   1
1   1460  12
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.90832627, 'recall': 0.5131366, 'specificity': 0.5131366, 'f1': 0.51712286, 'auroc': 0.9226335, 'binary_precision': 0.85, 'binary_recall': 0.02643857, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.05128205}
confusion matrix:
       0   1
0  18146   3
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.79988444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
better model found
persisted
after epoch: 6,now: 2024-05-28 08:45:10.676584,epoch time: 0:22:13.122051,used: 2:15:06.444107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9211746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9344586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.881909, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-05-28 09:07:29.282579,epoch time: 0:22:18.605995,used: 2:37:25.050102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.744035, 'recall': 0.65543485, 'specificity': 0.65543485, 'f1': 0.6889018, 'auroc': 0.93097425, 'binary_precision': 0.51135135, 'binary_recall': 0.32154995, 'binary_specificity': 0.98931974, 'binary_f1_score': 0.39482468}
confusion matrix:
       0    1
0  41869  452
1    998  473
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.774786, 'recall': 0.58105487, 'specificity': 0.58105487, 'f1': 0.6208747, 'auroc': 0.9399344, 'binary_precision': 0.5783784, 'binary_recall': 0.16640747, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.2584541}
confusion matrix:
       0    1
0  18071   78
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8003465, 'recall': 0.52990097, 'specificity': 0.52990097, 'f1': 0.54555976, 'auroc': 0.90928143, 'binary_precision': 0.64, 'binary_recall': 0.06130268, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11188811}
confusion matrix:
      0   1
0  5988   9
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-28 09:29:41.116893,epoch time: 0:22:11.834314,used: 2:59:36.884416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.7432735, 'recall': 0.6676568, 'specificity': 0.6676568, 'f1': 0.6977807, 'auroc': 0.93443733, 'binary_precision': 0.50898206, 'binary_recall': 0.3469388, 'binary_specificity': 0.9883748, 'binary_f1_score': 0.41262138}
confusion matrix:
       0    1
0  41830  492
1    960  510
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.77277184, 'recall': 0.6241386, 'specificity': 0.6241386, 'f1': 0.6681322, 'auroc': 0.94742584, 'binary_precision': 0.5714286, 'binary_recall': 0.25505444, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.3526882}
confusion matrix:
       0    1
0  18026  123
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8419615, 'recall': 0.5583865, 'specificity': 0.5583865, 'f1': 0.5920654, 'auroc': 0.90011036, 'binary_precision': 0.7209302, 'binary_recall': 0.118773945, 'binary_specificity': 0.997999, 'binary_f1_score': 0.20394737}
confusion matrix:
      0   1
0  5985  12
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-05-28 09:52:22.159644,epoch time: 0:22:41.042751,used: 3:22:17.927167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.7623509, 'recall': 0.5095788, 'specificity': 0.5095788, 'f1': 0.5105116, 'auroc': 0.9270185, 'binary_precision': 0.5576923, 'binary_recall': 0.019701088, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.03805775}
confusion matrix:
       0   1
0  42297  23
1   1443  29
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.782967, 'recall': 0.50227773, 'specificity': 0.50227773, 'f1': 0.49593896, 'auroc': 0.93929183, 'binary_precision': 0.6, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.009259259}
confusion matrix:
       0  1
0  18147  2
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9022546, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9613295197486877
after epoch: 10,now: 2024-05-28 10:15:21.855580,epoch time: 0:22:59.695936,used: 3:45:17.623103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9615912, 'precision': 0.7076101, 'recall': 0.723086, 'specificity': 0.723086, 'f1': 0.71503407, 'auroc': 0.92212343, 'binary_precision': 0.43379572, 'binary_recall': 0.4673913, 'binary_specificity': 0.97878075, 'binary_f1_score': 0.4499673}
confusion matrix:
       0    1
0  41422  898
1    784  688
---- Validation: 
scalar performance:
{'acc': 0.96450615, 'precision': 0.72273093, 'recall': 0.6410993, 'specificity': 0.6410993, 'f1': 0.671734, 'auroc': 0.93143153, 'binary_precision': 0.47014925, 'binary_recall': 0.29393467, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.36172247}
confusion matrix:
       0    1
0  17936  213
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.8452769, 'recall': 0.746539, 'specificity': 0.746539, 'f1': 0.7868019, 'auroc': 0.89380836, 'binary_precision': 0.7119565, 'binary_recall': 0.5019157, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.5887641}
confusion matrix:
      0    1
0  5944   53
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
new oracle model saved
early stop counter: 2
val acc:0.9645061492919922, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 11,now: 2024-05-28 10:38:40.557705,epoch time: 0:23:18.702125,used: 4:08:36.325228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7435005, 'recall': 0.73294544, 'specificity': 0.73294544, 'f1': 0.7380929, 'auroc': 0.9400563, 'binary_precision': 0.50497866, 'binary_recall': 0.48233697, 'binary_specificity': 0.9835539, 'binary_f1_score': 0.4933982}
confusion matrix:
       0    1
0  41624  696
1    762  710
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.74944204, 'recall': 0.70081574, 'specificity': 0.70081574, 'f1': 0.72221786, 'auroc': 0.94833064, 'binary_precision': 0.51945525, 'binary_recall': 0.41524106, 'binary_specificity': 0.9863904, 'binary_f1_score': 0.46153846}
confusion matrix:
       0    1
0  17902  247
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.84238863, 'recall': 0.60544544, 'specificity': 0.60544544, 'f1': 0.6558709, 'auroc': 0.9037918, 'binary_precision': 0.71794873, 'binary_recall': 0.21455939, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3303835}
confusion matrix:
      0   1
0  5975  22
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 3
val acc:0.9668475985527039, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 12,now: 2024-05-28 11:02:31.187800,epoch time: 0:23:50.630095,used: 4:32:26.955323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.75958616, 'recall': 0.601595, 'specificity': 0.601595, 'f1': 0.6429776, 'auroc': 0.93193245, 'binary_precision': 0.5460993, 'binary_recall': 0.20923913, 'binary_specificity': 0.99395084, 'binary_f1_score': 0.302554}
confusion matrix:
       0    1
0  42064  256
1   1164  308
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7867586, 'recall': 0.58277535, 'specificity': 0.58277535, 'f1': 0.62403893, 'auroc': 0.94227743, 'binary_precision': 0.6022099, 'binary_recall': 0.16951789, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.2645631}
confusion matrix:
       0    1
0  18077   72
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8035006, 'recall': 0.52057254, 'specificity': 0.52057254, 'f1': 0.5291091, 'auroc': 0.8949585, 'binary_precision': 0.64705884, 'binary_recall': 0.042145595, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07913669}
confusion matrix:
      0   1
0  5991   6
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 4
val acc:0.96775221824646, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 13,now: 2024-05-28 11:25:26.864456,epoch time: 0:22:55.676656,used: 4:55:22.631979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.967574, 'precision': 0.75485694, 'recall': 0.63241374, 'specificity': 0.63241374, 'f1': 0.67243767, 'auroc': 0.9274233, 'binary_precision': 0.53457445, 'binary_recall': 0.2730978, 'binary_specificity': 0.9917297, 'binary_f1_score': 0.36151078}
confusion matrix:
       0    1
0  41970  350
1   1070  402
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7674645, 'recall': 0.5590002, 'specificity': 0.5590002, 'f1': 0.5913808, 'auroc': 0.9310442, 'binary_precision': 0.5652174, 'binary_recall': 0.121306375, 'binary_specificity': 0.996694, 'binary_f1_score': 0.19974391}
confusion matrix:
       0   1
0  18089  60
1    565  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.94178957, 'recall': 0.5858734, 'specificity': 0.5858734, 'f1': 0.63614935, 'auroc': 0.8986672, 'binary_precision': 0.9183673, 'binary_recall': 0.1724138, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2903226}
confusion matrix:
      0   1
0  5993   4
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 5
val acc:0.966741144657135, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 14,now: 2024-05-28 11:47:57.511374,epoch time: 0:22:30.646918,used: 5:17:53.278897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.76341903, 'recall': 0.62378603, 'specificity': 0.62378603, 'f1': 0.6661381, 'auroc': 0.93914235, 'binary_precision': 0.55228275, 'binary_recall': 0.25475544, 'binary_specificity': 0.9928166, 'binary_f1_score': 0.34867504}
confusion matrix:
       0    1
0  42016  304
1   1097  375
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7557888, 'recall': 0.5806967, 'specificity': 0.5806967, 'f1': 0.6186973, 'auroc': 0.9470649, 'binary_precision': 0.540404, 'binary_recall': 0.16640747, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.25445896}
confusion matrix:
       0    1
0  18058   91
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9563496, 'recall': 0.5707145, 'specificity': 0.5707145, 'f1': 0.6140832, 'auroc': 0.90839744, 'binary_precision': 0.94871795, 'binary_recall': 0.14176245, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.24666664}
confusion matrix:
      0   1
0  5995   2
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 6
val acc:0.9666347503662109, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 15,now: 2024-05-28 12:10:19.273669,epoch time: 0:22:21.762295,used: 5:40:15.041192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9680307, 'precision': 0.75948274, 'recall': 0.65133804, 'specificity': 0.65133804, 'f1': 0.689806, 'auroc': 0.94203734, 'binary_precision': 0.5425532, 'binary_recall': 0.31182066, 'binary_specificity': 0.9908554, 'binary_f1_score': 0.39603108}
confusion matrix:
       0    1
0  41933  387
1   1013  459
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7578254, 'recall': 0.67642206, 'specificity': 0.67642206, 'f1': 0.7087139, 'auroc': 0.9512565, 'binary_precision': 0.537931, 'binary_recall': 0.36391914, 'binary_specificity': 0.988925, 'binary_f1_score': 0.43413728}
confusion matrix:
       0    1
0  17948  201
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.90074766, 'recall': 0.53989637, 'specificity': 0.53989637, 'f1': 0.5634511, 'auroc': 0.91282356, 'binary_precision': 0.84, 'binary_recall': 0.08045977, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5993   4
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 7
val acc:0.967539370059967, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 16,now: 2024-05-28 12:32:32.893138,epoch time: 0:22:13.619469,used: 6:02:28.660661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.77295375, 'recall': 0.5321544, 'specificity': 0.5321544, 'f1': 0.55081797, 'auroc': 0.9385612, 'binary_precision': 0.57738096, 'binary_recall': 0.065986395, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.11843713}
confusion matrix:
       0   1
0  42251  71
1   1373  97
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72229415, 'recall': 0.50822306, 'specificity': 0.50822306, 'f1': 0.5077945, 'auroc': 0.9487899, 'binary_precision': 0.47826087, 'binary_recall': 0.01710731, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.033033036}
confusion matrix:
       0   1
0  18137  12
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9184533, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 8
val acc:0.9657300710678101, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.9707574248313904
after epoch: 17,now: 2024-05-28 12:57:01.922495,epoch time: 0:24:29.029357,used: 6:26:57.690018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9660897, 'precision': 0.7395408, 'recall': 0.7509866, 'specificity': 0.7509866, 'f1': 0.74511456, 'auroc': 0.944244, 'binary_precision': 0.49579287, 'binary_recall': 0.52038044, 'binary_specificity': 0.98159266, 'binary_f1_score': 0.50778913}
confusion matrix:
       0    1
0  41541  779
1    706  766
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7471485, 'recall': 0.74418116, 'specificity': 0.74418116, 'f1': 0.7456548, 'auroc': 0.951987, 'binary_precision': 0.511811, 'binary_recall': 0.5054432, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.50860715}
confusion matrix:
       0    1
0  17839  310
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.9243717, 'recall': 0.7645326, 'specificity': 0.7645326, 'f1': 0.8242547, 'auroc': 0.91215456, 'binary_precision': 0.86875, 'binary_recall': 0.532567, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6603325}
confusion matrix:
      0    1
0  5976   21
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
new oracle model saved
early stop counter: 9
val acc:0.9665815234184265, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 18,now: 2024-05-28 13:22:03.592452,epoch time: 0:25:01.669957,used: 6:51:59.359975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9658385, 'precision': 0.7382731, 'recall': 0.76069236, 'specificity': 0.76069236, 'f1': 0.74891955, 'auroc': 0.9313024, 'binary_precision': 0.49257424, 'binary_recall': 0.5407609, 'binary_specificity': 0.98062384, 'binary_f1_score': 0.51554406}
confusion matrix:
       0    1
0  41500  820
1    676  796
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7348558, 'recall': 0.7432996, 'specificity': 0.7432996, 'f1': 0.7389942, 'auroc': 0.9422833, 'binary_precision': 0.48725638, 'binary_recall': 0.5054432, 'binary_specificity': 0.981156, 'binary_f1_score': 0.4961832}
confusion matrix:
       0    1
0  17807  342
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8820022, 'recall': 0.6988149, 'specificity': 0.6988149, 'f1': 0.7589079, 'auroc': 0.8882601, 'binary_precision': 0.7894737, 'binary_recall': 0.40229884, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5329949}
confusion matrix:
      0    1
0  5969   28
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 10
val acc:0.9648786783218384, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 19,now: 2024-05-28 13:44:27.494109,epoch time: 0:22:23.901657,used: 7:14:23.261632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96275574, 'precision': 0.72781193, 'recall': 0.84827507, 'specificity': 0.84827507, 'f1': 0.77378523, 'auroc': 0.9459443, 'binary_precision': 0.46535948, 'binary_recall': 0.7255435, 'binary_specificity': 0.97100663, 'binary_f1_score': 0.56702954}
confusion matrix:
       0     1
0  41093  1227
1    404  1068
---- Validation: 
scalar performance:
{'acc': 0.96365476, 'precision': 0.7335021, 'recall': 0.82967234, 'specificity': 0.82967234, 'f1': 0.77230805, 'auroc': 0.95433784, 'binary_precision': 0.47830802, 'binary_recall': 0.6858476, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.5635783}
confusion matrix:
       0    1
0  17668  481
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.83504456, 'recall': 0.7367103, 'specificity': 0.7367103, 'f1': 0.7765142, 'auroc': 0.9117824, 'binary_precision': 0.6923077, 'binary_recall': 0.4827586, 'binary_specificity': 0.990662, 'binary_f1_score': 0.5688488}
confusion matrix:
      0    1
0  5941   56
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 11
val acc:0.9636547565460205, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 20,now: 2024-05-28 14:08:13.552779,epoch time: 0:23:46.058670,used: 7:38:09.320302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9693323, 'precision': 0.79753554, 'recall': 0.6097176, 'specificity': 0.6097176, 'f1': 0.65690655, 'auroc': 0.9487463, 'binary_precision': 0.6214689, 'binary_recall': 0.22418478, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.32950577}
confusion matrix:
       0    1
0  42119  201
1   1142  330
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.8015076, 'recall': 0.57463497, 'specificity': 0.57463497, 'f1': 0.61462456, 'auroc': 0.95489943, 'binary_precision': 0.63225806, 'binary_recall': 0.15241058, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.24561405}
confusion matrix:
       0   1
0  18092  57
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9196953, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 12
val acc:0.9679650664329529, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 21,now: 2024-05-28 14:33:30.493350,epoch time: 0:25:16.940571,used: 8:03:26.260873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.8375449, 'recall': 0.50569177, 'specificity': 0.50569177, 'f1': 0.50287235, 'auroc': 0.94264925, 'binary_precision': 0.7083333, 'binary_recall': 0.011548913, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.022727272}
confusion matrix:
       0   1
0  42313   7
1   1455  17
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.77642167, 'recall': 0.51288867, 'specificity': 0.51288867, 'f1': 0.51665545, 'auroc': 0.9525846, 'binary_precision': 0.5862069, 'binary_recall': 0.02643857, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.05059524}
confusion matrix:
       0   1
0  18137  12
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91264904, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 13
val acc:0.9660493731498718, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 22,now: 2024-05-28 14:58:32.126807,epoch time: 0:25:01.633457,used: 8:28:27.894330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.9832374, 'recall': 0.5013587, 'specificity': 0.5013587, 'f1': 0.49418584, 'auroc': 0.9383669, 'binary_precision': 1.0, 'binary_recall': 0.0027173914, 'binary_specificity': 1.0, 'binary_f1_score': 0.0054200543}
confusion matrix:
       0  1
0  42320  0
1   1468  4
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.98299444, 'recall': 0.5031104, 'specificity': 0.5031104, 'f1': 0.49753252, 'auroc': 0.9458986, 'binary_precision': 1.0, 'binary_recall': 0.00622084, 'binary_specificity': 1.0, 'binary_f1_score': 0.012364761}
confusion matrix:
       0  1
0  18149  0
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9112944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 14
val acc:0.9659961462020874, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 23,now: 2024-05-28 15:25:41.487124,epoch time: 0:27:09.360317,used: 8:55:37.254647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9670716, 'precision': 0.78416663, 'recall': 0.52986175, 'specificity': 0.52986175, 'f1': 0.5470996, 'auroc': 0.9326241, 'binary_precision': 0.6, 'binary_recall': 0.061141305, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.11097411}
confusion matrix:
       0   1
0  42260  60
1   1382  90
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.79037786, 'recall': 0.5372486, 'specificity': 0.5372486, 'f1': 0.5592954, 'auroc': 0.9414472, 'binary_precision': 0.6125, 'binary_recall': 0.07620529, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.13554634}
confusion matrix:
       0   1
0  18118  31
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.90246135, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 15
val acc:0.966741144657135, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 24,now: 2024-05-28 15:49:17.225100,epoch time: 0:23:35.737976,used: 9:19:12.992623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96787083, 'precision': 0.88229567, 'recall': 0.5289719, 'specificity': 0.5289719, 'f1': 0.5462851, 'auroc': 0.9479533, 'binary_precision': 0.7962963, 'binary_recall': 0.05846363, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.1089297}
confusion matrix:
       0   1
0  42299  22
1   1385  86
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.86827135, 'recall': 0.52308017, 'specificity': 0.52308017, 'f1': 0.53556055, 'auroc': 0.9559566, 'binary_precision': 0.7692308, 'binary_recall': 0.0466563, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.08797654}
confusion matrix:
       0   1
0  18140   9
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.92104757, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 16
val acc:0.9669008255004883, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9613295197486877 / 0.977149248123169
after epoch: 25,now: 2024-05-28 16:11:38.747217,epoch time: 0:22:21.522117,used: 9:41:34.514740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9691496, 'precision': 0.7865519, 'recall': 0.6217539, 'specificity': 0.6217539, 'f1': 0.6681185, 'auroc': 0.9479027, 'binary_precision': 0.5986949, 'binary_recall': 0.24932066, 'binary_specificity': 0.9941871, 'binary_f1_score': 0.35203835}
confusion matrix:
       0    1
0  42074  246
1   1105  367
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.77438325, 'recall': 0.63855493, 'specificity': 0.63855493, 'f1': 0.6820915, 'auroc': 0.95639366, 'binary_precision': 0.5736677, 'binary_recall': 0.28460342, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.38045737}
confusion matrix:
       0    1
0  18013  136
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.91320264, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
better model found
persisted
after epoch: 26,now: 2024-05-28 16:33:58.588039,epoch time: 0:22:19.840822,used: 10:03:54.355562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9689441, 'precision': 0.7633288, 'recall': 0.72164464, 'specificity': 0.72164464, 'f1': 0.7405094, 'auroc': 0.94823146, 'binary_precision': 0.54545456, 'binary_recall': 0.45652175, 'binary_specificity': 0.9867675, 'binary_f1_score': 0.49704146}
confusion matrix:
       0    1
0  41760  560
1    800  672
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.7600857, 'recall': 0.71492285, 'specificity': 0.71492285, 'f1': 0.7351292, 'auroc': 0.9551562, 'binary_precision': 0.53977275, 'binary_recall': 0.44323483, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.48676348}
confusion matrix:
       0    1
0  17906  243
1    358  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.9154508, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9680182933807373, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9584531784057617 / 0.977149248123169
after epoch: 27,now: 2024-05-28 16:57:03.693107,epoch time: 0:23:05.105068,used: 10:26:59.460630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.78322566, 'recall': 0.5009954, 'specificity': 0.5009954, 'f1': 0.49348944, 'auroc': 0.94446754, 'binary_precision': 0.6, 'binary_recall': 0.0020380435, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.004062288}
confusion matrix:
       0  1
0  42318  2
1   1469  3
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.8162755, 'recall': 0.50152767, 'specificity': 0.50152767, 'f1': 0.49440578, 'auroc': 0.9473542, 'binary_precision': 0.6666667, 'binary_recall': 0.00311042, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0061919508}
confusion matrix:
       0  1
0  18148  1
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91430855, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 2
val acc:0.9658365249633789, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9584531784057617 / 0.977149248123169
after epoch: 28,now: 2024-05-28 17:20:53.586433,epoch time: 0:23:49.893326,used: 10:50:49.353956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9698575, 'precision': 0.77867806, 'recall': 0.6850691, 'specificity': 0.6850691, 'f1': 0.7215349, 'auroc': 0.94626474, 'binary_precision': 0.578675, 'binary_recall': 0.37975544, 'binary_specificity': 0.9903828, 'binary_f1_score': 0.4585726}
confusion matrix:
       0    1
0  41913  407
1    913  559
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.7865547, 'recall': 0.65938497, 'specificity': 0.65938497, 'f1': 0.7031977, 'auroc': 0.95609856, 'binary_precision': 0.59659094, 'binary_recall': 0.32659408, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.42211056}
confusion matrix:
       0    1
0  18007  142
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.9204414, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
better model found
persisted
after epoch: 29,now: 2024-05-28 17:44:45.750241,epoch time: 0:23:52.163808,used: 11:14:41.517764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96825904, 'precision': 0.7986747, 'recall': 0.5675242, 'specificity': 0.5675242, 'f1': 0.60492754, 'auroc': 0.9431646, 'binary_precision': 0.6265432, 'binary_recall': 0.13790761, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.2260579}
confusion matrix:
       0    1
0  42199  121
1   1269  203
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75511813, 'recall': 0.5776689, 'specificity': 0.5776689, 'f1': 0.614957, 'auroc': 0.95339704, 'binary_precision': 0.539267, 'binary_recall': 0.16018662, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.2470024}
confusion matrix:
       0    1
0  18061   88
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.9225683, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897898.png
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.9694018959999084, corresponding to test acc:                         0.9592521786689758 / 0.977149248123169
after epoch: 30,now: 2024-05-28 18:07:35.765274,epoch time: 0:22:50.015033,used: 11:37:31.532797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_28_06_30_04_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:37:31.532797 at 2024-05-28 18:07:35.765274
persisted model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.89695513, 'recall': 0.5284855, 'specificity': 0.5284855, 'f1': 0.54358935, 'auroc': 0.9195985, 'binary_precision': 0.8333333, 'binary_recall': 0.057471264, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5994   3
1   246  15
oracle model performance metric: 

scalar performance:
{'acc': 0.97762865, 'precision': 0.9303319, 'recall': 0.76661515, 'specificity': 0.76661515, 'f1': 0.82754636, 'auroc': 0.9195963, 'binary_precision': 0.8805031, 'binary_recall': 0.5363985, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5978   19
1   121  140
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1108 TiB |   1108 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    803 TiB |    803 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    790 TiB |    790 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197545 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94915 K  |   94912 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197545 K  |  197541 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94915 K  |   94912 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2802    |  125972 K  |  125972 K  |
|       from large pool |      37    |     600    |   76773 K  |   76773 K  |
|       from small pool |      41    |    2764    |   49198 K  |   49198 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1108 TiB |   1108 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    803 TiB |    803 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     40 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  125973 K  |  125973 K  |
|       from large pool |       4    |     600    |   76773 K  |   76773 K  |
|       from small pool |       0    |    2764    |   49200 K  |   49200 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1129 TiB |   1129 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1116 TiB |   1116 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1108 TiB |   1108 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    803 TiB |    803 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     40 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  125973 K  |  125973 K  |
|       from large pool |       4    |     600    |   76773 K  |   76773 K  |
|       from small pool |       0    |    2764    |   49200 K  |   49200 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898

 Experiment start at: 2024-05-28 18:17:35.253799
before training, model accuracy: 0.701374351978302
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.6953496, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.71672636, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.4693489, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 18:43:02.590035,epoch time: 0:25:27.336236,used: 0:25:27.336236,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.75057375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.75376326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.5607959, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 2,now: 2024-05-28 19:06:29.227939,epoch time: 0:23:26.637904,used: 0:48:53.974140,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8274301, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.8320808, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.71036124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 3,now: 2024-05-28 19:29:43.596550,epoch time: 0:23:14.368611,used: 1:12:08.342751,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.8849355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.8929047, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.7892973, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 3
val acc:0.9512619376182556, best validation acc: 0.9512619376182556, corresponding to test acc:                         0.995549738407135 / 0.995549738407135
after epoch: 4,now: 2024-05-28 19:53:05.761480,epoch time: 0:23:22.164930,used: 1:35:30.507681,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9536856, 'precision': 0.75817156, 'recall': 0.57582366, 'specificity': 0.57582366, 'f1': 0.61112416, 'auroc': 0.9080972, 'binary_precision': 0.5572034, 'binary_recall': 0.15795796, 'binary_specificity': 0.9936894, 'binary_f1_score': 0.24613945}
confusion matrix:
       0    1
0  32910  209
1   1402  263
---- Validation: 
scalar performance:
{'acc': 0.9524001, 'precision': 0.82104266, 'recall': 0.52079856, 'specificity': 0.52079856, 'f1': 0.52788746, 'auroc': 0.90863943, 'binary_precision': 0.6888889, 'binary_recall': 0.04258242, 'binary_specificity': 0.99901474, 'binary_f1_score': 0.08020699}
confusion matrix:
       0   1
0  14195  14
1    697  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9948953, 'precision': 0.6090144, 'recall': 0.5289516, 'specificity': 0.5289516, 'f1': 0.5452319, 'auroc': 0.7994791, 'binary_precision': 0.22222222, 'binary_recall': 0.05882353, 'binary_specificity': 0.99907964, 'binary_f1_score': 0.093023255}
confusion matrix:
       0   1
0  15198  14
1     64   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 5,now: 2024-05-28 20:16:04.669683,epoch time: 0:22:58.908203,used: 1:58:29.415884,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9521332, 'precision': 0.4760666, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48773986, 'auroc': 0.9105858, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  33119  0
1   1665  0
---- Validation: 
scalar performance:
{'acc': 0.95126194, 'precision': 0.47563097, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48751113, 'auroc': 0.91760594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  14209  0
1    728  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.8086647, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9512619376182556, best validation acc: 0.9524000883102417, corresponding to test acc:                         0.9948952794075012 / 0.995549738407135
after epoch: 6,now: 2024-05-28 20:38:55.953427,epoch time: 0:22:51.283744,used: 2:21:20.699628,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95512307, 'precision': 0.7690855, 'recall': 0.6147958, 'specificity': 0.6147958, 'f1': 0.65696514, 'auroc': 0.91381395, 'binary_precision': 0.5753623, 'binary_recall': 0.23843844, 'binary_specificity': 0.9911531, 'binary_f1_score': 0.33715498}
confusion matrix:
       0    1
0  32826  293
1   1268  397
---- Validation: 
scalar performance:
{'acc': 0.9544085, 'precision': 0.80186605, 'recall': 0.5694228, 'specificity': 0.5694228, 'f1': 0.6052379, 'auroc': 0.91785437, 'binary_precision': 0.6459627, 'binary_recall': 0.14285715, 'binary_specificity': 0.9959884, 'binary_f1_score': 0.23397078}
confusion matrix:
       0    1
0  14152   57
1    624  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952225, 'precision': 0.6646031, 'recall': 0.536436, 'specificity': 0.536436, 'f1': 0.55904335, 'auroc': 0.75692487, 'binary_precision': 0.33333334, 'binary_recall': 0.073529415, 'binary_specificity': 0.9993426, 'binary_f1_score': 0.12048193}
confusion matrix:
       0   1
0  15202  10
1     63   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 7,now: 2024-05-28 21:01:41.005211,epoch time: 0:22:45.051784,used: 2:44:05.751412,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9532256, 'precision': 0.77514863, 'recall': 0.5345129, 'specificity': 0.5345129, 'f1': 0.55179125, 'auroc': 0.91815686, 'binary_precision': 0.595, 'binary_recall': 0.071471475, 'binary_specificity': 0.9975543, 'binary_f1_score': 0.12761395}
confusion matrix:
       0    1
0  33038   81
1   1546  119
---- Validation: 
scalar performance:
{'acc': 0.95233315, 'precision': 0.976141, 'recall': 0.510989, 'specificity': 0.510989, 'f1': 0.5092843, 'auroc': 0.923877, 'binary_precision': 1.0, 'binary_recall': 0.021978023, 'binary_specificity': 1.0, 'binary_f1_score': 0.043010753}
confusion matrix:
       0   1
0  14209   0
1    712  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954843, 'precision': 0.6978396, 'recall': 0.51460725, 'specificity': 0.51460725, 'f1': 0.5262656, 'auroc': 0.8036822, 'binary_precision': 0.4, 'binary_recall': 0.029411765, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.05479452}
confusion matrix:
       0  1
0  15209  3
1     66  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9523331522941589, best validation acc: 0.9544085264205933, corresponding to test acc:                         0.9952225089073181 / 0.995549738407135
after epoch: 8,now: 2024-05-28 21:25:03.130873,epoch time: 0:23:22.125662,used: 3:07:27.877074,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9535131, 'precision': 0.79978645, 'recall': 0.5312414, 'specificity': 0.5312414, 'f1': 0.5465022, 'auroc': 0.9276841, 'binary_precision': 0.64457834, 'binary_recall': 0.06426427, 'binary_specificity': 0.99821854, 'binary_f1_score': 0.11687602}
confusion matrix:
       0    1
0  33060   59
1   1558  107
---- Validation: 
scalar performance:
{'acc': 0.9517306, 'precision': 0.975854, 'recall': 0.5048077, 'specificity': 0.5048077, 'f1': 0.49715206, 'auroc': 0.9276334, 'binary_precision': 1.0, 'binary_recall': 0.009615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.01904762}
confusion matrix:
       0  1
0  14209  0
1    721  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99541885, 'precision': 0.6979044, 'recall': 0.52921456, 'specificity': 0.52921456, 'f1': 0.5501339, 'auroc': 0.847026, 'binary_precision': 0.4, 'binary_recall': 0.05882353, 'binary_specificity': 0.9996056, 'binary_f1_score': 0.102564104}
confusion matrix:
       0  1
0  15206  6
1     64  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9517306089401245, best validation acc: 0.9544085264205933, corresponding to test acc:                         0.9952225089073181 / 0.995549738407135
after epoch: 9,now: 2024-05-28 21:47:46.927626,epoch time: 0:22:43.796753,used: 3:30:11.673827,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9562155, 'precision': 0.76310074, 'recall': 0.7089161, 'specificity': 0.7089161, 'f1': 0.73242664, 'auroc': 0.921237, 'binary_precision': 0.55428135, 'binary_recall': 0.43543544, 'binary_specificity': 0.98239684, 'binary_f1_score': 0.48772287}
confusion matrix:
       0    1
0  32536  583
1    940  725
---- Validation: 
scalar performance:
{'acc': 0.95628303, 'precision': 0.8129866, 'recall': 0.6010344, 'specificity': 0.6010344, 'f1': 0.646825, 'auroc': 0.92855006, 'binary_precision': 0.66519827, 'binary_recall': 0.20741758, 'binary_specificity': 0.99465126, 'binary_f1_score': 0.3162304}
confusion matrix:
       0    1
0  14133   76
1    577  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941754, 'precision': 0.60614, 'recall': 0.5578703, 'specificity': 0.5578703, 'f1': 0.5747293, 'auroc': 0.80278534, 'binary_precision': 0.21621622, 'binary_recall': 0.11764706, 'binary_specificity': 0.9980936, 'binary_f1_score': 0.15238094}
confusion matrix:
       0   1
0  15183  29
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 10,now: 2024-05-28 22:10:30.862967,epoch time: 0:22:43.935341,used: 3:52:55.609168,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.956388, 'precision': 0.76052177, 'recall': 0.7669029, 'specificity': 0.7669029, 'f1': 0.7636674, 'auroc': 0.92460155, 'binary_precision': 0.54332554, 'binary_recall': 0.5573574, 'binary_specificity': 0.97644854, 'binary_f1_score': 0.55025196}
confusion matrix:
       0    1
0  32339  780
1    737  928
---- Validation: 
scalar performance:
{'acc': 0.95708644, 'precision': 0.77031016, 'recall': 0.74872375, 'specificity': 0.74872375, 'f1': 0.75899696, 'auroc': 0.9286182, 'binary_precision': 0.5652174, 'binary_recall': 0.51785713, 'binary_specificity': 0.9795904, 'binary_f1_score': 0.5405017}
confusion matrix:
       0    1
0  13919  290
1    351  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99384815, 'precision': 0.6231941, 'recall': 0.59430635, 'specificity': 0.59430635, 'f1': 0.6067893, 'auroc': 0.80656576, 'binary_precision': 0.25, 'binary_recall': 0.19117647, 'binary_specificity': 0.9974362, 'binary_f1_score': 0.21666667}
confusion matrix:
       0   1
0  15173  39
1     55  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 11,now: 2024-05-28 22:33:07.847029,epoch time: 0:22:36.984062,used: 4:15:32.593230,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9567617, 'precision': 0.77423286, 'recall': 0.6678485, 'specificity': 0.6678485, 'f1': 0.70647776, 'auroc': 0.92907774, 'binary_precision': 0.5805806, 'binary_recall': 0.34834835, 'binary_specificity': 0.9873487, 'binary_f1_score': 0.43543544}
confusion matrix:
       0    1
0  32700  419
1   1085  580
---- Validation: 
scalar performance:
{'acc': 0.9566178, 'precision': 0.8037065, 'recall': 0.6188042, 'specificity': 0.6188042, 'f1': 0.66606814, 'auroc': 0.93265784, 'binary_precision': 0.64492756, 'binary_recall': 0.2445055, 'binary_specificity': 0.99310297, 'binary_f1_score': 0.35458168}
confusion matrix:
       0    1
0  14111   98
1    550  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9953534, 'precision': 0.71235245, 'recall': 0.56578207, 'specificity': 0.56578207, 'f1': 0.59995854, 'auroc': 0.81500673, 'binary_precision': 0.42857143, 'binary_recall': 0.13235295, 'binary_specificity': 0.99921113, 'binary_f1_score': 0.20224719}
confusion matrix:
       0   1
0  15200  12
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9566177725791931, best validation acc: 0.957086443901062, corresponding to test acc:                         0.9938481450080872 / 0.995549738407135
after epoch: 12,now: 2024-05-28 22:55:58.672714,epoch time: 0:22:50.825685,used: 4:38:23.418915,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9569342, 'precision': 0.7645341, 'recall': 0.75121844, 'specificity': 0.75121844, 'f1': 0.7576771, 'auroc': 0.9341532, 'binary_precision': 0.55294865, 'binary_recall': 0.5237237, 'binary_specificity': 0.97871315, 'binary_f1_score': 0.53793955}
confusion matrix:
       0    1
0  32414  705
1    793  872
---- Validation: 
scalar performance:
{'acc': 0.9567517, 'precision': 0.77534986, 'recall': 0.6951146, 'specificity': 0.6951146, 'f1': 0.72739446, 'auroc': 0.9357481, 'binary_precision': 0.5807087, 'binary_recall': 0.4052198, 'binary_specificity': 0.9850095, 'binary_f1_score': 0.4773463}
confusion matrix:
       0    1
0  13996  213
1    433  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469894, 'precision': 0.67607117, 'recall': 0.61669385, 'specificity': 0.61669385, 'f1': 0.6402627, 'auroc': 0.83634317, 'binary_precision': 0.35555556, 'binary_recall': 0.23529412, 'binary_specificity': 0.9980936, 'binary_f1_score': 0.28318584}
confusion matrix:
       0   1
0  15183  29
1     52  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9567517042160034, best validation acc: 0.957086443901062, corresponding to test acc:                         0.9938481450080872 / 0.995549738407135
after epoch: 13,now: 2024-05-28 23:18:47.024621,epoch time: 0:22:48.351907,used: 5:01:11.770822,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9529094, 'precision': 0.77505386, 'recall': 0.5243647, 'specificity': 0.5243647, 'f1': 0.5344252, 'auroc': 0.9331163, 'binary_precision': 0.59574467, 'binary_recall': 0.05045045, 'binary_specificity': 0.9982789, 'binary_f1_score': 0.09302326}
confusion matrix:
       0   1
0  33062  57
1   1581  84
---- Validation: 
scalar performance:
{'acc': 0.9532704, 'precision': 0.8188448, 'recall': 0.53754663, 'specificity': 0.53754663, 'f1': 0.55712783, 'auroc': 0.9336625, 'binary_precision': 0.68292683, 'binary_recall': 0.07692308, 'binary_specificity': 0.9981702, 'binary_f1_score': 0.13827161}
confusion matrix:
       0   1
0  14183  26
1    672  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99554974, 'precision': 0.74780726, 'recall': 0.50732005, 'specificity': 0.50732005, 'f1': 0.5131706, 'auroc': 0.8094698, 'binary_precision': 0.5, 'binary_recall': 0.014705882, 'binary_specificity': 0.99993426, 'binary_f1_score': 0.028571429}
confusion matrix:
       0  1
0  15211  1
1     67  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 3
val acc:0.9532703757286072, best validation acc: 0.957086443901062, corresponding to test acc:                         0.9938481450080872 / 0.995549738407135
after epoch: 14,now: 2024-05-28 23:41:32.094883,epoch time: 0:22:45.070262,used: 5:23:56.841084,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.957078, 'precision': 0.7642462, 'recall': 0.77011734, 'specificity': 0.77011734, 'f1': 0.7671443, 'auroc': 0.9318655, 'binary_precision': 0.55046946, 'binary_recall': 0.5633634, 'binary_specificity': 0.9768713, 'binary_f1_score': 0.5568418}
confusion matrix:
       0    1
0  32353  766
1    727  938
---- Validation: 
scalar performance:
{'acc': 0.9572203, 'precision': 0.77620065, 'recall': 0.71165156, 'specificity': 0.71165156, 'f1': 0.73902214, 'auroc': 0.9392719, 'binary_precision': 0.58076227, 'binary_recall': 0.43956044, 'binary_specificity': 0.9837427, 'binary_f1_score': 0.50039095}
confusion matrix:
       0    1
0  13978  231
1    408  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.57447714, 'recall': 0.6147217, 'specificity': 0.6147217, 'f1': 0.5901655, 'auroc': 0.8268037, 'binary_precision': 0.15238096, 'binary_recall': 0.23529412, 'binary_specificity': 0.9941493, 'binary_f1_score': 0.18497111}
confusion matrix:
       0   1
0  15123  89
1     52  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 15,now: 2024-05-29 00:04:25.356025,epoch time: 0:22:53.261142,used: 5:46:50.102226,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9564167, 'precision': 0.7685385, 'recall': 0.6796459, 'specificity': 0.6796459, 'f1': 0.7140164, 'auroc': 0.9301542, 'binary_precision': 0.56803656, 'binary_recall': 0.37357357, 'binary_specificity': 0.9857182, 'binary_f1_score': 0.45072466}
confusion matrix:
       0    1
0  32646  473
1   1043  622
---- Validation: 
scalar performance:
{'acc': 0.9574212, 'precision': 0.7857321, 'recall': 0.6785243, 'specificity': 0.6785243, 'f1': 0.718051, 'auroc': 0.93440175, 'binary_precision': 0.60313904, 'binary_recall': 0.3695055, 'binary_specificity': 0.9875431, 'binary_f1_score': 0.45826235}
confusion matrix:
       0    1
0  14032  177
1    459  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9943717, 'precision': 0.6073747, 'recall': 0.55064887, 'specificity': 0.55064887, 'f1': 0.5685883, 'auroc': 0.84069896, 'binary_precision': 0.21875, 'binary_recall': 0.10294118, 'binary_specificity': 0.9983566, 'binary_f1_score': 0.14}
confusion matrix:
       0   1
0  15187  25
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 16,now: 2024-05-29 00:27:09.648499,epoch time: 0:22:44.292474,used: 6:09:34.394700,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95242065, 'precision': 0.776464, 'recall': 0.5087071, 'specificity': 0.5087071, 'f1': 0.5052972, 'auroc': 0.92404777, 'binary_precision': 0.6, 'binary_recall': 0.018018018, 'binary_specificity': 0.99939615, 'binary_f1_score': 0.034985423}
confusion matrix:
       0   1
0  33099  20
1   1635  30
---- Validation: 
scalar performance:
{'acc': 0.95132893, 'precision': 0.7757233, 'recall': 0.5019901, 'specificity': 0.5019901, 'f1': 0.49161893, 'auroc': 0.92703867, 'binary_precision': 0.6, 'binary_recall': 0.0041208793, 'binary_specificity': 0.9998593, 'binary_f1_score': 0.008185539}
confusion matrix:
       0  1
0  14207  2
1    725  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99430627, 'precision': 0.4977721, 'recall': 0.4993755, 'specificity': 0.4993755, 'f1': 0.4985725, 'auroc': 0.7941537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998751, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  15193  19
1     68   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9513289332389832, best validation acc: 0.9574211835861206, corresponding to test acc:                         0.9943717122077942 / 0.995549738407135
after epoch: 17,now: 2024-05-29 00:49:58.266579,epoch time: 0:22:48.618080,used: 6:32:23.012780,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9538006, 'precision': 0.74845517, 'recall': 0.8257221, 'specificity': 0.8257221, 'f1': 0.7809459, 'auroc': 0.9392866, 'binary_precision': 0.5130631, 'binary_recall': 0.68408406, 'binary_specificity': 0.96736014, 'binary_f1_score': 0.5863578}
confusion matrix:
       0     1
0  32038  1081
1    526  1139
---- Validation: 
scalar performance:
{'acc': 0.95467633, 'precision': 0.75517404, 'recall': 0.81196773, 'specificity': 0.81196773, 'f1': 0.78021944, 'auroc': 0.9414813, 'binary_precision': 0.5283019, 'binary_recall': 0.65384614, 'binary_specificity': 0.9700894, 'binary_f1_score': 0.5844077}
confusion matrix:
       0    1
0  13784  425
1    252  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9901178, 'precision': 0.5797174, 'recall': 0.64367336, 'specificity': 0.64367336, 'f1': 0.6022259, 'auroc': 0.829468, 'binary_precision': 0.16260162, 'binary_recall': 0.29411766, 'binary_specificity': 0.99322903, 'binary_f1_score': 0.20942408}
confusion matrix:
       0    1
0  15109  103
1     48   20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9546763300895691, best validation acc: 0.9574211835861206, corresponding to test acc:                         0.9943717122077942 / 0.995549738407135
after epoch: 18,now: 2024-05-29 01:12:40.169271,epoch time: 0:22:41.902692,used: 6:55:04.915472,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95759547, 'precision': 0.77740955, 'recall': 0.6896765, 'specificity': 0.6896765, 'f1': 0.7241453, 'auroc': 0.93701065, 'binary_precision': 0.5848214, 'binary_recall': 0.3933934, 'binary_specificity': 0.9859597, 'binary_f1_score': 0.47037703}
confusion matrix:
       0    1
0  32654  465
1   1010  655
---- Validation: 
scalar performance:
{'acc': 0.957689, 'precision': 0.8059275, 'recall': 0.6408708, 'specificity': 0.6408708, 'f1': 0.68922514, 'auroc': 0.9432299, 'binary_precision': 0.64723927, 'binary_recall': 0.28983516, 'binary_specificity': 0.9919065, 'binary_f1_score': 0.4003795}
confusion matrix:
       0    1
0  14094  115
1    517  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905759, 'precision': 0.51032895, 'recall': 0.5121421, 'specificity': 0.5121421, 'f1': 0.51114607, 'auroc': 0.793192, 'binary_precision': 0.025, 'binary_recall': 0.029411765, 'binary_specificity': 0.99487245, 'binary_f1_score': 0.027027028}
confusion matrix:
       0   1
0  15134  78
1     66   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 19,now: 2024-05-29 01:35:29.854380,epoch time: 0:22:49.685109,used: 7:17:54.600581,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9579692, 'precision': 0.79299414, 'recall': 0.6530816, 'specificity': 0.6530816, 'f1': 0.69832665, 'auroc': 0.9362588, 'binary_precision': 0.61955243, 'binary_recall': 0.3159159, 'binary_specificity': 0.9902473, 'binary_f1_score': 0.41845664}
confusion matrix:
       0    1
0  32796  323
1   1139  526
---- Validation: 
scalar performance:
{'acc': 0.9560822, 'precision': 0.81657785, 'recall': 0.59376097, 'specificity': 0.59376097, 'f1': 0.6382381, 'auroc': 0.9439427, 'binary_precision': 0.6730769, 'binary_recall': 0.1923077, 'binary_specificity': 0.9952143, 'binary_f1_score': 0.2991453}
confusion matrix:
       0    1
0  14141   68
1    588  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927356, 'precision': 0.50891227, 'recall': 0.5059067, 'specificity': 0.5059067, 'f1': 0.5070267, 'auroc': 0.82104635, 'binary_precision': 0.022222223, 'binary_recall': 0.014705882, 'binary_specificity': 0.99710757, 'binary_f1_score': 0.017699115}
confusion matrix:
       0   1
0  15168  44
1     67   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9560822248458862, best validation acc: 0.9576889872550964, corresponding to test acc:                         0.990575909614563 / 0.995549738407135
after epoch: 20,now: 2024-05-29 01:58:20.093038,epoch time: 0:22:50.238658,used: 7:40:44.839239,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9561005, 'precision': 0.8389994, 'recall': 0.56653935, 'specificity': 0.56653935, 'f1': 0.6029029, 'auroc': 0.9375086, 'binary_precision': 0.7197452, 'binary_recall': 0.13573574, 'binary_specificity': 0.99734294, 'binary_f1_score': 0.22839819}
confusion matrix:
       0    1
0  33031   88
1   1439  226
---- Validation: 
scalar performance:
{'acc': 0.95393986, 'precision': 0.8466279, 'recall': 0.54180825, 'specificity': 0.54180825, 'f1': 0.5645179, 'auroc': 0.94051456, 'binary_precision': 0.7380952, 'binary_recall': 0.08516484, 'binary_specificity': 0.9984517, 'binary_f1_score': 0.15270936}
confusion matrix:
       0   1
0  14187  22
1    666  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9953534, 'precision': 0.49777442, 'recall': 0.49990138, 'specificity': 0.49990138, 'f1': 0.49883565, 'auroc': 0.8547342, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99980277, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15209  3
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9539398550987244, best validation acc: 0.9576889872550964, corresponding to test acc:                         0.990575909614563 / 0.995549738407135
after epoch: 21,now: 2024-05-29 02:21:20.290305,epoch time: 0:23:00.197267,used: 8:03:45.036506,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9582854, 'precision': 0.7695845, 'recall': 0.79299724, 'specificity': 0.79299724, 'f1': 0.7807243, 'auroc': 0.9400001, 'binary_precision': 0.5588559, 'binary_recall': 0.61021024, 'binary_specificity': 0.9757843, 'binary_f1_score': 0.58340514}
confusion matrix:
       0     1
0  32317   802
1    649  1016
---- Validation: 
scalar performance:
{'acc': 0.95849234, 'precision': 0.78267705, 'recall': 0.73056567, 'specificity': 0.73056567, 'f1': 0.7535826, 'auroc': 0.94338244, 'binary_precision': 0.59183675, 'binary_recall': 0.47802198, 'binary_specificity': 0.9831093, 'binary_f1_score': 0.52887535}
confusion matrix:
       0    1
0  13969  240
1    380  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9894633, 'precision': 0.5652463, 'recall': 0.62138444, 'specificity': 0.62138444, 'f1': 0.5845284, 'auroc': 0.8454679, 'binary_precision': 0.13385826, 'binary_recall': 0.25, 'binary_specificity': 0.9927689, 'binary_f1_score': 0.17435896}
confusion matrix:
       0    1
0  15102  110
1     51   17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 22,now: 2024-05-29 02:44:12.529416,epoch time: 0:22:52.239111,used: 8:26:37.275617,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9588891, 'precision': 0.77382386, 'recall': 0.781621, 'specificity': 0.781621, 'f1': 0.77765894, 'auroc': 0.94076216, 'binary_precision': 0.5685131, 'binary_recall': 0.5855856, 'binary_specificity': 0.9776563, 'binary_f1_score': 0.576923}
confusion matrix:
       0    1
0  32379  740
1    690  975
---- Validation: 
scalar performance:
{'acc': 0.9586262, 'precision': 0.794942, 'recall': 0.68828046, 'specificity': 0.68828046, 'f1': 0.72824997, 'auroc': 0.94114184, 'binary_precision': 0.62061405, 'binary_recall': 0.38873628, 'binary_specificity': 0.9878246, 'binary_f1_score': 0.47804058}
confusion matrix:
       0    1
0  14036  173
1    445  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937827, 'precision': 0.62549937, 'recall': 0.60159355, 'specificity': 0.60159355, 'f1': 0.6122605, 'auroc': 0.84751713, 'binary_precision': 0.25454545, 'binary_recall': 0.20588236, 'binary_specificity': 0.99730474, 'binary_f1_score': 0.22764227}
confusion matrix:
       0   1
0  15171  41
1     54  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 23,now: 2024-05-29 03:07:15.441867,epoch time: 0:23:02.912451,used: 8:49:40.188068,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95719296, 'precision': 0.7675651, 'recall': 0.73452735, 'specificity': 0.73452735, 'f1': 0.7497918, 'auroc': 0.93396634, 'binary_precision': 0.5606896, 'binary_recall': 0.48828828, 'binary_specificity': 0.98076636, 'binary_f1_score': 0.52199036}
confusion matrix:
       0    1
0  32482  637
1    852  813
---- Validation: 
scalar performance:
{'acc': 0.9564839, 'precision': 0.7766913, 'recall': 0.67738, 'specificity': 0.67738, 'f1': 0.71464086, 'auroc': 0.9395169, 'binary_precision': 0.58515286, 'binary_recall': 0.36813188, 'binary_specificity': 0.9866282, 'binary_f1_score': 0.4519393}
confusion matrix:
       0    1
0  14019  190
1    460  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9895942, 'precision': 0.53132343, 'recall': 0.5482494, 'specificity': 0.5482494, 'f1': 0.53784615, 'auroc': 0.833588, 'binary_precision': 0.06666667, 'binary_recall': 0.10294118, 'binary_specificity': 0.9935577, 'binary_f1_score': 0.08092486}
confusion matrix:
       0   1
0  15114  98
1     61   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9564839005470276, best validation acc: 0.9586262106895447, corresponding to test acc:                         0.9937826991081238 / 0.995549738407135
after epoch: 24,now: 2024-05-29 03:30:03.600000,epoch time: 0:22:48.158133,used: 9:12:28.346201,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9564455, 'precision': 0.7597358, 'recall': 0.80999887, 'specificity': 0.80999887, 'f1': 0.7822697, 'auroc': 0.93902385, 'binary_precision': 0.5373506, 'binary_recall': 0.64804804, 'binary_specificity': 0.97194964, 'binary_f1_score': 0.5875306}
confusion matrix:
       0     1
0  32190   929
1    586  1079
---- Validation: 
scalar performance:
{'acc': 0.95514494, 'precision': 0.75738066, 'recall': 0.79331696, 'specificity': 0.79331696, 'f1': 0.77397233, 'auroc': 0.9414751, 'binary_precision': 0.534689, 'binary_recall': 0.614011, 'binary_specificity': 0.972623, 'binary_f1_score': 0.5716112}
confusion matrix:
       0    1
0  13820  389
1    281  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9881545, 'precision': 0.5612945, 'recall': 0.6353672, 'specificity': 0.6353672, 'f1': 0.5837753, 'auroc': 0.83834696, 'binary_precision': 0.12582782, 'binary_recall': 0.27941176, 'binary_specificity': 0.99132264, 'binary_f1_score': 0.17351599}
confusion matrix:
       0    1
0  15080  132
1     49   19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9551449418067932, best validation acc: 0.9586262106895447, corresponding to test acc:                         0.9937826991081238 / 0.995549738407135
after epoch: 25,now: 2024-05-29 03:53:03.357895,epoch time: 0:22:59.757895,used: 9:35:28.104096,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9588891, 'precision': 0.7717739, 'recall': 0.8090005, 'specificity': 0.8090005, 'f1': 0.788998, 'auroc': 0.9405439, 'binary_precision': 0.5616151, 'binary_recall': 0.64324325, 'binary_specificity': 0.9747577, 'binary_f1_score': 0.5996641}
confusion matrix:
       0     1
0  32283   836
1    594  1071
---- Validation: 
scalar performance:
{'acc': 0.9592957, 'precision': 0.78930247, 'recall': 0.729033, 'specificity': 0.729033, 'f1': 0.7551552, 'auroc': 0.9448874, 'binary_precision': 0.6052632, 'binary_recall': 0.4739011, 'binary_specificity': 0.98416495, 'binary_f1_score': 0.531587}
confusion matrix:
       0    1
0  13984  225
1    383  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9844895, 'precision': 0.5422441, 'recall': 0.6262065, 'specificity': 0.6262065, 'f1': 0.5620215, 'auroc': 0.84644616, 'binary_precision': 0.087804876, 'binary_recall': 0.2647059, 'binary_specificity': 0.9877071, 'binary_f1_score': 0.13186812}
confusion matrix:
       0    1
0  15025  187
1     50   18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 26,now: 2024-05-29 04:16:01.566422,epoch time: 0:22:58.208527,used: 9:58:26.312623,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9599241, 'precision': 0.79503524, 'recall': 0.70572996, 'specificity': 0.70572996, 'f1': 0.7413403, 'auroc': 0.9405892, 'binary_precision': 0.6185477, 'binary_recall': 0.42462462, 'binary_specificity': 0.98683536, 'binary_f1_score': 0.50356126}
confusion matrix:
       0    1
0  32683  436
1    958  707
---- Validation: 
scalar performance:
{'acc': 0.9595635, 'precision': 0.8212701, 'recall': 0.65945, 'specificity': 0.65945, 'f1': 0.7098821, 'auroc': 0.9456605, 'binary_precision': 0.6761364, 'binary_recall': 0.32692307, 'binary_specificity': 0.9919769, 'binary_f1_score': 0.44074076}
confusion matrix:
       0    1
0  14095  114
1    490  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99234295, 'precision': 0.54030335, 'recall': 0.5349898, 'specificity': 0.5349898, 'f1': 0.5374478, 'auroc': 0.8377749, 'binary_precision': 0.084745765, 'binary_recall': 0.073529415, 'binary_specificity': 0.9964502, 'binary_f1_score': 0.07874016}
confusion matrix:
       0   1
0  15158  54
1     63   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
better model found
persisted
after epoch: 27,now: 2024-05-29 04:39:03.720304,epoch time: 0:23:02.153882,used: 10:21:28.466505,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96018285, 'precision': 0.81097436, 'recall': 0.6742083, 'specificity': 0.6742083, 'f1': 0.72093946, 'auroc': 0.9434267, 'binary_precision': 0.6535088, 'binary_recall': 0.35795796, 'binary_specificity': 0.99045867, 'binary_f1_score': 0.46255335}
confusion matrix:
       0    1
0  32803  316
1   1069  596
---- Validation: 
scalar performance:
{'acc': 0.9569525, 'precision': 0.84125113, 'recall': 0.5929152, 'specificity': 0.5929152, 'f1': 0.6390598, 'auroc': 0.94059485, 'binary_precision': 0.7225131, 'binary_recall': 0.18956044, 'binary_specificity': 0.99626994, 'binary_f1_score': 0.30032644}
confusion matrix:
       0    1
0  14156   53
1    590  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99384815, 'precision': 0.6181615, 'recall': 0.5869863, 'specificity': 0.5869863, 'f1': 0.600151, 'auroc': 0.82839835, 'binary_precision': 0.24, 'binary_recall': 0.1764706, 'binary_specificity': 0.99750197, 'binary_f1_score': 0.20338982}
confusion matrix:
       0   1
0  15174  38
1     56  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 1
val acc:0.9569525122642517, best validation acc: 0.9595634937286377, corresponding to test acc:                         0.9923429489135742 / 0.995549738407135
after epoch: 28,now: 2024-05-29 05:02:00.058163,epoch time: 0:22:56.337859,used: 10:44:24.804364,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.956158, 'precision': 0.77725494, 'recall': 0.6330219, 'specificity': 0.6330219, 'f1': 0.6765244, 'auroc': 0.9384364, 'binary_precision': 0.5899743, 'binary_recall': 0.27567568, 'binary_specificity': 0.99036807, 'binary_f1_score': 0.37576753}
confusion matrix:
       0    1
0  32800  319
1   1206  459
---- Validation: 
scalar performance:
{'acc': 0.9562161, 'precision': 0.8052966, 'recall': 0.60751545, 'specificity': 0.60751545, 'f1': 0.65364337, 'auroc': 0.9419098, 'binary_precision': 0.6491935, 'binary_recall': 0.22115384, 'binary_specificity': 0.9938771, 'binary_f1_score': 0.32991803}
confusion matrix:
       0    1
0  14122   87
1    567  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.6855663, 'recall': 0.5656835, 'specificity': 0.5656835, 'f1': 0.59661174, 'auroc': 0.8466277, 'binary_precision': 0.375, 'binary_recall': 0.13235295, 'binary_specificity': 0.99901396, 'binary_f1_score': 0.19565219}
confusion matrix:
       0   1
0  15197  15
1     59   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 2
val acc:0.9562160968780518, best validation acc: 0.9595634937286377, corresponding to test acc:                         0.9923429489135742 / 0.995549738407135
after epoch: 29,now: 2024-05-29 05:25:01.413594,epoch time: 0:23:01.355431,used: 11:07:26.159795,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96055657, 'precision': 0.804977, 'recall': 0.69608, 'specificity': 0.69608, 'f1': 0.7371612, 'auroc': 0.94322044, 'binary_precision': 0.63939106, 'binary_recall': 0.4036036, 'binary_specificity': 0.98855644, 'binary_f1_score': 0.49484533}
confusion matrix:
       0    1
0  32740  379
1    993  672
---- Validation: 
scalar performance:
{'acc': 0.9574881, 'precision': 0.8177852, 'recall': 0.62121654, 'specificity': 0.62121654, 'f1': 0.67054975, 'auroc': 0.94832134, 'binary_precision': 0.67286247, 'binary_recall': 0.24862637, 'binary_specificity': 0.9938067, 'binary_f1_score': 0.3630893}
confusion matrix:
       0    1
0  14121   88
1    547  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9903141, 'precision': 0.5697144, 'recall': 0.61449164, 'specificity': 0.61449164, 'f1': 0.5864531, 'auroc': 0.8367106, 'binary_precision': 0.14285715, 'binary_recall': 0.23529412, 'binary_specificity': 0.9936892, 'binary_f1_score': 0.17777778}
confusion matrix:
       0   1
0  15116  96
1     52  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897898.png
early stop counter: 3
val acc:0.9574881196022034, best validation acc: 0.9595634937286377, corresponding to test acc:                         0.9923429489135742 / 0.995549738407135
after epoch: 30,now: 2024-05-29 05:48:12.645838,epoch time: 0:23:11.232244,used: 11:30:37.392039,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_18_17_35_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:30:37.392039 at 2024-05-29 05:48:12.645838
persisted model performance metric: 

scalar performance:
{'acc': 0.99234295, 'precision': 0.54030335, 'recall': 0.5349898, 'specificity': 0.5349898, 'f1': 0.5374478, 'auroc': 0.8607538, 'binary_precision': 0.084745765, 'binary_recall': 0.073529415, 'binary_specificity': 0.9964502, 'binary_f1_score': 0.07874016}
confusion matrix:
       0   1
0  15158  54
1     63   5
oracle model performance metric: 

scalar performance:
{'acc': 0.99554974, 'precision': 0.49777487, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49888498, 'auroc': 0.47980213, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15212  0
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457908 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457908 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |  43376 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 448177 KiB |  13213 MiB |   2163 TiB |   2163 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2136 TiB |   2136 TiB |
|       from small pool |  41102 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14484 MiB |  28078 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     68 MiB |     70 MiB |     86 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445260 KiB |   1251 MiB |   1562 TiB |   1562 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1536 TiB |   1536 TiB |
|       from small pool |   9871 KiB |     40 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6866    |    7237    |  381896 K  |  381889 K  |
|       from large pool |     187    |    1413    |  198397 K  |  198397 K  |
|       from small pool |    6679    |    6975    |  183498 K  |  183492 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6866    |    7237    |  381896 K  |  381889 K  |
|       from large pool |     187    |    1413    |  198397 K  |  198397 K  |
|       from small pool |    6679    |    6975    |  183498 K  |  183492 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1208    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      34    |      35    |      43    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2802    |  243801 K  |  243801 K  |
|       from large pool |      40    |     604    |  143114 K  |  143114 K  |
|       from small pool |      34    |    2764    |  100687 K  |  100687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2163 TiB |   2163 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1562 TiB |   1562 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1536 TiB |   1536 TiB |
|       from small pool |      0 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381896 K  |  381896 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381896 K  |  381896 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  243804 K  |  243804 K  |
|       from large pool |       4    |     604    |  143114 K  |  143114 K  |
|       from small pool |       0    |    2764    |  100690 K  |  100690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2171 TiB |   2171 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2144 TiB |   2144 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2163 TiB |   2163 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1562 TiB |   1562 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1536 TiB |   1536 TiB |
|       from small pool |      0 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7237    |  381896 K  |  381896 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7237    |  381896 K  |  381896 K  |
|       from large pool |       2    |    1413    |  198397 K  |  198397 K  |
|       from small pool |       0    |    6975    |  183498 K  |  183498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  243804 K  |  243804 K  |
|       from large pool |       4    |     604    |  143114 K  |  143114 K  |
|       from small pool |       0    |    2764    |  100690 K  |  100690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898

 Experiment start at: 2024-05-29 06:01:35.028608
before training, model accuracy: 0.7692731618881226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.7406103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.7754667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.55507946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 06:24:08.499238,epoch time: 0:22:33.470630,used: 0:22:33.470630,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.7581482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.791961, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.59303606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 2,now: 2024-05-29 06:45:22.923988,epoch time: 0:21:14.424750,used: 0:43:47.895380,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.79328907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8104604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.59847355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 2
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 3,now: 2024-05-29 07:06:31.435623,epoch time: 0:21:08.511635,used: 1:04:56.407015,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.81738865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.8282516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.6078061, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 3
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 4,now: 2024-05-29 07:27:35.193398,epoch time: 0:21:03.757775,used: 1:26:00.164790,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.8308817, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.85916007, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.6230815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 4
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 5,now: 2024-05-29 07:48:37.386258,epoch time: 0:21:02.192860,used: 1:47:02.357650,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.88978535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.89885986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.70384383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 5
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 6,now: 2024-05-29 08:09:55.640041,epoch time: 0:21:18.253783,used: 2:08:20.611433,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663084, 'precision': 0.4831542, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914328, 'auroc': 0.9119204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9295717, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.8069976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 6
val acc:0.9648749232292175, best validation acc: 0.9648749232292175, corresponding to test acc:                         0.9602813124656677 / 0.9602813124656677
after epoch: 7,now: 2024-05-29 08:31:19.483514,epoch time: 0:21:23.843473,used: 2:29:44.454906,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9662383, 'precision': 0.48311916, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49141467, 'auroc': 0.92586553, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41355  0
1   1445  0
---- Validation: 
scalar performance:
{'acc': 0.96531194, 'precision': 0.9326738, 'recall': 0.5069701, 'specificity': 0.5069701, 'f1': 0.504953, 'auroc': 0.939142, 'binary_precision': 0.9, 'binary_recall': 0.01399689, 'binary_specificity': 0.9999434, 'binary_f1_score': 0.027565084}
confusion matrix:
       0  1
0  17662  1
1    634  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.8099618, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
better model found
persisted
after epoch: 8,now: 2024-05-29 08:52:32.400116,epoch time: 0:21:12.916602,used: 2:50:57.371508,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96378505, 'precision': 0.7219796, 'recall': 0.71960497, 'specificity': 0.71960497, 'f1': 0.72078514, 'auroc': 0.9266231, 'binary_precision': 0.46288514, 'binary_recall': 0.45775622, 'binary_specificity': 0.9814537, 'binary_f1_score': 0.4603064}
confusion matrix:
       0    1
0  40589  767
1    783  661
---- Validation: 
scalar performance:
{'acc': 0.96553046, 'precision': 0.74539757, 'recall': 0.64870054, 'specificity': 0.64870054, 'f1': 0.6839285, 'auroc': 0.93990546, 'binary_precision': 0.515625, 'binary_recall': 0.30793157, 'binary_specificity': 0.9894695, 'binary_f1_score': 0.38558912}
confusion matrix:
       0    1
0  17477  186
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595918, 'precision': 0.7175709, 'recall': 0.5645488, 'specificity': 0.5645488, 'f1': 0.59475404, 'auroc': 0.82538915, 'binary_precision': 0.4698795, 'binary_recall': 0.13541667, 'binary_specificity': 0.9936809, 'binary_f1_score': 0.21024257}
confusion matrix:
      0   1
0  6919  44
1   249  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
better model found
persisted
after epoch: 9,now: 2024-05-29 09:13:40.981907,epoch time: 0:21:08.581791,used: 3:12:05.953299,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.966986, 'precision': 0.74720347, 'recall': 0.646073, 'specificity': 0.646073, 'f1': 0.6823298, 'auroc': 0.92262864, 'binary_precision': 0.5184304, 'binary_recall': 0.30193907, 'binary_specificity': 0.99020696, 'binary_f1_score': 0.38161927}
confusion matrix:
       0    1
0  40951  405
1   1008  436
---- Validation: 
scalar performance:
{'acc': 0.96705997, 'precision': 0.7846289, 'recall': 0.5925466, 'specificity': 0.5925466, 'f1': 0.6356078, 'auroc': 0.9342237, 'binary_precision': 0.5980392, 'binary_recall': 0.18973562, 'binary_specificity': 0.9953575, 'binary_f1_score': 0.28807557}
confusion matrix:
       0    1
0  17581   82
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.7932879, 'recall': 0.5169303, 'specificity': 0.5169303, 'f1': 0.52289337, 'auroc': 0.7853656, 'binary_precision': 0.625, 'binary_recall': 0.034722224, 'binary_specificity': 0.9991383, 'binary_f1_score': 0.065789476}
confusion matrix:
      0   1
0  6957   6
1   278  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-05-29 09:34:59.010200,epoch time: 0:21:18.028293,used: 3:33:23.981592,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9662617, 'precision': 0.48313084, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49142072, 'auroc': 0.93584085, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  41356  0
1   1444  0
---- Validation: 
scalar performance:
{'acc': 0.9648749, 'precision': 0.48243746, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49106175, 'auroc': 0.9454684, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  17663  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602813, 'precision': 0.48014066, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48986912, 'auroc': 0.795033, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  6963  0
1   288  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
early stop counter: 1
val acc:0.9648749232292175, best validation acc: 0.9670599699020386, corresponding to test acc:                         0.9608330130577087 / 0.9608330130577087
after epoch: 11,now: 2024-05-29 09:56:21.323141,epoch time: 0:21:22.312941,used: 3:54:46.294533,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9674066, 'precision': 0.75024295, 'recall': 0.74003255, 'specificity': 0.74003255, 'f1': 0.74501956, 'auroc': 0.9339745, 'binary_precision': 0.5180636, 'binary_recall': 0.49619377, 'binary_specificity': 0.98387134, 'binary_f1_score': 0.50689286}
confusion matrix:
       0    1
0  40688  667
1    728  717
---- Validation: 
scalar performance:
{'acc': 0.96777016, 'precision': 0.7735337, 'recall': 0.6611006, 'specificity': 0.6611006, 'f1': 0.70135826, 'auroc': 0.9419565, 'binary_precision': 0.5710456, 'binary_recall': 0.33125973, 'binary_specificity': 0.9909415, 'binary_f1_score': 0.41929135}
confusion matrix:
       0    1
0  17503  160
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96290165, 'precision': 0.7848697, 'recall': 0.59456533, 'specificity': 0.59456533, 'f1': 0.6374568, 'auroc': 0.7630333, 'binary_precision': 0.60215056, 'binary_recall': 0.19444445, 'binary_specificity': 0.9946862, 'binary_f1_score': 0.29396325}
confusion matrix:
      0   1
0  6926  37
1   232  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897898.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-05-29 10:17:43.443043,epoch time: 0:21:22.119902,used: 4:16:08.414435,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_29_06_01_34_seed_0_20897898
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9676635, 'precision': 0.8127492, 'recall': 0.5434806, 'specificity': 0.5434806, 'f1': 0.56980675, 'auroc': 0.93673307, 'binary_precision': 0.6564103, 'binary_recall': 0.088581316, 'binary_specificity': 0.9983799, 'binary_f1_score': 0.15609756}
confusion matrix:
       0    1
0  41288   67
1   1317  128
---- Validation: 
scalar performance:
{'acc': 0.96558505, 'precision': 0.9039093, 'recall': 0.51235676, 'specificity': 0.51235676, 'f1': 0.515407, 'auroc': 0.9461119, 'binary_precision': 0.84210527, 'binary_recall': 0.02488336, 'binary_specificity': 0.9998301, 'binary_f1_score': 0.048338365}
confusion matrix:
       0   1
0  17660   3
1    627  16
---- Test Domain (oracle): 
slurmstepd: error: *** JOB 20897898 ON gpusrv63 CANCELLED AT 2024-05-29T10:35:56 ***
