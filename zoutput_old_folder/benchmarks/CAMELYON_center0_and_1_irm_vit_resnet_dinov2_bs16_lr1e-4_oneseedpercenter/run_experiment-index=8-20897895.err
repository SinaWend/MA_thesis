Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895

 Experiment start at: 2024-05-27 19:33:02.907390
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.969926, 'precision': 0.83382666, 'recall': 0.59232044, 'specificity': 0.59232044, 'f1': 0.6399901, 'auroc': 0.9481412, 'binary_precision': 0.6952141, 'binary_recall': 0.1875, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.2953451}
confusion matrix:
       0    1
0  42199  121
1   1196  276
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.8366749, 'recall': 0.60568404, 'specificity': 0.60568404, 'f1': 0.65661097, 'auroc': 0.95446646, 'binary_precision': 0.70050764, 'binary_recall': 0.21461898, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.32857144}
confusion matrix:
       0    1
0  18090   59
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.9344014, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 19:54:10.195540,epoch time: 0:21:07.288150,used: 0:21:07.288150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.7831555, 'recall': 0.8402765, 'specificity': 0.8402765, 'f1': 0.80881584, 'auroc': 0.95952785, 'binary_precision': 0.5768799, 'binary_recall': 0.69836956, 'binary_specificity': 0.98218334, 'binary_f1_score': 0.6318377}
confusion matrix:
       0     1
0  41566   754
1    444  1028
---- Validation: 
scalar performance:
{'acc': 0.9732333, 'precision': 0.79430735, 'recall': 0.81587994, 'specificity': 0.81587994, 'f1': 0.80467236, 'auroc': 0.96243966, 'binary_precision': 0.60115606, 'binary_recall': 0.64696735, 'binary_specificity': 0.98479253, 'binary_f1_score': 0.623221}
confusion matrix:
       0    1
0  17873  276
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8861729, 'recall': 0.58720547, 'specificity': 0.58720547, 'f1': 0.6353903, 'auroc': 0.9307965, 'binary_precision': 0.80701756, 'binary_recall': 0.17624521, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2893082}
confusion matrix:
      0   1
0  5986  11
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 20:13:28.974067,epoch time: 0:19:18.778527,used: 0:40:26.066677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97520095, 'precision': 0.8163198, 'recall': 0.782585, 'specificity': 0.782585, 'f1': 0.7984135, 'auroc': 0.9670543, 'binary_precision': 0.64732826, 'binary_recall': 0.57608694, 'binary_specificity': 0.9890832, 'binary_f1_score': 0.6096334}
confusion matrix:
       0    1
0  41858  462
1    624  848
---- Validation: 
scalar performance:
{'acc': 0.9787676, 'precision': 0.8664701, 'recall': 0.78274244, 'specificity': 0.78274244, 'f1': 0.8187556, 'auroc': 0.96380746, 'binary_precision': 0.7479675, 'binary_recall': 0.57231724, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.6484581}
confusion matrix:
       0    1
0  18025  124
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.9184389, 'recall': 0.625603, 'specificity': 0.625603, 'f1': 0.6874296, 'auroc': 0.9210923, 'binary_precision': 0.8684211, 'binary_recall': 0.25287357, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.39169142}
confusion matrix:
      0   1
0  5987  10
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-27 20:33:01.941653,epoch time: 0:19:32.967586,used: 0:59:59.034263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97540647, 'precision': 0.80406326, 'recall': 0.84236175, 'specificity': 0.84236175, 'f1': 0.82196236, 'auroc': 0.96906936, 'binary_precision': 0.6186186, 'binary_recall': 0.69972825, 'binary_specificity': 0.98499525, 'binary_f1_score': 0.6566783}
confusion matrix:
       0     1
0  41685   635
1    442  1030
---- Validation: 
scalar performance:
{'acc': 0.9756279, 'precision': 0.8137187, 'recall': 0.8231201, 'specificity': 0.8231201, 'f1': 0.8183431, 'auroc': 0.96894276, 'binary_precision': 0.63951737, 'binary_recall': 0.65940905, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.64931095}
confusion matrix:
       0    1
0  17910  239
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.88241374, 'recall': 0.7253014, 'specificity': 0.7253014, 'f1': 0.7816473, 'auroc': 0.9512323, 'binary_precision': 0.78807944, 'binary_recall': 0.4559387, 'binary_specificity': 0.994664, 'binary_f1_score': 0.5776699}
confusion matrix:
      0    1
0  5965   32
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
new oracle model saved
early stop counter: 1
val acc:0.9756278991699219, best validation acc: 0.9787675738334656, corresponding to test acc:                         0.9672419428825378 / 0.972195565700531
after epoch: 4,now: 2024-05-27 20:52:25.166173,epoch time: 0:19:23.224520,used: 1:19:22.258783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97520095, 'precision': 0.79728925, 'recall': 0.87422705, 'specificity': 0.87422705, 'f1': 0.8308824, 'auroc': 0.9733532, 'binary_precision': 0.60278374, 'binary_recall': 0.7659864, 'binary_specificity': 0.9824678, 'binary_f1_score': 0.6746555}
confusion matrix:
       0     1
0  41580   742
1    344  1126
---- Validation: 
scalar performance:
{'acc': 0.9774372, 'precision': 0.8192, 'recall': 0.86680996, 'specificity': 0.86680996, 'f1': 0.8411852, 'auroc': 0.97513086, 'binary_precision': 0.6473755, 'binary_recall': 0.748056, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.6940837}
confusion matrix:
       0    1
0  17887  262
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8432194, 'recall': 0.573462, 'specificity': 0.573462, 'f1': 0.61409724, 'auroc': 0.9411591, 'binary_precision': 0.7222222, 'binary_recall': 0.14942528, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.24761903}
confusion matrix:
      0   1
0  5982  15
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 2
val acc:0.9774371981620789, best validation acc: 0.9787675738334656, corresponding to test acc:                         0.9672419428825378 / 0.972195565700531
after epoch: 5,now: 2024-05-27 21:12:16.253755,epoch time: 0:19:51.087582,used: 1:39:13.346365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9759317, 'precision': 0.80755776, 'recall': 0.8468957, 'specificity': 0.8468957, 'f1': 0.82592475, 'auroc': 0.97066784, 'binary_precision': 0.62529975, 'binary_recall': 0.7085598, 'binary_specificity': 0.9852316, 'binary_f1_score': 0.6643312}
confusion matrix:
       0     1
0  41695   625
1    429  1043
---- Validation: 
scalar performance:
{'acc': 0.9767454, 'precision': 0.81777644, 'recall': 0.8477005, 'specificity': 0.8477005, 'f1': 0.83199805, 'auroc': 0.972067, 'binary_precision': 0.6458923, 'binary_recall': 0.70917577, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.6760563}
confusion matrix:
       0    1
0  17899  250
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8472494, 'recall': 0.6714114, 'specificity': 0.6714114, 'f1': 0.7266913, 'auroc': 0.95215124, 'binary_precision': 0.7222222, 'binary_recall': 0.348659, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4702842}
confusion matrix:
      0   1
0  5962  35
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 3
val acc:0.9767454266548157, best validation acc: 0.9787675738334656, corresponding to test acc:                         0.9672419428825378 / 0.972195565700531
after epoch: 6,now: 2024-05-27 21:32:03.019827,epoch time: 0:19:46.766072,used: 1:59:00.112437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9731001, 'precision': 0.78672117, 'recall': 0.8378899, 'specificity': 0.8378899, 'f1': 0.8099856, 'auroc': 0.9739586, 'binary_precision': 0.58419245, 'binary_recall': 0.6929348, 'binary_specificity': 0.982845, 'binary_f1_score': 0.63393414}
confusion matrix:
       0     1
0  41594   726
1    452  1020
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.7869289, 'recall': 0.797245, 'specificity': 0.797245, 'f1': 0.7919862, 'auroc': 0.9704686, 'binary_precision': 0.58770615, 'binary_recall': 0.6096423, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.5984733}
confusion matrix:
       0    1
0  17874  275
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6940837, 'recall': 0.5162409, 'specificity': 0.5162409, 'f1': 0.5211253, 'auroc': 0.9161517, 'binary_precision': 0.42857143, 'binary_recall': 0.03448276, 'binary_specificity': 0.997999, 'binary_f1_score': 0.06382979}
confusion matrix:
      0   1
0  5985  12
1   252   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 4
val acc:0.9720093607902527, best validation acc: 0.9787675738334656, corresponding to test acc:                         0.9672419428825378 / 0.972195565700531
after epoch: 7,now: 2024-05-27 21:51:39.211402,epoch time: 0:19:36.191575,used: 2:18:36.304012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9799735, 'precision': 0.8361527, 'recall': 0.8741509, 'specificity': 0.8741509, 'f1': 0.85403824, 'auroc': 0.9803376, 'binary_precision': 0.6806569, 'binary_recall': 0.760707, 'binary_specificity': 0.9875948, 'binary_f1_score': 0.71845907}
confusion matrix:
       0     1
0  41796   525
1    352  1119
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.86843956, 'recall': 0.87948096, 'specificity': 0.87948096, 'f1': 0.87387145, 'auroc': 0.9780891, 'binary_precision': 0.74509805, 'binary_recall': 0.7682737, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.75650847}
confusion matrix:
       0    1
0  17980  169
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8183398, 'recall': 0.5806246, 'specificity': 0.5806246, 'f1': 0.6225054, 'auroc': 0.94331264, 'binary_precision': 0.671875, 'binary_recall': 0.16475096, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.26461542}
confusion matrix:
      0   1
0  5976  21
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 8,now: 2024-05-27 22:11:42.980791,epoch time: 0:20:03.769389,used: 2:38:40.073401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98296493, 'precision': 0.86905086, 'recall': 0.8685669, 'specificity': 0.8685669, 'f1': 0.86880875, 'auroc': 0.980298, 'binary_precision': 0.74693877, 'binary_recall': 0.74592394, 'binary_specificity': 0.9912098, 'binary_f1_score': 0.746431}
confusion matrix:
       0     1
0  41948   372
1    374  1098
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.88525224, 'recall': 0.85336673, 'specificity': 0.85336673, 'f1': 0.8685626, 'auroc': 0.9796072, 'binary_precision': 0.78061223, 'binary_recall': 0.7138414, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.74573517}
confusion matrix:
       0    1
0  18020  129
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8920453, 'recall': 0.61002725, 'specificity': 0.61002725, 'f1': 0.66583467, 'auroc': 0.9490921, 'binary_precision': 0.8169014, 'binary_recall': 0.22222222, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3493976}
confusion matrix:
      0   1
0  5984  13
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 9,now: 2024-05-27 22:31:27.708257,epoch time: 0:19:44.727466,used: 2:58:24.800867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9758175, 'precision': 0.7967051, 'recall': 0.915687, 'specificity': 0.915687, 'f1': 0.8451705, 'auroc': 0.97855866, 'binary_precision': 0.5986622, 'binary_recall': 0.8512228, 'binary_specificity': 0.98015124, 'binary_f1_score': 0.7029453}
confusion matrix:
       0     1
0  41480   840
1    219  1253
---- Validation: 
scalar performance:
{'acc': 0.9805768, 'precision': 0.83178455, 'recall': 0.92093927, 'specificity': 0.92093927, 'f1': 0.8705434, 'auroc': 0.9786684, 'binary_precision': 0.6686893, 'binary_recall': 0.85692066, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.75119287}
confusion matrix:
       0    1
0  17876  273
1     92  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.85537094, 'recall': 0.6094436, 'specificity': 0.6094436, 'f1': 0.66193485, 'auroc': 0.9582161, 'binary_precision': 0.74358976, 'binary_recall': 0.22222222, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3421829}
confusion matrix:
      0   1
0  5977  20
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 1
val acc:0.9805768132209778, best validation acc: 0.9833439588546753, corresponding to test acc:                         0.9654842019081116 / 0.972195565700531
after epoch: 10,now: 2024-05-27 22:51:07.382251,epoch time: 0:19:39.673994,used: 3:18:04.474861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98063576, 'precision': 0.8324081, 'recall': 0.90932775, 'specificity': 0.90932775, 'f1': 0.8664845, 'auroc': 0.9828733, 'binary_precision': 0.6706783, 'binary_recall': 0.83288044, 'binary_specificity': 0.98577505, 'binary_f1_score': 0.74303025}
confusion matrix:
       0     1
0  41718   602
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.85571086, 'recall': 0.9140386, 'specificity': 0.9140386, 'f1': 0.88245344, 'auroc': 0.9810749, 'binary_precision': 0.7171315, 'binary_recall': 0.83981335, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.77363896}
confusion matrix:
       0    1
0  17936  213
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8618103, 'recall': 0.5831239, 'specificity': 0.5831239, 'f1': 0.6284615, 'auroc': 0.9577627, 'binary_precision': 0.7586207, 'binary_recall': 0.16858238, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5983  14
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 2
val acc:0.9831843376159668, best validation acc: 0.9833439588546753, corresponding to test acc:                         0.9654842019081116 / 0.972195565700531
after epoch: 11,now: 2024-05-27 23:10:21.245749,epoch time: 0:19:13.863498,used: 3:37:18.338359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9842437, 'precision': 0.8912613, 'recall': 0.8567698, 'specificity': 0.8567698, 'f1': 0.8731546, 'auroc': 0.9856446, 'binary_precision': 0.7922272, 'binary_recall': 0.7201087, 'binary_specificity': 0.993431, 'binary_f1_score': 0.7544484}
confusion matrix:
       0     1
0  42042   278
1    412  1060
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9012885, 'recall': 0.8516952, 'specificity': 0.8516952, 'f1': 0.8747244, 'auroc': 0.97955775, 'binary_precision': 0.8128342, 'binary_recall': 0.70917577, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7574751}
confusion matrix:
       0    1
0  18044  105
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.86131155, 'recall': 0.53023446, 'specificity': 0.53023446, 'f1': 0.5465201, 'auroc': 0.9491023, 'binary_precision': 0.7619048, 'binary_recall': 0.06130268, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.11347518}
confusion matrix:
      0   1
0  5992   5
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 12,now: 2024-05-27 23:29:59.699937,epoch time: 0:19:38.454188,used: 3:56:56.792547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9791058, 'precision': 0.8391355, 'recall': 0.83935785, 'specificity': 0.83935785, 'f1': 0.83924663, 'auroc': 0.9792162, 'binary_precision': 0.6890699, 'binary_recall': 0.68953806, 'binary_specificity': 0.9891777, 'binary_f1_score': 0.68930393}
confusion matrix:
       0     1
0  41862   458
1    457  1015
---- Validation: 
scalar performance:
{'acc': 0.9778629, 'precision': 0.83456486, 'recall': 0.82652736, 'specificity': 0.82652736, 'f1': 0.8304926, 'auroc': 0.97820723, 'binary_precision': 0.68102074, 'binary_recall': 0.66407466, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.67244095}
confusion matrix:
       0    1
0  17949  200
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.85410035, 'recall': 0.61319166, 'specificity': 0.61319166, 'f1': 0.6663208, 'auroc': 0.9435141, 'binary_precision': 0.7407407, 'binary_recall': 0.22988506, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3508772}
confusion matrix:
      0   1
0  5976  21
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 1
val acc:0.9778628945350647, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 13,now: 2024-05-27 23:49:19.717341,epoch time: 0:19:20.017404,used: 4:16:16.809951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9784664, 'precision': 0.81963664, 'recall': 0.88886166, 'specificity': 0.88886166, 'f1': 0.8505258, 'auroc': 0.9805073, 'binary_precision': 0.6465374, 'binary_recall': 0.79279894, 'binary_specificity': 0.9849244, 'binary_f1_score': 0.7122369}
confusion matrix:
       0     1
0  41682   638
1    305  1167
---- Validation: 
scalar performance:
{'acc': 0.9804704, 'precision': 0.8371124, 'recall': 0.8968824, 'specificity': 0.8968824, 'f1': 0.864323, 'auroc': 0.9798269, 'binary_precision': 0.68110234, 'binary_recall': 0.80715394, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.73879004}
confusion matrix:
       0    1
0  17906  243
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7379774, 'recall': 0.531233, 'specificity': 0.531233, 'f1': 0.5471866, 'auroc': 0.9334191, 'binary_precision': 0.5151515, 'binary_recall': 0.0651341, 'binary_specificity': 0.997332, 'binary_f1_score': 0.11564625}
confusion matrix:
      0   1
0  5981  16
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 2
val acc:0.9804704189300537, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 14,now: 2024-05-28 00:08:54.788649,epoch time: 0:19:35.071308,used: 4:35:51.881259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97896874, 'precision': 0.82408035, 'recall': 0.8871544, 'specificity': 0.8871544, 'f1': 0.8525418, 'auroc': 0.9836176, 'binary_precision': 0.6555618, 'binary_recall': 0.7887228, 'binary_specificity': 0.985586, 'binary_f1_score': 0.7160036}
confusion matrix:
       0     1
0  41710   610
1    311  1161
---- Validation: 
scalar performance:
{'acc': 0.9774372, 'precision': 0.8192, 'recall': 0.86680996, 'specificity': 0.86680996, 'f1': 0.8411852, 'auroc': 0.97913885, 'binary_precision': 0.6473755, 'binary_recall': 0.748056, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.6940837}
confusion matrix:
       0    1
0  17887  262
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.94747674, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 3
val acc:0.9774371981620789, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 15,now: 2024-05-28 00:28:18.496669,epoch time: 0:19:23.708020,used: 4:55:15.589279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9776215, 'precision': 0.8100876, 'recall': 0.90541494, 'specificity': 0.90541494, 'f1': 0.8507357, 'auroc': 0.9849609, 'binary_precision': 0.62622106, 'binary_recall': 0.8280082, 'binary_specificity': 0.98282176, 'binary_f1_score': 0.7131148}
confusion matrix:
       0     1
0  41594   727
1    253  1218
---- Validation: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.78978145, 'recall': 0.9040772, 'specificity': 0.9040772, 'f1': 0.8364486, 'auroc': 0.97648954, 'binary_precision': 0.5857143, 'binary_recall': 0.8289269, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.6864134}
confusion matrix:
       0    1
0  17772  377
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.849161, 'recall': 0.58295715, 'specificity': 0.58295715, 'f1': 0.62751853, 'auroc': 0.9418081, 'binary_precision': 0.73333335, 'binary_recall': 0.16858238, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2741433}
confusion matrix:
      0   1
0  5981  16
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 4
val acc:0.974084734916687, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 16,now: 2024-05-28 00:48:00.056646,epoch time: 0:19:41.559977,used: 5:14:57.149256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98013335, 'precision': 0.82450277, 'recall': 0.92710006, 'specificity': 0.92710006, 'f1': 0.8680825, 'auroc': 0.98689115, 'binary_precision': 0.6535714, 'binary_recall': 0.87024456, 'binary_specificity': 0.98395556, 'binary_f1_score': 0.7465035}
confusion matrix:
       0     1
0  41641   679
1    191  1281
---- Validation: 
scalar performance:
{'acc': 0.98036397, 'precision': 0.8326793, 'recall': 0.91032827, 'specificity': 0.91032827, 'f1': 0.86703634, 'auroc': 0.98269606, 'binary_precision': 0.67125, 'binary_recall': 0.83514774, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.7442827}
confusion matrix:
       0    1
0  17886  263
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8227648, 'recall': 0.60694426, 'specificity': 0.60694426, 'f1': 0.6557276, 'auroc': 0.94988585, 'binary_precision': 0.6785714, 'binary_recall': 0.21839081, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3304348}
confusion matrix:
      0   1
0  5970  27
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 5
val acc:0.9803639650344849, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 17,now: 2024-05-28 01:07:40.565806,epoch time: 0:19:40.509160,used: 5:34:37.658416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9802932, 'precision': 0.8251816, 'recall': 0.9291074, 'specificity': 0.9291074, 'f1': 0.8692535, 'auroc': 0.9888139, 'binary_precision': 0.65478617, 'binary_recall': 0.8742352, 'binary_specificity': 0.9839796, 'binary_f1_score': 0.7487627}
confusion matrix:
       0     1
0  41643   678
1    185  1286
---- Validation: 
scalar performance:
{'acc': 0.9780226, 'precision': 0.8131275, 'recall': 0.921117, 'specificity': 0.921117, 'f1': 0.85832953, 'auroc': 0.977479, 'binary_precision': 0.6312785, 'binary_recall': 0.8600311, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.72811055}
confusion matrix:
       0    1
0  17826  323
1     90  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8183303, 'recall': 0.56563246, 'specificity': 0.56563246, 'f1': 0.6018645, 'auroc': 0.9399798, 'binary_precision': 0.6730769, 'binary_recall': 0.13409962, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5980  17
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 6
val acc:0.978022575378418, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 18,now: 2024-05-28 01:27:16.090486,epoch time: 0:19:35.524680,used: 5:54:13.183096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9850201, 'precision': 0.8992007, 'recall': 0.86026454, 'specificity': 0.86026454, 'f1': 0.87865317, 'auroc': 0.98777163, 'binary_precision': 0.8078669, 'binary_recall': 0.7265306, 'binary_specificity': 0.9939984, 'binary_f1_score': 0.76504296}
confusion matrix:
       0     1
0  42068   254
1    402  1068
---- Validation: 
scalar performance:
{'acc': 0.9818008, 'precision': 0.8941597, 'recall': 0.80831456, 'specificity': 0.80831456, 'f1': 0.8455703, 'auroc': 0.97741205, 'binary_precision': 0.8016032, 'binary_recall': 0.62208396, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.70052534}
confusion matrix:
       0    1
0  18050   99
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.85254705, 'recall': 0.5490581, 'specificity': 0.5490581, 'f1': 0.5778542, 'auroc': 0.9596099, 'binary_precision': 0.74285716, 'binary_recall': 0.099616855, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.17567569}
confusion matrix:
      0   1
0  5988   9
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 7
val acc:0.9818007946014404, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 19,now: 2024-05-28 01:46:50.465145,epoch time: 0:19:34.374659,used: 6:13:47.557755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9848146, 'precision': 0.8988063, 'recall': 0.8570652, 'specificity': 0.8570652, 'f1': 0.8766894, 'auroc': 0.990103, 'binary_precision': 0.8073115, 'binary_recall': 0.7201087, 'binary_specificity': 0.9940217, 'binary_f1_score': 0.7612208}
confusion matrix:
       0     1
0  42067   253
1    412  1060
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.8925967, 'recall': 0.8244239, 'specificity': 0.8244239, 'f1': 0.8550042, 'auroc': 0.9777338, 'binary_precision': 0.7973485, 'binary_recall': 0.6547434, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.71904355}
confusion matrix:
       0    1
0  18042  107
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.9377861, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 8
val acc:0.9824925661087036, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 20,now: 2024-05-28 02:06:30.374165,epoch time: 0:19:39.909020,used: 6:33:27.466775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98182315, 'precision': 0.8479995, 'recall': 0.89118433, 'specificity': 0.89118433, 'f1': 0.86821187, 'auroc': 0.98591626, 'binary_precision': 0.70319086, 'binary_recall': 0.7940177, 'binary_specificity': 0.9883509, 'binary_f1_score': 0.74584925}
confusion matrix:
       0     1
0  41828   493
1    303  1168
---- Validation: 
scalar performance:
{'acc': 0.9788208, 'precision': 0.8299049, 'recall': 0.8712765, 'specificity': 0.8712765, 'f1': 0.8492494, 'auroc': 0.9783221, 'binary_precision': 0.66850066, 'binary_recall': 0.755832, 'binary_specificity': 0.98672104, 'binary_f1_score': 0.70948905}
confusion matrix:
       0    1
0  17908  241
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7709805, 'recall': 0.5686301, 'specificity': 0.5686301, 'f1': 0.6035517, 'auroc': 0.9277135, 'binary_precision': 0.578125, 'binary_recall': 0.14176245, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2276923}
confusion matrix:
      0   1
0  5970  27
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 9
val acc:0.97882080078125, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9600511193275452 / 0.972195565700531
after epoch: 21,now: 2024-05-28 02:26:08.578479,epoch time: 0:19:38.204314,used: 6:53:05.671089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98771465, 'precision': 0.9092165, 'recall': 0.89954805, 'specificity': 0.89954805, 'f1': 0.90431976, 'auroc': 0.99166936, 'binary_precision': 0.8252089, 'binary_recall': 0.8050272, 'binary_specificity': 0.994069, 'binary_f1_score': 0.8149931}
confusion matrix:
       0     1
0  42069   251
1    287  1185
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.89609927, 'recall': 0.87227726, 'specificity': 0.87227726, 'f1': 0.88378775, 'auroc': 0.97911197, 'binary_precision': 0.80099505, 'binary_recall': 0.7511664, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.7752809}
confusion matrix:
       0    1
0  18029  120
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7845403, 'recall': 0.5260696, 'specificity': 0.5260696, 'f1': 0.5388314, 'auroc': 0.9305393, 'binary_precision': 0.6086956, 'binary_recall': 0.053639848, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.09859155}
confusion matrix:
      0   1
0  5988   9
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 22,now: 2024-05-28 02:45:39.535588,epoch time: 0:19:30.957109,used: 7:12:36.628198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98433506, 'precision': 0.8555565, 'recall': 0.9374323, 'specificity': 0.9374323, 'f1': 0.89186513, 'auroc': 0.99203706, 'binary_precision': 0.7150685, 'binary_recall': 0.8871516, 'binary_specificity': 0.987713, 'binary_f1_score': 0.791869}
confusion matrix:
       0     1
0  41801   520
1    166  1305
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.8677243, 'recall': 0.9154774, 'specificity': 0.9154774, 'f1': 0.8900095, 'auroc': 0.98044276, 'binary_precision': 0.7410959, 'binary_recall': 0.84136856, 'binary_specificity': 0.9895862, 'binary_f1_score': 0.78805536}
confusion matrix:
       0    1
0  17960  189
1    102  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.82502186, 'recall': 0.6013639, 'specificity': 0.6013639, 'f1': 0.6492966, 'auroc': 0.94820476, 'binary_precision': 0.6835443, 'binary_recall': 0.20689656, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31764707}
confusion matrix:
      0   1
0  5972  25
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 1
val acc:0.9845147132873535, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.959092378616333 / 0.972195565700531
after epoch: 23,now: 2024-05-28 03:05:07.867009,epoch time: 0:19:28.331421,used: 7:32:04.959619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98762333, 'precision': 0.91427743, 'recall': 0.8903208, 'specificity': 0.8903208, 'f1': 0.9019136, 'auroc': 0.99109685, 'binary_precision': 0.8359827, 'binary_recall': 0.78600544, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.8102241}
confusion matrix:
       0     1
0  42093   227
1    315  1157
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9042704, 'recall': 0.8756907, 'specificity': 0.8756907, 'f1': 0.88941336, 'auroc': 0.98114336, 'binary_precision': 0.8171141, 'binary_recall': 0.7573872, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7861179}
confusion matrix:
       0    1
0  18040  109
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.945932, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 24,now: 2024-05-28 03:24:33.034580,epoch time: 0:19:25.167571,used: 7:51:30.127190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98326176, 'precision': 0.89252627, 'recall': 0.8342953, 'specificity': 0.8342953, 'f1': 0.8608892, 'auroc': 0.9909338, 'binary_precision': 0.79631114, 'binary_recall': 0.6745924, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.7304156}
confusion matrix:
       0    1
0  42066  254
1    479  993
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.89373195, 'recall': 0.84447634, 'specificity': 0.84447634, 'f1': 0.8673243, 'auroc': 0.9783951, 'binary_precision': 0.79821426, 'binary_recall': 0.69517887, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.74314207}
confusion matrix:
       0    1
0  18036  113
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.80635965, 'recall': 0.5280686, 'specificity': 0.5280686, 'f1': 0.5424343, 'auroc': 0.92397416, 'binary_precision': 0.65217394, 'binary_recall': 0.057471264, 'binary_specificity': 0.998666, 'binary_f1_score': 0.105633795}
confusion matrix:
      0   1
0  5989   8
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 1
val acc:0.9835568070411682, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9610099196434021 / 0.972195565700531
after epoch: 25,now: 2024-05-28 03:43:49.964892,epoch time: 0:19:16.930312,used: 8:10:47.057502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9878517, 'precision': 0.92096406, 'recall': 0.88552105, 'specificity': 0.88552105, 'f1': 0.9024018, 'auroc': 0.9937078, 'binary_precision': 0.84970236, 'binary_recall': 0.7758152, 'binary_specificity': 0.99522686, 'binary_f1_score': 0.8110795}
confusion matrix:
       0     1
0  42118   202
1    330  1142
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.90291476, 'recall': 0.83172536, 'specificity': 0.83172536, 'f1': 0.863593, 'auroc': 0.98188424, 'binary_precision': 0.8174905, 'binary_recall': 0.6687403, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7356715}
confusion matrix:
       0    1
0  18053   96
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8818009, 'recall': 0.62501943, 'specificity': 0.62501943, 'f1': 0.68315196, 'auroc': 0.9354214, 'binary_precision': 0.79518074, 'binary_recall': 0.25287357, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.38372093}
confusion matrix:
      0   1
0  5980  17
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 2
val acc:0.9835568070411682, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9610099196434021 / 0.972195565700531
after epoch: 26,now: 2024-05-28 04:03:04.959165,epoch time: 0:19:14.994273,used: 8:30:02.051775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9855453, 'precision': 0.8726715, 'recall': 0.9220315, 'specificity': 0.9220315, 'f1': 0.89567965, 'auroc': 0.991943, 'binary_precision': 0.75044775, 'binary_recall': 0.8539402, 'binary_specificity': 0.99012285, 'binary_f1_score': 0.798856}
confusion matrix:
       0     1
0  41902   418
1    215  1257
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.87699217, 'recall': 0.8860324, 'specificity': 0.8860324, 'f1': 0.881454, 'auroc': 0.97964907, 'binary_precision': 0.76176023, 'binary_recall': 0.7807154, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.7711214}
confusion matrix:
       0    1
0  17992  157
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.84522265, 'recall': 0.6224367, 'specificity': 0.6224367, 'f1': 0.67610174, 'auroc': 0.9033066, 'binary_precision': 0.7222222, 'binary_recall': 0.24904214, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.37037036}
confusion matrix:
      0   1
0  5972  25
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 3
val acc:0.9841421842575073, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9610099196434021 / 0.972195565700531
after epoch: 27,now: 2024-05-28 04:22:19.530489,epoch time: 0:19:14.571324,used: 8:49:16.623099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.87850475, 'recall': 0.9394376, 'specificity': 0.9394376, 'f1': 0.90649617, 'auroc': 0.9941707, 'binary_precision': 0.76090753, 'binary_recall': 0.88858694, 'binary_specificity': 0.99028826, 'binary_f1_score': 0.81980574}
confusion matrix:
       0     1
0  41909   411
1    164  1308
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.8724808, 'recall': 0.90422654, 'specificity': 0.90422654, 'f1': 0.88764566, 'auroc': 0.97963405, 'binary_precision': 0.75142854, 'binary_recall': 0.81804043, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.7833209}
confusion matrix:
       0    1
0  17975  174
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.88492227, 'recall': 0.6080282, 'specificity': 0.6080282, 'f1': 0.6627406, 'auroc': 0.9139246, 'binary_precision': 0.8028169, 'binary_recall': 0.21839081, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3433735}
confusion matrix:
      0   1
0  5983  14
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 4
val acc:0.9845147132873535, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9610099196434021 / 0.972195565700531
after epoch: 28,now: 2024-05-28 04:41:53.721051,epoch time: 0:19:34.190562,used: 9:08:50.813661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98876506, 'precision': 0.9188642, 'recall': 0.90566516, 'specificity': 0.90566516, 'f1': 0.9121505, 'auroc': 0.9934875, 'binary_precision': 0.84410113, 'binary_recall': 0.81657606, 'binary_specificity': 0.99475425, 'binary_f1_score': 0.8301105}
confusion matrix:
       0     1
0  42098   222
1    270  1202
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9136956, 'recall': 0.8675778, 'specificity': 0.8675778, 'f1': 0.88916504, 'auroc': 0.98074186, 'binary_precision': 0.83655536, 'binary_recall': 0.7402799, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.78547853}
confusion matrix:
       0    1
0  18056   93
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.91013587, 'recall': 0.6406786, 'specificity': 0.6406786, 'f1': 0.7044254, 'auroc': 0.9387388, 'binary_precision': 0.85057473, 'binary_recall': 0.2835249, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.42528737}
confusion matrix:
      0   1
0  5984  13
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
better model found
persisted
after epoch: 29,now: 2024-05-28 05:01:14.733551,epoch time: 0:19:21.012500,used: 9:28:11.826161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9893588, 'precision': 0.94114965, 'recall': 0.888268, 'specificity': 0.888268, 'f1': 0.9128939, 'auroc': 0.99427414, 'binary_precision': 0.8899225, 'binary_recall': 0.7798913, 'binary_specificity': 0.9966446, 'binary_f1_score': 0.83128166}
confusion matrix:
       0     1
0  42178   142
1    324  1148
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9164908, 'recall': 0.85302377, 'specificity': 0.85302377, 'f1': 0.8819314, 'auroc': 0.97994906, 'binary_precision': 0.84317344, 'binary_recall': 0.71073097, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.77130806}
confusion matrix:
       0    1
0  18064   85
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8991684, 'recall': 0.61202633, 'specificity': 0.61202633, 'f1': 0.66892886, 'auroc': 0.89833164, 'binary_precision': 0.8309859, 'binary_recall': 0.22605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.3554217}
confusion matrix:
      0   1
0  5985  12
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897895.png
early stop counter: 1
val acc:0.9855789542198181, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9680408835411072 / 0.972195565700531
after epoch: 30,now: 2024-05-28 05:20:38.753544,epoch time: 0:19:24.019993,used: 9:47:35.846154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:47:35.846154 at 2024-05-28 05:20:38.753544
persisted model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.91420454, 'recall': 0.6597523, 'specificity': 0.6597523, 'f1': 0.72612774, 'auroc': 0.94585514, 'binary_precision': 0.85714287, 'binary_recall': 0.3218391, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4679666}
confusion matrix:
      0   1
0  5983  14
1   177  84
oracle model performance metric: 

scalar performance:
{'acc': 0.97267497, 'precision': 0.8884578, 'recall': 0.7273838, 'specificity': 0.7273838, 'f1': 0.7849076, 'auroc': 0.94679826, 'binary_precision': 0.8, 'binary_recall': 0.4597701, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.5839416}
confusion matrix:
      0    1
0  5967   30
1   141  120
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |  88733 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2108 MiB |   2108 MiB |   2108 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    849 MiB |    866 MiB | 687736 GiB | 687736 GiB |
|       from large pool |    842 MiB |    863 MiB | 684083 GiB | 684082 GiB |
|       from small pool |      6 MiB |     18 MiB |   3653 GiB |   3653 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  129124 K  |  129120 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73601 K  |   73597 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  129124 K  |  129120 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73601 K  |   73597 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |      96    |      96    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2764    |   53457 K  |   53457 K  |
|       from large pool |      18    |      22    |   19254 K  |   19254 K  |
|       from small pool |      36    |    2746    |   34202 K  |   34202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687737 GiB | 687737 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684083 GiB | 684083 GiB |
|       from small pool |      0 KiB |     28 MiB |   3653 GiB |   3653 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129124 K  |  129124 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73601 K  |   73601 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129124 K  |  129124 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73601 K  |   73601 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53459 K  |   53459 K  |
|       from large pool |       4    |      25    |   19254 K  |   19254 K  |
|       from small pool |       0    |    2746    |   34204 K  |   34204 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687737 GiB | 687737 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684083 GiB | 684083 GiB |
|       from small pool |      0 KiB |     28 MiB |   3653 GiB |   3653 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129124 K  |  129124 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73601 K  |   73601 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129124 K  |  129124 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73601 K  |   73601 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53459 K  |   53459 K  |
|       from large pool |       4    |      25    |   19254 K  |   19254 K  |
|       from small pool |       0    |    2746    |   34204 K  |   34204 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895

 Experiment start at: 2024-05-28 05:28:53.188863
before training, model accuracy: 0.2590968608856201
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96348894, 'precision': 0.8369831, 'recall': 0.70104235, 'specificity': 0.70104235, 'f1': 0.74979985, 'auroc': 0.9519602, 'binary_precision': 0.70298046, 'binary_recall': 0.4108108, 'binary_specificity': 0.9912739, 'binary_f1_score': 0.51857466}
confusion matrix:
       0    1
0  32830  289
1    981  684
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.962777, 'precision': 0.8720623, 'recall': 0.6630939, 'specificity': 0.6630939, 'f1': 0.72253656, 'auroc': 0.9588034, 'binary_precision': 0.7774193, 'binary_recall': 0.33104396, 'binary_specificity': 0.99514395, 'binary_f1_score': 0.46435454}
confusion matrix:
       0    1
0  14140   69
1    487  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99456805, 'precision': 0.58485913, 'recall': 0.52878726, 'specificity': 0.52878726, 'f1': 0.542594, 'auroc': 0.8136712, 'binary_precision': 0.17391305, 'binary_recall': 0.05882353, 'binary_specificity': 0.998751, 'binary_f1_score': 0.08791209}
confusion matrix:
       0   1
0  15193  19
1     64   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 05:50:36.289403,epoch time: 0:21:43.100540,used: 0:21:43.100540,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96659386, 'precision': 0.82840204, 'recall': 0.7808185, 'specificity': 0.7808185, 'f1': 0.8025029, 'auroc': 0.95666134, 'binary_precision': 0.6779901, 'binary_recall': 0.5753754, 'binary_specificity': 0.98626167, 'binary_f1_score': 0.6224821}
confusion matrix:
       0    1
0  32664  455
1    707  958
---- Validation: 
scalar performance:
{'acc': 0.9649193, 'precision': 0.8364297, 'recall': 0.74111164, 'specificity': 0.74111164, 'f1': 0.7798993, 'auroc': 0.9571949, 'binary_precision': 0.6984436, 'binary_recall': 0.49313188, 'binary_specificity': 0.9890914, 'binary_f1_score': 0.5780998}
confusion matrix:
       0    1
0  14054  155
1    369  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99018323, 'precision': 0.5388403, 'recall': 0.55586535, 'specificity': 0.55586535, 'f1': 0.54572517, 'auroc': 0.8237643, 'binary_precision': 0.08163265, 'binary_recall': 0.11764706, 'binary_specificity': 0.99408364, 'binary_f1_score': 0.09638554}
confusion matrix:
       0   1
0  15122  90
1     60   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 2,now: 2024-05-28 06:10:15.047299,epoch time: 0:19:38.757896,used: 0:41:21.858436,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9706762, 'precision': 0.8859728, 'recall': 0.757294, 'specificity': 0.757294, 'f1': 0.8073158, 'auroc': 0.9708072, 'binary_precision': 0.79560035, 'binary_recall': 0.5213213, 'binary_specificity': 0.9932667, 'binary_f1_score': 0.62989837}
confusion matrix:
       0    1
0  32896  223
1    797  868
---- Validation: 
scalar performance:
{'acc': 0.9638482, 'precision': 0.8871571, 'recall': 0.6675667, 'specificity': 0.6675667, 'f1': 0.72951615, 'auroc': 0.9603826, 'binary_precision': 0.8071895, 'binary_recall': 0.3392857, 'binary_specificity': 0.9958477, 'binary_f1_score': 0.4777563}
confusion matrix:
       0    1
0  14150   59
1    481  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98992145, 'precision': 0.5830972, 'recall': 0.6582149, 'specificity': 0.6582149, 'f1': 0.60857505, 'auroc': 0.83187807, 'binary_precision': 0.16923077, 'binary_recall': 0.32352942, 'binary_specificity': 0.9929004, 'binary_f1_score': 0.22222224}
confusion matrix:
       0    1
0  15104  108
1     46   22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9638481736183167, best validation acc: 0.9649193286895752, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 3,now: 2024-05-28 06:29:49.301984,epoch time: 0:19:34.254685,used: 1:00:56.113121,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9719124, 'precision': 0.83880997, 'recall': 0.86632043, 'specificity': 0.86632043, 'f1': 0.8519526, 'auroc': 0.9654517, 'binary_precision': 0.6902655, 'binary_recall': 0.74954957, 'binary_specificity': 0.9830913, 'binary_f1_score': 0.718687}
confusion matrix:
       0     1
0  32559   560
1    417  1248
---- Validation: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.8282637, 'recall': 0.85551345, 'specificity': 0.85551345, 'f1': 0.8412657, 'auroc': 0.9630891, 'binary_precision': 0.67045456, 'binary_recall': 0.7293956, 'binary_specificity': 0.98163134, 'binary_f1_score': 0.6986843}
confusion matrix:
       0    1
0  13948  261
1    197  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99018323, 'precision': 0.6043787, 'recall': 0.7169069, 'specificity': 0.7169069, 'f1': 0.640386, 'auroc': 0.8977201, 'binary_precision': 0.2112676, 'binary_recall': 0.44117647, 'binary_specificity': 0.9926374, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  15100  112
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 4,now: 2024-05-28 06:49:33.634068,epoch time: 0:19:44.332084,used: 1:20:40.445205,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96567386, 'precision': 0.79824996, 'recall': 0.8898535, 'specificity': 0.8898535, 'f1': 0.8369665, 'auroc': 0.9728809, 'binary_precision': 0.60641664, 'binary_recall': 0.806006, 'binary_specificity': 0.9737009, 'binary_f1_score': 0.69210935}
confusion matrix:
       0     1
0  32248   871
1    323  1342
---- Validation: 
scalar performance:
{'acc': 0.9600321, 'precision': 0.77627623, 'recall': 0.8884164, 'specificity': 0.8884164, 'f1': 0.8212079, 'auroc': 0.9632021, 'binary_precision': 0.5625597, 'binary_recall': 0.80906594, 'binary_specificity': 0.9677669, 'binary_f1_score': 0.663662}
confusion matrix:
       0    1
0  13751  458
1    139  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910995, 'precision': 0.6045142, 'recall': 0.6807667, 'specificity': 0.6807667, 'f1': 0.63216984, 'auroc': 0.8360404, 'binary_precision': 0.21186441, 'binary_recall': 0.36764705, 'binary_specificity': 0.9938864, 'binary_f1_score': 0.26881722}
confusion matrix:
       0   1
0  15119  93
1     43  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9600321054458618, best validation acc: 0.9693378806114197, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 5,now: 2024-05-28 07:09:21.547546,epoch time: 0:19:47.913478,used: 1:40:28.358683,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96601886, 'precision': 0.79736817, 'recall': 0.9131361, 'specificity': 0.9131361, 'f1': 0.8442596, 'auroc': 0.9767703, 'binary_precision': 0.60220057, 'binary_recall': 0.85465467, 'binary_specificity': 0.9716175, 'binary_f1_score': 0.7065541}
confusion matrix:
       0     1
0  32179   940
1    242  1423
---- Validation: 
scalar performance:
{'acc': 0.9659905, 'precision': 0.7998322, 'recall': 0.91370344, 'specificity': 0.91370344, 'f1': 0.84615546, 'auroc': 0.97353065, 'binary_precision': 0.6072125, 'binary_recall': 0.8557692, 'binary_specificity': 0.97163767, 'binary_f1_score': 0.7103763}
confusion matrix:
       0    1
0  13806  403
1    105  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785995, 'precision': 0.54833215, 'recall': 0.7257293, 'specificity': 0.7257293, 'f1': 0.576422, 'auroc': 0.8695327, 'binary_precision': 0.099071205, 'binary_recall': 0.47058824, 'binary_specificity': 0.98087037, 'binary_f1_score': 0.16368285}
confusion matrix:
       0    1
0  14921  291
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 2
val acc:0.9659904837608337, best validation acc: 0.9693378806114197, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 6,now: 2024-05-28 07:28:58.390365,epoch time: 0:19:36.842819,used: 2:00:05.201502,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9768572, 'precision': 0.87660766, 'recall': 0.8660651, 'specificity': 0.8660651, 'f1': 0.87125194, 'auroc': 0.98133165, 'binary_precision': 0.7660891, 'binary_recall': 0.74354357, 'binary_specificity': 0.9885866, 'binary_f1_score': 0.75464803}
confusion matrix:
       0     1
0  32741   378
1    427  1238
---- Validation: 
scalar performance:
{'acc': 0.976836, 'precision': 0.89798295, 'recall': 0.8372994, 'specificity': 0.8372994, 'f1': 0.8648325, 'auroc': 0.9739063, 'binary_precision': 0.8120915, 'binary_recall': 0.6826923, 'binary_specificity': 0.9919065, 'binary_f1_score': 0.741791}
confusion matrix:
       0    1
0  14094  115
1    231  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9907068, 'precision': 0.6063722, 'recall': 0.7025297, 'specificity': 0.7025297, 'f1': 0.6390757, 'auroc': 0.8231227, 'binary_precision': 0.21538462, 'binary_recall': 0.4117647, 'binary_specificity': 0.9932948, 'binary_f1_score': 0.28282827}
confusion matrix:
       0    1
0  15110  102
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 7,now: 2024-05-28 07:48:42.654872,epoch time: 0:19:44.264507,used: 2:19:49.466009,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9768859, 'precision': 0.88287, 'recall': 0.85524243, 'specificity': 0.85524243, 'f1': 0.8684743, 'auroc': 0.98225164, 'binary_precision': 0.7797271, 'binary_recall': 0.7207207, 'binary_specificity': 0.98976415, 'binary_f1_score': 0.7490637}
confusion matrix:
       0     1
0  32780   339
1    465  1200
---- Validation: 
scalar performance:
{'acc': 0.97723776, 'precision': 0.8963146, 'recall': 0.84533006, 'specificity': 0.84533006, 'f1': 0.86885434, 'auroc': 0.9774498, 'binary_precision': 0.8079365, 'binary_recall': 0.69917583, 'binary_specificity': 0.9914843, 'binary_f1_score': 0.7496318}
confusion matrix:
       0    1
0  14088  121
1    219  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98965967, 'precision': 0.59016204, 'recall': 0.6873637, 'specificity': 0.6873637, 'f1': 0.6212066, 'auroc': 0.8366492, 'binary_precision': 0.18309858, 'binary_recall': 0.38235295, 'binary_specificity': 0.9923744, 'binary_f1_score': 0.24761906}
confusion matrix:
       0    1
0  15096  116
1     42   26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 8,now: 2024-05-28 08:08:15.747376,epoch time: 0:19:33.092504,used: 2:39:22.558513,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9795021, 'precision': 0.9389341, 'recall': 0.8218215, 'specificity': 0.8218215, 'f1': 0.8703958, 'auroc': 0.98645663, 'binary_precision': 0.89534885, 'binary_recall': 0.64744747, 'binary_specificity': 0.99619555, 'binary_f1_score': 0.75148135}
confusion matrix:
       0     1
0  32993   126
1    587  1078
---- Validation: 
scalar performance:
{'acc': 0.9748276, 'precision': 0.9301833, 'recall': 0.77694595, 'specificity': 0.77694595, 'f1': 0.83519715, 'auroc': 0.9785656, 'binary_precision': 0.8826087, 'binary_recall': 0.5576923, 'binary_specificity': 0.9961996, 'binary_f1_score': 0.6835017}
confusion matrix:
       0    1
0  14155   54
1    322  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99005234, 'precision': 0.6069186, 'recall': 0.7314813, 'specificity': 0.7314813, 'f1': 0.64564353, 'auroc': 0.8528054, 'binary_precision': 0.21621622, 'binary_recall': 0.47058824, 'binary_specificity': 0.9923744, 'binary_f1_score': 0.2962963}
confusion matrix:
       0    1
0  15096  116
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9748275876045227, best validation acc: 0.9772377610206604, corresponding to test acc:                         0.9896596670150757 / 0.9945680499076843
after epoch: 9,now: 2024-05-28 08:27:57.395099,epoch time: 0:19:41.647723,used: 2:59:04.206236,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9747585, 'precision': 0.85404897, 'recall': 0.8797935, 'specificity': 0.8797935, 'f1': 0.8664076, 'auroc': 0.982429, 'binary_precision': 0.7194646, 'binary_recall': 0.7747748, 'binary_specificity': 0.9848123, 'binary_f1_score': 0.7460961}
confusion matrix:
       0     1
0  32616   503
1    375  1290
---- Validation: 
scalar performance:
{'acc': 0.9767691, 'precision': 0.8793094, 'recall': 0.8659357, 'specificity': 0.8659357, 'f1': 0.87248695, 'auroc': 0.9770519, 'binary_precision': 0.7717546, 'binary_recall': 0.7431319, 'binary_specificity': 0.98873955, 'binary_f1_score': 0.7571729}
confusion matrix:
       0    1
0  14049  160
1    187  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905759, 'precision': 0.6090395, 'recall': 0.71710414, 'specificity': 0.71710414, 'f1': 0.64468694, 'auroc': 0.86564493, 'binary_precision': 0.22058824, 'binary_recall': 0.44117647, 'binary_specificity': 0.9930318, 'binary_f1_score': 0.29411766}
confusion matrix:
       0    1
0  15106  106
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 2
val acc:0.9767690896987915, best validation acc: 0.9772377610206604, corresponding to test acc:                         0.9896596670150757 / 0.9945680499076843
after epoch: 10,now: 2024-05-28 08:47:31.961062,epoch time: 0:19:34.565963,used: 3:18:38.772199,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9733211, 'precision': 0.8343463, 'recall': 0.9141187, 'specificity': 0.9141187, 'f1': 0.8693483, 'auroc': 0.98485094, 'binary_precision': 0.6764002, 'binary_recall': 0.84864867, 'binary_specificity': 0.97958875, 'binary_f1_score': 0.752797}
confusion matrix:
       0     1
0  32443   676
1    252  1413
---- Validation: 
scalar performance:
{'acc': 0.9729531, 'precision': 0.84264165, 'recall': 0.88608515, 'specificity': 0.88608515, 'f1': 0.8628801, 'auroc': 0.97520894, 'binary_precision': 0.6961259, 'binary_recall': 0.78983516, 'binary_specificity': 0.98233515, 'binary_f1_score': 0.7400257}
confusion matrix:
       0    1
0  13958  251
1    153  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9878927, 'precision': 0.58348775, 'recall': 0.71575654, 'specificity': 0.71575654, 'f1': 0.6193977, 'auroc': 0.85612774, 'binary_precision': 0.16949153, 'binary_recall': 0.44117647, 'binary_specificity': 0.9903366, 'binary_f1_score': 0.24489796}
confusion matrix:
       0    1
0  15065  147
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 3
val acc:0.9729530811309814, best validation acc: 0.9772377610206604, corresponding to test acc:                         0.9896596670150757 / 0.9945680499076843
after epoch: 11,now: 2024-05-28 09:07:13.919691,epoch time: 0:19:41.958629,used: 3:38:20.730828,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9760522, 'precision': 0.8526834, 'recall': 0.90870804, 'specificity': 0.90870804, 'f1': 0.8783432, 'auroc': 0.98459744, 'binary_precision': 0.7137718, 'binary_recall': 0.83423424, 'binary_specificity': 0.98318183, 'binary_f1_score': 0.76931596}
confusion matrix:
       0     1
0  32562   557
1    276  1389
---- Validation: 
scalar performance:
{'acc': 0.97208273, 'precision': 0.83543336, 'recall': 0.89214396, 'specificity': 0.89214396, 'f1': 0.86124915, 'auroc': 0.97459203, 'binary_precision': 0.68102443, 'binary_recall': 0.8035714, 'binary_specificity': 0.98071647, 'binary_f1_score': 0.7372401}
confusion matrix:
       0    1
0  13935  274
1    143  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9909686, 'precision': 0.61199427, 'recall': 0.7099813, 'specificity': 0.7099813, 'f1': 0.64568675, 'auroc': 0.801813, 'binary_precision': 0.2265625, 'binary_recall': 0.42647058, 'binary_specificity': 0.993492, 'binary_f1_score': 0.29591838}
confusion matrix:
       0   1
0  15113  99
1     39  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 4
val acc:0.9720827341079712, best validation acc: 0.9772377610206604, corresponding to test acc:                         0.9896596670150757 / 0.9945680499076843
after epoch: 12,now: 2024-05-28 09:26:44.044955,epoch time: 0:19:30.125264,used: 3:57:50.856092,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9830957, 'precision': 0.91464424, 'recall': 0.89615023, 'specificity': 0.89615023, 'f1': 0.9051608, 'auroc': 0.9888581, 'binary_precision': 0.83931947, 'binary_recall': 0.8, 'binary_specificity': 0.9923005, 'binary_f1_score': 0.8191882}
confusion matrix:
       0     1
0  32864   255
1    333  1332
---- Validation: 
scalar performance:
{'acc': 0.979447, 'precision': 0.90047663, 'recall': 0.8706014, 'specificity': 0.8706014, 'f1': 0.88488805, 'auroc': 0.9780714, 'binary_precision': 0.81371087, 'binary_recall': 0.75, 'binary_specificity': 0.9912028, 'binary_f1_score': 0.7805575}
confusion matrix:
       0    1
0  14084  125
1    182  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99064136, 'precision': 0.60773516, 'recall': 0.70981693, 'specificity': 0.70981693, 'f1': 0.6419234, 'auroc': 0.788536, 'binary_precision': 0.21804512, 'binary_recall': 0.42647058, 'binary_specificity': 0.9931633, 'binary_f1_score': 0.2885572}
confusion matrix:
       0    1
0  15108  104
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 13,now: 2024-05-28 09:47:18.738884,epoch time: 0:20:34.693929,used: 4:18:25.550021,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9813995, 'precision': 0.88273907, 'recall': 0.9272023, 'specificity': 0.9272023, 'f1': 0.90358746, 'auroc': 0.9895866, 'binary_precision': 0.77219254, 'binary_recall': 0.86726725, 'binary_specificity': 0.9871373, 'binary_f1_score': 0.8169731}
confusion matrix:
       0     1
0  32693   426
1    221  1444
---- Validation: 
scalar performance:
{'acc': 0.9806521, 'precision': 0.8907457, 'recall': 0.9044676, 'specificity': 0.9044676, 'f1': 0.89747274, 'auroc': 0.9792737, 'binary_precision': 0.79072845, 'binary_recall': 0.82005495, 'binary_specificity': 0.9888803, 'binary_f1_score': 0.80512476}
confusion matrix:
       0    1
0  14051  158
1    131  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98638743, 'precision': 0.5772374, 'recall': 0.72964066, 'specificity': 0.72964066, 'f1': 0.61421335, 'auroc': 0.80492353, 'binary_precision': 0.15686275, 'binary_recall': 0.47058824, 'binary_specificity': 0.9886931, 'binary_f1_score': 0.23529412}
confusion matrix:
       0    1
0  15040  172
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 14,now: 2024-05-28 10:06:47.163741,epoch time: 0:19:28.424857,used: 4:37:53.974878,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9777771, 'precision': 0.8564596, 'recall': 0.9310041, 'specificity': 0.9310041, 'f1': 0.8897009, 'auroc': 0.9889649, 'binary_precision': 0.71905696, 'binary_recall': 0.87927926, 'binary_specificity': 0.98272896, 'binary_f1_score': 0.7911375}
confusion matrix:
       0     1
0  32547   572
1    201  1464
---- Validation: 
scalar performance:
{'acc': 0.9771038, 'precision': 0.8593936, 'recall': 0.9169383, 'specificity': 0.9169383, 'f1': 0.8857285, 'auroc': 0.98008984, 'binary_precision': 0.72652584, 'binary_recall': 0.85027474, 'binary_specificity': 0.9836019, 'binary_f1_score': 0.78354436}
confusion matrix:
       0    1
0  13976  233
1    109  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9887435, 'precision': 0.5882163, 'recall': 0.70886374, 'specificity': 0.70886374, 'f1': 0.62325144, 'auroc': 0.81349355, 'binary_precision': 0.17901234, 'binary_recall': 0.42647058, 'binary_specificity': 0.9912569, 'binary_f1_score': 0.2521739}
confusion matrix:
       0    1
0  15079  133
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9771038293838501, best validation acc: 0.9806520938873291, corresponding to test acc:                         0.9863874316215515 / 0.9945680499076843
after epoch: 15,now: 2024-05-28 10:26:32.056438,epoch time: 0:19:44.892697,used: 4:57:38.867575,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9819457, 'precision': 0.9189551, 'recall': 0.87472653, 'specificity': 0.87472653, 'f1': 0.89546335, 'auroc': 0.9859779, 'binary_precision': 0.8501013, 'binary_recall': 0.75615615, 'binary_specificity': 0.9932969, 'binary_f1_score': 0.8003815}
confusion matrix:
       0     1
0  32897   222
1    406  1259
---- Validation: 
scalar performance:
{'acc': 0.9799156, 'precision': 0.91975677, 'recall': 0.8512989, 'specificity': 0.8512989, 'f1': 0.88213193, 'auroc': 0.97848725, 'binary_precision': 0.8543046, 'binary_recall': 0.7087912, 'binary_specificity': 0.9938067, 'binary_f1_score': 0.77477473}
confusion matrix:
       0    1
0  14121   88
1    212  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.990445, 'precision': 0.5886466, 'recall': 0.65847784, 'specificity': 0.65847784, 'f1': 0.61338586, 'auroc': 0.7623804, 'binary_precision': 0.18032786, 'binary_recall': 0.32352942, 'binary_specificity': 0.99342626, 'binary_f1_score': 0.23157896}
confusion matrix:
       0    1
0  15112  100
1     46   22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 2
val acc:0.9799156188964844, best validation acc: 0.9806520938873291, corresponding to test acc:                         0.9863874316215515 / 0.9945680499076843
after epoch: 16,now: 2024-05-28 10:46:39.699925,epoch time: 0:20:07.643487,used: 5:17:46.511062,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.981572, 'precision': 0.89057386, 'recall': 0.91388834, 'specificity': 0.91388834, 'f1': 0.9018495, 'auroc': 0.98937804, 'binary_precision': 0.7892655, 'binary_recall': 0.839039, 'binary_specificity': 0.9887376, 'binary_f1_score': 0.8133916}
confusion matrix:
       0     1
0  32746   373
1    268  1397
---- Validation: 
scalar performance:
{'acc': 0.98098683, 'precision': 0.8895466, 'recall': 0.9118115, 'specificity': 0.9118115, 'f1': 0.90032876, 'auroc': 0.9836549, 'binary_precision': 0.78756475, 'binary_recall': 0.83516484, 'binary_specificity': 0.98845804, 'binary_f1_score': 0.8106667}
confusion matrix:
       0    1
0  14045  164
1    120  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9871728, 'precision': 0.5821403, 'recall': 0.7300351, 'specificity': 0.7300351, 'f1': 0.6198426, 'auroc': 0.7809206, 'binary_precision': 0.16666667, 'binary_recall': 0.47058824, 'binary_specificity': 0.989482, 'binary_f1_score': 0.24615386}
confusion matrix:
       0    1
0  15052  160
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 17,now: 2024-05-28 11:06:40.782016,epoch time: 0:20:01.082091,used: 5:37:47.593153,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9861718, 'precision': 0.9447454, 'recall': 0.89805084, 'specificity': 0.89805084, 'f1': 0.91995716, 'auroc': 0.9918839, 'binary_precision': 0.8994602, 'binary_recall': 0.8006006, 'binary_specificity': 0.9955011, 'binary_f1_score': 0.84715605}
confusion matrix:
       0     1
0  32970   149
1    332  1333
---- Validation: 
scalar performance:
{'acc': 0.98118764, 'precision': 0.92263234, 'recall': 0.8643484, 'specificity': 0.8643484, 'f1': 0.8910771, 'auroc': 0.98034376, 'binary_precision': 0.858748, 'binary_recall': 0.7348901, 'binary_specificity': 0.9938067, 'binary_f1_score': 0.7920059}
confusion matrix:
       0    1
0  14121   88
1    193  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927356, 'precision': 0.62773234, 'recall': 0.6669483, 'specificity': 0.6669483, 'f1': 0.6446713, 'auroc': 0.8018041, 'binary_precision': 0.25842696, 'binary_recall': 0.3382353, 'binary_specificity': 0.9956613, 'binary_f1_score': 0.2929936}
confusion matrix:
       0   1
0  15146  66
1     45  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 18,now: 2024-05-28 11:26:46.751570,epoch time: 0:20:05.969554,used: 5:57:53.562707,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98050827, 'precision': 0.89871025, 'recall': 0.88366854, 'specificity': 0.88366854, 'f1': 0.8910269, 'auroc': 0.988701, 'binary_precision': 0.8086304, 'binary_recall': 0.7765766, 'binary_specificity': 0.99076056, 'binary_f1_score': 0.7922794}
confusion matrix:
       0     1
0  32813   306
1    372  1293
---- Validation: 
scalar performance:
{'acc': 0.9777733, 'precision': 0.91515774, 'recall': 0.8286693, 'specificity': 0.8286693, 'f1': 0.8663019, 'auroc': 0.9813552, 'binary_precision': 0.8473684, 'binary_recall': 0.66346157, 'binary_specificity': 0.9938771, 'binary_f1_score': 0.7442219}
confusion matrix:
       0    1
0  14122   87
1    245  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9895942, 'precision': 0.5848779, 'recall': 0.6726907, 'specificity': 0.6726907, 'f1': 0.61332285, 'auroc': 0.80505306, 'binary_precision': 0.17266187, 'binary_recall': 0.3529412, 'binary_specificity': 0.99244016, 'binary_f1_score': 0.23188406}
confusion matrix:
       0    1
0  15097  115
1     44   24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9777733087539673, best validation acc: 0.981187641620636, corresponding to test acc:                         0.9927356243133545 / 0.9945680499076843
after epoch: 19,now: 2024-05-28 11:46:29.149064,epoch time: 0:19:42.397494,used: 6:17:35.960201,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98530936, 'precision': 0.91592443, 'recall': 0.9246923, 'specificity': 0.9246923, 'f1': 0.920257, 'auroc': 0.99253273, 'binary_precision': 0.8390129, 'binary_recall': 0.8576577, 'binary_specificity': 0.9917268, 'binary_f1_score': 0.8482329}
confusion matrix:
       0     1
0  32845   274
1    237  1428
---- Validation: 
scalar performance:
{'acc': 0.9834639, 'precision': 0.9123155, 'recall': 0.90855205, 'specificity': 0.90855205, 'f1': 0.9104241, 'auroc': 0.98231506, 'binary_precision': 0.8335645, 'binary_recall': 0.8255494, 'binary_specificity': 0.9915547, 'binary_f1_score': 0.8295377}
confusion matrix:
       0    1
0  14089  120
1    127  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99018323, 'precision': 0.6043787, 'recall': 0.7169069, 'specificity': 0.7169069, 'f1': 0.640386, 'auroc': 0.8055695, 'binary_precision': 0.2112676, 'binary_recall': 0.44117647, 'binary_specificity': 0.9926374, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  15100  112
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 20,now: 2024-05-28 12:06:24.218502,epoch time: 0:19:55.069438,used: 6:37:31.029639,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98114073, 'precision': 0.90213335, 'recall': 0.88742316, 'specificity': 0.88742316, 'f1': 0.89462423, 'auroc': 0.9879694, 'binary_precision': 0.8151156, 'binary_recall': 0.7837838, 'binary_specificity': 0.9910625, 'binary_f1_score': 0.79914266}
confusion matrix:
       0     1
0  32823   296
1    360  1305
---- Validation: 
scalar performance:
{'acc': 0.97857666, 'precision': 0.89354706, 'recall': 0.8688407, 'specificity': 0.8688407, 'f1': 0.8807429, 'auroc': 0.98117864, 'binary_precision': 0.8, 'binary_recall': 0.74725276, 'binary_specificity': 0.9904286, 'binary_f1_score': 0.7727273}
confusion matrix:
       0    1
0  14073  136
1    184  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9884817, 'precision': 0.59722203, 'recall': 0.7526527, 'specificity': 0.7526527, 'f1': 0.6393735, 'auroc': 0.8174127, 'binary_precision': 0.19662921, 'binary_recall': 0.5147059, 'binary_specificity': 0.9905995, 'binary_f1_score': 0.28455284}
confusion matrix:
       0    1
0  15069  143
1     33   35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.97857666015625, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 21,now: 2024-05-28 12:26:10.720463,epoch time: 0:19:46.501961,used: 6:57:17.531600,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98418814, 'precision': 0.90999, 'recall': 0.9183994, 'specificity': 0.9183994, 'f1': 0.91414666, 'auroc': 0.9923389, 'binary_precision': 0.82774836, 'binary_recall': 0.84564567, 'binary_specificity': 0.9911531, 'binary_f1_score': 0.8366013}
confusion matrix:
       0     1
0  32826   293
1    257  1408
---- Validation: 
scalar performance:
{'acc': 0.9795809, 'precision': 0.8893502, 'recall': 0.8908721, 'specificity': 0.8908721, 'f1': 0.8901094, 'auroc': 0.97813547, 'binary_precision': 0.7893297, 'binary_recall': 0.7925824, 'binary_specificity': 0.9891618, 'binary_f1_score': 0.7909527}
confusion matrix:
       0    1
0  14055  154
1    151  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99051046, 'precision': 0.6122862, 'recall': 0.73171145, 'specificity': 0.73171145, 'f1': 0.6507213, 'auroc': 0.81148154, 'binary_precision': 0.22695035, 'binary_recall': 0.47058824, 'binary_specificity': 0.9928346, 'binary_f1_score': 0.30622005}
confusion matrix:
       0    1
0  15103  109
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 2
val acc:0.9795808792114258, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 22,now: 2024-05-28 12:45:45.153930,epoch time: 0:19:34.433467,used: 7:16:51.965067,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98614305, 'precision': 0.9247873, 'recall': 0.92284846, 'specificity': 0.92284846, 'f1': 0.92381537, 'auroc': 0.99374247, 'binary_precision': 0.8569704, 'binary_recall': 0.8528529, 'binary_specificity': 0.992844, 'binary_f1_score': 0.8549067}
confusion matrix:
       0     1
0  32882   237
1    245  1420
---- Validation: 
scalar performance:
{'acc': 0.98098683, 'precision': 0.90267533, 'recall': 0.8890046, 'specificity': 0.8890046, 'f1': 0.895707, 'auroc': 0.9793781, 'binary_precision': 0.8162393, 'binary_recall': 0.7870879, 'binary_specificity': 0.99092126, 'binary_f1_score': 0.8013985}
confusion matrix:
       0    1
0  14080  129
1    155  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99208117, 'precision': 0.6199426, 'recall': 0.68125975, 'specificity': 0.68125975, 'f1': 0.64420795, 'auroc': 0.79643905, 'binary_precision': 0.24271844, 'binary_recall': 0.36764705, 'binary_specificity': 0.99487245, 'binary_f1_score': 0.29239765}
confusion matrix:
       0   1
0  15134  78
1     43  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 3
val acc:0.9809868335723877, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 23,now: 2024-05-28 13:05:53.005735,epoch time: 0:20:07.851805,used: 7:36:59.816872,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98720676, 'precision': 0.9311688, 'recall': 0.9279703, 'specificity': 0.9279703, 'f1': 0.92956287, 'auroc': 0.9945401, 'binary_precision': 0.8692494, 'binary_recall': 0.86246246, 'binary_specificity': 0.99347806, 'binary_f1_score': 0.86584264}
confusion matrix:
       0     1
0  32903   216
1    229  1436
---- Validation: 
scalar performance:
{'acc': 0.9817902, 'precision': 0.90102106, 'recall': 0.903111, 'specificity': 0.903111, 'f1': 0.90206295, 'auroc': 0.98060226, 'binary_precision': 0.8114754, 'binary_recall': 0.81593406, 'binary_specificity': 0.99028784, 'binary_f1_score': 0.8136986}
confusion matrix:
       0    1
0  14071  138
1    134  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99123037, 'precision': 0.62574327, 'recall': 0.74671316, 'specificity': 0.74671316, 'f1': 0.66610986, 'auroc': 0.83746386, 'binary_precision': 0.25373134, 'binary_recall': 0.5, 'binary_specificity': 0.99342626, 'binary_f1_score': 0.33663365}
confusion matrix:
       0    1
0  15112  100
1     34   34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 4
val acc:0.9817901849746704, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 24,now: 2024-05-28 13:26:11.111510,epoch time: 0:20:18.105775,used: 7:57:17.922647,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9858843, 'precision': 0.9232621, 'recall': 0.92157173, 'specificity': 0.92157173, 'f1': 0.922415, 'auroc': 0.99391603, 'binary_precision': 0.85404104, 'binary_recall': 0.85045046, 'binary_specificity': 0.992693, 'binary_f1_score': 0.852242}
confusion matrix:
       0     1
0  32877   242
1    249  1416
---- Validation: 
scalar performance:
{'acc': 0.9799156, 'precision': 0.8999771, 'recall': 0.8780156, 'specificity': 0.8780156, 'f1': 0.88864744, 'auroc': 0.9830525, 'binary_precision': 0.81195337, 'binary_recall': 0.7651099, 'binary_specificity': 0.99092126, 'binary_f1_score': 0.78783596}
confusion matrix:
       0    1
0  14080  129
1    171  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9894633, 'precision': 0.6007206, 'recall': 0.7311855, 'specificity': 0.7311855, 'f1': 0.6395685, 'auroc': 0.8428033, 'binary_precision': 0.20382166, 'binary_recall': 0.47058824, 'binary_specificity': 0.9917828, 'binary_f1_score': 0.28444448}
confusion matrix:
       0    1
0  15087  125
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 5
val acc:0.9799156188964844, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 25,now: 2024-05-28 13:45:56.022087,epoch time: 0:19:44.910577,used: 8:17:02.833224,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9847056, 'precision': 0.90459234, 'recall': 0.9349277, 'specificity': 0.9349277, 'f1': 0.919142, 'auroc': 0.99319357, 'binary_precision': 0.81524765, 'binary_recall': 0.8798799, 'binary_specificity': 0.9899756, 'binary_f1_score': 0.84633166}
confusion matrix:
       0     1
0  32787   332
1    200  1465
---- Validation: 
scalar performance:
{'acc': 0.98004955, 'precision': 0.88159657, 'recall': 0.9132737, 'specificity': 0.9132737, 'f1': 0.89671874, 'auroc': 0.9768971, 'binary_precision': 0.77146465, 'binary_recall': 0.83928573, 'binary_specificity': 0.9872616, 'binary_f1_score': 0.8039474}
confusion matrix:
       0    1
0  14028  181
1    117  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99136126, 'precision': 0.6030623, 'recall': 0.66625804, 'specificity': 0.66625804, 'f1': 0.6270411, 'auroc': 0.79554236, 'binary_precision': 0.2090909, 'binary_recall': 0.3382353, 'binary_specificity': 0.9942808, 'binary_f1_score': 0.25842696}
confusion matrix:
       0   1
0  15125  87
1     45  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 6
val acc:0.9800495505332947, best validation acc: 0.9834638833999634, corresponding to test acc:                         0.9901832342147827 / 0.9945680499076843
after epoch: 26,now: 2024-05-28 14:06:05.942079,epoch time: 0:20:09.919992,used: 8:37:12.753216,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98896044, 'precision': 0.9509901, 'recall': 0.92518353, 'specificity': 0.92518353, 'f1': 0.937663, 'auroc': 0.9957133, 'binary_precision': 0.90926516, 'binary_recall': 0.85465467, 'binary_specificity': 0.99571246, 'binary_f1_score': 0.88111454}
confusion matrix:
       0     1
0  32977   142
1    242  1423
---- Validation: 
scalar performance:
{'acc': 0.98366475, 'precision': 0.93901473, 'recall': 0.87672806, 'specificity': 0.87672806, 'f1': 0.9052188, 'auroc': 0.980929, 'binary_precision': 0.89032257, 'binary_recall': 0.7582418, 'binary_specificity': 0.9952143, 'binary_f1_score': 0.8189911}
confusion matrix:
       0    1
0  14141   68
1    176  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.59250027, 'recall': 0.6586422, 'specificity': 0.6586422, 'f1': 0.61659795, 'auroc': 0.7483032, 'binary_precision': 0.18803419, 'binary_recall': 0.32352942, 'binary_specificity': 0.9937549, 'binary_f1_score': 0.23783785}
confusion matrix:
       0   1
0  15117  95
1     46  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
better model found
persisted
after epoch: 27,now: 2024-05-28 14:29:01.736028,epoch time: 0:22:55.793949,used: 9:00:08.547165,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9868043, 'precision': 0.91318697, 'recall': 0.95000476, 'specificity': 0.95000476, 'f1': 0.9307111, 'auroc': 0.9949713, 'binary_precision': 0.83095497, 'binary_recall': 0.9093093, 'binary_specificity': 0.9907002, 'binary_f1_score': 0.8683682}
confusion matrix:
       0     1
0  32811   308
1    151  1514
---- Validation: 
scalar performance:
{'acc': 0.98245966, 'precision': 0.8970592, 'recall': 0.91975343, 'specificity': 0.91975343, 'f1': 0.9080498, 'auroc': 0.9820291, 'binary_precision': 0.8018135, 'binary_recall': 0.85027474, 'binary_specificity': 0.9892322, 'binary_f1_score': 0.82533336}
confusion matrix:
       0    1
0  14056  153
1    109  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9891361, 'precision': 0.58958685, 'recall': 0.70174086, 'specificity': 0.70174086, 'f1': 0.62339026, 'auroc': 0.76698786, 'binary_precision': 0.18181819, 'binary_recall': 0.4117647, 'binary_specificity': 0.99171704, 'binary_f1_score': 0.25225225}
confusion matrix:
       0    1
0  15086  126
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 1
val acc:0.9824596643447876, best validation acc: 0.9836647510528564, corresponding to test acc:                         0.9907722473144531 / 0.9945680499076843
after epoch: 28,now: 2024-05-28 14:51:40.527488,epoch time: 0:22:38.791460,used: 9:22:47.338625,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98668927, 'precision': 0.9100018, 'recall': 0.9539372, 'specificity': 0.9539372, 'f1': 0.9307093, 'auroc': 0.99587035, 'binary_precision': 0.824164, 'binary_recall': 0.9177177, 'binary_specificity': 0.9901567, 'binary_f1_score': 0.8684285}
confusion matrix:
       0     1
0  32793   326
1    137  1528
---- Validation: 
scalar performance:
{'acc': 0.97884446, 'precision': 0.87004054, 'recall': 0.91980815, 'specificity': 0.91980815, 'f1': 0.8931377, 'auroc': 0.98106533, 'binary_precision': 0.74759614, 'binary_recall': 0.8543956, 'binary_specificity': 0.9852206, 'binary_f1_score': 0.7974359}
confusion matrix:
       0    1
0  13999  210
1    106  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.990445, 'precision': 0.59378636, 'recall': 0.673118, 'specificity': 0.673118, 'f1': 0.6213073, 'auroc': 0.77697074, 'binary_precision': 0.1904762, 'binary_recall': 0.3529412, 'binary_specificity': 0.9932948, 'binary_f1_score': 0.24742268}
confusion matrix:
       0    1
0  15110  102
1     44   24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 2
val acc:0.9788444638252258, best validation acc: 0.9836647510528564, corresponding to test acc:                         0.9907722473144531 / 0.9945680499076843
after epoch: 29,now: 2024-05-28 15:12:03.321932,epoch time: 0:20:22.794444,used: 9:43:10.133069,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9846481, 'precision': 0.89004713, 'recall': 0.9631326, 'specificity': 0.9631326, 'f1': 0.92303777, 'auroc': 0.9953718, 'binary_precision': 0.78317475, 'binary_recall': 0.93933934, 'binary_specificity': 0.98692596, 'binary_f1_score': 0.854178}
confusion matrix:
       0     1
0  32686   433
1    101  1564
---- Validation: 
scalar performance:
{'acc': 0.97810805, 'precision': 0.8639407, 'recall': 0.9226792, 'specificity': 0.9226792, 'f1': 0.8908056, 'auroc': 0.9822035, 'binary_precision': 0.73505276, 'binary_recall': 0.86126375, 'binary_specificity': 0.98409456, 'binary_f1_score': 0.79316884}
confusion matrix:
       0    1
0  13983  226
1    101  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9872382, 'precision': 0.5807847, 'recall': 0.7227479, 'specificity': 0.7227479, 'f1': 0.61740506, 'auroc': 0.8069655, 'binary_precision': 0.16402116, 'binary_recall': 0.45588234, 'binary_specificity': 0.9896135, 'binary_f1_score': 0.24124514}
confusion matrix:
       0    1
0  15054  158
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897895.png
early stop counter: 3
val acc:0.9781080484390259, best validation acc: 0.9836647510528564, corresponding to test acc:                         0.9907722473144531 / 0.9945680499076843
after epoch: 30,now: 2024-05-28 15:33:45.791948,epoch time: 0:21:42.470016,used: 10:04:52.603085,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_28_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:04:52.603085 at 2024-05-28 15:33:45.791948
persisted model performance metric: 

scalar performance:
{'acc': 0.99005234, 'precision': 0.5894568, 'recall': 0.67292076, 'specificity': 0.67292076, 'f1': 0.6174967, 'auroc': 0.7471525, 'binary_precision': 0.18181819, 'binary_recall': 0.3529412, 'binary_specificity': 0.9929004, 'binary_f1_score': 0.24}
confusion matrix:
       0    1
0  15104  108
1     44   24
oracle model performance metric: 

scalar performance:
{'acc': 0.9946335, 'precision': 0.57287025, 'recall': 0.52150005, 'specificity': 0.52150005, 'f1': 0.5327454, 'auroc': 0.84252954, 'binary_precision': 0.15, 'binary_recall': 0.04411765, 'binary_specificity': 0.9988825, 'binary_f1_score': 0.06818182}
confusion matrix:
       0   1
0  15195  17
1     65   3
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488564 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |  91508 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488564 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |  91508 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476996 KiB |   1821 MiB |   2685 TiB |   2685 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   2679 TiB |   2679 TiB |
|       from small pool |  89156 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2030 MiB |   2108 MiB |   2812 MiB |    782 MiB |
|       from large pool |   1904 MiB |   1982 MiB |   2654 MiB |    750 MiB |
|       from small pool |    126 MiB |    126 MiB |    158 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1126 MiB |   1129 MiB |   1362 TiB |   1362 TiB |
|       from large pool |   1116 MiB |   1118 MiB |   1355 TiB |   1355 TiB |
|       from small pool |     10 MiB |     28 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    7107    |    7764    |  244036 K  |  244029 K  |
|       from large pool |      87    |     178    |  105753 K  |  105753 K  |
|       from small pool |    7020    |    7642    |  138283 K  |  138276 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    7107    |    7764    |  244036 K  |  244029 K  |
|       from large pool |      87    |     178    |  105753 K  |  105753 K  |
|       from small pool |    7020    |    7642    |  138283 K  |  138276 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      96    |     117    |      26    |
|       from large pool |      28    |      33    |      38    |      10    |
|       from small pool |      63    |      63    |      79    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2764    |  102980 K  |  102980 K  |
|       from large pool |      21    |      25    |   38286 K  |   38286 K  |
|       from small pool |      32    |    2746    |   64694 K  |   64694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2685 TiB |   2685 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2679 TiB |   2679 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1604 MiB |   2108 MiB |   2812 MiB |   1208 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |    100 MiB |    126 MiB |    158 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1202 MiB |   1362 TiB |   1362 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1355 TiB |   1355 TiB |
|       from small pool |      0 KiB |     31 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  244036 K  |  244036 K  |
|       from large pool |       2    |     178    |  105753 K  |  105753 K  |
|       from small pool |       0    |    7642    |  138283 K  |  138283 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  244036 K  |  244036 K  |
|       from large pool |       2    |     178    |  105753 K  |  105753 K  |
|       from small pool |       0    |    7642    |  138283 K  |  138283 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |      96    |     117    |      42    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      50    |      63    |      79    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |  102983 K  |  102983 K  |
|       from large pool |       4    |      27    |   38286 K  |   38286 K  |
|       from small pool |       0    |    2746    |   64697 K  |   64697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2695 TiB |   2695 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2689 TiB |   2689 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2685 TiB |   2685 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2679 TiB |   2679 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1604 MiB |   2108 MiB |   2812 MiB |   1208 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |    100 MiB |    126 MiB |    158 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1202 MiB |   1362 TiB |   1362 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1355 TiB |   1355 TiB |
|       from small pool |      0 KiB |     31 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  244036 K  |  244036 K  |
|       from large pool |       2    |     178    |  105753 K  |  105753 K  |
|       from small pool |       0    |    7642    |  138283 K  |  138283 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  244036 K  |  244036 K  |
|       from large pool |       2    |     178    |  105753 K  |  105753 K  |
|       from small pool |       0    |    7642    |  138283 K  |  138283 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |      96    |     117    |      42    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      50    |      63    |      79    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |  102983 K  |  102983 K  |
|       from large pool |       4    |      27    |   38286 K  |   38286 K  |
|       from small pool |       0    |    2746    |   64697 K  |   64697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895

 Experiment start at: 2024-05-28 15:44:53.344736
before training, model accuracy: 0.6810094714164734
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.8079395, 'recall': 0.6944537, 'specificity': 0.6944537, 'f1': 0.7372592, 'auroc': 0.9480715, 'binary_precision': 0.63666666, 'binary_recall': 0.3968144, 'binary_specificity': 0.992093, 'binary_f1_score': 0.48890778}
confusion matrix:
       0    1
0  41029  327
1    871  573
---- Validation: 
scalar performance:
{'acc': 0.973506, 'precision': 0.8600143, 'recall': 0.6858026, 'specificity': 0.6858026, 'f1': 0.7429384, 'auroc': 0.9522261, 'binary_precision': 0.74233127, 'binary_recall': 0.3763608, 'binary_specificity': 0.9952443, 'binary_f1_score': 0.49948403}
confusion matrix:
       0    1
0  17579   84
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.9802731, 'recall': 0.5034722, 'specificity': 0.5034722, 'f1': 0.49683464, 'auroc': 0.91589147, 'binary_precision': 1.0, 'binary_recall': 0.0069444445, 'binary_specificity': 1.0, 'binary_f1_score': 0.013793104}
confusion matrix:
      0  1
0  6963  0
1   286  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 16:05:45.431608,epoch time: 0:20:52.086872,used: 0:20:52.086872,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9727336, 'precision': 0.78858775, 'recall': 0.80723774, 'specificity': 0.80723774, 'f1': 0.79759043, 'auroc': 0.9555253, 'binary_precision': 0.59014267, 'binary_recall': 0.62975776, 'binary_specificity': 0.98471767, 'binary_f1_score': 0.609307}
confusion matrix:
       0    1
0  40723  632
1    535  910
---- Validation: 
scalar performance:
{'acc': 0.9735606, 'precision': 0.802925, 'recall': 0.81471, 'specificity': 0.81471, 'f1': 0.8086933, 'auroc': 0.9599473, 'binary_precision': 0.6188341, 'binary_recall': 0.64385694, 'binary_specificity': 0.98556304, 'binary_f1_score': 0.6310976}
confusion matrix:
       0    1
0  17408  255
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611088, 'precision': 0.7473542, 'recall': 0.5986247, 'specificity': 0.5986247, 'f1': 0.6375014, 'auroc': 0.87834466, 'binary_precision': 0.52678573, 'binary_recall': 0.2048611, 'binary_specificity': 0.99238837, 'binary_f1_score': 0.295}
confusion matrix:
      0   1
0  6910  53
1   229  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-28 16:25:33.238652,epoch time: 0:19:47.807044,used: 0:40:39.893916,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9696262, 'precision': 0.76820505, 'recall': 0.7498615, 'specificity': 0.7498615, 'f1': 0.75867426, 'auroc': 0.95643723, 'binary_precision': 0.55331844, 'binary_recall': 0.5142065, 'binary_specificity': 0.98551637, 'binary_f1_score': 0.533046}
confusion matrix:
       0    1
0  40758  599
1    701  742
---- Validation: 
scalar performance:
{'acc': 0.96880805, 'precision': 0.77375305, 'recall': 0.7320724, 'specificity': 0.7320724, 'f1': 0.7510129, 'auroc': 0.9598646, 'binary_precision': 0.5664207, 'binary_recall': 0.47744945, 'binary_specificity': 0.98669535, 'binary_f1_score': 0.5181435}
confusion matrix:
       0    1
0  17428  235
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96290165, 'precision': 0.75690496, 'recall': 0.7543384, 'specificity': 0.7543384, 'f1': 0.7556144, 'auroc': 0.9282961, 'binary_precision': 0.53333336, 'binary_recall': 0.5277778, 'binary_specificity': 0.98089904, 'binary_f1_score': 0.530541}
confusion matrix:
      0    1
0  6830  133
1   136  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
new oracle model saved
early stop counter: 1
val acc:0.9688080549240112, best validation acc: 0.9735605716705322, corresponding to test acc:                         0.9611088037490845 / 0.9629016518592834
after epoch: 3,now: 2024-05-28 16:45:10.196187,epoch time: 0:19:36.957535,used: 1:00:16.851451,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9767991, 'precision': 0.81306577, 'recall': 0.859431, 'specificity': 0.859431, 'f1': 0.8344884, 'auroc': 0.9727559, 'binary_precision': 0.6354916, 'binary_recall': 0.733564, 'binary_specificity': 0.98529804, 'binary_f1_score': 0.6810151}
confusion matrix:
       0     1
0  40747   608
1    385  1060
---- Validation: 
scalar performance:
{'acc': 0.97956955, 'precision': 0.8439859, 'recall': 0.863531, 'specificity': 0.863531, 'f1': 0.8534621, 'auroc': 0.9699935, 'binary_precision': 0.6975037, 'binary_recall': 0.7387247, 'binary_specificity': 0.9883372, 'binary_f1_score': 0.7175226}
confusion matrix:
       0    1
0  17457  206
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96235, 'precision': 0.7639055, 'recall': 0.62090695, 'specificity': 0.62090695, 'f1': 0.66297066, 'auroc': 0.8997667, 'binary_precision': 0.55813956, 'binary_recall': 0.25, 'binary_specificity': 0.9918139, 'binary_f1_score': 0.34532374}
confusion matrix:
      0   1
0  6906  57
1   216  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
better model found
persisted
after epoch: 4,now: 2024-05-28 17:05:26.570708,epoch time: 0:20:16.374521,used: 1:20:33.225972,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9725701, 'precision': 0.7791394, 'recall': 0.8979821, 'specificity': 0.8979821, 'f1': 0.8269339, 'auroc': 0.9760308, 'binary_precision': 0.5647396, 'binary_recall': 0.8179931, 'binary_specificity': 0.9779712, 'binary_f1_score': 0.6681741}
confusion matrix:
       0     1
0  40444   911
1    263  1182
---- Validation: 
scalar performance:
{'acc': 0.9744892, 'precision': 0.7964467, 'recall': 0.902859, 'specificity': 0.902859, 'f1': 0.8406302, 'auroc': 0.97616494, 'binary_precision': 0.5993228, 'binary_recall': 0.8258165, 'binary_specificity': 0.9799015, 'binary_f1_score': 0.6945716}
confusion matrix:
       0    1
0  17308  355
1    112  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96290165, 'precision': 0.7590648, 'recall': 0.7077379, 'specificity': 0.7077379, 'f1': 0.7302278, 'auroc': 0.91805685, 'binary_precision': 0.5414847, 'binary_recall': 0.43055555, 'binary_specificity': 0.98492026, 'binary_f1_score': 0.4796905}
confusion matrix:
      0    1
0  6858  105
1   164  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.9744892120361328, best validation acc: 0.9795695543289185, corresponding to test acc:                         0.9623500108718872 / 0.9629016518592834
after epoch: 5,now: 2024-05-28 17:25:17.833700,epoch time: 0:19:51.262992,used: 1:40:24.488964,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97918224, 'precision': 0.82802415, 'recall': 0.8813679, 'specificity': 0.8813679, 'f1': 0.85249245, 'auroc': 0.97457683, 'binary_precision': 0.6639053, 'binary_recall': 0.7764706, 'binary_specificity': 0.98626524, 'binary_f1_score': 0.7157895}
confusion matrix:
       0     1
0  40787   568
1    323  1122
---- Validation: 
scalar performance:
{'acc': 0.9795149, 'precision': 0.8346864, 'recall': 0.891976, 'specificity': 0.891976, 'f1': 0.860842, 'auroc': 0.97228754, 'binary_precision': 0.676781, 'binary_recall': 0.7978227, 'binary_specificity': 0.9861292, 'binary_f1_score': 0.7323341}
confusion matrix:
       0    1
0  17418  245
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622121, 'precision': 0.8239436, 'recall': 0.5442772, 'specificity': 0.5442772, 'f1': 0.57009035, 'auroc': 0.74668944, 'binary_precision': 0.68421054, 'binary_recall': 0.090277776, 'binary_specificity': 0.9982766, 'binary_f1_score': 0.1595092}
confusion matrix:
      0   1
0  6951  12
1   262  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 2
val acc:0.9795148968696594, best validation acc: 0.9795695543289185, corresponding to test acc:                         0.9623500108718872 / 0.9629016518592834
after epoch: 6,now: 2024-05-28 17:45:20.044030,epoch time: 0:20:02.210330,used: 2:00:26.699294,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9792056, 'precision': 0.8277972, 'recall': 0.88304967, 'specificity': 0.88304967, 'f1': 0.85306376, 'auroc': 0.9791099, 'binary_precision': 0.6633314, 'binary_recall': 0.7799308, 'binary_specificity': 0.98616856, 'binary_f1_score': 0.71692115}
confusion matrix:
       0     1
0  40783   572
1    318  1127
---- Validation: 
scalar performance:
{'acc': 0.981263, 'precision': 0.8544949, 'recall': 0.8793944, 'specificity': 0.8793944, 'f1': 0.86648154, 'auroc': 0.9790796, 'binary_precision': 0.7173913, 'binary_recall': 0.7698289, 'binary_specificity': 0.98895997, 'binary_f1_score': 0.7426856}
confusion matrix:
       0    1
0  17468  195
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96386707, 'precision': 0.7672308, 'recall': 0.7115692, 'specificity': 0.7115692, 'f1': 0.735771, 'auroc': 0.8666835, 'binary_precision': 0.5575221, 'binary_recall': 0.4375, 'binary_specificity': 0.9856384, 'binary_f1_score': 0.49027237}
confusion matrix:
      0    1
0  6863  100
1   162  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-28 18:05:13.874518,epoch time: 0:19:53.830488,used: 2:20:20.529782,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9783411, 'precision': 0.8193549, 'recall': 0.888947, 'specificity': 0.888947, 'f1': 0.85038483, 'auroc': 0.9772252, 'binary_precision': 0.64599776, 'binary_recall': 0.79307956, 'binary_specificity': 0.9848144, 'binary_f1_score': 0.7120223}
confusion matrix:
       0     1
0  40727   628
1    299  1146
---- Validation: 
scalar performance:
{'acc': 0.97858626, 'precision': 0.8285531, 'recall': 0.88624966, 'specificity': 0.88624966, 'f1': 0.85483193, 'auroc': 0.9778179, 'binary_precision': 0.6649146, 'binary_recall': 0.7869362, 'binary_specificity': 0.98556304, 'binary_f1_score': 0.7207977}
confusion matrix:
       0    1
0  17408  255
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96248794, 'precision': 0.7579525, 'recall': 0.67257214, 'specificity': 0.67257214, 'f1': 0.7057835, 'auroc': 0.9091439, 'binary_precision': 0.54210526, 'binary_recall': 0.3576389, 'binary_specificity': 0.9875054, 'binary_f1_score': 0.43096232}
confusion matrix:
      0    1
0  6876   87
1   185  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.9785862565040588, best validation acc: 0.9812629818916321, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 8,now: 2024-05-28 18:25:05.524577,epoch time: 0:19:51.650059,used: 2:40:12.179841,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820327, 'precision': 0.86570656, 'recall': 0.85469544, 'specificity': 0.85469544, 'f1': 0.86010945, 'auroc': 0.9814788, 'binary_precision': 0.7412437, 'binary_recall': 0.71814406, 'binary_specificity': 0.99124676, 'binary_f1_score': 0.7295111}
confusion matrix:
       0     1
0  40994   362
1    407  1037
---- Validation: 
scalar performance:
{'acc': 0.9811537, 'precision': 0.87836456, 'recall': 0.82763636, 'specificity': 0.82763636, 'f1': 0.8510189, 'auroc': 0.9753505, 'binary_precision': 0.7689531, 'binary_recall': 0.66251945, 'binary_specificity': 0.9927532, 'binary_f1_score': 0.7117795}
confusion matrix:
       0    1
0  17535  128
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96166044, 'precision': 0.75288033, 'recall': 0.6255408, 'specificity': 0.6255408, 'f1': 0.6653573, 'auroc': 0.8907649, 'binary_precision': 0.53571427, 'binary_recall': 0.26041666, 'binary_specificity': 0.99066496, 'binary_f1_score': 0.3504673}
confusion matrix:
      0   1
0  6898  65
1   213  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 2
val acc:0.9811537265777588, best validation acc: 0.9812629818916321, corresponding to test acc:                         0.9638670682907104 / 0.9638670682907104
after epoch: 9,now: 2024-05-28 18:44:52.684435,epoch time: 0:19:47.159858,used: 2:59:59.339699,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9823131, 'precision': 0.8516085, 'recall': 0.8962776, 'specificity': 0.8962776, 'f1': 0.8724838, 'auroc': 0.98231727, 'binary_precision': 0.71009177, 'binary_recall': 0.80401665, 'binary_specificity': 0.98853856, 'binary_f1_score': 0.754141}
confusion matrix:
       0     1
0  40882   474
1    283  1161
---- Validation: 
scalar performance:
{'acc': 0.9826833, 'precision': 0.85837233, 'recall': 0.9048573, 'specificity': 0.9048573, 'f1': 0.8800615, 'auroc': 0.9780785, 'binary_precision': 0.72328764, 'binary_recall': 0.82115084, 'binary_specificity': 0.98856366, 'binary_f1_score': 0.7691187}
confusion matrix:
       0    1
0  17461  202
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96538407, 'precision': 0.83185697, 'recall': 0.6125009, 'specificity': 0.6125009, 'f1': 0.66343504, 'auroc': 0.8979808, 'binary_precision': 0.69473684, 'binary_recall': 0.22916667, 'binary_specificity': 0.9958351, 'binary_f1_score': 0.34464753}
confusion matrix:
      0   1
0  6934  29
1   222  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-05-28 19:04:35.248177,epoch time: 0:19:42.563742,used: 3:19:41.903441,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9826636, 'precision': 0.863955, 'recall': 0.87415326, 'specificity': 0.87415326, 'f1': 0.8689773, 'auroc': 0.9825382, 'binary_precision': 0.73638195, 'binary_recall': 0.75778544, 'binary_specificity': 0.9905211, 'binary_f1_score': 0.7469304}
confusion matrix:
       0     1
0  40963   392
1    350  1095
---- Validation: 
scalar performance:
{'acc': 0.98279256, 'precision': 0.868644, 'recall': 0.88243496, 'specificity': 0.88243496, 'f1': 0.875401, 'auroc': 0.9829936, 'binary_precision': 0.74550897, 'binary_recall': 0.7744945, 'binary_specificity': 0.99037534, 'binary_f1_score': 0.7597254}
confusion matrix:
       0    1
0  17493  170
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.82202685, 'recall': 0.52553904, 'specificity': 0.52553904, 'f1': 0.5385224, 'auroc': 0.68139046, 'binary_precision': 0.6818182, 'binary_recall': 0.052083332, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.0967742}
confusion matrix:
      0   1
0  6956   7
1   273  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
better model found
persisted
after epoch: 11,now: 2024-05-28 19:24:53.353756,epoch time: 0:20:18.105579,used: 3:40:00.009020,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9773832, 'precision': 0.80769753, 'recall': 0.9151657, 'specificity': 0.9151657, 'f1': 0.85259, 'auroc': 0.9846157, 'binary_precision': 0.6207595, 'binary_recall': 0.8484429, 'binary_specificity': 0.98188853, 'binary_f1_score': 0.71695906}
confusion matrix:
       0     1
0  40606   749
1    219  1226
---- Validation: 
scalar performance:
{'acc': 0.9792418, 'precision': 0.83111185, 'recall': 0.89707947, 'specificity': 0.89707947, 'f1': 0.86079824, 'auroc': 0.9768745, 'binary_precision': 0.66924065, 'binary_recall': 0.8087092, 'binary_specificity': 0.9854498, 'binary_f1_score': 0.7323944}
confusion matrix:
       0    1
0  17406  257
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611088, 'precision': 0.7691253, 'recall': 0.5387098, 'specificity': 0.5387098, 'f1': 0.56017417, 'auroc': 0.8060964, 'binary_precision': 0.575, 'binary_recall': 0.07986111, 'binary_specificity': 0.99755853, 'binary_f1_score': 0.1402439}
confusion matrix:
      0   1
0  6946  17
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.9792417883872986, best validation acc: 0.9827925562858582, corresponding to test acc:                         0.961384654045105 / 0.9653840661048889
after epoch: 12,now: 2024-05-28 19:44:23.296783,epoch time: 0:19:29.943027,used: 3:59:29.952047,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9846028, 'precision': 0.8758979, 'recall': 0.8941908, 'specificity': 0.8941908, 'f1': 0.8848078, 'auroc': 0.9873459, 'binary_precision': 0.75889325, 'binary_recall': 0.79723185, 'binary_specificity': 0.9911498, 'binary_f1_score': 0.7775902}
confusion matrix:
       0     1
0  40989   366
1    293  1152
---- Validation: 
scalar performance:
{'acc': 0.9831749, 'precision': 0.86499214, 'recall': 0.89986694, 'specificity': 0.89986694, 'f1': 0.88155866, 'auroc': 0.97869384, 'binary_precision': 0.73691654, 'binary_recall': 0.8102644, 'binary_specificity': 0.9894695, 'binary_f1_score': 0.77185184}
confusion matrix:
       0    1
0  17477  186
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9633154, 'precision': 0.7976241, 'recall': 0.5914521, 'specificity': 0.5914521, 'f1': 0.6349711, 'auroc': 0.8650969, 'binary_precision': 0.627907, 'binary_recall': 0.1875, 'binary_specificity': 0.9954043, 'binary_f1_score': 0.28877005}
confusion matrix:
      0   1
0  6931  32
1   234  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
better model found
persisted
after epoch: 13,now: 2024-05-28 20:04:29.157049,epoch time: 0:20:05.860266,used: 4:19:35.812313,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9804673, 'precision': 0.83128387, 'recall': 0.91108483, 'specificity': 0.91108483, 'f1': 0.8664666, 'auroc': 0.98432475, 'binary_precision': 0.66832507, 'binary_recall': 0.8366782, 'binary_specificity': 0.98549145, 'binary_f1_score': 0.7430855}
confusion matrix:
       0     1
0  40755   600
1    236  1209
---- Validation: 
scalar performance:
{'acc': 0.9789686, 'precision': 0.8258488, 'recall': 0.9104253, 'specificity': 0.9104253, 'f1': 0.8627646, 'auroc': 0.97976303, 'binary_precision': 0.65770173, 'binary_recall': 0.83670294, 'binary_specificity': 0.98414767, 'binary_f1_score': 0.73648185}
confusion matrix:
       0    1
0  17383  280
1    105  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.73824894, 'recall': 0.606659, 'specificity': 0.606659, 'f1': 0.6444389, 'auroc': 0.86908543, 'binary_precision': 0.50793654, 'binary_recall': 0.22222222, 'binary_specificity': 0.9910958, 'binary_f1_score': 0.30917874}
confusion matrix:
      0   1
0  6901  62
1   224  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.978968620300293, best validation acc: 0.9831749200820923, corresponding to test acc:                         0.9633154273033142 / 0.9653840661048889
after epoch: 14,now: 2024-05-28 20:24:02.492880,epoch time: 0:19:33.335831,used: 4:39:09.148144,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98268694, 'precision': 0.8476256, 'recall': 0.91886044, 'specificity': 0.91886044, 'f1': 0.87961394, 'auroc': 0.9877653, 'binary_precision': 0.7005134, 'binary_recall': 0.8504155, 'binary_specificity': 0.98730534, 'binary_f1_score': 0.76822025}
confusion matrix:
       0     1
0  40831   525
1    216  1228
---- Validation: 
scalar performance:
{'acc': 0.98088056, 'precision': 0.8407658, 'recall': 0.91066676, 'specificity': 0.91066676, 'f1': 0.8721335, 'auroc': 0.98139834, 'binary_precision': 0.68758005, 'binary_recall': 0.83514774, 'binary_specificity': 0.9861858, 'binary_f1_score': 0.7542135}
confusion matrix:
       0    1
0  17419  244
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631775, 'precision': 0.8395783, 'recall': 0.55975854, 'specificity': 0.55975854, 'f1': 0.5944329, 'auroc': 0.86276186, 'binary_precision': 0.71428573, 'binary_recall': 0.121527776, 'binary_specificity': 0.99798936, 'binary_f1_score': 0.20771514}
confusion matrix:
      0   1
0  6949  14
1   253  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 2
val acc:0.9808805584907532, best validation acc: 0.9831749200820923, corresponding to test acc:                         0.9633154273033142 / 0.9653840661048889
after epoch: 15,now: 2024-05-28 20:43:45.073267,epoch time: 0:19:42.580387,used: 4:58:51.728531,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9865888, 'precision': 0.9305543, 'recall': 0.8518076, 'specificity': 0.8518076, 'f1': 0.8869157, 'auroc': 0.9886054, 'binary_precision': 0.87127024, 'binary_recall': 0.70726645, 'binary_specificity': 0.9963487, 'binary_f1_score': 0.78074867}
confusion matrix:
       0     1
0  41204   151
1    423  1022
---- Validation: 
scalar performance:
{'acc': 0.98530537, 'precision': 0.90291893, 'recall': 0.8732469, 'specificity': 0.8732469, 'f1': 0.8874671, 'auroc': 0.9823884, 'binary_precision': 0.8148148, 'binary_recall': 0.7527216, 'binary_specificity': 0.99377227, 'binary_f1_score': 0.7825384}
confusion matrix:
       0    1
0  17553  110
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9635912, 'precision': 0.8267749, 'recall': 0.5749527, 'specificity': 0.5749527, 'f1': 0.6156714, 'auroc': 0.9081732, 'binary_precision': 0.6875, 'binary_recall': 0.15277778, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  6943  20
1   244  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
better model found
persisted
after epoch: 16,now: 2024-05-28 21:03:37.522452,epoch time: 0:19:52.449185,used: 5:18:44.177716,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9863785, 'precision': 0.8906504, 'recall': 0.9044597, 'specificity': 0.9044597, 'f1': 0.8974248, 'auroc': 0.9868968, 'binary_precision': 0.787717, 'binary_recall': 0.816609, 'binary_specificity': 0.99231046, 'binary_f1_score': 0.80190283}
confusion matrix:
       0     1
0  41037   318
1    265  1180
---- Validation: 
scalar performance:
{'acc': 0.98486835, 'precision': 0.881895, 'recall': 0.9007445, 'specificity': 0.9007445, 'f1': 0.8910719, 'auroc': 0.983119, 'binary_precision': 0.77071005, 'binary_recall': 0.8102644, 'binary_specificity': 0.9912246, 'binary_f1_score': 0.78999245}
confusion matrix:
       0    1
0  17508  155
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96179837, 'precision': 0.8413175, 'recall': 0.53074735, 'specificity': 0.53074735, 'f1': 0.5477469, 'auroc': 0.89842844, 'binary_precision': 0.72, 'binary_recall': 0.0625, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.115015976}
confusion matrix:
      0   1
0  6956   7
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.9848683476448059, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 17,now: 2024-05-28 21:23:23.455351,epoch time: 0:19:45.932899,used: 5:38:30.110615,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9864252, 'precision': 0.95025086, 'recall': 0.82968354, 'specificity': 0.82968354, 'f1': 0.8799783, 'auroc': 0.9901179, 'binary_precision': 0.91221374, 'binary_recall': 0.6615917, 'binary_specificity': 0.9977754, 'binary_f1_score': 0.7669475}
confusion matrix:
       0    1
0  41263   92
1    489  956
---- Validation: 
scalar performance:
{'acc': 0.9844313, 'precision': 0.9465805, 'recall': 0.8091037, 'specificity': 0.8091037, 'f1': 0.8644103, 'auroc': 0.97959095, 'binary_precision': 0.9068182, 'binary_recall': 0.62052876, 'binary_specificity': 0.99767876, 'binary_f1_score': 0.7368421}
confusion matrix:
       0    1
0  17622   41
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.83386457, 'recall': 0.5204743, 'specificity': 0.5204743, 'f1': 0.52944785, 'auroc': 0.83005214, 'binary_precision': 0.7058824, 'binary_recall': 0.041666668, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.078688525}
confusion matrix:
      0   1
0  6958   5
1   276  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 2
val acc:0.9844313263893127, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 18,now: 2024-05-28 21:43:15.370581,epoch time: 0:19:51.915230,used: 5:58:22.025845,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98693925, 'precision': 0.91508734, 'recall': 0.8769504, 'specificity': 0.8769504, 'f1': 0.895027, 'auroc': 0.98954153, 'binary_precision': 0.8385616, 'binary_recall': 0.75900275, 'binary_specificity': 0.99489796, 'binary_f1_score': 0.79680115}
confusion matrix:
       0     1
0  41145   211
1    348  1096
---- Validation: 
scalar performance:
{'acc': 0.9835027, 'precision': 0.8901789, 'recall': 0.85732687, 'specificity': 0.85732687, 'f1': 0.8729681, 'auroc': 0.9821918, 'binary_precision': 0.79046, 'binary_recall': 0.7216174, 'binary_specificity': 0.99303627, 'binary_f1_score': 0.75447154}
confusion matrix:
       0    1
0  17540  123
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.81412387, 'recall': 0.5170021, 'specificity': 0.5170021, 'f1': 0.52303785, 'auroc': 0.8246572, 'binary_precision': 0.6666667, 'binary_recall': 0.034722224, 'binary_specificity': 0.99928194, 'binary_f1_score': 0.0660066}
confusion matrix:
      0   1
0  6958   5
1   278  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 3
val acc:0.9835026860237122, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 19,now: 2024-05-28 22:02:46.912295,epoch time: 0:19:31.541714,used: 6:17:53.567559,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98621494, 'precision': 0.91133344, 'recall': 0.86831063, 'specificity': 0.86831063, 'f1': 0.88853955, 'auroc': 0.9866836, 'binary_precision': 0.83165246, 'binary_recall': 0.7418685, 'binary_specificity': 0.99475276, 'binary_f1_score': 0.784199}
confusion matrix:
       0     1
0  41138   217
1    373  1072
---- Validation: 
scalar performance:
{'acc': 0.9847045, 'precision': 0.9153906, 'recall': 0.8452116, 'specificity': 0.8452116, 'f1': 0.876799, 'auroc': 0.9758068, 'binary_precision': 0.8418079, 'binary_recall': 0.69517887, 'binary_specificity': 0.9952443, 'binary_f1_score': 0.7614991}
confusion matrix:
       0    1
0  17579   84
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9630396, 'precision': 0.8708709, 'recall': 0.54803663, 'specificity': 0.54803663, 'f1': 0.5769685, 'auroc': 0.8703017, 'binary_precision': 0.7777778, 'binary_recall': 0.097222224, 'binary_specificity': 0.99885106, 'binary_f1_score': 0.17283951}
confusion matrix:
      0   1
0  6955   8
1   260  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 4
val acc:0.9847044944763184, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 20,now: 2024-05-28 22:22:27.680383,epoch time: 0:19:40.768088,used: 6:37:34.335647,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9872897, 'precision': 0.9027979, 'recall': 0.9022598, 'specificity': 0.9022598, 'f1': 0.90252864, 'auroc': 0.99154985, 'binary_precision': 0.8121968, 'binary_recall': 0.81107265, 'binary_specificity': 0.993447, 'binary_f1_score': 0.8116343}
confusion matrix:
       0     1
0  41084   271
1    273  1172
---- Validation: 
scalar performance:
{'acc': 0.9845406, 'precision': 0.8806994, 'recall': 0.8960788, 'specificity': 0.8960788, 'f1': 0.88822293, 'auroc': 0.98188925, 'binary_precision': 0.76865673, 'binary_recall': 0.8009331, 'binary_specificity': 0.9912246, 'binary_f1_score': 0.78446305}
confusion matrix:
       0    1
0  17508  155
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.78782284, 'recall': 0.5321244, 'specificity': 0.5321244, 'f1': 0.54965484, 'auroc': 0.84461236, 'binary_precision': 0.61290324, 'binary_recall': 0.065972224, 'binary_specificity': 0.9982766, 'binary_f1_score': 0.11912226}
confusion matrix:
      0   1
0  6951  12
1   269  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 5
val acc:0.984540581703186, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 21,now: 2024-05-28 22:42:07.205916,epoch time: 0:19:39.525533,used: 6:57:13.861180,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98628503, 'precision': 0.88801765, 'recall': 0.9074167, 'specificity': 0.9074167, 'f1': 0.89746004, 'auroc': 0.99041533, 'binary_precision': 0.7822368, 'binary_recall': 0.82283735, 'binary_specificity': 0.9919961, 'binary_f1_score': 0.8020236}
confusion matrix:
       0     1
0  41024   331
1    256  1189
---- Validation: 
scalar performance:
{'acc': 0.983011, 'precision': 0.8701978, 'recall': 0.8840468, 'specificity': 0.8840468, 'f1': 0.8769833, 'auroc': 0.98148936, 'binary_precision': 0.74850297, 'binary_recall': 0.777605, 'binary_specificity': 0.9904886, 'binary_f1_score': 0.7627765}
confusion matrix:
       0    1
0  17495  168
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615225, 'precision': 0.79585445, 'recall': 0.53726095, 'specificity': 0.53726095, 'f1': 0.55827296, 'auroc': 0.7549797, 'binary_precision': 0.62857145, 'binary_recall': 0.07638889, 'binary_specificity': 0.998133, 'binary_f1_score': 0.13622291}
confusion matrix:
      0   1
0  6950  13
1   266  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 6
val acc:0.98301100730896, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 22,now: 2024-05-28 23:01:39.068231,epoch time: 0:19:31.862315,used: 7:16:45.723495,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98310745, 'precision': 0.8425796, 'recall': 0.94951737, 'specificity': 0.94951737, 'f1': 0.8881109, 'auroc': 0.9924614, 'binary_precision': 0.68821687, 'binary_recall': 0.9134948, 'binary_specificity': 0.98553985, 'binary_f1_score': 0.7850134}
confusion matrix:
       0     1
0  40757   598
1    125  1320
---- Validation: 
scalar performance:
{'acc': 0.9804436, 'precision': 0.8297795, 'recall': 0.9419108, 'specificity': 0.9419108, 'f1': 0.8768258, 'auroc': 0.9841789, 'binary_precision': 0.66323024, 'binary_recall': 0.90046656, 'binary_specificity': 0.98335505, 'binary_f1_score': 0.76385224}
confusion matrix:
       0    1
0  17369  294
1     64  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9630396, 'precision': 0.7745948, 'recall': 0.6229303, 'specificity': 0.6229303, 'f1': 0.66681683, 'auroc': 0.82845414, 'binary_precision': 0.5793651, 'binary_recall': 0.2534722, 'binary_specificity': 0.99238837, 'binary_f1_score': 0.352657}
confusion matrix:
      0   1
0  6910  53
1   215  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 7
val acc:0.9804435968399048, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 23,now: 2024-05-28 23:21:03.395891,epoch time: 0:19:24.327660,used: 7:36:10.051155,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98801404, 'precision': 0.9024979, 'recall': 0.91727275, 'specificity': 0.91727275, 'f1': 0.9097408, 'auroc': 0.99142385, 'binary_precision': 0.8105404, 'binary_recall': 0.8414127, 'binary_specificity': 0.99313277, 'binary_f1_score': 0.82568806}
confusion matrix:
       0     1
0  41072   284
1    229  1215
---- Validation: 
scalar performance:
{'acc': 0.98481375, 'precision': 0.87843764, 'recall': 0.9067105, 'specificity': 0.9067105, 'f1': 0.8920177, 'auroc': 0.98036575, 'binary_precision': 0.76334774, 'binary_recall': 0.82270604, 'binary_specificity': 0.990715, 'binary_f1_score': 0.79191613}
confusion matrix:
       0    1
0  17499  164
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.754024, 'recall': 0.5301729, 'specificity': 0.5301729, 'f1': 0.5460261, 'auroc': 0.78975856, 'binary_precision': 0.54545456, 'binary_recall': 0.0625, 'binary_specificity': 0.99784577, 'binary_f1_score': 0.11214954}
confusion matrix:
      0   1
0  6948  15
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 8
val acc:0.9848137497901917, best validation acc: 0.9853053689002991, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 24,now: 2024-05-28 23:40:41.006964,epoch time: 0:19:37.611073,used: 7:55:47.662228,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9883411, 'precision': 0.91134673, 'recall': 0.9094219, 'specificity': 0.9094219, 'f1': 0.9103819, 'auroc': 0.9921485, 'binary_precision': 0.82881004, 'binary_recall': 0.82479227, 'binary_specificity': 0.99405164, 'binary_f1_score': 0.8267963}
confusion matrix:
       0     1
0  41110   246
1    253  1191
---- Validation: 
scalar performance:
{'acc': 0.98634326, 'precision': 0.90293705, 'recall': 0.89326656, 'specificity': 0.89326656, 'f1': 0.8980379, 'auroc': 0.97944385, 'binary_precision': 0.8133971, 'binary_recall': 0.7931571, 'binary_specificity': 0.99337596, 'binary_f1_score': 0.8031496}
confusion matrix:
       0    1
0  17546  117
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9635912, 'precision': 0.7833738, 'recall': 0.6248818, 'specificity': 0.6248818, 'f1': 0.67024326, 'auroc': 0.9199873, 'binary_precision': 0.5967742, 'binary_recall': 0.25694445, 'binary_specificity': 0.9928192, 'binary_f1_score': 0.3592233}
confusion matrix:
      0   1
0  6913  50
1   214  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
better model found
persisted
after epoch: 25,now: 2024-05-29 00:00:39.910082,epoch time: 0:19:58.903118,used: 8:15:46.565346,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9839953, 'precision': 0.8537543, 'recall': 0.9359517, 'specificity': 0.9359517, 'f1': 0.89016414, 'auroc': 0.9910116, 'binary_precision': 0.7115813, 'binary_recall': 0.88442904, 'binary_specificity': 0.9874743, 'binary_f1_score': 0.78864545}
confusion matrix:
       0     1
0  40837   518
1    167  1278
---- Validation: 
scalar performance:
{'acc': 0.98186386, 'precision': 0.8447958, 'recall': 0.92466366, 'specificity': 0.92466366, 'f1': 0.8801622, 'auroc': 0.9759071, 'binary_precision': 0.6946183, 'binary_recall': 0.86314154, 'binary_specificity': 0.9861858, 'binary_f1_score': 0.76976424}
confusion matrix:
       0    1
0  17419  244
1     88  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619363, 'precision': 0.76897085, 'recall': 0.58074826, 'specificity': 0.58074826, 'f1': 0.6192658, 'auroc': 0.8991557, 'binary_precision': 0.5714286, 'binary_recall': 0.16666667, 'binary_specificity': 0.99482983, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  6927  36
1   240  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 1
val acc:0.9818638563156128, best validation acc: 0.986343264579773, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 26,now: 2024-05-29 00:20:14.896771,epoch time: 0:19:34.986689,used: 8:35:21.552035,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98890185, 'precision': 0.9087183, 'recall': 0.92479956, 'specificity': 0.92479956, 'f1': 0.9165907, 'auroc': 0.9940094, 'binary_precision': 0.8224734, 'binary_recall': 0.8560554, 'binary_specificity': 0.9935437, 'binary_f1_score': 0.83892846}
confusion matrix:
       0     1
0  41088   267
1    208  1237
---- Validation: 
scalar performance:
{'acc': 0.9857424, 'precision': 0.8972602, 'recall': 0.89070725, 'specificity': 0.89070725, 'f1': 0.89395404, 'auroc': 0.98479676, 'binary_precision': 0.8022152, 'binary_recall': 0.7884914, 'binary_specificity': 0.9929231, 'binary_f1_score': 0.7952941}
confusion matrix:
       0    1
0  17538  125
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96235, 'precision': 0.76915926, 'recall': 0.6025996, 'specificity': 0.6025996, 'f1': 0.64475435, 'auroc': 0.88666, 'binary_precision': 0.57009345, 'binary_recall': 0.21180555, 'binary_specificity': 0.99339366, 'binary_f1_score': 0.30886078}
confusion matrix:
      0   1
0  6917  46
1   227  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 2
val acc:0.9857423901557922, best validation acc: 0.986343264579773, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 27,now: 2024-05-29 00:39:35.488295,epoch time: 0:19:20.591524,used: 8:54:42.143559,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9867056, 'precision': 0.87635404, 'recall': 0.94162166, 'specificity': 0.94162166, 'f1': 0.90614605, 'auroc': 0.99361193, 'binary_precision': 0.7564554, 'binary_recall': 0.8932779, 'binary_specificity': 0.98996544, 'binary_f1_score': 0.81919295}
confusion matrix:
       0     1
0  40942   415
1    154  1289
---- Validation: 
scalar performance:
{'acc': 0.98339343, 'precision': 0.8603315, 'recall': 0.91721404, 'specificity': 0.91721404, 'f1': 0.8864889, 'auroc': 0.9817783, 'binary_precision': 0.7263017, 'binary_recall': 0.8460342, 'binary_specificity': 0.98839384, 'binary_f1_score': 0.78160924}
confusion matrix:
       0    1
0  17458  205
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455663, 'precision': 0.76969683, 'recall': 0.74354994, 'specificity': 0.74354994, 'f1': 0.75587404, 'auroc': 0.8993695, 'binary_precision': 0.55984557, 'binary_recall': 0.5034722, 'binary_specificity': 0.98362774, 'binary_f1_score': 0.5301645}
confusion matrix:
      0    1
0  6849  114
1   143  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 3
val acc:0.9833934307098389, best validation acc: 0.986343264579773, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 28,now: 2024-05-29 00:59:16.487268,epoch time: 0:19:40.998973,used: 9:14:23.142532,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98890185, 'precision': 0.91353, 'recall': 0.91711915, 'specificity': 0.91711915, 'f1': 0.91531616, 'auroc': 0.9943113, 'binary_precision': 0.83264744, 'binary_recall': 0.84013844, 'binary_specificity': 0.99409986, 'binary_f1_score': 0.8363762}
confusion matrix:
       0     1
0  41111   244
1    231  1214
---- Validation: 
scalar performance:
{'acc': 0.9839397, 'precision': 0.8773483, 'recall': 0.88977313, 'specificity': 0.88977313, 'f1': 0.88345087, 'auroc': 0.97992337, 'binary_precision': 0.762406, 'binary_recall': 0.7884914, 'binary_specificity': 0.9910548, 'binary_f1_score': 0.77522933}
confusion matrix:
       0    1
0  17505  158
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9627638, 'precision': 0.88171995, 'recall': 0.5412358, 'specificity': 0.5412358, 'f1': 0.5659539, 'auroc': 0.75917375, 'binary_precision': 0.8, 'binary_recall': 0.083333336, 'binary_specificity': 0.9991383, 'binary_f1_score': 0.1509434}
confusion matrix:
      0   1
0  6957   6
1   264  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 4
val acc:0.9839397072792053, best validation acc: 0.986343264579773, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 29,now: 2024-05-29 01:18:52.367208,epoch time: 0:19:35.879940,used: 9:33:59.022472,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9867757, 'precision': 0.8849297, 'recall': 0.9243672, 'specificity': 0.9243672, 'f1': 0.90360224, 'auroc': 0.9935827, 'binary_precision': 0.7748593, 'binary_recall': 0.85743946, 'binary_specificity': 0.99129486, 'binary_f1_score': 0.8140605}
confusion matrix:
       0     1
0  40995   360
1    206  1239
---- Validation: 
scalar performance:
{'acc': 0.9843221, 'precision': 0.8776946, 'recall': 0.8974642, 'specificity': 0.8974642, 'f1': 0.88730395, 'auroc': 0.97879153, 'binary_precision': 0.7625369, 'binary_recall': 0.80404353, 'binary_specificity': 0.9908849, 'binary_f1_score': 0.78274035}
confusion matrix:
       0    1
0  17502  161
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9627638, 'precision': 0.76563585, 'recall': 0.64109397, 'specificity': 0.64109397, 'f1': 0.68218184, 'auroc': 0.88464487, 'binary_precision': 0.56, 'binary_recall': 0.29166666, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.3835616}
confusion matrix:
      0   1
0  6897  66
1   204  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897895.png
early stop counter: 5
val acc:0.9843220710754395, best validation acc: 0.986343264579773, corresponding to test acc:                         0.9635912179946899 / 0.9653840661048889
after epoch: 30,now: 2024-05-29 01:38:45.504256,epoch time: 0:19:53.137048,used: 9:53:52.159520,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_44_53_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:53:52.159520 at 2024-05-29 01:38:45.504256
persisted model performance metric: 

scalar performance:
{'acc': 0.96414286, 'precision': 0.79620105, 'recall': 0.62017614, 'specificity': 0.62017614, 'f1': 0.667397, 'auroc': 0.9166185, 'binary_precision': 0.622807, 'binary_recall': 0.24652778, 'binary_specificity': 0.9938245, 'binary_f1_score': 0.3532338}
confusion matrix:
      0   1
0  6920  43
1   217  71
oracle model performance metric: 

scalar performance:
{'acc': 0.9627638, 'precision': 0.7798412, 'recall': 0.5978221, 'specificity': 0.5978221, 'f1': 0.64069545, 'auroc': 0.90182674, 'binary_precision': 0.59183675, 'binary_recall': 0.2013889, 'binary_specificity': 0.99425536, 'binary_f1_score': 0.30051816}
confusion matrix:
      0   1
0  6923  40
1   230  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486293 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |  90005 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486293 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |  90005 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476619 KiB |   1821 MiB |   4073 TiB |   4073 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   4063 TiB |   4063 TiB |
|       from small pool |  88779 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2046 MiB |   2108 MiB |   3254 MiB |   1208 MiB |
|       from large pool |   1920 MiB |   1982 MiB |   3070 MiB |   1150 MiB |
|       from small pool |    126 MiB |    126 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1013 MiB |   1202 MiB |   2108 TiB |   2108 TiB |
|       from large pool |   1005 MiB |   1178 MiB |   2098 TiB |   2098 TiB |
|       from small pool |      8 MiB |     31 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4101    |    7764    |  371550 K  |  371546 K  |
|       from large pool |      87    |     178    |  160677 K  |  160677 K  |
|       from small pool |    4014    |    7642    |  210872 K  |  210868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4101    |    7764    |  371550 K  |  371546 K  |
|       from large pool |      87    |     178    |  160677 K  |  160677 K  |
|       from small pool |    4014    |    7642    |  210872 K  |  210868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      96    |     133    |      42    |
|       from large pool |      28    |      33    |      41    |      13    |
|       from small pool |      63    |      63    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    2764    |  156805 K  |  156805 K  |
|       from large pool |      18    |      27    |   58489 K  |   58489 K  |
|       from small pool |      33    |    2746    |   98316 K  |   98315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   4073 TiB |   4073 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   4063 TiB |   4063 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1488 MiB |   2108 MiB |   3254 MiB |   1766 MiB |
|       from large pool |   1392 MiB |   1982 MiB |   3070 MiB |   1678 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1202 MiB |   2108 TiB |   2108 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   2098 TiB |   2098 TiB |
|       from small pool |      0 KiB |     31 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  371550 K  |  371550 K  |
|       from large pool |       2    |     178    |  160677 K  |  160677 K  |
|       from small pool |       0    |    7642    |  210872 K  |  210872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  371550 K  |  371550 K  |
|       from large pool |       2    |     178    |  160677 K  |  160677 K  |
|       from small pool |       0    |    7642    |  210872 K  |  210872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     133    |      61    |
|       from large pool |      24    |      33    |      41    |      17    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |  156807 K  |  156807 K  |
|       from large pool |       4    |      27    |   58489 K  |   58489 K  |
|       from small pool |       0    |    2746    |   98317 K  |   98317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   4086 TiB |   4086 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4077 TiB |   4077 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   4073 TiB |   4073 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   4063 TiB |   4063 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1488 MiB |   2108 MiB |   3254 MiB |   1766 MiB |
|       from large pool |   1392 MiB |   1982 MiB |   3070 MiB |   1678 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1202 MiB |   2108 TiB |   2108 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   2098 TiB |   2098 TiB |
|       from small pool |      0 KiB |     31 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  371550 K  |  371550 K  |
|       from large pool |       2    |     178    |  160677 K  |  160677 K  |
|       from small pool |       0    |    7642    |  210872 K  |  210872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  371550 K  |  371550 K  |
|       from large pool |       2    |     178    |  160677 K  |  160677 K  |
|       from small pool |       0    |    7642    |  210872 K  |  210872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     133    |      61    |
|       from large pool |      24    |      33    |      41    |      17    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |  156807 K  |  156807 K  |
|       from large pool |       4    |      27    |   58489 K  |   58489 K  |
|       from small pool |       0    |    2746    |   98317 K  |   98317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895

 Experiment start at: 2024-05-29 01:47:31.445115
before training, model accuracy: 0.2902069687843323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9721051, 'precision': 0.7919692, 'recall': 0.8316277, 'specificity': 0.8316277, 'f1': 0.8103961, 'auroc': 0.95114744, 'binary_precision': 0.5958386, 'binary_recall': 0.6803456, 'binary_specificity': 0.98290986, 'binary_f1_score': 0.63529414}
confusion matrix:
       0    1
0  36866  641
1    444  945
---- Validation: 
scalar performance:
{'acc': 0.972007, 'precision': 0.79387903, 'recall': 0.81474614, 'specificity': 0.81474614, 'f1': 0.8039155, 'auroc': 0.9509444, 'binary_precision': 0.600939, 'binary_recall': 0.6453782, 'binary_specificity': 0.9841141, 'binary_f1_score': 0.6223663}
confusion matrix:
       0    1
0  15797  255
1    211  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96523607, 'precision': 0.7036765, 'recall': 0.6795033, 'specificity': 0.6795033, 'f1': 0.69074047, 'auroc': 0.9253449, 'binary_precision': 0.4271523, 'binary_recall': 0.375, 'binary_specificity': 0.98400664, 'binary_f1_score': 0.39938083}
confusion matrix:
       0    1
0  10644  173
1    215  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 02:08:58.930054,epoch time: 0:21:27.484939,used: 0:21:27.484939,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97429043, 'precision': 0.80360395, 'recall': 0.8608387, 'specificity': 0.8608387, 'f1': 0.82948315, 'auroc': 0.9589439, 'binary_precision': 0.6169573, 'binary_recall': 0.73866093, 'binary_specificity': 0.9830165, 'binary_f1_score': 0.67234606}
confusion matrix:
       0     1
0  36870   637
1    363  1026
---- Validation: 
scalar performance:
{'acc': 0.977113, 'precision': 0.82444596, 'recall': 0.86675423, 'specificity': 0.86675423, 'f1': 0.84416914, 'auroc': 0.9633187, 'binary_precision': 0.658284, 'binary_recall': 0.7478992, 'binary_specificity': 0.9856093, 'binary_f1_score': 0.700236}
confusion matrix:
       0    1
0  15821  231
1    150  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9649673, 'precision': 0.72006416, 'recall': 0.80742574, 'specificity': 0.80742574, 'f1': 0.7556445, 'auroc': 0.9507877, 'binary_precision': 0.4517454, 'binary_recall': 0.6395349, 'binary_specificity': 0.97531664, 'binary_f1_score': 0.5294826}
confusion matrix:
       0    1
0  10550  267
1    124  220
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 2,now: 2024-05-29 02:28:43.671753,epoch time: 0:19:44.741699,used: 0:41:12.226638,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9782754, 'precision': 0.8393927, 'recall': 0.8499757, 'specificity': 0.8499757, 'f1': 0.84459484, 'auroc': 0.9675296, 'binary_precision': 0.68946266, 'binary_recall': 0.71181554, 'binary_specificity': 0.9881359, 'binary_f1_score': 0.7004608}
confusion matrix:
       0    1
0  37063  445
1    400  988
---- Validation: 
scalar performance:
{'acc': 0.98125786, 'precision': 0.8760087, 'recall': 0.8405819, 'specificity': 0.8405819, 'f1': 0.85734034, 'auroc': 0.97018677, 'binary_precision': 0.7635009, 'binary_recall': 0.68907565, 'binary_specificity': 0.9920882, 'binary_f1_score': 0.72438157}
confusion matrix:
       0    1
0  15925  127
1    185  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96353376, 'precision': 0.7114759, 'recall': 0.79542804, 'specificity': 0.79542804, 'f1': 0.7456453, 'auroc': 0.95161086, 'binary_precision': 0.43531826, 'binary_recall': 0.61627907, 'binary_specificity': 0.97457707, 'binary_f1_score': 0.51022863}
confusion matrix:
       0    1
0  10542  275
1    132  212
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 3,now: 2024-05-29 02:48:30.211278,epoch time: 0:19:46.539525,used: 1:00:58.766163,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97986937, 'precision': 0.84799236, 'recall': 0.8689311, 'specificity': 0.8689311, 'f1': 0.8581257, 'auroc': 0.9706333, 'binary_precision': 0.70528454, 'binary_recall': 0.74946004, 'binary_specificity': 0.9884022, 'binary_f1_score': 0.72670156}
confusion matrix:
       0     1
0  37072   435
1    348  1041
---- Validation: 
scalar performance:
{'acc': 0.98053706, 'precision': 0.85195446, 'recall': 0.8758124, 'specificity': 0.8758124, 'f1': 0.86345375, 'auroc': 0.97195804, 'binary_precision': 0.71271586, 'binary_recall': 0.7630252, 'binary_specificity': 0.98859954, 'binary_f1_score': 0.737013}
confusion matrix:
       0    1
0  15869  183
1    141  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96353376, 'precision': 0.71563464, 'recall': 0.8306097, 'specificity': 0.8306097, 'f1': 0.7595213, 'auroc': 0.9523591, 'binary_precision': 0.44134077, 'binary_recall': 0.68895346, 'binary_specificity': 0.9722659, 'binary_f1_score': 0.53802496}
confusion matrix:
       0    1
0  10517  300
1    107  237
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 1
val acc:0.9805370569229126, best validation acc: 0.9812578558921814, corresponding to test acc:                         0.9635337591171265 / 0.9652360677719116
after epoch: 4,now: 2024-05-29 03:08:06.292067,epoch time: 0:19:36.080789,used: 1:20:34.846952,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9804093, 'precision': 0.8829156, 'recall': 0.81118864, 'specificity': 0.81118864, 'f1': 0.8430253, 'auroc': 0.97345924, 'binary_precision': 0.7794643, 'binary_recall': 0.6289625, 'binary_specificity': 0.99341476, 'binary_f1_score': 0.6961723}
confusion matrix:
       0    1
0  37261  247
1    515  873
---- Validation: 
scalar performance:
{'acc': 0.98131794, 'precision': 0.9188607, 'recall': 0.7863975, 'specificity': 0.7863975, 'f1': 0.8392174, 'auroc': 0.9728895, 'binary_precision': 0.8532338, 'binary_recall': 0.5764706, 'binary_specificity': 0.9963244, 'binary_f1_score': 0.6880642}
confusion matrix:
       0    1
0  15993   59
1    252  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96962637, 'precision': 0.74514794, 'recall': 0.6522157, 'specificity': 0.6522157, 'f1': 0.6868076, 'auroc': 0.94661844, 'binary_precision': 0.51184833, 'binary_recall': 0.3139535, 'binary_specificity': 0.990478, 'binary_f1_score': 0.38918915}
confusion matrix:
       0    1
0  10714  103
1    236  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-29 03:27:56.213112,epoch time: 0:19:49.921045,used: 1:40:24.767997,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9836487, 'precision': 0.9157672, 'recall': 0.8303338, 'specificity': 0.8303338, 'f1': 0.86775804, 'auroc': 0.9735571, 'binary_precision': 0.8438356, 'binary_recall': 0.66522676, 'binary_specificity': 0.99544084, 'binary_f1_score': 0.74396133}
confusion matrix:
       0    1
0  37336  171
1    465  924
---- Validation: 
scalar performance:
{'acc': 0.98384094, 'precision': 0.9231855, 'recall': 0.8257376, 'specificity': 0.8257376, 'f1': 0.8676115, 'auroc': 0.97421944, 'binary_precision': 0.85903084, 'binary_recall': 0.6554622, 'binary_specificity': 0.996013, 'binary_f1_score': 0.7435653}
confusion matrix:
       0    1
0  15988   64
1    205  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96971595, 'precision': 0.7466496, 'recall': 0.753585, 'specificity': 0.753585, 'f1': 0.75006425, 'auroc': 0.95229733, 'binary_precision': 0.5084746, 'binary_recall': 0.5232558, 'binary_specificity': 0.9839142, 'binary_f1_score': 0.51575935}
confusion matrix:
       0    1
0  10643  174
1    164  180
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-05-29 03:47:32.010085,epoch time: 0:19:35.796973,used: 2:00:00.564970,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98017794, 'precision': 0.88143253, 'recall': 0.80864036, 'specificity': 0.80864036, 'f1': 0.84086454, 'auroc': 0.972984, 'binary_precision': 0.7766816, 'binary_recall': 0.6239193, 'binary_specificity': 0.9933614, 'binary_f1_score': 0.69196963}
confusion matrix:
       0    1
0  37259  249
1    522  866
---- Validation: 
scalar performance:
{'acc': 0.97693276, 'precision': 0.86183023, 'recall': 0.7695583, 'specificity': 0.7695583, 'f1': 0.8083617, 'auroc': 0.9686221, 'binary_precision': 0.7403189, 'binary_recall': 0.5462185, 'binary_specificity': 0.9928981, 'binary_f1_score': 0.6286267}
confusion matrix:
       0    1
0  15938  114
1    270  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9641609, 'precision': 0.7244785, 'recall': 0.89426017, 'specificity': 0.89426017, 'f1': 0.78316694, 'auroc': 0.9513049, 'binary_precision': 0.45483872, 'binary_recall': 0.8197674, 'binary_specificity': 0.96875286, 'binary_f1_score': 0.58506227}
confusion matrix:
       0    1
0  10479  338
1     62  282
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 1
val acc:0.9769327640533447, best validation acc: 0.9838409423828125, corresponding to test acc:                         0.96971595287323 / 0.96971595287323
after epoch: 7,now: 2024-05-29 04:07:16.410896,epoch time: 0:19:44.400811,used: 2:19:44.965781,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98159194, 'precision': 0.8817185, 'recall': 0.83758676, 'specificity': 0.83758676, 'f1': 0.8581784, 'auroc': 0.9752792, 'binary_precision': 0.7751431, 'binary_recall': 0.6825054, 'binary_specificity': 0.99266803, 'binary_f1_score': 0.72588056}
confusion matrix:
       0    1
0  37232  275
1    441  948
---- Validation: 
scalar performance:
{'acc': 0.98293984, 'precision': 0.9061323, 'recall': 0.82931626, 'specificity': 0.82931626, 'f1': 0.8633768, 'auroc': 0.9762275, 'binary_precision': 0.8246347, 'binary_recall': 0.66386557, 'binary_specificity': 0.994767, 'binary_f1_score': 0.735568}
confusion matrix:
       0    1
0  15968   84
1    200  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655049, 'precision': 0.71832234, 'recall': 0.7640779, 'specificity': 0.7640779, 'f1': 0.73877746, 'auroc': 0.9553355, 'binary_precision': 0.45107397, 'binary_recall': 0.5494186, 'binary_specificity': 0.9787372, 'binary_f1_score': 0.49541286}
confusion matrix:
       0    1
0  10587  230
1    155  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 2
val acc:0.9829398393630981, best validation acc: 0.9838409423828125, corresponding to test acc:                         0.96971595287323 / 0.96971595287323
after epoch: 8,now: 2024-05-29 04:26:49.635685,epoch time: 0:19:33.224789,used: 2:39:18.190570,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98424, 'precision': 0.9435977, 'recall': 0.81261516, 'specificity': 0.81261516, 'f1': 0.8658987, 'auroc': 0.97725743, 'binary_precision': 0.90082645, 'binary_recall': 0.6277898, 'binary_specificity': 0.99744046, 'binary_f1_score': 0.73992366}
confusion matrix:
       0    1
0  37411   96
1    517  872
---- Validation: 
scalar performance:
{'acc': 0.98384094, 'precision': 0.9381057, 'recall': 0.81117225, 'specificity': 0.81117225, 'f1': 0.8630596, 'auroc': 0.9749528, 'binary_precision': 0.8899522, 'binary_recall': 0.6252101, 'binary_specificity': 0.9971343, 'binary_f1_score': 0.7344522}
confusion matrix:
       0    1
0  16006   46
1    223  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687304, 'precision': 0.7398543, 'recall': 0.7727783, 'specificity': 0.7727783, 'f1': 0.755145, 'auroc': 0.9635955, 'binary_precision': 0.49363866, 'binary_recall': 0.56395346, 'binary_specificity': 0.981603, 'binary_f1_score': 0.5264586}
confusion matrix:
       0    1
0  10618  199
1    150  194
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 3
val acc:0.9838409423828125, best validation acc: 0.9838409423828125, corresponding to test acc:                         0.96971595287323 / 0.96971595287323
after epoch: 9,now: 2024-05-29 04:46:27.620535,epoch time: 0:19:37.984850,used: 2:58:56.175420,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9837772, 'precision': 0.88032895, 'recall': 0.88586295, 'specificity': 0.88586295, 'f1': 0.88307405, 'auroc': 0.9781712, 'binary_precision': 0.7687943, 'binary_recall': 0.78041756, 'binary_specificity': 0.9913083, 'binary_f1_score': 0.77456236}
confusion matrix:
       0     1
0  37181   326
1    305  1084
---- Validation: 
scalar performance:
{'acc': 0.9858233, 'precision': 0.91198015, 'recall': 0.87450755, 'specificity': 0.87450755, 'f1': 0.89227444, 'auroc': 0.9746791, 'binary_precision': 0.83302414, 'binary_recall': 0.75462186, 'binary_specificity': 0.9943932, 'binary_f1_score': 0.79188716}
confusion matrix:
       0    1
0  15962   90
1    146  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666697, 'precision': 0.72967875, 'recall': 0.8139331, 'specificity': 0.8139331, 'f1': 0.7645204, 'auroc': 0.9590211, 'binary_precision': 0.47058824, 'binary_recall': 0.6511628, 'binary_specificity': 0.97670335, 'binary_f1_score': 0.5463415}
confusion matrix:
       0    1
0  10565  252
1    120  224
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 10,now: 2024-05-29 05:06:21.549211,epoch time: 0:19:53.928676,used: 3:18:50.104096,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9838801, 'precision': 0.87433684, 'recall': 0.90047514, 'specificity': 0.90047514, 'f1': 0.8869232, 'auroc': 0.98062396, 'binary_precision': 0.7557047, 'binary_recall': 0.8106552, 'binary_specificity': 0.9902952, 'binary_f1_score': 0.7822161}
confusion matrix:
       0     1
0  37143   364
1    263  1126
---- Validation: 
scalar performance:
{'acc': 0.985583, 'precision': 0.8954218, 'recall': 0.8954218, 'specificity': 0.8954218, 'f1': 0.8954218, 'auroc': 0.97930646, 'binary_precision': 0.79831934, 'binary_recall': 0.79831934, 'binary_specificity': 0.99252427, 'binary_f1_score': 0.79831934}
confusion matrix:
       0    1
0  15932  120
1    120  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96801364, 'precision': 0.73632884, 'recall': 0.796332, 'specificity': 0.796332, 'f1': 0.7625743, 'auroc': 0.9599627, 'binary_precision': 0.48505747, 'binary_recall': 0.6133721, 'binary_specificity': 0.97929186, 'binary_f1_score': 0.54172015}
confusion matrix:
       0    1
0  10593  224
1    133  211
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 1
val acc:0.9855830073356628, best validation acc: 0.9858232736587524, corresponding to test acc:                         0.9666696786880493 / 0.96971595287323
after epoch: 11,now: 2024-05-29 05:26:04.572937,epoch time: 0:19:43.023726,used: 3:38:33.127822,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9833402, 'precision': 0.8652097, 'recall': 0.9095545, 'specificity': 0.9095545, 'f1': 0.88598883, 'auroc': 0.9876766, 'binary_precision': 0.7367412, 'binary_recall': 0.8300936, 'binary_specificity': 0.9890154, 'binary_f1_score': 0.7806364}
confusion matrix:
       0     1
0  37095   412
1    236  1153
---- Validation: 
scalar performance:
{'acc': 0.98504233, 'precision': 0.8885912, 'recall': 0.89675987, 'specificity': 0.89675987, 'f1': 0.89262915, 'auroc': 0.9780501, 'binary_precision': 0.78453946, 'binary_recall': 0.8016807, 'binary_specificity': 0.99183905, 'binary_f1_score': 0.79301745}
confusion matrix:
       0    1
0  15921  131
1    118  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96272737, 'precision': 0.7160655, 'recall': 0.86678255, 'specificity': 0.86678255, 'f1': 0.7694645, 'auroc': 0.94445926, 'binary_precision': 0.43979934, 'binary_recall': 0.7645349, 'binary_specificity': 0.9690302, 'binary_f1_score': 0.5583864}
confusion matrix:
       0    1
0  10482  335
1     81  263
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 2
val acc:0.9850423336029053, best validation acc: 0.9858232736587524, corresponding to test acc:                         0.9666696786880493 / 0.96971595287323
after epoch: 12,now: 2024-05-29 05:45:47.744949,epoch time: 0:19:43.172012,used: 3:58:16.299834,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.985397, 'precision': 0.8914378, 'recall': 0.8984885, 'specificity': 0.8984885, 'f1': 0.8949288, 'auroc': 0.98536515, 'binary_precision': 0.790106, 'binary_recall': 0.8048956, 'binary_specificity': 0.99208146, 'binary_f1_score': 0.79743224}
confusion matrix:
       0     1
0  37210   297
1    271  1118
---- Validation: 
scalar performance:
{'acc': 0.98594344, 'precision': 0.9056306, 'recall': 0.8858985, 'specificity': 0.8858985, 'f1': 0.89549696, 'auroc': 0.9808692, 'binary_precision': 0.81946903, 'binary_recall': 0.7781513, 'binary_specificity': 0.99364567, 'binary_f1_score': 0.7982759}
confusion matrix:
       0    1
0  15950  102
1    132  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756566, 'precision': 0.7313343, 'recall': 0.76373374, 'specificity': 0.76373374, 'f1': 0.7463567, 'auroc': 0.9525639, 'binary_precision': 0.47715735, 'binary_recall': 0.54651165, 'binary_specificity': 0.9809559, 'binary_f1_score': 0.50948507}
confusion matrix:
       0    1
0  10611  206
1    156  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 13,now: 2024-05-29 06:05:20.596121,epoch time: 0:19:32.851172,used: 4:17:49.151006,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98513985, 'precision': 0.9497678, 'recall': 0.82174766, 'specificity': 0.82174766, 'f1': 0.87433, 'auroc': 0.97964257, 'binary_precision': 0.9125127, 'binary_recall': 0.6457883, 'binary_specificity': 0.99770707, 'binary_f1_score': 0.75632375}
confusion matrix:
       0    1
0  37421   86
1    492  897
---- Validation: 
scalar performance:
{'acc': 0.9834805, 'precision': 0.94276786, 'recall': 0.8012751, 'specificity': 0.8012751, 'f1': 0.85755193, 'auroc': 0.9741448, 'binary_precision': 0.9, 'binary_recall': 0.60504204, 'binary_specificity': 0.9975081, 'binary_f1_score': 0.7236181}
confusion matrix:
       0    1
0  16012   40
1    235  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96998477, 'precision': 0.7517143, 'recall': 0.62566257, 'specificity': 0.62566257, 'f1': 0.665809, 'auroc': 0.9639989, 'binary_precision': 0.52662724, 'binary_recall': 0.25872093, 'binary_specificity': 0.99260426, 'binary_f1_score': 0.34697857}
confusion matrix:
       0   1
0  10737  80
1    255  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
new oracle model saved
early stop counter: 1
val acc:0.9834805130958557, best validation acc: 0.9859434366226196, corresponding to test acc:                         0.967565655708313 / 0.969984769821167
after epoch: 14,now: 2024-05-29 06:25:09.111890,epoch time: 0:19:48.515769,used: 4:37:37.666775,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98331445, 'precision': 0.8687526, 'recall': 0.9001138, 'specificity': 0.9001138, 'f1': 0.8837321, 'auroc': 0.98210645, 'binary_precision': 0.74454004, 'binary_recall': 0.81051874, 'binary_specificity': 0.98970884, 'binary_f1_score': 0.7761297}
confusion matrix:
       0     1
0  37122   386
1    263  1125
---- Validation: 
scalar performance:
{'acc': 0.9823992, 'precision': 0.86146444, 'recall': 0.8970077, 'specificity': 0.8970077, 'f1': 0.87832177, 'auroc': 0.9744638, 'binary_precision': 0.73018295, 'binary_recall': 0.805042, 'binary_specificity': 0.9889733, 'binary_f1_score': 0.7657874}
confusion matrix:
       0    1
0  15875  177
1    116  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638025, 'precision': 0.71791655, 'recall': 0.8405992, 'specificity': 0.8405992, 'f1': 0.7641166, 'auroc': 0.95593977, 'binary_precision': 0.4452555, 'binary_recall': 0.7093023, 'binary_specificity': 0.9718961, 'binary_f1_score': 0.5470852}
confusion matrix:
       0    1
0  10513  304
1    100  244
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 2
val acc:0.9823992252349854, best validation acc: 0.9859434366226196, corresponding to test acc:                         0.967565655708313 / 0.969984769821167
after epoch: 15,now: 2024-05-29 06:44:48.187719,epoch time: 0:19:39.075829,used: 4:57:16.742604,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9878651, 'precision': 0.9332151, 'recall': 0.8831296, 'specificity': 0.8831296, 'f1': 0.9065086, 'auroc': 0.9883938, 'binary_precision': 0.8748978, 'binary_recall': 0.77033836, 'binary_specificity': 0.9959208, 'binary_f1_score': 0.8192955}
confusion matrix:
       0     1
0  37354   153
1    319  1070
---- Validation: 
scalar performance:
{'acc': 0.9857031, 'precision': 0.9152239, 'recall': 0.8679718, 'specificity': 0.8679718, 'f1': 0.89005136, 'auroc': 0.9803437, 'binary_precision': 0.84, 'binary_recall': 0.7411765, 'binary_specificity': 0.994767, 'binary_f1_score': 0.78749996}
confusion matrix:
       0    1
0  15968   84
1    154  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629961, 'precision': 0.7139988, 'recall': 0.83736867, 'specificity': 0.83736867, 'f1': 0.7601499, 'auroc': 0.9621928, 'binary_precision': 0.437613, 'binary_recall': 0.70348835, 'binary_specificity': 0.971249, 'binary_f1_score': 0.53957635}
confusion matrix:
       0    1
0  10506  311
1    102  242
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 3
val acc:0.9857031106948853, best validation acc: 0.9859434366226196, corresponding to test acc:                         0.967565655708313 / 0.969984769821167
after epoch: 16,now: 2024-05-29 07:04:32.660447,epoch time: 0:19:44.472728,used: 5:17:01.215332,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98650247, 'precision': 0.8997616, 'recall': 0.90558267, 'specificity': 0.90558267, 'f1': 0.9026492, 'auroc': 0.98919106, 'binary_precision': 0.80624557, 'binary_recall': 0.8184438, 'binary_specificity': 0.99272156, 'binary_f1_score': 0.8122989}
confusion matrix:
       0     1
0  37235   273
1    252  1136
---- Validation: 
scalar performance:
{'acc': 0.9872049, 'precision': 0.90693295, 'recall': 0.90759146, 'specificity': 0.90759146, 'f1': 0.90726197, 'auroc': 0.9826418, 'binary_precision': 0.8204698, 'binary_recall': 0.82184875, 'binary_specificity': 0.9933342, 'binary_f1_score': 0.82115877}
confusion matrix:
       0    1
0  15945  107
1    106  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606666, 'precision': 0.71254164, 'recall': 0.9065301, 'specificity': 0.9065301, 'f1': 0.7751293, 'auroc': 0.9601692, 'binary_precision': 0.43004417, 'binary_recall': 0.8488372, 'binary_specificity': 0.96422297, 'binary_f1_score': 0.57087004}
confusion matrix:
       0    1
0  10430  387
1     52  292
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 17,now: 2024-05-29 07:24:09.698263,epoch time: 0:19:37.037816,used: 5:36:38.253148,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9869909, 'precision': 0.9057706, 'recall': 0.90520793, 'specificity': 0.90520793, 'f1': 0.9054891, 'auroc': 0.9882096, 'binary_precision': 0.8183129, 'binary_recall': 0.8171346, 'binary_specificity': 0.99328125, 'binary_f1_score': 0.81772333}
confusion matrix:
       0     1
0  37255   252
1    254  1135
---- Validation: 
scalar performance:
{'acc': 0.98708475, 'precision': 0.9262042, 'recall': 0.8783984, 'specificity': 0.8783984, 'f1': 0.9007622, 'auroc': 0.981104, 'binary_precision': 0.8612167, 'binary_recall': 0.76134455, 'binary_specificity': 0.9954523, 'binary_f1_score': 0.80820704}
confusion matrix:
       0    1
0  15979   73
1    142  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95887464, 'precision': 0.7036566, 'recall': 0.8830894, 'specificity': 0.8830894, 'f1': 0.7622279, 'auroc': 0.9606576, 'binary_precision': 0.41379312, 'binary_recall': 0.8023256, 'binary_specificity': 0.9638532, 'binary_f1_score': 0.54599404}
confusion matrix:
       0    1
0  10426  391
1     68  276
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 1
val acc:0.9870847463607788, best validation acc: 0.987204909324646, corresponding to test acc:                         0.9606665968894958 / 0.969984769821167
after epoch: 18,now: 2024-05-29 07:44:10.548038,epoch time: 0:20:00.849775,used: 5:56:39.102923,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98855925, 'precision': 0.94533956, 'recall': 0.881063, 'specificity': 0.881063, 'f1': 0.9104998, 'auroc': 0.9921256, 'binary_precision': 0.89932317, 'binary_recall': 0.7652988, 'binary_specificity': 0.99682724, 'binary_f1_score': 0.82691556}
confusion matrix:
       0     1
0  37388   119
1    326  1063
---- Validation: 
scalar performance:
{'acc': 0.98642397, 'precision': 0.93204355, 'recall': 0.8602537, 'specificity': 0.8602537, 'f1': 0.89263105, 'auroc': 0.98179364, 'binary_precision': 0.8742393, 'binary_recall': 0.72436976, 'binary_specificity': 0.99613756, 'binary_f1_score': 0.7922794}
confusion matrix:
       0    1
0  15990   62
1    164  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663113, 'precision': 0.7313498, 'recall': 0.86159515, 'specificity': 0.86159515, 'f1': 0.7804649, 'auroc': 0.9617597, 'binary_precision': 0.47080293, 'binary_recall': 0.75, 'binary_specificity': 0.97319037, 'binary_f1_score': 0.57847536}
confusion matrix:
       0    1
0  10527  290
1     86  258
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 2
val acc:0.9864239692687988, best validation acc: 0.987204909324646, corresponding to test acc:                         0.9606665968894958 / 0.969984769821167
after epoch: 19,now: 2024-05-29 08:03:51.464544,epoch time: 0:19:40.916506,used: 6:16:20.019429,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9889706, 'precision': 0.9319875, 'recall': 0.9034613, 'specificity': 0.9034613, 'f1': 0.9171963, 'auroc': 0.99217767, 'binary_precision': 0.87094283, 'binary_recall': 0.8113751, 'binary_specificity': 0.9955475, 'binary_f1_score': 0.8401043}
confusion matrix:
       0     1
0  37340   167
1    262  1127
---- Validation: 
scalar performance:
{'acc': 0.9857031, 'precision': 0.91339433, 'recall': 0.8703993, 'specificity': 0.8703993, 'f1': 0.89061683, 'auroc': 0.9829303, 'binary_precision': 0.8361582, 'binary_recall': 0.7462185, 'binary_specificity': 0.9945801, 'binary_f1_score': 0.78863233}
confusion matrix:
       0    1
0  15965   87
1    151  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663113, 'precision': 0.72850895, 'recall': 0.82359904, 'specificity': 0.82359904, 'f1': 0.76690567, 'auroc': 0.9560952, 'binary_precision': 0.46761134, 'binary_recall': 0.67151165, 'binary_specificity': 0.97568643, 'binary_f1_score': 0.5513127}
confusion matrix:
       0    1
0  10554  263
1    113  231
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 3
val acc:0.9857031106948853, best validation acc: 0.987204909324646, corresponding to test acc:                         0.9606665968894958 / 0.969984769821167
after epoch: 20,now: 2024-05-29 08:23:47.134165,epoch time: 0:19:55.669621,used: 6:36:15.689050,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98591113, 'precision': 0.88838476, 'recall': 0.9147006, 'specificity': 0.9147006, 'f1': 0.9010713, 'auroc': 0.99021053, 'binary_precision': 0.7827841, 'binary_recall': 0.83801293, 'binary_specificity': 0.99138826, 'binary_f1_score': 0.80945754}
confusion matrix:
       0     1
0  37184   323
1    225  1164
---- Validation: 
scalar performance:
{'acc': 0.9858233, 'precision': 0.88911265, 'recall': 0.9117302, 'specificity': 0.9117302, 'f1': 0.90007234, 'auroc': 0.9811255, 'binary_precision': 0.78446907, 'binary_recall': 0.8319328, 'binary_specificity': 0.99152756, 'binary_f1_score': 0.80750406}
confusion matrix:
       0    1
0  15916  136
1    100  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681393, 'precision': 0.69863355, 'recall': 0.89609885, 'specificity': 0.89609885, 'f1': 0.7600157, 'auroc': 0.949912, 'binary_precision': 0.4028169, 'binary_recall': 0.8313953, 'binary_specificity': 0.96080244, 'binary_f1_score': 0.5426945}
confusion matrix:
       0    1
0  10393  424
1     58  286
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 4
val acc:0.9858232736587524, best validation acc: 0.987204909324646, corresponding to test acc:                         0.9606665968894958 / 0.969984769821167
after epoch: 21,now: 2024-05-29 08:43:23.305525,epoch time: 0:19:36.171360,used: 6:55:51.860410,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9879936, 'precision': 0.9195607, 'recall': 0.9029547, 'specificity': 0.9029547, 'f1': 0.9110756, 'auroc': 0.9914197, 'binary_precision': 0.8460961, 'binary_recall': 0.8113751, 'binary_specificity': 0.9945344, 'binary_f1_score': 0.8283719}
confusion matrix:
       0     1
0  37302   205
1    262  1127
---- Validation: 
scalar performance:
{'acc': 0.987265, 'precision': 0.9066095, 'recall': 0.90924096, 'specificity': 0.90924096, 'f1': 0.9079206, 'auroc': 0.98096013, 'binary_precision': 0.8196995, 'binary_recall': 0.8252101, 'binary_specificity': 0.9932719, 'binary_f1_score': 0.8224456}
confusion matrix:
       0    1
0  15944  108
1    104  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96317536, 'precision': 0.71862304, 'recall': 0.87405, 'specificity': 0.87405, 'f1': 0.7733849, 'auroc': 0.95524985, 'binary_precision': 0.44444445, 'binary_recall': 0.7790698, 'binary_specificity': 0.9690302, 'binary_f1_score': 0.5659979}
confusion matrix:
       0    1
0  10482  335
1     76  268
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
better model found
persisted
after epoch: 22,now: 2024-05-29 09:02:58.351271,epoch time: 0:19:35.045746,used: 7:15:26.906156,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9883021, 'precision': 0.92840195, 'recall': 0.8965285, 'specificity': 0.8965285, 'f1': 0.91179746, 'auroc': 0.98923826, 'binary_precision': 0.86427456, 'binary_recall': 0.7976962, 'binary_specificity': 0.99536085, 'binary_f1_score': 0.82965183}
confusion matrix:
       0     1
0  37333   174
1    281  1108
---- Validation: 
scalar performance:
{'acc': 0.9857031, 'precision': 0.91219854, 'recall': 0.8720177, 'specificity': 0.8720177, 'f1': 0.8909905, 'auroc': 0.97303104, 'binary_precision': 0.83364487, 'binary_recall': 0.74957985, 'binary_specificity': 0.9944555, 'binary_f1_score': 0.78938055}
confusion matrix:
       0    1
0  15963   89
1    149  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967924, 'precision': 0.73826313, 'recall': 0.84131825, 'specificity': 0.84131825, 'f1': 0.7795806, 'auroc': 0.96220696, 'binary_precision': 0.486, 'binary_recall': 0.7063953, 'binary_specificity': 0.9762411, 'binary_f1_score': 0.5758294}
confusion matrix:
       0    1
0  10560  257
1    101  243
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 1
val acc:0.9857031106948853, best validation acc: 0.9872649908065796, corresponding to test acc:                         0.963175356388092 / 0.969984769821167
after epoch: 23,now: 2024-05-29 09:22:24.733528,epoch time: 0:19:26.382257,used: 7:34:53.288413,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9868367, 'precision': 0.8926737, 'recall': 0.9252331, 'specificity': 0.9252331, 'f1': 0.9082451, 'auroc': 0.99099004, 'binary_precision': 0.7905898, 'binary_recall': 0.8588913, 'binary_specificity': 0.9915749, 'binary_f1_score': 0.82332647}
confusion matrix:
       0     1
0  37191   316
1    196  1193
---- Validation: 
scalar performance:
{'acc': 0.9861236, 'precision': 0.8922465, 'recall': 0.9118859, 'specificity': 0.9118859, 'f1': 0.9018043, 'auroc': 0.98110473, 'binary_precision': 0.7907348, 'binary_recall': 0.8319328, 'binary_specificity': 0.99183905, 'binary_f1_score': 0.81081086}
confusion matrix:
       0    1
0  15921  131
1    100  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603082, 'precision': 0.7103502, 'recall': 0.8979016, 'specificity': 0.8979016, 'f1': 0.7713778, 'auroc': 0.96289575, 'binary_precision': 0.4262295, 'binary_recall': 0.8313953, 'binary_specificity': 0.96440786, 'binary_f1_score': 0.5635468}
confusion matrix:
       0    1
0  10432  385
1     58  286
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 2
val acc:0.9861236214637756, best validation acc: 0.9872649908065796, corresponding to test acc:                         0.963175356388092 / 0.969984769821167
after epoch: 24,now: 2024-05-29 09:42:11.124641,epoch time: 0:19:46.391113,used: 7:54:39.679526,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9867853, 'precision': 0.923182, 'recall': 0.8765897, 'specificity': 0.8765897, 'f1': 0.89841473, 'auroc': 0.9920026, 'binary_precision': 0.8552846, 'binary_recall': 0.7579251, 'binary_specificity': 0.99525434, 'binary_f1_score': 0.8036669}
confusion matrix:
       0     1
0  37330   178
1    336  1052
---- Validation: 
scalar performance:
{'acc': 0.98606354, 'precision': 0.9157014, 'recall': 0.8738229, 'specificity': 0.8738229, 'f1': 0.89355683, 'auroc': 0.9789816, 'binary_precision': 0.8405253, 'binary_recall': 0.7529412, 'binary_specificity': 0.9947047, 'binary_f1_score': 0.79432625}
confusion matrix:
       0    1
0  15967   85
1    147  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96362334, 'precision': 0.71635324, 'recall': 0.83347046, 'specificity': 0.83347046, 'f1': 0.7608928, 'auroc': 0.9543872, 'binary_precision': 0.4425926, 'binary_recall': 0.6947674, 'binary_specificity': 0.97217345, 'binary_f1_score': 0.540724}
confusion matrix:
       0    1
0  10516  301
1    105  239
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 3
val acc:0.986063539981842, best validation acc: 0.9872649908065796, corresponding to test acc:                         0.963175356388092 / 0.969984769821167
after epoch: 25,now: 2024-05-29 10:02:35.617935,epoch time: 0:20:24.493294,used: 8:15:04.172820,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9874537, 'precision': 0.89674354, 'recall': 0.9296651, 'specificity': 0.9296651, 'f1': 0.912488, 'auroc': 0.99238634, 'binary_precision': 0.7984085, 'binary_recall': 0.86743516, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.83149165}
confusion matrix:
       0     1
0  37204   304
1    184  1204
---- Validation: 
scalar performance:
{'acc': 0.98438156, 'precision': 0.8750968, 'recall': 0.9101734, 'specificity': 0.9101734, 'f1': 0.8917767, 'auroc': 0.978618, 'binary_precision': 0.7565084, 'binary_recall': 0.8302521, 'binary_specificity': 0.9900947, 'binary_f1_score': 0.7916667}
confusion matrix:
       0    1
0  15893  159
1    101  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677448, 'precision': 0.7366642, 'recall': 0.8299677, 'specificity': 0.8299677, 'f1': 0.7747573, 'auroc': 0.9569405, 'binary_precision': 0.4835391, 'binary_recall': 0.68313956, 'binary_specificity': 0.9767958, 'binary_f1_score': 0.56626505}
confusion matrix:
       0    1
0  10566  251
1    109  235
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897895.png
early stop counter: 4
val acc:0.9843815565109253, best validation acc: 0.9872649908065796, corresponding to test acc:                         0.963175356388092 / 0.969984769821167
after epoch: 26,now: 2024-05-29 10:22:47.572524,epoch time: 0:20:11.954589,used: 8:35:16.127409,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_29_01_47_31_seed_0_20897895
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
slurmstepd: error: *** JOB 20897895 ON gpusrv30 CANCELLED AT 2024-05-29T10:35:50 ***
