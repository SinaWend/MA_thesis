Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:43 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891

 Experiment start at: 2024-05-27 19:33:02.881434
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9650164, 'precision': 0.73780483, 'recall': 0.8402647, 'specificity': 0.8402647, 'f1': 0.77880704, 'auroc': 0.9354618, 'binary_precision': 0.48598132, 'binary_recall': 0.70652175, 'binary_specificity': 0.97400755, 'binary_f1_score': 0.57585824}
confusion matrix:
       0     1
0  41220  1100
1    432  1040
---- Validation: 
scalar performance:
{'acc': 0.9620583, 'precision': 0.7256242, 'recall': 0.82509565, 'specificity': 0.82509565, 'f1': 0.7651758, 'auroc': 0.9310491, 'binary_precision': 0.462845, 'binary_recall': 0.67807156, 'binary_specificity': 0.9721197, 'binary_f1_score': 0.5501577}
confusion matrix:
       0    1
0  17643  506
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.83527446, 'recall': 0.8266634, 'specificity': 0.8266634, 'f1': 0.8309063, 'auroc': 0.91616845, 'binary_precision': 0.68503934, 'binary_recall': 0.6666667, 'binary_specificity': 0.98666, 'binary_f1_score': 0.67572814}
confusion matrix:
      0    1
0  5917   80
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 19:53:21.308916,epoch time: 0:20:18.427482,used: 0:20:18.427482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9702914, 'precision': 0.7731612, 'recall': 0.7525047, 'specificity': 0.7525047, 'f1': 0.762385, 'auroc': 0.95318687, 'binary_precision': 0.56300664, 'binary_recall': 0.51902175, 'binary_specificity': 0.9859877, 'binary_f1_score': 0.5401202}
confusion matrix:
       0    1
0  41727  593
1    708  764
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74385315, 'recall': 0.73946047, 'specificity': 0.73946047, 'f1': 0.7416346, 'auroc': 0.9463055, 'binary_precision': 0.50554675, 'binary_recall': 0.496112, 'binary_specificity': 0.98280895, 'binary_f1_score': 0.50078493}
confusion matrix:
       0    1
0  17837  312
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.88751507, 'recall': 0.7708615, 'specificity': 0.7708615, 'f1': 0.81784487, 'auroc': 0.9277533, 'binary_precision': 0.79444444, 'binary_recall': 0.54789275, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.64852613}
confusion matrix:
      0    1
0  5960   37
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-27 20:12:08.565904,epoch time: 0:18:47.256988,used: 0:39:05.684470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9699032, 'precision': 0.7680886, 'recall': 0.76773643, 'specificity': 0.76773643, 'f1': 0.7679124, 'auroc': 0.9584667, 'binary_precision': 0.5517711, 'binary_recall': 0.5510204, 'binary_specificity': 0.98445255, 'binary_f1_score': 0.5513955}
confusion matrix:
       0    1
0  41664  658
1    660  810
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.75436825, 'recall': 0.79720855, 'specificity': 0.79720855, 'f1': 0.7739294, 'auroc': 0.95306176, 'binary_precision': 0.52248675, 'binary_recall': 0.61430794, 'binary_specificity': 0.9801091, 'binary_f1_score': 0.56468904}
confusion matrix:
       0    1
0  17788  361
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.86385584, 'recall': 0.7529531, 'specificity': 0.7529531, 'f1': 0.7974239, 'auroc': 0.9578519, 'binary_precision': 0.74860334, 'binary_recall': 0.51341, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6090909}
confusion matrix:
      0    1
0  5952   45
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
better model found
persisted
after epoch: 3,now: 2024-05-27 20:30:40.804812,epoch time: 0:18:32.238908,used: 0:57:37.923378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9681449, 'precision': 0.7544482, 'recall': 0.857204, 'specificity': 0.857204, 'f1': 0.7961557, 'auroc': 0.9634745, 'binary_precision': 0.51812977, 'binary_recall': 0.73827326, 'binary_specificity': 0.9761348, 'binary_f1_score': 0.6089151}
confusion matrix:
       0     1
0  41311  1010
1    385  1086
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7450857, 'recall': 0.8353298, 'specificity': 0.8353298, 'f1': 0.78231454, 'auroc': 0.9581939, 'binary_precision': 0.5011211, 'binary_recall': 0.69517887, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.5824104}
confusion matrix:
       0    1
0  17704  445
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.82899565, 'recall': 0.816918, 'specificity': 0.816918, 'f1': 0.82283056, 'auroc': 0.9499769, 'binary_precision': 0.67330676, 'binary_recall': 0.6475096, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.66015625}
confusion matrix:
      0    1
0  5915   82
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9725151658058167 / 0.9752317070960999
after epoch: 4,now: 2024-05-27 20:49:26.411363,epoch time: 0:18:45.606551,used: 1:16:23.529929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9698575, 'precision': 0.7650895, 'recall': 0.82506496, 'specificity': 0.82506496, 'f1': 0.79168403, 'auroc': 0.9640504, 'binary_precision': 0.54175824, 'binary_recall': 0.66983694, 'binary_specificity': 0.980293, 'binary_f1_score': 0.59902793}
confusion matrix:
       0    1
0  41486  834
1    486  986
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75038195, 'recall': 0.8425762, 'specificity': 0.8425762, 'f1': 0.7884275, 'auroc': 0.9619527, 'binary_precision': 0.51121074, 'binary_recall': 0.70917577, 'binary_specificity': 0.97597665, 'binary_f1_score': 0.59413683}
confusion matrix:
       0    1
0  17713  436
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.84483206, 'recall': 0.7371272, 'specificity': 0.7371272, 'f1': 0.77997124, 'auroc': 0.9568287, 'binary_precision': 0.7118644, 'binary_recall': 0.4827586, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5753425}
confusion matrix:
      0    1
0  5946   51
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9725151658058167 / 0.9752317070960999
after epoch: 5,now: 2024-05-27 21:08:35.543858,epoch time: 0:19:09.132495,used: 1:35:32.662424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9690811, 'precision': 0.760692, 'recall': 0.79843456, 'specificity': 0.79843456, 'f1': 0.7781459, 'auroc': 0.96516657, 'binary_precision': 0.5348288, 'binary_recall': 0.6154891, 'binary_specificity': 0.98138, 'binary_f1_score': 0.572331}
confusion matrix:
       0    1
0  41532  788
1    566  906
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7530389, 'recall': 0.81209946, 'specificity': 0.81209946, 'f1': 0.7791146, 'auroc': 0.9622528, 'binary_precision': 0.51875, 'binary_recall': 0.64541215, 'binary_specificity': 0.9787867, 'binary_f1_score': 0.57519054}
confusion matrix:
       0    1
0  17764  385
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8569649, 'recall': 0.69806457, 'specificity': 0.69806457, 'f1': 0.7525792, 'auroc': 0.9500854, 'binary_precision': 0.7394366, 'binary_recall': 0.40229884, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.5210918}
confusion matrix:
      0    1
0  5960   37
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 3
val acc:0.9673797488212585, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9725151658058167 / 0.9752317070960999
after epoch: 6,now: 2024-05-27 21:27:15.350851,epoch time: 0:18:39.806993,used: 1:54:12.469417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96949214, 'precision': 0.7619829, 'recall': 0.8648747, 'specificity': 0.8648747, 'f1': 0.8039876, 'auroc': 0.9683417, 'binary_precision': 0.5326923, 'binary_recall': 0.7527174, 'binary_specificity': 0.9770321, 'binary_f1_score': 0.6238739}
confusion matrix:
       0     1
0  41348   972
1    364  1108
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7529898, 'recall': 0.84282416, 'specificity': 0.84282416, 'f1': 0.79030645, 'auroc': 0.96316946, 'binary_precision': 0.5164213, 'binary_recall': 0.70917577, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.59764093}
confusion matrix:
       0    1
0  17722  427
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8051715, 'recall': 0.66816163, 'specificity': 0.66816163, 'f1': 0.7147177, 'auroc': 0.93644905, 'binary_precision': 0.63829786, 'binary_recall': 0.3448276, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.4477612}
confusion matrix:
      0   1
0  5946  51
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 4
val acc:0.9673265218734741, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9725151658058167 / 0.9752317070960999
after epoch: 7,now: 2024-05-27 21:47:03.206770,epoch time: 0:19:47.855919,used: 2:14:00.325336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.969789, 'precision': 0.76465416, 'recall': 0.82470167, 'specificity': 0.82470167, 'f1': 0.79127157, 'auroc': 0.9673443, 'binary_precision': 0.5409116, 'binary_recall': 0.6691576, 'binary_specificity': 0.98024577, 'binary_f1_score': 0.59823877}
confusion matrix:
       0    1
0  41484  836
1    487  985
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.7641593, 'recall': 0.825037, 'specificity': 0.825037, 'f1': 0.791088, 'auroc': 0.96309316, 'binary_precision': 0.5401003, 'binary_recall': 0.6702955, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.5981957}
confusion matrix:
       0    1
0  17782  367
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.8586548, 'recall': 0.73579514, 'specificity': 0.73579514, 'f1': 0.78325105, 'auroc': 0.95158434, 'binary_precision': 0.73964494, 'binary_recall': 0.4789272, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5813953}
confusion matrix:
      0    1
0  5953   44
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
better model found
persisted
after epoch: 8,now: 2024-05-27 22:07:25.537914,epoch time: 0:20:22.331144,used: 2:34:22.656480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.75094616, 'recall': 0.8392693, 'specificity': 0.8392693, 'f1': 0.78770363, 'auroc': 0.96732175, 'binary_precision': 0.5124008, 'binary_recall': 0.7017663, 'binary_specificity': 0.9767722, 'binary_f1_score': 0.5923165}
confusion matrix:
       0     1
0  41337   983
1    439  1033
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.73842466, 'recall': 0.8473369, 'specificity': 0.8473369, 'f1': 0.781446, 'auroc': 0.9565277, 'binary_precision': 0.48688352, 'binary_recall': 0.7216174, 'binary_specificity': 0.9730564, 'binary_f1_score': 0.5814537}
confusion matrix:
       0    1
0  17660  489
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8553797, 'recall': 0.6998969, 'specificity': 0.6998969, 'f1': 0.75376046, 'auroc': 0.94788647, 'binary_precision': 0.7361111, 'binary_recall': 0.40613025, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.52345675}
confusion matrix:
      0    1
0  5959   38
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 1
val acc:0.9644529819488525, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9712368249893188 / 0.9752317070960999
after epoch: 9,now: 2024-05-27 22:26:27.987433,epoch time: 0:19:02.449519,used: 2:53:25.105999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.75686276, 'recall': 0.8695679, 'specificity': 0.8695679, 'f1': 0.8018555, 'auroc': 0.9693254, 'binary_precision': 0.52208275, 'binary_recall': 0.76342624, 'binary_specificity': 0.97570944, 'binary_f1_score': 0.62009937}
confusion matrix:
       0     1
0  41293  1028
1    348  1123
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.7339195, 'recall': 0.8647046, 'specificity': 0.8647046, 'f1': 0.78312206, 'auroc': 0.96183133, 'binary_precision': 0.4765625, 'binary_recall': 0.7589425, 'binary_specificity': 0.9704667, 'binary_f1_score': 0.5854829}
confusion matrix:
       0    1
0  17613  536
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.81729966, 'recall': 0.651754, 'specificity': 0.651754, 'f1': 0.7023809, 'auroc': 0.9426569, 'binary_precision': 0.6639344, 'binary_recall': 0.31034482, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.4229765}
confusion matrix:
      0   1
0  5956  41
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 2
val acc:0.9632290601730347, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9712368249893188 / 0.9752317070960999
after epoch: 10,now: 2024-05-27 22:44:58.722129,epoch time: 0:18:30.734696,used: 3:11:55.840695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97227806, 'precision': 0.77867943, 'recall': 0.8650047, 'specificity': 0.8650047, 'f1': 0.8154061, 'auroc': 0.96918875, 'binary_precision': 0.5661538, 'binary_recall': 0.75, 'binary_specificity': 0.98000944, 'binary_f1_score': 0.64523673}
confusion matrix:
       0     1
0  41474   846
1    368  1104
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.76349175, 'recall': 0.86856776, 'specificity': 0.86856776, 'f1': 0.8062458, 'auroc': 0.96150017, 'binary_precision': 0.5355969, 'binary_recall': 0.7604977, 'binary_specificity': 0.97663784, 'binary_f1_score': 0.6285347}
confusion matrix:
       0    1
0  17725  424
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8257364, 'recall': 0.64450806, 'specificity': 0.64450806, 'f1': 0.6968229, 'auroc': 0.94336534, 'binary_precision': 0.6814159, 'binary_recall': 0.29501915, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4117647}
confusion matrix:
      0   1
0  5961  36
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
better model found
persisted
after epoch: 11,now: 2024-05-27 23:03:28.835099,epoch time: 0:18:30.112970,used: 3:30:25.953665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97120476, 'precision': 0.77294326, 'recall': 0.8457615, 'specificity': 0.8457615, 'f1': 0.80458605, 'auroc': 0.9719784, 'binary_precision': 0.5560276, 'binary_recall': 0.7112772, 'binary_specificity': 0.98024577, 'binary_f1_score': 0.62414306}
confusion matrix:
       0     1
0  41484   836
1    425  1047
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7509795, 'recall': 0.8583549, 'specificity': 0.8583549, 'f1': 0.794028, 'auroc': 0.9628791, 'binary_precision': 0.511254, 'binary_recall': 0.7418352, 'binary_specificity': 0.9748747, 'binary_f1_score': 0.60532993}
confusion matrix:
       0    1
0  17693  456
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8502389, 'recall': 0.61877203, 'specificity': 0.61877203, 'f1': 0.6724757, 'auroc': 0.9554919, 'binary_precision': 0.73255813, 'binary_recall': 0.2413793, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3631124}
confusion matrix:
      0   1
0  5974  23
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 12,now: 2024-05-27 23:22:40.496941,epoch time: 0:19:11.661842,used: 3:49:37.615507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9711819, 'precision': 0.773651, 'recall': 0.82924724, 'specificity': 0.82924724, 'f1': 0.79860234, 'auroc': 0.96307147, 'binary_precision': 0.55860907, 'binary_recall': 0.6770904, 'binary_specificity': 0.981404, 'binary_f1_score': 0.6121697}
confusion matrix:
       0    1
0  41534  787
1    475  996
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.75470227, 'recall': 0.8317386, 'specificity': 0.8317386, 'f1': 0.7875507, 'auroc': 0.95971763, 'binary_precision': 0.5206612, 'binary_recall': 0.6858476, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.5919463}
confusion matrix:
       0    1
0  17743  406
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.83971155, 'recall': 0.77818894, 'specificity': 0.77818894, 'f1': 0.8055477, 'auroc': 0.95927995, 'binary_precision': 0.6981132, 'binary_recall': 0.5670498, 'binary_specificity': 0.989328, 'binary_f1_score': 0.62579286}
confusion matrix:
      0    1
0  5933   64
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 2
val acc:0.9676458239555359, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 13,now: 2024-05-27 23:41:04.683300,epoch time: 0:18:24.186359,used: 4:08:01.801866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7450081, 'recall': 0.80426973, 'specificity': 0.80426973, 'f1': 0.77105975, 'auroc': 0.95060325, 'binary_precision': 0.5029843, 'binary_recall': 0.6301836, 'binary_specificity': 0.9783559, 'binary_f1_score': 0.5594448}
confusion matrix:
       0    1
0  41405  916
1    544  927
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7353453, 'recall': 0.81719697, 'specificity': 0.81719697, 'f1': 0.7694331, 'auroc': 0.9440963, 'binary_precision': 0.48291573, 'binary_recall': 0.65940905, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.55752796}
confusion matrix:
       0    1
0  17695  454
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8136115, 'recall': 0.687152, 'specificity': 0.687152, 'f1': 0.7327044, 'auroc': 0.9582917, 'binary_precision': 0.6535948, 'binary_recall': 0.38314176, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.48309183}
confusion matrix:
      0    1
0  5944   53
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 3
val acc:0.9641869068145752, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 14,now: 2024-05-27 23:59:32.211779,epoch time: 0:18:27.528479,used: 4:26:29.330345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9710906, 'precision': 0.7704549, 'recall': 0.8876684, 'specificity': 0.8876684, 'f1': 0.81740606, 'auroc': 0.9748765, 'binary_precision': 0.54804105, 'binary_recall': 0.7982337, 'binary_specificity': 0.977103, 'binary_f1_score': 0.6498894}
confusion matrix:
       0     1
0  41351   969
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7483518, 'recall': 0.8700527, 'specificity': 0.8700527, 'f1': 0.7957087, 'auroc': 0.9657694, 'binary_precision': 0.50512296, 'binary_recall': 0.7667185, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.60901785}
confusion matrix:
       0    1
0  17666  483
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.8715941, 'recall': 0.74570715, 'specificity': 0.74570715, 'f1': 0.7945492, 'auroc': 0.95854294, 'binary_precision': 0.7647059, 'binary_recall': 0.49808428, 'binary_specificity': 0.99333, 'binary_f1_score': 0.60324824}
confusion matrix:
      0    1
0  5957   40
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 4
val acc:0.9663154482841492, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 15,now: 2024-05-28 00:17:58.427850,epoch time: 0:18:26.216071,used: 4:44:55.546416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9723009, 'precision': 0.77740496, 'recall': 0.8882946, 'specificity': 0.8882946, 'f1': 0.82255983, 'auroc': 0.97910404, 'binary_precision': 0.5619321, 'binary_recall': 0.7982337, 'binary_specificity': 0.9783554, 'binary_f1_score': 0.6595565}
confusion matrix:
       0     1
0  41404   916
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.75278187, 'recall': 0.86752087, 'specificity': 0.86752087, 'f1': 0.7982174, 'auroc': 0.97272056, 'binary_precision': 0.51419556, 'binary_recall': 0.7604977, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.6135508}
confusion matrix:
       0    1
0  17687  462
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.8492863, 'recall': 0.78993326, 'specificity': 0.78993326, 'f1': 0.8165527, 'auroc': 0.9435201, 'binary_precision': 0.7162791, 'binary_recall': 0.5900383, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.64705884}
confusion matrix:
      0    1
0  5936   61
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 5
val acc:0.9672200679779053, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 16,now: 2024-05-28 00:36:26.575300,epoch time: 0:18:28.147450,used: 5:03:23.693866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.76569736, 'recall': 0.84681004, 'specificity': 0.84681004, 'f1': 0.80026484, 'auroc': 0.9625685, 'binary_precision': 0.5414308, 'binary_recall': 0.71467394, 'binary_specificity': 0.97894615, 'binary_f1_score': 0.61610544}
confusion matrix:
       0     1
0  41429   891
1    420  1052
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.75189435, 'recall': 0.8472142, 'specificity': 0.8472142, 'f1': 0.79103756, 'auroc': 0.94327, 'binary_precision': 0.51390433, 'binary_recall': 0.718507, 'binary_specificity': 0.9759215, 'binary_f1_score': 0.59922177}
confusion matrix:
       0    1
0  17712  437
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.82956964, 'recall': 0.7477043, 'specificity': 0.7477043, 'f1': 0.7821919, 'auroc': 0.9336225, 'binary_precision': 0.68041235, 'binary_recall': 0.50574714, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.5802198}
confusion matrix:
      0    1
0  5935   62
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 6
val acc:0.9671136736869812, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 17,now: 2024-05-28 00:54:55.047759,epoch time: 0:18:28.472459,used: 5:21:52.166325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96873856, 'precision': 0.7577453, 'recall': 0.8791652, 'specificity': 0.8791652, 'f1': 0.8054826, 'auroc': 0.9761872, 'binary_precision': 0.52316076, 'binary_recall': 0.7831407, 'binary_specificity': 0.9751896, 'binary_f1_score': 0.6272802}
confusion matrix:
       0     1
0  41271  1050
1    319  1152
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.73888767, 'recall': 0.87347865, 'specificity': 0.87347865, 'f1': 0.7894467, 'auroc': 0.9643159, 'binary_precision': 0.4858812, 'binary_recall': 0.7760498, 'binary_specificity': 0.9709075, 'binary_f1_score': 0.5976048}
confusion matrix:
       0    1
0  17621  528
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8457755, 'recall': 0.7089752, 'specificity': 0.7089752, 'f1': 0.7588104, 'auroc': 0.9451124, 'binary_precision': 0.716129, 'binary_recall': 0.42528737, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5336539}
confusion matrix:
      0    1
0  5953   44
1   150  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 7
val acc:0.9642400741577148, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 18,now: 2024-05-28 01:13:19.223830,epoch time: 0:18:24.176071,used: 5:40:16.342396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9703827, 'precision': 0.76724964, 'recall': 0.85943407, 'specificity': 0.85943407, 'f1': 0.80577826, 'auroc': 0.9721688, 'binary_precision': 0.5436409, 'binary_recall': 0.7404891, 'binary_specificity': 0.978379, 'binary_f1_score': 0.62697726}
confusion matrix:
       0     1
0  41405   915
1    382  1090
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74887085, 'recall': 0.8701078, 'specificity': 0.8701078, 'f1': 0.79611367, 'auroc': 0.9641975, 'binary_precision': 0.50616014, 'binary_recall': 0.7667185, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.6097712}
confusion matrix:
       0    1
0  17668  481
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8384787, 'recall': 0.71996915, 'specificity': 0.71996915, 'f1': 0.76534, 'auroc': 0.94634104, 'binary_precision': 0.7005988, 'binary_recall': 0.44827586, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.54672897}
confusion matrix:
      0    1
0  5947   50
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 8
val acc:0.966421902179718, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 19,now: 2024-05-28 01:31:47.979372,epoch time: 0:18:28.755542,used: 5:58:45.097938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9653818, 'precision': 0.74256796, 'recall': 0.9004519, 'specificity': 0.9004519, 'f1': 0.7996179, 'auroc': 0.9734523, 'binary_precision': 0.49116465, 'binary_recall': 0.8308424, 'binary_specificity': 0.9700614, 'binary_f1_score': 0.61736494}
confusion matrix:
       0     1
0  41053  1267
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.7243233, 'recall': 0.87982833, 'specificity': 0.87982833, 'f1': 0.77926564, 'auroc': 0.9619708, 'binary_precision': 0.45617172, 'binary_recall': 0.7931571, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.57921636}
confusion matrix:
       0    1
0  17541  608
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.85524654, 'recall': 0.81467074, 'specificity': 0.81467074, 'f1': 0.8335942, 'auroc': 0.9233326, 'binary_precision': 0.726087, 'binary_recall': 0.63984674, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.68024445}
confusion matrix:
      0    1
0  5934   63
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 9
val acc:0.9605683088302612, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 20,now: 2024-05-28 01:50:11.750114,epoch time: 0:18:23.770742,used: 6:17:08.868680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9660897, 'precision': 0.74530125, 'recall': 0.8916381, 'specificity': 0.8916381, 'f1': 0.7995171, 'auroc': 0.97451776, 'binary_precision': 0.49729505, 'binary_recall': 0.8118206, 'binary_specificity': 0.9714556, 'binary_f1_score': 0.6167742}
confusion matrix:
       0     1
0  41112  1208
1    277  1195
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.72020465, 'recall': 0.8681642, 'specificity': 0.8681642, 'f1': 0.7729577, 'auroc': 0.9620718, 'binary_precision': 0.44877607, 'binary_recall': 0.7698289, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.5670103}
confusion matrix:
       0    1
0  17541  608
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503036, 'precision': 0.67551255, 'recall': 0.64241797, 'specificity': 0.64241797, 'f1': 0.6569415, 'auroc': 0.9185351, 'binary_precision': 0.3809524, 'binary_recall': 0.3065134, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.33970276}
confusion matrix:
      0    1
0  5867  130
1   181   80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 10
val acc:0.959770143032074, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 21,now: 2024-05-28 02:08:35.338062,epoch time: 0:18:23.587948,used: 6:35:32.456628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96997166, 'precision': 0.76414824, 'recall': 0.8929268, 'specificity': 0.8929268, 'f1': 0.8144111, 'auroc': 0.9787663, 'binary_precision': 0.53500897, 'binary_recall': 0.81033313, 'binary_specificity': 0.97552043, 'binary_f1_score': 0.64449847}
confusion matrix:
       0     1
0  41285  1036
1    279  1192
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.7376221, 'recall': 0.8718407, 'specificity': 0.8718407, 'f1': 0.7880012, 'auroc': 0.9663947, 'binary_precision': 0.48346305, 'binary_recall': 0.7729393, 'binary_specificity': 0.97074217, 'binary_f1_score': 0.5948534}
confusion matrix:
       0    1
0  17618  531
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.83803654, 'recall': 0.78185356, 'specificity': 0.78185356, 'f1': 0.8071143, 'auroc': 0.9520075, 'binary_precision': 0.6944444, 'binary_recall': 0.57471263, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.6289308}
confusion matrix:
      0    1
0  5931   66
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 11
val acc:0.9639740586280823, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 22,now: 2024-05-28 02:26:55.141151,epoch time: 0:18:19.803089,used: 6:53:52.259717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97104496, 'precision': 0.7749244, 'recall': 0.80043423, 'specificity': 0.80043423, 'f1': 0.787053, 'auroc': 0.9701269, 'binary_precision': 0.563197, 'binary_recall': 0.6175272, 'binary_specificity': 0.9833412, 'binary_f1_score': 0.58911216}
confusion matrix:
       0    1
0  41615  705
1    563  909
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75401944, 'recall': 0.7986811, 'specificity': 0.7986811, 'f1': 0.7743335, 'auroc': 0.9537497, 'binary_precision': 0.521682, 'binary_recall': 0.61741835, 'binary_specificity': 0.9799438, 'binary_f1_score': 0.5655271}
confusion matrix:
       0    1
0  17785  364
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8507991, 'recall': 0.6959821, 'specificity': 0.6959821, 'f1': 0.7493346, 'auroc': 0.92680025, 'binary_precision': 0.72727275, 'binary_recall': 0.39846742, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.5148515}
confusion matrix:
      0    1
0  5958   39
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 12
val acc:0.967539370059967, best validation acc: 0.9692422151565552, corresponding to test acc:                         0.9648450016975403 / 0.9752317070960999
after epoch: 23,now: 2024-05-28 02:45:08.749206,epoch time: 0:18:13.608055,used: 7:12:05.867772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.974219, 'precision': 0.79003483, 'recall': 0.88043475, 'specificity': 0.88043475, 'f1': 0.82847494, 'auroc': 0.97450054, 'binary_precision': 0.5878136, 'binary_recall': 0.7798913, 'binary_specificity': 0.98097825, 'binary_f1_score': 0.670365}
confusion matrix:
       0     1
0  41515   805
1    324  1148
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.76624525, 'recall': 0.85378706, 'specificity': 0.85378706, 'f1': 0.803108, 'auroc': 0.9543314, 'binary_precision': 0.5421965, 'binary_recall': 0.7293935, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.62201595}
confusion matrix:
       0    1
0  17753  396
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.81828564, 'recall': 0.7284638, 'specificity': 0.7284638, 'f1': 0.76517475, 'auroc': 0.94892144, 'binary_precision': 0.6594595, 'binary_recall': 0.46743295, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.54708517}
confusion matrix:
      0    1
0  5934   63
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
better model found
persisted
after epoch: 24,now: 2024-05-28 03:03:08.471638,epoch time: 0:17:59.722432,used: 7:30:05.590204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.75211823, 'recall': 0.8874329, 'specificity': 0.8874329, 'f1': 0.8036866, 'auroc': 0.96484137, 'binary_precision': 0.51127493, 'binary_recall': 0.80149555, 'binary_specificity': 0.9733702, 'binary_f1_score': 0.624305}
confusion matrix:
       0     1
0  41194  1127
1    292  1179
---- Validation: 
scalar performance:
{'acc': 0.9608876, 'precision': 0.723404, 'recall': 0.85599184, 'specificity': 0.85599184, 'f1': 0.77243423, 'auroc': 0.94386625, 'binary_precision': 0.45610687, 'binary_recall': 0.7433904, 'binary_specificity': 0.9685933, 'binary_f1_score': 0.565346}
confusion matrix:
       0    1
0  17579  570
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.78687495, 'recall': 0.7657756, 'specificity': 0.7657756, 'f1': 0.77587104, 'auroc': 0.9303454, 'binary_precision': 0.593361, 'binary_recall': 0.54789275, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.56972116}
confusion matrix:
      0    1
0  5899   98
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 1
val acc:0.960887610912323, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9677213430404663 / 0.9752317070960999
after epoch: 25,now: 2024-05-28 03:21:06.865092,epoch time: 0:17:58.393454,used: 7:48:03.983658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9612258, 'precision': 0.7255577, 'recall': 0.896276, 'specificity': 0.896276, 'f1': 0.78425765, 'auroc': 0.9734119, 'binary_precision': 0.4573148, 'binary_recall': 0.82664853, 'binary_specificity': 0.96590346, 'binary_f1_score': 0.58886194}
confusion matrix:
       0     1
0  40878  1443
1    255  1216
---- Validation: 
scalar performance:
{'acc': 0.96019584, 'precision': 0.72141373, 'recall': 0.8638843, 'specificity': 0.8638843, 'f1': 0.772884, 'auroc': 0.9559269, 'binary_precision': 0.45152354, 'binary_recall': 0.7604977, 'binary_specificity': 0.9672709, 'binary_f1_score': 0.56662804}
confusion matrix:
       0    1
0  17555  594
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.8414033, 'recall': 0.84390473, 'specificity': 0.84390473, 'f1': 0.84264886, 'auroc': 0.957162, 'binary_precision': 0.6958175, 'binary_recall': 0.7011494, 'binary_specificity': 0.98666, 'binary_f1_score': 0.6984732}
confusion matrix:
      0    1
0  5917   80
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 2
val acc:0.9601958394050598, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9677213430404663 / 0.9752317070960999
after epoch: 26,now: 2024-05-28 03:39:18.218231,epoch time: 0:18:11.353139,used: 8:06:15.336797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97188985, 'precision': 0.78031754, 'recall': 0.81234646, 'specificity': 0.81234646, 'f1': 0.7953741, 'auroc': 0.97401273, 'binary_precision': 0.57316333, 'binary_recall': 0.6413044, 'binary_specificity': 0.9833885, 'binary_f1_score': 0.60532224}
confusion matrix:
       0    1
0  41617  703
1    528  944
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.74411535, 'recall': 0.82402384, 'specificity': 0.82402384, 'f1': 0.7777508, 'auroc': 0.95892924, 'binary_precision': 0.5, 'binary_recall': 0.6718507, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.5733245}
confusion matrix:
       0    1
0  17717  432
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.822592, 'recall': 0.72305024, 'specificity': 0.72305024, 'f1': 0.762749, 'auroc': 0.9476903, 'binary_precision': 0.66853935, 'binary_recall': 0.4559387, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5421412}
confusion matrix:
      0    1
0  5938   59
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9677213430404663 / 0.9752317070960999
after epoch: 27,now: 2024-05-28 03:57:36.899222,epoch time: 0:18:18.680991,used: 8:24:34.017788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9710906, 'precision': 0.77064097, 'recall': 0.88209474, 'specificity': 0.88209474, 'f1': 0.8157476, 'auroc': 0.97716635, 'binary_precision': 0.5488152, 'binary_recall': 0.7866848, 'binary_specificity': 0.97750473, 'binary_f1_score': 0.6465662}
confusion matrix:
       0     1
0  41368   952
1    314  1158
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.74616385, 'recall': 0.8660821, 'specificity': 0.8660821, 'f1': 0.7928825, 'auroc': 0.9668186, 'binary_precision': 0.5010267, 'binary_recall': 0.7589425, 'binary_specificity': 0.97322166, 'binary_f1_score': 0.6035869}
confusion matrix:
       0    1
0  17663  486
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8139013, 'recall': 0.73945785, 'specificity': 0.73945785, 'f1': 0.7710998, 'auroc': 0.9489285, 'binary_precision': 0.6497462, 'binary_recall': 0.49042144, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.558952}
confusion matrix:
      0    1
0  5928   69
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 4
val acc:0.9658897519111633, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9677213430404663 / 0.9752317070960999
after epoch: 28,now: 2024-05-28 04:16:05.500468,epoch time: 0:18:28.601246,used: 8:43:02.619034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97830653, 'precision': 0.81812316, 'recall': 0.8889667, 'specificity': 0.8889667, 'f1': 0.8496367, 'auroc': 0.9841815, 'binary_precision': 0.6434879, 'binary_recall': 0.7931973, 'binary_specificity': 0.9847361, 'binary_f1_score': 0.7105424}
confusion matrix:
       0     1
0  41676   646
1    304  1166
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.7771003, 'recall': 0.86375195, 'specificity': 0.86375195, 'f1': 0.81389666, 'auroc': 0.9711321, 'binary_precision': 0.5632318, 'binary_recall': 0.748056, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.64261854}
confusion matrix:
       0    1
0  17776  373
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8593988, 'recall': 0.67740864, 'specificity': 0.67740864, 'f1': 0.73469055, 'auroc': 0.9478878, 'binary_precision': 0.74603176, 'binary_recall': 0.36015326, 'binary_specificity': 0.994664, 'binary_f1_score': 0.48578814}
confusion matrix:
      0   1
0  5965  32
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
better model found
persisted
after epoch: 29,now: 2024-05-28 04:34:30.981798,epoch time: 0:18:25.481330,used: 9:01:28.100364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.969652, 'precision': 0.76513827, 'recall': 0.789222, 'specificity': 0.789222, 'f1': 0.7765994, 'auroc': 0.9722037, 'binary_precision': 0.5443824, 'binary_recall': 0.59578806, 'binary_specificity': 0.98265594, 'binary_f1_score': 0.5689264}
confusion matrix:
       0    1
0  41586  734
1    595  877
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7371897, 'recall': 0.78380257, 'specificity': 0.78380257, 'f1': 0.75815326, 'auroc': 0.96211076, 'binary_precision': 0.48903227, 'binary_recall': 0.58942455, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.5345557}
confusion matrix:
       0    1
0  17753  396
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8078525, 'recall': 0.77268994, 'specificity': 0.77268994, 'f1': 0.7890779, 'auroc': 0.9316497, 'binary_precision': 0.6347826, 'binary_recall': 0.55938697, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.59470475}
confusion matrix:
      0    1
0  5913   84
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897891.png
early stop counter: 1
val acc:0.9648786783218384, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.96820068359375 / 0.9752317070960999
after epoch: 30,now: 2024-05-28 04:53:02.072189,epoch time: 0:18:31.090391,used: 9:19:59.190755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_02_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:19:59.190755 at 2024-05-28 04:53:02.072189
persisted model performance metric: 

scalar performance:
{'acc': 0.9683605, 'precision': 0.8404105, 'recall': 0.70314467, 'specificity': 0.70314467, 'f1': 0.7526891, 'auroc': 0.9530214, 'binary_precision': 0.7058824, 'binary_recall': 0.41379312, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.5217391}
confusion matrix:
      0    1
0  5952   45
1   153  108
oracle model performance metric: 

scalar performance:
{'acc': 0.9757111, 'precision': 0.8942524, 'recall': 0.7711116, 'specificity': 0.7711116, 'f1': 0.8201916, 'auroc': 0.94241965, 'binary_precision': 0.8079096, 'binary_recall': 0.54789275, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6529681}
confusion matrix:
      0    1
0  5963   34
1   118  143
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1343 MiB |   1726 MiB | 593349 GiB | 593348 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590409 GiB | 590407 GiB |
|       from small pool |     10 MiB |     11 MiB |   2940 GiB |   2940 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137761 K  |  137757 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72867 K  |   72863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137761 K  |  137757 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72867 K  |   72863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2768    |   70697 K  |   70697 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      52    |    2747    |   38519 K  |   38519 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593349 GiB | 593349 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     24 MiB |   2940 GiB |   2940 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137761 K  |  137761 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72867 K  |   72867 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137761 K  |  137761 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72867 K  |   72867 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70698 K  |   70698 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38521 K  |   38521 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593349 GiB | 593349 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     24 MiB |   2940 GiB |   2940 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137761 K  |  137761 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72867 K  |   72867 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137761 K  |  137761 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72867 K  |   72867 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70698 K  |   70698 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38521 K  |   38521 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891

 Experiment start at: 2024-05-28 05:01:37.400269
before training, model accuracy: 0.2590968608856201
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95929164, 'precision': 0.79758036, 'recall': 0.6800147, 'specificity': 0.6800147, 'f1': 0.7224512, 'auroc': 0.9373045, 'binary_precision': 0.6261398, 'binary_recall': 0.37117118, 'binary_specificity': 0.98885834, 'binary_f1_score': 0.46606335}
confusion matrix:
       0    1
0  32750  369
1   1047  618
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9574212, 'precision': 0.7834872, 'recall': 0.6863438, 'specificity': 0.6863438, 'f1': 0.7234682, 'auroc': 0.93241924, 'binary_precision': 0.5978723, 'binary_recall': 0.385989, 'binary_specificity': 0.98669857, 'binary_f1_score': 0.46911517}
confusion matrix:
       0    1
0  14020  189
1    447  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469894, 'precision': 0.5566614, 'recall': 0.51421285, 'specificity': 0.51421285, 'f1': 0.5222005, 'auroc': 0.8093511, 'binary_precision': 0.11764706, 'binary_recall': 0.029411765, 'binary_specificity': 0.99901396, 'binary_f1_score': 0.047058824}
confusion matrix:
       0   1
0  15197  15
1     66   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 05:23:09.917259,epoch time: 0:21:32.516990,used: 0:21:32.516990,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9586879, 'precision': 0.77318966, 'recall': 0.775526, 'specificity': 0.775526, 'f1': 0.7743521, 'auroc': 0.9468967, 'binary_precision': 0.56785715, 'binary_recall': 0.57297295, 'binary_specificity': 0.978079, 'binary_f1_score': 0.57040364}
confusion matrix:
       0    1
0  32393  726
1    711  954
---- Validation: 
scalar performance:
{'acc': 0.95655084, 'precision': 0.7678778, 'recall': 0.73801625, 'specificity': 0.73801625, 'f1': 0.7519267, 'auroc': 0.9393666, 'binary_precision': 0.5614308, 'binary_recall': 0.4958791, 'binary_specificity': 0.98015344, 'binary_f1_score': 0.52662295}
confusion matrix:
       0    1
0  13927  282
1    367  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.57775867, 'recall': 0.6220418, 'specificity': 0.6220418, 'f1': 0.59482265, 'auroc': 0.82489836, 'binary_precision': 0.1588785, 'binary_recall': 0.25, 'binary_specificity': 0.99408364, 'binary_f1_score': 0.19428572}
confusion matrix:
       0   1
0  15122  90
1     51  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.9565508365631104, best validation acc: 0.9574211835861206, corresponding to test acc:                         0.9946989417076111 / 0.9946989417076111
after epoch: 2,now: 2024-05-28 05:42:25.598885,epoch time: 0:19:15.681626,used: 0:40:48.198616,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9575667, 'precision': 0.76464516, 'recall': 0.8248478, 'specificity': 0.8248478, 'f1': 0.79114676, 'auroc': 0.95810926, 'binary_precision': 0.54567426, 'binary_recall': 0.67807806, 'binary_specificity': 0.9716175, 'binary_f1_score': 0.6047135}
confusion matrix:
       0     1
0  32179   940
1    536  1129
---- Validation: 
scalar performance:
{'acc': 0.95635, 'precision': 0.7627439, 'recall': 0.8121959, 'specificity': 0.8121959, 'f1': 0.7849735, 'auroc': 0.9518261, 'binary_precision': 0.54347825, 'binary_recall': 0.65247256, 'binary_specificity': 0.9719192, 'binary_f1_score': 0.59300876}
confusion matrix:
       0    1
0  13810  399
1    253  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99175394, 'precision': 0.6034519, 'recall': 0.6518151, 'specificity': 0.6518151, 'f1': 0.62292707, 'auroc': 0.81933695, 'binary_precision': 0.21, 'binary_recall': 0.30882353, 'binary_specificity': 0.9948067, 'binary_f1_score': 0.25}
confusion matrix:
       0   1
0  15133  79
1     47  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 2
val acc:0.9563500285148621, best validation acc: 0.9574211835861206, corresponding to test acc:                         0.9946989417076111 / 0.9946989417076111
after epoch: 3,now: 2024-05-28 06:01:49.399601,epoch time: 0:19:23.800716,used: 1:00:11.999332,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.962109, 'precision': 0.8016075, 'recall': 0.74880224, 'specificity': 0.74880224, 'f1': 0.77231723, 'auroc': 0.95430076, 'binary_precision': 0.6274798, 'binary_recall': 0.5129129, 'binary_specificity': 0.98469156, 'binary_f1_score': 0.5644415}
confusion matrix:
       0    1
0  32612  507
1    811  854
---- Validation: 
scalar performance:
{'acc': 0.9600991, 'precision': 0.7863893, 'recall': 0.7744174, 'specificity': 0.7744174, 'f1': 0.78025585, 'auroc': 0.9535928, 'binary_precision': 0.5948276, 'binary_recall': 0.5686813, 'binary_specificity': 0.98015344, 'binary_f1_score': 0.58146065}
confusion matrix:
       0    1
0  13927  282
1    314  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9919503, 'precision': 0.60368264, 'recall': 0.64459366, 'specificity': 0.64459366, 'f1': 0.62067616, 'auroc': 0.7903925, 'binary_precision': 0.21052632, 'binary_recall': 0.29411766, 'binary_specificity': 0.9950697, 'binary_f1_score': 0.24539877}
confusion matrix:
       0   1
0  15137  75
1     48  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
better model found
persisted
after epoch: 4,now: 2024-05-28 06:21:12.649546,epoch time: 0:19:23.249945,used: 1:19:35.249277,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9595216, 'precision': 0.7721447, 'recall': 0.86380637, 'specificity': 0.86380637, 'f1': 0.81023043, 'auroc': 0.9619193, 'binary_precision': 0.5566828, 'binary_recall': 0.75795794, 'binary_specificity': 0.96965486, 'binary_f1_score': 0.6419125}
confusion matrix:
       0     1
0  32114  1005
1    403  1262
---- Validation: 
scalar performance:
{'acc': 0.957689, 'precision': 0.76782817, 'recall': 0.8480873, 'specificity': 0.8480873, 'f1': 0.80180573, 'auroc': 0.9564364, 'binary_precision': 0.54989606, 'binary_recall': 0.72664833, 'binary_specificity': 0.96952635, 'binary_f1_score': 0.6260355}
confusion matrix:
       0    1
0  13776  433
1    199  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.986911, 'precision': 0.582173, 'recall': 0.73722374, 'specificity': 0.73722374, 'f1': 0.6207592, 'auroc': 0.83598256, 'binary_precision': 0.16666667, 'binary_recall': 0.4852941, 'binary_specificity': 0.9891533, 'binary_f1_score': 0.24812031}
confusion matrix:
       0    1
0  15047  165
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.9576889872550964, best validation acc: 0.9600991010665894, corresponding to test acc:                         0.991950273513794 / 0.9946989417076111
after epoch: 5,now: 2024-05-28 06:40:37.952522,epoch time: 0:19:25.302976,used: 1:39:00.552253,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9602116, 'precision': 0.7763053, 'recall': 0.8419229, 'specificity': 0.8419229, 'f1': 0.8050509, 'auroc': 0.9571468, 'binary_precision': 0.56732154, 'binary_recall': 0.7111111, 'binary_specificity': 0.9727347, 'binary_f1_score': 0.63113016}
confusion matrix:
       0     1
0  32216   903
1    481  1184
---- Validation: 
scalar performance:
{'acc': 0.9584254, 'precision': 0.77247775, 'recall': 0.8178481, 'specificity': 0.8178481, 'f1': 0.7931249, 'auroc': 0.95546997, 'binary_precision': 0.56242704, 'binary_recall': 0.6620879, 'binary_specificity': 0.97360826, 'binary_f1_score': 0.60820186}
confusion matrix:
       0    1
0  13834  375
1    246  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9809555, 'precision': 0.548846, 'recall': 0.6976323, 'specificity': 0.6976323, 'f1': 0.5758758, 'auroc': 0.85951006, 'binary_precision': 0.10035843, 'binary_recall': 0.4117647, 'binary_specificity': 0.9834999, 'binary_f1_score': 0.16138329}
confusion matrix:
       0    1
0  14961  251
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 2
val acc:0.9584254026412964, best validation acc: 0.9600991010665894, corresponding to test acc:                         0.991950273513794 / 0.9946989417076111
after epoch: 6,now: 2024-05-28 07:00:01.845246,epoch time: 0:19:23.892724,used: 1:58:24.444977,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96072906, 'precision': 0.77863824, 'recall': 0.8441911, 'specificity': 0.8441911, 'f1': 0.8073927, 'auroc': 0.9636109, 'binary_precision': 0.5717715, 'binary_recall': 0.71531534, 'binary_specificity': 0.9730668, 'binary_f1_score': 0.635539}
confusion matrix:
       0     1
0  32227   892
1    474  1191
---- Validation: 
scalar performance:
{'acc': 0.9586262, 'precision': 0.77254605, 'recall': 0.83424425, 'specificity': 0.83424425, 'f1': 0.7997206, 'auroc': 0.9572108, 'binary_precision': 0.5608407, 'binary_recall': 0.6964286, 'binary_specificity': 0.97205997, 'binary_f1_score': 0.6213235}
confusion matrix:
       0    1
0  13812  397
1    221  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98455495, 'precision': 0.56117165, 'recall': 0.69944006, 'specificity': 0.69944006, 'f1': 0.5919919, 'auroc': 0.8243122, 'binary_precision': 0.125, 'binary_recall': 0.4117647, 'binary_specificity': 0.98711544, 'binary_f1_score': 0.1917808}
confusion matrix:
       0    1
0  15016  196
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 3
val acc:0.9586262106895447, best validation acc: 0.9600991010665894, corresponding to test acc:                         0.991950273513794 / 0.9946989417076111
after epoch: 7,now: 2024-05-28 07:19:26.463293,epoch time: 0:19:24.618047,used: 2:17:49.063024,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9592629, 'precision': 0.770459, 'recall': 0.88648677, 'specificity': 0.88648677, 'f1': 0.816415, 'auroc': 0.95990336, 'binary_precision': 0.55090314, 'binary_recall': 0.806006, 'binary_specificity': 0.9669676, 'binary_f1_score': 0.6544745}
confusion matrix:
       0     1
0  32025  1094
1    323  1342
---- Validation: 
scalar performance:
{'acc': 0.9559483, 'precision': 0.76059496, 'recall': 0.86215985, 'specificity': 0.86215985, 'f1': 0.8015772, 'auroc': 0.9510216, 'binary_precision': 0.5338491, 'binary_recall': 0.7582418, 'binary_specificity': 0.96607786, 'binary_f1_score': 0.62656075}
confusion matrix:
       0    1
0  13727  482
1    176  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98658377, 'precision': 0.5766627, 'recall': 0.7224192, 'specificity': 0.7224192, 'f1': 0.61272126, 'auroc': 0.79875576, 'binary_precision': 0.1557789, 'binary_recall': 0.45588234, 'binary_specificity': 0.9889561, 'binary_f1_score': 0.23220973}
confusion matrix:
       0    1
0  15044  168
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 4
val acc:0.9559482932090759, best validation acc: 0.9600991010665894, corresponding to test acc:                         0.991950273513794 / 0.9946989417076111
after epoch: 8,now: 2024-05-28 07:38:49.962249,epoch time: 0:19:23.498956,used: 2:37:12.561980,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9579979, 'precision': 0.76556516, 'recall': 0.88582253, 'specificity': 0.88582253, 'f1': 0.81259775, 'auroc': 0.9625292, 'binary_precision': 0.54112905, 'binary_recall': 0.806006, 'binary_specificity': 0.96563905, 'binary_f1_score': 0.64752716}
confusion matrix:
       0     1
0  31981  1138
1    323  1342
---- Validation: 
scalar performance:
{'acc': 0.95253396, 'precision': 0.74882734, 'recall': 0.87926227, 'specificity': 0.87926227, 'f1': 0.7978698, 'auroc': 0.9533489, 'binary_precision': 0.50831145, 'binary_recall': 0.7980769, 'binary_specificity': 0.9604476, 'binary_f1_score': 0.6210582}
confusion matrix:
       0    1
0  13647  562
1    147  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.986911, 'precision': 0.57502353, 'recall': 0.70794344, 'specificity': 0.70794344, 'f1': 0.60910296, 'auroc': 0.83702326, 'binary_precision': 0.15263158, 'binary_recall': 0.42647058, 'binary_specificity': 0.98941624, 'binary_f1_score': 0.22480619}
confusion matrix:
       0    1
0  15051  161
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 5
val acc:0.9525339603424072, best validation acc: 0.9600991010665894, corresponding to test acc:                         0.991950273513794 / 0.9946989417076111
after epoch: 9,now: 2024-05-28 07:58:17.451259,epoch time: 0:19:27.489010,used: 2:56:40.050990,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9638339, 'precision': 0.79696727, 'recall': 0.8272833, 'specificity': 0.8272833, 'f1': 0.8112758, 'auroc': 0.9581251, 'binary_precision': 0.6102981, 'binary_recall': 0.67627627, 'binary_specificity': 0.9782904, 'binary_f1_score': 0.6415954}
confusion matrix:
       0     1
0  32400   719
1    539  1126
---- Validation: 
scalar performance:
{'acc': 0.96036685, 'precision': 0.7848617, 'recall': 0.79671335, 'specificity': 0.79671335, 'f1': 0.7906476, 'auroc': 0.95743084, 'binary_precision': 0.58947366, 'binary_recall': 0.61538464, 'binary_specificity': 0.97804207, 'binary_f1_score': 0.60215056}
confusion matrix:
       0    1
0  13897  312
1    280  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918194, 'precision': 0.62257516, 'recall': 0.7030885, 'specificity': 0.7030885, 'f1': 0.6526388, 'auroc': 0.76041794, 'binary_precision': 0.24778761, 'binary_recall': 0.4117647, 'binary_specificity': 0.9944123, 'binary_f1_score': 0.30939227}
confusion matrix:
       0   1
0  15127  85
1     40  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
better model found
persisted
after epoch: 10,now: 2024-05-28 08:17:40.333867,epoch time: 0:19:22.882608,used: 3:16:02.933598,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96018285, 'precision': 0.77448595, 'recall': 0.87670255, 'specificity': 0.87670255, 'f1': 0.81618404, 'auroc': 0.96478146, 'binary_precision': 0.56003433, 'binary_recall': 0.78438437, 'binary_specificity': 0.9690208, 'binary_f1_score': 0.6534901}
confusion matrix:
       0     1
0  32093  1026
1    359  1306
---- Validation: 
scalar performance:
{'acc': 0.95447546, 'precision': 0.7553598, 'recall': 0.876373, 'specificity': 0.876373, 'f1': 0.8020838, 'auroc': 0.9592855, 'binary_precision': 0.5217786, 'binary_recall': 0.78983516, 'binary_specificity': 0.96291083, 'binary_f1_score': 0.6284152}
confusion matrix:
       0    1
0  13682  527
1    153  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9887435, 'precision': 0.59590065, 'recall': 0.73814404, 'specificity': 0.73814404, 'f1': 0.6358192, 'auroc': 0.8017591, 'binary_precision': 0.19411765, 'binary_recall': 0.4852941, 'binary_specificity': 0.990994, 'binary_f1_score': 0.2773109}
confusion matrix:
       0    1
0  15075  137
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.954475462436676, best validation acc: 0.9603668451309204, corresponding to test acc:                         0.9918193817138672 / 0.9946989417076111
after epoch: 11,now: 2024-05-28 08:37:08.895985,epoch time: 0:19:28.562118,used: 3:35:31.495716,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96182156, 'precision': 0.78424394, 'recall': 0.8416275, 'specificity': 0.8416275, 'f1': 0.80987775, 'auroc': 0.95787823, 'binary_precision': 0.5832921, 'binary_recall': 0.7087087, 'binary_specificity': 0.9745463, 'binary_f1_score': 0.63991326}
confusion matrix:
       0     1
0  32276   843
1    485  1180
---- Validation: 
scalar performance:
{'acc': 0.95541275, 'precision': 0.75838137, 'recall': 0.8338585, 'specificity': 0.8338585, 'f1': 0.7904438, 'auroc': 0.9517207, 'binary_precision': 0.5324268, 'binary_recall': 0.69917583, 'binary_specificity': 0.9685411, 'binary_f1_score': 0.60451305}
confusion matrix:
       0    1
0  13762  447
1    219  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98390055, 'precision': 0.5601445, 'recall': 0.70643145, 'specificity': 0.70643145, 'f1': 0.59132946, 'auroc': 0.8578104, 'binary_precision': 0.12288135, 'binary_recall': 0.42647058, 'binary_specificity': 0.9863923, 'binary_f1_score': 0.19078948}
confusion matrix:
       0    1
0  15005  207
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 2
val acc:0.955412745475769, best validation acc: 0.9603668451309204, corresponding to test acc:                         0.9918193817138672 / 0.9946989417076111
after epoch: 12,now: 2024-05-28 08:56:35.404501,epoch time: 0:19:26.508516,used: 3:54:58.004232,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9604703, 'precision': 0.7753494, 'recall': 0.88569486, 'specificity': 0.88569486, 'f1': 0.8197118, 'auroc': 0.9670325, 'binary_precision': 0.5608221, 'binary_recall': 0.803003, 'binary_specificity': 0.9683867, 'binary_f1_score': 0.66041}
confusion matrix:
       0     1
0  32072  1047
1    328  1337
---- Validation: 
scalar performance:
{'acc': 0.95487714, 'precision': 0.7571696, 'recall': 0.894178, 'specificity': 0.894178, 'f1': 0.80851626, 'auroc': 0.9605279, 'binary_precision': 0.52347827, 'binary_recall': 0.8269231, 'binary_specificity': 0.9614329, 'binary_f1_score': 0.64110756}
confusion matrix:
       0    1
0  13661  548
1    126  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9857984, 'precision': 0.57881314, 'recall': 0.7513051, 'specificity': 0.7513051, 'f1': 0.6183672, 'auroc': 0.8533912, 'binary_precision': 0.15981735, 'binary_recall': 0.5147059, 'binary_specificity': 0.9879043, 'binary_f1_score': 0.24390244}
confusion matrix:
       0    1
0  15028  184
1     33   35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 3
val acc:0.9548771381378174, best validation acc: 0.9603668451309204, corresponding to test acc:                         0.9918193817138672 / 0.9946989417076111
after epoch: 13,now: 2024-05-28 09:15:59.150494,epoch time: 0:19:23.745993,used: 4:14:21.750225,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95173067, 'precision': 0.73862225, 'recall': 0.79383314, 'specificity': 0.79383314, 'f1': 0.76284164, 'auroc': 0.9322414, 'binary_precision': 0.49662814, 'binary_recall': 0.61921924, 'binary_specificity': 0.9684471, 'binary_f1_score': 0.55118954}
confusion matrix:
       0     1
0  32074  1045
1    634  1031
---- Validation: 
scalar performance:
{'acc': 0.9509942, 'precision': 0.7392086, 'recall': 0.79699993, 'specificity': 0.79699993, 'f1': 0.7644074, 'auroc': 0.924322, 'binary_precision': 0.4978166, 'binary_recall': 0.62637365, 'binary_specificity': 0.96762615, 'binary_f1_score': 0.55474454}
confusion matrix:
       0    1
0  13749  460
1    272  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9768979, 'precision': 0.54463977, 'recall': 0.72487473, 'specificity': 0.72487473, 'f1': 0.5708832, 'auroc': 0.880682, 'binary_precision': 0.09169055, 'binary_recall': 0.47058824, 'binary_specificity': 0.9791612, 'binary_f1_score': 0.1534772}
confusion matrix:
       0    1
0  14895  317
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 4
val acc:0.9509941935539246, best validation acc: 0.9603668451309204, corresponding to test acc:                         0.9918193817138672 / 0.9946989417076111
after epoch: 14,now: 2024-05-28 09:35:31.988763,epoch time: 0:19:32.838269,used: 4:33:54.588494,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9654151, 'precision': 0.80037737, 'recall': 0.86319363, 'specificity': 0.86319363, 'f1': 0.8283443, 'auroc': 0.97259533, 'binary_precision': 0.61345774, 'binary_recall': 0.75015014, 'binary_specificity': 0.9762372, 'binary_f1_score': 0.6749527}
confusion matrix:
       0     1
0  32332   787
1    416  1249
---- Validation: 
scalar performance:
{'acc': 0.9617728, 'precision': 0.78759515, 'recall': 0.83915627, 'specificity': 0.83915627, 'f1': 0.8109073, 'auroc': 0.9613205, 'binary_precision': 0.5905421, 'binary_recall': 0.7032967, 'binary_specificity': 0.9750158, 'binary_f1_score': 0.6420063}
confusion matrix:
       0    1
0  13854  355
1    216  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99443716, 'precision': 0.67386204, 'recall': 0.6458427, 'specificity': 0.6458427, 'f1': 0.65860355, 'auroc': 0.84994984, 'binary_precision': 0.3508772, 'binary_recall': 0.29411766, 'binary_specificity': 0.9975677, 'binary_f1_score': 0.32}
confusion matrix:
       0   1
0  15175  37
1     48  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
better model found
persisted
after epoch: 15,now: 2024-05-28 09:55:02.634082,epoch time: 0:19:30.645319,used: 4:53:25.233813,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9631152, 'precision': 0.79995775, 'recall': 0.7864071, 'specificity': 0.7864071, 'f1': 0.79300284, 'auroc': 0.9389497, 'binary_precision': 0.62042874, 'binary_recall': 0.590991, 'binary_specificity': 0.98182315, 'binary_f1_score': 0.60535216}
confusion matrix:
       0    1
0  32517  602
1    681  984
---- Validation: 
scalar performance:
{'acc': 0.9566178, 'precision': 0.76419455, 'recall': 0.80582035, 'specificity': 0.80582035, 'f1': 0.7832264, 'auroc': 0.9425949, 'binary_precision': 0.5470588, 'binary_recall': 0.63873625, 'binary_specificity': 0.9729045, 'binary_f1_score': 0.5893536}
confusion matrix:
       0    1
0  13824  385
1    263  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9914267, 'precision': 0.6163279, 'recall': 0.7028913, 'specificity': 0.7028913, 'f1': 0.6475761, 'auroc': 0.8481201, 'binary_precision': 0.23529412, 'binary_recall': 0.4117647, 'binary_specificity': 0.9940179, 'binary_f1_score': 0.29946524}
confusion matrix:
       0   1
0  15121  91
1     40  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.9566177725791931, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 16,now: 2024-05-28 10:14:36.665884,epoch time: 0:19:34.031802,used: 5:12:59.265615,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96193653, 'precision': 0.7946048, 'recall': 0.7726687, 'specificity': 0.7726687, 'f1': 0.7831503, 'auroc': 0.9367064, 'binary_precision': 0.6110749, 'binary_recall': 0.5633634, 'binary_specificity': 0.98197407, 'binary_f1_score': 0.58625007}
confusion matrix:
       0    1
0  32522  597
1    727  938
---- Validation: 
scalar performance:
{'acc': 0.95809066, 'precision': 0.7738892, 'recall': 0.7753166, 'specificity': 0.7753166, 'f1': 0.77460074, 'auroc': 0.9460085, 'binary_precision': 0.5696721, 'binary_recall': 0.5728022, 'binary_specificity': 0.97783095, 'binary_f1_score': 0.57123286}
confusion matrix:
       0    1
0  13894  315
1    311  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99293196, 'precision': 0.63224006, 'recall': 0.6670469, 'specificity': 0.6670469, 'f1': 0.6475747, 'auroc': 0.8070005, 'binary_precision': 0.26744187, 'binary_recall': 0.3382353, 'binary_specificity': 0.99585855, 'binary_f1_score': 0.29870132}
confusion matrix:
       0   1
0  15149  63
1     45  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 2
val acc:0.9580906629562378, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 17,now: 2024-05-28 10:34:41.031352,epoch time: 0:20:04.365468,used: 5:33:03.631083,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96182156, 'precision': 0.78481627, 'recall': 0.8356383, 'specificity': 0.8356383, 'f1': 0.80781007, 'auroc': 0.9548651, 'binary_precision': 0.58505803, 'binary_recall': 0.6960961, 'binary_specificity': 0.9751804, 'binary_f1_score': 0.63576525}
confusion matrix:
       0     1
0  32297   822
1    506  1159
---- Validation: 
scalar performance:
{'acc': 0.95795673, 'precision': 0.768998, 'recall': 0.8475765, 'specificity': 0.8475765, 'f1': 0.80240047, 'auroc': 0.94985306, 'binary_precision': 0.5523012, 'binary_recall': 0.72527474, 'binary_specificity': 0.96987826, 'binary_f1_score': 0.62707835}
confusion matrix:
       0    1
0  13781  428
1    200  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99319375, 'precision': 0.6414094, 'recall': 0.67449844, 'specificity': 0.67449844, 'f1': 0.6561847, 'auroc': 0.8592979, 'binary_precision': 0.2857143, 'binary_recall': 0.3529412, 'binary_specificity': 0.9960557, 'binary_f1_score': 0.3157895}
confusion matrix:
       0   1
0  15152  60
1     44  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 3
val acc:0.9579567313194275, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 18,now: 2024-05-28 10:54:35.212305,epoch time: 0:19:54.180953,used: 5:52:57.812036,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9617065, 'precision': 0.783026, 'recall': 0.84898245, 'specificity': 0.84898245, 'f1': 0.81199753, 'auroc': 0.9652345, 'binary_precision': 0.5800866, 'binary_recall': 0.72432435, 'binary_specificity': 0.9736405, 'binary_f1_score': 0.6442308}
confusion matrix:
       0     1
0  32246   873
1    459  1206
---- Validation: 
scalar performance:
{'acc': 0.95641696, 'precision': 0.7625835, 'recall': 0.83829606, 'specificity': 0.83829606, 'f1': 0.79481983, 'auroc': 0.94833946, 'binary_precision': 0.5403987, 'binary_recall': 0.7074176, 'binary_specificity': 0.96917444, 'binary_f1_score': 0.6127305}
confusion matrix:
       0    1
0  13771  438
1    213  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.61944443, 'recall': 0.746483, 'specificity': 0.746483, 'f1': 0.6603566, 'auroc': 0.8499859, 'binary_precision': 0.24113475, 'binary_recall': 0.5, 'binary_specificity': 0.99296606, 'binary_f1_score': 0.32535884}
confusion matrix:
       0    1
0  15105  107
1     34   34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 4
val acc:0.9564169645309448, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 19,now: 2024-05-28 11:14:40.726737,epoch time: 0:20:05.514432,used: 6:13:03.326468,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9609591, 'precision': 0.77802813, 'recall': 0.87197655, 'specificity': 0.87197655, 'f1': 0.8170569, 'auroc': 0.968629, 'binary_precision': 0.567651, 'binary_recall': 0.7735736, 'binary_specificity': 0.97037953, 'binary_f1_score': 0.6548043}
confusion matrix:
       0     1
0  32138   981
1    377  1288
---- Validation: 
scalar performance:
{'acc': 0.95347124, 'precision': 0.75083935, 'recall': 0.8439156, 'specificity': 0.8439156, 'f1': 0.7887329, 'auroc': 0.9535122, 'binary_precision': 0.5161923, 'binary_recall': 0.72252744, 'binary_specificity': 0.96530366, 'binary_f1_score': 0.6021752}
confusion matrix:
       0    1
0  13716  493
1    202  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99136126, 'precision': 0.6003359, 'recall': 0.658938, 'specificity': 0.658938, 'f1': 0.62282777, 'auroc': 0.79787123, 'binary_precision': 0.2037037, 'binary_recall': 0.32352942, 'binary_specificity': 0.99434656, 'binary_f1_score': 0.25}
confusion matrix:
       0   1
0  15126  86
1     46  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 5
val acc:0.9534712433815002, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 20,now: 2024-05-28 11:34:17.135082,epoch time: 0:19:36.408345,used: 6:32:39.734813,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96041286, 'precision': 0.7743396, 'recall': 0.9124738, 'specificity': 0.9124738, 'f1': 0.8270406, 'auroc': 0.9742948, 'binary_precision': 0.5559441, 'binary_recall': 0.85945946, 'binary_specificity': 0.9654881, 'binary_f1_score': 0.6751592}
confusion matrix:
       0     1
0  31976  1143
1    234  1431
---- Validation: 
scalar performance:
{'acc': 0.95541275, 'precision': 0.7588498, 'recall': 0.88533676, 'specificity': 0.88533676, 'f1': 0.80733895, 'auroc': 0.95378184, 'binary_precision': 0.5278276, 'binary_recall': 0.8076923, 'binary_specificity': 0.9629812, 'binary_f1_score': 0.6384365}
confusion matrix:
       0    1
0  13683  526
1    140  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9838351, 'precision': 0.566183, 'recall': 0.7356789, 'specificity': 0.7356789, 'f1': 0.6013482, 'auroc': 0.7860638, 'binary_precision': 0.13469388, 'binary_recall': 0.4852941, 'binary_specificity': 0.98606366, 'binary_f1_score': 0.2108626}
confusion matrix:
       0    1
0  15000  212
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 6
val acc:0.955412745475769, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 21,now: 2024-05-28 11:53:47.980364,epoch time: 0:19:30.845282,used: 6:52:10.580095,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96041286, 'precision': 0.7741786, 'recall': 0.92017424, 'specificity': 0.92017424, 'f1': 0.829075, 'auroc': 0.97346866, 'binary_precision': 0.55479455, 'binary_recall': 0.8756757, 'binary_specificity': 0.96467286, 'binary_f1_score': 0.6792453}
confusion matrix:
       0     1
0  31949  1170
1    207  1458
---- Validation: 
scalar performance:
{'acc': 0.9516637, 'precision': 0.7461641, 'recall': 0.88271457, 'specificity': 0.88271457, 'f1': 0.7966962, 'auroc': 0.9563961, 'binary_precision': 0.5025685, 'binary_recall': 0.8063187, 'binary_specificity': 0.95911044, 'binary_f1_score': 0.6191983}
confusion matrix:
       0    1
0  13628  581
1    141  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.983966, 'precision': 0.5651932, 'recall': 0.72842455, 'specificity': 0.72842455, 'f1': 0.59951043, 'auroc': 0.81933, 'binary_precision': 0.13278009, 'binary_recall': 0.47058824, 'binary_specificity': 0.98626083, 'binary_f1_score': 0.20711975}
confusion matrix:
       0    1
0  15003  209
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 7
val acc:0.9516636729240417, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 22,now: 2024-05-28 12:13:15.390686,epoch time: 0:19:27.410322,used: 7:11:37.990417,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96440893, 'precision': 0.79227865, 'recall': 0.8897596, 'specificity': 0.8897596, 'f1': 0.83290327, 'auroc': 0.97051734, 'binary_precision': 0.5944272, 'binary_recall': 0.8072072, 'binary_specificity': 0.972312, 'binary_f1_score': 0.68466634}
confusion matrix:
       0     1
0  32202   917
1    321  1344
---- Validation: 
scalar performance:
{'acc': 0.9612372, 'precision': 0.78295004, 'recall': 0.8616816, 'specificity': 0.8616816, 'f1': 0.816692, 'auroc': 0.9554316, 'binary_precision': 0.57883596, 'binary_recall': 0.75137365, 'binary_specificity': 0.9719896, 'binary_f1_score': 0.6539151}
confusion matrix:
       0    1
0  13811  398
1    181  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918194, 'precision': 0.60739565, 'recall': 0.65916806, 'specificity': 0.65916806, 'f1': 0.62812096, 'auroc': 0.76369977, 'binary_precision': 0.21782178, 'binary_recall': 0.32352942, 'binary_specificity': 0.9948067, 'binary_f1_score': 0.26035503}
confusion matrix:
       0   1
0  15133  79
1     46  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 8
val acc:0.9612371921539307, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 23,now: 2024-05-28 12:32:39.760174,epoch time: 0:19:24.369488,used: 7:31:02.359905,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95713544, 'precision': 0.76229954, 'recall': 0.86198294, 'specificity': 0.86198294, 'f1': 0.80276436, 'auroc': 0.9640539, 'binary_precision': 0.5370844, 'binary_recall': 0.7567568, 'binary_specificity': 0.96720916, 'binary_f1_score': 0.6282723}
confusion matrix:
       0     1
0  32033  1086
1    405  1260
---- Validation: 
scalar performance:
{'acc': 0.9515967, 'precision': 0.7447781, 'recall': 0.8598725, 'specificity': 0.8598725, 'f1': 0.7892456, 'auroc': 0.95202065, 'binary_precision': 0.5022748, 'binary_recall': 0.7582418, 'binary_specificity': 0.96150327, 'binary_f1_score': 0.6042693}
confusion matrix:
       0    1
0  13662  547
1    176  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741492, 'precision': 0.5408092, 'recall': 0.7308143, 'specificity': 0.7308143, 'f1': 0.5650218, 'auroc': 0.8489053, 'binary_precision': 0.08396947, 'binary_recall': 0.4852941, 'binary_specificity': 0.97633445, 'binary_f1_score': 0.14316702}
confusion matrix:
       0    1
0  14852  360
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 9
val acc:0.9515966773033142, best validation acc: 0.9617727994918823, corresponding to test acc:                         0.9944371581077576 / 0.9946989417076111
after epoch: 24,now: 2024-05-28 12:52:23.844126,epoch time: 0:19:44.083952,used: 7:50:46.443857,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96705383, 'precision': 0.80672437, 'recall': 0.8788848, 'specificity': 0.8788848, 'f1': 0.83841294, 'auroc': 0.97220373, 'binary_precision': 0.6245799, 'binary_recall': 0.78138137, 'binary_specificity': 0.97638816, 'binary_f1_score': 0.69423693}
confusion matrix:
       0     1
0  32337   782
1    364  1301
---- Validation: 
scalar performance:
{'acc': 0.962777, 'precision': 0.7933165, 'recall': 0.83577436, 'specificity': 0.83577436, 'f1': 0.81288284, 'auroc': 0.94817734, 'binary_precision': 0.60238093, 'binary_recall': 0.69505495, 'binary_specificity': 0.9764938, 'binary_f1_score': 0.64540815}
confusion matrix:
       0    1
0  13875  334
1    222  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905759, 'precision': 0.58462423, 'recall': 0.64390343, 'specificity': 0.64390343, 'f1': 0.6063253, 'auroc': 0.7704064, 'binary_precision': 0.1724138, 'binary_recall': 0.29411766, 'binary_specificity': 0.9936892, 'binary_f1_score': 0.2173913}
confusion matrix:
       0   1
0  15116  96
1     48  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
better model found
persisted
after epoch: 25,now: 2024-05-28 13:14:08.736211,epoch time: 0:21:44.892085,used: 8:12:31.335942,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9530244, 'precision': 0.7484076, 'recall': 0.89433366, 'specificity': 0.89433366, 'f1': 0.80161315, 'auroc': 0.97343326, 'binary_precision': 0.50567555, 'binary_recall': 0.82942945, 'binary_specificity': 0.9592379, 'binary_f1_score': 0.62829846}
confusion matrix:
       0     1
0  31769  1350
1    284  1381
---- Validation: 
scalar performance:
{'acc': 0.9491196, 'precision': 0.73813874, 'recall': 0.88007414, 'specificity': 0.88007414, 'f1': 0.78951013, 'auroc': 0.961925, 'binary_precision': 0.48668885, 'binary_recall': 0.8035714, 'binary_specificity': 0.9565768, 'binary_f1_score': 0.60621756}
confusion matrix:
       0    1
0  13592  617
1    143  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9795812, 'precision': 0.5583723, 'recall': 0.7701428, 'specificity': 0.7701428, 'f1': 0.59276783, 'auroc': 0.87416625, 'binary_precision': 0.11875, 'binary_recall': 0.5588235, 'binary_specificity': 0.981462, 'binary_f1_score': 0.1958763}
confusion matrix:
       0    1
0  14930  282
1     30   38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.9491196274757385, best validation acc: 0.9627770185470581, corresponding to test acc:                         0.990575909614563 / 0.9946989417076111
after epoch: 26,now: 2024-05-28 13:33:36.284598,epoch time: 0:19:27.548387,used: 8:31:58.884329,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9710212, 'precision': 0.82743317, 'recall': 0.8869574, 'specificity': 0.8869574, 'f1': 0.85434735, 'auroc': 0.9781436, 'binary_precision': 0.6653246, 'binary_recall': 0.793994, 'binary_specificity': 0.97992086, 'binary_f1_score': 0.72398686}
confusion matrix:
       0     1
0  32454   665
1    343  1322
---- Validation: 
scalar performance:
{'acc': 0.9629778, 'precision': 0.7927025, 'recall': 0.84891236, 'specificity': 0.84891236, 'f1': 0.8179448, 'auroc': 0.95353425, 'binary_precision': 0.599772, 'binary_recall': 0.72252744, 'binary_specificity': 0.97529733, 'binary_f1_score': 0.6554517}
confusion matrix:
       0    1
0  13858  351
1    202  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99162304, 'precision': 0.595325, 'recall': 0.6371092, 'specificity': 0.6371092, 'f1': 0.61235213, 'auroc': 0.7805518, 'binary_precision': 0.19387755, 'binary_recall': 0.27941176, 'binary_specificity': 0.9948067, 'binary_f1_score': 0.22891566}
confusion matrix:
       0   1
0  15133  79
1     49  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
better model found
persisted
after epoch: 27,now: 2024-05-28 13:53:13.993671,epoch time: 0:19:37.709073,used: 8:51:36.593402,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96213776, 'precision': 0.78432214, 'recall': 0.8586206, 'specificity': 0.8586206, 'f1': 0.8164705, 'auroc': 0.97043693, 'binary_precision': 0.58169013, 'binary_recall': 0.74414414, 'binary_specificity': 0.973097, 'binary_f1_score': 0.6529644}
confusion matrix:
       0     1
0  32228   891
1    426  1239
---- Validation: 
scalar performance:
{'acc': 0.95708644, 'precision': 0.765144, 'recall': 0.85624176, 'specificity': 0.85624176, 'f1': 0.802817, 'auroc': 0.9566593, 'binary_precision': 0.5436309, 'binary_recall': 0.74450547, 'binary_specificity': 0.96797806, 'binary_f1_score': 0.62840575}
confusion matrix:
       0    1
0  13754  455
1    186  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98291886, 'precision': 0.56825596, 'recall': 0.76449895, 'specificity': 0.76449895, 'f1': 0.6061301, 'auroc': 0.85071164, 'binary_precision': 0.13857678, 'binary_recall': 0.5441176, 'binary_specificity': 0.9848803, 'binary_f1_score': 0.2208955}
confusion matrix:
       0    1
0  14982  230
1     31   37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 1
val acc:0.957086443901062, best validation acc: 0.9629778265953064, corresponding to test acc:                         0.991623044013977 / 0.9946989417076111
after epoch: 28,now: 2024-05-28 14:13:40.220093,epoch time: 0:20:26.226422,used: 9:12:02.819824,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9672263, 'precision': 0.8261502, 'recall': 0.80111486, 'specificity': 0.80111486, 'f1': 0.8130641, 'auroc': 0.96155, 'binary_precision': 0.6714566, 'binary_recall': 0.6174174, 'binary_specificity': 0.9848123, 'binary_f1_score': 0.6433041}
confusion matrix:
       0     1
0  32616   503
1    637  1028
---- Validation: 
scalar performance:
{'acc': 0.9602999, 'precision': 0.7829385, 'recall': 0.8097106, 'specificity': 0.8097106, 'f1': 0.795622, 'auroc': 0.95483094, 'binary_precision': 0.58426964, 'binary_recall': 0.64285713, 'binary_specificity': 0.97656417, 'binary_f1_score': 0.6121648}
confusion matrix:
       0    1
0  13876  333
1    260  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.986911, 'precision': 0.5692611, 'recall': 0.6859832, 'specificity': 0.6859832, 'f1': 0.59987515, 'auroc': 0.84281397, 'binary_precision': 0.14130434, 'binary_recall': 0.38235295, 'binary_specificity': 0.9896135, 'binary_f1_score': 0.20634918}
confusion matrix:
       0    1
0  15054  158
1     42   26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 2
val acc:0.9602999091148376, best validation acc: 0.9629778265953064, corresponding to test acc:                         0.991623044013977 / 0.9946989417076111
after epoch: 29,now: 2024-05-28 14:36:23.518811,epoch time: 0:22:43.298718,used: 9:34:46.118542,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9683475, 'precision': 0.8105886, 'recall': 0.8972467, 'specificity': 0.8972467, 'f1': 0.84777987, 'auroc': 0.9810016, 'binary_precision': 0.6304348, 'binary_recall': 0.8186186, 'binary_specificity': 0.9758749, 'binary_f1_score': 0.71230733}
confusion matrix:
       0     1
0  32320   799
1    302  1363
---- Validation: 
scalar performance:
{'acc': 0.9591618, 'precision': 0.773939, 'recall': 0.8560294, 'specificity': 0.8560294, 'f1': 0.80870485, 'auroc': 0.9581516, 'binary_precision': 0.56133056, 'binary_recall': 0.7417582, 'binary_specificity': 0.9703005, 'binary_f1_score': 0.6390532}
confusion matrix:
       0    1
0  13787  422
1    188  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910995, 'precision': 0.6137926, 'recall': 0.710047, 'specificity': 0.710047, 'f1': 0.64724517, 'auroc': 0.84487766, 'binary_precision': 0.23015873, 'binary_recall': 0.42647058, 'binary_specificity': 0.99362344, 'binary_f1_score': 0.29896906}
confusion matrix:
       0   1
0  15115  97
1     39  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897891.png
early stop counter: 3
val acc:0.9591618180274963, best validation acc: 0.9629778265953064, corresponding to test acc:                         0.991623044013977 / 0.9946989417076111
after epoch: 30,now: 2024-05-28 14:56:42.034383,epoch time: 0:20:18.515572,used: 9:55:04.634114,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_05_01_37_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:55:04.634114 at 2024-05-28 14:56:42.034383
persisted model performance metric: 

scalar performance:
{'acc': 0.99149215, 'precision': 0.6076407, 'recall': 0.6736439, 'specificity': 0.6736439, 'f1': 0.63269204, 'auroc': 0.79276377, 'binary_precision': 0.21818182, 'binary_recall': 0.3529412, 'binary_specificity': 0.99434656, 'binary_f1_score': 0.26966292}
confusion matrix:
       0   1
0  15126  86
1     44  24
oracle model performance metric: 

scalar performance:
{'acc': 0.9941754, 'precision': 0.5195434, 'recall': 0.5066298, 'specificity': 0.5066298, 'f1': 0.5095285, 'auroc': 0.8088716, 'binary_precision': 0.04347826, 'binary_recall': 0.014705882, 'binary_specificity': 0.99855375, 'binary_f1_score': 0.021978023}
confusion matrix:
       0   1
0  15190  22
1     67   1
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498548 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |  91508 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 498548 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |  91508 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476996 KiB |  10962 MiB |   3210 TiB |   3210 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   3205 TiB |   3205 TiB |
|       from small pool |  89156 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11392 MiB |  11392 MiB |  20792 MiB |   9400 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    126 MiB |    126 MiB |    154 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1483 MiB |   2595 MiB |   1075 TiB |   1075 TiB |
|       from large pool |   1472 MiB |   2593 MiB |   1068 TiB |   1068 TiB |
|       from small pool |     10 MiB |     24 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    7107    |    7764    |  264876 K  |  264869 K  |
|       from large pool |      87    |     909    |  125559 K  |  125559 K  |
|       from small pool |    7020    |    7642    |  139316 K  |  139309 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    7107    |    7764    |  264876 K  |  264869 K  |
|       from large pool |      87    |     909    |  125559 K  |  125559 K  |
|       from small pool |    7020    |    7642    |  139316 K  |  139309 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     388    |     153    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      63    |      63    |      77    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2768    |  139798 K  |  139798 K  |
|       from large pool |      24    |      65    |   65493 K  |   65493 K  |
|       from small pool |      48    |    2747    |   74304 K  |   74304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   3210 TiB |   3210 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3205 TiB |   3205 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1970 MiB |  11392 MiB |  20792 MiB |  18822 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    100 MiB |    126 MiB |    154 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1075 TiB |   1075 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     31 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  264876 K  |  264876 K  |
|       from large pool |       2    |     909    |  125559 K  |  125559 K  |
|       from small pool |       0    |    7642    |  139316 K  |  139316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  264876 K  |  264876 K  |
|       from large pool |       2    |     909    |  125559 K  |  125559 K  |
|       from small pool |       0    |    7642    |  139316 K  |  139316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      85    |     235    |     388    |     303    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      50    |      63    |      77    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  139801 K  |  139801 K  |
|       from large pool |       4    |      65    |   65493 K  |   65493 K  |
|       from small pool |       0    |    2747    |   74307 K  |   74307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3224 TiB |   3224 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3219 TiB |   3219 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   3210 TiB |   3210 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3205 TiB |   3205 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1970 MiB |  11392 MiB |  20792 MiB |  18822 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    100 MiB |    126 MiB |    154 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1075 TiB |   1075 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     31 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  264876 K  |  264876 K  |
|       from large pool |       2    |     909    |  125559 K  |  125559 K  |
|       from small pool |       0    |    7642    |  139316 K  |  139316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  264876 K  |  264876 K  |
|       from large pool |       2    |     909    |  125559 K  |  125559 K  |
|       from small pool |       0    |    7642    |  139316 K  |  139316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      85    |     235    |     388    |     303    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      50    |      63    |      77    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  139801 K  |  139801 K  |
|       from large pool |       4    |      65    |   65493 K  |   65493 K  |
|       from small pool |       0    |    2747    |   74307 K  |   74307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891

 Experiment start at: 2024-05-28 15:08:31.760249
before training, model accuracy: 0.6810094714164734
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9720561, 'precision': 0.8065213, 'recall': 0.70036334, 'specificity': 0.70036334, 'f1': 0.74134254, 'auroc': 0.9414284, 'binary_precision': 0.6334405, 'binary_recall': 0.40899655, 'binary_specificity': 0.99173015, 'binary_f1_score': 0.49705637}
confusion matrix:
       0    1
0  41013  342
1    854  591
---- Validation: 
scalar performance:
{'acc': 0.96935433, 'precision': 0.7804467, 'recall': 0.7241132, 'specificity': 0.7241132, 'f1': 0.74881107, 'auroc': 0.9426732, 'binary_precision': 0.5803922, 'binary_recall': 0.46034214, 'binary_specificity': 0.9878843, 'binary_f1_score': 0.51344323}
confusion matrix:
       0    1
0  17449  214
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9573852, 'precision': 0.653198, 'recall': 0.536771, 'specificity': 0.536771, 'f1': 0.5538677, 'auroc': 0.8667069, 'binary_precision': 0.3432836, 'binary_recall': 0.07986111, 'binary_specificity': 0.9936809, 'binary_f1_score': 0.12957747}
confusion matrix:
      0   1
0  6919  44
1   265  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 15:30:12.111110,epoch time: 0:21:40.350861,used: 0:21:40.350861,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9712617, 'precision': 0.78218305, 'recall': 0.76139545, 'specificity': 0.76139545, 'f1': 0.7713512, 'auroc': 0.94969773, 'binary_precision': 0.5805243, 'binary_recall': 0.5363322, 'binary_specificity': 0.9864587, 'binary_f1_score': 0.55755395}
confusion matrix:
       0    1
0  40795  560
1    670  775
---- Validation: 
scalar performance:
{'acc': 0.96935433, 'precision': 0.7834884, 'recall': 0.70837796, 'specificity': 0.70837796, 'f1': 0.73962355, 'auroc': 0.9488956, 'binary_precision': 0.58760685, 'binary_recall': 0.42768273, 'binary_specificity': 0.9890732, 'binary_f1_score': 0.49504954}
confusion matrix:
       0    1
0  17470  193
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96166044, 'precision': 0.8096321, 'recall': 0.53566843, 'specificity': 0.53566843, 'f1': 0.5558238, 'auroc': 0.8581492, 'binary_precision': 0.65625, 'binary_recall': 0.072916664, 'binary_specificity': 0.99842024, 'binary_f1_score': 0.13125}
confusion matrix:
      0   1
0  6952  11
1   267  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
new oracle model saved
early stop counter: 1
val acc:0.9693543314933777, best validation acc: 0.9693543314933777, corresponding to test acc:                         0.9573851823806763 / 0.9616604447364807
after epoch: 2,now: 2024-05-28 15:48:44.412005,epoch time: 0:18:32.300895,used: 0:40:12.651756,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97471964, 'precision': 0.8060374, 'recall': 0.8072636, 'specificity': 0.8072636, 'f1': 0.8066492, 'auroc': 0.95902646, 'binary_precision': 0.6250861, 'binary_recall': 0.6276817, 'binary_specificity': 0.9868456, 'binary_f1_score': 0.6263812}
confusion matrix:
       0    1
0  40811  544
1    538  907
---- Validation: 
scalar performance:
{'acc': 0.9772206, 'precision': 0.8431883, 'recall': 0.80236995, 'specificity': 0.80236995, 'f1': 0.8213687, 'auroc': 0.9601886, 'binary_precision': 0.70035464, 'binary_recall': 0.61430794, 'binary_specificity': 0.99043196, 'binary_f1_score': 0.6545153}
confusion matrix:
       0    1
0  17494  169
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.74600005, 'recall': 0.53010106, 'specificity': 0.53010106, 'f1': 0.54581594, 'auroc': 0.8391818, 'binary_precision': 0.5294118, 'binary_recall': 0.0625, 'binary_specificity': 0.9977021, 'binary_f1_score': 0.111801244}
confusion matrix:
      0   1
0  6947  16
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
better model found
persisted
after epoch: 3,now: 2024-05-28 16:06:29.562219,epoch time: 0:17:45.150214,used: 0:57:57.801970,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97014016, 'precision': 0.76931816, 'recall': 0.7940718, 'specificity': 0.7940718, 'f1': 0.7810917, 'auroc': 0.96245086, 'binary_precision': 0.55246526, 'binary_recall': 0.6052632, 'binary_specificity': 0.98288035, 'binary_f1_score': 0.5776603}
confusion matrix:
       0    1
0  40648  708
1    570  874
---- Validation: 
scalar performance:
{'acc': 0.96858954, 'precision': 0.76780176, 'recall': 0.7754184, 'specificity': 0.7754184, 'f1': 0.7715506, 'auroc': 0.9562422, 'binary_precision': 0.55135953, 'binary_recall': 0.5676516, 'binary_specificity': 0.9831852, 'binary_f1_score': 0.55938697}
confusion matrix:
       0    1
0  17366  297
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.7595291, 'recall': 0.5419666, 'specificity': 0.5419666, 'f1': 0.5650885, 'auroc': 0.8802035, 'binary_precision': 0.5555556, 'binary_recall': 0.08680555, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.15015014}
confusion matrix:
      0   1
0  6943  20
1   263  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 1
val acc:0.9685895442962646, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9616604447364807
after epoch: 4,now: 2024-05-28 16:24:11.490706,epoch time: 0:17:41.928487,used: 1:15:39.730457,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9713084, 'precision': 0.77520466, 'recall': 0.83354855, 'specificity': 0.83354855, 'f1': 0.80127037, 'auroc': 0.9670466, 'binary_precision': 0.5614731, 'binary_recall': 0.6858131, 'binary_specificity': 0.981284, 'binary_f1_score': 0.61744547}
confusion matrix:
       0    1
0  40581  774
1    454  991
---- Validation: 
scalar performance:
{'acc': 0.9717033, 'precision': 0.78708726, 'recall': 0.8204912, 'specificity': 0.8204912, 'f1': 0.80276936, 'auroc': 0.9611604, 'binary_precision': 0.5866852, 'binary_recall': 0.6578538, 'binary_specificity': 0.98312855, 'binary_f1_score': 0.6202346}
confusion matrix:
       0    1
0  17365  298
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.74995315, 'recall': 0.5970322, 'specificity': 0.5970322, 'f1': 0.63613474, 'auroc': 0.89433247, 'binary_precision': 0.5321101, 'binary_recall': 0.2013889, 'binary_specificity': 0.99267554, 'binary_f1_score': 0.29219145}
confusion matrix:
      0   1
0  6912  51
1   230  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 2
val acc:0.971703290939331, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9616604447364807
after epoch: 5,now: 2024-05-28 16:42:24.367392,epoch time: 0:18:12.876686,used: 1:33:52.607143,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9715654, 'precision': 0.77699447, 'recall': 0.831568, 'specificity': 0.831568, 'f1': 0.8015649, 'auroc': 0.9660434, 'binary_precision': 0.5651924, 'binary_recall': 0.6814405, 'binary_specificity': 0.98169553, 'binary_f1_score': 0.61789644}
confusion matrix:
       0    1
0  40599  757
1    460  984
---- Validation: 
scalar performance:
{'acc': 0.97164863, 'precision': 0.7855491, 'recall': 0.8302038, 'specificity': 0.8302038, 'f1': 0.8060758, 'auroc': 0.96516097, 'binary_precision': 0.5828877, 'binary_recall': 0.67807156, 'binary_specificity': 0.982336, 'binary_f1_score': 0.62688714}
confusion matrix:
       0    1
0  17351  312
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96262586, 'precision': 0.79453766, 'recall': 0.57278574, 'specificity': 0.57278574, 'f1': 0.6108688, 'auroc': 0.85603917, 'binary_precision': 0.6231884, 'binary_recall': 0.14930555, 'binary_specificity': 0.99626595, 'binary_f1_score': 0.24089634}
confusion matrix:
      0   1
0  6937  26
1   245  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
new oracle model saved
early stop counter: 3
val acc:0.971648633480072, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9626258611679077
after epoch: 6,now: 2024-05-28 17:01:15.346164,epoch time: 0:18:50.978772,used: 1:52:43.585915,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9733645, 'precision': 0.78816235, 'recall': 0.8485391, 'specificity': 0.8485391, 'f1': 0.8151796, 'auroc': 0.9681047, 'binary_precision': 0.5863636, 'binary_recall': 0.71468145, 'binary_specificity': 0.9823967, 'binary_f1_score': 0.6441947}
confusion matrix:
       0     1
0  40628   728
1    412  1032
---- Validation: 
scalar performance:
{'acc': 0.9694636, 'precision': 0.7687499, 'recall': 0.87927437, 'specificity': 0.87927437, 'f1': 0.8134307, 'auroc': 0.9696669, 'binary_precision': 0.54555315, 'binary_recall': 0.7822706, 'binary_specificity': 0.97627807, 'binary_f1_score': 0.6428115}
confusion matrix:
       0    1
0  17244  419
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.8027383, 'recall': 0.5305319, 'specificity': 0.5305319, 'f1': 0.54709315, 'auroc': 0.78733677, 'binary_precision': 0.64285713, 'binary_recall': 0.0625, 'binary_specificity': 0.9985638, 'binary_f1_score': 0.11392405}
confusion matrix:
      0   1
0  6953  10
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 4
val acc:0.969463586807251, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9626258611679077
after epoch: 7,now: 2024-05-28 17:19:38.168977,epoch time: 0:18:22.822813,used: 2:11:06.408728,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.82194877, 'recall': 0.7616712, 'specificity': 0.7616712, 'f1': 0.78841555, 'auroc': 0.9616655, 'binary_precision': 0.66008586, 'binary_recall': 0.53291756, 'binary_specificity': 0.9904248, 'binary_f1_score': 0.58972394}
confusion matrix:
       0    1
0  40961  396
1    674  769
---- Validation: 
scalar performance:
{'acc': 0.9732328, 'precision': 0.8072643, 'recall': 0.7823204, 'specificity': 0.7823204, 'f1': 0.7942115, 'auroc': 0.95700884, 'binary_precision': 0.62988114, 'binary_recall': 0.5769829, 'binary_specificity': 0.98765785, 'binary_f1_score': 0.6022727}
confusion matrix:
       0    1
0  17445  218
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.79393786, 'recall': 0.5338605, 'specificity': 0.5338605, 'f1': 0.55262834, 'auroc': 0.88744247, 'binary_precision': 0.625, 'binary_recall': 0.06944445, 'binary_specificity': 0.9982766, 'binary_f1_score': 0.12500001}
confusion matrix:
      0   1
0  6951  12
1   268  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 5
val acc:0.9732328057289124, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9626258611679077
after epoch: 8,now: 2024-05-28 17:40:13.998715,epoch time: 0:20:35.829738,used: 2:31:42.238466,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9752103, 'precision': 0.8272598, 'recall': 0.75609225, 'specificity': 0.75609225, 'f1': 0.7869495, 'auroc': 0.96686447, 'binary_precision': 0.67112297, 'binary_recall': 0.52110726, 'binary_specificity': 0.99107724, 'binary_f1_score': 0.586677}
confusion matrix:
       0    1
0  40986  369
1    692  753
---- Validation: 
scalar performance:
{'acc': 0.9736152, 'precision': 0.81300294, 'recall': 0.77577484, 'specificity': 0.77577484, 'f1': 0.7930961, 'auroc': 0.9653146, 'binary_precision': 0.641844, 'binary_recall': 0.562986, 'binary_specificity': 0.98856366, 'binary_f1_score': 0.5998344}
confusion matrix:
       0    1
0  17461  202
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622121, 'precision': 0.8482482, 'recall': 0.53761995, 'specificity': 0.53761995, 'f1': 0.5595236, 'auroc': 0.9143574, 'binary_precision': 0.73333335, 'binary_recall': 0.07638889, 'binary_specificity': 0.99885106, 'binary_f1_score': 0.13836478}
confusion matrix:
      0   1
0  6955   8
1   266  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 6
val acc:0.9736152291297913, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9626258611679077
after epoch: 9,now: 2024-05-28 17:59:29.982290,epoch time: 0:19:15.983575,used: 2:50:58.222041,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678972, 'precision': 0.7537937, 'recall': 0.8394638, 'specificity': 0.8394638, 'f1': 0.7897022, 'auroc': 0.97116315, 'binary_precision': 0.51814, 'binary_recall': 0.70173013, 'binary_specificity': 0.9771974, 'binary_f1_score': 0.59612}
confusion matrix:
       0     1
0  40412   943
1    431  1014
---- Validation: 
scalar performance:
{'acc': 0.9609964, 'precision': 0.72641534, 'recall': 0.83817106, 'specificity': 0.83817106, 'f1': 0.7696984, 'auroc': 0.9569334, 'binary_precision': 0.4637385, 'binary_recall': 0.7060653, 'binary_specificity': 0.97027683, 'binary_f1_score': 0.55980265}
confusion matrix:
       0    1
0  17138  525
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9630396, 'precision': 0.8045089, 'recall': 0.5763298, 'specificity': 0.5763298, 'f1': 0.61622435, 'auroc': 0.9180194, 'binary_precision': 0.64285713, 'binary_recall': 0.15625, 'binary_specificity': 0.9964096, 'binary_f1_score': 0.25139666}
confusion matrix:
      0   1
0  6938  25
1   243  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
new oracle model saved
early stop counter: 7
val acc:0.9609963893890381, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 10,now: 2024-05-28 18:17:51.037841,epoch time: 0:18:21.055551,used: 3:09:19.277592,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9725, 'precision': 0.7859604, 'recall': 0.8127936, 'specificity': 0.8127936, 'f1': 0.79871225, 'auroc': 0.9598044, 'binary_precision': 0.5844893, 'binary_recall': 0.64152247, 'binary_specificity': 0.9840648, 'binary_f1_score': 0.6116793}
confusion matrix:
       0    1
0  40696  659
1    518  927
---- Validation: 
scalar performance:
{'acc': 0.97061074, 'precision': 0.7782012, 'recall': 0.8311645, 'specificity': 0.8311645, 'f1': 0.8021171, 'auroc': 0.95278966, 'binary_precision': 0.56809336, 'binary_recall': 0.68118197, 'binary_specificity': 0.98114705, 'binary_f1_score': 0.6195191}
confusion matrix:
       0    1
0  17330  333
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96262586, 'precision': 0.8266121, 'recall': 0.5528141, 'specificity': 0.5528141, 'f1': 0.58352995, 'auroc': 0.85582864, 'binary_precision': 0.6888889, 'binary_recall': 0.10763889, 'binary_specificity': 0.99798936, 'binary_f1_score': 0.18618618}
confusion matrix:
      0   1
0  6949  14
1   257  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 8
val acc:0.9706107378005981, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 11,now: 2024-05-28 18:35:40.655356,epoch time: 0:17:49.617515,used: 3:27:08.895107,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97292054, 'precision': 0.788162, 'recall': 0.8216934, 'specificity': 0.8216934, 'f1': 0.8039086, 'auroc': 0.9661684, 'binary_precision': 0.5882716, 'binary_recall': 0.65951556, 'binary_specificity': 0.98387134, 'binary_f1_score': 0.62185967}
confusion matrix:
       0    1
0  40688  667
1    492  953
---- Validation: 
scalar performance:
{'acc': 0.97072, 'precision': 0.7772116, 'recall': 0.85444933, 'specificity': 0.85444933, 'f1': 0.81055474, 'auroc': 0.96164536, 'binary_precision': 0.5643803, 'binary_recall': 0.7293935, 'binary_specificity': 0.9795052, 'binary_f1_score': 0.6363637}
confusion matrix:
       0    1
0  17301  362
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9627638, 'precision': 0.8569127, 'recall': 0.54622877, 'specificity': 0.54622877, 'f1': 0.57381153, 'auroc': 0.88251245, 'binary_precision': 0.75, 'binary_recall': 0.09375, 'binary_specificity': 0.9987075, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  6954   9
1   261  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 9
val acc:0.9707199931144714, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 12,now: 2024-05-28 18:53:30.836265,epoch time: 0:17:50.180909,used: 3:44:59.076016,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9715654, 'precision': 0.7765991, 'recall': 0.8386905, 'specificity': 0.8386905, 'f1': 0.8041643, 'auroc': 0.9708611, 'binary_precision': 0.56390136, 'binary_recall': 0.69619375, 'binary_specificity': 0.9811873, 'binary_f1_score': 0.62310314}
confusion matrix:
       0     1
0  40577   778
1    439  1006
---- Validation: 
scalar performance:
{'acc': 0.9681525, 'precision': 0.7620923, 'recall': 0.8531189, 'specificity': 0.8531189, 'f1': 0.8000428, 'auroc': 0.96466464, 'binary_precision': 0.53416854, 'binary_recall': 0.7293935, 'binary_specificity': 0.97684425, 'binary_f1_score': 0.6166996}
confusion matrix:
       0    1
0  17254  409
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622121, 'precision': 0.7995969, 'recall': 0.55592734, 'specificity': 0.55592734, 'f1': 0.58738506, 'auroc': 0.8527825, 'binary_precision': 0.63461536, 'binary_recall': 0.114583336, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.19411767}
confusion matrix:
      0   1
0  6944  19
1   255  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 10
val acc:0.9681525230407715, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 13,now: 2024-05-28 19:11:31.486455,epoch time: 0:18:00.650190,used: 4:02:59.726206,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9723131, 'precision': 0.78024423, 'recall': 0.85710967, 'specificity': 0.85710967, 'f1': 0.81352645, 'auroc': 0.9747623, 'binary_precision': 0.56989247, 'binary_recall': 0.733564, 'binary_specificity': 0.9806553, 'binary_f1_score': 0.6414523}
confusion matrix:
       0     1
0  40555   800
1    385  1060
---- Validation: 
scalar performance:
{'acc': 0.96842563, 'precision': 0.7634045, 'recall': 0.86599845, 'specificity': 0.86599845, 'f1': 0.80530584, 'auroc': 0.96240485, 'binary_precision': 0.5358324, 'binary_recall': 0.755832, 'binary_specificity': 0.9761649, 'binary_f1_score': 0.6270968}
confusion matrix:
       0    1
0  17242  421
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.77070963, 'recall': 0.54377455, 'specificity': 0.54377455, 'f1': 0.568162, 'auroc': 0.66015995, 'binary_precision': 0.5777778, 'binary_recall': 0.090277776, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.15615615}
confusion matrix:
      0   1
0  6944  19
1   262  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 11
val acc:0.9684256315231323, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 14,now: 2024-05-28 19:29:30.402692,epoch time: 0:17:58.916237,used: 4:20:58.642443,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9689019, 'precision': 0.7593559, 'recall': 0.9057121, 'specificity': 0.9057121, 'f1': 0.8144498, 'auroc': 0.9760999, 'binary_precision': 0.52449065, 'binary_recall': 0.8379501, 'binary_specificity': 0.9734742, 'binary_f1_score': 0.6451612}
confusion matrix:
       0     1
0  40259  1097
1    234  1210
---- Validation: 
scalar performance:
{'acc': 0.9671692, 'precision': 0.7571609, 'recall': 0.90805733, 'specificity': 0.90805733, 'f1': 0.813269, 'auroc': 0.9665624, 'binary_precision': 0.52011496, 'binary_recall': 0.844479, 'binary_specificity': 0.97163564, 'binary_f1_score': 0.6437463}
confusion matrix:
       0    1
0  17162  501
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539374, 'precision': 0.5509025, 'recall': 0.5116756, 'specificity': 0.5116756, 'f1': 0.51376605, 'auroc': 0.8100333, 'binary_precision': 0.140625, 'binary_recall': 0.03125, 'binary_specificity': 0.99210113, 'binary_f1_score': 0.051136363}
confusion matrix:
      0   1
0  6908  55
1   279   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 12
val acc:0.9671692252159119, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 15,now: 2024-05-28 19:47:24.480440,epoch time: 0:17:54.077748,used: 4:38:52.720191,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97324765, 'precision': 0.7943034, 'recall': 0.79882157, 'specificity': 0.79882157, 'f1': 0.79654354, 'auroc': 0.9655914, 'binary_precision': 0.6021798, 'binary_recall': 0.6117647, 'binary_specificity': 0.98587835, 'binary_f1_score': 0.6069344}
confusion matrix:
       0    1
0  40771  584
1    561  884
---- Validation: 
scalar performance:
{'acc': 0.96880805, 'precision': 0.7671811, 'recall': 0.8144951, 'specificity': 0.8144951, 'f1': 0.78868794, 'auroc': 0.9579202, 'binary_precision': 0.5472441, 'binary_recall': 0.64852256, 'binary_specificity': 0.9804676, 'binary_f1_score': 0.59359425}
confusion matrix:
       0    1
0  17318  345
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9562819, 'precision': 0.61967504, 'recall': 0.527875, 'specificity': 0.527875, 'f1': 0.53978926, 'auroc': 0.7484492, 'binary_precision': 0.2769231, 'binary_recall': 0.0625, 'binary_specificity': 0.99325, 'binary_f1_score': 0.101983}
confusion matrix:
      0   1
0  6916  47
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 13
val acc:0.9688080549240112, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 16,now: 2024-05-28 20:05:11.259227,epoch time: 0:17:46.778787,used: 4:56:39.498978,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9698365, 'precision': 0.76530945, 'recall': 0.8353517, 'specificity': 0.8353517, 'f1': 0.7957783, 'auroc': 0.9689206, 'binary_precision': 0.54150844, 'binary_recall': 0.6911357, 'binary_specificity': 0.97956765, 'binary_f1_score': 0.6072407}
confusion matrix:
       0    1
0  40511  845
1    446  998
---- Validation: 
scalar performance:
{'acc': 0.9662406, 'precision': 0.75137925, 'recall': 0.8221562, 'specificity': 0.8221562, 'f1': 0.781856, 'auroc': 0.9620267, 'binary_precision': 0.515006, 'binary_recall': 0.66718507, 'binary_specificity': 0.9771273, 'binary_f1_score': 0.5813008}
confusion matrix:
       0    1
0  17259  404
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579368, 'precision': 0.66624635, 'recall': 0.5387225, 'specificity': 0.5387225, 'f1': 0.5572105, 'auroc': 0.8744809, 'binary_precision': 0.36923078, 'binary_recall': 0.083333336, 'binary_specificity': 0.9941117, 'binary_f1_score': 0.13597734}
confusion matrix:
      0   1
0  6922  41
1   264  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 14
val acc:0.9662405848503113, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 17,now: 2024-05-28 20:23:08.262407,epoch time: 0:17:57.003180,used: 5:14:36.502158,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97404206, 'precision': 0.78879774, 'recall': 0.88872594, 'specificity': 0.88872594, 'f1': 0.8305761, 'auroc': 0.9806851, 'binary_precision': 0.5847716, 'binary_recall': 0.79723185, 'binary_specificity': 0.98022, 'binary_f1_score': 0.6746706}
confusion matrix:
       0     1
0  40537   818
1    293  1152
---- Validation: 
scalar performance:
{'acc': 0.9669507, 'precision': 0.7557848, 'recall': 0.8787215, 'specificity': 0.8787215, 'f1': 0.80381817, 'auroc': 0.9688909, 'binary_precision': 0.51958764, 'binary_recall': 0.7838258, 'binary_specificity': 0.97361714, 'binary_f1_score': 0.6249225}
confusion matrix:
       0    1
0  17197  466
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96235, 'precision': 0.76915926, 'recall': 0.6025996, 'specificity': 0.6025996, 'f1': 0.64475435, 'auroc': 0.9112262, 'binary_precision': 0.57009345, 'binary_recall': 0.21180555, 'binary_specificity': 0.99339366, 'binary_f1_score': 0.30886078}
confusion matrix:
      0   1
0  6917  46
1   227  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 15
val acc:0.9669507145881653, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 18,now: 2024-05-28 20:40:42.662191,epoch time: 0:17:34.399784,used: 5:32:10.901942,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97014016, 'precision': 0.7657492, 'recall': 0.89772654, 'specificity': 0.89772654, 'f1': 0.8170383, 'auroc': 0.97694945, 'binary_precision': 0.53790283, 'binary_recall': 0.8200692, 'binary_specificity': 0.9753839, 'binary_f1_score': 0.6496711}
confusion matrix:
       0     1
0  40337  1018
1    260  1185
---- Validation: 
scalar performance:
{'acc': 0.9639462, 'precision': 0.74248606, 'recall': 0.89065194, 'specificity': 0.89065194, 'f1': 0.7968846, 'auroc': 0.9650538, 'binary_precision': 0.4919887, 'binary_recall': 0.8118196, 'binary_specificity': 0.9694842, 'binary_f1_score': 0.6126761}
confusion matrix:
       0    1
0  17124  539
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9594539, 'precision': 0.6772537, 'recall': 0.5178765, 'specificity': 0.5178765, 'f1': 0.5244478, 'auroc': 0.71147084, 'binary_precision': 0.39285713, 'binary_recall': 0.038194444, 'binary_specificity': 0.99755853, 'binary_f1_score': 0.06962025}
confusion matrix:
      0   1
0  6946  17
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 16
val acc:0.9639462232589722, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 19,now: 2024-05-28 20:58:17.990228,epoch time: 0:17:35.328037,used: 5:49:46.229979,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9733411, 'precision': 0.79162943, 'recall': 0.81978834, 'specificity': 0.81978834, 'f1': 0.8049929, 'auroc': 0.96483576, 'binary_precision': 0.595343, 'binary_recall': 0.65512466, 'binary_specificity': 0.98445207, 'binary_f1_score': 0.62380487}
confusion matrix:
       0    1
0  40713  643
1    498  946
---- Validation: 
scalar performance:
{'acc': 0.9676609, 'precision': 0.7596846, 'recall': 0.8228922, 'specificity': 0.8228922, 'f1': 0.7874439, 'auroc': 0.9581803, 'binary_precision': 0.5315985, 'binary_recall': 0.66718507, 'binary_specificity': 0.9785993, 'binary_f1_score': 0.5917241}
confusion matrix:
       0    1
0  17285  378
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95917803, 'precision': 0.6472949, 'recall': 0.51273996, 'specificity': 0.51273996, 'f1': 0.5152111, 'auroc': 0.8169092, 'binary_precision': 0.33333334, 'binary_recall': 0.027777778, 'binary_specificity': 0.9977021, 'binary_f1_score': 0.05128205}
confusion matrix:
      0   1
0  6947  16
1   280   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 17
val acc:0.9676609039306641, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 20,now: 2024-05-28 21:16:07.897029,epoch time: 0:17:49.906801,used: 6:07:36.136780,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.958972, 'precision': 0.7178271, 'recall': 0.8926152, 'specificity': 0.8926152, 'f1': 0.77663225, 'auroc': 0.9651058, 'binary_precision': 0.44208565, 'binary_recall': 0.8214533, 'binary_specificity': 0.96377707, 'binary_f1_score': 0.5748184}
confusion matrix:
       0     1
0  39857  1498
1    258  1187
---- Validation: 
scalar performance:
{'acc': 0.95826507, 'precision': 0.71916026, 'recall': 0.87422055, 'specificity': 0.87422055, 'f1': 0.77346, 'auroc': 0.9491378, 'binary_precision': 0.44641274, 'binary_recall': 0.7838258, 'binary_specificity': 0.9646153, 'binary_f1_score': 0.5688488}
confusion matrix:
       0    1
0  17038  625
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95448905, 'precision': 0.60637295, 'recall': 0.53193444, 'specificity': 0.53193444, 'f1': 0.5447743, 'auroc': 0.84723854, 'binary_precision': 0.25, 'binary_recall': 0.072916664, 'binary_specificity': 0.9909522, 'binary_f1_score': 0.11290322}
confusion matrix:
      0   1
0  6900  63
1   267  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 18
val acc:0.9582650661468506, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 21,now: 2024-05-28 21:33:48.225484,epoch time: 0:17:40.328455,used: 6:25:16.465235,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9718458, 'precision': 0.7930126, 'recall': 0.73565114, 'specificity': 0.73565114, 'f1': 0.7609211, 'auroc': 0.93842924, 'binary_precision': 0.60398614, 'binary_recall': 0.48235294, 'binary_specificity': 0.98894936, 'binary_f1_score': 0.5363601}
confusion matrix:
       0    1
0  40898  457
1    748  697
---- Validation: 
scalar performance:
{'acc': 0.970283, 'precision': 0.7829069, 'recall': 0.7650565, 'specificity': 0.7650565, 'f1': 0.77365994, 'auroc': 0.94632983, 'binary_precision': 0.5823627, 'binary_recall': 0.5443235, 'binary_specificity': 0.9857895, 'binary_f1_score': 0.562701}
confusion matrix:
       0    1
0  17412  251
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95807475, 'precision': 0.54846954, 'recall': 0.50384396, 'specificity': 0.50384396, 'f1': 0.49896717, 'auroc': 0.7937441, 'binary_precision': 0.13636364, 'binary_recall': 0.010416667, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.019354839}
confusion matrix:
      0   1
0  6944  19
1   285   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 19
val acc:0.9702829718589783, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 22,now: 2024-05-28 21:51:27.927680,epoch time: 0:17:39.702196,used: 6:42:56.167431,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97432244, 'precision': 0.79207575, 'recall': 0.8715936, 'specificity': 0.8715936, 'f1': 0.8265558, 'auroc': 0.9785526, 'binary_precision': 0.5925526, 'binary_recall': 0.7614424, 'binary_specificity': 0.98174477, 'binary_f1_score': 0.6664643}
confusion matrix:
       0     1
0  40603   755
1    344  1098
---- Validation: 
scalar performance:
{'acc': 0.97033757, 'precision': 0.77373755, 'recall': 0.87598073, 'specificity': 0.87598073, 'f1': 0.8158457, 'auroc': 0.9681222, 'binary_precision': 0.5558036, 'binary_recall': 0.7744945, 'binary_specificity': 0.977467, 'binary_f1_score': 0.64717346}
confusion matrix:
       0    1
0  17265  398
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9609709, 'precision': 0.7716245, 'recall': 0.5303165, 'specificity': 0.5303165, 'f1': 0.5464496, 'auroc': 0.777568, 'binary_precision': 0.58064514, 'binary_recall': 0.0625, 'binary_specificity': 0.998133, 'binary_f1_score': 0.11285266}
confusion matrix:
      0   1
0  6950  13
1   270  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897891.png
early stop counter: 20
val acc:0.9703375697135925, best validation acc: 0.9772205948829651, corresponding to test acc:                         0.9605571627616882 / 0.9630395770072937
after epoch: 23,now: 2024-05-28 22:09:11.657124,epoch time: 0:17:43.729444,used: 7:00:39.896875,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_15_08_31_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 7:00:39.896875 at 2024-05-28 22:09:11.657124
persisted model performance metric: 

scalar performance:
{'acc': 0.9622121, 'precision': 0.79716855, 'recall': 0.5575916, 'specificity': 0.5575916, 'f1': 0.58974004, 'auroc': 0.85182106, 'binary_precision': 0.6296296, 'binary_recall': 0.11805555, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.19883038}
confusion matrix:
      0   1
0  6943  20
1   254  34
oracle model performance metric: 

scalar performance:
{'acc': 0.96235, 'precision': 0.7904365, 'recall': 0.56764925, 'specificity': 0.56764925, 'f1': 0.60366714, 'auroc': 0.91797876, 'binary_precision': 0.61538464, 'binary_recall': 0.1388889, 'binary_specificity': 0.9964096, 'binary_f1_score': 0.22662891}
confusion matrix:
      0   1
0  6938  25
1   248  40
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496085 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |  90005 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496085 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |  90005 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476619 KiB |  10962 MiB |   4372 TiB |   4372 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4365 TiB |   4365 TiB |
|       from small pool |  88779 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11238 MiB |  11392 MiB |  30060 MiB |  18822 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    126 MiB |    126 MiB |    180 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1440 TiB |   1440 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1431 TiB |   1431 TiB |
|       from small pool |      8 MiB |     31 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4101    |    7764    |  362425 K  |  362421 K  |
|       from large pool |      87    |     909    |  170933 K  |  170933 K  |
|       from small pool |    4014    |    7642    |  191491 K  |  191487 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4101    |    7764    |  362425 K  |  362421 K  |
|       from large pool |      87    |     909    |  170933 K  |  170933 K  |
|       from small pool |    4014    |    7642    |  191491 K  |  191487 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     538    |     303    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      63    |      63    |      90    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    2768    |  191674 K  |  191674 K  |
|       from large pool |      24    |      65    |   89857 K  |   89857 K  |
|       from small pool |      52    |    2747    |  101816 K  |  101816 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4372 TiB |   4372 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4365 TiB |   4365 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30060 MiB |  28228 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    180 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1440 TiB |   1440 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1431 TiB |   1431 TiB |
|       from small pool |      0 KiB |     31 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  362425 K  |  362425 K  |
|       from large pool |       2    |     909    |  170933 K  |  170933 K  |
|       from small pool |       0    |    7642    |  191491 K  |  191491 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  362425 K  |  362425 K  |
|       from large pool |       2    |     909    |  170933 K  |  170933 K  |
|       from small pool |       0    |    7642    |  191491 K  |  191491 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     538    |     456    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      90    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  191675 K  |  191675 K  |
|       from large pool |       4    |      65    |   89857 K  |   89857 K  |
|       from small pool |       0    |    2747    |  101818 K  |  101818 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4391 TiB |   4391 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4384 TiB |   4384 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4372 TiB |   4372 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4365 TiB |   4365 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30060 MiB |  28228 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    180 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1440 TiB |   1440 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1431 TiB |   1431 TiB |
|       from small pool |      0 KiB |     31 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  362425 K  |  362425 K  |
|       from large pool |       2    |     909    |  170933 K  |  170933 K  |
|       from small pool |       0    |    7642    |  191491 K  |  191491 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  362425 K  |  362425 K  |
|       from large pool |       2    |     909    |  170933 K  |  170933 K  |
|       from small pool |       0    |    7642    |  191491 K  |  191491 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     538    |     456    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      90    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  191675 K  |  191675 K  |
|       from large pool |       4    |      65    |   89857 K  |   89857 K  |
|       from small pool |       0    |    2747    |  101818 K  |  101818 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891

 Experiment start at: 2024-05-28 22:17:55.556355
before training, model accuracy: 0.2902069687843323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.971231, 'precision': 0.80469775, 'recall': 0.73149925, 'specificity': 0.73149925, 'f1': 0.7626126, 'auroc': 0.93565077, 'binary_precision': 0.6287081, 'binary_recall': 0.47334293, 'binary_specificity': 0.98965555, 'binary_f1_score': 0.540074}
confusion matrix:
       0    1
0  37120  388
1    731  657
---- Validation: 
scalar performance:
{'acc': 0.9688232, 'precision': 0.7863065, 'recall': 0.6957631, 'specificity': 0.6957631, 'f1': 0.7316843, 'auroc': 0.9342891, 'binary_precision': 0.59452736, 'binary_recall': 0.40168068, 'binary_specificity': 0.9898455, 'binary_f1_score': 0.4794383}
confusion matrix:
       0    1
0  15889  163
1    356  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9662217, 'precision': 0.71527755, 'recall': 0.702528, 'specificity': 0.702528, 'f1': 0.7086866, 'auroc': 0.93208504, 'binary_precision': 0.4489164, 'binary_recall': 0.42151162, 'binary_specificity': 0.9835444, 'binary_f1_score': 0.4347826}
confusion matrix:
       0    1
0  10639  178
1    199  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 22:37:48.660027,epoch time: 0:19:53.103672,used: 0:19:53.103672,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547204, 'precision': 0.7510694, 'recall': 0.86770535, 'specificity': 0.86770535, 'f1': 0.796947, 'auroc': 0.9504167, 'binary_precision': 0.5111004, 'binary_recall': 0.762419, 'binary_specificity': 0.9729917, 'binary_f1_score': 0.6119619}
confusion matrix:
       0     1
0  36494  1013
1    330  1059
---- Validation: 
scalar performance:
{'acc': 0.9602932, 'precision': 0.7281622, 'recall': 0.86046016, 'specificity': 0.86046016, 'f1': 0.7773191, 'auroc': 0.94908047, 'binary_precision': 0.46569645, 'binary_recall': 0.7529412, 'binary_specificity': 0.9679791, 'binary_f1_score': 0.5754656}
confusion matrix:
       0    1
0  15538  514
1    147  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655945, 'precision': 0.72414476, 'recall': 0.8161929, 'specificity': 0.8161929, 'f1': 0.7613989, 'auroc': 0.92935437, 'binary_precision': 0.4593496, 'binary_recall': 0.65697676, 'binary_specificity': 0.9754091, 'binary_f1_score': 0.54066986}
confusion matrix:
       0    1
0  10551  266
1    118  226
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 1
val acc:0.960293173789978, best validation acc: 0.9688231945037842, corresponding to test acc:                         0.9662216901779175 / 0.9662216901779175
after epoch: 2,now: 2024-05-28 22:56:15.092263,epoch time: 0:18:26.432236,used: 0:38:19.535908,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9677859, 'precision': 0.7633543, 'recall': 0.831468, 'specificity': 0.831468, 'f1': 0.7930323, 'auroc': 0.95583045, 'binary_precision': 0.5385051, 'binary_recall': 0.6846652, 'binary_specificity': 0.9782707, 'binary_f1_score': 0.6028526}
confusion matrix:
       0    1
0  36692  815
1    438  951
---- Validation: 
scalar performance:
{'acc': 0.9670811, 'precision': 0.759765, 'recall': 0.8073368, 'specificity': 0.8073368, 'f1': 0.7813121, 'auroc': 0.94743997, 'binary_precision': 0.53314525, 'binary_recall': 0.63529414, 'binary_specificity': 0.97937953, 'binary_f1_score': 0.5797546}
confusion matrix:
       0    1
0  15721  331
1    217  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9657737, 'precision': 0.71314096, 'recall': 0.7107405, 'specificity': 0.7107405, 'f1': 0.71193314, 'auroc': 0.9468036, 'binary_precision': 0.44411764, 'binary_recall': 0.4389535, 'binary_specificity': 0.9825275, 'binary_f1_score': 0.44152048}
confusion matrix:
       0    1
0  10628  189
1    193  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 2
val acc:0.9670811295509338, best validation acc: 0.9688231945037842, corresponding to test acc:                         0.9662216901779175 / 0.9662216901779175
after epoch: 3,now: 2024-05-28 23:14:47.676522,epoch time: 0:18:32.584259,used: 0:56:52.120167,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97331345, 'precision': 0.8060234, 'recall': 0.80729616, 'specificity': 0.80729616, 'f1': 0.8066584, 'auroc': 0.95821303, 'binary_precision': 0.62580645, 'binary_recall': 0.6285097, 'binary_specificity': 0.9860826, 'binary_f1_score': 0.6271552}
confusion matrix:
       0    1
0  36985  522
1    516  873
---- Validation: 
scalar performance:
{'acc': 0.9713462, 'precision': 0.7945645, 'recall': 0.7787993, 'specificity': 0.7787993, 'f1': 0.78644204, 'auroc': 0.953738, 'binary_precision': 0.6049822, 'binary_recall': 0.5714286, 'binary_specificity': 0.98616993, 'binary_f1_score': 0.5877269}
confusion matrix:
       0    1
0  15830  222
1    255  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968372, 'precision': 0.72384304, 'recall': 0.60653615, 'specificity': 0.60653615, 'f1': 0.64240503, 'auroc': 0.94125414, 'binary_precision': 0.47204968, 'binary_recall': 0.22093023, 'binary_specificity': 0.992142, 'binary_f1_score': 0.30099007}
confusion matrix:
       0   1
0  10732  85
1    268  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-28 23:33:29.685177,epoch time: 0:18:42.008655,used: 1:15:34.128822,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.969637, 'precision': 0.77360606, 'recall': 0.852533, 'specificity': 0.852533, 'f1': 0.80749476, 'auroc': 0.9658705, 'binary_precision': 0.5574586, 'binary_recall': 0.7264219, 'binary_specificity': 0.978644, 'binary_f1_score': 0.6308221}
confusion matrix:
       0     1
0  36706   801
1    380  1009
---- Validation: 
scalar performance:
{'acc': 0.9672614, 'precision': 0.7602376, 'recall': 0.84788966, 'specificity': 0.84788966, 'f1': 0.7969519, 'auroc': 0.9616816, 'binary_precision': 0.53101736, 'binary_recall': 0.71932775, 'binary_specificity': 0.9764515, 'binary_f1_score': 0.61099213}
confusion matrix:
       0    1
0  15674  378
1    167  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622794, 'precision': 0.70675063, 'recall': 0.8046318, 'specificity': 0.8046318, 'f1': 0.7451401, 'auroc': 0.952806, 'binary_precision': 0.42524272, 'binary_recall': 0.6366279, 'binary_specificity': 0.9726357, 'binary_f1_score': 0.50989527}
confusion matrix:
       0    1
0  10521  296
1    125  219
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 1
val acc:0.9672613739967346, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9683719873428345
after epoch: 5,now: 2024-05-28 23:51:58.052451,epoch time: 0:18:28.367274,used: 1:34:02.496096,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97030544, 'precision': 0.78007305, 'recall': 0.82272184, 'specificity': 0.82272184, 'f1': 0.79971445, 'auroc': 0.9600704, 'binary_precision': 0.5726708, 'binary_recall': 0.6637869, 'binary_specificity': 0.98165673, 'binary_f1_score': 0.6148716}
confusion matrix:
       0    1
0  36819  688
1    467  922
---- Validation: 
scalar performance:
{'acc': 0.9670211, 'precision': 0.7596276, 'recall': 0.79597706, 'specificity': 0.79597706, 'f1': 0.7764695, 'auroc': 0.9584438, 'binary_precision': 0.53372437, 'binary_recall': 0.6117647, 'binary_specificity': 0.9801894, 'binary_f1_score': 0.5700862}
confusion matrix:
       0    1
0  15734  318
1    231  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634441, 'precision': 0.7059368, 'recall': 0.758793, 'specificity': 0.758793, 'f1': 0.7289916, 'auroc': 0.9452906, 'binary_precision': 0.4266055, 'binary_recall': 0.5406977, 'binary_specificity': 0.97688824, 'binary_f1_score': 0.4769231}
confusion matrix:
       0    1
0  10567  250
1    158  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 2
val acc:0.967021107673645, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9683719873428345
after epoch: 6,now: 2024-05-29 00:10:37.253050,epoch time: 0:18:39.200599,used: 1:52:41.696695,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9701769, 'precision': 0.77644515, 'recall': 0.8597457, 'specificity': 0.8597457, 'f1': 0.8119863, 'auroc': 0.9589685, 'binary_precision': 0.5626025, 'binary_recall': 0.7408207, 'binary_specificity': 0.97867066, 'binary_f1_score': 0.6395277}
confusion matrix:
       0     1
0  36707   800
1    360  1029
---- Validation: 
scalar performance:
{'acc': 0.967802, 'precision': 0.76319313, 'recall': 0.8505975, 'specificity': 0.8505975, 'f1': 0.7998953, 'auroc': 0.94991827, 'binary_precision': 0.53673726, 'binary_recall': 0.72436976, 'binary_specificity': 0.9768253, 'binary_f1_score': 0.6165952}
confusion matrix:
       0    1
0  15680  372
1    164  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642505, 'precision': 0.71868545, 'recall': 0.82816494, 'specificity': 0.82816494, 'f1': 0.7611264, 'auroc': 0.95264393, 'binary_precision': 0.44761905, 'binary_recall': 0.68313956, 'binary_specificity': 0.97319037, 'binary_f1_score': 0.54085153}
confusion matrix:
       0    1
0  10527  290
1    109  235
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 3
val acc:0.9678019881248474, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9683719873428345
after epoch: 7,now: 2024-05-29 00:29:05.945002,epoch time: 0:18:28.691952,used: 2:11:10.388647,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97267073, 'precision': 0.78945506, 'recall': 0.8870368, 'specificity': 0.8870368, 'f1': 0.8303793, 'auroc': 0.96958065, 'binary_precision': 0.58660996, 'binary_recall': 0.79481643, 'binary_specificity': 0.9792572, 'binary_f1_score': 0.67502296}
confusion matrix:
       0     1
0  36729   778
1    285  1104
---- Validation: 
scalar performance:
{'acc': 0.968643, 'precision': 0.76739764, 'recall': 0.86964494, 'specificity': 0.86964494, 'f1': 0.8092915, 'auroc': 0.9624249, 'binary_precision': 0.54371256, 'binary_recall': 0.7630252, 'binary_specificity': 0.97626466, 'binary_f1_score': 0.634965}
confusion matrix:
       0    1
0  15671  381
1    141  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9647881, 'precision': 0.7254668, 'recall': 0.87488204, 'specificity': 0.87488204, 'f1': 0.779297, 'auroc': 0.95889497, 'binary_precision': 0.45811966, 'binary_recall': 0.7790698, 'binary_specificity': 0.9706943, 'binary_f1_score': 0.5769645}
confusion matrix:
       0    1
0  10500  317
1     76  268
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 4
val acc:0.9686430096626282, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9683719873428345
after epoch: 8,now: 2024-05-29 00:47:34.572901,epoch time: 0:18:28.627899,used: 2:29:39.016546,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9699969, 'precision': 0.7780995, 'recall': 0.8208287, 'specificity': 0.8208287, 'f1': 0.7977631, 'auroc': 0.9639888, 'binary_precision': 0.56885856, 'binary_recall': 0.6601872, 'binary_specificity': 0.9814701, 'binary_f1_score': 0.61112964}
confusion matrix:
       0    1
0  36812  695
1    472  917
---- Validation: 
scalar performance:
{'acc': 0.96365714, 'precision': 0.7386711, 'recall': 0.78047657, 'specificity': 0.78047657, 'f1': 0.757674, 'auroc': 0.9544327, 'binary_precision': 0.49289772, 'binary_recall': 0.5831933, 'binary_specificity': 0.9777598, 'binary_f1_score': 0.5342571}
confusion matrix:
       0    1
0  15695  357
1    248  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691784, 'precision': 0.741826, 'recall': 0.73501325, 'specificity': 0.73501325, 'f1': 0.7383659, 'auroc': 0.9571339, 'binary_precision': 0.5, 'binary_recall': 0.4854651, 'binary_specificity': 0.9845613, 'binary_f1_score': 0.49262536}
confusion matrix:
       0    1
0  10650  167
1    177  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
new oracle model saved
early stop counter: 5
val acc:0.9636571407318115, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9691783785820007
after epoch: 9,now: 2024-05-29 01:05:58.443505,epoch time: 0:18:23.870604,used: 2:48:02.887150,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97328776, 'precision': 0.7946672, 'recall': 0.8748777, 'specificity': 0.8748777, 'f1': 0.82941574, 'auroc': 0.96839327, 'binary_precision': 0.5979843, 'binary_recall': 0.7688985, 'binary_specificity': 0.9808569, 'binary_f1_score': 0.6727559}
confusion matrix:
       0     1
0  36789   718
1    321  1068
---- Validation: 
scalar performance:
{'acc': 0.97014475, 'precision': 0.778649, 'recall': 0.8283459, 'specificity': 0.8283459, 'f1': 0.8012258, 'auroc': 0.9472216, 'binary_precision': 0.5694051, 'binary_recall': 0.6756303, 'binary_specificity': 0.9810616, 'binary_f1_score': 0.61798614}
confusion matrix:
       0    1
0  15748  304
1    193  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9526924, 'precision': 0.6861574, 'recall': 0.89256537, 'specificity': 0.89256537, 'f1': 0.74712414, 'auroc': 0.9493855, 'binary_precision': 0.37798408, 'binary_recall': 0.82848835, 'binary_specificity': 0.9566423, 'binary_f1_score': 0.5191257}
confusion matrix:
       0    1
0  10348  469
1     59  285
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 6
val acc:0.9701447486877441, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9691783785820007
after epoch: 10,now: 2024-05-29 01:24:16.962581,epoch time: 0:18:18.519076,used: 3:06:21.406226,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9674517, 'precision': 0.7609103, 'recall': 0.8746247, 'specificity': 0.8746247, 'f1': 0.80629295, 'auroc': 0.966777, 'binary_precision': 0.5303105, 'binary_recall': 0.774658, 'binary_specificity': 0.97459143, 'binary_f1_score': 0.6296079}
confusion matrix:
       0     1
0  36554   953
1    313  1076
---- Validation: 
scalar performance:
{'acc': 0.96642035, 'precision': 0.75574267, 'recall': 0.8547362, 'specificity': 0.8547362, 'f1': 0.79618216, 'auroc': 0.951736, 'binary_precision': 0.5214797, 'binary_recall': 0.7344538, 'binary_specificity': 0.9750187, 'binary_f1_score': 0.6099093}
confusion matrix:
       0    1
0  15651  401
1    158  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94767493, 'precision': 0.6751168, 'recall': 0.90264225, 'specificity': 0.90264225, 'f1': 0.73704714, 'auroc': 0.9531775, 'binary_precision': 0.35507247, 'binary_recall': 0.85465115, 'binary_specificity': 0.9506333, 'binary_f1_score': 0.50170654}
confusion matrix:
       0    1
0  10283  534
1     50  294
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 7
val acc:0.9664203524589539, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9691783785820007
after epoch: 11,now: 2024-05-29 01:42:22.450704,epoch time: 0:18:05.488123,used: 3:24:26.894349,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.971848, 'precision': 0.79001194, 'recall': 0.83218765, 'specificity': 0.83218765, 'f1': 0.80950916, 'auroc': 0.96885014, 'binary_precision': 0.591875, 'binary_recall': 0.68178546, 'binary_specificity': 0.9825899, 'binary_f1_score': 0.6336568}
confusion matrix:
       0    1
0  36854  653
1    442  947
---- Validation: 
scalar performance:
{'acc': 0.968643, 'precision': 0.7706952, 'recall': 0.7960089, 'specificity': 0.7960089, 'f1': 0.7827209, 'auroc': 0.95750403, 'binary_precision': 0.55589586, 'binary_recall': 0.61008406, 'binary_specificity': 0.9819337, 'binary_f1_score': 0.58173084}
confusion matrix:
       0    1
0  15762  290
1    232  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95323, 'precision': 0.68829095, 'recall': 0.89706445, 'specificity': 0.89706445, 'f1': 0.74999774, 'auroc': 0.95425934, 'binary_precision': 0.38196287, 'binary_recall': 0.8372093, 'binary_specificity': 0.95691967, 'binary_f1_score': 0.5245902}
confusion matrix:
       0    1
0  10351  466
1     56  288
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 8
val acc:0.9686430096626282, best validation acc: 0.9713461995124817, corresponding to test acc:                         0.9683719873428345 / 0.9691783785820007
after epoch: 12,now: 2024-05-29 02:00:23.215842,epoch time: 0:18:00.765138,used: 3:42:27.659487,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97503597, 'precision': 0.825158, 'recall': 0.7977901, 'specificity': 0.7977901, 'f1': 0.8108135, 'auroc': 0.9619137, 'binary_precision': 0.6648265, 'binary_recall': 0.6069114, 'binary_specificity': 0.9886688, 'binary_f1_score': 0.6345503}
confusion matrix:
       0    1
0  37082  425
1    546  843
---- Validation: 
scalar performance:
{'acc': 0.9714063, 'precision': 0.7938747, 'recall': 0.78530395, 'specificity': 0.78530395, 'f1': 0.7895191, 'auroc': 0.94665253, 'binary_precision': 0.6031196, 'binary_recall': 0.584874, 'binary_specificity': 0.98573387, 'binary_f1_score': 0.5938567}
confusion matrix:
       0    1
0  15823  229
1    247  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967028, 'precision': 0.73283994, 'recall': 0.83100516, 'specificity': 0.83100516, 'f1': 0.7723871, 'auroc': 0.96053165, 'binary_precision': 0.47580644, 'binary_recall': 0.68604654, 'binary_specificity': 0.9759638, 'binary_f1_score': 0.5619048}
confusion matrix:
       0    1
0  10557  260
1    108  236
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
better model found
persisted
after epoch: 13,now: 2024-05-29 02:18:24.165478,epoch time: 0:18:00.949636,used: 4:00:28.609123,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97169375, 'precision': 0.78448546, 'recall': 0.8757844, 'specificity': 0.8757844, 'f1': 0.8230741, 'auroc': 0.9691123, 'binary_precision': 0.57750267, 'binary_recall': 0.7724982, 'binary_specificity': 0.97907054, 'binary_f1_score': 0.66091776}
confusion matrix:
       0     1
0  36722   785
1    316  1073
---- Validation: 
scalar performance:
{'acc': 0.9681624, 'precision': 0.7649907, 'recall': 0.8604947, 'specificity': 0.8604947, 'f1': 0.80454016, 'auroc': 0.9579493, 'binary_precision': 0.5395859, 'binary_recall': 0.74453783, 'binary_specificity': 0.9764515, 'binary_f1_score': 0.62570626}
confusion matrix:
       0    1
0  15674  378
1    152  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9571723, 'precision': 0.7008529, 'recall': 0.90472734, 'specificity': 0.90472734, 'f1': 0.7637111, 'auroc': 0.9566058, 'binary_precision': 0.40668523, 'binary_recall': 0.8488372, 'binary_specificity': 0.96061754, 'binary_f1_score': 0.5499058}
confusion matrix:
       0    1
0  10391  426
1     52  292
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 1
val acc:0.9681624174118042, best validation acc: 0.9714062809944153, corresponding to test acc:                         0.967028021812439 / 0.9691783785820007
after epoch: 14,now: 2024-05-29 02:36:15.429289,epoch time: 0:17:51.263811,used: 4:18:19.872934,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9755245, 'precision': 0.80842197, 'recall': 0.8850501, 'specificity': 0.8850501, 'f1': 0.84203136, 'auroc': 0.9730755, 'binary_precision': 0.62478584, 'binary_recall': 0.78761697, 'binary_specificity': 0.98248327, 'binary_f1_score': 0.69681525}
confusion matrix:
       0     1
0  36850   657
1    295  1094
---- Validation: 
scalar performance:
{'acc': 0.9724275, 'precision': 0.7921819, 'recall': 0.84895, 'specificity': 0.84895, 'f1': 0.81776714, 'auroc': 0.9560749, 'binary_precision': 0.5949721, 'binary_recall': 0.7159664, 'binary_specificity': 0.9819337, 'binary_f1_score': 0.6498856}
confusion matrix:
       0    1
0  15762  290
1    169  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961921, 'precision': 0.71086997, 'recall': 0.8494793, 'specificity': 0.8494793, 'f1': 0.7608337, 'auroc': 0.94073033, 'binary_precision': 0.43053174, 'binary_recall': 0.72965115, 'binary_specificity': 0.96930754, 'binary_f1_score': 0.5415318}
confusion matrix:
       0    1
0  10485  332
1     93  251
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
better model found
persisted
after epoch: 15,now: 2024-05-29 02:54:26.388577,epoch time: 0:18:10.959288,used: 4:36:30.832222,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9677859, 'precision': 0.7630271, 'recall': 0.8463735, 'specificity': 0.8463735, 'f1': 0.7982918, 'auroc': 0.94354564, 'binary_precision': 0.53671706, 'binary_recall': 0.7156227, 'binary_specificity': 0.9771243, 'binary_f1_score': 0.6133909}
confusion matrix:
       0    1
0  36649  858
1    395  994
---- Validation: 
scalar performance:
{'acc': 0.96581966, 'precision': 0.75220346, 'recall': 0.81962967, 'specificity': 0.81962967, 'f1': 0.78143823, 'auroc': 0.9241592, 'binary_precision': 0.51706034, 'binary_recall': 0.6621849, 'binary_specificity': 0.9770745, 'binary_f1_score': 0.5806927}
confusion matrix:
       0    1
0  15684  368
1    201  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95493233, 'precision': 0.6966149, 'recall': 0.9232735, 'specificity': 0.9232735, 'f1': 0.76258016, 'auroc': 0.95846033, 'binary_precision': 0.39688715, 'binary_recall': 0.8895349, 'binary_specificity': 0.9570121, 'binary_f1_score': 0.5488789}
confusion matrix:
       0    1
0  10352  465
1     38  306
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 1
val acc:0.9658196568489075, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 16,now: 2024-05-29 03:12:50.729709,epoch time: 0:18:24.341132,used: 4:54:55.173354,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97524166, 'precision': 0.808955, 'recall': 0.86956364, 'specificity': 0.86956364, 'f1': 0.8362553, 'auroc': 0.97392136, 'binary_precision': 0.6270173, 'binary_recall': 0.7557637, 'binary_specificity': 0.98336357, 'binary_f1_score': 0.6853969}
confusion matrix:
       0     1
0  36884   624
1    339  1049
---- Validation: 
scalar performance:
{'acc': 0.9718868, 'precision': 0.7894213, 'recall': 0.84057784, 'specificity': 0.84057784, 'f1': 0.81268615, 'auroc': 0.9564223, 'binary_precision': 0.5900709, 'binary_recall': 0.6991597, 'binary_specificity': 0.981996, 'binary_f1_score': 0.64}
confusion matrix:
       0    1
0  15763  289
1    179  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586059, 'precision': 0.70200914, 'recall': 0.87732166, 'specificity': 0.87732166, 'f1': 0.7595408, 'auroc': 0.9554846, 'binary_precision': 0.41087613, 'binary_recall': 0.7906977, 'binary_specificity': 0.9639456, 'binary_f1_score': 0.54075545}
confusion matrix:
       0    1
0  10427  390
1     72  272
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 2
val acc:0.9718868136405945, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 17,now: 2024-05-29 03:31:16.123823,epoch time: 0:18:25.394114,used: 5:13:20.567468,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9723622, 'precision': 0.7963915, 'recall': 0.81464803, 'specificity': 0.81464803, 'f1': 0.80521727, 'auroc': 0.95681655, 'binary_precision': 0.60595804, 'binary_recall': 0.6448127, 'binary_specificity': 0.9844833, 'binary_f1_score': 0.62478185}
confusion matrix:
       0    1
0  36926  582
1    493  895
---- Validation: 
scalar performance:
{'acc': 0.96750164, 'precision': 0.76257765, 'recall': 0.80269974, 'specificity': 0.80269974, 'f1': 0.7810434, 'auroc': 0.9440732, 'binary_precision': 0.53913045, 'binary_recall': 0.6252101, 'binary_specificity': 0.9801894, 'binary_f1_score': 0.5789884}
confusion matrix:
       0    1
0  15734  318
1    223  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646985, 'precision': 0.7191256, 'recall': 0.8115089, 'specificity': 0.8115089, 'f1': 0.7563057, 'auroc': 0.9534985, 'binary_precision': 0.44959676, 'binary_recall': 0.6482558, 'binary_specificity': 0.97476196, 'binary_f1_score': 0.5309524}
confusion matrix:
       0    1
0  10544  273
1    121  223
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 3
val acc:0.9675016403198242, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 18,now: 2024-05-29 03:49:41.171337,epoch time: 0:18:25.047514,used: 5:31:45.614982,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9686343, 'precision': 0.7675024, 'recall': 0.85894585, 'specificity': 0.85894585, 'f1': 0.8057245, 'auroc': 0.96476907, 'binary_precision': 0.5447327, 'binary_recall': 0.7408207, 'binary_specificity': 0.9770709, 'binary_f1_score': 0.6278218}
confusion matrix:
       0     1
0  36647   860
1    360  1029
---- Validation: 
scalar performance:
{'acc': 0.9587313, 'precision': 0.7195854, 'recall': 0.83537465, 'specificity': 0.83537465, 'f1': 0.76364654, 'auroc': 0.9479239, 'binary_precision': 0.45043105, 'binary_recall': 0.702521, 'binary_specificity': 0.9682283, 'binary_f1_score': 0.54891664}
confusion matrix:
       0    1
0  15542  510
1    177  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618314, 'precision': 0.70699453, 'recall': 0.8212879, 'specificity': 0.8212879, 'f1': 0.75019765, 'auroc': 0.95369625, 'binary_precision': 0.42463234, 'binary_recall': 0.67151165, 'binary_specificity': 0.9710641, 'binary_f1_score': 0.5202703}
confusion matrix:
       0    1
0  10504  313
1    113  231
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 4
val acc:0.9587312936782837, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 19,now: 2024-05-29 04:08:06.429671,epoch time: 0:18:25.258334,used: 5:50:10.873316,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9720537, 'precision': 0.78595936, 'recall': 0.88429034, 'specificity': 0.88429034, 'f1': 0.82705504, 'auroc': 0.9744797, 'binary_precision': 0.5798097, 'binary_recall': 0.7897768, 'binary_specificity': 0.97880393, 'binary_f1_score': 0.6686986}
confusion matrix:
       0     1
0  36712   795
1    292  1097
---- Validation: 
scalar performance:
{'acc': 0.964438, 'precision': 0.7453904, 'recall': 0.8407613, 'specificity': 0.8407613, 'f1': 0.7842938, 'auroc': 0.95198464, 'binary_precision': 0.50178784, 'binary_recall': 0.70756304, 'binary_specificity': 0.9739596, 'binary_f1_score': 0.5871688}
confusion matrix:
       0    1
0  15634  418
1    174  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586955, 'precision': 0.7023203, 'recall': 0.87736785, 'specificity': 0.87736785, 'f1': 0.7598338, 'auroc': 0.95203346, 'binary_precision': 0.41149774, 'binary_recall': 0.7906977, 'binary_specificity': 0.9640381, 'binary_f1_score': 0.54129356}
confusion matrix:
       0    1
0  10428  389
1     72  272
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 5
val acc:0.9644380211830139, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 20,now: 2024-05-29 04:26:32.660871,epoch time: 0:18:26.231200,used: 6:08:37.104516,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9730564, 'precision': 0.7926612, 'recall': 0.879264, 'specificity': 0.879264, 'f1': 0.8297343, 'auroc': 0.97785157, 'binary_precision': 0.5936299, 'binary_recall': 0.7782577, 'binary_specificity': 0.9802703, 'binary_f1_score': 0.67352027}
confusion matrix:
       0     1
0  36767   740
1    308  1081
---- Validation: 
scalar performance:
{'acc': 0.9659999, 'precision': 0.75340545, 'recall': 0.8399528, 'specificity': 0.8399528, 'f1': 0.78955877, 'auroc': 0.96037644, 'binary_precision': 0.51792336, 'binary_recall': 0.7042017, 'binary_specificity': 0.97570395, 'binary_f1_score': 0.59686613}
confusion matrix:
       0    1
0  15662  390
1    176  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638025, 'precision': 0.7189224, 'recall': 0.85045004, 'specificity': 0.85045004, 'f1': 0.7676097, 'auroc': 0.9598177, 'binary_precision': 0.4466192, 'binary_recall': 0.72965115, 'binary_specificity': 0.971249, 'binary_f1_score': 0.5540839}
confusion matrix:
       0    1
0  10506  311
1     93  251
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 6
val acc:0.9659999012947083, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 21,now: 2024-05-29 04:44:58.980136,epoch time: 0:18:26.319265,used: 6:27:03.423781,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9703568, 'precision': 0.77525556, 'recall': 0.89853466, 'specificity': 0.89853466, 'f1': 0.8242204, 'auroc': 0.97725856, 'binary_precision': 0.5572407, 'binary_recall': 0.82119685, 'binary_specificity': 0.97587246, 'binary_f1_score': 0.6639464}
confusion matrix:
       0     1
0  36604   905
1    248  1139
---- Validation: 
scalar performance:
{'acc': 0.96215534, 'precision': 0.73561484, 'recall': 0.8565706, 'specificity': 0.8565706, 'f1': 0.78203, 'auroc': 0.9605825, 'binary_precision': 0.48095757, 'binary_recall': 0.74285716, 'binary_specificity': 0.9702841, 'binary_f1_score': 0.58388376}
confusion matrix:
       0    1
0  15575  477
1    153  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95959145, 'precision': 0.7046086, 'recall': 0.8707938, 'specificity': 0.8707938, 'f1': 0.76049757, 'auroc': 0.9541638, 'binary_precision': 0.41653666, 'binary_recall': 0.7761628, 'binary_specificity': 0.9654248, 'binary_f1_score': 0.542132}
confusion matrix:
       0    1
0  10443  374
1     77  267
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 7
val acc:0.9621553421020508, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 22,now: 2024-05-29 05:03:25.983662,epoch time: 0:18:27.003526,used: 6:45:30.427307,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9697398, 'precision': 0.7723526, 'recall': 0.89487636, 'specificity': 0.89487636, 'f1': 0.8209597, 'auroc': 0.977543, 'binary_precision': 0.5517073, 'binary_recall': 0.8142549, 'binary_specificity': 0.9754979, 'binary_f1_score': 0.6577493}
confusion matrix:
       0     1
0  36588   919
1    258  1131
---- Validation: 
scalar performance:
{'acc': 0.96365714, 'precision': 0.742534, 'recall': 0.86139524, 'specificity': 0.86139524, 'f1': 0.7886847, 'auroc': 0.9590546, 'binary_precision': 0.49446902, 'binary_recall': 0.7512605, 'binary_specificity': 0.97153, 'binary_f1_score': 0.5963976}
confusion matrix:
       0    1
0  15595  457
1    148  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9565451, 'precision': 0.6943075, 'recall': 0.87062943, 'specificity': 0.87062943, 'f1': 0.7511033, 'auroc': 0.94797367, 'binary_precision': 0.3958641, 'binary_recall': 0.7790698, 'binary_specificity': 0.96218914, 'binary_f1_score': 0.5249755}
confusion matrix:
       0    1
0  10408  409
1     76  268
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 8
val acc:0.9636571407318115, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 23,now: 2024-05-29 05:21:52.785895,epoch time: 0:18:26.802233,used: 7:03:57.229540,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96608907, 'precision': 0.75510734, 'recall': 0.9255676, 'specificity': 0.9255676, 'f1': 0.8161105, 'auroc': 0.97516257, 'binary_precision': 0.5147059, 'binary_recall': 0.88192946, 'binary_specificity': 0.96920574, 'binary_f1_score': 0.65003985}
confusion matrix:
       0     1
0  36352  1155
1    164  1225
---- Validation: 
scalar performance:
{'acc': 0.95789033, 'precision': 0.72176206, 'recall': 0.8883449, 'specificity': 0.8883449, 'f1': 0.778911, 'auroc': 0.9606185, 'binary_precision': 0.45065176, 'binary_recall': 0.8134454, 'binary_specificity': 0.96324444, 'binary_f1_score': 0.579988}
confusion matrix:
       0    1
0  15462  590
1    111  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567243, 'precision': 0.70069087, 'recall': 0.9143471, 'specificity': 0.9143471, 'f1': 0.76522624, 'auroc': 0.9538481, 'binary_precision': 0.40569878, 'binary_recall': 0.86918604, 'binary_specificity': 0.9595082, 'binary_f1_score': 0.5531915}
confusion matrix:
       0    1
0  10379  438
1     45  299
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 9
val acc:0.9578903317451477, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 24,now: 2024-05-29 05:40:21.910961,epoch time: 0:18:29.125066,used: 7:22:26.354606,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97308207, 'precision': 0.79679275, 'recall': 0.8480798, 'specificity': 0.8480798, 'f1': 0.8201686, 'auroc': 0.95581126, 'binary_precision': 0.6042683, 'binary_recall': 0.71346295, 'binary_specificity': 0.9826966, 'binary_f1_score': 0.6543414}
confusion matrix:
       0    1
0  36858  649
1    398  991
---- Validation: 
scalar performance:
{'acc': 0.9677419, 'precision': 0.76399994, 'recall': 0.8068703, 'specificity': 0.8068703, 'f1': 0.7836319, 'auroc': 0.92850685, 'binary_precision': 0.5416667, 'binary_recall': 0.63361347, 'binary_specificity': 0.9801271, 'binary_f1_score': 0.58404344}
confusion matrix:
       0    1
0  15733  319
1    218  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9526924, 'precision': 0.6723404, 'recall': 0.81094396, 'specificity': 0.81094396, 'f1': 0.71878976, 'auroc': 0.93677676, 'binary_precision': 0.35579938, 'binary_recall': 0.65988374, 'binary_specificity': 0.96200424, 'binary_f1_score': 0.4623218}
confusion matrix:
       0    1
0  10406  411
1    117  227
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 10
val acc:0.9677419066429138, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 25,now: 2024-05-29 05:58:48.895495,epoch time: 0:18:26.984534,used: 7:40:53.339140,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96760595, 'precision': 0.7616141, 'recall': 0.9152616, 'specificity': 0.9152616, 'f1': 0.81871116, 'auroc': 0.9794415, 'binary_precision': 0.52857774, 'binary_recall': 0.8588913, 'binary_specificity': 0.97163194, 'binary_f1_score': 0.6544158}
confusion matrix:
       0     1
0  36443  1064
1    196  1193
---- Validation: 
scalar performance:
{'acc': 0.96005285, 'precision': 0.72847843, 'recall': 0.8757101, 'specificity': 0.8757101, 'f1': 0.781567, 'auroc': 0.9585557, 'binary_precision': 0.46513945, 'binary_recall': 0.78487396, 'binary_specificity': 0.96654624, 'binary_f1_score': 0.58411515}
confusion matrix:
       0    1
0  15515  537
1    128  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94435984, 'precision': 0.66657454, 'recall': 0.8953029, 'specificity': 0.8953029, 'f1': 0.72676444, 'auroc': 0.9538162, 'binary_precision': 0.33838972, 'binary_recall': 0.84302324, 'binary_specificity': 0.9475825, 'binary_f1_score': 0.48293087}
confusion matrix:
       0    1
0  10250  567
1     54  290
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 11
val acc:0.9600528478622437, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 26,now: 2024-05-29 06:17:18.635181,epoch time: 0:18:29.739686,used: 7:59:23.078826,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96526635, 'precision': 0.7509183, 'recall': 0.89844966, 'specificity': 0.89844966, 'f1': 0.8056688, 'auroc': 0.96646726, 'binary_precision': 0.5084145, 'binary_recall': 0.82649386, 'binary_specificity': 0.9704055, 'binary_f1_score': 0.62955856}
confusion matrix:
       0     1
0  36397  1110
1    241  1148
---- Validation: 
scalar performance:
{'acc': 0.9605935, 'precision': 0.72925085, 'recall': 0.85899746, 'specificity': 0.85899746, 'f1': 0.77778167, 'auroc': 0.9343527, 'binary_precision': 0.4679958, 'binary_recall': 0.74957985, 'binary_specificity': 0.96841514, 'binary_f1_score': 0.57622737}
confusion matrix:
       0    1
0  15545  507
1    149  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.945435, 'precision': 0.66874635, 'recall': 0.8944503, 'specificity': 0.8944503, 'f1': 0.7290635, 'auroc': 0.9570556, 'binary_precision': 0.34282324, 'binary_recall': 0.84011626, 'binary_specificity': 0.9487843, 'binary_f1_score': 0.48694184}
confusion matrix:
       0    1
0  10263  554
1     55  289
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 12
val acc:0.9605935215950012, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 27,now: 2024-05-29 06:35:48.781529,epoch time: 0:18:30.146348,used: 8:17:53.225174,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9736991, 'precision': 0.79783034, 'recall': 0.8716246, 'specificity': 0.8716246, 'f1': 0.8301983, 'auroc': 0.9691336, 'binary_precision': 0.6045714, 'binary_recall': 0.7616991, 'binary_specificity': 0.9815501, 'binary_f1_score': 0.6741}
confusion matrix:
       0     1
0  36815   692
1    331  1058
---- Validation: 
scalar performance:
{'acc': 0.9653391, 'precision': 0.75050324, 'recall': 0.864695, 'specificity': 0.864695, 'f1': 0.79560417, 'auroc': 0.95084596, 'binary_precision': 0.5102041, 'binary_recall': 0.75630254, 'binary_specificity': 0.9730875, 'binary_f1_score': 0.60934323}
confusion matrix:
       0    1
0  15620  432
1    145  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9575307, 'precision': 0.6979657, 'recall': 0.87395245, 'specificity': 0.87395245, 'f1': 0.7551496, 'auroc': 0.95108724, 'binary_precision': 0.40298507, 'binary_recall': 0.78488374, 'binary_specificity': 0.96302116, 'binary_f1_score': 0.5325444}
confusion matrix:
       0    1
0  10417  400
1     74  270
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 13
val acc:0.9653391242027283, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 28,now: 2024-05-29 06:54:15.213553,epoch time: 0:18:26.432024,used: 8:36:19.657198,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9701769, 'precision': 0.77405846, 'recall': 0.9110485, 'specificity': 0.9110485, 'f1': 0.8271374, 'auroc': 0.97923225, 'binary_precision': 0.55388236, 'binary_recall': 0.84737223, 'binary_specificity': 0.9747247, 'binary_f1_score': 0.66989183}
confusion matrix:
       0     1
0  36559   948
1    212  1177
---- Validation: 
scalar performance:
{'acc': 0.9622755, 'precision': 0.736943, 'recall': 0.8695799, 'specificity': 0.8695799, 'f1': 0.7867424, 'auroc': 0.962132, 'binary_precision': 0.48261327, 'binary_recall': 0.7697479, 'binary_specificity': 0.9694119, 'binary_f1_score': 0.5932643}
confusion matrix:
       0    1
0  15561  491
1    137  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581579, 'precision': 0.70083636, 'recall': 0.8799051, 'specificity': 0.8799051, 'f1': 0.7589919, 'auroc': 0.9600737, 'binary_precision': 0.40834576, 'binary_recall': 0.79651165, 'binary_specificity': 0.9632985, 'binary_f1_score': 0.5399015}
confusion matrix:
       0    1
0  10420  397
1     70  274
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 14
val acc:0.962275505065918, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 29,now: 2024-05-29 07:12:39.580831,epoch time: 0:18:24.367278,used: 8:54:44.024476,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9707682, 'precision': 0.7778818, 'recall': 0.8947163, 'specificity': 0.8947163, 'f1': 0.82490647, 'auroc': 0.9773183, 'binary_precision': 0.56281155, 'binary_recall': 0.81281495, 'binary_specificity': 0.9766177, 'binary_f1_score': 0.6650957}
confusion matrix:
       0     1
0  36630   877
1    260  1129
---- Validation: 
scalar performance:
{'acc': 0.9622154, 'precision': 0.73535955, 'recall': 0.8485099, 'specificity': 0.8485099, 'f1': 0.77946067, 'auroc': 0.9539372, 'binary_precision': 0.48106903, 'binary_recall': 0.72605044, 'binary_specificity': 0.9709694, 'binary_f1_score': 0.5787006}
confusion matrix:
       0    1
0  15586  466
1    163  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95968103, 'precision': 0.7051102, 'recall': 0.8722473, 'specificity': 0.8722473, 'f1': 0.7612597, 'auroc': 0.9562932, 'binary_precision': 0.41744548, 'binary_recall': 0.7790698, 'binary_specificity': 0.9654248, 'binary_f1_score': 0.5436105}
confusion matrix:
       0    1
0  10443  374
1     76  268
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897891.png
early stop counter: 15
val acc:0.9622154235839844, best validation acc: 0.972427487373352, corresponding to test acc:                         0.961920976638794 / 0.9691783785820007
after epoch: 30,now: 2024-05-29 07:31:09.157504,epoch time: 0:18:29.576673,used: 9:13:13.601149,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_22_17_55_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:13:13.601149 at 2024-05-29 07:31:09.157504
persisted model performance metric: 

scalar performance:
{'acc': 0.9626378, 'precision': 0.7137111, 'recall': 0.8484419, 'specificity': 0.8484419, 'f1': 0.7628875, 'auroc': 0.9501834, 'binary_precision': 0.4363002, 'binary_recall': 0.7267442, 'binary_specificity': 0.9701396, 'binary_f1_score': 0.5452563}
confusion matrix:
       0    1
0  10494  323
1     94  250
oracle model performance metric: 

scalar performance:
{'acc': 0.9663113, 'precision': 0.7178736, 'recall': 0.7166469, 'specificity': 0.7166469, 'f1': 0.71725833, 'auroc': 0.9491084, 'binary_precision': 0.45321637, 'binary_recall': 0.4505814, 'binary_specificity': 0.9827124, 'binary_f1_score': 0.45189506}
confusion matrix:
       0    1
0  10630  187
1    189  155
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496817 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496817 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476803 KiB |  10962 MiB |   5907 TiB |   5907 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   5898 TiB |   5898 TiB |
|       from small pool |  88963 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11400 MiB |  11400 MiB |  39628 MiB |  28228 MiB |
|       from large pool |  11274 MiB |  11274 MiB |  39418 MiB |  28144 MiB |
|       from small pool |    126 MiB |    126 MiB |    210 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1348 MiB |   2595 MiB |   1926 TiB |   1926 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1915 TiB |   1915 TiB |
|       from small pool |      9 MiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5565    |    7764    |  489509 K  |  489503 K  |
|       from large pool |      87    |     909    |  230801 K  |  230801 K  |
|       from small pool |    5478    |    7642    |  258707 K  |  258702 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5565    |    7764    |  489509 K  |  489503 K  |
|       from large pool |      87    |     909    |  230801 K  |  230801 K  |
|       from small pool |    5478    |    7642    |  258707 K  |  258702 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     239    |     239    |     695    |     456    |
|       from large pool |     176    |     176    |     590    |     414    |
|       from small pool |      63    |      63    |     105    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2768    |  260413 K  |  260413 K  |
|       from large pool |      23    |      65    |  122802 K  |  122802 K  |
|       from small pool |      51    |    2747    |  137611 K  |  137611 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5907 TiB |   5907 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5898 TiB |   5898 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1834 MiB |  11400 MiB |  39628 MiB |  37794 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     98 MiB |    126 MiB |    210 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1926 TiB |   1926 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1915 TiB |   1915 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  489509 K  |  489509 K  |
|       from large pool |       2    |     909    |  230801 K  |  230801 K  |
|       from small pool |       0    |    7642    |  258707 K  |  258707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  489509 K  |  489509 K  |
|       from large pool |       2    |     909    |  230801 K  |  230801 K  |
|       from small pool |       0    |    7642    |  258707 K  |  258707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     239    |     695    |     612    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      49    |      63    |     105    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  260416 K  |  260416 K  |
|       from large pool |       4    |      65    |  122802 K  |  122802 K  |
|       from small pool |       0    |    2747    |  137613 K  |  137613 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5932 TiB |   5932 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5923 TiB |   5923 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5907 TiB |   5907 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5898 TiB |   5898 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1834 MiB |  11400 MiB |  39628 MiB |  37794 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     98 MiB |    126 MiB |    210 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1926 TiB |   1926 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1915 TiB |   1915 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  489509 K  |  489509 K  |
|       from large pool |       2    |     909    |  230801 K  |  230801 K  |
|       from small pool |       0    |    7642    |  258707 K  |  258707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  489509 K  |  489509 K  |
|       from large pool |       2    |     909    |  230801 K  |  230801 K  |
|       from small pool |       0    |    7642    |  258707 K  |  258707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     239    |     695    |     612    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      49    |      63    |     105    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  260416 K  |  260416 K  |
|       from large pool |       4    |      65    |  122802 K  |  122802 K  |
|       from small pool |       0    |    2747    |  137613 K  |  137613 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891

 Experiment start at: 2024-05-29 07:40:59.244771
before training, model accuracy: 0.5330235362052917
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9800931, 'precision': 0.80474496, 'recall': 0.71395475, 'specificity': 0.71395475, 'f1': 0.7509049, 'auroc': 0.9315099, 'binary_precision': 0.6233184, 'binary_recall': 0.434375, 'binary_specificity': 0.9935345, 'binary_f1_score': 0.5119705}
confusion matrix:
       0    1
0  38724  252
1    543  417
---- Validation: 
scalar performance:
{'acc': 0.9785956, 'precision': 0.77196777, 'recall': 0.7904684, 'specificity': 0.7904684, 'f1': 0.78089094, 'auroc': 0.93596774, 'binary_precision': 0.5540541, 'binary_recall': 0.5927711, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.57275903}
confusion matrix:
       0    1
0  16533  198
1    169  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.7028378, 'recall': 0.51415247, 'specificity': 0.51415247, 'f1': 0.5092548, 'auroc': 0.8055698, 'binary_precision': 0.48, 'binary_recall': 0.031088082, 'binary_specificity': 0.9972169, 'binary_f1_score': 0.05839416}
confusion matrix:
      0   1
0  9316  26
1   748  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 08:00:47.138169,epoch time: 0:19:47.893398,used: 0:19:47.893398,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.980594, 'precision': 0.84050965, 'recall': 0.6693413, 'specificity': 0.6693413, 'f1': 0.7246482, 'auroc': 0.9436332, 'binary_precision': 0.6970339, 'binary_recall': 0.3423517, 'binary_specificity': 0.996331, 'binary_f1_score': 0.45917657}
confusion matrix:
       0    1
0  38832  143
1    632  329
---- Validation: 
scalar performance:
{'acc': 0.97917885, 'precision': 0.8126969, 'recall': 0.6556497, 'specificity': 0.6556497, 'f1': 0.70633066, 'auroc': 0.9346905, 'binary_precision': 0.64215684, 'binary_recall': 0.31566265, 'binary_specificity': 0.9956368, 'binary_f1_score': 0.42326334}
confusion matrix:
       0    1
0  16658   73
1    284  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91922086, 'precision': 0.65313035, 'recall': 0.5385876, 'specificity': 0.5385876, 'f1': 0.55105585, 'auroc': 0.86664945, 'binary_precision': 0.37704918, 'binary_recall': 0.08937824, 'binary_specificity': 0.987797, 'binary_f1_score': 0.14450261}
confusion matrix:
      0    1
0  9228  114
1   703   69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
better model found
persisted
after epoch: 2,now: 2024-05-29 08:19:05.079002,epoch time: 0:18:17.940833,used: 0:38:05.834231,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9819211, 'precision': 0.8617681, 'recall': 0.69082725, 'specificity': 0.69082725, 'f1': 0.748474, 'auroc': 0.9483812, 'binary_precision': 0.73852295, 'binary_recall': 0.3850156, 'binary_specificity': 0.9966389, 'binary_f1_score': 0.50615597}
confusion matrix:
       0    1
0  38844  131
1    591  370
---- Validation: 
scalar performance:
{'acc': 0.9811618, 'precision': 0.8548653, 'recall': 0.6766397, 'specificity': 0.6766397, 'f1': 0.7342992, 'auroc': 0.9459747, 'binary_precision': 0.7254902, 'binary_recall': 0.3566265, 'binary_specificity': 0.9966529, 'binary_f1_score': 0.47819063}
confusion matrix:
       0    1
0  16675   56
1    267  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231758, 'precision': 0.6158301, 'recall': 0.502109, 'specificity': 0.502109, 'f1': 0.48511407, 'auroc': 0.8151205, 'binary_precision': 0.30769232, 'binary_recall': 0.005181347, 'binary_specificity': 0.9990366, 'binary_f1_score': 0.010191083}
confusion matrix:
      0  1
0  9333  9
1   768  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
better model found
persisted
after epoch: 3,now: 2024-05-29 08:37:16.343279,epoch time: 0:18:11.264277,used: 0:56:17.098508,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9801933, 'precision': 0.7858923, 'recall': 0.81052697, 'specificity': 0.81052697, 'f1': 0.797664, 'auroc': 0.96117675, 'binary_precision': 0.5808613, 'binary_recall': 0.6322917, 'binary_specificity': 0.9887623, 'binary_f1_score': 0.60548633}
confusion matrix:
       0    1
0  38538  438
1    353  607
---- Validation: 
scalar performance:
{'acc': 0.9778374, 'precision': 0.76274514, 'recall': 0.8253279, 'specificity': 0.8253279, 'f1': 0.7904419, 'auroc': 0.9560054, 'binary_precision': 0.5338491, 'binary_recall': 0.6650602, 'binary_specificity': 0.9855956, 'binary_f1_score': 0.59227467}
confusion matrix:
       0    1
0  16490  241
1    139  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.6612522, 'recall': 0.5141579, 'specificity': 0.5141579, 'f1': 0.50970083, 'auroc': 0.7857677, 'binary_precision': 0.3968254, 'binary_recall': 0.03238342, 'binary_specificity': 0.99593234, 'binary_f1_score': 0.05988024}
confusion matrix:
      0   1
0  9304  38
1   747  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
early stop counter: 1
val acc:0.9778373837471008, best validation acc: 0.9811617732048035, corresponding to test acc:                         0.9231758117675781 / 0.9234724044799805
after epoch: 4,now: 2024-05-29 08:55:40.263904,epoch time: 0:18:23.920625,used: 1:14:41.019133,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98392427, 'precision': 0.8521267, 'recall': 0.77304757, 'specificity': 0.77304757, 'f1': 0.807292, 'auroc': 0.9695067, 'binary_precision': 0.71524966, 'binary_recall': 0.55150884, 'binary_specificity': 0.9945863, 'binary_f1_score': 0.6227968}
confusion matrix:
       0    1
0  38764  211
1    431  530
---- Validation: 
scalar performance:
{'acc': 0.98192, 'precision': 0.823, 'recall': 0.7604486, 'specificity': 0.7604486, 'f1': 0.78815997, 'auroc': 0.96212846, 'binary_precision': 0.6576577, 'binary_recall': 0.52771086, 'binary_specificity': 0.9931863, 'binary_f1_score': 0.5855615}
confusion matrix:
       0    1
0  16617  114
1    196  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9213961, 'precision': 0.67153203, 'recall': 0.53204125, 'specificity': 0.53204125, 'f1': 0.5411686, 'auroc': 0.83337593, 'binary_precision': 0.4148148, 'binary_recall': 0.07253886, 'binary_specificity': 0.9915436, 'binary_f1_score': 0.123484015}
confusion matrix:
      0   1
0  9263  79
1   716  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
better model found
persisted
after epoch: 5,now: 2024-05-29 09:13:59.130817,epoch time: 0:18:18.866913,used: 1:32:59.886046,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98314804, 'precision': 0.8144708, 'recall': 0.8428706, 'specificity': 0.8428706, 'f1': 0.8280152, 'auroc': 0.96683013, 'binary_precision': 0.6364504, 'binary_recall': 0.69551617, 'binary_specificity': 0.990225, 'binary_f1_score': 0.6646736}
confusion matrix:
       0    1
0  38596  381
1    292  667
---- Validation: 
scalar performance:
{'acc': 0.9804619, 'precision': 0.7843136, 'recall': 0.8619208, 'specificity': 0.8619208, 'f1': 0.8181024, 'auroc': 0.9636905, 'binary_precision': 0.575188, 'binary_recall': 0.7373494, 'binary_specificity': 0.98649216, 'binary_f1_score': 0.64625126}
confusion matrix:
       0    1
0  16505  226
1    109  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231758, 'precision': 0.7169047, 'recall': 0.6132144, 'specificity': 0.6132144, 'f1': 0.64442384, 'auroc': 0.84333885, 'binary_precision': 0.49354005, 'binary_recall': 0.24740933, 'binary_specificity': 0.97901946, 'binary_f1_score': 0.32959446}
confusion matrix:
      0    1
0  9146  196
1   581  191
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
early stop counter: 1
val acc:0.9804618954658508, best validation acc: 0.9819200038909912, corresponding to test acc:                         0.9213960766792297 / 0.9234724044799805
after epoch: 6,now: 2024-05-29 09:32:24.885096,epoch time: 0:18:25.754279,used: 1:51:25.640325,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9800681, 'precision': 0.78135264, 'recall': 0.8421167, 'specificity': 0.8421167, 'f1': 0.80855054, 'auroc': 0.97241646, 'binary_precision': 0.5702128, 'binary_recall': 0.6971904, 'binary_specificity': 0.98704296, 'binary_f1_score': 0.62734085}
confusion matrix:
       0    1
0  38470  505
1    291  670
---- Validation: 
scalar performance:
{'acc': 0.98139507, 'precision': 0.7960119, 'recall': 0.84242505, 'specificity': 0.84242505, 'f1': 0.81740886, 'auroc': 0.9672601, 'binary_precision': 0.59958506, 'binary_recall': 0.69638556, 'binary_specificity': 0.98846453, 'binary_f1_score': 0.6443701}
confusion matrix:
       0    1
0  16538  193
1    126  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9102234, 'precision': 0.68495136, 'recall': 0.69413674, 'specificity': 0.69413674, 'f1': 0.6893917, 'auroc': 0.85365295, 'binary_precision': 0.4164619, 'binary_recall': 0.43911916, 'binary_specificity': 0.9491544, 'binary_f1_score': 0.42749056}
confusion matrix:
      0    1
0  8867  475
1   433  339
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
early stop counter: 2
val acc:0.9813950657844543, best validation acc: 0.9819200038909912, corresponding to test acc:                         0.9213960766792297 / 0.9234724044799805
after epoch: 7,now: 2024-05-29 09:51:00.759003,epoch time: 0:18:35.873907,used: 2:10:01.514232,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98382413, 'precision': 0.8175736, 'recall': 0.86636937, 'specificity': 0.86636937, 'f1': 0.84011054, 'auroc': 0.977005, 'binary_precision': 0.6415094, 'binary_recall': 0.74297607, 'binary_specificity': 0.98976266, 'binary_f1_score': 0.68852454}
confusion matrix:
       0    1
0  38576  399
1    247  714
---- Validation: 
scalar performance:
{'acc': 0.98296976, 'precision': 0.8082832, 'recall': 0.8702554, 'specificity': 0.8702554, 'f1': 0.83623695, 'auroc': 0.9690155, 'binary_precision': 0.6227545, 'binary_recall': 0.7518072, 'binary_specificity': 0.9887036, 'binary_f1_score': 0.6812227}
confusion matrix:
       0    1
0  16542  189
1    103  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230769, 'precision': 0.6860797, 'recall': 0.5145325, 'specificity': 0.5145325, 'f1': 0.5101417, 'auroc': 0.75555015, 'binary_precision': 0.44642857, 'binary_recall': 0.03238342, 'binary_specificity': 0.99668163, 'binary_f1_score': 0.060386475}
confusion matrix:
      0   1
0  9311  31
1   747  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
better model found
persisted
after epoch: 8,now: 2024-05-29 10:09:35.463685,epoch time: 0:18:34.704682,used: 2:28:36.218914,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98510116, 'precision': 0.84245837, 'recall': 0.8379336, 'specificity': 0.8379336, 'f1': 0.84018004, 'auroc': 0.9755407, 'binary_precision': 0.69271386, 'binary_recall': 0.68333334, 'binary_specificity': 0.99253386, 'binary_f1_score': 0.6879916}
confusion matrix:
       0    1
0  38685  291
1    304  656
---- Validation: 
scalar performance:
{'acc': 0.9858859, 'precision': 0.85403335, 'recall': 0.8423763, 'specificity': 0.8423763, 'f1': 0.84810114, 'auroc': 0.9577606, 'binary_precision': 0.7157107, 'binary_recall': 0.6915663, 'binary_specificity': 0.9931863, 'binary_f1_score': 0.70343137}
confusion matrix:
       0    1
0  16617  114
1    128  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92287916, 'precision': 0.67097986, 'recall': 0.51145476, 'specificity': 0.51145476, 'f1': 0.50429547, 'auroc': 0.7107266, 'binary_precision': 0.41666666, 'binary_recall': 0.025906736, 'binary_specificity': 0.9970028, 'binary_f1_score': 0.048780486}
confusion matrix:
      0   1
0  9314  28
1   752  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897891.png
better model found
persisted
after epoch: 9,now: 2024-05-29 10:28:06.997465,epoch time: 0:18:31.533780,used: 2:47:07.752694,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_07_40_59_seed_0_20897891
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
slurmstepd: error: *** JOB 20897891 ON gpusrv27 CANCELLED AT 2024-05-29T10:35:42 ***
