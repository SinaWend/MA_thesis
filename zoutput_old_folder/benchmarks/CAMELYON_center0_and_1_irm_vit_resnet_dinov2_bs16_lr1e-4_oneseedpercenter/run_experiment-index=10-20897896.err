Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon May 27 19:25:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896

 Experiment start at: 2024-05-27 19:33:17.503646
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.75810224, 'recall': 0.7604708, 'specificity': 0.7604708, 'f1': 0.7592805, 'auroc': 0.9325843, 'binary_precision': 0.5323015, 'binary_recall': 0.5373641, 'binary_specificity': 0.9835775, 'binary_f1_score': 0.5348208}
confusion matrix:
       0    1
0  41625  695
1    681  791
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.73936087, 'recall': 0.77577233, 'specificity': 0.77577233, 'f1': 0.7561232, 'auroc': 0.9304758, 'binary_precision': 0.49395972, 'binary_recall': 0.57231724, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.5302593}
confusion matrix:
       0    1
0  17772  377
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.88541114, 'recall': 0.8199195, 'specificity': 0.8199195, 'f1': 0.8493111, 'auroc': 0.9309803, 'binary_precision': 0.7860465, 'binary_recall': 0.6475096, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.710084}
confusion matrix:
      0    1
0  5951   46
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-27 19:54:28.700847,epoch time: 0:21:11.197201,used: 0:21:11.197201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9714788, 'precision': 0.8011415, 'recall': 0.6872194, 'specificity': 0.6872194, 'f1': 0.7297236, 'auroc': 0.9557042, 'binary_precision': 0.6234773, 'binary_recall': 0.3824728, 'binary_specificity': 0.99196595, 'binary_f1_score': 0.47410524}
confusion matrix:
       0    1
0  41980  340
1    909  563
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.8203063, 'recall': 0.63976717, 'specificity': 0.63976717, 'f1': 0.691819, 'auroc': 0.9518235, 'binary_precision': 0.66545457, 'binary_recall': 0.28460342, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.39869282}
confusion matrix:
       0    1
0  18057   92
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.82301795, 'recall': 0.59570014, 'specificity': 0.59570014, 'f1': 0.6421798, 'auroc': 0.93518776, 'binary_precision': 0.68, 'binary_recall': 0.1954023, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5973  24
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
better model found
persisted
after epoch: 2,now: 2024-05-27 20:14:27.699315,epoch time: 0:19:58.998468,used: 0:41:10.195669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.971867, 'precision': 0.78325367, 'recall': 0.7839971, 'specificity': 0.7839971, 'f1': 0.7836249, 'auroc': 0.9603432, 'binary_precision': 0.58101696, 'binary_recall': 0.5825969, 'binary_specificity': 0.98539734, 'binary_f1_score': 0.5818059}
confusion matrix:
       0    1
0  41703  618
1    614  857
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.777512, 'recall': 0.7641661, 'specificity': 0.7641661, 'f1': 0.7706573, 'auroc': 0.95980775, 'binary_precision': 0.57119477, 'binary_recall': 0.5427683, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.5566188}
confusion matrix:
       0    1
0  17887  262
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.8796295, 'recall': 0.7667799, 'specificity': 0.7667799, 'f1': 0.8123787, 'auroc': 0.9460938, 'binary_precision': 0.7790055, 'binary_recall': 0.54022986, 'binary_specificity': 0.99333, 'binary_f1_score': 0.6380091}
confusion matrix:
      0    1
0  5957   40
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 1
val acc:0.9704129695892334, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 3,now: 2024-05-27 20:33:57.209267,epoch time: 0:19:29.509952,used: 1:00:39.705621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9683275, 'precision': 0.7553662, 'recall': 0.8425345, 'specificity': 0.8425345, 'f1': 0.79184186, 'auroc': 0.9550718, 'binary_precision': 0.521021, 'binary_recall': 0.70768183, 'binary_specificity': 0.97738713, 'binary_f1_score': 0.600173}
confusion matrix:
       0     1
0  41364   957
1    430  1041
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7586785, 'recall': 0.8425975, 'specificity': 0.8425975, 'f1': 0.7940798, 'auroc': 0.9587233, 'binary_precision': 0.5278422, 'binary_recall': 0.7076205, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.60465115}
confusion matrix:
       0    1
0  17742  407
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.81762505, 'recall': 0.7172197, 'specificity': 0.7172197, 'f1': 0.75696045, 'auroc': 0.9374745, 'binary_precision': 0.65909094, 'binary_recall': 0.44444445, 'binary_specificity': 0.989995, 'binary_f1_score': 0.5308925}
confusion matrix:
      0    1
0  5937   60
1   145  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 2
val acc:0.9683375954627991, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 4,now: 2024-05-27 20:54:05.154399,epoch time: 0:20:07.945132,used: 1:20:47.650753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9716158, 'precision': 0.7848641, 'recall': 0.7584357, 'specificity': 0.7584357, 'f1': 0.77094257, 'auroc': 0.9576874, 'binary_precision': 0.58602554, 'binary_recall': 0.5298913, 'binary_specificity': 0.98698014, 'binary_f1_score': 0.5565465}
confusion matrix:
       0    1
0  41769  551
1    692  780
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.75420153, 'recall': 0.770179, 'specificity': 0.770179, 'f1': 0.7619189, 'auroc': 0.9530626, 'binary_precision': 0.5240876, 'binary_recall': 0.55832034, 'binary_specificity': 0.9820376, 'binary_f1_score': 0.54066265}
confusion matrix:
       0    1
0  17823  326
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8595891, 'recall': 0.6981479, 'specificity': 0.6981479, 'f1': 0.7532693, 'auroc': 0.9511303, 'binary_precision': 0.7446808, 'binary_recall': 0.40229884, 'binary_specificity': 0.993997, 'binary_f1_score': 0.52238804}
confusion matrix:
      0    1
0  5961   36
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 3
val acc:0.967539370059967, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 5,now: 2024-05-27 21:14:26.516909,epoch time: 0:20:21.362510,used: 1:41:09.013263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.7497819, 'recall': 0.7829121, 'specificity': 0.7829121, 'f1': 0.76519793, 'auroc': 0.9584397, 'binary_precision': 0.5140466, 'binary_recall': 0.585034, 'binary_specificity': 0.98079014, 'binary_f1_score': 0.5472479}
confusion matrix:
       0    1
0  41509  813
1    610  860
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.73463947, 'recall': 0.7970005, 'specificity': 0.7970005, 'f1': 0.761701, 'auroc': 0.9533505, 'binary_precision': 0.48296836, 'binary_recall': 0.61741835, 'binary_specificity': 0.9765827, 'binary_f1_score': 0.5419795}
confusion matrix:
       0    1
0  17724  425
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.87103176, 'recall': 0.62293696, 'specificity': 0.62293696, 'f1': 0.6795733, 'auroc': 0.94372153, 'binary_precision': 0.77380955, 'binary_recall': 0.24904214, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3768116}
confusion matrix:
      0   1
0  5978  19
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 4
val acc:0.9642933011054993, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 6,now: 2024-05-27 21:35:11.487839,epoch time: 0:20:44.970930,used: 2:01:53.984193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.7578739, 'recall': 0.87878704, 'specificity': 0.87878704, 'f1': 0.8054629, 'auroc': 0.96121526, 'binary_precision': 0.5234411, 'binary_recall': 0.7823129, 'binary_specificity': 0.9752611, 'binary_f1_score': 0.62721574}
confusion matrix:
       0     1
0  41275  1047
1    320  1150
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7468583, 'recall': 0.87138754, 'specificity': 0.87138754, 'f1': 0.79498136, 'auroc': 0.9568614, 'binary_precision': 0.5020284, 'binary_recall': 0.7698289, 'binary_specificity': 0.97294617, 'binary_f1_score': 0.60773486}
confusion matrix:
       0    1
0  17658  491
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8891252, 'recall': 0.70847684, 'specificity': 0.70847684, 'f1': 0.7690375, 'auroc': 0.94300073, 'binary_precision': 0.8029197, 'binary_recall': 0.42145595, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.5527638}
confusion matrix:
      0    1
0  5970   27
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 5
val acc:0.9659961462020874, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 7,now: 2024-05-27 21:55:20.621576,epoch time: 0:20:09.133737,used: 2:22:03.117930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97035986, 'precision': 0.7687086, 'recall': 0.8190956, 'specificity': 0.8190956, 'f1': 0.79150164, 'auroc': 0.96746004, 'binary_precision': 0.5494318, 'binary_recall': 0.6569294, 'binary_specificity': 0.9812618, 'binary_f1_score': 0.5983911}
confusion matrix:
       0    1
0  41527  793
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7518301, 'recall': 0.82023984, 'specificity': 0.82023984, 'f1': 0.78145105, 'auroc': 0.9584019, 'binary_precision': 0.5157385, 'binary_recall': 0.66251945, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.5799864}
confusion matrix:
       0    1
0  17749  400
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8512739, 'recall': 0.6828222, 'specificity': 0.6828222, 'f1': 0.7379434, 'auroc': 0.9519281, 'binary_precision': 0.7293233, 'binary_recall': 0.3716475, 'binary_specificity': 0.993997, 'binary_f1_score': 0.49238577}
confusion matrix:
      0   1
0  5961  36
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 6
val acc:0.9671669006347656, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 8,now: 2024-05-27 22:15:54.458993,epoch time: 0:20:33.837417,used: 2:42:36.955347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96839607, 'precision': 0.75617135, 'recall': 0.7769519, 'specificity': 0.7769519, 'f1': 0.76611114, 'auroc': 0.96006197, 'binary_precision': 0.5272727, 'binary_recall': 0.57171994, 'binary_specificity': 0.9821838, 'binary_f1_score': 0.5485975}
confusion matrix:
       0    1
0  41567  754
1    630  841
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7497152, 'recall': 0.82304716, 'specificity': 0.82304716, 'f1': 0.7811148, 'auroc': 0.95285624, 'binary_precision': 0.5112961, 'binary_recall': 0.6687403, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.57951486}
confusion matrix:
       0    1
0  17738  411
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.86590385, 'recall': 0.70023036, 'specificity': 0.70023036, 'f1': 0.7565389, 'auroc': 0.95031667, 'binary_precision': 0.75714284, 'binary_recall': 0.40613025, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.5286783}
confusion matrix:
      0    1
0  5963   34
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 7
val acc:0.9667943716049194, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 9,now: 2024-05-27 22:36:05.379465,epoch time: 0:20:10.920472,used: 3:02:47.875819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9679394, 'precision': 0.75351334, 'recall': 0.86177635, 'specificity': 0.86177635, 'f1': 0.7969651, 'auroc': 0.9702844, 'binary_precision': 0.5159325, 'binary_recall': 0.74796194, 'binary_specificity': 0.97559077, 'binary_f1_score': 0.61064893}
confusion matrix:
       0     1
0  41287  1033
1    371  1101
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.7334099, 'recall': 0.857204, 'specificity': 0.857204, 'f1': 0.78061056, 'auroc': 0.9602184, 'binary_precision': 0.47609562, 'binary_recall': 0.7433904, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.5804493}
confusion matrix:
       0    1
0  17623  526
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.88838565, 'recall': 0.74062705, 'specificity': 0.74062705, 'f1': 0.7955192, 'auroc': 0.9679698, 'binary_precision': 0.7987421, 'binary_recall': 0.48659003, 'binary_specificity': 0.994664, 'binary_f1_score': 0.6047619}
confusion matrix:
      0    1
0  5965   32
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 8
val acc:0.9632290601730347, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 10,now: 2024-05-27 22:56:05.056283,epoch time: 0:19:59.676818,used: 3:22:47.552637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9711591, 'precision': 0.78437936, 'recall': 0.7342657, 'specificity': 0.7342657, 'f1': 0.75666404, 'auroc': 0.9648944, 'binary_precision': 0.586722, 'binary_recall': 0.4802989, 'binary_specificity': 0.9882325, 'binary_f1_score': 0.52820325}
confusion matrix:
       0    1
0  41822  498
1    765  707
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7560564, 'recall': 0.7552881, 'specificity': 0.7552881, 'f1': 0.7556716, 'auroc': 0.9533942, 'binary_precision': 0.52886117, 'binary_recall': 0.5272162, 'binary_specificity': 0.98336, 'binary_f1_score': 0.5280374}
confusion matrix:
       0    1
0  17847  302
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.730695, 'recall': 0.538479, 'specificity': 0.538479, 'f1': 0.5586216, 'auroc': 0.94828093, 'binary_precision': 0.5, 'binary_recall': 0.08045977, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.13861386}
confusion matrix:
      0   1
0  5976  21
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 9
val acc:0.96775221824646, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 11,now: 2024-05-27 23:16:06.192255,epoch time: 0:20:01.135972,used: 3:42:48.688609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.969378, 'precision': 0.76180446, 'recall': 0.8276577, 'specificity': 0.8276577, 'f1': 0.7906302, 'auroc': 0.96483827, 'binary_precision': 0.5349839, 'binary_recall': 0.6757308, 'binary_specificity': 0.9795846, 'binary_f1_score': 0.5971764}
confusion matrix:
       0    1
0  41457  864
1    477  994
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7518891, 'recall': 0.82549024, 'specificity': 0.82549024, 'f1': 0.7834302, 'auroc': 0.954648, 'binary_precision': 0.51547617, 'binary_recall': 0.6734059, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.5839514}
confusion matrix:
       0    1
0  17742  407
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80710244, 'recall': 0.5897863, 'specificity': 0.5897863, 'f1': 0.63347316, 'auroc': 0.9512114, 'binary_precision': 0.6486486, 'binary_recall': 0.18390805, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28656715}
confusion matrix:
      0   1
0  5971  26
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 10
val acc:0.9671669006347656, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 12,now: 2024-05-27 23:36:15.152120,epoch time: 0:20:08.959865,used: 4:02:57.648474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9704284, 'precision': 0.76707685, 'recall': 0.87085295, 'specificity': 0.87085295, 'f1': 0.80954075, 'auroc': 0.97403085, 'binary_precision': 0.54247105, 'binary_recall': 0.76410604, 'binary_specificity': 0.9775998, 'binary_f1_score': 0.63449055}
confusion matrix:
       0     1
0  41373   948
1    347  1124
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.75098395, 'recall': 0.8441314, 'specificity': 0.8441314, 'f1': 0.78936934, 'auroc': 0.96377075, 'binary_precision': 0.51230425, 'binary_recall': 0.7122862, 'binary_specificity': 0.97597665, 'binary_f1_score': 0.59596616}
confusion matrix:
       0    1
0  17713  436
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.80736166, 'recall': 0.67757344, 'specificity': 0.67757344, 'f1': 0.72322947, 'auroc': 0.95002687, 'binary_precision': 0.6418919, 'binary_recall': 0.36398467, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.4645477}
confusion matrix:
      0   1
0  5944  53
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 11
val acc:0.9669540524482727, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 13,now: 2024-05-27 23:56:19.391540,epoch time: 0:20:04.239420,used: 4:23:01.887894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.7508942, 'recall': 0.84351957, 'specificity': 0.84351957, 'f1': 0.78911847, 'auroc': 0.9703094, 'binary_precision': 0.51199216, 'binary_recall': 0.7105978, 'binary_specificity': 0.9764414, 'binary_f1_score': 0.5951635}
confusion matrix:
       0     1
0  41323   997
1    426  1046
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.73958623, 'recall': 0.8400016, 'specificity': 0.8400016, 'f1': 0.779981, 'auroc': 0.95976144, 'binary_precision': 0.48975188, 'binary_recall': 0.7060653, 'binary_specificity': 0.9739379, 'binary_f1_score': 0.57834387}
confusion matrix:
       0    1
0  17676  473
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.82090676, 'recall': 0.6237688, 'specificity': 0.6237688, 'f1': 0.67450786, 'auroc': 0.9426591, 'binary_precision': 0.67346936, 'binary_recall': 0.25287357, 'binary_specificity': 0.994664, 'binary_f1_score': 0.367688}
confusion matrix:
      0   1
0  5965  32
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 12
val acc:0.9647722244262695, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 14,now: 2024-05-28 00:15:39.312725,epoch time: 0:19:19.921185,used: 4:42:21.809079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.74341697, 'recall': 0.8355183, 'specificity': 0.8355183, 'f1': 0.78123873, 'auroc': 0.971871, 'binary_precision': 0.4975681, 'binary_recall': 0.6954453, 'binary_specificity': 0.9755913, 'binary_f1_score': 0.5800964}
confusion matrix:
       0     1
0  41288  1033
1    448  1023
---- Validation: 
scalar performance:
{'acc': 0.9615794, 'precision': 0.72542137, 'recall': 0.8465992, 'specificity': 0.8465992, 'f1': 0.77143025, 'auroc': 0.95778817, 'binary_precision': 0.46085232, 'binary_recall': 0.7231726, 'binary_specificity': 0.9700259, 'binary_f1_score': 0.56295395}
confusion matrix:
       0    1
0  17605  544
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.83645284, 'recall': 0.550807, 'specificity': 0.550807, 'f1': 0.580274, 'auroc': 0.9299573, 'binary_precision': 0.7105263, 'binary_recall': 0.10344828, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.18060201}
confusion matrix:
      0   1
0  5986  11
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 13
val acc:0.9615793824195862, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 15,now: 2024-05-28 00:35:11.637244,epoch time: 0:19:32.324519,used: 5:01:54.133598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97227806, 'precision': 0.7774093, 'recall': 0.8798636, 'specificity': 0.8798636, 'f1': 0.81974727, 'auroc': 0.97730666, 'binary_precision': 0.56253064, 'binary_recall': 0.78080326, 'binary_specificity': 0.978924, 'binary_f1_score': 0.6539338}
confusion matrix:
       0     1
0  41431   892
1    322  1147
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7553093, 'recall': 0.8745193, 'specificity': 0.8745193, 'f1': 0.8022325, 'auroc': 0.96695876, 'binary_precision': 0.51875, 'binary_recall': 0.7744945, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.62133497}
confusion matrix:
       0    1
0  17687  462
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8188578, 'recall': 0.61060894, 'specificity': 0.61060894, 'f1': 0.6595616, 'auroc': 0.9495709, 'binary_precision': 0.67045456, 'binary_recall': 0.22605364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5968  29
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 14
val acc:0.9676989912986755, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 16,now: 2024-05-28 00:54:54.568803,epoch time: 0:19:42.931559,used: 5:21:37.065157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.75406027, 'recall': 0.8555281, 'specificity': 0.8555281, 'f1': 0.79533255, 'auroc': 0.9731221, 'binary_precision': 0.51747245, 'binary_recall': 0.73487425, 'binary_specificity': 0.97618204, 'binary_f1_score': 0.6073033}
confusion matrix:
       0     1
0  41313  1008
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.7384176, 'recall': 0.8562825, 'specificity': 0.8562825, 'f1': 0.78414947, 'auroc': 0.96252894, 'binary_precision': 0.4862104, 'binary_recall': 0.7402799, 'binary_specificity': 0.972285, 'binary_f1_score': 0.58692974}
confusion matrix:
       0    1
0  17646  503
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.82738936, 'recall': 0.6389277, 'specificity': 0.6389277, 'f1': 0.6914451, 'auroc': 0.9395485, 'binary_precision': 0.6851852, 'binary_recall': 0.2835249, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40108404}
confusion matrix:
      0   1
0  5963  34
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 15
val acc:0.9643465280532837, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 17,now: 2024-05-28 01:14:34.264660,epoch time: 0:19:39.695857,used: 5:41:16.761014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9730316, 'precision': 0.7832006, 'recall': 0.8696568, 'specificity': 0.8696568, 'f1': 0.82007074, 'auroc': 0.9773678, 'binary_precision': 0.5748842, 'binary_recall': 0.7588315, 'binary_specificity': 0.98048204, 'binary_f1_score': 0.6541728}
confusion matrix:
       0     1
0  41494   826
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7528166, 'recall': 0.8517972, 'specificity': 0.8517972, 'f1': 0.79320693, 'auroc': 0.96285945, 'binary_precision': 0.5154185, 'binary_recall': 0.7278383, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.60348165}
confusion matrix:
       0    1
0  17709  440
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.83362687, 'recall': 0.66724646, 'specificity': 0.66724646, 'f1': 0.7200922, 'auroc': 0.9544595, 'binary_precision': 0.6953125, 'binary_recall': 0.34099618, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.45758358}
confusion matrix:
      0   1
0  5958  39
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 16
val acc:0.9672732949256897, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 18,now: 2024-05-28 01:34:00.285141,epoch time: 0:19:26.020481,used: 6:00:42.781495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.75030065, 'recall': 0.885332, 'specificity': 0.885332, 'f1': 0.8016857, 'auroc': 0.9723669, 'binary_precision': 0.50778544, 'binary_recall': 0.7975544, 'binary_specificity': 0.97310966, 'binary_f1_score': 0.6205074}
confusion matrix:
       0     1
0  41182  1138
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.72506946, 'recall': 0.8814111, 'specificity': 0.8814111, 'f1': 0.78027797, 'auroc': 0.9571136, 'binary_precision': 0.4575514, 'binary_recall': 0.7962675, 'binary_specificity': 0.96655464, 'binary_f1_score': 0.5811578}
confusion matrix:
       0    1
0  17542  607
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8472494, 'recall': 0.6714114, 'specificity': 0.6714114, 'f1': 0.7266913, 'auroc': 0.9413513, 'binary_precision': 0.7222222, 'binary_recall': 0.348659, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4702842}
confusion matrix:
      0   1
0  5962  35
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 17
val acc:0.9607279896736145, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 19,now: 2024-05-28 01:53:30.728705,epoch time: 0:19:30.443564,used: 6:20:13.225059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97026855, 'precision': 0.7661308, 'recall': 0.87707937, 'specificity': 0.87707937, 'f1': 0.8109124, 'auroc': 0.9807031, 'binary_precision': 0.5401322, 'binary_recall': 0.77717394, 'binary_specificity': 0.97698486, 'binary_f1_score': 0.63732594}
confusion matrix:
       0     1
0  41346   974
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.7229635, 'recall': 0.85815936, 'specificity': 0.85815936, 'f1': 0.7726581, 'auroc': 0.96408033, 'binary_precision': 0.4550615, 'binary_recall': 0.748056, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.5658824}
confusion matrix:
       0    1
0  17573  576
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.84262395, 'recall': 0.61485726, 'specificity': 0.61485726, 'f1': 0.6670976, 'auroc': 0.93464714, 'binary_precision': 0.7176471, 'binary_recall': 0.23371647, 'binary_specificity': 0.995998, 'binary_f1_score': 0.35260117}
confusion matrix:
      0   1
0  5973  24
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 18
val acc:0.9607279896736145, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 20,now: 2024-05-28 02:13:04.672913,epoch time: 0:19:33.944208,used: 6:39:47.169267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9707024, 'precision': 0.7681351, 'recall': 0.8896958, 'specificity': 0.8896958, 'f1': 0.8163631, 'auroc': 0.97813153, 'binary_precision': 0.5432383, 'binary_recall': 0.8028552, 'binary_specificity': 0.97653645, 'binary_f1_score': 0.648011}
confusion matrix:
       0     1
0  41328   993
1    290  1181
---- Validation: 
scalar performance:
{'acc': 0.9628033, 'precision': 0.7325521, 'recall': 0.87123466, 'specificity': 0.87123466, 'f1': 0.7838239, 'auroc': 0.9618285, 'binary_precision': 0.47333333, 'binary_recall': 0.7729393, 'binary_specificity': 0.96953, 'binary_f1_score': 0.5871234}
confusion matrix:
       0    1
0  17596  553
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7967518, 'recall': 0.5821234, 'specificity': 0.5821234, 'f1': 0.62295926, 'auroc': 0.9274524, 'binary_precision': 0.62857145, 'binary_recall': 0.16858238, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5971  26
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 19
val acc:0.962803304195404, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 21,now: 2024-05-28 02:32:11.286166,epoch time: 0:19:06.613253,used: 6:58:53.782520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97104496, 'precision': 0.7723823, 'recall': 0.8347539, 'specificity': 0.8347539, 'f1': 0.80000716, 'auroc': 0.9746255, 'binary_precision': 0.5556775, 'binary_recall': 0.68864715, 'binary_specificity': 0.9808606, 'binary_f1_score': 0.61505765}
confusion matrix:
       0     1
0  41511   810
1    458  1013
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.74062973, 'recall': 0.834139, 'specificity': 0.834139, 'f1': 0.7788116, 'auroc': 0.96241426, 'binary_precision': 0.49227372, 'binary_recall': 0.69362366, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.5758554}
confusion matrix:
       0    1
0  17689  460
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.78281194, 'recall': 0.6579995, 'specificity': 0.6579995, 'f1': 0.70073617, 'auroc': 0.9457481, 'binary_precision': 0.5944056, 'binary_recall': 0.3256705, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.42079207}
confusion matrix:
      0   1
0  5939  58
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20897896.png
early stop counter: 20
val acc:0.9650382995605469, best validation acc: 0.9706258177757263, corresponding to test acc:                         0.9626078605651855 / 0.9779482483863831
after epoch: 22,now: 2024-05-28 02:51:42.715357,epoch time: 0:19:31.429191,used: 7:18:25.211711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_27_19_33_17_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 7:18:25.211711 at 2024-05-28 02:51:42.715357
persisted model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.8580371, 'recall': 0.5962838, 'specificity': 0.5962838, 'f1': 0.645702, 'auroc': 0.9358907, 'binary_precision': 0.75, 'binary_recall': 0.1954023, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3100304}
confusion matrix:
      0   1
0  5980  17
1   210  51
oracle model performance metric: 

scalar performance:
{'acc': 0.9785874, 'precision': 0.8970307, 'recall': 0.81475604, 'specificity': 0.81475604, 'f1': 0.850663, 'auroc': 0.9301547, 'binary_precision': 0.8097561, 'binary_recall': 0.6360153, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.71244633}
confusion matrix:
      0    1
0  5958   39
1    95  166
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1214 TiB |   1214 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1343 MiB |   1726 MiB | 435477 GiB | 435476 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 433317 GiB | 433316 GiB |
|       from small pool |     10 MiB |     11 MiB |   2159 GiB |   2159 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  101134 K  |  101131 K  |
|       from large pool |      87    |     909    |   47636 K  |   47636 K  |
|       from small pool |    3642    |    6631    |   53498 K  |   53494 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  101134 K  |  101131 K  |
|       from large pool |      87    |     909    |   47636 K  |   47636 K  |
|       from small pool |    3642    |    6631    |   53498 K  |   53494 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |    2768    |   51915 K  |   51915 K  |
|       from large pool |      20    |      59    |   23623 K  |   23623 K  |
|       from small pool |      56    |    2747    |   28291 K  |   28291 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1214 TiB |   1214 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 435477 GiB | 435477 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 433317 GiB | 433317 GiB |
|       from small pool |      0 KiB |     26 MiB |   2159 GiB |   2159 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  101134 K  |  101134 K  |
|       from large pool |       2    |     909    |   47636 K  |   47636 K  |
|       from small pool |       0    |    6631    |   53498 K  |   53498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  101134 K  |  101134 K  |
|       from large pool |       2    |     909    |   47636 K  |   47636 K  |
|       from small pool |       0    |    6631    |   53498 K  |   53498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   51916 K  |   51916 K  |
|       from large pool |       4    |      59    |   23623 K  |   23623 K  |
|       from small pool |       0    |    2747    |   28293 K  |   28293 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1219 TiB |   1219 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1217 TiB |   1217 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1214 TiB |   1214 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 435477 GiB | 435477 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 433317 GiB | 433317 GiB |
|       from small pool |      0 KiB |     26 MiB |   2159 GiB |   2159 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  101134 K  |  101134 K  |
|       from large pool |       2    |     909    |   47636 K  |   47636 K  |
|       from small pool |       0    |    6631    |   53498 K  |   53498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  101134 K  |  101134 K  |
|       from large pool |       2    |     909    |   47636 K  |   47636 K  |
|       from small pool |       0    |    6631    |   53498 K  |   53498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   51916 K  |   51916 K  |
|       from large pool |       4    |      59    |   23623 K  |   23623 K  |
|       from small pool |       0    |    2747    |   28293 K  |   28293 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896

 Experiment start at: 2024-05-28 03:00:58.097481
before training, model accuracy: 0.2590968608856201
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9597229, 'precision': 0.84716, 'recall': 0.6232006, 'specificity': 0.6232006, 'f1': 0.6764536, 'auroc': 0.93353283, 'binary_precision': 0.7307692, 'binary_recall': 0.25105104, 'binary_specificity': 0.9953501, 'binary_f1_score': 0.3737148}
confusion matrix:
       0    1
0  32965  154
1   1247  418
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9574212, 'precision': 0.85240686, 'recall': 0.5944648, 'specificity': 0.5944648, 'f1': 0.641857, 'auroc': 0.93198603, 'binary_precision': 0.7446808, 'binary_recall': 0.1923077, 'binary_specificity': 0.99662185, 'binary_f1_score': 0.30567685}
confusion matrix:
       0    1
0  14161   48
1    588  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99515706, 'precision': 0.497774, 'recall': 0.4998028, 'specificity': 0.4998028, 'f1': 0.4987863, 'auroc': 0.77944195, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996056, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15206  6
1     68  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 03:24:15.221333,epoch time: 0:23:17.123852,used: 0:23:17.123852,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95929164, 'precision': 0.7778002, 'recall': 0.76700175, 'specificity': 0.76700175, 'f1': 0.7722775, 'auroc': 0.95078367, 'binary_precision': 0.57795864, 'binary_recall': 0.55435437, 'binary_specificity': 0.9796491, 'binary_f1_score': 0.56591046}
confusion matrix:
       0    1
0  32445  674
1    742  923
---- Validation: 
scalar performance:
{'acc': 0.95922875, 'precision': 0.7889217, 'recall': 0.7283462, 'specificity': 0.7283462, 'f1': 0.754572, 'auroc': 0.9482366, 'binary_precision': 0.60456944, 'binary_recall': 0.47252747, 'binary_specificity': 0.98416495, 'binary_f1_score': 0.5304549}
confusion matrix:
       0    1
0  13984  225
1    384  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9924084, 'precision': 0.6088526, 'recall': 0.6375037, 'specificity': 0.6375037, 'f1': 0.6214691, 'auroc': 0.8464136, 'binary_precision': 0.22093023, 'binary_recall': 0.27941176, 'binary_specificity': 0.9955956, 'binary_f1_score': 0.24675325}
confusion matrix:
       0   1
0  15145  67
1     49  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
better model found
persisted
after epoch: 2,now: 2024-05-28 03:44:31.567225,epoch time: 0:20:16.345892,used: 0:43:33.469744,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9581704, 'precision': 0.76706016, 'recall': 0.83714336, 'specificity': 0.83714336, 'f1': 0.7973403, 'auroc': 0.9545659, 'binary_precision': 0.54924953, 'binary_recall': 0.7033033, 'binary_specificity': 0.97098345, 'binary_f1_score': 0.61680275}
confusion matrix:
       0     1
0  32158   961
1    494  1171
---- Validation: 
scalar performance:
{'acc': 0.9569525, 'precision': 0.7649857, 'recall': 0.83336455, 'specificity': 0.83336455, 'f1': 0.7945808, 'auroc': 0.953946, 'binary_precision': 0.5457481, 'binary_recall': 0.6964286, 'binary_specificity': 0.9703005, 'binary_f1_score': 0.61194927}
confusion matrix:
       0    1
0  13787  422
1    221  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9886126, 'precision': 0.5871246, 'recall': 0.708798, 'specificity': 0.708798, 'f1': 0.62213135, 'auroc': 0.89257216, 'binary_precision': 0.17682926, 'binary_recall': 0.42647058, 'binary_specificity': 0.9911254, 'binary_f1_score': 0.24999997}
confusion matrix:
       0    1
0  15077  135
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 1
val acc:0.9569525122642517, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 3,now: 2024-05-28 04:04:45.831691,epoch time: 0:20:14.264466,used: 1:03:47.734210,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9613615, 'precision': 0.7855427, 'recall': 0.806306, 'specificity': 0.806306, 'f1': 0.79550314, 'auroc': 0.959887, 'binary_precision': 0.5895148, 'binary_recall': 0.6348348, 'binary_specificity': 0.9777771, 'binary_f1_score': 0.611336}
confusion matrix:
       0     1
0  32383   736
1    608  1057
---- Validation: 
scalar performance:
{'acc': 0.95809066, 'precision': 0.7715993, 'recall': 0.8046397, 'specificity': 0.8046397, 'f1': 0.7870138, 'auroc': 0.95373124, 'binary_precision': 0.5620438, 'binary_recall': 0.63461536, 'binary_specificity': 0.974664, 'binary_f1_score': 0.59612906}
confusion matrix:
       0    1
0  13849  360
1    266  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99260473, 'precision': 0.60591745, 'recall': 0.6229621, 'specificity': 0.6229621, 'f1': 0.6137885, 'auroc': 0.8420689, 'binary_precision': 0.21518987, 'binary_recall': 0.25, 'binary_specificity': 0.9959243, 'binary_f1_score': 0.23129252}
confusion matrix:
       0   1
0  15150  62
1     51  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 2
val acc:0.9580906629562378, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 4,now: 2024-05-28 04:25:31.119878,epoch time: 0:20:45.288187,used: 1:24:33.022397,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9613615, 'precision': 0.78254557, 'recall': 0.8345411, 'specificity': 0.8345411, 'f1': 0.80599713, 'auroc': 0.966327, 'binary_precision': 0.5806128, 'binary_recall': 0.6942943, 'binary_specificity': 0.9747879, 'binary_f1_score': 0.63238513}
confusion matrix:
       0     1
0  32284   835
1    509  1156
---- Validation: 
scalar performance:
{'acc': 0.95822453, 'precision': 0.77025306, 'recall': 0.8451108, 'specificity': 0.8451108, 'f1': 0.80233413, 'auroc': 0.9568691, 'binary_precision': 0.55508476, 'binary_recall': 0.7197802, 'binary_specificity': 0.9704413, 'binary_f1_score': 0.6267943}
confusion matrix:
       0    1
0  13789  420
1    204  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905759, 'precision': 0.5953226, 'recall': 0.67318374, 'specificity': 0.67318374, 'f1': 0.62262905, 'auroc': 0.80767965, 'binary_precision': 0.19354838, 'binary_recall': 0.3529412, 'binary_specificity': 0.99342626, 'binary_f1_score': 0.24999997}
confusion matrix:
       0    1
0  15112  100
1     44   24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 3
val acc:0.9582245349884033, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 5,now: 2024-05-28 04:46:27.483693,epoch time: 0:20:56.363815,used: 1:45:29.386212,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9588891, 'precision': 0.7701558, 'recall': 0.84179884, 'specificity': 0.84179884, 'f1': 0.80106914, 'auroc': 0.9625149, 'binary_precision': 0.5549836, 'binary_recall': 0.71231234, 'binary_specificity': 0.97128534, 'binary_f1_score': 0.6238822}
confusion matrix:
       0     1
0  32168   951
1    479  1186
---- Validation: 
scalar performance:
{'acc': 0.9562161, 'precision': 0.76169765, 'recall': 0.84275186, 'specificity': 0.84275186, 'f1': 0.7958149, 'auroc': 0.95643854, 'binary_precision': 0.53814435, 'binary_recall': 0.71703297, 'binary_specificity': 0.9684707, 'binary_f1_score': 0.61484104}
confusion matrix:
       0    1
0  13761  448
1    206  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99123037, 'precision': 0.60634077, 'recall': 0.6808325, 'specificity': 0.6808325, 'f1': 0.6336639, 'auroc': 0.8281651, 'binary_precision': 0.21551724, 'binary_recall': 0.36764705, 'binary_specificity': 0.9940179, 'binary_f1_score': 0.27173916}
confusion matrix:
       0   1
0  15121  91
1     43  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 4
val acc:0.9562160968780518, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 6,now: 2024-05-28 05:07:16.923389,epoch time: 0:20:49.439696,used: 2:06:18.825908,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9627415, 'precision': 0.79294556, 'recall': 0.8115939, 'specificity': 0.8115939, 'f1': 0.8019378, 'auroc': 0.9673865, 'binary_precision': 0.6038267, 'binary_recall': 0.64444447, 'binary_specificity': 0.9787433, 'binary_f1_score': 0.6234747}
confusion matrix:
       0     1
0  32415   704
1    592  1073
---- Validation: 
scalar performance:
{'acc': 0.958894, 'precision': 0.7764369, 'recall': 0.7972424, 'specificity': 0.7972424, 'f1': 0.7864008, 'auroc': 0.95758796, 'binary_precision': 0.57251906, 'binary_recall': 0.6181319, 'binary_specificity': 0.976353, 'binary_f1_score': 0.5944518}
confusion matrix:
       0    1
0  13873  336
1    278  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9907068, 'precision': 0.6041158, 'recall': 0.6952097, 'specificity': 0.6952097, 'f1': 0.63541675, 'auroc': 0.81552875, 'binary_precision': 0.2109375, 'binary_recall': 0.3970588, 'binary_specificity': 0.9933605, 'binary_f1_score': 0.2755102}
confusion matrix:
       0    1
0  15111  101
1     41   27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 5
val acc:0.9588940143585205, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 7,now: 2024-05-28 05:27:56.350222,epoch time: 0:20:39.426833,used: 2:26:58.252741,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96366143, 'precision': 0.79070294, 'recall': 0.8694028, 'specificity': 0.8694028, 'f1': 0.8245965, 'auroc': 0.964553, 'binary_precision': 0.5933861, 'binary_recall': 0.76516515, 'binary_specificity': 0.9736405, 'binary_f1_score': 0.66841555}
confusion matrix:
       0     1
0  32246   873
1    391  1274
---- Validation: 
scalar performance:
{'acc': 0.95896095, 'precision': 0.7729082, 'recall': 0.8598336, 'specificity': 0.8598336, 'f1': 0.8093538, 'auroc': 0.9522296, 'binary_precision': 0.5588536, 'binary_recall': 0.75, 'binary_specificity': 0.96966714, 'binary_f1_score': 0.6404692}
confusion matrix:
       0    1
0  13778  431
1    182  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98992145, 'precision': 0.605477, 'recall': 0.7314156, 'specificity': 0.7314156, 'f1': 0.6442513, 'auroc': 0.8460276, 'binary_precision': 0.21333334, 'binary_recall': 0.47058824, 'binary_specificity': 0.992243, 'binary_f1_score': 0.293578}
confusion matrix:
       0    1
0  15094  118
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 6
val acc:0.9589609503746033, best validation acc: 0.9592287540435791, corresponding to test acc:                         0.9924083948135376 / 0.9951570630073547
after epoch: 8,now: 2024-05-28 05:48:43.309716,epoch time: 0:20:46.959494,used: 2:47:45.212235,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9640064, 'precision': 0.7989687, 'recall': 0.82138467, 'specificity': 0.82138467, 'f1': 0.80971, 'auroc': 0.9652492, 'binary_precision': 0.61491376, 'binary_recall': 0.6636637, 'binary_specificity': 0.97910565, 'binary_f1_score': 0.6383593}
confusion matrix:
       0     1
0  32427   692
1    560  1105
---- Validation: 
scalar performance:
{'acc': 0.9600991, 'precision': 0.7795028, 'recall': 0.83567005, 'specificity': 0.83567005, 'f1': 0.80459225, 'auroc': 0.9556695, 'binary_precision': 0.57466066, 'binary_recall': 0.6978022, 'binary_specificity': 0.9735379, 'binary_f1_score': 0.6302729}
confusion matrix:
       0    1
0  13833  376
1    220  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9924084, 'precision': 0.62355113, 'recall': 0.67410403, 'specificity': 0.67410403, 'f1': 0.6444333, 'auroc': 0.7969557, 'binary_precision': 0.25, 'binary_recall': 0.3529412, 'binary_specificity': 0.9952669, 'binary_f1_score': 0.29268295}
confusion matrix:
       0   1
0  15140  72
1     44  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
better model found
persisted
after epoch: 9,now: 2024-05-28 06:09:40.400938,epoch time: 0:20:57.091222,used: 3:08:42.303457,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96440893, 'precision': 0.81050813, 'recall': 0.7816676, 'specificity': 0.7816676, 'f1': 0.7952863, 'auroc': 0.9664792, 'binary_precision': 0.64204925, 'binary_recall': 0.5795796, 'binary_specificity': 0.9837555, 'binary_f1_score': 0.60921717}
confusion matrix:
       0    1
0  32581  538
1    700  965
---- Validation: 
scalar performance:
{'acc': 0.96117026, 'precision': 0.7867099, 'recall': 0.8186392, 'specificity': 0.8186392, 'f1': 0.8016968, 'auroc': 0.95413053, 'binary_precision': 0.59090906, 'binary_recall': 0.66071427, 'binary_specificity': 0.97656417, 'binary_f1_score': 0.62386507}
confusion matrix:
       0    1
0  13876  333
1    247  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9921466, 'precision': 0.6260075, 'recall': 0.69593275, 'specificity': 0.69593275, 'f1': 0.65319777, 'auroc': 0.8218734, 'binary_precision': 0.254717, 'binary_recall': 0.3970588, 'binary_specificity': 0.9948067, 'binary_f1_score': 0.31034482}
confusion matrix:
       0   1
0  15133  79
1     41  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
better model found
persisted
after epoch: 10,now: 2024-05-28 06:30:29.983498,epoch time: 0:20:49.582560,used: 3:29:31.886017,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96242523, 'precision': 0.78808355, 'recall': 0.8348145, 'specificity': 0.8348145, 'f1': 0.80941653, 'auroc': 0.9653311, 'binary_precision': 0.5917008, 'binary_recall': 0.6936937, 'binary_specificity': 0.9759353, 'binary_f1_score': 0.63865083}
confusion matrix:
       0     1
0  32322   797
1    510  1155
---- Validation: 
scalar performance:
{'acc': 0.95896095, 'precision': 0.7743732, 'recall': 0.82985884, 'specificity': 0.82985884, 'f1': 0.79913604, 'auroc': 0.9567914, 'binary_precision': 0.56497175, 'binary_recall': 0.6868132, 'binary_specificity': 0.9729045, 'binary_f1_score': 0.6199628}
confusion matrix:
       0    1
0  13824  385
1    228  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9903141, 'precision': 0.6016205, 'recall': 0.70233256, 'specificity': 0.70233256, 'f1': 0.6348172, 'auroc': 0.8130252, 'binary_precision': 0.20588236, 'binary_recall': 0.4117647, 'binary_specificity': 0.9929004, 'binary_f1_score': 0.27450982}
confusion matrix:
       0    1
0  15104  108
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 1
val acc:0.9589609503746033, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 11,now: 2024-05-28 06:51:12.336426,epoch time: 0:20:42.352928,used: 3:50:14.238945,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9655876, 'precision': 0.8007498, 'recall': 0.8669919, 'specificity': 0.8669919, 'f1': 0.8300669, 'auroc': 0.971672, 'binary_precision': 0.6138132, 'binary_recall': 0.75795794, 'binary_specificity': 0.9760258, 'binary_f1_score': 0.6783123}
confusion matrix:
       0     1
0  32325   794
1    403  1262
---- Validation: 
scalar performance:
{'acc': 0.9600321, 'precision': 0.7780234, 'recall': 0.8525771, 'specificity': 0.8525771, 'f1': 0.81013894, 'auroc': 0.95785517, 'binary_precision': 0.56990397, 'binary_recall': 0.73351645, 'binary_specificity': 0.97163767, 'binary_f1_score': 0.6414414}
confusion matrix:
       0    1
0  13806  403
1    194  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99430627, 'precision': 0.65870273, 'recall': 0.6238167, 'specificity': 0.6238167, 'f1': 0.6390668, 'auroc': 0.7832533, 'binary_precision': 0.3207547, 'binary_recall': 0.25, 'binary_specificity': 0.99763346, 'binary_f1_score': 0.28099173}
confusion matrix:
       0   1
0  15176  36
1     51  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 2
val acc:0.9600321054458618, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 12,now: 2024-05-28 07:12:06.914084,epoch time: 0:20:54.577658,used: 4:11:08.816603,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9618503, 'precision': 0.7808716, 'recall': 0.89098275, 'specificity': 0.89098275, 'f1': 0.8253579, 'auroc': 0.9711566, 'binary_precision': 0.5713682, 'binary_recall': 0.8126126, 'binary_specificity': 0.96935296, 'binary_f1_score': 0.67096454}
confusion matrix:
       0     1
0  32104  1015
1    312  1353
---- Validation: 
scalar performance:
{'acc': 0.95782286, 'precision': 0.7679479, 'recall': 0.8677064, 'specificity': 0.8677064, 'f1': 0.80859447, 'auroc': 0.9574162, 'binary_precision': 0.5480392, 'binary_recall': 0.76785713, 'binary_specificity': 0.96755576, 'binary_f1_score': 0.6395881}
confusion matrix:
       0    1
0  13748  461
1    169  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98979056, 'precision': 0.5937162, 'recall': 0.6947495, 'specificity': 0.6947495, 'f1': 0.62600136, 'auroc': 0.8131603, 'binary_precision': 0.19014084, 'binary_recall': 0.3970588, 'binary_specificity': 0.99244016, 'binary_f1_score': 0.25714284}
confusion matrix:
       0    1
0  15097  115
1     41   27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 3
val acc:0.957822859287262, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 13,now: 2024-05-28 07:32:58.930872,epoch time: 0:20:52.016788,used: 4:32:00.833391,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9606141, 'precision': 0.77507734, 'recall': 0.91343504, 'specificity': 0.91343504, 'f1': 0.82788193, 'auroc': 0.9745526, 'binary_precision': 0.5573261, 'binary_recall': 0.86126125, 'binary_specificity': 0.96560884, 'binary_f1_score': 0.6767343}
confusion matrix:
       0     1
0  31980  1139
1    231  1434
---- Validation: 
scalar performance:
{'acc': 0.95822453, 'precision': 0.76921505, 'recall': 0.8861631, 'specificity': 0.8861631, 'f1': 0.8153612, 'auroc': 0.96089864, 'binary_precision': 0.5485981, 'binary_recall': 0.8063187, 'binary_specificity': 0.9660075, 'binary_f1_score': 0.6529477}
confusion matrix:
       0    1
0  13726  483
1    141  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99077225, 'precision': 0.61152756, 'recall': 0.7172028, 'specificity': 0.7172028, 'f1': 0.6469315, 'auroc': 0.83028924, 'binary_precision': 0.22556391, 'binary_recall': 0.44117647, 'binary_specificity': 0.99322903, 'binary_f1_score': 0.29850745}
confusion matrix:
       0    1
0  15109  103
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 4
val acc:0.9582245349884033, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 14,now: 2024-05-28 07:53:48.277812,epoch time: 0:20:49.346940,used: 4:52:50.180331,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9604991, 'precision': 0.7835913, 'recall': 0.7813256, 'specificity': 0.7813256, 'f1': 0.7824532, 'auroc': 0.9403796, 'binary_precision': 0.5881284, 'binary_recall': 0.58318317, 'binary_specificity': 0.979468, 'binary_f1_score': 0.5856453}
confusion matrix:
       0    1
0  32439  680
1    694  971
---- Validation: 
scalar performance:
{'acc': 0.9560822, 'precision': 0.76186895, 'recall': 0.7964161, 'specificity': 0.7964161, 'f1': 0.7778901, 'auroc': 0.9445633, 'binary_precision': 0.54337347, 'binary_recall': 0.61950547, 'binary_specificity': 0.97332674, 'binary_f1_score': 0.5789473}
confusion matrix:
       0    1
0  13830  379
1    277  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9899869, 'precision': 0.5979697, 'recall': 0.70216817, 'specificity': 0.70216817, 'f1': 0.6314508, 'auroc': 0.79794544, 'binary_precision': 0.19858156, 'binary_recall': 0.4117647, 'binary_specificity': 0.99257165, 'binary_f1_score': 0.26794258}
confusion matrix:
       0    1
0  15099  113
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 5
val acc:0.9560822248458862, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 15,now: 2024-05-28 08:14:38.105410,epoch time: 0:20:49.827598,used: 5:13:40.007929,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9607866, 'precision': 0.77654827, 'recall': 0.88842773, 'specificity': 0.88842773, 'f1': 0.8214437, 'auroc': 0.974556, 'binary_precision': 0.56294435, 'binary_recall': 0.8084084, 'binary_specificity': 0.9684471, 'binary_f1_score': 0.6637081}
confusion matrix:
       0     1
0  32074  1045
1    319  1346
---- Validation: 
scalar performance:
{'acc': 0.95922875, 'precision': 0.7733963, 'recall': 0.8775681, 'specificity': 0.8775681, 'f1': 0.81566674, 'auroc': 0.9586952, 'binary_precision': 0.5579357, 'binary_recall': 0.7870879, 'binary_specificity': 0.9680484, 'binary_f1_score': 0.6529915}
confusion matrix:
       0    1
0  13755  454
1    155  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9908377, 'precision': 0.61238205, 'recall': 0.7172356, 'specificity': 0.7172356, 'f1': 0.64769435, 'auroc': 0.824165, 'binary_precision': 0.22727273, 'binary_recall': 0.44117647, 'binary_specificity': 0.9932948, 'binary_f1_score': 0.29999998}
confusion matrix:
       0    1
0  15110  102
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 6
val acc:0.9592287540435791, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 16,now: 2024-05-28 08:35:26.412813,epoch time: 0:20:48.307403,used: 5:34:28.315332,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96052784, 'precision': 0.7765017, 'recall': 0.86462003, 'specificity': 0.86462003, 'f1': 0.81347525, 'auroc': 0.96870196, 'binary_precision': 0.56535363, 'binary_recall': 0.7585586, 'binary_specificity': 0.9706815, 'binary_f1_score': 0.64785844}
confusion matrix:
       0     1
0  32148   971
1    402  1263
---- Validation: 
scalar performance:
{'acc': 0.9558144, 'precision': 0.7600723, 'recall': 0.8607862, 'specificity': 0.8607862, 'f1': 0.8007621, 'auroc': 0.95244044, 'binary_precision': 0.53294575, 'binary_recall': 0.75549453, 'binary_specificity': 0.96607786, 'binary_f1_score': 0.62500006}
confusion matrix:
       0    1
0  13727  482
1    178  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9891361, 'precision': 0.59165937, 'recall': 0.70906097, 'specificity': 0.70906097, 'f1': 0.6267283, 'auroc': 0.78683066, 'binary_precision': 0.18589744, 'binary_recall': 0.42647058, 'binary_specificity': 0.99165136, 'binary_f1_score': 0.2589286}
confusion matrix:
       0    1
0  15085  127
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 7
val acc:0.9558144211769104, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 17,now: 2024-05-28 08:56:13.840342,epoch time: 0:20:47.427529,used: 5:55:15.742861,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96090156, 'precision': 0.7764391, 'recall': 0.90445954, 'specificity': 0.90445954, 'f1': 0.8262986, 'auroc': 0.9712125, 'binary_precision': 0.5610244, 'binary_recall': 0.842042, 'binary_specificity': 0.96687704, 'binary_f1_score': 0.673391}
confusion matrix:
       0     1
0  32022  1097
1    263  1402
---- Validation: 
scalar performance:
{'acc': 0.955078, 'precision': 0.7575583, 'recall': 0.8792962, 'specificity': 0.8792962, 'f1': 0.8046035, 'auroc': 0.95134723, 'binary_precision': 0.5258856, 'binary_recall': 0.7953297, 'binary_specificity': 0.96326274, 'binary_f1_score': 0.6331329}
confusion matrix:
       0    1
0  13687  522
1    149  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98219895, 'precision': 0.5599452, 'recall': 0.73485714, 'specificity': 0.73485714, 'f1': 0.5931331, 'auroc': 0.8199566, 'binary_precision': 0.12222222, 'binary_recall': 0.4852941, 'binary_specificity': 0.9844202, 'binary_f1_score': 0.19526628}
confusion matrix:
       0    1
0  14975  237
1     35   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 8
val acc:0.9550780057907104, best validation acc: 0.9611702561378479, corresponding to test acc:                         0.9921466112136841 / 0.9951570630073547
after epoch: 18,now: 2024-05-28 09:16:55.130978,epoch time: 0:20:41.290636,used: 6:15:57.033497,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9652139, 'precision': 0.7966058, 'recall': 0.8847635, 'specificity': 0.8847635, 'f1': 0.83405685, 'auroc': 0.97388524, 'binary_precision': 0.60364467, 'binary_recall': 0.7957958, 'binary_specificity': 0.9737311, 'binary_f1_score': 0.68652844}
confusion matrix:
       0     1
0  32249   870
1    340  1325
---- Validation: 
scalar performance:
{'acc': 0.96157193, 'precision': 0.7829177, 'recall': 0.8840128, 'specificity': 0.8840128, 'f1': 0.8244777, 'auroc': 0.95898026, 'binary_precision': 0.5763889, 'binary_recall': 0.7980769, 'binary_specificity': 0.96994865, 'binary_f1_score': 0.66935486}
confusion matrix:
       0    1
0  13782  427
1    147  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99090314, 'precision': 0.60430557, 'recall': 0.68798816, 'specificity': 0.68798816, 'f1': 0.6338371, 'auroc': 0.7878919, 'binary_precision': 0.21138212, 'binary_recall': 0.38235295, 'binary_specificity': 0.99362344, 'binary_f1_score': 0.2722513}
confusion matrix:
       0   1
0  15115  97
1     42  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
better model found
persisted
after epoch: 19,now: 2024-05-28 09:37:17.609388,epoch time: 0:20:22.478410,used: 6:36:19.511907,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9673988, 'precision': 0.80771005, 'recall': 0.8841996, 'specificity': 0.8841996, 'f1': 0.84106433, 'auroc': 0.97696924, 'binary_precision': 0.62600857, 'binary_recall': 0.7921922, 'binary_specificity': 0.976207, 'binary_f1_score': 0.69936377}
confusion matrix:
       0     1
0  32331   788
1    346  1319
---- Validation: 
scalar performance:
{'acc': 0.960233, 'precision': 0.778272, 'recall': 0.86376023, 'specificity': 0.86376023, 'f1': 0.81434196, 'auroc': 0.9526114, 'binary_precision': 0.5692149, 'binary_recall': 0.7568681, 'binary_specificity': 0.9706524, 'binary_f1_score': 0.6497642}
confusion matrix:
       0    1
0  13792  417
1    177  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9901178, 'precision': 0.5850963, 'recall': 0.6583135, 'specificity': 0.6583135, 'f1': 0.6103341, 'auroc': 0.8097639, 'binary_precision': 0.17322835, 'binary_recall': 0.32352942, 'binary_specificity': 0.99309754, 'binary_f1_score': 0.22564104}
confusion matrix:
       0    1
0  15107  105
1     46   22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 1
val acc:0.9602329730987549, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 20,now: 2024-05-28 09:57:44.660936,epoch time: 0:20:27.051548,used: 6:56:46.563455,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9620228, 'precision': 0.7862449, 'recall': 0.83203626, 'specificity': 0.83203626, 'f1': 0.8071735, 'auroc': 0.96632063, 'binary_precision': 0.5882957, 'binary_recall': 0.6882883, 'binary_specificity': 0.9757843, 'binary_f1_score': 0.6343759}
confusion matrix:
       0     1
0  32317   802
1    519  1146
---- Validation: 
scalar performance:
{'acc': 0.95588136, 'precision': 0.76053214, 'recall': 0.8152077, 'specificity': 0.8152077, 'f1': 0.78481764, 'auroc': 0.9466566, 'binary_precision': 0.53872055, 'binary_recall': 0.6593407, 'binary_specificity': 0.9710747, 'binary_f1_score': 0.5929586}
confusion matrix:
       0    1
0  13798  411
1    248  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.985733, 'precision': 0.5684178, 'recall': 0.7073518, 'specificity': 0.7073518, 'f1': 0.6014732, 'auroc': 0.82154447, 'binary_precision': 0.13942307, 'binary_recall': 0.42647058, 'binary_specificity': 0.988233, 'binary_f1_score': 0.21014492}
confusion matrix:
       0    1
0  15033  179
1     39   29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 2
val acc:0.9558813571929932, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 21,now: 2024-05-28 10:18:00.882264,epoch time: 0:20:16.221328,used: 7:17:02.784783,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96242523, 'precision': 0.7837789, 'recall': 0.8838694, 'specificity': 0.8838694, 'f1': 0.8250556, 'auroc': 0.97191656, 'binary_precision': 0.5779617, 'binary_recall': 0.796997, 'binary_specificity': 0.97074187, 'binary_f1_score': 0.6700328}
confusion matrix:
       0     1
0  32150   969
1    338  1327
---- Validation: 
scalar performance:
{'acc': 0.9602999, 'precision': 0.7799776, 'recall': 0.84229183, 'specificity': 0.84229183, 'f1': 0.8074891, 'auroc': 0.9435338, 'binary_precision': 0.5749168, 'binary_recall': 0.71153843, 'binary_specificity': 0.97304523, 'binary_f1_score': 0.63597304}
confusion matrix:
       0    1
0  13826  383
1    210  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9895942, 'precision': 0.5939165, 'recall': 0.701971, 'specificity': 0.701971, 'f1': 0.6276127, 'auroc': 0.86309135, 'binary_precision': 0.1904762, 'binary_recall': 0.4117647, 'binary_specificity': 0.99217725, 'binary_f1_score': 0.26046512}
confusion matrix:
       0    1
0  15093  119
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 3
val acc:0.9602999091148376, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 22,now: 2024-05-28 10:38:23.892716,epoch time: 0:20:23.010452,used: 7:37:25.795235,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96547264, 'precision': 0.79761744, 'recall': 0.8868958, 'specificity': 0.8868958, 'f1': 0.83549166, 'auroc': 0.9742202, 'binary_precision': 0.60545456, 'binary_recall': 0.8, 'binary_specificity': 0.9737915, 'binary_f1_score': 0.68926257}
confusion matrix:
       0     1
0  32251   868
1    333  1332
---- Validation: 
scalar performance:
{'acc': 0.96036685, 'precision': 0.77871263, 'recall': 0.8664372, 'specificity': 0.8664372, 'f1': 0.8155801, 'auroc': 0.9563223, 'binary_precision': 0.5698152, 'binary_recall': 0.76236266, 'binary_specificity': 0.9705117, 'binary_f1_score': 0.65217394}
confusion matrix:
       0    1
0  13790  419
1    173  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99103403, 'precision': 0.59851635, 'recall': 0.6660937, 'specificity': 0.6660937, 'f1': 0.6234281, 'auroc': 0.84519404, 'binary_precision': 0.2, 'binary_recall': 0.3382353, 'binary_specificity': 0.99395216, 'binary_f1_score': 0.25136614}
confusion matrix:
       0   1
0  15120  92
1     45  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 4
val acc:0.9603668451309204, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 23,now: 2024-05-28 10:58:50.937928,epoch time: 0:20:27.045212,used: 7:57:52.840447,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96070033, 'precision': 0.7826333, 'recall': 0.79854345, 'specificity': 0.79854345, 'f1': 0.7903365, 'auroc': 0.92388165, 'binary_precision': 0.5844671, 'binary_recall': 0.61921924, 'binary_specificity': 0.97786766, 'binary_f1_score': 0.60134155}
confusion matrix:
       0     1
0  32386   733
1    634  1031
---- Validation: 
scalar performance:
{'acc': 0.95588136, 'precision': 0.76113284, 'recall': 0.7871878, 'specificity': 0.7871878, 'f1': 0.7734357, 'auroc': 0.91617143, 'binary_precision': 0.54285717, 'binary_recall': 0.60027474, 'binary_specificity': 0.97410095, 'binary_f1_score': 0.5701239}
confusion matrix:
       0    1
0  13841  368
1    291  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98867804, 'precision': 0.5856337, 'recall': 0.7015108, 'specificity': 0.7015108, 'f1': 0.61941886, 'auroc': 0.8111555, 'binary_precision': 0.17391305, 'binary_recall': 0.4117647, 'binary_specificity': 0.9912569, 'binary_f1_score': 0.2445415}
confusion matrix:
       0    1
0  15079  133
1     40   28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 5
val acc:0.9558813571929932, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 24,now: 2024-05-28 11:19:36.169275,epoch time: 0:20:45.231347,used: 8:18:38.071794,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.962454, 'precision': 0.7833962, 'recall': 0.89187026, 'specificity': 0.89187026, 'f1': 0.82743883, 'auroc': 0.97333395, 'binary_precision': 0.5763505, 'binary_recall': 0.8138138, 'binary_specificity': 0.96992666, 'binary_f1_score': 0.67480075}
confusion matrix:
       0     1
0  32123   996
1    310  1355
---- Validation: 
scalar performance:
{'acc': 0.957689, 'precision': 0.7673789, 'recall': 0.86959094, 'specificity': 0.86959094, 'f1': 0.80880725, 'auroc': 0.9482001, 'binary_precision': 0.5466926, 'binary_recall': 0.771978, 'binary_specificity': 0.96720386, 'binary_f1_score': 0.6400911}
confusion matrix:
       0    1
0  13743  466
1    166  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99149215, 'precision': 0.62169737, 'recall': 0.71756434, 'specificity': 0.71756434, 'f1': 0.65575445, 'auroc': 0.8297056, 'binary_precision': 0.24590164, 'binary_recall': 0.44117647, 'binary_specificity': 0.99395216, 'binary_f1_score': 0.31578946}
confusion matrix:
       0   1
0  15120  92
1     38  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 6
val acc:0.9576889872550964, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 25,now: 2024-05-28 11:40:02.400724,epoch time: 0:20:26.231449,used: 8:39:04.303243,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95449054, 'precision': 0.752934, 'recall': 0.8862623, 'specificity': 0.8862623, 'f1': 0.8030759, 'auroc': 0.971203, 'binary_precision': 0.5156608, 'binary_recall': 0.8108108, 'binary_specificity': 0.9617138, 'binary_f1_score': 0.6303993}
confusion matrix:
       0     1
0  31851  1268
1    315  1350
---- Validation: 
scalar performance:
{'acc': 0.94965523, 'precision': 0.7372732, 'recall': 0.8438647, 'specificity': 0.8438647, 'f1': 0.77886724, 'auroc': 0.9474244, 'binary_precision': 0.48890942, 'binary_recall': 0.72664833, 'binary_specificity': 0.961081, 'binary_f1_score': 0.58453035}
confusion matrix:
       0    1
0  13656  553
1    199  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98880893, 'precision': 0.5907677, 'recall': 0.7162167, 'specificity': 0.7162167, 'f1': 0.62705106, 'auroc': 0.82454807, 'binary_precision': 0.18404908, 'binary_recall': 0.44117647, 'binary_specificity': 0.9912569, 'binary_f1_score': 0.25974026}
confusion matrix:
       0    1
0  15079  133
1     38   30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 7
val acc:0.9496552348136902, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 26,now: 2024-05-28 12:00:10.122487,epoch time: 0:20:07.721763,used: 8:59:12.025006,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9616778, 'precision': 0.7807808, 'recall': 0.8791989, 'specificity': 0.8791989, 'f1': 0.82140595, 'auroc': 0.9678047, 'binary_precision': 0.57242584, 'binary_recall': 0.787988, 'binary_specificity': 0.97040975, 'binary_f1_score': 0.6631287}
confusion matrix:
       0     1
0  32139   980
1    353  1312
---- Validation: 
scalar performance:
{'acc': 0.9557475, 'precision': 0.7598618, 'recall': 0.86791885, 'specificity': 0.86791885, 'f1': 0.8028729, 'auroc': 0.9548118, 'binary_precision': 0.53175354, 'binary_recall': 0.7706044, 'binary_specificity': 0.9652333, 'binary_f1_score': 0.62927645}
confusion matrix:
       0    1
0  13715  494
1    167  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9886126, 'precision': 0.5929264, 'recall': 0.73075825, 'specificity': 0.73075825, 'f1': 0.63158464, 'auroc': 0.8854697, 'binary_precision': 0.1882353, 'binary_recall': 0.47058824, 'binary_specificity': 0.99092823, 'binary_f1_score': 0.26890755}
confusion matrix:
       0    1
0  15074  138
1     36   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 8
val acc:0.9557474851608276, best validation acc: 0.9615719318389893, corresponding to test acc:                         0.9909031391143799 / 0.9951570630073547
after epoch: 27,now: 2024-05-28 12:20:31.679778,epoch time: 0:20:21.557291,used: 9:19:33.582297,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96866375, 'precision': 0.82157016, 'recall': 0.8514951, 'specificity': 0.8514951, 'f1': 0.83577, 'auroc': 0.9759236, 'binary_precision': 0.6571897, 'binary_recall': 0.7219219, 'binary_specificity': 0.98106825, 'binary_f1_score': 0.6880367}
confusion matrix:
       0     1
0  32492   627
1    463  1202
---- Validation: 
scalar performance:
{'acc': 0.96257615, 'precision': 0.79037035, 'recall': 0.85130775, 'specificity': 0.85130775, 'f1': 0.81747055, 'auroc': 0.9590523, 'binary_precision': 0.59483725, 'binary_recall': 0.728022, 'binary_specificity': 0.9745936, 'binary_f1_score': 0.65472513}
confusion matrix:
       0    1
0  13848  361
1    198  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99221206, 'precision': 0.62482995, 'recall': 0.6886456, 'specificity': 0.6886456, 'f1': 0.65008885, 'auroc': 0.840517, 'binary_precision': 0.2524272, 'binary_recall': 0.38235295, 'binary_specificity': 0.9949382, 'binary_f1_score': 0.30409357}
confusion matrix:
       0   1
0  15135  77
1     42  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
better model found
persisted
after epoch: 28,now: 2024-05-28 12:41:55.887370,epoch time: 0:21:24.207592,used: 9:40:57.789889,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9661051, 'precision': 0.8085855, 'recall': 0.8381729, 'specificity': 0.8381729, 'f1': 0.82260084, 'auroc': 0.973304, 'binary_precision': 0.63249725, 'binary_recall': 0.6966967, 'binary_specificity': 0.9796491, 'binary_f1_score': 0.6630466}
confusion matrix:
       0     1
0  32445   674
1    505  1160
---- Validation: 
scalar performance:
{'acc': 0.96157193, 'precision': 0.78637564, 'recall': 0.84100556, 'specificity': 0.84100556, 'f1': 0.81092024, 'auroc': 0.9560942, 'binary_precision': 0.58789957, 'binary_recall': 0.7074176, 'binary_specificity': 0.9745936, 'binary_f1_score': 0.6421447}
confusion matrix:
       0    1
0  13848  361
1    213  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9912958, 'precision': 0.5807618, 'recall': 0.6149847, 'specificity': 0.6149847, 'f1': 0.5947819, 'auroc': 0.7975858, 'binary_precision': 0.16494845, 'binary_recall': 0.23529412, 'binary_specificity': 0.9946753, 'binary_f1_score': 0.19393939}
confusion matrix:
       0   1
0  15131  81
1     52  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 1
val acc:0.9615719318389893, best validation acc: 0.962576150894165, corresponding to test acc:                         0.9922120571136475 / 0.9951570630073547
after epoch: 29,now: 2024-05-28 13:02:36.214258,epoch time: 0:20:40.326888,used: 10:01:38.116777,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96331644, 'precision': 0.80139875, 'recall': 0.7862275, 'specificity': 0.7862275, 'f1': 0.7935887, 'auroc': 0.92230415, 'binary_precision': 0.6233354, 'binary_recall': 0.5903904, 'binary_specificity': 0.98206466, 'binary_f1_score': 0.60641575}
confusion matrix:
       0    1
0  32525  594
1    682  983
---- Validation: 
scalar performance:
{'acc': 0.9582915, 'precision': 0.7771214, 'recall': 0.75717664, 'specificity': 0.75717664, 'f1': 0.7667186, 'auroc': 0.9049798, 'binary_precision': 0.5780089, 'binary_recall': 0.5343407, 'binary_specificity': 0.98001266, 'binary_f1_score': 0.55531764}
confusion matrix:
       0    1
0  13925  284
1    339  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9848822, 'precision': 0.56766003, 'recall': 0.72156465, 'specificity': 0.72156465, 'f1': 0.601986, 'auroc': 0.8327863, 'binary_precision': 0.13777778, 'binary_recall': 0.45588234, 'binary_specificity': 0.98724693, 'binary_f1_score': 0.2116041}
confusion matrix:
       0    1
0  15018  194
1     37   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center1_20897896.png
early stop counter: 2
val acc:0.9582914710044861, best validation acc: 0.962576150894165, corresponding to test acc:                         0.9922120571136475 / 0.9951570630073547
after epoch: 30,now: 2024-05-28 13:22:44.337478,epoch time: 0:20:08.123220,used: 10:21:46.239997,model: dset_te_center1_erm_b44271c83_not_commited_2024md_05md_28_03_00_58_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:21:46.239997 at 2024-05-28 13:22:44.337478
persisted model performance metric: 

scalar performance:
{'acc': 0.9918194, 'precision': 0.6202702, 'recall': 0.6957684, 'specificity': 0.6957684, 'f1': 0.64878076, 'auroc': 0.8230424, 'binary_precision': 0.24324325, 'binary_recall': 0.3970588, 'binary_specificity': 0.99447805, 'binary_f1_score': 0.30167598}
confusion matrix:
       0   1
0  15128  84
1     41  27
oracle model performance metric: 

scalar performance:
{'acc': 0.9950262, 'precision': 0.4977737, 'recall': 0.49973705, 'specificity': 0.49973705, 'f1': 0.49875343, 'auroc': 0.7958964, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994741, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  15204  8
1     68  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498548 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  91508 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 498548 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  91508 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476996 KiB |  10962 MiB |   2771 TiB |   2771 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   2766 TiB |   2766 TiB |
|       from small pool |  89156 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11392 MiB |  11392 MiB |  20792 MiB |   9400 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    126 MiB |    126 MiB |    154 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1485 MiB |   2595 MiB |    921 TiB |    921 TiB |
|       from large pool |   1472 MiB |   2593 MiB |    915 TiB |    915 TiB |
|       from small pool |     12 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    7107    |    7764    |  228249 K  |  228242 K  |
|       from large pool |      87    |     909    |  108301 K  |  108301 K  |
|       from small pool |    7020    |    7642    |  119947 K  |  119940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    7107    |    7764    |  228249 K  |  228242 K  |
|       from large pool |      87    |     909    |  108301 K  |  108301 K  |
|       from small pool |    7020    |    7642    |  119947 K  |  119940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     388    |     153    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      63    |      63    |      77    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2768    |  120832 K  |  120832 K  |
|       from large pool |      24    |      65    |   56939 K  |   56939 K  |
|       from small pool |      50    |    2747    |   63893 K  |   63893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   2771 TiB |   2771 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   2766 TiB |   2766 TiB |
|       from small pool |      0 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1972 MiB |  11392 MiB |  20792 MiB |  18820 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    102 MiB |    126 MiB |    154 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |    921 TiB |    921 TiB |
|       from large pool | 134912 KiB |   2593 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  228249 K  |  228249 K  |
|       from large pool |       2    |     909    |  108301 K  |  108301 K  |
|       from small pool |       0    |    7642    |  119947 K  |  119947 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  228249 K  |  228249 K  |
|       from large pool |       2    |     909    |  108301 K  |  108301 K  |
|       from small pool |       0    |    7642    |  119947 K  |  119947 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      86    |     235    |     388    |     302    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      51    |      63    |      77    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  120835 K  |  120835 K  |
|       from large pool |       4    |      65    |   56939 K  |   56939 K  |
|       from small pool |       0    |    2747    |   63896 K  |   63896 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   2783 TiB |   2783 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   2771 TiB |   2771 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   2766 TiB |   2766 TiB |
|       from small pool |      0 KiB |    123 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1972 MiB |  11392 MiB |  20792 MiB |  18820 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |    102 MiB |    126 MiB |    154 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |    921 TiB |    921 TiB |
|       from large pool | 134912 KiB |   2593 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  228249 K  |  228249 K  |
|       from large pool |       2    |     909    |  108301 K  |  108301 K  |
|       from small pool |       0    |    7642    |  119947 K  |  119947 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  228249 K  |  228249 K  |
|       from large pool |       2    |     909    |  108301 K  |  108301 K  |
|       from small pool |       0    |    7642    |  119947 K  |  119947 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      86    |     235    |     388    |     302    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      51    |      63    |      77    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  120835 K  |  120835 K  |
|       from large pool |       4    |      65    |   56939 K  |   56939 K  |
|       from small pool |       0    |    2747    |   63896 K  |   63896 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896

 Experiment start at: 2024-05-28 13:34:54.890040
before training, model accuracy: 0.6810094714164734
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96845794, 'precision': 0.757143, 'recall': 0.8157109, 'specificity': 0.8157109, 'f1': 0.783085, 'auroc': 0.94547725, 'binary_precision': 0.5265511, 'binary_recall': 0.6519031, 'binary_specificity': 0.9795188, 'binary_f1_score': 0.5825603}
confusion matrix:
       0    1
0  40508  847
1    503  942
---- Validation: 
scalar performance:
{'acc': 0.96837103, 'precision': 0.7654073, 'recall': 0.78879255, 'specificity': 0.78879255, 'f1': 0.7765496, 'auroc': 0.9403748, 'binary_precision': 0.545584, 'binary_recall': 0.5956454, 'binary_specificity': 0.9819397, 'binary_f1_score': 0.5695168}
confusion matrix:
       0    1
0  17344  319
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.7509606, 'recall': 0.6070899, 'specificity': 0.6070899, 'f1': 0.64692944, 'auroc': 0.88544786, 'binary_precision': 0.53333336, 'binary_recall': 0.22222222, 'binary_specificity': 0.9919575, 'binary_f1_score': 0.3137255}
confusion matrix:
      0   1
0  6907  56
1   224  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 13:55:10.265881,epoch time: 0:20:15.375841,used: 0:20:15.375841,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710981, 'precision': 0.79859126, 'recall': 0.68350506, 'specificity': 0.68350506, 'f1': 0.7260932, 'auroc': 0.94382817, 'binary_precision': 0.6187215, 'binary_recall': 0.37508652, 'binary_specificity': 0.9919236, 'binary_f1_score': 0.46704006}
confusion matrix:
       0    1
0  41021  334
1    903  542
---- Validation: 
scalar performance:
{'acc': 0.97011906, 'precision': 0.7966269, 'recall': 0.6952869, 'specificity': 0.6952869, 'f1': 0.7345311, 'auroc': 0.94132066, 'binary_precision': 0.6148325, 'binary_recall': 0.39968896, 'binary_specificity': 0.9908849, 'binary_f1_score': 0.48444864}
confusion matrix:
       0    1
0  17502  161
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.78640723, 'recall': 0.51859456, 'specificity': 0.51859456, 'f1': 0.5259449, 'auroc': 0.8869077, 'binary_precision': 0.6111111, 'binary_recall': 0.038194444, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.07189543}
confusion matrix:
      0   1
0  6956   7
1   277  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
better model found
persisted
after epoch: 2,now: 2024-05-28 14:15:39.391217,epoch time: 0:20:29.125336,used: 0:40:44.501177,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.973014, 'precision': 0.7983119, 'recall': 0.7673112, 'specificity': 0.7673112, 'f1': 0.78187907, 'auroc': 0.96127826, 'binary_precision': 0.6124031, 'binary_recall': 0.5467128, 'binary_specificity': 0.98790956, 'binary_f1_score': 0.5776965}
confusion matrix:
       0    1
0  40855  500
1    655  790
---- Validation: 
scalar performance:
{'acc': 0.97230417, 'precision': 0.80744255, 'recall': 0.74662215, 'specificity': 0.74662215, 'f1': 0.77336997, 'auroc': 0.96058, 'binary_precision': 0.6328125, 'binary_recall': 0.503888, 'binary_specificity': 0.9893563, 'binary_f1_score': 0.561039}
confusion matrix:
       0    1
0  17475  188
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.7667572, 'recall': 0.55549645, 'specificity': 0.55549645, 'f1': 0.58548594, 'auroc': 0.8539183, 'binary_precision': 0.5689655, 'binary_recall': 0.114583336, 'binary_specificity': 0.9964096, 'binary_f1_score': 0.19075146}
confusion matrix:
      0   1
0  6938  25
1   255  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
better model found
persisted
after epoch: 3,now: 2024-05-28 14:37:53.418744,epoch time: 0:22:14.027527,used: 1:02:58.528704,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9696262, 'precision': 0.76568377, 'recall': 0.7936082, 'specificity': 0.7936082, 'f1': 0.7788716, 'auroc': 0.955794, 'binary_precision': 0.5452277, 'binary_recall': 0.6048443, 'binary_specificity': 0.98237216, 'binary_f1_score': 0.57349086}
confusion matrix:
       0    1
0  40626  729
1    571  874
---- Validation: 
scalar performance:
{'acc': 0.96858954, 'precision': 0.76584274, 'recall': 0.812134, 'specificity': 0.812134, 'f1': 0.78691643, 'auroc': 0.95508623, 'binary_precision': 0.54473686, 'binary_recall': 0.64385694, 'binary_specificity': 0.98041105, 'binary_f1_score': 0.59016395}
confusion matrix:
       0    1
0  17317  346
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.960833, 'precision': 0.74754536, 'recall': 0.55853784, 'specificity': 0.55853784, 'f1': 0.5888333, 'auroc': 0.90952176, 'binary_precision': 0.530303, 'binary_recall': 0.121527776, 'binary_specificity': 0.9955479, 'binary_f1_score': 0.19774011}
confusion matrix:
      0   1
0  6932  31
1   253  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 1
val acc:0.9685895442962646, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 4,now: 2024-05-28 14:58:43.214985,epoch time: 0:20:49.796241,used: 1:23:48.324945,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97343457, 'precision': 0.8096492, 'recall': 0.7431519, 'specificity': 0.7431519, 'f1': 0.77203286, 'auroc': 0.9609336, 'binary_precision': 0.6367673, 'binary_recall': 0.49619377, 'binary_specificity': 0.99011004, 'binary_f1_score': 0.5577597}
confusion matrix:
       0    1
0  40946  409
1    728  717
---- Validation: 
scalar performance:
{'acc': 0.97033757, 'precision': 0.7827396, 'recall': 0.7695806, 'specificity': 0.7695806, 'f1': 0.77598655, 'auroc': 0.9551133, 'binary_precision': 0.5816994, 'binary_recall': 0.55365473, 'binary_specificity': 0.9855064, 'binary_f1_score': 0.5673307}
confusion matrix:
       0    1
0  17407  256
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.79296386, 'recall': 0.5084652, 'specificity': 0.5084652, 'f1': 0.50682575, 'auroc': 0.8620225, 'binary_precision': 0.625, 'binary_recall': 0.017361112, 'binary_specificity': 0.9995692, 'binary_f1_score': 0.033783786}
confusion matrix:
      0  1
0  6960  3
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 2
val acc:0.9703375697135925, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 5,now: 2024-05-28 15:21:04.248404,epoch time: 0:22:21.033419,used: 1:46:09.358364,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97303736, 'precision': 0.8073131, 'recall': 0.735266, 'specificity': 0.735266, 'f1': 0.76606643, 'auroc': 0.9511807, 'binary_precision': 0.63263446, 'binary_recall': 0.48027682, 'binary_specificity': 0.9902551, 'binary_f1_score': 0.5460268}
confusion matrix:
       0    1
0  40952  403
1    751  694
---- Validation: 
scalar performance:
{'acc': 0.97132087, 'precision': 0.7862623, 'recall': 0.80380845, 'specificity': 0.80380845, 'f1': 0.794746, 'auroc': 0.9546648, 'binary_precision': 0.58625734, 'binary_recall': 0.62363917, 'binary_specificity': 0.9839778, 'binary_f1_score': 0.6043708}
confusion matrix:
       0    1
0  17380  283
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.7477037, 'recall': 0.54182297, 'specificity': 0.54182297, 'f1': 0.5645683, 'auroc': 0.8939315, 'binary_precision': 0.5319149, 'binary_recall': 0.08680555, 'binary_specificity': 0.9968404, 'binary_f1_score': 0.14925374}
confusion matrix:
      0   1
0  6941  22
1   263  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 3
val acc:0.9713208675384521, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 6,now: 2024-05-28 15:42:27.337280,epoch time: 0:21:23.088876,used: 2:07:32.447240,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9707944, 'precision': 0.7788644, 'recall': 0.7523048, 'specificity': 0.7523048, 'f1': 0.76485276, 'auroc': 0.9592787, 'binary_precision': 0.57450074, 'binary_recall': 0.51800555, 'binary_specificity': 0.9866041, 'binary_f1_score': 0.5447924}
confusion matrix:
       0    1
0  40802  554
1    696  748
---- Validation: 
scalar performance:
{'acc': 0.96842563, 'precision': 0.7660354, 'recall': 0.78432506, 'specificity': 0.78432506, 'f1': 0.7748414, 'auroc': 0.95497704, 'binary_precision': 0.5471698, 'binary_recall': 0.58631414, 'binary_specificity': 0.982336, 'binary_f1_score': 0.5660661}
confusion matrix:
       0    1
0  17351  312
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96055716, 'precision': 0.76196873, 'recall': 0.51512235, 'specificity': 0.51512235, 'f1': 0.5195334, 'auroc': 0.8659113, 'binary_precision': 0.5625, 'binary_recall': 0.03125, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.059210528}
confusion matrix:
      0  1
0  6956  7
1   279  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 4
val acc:0.9684256315231323, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961384654045105
after epoch: 7,now: 2024-05-28 16:01:41.347379,epoch time: 0:19:14.010099,used: 2:26:46.457339,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97093457, 'precision': 0.7800054, 'recall': 0.7537141, 'specificity': 0.7537141, 'f1': 0.7661462, 'auroc': 0.962898, 'binary_precision': 0.5766871, 'binary_recall': 0.5207756, 'binary_specificity': 0.9866525, 'binary_f1_score': 0.5473072}
confusion matrix:
       0    1
0  40804  552
1    692  752
---- Validation: 
scalar performance:
{'acc': 0.9629083, 'precision': 0.73044217, 'recall': 0.773973, 'specificity': 0.773973, 'f1': 0.75008595, 'auroc': 0.95595896, 'binary_precision': 0.4766234, 'binary_recall': 0.57076204, 'binary_specificity': 0.97718394, 'binary_f1_score': 0.51946217}
confusion matrix:
       0    1
0  17260  403
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96179837, 'precision': 0.8758624, 'recall': 0.52575445, 'specificity': 0.52575445, 'f1': 0.53910303, 'auroc': 0.8994873, 'binary_precision': 0.7894737, 'binary_recall': 0.052083332, 'binary_specificity': 0.99942553, 'binary_f1_score': 0.09771987}
confusion matrix:
      0   1
0  6959   4
1   273  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
new oracle model saved
early stop counter: 5
val acc:0.9629083275794983, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 8,now: 2024-05-28 16:20:20.853681,epoch time: 0:18:39.506302,used: 2:45:25.963641,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97261685, 'precision': 0.78383476, 'recall': 0.83990246, 'specificity': 0.83990246, 'f1': 0.8090751, 'auroc': 0.96680164, 'binary_precision': 0.57831323, 'binary_recall': 0.69757783, 'binary_specificity': 0.9822271, 'binary_f1_score': 0.63237137}
confusion matrix:
       0     1
0  40620   735
1    437  1008
---- Validation: 
scalar performance:
{'acc': 0.9696821, 'precision': 0.770645, 'recall': 0.85990584, 'specificity': 0.85990584, 'f1': 0.8081981, 'auroc': 0.9641223, 'binary_precision': 0.5508083, 'binary_recall': 0.7418352, 'binary_specificity': 0.97797656, 'binary_f1_score': 0.63220674}
confusion matrix:
       0    1
0  17274  389
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96138465, 'precision': 0.8974651, 'recall': 0.5172175, 'specificity': 0.5172175, 'f1': 0.5234756, 'auroc': 0.84267473, 'binary_precision': 0.8333333, 'binary_recall': 0.034722224, 'binary_specificity': 0.99971277, 'binary_f1_score': 0.06666667}
confusion matrix:
      0   1
0  6961   2
1   278  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 6
val acc:0.9696820974349976, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 9,now: 2024-05-28 16:39:09.590088,epoch time: 0:18:48.736407,used: 3:04:14.700048,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.77959824, 'recall': 0.8378128, 'specificity': 0.8378128, 'f1': 0.8056599, 'auroc': 0.970068, 'binary_precision': 0.5699659, 'binary_recall': 0.69390583, 'binary_specificity': 0.9817197, 'binary_f1_score': 0.6258589}
confusion matrix:
       0     1
0  40600   756
1    442  1002
---- Validation: 
scalar performance:
{'acc': 0.96886265, 'precision': 0.76599, 'recall': 0.85798264, 'specificity': 0.85798264, 'f1': 0.8043785, 'auroc': 0.9655094, 'binary_precision': 0.5416192, 'binary_recall': 0.7387247, 'binary_specificity': 0.97724056, 'binary_f1_score': 0.625}
confusion matrix:
       0    1
0  17261  402
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96166044, 'precision': 0.84482324, 'recall': 0.5273469, 'specificity': 0.5273469, 'f1': 0.5418187, 'auroc': 0.8193699, 'binary_precision': 0.72727275, 'binary_recall': 0.055555556, 'binary_specificity': 0.9991383, 'binary_f1_score': 0.1032258}
confusion matrix:
      0   1
0  6957   6
1   272  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 7
val acc:0.9688626527786255, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 10,now: 2024-05-28 16:58:14.450971,epoch time: 0:19:04.860883,used: 3:23:19.560931,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.970257, 'precision': 0.7771421, 'recall': 0.72544146, 'specificity': 0.72544146, 'f1': 0.7483673, 'auroc': 0.9259552, 'binary_precision': 0.5728988, 'binary_recall': 0.46292445, 'binary_specificity': 0.9879585, 'binary_f1_score': 0.51207364}
confusion matrix:
       0    1
0  40859  498
1    775  668
---- Validation: 
scalar performance:
{'acc': 0.96514803, 'precision': 0.74354684, 'recall': 0.76464343, 'specificity': 0.76464343, 'f1': 0.75360376, 'auroc': 0.93368185, 'binary_precision': 0.5035663, 'binary_recall': 0.5489891, 'binary_specificity': 0.9802978, 'binary_f1_score': 0.5252976}
confusion matrix:
       0    1
0  17315  348
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96166044, 'precision': 0.7486727, 'recall': 0.725399, 'specificity': 0.725399, 'f1': 0.7363891, 'auroc': 0.90469676, 'binary_precision': 0.5192308, 'binary_recall': 0.46875, 'binary_specificity': 0.982048, 'binary_f1_score': 0.49270073}
confusion matrix:
      0    1
0  6838  125
1   153  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 8
val acc:0.9651480317115784, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 11,now: 2024-05-28 17:19:26.636895,epoch time: 0:21:12.185924,used: 3:44:31.746855,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97114486, 'precision': 0.80584276, 'recall': 0.6681684, 'specificity': 0.6681684, 'f1': 0.7153147, 'auroc': 0.94440377, 'binary_precision': 0.6342711, 'binary_recall': 0.3432526, 'binary_specificity': 0.99308425, 'binary_f1_score': 0.44544232}
confusion matrix:
       0    1
0  41069  286
1    949  496
---- Validation: 
scalar performance:
{'acc': 0.97033757, 'precision': 0.79708445, 'recall': 0.70289314, 'specificity': 0.70289314, 'f1': 0.7402705, 'auroc': 0.9423107, 'binary_precision': 0.6152074, 'binary_recall': 0.41524106, 'binary_specificity': 0.9905452, 'binary_f1_score': 0.49582174}
confusion matrix:
       0    1
0  17496  167
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606951, 'precision': 0.8138636, 'recall': 0.5102013, 'specificity': 0.5102013, 'f1': 0.51017034, 'auroc': 0.8247371, 'binary_precision': 0.6666667, 'binary_recall': 0.020833334, 'binary_specificity': 0.9995692, 'binary_f1_score': 0.040404044}
confusion matrix:
      0  1
0  6960  3
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 9
val acc:0.9703375697135925, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 12,now: 2024-05-28 17:39:57.902623,epoch time: 0:20:31.265728,used: 4:05:03.012583,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.973528, 'precision': 0.7955322, 'recall': 0.80597913, 'specificity': 0.80597913, 'f1': 0.8006557, 'auroc': 0.9694805, 'binary_precision': 0.60413885, 'binary_recall': 0.6262976, 'binary_specificity': 0.98566073, 'binary_f1_score': 0.61501867}
confusion matrix:
       0    1
0  40762  593
1    540  905
---- Validation: 
scalar performance:
{'acc': 0.97132087, 'precision': 0.782217, 'recall': 0.8405241, 'specificity': 0.8405241, 'f1': 0.80832934, 'auroc': 0.9606819, 'binary_precision': 0.57544756, 'binary_recall': 0.6998445, 'binary_specificity': 0.9812037, 'binary_f1_score': 0.6315789}
confusion matrix:
       0    1
0  17331  332
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.73635566, 'recall': 0.61158013, 'specificity': 0.61158013, 'f1': 0.64895386, 'auroc': 0.8976418, 'binary_precision': 0.5037594, 'binary_recall': 0.2326389, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.3182898}
confusion matrix:
      0   1
0  6897  66
1   221  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 10
val acc:0.9713208675384521, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.961798369884491
after epoch: 13,now: 2024-05-28 17:59:19.135626,epoch time: 0:19:21.233003,used: 4:24:24.245586,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671963, 'precision': 0.7514361, 'recall': 0.9058871, 'specificity': 0.9058871, 'f1': 0.80822057, 'auroc': 0.9744572, 'binary_precision': 0.5085882, 'binary_recall': 0.84013844, 'binary_specificity': 0.9716358, 'binary_f1_score': 0.6336117}
confusion matrix:
       0     1
0  40182  1173
1    231  1214
---- Validation: 
scalar performance:
{'acc': 0.96482027, 'precision': 0.7466334, 'recall': 0.9008457, 'specificity': 0.9008457, 'f1': 0.8029084, 'auroc': 0.96424484, 'binary_precision': 0.49953315, 'binary_recall': 0.8320373, 'binary_specificity': 0.9696541, 'binary_f1_score': 0.6242707}
confusion matrix:
       0    1
0  17127  536
1    108  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631775, 'precision': 0.8137222, 'recall': 0.57307297, 'specificity': 0.57307297, 'f1': 0.6123777, 'auroc': 0.8894216, 'binary_precision': 0.6615385, 'binary_recall': 0.14930555, 'binary_specificity': 0.9968404, 'binary_f1_score': 0.24362606}
confusion matrix:
      0   1
0  6941  22
1   245  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
new oracle model saved
early stop counter: 11
val acc:0.9648202657699585, best validation acc: 0.9723041653633118, corresponding to test acc:                         0.961384654045105 / 0.963177502155304
after epoch: 14,now: 2024-05-28 18:18:04.968989,epoch time: 0:18:45.833363,used: 4:43:10.078949,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97338784, 'precision': 0.8435782, 'recall': 0.6764535, 'specificity': 0.6764535, 'f1': 0.7310936, 'auroc': 0.966488, 'binary_precision': 0.70919067, 'binary_recall': 0.35803324, 'binary_specificity': 0.99487376, 'binary_f1_score': 0.47583982}
confusion matrix:
       0    1
0  41144  212
1    927  517
---- Validation: 
scalar performance:
{'acc': 0.9727412, 'precision': 0.85040224, 'recall': 0.67866254, 'specificity': 0.67866254, 'f1': 0.73445153, 'auroc': 0.9572928, 'binary_precision': 0.7236025, 'binary_recall': 0.3623639, 'binary_specificity': 0.9949612, 'binary_f1_score': 0.48290154}
confusion matrix:
       0    1
0  17574   89
1    410  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600055, 'precision': 0.68878645, 'recall': 0.50817794, 'specificity': 0.50817794, 'f1': 0.50645685, 'auroc': 0.7583575, 'binary_precision': 0.41666666, 'binary_recall': 0.017361112, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.033333335}
confusion matrix:
      0  1
0  6956  7
1   283  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
better model found
persisted
after epoch: 15,now: 2024-05-28 18:36:51.548044,epoch time: 0:18:46.579055,used: 5:01:56.658004,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97471964, 'precision': 0.8031106, 'recall': 0.8212887, 'specificity': 0.8212887, 'f1': 0.81190836, 'auroc': 0.9592459, 'binary_precision': 0.6182411, 'binary_recall': 0.6567474, 'binary_specificity': 0.98583, 'binary_f1_score': 0.63691276}
confusion matrix:
       0    1
0  40769  586
1    496  949
---- Validation: 
scalar performance:
{'acc': 0.9704468, 'precision': 0.7781404, 'recall': 0.8183415, 'specificity': 0.8183415, 'f1': 0.7967323, 'auroc': 0.9615791, 'binary_precision': 0.56891894, 'binary_recall': 0.6547434, 'binary_specificity': 0.9819397, 'binary_f1_score': 0.6088214}
confusion matrix:
       0    1
0  17344  319
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96041924, 'precision': 0.747319, 'recall': 0.51338625, 'specificity': 0.51338625, 'f1': 0.5162963, 'auroc': 0.77341545, 'binary_precision': 0.53333336, 'binary_recall': 0.027777778, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.05280528}
confusion matrix:
      0  1
0  6956  7
1   280  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 1
val acc:0.9704468250274658, best validation acc: 0.9727411866188049, corresponding to test acc:                         0.960005521774292 / 0.963177502155304
after epoch: 16,now: 2024-05-28 18:55:26.973425,epoch time: 0:18:35.425381,used: 5:20:32.083385,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9759112, 'precision': 0.8162361, 'recall': 0.81222135, 'specificity': 0.81222135, 'f1': 0.81421465, 'auroc': 0.969659, 'binary_precision': 0.6451613, 'binary_recall': 0.6366782, 'binary_specificity': 0.9877645, 'binary_f1_score': 0.6408917}
confusion matrix:
       0    1
0  40849  506
1    525  920
---- Validation: 
scalar performance:
{'acc': 0.9730143, 'precision': 0.79707134, 'recall': 0.8219199, 'specificity': 0.8219199, 'f1': 0.8089433, 'auroc': 0.9591863, 'binary_precision': 0.60658085, 'binary_recall': 0.65940905, 'binary_specificity': 0.98443073, 'binary_f1_score': 0.63189274}
confusion matrix:
       0    1
0  17388  275
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.7112887, 'recall': 0.50991404, 'specificity': 0.50991404, 'f1': 0.50975823, 'auroc': 0.7053589, 'binary_precision': 0.46153846, 'binary_recall': 0.020833334, 'binary_specificity': 0.9989947, 'binary_f1_score': 0.03986711}
confusion matrix:
      0  1
0  6956  7
1   282  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
better model found
persisted
after epoch: 17,now: 2024-05-28 19:14:14.677134,epoch time: 0:18:47.703709,used: 5:39:19.787094,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9776402, 'precision': 0.83787644, 'recall': 0.8027642, 'specificity': 0.8027642, 'f1': 0.8192712, 'auroc': 0.97177696, 'binary_precision': 0.6891473, 'binary_recall': 0.6152249, 'binary_specificity': 0.99030346, 'binary_f1_score': 0.6500914}
confusion matrix:
       0    1
0  40954  401
1    556  889
---- Validation: 
scalar performance:
{'acc': 0.97558177, 'precision': 0.8237834, 'recall': 0.8067658, 'specificity': 0.8067658, 'f1': 0.81502235, 'auroc': 0.9618458, 'binary_precision': 0.6611842, 'binary_recall': 0.62519443, 'binary_specificity': 0.9883372, 'binary_f1_score': 0.64268583}
confusion matrix:
       0    1
0  17457  206
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9612467, 'precision': 0.8230926, 'recall': 0.5221386, 'specificity': 0.5221386, 'f1': 0.5324474, 'auroc': 0.76460844, 'binary_precision': 0.68421054, 'binary_recall': 0.045138888, 'binary_specificity': 0.9991383, 'binary_f1_score': 0.08469055}
confusion matrix:
      0   1
0  6957   6
1   275  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
better model found
persisted
after epoch: 18,now: 2024-05-28 19:33:03.125604,epoch time: 0:18:48.448470,used: 5:58:08.235564,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97675234, 'precision': 0.8584391, 'recall': 0.7403501, 'specificity': 0.7403501, 'f1': 0.78681505, 'auroc': 0.9426321, 'binary_precision': 0.73458725, 'binary_recall': 0.4868421, 'binary_specificity': 0.9938582, 'binary_f1_score': 0.5855893}
confusion matrix:
       0    1
0  41102  254
1    741  703
---- Validation: 
scalar performance:
{'acc': 0.97388834, 'precision': 0.83170545, 'recall': 0.7362036, 'specificity': 0.7362036, 'f1': 0.7752049, 'auroc': 0.9284134, 'binary_precision': 0.6821192, 'binary_recall': 0.4805599, 'binary_specificity': 0.99184734, 'binary_f1_score': 0.5638686}
confusion matrix:
       0    1
0  17519  144
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440077, 'precision': 0.63528585, 'recall': 0.6379853, 'specificity': 0.6379853, 'f1': 0.6366194, 'auroc': 0.8036308, 'binary_precision': 0.2993197, 'binary_recall': 0.30555555, 'binary_specificity': 0.97041506, 'binary_f1_score': 0.30240548}
confusion matrix:
      0    1
0  6757  206
1   200   88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 1
val acc:0.9738883376121521, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 19,now: 2024-05-28 19:51:50.612175,epoch time: 0:18:47.486571,used: 6:16:55.722135,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97621495, 'precision': 0.8206183, 'recall': 0.806442, 'specificity': 0.806442, 'f1': 0.81335473, 'auroc': 0.9714488, 'binary_precision': 0.654321, 'binary_recall': 0.62439364, 'binary_specificity': 0.98849046, 'binary_f1_score': 0.6390071}
confusion matrix:
       0    1
0  40881  476
1    542  901
---- Validation: 
scalar performance:
{'acc': 0.97164863, 'precision': 0.78597176, 'recall': 0.82645726, 'specificity': 0.82645726, 'f1': 0.804727, 'auroc': 0.962663, 'binary_precision': 0.58401084, 'binary_recall': 0.6702955, 'binary_specificity': 0.98261905, 'binary_f1_score': 0.6241854}
confusion matrix:
       0    1
0  17356  307
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96248794, 'precision': 0.8039164, 'recall': 0.5610638, 'specificity': 0.5610638, 'f1': 0.59504527, 'auroc': 0.7336984, 'binary_precision': 0.64285713, 'binary_recall': 0.125, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.20930232}
confusion matrix:
      0   1
0  6943  20
1   252  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 2
val acc:0.971648633480072, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 20,now: 2024-05-28 20:10:31.192893,epoch time: 0:18:40.580718,used: 6:35:36.302853,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97635514, 'precision': 0.8173616, 'recall': 0.82413864, 'specificity': 0.82413864, 'f1': 0.8207108, 'auroc': 0.97689253, 'binary_precision': 0.64658093, 'binary_recall': 0.66089964, 'binary_specificity': 0.9873776, 'binary_f1_score': 0.65366185}
confusion matrix:
       0    1
0  40833  522
1    490  955
---- Validation: 
scalar performance:
{'acc': 0.97066534, 'precision': 0.77850914, 'recall': 0.8319421, 'specificity': 0.8319421, 'f1': 0.80261886, 'auroc': 0.9619534, 'binary_precision': 0.56865287, 'binary_recall': 0.6827372, 'binary_specificity': 0.98114705, 'binary_f1_score': 0.6204947}
confusion matrix:
       0    1
0  17330  333
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96166044, 'precision': 0.7841047, 'recall': 0.54898286, 'specificity': 0.54898286, 'f1': 0.5764973, 'auroc': 0.8996775, 'binary_precision': 0.6041667, 'binary_recall': 0.10069445, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.17261904}
confusion matrix:
      0   1
0  6944  19
1   259  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 3
val acc:0.9706653356552124, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 21,now: 2024-05-28 20:28:58.612827,epoch time: 0:18:27.419934,used: 6:54:03.722787,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9756308, 'precision': 0.82200754, 'recall': 0.7828778, 'specificity': 0.7828778, 'f1': 0.8010601, 'auroc': 0.95866215, 'binary_precision': 0.658749, 'binary_recall': 0.5761773, 'binary_specificity': 0.9895783, 'binary_f1_score': 0.61470264}
confusion matrix:
       0    1
0  40925  431
1    612  832
---- Validation: 
scalar performance:
{'acc': 0.9705015, 'precision': 0.783103, 'recall': 0.7771585, 'specificity': 0.7771585, 'f1': 0.7800958, 'auroc': 0.9479592, 'binary_precision': 0.581876, 'binary_recall': 0.56920683, 'binary_specificity': 0.9851101, 'binary_f1_score': 0.5754717}
confusion matrix:
       0    1
0  17400  263
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590401, 'precision': 0.6120131, 'recall': 0.50767523, 'specificity': 0.50767523, 'f1': 0.5058252, 'auroc': 0.7012044, 'binary_precision': 0.2631579, 'binary_recall': 0.017361112, 'binary_specificity': 0.99798936, 'binary_f1_score': 0.03257329}
confusion matrix:
      0   1
0  6949  14
1   283   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 4
val acc:0.9705014824867249, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 22,now: 2024-05-28 20:47:32.430036,epoch time: 0:18:33.817209,used: 7:12:37.539996,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97553736, 'precision': 0.83017135, 'recall': 0.7592669, 'specificity': 0.7592669, 'f1': 0.7900777, 'auroc': 0.9645004, 'binary_precision': 0.67673177, 'binary_recall': 0.52733564, 'binary_specificity': 0.9911982, 'binary_f1_score': 0.59276545}
confusion matrix:
       0    1
0  40991  364
1    683  762
---- Validation: 
scalar performance:
{'acc': 0.9717033, 'precision': 0.795606, 'recall': 0.7680404, 'specificity': 0.7680404, 'f1': 0.7810798, 'auroc': 0.9519372, 'binary_precision': 0.60757315, 'binary_recall': 0.5489891, 'binary_specificity': 0.98709166, 'binary_f1_score': 0.57679737}
confusion matrix:
       0    1
0  17435  228
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95890224, 'precision': 0.634469, 'recall': 0.5125963, 'specificity': 0.5125963, 'f1': 0.51497585, 'auroc': 0.6272441, 'binary_precision': 0.30769232, 'binary_recall': 0.027777778, 'binary_specificity': 0.9974149, 'binary_f1_score': 0.05095541}
confusion matrix:
      0   1
0  6945  18
1   280   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 5
val acc:0.971703290939331, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 23,now: 2024-05-28 21:06:02.292644,epoch time: 0:18:29.862608,used: 7:31:07.402604,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97581774, 'precision': 0.80013585, 'recall': 0.8926502, 'specificity': 0.8926502, 'f1': 0.83955216, 'auroc': 0.9807509, 'binary_precision': 0.60721755, 'binary_recall': 0.8034602, 'binary_specificity': 0.9818402, 'binary_f1_score': 0.691689}
confusion matrix:
       0     1
0  40604   751
1    284  1161
---- Validation: 
scalar performance:
{'acc': 0.9705015, 'precision': 0.77439034, 'recall': 0.88206005, 'specificity': 0.88206005, 'f1': 0.8183298, 'auroc': 0.96750855, 'binary_precision': 0.55665565, 'binary_recall': 0.7869362, 'binary_specificity': 0.97718394, 'binary_f1_score': 0.6520618}
confusion matrix:
       0    1
0  17260  403
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95917803, 'precision': 0.6972356, 'recall': 0.5410331, 'specificity': 0.5410331, 'f1': 0.5617994, 'auroc': 0.8442954, 'binary_precision': 0.43103448, 'binary_recall': 0.08680555, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.14450867}
confusion matrix:
      0   1
0  6930  33
1   263  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 6
val acc:0.9705014824867249, best validation acc: 0.9755817651748657, corresponding to test acc:                         0.9612467288970947 / 0.963177502155304
after epoch: 24,now: 2024-05-28 21:24:40.529128,epoch time: 0:18:38.236484,used: 7:49:45.639088,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.978014, 'precision': 0.89433265, 'recall': 0.72715545, 'specificity': 0.72715545, 'f1': 0.7866279, 'auroc': 0.97846246, 'binary_precision': 0.8073171, 'binary_recall': 0.4581315, 'binary_specificity': 0.9961794, 'binary_f1_score': 0.58454746}
confusion matrix:
       0    1
0  41197  158
1    783  662
---- Validation: 
scalar performance:
{'acc': 0.9758003, 'precision': 0.869768, 'recall': 0.72520566, 'specificity': 0.72520566, 'f1': 0.7785176, 'auroc': 0.96203196, 'binary_precision': 0.75906736, 'binary_recall': 0.45567653, 'binary_specificity': 0.99473476, 'binary_f1_score': 0.56948495}
confusion matrix:
       0    1
0  17570   93
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96414286, 'precision': 0.83928955, 'recall': 0.58023286, 'specificity': 0.58023286, 'f1': 0.62357986, 'auroc': 0.8956927, 'binary_precision': 0.7121212, 'binary_recall': 0.16319445, 'binary_specificity': 0.9972713, 'binary_f1_score': 0.26553673}
confusion matrix:
      0   1
0  6944  19
1   241  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-05-28 21:43:16.119398,epoch time: 0:18:35.590270,used: 8:08:21.229358,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9767757, 'precision': 0.88135225, 'recall': 0.71415925, 'specificity': 0.71415925, 'f1': 0.7725581, 'auroc': 0.9675199, 'binary_precision': 0.7822278, 'binary_recall': 0.43252596, 'binary_specificity': 0.9957925, 'binary_f1_score': 0.55704105}
confusion matrix:
       0    1
0  41181  174
1    820  625
---- Validation: 
scalar performance:
{'acc': 0.9735606, 'precision': 0.8530654, 'recall': 0.69482243, 'specificity': 0.69482243, 'f1': 0.74925447, 'auroc': 0.9557401, 'binary_precision': 0.7277937, 'binary_recall': 0.39502332, 'binary_specificity': 0.9946215, 'binary_f1_score': 0.5120967}
confusion matrix:
       0    1
0  17568   95
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96179837, 'precision': 0.79890394, 'recall': 0.5440618, 'specificity': 0.5440618, 'f1': 0.56925523, 'auroc': 0.88933533, 'binary_precision': 0.63414633, 'binary_recall': 0.090277776, 'binary_specificity': 0.99784577, 'binary_f1_score': 0.1580547}
confusion matrix:
      0   1
0  6948  15
1   262  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 1
val acc:0.9735605716705322, best validation acc: 0.9758002758026123, corresponding to test acc:                         0.9641428589820862 / 0.9641428589820862
after epoch: 26,now: 2024-05-28 22:01:53.217825,epoch time: 0:18:37.098427,used: 8:26:58.327785,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9739486, 'precision': 0.7878479, 'recall': 0.8926847, 'specificity': 0.8926847, 'f1': 0.83129144, 'auroc': 0.982468, 'binary_precision': 0.5825826, 'binary_recall': 0.8055363, 'binary_specificity': 0.9798331, 'binary_f1_score': 0.6761545}
confusion matrix:
       0     1
0  40521   834
1    281  1164
---- Validation: 
scalar performance:
{'acc': 0.96760625, 'precision': 0.7590457, 'recall': 0.88130903, 'specificity': 0.88130903, 'f1': 0.8070245, 'auroc': 0.96367425, 'binary_precision': 0.5259336, 'binary_recall': 0.7884914, 'binary_specificity': 0.9741267, 'binary_f1_score': 0.6309895}
confusion matrix:
       0    1
0  17206  457
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95931596, 'precision': 0.7262889, 'recall': 0.645956, 'specificity': 0.645956, 'f1': 0.67632407, 'auroc': 0.9043404, 'binary_precision': 0.48087433, 'binary_recall': 0.30555555, 'binary_specificity': 0.98635644, 'binary_f1_score': 0.37367305}
confusion matrix:
      0   1
0  6868  95
1   200  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 2
val acc:0.967606246471405, best validation acc: 0.9758002758026123, corresponding to test acc:                         0.9641428589820862 / 0.9641428589820862
after epoch: 27,now: 2024-05-28 22:20:22.949438,epoch time: 0:18:29.731613,used: 8:45:28.059398,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9746262, 'precision': 0.7988, 'recall': 0.84127617, 'specificity': 0.84127617, 'f1': 0.8184823, 'auroc': 0.97672564, 'binary_precision': 0.6081977, 'binary_recall': 0.6982699, 'binary_specificity': 0.98428243, 'binary_f1_score': 0.6501289}
confusion matrix:
       0     1
0  40705   650
1    436  1009
---- Validation: 
scalar performance:
{'acc': 0.9712116, 'precision': 0.78253627, 'recall': 0.82922804, 'specificity': 0.82922804, 'f1': 0.80389893, 'auroc': 0.9627383, 'binary_precision': 0.5769231, 'binary_recall': 0.67651635, 'binary_specificity': 0.9819397, 'binary_f1_score': 0.62276304}
confusion matrix:
       0    1
0  17344  319
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95890224, 'precision': 0.6716109, 'recall': 0.52591074, 'specificity': 0.52591074, 'f1': 0.53797114, 'auroc': 0.8452641, 'binary_precision': 0.3809524, 'binary_recall': 0.055555556, 'binary_specificity': 0.99626595, 'binary_f1_score': 0.0969697}
confusion matrix:
      0   1
0  6937  26
1   272  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 3
val acc:0.9712116122245789, best validation acc: 0.9758002758026123, corresponding to test acc:                         0.9641428589820862 / 0.9641428589820862
after epoch: 28,now: 2024-05-28 22:38:57.059728,epoch time: 0:18:34.110290,used: 9:04:02.169688,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9748832, 'precision': 0.79745626, 'recall': 0.86344856, 'specificity': 0.86344856, 'f1': 0.8268083, 'auroc': 0.9802797, 'binary_precision': 0.60393256, 'binary_recall': 0.74394464, 'binary_specificity': 0.9829525, 'binary_f1_score': 0.6666666}
confusion matrix:
       0     1
0  40650   705
1    370  1075
---- Validation: 
scalar performance:
{'acc': 0.96782476, 'precision': 0.7605372, 'recall': 0.83121943, 'specificity': 0.83121943, 'f1': 0.7911435, 'auroc': 0.9634431, 'binary_precision': 0.53268766, 'binary_recall': 0.6842924, 'binary_specificity': 0.97814643, 'binary_f1_score': 0.599047}
confusion matrix:
       0    1
0  17277  386
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96014345, 'precision': 0.7249403, 'recall': 0.53154993, 'specificity': 0.53154993, 'f1': 0.54791, 'auroc': 0.7679888, 'binary_precision': 0.4871795, 'binary_recall': 0.065972224, 'binary_specificity': 0.99712765, 'binary_f1_score': 0.11620795}
confusion matrix:
      0   1
0  6943  20
1   269  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 4
val acc:0.9678247570991516, best validation acc: 0.9758002758026123, corresponding to test acc:                         0.9641428589820862 / 0.9641428589820862
after epoch: 29,now: 2024-05-28 22:57:33.681058,epoch time: 0:18:36.621330,used: 9:22:38.791018,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9698131, 'precision': 0.7704209, 'recall': 0.7479565, 'specificity': 0.7479565, 'f1': 0.758651, 'auroc': 0.9477272, 'binary_precision': 0.5579107, 'binary_recall': 0.5100346, 'binary_specificity': 0.98587835, 'binary_f1_score': 0.53289956}
confusion matrix:
       0    1
0  40771  584
1    708  737
---- Validation: 
scalar performance:
{'acc': 0.962963, 'precision': 0.7270031, 'recall': 0.7290435, 'specificity': 0.7290435, 'f1': 0.72801816, 'auroc': 0.93538904, 'binary_precision': 0.47303542, 'binary_recall': 0.47744945, 'binary_specificity': 0.9806375, 'binary_f1_score': 0.47523218}
confusion matrix:
       0    1
0  17321  342
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9594539, 'precision': 0.7132034, 'recall': 0.55948406, 'specificity': 0.55948406, 'f1': 0.5879617, 'auroc': 0.8477815, 'binary_precision': 0.46153846, 'binary_recall': 0.125, 'binary_specificity': 0.9939681, 'binary_f1_score': 0.19672132}
confusion matrix:
      0   1
0  6921  42
1   252  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center2_20897896.png
early stop counter: 5
val acc:0.9629629850387573, best validation acc: 0.9758002758026123, corresponding to test acc:                         0.9641428589820862 / 0.9641428589820862
after epoch: 30,now: 2024-05-28 23:16:13.146512,epoch time: 0:18:39.465454,used: 9:41:18.256472,model: dset_te_center2_erm_b44271c83_not_commited_2024md_05md_28_13_34_54_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:41:18.256472 at 2024-05-28 23:16:13.146512
persisted model performance metric: 

scalar performance:
{'acc': 0.9634533, 'precision': 0.8302858, 'recall': 0.569888, 'specificity': 0.569888, 'f1': 0.608795, 'auroc': 0.8947419, 'binary_precision': 0.69491524, 'binary_recall': 0.1423611, 'binary_specificity': 0.9974149, 'binary_f1_score': 0.23631123}
confusion matrix:
      0   1
0  6945  18
1   247  41
oracle model performance metric: 

scalar performance:
{'acc': 0.9644187, 'precision': 0.8581039, 'recall': 0.5770479, 'specificity': 0.5770479, 'f1': 0.6201963, 'auroc': 0.8894716, 'binary_precision': 0.75, 'binary_recall': 0.15625, 'binary_specificity': 0.99784577, 'binary_f1_score': 0.25862068}
confusion matrix:
      0   1
0  6948  15
1   243  45
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496085 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |  90005 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496085 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |  90005 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476619 KiB |  10962 MiB |   4285 TiB |   4285 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4278 TiB |   4278 TiB |
|       from small pool |  88779 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11238 MiB |  11392 MiB |  30058 MiB |  18820 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    126 MiB |    126 MiB |    178 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1396 TiB |   1396 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1388 TiB |   1388 TiB |
|       from small pool |      8 MiB |     33 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4101    |    7764    |  355341 K  |  355337 K  |
|       from large pool |      87    |     909    |  167423 K  |  167422 K  |
|       from small pool |    4014    |    7642    |  187918 K  |  187914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4101    |    7764    |  355341 K  |  355337 K  |
|       from large pool |      87    |     909    |  167423 K  |  167422 K  |
|       from small pool |    4014    |    7642    |  187918 K  |  187914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     537    |     302    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      63    |      63    |      89    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    2768    |  188414 K  |  188414 K  |
|       from large pool |      24    |      65    |   88676 K  |   88676 K  |
|       from small pool |      49    |    2747    |   99737 K  |   99737 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |      0 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |      0 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4285 TiB |   4285 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4278 TiB |   4278 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30058 MiB |  28226 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    178 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1396 TiB |   1396 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |     33 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  355341 K  |  355341 K  |
|       from large pool |       2    |     909    |  167423 K  |  167423 K  |
|       from small pool |       0    |    7642    |  187918 K  |  187918 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  355341 K  |  355341 K  |
|       from large pool |       2    |     909    |  167423 K  |  167423 K  |
|       from small pool |       0    |    7642    |  187918 K  |  187918 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     537    |     455    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      89    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  188415 K  |  188415 K  |
|       from large pool |       4    |      65    |   88676 K  |   88676 K  |
|       from small pool |       0    |    2747    |   99739 K  |   99739 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |      0 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4303 TiB |   4303 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4296 TiB |   4296 TiB |
|       from small pool |      0 KiB |    125 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   4285 TiB |   4285 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4278 TiB |   4278 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30058 MiB |  28226 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    178 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1396 TiB |   1396 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |     33 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  355341 K  |  355341 K  |
|       from large pool |       2    |     909    |  167423 K  |  167423 K  |
|       from small pool |       0    |    7642    |  187918 K  |  187918 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  355341 K  |  355341 K  |
|       from large pool |       2    |     909    |  167423 K  |  167423 K  |
|       from small pool |       0    |    7642    |  187918 K  |  187918 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     537    |     455    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      89    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  188415 K  |  188415 K  |
|       from large pool |       4    |      65    |   88676 K  |   88676 K  |
|       from small pool |       0    |    2747    |   99739 K  |   99739 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896

 Experiment start at: 2024-05-28 23:25:31.886923
before training, model accuracy: 0.2902069687843323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9703568, 'precision': 0.78197986, 'recall': 0.8074963, 'specificity': 0.8074963, 'f1': 0.7941233, 'auroc': 0.9378363, 'binary_precision': 0.5776316, 'binary_recall': 0.6321094, 'binary_specificity': 0.9828832, 'binary_f1_score': 0.6036439}
confusion matrix:
       0    1
0  36865  642
1    511  878
---- Validation: 
scalar performance:
{'acc': 0.96750164, 'precision': 0.7625004, 'recall': 0.80512726, 'specificity': 0.80512726, 'f1': 0.78202015, 'auroc': 0.9403259, 'binary_precision': 0.5387931, 'binary_recall': 0.6302521, 'binary_specificity': 0.98000246, 'binary_f1_score': 0.580945}
confusion matrix:
       0    1
0  15731  321
1    220  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646985, 'precision': 0.70699954, 'recall': 0.7186294, 'specificity': 0.7186294, 'f1': 0.71263695, 'auroc': 0.91872156, 'binary_precision': 0.43131867, 'binary_recall': 0.45639536, 'binary_specificity': 0.98086345, 'binary_f1_score': 0.4435028}
confusion matrix:
       0    1
0  10610  207
1    187  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-28 23:46:43.402657,epoch time: 0:21:11.515734,used: 0:21:11.515734,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96364665, 'precision': 0.73771566, 'recall': 0.7665798, 'specificity': 0.7665798, 'f1': 0.7512164, 'auroc': 0.9310683, 'binary_precision': 0.49201277, 'binary_recall': 0.5543557, 'binary_specificity': 0.97880393, 'binary_f1_score': 0.521327}
confusion matrix:
       0    1
0  36712  795
1    619  770
---- Validation: 
scalar performance:
{'acc': 0.9619151, 'precision': 0.72809166, 'recall': 0.769863, 'specificity': 0.769863, 'f1': 0.7469925, 'auroc': 0.91458815, 'binary_precision': 0.47249648, 'binary_recall': 0.56302524, 'binary_specificity': 0.9767007, 'binary_f1_score': 0.5138037}
confusion matrix:
       0    1
0  15678  374
1    260  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689992, 'precision': 0.7369878, 'recall': 0.6532994, 'specificity': 0.6532994, 'f1': 0.6853113, 'auroc': 0.93285584, 'binary_precision': 0.49545455, 'binary_recall': 0.31686047, 'binary_specificity': 0.98973835, 'binary_f1_score': 0.38652486}
confusion matrix:
       0    1
0  10706  111
1    235  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
new oracle model saved
early stop counter: 1
val acc:0.9619150757789612, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9689992070198059
after epoch: 2,now: 2024-05-29 00:06:13.434809,epoch time: 0:19:30.032152,used: 0:40:41.547886,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97115386, 'precision': 0.797212, 'recall': 0.7566068, 'specificity': 0.7566068, 'f1': 0.7752675, 'auroc': 0.9534351, 'binary_precision': 0.6119028, 'binary_recall': 0.52555794, 'binary_specificity': 0.98765564, 'binary_f1_score': 0.5654531}
confusion matrix:
       0    1
0  37044  463
1    659  730
---- Validation: 
scalar performance:
{'acc': 0.96636033, 'precision': 0.7565553, 'recall': 0.73656374, 'specificity': 0.73656374, 'f1': 0.74610746, 'auroc': 0.95210177, 'binary_precision': 0.5319927, 'binary_recall': 0.48907563, 'binary_specificity': 0.9840518, 'binary_f1_score': 0.5096322}
confusion matrix:
       0    1
0  15796  256
1    304  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694472, 'precision': 0.74316853, 'recall': 0.59442544, 'specificity': 0.59442544, 'f1': 0.6332483, 'auroc': 0.9375128, 'binary_precision': 0.5114504, 'binary_recall': 0.19476745, 'binary_specificity': 0.9940834, 'binary_f1_score': 0.28210527}
confusion matrix:
       0   1
0  10753  64
1    277  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
new oracle model saved
early stop counter: 2
val acc:0.966360330581665, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9694471955299377
after epoch: 3,now: 2024-05-29 00:25:38.449899,epoch time: 0:19:25.015090,used: 1:00:06.562976,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9684029, 'precision': 0.76789486, 'recall': 0.8127227, 'specificity': 0.8127227, 'f1': 0.78837216, 'auroc': 0.95117164, 'binary_precision': 0.54901963, 'binary_recall': 0.6450684, 'binary_specificity': 0.980377, 'binary_f1_score': 0.5931811}
confusion matrix:
       0    1
0  36771  736
1    493  896
---- Validation: 
scalar performance:
{'acc': 0.96636033, 'precision': 0.7553066, 'recall': 0.8296203, 'specificity': 0.8296203, 'f1': 0.787147, 'auroc': 0.9501538, 'binary_precision': 0.5225225, 'binary_recall': 0.68235296, 'binary_specificity': 0.97688764, 'binary_f1_score': 0.59183675}
confusion matrix:
       0    1
0  15681  371
1    189  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643401, 'precision': 0.707436, 'recall': 0.73533165, 'specificity': 0.73533165, 'f1': 0.72040063, 'auroc': 0.9369755, 'binary_precision': 0.43112245, 'binary_recall': 0.49127907, 'binary_specificity': 0.9793843, 'binary_f1_score': 0.45923913}
confusion matrix:
       0    1
0  10594  223
1    175  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 3
val acc:0.966360330581665, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9694471955299377
after epoch: 4,now: 2024-05-29 00:44:55.787744,epoch time: 0:19:17.337845,used: 1:19:23.900821,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9661662, 'precision': 0.7541173, 'recall': 0.8372143, 'specificity': 0.8372143, 'f1': 0.7890836, 'auroc': 0.95488286, 'binary_precision': 0.5195501, 'binary_recall': 0.6983441, 'binary_specificity': 0.9760845, 'binary_f1_score': 0.5958231}
confusion matrix:
       0    1
0  36610  897
1    419  970
---- Validation: 
scalar performance:
{'acc': 0.96311647, 'precision': 0.738487, 'recall': 0.83117497, 'specificity': 0.83117497, 'f1': 0.7762776, 'auroc': 0.95350015, 'binary_precision': 0.488677, 'binary_recall': 0.68907565, 'binary_specificity': 0.97327435, 'binary_f1_score': 0.5718271}
confusion matrix:
       0    1
0  15623  429
1    185  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663113, 'precision': 0.7281723, 'recall': 0.81937724, 'specificity': 0.81937724, 'f1': 0.7652902, 'auroc': 0.9539273, 'binary_precision': 0.46721312, 'binary_recall': 0.6627907, 'binary_specificity': 0.9759638, 'binary_f1_score': 0.5480769}
confusion matrix:
       0    1
0  10557  260
1    116  228
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 4
val acc:0.963116466999054, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9694471955299377
after epoch: 5,now: 2024-05-29 01:04:24.070501,epoch time: 0:19:28.282757,used: 1:38:52.183578,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9649064, 'precision': 0.74885476, 'recall': 0.88266426, 'specificity': 0.88266426, 'f1': 0.79968154, 'auroc': 0.9670273, 'binary_precision': 0.50549954, 'binary_recall': 0.79409647, 'binary_specificity': 0.97123206, 'binary_f1_score': 0.6177541}
confusion matrix:
       0     1
0  36428  1079
1    286  1103
---- Validation: 
scalar performance:
{'acc': 0.9653391, 'precision': 0.750273, 'recall': 0.85498476, 'specificity': 0.85498476, 'f1': 0.7923846, 'auroc': 0.96033156, 'binary_precision': 0.5104895, 'binary_recall': 0.73613447, 'binary_specificity': 0.97383505, 'binary_f1_score': 0.60289055}
confusion matrix:
       0    1
0  15632  420
1    157  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655049, 'precision': 0.7262768, 'recall': 0.84569925, 'specificity': 0.84569925, 'f1': 0.7720238, 'auroc': 0.9511231, 'binary_precision': 0.46168223, 'binary_recall': 0.71802324, 'binary_specificity': 0.97337526, 'binary_f1_score': 0.56200224}
confusion matrix:
       0    1
0  10529  288
1     97  247
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 5
val acc:0.9653391242027283, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9694471955299377
after epoch: 6,now: 2024-05-29 01:23:48.255181,epoch time: 0:19:24.184680,used: 1:58:16.368258,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96737456, 'precision': 0.7606178, 'recall': 0.8572527, 'specificity': 0.8572527, 'f1': 0.800423, 'auroc': 0.96340644, 'binary_precision': 0.5310559, 'binary_recall': 0.73866093, 'binary_specificity': 0.9758445, 'binary_f1_score': 0.6178862}
confusion matrix:
       0     1
0  36601   906
1    363  1026
---- Validation: 
scalar performance:
{'acc': 0.96461827, 'precision': 0.74669445, 'recall': 0.8529926, 'specificity': 0.8529926, 'f1': 0.7891743, 'auroc': 0.9549844, 'binary_precision': 0.5034642, 'binary_recall': 0.7327731, 'binary_specificity': 0.97321206, 'binary_f1_score': 0.5968515}
confusion matrix:
       0    1
0  15622  430
1    159  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602186, 'precision': 0.70691055, 'recall': 0.87111735, 'specificity': 0.87111735, 'f1': 0.7626051, 'auroc': 0.93960273, 'binary_precision': 0.42113563, 'binary_recall': 0.7761628, 'binary_specificity': 0.9660719, 'binary_f1_score': 0.5460123}
confusion matrix:
       0    1
0  10450  367
1     77  267
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 6
val acc:0.9646182656288147, best validation acc: 0.9675016403198242, corresponding to test acc:                         0.9646984934806824 / 0.9694471955299377
after epoch: 7,now: 2024-05-29 01:43:05.058911,epoch time: 0:19:16.803730,used: 2:17:33.171988,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9743418, 'precision': 0.81064373, 'recall': 0.826548, 'specificity': 0.826548, 'f1': 0.8183764, 'auroc': 0.9620869, 'binary_precision': 0.6336295, 'binary_recall': 0.6673866, 'binary_specificity': 0.9857093, 'binary_f1_score': 0.6500701}
confusion matrix:
       0    1
0  36971  536
1    462  927
---- Validation: 
scalar performance:
{'acc': 0.97212714, 'precision': 0.7956281, 'recall': 0.80995333, 'specificity': 0.80995333, 'f1': 0.80260277, 'auroc': 0.96006495, 'binary_precision': 0.6048, 'binary_recall': 0.63529414, 'binary_specificity': 0.9846125, 'binary_f1_score': 0.61967206}
confusion matrix:
       0    1
0  15805  247
1    217  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655945, 'precision': 0.72336197, 'recall': 0.80774933, 'specificity': 0.80774933, 'f1': 0.75805926, 'auroc': 0.9563048, 'binary_precision': 0.45833334, 'binary_recall': 0.6395349, 'binary_specificity': 0.9759638, 'binary_f1_score': 0.5339806}
confusion matrix:
       0    1
0  10557  260
1    124  220
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
better model found
persisted
after epoch: 8,now: 2024-05-29 02:02:24.622926,epoch time: 0:19:19.564015,used: 2:36:52.736003,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97094816, 'precision': 0.7827272, 'recall': 0.841427, 'specificity': 0.841427, 'f1': 0.8089961, 'auroc': 0.9650408, 'binary_precision': 0.5765819, 'binary_recall': 0.7019438, 'binary_specificity': 0.98091024, 'binary_f1_score': 0.63311684}
confusion matrix:
       0    1
0  36791  716
1    414  975
---- Validation: 
scalar performance:
{'acc': 0.96900344, 'precision': 0.77122533, 'recall': 0.8269449, 'specificity': 0.8269449, 'f1': 0.7961803, 'auroc': 0.95589817, 'binary_precision': 0.5546335, 'binary_recall': 0.6739496, 'binary_specificity': 0.9799402, 'binary_f1_score': 0.60849774}
confusion matrix:
       0    1
0  15730  322
1    194  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95636594, 'precision': 0.6883688, 'recall': 0.8353554, 'specificity': 0.8353554, 'f1': 0.73833734, 'auroc': 0.94955057, 'binary_precision': 0.3863275, 'binary_recall': 0.7063953, 'binary_specificity': 0.9643154, 'binary_f1_score': 0.49948612}
confusion matrix:
       0    1
0  10431  386
1    101  243
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 1
val acc:0.969003438949585, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 9,now: 2024-05-29 02:21:47.433148,epoch time: 0:19:22.810222,used: 2:56:15.546225,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9712824, 'precision': 0.78894407, 'recall': 0.80832285, 'specificity': 0.80832285, 'f1': 0.79828423, 'auroc': 0.9549318, 'binary_precision': 0.59152085, 'binary_recall': 0.63282937, 'binary_specificity': 0.9838163, 'binary_f1_score': 0.61147827}
confusion matrix:
       0    1
0  36900  607
1    510  879
---- Validation: 
scalar performance:
{'acc': 0.9670211, 'precision': 0.75948465, 'recall': 0.80245054, 'specificity': 0.80245054, 'f1': 0.77912515, 'auroc': 0.9572195, 'binary_precision': 0.5329513, 'binary_recall': 0.6252101, 'binary_specificity': 0.979691, 'binary_f1_score': 0.575406}
confusion matrix:
       0    1
0  15726  326
1    223  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96353376, 'precision': 0.7171498, 'recall': 0.84468234, 'specificity': 0.84468234, 'f1': 0.7646398, 'auroc': 0.9593321, 'binary_precision': 0.44344702, 'binary_recall': 0.71802324, 'binary_specificity': 0.97134143, 'binary_f1_score': 0.54827964}
confusion matrix:
       0    1
0  10507  310
1     97  247
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 2
val acc:0.967021107673645, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 10,now: 2024-05-29 02:41:12.624468,epoch time: 0:19:25.191320,used: 3:15:40.737545,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97141093, 'precision': 0.78373325, 'recall': 0.863852, 'specificity': 0.863852, 'f1': 0.81825244, 'auroc': 0.9667102, 'binary_precision': 0.57690173, 'binary_recall': 0.7480202, 'binary_specificity': 0.9796838, 'binary_f1_score': 0.6514107}
confusion matrix:
       0     1
0  36745   762
1    350  1039
---- Validation: 
scalar performance:
{'acc': 0.9702649, 'precision': 0.77753663, 'recall': 0.853493, 'specificity': 0.853493, 'f1': 0.81039786, 'auroc': 0.95948213, 'binary_precision': 0.5652742, 'binary_recall': 0.7277311, 'binary_specificity': 0.9792549, 'binary_f1_score': 0.63629687}
confusion matrix:
       0    1
0  15719  333
1    162  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875014, 'precision': 0.677511, 'recall': 0.90178967, 'specificity': 0.90178967, 'f1': 0.739509, 'auroc': 0.95206183, 'binary_precision': 0.35995087, 'binary_recall': 0.8517442, 'binary_specificity': 0.9518351, 'binary_f1_score': 0.5060449}
confusion matrix:
       0    1
0  10296  521
1     51  293
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 3
val acc:0.9702649116516113, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 11,now: 2024-05-29 03:01:33.433459,epoch time: 0:20:20.808991,used: 3:36:01.546536,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9729535, 'precision': 0.7911112, 'recall': 0.88787675, 'specificity': 0.88787675, 'f1': 0.83179027, 'auroc': 0.96563995, 'binary_precision': 0.58986664, 'binary_recall': 0.7962563, 'binary_specificity': 0.97949713, 'binary_f1_score': 0.67769605}
confusion matrix:
       0     1
0  36738   769
1    283  1106
---- Validation: 
scalar performance:
{'acc': 0.9707455, 'precision': 0.7786907, 'recall': 0.88044536, 'specificity': 0.88044536, 'f1': 0.8207611, 'auroc': 0.9533918, 'binary_precision': 0.565534, 'binary_recall': 0.7831933, 'binary_specificity': 0.9776975, 'binary_f1_score': 0.6568006}
confusion matrix:
       0    1
0  15694  358
1    129  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94677895, 'precision': 0.6734462, 'recall': 0.9049945, 'specificity': 0.9049945, 'f1': 0.73552656, 'auroc': 0.95586246, 'binary_precision': 0.35154393, 'binary_recall': 0.8604651, 'binary_specificity': 0.9495239, 'binary_f1_score': 0.49915677}
confusion matrix:
       0    1
0  10271  546
1     48  296
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 4
val acc:0.9707455039024353, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 12,now: 2024-05-29 03:20:53.275204,epoch time: 0:19:19.841745,used: 3:55:21.388281,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96827435, 'precision': 0.7652325, 'recall': 0.87123823, 'specificity': 0.87123823, 'f1': 0.8082975, 'auroc': 0.9660163, 'binary_precision': 0.5392405, 'binary_recall': 0.76673865, 'binary_specificity': 0.97573787, 'binary_f1_score': 0.6331748}
confusion matrix:
       0     1
0  36597   910
1    324  1065
---- Validation: 
scalar performance:
{'acc': 0.9632967, 'precision': 0.73995316, 'recall': 0.84259707, 'specificity': 0.84259707, 'f1': 0.78101367, 'auroc': 0.94585156, 'binary_precision': 0.49074075, 'binary_recall': 0.71260506, 'binary_specificity': 0.9725891, 'binary_f1_score': 0.58122003}
confusion matrix:
       0    1
0  15612  440
1    171  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9575307, 'precision': 0.695194, 'recall': 0.8542507, 'specificity': 0.8542507, 'f1': 0.74852693, 'auroc': 0.95745075, 'binary_precision': 0.39875388, 'binary_recall': 0.74418604, 'binary_specificity': 0.9643154, 'binary_f1_score': 0.51926976}
confusion matrix:
       0    1
0  10431  386
1     88  256
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 5
val acc:0.9632967114448547, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 13,now: 2024-05-29 03:40:22.606421,epoch time: 0:19:29.331217,used: 4:14:50.719498,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9701512, 'precision': 0.77560765, 'recall': 0.8718648, 'specificity': 0.8718648, 'f1': 0.81571096, 'auroc': 0.96678555, 'binary_precision': 0.56, 'binary_recall': 0.76601875, 'binary_specificity': 0.97771084, 'binary_f1_score': 0.6470052}
confusion matrix:
       0     1
0  36671   836
1    325  1064
---- Validation: 
scalar performance:
{'acc': 0.96936387, 'precision': 0.77159464, 'recall': 0.8643544, 'specificity': 0.8643544, 'f1': 0.81037986, 'auroc': 0.95960736, 'binary_precision': 0.552534, 'binary_recall': 0.7512605, 'binary_specificity': 0.9774483, 'binary_f1_score': 0.6367521}
confusion matrix:
       0    1
0  15690  362
1    148  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91380703, 'precision': 0.60975707, 'recall': 0.83591545, 'specificity': 0.83591545, 'f1': 0.6519216, 'auroc': 0.9280093, 'binary_precision': 0.22799295, 'binary_recall': 0.752907, 'binary_specificity': 0.9189239, 'binary_f1_score': 0.35}
confusion matrix:
      0    1
0  9940  877
1    85  259
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 6
val acc:0.9693638682365417, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 14,now: 2024-05-29 03:59:41.359166,epoch time: 0:19:18.752745,used: 4:34:09.472243,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.79707205, 'recall': 0.8978226, 'specificity': 0.8978226, 'f1': 0.83929646, 'auroc': 0.9755371, 'binary_precision': 0.601061, 'binary_recall': 0.81569475, 'binary_specificity': 0.9799504, 'binary_f1_score': 0.6921198}
confusion matrix:
       0     1
0  36755   752
1    256  1133
---- Validation: 
scalar performance:
{'acc': 0.9692437, 'precision': 0.7703314, 'recall': 0.8804759, 'specificity': 0.8804759, 'f1': 0.8149217, 'auroc': 0.9610483, 'binary_precision': 0.54876614, 'binary_recall': 0.78487396, 'binary_specificity': 0.97607774, 'binary_f1_score': 0.64591974}
confusion matrix:
       0    1
0  15668  384
1    128  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621898, 'precision': 0.705362, 'recall': 0.79754925, 'specificity': 0.79754925, 'f1': 0.74193794, 'auroc': 0.94722426, 'binary_precision': 0.4229249, 'binary_recall': 0.622093, 'binary_specificity': 0.9730055, 'binary_f1_score': 0.50352937}
confusion matrix:
       0    1
0  10525  292
1    130  214
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 7
val acc:0.9692437052726746, best validation acc: 0.9721271395683289, corresponding to test acc:                         0.965594470500946 / 0.9694471955299377
after epoch: 15,now: 2024-05-29 04:19:07.400427,epoch time: 0:19:26.041261,used: 4:53:35.513504,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9761672, 'precision': 0.81413686, 'recall': 0.87914383, 'specificity': 0.87914383, 'f1': 0.8432604, 'auroc': 0.9754608, 'binary_precision': 0.6366864, 'binary_recall': 0.774658, 'binary_specificity': 0.9836297, 'binary_f1_score': 0.69892824}
confusion matrix:
       0     1
0  36893   614
1    313  1076
---- Validation: 
scalar performance:
{'acc': 0.97326845, 'precision': 0.7956457, 'recall': 0.8671883, 'specificity': 0.8671883, 'f1': 0.82711565, 'auroc': 0.9613523, 'binary_precision': 0.60053617, 'binary_recall': 0.7529412, 'binary_specificity': 0.98143536, 'binary_f1_score': 0.66815805}
confusion matrix:
       0    1
0  15754  298
1    147  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9562763, 'precision': 0.68524116, 'recall': 0.81842196, 'specificity': 0.81842196, 'f1': 0.7317411, 'auroc': 0.9522109, 'binary_precision': 0.38118812, 'binary_recall': 0.67151165, 'binary_specificity': 0.9653323, 'binary_f1_score': 0.4863158}
confusion matrix:
       0    1
0  10442  375
1    113  231
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
better model found
persisted
after epoch: 16,now: 2024-05-29 04:38:27.636624,epoch time: 0:19:20.236197,used: 5:12:55.749701,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96310675, 'precision': 0.7402303, 'recall': 0.86717224, 'specificity': 0.86717224, 'f1': 0.7886198, 'auroc': 0.96354413, 'binary_precision': 0.48939115, 'binary_recall': 0.7638589, 'binary_specificity': 0.9704855, 'binary_f1_score': 0.59657013}
confusion matrix:
       0     1
0  36400  1107
1    328  1061
---- Validation: 
scalar performance:
{'acc': 0.9602932, 'precision': 0.7274172, 'recall': 0.85155904, 'specificity': 0.85155904, 'f1': 0.77428406, 'auroc': 0.94814813, 'binary_precision': 0.4648936, 'binary_recall': 0.7344538, 'binary_specificity': 0.96866435, 'binary_f1_score': 0.5693811}
confusion matrix:
       0    1
0  15549  503
1    158  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95833707, 'precision': 0.6812357, 'recall': 0.75615823, 'specificity': 0.75615823, 'f1': 0.71140075, 'auroc': 0.93902826, 'binary_precision': 0.37728193, 'binary_recall': 0.5406977, 'binary_specificity': 0.9716188, 'binary_f1_score': 0.44444445}
confusion matrix:
       0    1
0  10510  307
1    158  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 1
val acc:0.960293173789978, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 17,now: 2024-05-29 04:57:57.438541,epoch time: 0:19:29.801917,used: 5:32:25.551618,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9757302, 'precision': 0.827369, 'recall': 0.8123623, 'specificity': 0.8123623, 'f1': 0.8196721, 'auroc': 0.9654026, 'binary_precision': 0.6681784, 'binary_recall': 0.6364291, 'binary_specificity': 0.9882955, 'binary_f1_score': 0.6519174}
confusion matrix:
       0    1
0  37068  439
1    505  884
---- Validation: 
scalar performance:
{'acc': 0.9718868, 'precision': 0.7977891, 'recall': 0.7871715, 'specificity': 0.7871715, 'f1': 0.7923738, 'auroc': 0.9452056, 'binary_precision': 0.61082023, 'binary_recall': 0.5882353, 'binary_specificity': 0.98610765, 'binary_f1_score': 0.5993151}
confusion matrix:
       0    1
0  15829  223
1    245  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95968103, 'precision': 0.67715067, 'recall': 0.7118191, 'specificity': 0.7118191, 'f1': 0.6927322, 'auroc': 0.94530874, 'binary_precision': 0.37198067, 'binary_recall': 0.44767442, 'binary_specificity': 0.9759638, 'binary_f1_score': 0.40633246}
confusion matrix:
       0    1
0  10557  260
1    190  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 2
val acc:0.9718868136405945, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 18,now: 2024-05-29 05:17:18.201876,epoch time: 0:19:20.763335,used: 5:51:46.314953,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97387904, 'precision': 0.7985705, 'recall': 0.8751843, 'specificity': 0.8751843, 'f1': 0.8320265, 'auroc': 0.9672469, 'binary_precision': 0.6057856, 'binary_recall': 0.7688985, 'binary_specificity': 0.9814701, 'binary_f1_score': 0.677665}
confusion matrix:
       0     1
0  36812   695
1    321  1068
---- Validation: 
scalar performance:
{'acc': 0.968643, 'precision': 0.76841164, 'recall': 0.8388958, 'specificity': 0.8388958, 'f1': 0.79906625, 'auroc': 0.94280046, 'binary_precision': 0.54808956, 'binary_recall': 0.6991597, 'binary_specificity': 0.978632, 'binary_f1_score': 0.6144756}
confusion matrix:
       0    1
0  15709  343
1    179  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589642, 'precision': 0.70143294, 'recall': 0.8634339, 'specificity': 0.8634339, 'f1': 0.7560714, 'auroc': 0.94744635, 'binary_precision': 0.4106583, 'binary_recall': 0.7616279, 'binary_specificity': 0.9652399, 'binary_f1_score': 0.53360486}
confusion matrix:
       0    1
0  10441  376
1     82  262
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 3
val acc:0.9686430096626282, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 19,now: 2024-05-29 05:36:43.226485,epoch time: 0:19:25.024609,used: 6:11:11.339562,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9675802, 'precision': 0.7614812, 'recall': 0.9069289, 'specificity': 0.9069289, 'f1': 0.81631434, 'auroc': 0.9740771, 'binary_precision': 0.5289593, 'binary_recall': 0.8416127, 'binary_specificity': 0.97224516, 'binary_f1_score': 0.6496249}
confusion matrix:
       0     1
0  36466  1041
1    220  1169
---- Validation: 
scalar performance:
{'acc': 0.96275604, 'precision': 0.73962736, 'recall': 0.88115776, 'specificity': 0.88115776, 'f1': 0.7920203, 'auroc': 0.9561536, 'binary_precision': 0.4871001, 'binary_recall': 0.7932773, 'binary_specificity': 0.9690381, 'binary_f1_score': 0.6035806}
confusion matrix:
       0    1
0  15555  497
1    123  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9450766, 'precision': 0.66817087, 'recall': 0.8956727, 'specificity': 0.8956727, 'f1': 0.72857857, 'auroc': 0.95383084, 'binary_precision': 0.34157833, 'binary_recall': 0.84302324, 'binary_specificity': 0.94832206, 'binary_f1_score': 0.48616934}
confusion matrix:
       0    1
0  10258  559
1     54  290
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 4
val acc:0.9627560377120972, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 20,now: 2024-05-29 05:56:06.505124,epoch time: 0:19:23.278639,used: 6:30:34.618201,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.975216, 'precision': 0.8212576, 'recall': 0.81590873, 'specificity': 0.81590873, 'f1': 0.8185584, 'auroc': 0.9628842, 'binary_precision': 0.6556777, 'binary_recall': 0.64434844, 'binary_specificity': 0.987469, 'binary_f1_score': 0.6499636}
confusion matrix:
       0    1
0  37037  470
1    494  895
---- Validation: 
scalar performance:
{'acc': 0.97206706, 'precision': 0.79776704, 'recall': 0.7953568, 'specificity': 0.7953568, 'f1': 0.7965565, 'auroc': 0.934457, 'binary_precision': 0.6101695, 'binary_recall': 0.60504204, 'binary_specificity': 0.9856716, 'binary_f1_score': 0.6075949}
confusion matrix:
       0    1
0  15822  230
1    235  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94794375, 'precision': 0.6448561, 'recall': 0.74938905, 'specificity': 0.74938905, 'f1': 0.6809389, 'auroc': 0.9294734, 'binary_precision': 0.3047776, 'binary_recall': 0.5377907, 'binary_specificity': 0.9609873, 'binary_f1_score': 0.38906416}
confusion matrix:
       0    1
0  10395  422
1    159  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 5
val acc:0.9720670580863953, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 21,now: 2024-05-29 06:15:30.515763,epoch time: 0:19:24.010639,used: 6:49:58.628840,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9683515, 'precision': 0.7651708, 'recall': 0.9024759, 'specificity': 0.9024759, 'f1': 0.8178896, 'auroc': 0.9702955, 'binary_precision': 0.53671, 'binary_recall': 0.8315335, 'binary_specificity': 0.9734183, 'binary_f1_score': 0.6523581}
confusion matrix:
       0     1
0  36510   997
1    234  1155
---- Validation: 
scalar performance:
{'acc': 0.9638373, 'precision': 0.7437476, 'recall': 0.8703898, 'specificity': 0.8703898, 'f1': 0.79224026, 'auroc': 0.9380343, 'binary_precision': 0.496208, 'binary_recall': 0.7697479, 'binary_specificity': 0.97103167, 'binary_f1_score': 0.60342556}
confusion matrix:
       0    1
0  15587  465
1    137  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9499149, 'precision': 0.6759558, 'recall': 0.8742453, 'specificity': 0.8742453, 'f1': 0.7338854, 'auroc': 0.9439156, 'binary_precision': 0.3587385, 'binary_recall': 0.7936047, 'binary_specificity': 0.95488584, 'binary_f1_score': 0.49411765}
confusion matrix:
       0    1
0  10329  488
1     71  273
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 6
val acc:0.9638373255729675, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 22,now: 2024-05-29 06:34:40.501412,epoch time: 0:19:09.985649,used: 7:09:08.614489,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9702797, 'precision': 0.77604914, 'recall': 0.87747765, 'specificity': 0.87747765, 'f1': 0.8179327, 'auroc': 0.9746519, 'binary_precision': 0.5604567, 'binary_recall': 0.7775378, 'binary_specificity': 0.9774175, 'binary_f1_score': 0.6513872}
confusion matrix:
       0     1
0  36660   847
1    309  1080
---- Validation: 
scalar performance:
{'acc': 0.96642035, 'precision': 0.7557272, 'recall': 0.8523087, 'specificity': 0.8523087, 'f1': 0.7953637, 'auroc': 0.9553788, 'binary_precision': 0.52163464, 'binary_recall': 0.7294118, 'binary_specificity': 0.9752056, 'binary_f1_score': 0.60826916}
confusion matrix:
       0    1
0  15654  398
1    161  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534092, 'precision': 0.6883915, 'recall': 0.8943424, 'specificity': 0.8943424, 'f1': 0.749658, 'auroc': 0.9553941, 'binary_precision': 0.38235295, 'binary_recall': 0.8313953, 'binary_specificity': 0.95728946, 'binary_f1_score': 0.52380955}
confusion matrix:
       0    1
0  10355  462
1     58  286
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 7
val acc:0.9664203524589539, best validation acc: 0.973268449306488, corresponding to test acc:                         0.9562762975692749 / 0.9694471955299377
after epoch: 23,now: 2024-05-29 06:54:01.825357,epoch time: 0:19:21.323945,used: 7:28:29.938434,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9769385, 'precision': 0.8267454, 'recall': 0.8518126, 'specificity': 0.8518126, 'f1': 0.83876824, 'auroc': 0.96842575, 'binary_precision': 0.664, 'binary_recall': 0.71706265, 'binary_specificity': 0.9865625, 'binary_f1_score': 0.68951195}
confusion matrix:
       0    1
0  37003  504
1    393  996
---- Validation: 
scalar performance:
{'acc': 0.97368896, 'precision': 0.80432165, 'recall': 0.83180207, 'specificity': 0.83180207, 'f1': 0.8174041, 'auroc': 0.93913406, 'binary_precision': 0.6205837, 'binary_recall': 0.6789916, 'binary_specificity': 0.9846125, 'binary_f1_score': 0.6484751}
confusion matrix:
       0    1
0  15805  247
1    191  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586059, 'precision': 0.6993853, 'recall': 0.85761994, 'specificity': 0.85761994, 'f1': 0.75298095, 'auroc': 0.95538086, 'binary_precision': 0.40694007, 'binary_recall': 0.75, 'binary_specificity': 0.9652399, 'binary_f1_score': 0.5276073}
confusion matrix:
       0    1
0  10441  376
1     86  258
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
better model found
persisted
after epoch: 24,now: 2024-05-29 07:13:30.890873,epoch time: 0:19:29.065516,used: 7:47:59.003950,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9696884, 'precision': 0.78673387, 'recall': 0.73608845, 'specificity': 0.73608845, 'f1': 0.7587025, 'auroc': 0.9304554, 'binary_precision': 0.5924296, 'binary_recall': 0.48452124, 'binary_specificity': 0.98765564, 'binary_f1_score': 0.5330693}
confusion matrix:
       0    1
0  37044  463
1    716  673
---- Validation: 
scalar performance:
{'acc': 0.9676218, 'precision': 0.7674049, 'recall': 0.73479027, 'specificity': 0.73479027, 'f1': 0.74992096, 'auroc': 0.9052248, 'binary_precision': 0.5538462, 'binary_recall': 0.4840336, 'binary_specificity': 0.98554695, 'binary_f1_score': 0.51659197}
confusion matrix:
       0    1
0  15820  232
1    307  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9401487, 'precision': 0.65265673, 'recall': 0.8649851, 'specificity': 0.8649851, 'f1': 0.7076911, 'auroc': 0.94691414, 'binary_precision': 0.3125, 'binary_recall': 0.78488374, 'binary_specificity': 0.9450864, 'binary_f1_score': 0.44701988}
confusion matrix:
       0    1
0  10223  594
1     74  270
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 1
val acc:0.9676218032836914, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 25,now: 2024-05-29 07:32:56.273383,epoch time: 0:19:25.382510,used: 8:07:24.386460,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9718737, 'precision': 0.78432363, 'recall': 0.89001894, 'specificity': 0.89001894, 'f1': 0.8278959, 'auroc': 0.97136223, 'binary_precision': 0.57608694, 'binary_recall': 0.8018732, 'binary_specificity': 0.9781647, 'binary_f1_score': 0.6704819}
confusion matrix:
       0     1
0  36689   819
1    275  1113
---- Validation: 
scalar performance:
{'acc': 0.9655193, 'precision': 0.7509593, 'recall': 0.8445588, 'specificity': 0.8445588, 'f1': 0.7894497, 'auroc': 0.9241024, 'binary_precision': 0.51266587, 'binary_recall': 0.71428573, 'binary_specificity': 0.9748318, 'binary_f1_score': 0.5969101}
confusion matrix:
       0    1
0  15648  404
1    170  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94435984, 'precision': 0.65634894, 'recall': 0.83901227, 'specificity': 0.83901227, 'f1': 0.7083696, 'auroc': 0.9448569, 'binary_precision': 0.3217503, 'binary_recall': 0.7267442, 'binary_specificity': 0.9512804, 'binary_f1_score': 0.44603035}
confusion matrix:
       0    1
0  10290  527
1     94  250
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 2
val acc:0.9655193090438843, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 26,now: 2024-05-29 07:52:18.307830,epoch time: 0:19:22.034447,used: 8:26:46.420907,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9739305, 'precision': 0.7985413, 'recall': 0.87798405, 'specificity': 0.87798405, 'f1': 0.8330672, 'auroc': 0.9705145, 'binary_precision': 0.6055149, 'binary_recall': 0.774658, 'binary_specificity': 0.9813101, 'binary_f1_score': 0.679722}
confusion matrix:
       0     1
0  36806   701
1    313  1076
---- Validation: 
scalar performance:
{'acc': 0.967802, 'precision': 0.7633711, 'recall': 0.8416965, 'specificity': 0.8416965, 'f1': 0.796836, 'auroc': 0.9297881, 'binary_precision': 0.53777206, 'binary_recall': 0.7058824, 'binary_specificity': 0.9775106, 'binary_f1_score': 0.61046505}
confusion matrix:
       0    1
0  15691  361
1    175  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379984, 'precision': 0.65607375, 'recall': 0.90609366, 'specificity': 0.90609366, 'f1': 0.71574545, 'auroc': 0.9499811, 'binary_precision': 0.3164557, 'binary_recall': 0.872093, 'binary_specificity': 0.9400943, 'binary_f1_score': 0.4643963}
confusion matrix:
       0    1
0  10169  648
1     44  300
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 3
val acc:0.9678019881248474, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 27,now: 2024-05-29 08:11:35.574863,epoch time: 0:19:17.267033,used: 8:46:03.687940,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9713338, 'precision': 0.7824283, 'recall': 0.8742112, 'specificity': 0.8742112, 'f1': 0.8211404, 'auroc': 0.96519387, 'binary_precision': 0.57349783, 'binary_recall': 0.76961845, 'binary_specificity': 0.97880393, 'binary_f1_score': 0.65723944}
confusion matrix:
       0     1
0  36712   795
1    320  1069
---- Validation: 
scalar performance:
{'acc': 0.9676218, 'precision': 0.76238644, 'recall': 0.83917546, 'specificity': 0.83917546, 'f1': 0.79527175, 'auroc': 0.9278463, 'binary_precision': 0.5359897, 'binary_recall': 0.70084035, 'binary_specificity': 0.9775106, 'binary_f1_score': 0.607429}
confusion matrix:
       0    1
0  15691  361
1    178  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95600754, 'precision': 0.693977, 'recall': 0.880203, 'specificity': 0.880203, 'f1': 0.752633, 'auroc': 0.95934564, 'binary_precision': 0.39454806, 'binary_recall': 0.7994186, 'binary_specificity': 0.9609873, 'binary_f1_score': 0.52833813}
confusion matrix:
       0    1
0  10395  422
1     69  275
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 4
val acc:0.9676218032836914, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 28,now: 2024-05-29 08:31:13.676468,epoch time: 0:19:38.101605,used: 9:05:41.789545,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97706705, 'precision': 0.8392553, 'recall': 0.8175618, 'specificity': 0.8175618, 'f1': 0.82801557, 'auroc': 0.9641153, 'binary_precision': 0.691596, 'binary_recall': 0.6457883, 'binary_specificity': 0.9893353, 'binary_f1_score': 0.6679077}
confusion matrix:
       0    1
0  37107  400
1    492  897
---- Validation: 
scalar performance:
{'acc': 0.97182673, 'precision': 0.7949841, 'recall': 0.79927814, 'specificity': 0.79927814, 'f1': 0.7971139, 'auroc': 0.9356664, 'binary_precision': 0.6043046, 'binary_recall': 0.6134454, 'binary_specificity': 0.9851109, 'binary_f1_score': 0.6088407}
confusion matrix:
       0    1
0  15813  239
1    230  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95394677, 'precision': 0.67389923, 'recall': 0.79892576, 'specificity': 0.79892576, 'f1': 0.7174486, 'auroc': 0.93837947, 'binary_precision': 0.35973597, 'binary_recall': 0.63372093, 'binary_specificity': 0.9641305, 'binary_f1_score': 0.45894736}
confusion matrix:
       0    1
0  10429  388
1    126  218
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 5
val acc:0.9718267321586609, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 29,now: 2024-05-29 08:50:32.299833,epoch time: 0:19:18.623365,used: 9:25:00.412910,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96976554, 'precision': 0.77241635, 'recall': 0.89696956, 'specificity': 0.89696956, 'f1': 0.82165587, 'auroc': 0.9686737, 'binary_precision': 0.55167395, 'binary_recall': 0.8185745, 'binary_specificity': 0.9753646, 'binary_f1_score': 0.6591304}
confusion matrix:
       0     1
0  36583   924
1    252  1137
---- Validation: 
scalar performance:
{'acc': 0.964438, 'precision': 0.74579537, 'recall': 0.85209, 'specificity': 0.85209, 'f1': 0.78823876, 'auroc': 0.9358674, 'binary_precision': 0.5017301, 'binary_recall': 0.73109245, 'binary_specificity': 0.9730875, 'binary_f1_score': 0.5950752}
confusion matrix:
       0    1
0  15620  432
1    160  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95994985, 'precision': 0.7020852, 'recall': 0.84142613, 'specificity': 0.84142613, 'f1': 0.7515286, 'auroc': 0.94733393, 'binary_precision': 0.41344538, 'binary_recall': 0.71511626, 'binary_specificity': 0.96773595, 'binary_f1_score': 0.52396166}
confusion matrix:
       0    1
0  10468  349
1     98  246
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center3_20897896.png
early stop counter: 6
val acc:0.9644380211830139, best validation acc: 0.9736889600753784, corresponding to test acc:                         0.9586058855056763 / 0.9694471955299377
after epoch: 30,now: 2024-05-29 09:09:56.449510,epoch time: 0:19:24.149677,used: 9:44:24.562587,model: dset_te_center3_erm_b44271c83_not_commited_2024md_05md_28_23_25_31_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:44:24.562587 at 2024-05-29 09:09:56.449510
persisted model performance metric: 

scalar performance:
{'acc': 0.95878506, 'precision': 0.70116556, 'recall': 0.866156, 'specificity': 0.866156, 'f1': 0.75642556, 'auroc': 0.9587368, 'binary_precision': 0.4099379, 'binary_recall': 0.76744187, 'binary_specificity': 0.9648701, 'binary_f1_score': 0.534413}
confusion matrix:
       0    1
0  10437  380
1     80  264
oracle model performance metric: 

scalar performance:
{'acc': 0.97052234, 'precision': 0.76946527, 'recall': 0.59357285, 'specificity': 0.59357285, 'f1': 0.63564223, 'auroc': 0.9387869, 'binary_precision': 0.5641026, 'binary_recall': 0.19186047, 'binary_specificity': 0.9952852, 'binary_f1_score': 0.28633407}
confusion matrix:
       0   1
0  10766  51
1    278  66
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-4/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496817 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496817 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |  90737 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476803 KiB |  10962 MiB |   5819 TiB |   5819 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   5810 TiB |   5810 TiB |
|       from small pool |  88963 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11400 MiB |  11400 MiB |  39626 MiB |  28226 MiB |
|       from large pool |  11274 MiB |  11274 MiB |  39418 MiB |  28144 MiB |
|       from small pool |    126 MiB |    126 MiB |    208 MiB |     82 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1348 MiB |   2595 MiB |   1883 TiB |   1883 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1872 TiB |   1872 TiB |
|       from small pool |      9 MiB |     33 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5565    |    7764    |  482425 K  |  482419 K  |
|       from large pool |      87    |     909    |  227290 K  |  227290 K  |
|       from small pool |    5478    |    7642    |  255134 K  |  255128 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5565    |    7764    |  482425 K  |  482419 K  |
|       from large pool |      87    |     909    |  227290 K  |  227290 K  |
|       from small pool |    5478    |    7642    |  255134 K  |  255128 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     239    |     239    |     694    |     455    |
|       from large pool |     176    |     176    |     590    |     414    |
|       from small pool |      63    |      63    |     104    |      41    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2768    |  257233 K  |  257233 K  |
|       from large pool |      23    |      65    |  121621 K  |  121621 K  |
|       from small pool |      51    |    2747    |  135611 K  |  135611 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5819 TiB |   5819 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5810 TiB |   5810 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1834 MiB |  11400 MiB |  39626 MiB |  37792 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     98 MiB |    126 MiB |    208 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1883 TiB |   1883 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1872 TiB |   1872 TiB |
|       from small pool |      0 KiB |     33 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  482425 K  |  482425 K  |
|       from large pool |       2    |     909    |  227290 K  |  227290 K  |
|       from small pool |       0    |    7642    |  255134 K  |  255134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  482425 K  |  482425 K  |
|       from large pool |       2    |     909    |  227290 K  |  227290 K  |
|       from small pool |       0    |    7642    |  255134 K  |  255134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     239    |     694    |     611    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      49    |      63    |     104    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  257235 K  |  257235 K  |
|       from large pool |       4    |      65    |  121621 K  |  121621 K  |
|       from small pool |       0    |    2747    |  135614 K  |  135614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5844 TiB |   5844 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5835 TiB |   5835 TiB |
|       from small pool |      0 KiB |    125 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10962 MiB |   5819 TiB |   5819 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5810 TiB |   5810 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1834 MiB |  11400 MiB |  39626 MiB |  37792 MiB |
|       from large pool |   1736 MiB |  11274 MiB |  39418 MiB |  37682 MiB |
|       from small pool |     98 MiB |    126 MiB |    208 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1883 TiB |   1883 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1872 TiB |   1872 TiB |
|       from small pool |      0 KiB |     33 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7764    |  482425 K  |  482425 K  |
|       from large pool |       2    |     909    |  227290 K  |  227290 K  |
|       from small pool |       0    |    7642    |  255134 K  |  255134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7764    |  482425 K  |  482425 K  |
|       from large pool |       2    |     909    |  227290 K  |  227290 K  |
|       from small pool |       0    |    7642    |  255134 K  |  255134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     239    |     694    |     611    |
|       from large pool |      34    |     176    |     590    |     556    |
|       from small pool |      49    |      63    |     104    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |  257235 K  |  257235 K  |
|       from large pool |       4    |      65    |  121621 K  |  121621 K  |
|       from small pool |       0    |    2747    |  135614 K  |  135614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_09_20_42_seed_0_20897896

 Experiment start at: 2024-05-29 09:20:43.034404
before training, model accuracy: 0.5330235362052917
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97964245, 'precision': 0.80013037, 'recall': 0.7020397, 'specificity': 0.7020397, 'f1': 0.7409027, 'auroc': 0.93423724, 'binary_precision': 0.6146646, 'binary_recall': 0.41041666, 'binary_specificity': 0.9936628, 'binary_f1_score': 0.49219242}
confusion matrix:
       0    1
0  38729  247
1    566  394
---- Validation: 
scalar performance:
{'acc': 0.97853726, 'precision': 0.7710817, 'recall': 0.7939633, 'specificity': 0.7939633, 'f1': 0.78202415, 'auroc': 0.93954533, 'binary_precision': 0.55210644, 'binary_recall': 0.6, 'binary_specificity': 0.9879266, 'binary_f1_score': 0.5750577}
confusion matrix:
       0    1
0  16529  202
1    166  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233735, 'precision': 0.69872546, 'recall': 0.5146931, 'specificity': 0.5146931, 'f1': 0.51033187, 'auroc': 0.7086608, 'binary_precision': 0.4716981, 'binary_recall': 0.03238342, 'binary_specificity': 0.9970028, 'binary_f1_score': 0.06060606}
confusion matrix:
      0   1
0  9314  28
1   747  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897896.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 09:42:18.559046,epoch time: 0:21:35.524642,used: 0:21:35.524642,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_09_20_42_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9815956, 'precision': 0.831563, 'recall': 0.7226306, 'specificity': 0.7226306, 'f1': 0.7657607, 'auroc': 0.95265526, 'binary_precision': 0.6765625, 'binary_recall': 0.4505723, 'binary_specificity': 0.9946889, 'binary_f1_score': 0.5409119}
confusion matrix:
       0    1
0  38768  207
1    528  433
---- Validation: 
scalar performance:
{'acc': 0.97987866, 'precision': 0.7991082, 'recall': 0.7276794, 'specificity': 0.7276794, 'f1': 0.758235, 'auroc': 0.9410168, 'binary_precision': 0.611465, 'binary_recall': 0.4626506, 'binary_specificity': 0.99270815, 'binary_f1_score': 0.526749}
confusion matrix:
       0    1
0  16609  122
1    223  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91803443, 'precision': 0.6782095, 'recall': 0.58607125, 'specificity': 0.58607125, 'f1': 0.61115825, 'auroc': 0.8475126, 'binary_precision': 0.42016807, 'binary_recall': 0.19430052, 'binary_specificity': 0.97784203, 'binary_f1_score': 0.2657219}
confusion matrix:
      0    1
0  9135  207
1   622  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897896.png
better model found
persisted
after epoch: 2,now: 2024-05-29 10:02:48.755673,epoch time: 0:20:30.196627,used: 0:42:05.721269,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_09_20_42_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98154545, 'precision': 0.8284869, 'recall': 0.72666466, 'specificity': 0.72666466, 'f1': 0.7676813, 'auroc': 0.96055365, 'binary_precision': 0.67021275, 'binary_recall': 0.458897, 'binary_specificity': 0.99443233, 'binary_f1_score': 0.54478073}
confusion matrix:
       0    1
0  38758  217
1    520  441
---- Validation: 
scalar performance:
{'acc': 0.9814534, 'precision': 0.8284452, 'recall': 0.7273113, 'specificity': 0.7273113, 'f1': 0.76812387, 'auroc': 0.9541074, 'binary_precision': 0.67017543, 'binary_recall': 0.46024096, 'binary_specificity': 0.99438167, 'binary_f1_score': 0.54571426}
confusion matrix:
       0    1
0  16637   94
1    224  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9222859, 'precision': 0.6657505, 'recall': 0.5170751, 'specificity': 0.5170751, 'f1': 0.51518446, 'auroc': 0.8030317, 'binary_precision': 0.4054054, 'binary_recall': 0.038860105, 'binary_specificity': 0.9952901, 'binary_f1_score': 0.07092199}
confusion matrix:
      0   1
0  9298  44
1   742  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20897896.png
better model found
persisted
after epoch: 3,now: 2024-05-29 10:22:56.691797,epoch time: 0:20:07.936124,used: 1:02:13.657393,model: dset_te_center4_erm_b44271c83_not_commited_2024md_05md_29_09_20_42_seed_0_20897896
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
slurmstepd: error: *** JOB 20897896 ON gpusrv39 CANCELLED AT 2024-05-29T10:35:51 ***
