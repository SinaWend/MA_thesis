Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183

 Experiment start at: 2024-06-07 01:23:44.583366
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96960634, 'precision': 0.7680191, 'recall': 0.7406752, 'specificity': 0.7406752, 'f1': 0.7535357, 'auroc': 0.9503344, 'binary_precision': 0.55353075, 'binary_recall': 0.49524456, 'binary_specificity': 0.98610586, 'binary_f1_score': 0.522768}
confusion matrix:
       0    1
0  41732  588
1    743  729
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.75382876, 'recall': 0.7416218, 'specificity': 0.7416218, 'f1': 0.74755806, 'auroc': 0.9464853, 'binary_precision': 0.5253683, 'binary_recall': 0.4992224, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.5119617}
confusion matrix:
       0    1
0  17859  290
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.89972806, 'recall': 0.70497894, 'specificity': 0.70497894, 'f1': 0.7682519, 'auroc': 0.9376545, 'binary_precision': 0.8244275, 'binary_recall': 0.41379312, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.55102044}
confusion matrix:
      0    1
0  5974   23
1   153  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:41:53.640954,epoch time: 0:18:09.057588,used: 0:18:09.057588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9745844, 'precision': 0.8475473, 'recall': 0.6996455, 'specificity': 0.6996455, 'f1': 0.75204265, 'auroc': 0.96341246, 'binary_precision': 0.71548617, 'binary_recall': 0.4048913, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.51713663}
confusion matrix:
       0    1
0  42083  237
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.8534873, 'recall': 0.67189693, 'specificity': 0.67189693, 'f1': 0.7289379, 'auroc': 0.9597359, 'binary_precision': 0.7296417, 'binary_recall': 0.34836704, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.471579}
confusion matrix:
       0    1
0  18066   83
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.95019877, 'recall': 0.5573045, 'specificity': 0.5573045, 'f1': 0.5928579, 'auroc': 0.9452175, 'binary_precision': 0.9375, 'binary_recall': 0.11494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.20477815}
confusion matrix:
      0   1
0  5995   2
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 01:59:01.171253,epoch time: 0:17:07.530299,used: 0:35:16.587887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9753608, 'precision': 0.80497146, 'recall': 0.8354531, 'specificity': 0.8354531, 'f1': 0.81941354, 'auroc': 0.97203755, 'binary_precision': 0.6209231, 'binary_recall': 0.68546194, 'binary_specificity': 0.98544425, 'binary_f1_score': 0.65159833}
confusion matrix:
       0     1
0  41704   616
1    463  1009
---- Validation: 
scalar performance:
{'acc': 0.9754683, 'precision': 0.8212552, 'recall': 0.7907851, 'specificity': 0.7907851, 'f1': 0.8051898, 'auroc': 0.9656352, 'binary_precision': 0.65689653, 'binary_recall': 0.592535, 'binary_specificity': 0.9890352, 'binary_f1_score': 0.623058}
confusion matrix:
       0    1
0  17950  199
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.88312614, 'recall': 0.598533, 'specificity': 0.598533, 'f1': 0.6504034, 'auroc': 0.9535524, 'binary_precision': 0.8, 'binary_recall': 0.19923371, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.31901842}
confusion matrix:
      0   1
0  5984  13
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 02:16:10.871897,epoch time: 0:17:09.700644,used: 0:52:26.288531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9804302, 'precision': 0.878364, 'recall': 0.79400504, 'specificity': 0.79400504, 'f1': 0.83046615, 'auroc': 0.97780806, 'binary_precision': 0.7707231, 'binary_recall': 0.59415364, 'binary_specificity': 0.9938565, 'binary_f1_score': 0.6710173}
confusion matrix:
       0    1
0  42061  260
1    597  874
---- Validation: 
scalar performance:
{'acc': 0.9759472, 'precision': 0.8702311, 'recall': 0.71452737, 'specificity': 0.71452737, 'f1': 0.77005833, 'auroc': 0.97144055, 'binary_precision': 0.76021796, 'binary_recall': 0.43390357, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.5524752}
confusion matrix:
       0    1
0  18061   88
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.87536275, 'recall': 0.5832907, 'specificity': 0.5832907, 'f1': 0.6294153, 'auroc': 0.9499947, 'binary_precision': 0.78571427, 'binary_recall': 0.16858238, 'binary_specificity': 0.997999, 'binary_f1_score': 0.27760252}
confusion matrix:
      0   1
0  5985  12
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 02:33:17.346514,epoch time: 0:17:06.474617,used: 1:09:32.763148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.88769174, 'recall': 0.8173115, 'specificity': 0.8173115, 'f1': 0.84870535, 'auroc': 0.9808564, 'binary_precision': 0.7878028, 'binary_recall': 0.640625, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.70663166}
confusion matrix:
       0    1
0  42066  254
1    529  943
---- Validation: 
scalar performance:
{'acc': 0.9808429, 'precision': 0.88598824, 'recall': 0.79956806, 'specificity': 0.79956806, 'f1': 0.8368889, 'auroc': 0.9747172, 'binary_precision': 0.7858586, 'binary_recall': 0.60497665, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.6836555}
confusion matrix:
       0    1
0  18043  106
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.94178957, 'recall': 0.5858734, 'specificity': 0.5858734, 'f1': 0.63614935, 'auroc': 0.9483351, 'binary_precision': 0.9183673, 'binary_recall': 0.1724138, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2903226}
confusion matrix:
      0   1
0  5993   4
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 02:50:24.675477,epoch time: 0:17:07.328963,used: 1:26:40.092111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98362714, 'precision': 0.9090042, 'recall': 0.82005847, 'specificity': 0.82005847, 'f1': 0.85868716, 'auroc': 0.9840206, 'binary_precision': 0.83027124, 'binary_recall': 0.64470106, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.7258127}
confusion matrix:
       0    1
0  42126  194
1    523  949
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.9190311, 'recall': 0.7828678, 'specificity': 0.7828678, 'f1': 0.8367619, 'auroc': 0.9766263, 'binary_precision': 0.85314685, 'binary_recall': 0.56920683, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.68283576}
confusion matrix:
       0    1
0  18086   63
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8873775, 'recall': 0.5493082, 'specificity': 0.5493082, 'f1': 0.57887876, 'auroc': 0.9444119, 'binary_precision': 0.8125, 'binary_recall': 0.099616855, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1774744}
confusion matrix:
      0   1
0  5991   6
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 03:07:30.175000,epoch time: 0:17:05.499523,used: 1:43:45.591634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98266804, 'precision': 0.8626766, 'recall': 0.8748071, 'specificity': 0.8748071, 'f1': 0.86863315, 'auroc': 0.9850866, 'binary_precision': 0.7337278, 'binary_recall': 0.75918365, 'binary_specificity': 0.99043053, 'binary_f1_score': 0.74623865}
confusion matrix:
       0     1
0  41917   405
1    354  1116
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.866572, 'recall': 0.86712193, 'specificity': 0.86712193, 'f1': 0.86684674, 'auroc': 0.97687227, 'binary_precision': 0.742236, 'binary_recall': 0.7433904, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.7428127}
confusion matrix:
       0    1
0  17983  166
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9091885, 'recall': 0.63876283, 'specificity': 0.63876283, 'f1': 0.7021159, 'auroc': 0.95040286, 'binary_precision': 0.8488372, 'binary_recall': 0.27969348, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.42074925}
confusion matrix:
      0   1
0  5984  13
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 03:24:38.448790,epoch time: 0:17:08.273790,used: 2:00:53.865424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9828279, 'precision': 0.8840411, 'recall': 0.83800507, 'specificity': 0.83800507, 'f1': 0.8594339, 'auroc': 0.9841516, 'binary_precision': 0.7790698, 'binary_recall': 0.68274456, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.7277335}
confusion matrix:
       0     1
0  42035   285
1    467  1005
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.8818426, 'recall': 0.8201777, 'specificity': 0.8201777, 'f1': 0.8480755, 'auroc': 0.9786725, 'binary_precision': 0.7761194, 'binary_recall': 0.64696735, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.70568275}
confusion matrix:
       0    1
0  18029  120
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8183079, 'recall': 0.56938046, 'specificity': 0.56938046, 'f1': 0.6071706, 'auroc': 0.95547074, 'binary_precision': 0.6727273, 'binary_recall': 0.14176245, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.23417722}
confusion matrix:
      0   1
0  5979  18
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_8.png
early stop counter: 1
val acc:0.9815347194671631, best validation acc: 0.9823861122131348, corresponding to test acc:                         0.9678810834884644 / 0.9718760251998901
after epoch: 8,now: 2024-06-07 03:41:48.679520,epoch time: 0:17:10.230730,used: 2:18:04.096154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.985591, 'precision': 0.9071251, 'recall': 0.86074555, 'specificity': 0.86074555, 'f1': 0.8824223, 'auroc': 0.98822355, 'binary_precision': 0.82371056, 'binary_recall': 0.7269022, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.77228445}
confusion matrix:
       0     1
0  42091   229
1    402  1070
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.8964941, 'recall': 0.82764447, 'specificity': 0.82764447, 'f1': 0.8585299, 'auroc': 0.9792894, 'binary_precision': 0.80492425, 'binary_recall': 0.66096425, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.7258754}
confusion matrix:
       0    1
0  18046  103
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9086533, 'recall': 0.56654954, 'specificity': 0.56654954, 'f1': 0.60639673, 'auroc': 0.94749343, 'binary_precision': 0.85365856, 'binary_recall': 0.13409962, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.23178808}
confusion matrix:
      0   1
0  5991   6
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 03:58:58.870639,epoch time: 0:17:10.191119,used: 2:35:14.287273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.983787, 'precision': 0.9474877, 'recall': 0.78622717, 'specificity': 0.78622717, 'f1': 0.8479159, 'auroc': 0.9887349, 'binary_precision': 0.9095802, 'binary_recall': 0.57443917, 'binary_specificity': 0.99801517, 'binary_f1_score': 0.7041667}
confusion matrix:
       0    1
0  42237   84
1    626  845
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.9257704, 'recall': 0.7420955, 'specificity': 0.7420955, 'f1': 0.8069109, 'auroc': 0.9791836, 'binary_precision': 0.86944443, 'binary_recall': 0.4867807, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.6241276}
confusion matrix:
       0    1
0  18102   47
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8237244, 'recall': 0.52065593, 'specificity': 0.52065593, 'f1': 0.52929366, 'auroc': 0.9146253, 'binary_precision': 0.6875, 'binary_recall': 0.042145595, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07942238}
confusion matrix:
      0   1
0  5992   5
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_10.png
early stop counter: 1
val acc:0.979938268661499, best validation acc: 0.9829182624816895, corresponding to test acc:                         0.9629274606704712 / 0.9718760251998901
after epoch: 10,now: 2024-06-07 04:16:15.486452,epoch time: 0:17:16.615813,used: 2:52:30.903086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.8790065, 'recall': 0.919629, 'specificity': 0.919629, 'f1': 0.8981925, 'auroc': 0.9896319, 'binary_precision': 0.76330274, 'binary_recall': 0.84840244, 'binary_specificity': 0.9908556, 'binary_f1_score': 0.8036059}
confusion matrix:
       0     1
0  41934   387
1    223  1248
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.88054335, 'recall': 0.8908082, 'specificity': 0.8908082, 'f1': 0.8856014, 'auroc': 0.98069024, 'binary_precision': 0.7685325, 'binary_recall': 0.79004663, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.77914107}
confusion matrix:
       0    1
0  17996  153
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.91093576, 'recall': 0.5798762, 'specificity': 0.5798762, 'f1': 0.6262262, 'auroc': 0.928046, 'binary_precision': 0.85714287, 'binary_recall': 0.16091955, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.27096778}
confusion matrix:
      0   1
0  5990   7
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 04:34:15.770377,epoch time: 0:18:00.283925,used: 3:10:31.187011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98515713, 'precision': 0.8662058, 'recall': 0.9287157, 'specificity': 0.9287157, 'f1': 0.89477587, 'auroc': 0.9904443, 'binary_precision': 0.73702425, 'binary_recall': 0.8682065, 'binary_specificity': 0.989225, 'binary_f1_score': 0.7972551}
confusion matrix:
       0     1
0  41864   456
1    194  1278
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.8822049, 'recall': 0.90394485, 'specificity': 0.90394485, 'f1': 0.8927474, 'auroc': 0.98248494, 'binary_precision': 0.7709251, 'binary_recall': 0.8164852, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.79305136}
confusion matrix:
       0    1
0  17993  156
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.87440306, 'recall': 0.58895445, 'specificity': 0.58895445, 'f1': 0.63711035, 'auroc': 0.9399943, 'binary_precision': 0.78333336, 'binary_recall': 0.18007663, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29283488}
confusion matrix:
      0   1
0  5984  13
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 04:51:52.048668,epoch time: 0:17:36.278291,used: 3:28:07.465302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9868469, 'precision': 0.9594902, 'recall': 0.8279537, 'specificity': 0.8279537, 'f1': 0.8819649, 'auroc': 0.99160004, 'binary_precision': 0.9307692, 'binary_recall': 0.6576087, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.77070063}
confusion matrix:
       0    1
0  42248   72
1    504  968
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.9462801, 'recall': 0.7820289, 'specificity': 0.7820289, 'f1': 0.84433496, 'auroc': 0.9791246, 'binary_precision': 0.9077307, 'binary_recall': 0.5660964, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.697318}
confusion matrix:
       0    1
0  18112   37
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.8914746, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_13.png
early stop counter: 1
val acc:0.9831843376159668, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9637264013290405 / 0.9718760251998901
after epoch: 13,now: 2024-06-07 05:09:22.789584,epoch time: 0:17:30.740916,used: 3:45:38.206218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.9213911, 'recall': 0.90671706, 'specificity': 0.90671706, 'f1': 0.9139136, 'auroc': 0.9929326, 'binary_precision': 0.84908324, 'binary_recall': 0.8184908, 'binary_specificity': 0.9949434, 'binary_f1_score': 0.83350646}
confusion matrix:
       0     1
0  42107   214
1    267  1204
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9128352, 'recall': 0.8636898, 'specificity': 0.8636898, 'f1': 0.88658124, 'auroc': 0.9802829, 'binary_precision': 0.8351064, 'binary_recall': 0.7325039, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.78044736}
confusion matrix:
       0    1
0  18056   93
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.9444878, 'recall': 0.5706311, 'specificity': 0.5706311, 'f1': 0.6136317, 'auroc': 0.93171823, 'binary_precision': 0.925, 'binary_recall': 0.14176245, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.24584717}
confusion matrix:
      0   1
0  5994   3
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 05:27:07.259742,epoch time: 0:17:44.470158,used: 4:03:22.676376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98906195, 'precision': 0.9560306, 'recall': 0.8677871, 'specificity': 0.8677871, 'f1': 0.90683687, 'auroc': 0.9936584, 'binary_precision': 0.9211196, 'binary_recall': 0.73777175, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.81931347}
confusion matrix:
       0     1
0  42227    93
1    386  1086
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.93087256, 'recall': 0.81333214, 'specificity': 0.81333214, 'f1': 0.86212724, 'auroc': 0.9801942, 'binary_precision': 0.87473005, 'binary_recall': 0.62986004, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.73236895}
confusion matrix:
       0    1
0  18091   58
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9383205, 'recall': 0.5209894, 'specificity': 0.5209894, 'f1': 0.5300423, 'auroc': 0.9299291, 'binary_precision': 0.9166667, 'binary_recall': 0.042145595, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08058608}
confusion matrix:
      0   1
0  5996   1
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_15.png
early stop counter: 1
val acc:0.9842486381530762, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9637264013290405 / 0.9718760251998901
after epoch: 15,now: 2024-06-07 05:44:18.691313,epoch time: 0:17:11.431571,used: 4:20:34.107947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.94598943, 'recall': 0.9001294, 'specificity': 0.9001294, 'f1': 0.9217216, 'auroc': 0.994781, 'binary_precision': 0.8987824, 'binary_recall': 0.80340135, 'binary_specificity': 0.9968574, 'binary_f1_score': 0.84841955}
confusion matrix:
       0     1
0  42189   133
1    289  1181
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.93299663, 'recall': 0.84199333, 'specificity': 0.84199333, 'f1': 0.88174415, 'auroc': 0.9814899, 'binary_precision': 0.8769841, 'binary_recall': 0.6874028, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7707062}
confusion matrix:
       0    1
0  18087   62
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9120728, 'recall': 0.5589701, 'specificity': 0.5589701, 'f1': 0.59476095, 'auroc': 0.9248189, 'binary_precision': 0.8611111, 'binary_recall': 0.118773945, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.20875421}
confusion matrix:
      0   1
0  5992   5
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_16.png
better model found
persisted
after epoch: 16,now: 2024-06-07 06:01:39.101995,epoch time: 0:17:20.410682,used: 4:37:54.518629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99029505, 'precision': 0.9386234, 'recall': 0.90776825, 'specificity': 0.90776825, 'f1': 0.9225895, 'auroc': 0.99476814, 'binary_precision': 0.8835165, 'binary_recall': 0.8192935, 'binary_specificity': 0.99624294, 'binary_f1_score': 0.85019386}
confusion matrix:
       0     1
0  42161   159
1    266  1206
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.92693985, 'recall': 0.8618804, 'specificity': 0.8618804, 'f1': 0.8915163, 'auroc': 0.9804349, 'binary_precision': 0.86346865, 'binary_recall': 0.7278383, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7898734}
confusion matrix:
       0    1
0  18075   74
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.92486906, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 06:18:45.737157,epoch time: 0:17:06.635162,used: 4:55:01.153791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9908888, 'precision': 0.95101917, 'recall': 0.90381324, 'specificity': 0.90381324, 'f1': 0.9260136, 'auroc': 0.99587655, 'binary_precision': 0.90860623, 'binary_recall': 0.81046194, 'binary_specificity': 0.9971645, 'binary_f1_score': 0.8567325}
confusion matrix:
       0     1
0  42200   120
1    279  1193
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9324461, 'recall': 0.8612957, 'specificity': 0.8612957, 'f1': 0.89343417, 'auroc': 0.98223555, 'binary_precision': 0.8745318, 'binary_recall': 0.7262831, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7935429}
confusion matrix:
       0    1
0  18082   67
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.90783304, 'recall': 0.5551387, 'specificity': 0.5551387, 'f1': 0.5886086, 'auroc': 0.9159435, 'binary_precision': 0.85294116, 'binary_recall': 0.11111111, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19661018}
confusion matrix:
      0   1
0  5992   5
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 06:35:57.177462,epoch time: 0:17:11.440305,used: 5:12:12.594096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99084306, 'precision': 0.9305929, 'recall': 0.9280511, 'specificity': 0.9280511, 'f1': 0.92931795, 'auroc': 0.9958993, 'binary_precision': 0.8660287, 'binary_recall': 0.8607337, 'binary_specificity': 0.9953686, 'binary_f1_score': 0.8633731}
confusion matrix:
       0     1
0  42124   196
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9116512, 'recall': 0.89371336, 'specificity': 0.89371336, 'f1': 0.9024659, 'auroc': 0.9812961, 'binary_precision': 0.8306189, 'binary_recall': 0.7931571, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.81145585}
confusion matrix:
       0    1
0  18045  104
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.86604327, 'recall': 0.5567209, 'specificity': 0.5567209, 'f1': 0.5901768, 'auroc': 0.9145612, 'binary_precision': 0.7692308, 'binary_recall': 0.11494253, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5988   9
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_19.png
better model found
persisted
after epoch: 19,now: 2024-06-07 06:53:19.126403,epoch time: 0:17:21.948941,used: 5:29:34.543037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.9414617, 'recall': 0.9179512, 'specificity': 0.9179512, 'f1': 0.9293598, 'auroc': 0.996477, 'binary_precision': 0.8884892, 'binary_recall': 0.8395649, 'binary_specificity': 0.99633753, 'binary_f1_score': 0.86333454}
confusion matrix:
       0     1
0  42166   155
1    236  1235
---- Validation: 
scalar performance:
{'acc': 0.98845255, 'precision': 0.9387133, 'recall': 0.8785132, 'specificity': 0.8785132, 'f1': 0.90622336, 'auroc': 0.98256147, 'binary_precision': 0.88586956, 'binary_recall': 0.7604977, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.81841004}
confusion matrix:
       0    1
0  18086   63
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.89289963, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_20.png
better model found
persisted
after epoch: 20,now: 2024-06-07 07:10:34.346404,epoch time: 0:17:15.220001,used: 5:46:49.763038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99198484, 'precision': 0.95057595, 'recall': 0.923017, 'specificity': 0.923017, 'f1': 0.9363283, 'auroc': 0.99702233, 'binary_precision': 0.9063861, 'binary_recall': 0.84908223, 'binary_specificity': 0.9969519, 'binary_f1_score': 0.87679887}
confusion matrix:
       0     1
0  42192   129
1    222  1249
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.9291855, 'recall': 0.8735445, 'specificity': 0.8735445, 'f1': 0.8992843, 'auroc': 0.982382, 'binary_precision': 0.8671454, 'binary_recall': 0.7511664, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.805}
confusion matrix:
       0    1
0  18075   74
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8601259, 'recall': 0.54156196, 'specificity': 0.54156196, 'f1': 0.56580156, 'auroc': 0.91828334, 'binary_precision': 0.7586207, 'binary_recall': 0.08429119, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.15172414}
confusion matrix:
      0   1
0  5990   7
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_21.png
early stop counter: 1
val acc:0.9875478744506836, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 21,now: 2024-06-07 07:27:36.126976,epoch time: 0:17:01.780572,used: 6:03:51.543610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991551, 'precision': 0.9420098, 'recall': 0.92574537, 'specificity': 0.92574537, 'f1': 0.9337132, 'auroc': 0.99652934, 'binary_precision': 0.88904595, 'binary_recall': 0.8552005, 'binary_specificity': 0.99629027, 'binary_f1_score': 0.8717949}
confusion matrix:
       0     1
0  42164   157
1    213  1258
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.9116679, 'recall': 0.8906305, 'specificity': 0.8906305, 'f1': 0.90085053, 'auroc': 0.98387814, 'binary_precision': 0.8308703, 'binary_recall': 0.7869362, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.80830675}
confusion matrix:
       0    1
0  18046  103
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.807091, 'recall': 0.57296175, 'specificity': 0.57296175, 'f1': 0.6115322, 'auroc': 0.91284895, 'binary_precision': 0.65, 'binary_recall': 0.14942528, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.24299066}
confusion matrix:
      0   1
0  5976  21
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_22.png
early stop counter: 2
val acc:0.9872286319732666, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 22,now: 2024-06-07 07:44:42.548858,epoch time: 0:17:06.421882,used: 6:20:57.965492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99050057, 'precision': 0.9092661, 'recall': 0.95473003, 'specificity': 0.95473003, 'f1': 0.9306996, 'auroc': 0.99713004, 'binary_precision': 0.82145035, 'binary_recall': 0.9163834, 'binary_specificity': 0.99307674, 'binary_f1_score': 0.8663239}
confusion matrix:
       0     1
0  42028   293
1    123  1348
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.891815, 'recall': 0.9082461, 'specificity': 0.9082461, 'f1': 0.89984703, 'auroc': 0.9833174, 'binary_precision': 0.78986585, 'binary_recall': 0.82426125, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.8066971}
confusion matrix:
       0    1
0  18008  141
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8992585, 'recall': 0.58545655, 'specificity': 0.58545655, 'f1': 0.6336366, 'auroc': 0.9299175, 'binary_precision': 0.8333333, 'binary_recall': 0.1724138, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5988   9
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_23.png
early stop counter: 3
val acc:0.986483633518219, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 23,now: 2024-06-07 08:01:46.746586,epoch time: 0:17:04.197728,used: 6:38:02.163220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99342346, 'precision': 0.96935964, 'recall': 0.9267142, 'specificity': 0.9267142, 'f1': 0.94694626, 'auroc': 0.9977143, 'binary_precision': 0.94373596, 'binary_recall': 0.8552005, 'binary_specificity': 0.99822783, 'binary_f1_score': 0.8972896}
confusion matrix:
       0     1
0  42246    75
1    213  1258
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9339492, 'recall': 0.8783479, 'specificity': 0.8783479, 'f1': 0.90409607, 'auroc': 0.98277515, 'binary_precision': 0.8763441, 'binary_recall': 0.7604977, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.8143214}
confusion matrix:
       0    1
0  18080   69
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.91590285, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_24.png
early stop counter: 4
val acc:0.9881332516670227, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 24,now: 2024-06-07 08:18:51.029085,epoch time: 0:17:04.282499,used: 6:55:06.445719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9923045, 'precision': 0.92790973, 'recall': 0.9589703, 'specificity': 0.9589703, 'f1': 0.9428511, 'auroc': 0.99782, 'binary_precision': 0.85849655, 'binary_recall': 0.9232337, 'binary_specificity': 0.994707, 'binary_f1_score': 0.8896891}
confusion matrix:
       0     1
0  42096   224
1    113  1359
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.89076847, 'recall': 0.91357917, 'specificity': 0.91357917, 'f1': 0.90182185, 'auroc': 0.9826889, 'binary_precision': 0.78739005, 'binary_recall': 0.83514774, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.81056607}
confusion matrix:
       0    1
0  18004  145
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83818096, 'recall': 0.54705894, 'specificity': 0.54705894, 'f1': 0.574394, 'auroc': 0.87460124, 'binary_precision': 0.71428573, 'binary_recall': 0.09578544, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5987  10
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_25.png
early stop counter: 5
val acc:0.9866432547569275, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 25,now: 2024-06-07 08:35:55.734686,epoch time: 0:17:04.705601,used: 7:12:11.151320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99171084, 'precision': 0.9844412, 'recall': 0.885473, 'specificity': 0.885473, 'f1': 0.9289307, 'auroc': 0.9976688, 'binary_precision': 0.9767642, 'binary_recall': 0.771584, 'binary_specificity': 0.999362, 'binary_f1_score': 0.86213446}
confusion matrix:
       0     1
0  42294    27
1    336  1135
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9602665, 'recall': 0.8311833, 'specificity': 0.8311833, 'f1': 0.8844441, 'auroc': 0.98233914, 'binary_precision': 0.9323144, 'binary_recall': 0.66407466, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.7756585}
confusion matrix:
       0    1
0  18118   31
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.92420125, 'recall': 0.5152423, 'specificity': 0.5152423, 'f1': 0.5192589, 'auroc': 0.89735866, 'binary_precision': 0.8888889, 'binary_recall': 0.03065134, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5996  1
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_26.png
early stop counter: 6
val acc:0.9868561029434204, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 26,now: 2024-06-07 08:53:01.193198,epoch time: 0:17:05.458512,used: 7:29:16.609832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99244153, 'precision': 0.9493011, 'recall': 0.9324846, 'specificity': 0.9324846, 'f1': 0.9407201, 'auroc': 0.9977819, 'binary_precision': 0.90318024, 'binary_recall': 0.8682065, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.88534814}
confusion matrix:
       0     1
0  42183   137
1    194  1278
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.93202823, 'recall': 0.88059807, 'specificity': 0.88059807, 'f1': 0.9045571, 'auroc': 0.9819743, 'binary_precision': 0.87234044, 'binary_recall': 0.7651633, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.81524444}
confusion matrix:
       0    1
0  18077   72
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.89799964, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_27.png
early stop counter: 7
val acc:0.9881332516670227, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 27,now: 2024-06-07 09:10:22.722584,epoch time: 0:17:21.529386,used: 7:46:38.139218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99328643, 'precision': 0.9731251, 'recall': 0.920791, 'specificity': 0.920791, 'f1': 0.9453128, 'auroc': 0.9982466, 'binary_precision': 0.9516871, 'binary_recall': 0.8430706, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.8940922}
confusion matrix:
       0     1
0  42257    63
1    231  1241
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.92969346, 'recall': 0.8511593, 'specificity': 0.8511593, 'f1': 0.88617116, 'auroc': 0.9841968, 'binary_precision': 0.8697318, 'binary_recall': 0.7060653, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7793991}
confusion matrix:
       0    1
0  18081   68
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9802979, 'recall': 0.52873564, 'specificity': 0.52873564, 'f1': 0.5442988, 'auroc': 0.8819178, 'binary_precision': 1.0, 'binary_recall': 0.057471264, 'binary_specificity': 1.0, 'binary_f1_score': 0.10869565}
confusion matrix:
      0   1
0  5997   0
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_28.png
early stop counter: 8
val acc:0.9863239526748657, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 28,now: 2024-06-07 09:27:41.980629,epoch time: 0:17:19.258045,used: 8:03:57.397263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9938573, 'precision': 0.9539288, 'recall': 0.95124936, 'specificity': 0.95124936, 'f1': 0.95258486, 'auroc': 0.99809575, 'binary_precision': 0.9111415, 'binary_recall': 0.9055706, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.90834755}
confusion matrix:
       0     1
0  42190   130
1    139  1333
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9055498, 'recall': 0.89885354, 'specificity': 0.89885354, 'f1': 0.9021715, 'auroc': 0.983871, 'binary_precision': 0.818038, 'binary_recall': 0.80404353, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.8109804}
confusion matrix:
       0    1
0  18034  115
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9055276, 'recall': 0.55322295, 'specificity': 0.55322295, 'f1': 0.58550155, 'auroc': 0.9201391, 'binary_precision': 0.8484849, 'binary_recall': 0.107279696, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19047618}
confusion matrix:
      0   1
0  5992   5
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_29.png
early stop counter: 9
val acc:0.9871754050254822, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 29,now: 2024-06-07 09:44:50.417406,epoch time: 0:17:08.436777,used: 8:21:05.834040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9928982, 'precision': 0.9371528, 'recall': 0.9563268, 'specificity': 0.9563268, 'f1': 0.94651735, 'auroc': 0.99814296, 'binary_precision': 0.877193, 'binary_recall': 0.91711956, 'binary_specificity': 0.995534, 'binary_f1_score': 0.8967121}
confusion matrix:
       0     1
0  42131   189
1    122  1350
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.893771, 'recall': 0.9091064, 'specificity': 0.9091064, 'f1': 0.9012794, 'auroc': 0.98428833, 'binary_precision': 0.793722, 'binary_recall': 0.8258165, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.80945116}
confusion matrix:
       0    1
0  18011  138
1    112  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.92840976, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_30.png
early stop counter: 10
val acc:0.9866964817047119, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9611697196960449 / 0.9718760251998901
after epoch: 30,now: 2024-06-07 10:02:04.251099,epoch time: 0:17:13.833693,used: 8:38:19.667733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_23_44_seed_0_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:38:19.667733 at 2024-06-07 10:02:04.251099
persisted model performance metric: 

scalar performance:
{'acc': 0.96180886, 'precision': 0.9425237, 'recall': 0.5458103, 'specificity': 0.5458103, 'f1': 0.5738518, 'auroc': 0.905741, 'binary_precision': 0.9230769, 'binary_recall': 0.09195402, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.16724738}
confusion matrix:
      0   1
0  5995   2
1   237  24
oracle model performance metric: 

scalar performance:
{'acc': 0.97235537, 'precision': 0.9120461, 'recall': 0.70339674, 'specificity': 0.70339674, 'f1': 0.7693541, 'auroc': 0.930506, 'binary_precision': 0.8492063, 'binary_recall': 0.4099617, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.55297154}
confusion matrix:
      0    1
0  5978   19
1   154  107
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16678 MiB |  16678 MiB |  16678 MiB |      0 B   |
|       from large pool |  16650 MiB |  16650 MiB |  16650 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474654 KiB |    851 MiB | 464776 GiB | 464776 GiB |
|       from large pool | 454720 KiB |    848 MiB | 451886 GiB | 451885 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  151974 K  |  151971 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89895 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  151974 K  |  151971 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89895 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2873    |   83867 K  |   83866 K  |
|       from large pool |     110    |     506    |   40711 K  |   40711 K  |
|       from small pool |      34    |    2761    |   43155 K  |   43155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451887 GiB | 451887 GiB |
|       from small pool |      0 B   |     24 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83868 K  |   83868 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   43156 K  |   43156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451887 GiB | 451887 GiB |
|       from small pool |      0 B   |     24 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83868 K  |   83868 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   43156 K  |   43156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183

 Experiment start at: 2024-06-07 10:09:45.820495
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9697875, 'precision': 0.7640355, 'recall': 0.73651564, 'specificity': 0.73651564, 'f1': 0.7494414, 'auroc': 0.94178927, 'binary_precision': 0.54545456, 'binary_recall': 0.48682386, 'binary_specificity': 0.98620737, 'binary_f1_score': 0.5144742}
confusion matrix:
       0    1
0  41829  585
1    740  702
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.77352273, 'recall': 0.73456514, 'specificity': 0.73456514, 'f1': 0.7523871, 'auroc': 0.9462641, 'binary_precision': 0.5662021, 'binary_recall': 0.48291233, 'binary_specificity': 0.986218, 'binary_f1_score': 0.52125096}
confusion matrix:
       0    1
0  17818  249
1    348  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7077576, 'recall': 0.55282605, 'specificity': 0.55282605, 'f1': 0.5785035, 'auroc': 0.9287983, 'binary_precision': 0.453125, 'binary_recall': 0.11153846, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.17901234}
confusion matrix:
      0   1
0  5911  35
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 10:27:50.006919,epoch time: 0:18:04.186424,used: 0:18:04.186424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97423387, 'precision': 0.8244689, 'recall': 0.7108154, 'specificity': 0.7108154, 'f1': 0.7545802, 'auroc': 0.95928305, 'binary_precision': 0.6681081, 'binary_recall': 0.42886883, 'binary_specificity': 0.99276197, 'binary_f1_score': 0.5224006}
confusion matrix:
       0    1
0  42108  307
1    823  618
---- Validation: 
scalar performance:
{'acc': 0.9728922, 'precision': 0.836311, 'recall': 0.71628547, 'specificity': 0.71628547, 'f1': 0.76210904, 'auroc': 0.9618063, 'binary_precision': 0.69320846, 'binary_recall': 0.4398217, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.53818184}
confusion matrix:
       0    1
0  17936  131
1    377  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.76460314, 'recall': 0.5724773, 'specificity': 0.5724773, 'f1': 0.60815454, 'auroc': 0.93789154, 'binary_precision': 0.5652174, 'binary_recall': 0.15, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.23708208}
confusion matrix:
      0   1
0  5916  30
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 10:44:59.662238,epoch time: 0:17:09.655319,used: 0:35:13.841743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9774261, 'precision': 0.8369461, 'recall': 0.7819989, 'specificity': 0.7819989, 'f1': 0.80682313, 'auroc': 0.96800125, 'binary_precision': 0.68833333, 'binary_recall': 0.57281554, 'binary_specificity': 0.99118215, 'binary_f1_score': 0.62528384}
confusion matrix:
       0    1
0  42040  374
1    616  826
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.84305453, 'recall': 0.75230217, 'specificity': 0.75230217, 'f1': 0.79013455, 'auroc': 0.9682298, 'binary_precision': 0.70408165, 'binary_recall': 0.51263, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.5932932}
confusion matrix:
       0    1
0  17922  145
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7834195, 'recall': 0.5429694, 'specificity': 0.5429694, 'f1': 0.56678003, 'auroc': 0.94003665, 'binary_precision': 0.6052632, 'binary_recall': 0.08846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.15436243}
confusion matrix:
      0   1
0  5931  15
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 11:02:15.622784,epoch time: 0:17:15.960546,used: 0:52:29.802289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9804132, 'precision': 0.88291055, 'recall': 0.7785189, 'specificity': 0.7785189, 'f1': 0.8218451, 'auroc': 0.9749841, 'binary_precision': 0.7805582, 'binary_recall': 0.56241333, 'binary_specificity': 0.99462444, 'binary_f1_score': 0.65376866}
confusion matrix:
       0    1
0  42186  228
1    631  811
---- Validation: 
scalar performance:
{'acc': 0.97892207, 'precision': 0.8953402, 'recall': 0.76876616, 'specificity': 0.76876616, 'f1': 0.8190119, 'auroc': 0.97234344, 'binary_precision': 0.8075221, 'binary_recall': 0.54234767, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.6488889}
confusion matrix:
       0    1
0  17980   87
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.85634935, 'recall': 0.5568514, 'specificity': 0.5568514, 'f1': 0.5900925, 'auroc': 0.94767684, 'binary_precision': 0.75, 'binary_recall': 0.115384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5936  10
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-07 11:19:03.726205,epoch time: 0:16:48.103421,used: 1:09:17.905710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97979754, 'precision': 0.8338519, 'recall': 0.8632784, 'specificity': 0.8632784, 'f1': 0.8478862, 'auroc': 0.97858274, 'binary_precision': 0.67662007, 'binary_recall': 0.7385576, 'binary_specificity': 0.98799926, 'binary_f1_score': 0.70623344}
confusion matrix:
       0     1
0  41905   509
1    377  1065
---- Validation: 
scalar performance:
{'acc': 0.9783351, 'precision': 0.8419897, 'recall': 0.8478564, 'specificity': 0.8478564, 'f1': 0.8448956, 'auroc': 0.97633684, 'binary_precision': 0.6948905, 'binary_recall': 0.7072808, 'binary_specificity': 0.98843193, 'binary_f1_score': 0.70103085}
confusion matrix:
       0    1
0  17858  209
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.83676493, 'recall': 0.64346296, 'specificity': 0.64346296, 'f1': 0.6975546, 'auroc': 0.95121074, 'binary_precision': 0.7037037, 'binary_recall': 0.2923077, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.4130435}
confusion matrix:
      0   1
0  5914  32
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_5.png
new oracle model saved
early stop counter: 1
val acc:0.9783350825309753, best validation acc: 0.9789220690727234, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 5,now: 2024-06-07 11:35:43.991553,epoch time: 0:16:40.265348,used: 1:25:58.171058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9833318, 'precision': 0.91638756, 'recall': 0.79945505, 'specificity': 0.79945505, 'f1': 0.8476766, 'auroc': 0.9807447, 'binary_precision': 0.84615386, 'binary_recall': 0.6026352, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.70392865}
confusion matrix:
       0    1
0  42256  158
1    573  869
---- Validation: 
scalar performance:
{'acc': 0.9803095, 'precision': 0.913, 'recall': 0.7759231, 'specificity': 0.7759231, 'f1': 0.8297516, 'auroc': 0.9782117, 'binary_precision': 0.8423423, 'binary_recall': 0.5557206, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.66965085}
confusion matrix:
       0    1
0  17997   70
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.9424446, 'recall': 0.5459857, 'specificity': 0.5459857, 'f1': 0.57410246, 'auroc': 0.945783, 'binary_precision': 0.9230769, 'binary_recall': 0.092307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.16783217}
confusion matrix:
      0   1
0  5944   2
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 11:52:19.241889,epoch time: 0:16:35.250336,used: 1:42:33.421394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98223734, 'precision': 0.85418695, 'recall': 0.87525827, 'specificity': 0.87525827, 'f1': 0.8643911, 'auroc': 0.9850875, 'binary_precision': 0.71652514, 'binary_recall': 0.760749, 'binary_specificity': 0.98976755, 'binary_f1_score': 0.73797506}
confusion matrix:
       0     1
0  41980   434
1    345  1097
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.85435534, 'recall': 0.8740808, 'specificity': 0.8740808, 'f1': 0.8639247, 'auroc': 0.9795934, 'binary_precision': 0.7176966, 'binary_recall': 0.75928676, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.73790616}
confusion matrix:
       0    1
0  17866  201
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8306509, 'recall': 0.5396278, 'specificity': 0.5396278, 'f1': 0.56218445, 'auroc': 0.9494893, 'binary_precision': 0.7, 'binary_recall': 0.08076923, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.14482759}
confusion matrix:
      0   1
0  5937   9
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 12:09:00.107255,epoch time: 0:16:40.865366,used: 1:59:14.286760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98454034, 'precision': 0.8904118, 'recall': 0.85735667, 'specificity': 0.85735667, 'f1': 0.87309444, 'auroc': 0.9835751, 'binary_precision': 0.79027355, 'binary_recall': 0.72122055, 'binary_specificity': 0.9934927, 'binary_f1_score': 0.7541697}
confusion matrix:
       0     1
0  42138   276
1    402  1040
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.91063845, 'recall': 0.825945, 'specificity': 0.825945, 'f1': 0.8630181, 'auroc': 0.97983176, 'binary_precision': 0.83396226, 'binary_recall': 0.65676075, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7348296}
confusion matrix:
       0    1
0  17979   88
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.92904806, 'recall': 0.5650483, 'specificity': 0.5650483, 'f1': 0.60460085, 'auroc': 0.94403994, 'binary_precision': 0.8947368, 'binary_recall': 0.13076924, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.22818793}
confusion matrix:
      0   1
0  5942   4
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 12:25:48.044336,epoch time: 0:16:47.937081,used: 2:16:02.223841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98629606, 'precision': 0.9134182, 'recall': 0.8602741, 'specificity': 0.8602741, 'f1': 0.88487995, 'auroc': 0.98637486, 'binary_precision': 0.8361311, 'binary_recall': 0.72538143, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.7768289}
confusion matrix:
       0     1
0  42209   205
1    396  1046
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.91426015, 'recall': 0.8312286, 'specificity': 0.8312286, 'f1': 0.8677373, 'auroc': 0.98045576, 'binary_precision': 0.84082395, 'binary_recall': 0.66716194, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.74399334}
confusion matrix:
       0    1
0  17982   85
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.90674806, 'recall': 0.5438944, 'specificity': 0.5438944, 'f1': 0.5702013, 'auroc': 0.94455045, 'binary_precision': 0.8518519, 'binary_recall': 0.08846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.16027877}
confusion matrix:
      0   1
0  5942   4
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 12:42:32.340064,epoch time: 0:16:44.295728,used: 2:32:46.519569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9854752, 'precision': 0.94398284, 'recall': 0.8126214, 'specificity': 0.8126214, 'f1': 0.8661052, 'auroc': 0.98753357, 'binary_precision': 0.9004975, 'binary_recall': 0.62760055, 'binary_specificity': 0.9976423, 'binary_f1_score': 0.7396812}
confusion matrix:
       0    1
0  42314  100
1    537  905
---- Validation: 
scalar performance:
{'acc': 0.9807364, 'precision': 0.93827474, 'recall': 0.76183915, 'specificity': 0.76183915, 'f1': 0.8261933, 'auroc': 0.9788047, 'binary_precision': 0.8939394, 'binary_recall': 0.52600294, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.6623012}
confusion matrix:
       0    1
0  18025   42
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.9397433, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_10.png
early stop counter: 1
val acc:0.9807363748550415, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 10,now: 2024-06-07 12:59:12.207477,epoch time: 0:16:39.867413,used: 2:49:26.386982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.987915, 'precision': 0.91523063, 'recall': 0.889582, 'specificity': 0.889582, 'f1': 0.90196544, 'auroc': 0.98858935, 'binary_precision': 0.8377778, 'binary_recall': 0.7843273, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.81017196}
confusion matrix:
       0     1
0  42195   219
1    311  1131
---- Validation: 
scalar performance:
{'acc': 0.9828709, 'precision': 0.9050163, 'recall': 0.8308965, 'specificity': 0.8308965, 'f1': 0.8639084, 'auroc': 0.9818934, 'binary_precision': 0.8223443, 'binary_recall': 0.66716194, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.73666936}
confusion matrix:
       0    1
0  17970   97
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9003583, 'recall': 0.5591108, 'specificity': 0.5591108, 'f1': 0.5946784, 'auroc': 0.94541776, 'binary_precision': 0.8378378, 'binary_recall': 0.11923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.20875423}
confusion matrix:
      0   1
0  5940   6
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_11.png
early stop counter: 2
val acc:0.982870876789093, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 11,now: 2024-06-07 13:15:48.222895,epoch time: 0:16:36.015418,used: 3:06:02.402400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9873906, 'precision': 0.89478195, 'recall': 0.91141766, 'specificity': 0.91141766, 'f1': 0.9029138, 'auroc': 0.99092937, 'binary_precision': 0.7953488, 'binary_recall': 0.8300971, 'binary_specificity': 0.99273825, 'binary_f1_score': 0.8123516}
confusion matrix:
       0     1
0  42106   308
1    245  1197
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.9101376, 'recall': 0.87599456, 'specificity': 0.87599456, 'f1': 0.89226025, 'auroc': 0.98200583, 'binary_precision': 0.8292683, 'binary_recall': 0.7578009, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.79192543}
confusion matrix:
       0    1
0  17962  105
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.91133565, 'recall': 0.591635, 'specificity': 0.591635, 'f1': 0.6428048, 'auroc': 0.93889314, 'binary_precision': 0.85714287, 'binary_recall': 0.18461539, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.30379745}
confusion matrix:
      0   1
0  5938   8
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 13:32:29.746963,epoch time: 0:16:41.524068,used: 3:22:43.926468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9880746, 'precision': 0.9191356, 'recall': 0.8873198, 'specificity': 0.8873198, 'f1': 0.9025512, 'auroc': 0.99055177, 'binary_precision': 0.84574866, 'binary_recall': 0.77947295, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.8112595}
confusion matrix:
       0     1
0  42209   205
1    318  1124
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.91580063, 'recall': 0.82096577, 'specificity': 0.82096577, 'f1': 0.8617805, 'auroc': 0.981822, 'binary_precision': 0.8446602, 'binary_recall': 0.64635956, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.7323233}
confusion matrix:
       0    1
0  17987   80
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9652475, 'recall': 0.5576082, 'specificity': 0.5576082, 'f1': 0.59356385, 'auroc': 0.9507293, 'binary_precision': 0.9677419, 'binary_recall': 0.115384616, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5945   1
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_13.png
early stop counter: 1
val acc:0.9830309748649597, best validation acc: 0.9856990575790405, corresponding to test acc:                         0.9645504355430603 / 0.9651950001716614
after epoch: 13,now: 2024-06-07 13:48:59.240440,epoch time: 0:16:29.493477,used: 3:39:13.419945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.9533086, 'recall': 0.8670833, 'specificity': 0.8670833, 'f1': 0.9053395, 'auroc': 0.99220014, 'binary_precision': 0.9155173, 'binary_recall': 0.73647714, 'binary_specificity': 0.9976894, 'binary_f1_score': 0.81629515}
confusion matrix:
       0     1
0  42316    98
1    380  1062
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.94299316, 'recall': 0.8225666, 'specificity': 0.8225666, 'f1': 0.8725742, 'auroc': 0.9804201, 'binary_precision': 0.89896905, 'binary_recall': 0.64784545, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.75302243}
confusion matrix:
       0    1
0  18018   49
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.95999813, 'recall': 0.54414666, 'specificity': 0.54414666, 'f1': 0.5711739, 'auroc': 0.8995422, 'binary_precision': 0.9583333, 'binary_recall': 0.08846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16197182}
confusion matrix:
      0   1
0  5945   1
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_14.png
early stop counter: 2
val acc:0.9847385287284851, best validation acc: 0.9856990575790405, corresponding to test acc:                         0.9645504355430603 / 0.9651950001716614
after epoch: 14,now: 2024-06-07 14:05:35.853311,epoch time: 0:16:36.612871,used: 3:55:50.032816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895567, 'precision': 0.9295057, 'recall': 0.9018191, 'specificity': 0.9018191, 'f1': 0.9151658, 'auroc': 0.9921863, 'binary_precision': 0.8655275, 'binary_recall': 0.8079057, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.83572453}
confusion matrix:
       0     1
0  42233   181
1    277  1165
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.9050373, 'recall': 0.8654827, 'specificity': 0.8654827, 'f1': 0.88415635, 'auroc': 0.9823805, 'binary_precision': 0.8198347, 'binary_recall': 0.7369985, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.77621275}
confusion matrix:
       0    1
0  17958  109
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8821312, 'recall': 0.57608217, 'specificity': 0.57608217, 'f1': 0.61952966, 'auroc': 0.94666064, 'binary_precision': 0.8, 'binary_recall': 0.15384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  5936  10
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_15.png
early stop counter: 3
val acc:0.9847385287284851, best validation acc: 0.9856990575790405, corresponding to test acc:                         0.9645504355430603 / 0.9651950001716614
after epoch: 15,now: 2024-06-07 14:22:16.360256,epoch time: 0:16:40.506945,used: 4:12:30.539761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98980755, 'precision': 0.9388814, 'recall': 0.8949148, 'specificity': 0.8949148, 'f1': 0.91565144, 'auroc': 0.9933753, 'binary_precision': 0.88476413, 'binary_recall': 0.7933426, 'binary_specificity': 0.996487, 'binary_f1_score': 0.83656305}
confusion matrix:
       0     1
0  42265   149
1    298  1144
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.9141283, 'recall': 0.843748, 'specificity': 0.843748, 'f1': 0.8753963, 'auroc': 0.9826617, 'binary_precision': 0.83963966, 'binary_recall': 0.692422, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.7589577}
confusion matrix:
       0    1
0  17978   89
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.942287, 'recall': 0.5670554, 'specificity': 0.5670554, 'f1': 0.6080391, 'auroc': 0.94857883, 'binary_precision': 0.92105263, 'binary_recall': 0.13461539, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.23489934}
confusion matrix:
      0   1
0  5943   3
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_16.png
early stop counter: 4
val acc:0.984204888343811, best validation acc: 0.9856990575790405, corresponding to test acc:                         0.9645504355430603 / 0.9651950001716614
after epoch: 16,now: 2024-06-07 14:39:00.738322,epoch time: 0:16:44.378066,used: 4:29:14.917827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99056, 'precision': 0.9347315, 'recall': 0.9137262, 'specificity': 0.9137262, 'f1': 0.92394876, 'auroc': 0.9944825, 'binary_precision': 0.8751825, 'binary_recall': 0.8314841, 'binary_specificity': 0.99596834, 'binary_f1_score': 0.8527739}
confusion matrix:
       0     1
0  42243   171
1    243  1199
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.9062792, 'recall': 0.8736274, 'specificity': 0.8736274, 'f1': 0.8892101, 'auroc': 0.98114085, 'binary_precision': 0.821718, 'binary_recall': 0.7533432, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.7860465}
confusion matrix:
       0    1
0  17957  110
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9501235, 'recall': 0.55752414, 'specificity': 0.55752414, 'f1': 0.59316874, 'auroc': 0.9154787, 'binary_precision': 0.9375, 'binary_recall': 0.115384616, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5944   2
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_17.png
early stop counter: 5
val acc:0.9852721691131592, best validation acc: 0.9856990575790405, corresponding to test acc:                         0.9645504355430603 / 0.9651950001716614
after epoch: 17,now: 2024-06-07 14:55:40.678744,epoch time: 0:16:39.940422,used: 4:45:54.858249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99044603, 'precision': 0.93603635, 'recall': 0.9099828, 'specificity': 0.9099828, 'f1': 0.9225776, 'auroc': 0.9945046, 'binary_precision': 0.8780488, 'binary_recall': 0.82385576, 'binary_specificity': 0.9961098, 'binary_f1_score': 0.85008943}
confusion matrix:
       0     1
0  42249   165
1    254  1188
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.92735696, 'recall': 0.8633965, 'specificity': 0.8633965, 'f1': 0.89257544, 'auroc': 0.9826977, 'binary_precision': 0.86467487, 'binary_recall': 0.73105496, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.7922705}
confusion matrix:
       0    1
0  17990   77
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.91395295, 'recall': 0.561118, 'specificity': 0.561118, 'f1': 0.5981279, 'auroc': 0.921994, 'binary_precision': 0.8648649, 'binary_recall': 0.12307692, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.21548823}
confusion matrix:
      0   1
0  5941   5
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 15:12:32.338136,epoch time: 0:16:51.659392,used: 5:02:46.517641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.990332, 'precision': 0.96599877, 'recall': 0.8760936, 'specificity': 0.8760936, 'f1': 0.915908, 'auroc': 0.994693, 'binary_precision': 0.94031143, 'binary_recall': 0.75381416, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.8367975}
confusion matrix:
       0     1
0  42345    69
1    355  1087
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.94193923, 'recall': 0.8062773, 'specificity': 0.8062773, 'f1': 0.8608698, 'auroc': 0.98194534, 'binary_precision': 0.89804775, 'binary_recall': 0.615156, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.73015875}
confusion matrix:
       0    1
0  18020   47
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.932503, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_19.png
early stop counter: 1
val acc:0.9836713075637817, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.962455689907074 / 0.9651950001716614
after epoch: 19,now: 2024-06-07 15:29:17.019019,epoch time: 0:16:44.680883,used: 5:19:31.198524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99074244, 'precision': 0.91867065, 'recall': 0.9399468, 'specificity': 0.9399468, 'f1': 0.92902374, 'auroc': 0.9949864, 'binary_precision': 0.8412385, 'binary_recall': 0.8855756, 'binary_specificity': 0.9943179, 'binary_f1_score': 0.86283785}
confusion matrix:
       0     1
0  42173   241
1    165  1277
---- Validation: 
scalar performance:
{'acc': 0.9850053, 'precision': 0.8935795, 'recall': 0.88850963, 'specificity': 0.88850963, 'f1': 0.8910266, 'auroc': 0.9826543, 'binary_precision': 0.79518074, 'binary_recall': 0.7845468, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.78982794}
confusion matrix:
       0    1
0  17931  136
1    145  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8814235, 'recall': 0.59698373, 'specificity': 0.59698373, 'f1': 0.6482247, 'auroc': 0.932392, 'binary_precision': 0.796875, 'binary_recall': 0.19615385, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.3148148}
confusion matrix:
      0   1
0  5933  13
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_20.png
early stop counter: 2
val acc:0.9850053191184998, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.962455689907074 / 0.9651950001716614
after epoch: 20,now: 2024-06-07 15:45:57.240395,epoch time: 0:16:40.221376,used: 5:36:11.419900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9914493, 'precision': 0.93192303, 'recall': 0.9339481, 'specificity': 0.9339481, 'f1': 0.93293303, 'auroc': 0.9956229, 'binary_precision': 0.868185, 'binary_recall': 0.87239945, 'binary_specificity': 0.99549675, 'binary_f1_score': 0.8702871}
confusion matrix:
       0     1
0  42223   191
1    184  1258
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.89913493, 'recall': 0.8865576, 'specificity': 0.8865576, 'f1': 0.89273655, 'auroc': 0.98288673, 'binary_precision': 0.8064516, 'binary_recall': 0.78008914, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.79305136}
confusion matrix:
       0    1
0  17941  126
1    148  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.9489747, 'recall': 0.58051693, 'specificity': 0.58051693, 'f1': 0.628578, 'auroc': 0.9401493, 'binary_precision': 0.93333334, 'binary_recall': 0.16153847, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.27540985}
confusion matrix:
      0   1
0  5943   3
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_21.png
early stop counter: 3
val acc:0.9853788614273071, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.962455689907074 / 0.9651950001716614
after epoch: 21,now: 2024-06-07 16:02:46.589984,epoch time: 0:16:49.349589,used: 5:53:00.769489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9916545, 'precision': 0.96809906, 'recall': 0.8962046, 'specificity': 0.8962046, 'f1': 0.9289479, 'auroc': 0.9965706, 'binary_precision': 0.9431631, 'binary_recall': 0.7940361, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.8621988}
confusion matrix:
       0     1
0  42345    69
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.9499976, 'recall': 0.8545685, 'specificity': 0.8545685, 'f1': 0.89617825, 'auroc': 0.98074365, 'binary_precision': 0.9106464, 'binary_recall': 0.71173847, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.79899913}
confusion matrix:
       0    1
0  18020   47
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.90071326, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_22.png
better model found
persisted
after epoch: 22,now: 2024-06-07 16:19:31.912176,epoch time: 0:16:45.322192,used: 6:09:46.091681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99097043, 'precision': 0.96243423, 'recall': 0.89015675, 'specificity': 0.89015675, 'f1': 0.9230116, 'auroc': 0.9956186, 'binary_precision': 0.9322314, 'binary_recall': 0.7822469, 'binary_specificity': 0.99806666, 'binary_f1_score': 0.85067874}
confusion matrix:
       0     1
0  42332    82
1    314  1128
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.9454117, 'recall': 0.83668256, 'specificity': 0.83668256, 'f1': 0.8828987, 'auroc': 0.98189795, 'binary_precision': 0.9027778, 'binary_recall': 0.67607725, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.77315205}
confusion matrix:
       0    1
0  18018   49
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.9490375, 'recall': 0.55560106, 'specificity': 0.55560106, 'f1': 0.5900449, 'auroc': 0.9228106, 'binary_precision': 0.9354839, 'binary_recall': 0.11153846, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.19931272}
confusion matrix:
      0   1
0  5944   2
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_23.png
early stop counter: 1
val acc:0.9857524037361145, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9614889025688171 / 0.9651950001716614
after epoch: 23,now: 2024-06-07 16:36:33.527823,epoch time: 0:17:01.615647,used: 6:26:47.707328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9918825, 'precision': 0.98031604, 'recall': 0.88895357, 'specificity': 0.88895357, 'f1': 0.9294996, 'auroc': 0.9967662, 'binary_precision': 0.96810347, 'binary_recall': 0.77877945, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.8631822}
confusion matrix:
       0     1
0  42377    37
1    319  1123
---- Validation: 
scalar performance:
{'acc': 0.9850053, 'precision': 0.95362425, 'recall': 0.8176981, 'specificity': 0.8176981, 'f1': 0.87277997, 'auroc': 0.97997785, 'binary_precision': 0.92060083, 'binary_recall': 0.63744426, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.75329226}
confusion matrix:
       0    1
0  18030   37
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.9408283, 'recall': 0.5440626, 'specificity': 0.5440626, 'f1': 0.5708477, 'auroc': 0.9243927, 'binary_precision': 0.92, 'binary_recall': 0.08846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5944   2
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_24.png
early stop counter: 2
val acc:0.9850053191184998, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9614889025688171 / 0.9651950001716614
after epoch: 24,now: 2024-06-07 16:53:31.306027,epoch time: 0:16:57.778204,used: 6:43:45.485532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927034, 'precision': 0.9571482, 'recall': 0.92521787, 'specificity': 0.92521787, 'f1': 0.9405622, 'auroc': 0.9971943, 'binary_precision': 0.9192825, 'binary_recall': 0.852982, 'binary_specificity': 0.9974537, 'binary_f1_score': 0.8848921}
confusion matrix:
       0     1
0  42306   108
1    212  1230
---- Validation: 
scalar performance:
{'acc': 0.986873, 'precision': 0.93342924, 'recall': 0.8673049, 'specificity': 0.8673049, 'f1': 0.8974124, 'auroc': 0.98146003, 'binary_precision': 0.8765432, 'binary_recall': 0.7384844, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.80161285}
confusion matrix:
       0    1
0  17997   70
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.93733084, 'recall': 0.5593631, 'specificity': 0.5593631, 'f1': 0.59586966, 'auroc': 0.9110684, 'binary_precision': 0.9117647, 'binary_recall': 0.11923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5943   3
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_25.png
early stop counter: 3
val acc:0.9868729710578918, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9614889025688171 / 0.9651950001716614
after epoch: 25,now: 2024-06-07 17:11:07.097391,epoch time: 0:17:35.791364,used: 7:01:21.276896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99361545, 'precision': 0.9558891, 'recall': 0.94243693, 'specificity': 0.94243693, 'f1': 0.9490547, 'auroc': 0.99738264, 'binary_precision': 0.9155937, 'binary_recall': 0.88765603, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.9014085}
confusion matrix:
       0     1
0  42296   118
1    162  1280
---- Validation: 
scalar performance:
{'acc': 0.98778015, 'precision': 0.9344509, 'recall': 0.88136554, 'specificity': 0.88136554, 'f1': 0.9060377, 'auroc': 0.9806966, 'binary_precision': 0.877551, 'binary_recall': 0.7667162, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.81839806}
confusion matrix:
       0    1
0  17995   72
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.95303607, 'recall': 0.56329334, 'specificity': 0.56329334, 'f1': 0.6024149, 'auroc': 0.91595286, 'binary_precision': 0.94285715, 'binary_recall': 0.12692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.22372884}
confusion matrix:
      0   1
0  5944   2
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_26.png
better model found
persisted
after epoch: 26,now: 2024-06-07 17:28:56.141138,epoch time: 0:17:49.043747,used: 7:19:10.320643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9904916, 'precision': 0.94110227, 'recall': 0.9046471, 'specificity': 0.9046471, 'f1': 0.9220295, 'auroc': 0.9956783, 'binary_precision': 0.88855195, 'binary_recall': 0.81276006, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.84896773}
confusion matrix:
       0     1
0  42267   147
1    270  1172
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.90634906, 'recall': 0.8537617, 'specificity': 0.8537617, 'f1': 0.8780799, 'auroc': 0.98122233, 'binary_precision': 0.8233276, 'binary_recall': 0.71322435, 'binary_specificity': 0.994299, 'binary_f1_score': 0.76433116}
confusion matrix:
       0    1
0  17964  103
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.84854066, 'recall': 0.5265026, 'specificity': 0.5265026, 'f1': 0.5398356, 'auroc': 0.92426836, 'binary_precision': 0.7368421, 'binary_recall': 0.053846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.10035843}
confusion matrix:
      0   1
0  5941   5
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_27.png
early stop counter: 1
val acc:0.984204888343811, best validation acc: 0.9877801537513733, corresponding to test acc:                         0.963100254535675 / 0.9651950001716614
after epoch: 27,now: 2024-06-07 17:46:31.614339,epoch time: 0:17:35.473201,used: 7:36:45.793844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9927034, 'precision': 0.9476781, 'recall': 0.9362712, 'specificity': 0.9362712, 'f1': 0.94189537, 'auroc': 0.9976953, 'binary_precision': 0.8995727, 'binary_recall': 0.87586683, 'binary_specificity': 0.9966756, 'binary_f1_score': 0.8875615}
confusion matrix:
       0     1
0  42273   141
1    179  1263
---- Validation: 
scalar performance:
{'acc': 0.9883138, 'precision': 0.9270885, 'recall': 0.899524, 'specificity': 0.899524, 'f1': 0.91280735, 'auroc': 0.98033595, 'binary_precision': 0.861465, 'binary_recall': 0.8038633, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.8316679}
confusion matrix:
       0    1
0  17980   87
1    132  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.87498593, 'recall': 0.54941136, 'specificity': 0.54941136, 'f1': 0.5787941, 'auroc': 0.8887372, 'binary_precision': 0.7878788, 'binary_recall': 0.1, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.17747441}
confusion matrix:
      0   1
0  5939   7
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_28.png
better model found
persisted
after epoch: 28,now: 2024-06-07 18:04:09.017458,epoch time: 0:17:37.403119,used: 7:54:23.196963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9934558, 'precision': 0.9816321, 'recall': 0.9131537, 'specificity': 0.9131537, 'f1': 0.9445874, 'auroc': 0.99798864, 'binary_precision': 0.9691057, 'binary_recall': 0.82720333, 'binary_specificity': 0.9991041, 'binary_f1_score': 0.89254963}
confusion matrix:
       0     1
0  42377    38
1    249  1192
---- Validation: 
scalar performance:
{'acc': 0.98671293, 'precision': 0.94461834, 'recall': 0.8529166, 'specificity': 0.8529166, 'f1': 0.8930768, 'auroc': 0.9804529, 'binary_precision': 0.9, 'binary_recall': 0.7087667, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.79301745}
confusion matrix:
       0    1
0  18014   53
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.907049, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_29.png
early stop counter: 1
val acc:0.9867129325866699, best validation acc: 0.9883137941360474, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 29,now: 2024-06-07 18:21:27.661683,epoch time: 0:17:18.644225,used: 8:11:41.841188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99377507, 'precision': 0.93676686, 'recall': 0.9703205, 'specificity': 0.9703205, 'f1': 0.9528735, 'auroc': 0.9983083, 'binary_precision': 0.87540144, 'binary_recall': 0.945215, 'binary_specificity': 0.99542606, 'binary_f1_score': 0.9089697}
confusion matrix:
       0     1
0  42220   194
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.896242, 'recall': 0.9070002, 'specificity': 0.9070002, 'f1': 0.9015424, 'auroc': 0.9826774, 'binary_precision': 0.79913294, 'binary_recall': 0.8216939, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.8102564}
confusion matrix:
       0    1
0  17928  139
1    120  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.87551343, 'recall': 0.570313, 'specificity': 0.570313, 'f1': 0.61089706, 'auroc': 0.9176854, 'binary_precision': 0.78723407, 'binary_recall': 0.1423077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.24104236}
confusion matrix:
      0   1
0  5936  10
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_30.png
early stop counter: 2
val acc:0.9861792922019958, best validation acc: 0.9883137941360474, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 30,now: 2024-06-07 18:38:16.475416,epoch time: 0:16:48.813733,used: 8:28:30.654921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_10_09_45_seed_1_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:28:30.654921 at 2024-06-07 18:38:16.475416
persisted model performance metric: 

scalar performance:
{'acc': 0.96358365, 'precision': 0.955526, 'recall': 0.5690626, 'specificity': 0.5690626, 'f1': 0.6114774, 'auroc': 0.88746405, 'binary_precision': 0.94736844, 'binary_recall': 0.13846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.24161077}
confusion matrix:
      0   1
0  5944   2
1   224  36
oracle model performance metric: 

scalar performance:
{'acc': 0.96471155, 'precision': 0.83600605, 'recall': 0.63401574, 'specificity': 0.63401574, 'f1': 0.6875895, 'auroc': 0.94585407, 'binary_precision': 0.7029703, 'binary_recall': 0.27307692, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3933518}
confusion matrix:
      0   1
0  5916  30
1   189  71
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16700 MiB |  16700 MiB |  31208 MiB |  14508 MiB |
|       from large pool |  16672 MiB |  16672 MiB |  31178 MiB |  14506 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474666 KiB |    851 MiB |    880 TiB |    880 TiB |
|       from large pool | 454720 KiB |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |  19946 KiB |     24 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304413 K  |  304410 K  |
|       from large pool |     247    |     989    |  124418 K  |  124418 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304413 K  |  304410 K  |
|       from large pool |     247    |     989    |  124418 K  |  124418 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     619    |     619    |    1117    |     498    |
|       from large pool |     605    |     605    |    1102    |     497    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2875    |  168447 K  |  168447 K  |
|       from large pool |     110    |     508    |   82250 K  |   82250 K  |
|       from small pool |      34    |    2763    |   86197 K  |   86197 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  31208 MiB |  29038 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  31178 MiB |  29034 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |    880 TiB |    880 TiB |
|       from large pool |      0 B   |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |      0 B   |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1117    |     998    |
|       from large pool |     106    |     605    |    1102    |     996    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2875    |  168448 K  |  168448 K  |
|       from large pool |       0    |     508    |   82250 K  |   82250 K  |
|       from small pool |       0    |    2763    |   86198 K  |   86198 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  31208 MiB |  29038 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  31178 MiB |  29034 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |    880 TiB |    880 TiB |
|       from large pool |      0 B   |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |      0 B   |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1117    |     998    |
|       from large pool |     106    |     605    |    1102    |     996    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2875    |  168448 K  |  168448 K  |
|       from large pool |       0    |     508    |   82250 K  |   82250 K  |
|       from small pool |       0    |    2763    |   86198 K  |   86198 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183

 Experiment start at: 2024-06-07 18:45:47.850073
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96823657, 'precision': 0.77296054, 'recall': 0.65916264, 'specificity': 0.65916264, 'f1': 0.6996459, 'auroc': 0.94124675, 'binary_precision': 0.56962025, 'binary_recall': 0.32716456, 'binary_specificity': 0.9911607, 'binary_f1_score': 0.4156171}
confusion matrix:
       0    1
0  41937  374
1   1018  495
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.7626438, 'recall': 0.6768857, 'specificity': 0.6768857, 'f1': 0.7106143, 'auroc': 0.939556, 'binary_precision': 0.54613465, 'binary_recall': 0.36378738, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.43668994}
confusion matrix:
       0    1
0  17989  182
1    383  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.85351974, 'recall': 0.5977562, 'specificity': 0.5977562, 'f1': 0.6476836, 'auroc': 0.92231727, 'binary_precision': 0.73846155, 'binary_recall': 0.1983471, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.31270358}
confusion matrix:
      0   1
0  5980  17
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 19:03:22.964498,epoch time: 0:17:35.114425,used: 0:17:35.114425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97423786, 'precision': 0.8203442, 'recall': 0.7600967, 'specificity': 0.7600967, 'f1': 0.78680265, 'auroc': 0.95957816, 'binary_precision': 0.65737706, 'binary_recall': 0.5300727, 'binary_specificity': 0.99012077, 'binary_f1_score': 0.5869009}
confusion matrix:
       0    1
0  41893  418
1    711  802
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.78611875, 'recall': 0.7644628, 'specificity': 0.7644628, 'f1': 0.77482426, 'auroc': 0.9562398, 'binary_precision': 0.5873874, 'binary_recall': 0.5415282, 'binary_specificity': 0.9873975, 'binary_f1_score': 0.56352633}
confusion matrix:
       0    1
0  17942  229
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8049309, 'recall': 0.6009713, 'specificity': 0.6009713, 'f1': 0.6472025, 'auroc': 0.9347925, 'binary_precision': 0.64102566, 'binary_recall': 0.20661157, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3125}
confusion matrix:
      0   1
0  5969  28
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 19:20:15.076642,epoch time: 0:16:52.112144,used: 0:34:27.226569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9746714, 'precision': 0.89427745, 'recall': 0.67205465, 'specificity': 0.67205465, 'f1': 0.73656344, 'auroc': 0.96840584, 'binary_precision': 0.8114374, 'binary_recall': 0.34699273, 'binary_specificity': 0.99711657, 'binary_f1_score': 0.48611116}
confusion matrix:
       0    1
0  42189  122
1    988  525
---- Validation: 
scalar performance:
{'acc': 0.9735258, 'precision': 0.86850893, 'recall': 0.62575567, 'specificity': 0.62575567, 'f1': 0.6837723, 'auroc': 0.9656193, 'binary_precision': 0.76119405, 'binary_recall': 0.25415283, 'binary_specificity': 0.99735844, 'binary_f1_score': 0.381071}
confusion matrix:
       0    1
0  18123   48
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7311245, 'recall': 0.5138792, 'specificity': 0.5138792, 'f1': 0.5174436, 'auroc': 0.93574286, 'binary_precision': 0.5, 'binary_recall': 0.02892562, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.054687504}
confusion matrix:
      0  1
0  5990  7
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 19:37:24.969101,epoch time: 0:17:09.892459,used: 0:51:37.119028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9788244, 'precision': 0.8660536, 'recall': 0.78892016, 'specificity': 0.78892016, 'f1': 0.82255876, 'auroc': 0.9737613, 'binary_precision': 0.7468355, 'binary_recall': 0.5849306, 'binary_specificity': 0.99290967, 'binary_f1_score': 0.6560415}
confusion matrix:
       0    1
0  42011  300
1    628  885
---- Validation: 
scalar performance:
{'acc': 0.9751238, 'precision': 0.8160972, 'recall': 0.73981094, 'specificity': 0.73981094, 'f1': 0.77227414, 'auroc': 0.9667443, 'binary_precision': 0.6490066, 'binary_recall': 0.4883721, 'binary_specificity': 0.9912498, 'binary_f1_score': 0.5573459}
confusion matrix:
       0    1
0  18012  159
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8987589, 'recall': 0.608587, 'specificity': 0.608587, 'f1': 0.664987, 'auroc': 0.938231, 'binary_precision': 0.828125, 'binary_recall': 0.21900827, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34640524}
confusion matrix:
      0   1
0  5986  11
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-07 19:54:36.910729,epoch time: 0:17:11.941628,used: 1:08:49.060656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9801935, 'precision': 0.9215138, 'recall': 0.75298417, 'specificity': 0.75298417, 'f1': 0.8146759, 'auroc': 0.97681135, 'binary_precision': 0.8603352, 'binary_recall': 0.5089227, 'binary_specificity': 0.9970457, 'binary_f1_score': 0.6395349}
confusion matrix:
       0    1
0  42186  125
1    743  770
---- Validation: 
scalar performance:
{'acc': 0.97709477, 'precision': 0.87807024, 'recall': 0.6990705, 'specificity': 0.6990705, 'f1': 0.758901, 'auroc': 0.96587163, 'binary_precision': 0.775641, 'binary_recall': 0.40199336, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.5295405}
confusion matrix:
       0    1
0  18101   70
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8930843, 'recall': 0.54710376, 'specificity': 0.54710376, 'f1': 0.5760108, 'auroc': 0.9418423, 'binary_precision': 0.8214286, 'binary_recall': 0.09504132, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.17037036}
confusion matrix:
      0   1
0  5992   5
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 20:11:42.496766,epoch time: 0:17:05.586037,used: 1:25:54.646693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.982521, 'precision': 0.90867805, 'recall': 0.80772305, 'specificity': 0.80772305, 'f1': 0.8505285, 'auroc': 0.9820965, 'binary_precision': 0.8308237, 'binary_recall': 0.61996037, 'binary_specificity': 0.9954858, 'binary_f1_score': 0.7100681}
confusion matrix:
       0    1
0  42120  191
1    575  938
---- Validation: 
scalar performance:
{'acc': 0.9816225, 'precision': 0.89685833, 'recall': 0.777699, 'specificity': 0.777699, 'f1': 0.82599384, 'auroc': 0.9733051, 'binary_precision': 0.80815345, 'binary_recall': 0.5598007, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.6614328}
confusion matrix:
       0    1
0  18091   80
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7672196, 'recall': 0.524043, 'specificity': 0.524043, 'f1': 0.5358443, 'auroc': 0.94266415, 'binary_precision': 0.5714286, 'binary_recall': 0.049586777, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.091254756}
confusion matrix:
      0   1
0  5988   9
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 20:29:04.782614,epoch time: 0:17:22.285848,used: 1:43:16.932541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98261225, 'precision': 0.9353638, 'recall': 0.78355277, 'specificity': 0.78355277, 'f1': 0.84226793, 'auroc': 0.9846913, 'binary_precision': 0.8859198, 'binary_recall': 0.56972903, 'binary_specificity': 0.99737656, 'binary_f1_score': 0.6934835}
confusion matrix:
       0    1
0  42200  111
1    651  862
---- Validation: 
scalar performance:
{'acc': 0.9809833, 'precision': 0.915288, 'recall': 0.746853, 'specificity': 0.746853, 'f1': 0.80821073, 'auroc': 0.975806, 'binary_precision': 0.8470255, 'binary_recall': 0.49667773, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.62617797}
confusion matrix:
       0    1
0  18117   54
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7812822, 'recall': 0.5180948, 'specificity': 0.5180948, 'f1': 0.52524114, 'auroc': 0.9470936, 'binary_precision': 0.6, 'binary_recall': 0.037190083, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.070038915}
confusion matrix:
      0  1
0  5991  6
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_7.png
early stop counter: 1
val acc:0.980983316898346, best validation acc: 0.9816225171089172, corresponding to test acc:                         0.9616925716400146 / 0.9679436087608337
after epoch: 7,now: 2024-06-07 20:46:47.279838,epoch time: 0:17:42.497224,used: 2:00:59.429765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98441494, 'precision': 0.9423928, 'recall': 0.8080666, 'specificity': 0.8080666, 'f1': 0.8623272, 'auroc': 0.9842241, 'binary_precision': 0.8982726, 'binary_recall': 0.61863846, 'binary_specificity': 0.99749476, 'binary_f1_score': 0.73268104}
confusion matrix:
       0    1
0  42205  106
1    577  936
---- Validation: 
scalar performance:
{'acc': 0.9817824, 'precision': 0.88295746, 'recall': 0.7986608, 'specificity': 0.7986608, 'f1': 0.8351999, 'auroc': 0.9756667, 'binary_precision': 0.77896994, 'binary_recall': 0.60299003, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.6797753}
confusion matrix:
       0    1
0  18068  103
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.9292816, 'recall': 0.53495723, 'specificity': 0.53495723, 'f1': 0.5558438, 'auroc': 0.9450729, 'binary_precision': 0.8947368, 'binary_recall': 0.07024793, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13026819}
confusion matrix:
      0   1
0  5995   2
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 21:04:39.340078,epoch time: 0:17:52.060240,used: 2:18:51.490005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.983274, 'precision': 0.8931355, 'recall': 0.84252745, 'specificity': 0.84252745, 'f1': 0.86594474, 'auroc': 0.9832622, 'binary_precision': 0.7972561, 'binary_recall': 0.6913417, 'binary_specificity': 0.9937132, 'binary_f1_score': 0.7405309}
confusion matrix:
       0     1
0  42045   266
1    467  1046
---- Validation: 
scalar performance:
{'acc': 0.97826666, 'precision': 0.8474965, 'recall': 0.76873803, 'specificity': 0.76873803, 'f1': 0.8026788, 'auroc': 0.9760262, 'binary_precision': 0.7099567, 'binary_recall': 0.54485047, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.6165413}
confusion matrix:
       0    1
0  18037  134
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.8101705, 'recall': 0.62733054, 'specificity': 0.62733054, 'f1': 0.6770674, 'auroc': 0.93741345, 'binary_precision': 0.6494845, 'binary_recall': 0.2603306, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.37168145}
confusion matrix:
      0   1
0  5963  34
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_9.png
early stop counter: 1
val acc:0.9782666563987732, best validation acc: 0.9817823767662048, corresponding to test acc:                         0.9636159539222717 / 0.9679436087608337
after epoch: 9,now: 2024-06-07 21:22:16.278266,epoch time: 0:17:36.938188,used: 2:36:28.428193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98655987, 'precision': 0.9169272, 'recall': 0.8729078, 'specificity': 0.8729078, 'f1': 0.89359057, 'auroc': 0.9884784, 'binary_precision': 0.84273, 'binary_recall': 0.7508262, 'binary_specificity': 0.99498945, 'binary_f1_score': 0.79412794}
confusion matrix:
       0     1
0  42099   212
1    377  1136
---- Validation: 
scalar performance:
{'acc': 0.9837, 'precision': 0.88751614, 'recall': 0.83498555, 'specificity': 0.83498555, 'f1': 0.8591926, 'auroc': 0.9785721, 'binary_precision': 0.78571427, 'binary_recall': 0.67607975, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.7267858}
confusion matrix:
       0    1
0  18060  111
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8449062, 'recall': 0.56916404, 'specificity': 0.56916404, 'f1': 0.6085815, 'auroc': 0.94804305, 'binary_precision': 0.7234042, 'binary_recall': 0.14049587, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5984  13
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 21:39:42.121716,epoch time: 0:17:25.843450,used: 2:53:54.271643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872444, 'precision': 0.9021047, 'recall': 0.9079954, 'specificity': 0.9079954, 'f1': 0.90502673, 'auroc': 0.9903315, 'binary_precision': 0.8105469, 'binary_recall': 0.82286847, 'binary_specificity': 0.99312234, 'binary_f1_score': 0.8166612}
confusion matrix:
       0     1
0  42020   291
1    268  1245
---- Validation: 
scalar performance:
{'acc': 0.982315, 'precision': 0.8514154, 'recall': 0.87281644, 'specificity': 0.87281644, 'f1': 0.8617721, 'auroc': 0.97985554, 'binary_precision': 0.7109375, 'binary_recall': 0.75581396, 'binary_specificity': 0.98981893, 'binary_f1_score': 0.7326892}
confusion matrix:
       0    1
0  17986  185
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.8533492, 'recall': 0.63031375, 'specificity': 0.63031375, 'f1': 0.6862566, 'auroc': 0.9450345, 'binary_precision': 0.7356322, 'binary_recall': 0.2644628, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.38905773}
confusion matrix:
      0   1
0  5974  23
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_11.png
early stop counter: 1
val acc:0.9823150038719177, best validation acc: 0.9836999773979187, corresponding to test acc:                         0.9645776748657227 / 0.9679436087608337
after epoch: 11,now: 2024-06-07 21:57:06.312272,epoch time: 0:17:24.190556,used: 3:11:18.462199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98783773, 'precision': 0.9281603, 'recall': 0.88185453, 'specificity': 0.88185453, 'f1': 0.90357727, 'auroc': 0.9910662, 'binary_precision': 0.8645833, 'binary_recall': 0.76801056, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.8134406}
confusion matrix:
       0     1
0  42129   182
1    351  1162
---- Validation: 
scalar performance:
{'acc': 0.9819422, 'precision': 0.87090635, 'recall': 0.82122874, 'specificity': 0.82122874, 'f1': 0.8441423, 'auroc': 0.9789402, 'binary_precision': 0.7533719, 'binary_recall': 0.6495017, 'binary_specificity': 0.9929558, 'binary_f1_score': 0.6975915}
confusion matrix:
       0    1
0  18043  128
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.84475017, 'recall': 0.60981935, 'specificity': 0.60981935, 'f1': 0.66175395, 'auroc': 0.95522887, 'binary_precision': 0.72, 'binary_recall': 0.2231405, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.340694}
confusion matrix:
      0   1
0  5976  21
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_12.png
early stop counter: 2
val acc:0.9819421768188477, best validation acc: 0.9836999773979187, corresponding to test acc:                         0.9645776748657227 / 0.9679436087608337
after epoch: 12,now: 2024-06-07 22:14:29.743269,epoch time: 0:17:23.430997,used: 3:28:41.893196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9875639, 'precision': 0.91507864, 'recall': 0.8941402, 'specificity': 0.8941402, 'f1': 0.9043158, 'auroc': 0.9912673, 'binary_precision': 0.83751744, 'binary_recall': 0.7937872, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.81506616}
confusion matrix:
       0     1
0  42078   233
1    312  1201
---- Validation: 
scalar performance:
{'acc': 0.9826879, 'precision': 0.8640543, 'recall': 0.8529329, 'specificity': 0.8529329, 'f1': 0.8584001, 'auroc': 0.9783322, 'binary_precision': 0.7375643, 'binary_recall': 0.71428573, 'binary_specificity': 0.99158, 'binary_f1_score': 0.7257384}
confusion matrix:
       0    1
0  18018  153
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.8469665, 'recall': 0.6525408, 'specificity': 0.6525408, 'f1': 0.7086852, 'auroc': 0.947955, 'binary_precision': 0.72115386, 'binary_recall': 0.30991736, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.43352604}
confusion matrix:
      0   1
0  5968  29
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_13.png
new oracle model saved
early stop counter: 3
val acc:0.9826878905296326, best validation acc: 0.9836999773979187, corresponding to test acc:                         0.9645776748657227 / 0.9685847163200378
after epoch: 13,now: 2024-06-07 22:31:49.772568,epoch time: 0:17:20.029299,used: 3:46:01.922495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.987929, 'precision': 0.9110058, 'recall': 0.9070753, 'specificity': 0.9070753, 'f1': 0.9090303, 'auroc': 0.99210024, 'binary_precision': 0.8284379, 'binary_recall': 0.8202247, 'binary_specificity': 0.9939259, 'binary_f1_score': 0.82431084}
confusion matrix:
       0     1
0  42054   257
1    272  1241
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.87719655, 'recall': 0.8838564, 'specificity': 0.8838564, 'f1': 0.88049495, 'auroc': 0.9807974, 'binary_precision': 0.76182705, 'binary_recall': 0.77574754, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.7687243}
confusion matrix:
       0    1
0  18025  146
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.8696101, 'recall': 0.62858117, 'specificity': 0.62858117, 'f1': 0.68629897, 'auroc': 0.9504752, 'binary_precision': 0.76829267, 'binary_recall': 0.2603306, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3888889}
confusion matrix:
      0   1
0  5978  19
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 22:49:12.277618,epoch time: 0:17:22.505050,used: 4:03:24.427545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9887048, 'precision': 0.91168547, 'recall': 0.9208605, 'specificity': 0.9208605, 'f1': 0.91621804, 'auroc': 0.99335694, 'binary_precision': 0.82881135, 'binary_recall': 0.84798414, 'binary_specificity': 0.99373686, 'binary_f1_score': 0.8382881}
confusion matrix:
       0     1
0  42046   265
1    230  1283
---- Validation: 
scalar performance:
{'acc': 0.9835402, 'precision': 0.86539185, 'recall': 0.8718432, 'specificity': 0.8718432, 'f1': 0.8685869, 'auroc': 0.9818102, 'binary_precision': 0.7389886, 'binary_recall': 0.7524917, 'binary_specificity': 0.9911948, 'binary_f1_score': 0.745679}
confusion matrix:
       0    1
0  18011  160
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.87217915, 'recall': 0.5714803, 'specificity': 0.5714803, 'f1': 0.6130512, 'auroc': 0.9493092, 'binary_precision': 0.7777778, 'binary_recall': 0.1446281, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.24390242}
confusion matrix:
      0   1
0  5987  10
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_15.png
early stop counter: 1
val acc:0.9835401773452759, best validation acc: 0.9850317239761353, corresponding to test acc:                         0.9682641625404358 / 0.9685847163200378
after epoch: 15,now: 2024-06-07 23:06:32.046529,epoch time: 0:17:19.768911,used: 4:20:44.196456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98938936, 'precision': 0.9451948, 'recall': 0.8890312, 'specificity': 0.8890312, 'f1': 0.91507435, 'auroc': 0.99296206, 'binary_precision': 0.8981763, 'binary_recall': 0.7812293, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.83563095}
confusion matrix:
       0     1
0  42177   134
1    331  1182
---- Validation: 
scalar performance:
{'acc': 0.98572415, 'precision': 0.8984865, 'recall': 0.8625318, 'specificity': 0.8625318, 'f1': 0.87959373, 'auroc': 0.9807507, 'binary_precision': 0.8058608, 'binary_recall': 0.730897, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.7665505}
confusion matrix:
       0    1
0  18065  106
1    162  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8137794, 'recall': 0.5748622, 'specificity': 0.5748622, 'f1': 0.6149657, 'auroc': 0.9364927, 'binary_precision': 0.66071427, 'binary_recall': 0.15289256, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5978  19
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_16.png
better model found
persisted
after epoch: 16,now: 2024-06-07 23:23:55.899607,epoch time: 0:17:23.853078,used: 4:38:08.049534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9905075, 'precision': 0.9439906, 'recall': 0.9093666, 'specificity': 0.9093666, 'f1': 0.9259202, 'auroc': 0.99445057, 'binary_precision': 0.8943206, 'binary_recall': 0.8222075, 'binary_specificity': 0.9965257, 'binary_f1_score': 0.85674924}
confusion matrix:
       0     1
0  42164   147
1    269  1244
---- Validation: 
scalar performance:
{'acc': 0.9872689, 'precision': 0.9057549, 'recall': 0.884209, 'specificity': 0.884209, 'f1': 0.89466524, 'auroc': 0.98139536, 'binary_precision': 0.8189807, 'binary_recall': 0.77408636, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.79590094}
confusion matrix:
       0    1
0  18068  103
1    136  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.86634433, 'recall': 0.573463, 'specificity': 0.573463, 'f1': 0.61566603, 'auroc': 0.93450874, 'binary_precision': 0.7659575, 'binary_recall': 0.14876033, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.24913496}
confusion matrix:
      0   1
0  5986  11
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 23:41:39.404261,epoch time: 0:17:43.504654,used: 4:55:51.554188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9898914, 'precision': 0.93149745, 'recall': 0.914146, 'specificity': 0.914146, 'f1': 0.9226291, 'auroc': 0.9943186, 'binary_precision': 0.8689655, 'binary_recall': 0.83278257, 'binary_specificity': 0.99550945, 'binary_f1_score': 0.8504894}
confusion matrix:
       0     1
0  42121   190
1    253  1260
---- Validation: 
scalar performance:
{'acc': 0.9816225, 'precision': 0.85922897, 'recall': 0.8355185, 'specificity': 0.8355185, 'f1': 0.8469355, 'auroc': 0.9789679, 'binary_precision': 0.7290553, 'binary_recall': 0.679402, 'binary_specificity': 0.991635, 'binary_f1_score': 0.7033534}
confusion matrix:
       0    1
0  18019  152
1    193  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8483065, 'recall': 0.587509, 'specificity': 0.587509, 'f1': 0.63402903, 'auroc': 0.93930197, 'binary_precision': 0.7288136, 'binary_recall': 0.17768595, 'binary_specificity': 0.997332, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5981  16
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_18.png
early stop counter: 1
val acc:0.9816225171089172, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 18,now: 2024-06-07 23:59:27.218243,epoch time: 0:17:47.813982,used: 5:13:39.368170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9912377, 'precision': 0.9466286, 'recall': 0.918667, 'specificity': 0.918667, 'f1': 0.9321599, 'auroc': 0.9953009, 'binary_precision': 0.8989399, 'binary_recall': 0.8407138, 'binary_specificity': 0.99662024, 'binary_f1_score': 0.86885244}
confusion matrix:
       0     1
0  42168   143
1    241  1272
---- Validation: 
scalar performance:
{'acc': 0.98529804, 'precision': 0.87950826, 'recall': 0.8856001, 'specificity': 0.8856001, 'f1': 0.8825279, 'auroc': 0.97995645, 'binary_precision': 0.7663399, 'binary_recall': 0.7790698, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.7726524}
confusion matrix:
       0    1
0  18028  143
1    133  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.9021315, 'recall': 0.58404374, 'specificity': 0.58404374, 'f1': 0.6323188, 'auroc': 0.94301784, 'binary_precision': 0.8367347, 'binary_recall': 0.1694215, 'binary_specificity': 0.998666, 'binary_f1_score': 0.28178695}
confusion matrix:
      0   1
0  5989   8
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_19.png
early stop counter: 2
val acc:0.9852980375289917, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 19,now: 2024-06-08 00:16:41.862625,epoch time: 0:17:14.644382,used: 5:30:54.012552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9897545, 'precision': 0.97233194, 'recall': 0.8688265, 'specificity': 0.8688265, 'f1': 0.91374505, 'auroc': 0.9954787, 'binary_precision': 0.9539249, 'binary_recall': 0.7389293, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.8327747}
confusion matrix:
       0     1
0  42257    54
1    395  1118
---- Validation: 
scalar performance:
{'acc': 0.9861503, 'precision': 0.93038166, 'recall': 0.83143306, 'specificity': 0.83143306, 'f1': 0.8740263, 'auroc': 0.9786384, 'binary_precision': 0.87173915, 'binary_recall': 0.66611296, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.7551789}
confusion matrix:
       0    1
0  18112   59
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.84485024, 'recall': 0.5162788, 'specificity': 0.5162788, 'f1': 0.5219273, 'auroc': 0.93793124, 'binary_precision': 0.72727275, 'binary_recall': 0.03305785, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0632411}
confusion matrix:
      0  1
0  5994  3
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_20.png
early stop counter: 3
val acc:0.986150324344635, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 20,now: 2024-06-08 00:33:54.929511,epoch time: 0:17:13.066886,used: 5:48:07.079438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9915571, 'precision': 0.94542944, 'recall': 0.9255242, 'specificity': 0.9255242, 'f1': 0.93523103, 'auroc': 0.99608743, 'binary_precision': 0.8960499, 'binary_recall': 0.8545935, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.87483084}
confusion matrix:
       0     1
0  42161   150
1    220  1293
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.8870394, 'recall': 0.8777071, 'specificity': 0.8777071, 'f1': 0.88231176, 'auroc': 0.98084235, 'binary_precision': 0.78194207, 'binary_recall': 0.76245844, 'binary_specificity': 0.9929558, 'binary_f1_score': 0.7720774}
confusion matrix:
       0    1
0  18043  128
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9128833, 'recall': 0.59850657, 'specificity': 0.59850657, 'f1': 0.6527815, 'auroc': 0.9416587, 'binary_precision': 0.85714287, 'binary_recall': 0.1983471, 'binary_specificity': 0.998666, 'binary_f1_score': 0.32214764}
confusion matrix:
      0   1
0  5989   8
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_21.png
early stop counter: 4
val acc:0.9855643510818481, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 21,now: 2024-06-08 00:51:08.192560,epoch time: 0:17:13.263049,used: 6:05:20.342487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9913518, 'precision': 0.9521334, 'recall': 0.914265, 'specificity': 0.914265, 'f1': 0.9323064, 'auroc': 0.995986, 'binary_precision': 0.910275, 'binary_recall': 0.83146065, 'binary_specificity': 0.9970693, 'binary_f1_score': 0.8690846}
confusion matrix:
       0     1
0  42187   124
1    255  1258
---- Validation: 
scalar performance:
{'acc': 0.98625684, 'precision': 0.9065802, 'recall': 0.8620039, 'specificity': 0.8620039, 'f1': 0.8829007, 'auroc': 0.97966754, 'binary_precision': 0.82209736, 'binary_recall': 0.7292359, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.77288735}
confusion matrix:
       0    1
0  18076   95
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8637223, 'recall': 0.5713969, 'specificity': 0.5713969, 'f1': 0.612586, 'auroc': 0.93394166, 'binary_precision': 0.76086956, 'binary_recall': 0.1446281, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.24305555}
confusion matrix:
      0   1
0  5986  11
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_22.png
early stop counter: 5
val acc:0.9862568378448486, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 22,now: 2024-06-08 01:08:19.219002,epoch time: 0:17:11.026442,used: 6:22:31.368929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921504, 'precision': 0.960904, 'recall': 0.9178651, 'specificity': 0.9178651, 'f1': 0.93824875, 'auroc': 0.99665475, 'binary_precision': 0.9275786, 'binary_recall': 0.83807003, 'binary_specificity': 0.99766016, 'binary_f1_score': 0.88055557}
confusion matrix:
       0     1
0  42212    99
1    245  1268
---- Validation: 
scalar performance:
{'acc': 0.9871624, 'precision': 0.91630214, 'recall': 0.86728996, 'specificity': 0.86728996, 'f1': 0.89014804, 'auroc': 0.9809895, 'binary_precision': 0.8412098, 'binary_recall': 0.7392027, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.7869142}
confusion matrix:
       0    1
0  18087   84
1    157  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8392713, 'recall': 0.5406553, 'specificity': 0.5406553, 'f1': 0.564654, 'auroc': 0.9344814, 'binary_precision': 0.71428573, 'binary_recall': 0.08264463, 'binary_specificity': 0.998666, 'binary_f1_score': 0.14814815}
confusion matrix:
      0   1
0  5989   8
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_23.png
early stop counter: 6
val acc:0.9871624112129211, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 23,now: 2024-06-08 01:25:30.995118,epoch time: 0:17:11.776116,used: 6:39:43.145045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99221885, 'precision': 0.97381675, 'recall': 0.9061104, 'specificity': 0.9061104, 'f1': 0.93716276, 'auroc': 0.99689525, 'binary_precision': 0.95426357, 'binary_recall': 0.8136153, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.87834466}
confusion matrix:
       0     1
0  42252    59
1    282  1231
---- Validation: 
scalar performance:
{'acc': 0.9868961, 'precision': 0.91988295, 'recall': 0.8575158, 'specificity': 0.8575158, 'f1': 0.8860125, 'auroc': 0.98116773, 'binary_precision': 0.8490196, 'binary_recall': 0.7192691, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.77877694}
confusion matrix:
       0    1
0  18094   77
1    169  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.87048113, 'recall': 0.56329924, 'specificity': 0.56329924, 'f1': 0.6009097, 'auroc': 0.93795294, 'binary_precision': 0.775, 'binary_recall': 0.12809917, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21985814}
confusion matrix:
      0   1
0  5988   9
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_24.png
early stop counter: 7
val acc:0.9868960976600647, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 24,now: 2024-06-08 01:42:42.873164,epoch time: 0:17:11.878046,used: 6:56:55.023091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9913746, 'precision': 0.92303956, 'recall': 0.95315236, 'specificity': 0.95315236, 'f1': 0.9375341, 'auroc': 0.9963237, 'binary_precision': 0.84923077, 'binary_recall': 0.9120952, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.8795411}
confusion matrix:
       0     1
0  42066   245
1    133  1380
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.86467505, 'recall': 0.90376747, 'specificity': 0.90376747, 'f1': 0.8831409, 'auroc': 0.98041683, 'binary_precision': 0.735426, 'binary_recall': 0.81727576, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.7741936}
confusion matrix:
       0    1
0  17994  177
1    110  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.8681009, 'recall': 0.62651503, 'specificity': 0.62651503, 'f1': 0.6837645, 'auroc': 0.92846906, 'binary_precision': 0.7654321, 'binary_recall': 0.25619835, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3839009}
confusion matrix:
      0   1
0  5978  19
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_25.png
early stop counter: 8
val acc:0.9847120642662048, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 25,now: 2024-06-08 01:59:53.676634,epoch time: 0:17:10.803470,used: 7:14:05.826561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9916712, 'precision': 0.9600934, 'recall': 0.91092527, 'specificity': 0.91092527, 'f1': 0.9340141, 'auroc': 0.9970869, 'binary_precision': 0.92644876, 'binary_recall': 0.8241904, 'binary_specificity': 0.99766016, 'binary_f1_score': 0.87233293}
confusion matrix:
       0     1
0  42212    99
1    266  1247
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.89286923, 'recall': 0.8491602, 'specificity': 0.8491602, 'f1': 0.8696271, 'auroc': 0.98126715, 'binary_precision': 0.7954972, 'binary_recall': 0.70431894, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.74713653}
confusion matrix:
       0    1
0  18062  109
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8611259, 'recall': 0.5571009, 'specificity': 0.5571009, 'f1': 0.59121835, 'auroc': 0.92675483, 'binary_precision': 0.7567568, 'binary_recall': 0.11570248, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.20071684}
confusion matrix:
      0   1
0  5988   9
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_26.png
early stop counter: 9
val acc:0.9847120642662048, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 26,now: 2024-06-08 02:17:03.970371,epoch time: 0:17:10.293737,used: 7:31:16.120298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99256116, 'precision': 0.9511503, 'recall': 0.9356037, 'specificity': 0.9356037, 'f1': 0.9432298, 'auroc': 0.9970081, 'binary_precision': 0.9067855, 'binary_recall': 0.87442166, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.8903096}
confusion matrix:
       0     1
0  42175   136
1    190  1323
---- Validation: 
scalar performance:
{'acc': 0.9860438, 'precision': 0.89812994, 'recall': 0.8699243, 'specificity': 0.8699243, 'f1': 0.8834686, 'auroc': 0.97933614, 'binary_precision': 0.8046595, 'binary_recall': 0.74584717, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.7741379}
confusion matrix:
       0    1
0  18062  109
1    153  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.9319906, 'recall': 0.53702337, 'specificity': 0.53702337, 'f1': 0.5594521, 'auroc': 0.93201494, 'binary_precision': 0.9, 'binary_recall': 0.07438017, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13740458}
confusion matrix:
      0   1
0  5995   2
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_27.png
early stop counter: 10
val acc:0.9860438108444214, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 27,now: 2024-06-08 02:34:11.817969,epoch time: 0:17:07.847598,used: 7:48:23.967896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98984575, 'precision': 0.90889466, 'recall': 0.9475808, 'specificity': 0.9475808, 'f1': 0.9272872, 'auroc': 0.9966485, 'binary_precision': 0.8212996, 'binary_recall': 0.9021811, 'binary_specificity': 0.99298054, 'binary_f1_score': 0.8598425}
confusion matrix:
       0     1
0  42014   297
1    148  1365
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.87923205, 'recall': 0.8798411, 'specificity': 0.8798411, 'f1': 0.8795363, 'auroc': 0.98208296, 'binary_precision': 0.76616913, 'binary_recall': 0.76744187, 'binary_specificity': 0.99224037, 'binary_f1_score': 0.76680493}
confusion matrix:
       0    1
0  18030  141
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.86159694, 'recall': 0.5448709, 'specificity': 0.5448709, 'f1': 0.5718829, 'auroc': 0.9254739, 'binary_precision': 0.7586207, 'binary_recall': 0.09090909, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16236164}
confusion matrix:
      0   1
0  5990   7
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_28.png
early stop counter: 11
val acc:0.9850317239761353, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 28,now: 2024-06-08 02:51:17.169774,epoch time: 0:17:05.351805,used: 8:05:29.319701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9925155, 'precision': 0.9705496, 'recall': 0.9139117, 'specificity': 0.9139117, 'f1': 0.94027907, 'auroc': 0.9977051, 'binary_precision': 0.94716984, 'binary_recall': 0.82947785, 'binary_specificity': 0.9983456, 'binary_f1_score': 0.88442564}
confusion matrix:
       0     1
0  42241    70
1    258  1255
---- Validation: 
scalar performance:
{'acc': 0.985884, 'precision': 0.9125142, 'recall': 0.8465533, 'specificity': 0.8465533, 'f1': 0.8764545, 'auroc': 0.9802791, 'binary_precision': 0.8349901, 'binary_recall': 0.6976744, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.76018095}
confusion matrix:
       0    1
0  18088   83
1    182  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.78950465, 'recall': 0.5322241, 'specificity': 0.5322241, 'f1': 0.55003726, 'auroc': 0.9349034, 'binary_precision': 0.61538464, 'binary_recall': 0.0661157, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.11940298}
confusion matrix:
      0   1
0  5987  10
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_29.png
early stop counter: 12
val acc:0.9858840107917786, best validation acc: 0.9872689247131348, corresponding to test acc:                         0.9652187824249268 / 0.9685847163200378
after epoch: 29,now: 2024-06-08 03:08:15.463785,epoch time: 0:16:58.294011,used: 8:22:27.613712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9939303, 'precision': 0.9640609, 'recall': 0.9433231, 'specificity': 0.9433231, 'f1': 0.9534364, 'auroc': 0.99825424, 'binary_precision': 0.93208593, 'binary_recall': 0.8889623, 'binary_specificity': 0.9976838, 'binary_f1_score': 0.9100135}
confusion matrix:
       0     1
0  42213    98
1    168  1345
---- Validation: 
scalar performance:
{'acc': 0.9873222, 'precision': 0.9109036, 'recall': 0.87781215, 'specificity': 0.87781215, 'f1': 0.8936105, 'auroc': 0.983155, 'binary_precision': 0.8297101, 'binary_recall': 0.7607973, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.79376084}
confusion matrix:
       0    1
0  18077   94
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8827531, 'recall': 0.5572676, 'specificity': 0.5572676, 'f1': 0.59202635, 'auroc': 0.91839963, 'binary_precision': 0.8, 'binary_recall': 0.11570248, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20216607}
confusion matrix:
      0   1
0  5990   7
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170183_30.png
better model found
persisted
after epoch: 30,now: 2024-06-08 03:25:20.151418,epoch time: 0:17:04.687633,used: 8:39:32.301345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_45_47_seed_2_21170183
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:39:32.301345 at 2024-06-08 03:25:20.151418
persisted model performance metric: 

scalar performance:
{'acc': 0.9626543, 'precision': 0.8388894, 'recall': 0.5304915, 'specificity': 0.5304915, 'f1': 0.54749674, 'auroc': 0.9269029, 'binary_precision': 0.71428573, 'binary_recall': 0.06198347, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11406844}
confusion matrix:
      0   1
0  5991   6
1   227  15
oracle model performance metric: 

scalar performance:
{'acc': 0.967623, 'precision': 0.8400042, 'recall': 0.63816136, 'specificity': 0.63816136, 'f1': 0.6928638, 'auroc': 0.94456095, 'binary_precision': 0.7083333, 'binary_recall': 0.28099173, 'binary_specificity': 0.995331, 'binary_f1_score': 0.40236688}
confusion matrix:
      0   1
0  5969  28
1   174  68
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      6 MiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      6 MiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   3124 TiB |   3124 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   3087 TiB |   3087 TiB |
|       from small pool |      5 MiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16700 MiB |  16700 MiB |  45738 MiB |  29038 MiB |
|       from large pool |  16672 MiB |  16672 MiB |  45706 MiB |  29034 MiB |
|       from small pool |     28 MiB |     28 MiB |     32 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474660 KiB |    851 MiB |   1304 TiB |   1304 TiB |
|       from large pool | 454720 KiB |    848 MiB |   1266 TiB |   1266 TiB |
|       from small pool |  19940 KiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3354    |    6365    |  456175 K  |  456171 K  |
|       from large pool |     247    |     989    |  186385 K  |  186385 K  |
|       from small pool |    3107    |    6116    |  269789 K  |  269786 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3354    |    6365    |  456175 K  |  456171 K  |
|       from large pool |     247    |     989    |  186385 K  |  186385 K  |
|       from small pool |    3107    |    6116    |  269789 K  |  269786 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     619    |     619    |    1617    |     998    |
|       from large pool |     605    |     605    |    1601    |     996    |
|       from small pool |      14    |      14    |      16    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |    2875    |  252750 K  |  252750 K  |
|       from large pool |     110    |     508    |  123539 K  |  123539 K  |
|       from small pool |      35    |    2763    |  129211 K  |  129211 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      0 KiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      0 KiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   3124 TiB |   3124 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   3087 TiB |   3087 TiB |
|       from small pool |      0 KiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  45738 MiB |  43568 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  45706 MiB |  43562 MiB |
|       from small pool |     26 MiB |     28 MiB |     32 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |   1304 TiB |   1304 TiB |
|       from large pool |      0 B   |    848 MiB |   1266 TiB |   1266 TiB |
|       from small pool |      0 B   |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  456175 K  |  456175 K  |
|       from large pool |       2    |     989    |  186385 K  |  186385 K  |
|       from small pool |       0    |    6116    |  269789 K  |  269789 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  456175 K  |  456175 K  |
|       from large pool |       2    |     989    |  186385 K  |  186385 K  |
|       from small pool |       0    |    6116    |  269789 K  |  269789 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1617    |    1498    |
|       from large pool |     106    |     605    |    1601    |    1495    |
|       from small pool |      13    |      14    |      16    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2875    |  252752 K  |  252752 K  |
|       from large pool |       0    |     508    |  123539 K  |  123539 K  |
|       from small pool |       0    |    2763    |  129212 K  |  129212 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 03:27:02 2024]
Finished job 0.
1 of 1 steps (100%) done
