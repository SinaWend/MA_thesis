Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:39:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158

 Experiment start at: 2024-06-08 23:45:45.093105
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.7715616, 'recall': 0.7603261, 'specificity': 0.7603261, 'f1': 0.76581275, 'auroc': 0.9483736, 'binary_precision': 0.55926186, 'binary_recall': 0.53532606, 'binary_specificity': 0.9853261, 'binary_f1_score': 0.54703224}
confusion matrix:
       0    1
0  41699  621
1    684  788
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7511972, 'recall': 0.7534573, 'specificity': 0.7534573, 'f1': 0.7523216, 'auroc': 0.9460207, 'binary_precision': 0.5192604, 'binary_recall': 0.5241057, 'binary_specificity': 0.98280895, 'binary_f1_score': 0.5216718}
confusion matrix:
       0    1
0  17837  312
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.9115437, 'recall': 0.7565363, 'specificity': 0.7565363, 'f1': 0.81442285, 'auroc': 0.93074363, 'binary_precision': 0.84375, 'binary_recall': 0.51724136, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6413302}
confusion matrix:
      0    1
0  5972   25
1   126  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:25:13.931403,epoch time: 0:39:28.838298,used: 0:39:28.838298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9726891, 'precision': 0.79192626, 'recall': 0.77735114, 'specificity': 0.77735114, 'f1': 0.7844335, 'auroc': 0.9624871, 'binary_precision': 0.5988539, 'binary_recall': 0.5679348, 'binary_specificity': 0.9867675, 'binary_f1_score': 0.5829847}
confusion matrix:
       0    1
0  41760  560
1    636  836
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.7825359, 'recall': 0.7727749, 'specificity': 0.7727749, 'f1': 0.7775606, 'auroc': 0.95801497, 'binary_precision': 0.58064514, 'binary_recall': 0.5598756, 'binary_specificity': 0.98567414, 'binary_f1_score': 0.5700713}
confusion matrix:
       0    1
0  17889  260
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.85499394, 'recall': 0.57737684, 'specificity': 0.57737684, 'f1': 0.62015665, 'auroc': 0.93762755, 'binary_precision': 0.74545455, 'binary_recall': 0.15708812, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.25949365}
confusion matrix:
      0   1
0  5983  14
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 01:03:12.506737,epoch time: 0:37:58.575334,used: 1:17:27.413632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97721046, 'precision': 0.8564182, 'recall': 0.7524781, 'specificity': 0.7524781, 'f1': 0.7948538, 'auroc': 0.9712204, 'binary_precision': 0.72965115, 'binary_recall': 0.51154894, 'binary_specificity': 0.99340737, 'binary_f1_score': 0.6014377}
confusion matrix:
       0    1
0  42041  279
1    719  753
---- Validation: 
scalar performance:
{'acc': 0.9770115, 'precision': 0.8641655, 'recall': 0.74583066, 'specificity': 0.74583066, 'f1': 0.7925916, 'auroc': 0.9660459, 'binary_precision': 0.7459207, 'binary_recall': 0.4976672, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.5970149}
confusion matrix:
       0    1
0  18040  109
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.93728775, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 01:41:24.637171,epoch time: 0:38:12.130434,used: 1:55:39.544066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98052156, 'precision': 0.87015617, 'recall': 0.8088164, 'specificity': 0.8088164, 'f1': 0.8364848, 'auroc': 0.97789, 'binary_precision': 0.7532787, 'binary_recall': 0.6247451, 'binary_specificity': 0.9928877, 'binary_f1_score': 0.68301743}
confusion matrix:
       0    1
0  42020  301
1    552  919
---- Validation: 
scalar performance:
{'acc': 0.9795658, 'precision': 0.8647184, 'recall': 0.80415726, 'specificity': 0.80415726, 'f1': 0.8314611, 'auroc': 0.971026, 'binary_precision': 0.7429643, 'binary_recall': 0.61586314, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.67346936}
confusion matrix:
       0    1
0  18012  137
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.9453198, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 02:19:36.601325,epoch time: 0:38:11.964154,used: 2:33:51.508220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98154914, 'precision': 0.86637664, 'recall': 0.83986044, 'specificity': 0.83986044, 'f1': 0.85257775, 'auroc': 0.9775068, 'binary_precision': 0.7435709, 'binary_recall': 0.68796736, 'binary_specificity': 0.9917535, 'binary_f1_score': 0.7146892}
confusion matrix:
       0     1
0  41972   349
1    459  1012
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.8658762, 'recall': 0.8295152, 'specificity': 0.8295152, 'f1': 0.84666187, 'auroc': 0.97229743, 'binary_precision': 0.7435009, 'binary_recall': 0.66718507, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.70327866}
confusion matrix:
       0    1
0  18001  148
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9580296, 'recall': 0.54014647, 'specificity': 0.54014647, 'f1': 0.56435454, 'auroc': 0.9442576, 'binary_precision': 0.95454544, 'binary_recall': 0.08045977, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.14840989}
confusion matrix:
      0   1
0  5996   1
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 02:57:41.346267,epoch time: 0:38:04.744942,used: 3:11:56.253162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9830106, 'precision': 0.9017478, 'recall': 0.81678873, 'specificity': 0.81678873, 'f1': 0.85385317, 'auroc': 0.9830414, 'binary_precision': 0.8159722, 'binary_recall': 0.63858694, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.7164634}
confusion matrix:
       0    1
0  42108  212
1    532  940
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.91465193, 'recall': 0.7920062, 'specificity': 0.7920062, 'f1': 0.8418813, 'auroc': 0.9751227, 'binary_precision': 0.84375, 'binary_recall': 0.58786935, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.69294226}
confusion matrix:
       0    1
0  18079   70
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8486262, 'recall': 0.52640307, 'specificity': 0.52640307, 'f1': 0.5397025, 'auroc': 0.9401883, 'binary_precision': 0.7368421, 'binary_recall': 0.053639848, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5992   5
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 03:36:12.250886,epoch time: 0:38:30.904619,used: 3:50:27.157781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.88908356, 'recall': 0.8529862, 'specificity': 0.8529862, 'f1': 0.87008417, 'auroc': 0.9837175, 'binary_precision': 0.7881292, 'binary_recall': 0.7126359, 'binary_specificity': 0.9933365, 'binary_f1_score': 0.7484838}
confusion matrix:
       0     1
0  42038   282
1    423  1049
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.8952727, 'recall': 0.836838, 'specificity': 0.836838, 'f1': 0.8635315, 'auroc': 0.97525036, 'binary_precision': 0.8018349, 'binary_recall': 0.67962676, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7356903}
confusion matrix:
       0    1
0  18041  108
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.870165, 'recall': 0.55297285, 'specificity': 0.55297285, 'f1': 0.58441436, 'auroc': 0.9521506, 'binary_precision': 0.7777778, 'binary_recall': 0.107279696, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5989   8
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 04:14:20.765732,epoch time: 0:38:08.514846,used: 4:28:35.672627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9843807, 'precision': 0.87988245, 'recall': 0.8793839, 'specificity': 0.8793839, 'f1': 0.87963295, 'auroc': 0.9852736, 'binary_precision': 0.7678693, 'binary_recall': 0.7668253, 'binary_specificity': 0.9919425, 'binary_f1_score': 0.76734686}
confusion matrix:
       0     1
0  41980   341
1    343  1128
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.88240725, 'recall': 0.8709211, 'specificity': 0.8709211, 'f1': 0.876569, 'auroc': 0.9770619, 'binary_precision': 0.77367574, 'binary_recall': 0.7496112, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.7614534}
confusion matrix:
       0    1
0  18008  141
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.89502543, 'recall': 0.58920455, 'specificity': 0.58920455, 'f1': 0.6386169, 'auroc': 0.9450196, 'binary_precision': 0.8245614, 'binary_recall': 0.18007663, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2955975}
confusion matrix:
      0   1
0  5987  10
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 04:52:53.234015,epoch time: 0:38:32.468283,used: 5:07:08.140910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.985865, 'precision': 0.92086655, 'recall': 0.84832704, 'specificity': 0.84832704, 'f1': 0.8809126, 'auroc': 0.9863157, 'binary_precision': 0.8520661, 'binary_recall': 0.70088375, 'binary_specificity': 0.9957704, 'binary_f1_score': 0.7691159}
confusion matrix:
       0     1
0  42142   179
1    440  1031
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9191567, 'recall': 0.8214725, 'specificity': 0.8214725, 'f1': 0.86337614, 'auroc': 0.97708094, 'binary_precision': 0.85071576, 'binary_recall': 0.64696735, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.7349823}
confusion matrix:
       0    1
0  18076   73
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.929835, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_9.png
better model found
persisted
after epoch: 9,now: 2024-06-09 05:31:21.933324,epoch time: 0:38:28.699309,used: 5:45:36.840219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9857737, 'precision': 0.9111514, 'recall': 0.8588729, 'specificity': 0.8588729, 'f1': 0.8830965, 'auroc': 0.9884157, 'binary_precision': 0.83189994, 'binary_recall': 0.72282606, 'binary_specificity': 0.99491966, 'binary_f1_score': 0.77353686}
confusion matrix:
       0     1
0  42105   215
1    408  1064
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.8975444, 'recall': 0.8315325, 'specificity': 0.8315325, 'f1': 0.86130655, 'auroc': 0.975842, 'binary_precision': 0.80675423, 'binary_recall': 0.6687403, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.73129255}
confusion matrix:
       0    1
0  18046  103
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.93186474, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_10.png
early stop counter: 1
val acc:0.9831843376159668, best validation acc: 0.9840357303619385, corresponding to test acc:                         0.9587727785110474 / 0.9758709073066711
after epoch: 10,now: 2024-06-09 06:09:53.042642,epoch time: 0:38:31.109318,used: 6:24:07.949537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9869839, 'precision': 0.94489914, 'recall': 0.8431061, 'specificity': 0.8431061, 'f1': 0.88694674, 'auroc': 0.9895874, 'binary_precision': 0.90053284, 'binary_recall': 0.6888587, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.7806005}
confusion matrix:
       0     1
0  42208   112
1    458  1014
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9437872, 'recall': 0.8152455, 'specificity': 0.8152455, 'f1': 0.867839, 'auroc': 0.9776573, 'binary_precision': 0.9004425, 'binary_recall': 0.63297045, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.743379}
confusion matrix:
       0    1
0  18104   45
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.92124915, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 06:48:21.570475,epoch time: 0:38:28.527833,used: 7:02:36.477370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98780596, 'precision': 0.9197831, 'recall': 0.8860774, 'specificity': 0.8860774, 'f1': 0.9021692, 'auroc': 0.99042237, 'binary_precision': 0.8472943, 'binary_recall': 0.7770224, 'binary_specificity': 0.99513245, 'binary_f1_score': 0.81063825}
confusion matrix:
       0     1
0  42115   206
1    328  1143
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9186803, 'recall': 0.8631326, 'specificity': 0.8631326, 'f1': 0.8887752, 'auroc': 0.9787059, 'binary_precision': 0.8468468, 'binary_recall': 0.7309487, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7846411}
confusion matrix:
       0    1
0  18064   85
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.9349154, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 07:26:50.716682,epoch time: 0:38:29.146207,used: 7:41:05.623577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9880572, 'precision': 0.9218172, 'recall': 0.88825023, 'specificity': 0.88825023, 'f1': 0.90428287, 'auroc': 0.99257654, 'binary_precision': 0.8512213, 'binary_recall': 0.78125, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.81473607}
confusion matrix:
       0     1
0  42119   201
1    322  1150
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9134046, 'recall': 0.8629398, 'specificity': 0.8629398, 'f1': 0.88639927, 'auroc': 0.9785385, 'binary_precision': 0.83629894, 'binary_recall': 0.7309487, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.78008294}
confusion matrix:
       0    1
0  18057   92
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8956452, 'recall': 0.5550553, 'specificity': 0.5550553, 'f1': 0.58823484, 'auroc': 0.9257007, 'binary_precision': 0.82857144, 'binary_recall': 0.11111111, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5991   6
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_13.png
early stop counter: 1
val acc:0.9858982563018799, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9595717191696167 / 0.9758709073066711
after epoch: 13,now: 2024-06-09 08:05:19.591138,epoch time: 0:38:28.874456,used: 8:19:34.498033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98792017, 'precision': 0.8986023, 'recall': 0.92129314, 'specificity': 0.92129314, 'f1': 0.9096069, 'auroc': 0.99251246, 'binary_precision': 0.8024375, 'binary_recall': 0.8498641, 'binary_specificity': 0.9927221, 'binary_f1_score': 0.8254702}
confusion matrix:
       0     1
0  42012   308
1    221  1251
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8887645, 'recall': 0.900415, 'specificity': 0.900415, 'f1': 0.8944962, 'auroc': 0.9810815, 'binary_precision': 0.78431374, 'binary_recall': 0.8087092, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.7963247}
confusion matrix:
       0    1
0  18006  143
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8916132, 'recall': 0.5436444, 'specificity': 0.5436444, 'f1': 0.5696478, 'auroc': 0.9353831, 'binary_precision': 0.8214286, 'binary_recall': 0.08812261, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5992   5
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_14.png
early stop counter: 2
val acc:0.9858450293540955, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9595717191696167 / 0.9758709073066711
after epoch: 14,now: 2024-06-09 08:43:23.259365,epoch time: 0:38:03.668227,used: 8:57:38.166260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9868926, 'precision': 0.8855099, 'recall': 0.9243195, 'specificity': 0.9243195, 'f1': 0.9039028, 'auroc': 0.993407, 'binary_precision': 0.776, 'binary_recall': 0.85723996, 'binary_specificity': 0.99139905, 'binary_f1_score': 0.8145995}
confusion matrix:
       0     1
0  41957   364
1    210  1261
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.85790664, 'recall': 0.9065105, 'specificity': 0.9065105, 'f1': 0.8805171, 'auroc': 0.98112375, 'binary_precision': 0.7220709, 'binary_recall': 0.82426125, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.7697894}
confusion matrix:
       0    1
0  17945  204
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8668101, 'recall': 0.57562786, 'specificity': 0.57562786, 'f1': 0.6182487, 'auroc': 0.9414936, 'binary_precision': 0.7692308, 'binary_recall': 0.1532567, 'binary_specificity': 0.997999, 'binary_f1_score': 0.25559103}
confusion matrix:
      0   1
0  5985  12
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_15.png
early stop counter: 3
val acc:0.9831311106681824, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9595717191696167 / 0.9758709073066711
after epoch: 15,now: 2024-06-09 09:21:54.729288,epoch time: 0:38:31.469923,used: 9:36:09.636183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.96185756, 'recall': 0.87371516, 'specificity': 0.87371516, 'f1': 0.9127992, 'auroc': 0.99380857, 'binary_precision': 0.9323753, 'binary_recall': 0.7493206, 'binary_specificity': 0.99810964, 'binary_f1_score': 0.8308851}
confusion matrix:
       0     1
0  42240    80
1    369  1103
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9359299, 'recall': 0.8389931, 'specificity': 0.8389931, 'f1': 0.8809397, 'auroc': 0.98218954, 'binary_precision': 0.8830645, 'binary_recall': 0.68118197, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7690957}
confusion matrix:
       0    1
0  18091   58
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.9161905, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_16.png
early stop counter: 4
val acc:0.9860047101974487, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9595717191696167 / 0.9758709073066711
after epoch: 16,now: 2024-06-09 10:00:01.412246,epoch time: 0:38:06.682958,used: 10:14:16.319141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989884, 'precision': 0.949849, 'recall': 0.887884, 'specificity': 0.887884, 'f1': 0.9164023, 'auroc': 0.99413085, 'binary_precision': 0.9073634, 'binary_recall': 0.7785326, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.83802557}
confusion matrix:
       0     1
0  42203   117
1    326  1146
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.92849463, 'recall': 0.853437, 'specificity': 0.853437, 'f1': 0.8870832, 'auroc': 0.98034894, 'binary_precision': 0.86717266, 'binary_recall': 0.71073097, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7811966}
confusion matrix:
       0    1
0  18079   70
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.90676224, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_17.png
better model found
persisted
after epoch: 17,now: 2024-06-09 10:38:35.992298,epoch time: 0:38:34.580052,used: 10:52:50.899193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9892903, 'precision': 0.92525756, 'recall': 0.9065308, 'specificity': 0.9065308, 'f1': 0.91566646, 'auroc': 0.99478495, 'binary_precision': 0.85683763, 'binary_recall': 0.817811, 'binary_specificity': 0.9952506, 'binary_f1_score': 0.8368696}
confusion matrix:
       0     1
0  42120   201
1    268  1203
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.92263013, 'recall': 0.8787123, 'specificity': 0.8787123, 'f1': 0.89937097, 'auroc': 0.9805254, 'binary_precision': 0.85365856, 'binary_recall': 0.7620529, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8052588}
confusion matrix:
       0    1
0  18065   84
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.87934595, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_18.png
better model found
persisted
after epoch: 18,now: 2024-06-09 11:17:08.748610,epoch time: 0:38:32.756312,used: 11:31:23.655505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99011236, 'precision': 0.9469906, 'recall': 0.8948872, 'specificity': 0.8948872, 'f1': 0.9192039, 'auroc': 0.9934086, 'binary_precision': 0.9011583, 'binary_recall': 0.79279894, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.84351283}
confusion matrix:
       0     1
0  42192   128
1    305  1167
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.93212116, 'recall': 0.86823905, 'specificity': 0.86823905, 'f1': 0.89743125, 'auroc': 0.9797106, 'binary_precision': 0.8733945, 'binary_recall': 0.7402799, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.8013468}
confusion matrix:
       0    1
0  18080   69
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.8717716, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_19.png
better model found
persisted
after epoch: 19,now: 2024-06-09 11:55:38.043220,epoch time: 0:38:29.294610,used: 12:09:52.950115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.990432, 'precision': 0.9312475, 'recall': 0.919642, 'specificity': 0.919642, 'f1': 0.9253593, 'auroc': 0.99566865, 'binary_precision': 0.8679245, 'binary_recall': 0.84375, 'binary_specificity': 0.995534, 'binary_f1_score': 0.8556666}
confusion matrix:
       0     1
0  42131   189
1    230  1242
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.9221202, 'recall': 0.8871833, 'specificity': 0.8871833, 'f1': 0.9038365, 'auroc': 0.9809903, 'binary_precision': 0.8520408, 'binary_recall': 0.7791602, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.8139724}
confusion matrix:
       0    1
0  18062   87
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9205462, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 12:34:08.439349,epoch time: 0:38:30.396129,used: 12:48:23.346244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9912998, 'precision': 0.94471955, 'recall': 0.91812384, 'specificity': 0.91812384, 'f1': 0.9309799, 'auroc': 0.9963058, 'binary_precision': 0.8950036, 'binary_recall': 0.83967394, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.8664564}
confusion matrix:
       0     1
0  42175   145
1    236  1236
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.9337301, 'recall': 0.8682941, 'specificity': 0.8682941, 'f1': 0.8981346, 'auroc': 0.9821346, 'binary_precision': 0.8766114, 'binary_recall': 0.7402799, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.8026981}
confusion matrix:
       0    1
0  18082   67
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.88522613, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_21.png
early stop counter: 1
val acc:0.9875478744506836, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9606903195381165 / 0.9758709073066711
after epoch: 21,now: 2024-06-09 13:12:15.872512,epoch time: 0:38:07.433163,used: 13:26:30.779407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.91619647, 'recall': 0.95373046, 'specificity': 0.95373046, 'f1': 0.9340855, 'auroc': 0.9966667, 'binary_precision': 0.83540374, 'binary_recall': 0.9137228, 'binary_specificity': 0.9937382, 'binary_f1_score': 0.8728099}
confusion matrix:
       0     1
0  42055   265
1    127  1345
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.8955014, 'recall': 0.9038009, 'specificity': 0.9038009, 'f1': 0.8996043, 'auroc': 0.98133314, 'binary_precision': 0.7975647, 'binary_recall': 0.81493, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.80615383}
confusion matrix:
       0    1
0  18016  133
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9372755, 'recall': 0.54006314, 'specificity': 0.54006314, 'f1': 0.56405157, 'auroc': 0.87802756, 'binary_precision': 0.9130435, 'binary_recall': 0.08045977, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14788733}
confusion matrix:
      0   1
0  5995   2
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_22.png
early stop counter: 2
val acc:0.9865900278091431, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9606903195381165 / 0.9758709073066711
after epoch: 22,now: 2024-06-09 13:50:23.244867,epoch time: 0:38:07.372355,used: 14:04:38.151762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99171084, 'precision': 0.9571599, 'recall': 0.9111236, 'specificity': 0.9111236, 'f1': 0.932829, 'auroc': 0.99616885, 'binary_precision': 0.92039424, 'binary_recall': 0.82472825, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.8699391}
confusion matrix:
       0     1
0  42215   105
1    258  1214
---- Validation: 
scalar performance:
{'acc': 0.9887186, 'precision': 0.94996977, 'recall': 0.8711504, 'specificity': 0.8711504, 'f1': 0.90649074, 'auroc': 0.9823971, 'binary_precision': 0.9089184, 'binary_recall': 0.7449456, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.8188035}
confusion matrix:
       0    1
0  18101   48
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.94904476, 'recall': 0.52865225, 'specificity': 0.52865225, 'f1': 0.54406095, 'auroc': 0.8752878, 'binary_precision': 0.9375, 'binary_recall': 0.057471264, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5996   1
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_23.png
better model found
persisted
after epoch: 23,now: 2024-06-09 14:28:33.232860,epoch time: 0:38:09.987993,used: 14:42:48.139755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9678815, 'recall': 0.8894701, 'specificity': 0.8894701, 'f1': 0.9248288, 'auroc': 0.9970795, 'binary_precision': 0.9433498, 'binary_recall': 0.7805706, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.8542751}
confusion matrix:
       0     1
0  42251    69
1    323  1149
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.95852214, 'recall': 0.8257125, 'specificity': 0.8257125, 'f1': 0.88006747, 'auroc': 0.98101497, 'binary_precision': 0.9292035, 'binary_recall': 0.65318817, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.7671232}
confusion matrix:
       0    1
0  18117   32
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.915532, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_24.png
early stop counter: 1
val acc:0.9864304065704346, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 24,now: 2024-06-09 15:06:32.545003,epoch time: 0:37:59.312143,used: 15:20:47.451898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99251, 'precision': 0.9619592, 'recall': 0.9194057, 'specificity': 0.9194057, 'f1': 0.9395777, 'auroc': 0.9977157, 'binary_precision': 0.9294294, 'binary_recall': 0.8410326, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.8830243}
confusion matrix:
       0     1
0  42226    94
1    234  1238
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.94887805, 'recall': 0.86956763, 'specificity': 0.86956763, 'f1': 0.905089, 'auroc': 0.9808427, 'binary_precision': 0.9068441, 'binary_recall': 0.7418352, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.8160821}
confusion matrix:
       0    1
0  18100   49
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.85482705, 'recall': 0.51699126, 'specificity': 0.51699126, 'f1': 0.5225529, 'auroc': 0.84478796, 'binary_precision': 0.75, 'binary_recall': 0.03448276, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.06593406}
confusion matrix:
      0  1
0  5994  3
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_25.png
early stop counter: 2
val acc:0.9885589480400085, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 25,now: 2024-06-09 15:44:52.429560,epoch time: 0:38:19.884557,used: 15:59:07.336455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9926242, 'precision': 0.96821356, 'recall': 0.9148748, 'specificity': 0.9148748, 'f1': 0.9398136, 'auroc': 0.9980807, 'binary_precision': 0.9422633, 'binary_recall': 0.83152175, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.88343555}
confusion matrix:
       0     1
0  42245    75
1    248  1224
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9501918, 'recall': 0.84871006, 'specificity': 0.84871006, 'f1': 0.892527, 'auroc': 0.98095584, 'binary_precision': 0.91093117, 'binary_recall': 0.6998445, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.79155666}
confusion matrix:
       0    1
0  18105   44
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.8307632, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_26.png
early stop counter: 3
val acc:0.9873882532119751, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 26,now: 2024-06-09 16:23:02.383759,epoch time: 0:38:09.954199,used: 16:37:17.290654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928754, 'precision': 0.95628035, 'recall': 0.9316801, 'specificity': 0.9316801, 'f1': 0.9436133, 'auroc': 0.9975822, 'binary_precision': 0.91720665, 'binary_recall': 0.8660775, 'binary_specificity': 0.9972827, 'binary_f1_score': 0.8909091}
confusion matrix:
       0     1
0  42206   115
1    197  1274
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9209128, 'recall': 0.8554943, 'specificity': 0.8554943, 'f1': 0.88522935, 'auroc': 0.97889566, 'binary_precision': 0.8518519, 'binary_recall': 0.7153966, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.77768385}
confusion matrix:
       0    1
0  18069   80
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.8755075, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_27.png
early stop counter: 4
val acc:0.9860047101974487, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 27,now: 2024-06-09 17:01:29.169424,epoch time: 0:38:26.785665,used: 17:15:44.076319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.9393203, 'recall': 0.9341328, 'specificity': 0.9341328, 'f1': 0.93671, 'auroc': 0.99703765, 'binary_precision': 0.88308114, 'binary_recall': 0.8722826, 'binary_specificity': 0.995983, 'binary_f1_score': 0.8776487}
confusion matrix:
       0     1
0  42150   170
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.9887186, 'precision': 0.9281041, 'recall': 0.8959022, 'specificity': 0.8959022, 'f1': 0.9113232, 'auroc': 0.98103017, 'binary_precision': 0.8634064, 'binary_recall': 0.7962675, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.828479}
confusion matrix:
       0    1
0  18068   81
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7298814, 'recall': 0.51832336, 'specificity': 0.51832336, 'f1': 0.52492106, 'auroc': 0.8263917, 'binary_precision': 0.5, 'binary_recall': 0.038314175, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.071174376}
confusion matrix:
      0   1
0  5987  10
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_28.png
early stop counter: 5
val acc:0.9887186288833618, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 28,now: 2024-06-09 17:39:53.793571,epoch time: 0:38:24.624147,used: 17:54:08.700466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9908202, 'precision': 0.9583376, 'recall': 0.8948549, 'specificity': 0.8948549, 'f1': 0.9240587, 'auroc': 0.99720895, 'binary_precision': 0.92386997, 'binary_recall': 0.79197824, 'binary_specificity': 0.9977316, 'binary_f1_score': 0.8528551}
confusion matrix:
       0     1
0  42225    96
1    306  1165
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.9383273, 'recall': 0.85221237, 'specificity': 0.85221237, 'f1': 0.8902221, 'auroc': 0.9807646, 'binary_precision': 0.8869396, 'binary_recall': 0.7076205, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.78719723}
confusion matrix:
       0    1
0  18091   58
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.85313606, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_29.png
early stop counter: 6
val acc:0.9869093298912048, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9605305194854736 / 0.9758709073066711
after epoch: 29,now: 2024-06-09 18:18:17.206195,epoch time: 0:38:23.412624,used: 18:32:32.113090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9939715, 'precision': 0.96138895, 'recall': 0.94442344, 'specificity': 0.94442344, 'f1': 0.9527352, 'auroc': 0.99836355, 'binary_precision': 0.92655367, 'binary_recall': 0.8913044, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.9085873}
confusion matrix:
       0     1
0  42216   104
1    160  1312
---- Validation: 
scalar performance:
{'acc': 0.988825, 'precision': 0.93075943, 'recall': 0.8944572, 'specificity': 0.8944572, 'f1': 0.9117459, 'auroc': 0.9823146, 'binary_precision': 0.86882454, 'binary_recall': 0.7931571, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.82926834}
confusion matrix:
       0    1
0  18072   77
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8552821, 'recall': 0.52831876, 'specificity': 0.52831876, 'f1': 0.5431233, 'auroc': 0.8320925, 'binary_precision': 0.75, 'binary_recall': 0.057471264, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5992   5
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_30.png
better model found
persisted
after epoch: 30,now: 2024-06-09 18:56:46.747355,epoch time: 0:38:29.541160,used: 19:11:01.654250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_45_seed_0_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:11:01.654250 at 2024-06-09 18:56:46.747355
persisted model performance metric: 

scalar performance:
{'acc': 0.9610099, 'precision': 0.9329806, 'recall': 0.5362317, 'specificity': 0.5362317, 'f1': 0.5574037, 'auroc': 0.8467102, 'binary_precision': 0.9047619, 'binary_recall': 0.07279693, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13475177}
confusion matrix:
      0   1
0  5995   2
1   242  19
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1652 MiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430672 KiB |    863 MiB | 413192 GiB | 413192 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400321 GiB | 400320 GiB |
|       from small pool |  20368 KiB |     21 MiB |  12871 GiB |  12871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2498    |    6357    |  152021 K  |  152019 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89743 K  |   89741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2498    |    6357    |  152021 K  |  152019 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89743 K  |   89741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |    2873    |   89805 K  |   89805 K  |
|       from large pool |     112    |     516    |   47248 K  |   47247 K  |
|       from small pool |      33    |    2761    |   42557 K  |   42557 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413193 GiB | 413193 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400322 GiB | 400322 GiB |
|       from small pool |      0 KiB |     25 MiB |  12871 GiB |  12871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89806 K  |   89806 K  |
|       from large pool |       2    |     516    |   47248 K  |   47248 K  |
|       from small pool |       0    |    2761    |   42558 K  |   42558 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413193 GiB | 413193 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400322 GiB | 400322 GiB |
|       from small pool |      0 KiB |     25 MiB |  12871 GiB |  12871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89806 K  |   89806 K  |
|       from large pool |       2    |     516    |   47248 K  |   47248 K  |
|       from small pool |       0    |    2761    |   42558 K  |   42558 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158

 Experiment start at: 2024-06-09 19:05:05.157835
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9710416, 'precision': 0.78354526, 'recall': 0.6959649, 'specificity': 0.6959649, 'f1': 0.7310222, 'auroc': 0.94456434, 'binary_precision': 0.5872211, 'binary_recall': 0.40152565, 'binary_specificity': 0.9904041, 'binary_f1_score': 0.4769357}
confusion matrix:
       0    1
0  42007  407
1    863  579
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.7819745, 'recall': 0.7032594, 'specificity': 0.7032594, 'f1': 0.7355776, 'auroc': 0.94708484, 'binary_precision': 0.5854167, 'binary_recall': 0.41753343, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.48742414}
confusion matrix:
       0    1
0  17868  199
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.69279516, 'recall': 0.5307582, 'specificity': 0.5307582, 'f1': 0.5456858, 'auroc': 0.92677754, 'binary_precision': 0.425, 'binary_recall': 0.06538462, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.11333334}
confusion matrix:
      0   1
0  5923  23
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 19:45:08.212081,epoch time: 0:40:03.054246,used: 0:40:03.054246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9717485, 'precision': 0.7752254, 'recall': 0.8055247, 'specificity': 0.8055247, 'f1': 0.78950137, 'auroc': 0.9612107, 'binary_precision': 0.5631612, 'binary_recall': 0.62760055, 'binary_specificity': 0.98344886, 'binary_f1_score': 0.5936372}
confusion matrix:
       0    1
0  41712  702
1    537  905
---- Validation: 
scalar performance:
{'acc': 0.96963716, 'precision': 0.7784389, 'recall': 0.80185986, 'specificity': 0.80185986, 'f1': 0.78962255, 'auroc': 0.96182275, 'binary_precision': 0.57103825, 'binary_recall': 0.62109953, 'binary_specificity': 0.98262024, 'binary_f1_score': 0.59501785}
confusion matrix:
       0    1
0  17753  314
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8112416, 'recall': 0.64462924, 'specificity': 0.64462924, 'f1': 0.69439673, 'auroc': 0.9391532, 'binary_precision': 0.65254235, 'binary_recall': 0.29615384, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.4074074}
confusion matrix:
      0   1
0  5905  41
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 20:23:18.343308,epoch time: 0:38:10.131227,used: 1:18:13.185473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97710687, 'precision': 0.82256025, 'recall': 0.8113096, 'specificity': 0.8113096, 'f1': 0.81682587, 'auroc': 0.9673989, 'binary_precision': 0.657554, 'binary_recall': 0.6338419, 'binary_specificity': 0.9887773, 'binary_f1_score': 0.6454802}
confusion matrix:
       0    1
0  41938  476
1    528  914
---- Validation: 
scalar performance:
{'acc': 0.9741729, 'precision': 0.8346255, 'recall': 0.7534282, 'specificity': 0.7534282, 'f1': 0.78790075, 'auroc': 0.96798474, 'binary_precision': 0.6871287, 'binary_recall': 0.51560175, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.5891341}
confusion matrix:
       0    1
0  17909  158
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.80754364, 'recall': 0.5938834, 'specificity': 0.5938834, 'f1': 0.6385543, 'auroc': 0.944687, 'binary_precision': 0.64935064, 'binary_recall': 0.1923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.2967359}
confusion matrix:
      0   1
0  5919  27
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 21:01:57.725851,epoch time: 0:38:39.382543,used: 1:56:52.568016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.978361, 'precision': 0.91554093, 'recall': 0.7061131, 'specificity': 0.7061131, 'f1': 0.7732425, 'auroc': 0.97221357, 'binary_precision': 0.8506401, 'binary_recall': 0.4147018, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.55757576}
confusion matrix:
       0    1
0  42309  105
1    844  598
---- Validation: 
scalar performance:
{'acc': 0.9734792, 'precision': 0.93539983, 'recall': 0.6472089, 'specificity': 0.6472089, 'f1': 0.715554, 'auroc': 0.9710077, 'binary_precision': 0.8963964, 'binary_recall': 0.29569092, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.44469273}
confusion matrix:
       0    1
0  18044   23
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.9499824, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_4.png
early stop counter: 1
val acc:0.9734792113304138, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9618111252784729 / 0.9639058709144592
after epoch: 4,now: 2024-06-09 21:41:16.550976,epoch time: 0:39:18.825125,used: 2:36:11.393141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9804588, 'precision': 0.89593095, 'recall': 0.76413953, 'specificity': 0.76413953, 'f1': 0.81591374, 'auroc': 0.97552955, 'binary_precision': 0.807571, 'binary_recall': 0.5325936, 'binary_specificity': 0.9956854, 'binary_f1_score': 0.6418721}
confusion matrix:
       0    1
0  42231  183
1    674  768
---- Validation: 
scalar performance:
{'acc': 0.9768943, 'precision': 0.9170811, 'recall': 0.7133542, 'specificity': 0.7133542, 'f1': 0.779919, 'auroc': 0.97327095, 'binary_precision': 0.8550296, 'binary_recall': 0.4294205, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.5717112}
confusion matrix:
       0    1
0  18018   49
1    384  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.90775704, 'recall': 0.55534875, 'specificity': 0.55534875, 'f1': 0.5889019, 'auroc': 0.9505626, 'binary_precision': 0.85294116, 'binary_recall': 0.11153846, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.19727892}
confusion matrix:
      0   1
0  5941   5
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 22:20:06.047812,epoch time: 0:38:49.496836,used: 3:15:00.889977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98262495, 'precision': 0.91565, 'recall': 0.7866963, 'specificity': 0.7866963, 'f1': 0.83848405, 'auroc': 0.9795241, 'binary_precision': 0.8455285, 'binary_recall': 0.5769764, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.6859028}
confusion matrix:
       0    1
0  42262  152
1    610  832
---- Validation: 
scalar performance:
{'acc': 0.9782284, 'precision': 0.9353467, 'recall': 0.7233445, 'specificity': 0.7233445, 'f1': 0.79282504, 'auroc': 0.97653204, 'binary_precision': 0.89085543, 'binary_recall': 0.448737, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.59683794}
confusion matrix:
       0    1
0  18030   37
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9003583, 'recall': 0.5591108, 'specificity': 0.5591108, 'f1': 0.5946784, 'auroc': 0.9516071, 'binary_precision': 0.8378378, 'binary_recall': 0.11923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.20875423}
confusion matrix:
      0   1
0  5940   6
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 22:59:39.427922,epoch time: 0:39:33.380110,used: 3:54:34.270087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98326343, 'precision': 0.9330659, 'recall': 0.78267205, 'specificity': 0.78267205, 'f1': 0.8409778, 'auroc': 0.9844851, 'binary_precision': 0.88064516, 'binary_recall': 0.56796116, 'binary_specificity': 0.99738294, 'binary_f1_score': 0.6905565}
confusion matrix:
       0    1
0  42303  111
1    623  819
---- Validation: 
scalar performance:
{'acc': 0.9766275, 'precision': 0.92119193, 'recall': 0.70606315, 'specificity': 0.70606315, 'f1': 0.7741178, 'auroc': 0.9770392, 'binary_precision': 0.8637771, 'binary_recall': 0.41456166, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.560241}
confusion matrix:
       0    1
0  18023   44
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.92773044, 'recall': 0.5325241, 'specificity': 0.5325241, 'f1': 0.5508355, 'auroc': 0.9484731, 'binary_precision': 0.8947368, 'binary_recall': 0.06538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5944   2
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_7.png
early stop counter: 1
val acc:0.97662752866745, best validation acc: 0.9782283902168274, corresponding to test acc:                         0.9621334075927734 / 0.9639058709144592
after epoch: 7,now: 2024-06-09 23:38:34.707295,epoch time: 0:38:55.279373,used: 4:33:29.549460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.985726, 'precision': 0.90474796, 'recall': 0.8606492, 'specificity': 0.8606492, 'f1': 0.8813282, 'auroc': 0.9830866, 'binary_precision': 0.81875, 'binary_recall': 0.7267684, 'binary_specificity': 0.9945301, 'binary_f1_score': 0.77002203}
confusion matrix:
       0     1
0  42182   232
1    394  1048
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.9052082, 'recall': 0.81691897, 'specificity': 0.81691897, 'f1': 0.85521644, 'auroc': 0.97839415, 'binary_precision': 0.8237548, 'binary_recall': 0.63893014, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.7196653}
confusion matrix:
       0    1
0  17975   92
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9175741, 'recall': 0.5649642, 'specificity': 0.5649642, 'f1': 0.6041772, 'auroc': 0.9514873, 'binary_precision': 0.8717949, 'binary_recall': 0.13076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.22742477}
confusion matrix:
      0   1
0  5941   5
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_8.png
better model found
persisted
after epoch: 8,now: 2024-06-10 00:18:43.203956,epoch time: 0:40:08.496661,used: 5:13:38.046121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9825565, 'precision': 0.8443482, 'recall': 0.91327286, 'specificity': 0.91327286, 'f1': 0.87538064, 'auroc': 0.98507905, 'binary_precision': 0.6942054, 'binary_recall': 0.83911234, 'binary_specificity': 0.9874334, 'binary_f1_score': 0.7598116}
confusion matrix:
       0     1
0  41881   533
1    232  1210
---- Validation: 
scalar performance:
{'acc': 0.9800427, 'precision': 0.8481238, 'recall': 0.87592214, 'specificity': 0.87592214, 'f1': 0.8614359, 'auroc': 0.97931534, 'binary_precision': 0.70507544, 'binary_recall': 0.7637444, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.7332382}
confusion matrix:
       0    1
0  17852  215
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.813855, 'recall': 0.62030196, 'specificity': 0.62030196, 'f1': 0.6697736, 'auroc': 0.94523835, 'binary_precision': 0.6597938, 'binary_recall': 0.24615385, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.35854343}
confusion matrix:
      0   1
0  5913  33
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_9.png
early stop counter: 1
val acc:0.9800426959991455, best validation acc: 0.9821237921714783, corresponding to test acc:                         0.9627779722213745 / 0.9639058709144592
after epoch: 9,now: 2024-06-10 00:57:03.220502,epoch time: 0:38:20.016546,used: 5:51:58.062667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9862732, 'precision': 0.9098216, 'recall': 0.86461663, 'specificity': 0.86461663, 'f1': 0.8857967, 'auroc': 0.98766243, 'binary_precision': 0.8286385, 'binary_recall': 0.7343967, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.77867645}
confusion matrix:
       0     1
0  42195   219
1    383  1059
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.90885687, 'recall': 0.8126274, 'specificity': 0.8126274, 'f1': 0.8537961, 'auroc': 0.9803512, 'binary_precision': 0.83137256, 'binary_recall': 0.63001484, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7168217}
confusion matrix:
       0    1
0  17981   86
1    249  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8700882, 'recall': 0.5531734, 'specificity': 0.5531734, 'f1': 0.58469033, 'auroc': 0.94606537, 'binary_precision': 0.7777778, 'binary_recall': 0.10769231, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5938   8
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_10.png
early stop counter: 2
val acc:0.9821237921714783, best validation acc: 0.9821237921714783, corresponding to test acc:                         0.9627779722213745 / 0.9639058709144592
after epoch: 10,now: 2024-06-10 01:37:57.805113,epoch time: 0:40:54.584611,used: 6:32:52.647278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98736775, 'precision': 0.93003845, 'recall': 0.8604932, 'specificity': 0.8604932, 'f1': 0.89197826, 'auroc': 0.9905273, 'binary_precision': 0.86938435, 'binary_recall': 0.72468793, 'binary_specificity': 0.9962984, 'binary_f1_score': 0.790469}
confusion matrix:
       0     1
0  42257   157
1    397  1045
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.9305428, 'recall': 0.80594516, 'specificity': 0.80594516, 'f1': 0.8568804, 'auroc': 0.98143494, 'binary_precision': 0.8752643, 'binary_recall': 0.615156, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.7225131}
confusion matrix:
       0    1
0  18008   59
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.93733084, 'recall': 0.5593631, 'specificity': 0.5593631, 'f1': 0.59586966, 'auroc': 0.950205, 'binary_precision': 0.9117647, 'binary_recall': 0.11923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5943   3
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_11.png
better model found
persisted
after epoch: 11,now: 2024-06-10 02:17:44.465296,epoch time: 0:39:46.660183,used: 7:12:39.307461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9881886, 'precision': 0.9232931, 'recall': 0.88402927, 'specificity': 0.88402927, 'f1': 0.9026327, 'auroc': 0.9897344, 'binary_precision': 0.8542945, 'binary_recall': 0.7725381, 'binary_specificity': 0.99552035, 'binary_f1_score': 0.81136197}
confusion matrix:
       0     1
0  42224   190
1    328  1114
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.9140837, 'recall': 0.8304857, 'specificity': 0.8304857, 'f1': 0.8672029, 'auroc': 0.981765, 'binary_precision': 0.8405253, 'binary_recall': 0.66567606, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.74295187}
confusion matrix:
       0    1
0  17982   85
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.94534755, 'recall': 0.5498318, 'specificity': 0.5498318, 'f1': 0.580545, 'auroc': 0.945861, 'binary_precision': 0.9285714, 'binary_recall': 0.1, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18055557}
confusion matrix:
      0   1
0  5944   2
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_12.png
better model found
persisted
after epoch: 12,now: 2024-06-10 02:58:47.444694,epoch time: 0:41:02.979398,used: 7:53:42.286859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9880746, 'precision': 0.93620914, 'recall': 0.8665528, 'specificity': 0.8665528, 'f1': 0.8981348, 'auroc': 0.99045134, 'binary_precision': 0.8813278, 'binary_recall': 0.73647714, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.8024178}
confusion matrix:
       0     1
0  42271   143
1    380  1062
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.90946096, 'recall': 0.7927617, 'specificity': 0.7927617, 'f1': 0.8406322, 'auroc': 0.9797138, 'binary_precision': 0.8340336, 'binary_recall': 0.58989596, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.6910357}
confusion matrix:
       0    1
0  17988   79
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.95901453, 'recall': 0.5422236, 'specificity': 0.5422236, 'f1': 0.5678861, 'auroc': 0.95228064, 'binary_precision': 0.95652175, 'binary_recall': 0.08461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.15547705}
confusion matrix:
      0   1
0  5945   1
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_13.png
early stop counter: 1
val acc:0.9810565710067749, best validation acc: 0.9834578633308411, corresponding to test acc:                         0.9619722962379456 / 0.9639058709144592
after epoch: 13,now: 2024-06-10 03:40:40.516886,epoch time: 0:41:53.072192,used: 8:35:35.359051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.9616232, 'recall': 0.8593794, 'specificity': 0.8593794, 'f1': 0.90368795, 'auroc': 0.99226916, 'binary_precision': 0.93267506, 'binary_recall': 0.72052705, 'binary_specificity': 0.9982317, 'binary_f1_score': 0.8129891}
confusion matrix:
       0     1
0  42339    75
1    403  1039
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.938844, 'recall': 0.8150542, 'specificity': 0.8150542, 'f1': 0.8659978, 'auroc': 0.98035765, 'binary_precision': 0.8912134, 'binary_recall': 0.6329866, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.7402259}
confusion matrix:
       0    1
0  18015   52
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9029736, 'recall': 0.52098566, 'specificity': 0.52098566, 'f1': 0.5299545, 'auroc': 0.93368167, 'binary_precision': 0.84615386, 'binary_recall': 0.042307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.08058608}
confusion matrix:
      0   1
0  5944   2
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_14.png
better model found
persisted
after epoch: 14,now: 2024-06-10 04:23:09.143209,epoch time: 0:42:28.626323,used: 9:18:03.985374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98957956, 'precision': 0.9543035, 'recall': 0.87436485, 'specificity': 0.87436485, 'f1': 0.9102006, 'auroc': 0.9926982, 'binary_precision': 0.9170195, 'binary_recall': 0.7510402, 'binary_specificity': 0.9976894, 'binary_f1_score': 0.825772}
confusion matrix:
       0     1
0  42316    98
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.93272185, 'recall': 0.82077634, 'specificity': 0.82077634, 'f1': 0.86777675, 'auroc': 0.9827297, 'binary_precision': 0.8785425, 'binary_recall': 0.6448737, 'binary_specificity': 0.996679, 'binary_f1_score': 0.74378747}
confusion matrix:
       0    1
0  18007   60
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.91201234, 'recall': 0.5477406, 'specificity': 0.5477406, 'f1': 0.5766479, 'auroc': 0.9364565, 'binary_precision': 0.86206895, 'binary_recall': 0.09615385, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5942   4
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_15.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9840448498725891, corresponding to test acc:                         0.9595552682876587 / 0.9639058709144592
after epoch: 15,now: 2024-06-10 05:06:35.801167,epoch time: 0:43:26.657958,used: 10:01:30.643332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98994434, 'precision': 0.9454113, 'recall': 0.88996124, 'specificity': 0.88996124, 'f1': 0.9157094, 'auroc': 0.99289423, 'binary_precision': 0.89817023, 'binary_recall': 0.7829404, 'binary_specificity': 0.99698216, 'binary_f1_score': 0.83660614}
confusion matrix:
       0     1
0  42286   128
1    313  1129
---- Validation: 
scalar performance:
{'acc': 0.9854322, 'precision': 0.92765385, 'recall': 0.84939134, 'specificity': 0.84939134, 'f1': 0.8842586, 'auroc': 0.98314893, 'binary_precision': 0.86630034, 'binary_recall': 0.70282316, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7760459}
confusion matrix:
       0    1
0  17994   73
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8867638, 'recall': 0.5571037, 'specificity': 0.5571037, 'f1': 0.59122884, 'auroc': 0.9472625, 'binary_precision': 0.8108108, 'binary_recall': 0.115384616, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.2020202}
confusion matrix:
      0   1
0  5939   7
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_16.png
better model found
persisted
after epoch: 16,now: 2024-06-10 05:46:29.400656,epoch time: 0:39:53.599489,used: 10:41:24.242821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9905372, 'precision': 0.96305656, 'recall': 0.8821478, 'specificity': 0.8821478, 'f1': 0.91845345, 'auroc': 0.99456084, 'binary_precision': 0.93401015, 'binary_recall': 0.7661346, 'binary_specificity': 0.998161, 'binary_f1_score': 0.8417842}
confusion matrix:
       0     1
0  42337    78
1    337  1104
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.9350698, 'recall': 0.80534065, 'specificity': 0.80534065, 'f1': 0.85796034, 'auroc': 0.9821764, 'binary_precision': 0.8843683, 'binary_recall': 0.6136701, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.72456133}
confusion matrix:
       0    1
0  18013   54
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.93450767, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_17.png
early stop counter: 1
val acc:0.9832444190979004, best validation acc: 0.9854322075843811, corresponding to test acc:                         0.9618111252784729 / 0.9639058709144592
after epoch: 17,now: 2024-06-10 06:28:32.045779,epoch time: 0:42:02.645123,used: 11:23:26.887944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.9063159, 'recall': 0.92669296, 'specificity': 0.92669296, 'f1': 0.9162347, 'auroc': 0.99400616, 'binary_precision': 0.8174028, 'binary_recall': 0.8599168, 'binary_specificity': 0.9934691, 'binary_f1_score': 0.83812106}
confusion matrix:
       0     1
0  42137   277
1    202  1240
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.91962034, 'recall': 0.8822702, 'specificity': 0.8822702, 'f1': 0.90000105, 'auroc': 0.98187685, 'binary_precision': 0.8477905, 'binary_recall': 0.76968795, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.8068536}
confusion matrix:
       0    1
0  17974   93
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.96397924, 'recall': 0.5537621, 'specificity': 0.5537621, 'f1': 0.587276, 'auroc': 0.946861, 'binary_precision': 0.9655172, 'binary_recall': 0.10769231, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.19377162}
confusion matrix:
      0   1
0  5945   1
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_18.png
better model found
persisted
after epoch: 18,now: 2024-06-10 07:08:29.473347,epoch time: 0:39:57.427568,used: 12:03:24.315512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9893971, 'precision': 0.9033017, 'recall': 0.93858135, 'specificity': 0.93858135, 'f1': 0.9201405, 'auroc': 0.9946408, 'binary_precision': 0.8105531, 'binary_recall': 0.88418865, 'binary_specificity': 0.99297404, 'binary_f1_score': 0.84577113}
confusion matrix:
       0     1
0  42116   298
1    167  1275
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.90119207, 'recall': 0.9006181, 'specificity': 0.9006181, 'f1': 0.90090483, 'auroc': 0.98314226, 'binary_precision': 0.8095238, 'binary_recall': 0.80832094, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.8089219}
confusion matrix:
       0    1
0  17939  128
1    129  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.90775704, 'recall': 0.55534875, 'specificity': 0.55534875, 'f1': 0.5889019, 'auroc': 0.935382, 'binary_precision': 0.85294116, 'binary_recall': 0.11153846, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.19727892}
confusion matrix:
      0   1
0  5941   5
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_19.png
early stop counter: 1
val acc:0.9862860441207886, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.962455689907074 / 0.9639058709144592
after epoch: 19,now: 2024-06-10 07:47:06.315844,epoch time: 0:38:36.842497,used: 12:42:01.158009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99181414, 'precision': 0.9398488, 'recall': 0.9301173, 'specificity': 0.9301173, 'f1': 0.9349245, 'auroc': 0.99552405, 'binary_precision': 0.88431513, 'binary_recall': 0.8640777, 'binary_specificity': 0.99615693, 'binary_f1_score': 0.87407935}
confusion matrix:
       0     1
0  42251   163
1    196  1246
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.91366065, 'recall': 0.87982, 'specificity': 0.87982, 'f1': 0.8959563, 'auroc': 0.98189914, 'binary_precision': 0.83603895, 'binary_recall': 0.7652303, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.79906905}
confusion matrix:
       0    1
0  17966  101
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.94665694, 'recall': 0.5517549, 'specificity': 0.5517549, 'f1': 0.5837333, 'auroc': 0.94123846, 'binary_precision': 0.9310345, 'binary_recall': 0.103846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18685122}
confusion matrix:
      0   1
0  5944   2
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_20.png
early stop counter: 2
val acc:0.9861792922019958, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.962455689907074 / 0.9639058709144592
after epoch: 20,now: 2024-06-10 08:26:12.147641,epoch time: 0:39:05.831797,used: 13:21:06.989806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9913809, 'precision': 0.9617847, 'recall': 0.8977379, 'specificity': 0.8977379, 'f1': 0.92720234, 'auroc': 0.9958029, 'binary_precision': 0.9304207, 'binary_recall': 0.7975035, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.85884994}
confusion matrix:
       0     1
0  42328    86
1    292  1150
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.93098766, 'recall': 0.82515097, 'specificity': 0.82515097, 'f1': 0.87007296, 'auroc': 0.9814057, 'binary_precision': 0.8747515, 'binary_recall': 0.653789, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7482993}
confusion matrix:
       0    1
0  18004   63
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.9384619, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_21.png
early stop counter: 3
val acc:0.984204888343811, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.962455689907074 / 0.9639058709144592
after epoch: 21,now: 2024-06-10 09:05:55.692842,epoch time: 0:39:43.545201,used: 14:00:50.535007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9894883, 'precision': 0.9338665, 'recall': 0.89508474, 'specificity': 0.89508474, 'f1': 0.91349924, 'auroc': 0.9958753, 'binary_precision': 0.87471354, 'binary_recall': 0.7940361, 'binary_specificity': 0.9961333, 'binary_f1_score': 0.8324246}
confusion matrix:
       0     1
0  42250   164
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9833511, 'precision': 0.9018347, 'recall': 0.84402037, 'specificity': 0.84402037, 'f1': 0.870494, 'auroc': 0.98075986, 'binary_precision': 0.8150087, 'binary_recall': 0.69390786, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.7495987}
confusion matrix:
       0    1
0  17961  106
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.92245615, 'recall': 0.58411086, 'specificity': 0.58411086, 'f1': 0.63276345, 'auroc': 0.9378965, 'binary_precision': 0.88, 'binary_recall': 0.16923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.28387097}
confusion matrix:
      0   1
0  5940   6
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_22.png
new oracle model saved
early stop counter: 4
val acc:0.9833511114120483, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 22,now: 2024-06-10 09:45:34.760259,epoch time: 0:39:39.067417,used: 14:40:29.602424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9919281, 'precision': 0.9403727, 'recall': 0.93151605, 'specificity': 0.93151605, 'f1': 0.9358959, 'auroc': 0.9964651, 'binary_precision': 0.8852691, 'binary_recall': 0.86685157, 'binary_specificity': 0.99618053, 'binary_f1_score': 0.8759635}
confusion matrix:
       0     1
0  42252   162
1    192  1250
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9180829, 'recall': 0.88147193, 'specificity': 0.88147193, 'f1': 0.8988673, 'auroc': 0.9826486, 'binary_precision': 0.84477127, 'binary_recall': 0.76820207, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.80466926}
confusion matrix:
       0    1
0  17972   95
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.9191307, 'recall': 0.5917191, 'specificity': 0.5917191, 'f1': 0.64332914, 'auroc': 0.9420168, 'binary_precision': 0.8727273, 'binary_recall': 0.18461539, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.30476192}
confusion matrix:
      0   1
0  5939   7
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_23.png
new oracle model saved
early stop counter: 5
val acc:0.9866061806678772, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.962455689907074 / 0.9647115468978882
after epoch: 23,now: 2024-06-10 10:30:10.938754,epoch time: 0:44:36.178495,used: 15:25:05.780919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9920421, 'precision': 0.93315107, 'recall': 0.94329834, 'specificity': 0.94329834, 'f1': 0.9381613, 'auroc': 0.99654746, 'binary_precision': 0.8700068, 'binary_recall': 0.8911234, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.88043857}
confusion matrix:
       0     1
0  42222   192
1    157  1285
---- Validation: 
scalar performance:
{'acc': 0.9884205, 'precision': 0.92736316, 'recall': 0.9010098, 'specificity': 0.9010098, 'f1': 0.91373146, 'auroc': 0.98193514, 'binary_precision': 0.86190474, 'binary_recall': 0.80683506, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.8334612}
confusion matrix:
       0    1
0  17980   87
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9521177, 'recall': 0.5613703, 'specificity': 0.5613703, 'f1': 0.59935355, 'auroc': 0.9361471, 'binary_precision': 0.9411765, 'binary_recall': 0.12307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5944   2
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_24.png
better model found
persisted
after epoch: 24,now: 2024-06-10 11:09:13.991098,epoch time: 0:39:03.052344,used: 16:04:08.833263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9915633, 'precision': 0.92220503, 'recall': 0.9504197, 'specificity': 0.9504197, 'f1': 0.93581927, 'auroc': 0.9965479, 'binary_precision': 0.8476005, 'binary_recall': 0.90638006, 'binary_specificity': 0.9944594, 'binary_f1_score': 0.87600535}
confusion matrix:
       0     1
0  42179   235
1    135  1307
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.8919645, 'recall': 0.9126669, 'specificity': 0.9126669, 'f1': 0.9020246, 'auroc': 0.9827645, 'binary_precision': 0.79014087, 'binary_recall': 0.833581, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.81127983}
confusion matrix:
       0    1
0  17918  149
1    112  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.95699805, 'recall': 0.57290876, 'specificity': 0.57290876, 'f1': 0.6174196, 'auroc': 0.94415605, 'binary_precision': 0.95, 'binary_recall': 0.14615385, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.25333333}
confusion matrix:
      0   1
0  5944   2
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_25.png
early stop counter: 1
val acc:0.9860725998878479, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 25,now: 2024-06-10 11:49:49.755672,epoch time: 0:40:35.764574,used: 16:44:44.597837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99334186, 'precision': 0.9420091, 'recall': 0.95502365, 'specificity': 0.95502365, 'f1': 0.94841456, 'auroc': 0.9974314, 'binary_precision': 0.88694483, 'binary_recall': 0.9140083, 'binary_specificity': 0.99603903, 'binary_f1_score': 0.90027326}
confusion matrix:
       0     1
0  42246   168
1    124  1318
---- Validation: 
scalar performance:
{'acc': 0.98762006, 'precision': 0.90879333, 'recall': 0.91346955, 'specificity': 0.91346955, 'f1': 0.91111696, 'auroc': 0.98312443, 'binary_precision': 0.8237885, 'binary_recall': 0.833581, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.82865584}
confusion matrix:
       0    1
0  17947  120
1    112  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.90930164, 'recall': 0.57825756, 'specificity': 0.57825756, 'f1': 0.62378114, 'auroc': 0.92668164, 'binary_precision': 0.8541667, 'binary_recall': 0.15769231, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.26623377}
confusion matrix:
      0   1
0  5939   7
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_26.png
early stop counter: 2
val acc:0.9876200556755066, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 26,now: 2024-06-10 12:30:49.229657,epoch time: 0:40:59.473985,used: 17:25:44.071822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9929314, 'precision': 0.9495176, 'recall': 0.93806386, 'specificity': 0.93806386, 'f1': 0.94371116, 'auroc': 0.9971447, 'binary_precision': 0.9031339, 'binary_recall': 0.8793343, 'binary_specificity': 0.9967935, 'binary_f1_score': 0.8910752}
confusion matrix:
       0     1
0  42278   136
1    174  1268
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.8997239, 'recall': 0.8733506, 'specificity': 0.8733506, 'f1': 0.8860476, 'auroc': 0.9831094, 'binary_precision': 0.80861247, 'binary_recall': 0.7533432, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.78000003}
confusion matrix:
       0    1
0  17947  120
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.90043163, 'recall': 0.56864214, 'specificity': 0.56864214, 'f1': 0.60927355, 'auroc': 0.93755335, 'binary_precision': 0.8372093, 'binary_recall': 0.13846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.23762377}
confusion matrix:
      0   1
0  5939   7
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_27.png
early stop counter: 3
val acc:0.9847385287284851, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 27,now: 2024-06-10 13:09:59.300233,epoch time: 0:39:10.070576,used: 18:04:54.142398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9929998, 'precision': 0.96228385, 'recall': 0.92470115, 'specificity': 0.92470115, 'f1': 0.9426375, 'auroc': 0.9981656, 'binary_precision': 0.9295988, 'binary_recall': 0.851595, 'binary_specificity': 0.9978073, 'binary_f1_score': 0.88888896}
confusion matrix:
       0     1
0  42321    93
1    214  1228
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.92830575, 'recall': 0.8759712, 'specificity': 0.8759712, 'f1': 0.90029335, 'auroc': 0.9833127, 'binary_precision': 0.86564624, 'binary_recall': 0.756315, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.8072958}
confusion matrix:
       0    1
0  17988   79
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.93280715, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_28.png
early stop counter: 4
val acc:0.9870330691337585, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 28,now: 2024-06-10 13:49:49.788374,epoch time: 0:39:50.488141,used: 18:44:44.630539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99325067, 'precision': 0.93372774, 'recall': 0.96502507, 'specificity': 0.96502507, 'f1': 0.94878787, 'auroc': 0.9978763, 'binary_precision': 0.8696774, 'binary_recall': 0.9348128, 'binary_specificity': 0.9952374, 'binary_f1_score': 0.9010696}
confusion matrix:
       0     1
0  42212   202
1     94  1348
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.88575935, 'recall': 0.91382074, 'specificity': 0.91382074, 'f1': 0.8992512, 'auroc': 0.9843942, 'binary_precision': 0.7776243, 'binary_recall': 0.83655274, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.80601287}
confusion matrix:
       0    1
0  17906  161
1    110  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.89274895, 'recall': 0.59522885, 'specificity': 0.59522885, 'f1': 0.6466242, 'auroc': 0.9465364, 'binary_precision': 0.8196721, 'binary_recall': 0.1923077, 'binary_specificity': 0.99815, 'binary_f1_score': 0.31152648}
confusion matrix:
      0   1
0  5935  11
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_29.png
early stop counter: 5
val acc:0.9855389595031738, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 29,now: 2024-06-10 14:31:57.898843,epoch time: 0:42:08.110469,used: 19:26:52.741008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99366105, 'precision': 0.9646177, 'recall': 0.93341684, 'specificity': 0.93341684, 'f1': 0.9484352, 'auroc': 0.9983158, 'binary_precision': 0.9336811, 'binary_recall': 0.86893207, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.9001437}
confusion matrix:
       0     1
0  42325    89
1    189  1253
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.92004406, 'recall': 0.86386275, 'specificity': 0.86386275, 'f1': 0.8897706, 'auroc': 0.98287225, 'binary_precision': 0.85, 'binary_recall': 0.73254085, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.7869114}
confusion matrix:
       0    1
0  17980   87
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.90545094, 'recall': 0.5534257, 'specificity': 0.5534257, 'f1': 0.5857851, 'auroc': 0.9376719, 'binary_precision': 0.8484849, 'binary_recall': 0.10769231, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.19112627}
confusion matrix:
      0   1
0  5941   5
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_30.png
early stop counter: 6
val acc:0.9857524037361145, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9629390835762024 / 0.9647115468978882
after epoch: 30,now: 2024-06-10 15:14:48.895027,epoch time: 0:42:50.996184,used: 20:09:43.737192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_19_05_05_seed_1_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:09:43.737192 at 2024-06-10 15:14:48.895027
persisted model performance metric: 

scalar performance:
{'acc': 0.96132773, 'precision': 0.9231329, 'recall': 0.5439785, 'specificity': 0.5439785, 'f1': 0.5705235, 'auroc': 0.9367058, 'binary_precision': 0.88461536, 'binary_recall': 0.08846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16083917}
confusion matrix:
      0   1
0  5943   3
1   237  23
oracle model performance metric: 

scalar performance:
{'acc': 0.9655172, 'precision': 0.95401055, 'recall': 0.5939785, 'specificity': 0.5939785, 'f1': 0.6482083, 'auroc': 0.9364387, 'binary_precision': 0.9423077, 'binary_recall': 0.18846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5943   3
1   211  49
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1978 TiB |   1978 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    783 TiB |    783 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304711 K  |  304708 K  |
|       from large pool |     247    |     989    |  124871 K  |  124871 K  |
|       from small pool |    3095    |    6116    |  179839 K  |  179836 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304711 K  |  304708 K  |
|       from large pool |     247    |     989    |  124871 K  |  124871 K  |
|       from small pool |    3095    |    6116    |  179839 K  |  179836 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |    2873    |  179558 K  |  179558 K  |
|       from large pool |     107    |     516    |   93704 K  |   93704 K  |
|       from small pool |      34    |    2763    |   85853 K  |   85853 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1978 TiB |   1978 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304711 K  |  304711 K  |
|       from large pool |       2    |     989    |  124871 K  |  124871 K  |
|       from small pool |       0    |    6116    |  179839 K  |  179839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304711 K  |  304711 K  |
|       from large pool |       2    |     989    |  124871 K  |  124871 K  |
|       from small pool |       0    |    6116    |  179839 K  |  179839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179559 K  |  179559 K  |
|       from large pool |       2    |     516    |   93704 K  |   93704 K  |
|       from small pool |       0    |    2763    |   85855 K  |   85855 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1983 TiB |   1983 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1978 TiB |   1978 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304711 K  |  304711 K  |
|       from large pool |       2    |     989    |  124871 K  |  124871 K  |
|       from small pool |       0    |    6116    |  179839 K  |  179839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304711 K  |  304711 K  |
|       from large pool |       2    |     989    |  124871 K  |  124871 K  |
|       from small pool |       0    |    6116    |  179839 K  |  179839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179559 K  |  179559 K  |
|       from large pool |       2    |     516    |   93704 K  |   93704 K  |
|       from small pool |       0    |    2763    |   85855 K  |   85855 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158

 Experiment start at: 2024-06-10 15:28:36.968699
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9680768, 'precision': 0.7634591, 'recall': 0.7135694, 'specificity': 0.7135694, 'f1': 0.73562926, 'auroc': 0.942629, 'binary_precision': 0.54679805, 'binary_recall': 0.44018507, 'binary_specificity': 0.98695374, 'binary_f1_score': 0.48773342}
confusion matrix:
       0    1
0  41759  552
1    847  666
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.75978374, 'recall': 0.7017527, 'specificity': 0.7017527, 'f1': 0.7267639, 'auroc': 0.9381344, 'binary_precision': 0.5387931, 'binary_recall': 0.4152824, 'binary_specificity': 0.988223, 'binary_f1_score': 0.46904317}
confusion matrix:
       0    1
0  17957  214
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8733113, 'recall': 0.62048346, 'specificity': 0.62048346, 'f1': 0.6773109, 'auroc': 0.92467237, 'binary_precision': 0.7763158, 'binary_recall': 0.24380165, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.37106916}
confusion matrix:
      0   1
0  5980  17
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 16:12:08.657619,epoch time: 0:43:31.688920,used: 0:43:31.688920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97222984, 'precision': 0.7930747, 'recall': 0.7839117, 'specificity': 0.7839117, 'f1': 0.7884129, 'auroc': 0.961887, 'binary_precision': 0.6010929, 'binary_recall': 0.58162594, 'binary_specificity': 0.9861975, 'binary_f1_score': 0.5911992}
confusion matrix:
       0    1
0  41727  584
1    633  880
---- Validation: 
scalar performance:
{'acc': 0.97427154, 'precision': 0.8042973, 'recall': 0.7417798, 'specificity': 0.7417798, 'f1': 0.76914394, 'auroc': 0.9573014, 'binary_precision': 0.62526315, 'binary_recall': 0.49335548, 'binary_specificity': 0.99020416, 'binary_f1_score': 0.5515321}
confusion matrix:
       0    1
0  17993  178
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.8817788, 'recall': 0.6471762, 'specificity': 0.6471762, 'f1': 0.70843524, 'auroc': 0.93429756, 'binary_precision': 0.7912088, 'binary_recall': 0.29752067, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.43243244}
confusion matrix:
      0   1
0  5978  19
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 16:52:22.325660,epoch time: 0:40:13.668041,used: 1:23:45.356961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9758808, 'precision': 0.83251834, 'recall': 0.7794294, 'specificity': 0.7794294, 'f1': 0.8034596, 'auroc': 0.9676807, 'binary_precision': 0.68037975, 'binary_recall': 0.5684071, 'binary_specificity': 0.99045163, 'binary_f1_score': 0.6193734}
confusion matrix:
       0    1
0  41907  404
1    653  860
---- Validation: 
scalar performance:
{'acc': 0.97725457, 'precision': 0.8424767, 'recall': 0.74974513, 'specificity': 0.74974513, 'f1': 0.78826976, 'auroc': 0.96177083, 'binary_precision': 0.7011494, 'binary_recall': 0.50664455, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.5882353}
confusion matrix:
       0    1
0  18041  130
1    297  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.9149368, 'recall': 0.52669275, 'specificity': 0.52669275, 'f1': 0.5411327, 'auroc': 0.93550146, 'binary_precision': 0.8666667, 'binary_recall': 0.053719006, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.101167314}
confusion matrix:
      0   1
0  5995   2
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_3.png
better model found
persisted
after epoch: 3,now: 2024-06-10 17:31:09.947617,epoch time: 0:38:47.621957,used: 2:02:32.978918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97900695, 'precision': 0.8545882, 'recall': 0.8141882, 'specificity': 0.8141882, 'f1': 0.8330586, 'auroc': 0.9751923, 'binary_precision': 0.7220974, 'binary_recall': 0.63714474, 'binary_specificity': 0.9912316, 'binary_f1_score': 0.67696625}
confusion matrix:
       0    1
0  41940  371
1    549  964
---- Validation: 
scalar performance:
{'acc': 0.9786928, 'precision': 0.8378283, 'recall': 0.8018832, 'specificity': 0.8018832, 'f1': 0.8187598, 'auroc': 0.9720373, 'binary_precision': 0.6884328, 'binary_recall': 0.6129568, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.6485061}
confusion matrix:
       0    1
0  18004  167
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7681252, 'recall': 0.54808605, 'specificity': 0.54808605, 'f1': 0.5748302, 'auroc': 0.9507035, 'binary_precision': 0.5714286, 'binary_recall': 0.09917355, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5979  18
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_4.png
better model found
persisted
after epoch: 4,now: 2024-06-10 18:09:32.628444,epoch time: 0:38:22.680827,used: 2:40:55.659745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9765197, 'precision': 0.81705904, 'recall': 0.8498637, 'specificity': 0.8498637, 'f1': 0.8325724, 'auroc': 0.97749966, 'binary_precision': 0.6443914, 'binary_recall': 0.7138136, 'binary_specificity': 0.9859138, 'binary_f1_score': 0.6773283}
confusion matrix:
       0     1
0  41715   596
1    433  1080
---- Validation: 
scalar performance:
{'acc': 0.97784054, 'precision': 0.81805134, 'recall': 0.8343679, 'specificity': 0.8343679, 'f1': 0.82598674, 'auroc': 0.9696772, 'binary_precision': 0.6466877, 'binary_recall': 0.6810631, 'binary_specificity': 0.9876727, 'binary_f1_score': 0.66343045}
confusion matrix:
       0    1
0  17947  224
1    192  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.83524287, 'recall': 0.5629657, 'specificity': 0.5629657, 'f1': 0.59920526, 'auroc': 0.9394458, 'binary_precision': 0.70454544, 'binary_recall': 0.12809917, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21678323}
confusion matrix:
      0   1
0  5984  13
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_5.png
early stop counter: 1
val acc:0.9778405427932739, best validation acc: 0.9786928296089172, corresponding to test acc:                         0.9621734023094177 / 0.969706654548645
after epoch: 5,now: 2024-06-10 18:50:10.530369,epoch time: 0:40:37.901925,used: 3:21:33.561670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9816083, 'precision': 0.9275012, 'recall': 0.77283597, 'specificity': 0.77283597, 'f1': 0.8318464, 'auroc': 0.9812948, 'binary_precision': 0.8709339, 'binary_recall': 0.548579, 'binary_specificity': 0.99709296, 'binary_f1_score': 0.6731549}
confusion matrix:
       0    1
0  42188  123
1    683  830
---- Validation: 
scalar performance:
{'acc': 0.97858626, 'precision': 0.9049983, 'recall': 0.7078715, 'specificity': 0.7078715, 'f1': 0.7726599, 'auroc': 0.97042024, 'binary_precision': 0.82894737, 'binary_recall': 0.41860464, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.5562914}
confusion matrix:
       0    1
0  18119   52
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.80271375, 'recall': 0.51817816, 'specificity': 0.51817816, 'f1': 0.5254197, 'auroc': 0.93670064, 'binary_precision': 0.64285713, 'binary_recall': 0.037190083, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0703125}
confusion matrix:
      0  1
0  5992  5
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_6.png
early stop counter: 2
val acc:0.9785862565040588, best validation acc: 0.9786928296089172, corresponding to test acc:                         0.9621734023094177 / 0.969706654548645
after epoch: 6,now: 2024-06-10 19:28:25.574607,epoch time: 0:38:15.044238,used: 3:59:48.605908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98236126, 'precision': 0.89562166, 'recall': 0.82070506, 'specificity': 0.82070506, 'f1': 0.8539253, 'auroc': 0.9824347, 'binary_precision': 0.8037767, 'binary_recall': 0.64705884, 'binary_specificity': 0.9943513, 'binary_f1_score': 0.7169536}
confusion matrix:
       0    1
0  42072  239
1    534  979
---- Validation: 
scalar performance:
{'acc': 0.9823683, 'precision': 0.9142004, 'recall': 0.77487206, 'specificity': 0.77487206, 'f1': 0.82947385, 'auroc': 0.9759588, 'binary_precision': 0.84303796, 'binary_recall': 0.55315614, 'binary_specificity': 0.996588, 'binary_f1_score': 0.66800404}
confusion matrix:
       0    1
0  18109   62
1    269  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.8381281, 'recall': 0.51016384, 'specificity': 0.51016384, 'f1': 0.51030844, 'auroc': 0.9357077, 'binary_precision': 0.71428573, 'binary_recall': 0.020661157, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.04016064}
confusion matrix:
      0  1
0  5995  2
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_7.png
better model found
persisted
after epoch: 7,now: 2024-06-10 20:07:25.453359,epoch time: 0:38:59.878752,used: 4:38:48.484660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98478, 'precision': 0.90334225, 'recall': 0.8576467, 'specificity': 0.8576467, 'f1': 0.8790086, 'auroc': 0.98512423, 'binary_precision': 0.8166168, 'binary_recall': 0.72108394, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.7658828}
confusion matrix:
       0     1
0  42066   245
1    422  1091
---- Validation: 
scalar performance:
{'acc': 0.98279446, 'precision': 0.88237107, 'recall': 0.8224721, 'specificity': 0.8224721, 'f1': 0.84967816, 'auroc': 0.9765184, 'binary_precision': 0.7762376, 'binary_recall': 0.6511628, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.7082204}
confusion matrix:
       0    1
0  18058  113
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8453198, 'recall': 0.5590002, 'specificity': 0.5590002, 'f1': 0.5936535, 'auroc': 0.9434619, 'binary_precision': 0.725, 'binary_recall': 0.11983471, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.20567375}
confusion matrix:
      0   1
0  5986  11
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_8.png
better model found
persisted
after epoch: 8,now: 2024-06-10 20:46:05.594835,epoch time: 0:38:40.141476,used: 5:17:28.626136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840042, 'precision': 0.87767386, 'recall': 0.88464904, 'specificity': 0.88464904, 'f1': 0.88112664, 'auroc': 0.9864514, 'binary_precision': 0.7632944, 'binary_recall': 0.77792466, 'binary_specificity': 0.9913734, 'binary_f1_score': 0.7705401}
confusion matrix:
       0     1
0  41946   365
1    336  1177
---- Validation: 
scalar performance:
{'acc': 0.9826879, 'precision': 0.86841613, 'recall': 0.8440993, 'specificity': 0.8440993, 'f1': 0.85580873, 'auroc': 0.9776306, 'binary_precision': 0.7468806, 'binary_recall': 0.6960133, 'binary_specificity': 0.99218535, 'binary_f1_score': 0.7205503}
confusion matrix:
       0    1
0  18029  142
1    183  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.83220327, 'recall': 0.54263806, 'specificity': 0.54263806, 'f1': 0.5677843, 'auroc': 0.9368575, 'binary_precision': 0.7, 'binary_recall': 0.08677686, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15441176}
confusion matrix:
      0   1
0  5988   9
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_9.png
early stop counter: 1
val acc:0.9826878905296326, best validation acc: 0.982794463634491, corresponding to test acc:                         0.9640967845916748 / 0.969706654548645
after epoch: 9,now: 2024-06-10 21:24:45.081742,epoch time: 0:38:39.486907,used: 5:56:08.113043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9845062, 'precision': 0.895071, 'recall': 0.8645153, 'specificity': 0.8645153, 'f1': 0.8791263, 'auroc': 0.98667395, 'binary_precision': 0.79956895, 'binary_recall': 0.7356246, 'binary_specificity': 0.993406, 'binary_f1_score': 0.7662651}
confusion matrix:
       0     1
0  42032   279
1    400  1113
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.8497194, 'recall': 0.81137705, 'specificity': 0.81137705, 'f1': 0.8293436, 'auroc': 0.9788204, 'binary_precision': 0.7116105, 'binary_recall': 0.6312292, 'binary_specificity': 0.99152493, 'binary_f1_score': 0.6690141}
confusion matrix:
       0    1
0  18017  154
1    222  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7618546, 'recall': 0.5679968, 'specificity': 0.5679968, 'f1': 0.6025603, 'auroc': 0.94503534, 'binary_precision': 0.55737704, 'binary_recall': 0.14049587, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.22442245}
confusion matrix:
      0   1
0  5970  27
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_10.png
early stop counter: 2
val acc:0.9799712300300598, best validation acc: 0.982794463634491, corresponding to test acc:                         0.9640967845916748 / 0.969706654548645
after epoch: 10,now: 2024-06-10 22:03:40.438901,epoch time: 0:38:55.357159,used: 6:35:03.470202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98530483, 'precision': 0.8755692, 'recall': 0.9184624, 'specificity': 0.9184624, 'f1': 0.89575005, 'auroc': 0.9887258, 'binary_precision': 0.756645, 'binary_recall': 0.8466623, 'binary_specificity': 0.99026257, 'binary_f1_score': 0.7991267}
confusion matrix:
       0     1
0  41899   412
1    232  1281
---- Validation: 
scalar performance:
{'acc': 0.9817291, 'precision': 0.85042685, 'recall': 0.8588619, 'specificity': 0.8588619, 'f1': 0.8545899, 'auroc': 0.9780601, 'binary_precision': 0.70988655, 'binary_recall': 0.72757477, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.7186218}
confusion matrix:
       0    1
0  17992  179
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.838681, 'recall': 0.603621, 'specificity': 0.603621, 'f1': 0.65370613, 'auroc': 0.9458252, 'binary_precision': 0.7083333, 'binary_recall': 0.2107438, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.32484075}
confusion matrix:
      0   1
0  5976  21
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_11.png
early stop counter: 3
val acc:0.9817290902137756, best validation acc: 0.982794463634491, corresponding to test acc:                         0.9640967845916748 / 0.969706654548645
after epoch: 11,now: 2024-06-10 22:42:44.454996,epoch time: 0:39:04.016095,used: 7:14:07.486297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9877008, 'precision': 0.9254751, 'recall': 0.88273954, 'specificity': 0.88273954, 'f1': 0.902886, 'auroc': 0.9900826, 'binary_precision': 0.85914457, 'binary_recall': 0.76999336, 'binary_specificity': 0.9954858, 'binary_f1_score': 0.8121296}
confusion matrix:
       0     1
0  42120   191
1    348  1165
---- Validation: 
scalar performance:
{'acc': 0.98263466, 'precision': 0.88482714, 'recall': 0.81516206, 'specificity': 0.81516206, 'f1': 0.84626126, 'auroc': 0.98042214, 'binary_precision': 0.78163266, 'binary_recall': 0.63621265, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.70146525}
confusion matrix:
       0    1
0  18064  107
1    219  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.84743834, 'recall': 0.53867257, 'specificity': 0.53867257, 'f1': 0.56147707, 'auroc': 0.94328976, 'binary_precision': 0.7307692, 'binary_recall': 0.0785124, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14179105}
confusion matrix:
      0   1
0  5990   7
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261158_12.png
early stop counter: 4
val acc:0.9826346635818481, best validation acc: 0.982794463634491, corresponding to test acc:                         0.9640967845916748 / 0.969706654548645
after epoch: 12,now: 2024-06-10 23:22:25.670199,epoch time: 0:39:41.215203,used: 7:53:48.701500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_15_28_36_seed_2_21261158
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21261158 ON gpusrv27 CANCELLED AT 2024-06-10T23:39:47 DUE TO TIME LIMIT ***
