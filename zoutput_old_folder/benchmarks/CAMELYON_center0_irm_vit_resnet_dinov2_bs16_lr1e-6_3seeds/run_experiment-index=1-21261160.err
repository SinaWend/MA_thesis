Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:39:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160

 Experiment start at: 2024-06-08 23:44:49.618627
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9694465, 'precision': 0.8475144, 'recall': 0.5721108, 'specificity': 0.5721108, 'f1': 0.6138106, 'auroc': 0.9475708, 'binary_precision': 0.72390574, 'binary_recall': 0.14615908, 'binary_specificity': 0.99806243, 'binary_f1_score': 0.24321267}
confusion matrix:
       0    1
0  42239   82
1   1256  215
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7947085, 'recall': 0.5213046, 'specificity': 0.5213046, 'f1': 0.5321331, 'auroc': 0.9480002, 'binary_precision': 0.62222224, 'binary_recall': 0.04354588, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.08139535}
confusion matrix:
       0   1
0  18132  17
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.93037593, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:01:15.228020,epoch time: 0:16:25.609393,used: 0:16:25.609393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.79627264, 'recall': 0.6412423, 'specificity': 0.6412423, 'f1': 0.68899465, 'auroc': 0.9576777, 'binary_precision': 0.616836, 'binary_recall': 0.2887228, 'binary_specificity': 0.99376184, 'binary_f1_score': 0.39333642}
confusion matrix:
       0    1
0  42056  264
1   1047  425
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.78367263, 'recall': 0.6388304, 'specificity': 0.6388304, 'f1': 0.6842284, 'auroc': 0.9587007, 'binary_precision': 0.592233, 'binary_recall': 0.28460342, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.38445377}
confusion matrix:
       0    1
0  18023  126
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8818009, 'recall': 0.62501943, 'specificity': 0.62501943, 'f1': 0.68315196, 'auroc': 0.9521605, 'binary_precision': 0.79518074, 'binary_recall': 0.25287357, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.38372093}
confusion matrix:
      0   1
0  5980  17
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 00:16:49.415808,epoch time: 0:15:34.187788,used: 0:31:59.797181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9746529, 'precision': 0.80943096, 'recall': 0.7862358, 'specificity': 0.7862358, 'f1': 0.7973386, 'auroc': 0.9665589, 'binary_precision': 0.6332843, 'binary_recall': 0.5842391, 'binary_specificity': 0.9882325, 'binary_f1_score': 0.6077739}
confusion matrix:
       0    1
0  41822  498
1    612  860
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.8377178, 'recall': 0.73575556, 'specificity': 0.73575556, 'f1': 0.776896, 'auroc': 0.9648766, 'binary_precision': 0.6936937, 'binary_recall': 0.47900465, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.5666973}
confusion matrix:
       0    1
0  18013  136
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.950487, 'recall': 0.6737459, 'specificity': 0.6737459, 'f1': 0.7462021, 'auroc': 0.9508774, 'binary_precision': 0.9285714, 'binary_recall': 0.348659, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5069638}
confusion matrix:
      0   1
0  5990   7
1   170  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-09 00:32:19.630700,epoch time: 0:15:30.214892,used: 0:47:30.012073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97634274, 'precision': 0.9094903, 'recall': 0.6815394, 'specificity': 0.6815394, 'f1': 0.7486744, 'auroc': 0.97217625, 'binary_precision': 0.840625, 'binary_recall': 0.36548913, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.50946975}
confusion matrix:
       0    1
0  42218  102
1    934  538
---- Validation: 
scalar performance:
{'acc': 0.9750958, 'precision': 0.9183424, 'recall': 0.66158277, 'specificity': 0.66158277, 'f1': 0.7295153, 'auroc': 0.9692453, 'binary_precision': 0.8600823, 'binary_recall': 0.32503888, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.47178334}
confusion matrix:
       0    1
0  18115   34
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9573674, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 00:47:48.595593,epoch time: 0:15:28.964893,used: 1:02:58.976966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97965384, 'precision': 0.84535545, 'recall': 0.83833, 'specificity': 0.83833, 'f1': 0.8418033, 'auroc': 0.97326434, 'binary_precision': 0.70159614, 'binary_recall': 0.6868206, 'binary_specificity': 0.9898393, 'binary_f1_score': 0.69412977}
confusion matrix:
       0     1
0  41890   430
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.97914004, 'precision': 0.8749942, 'recall': 0.778435, 'specificity': 0.778435, 'f1': 0.81899816, 'auroc': 0.971405, 'binary_precision': 0.7653277, 'binary_recall': 0.562986, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.6487455}
confusion matrix:
       0    1
0  18038  111
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.9307617, 'recall': 0.7799417, 'specificity': 0.7799417, 'f1': 0.83791524, 'auroc': 0.9595256, 'binary_precision': 0.88023955, 'binary_recall': 0.5632184, 'binary_specificity': 0.996665, 'binary_f1_score': 0.68691593}
confusion matrix:
      0    1
0  5977   20
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-09 01:03:19.712247,epoch time: 0:15:31.116654,used: 1:18:30.093620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794483, 'precision': 0.92735255, 'recall': 0.7260958, 'specificity': 0.7260958, 'f1': 0.793655, 'auroc': 0.9779928, 'binary_precision': 0.87336814, 'binary_recall': 0.4544837, 'binary_specificity': 0.99770796, 'binary_f1_score': 0.59785527}
confusion matrix:
       0    1
0  42223   97
1    803  669
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.94228613, 'recall': 0.69368494, 'specificity': 0.69368494, 'f1': 0.76632094, 'auroc': 0.9722077, 'binary_precision': 0.9057971, 'binary_recall': 0.3888025, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.54406965}
confusion matrix:
       0    1
0  18123   26
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.9571713, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_6.png
early stop counter: 1
val acc:0.9777032732963562, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 6,now: 2024-06-09 01:18:52.155279,epoch time: 0:15:32.443032,used: 1:34:02.536652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9819602, 'precision': 0.89983666, 'recall': 0.798213, 'specificity': 0.798213, 'f1': 0.84105736, 'auroc': 0.9797602, 'binary_precision': 0.8134191, 'binary_recall': 0.6012228, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.69140625}
confusion matrix:
       0    1
0  42117  203
1    587  885
---- Validation: 
scalar performance:
{'acc': 0.9802576, 'precision': 0.91248196, 'recall': 0.758762, 'specificity': 0.758762, 'f1': 0.8167297, 'auroc': 0.97505367, 'binary_precision': 0.84170854, 'binary_recall': 0.5209953, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.6436119}
confusion matrix:
       0    1
0  18086   63
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.9517746, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 01:34:22.971069,epoch time: 0:15:30.815790,used: 1:49:33.352442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98298776, 'precision': 0.91261494, 'recall': 0.8035306, 'specificity': 0.8035306, 'f1': 0.8491392, 'auroc': 0.98050886, 'binary_precision': 0.8386194, 'binary_recall': 0.6111489, 'binary_specificity': 0.9959122, 'binary_f1_score': 0.70703894}
confusion matrix:
       0    1
0  42148  173
1    572  899
---- Validation: 
scalar performance:
{'acc': 0.9800979, 'precision': 0.92739004, 'recall': 0.7436783, 'specificity': 0.7436783, 'f1': 0.80863297, 'auroc': 0.972141, 'binary_precision': 0.8725762, 'binary_recall': 0.48989114, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.62749004}
confusion matrix:
       0    1
0  18103   46
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.91341454, 'recall': 0.6160245, 'specificity': 0.6160245, 'f1': 0.6751171, 'auroc': 0.95778334, 'binary_precision': 0.85915494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.36746988}
confusion matrix:
      0   1
0  5987  10
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_8.png
early stop counter: 1
val acc:0.9800978899002075, best validation acc: 0.9802575707435608, corresponding to test acc:                         0.9598913192749023 / 0.9785873889923096
after epoch: 8,now: 2024-06-09 01:49:54.640719,epoch time: 0:15:31.669650,used: 2:05:05.022092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9812523, 'precision': 0.952245, 'recall': 0.7407993, 'specificity': 0.7407993, 'f1': 0.8121761, 'auroc': 0.9840859, 'binary_precision': 0.922179, 'binary_recall': 0.4830163, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.63397235}
confusion matrix:
       0    1
0  42260   60
1    761  711
---- Validation: 
scalar performance:
{'acc': 0.97765005, 'precision': 0.94653267, 'recall': 0.69065714, 'specificity': 0.69065714, 'f1': 0.76401037, 'auroc': 0.97261065, 'binary_precision': 0.91449815, 'binary_recall': 0.38258165, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.53947365}
confusion matrix:
       0    1
0  18126   23
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9568703, 'recall': 0.5382308, 'specificity': 0.5382308, 'f1': 0.5610315, 'auroc': 0.95174146, 'binary_precision': 0.95238096, 'binary_recall': 0.07662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.14184396}
confusion matrix:
      0   1
0  5996   1
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_9.png
early stop counter: 2
val acc:0.9776500463485718, best validation acc: 0.9802575707435608, corresponding to test acc:                         0.9598913192749023 / 0.9785873889923096
after epoch: 9,now: 2024-06-09 02:05:24.420228,epoch time: 0:15:29.779509,used: 2:20:34.801601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9842437, 'precision': 0.91238, 'recall': 0.82791823, 'specificity': 0.82791823, 'f1': 0.86495924, 'auroc': 0.98395294, 'binary_precision': 0.8364888, 'binary_recall': 0.66032606, 'binary_specificity': 0.9955104, 'binary_f1_score': 0.738041}
confusion matrix:
       0    1
0  42130  190
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.9065867, 'recall': 0.8087278, 'specificity': 0.8087278, 'f1': 0.85043985, 'auroc': 0.977813, 'binary_precision': 0.8264463, 'binary_recall': 0.62208396, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7098492}
confusion matrix:
       0    1
0  18065   84
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.84187824, 'recall': 0.56779826, 'specificity': 0.56779826, 'f1': 0.6059646, 'auroc': 0.9476261, 'binary_precision': 0.72, 'binary_recall': 0.13793103, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23151125}
confusion matrix:
      0   1
0  5983  14
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 02:20:57.190674,epoch time: 0:15:32.770446,used: 2:36:07.572047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9850429, 'precision': 0.8813811, 'recall': 0.89113855, 'specificity': 0.89113855, 'f1': 0.8861929, 'auroc': 0.9855965, 'binary_precision': 0.7700464, 'binary_recall': 0.7904762, 'binary_specificity': 0.99180096, 'binary_f1_score': 0.78012764}
confusion matrix:
       0     1
0  41975   347
1    308  1162
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.887676, 'recall': 0.85500467, 'specificity': 0.85500467, 'f1': 0.87056065, 'auroc': 0.9777307, 'binary_precision': 0.78534925, 'binary_recall': 0.7169518, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7495935}
confusion matrix:
       0    1
0  18023  126
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.85015595, 'recall': 0.66208297, 'specificity': 0.66208297, 'f1': 0.7183853, 'auroc': 0.9623859, 'binary_precision': 0.7288136, 'binary_recall': 0.32950193, 'binary_specificity': 0.994664, 'binary_f1_score': 0.45382586}
confusion matrix:
      0   1
0  5965  32
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 02:36:34.198514,epoch time: 0:15:37.007840,used: 2:51:44.579887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98305625, 'precision': 0.96551955, 'recall': 0.7620599, 'specificity': 0.7620599, 'f1': 0.83350015, 'auroc': 0.9867034, 'binary_precision': 0.94730395, 'binary_recall': 0.5251359, 'binary_specificity': 0.9989839, 'binary_f1_score': 0.67569935}
confusion matrix:
       0    1
0  42277   43
1    699  773
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.9503311, 'recall': 0.7372033, 'specificity': 0.7372033, 'f1': 0.808553, 'auroc': 0.9762447, 'binary_precision': 0.9189189, 'binary_recall': 0.47589424, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.62704915}
confusion matrix:
       0    1
0  18122   27
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8863033, 'recall': 0.5720466, 'specificity': 0.5720466, 'f1': 0.6138747, 'auroc': 0.9593031, 'binary_precision': 0.80851066, 'binary_recall': 0.14559387, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.24675325}
confusion matrix:
      0   1
0  5988   9
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_12.png
early stop counter: 1
val acc:0.9806300401687622, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 12,now: 2024-06-09 02:52:14.762042,epoch time: 0:15:40.563528,used: 3:07:25.143415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98479176, 'precision': 0.86675256, 'recall': 0.9179832, 'specificity': 0.9179832, 'f1': 0.8905425, 'auroc': 0.98653984, 'binary_precision': 0.7388724, 'binary_recall': 0.846363, 'binary_specificity': 0.9896033, 'binary_f1_score': 0.78897345}
confusion matrix:
       0     1
0  41881   440
1    226  1245
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.85714877, 'recall': 0.9003447, 'specificity': 0.9003447, 'f1': 0.87739885, 'auroc': 0.9798053, 'binary_precision': 0.7209945, 'binary_recall': 0.8118196, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.76371616}
confusion matrix:
       0    1
0  17947  202
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8212584, 'recall': 0.7136384, 'specificity': 0.7136384, 'f1': 0.755448, 'auroc': 0.95302796, 'binary_precision': 0.6666667, 'binary_recall': 0.43678162, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.52777785}
confusion matrix:
      0    1
0  5940   57
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_13.png
early stop counter: 2
val acc:0.9828118085861206, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 13,now: 2024-06-09 03:07:45.684272,epoch time: 0:15:30.922230,used: 3:22:56.065645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847689, 'precision': 0.8799727, 'recall': 0.88818824, 'specificity': 0.88818824, 'f1': 0.8840327, 'auroc': 0.9863061, 'binary_precision': 0.76744187, 'binary_recall': 0.78464675, 'binary_specificity': 0.9917297, 'binary_f1_score': 0.77594894}
confusion matrix:
       0     1
0  41970   350
1    317  1155
---- Validation: 
scalar performance:
{'acc': 0.9805768, 'precision': 0.84206486, 'recall': 0.8834365, 'specificity': 0.8834365, 'f1': 0.8614569, 'auroc': 0.97805506, 'binary_precision': 0.69198895, 'binary_recall': 0.7791602, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.73299193}
confusion matrix:
       0    1
0  17926  223
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.9103844, 'recall': 0.6311834, 'specificity': 0.6311834, 'f1': 0.6933758, 'auroc': 0.95719075, 'binary_precision': 0.8518519, 'binary_recall': 0.26436782, 'binary_specificity': 0.997999, 'binary_f1_score': 0.40350875}
confusion matrix:
      0   1
0  5985  12
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_14.png
early stop counter: 3
val acc:0.9805768132209778, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 14,now: 2024-06-09 03:23:15.779534,epoch time: 0:15:30.095262,used: 3:38:26.160907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9856138, 'precision': 0.9511936, 'recall': 0.8140757, 'specificity': 0.8140757, 'f1': 0.86948687, 'auroc': 0.9873409, 'binary_precision': 0.9151037, 'binary_recall': 0.6301836, 'binary_specificity': 0.9979679, 'binary_f1_score': 0.7463768}
confusion matrix:
       0    1
0  42235   86
1    544  927
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.9408636, 'recall': 0.7602284, 'specificity': 0.7602284, 'f1': 0.8256661, 'auroc': 0.97627777, 'binary_precision': 0.8983957, 'binary_recall': 0.5225505, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.66076696}
confusion matrix:
       0    1
0  18111   38
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9093665, 'recall': 0.59886646, 'specificity': 0.59886646, 'f1': 0.6525519, 'auroc': 0.96261734, 'binary_precision': 0.852459, 'binary_recall': 0.19923371, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.32298136}
confusion matrix:
      0   1
0  5988   9
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_15.png
early stop counter: 4
val acc:0.9816411137580872, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 15,now: 2024-06-09 03:38:48.952574,epoch time: 0:15:33.173040,used: 3:53:59.333947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9872808, 'precision': 0.91580486, 'recall': 0.8816192, 'specificity': 0.8816192, 'f1': 0.89792055, 'auroc': 0.98864824, 'binary_precision': 0.83964366, 'binary_recall': 0.7683424, 'binary_specificity': 0.99489605, 'binary_f1_score': 0.8024122}
confusion matrix:
       0     1
0  42104   216
1    341  1131
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.90870583, 'recall': 0.8458049, 'specificity': 0.8458049, 'f1': 0.8744223, 'auroc': 0.97937965, 'binary_precision': 0.8280961, 'binary_recall': 0.6967341, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7567568}
confusion matrix:
       0    1
0  18056   93
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8787238, 'recall': 0.60036534, 'specificity': 0.60036534, 'f1': 0.65247804, 'auroc': 0.9523325, 'binary_precision': 0.7910448, 'binary_recall': 0.20306513, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32317072}
confusion matrix:
      0   1
0  5983  14
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 03:54:27.980017,epoch time: 0:15:39.027443,used: 4:09:38.361390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9870068, 'precision': 0.91684294, 'recall': 0.8748369, 'specificity': 0.8748369, 'f1': 0.894637, 'auroc': 0.98958534, 'binary_precision': 0.84218514, 'binary_recall': 0.7545887, 'binary_specificity': 0.9950852, 'binary_f1_score': 0.7959842}
confusion matrix:
       0     1
0  42113   208
1    361  1110
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.92678535, 'recall': 0.8031682, 'specificity': 0.8031682, 'f1': 0.85372937, 'auroc': 0.9755795, 'binary_precision': 0.86725664, 'binary_recall': 0.6096423, 'binary_specificity': 0.996694, 'binary_f1_score': 0.71598184}
confusion matrix:
       0    1
0  18089   60
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.931528, 'recall': 0.6143589, 'specificity': 0.6143589, 'f1': 0.6743939, 'auroc': 0.9650178, 'binary_precision': 0.8955224, 'binary_recall': 0.22988506, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.36585367}
confusion matrix:
      0   1
0  5990   7
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_17.png
early stop counter: 1
val acc:0.9834504127502441, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9645254015922546 / 0.9785873889923096
after epoch: 17,now: 2024-06-09 04:10:02.780922,epoch time: 0:15:34.800905,used: 4:25:13.162295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.983513, 'precision': 0.9717633, 'recall': 0.7655748, 'specificity': 0.7655748, 'f1': 0.83798796, 'auroc': 0.98965424, 'binary_precision': 0.95955884, 'binary_recall': 0.5319294, 'binary_specificity': 0.99922025, 'binary_f1_score': 0.68444055}
confusion matrix:
       0    1
0  42287   33
1    689  783
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.93935984, 'recall': 0.72459626, 'specificity': 0.72459626, 'f1': 0.7949364, 'auroc': 0.9787868, 'binary_precision': 0.8978328, 'binary_recall': 0.45101088, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.6004141}
confusion matrix:
       0    1
0  18116   33
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.9024307, 'recall': 0.5702976, 'specificity': 0.5702976, 'f1': 0.61185277, 'auroc': 0.95232433, 'binary_precision': 0.84090906, 'binary_recall': 0.14176245, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.24262294}
confusion matrix:
      0   1
0  5990   7
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_18.png
early stop counter: 2
val acc:0.9794593453407288, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9645254015922546 / 0.9785873889923096
after epoch: 18,now: 2024-06-09 04:25:38.608286,epoch time: 0:15:35.827364,used: 4:40:48.989659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98771465, 'precision': 0.93615186, 'recall': 0.864795, 'specificity': 0.864795, 'f1': 0.8970537, 'auroc': 0.9911957, 'binary_precision': 0.88153595, 'binary_recall': 0.7330163, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.8004451}
confusion matrix:
       0     1
0  42175   145
1    393  1079
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9235824, 'recall': 0.8177498, 'specificity': 0.8177498, 'f1': 0.8625369, 'auroc': 0.9782612, 'binary_precision': 0.85983264, 'binary_recall': 0.63919127, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7332738}
confusion matrix:
       0    1
0  18082   67
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8914374, 'recall': 0.66308343, 'specificity': 0.66308343, 'f1': 0.7263071, 'auroc': 0.9556188, 'binary_precision': 0.8113208, 'binary_recall': 0.32950193, 'binary_specificity': 0.996665, 'binary_f1_score': 0.46866488}
confusion matrix:
      0   1
0  5977  20
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_19.png
early stop counter: 3
val acc:0.9840889573097229, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9645254015922546 / 0.9785873889923096
after epoch: 19,now: 2024-06-09 04:41:11.933421,epoch time: 0:15:33.325135,used: 4:56:22.314794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98810285, 'precision': 0.91615164, 'recall': 0.89672995, 'specificity': 0.89672995, 'f1': 0.90619, 'auroc': 0.99069667, 'binary_precision': 0.83928573, 'binary_recall': 0.7987763, 'binary_specificity': 0.9946835, 'binary_f1_score': 0.81853014}
confusion matrix:
       0     1
0  42096   225
1    296  1175
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9146228, 'recall': 0.8583568, 'specificity': 0.8583568, 'f1': 0.88427734, 'auroc': 0.9792782, 'binary_precision': 0.83905965, 'binary_recall': 0.7216174, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.7759197}
confusion matrix:
       0    1
0  18060   89
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.951692, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 04:56:47.259756,epoch time: 0:15:35.326335,used: 5:11:57.641129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98945016, 'precision': 0.9461291, 'recall': 0.88438094, 'specificity': 0.88438094, 'f1': 0.91278595, 'auroc': 0.9921095, 'binary_precision': 0.90015846, 'binary_recall': 0.7717391, 'binary_specificity': 0.9970227, 'binary_f1_score': 0.8310168}
confusion matrix:
       0     1
0  42194   126
1    336  1136
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.92212355, 'recall': 0.8346918, 'specificity': 0.8346918, 'f1': 0.8729658, 'auroc': 0.9814576, 'binary_precision': 0.85573125, 'binary_recall': 0.6734059, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.7536989}
confusion matrix:
       0    1
0  18076   73
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.85000813, 'recall': 0.60369647, 'specificity': 0.60369647, 'f1': 0.654413, 'auroc': 0.9427289, 'binary_precision': 0.73333335, 'binary_recall': 0.21072797, 'binary_specificity': 0.996665, 'binary_f1_score': 0.32738096}
confusion matrix:
      0   1
0  5977  20
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_21.png
early stop counter: 1
val acc:0.9849404096603394, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9646852016448975 / 0.9785873889923096
after epoch: 21,now: 2024-06-09 05:12:19.278278,epoch time: 0:15:32.018522,used: 5:27:29.659651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9889249, 'precision': 0.9124154, 'recall': 0.9180994, 'specificity': 0.9180994, 'f1': 0.91523635, 'auroc': 0.99260575, 'binary_precision': 0.83031523, 'binary_recall': 0.84217685, 'binary_specificity': 0.994022, 'binary_f1_score': 0.836204}
confusion matrix:
       0     1
0  42069   253
1    232  1238
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9026715, 'recall': 0.87177515, 'specificity': 0.87177515, 'f1': 0.8865557, 'auroc': 0.9806389, 'binary_precision': 0.8141892, 'binary_recall': 0.7496112, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.7805668}
confusion matrix:
       0    1
0  18039  110
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.8724182, 'recall': 0.7532866, 'specificity': 0.7532866, 'f1': 0.80038583, 'auroc': 0.9650334, 'binary_precision': 0.7657143, 'binary_recall': 0.51341, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.6146789}
confusion matrix:
      0    1
0  5956   41
1   127  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_22.png
early stop counter: 2
val acc:0.9855789542198181, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9646852016448975 / 0.9785873889923096
after epoch: 22,now: 2024-06-09 05:27:54.760790,epoch time: 0:15:35.482512,used: 5:43:05.142163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98655003, 'precision': 0.9742054, 'recall': 0.8119354, 'specificity': 0.8119354, 'f1': 0.8751985, 'auroc': 0.9938334, 'binary_precision': 0.9612971, 'binary_recall': 0.6247451, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.75731355}
confusion matrix:
       0    1
0  42284   37
1    552  919
---- Validation: 
scalar performance:
{'acc': 0.98110896, 'precision': 0.9528496, 'recall': 0.74345165, 'specificity': 0.74345165, 'f1': 0.81458074, 'auroc': 0.9806309, 'binary_precision': 0.9235294, 'binary_recall': 0.48833594, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.63886064}
confusion matrix:
       0    1
0  18123   26
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.90936995, 'recall': 0.57796043, 'specificity': 0.57796043, 'f1': 0.6233882, 'auroc': 0.9275608, 'binary_precision': 0.8541667, 'binary_recall': 0.15708812, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.26537216}
confusion matrix:
      0   1
0  5990   7
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_23.png
early stop counter: 3
val acc:0.9811089634895325, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9646852016448975 / 0.9785873889923096
after epoch: 23,now: 2024-06-09 05:43:33.274678,epoch time: 0:15:38.513888,used: 5:58:43.656051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98913044, 'precision': 0.9236615, 'recall': 0.9058542, 'specificity': 0.9058542, 'f1': 0.9145513, 'auroc': 0.9932294, 'binary_precision': 0.8536932, 'binary_recall': 0.81657606, 'binary_specificity': 0.9951323, 'binary_f1_score': 0.8347222}
confusion matrix:
       0     1
0  42114   206
1    270  1202
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.893196, 'recall': 0.87369466, 'specificity': 0.87369466, 'f1': 0.8831762, 'auroc': 0.9804712, 'binary_precision': 0.795082, 'binary_recall': 0.7542768, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.774142}
confusion matrix:
       0    1
0  18024  125
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8305936, 'recall': 0.6390111, 'specificity': 0.6390111, 'f1': 0.692032, 'auroc': 0.90950537, 'binary_precision': 0.69158876, 'binary_recall': 0.2835249, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.40217394}
confusion matrix:
      0   1
0  5964  33
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_24.png
early stop counter: 4
val acc:0.9849404096603394, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9646852016448975 / 0.9785873889923096
after epoch: 24,now: 2024-06-09 05:59:11.303738,epoch time: 0:15:38.029060,used: 6:14:21.685111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98874223, 'precision': 0.8982533, 'recall': 0.939095, 'specificity': 0.939095, 'f1': 0.9175918, 'auroc': 0.9941459, 'binary_precision': 0.8004911, 'binary_recall': 0.88586956, 'binary_specificity': 0.9923204, 'binary_f1_score': 0.84101903}
confusion matrix:
       0     1
0  41995   325
1    168  1304
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8879664, 'recall': 0.9019151, 'specificity': 0.9019151, 'f1': 0.89480674, 'auroc': 0.98029923, 'binary_precision': 0.7826087, 'binary_recall': 0.8118196, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.7969465}
confusion matrix:
       0    1
0  18004  145
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8739195, 'recall': 0.6078614, 'specificity': 0.6078614, 'f1': 0.66162896, 'auroc': 0.91599846, 'binary_precision': 0.7808219, 'binary_recall': 0.21839081, 'binary_specificity': 0.997332, 'binary_f1_score': 0.34131736}
confusion matrix:
      0   1
0  5981  16
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_25.png
better model found
persisted
after epoch: 25,now: 2024-06-09 06:14:47.267829,epoch time: 0:15:35.964091,used: 6:29:57.649202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9899297, 'precision': 0.9104823, 'recall': 0.9413487, 'specificity': 0.9413487, 'f1': 0.92530894, 'auroc': 0.99397194, 'binary_precision': 0.8248267, 'binary_recall': 0.8892663, 'binary_specificity': 0.993431, 'binary_f1_score': 0.85583526}
confusion matrix:
       0     1
0  42042   278
1    163  1309
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.902153, 'recall': 0.8809962, 'specificity': 0.8809962, 'f1': 0.8912648, 'auroc': 0.98165476, 'binary_precision': 0.8125, 'binary_recall': 0.7682737, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.7897682}
confusion matrix:
       0    1
0  18035  114
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8522546, 'recall': 0.65083885, 'specificity': 0.65083885, 'f1': 0.7075714, 'auroc': 0.9360972, 'binary_precision': 0.73394495, 'binary_recall': 0.3065134, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.43243244}
confusion matrix:
      0   1
0  5968  29
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_26.png
better model found
persisted
after epoch: 26,now: 2024-06-09 06:30:22.734863,epoch time: 0:15:35.467034,used: 6:45:33.116236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.9501678, 'recall': 0.90033793, 'specificity': 0.90033793, 'f1': 0.92368233, 'auroc': 0.99454784, 'binary_precision': 0.9071374, 'binary_recall': 0.803535, 'binary_specificity': 0.9971409, 'binary_f1_score': 0.852199}
confusion matrix:
       0     1
0  42200   121
1    289  1182
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.93823266, 'recall': 0.8467967, 'specificity': 0.8467967, 'f1': 0.88678575, 'auroc': 0.9817257, 'binary_precision': 0.8871287, 'binary_recall': 0.6967341, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7804878}
confusion matrix:
       0    1
0  18092   57
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8335662, 'recall': 0.62218654, 'specificity': 0.62218654, 'f1': 0.67440677, 'auroc': 0.9163656, 'binary_precision': 0.6989247, 'binary_recall': 0.24904214, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3672316}
confusion matrix:
      0   1
0  5969  28
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_27.png
better model found
persisted
after epoch: 27,now: 2024-06-09 06:45:57.139702,epoch time: 0:15:34.404839,used: 7:01:07.521075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9907061, 'precision': 0.92854226, 'recall': 0.92826104, 'specificity': 0.92826104, 'f1': 0.9284016, 'auroc': 0.99458504, 'binary_precision': 0.86190474, 'binary_recall': 0.8613188, 'binary_specificity': 0.9952033, 'binary_f1_score': 0.86161166}
confusion matrix:
       0     1
0  42118   203
1    204  1267
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9232887, 'recall': 0.84785604, 'specificity': 0.84785604, 'f1': 0.8815943, 'auroc': 0.9804183, 'binary_precision': 0.85714287, 'binary_recall': 0.6998445, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.770548}
confusion matrix:
       0    1
0  18074   75
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8330575, 'recall': 0.575211, 'specificity': 0.575211, 'f1': 0.61603045, 'auroc': 0.9209844, 'binary_precision': 0.7017544, 'binary_recall': 0.1532567, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2515723}
confusion matrix:
      0   1
0  5980  17
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_28.png
early stop counter: 1
val acc:0.9857386350631714, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9785873889923096
after epoch: 28,now: 2024-06-09 07:01:34.101035,epoch time: 0:15:36.961333,used: 7:16:44.482408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99102575, 'precision': 0.9685544, 'recall': 0.8884747, 'specificity': 0.8884747, 'f1': 0.9245011, 'auroc': 0.99573123, 'binary_precision': 0.94476503, 'binary_recall': 0.7785326, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.8536313}
confusion matrix:
       0     1
0  42253    67
1    326  1146
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.94480026, 'recall': 0.7920551, 'specificity': 0.7920551, 'f1': 0.85147136, 'auroc': 0.98070824, 'binary_precision': 0.90407676, 'binary_recall': 0.58631414, 'binary_specificity': 0.997796, 'binary_f1_score': 0.71132076}
confusion matrix:
       0    1
0  18109   40
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8787829, 'recall': 0.6665814, 'specificity': 0.6665814, 'f1': 0.7278133, 'auroc': 0.95195377, 'binary_precision': 0.78571427, 'binary_recall': 0.33716476, 'binary_specificity': 0.995998, 'binary_f1_score': 0.4718499}
confusion matrix:
      0   1
0  5973  24
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_29.png
early stop counter: 2
val acc:0.9837164878845215, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.964205801486969 / 0.9785873889923096
after epoch: 29,now: 2024-06-09 07:17:09.680968,epoch time: 0:15:35.579933,used: 7:32:20.062341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.94666564, 'recall': 0.92495275, 'specificity': 0.92495275, 'f1': 0.93551767, 'auroc': 0.99604464, 'binary_precision': 0.8984263, 'binary_recall': 0.8532609, 'binary_specificity': 0.9966446, 'binary_f1_score': 0.8752613}
confusion matrix:
       0     1
0  42178   142
1    216  1256
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.9349041, 'recall': 0.85674024, 'specificity': 0.85674024, 'f1': 0.8916662, 'auroc': 0.9816164, 'binary_precision': 0.879771, 'binary_recall': 0.7169518, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.79006}
confusion matrix:
       0    1
0  18086   63
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.90936995, 'recall': 0.57796043, 'specificity': 0.57796043, 'f1': 0.6233882, 'auroc': 0.91569924, 'binary_precision': 0.8541667, 'binary_recall': 0.15708812, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.26537216}
confusion matrix:
      0   1
0  5990   7
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_30.png
better model found
persisted
after epoch: 30,now: 2024-06-09 07:32:44.663441,epoch time: 0:15:34.982473,used: 7:47:55.044814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_44_49_seed_0_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:47:55.044814 at 2024-06-09 07:32:44.663441
persisted model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.8403441, 'recall': 0.5621345, 'specificity': 0.5621345, 'f1': 0.5976221, 'auroc': 0.92497075, 'binary_precision': 0.7173913, 'binary_recall': 0.12643678, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21498372}
confusion matrix:
      0   1
0  5984  13
1   228  33
oracle model performance metric: 

scalar performance:
{'acc': 0.97746885, 'precision': 0.92987347, 'recall': 0.7646994, 'specificity': 0.7646994, 'f1': 0.8259144, 'auroc': 0.9609486, 'binary_precision': 0.87974685, 'binary_recall': 0.532567, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.66348445}
confusion matrix:
      0    1
0  5978   19
1   122  139
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14522 MiB |  14522 MiB |  14522 MiB |      0 B   |
|       from large pool |  14450 MiB |  14450 MiB |  14450 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 537683 KiB |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool | 526122 KiB |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94720 K  |   94717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94720 K  |   94717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     639    |     639    |     639    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |    2811    |  109599 K  |  109599 K  |
|       from large pool |      46    |     600    |   60597 K  |   60597 K  |
|       from small pool |      42    |    2764    |   49002 K  |   49002 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1016 MiB |  14522 MiB |  14522 MiB |  13506 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |     639    |     570    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  109600 K  |  109600 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   49003 K  |   49003 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1016 MiB |  14522 MiB |  14522 MiB |  13506 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |     639    |     570    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  109600 K  |  109600 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   49003 K  |   49003 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160

 Experiment start at: 2024-06-09 07:41:34.511419
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9698787, 'precision': 0.80707645, 'recall': 0.5935382, 'specificity': 0.5935382, 'f1': 0.63928574, 'auroc': 0.95051455, 'binary_precision': 0.64102566, 'binary_recall': 0.19070736, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.29396045}
confusion matrix:
       0    1
0  42260  154
1   1167  275
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.76419604, 'recall': 0.525971, 'specificity': 0.525971, 'f1': 0.5397973, 'auroc': 0.94867235, 'binary_precision': 0.5625, 'binary_recall': 0.053491827, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.097693354}
confusion matrix:
       0   1
0  18039  28
1    637  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.93029726, 'recall': 0.5822719, 'specificity': 0.5822719, 'f1': 0.6304399, 'auroc': 0.9495375, 'binary_precision': 0.8958333, 'binary_recall': 0.16538462, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.2792208}
confusion matrix:
      0   1
0  5941   5
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 07:57:57.119050,epoch time: 0:16:22.607631,used: 0:16:22.607631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97291136, 'precision': 0.8003305, 'recall': 0.72439766, 'specificity': 0.72439766, 'f1': 0.75637496, 'auroc': 0.95937324, 'binary_precision': 0.6189138, 'binary_recall': 0.45839113, 'binary_specificity': 0.9904041, 'binary_f1_score': 0.5266932}
confusion matrix:
       0    1
0  42007  407
1    781  661
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.8007294, 'recall': 0.72073454, 'specificity': 0.72073454, 'f1': 0.7539908, 'auroc': 0.95381796, 'binary_precision': 0.62167686, 'binary_recall': 0.45170876, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.5232358}
confusion matrix:
       0    1
0  17882  185
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8685269, 'recall': 0.66127515, 'specificity': 0.66127515, 'f1': 0.72076404, 'auroc': 0.95443285, 'binary_precision': 0.7657658, 'binary_recall': 0.32692307, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.45822108}
confusion matrix:
      0   1
0  5920  26
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 08:13:13.627287,epoch time: 0:15:16.508237,used: 0:31:39.115868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9721361, 'precision': 0.88706326, 'recall': 0.6007344, 'specificity': 0.6007344, 'f1': 0.6549449, 'auroc': 0.9669324, 'binary_precision': 0.80054647, 'binary_recall': 0.20319001, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.32411504}
confusion matrix:
       0    1
0  42341   73
1   1149  293
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.87772274, 'recall': 0.5808934, 'specificity': 0.5808934, 'f1': 0.627215, 'auroc': 0.96693635, 'binary_precision': 0.78571427, 'binary_recall': 0.16344725, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.27060267}
confusion matrix:
       0    1
0  18037   30
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.82588905, 'recall': 0.51697135, 'specificity': 0.51697135, 'f1': 0.5224637, 'auroc': 0.9581601, 'binary_precision': 0.6923077, 'binary_recall': 0.034615386, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.06593407}
confusion matrix:
      0  1
0  5942  4
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_3.png
early stop counter: 1
val acc:0.9683564305305481, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 3,now: 2024-06-09 08:28:25.386013,epoch time: 0:15:11.758726,used: 0:46:50.874594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9708136, 'precision': 0.95322394, 'recall': 0.5601914, 'specificity': 0.5601914, 'f1': 0.599445, 'auroc': 0.96699226, 'binary_precision': 0.9354839, 'binary_recall': 0.120665744, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.21375921}
confusion matrix:
       0    1
0  42402   12
1   1268  174
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.96486473, 'recall': 0.5385776, 'specificity': 0.5385776, 'f1': 0.56305134, 'auroc': 0.95663047, 'binary_precision': 0.962963, 'binary_recall': 0.07726597, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.14305364}
confusion matrix:
       0   1
0  18065   2
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.9463464, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_4.png
early stop counter: 2
val acc:0.9667556285858154, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 4,now: 2024-06-09 08:43:35.921193,epoch time: 0:15:10.535180,used: 1:02:01.409774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9797747, 'precision': 0.8983786, 'recall': 0.74770814, 'specificity': 0.74770814, 'f1': 0.80421716, 'auroc': 0.97472465, 'binary_precision': 0.8135593, 'binary_recall': 0.49930653, 'binary_specificity': 0.9961098, 'binary_f1_score': 0.6188225}
confusion matrix:
       0    1
0  42249  165
1    722  720
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.9291235, 'recall': 0.6308642, 'specificity': 0.6308642, 'f1': 0.69566035, 'auroc': 0.9658298, 'binary_precision': 0.885, 'binary_recall': 0.26300147, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.40549827}
confusion matrix:
       0    1
0  18044   23
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.77456594, 'recall': 0.5503254, 'specificity': 0.5503254, 'f1': 0.5778273, 'auroc': 0.9580641, 'binary_precision': 0.5869565, 'binary_recall': 0.103846155, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5927  19
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 08:58:57.154619,epoch time: 0:15:21.233426,used: 1:17:22.643200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98055, 'precision': 0.8415524, 'recall': 0.8623276, 'specificity': 0.8623276, 'f1': 0.8516054, 'auroc': 0.975942, 'binary_precision': 0.69210696, 'binary_recall': 0.73578364, 'binary_specificity': 0.9888716, 'binary_f1_score': 0.71327734}
confusion matrix:
       0     1
0  41942   472
1    381  1061
---- Validation: 
scalar performance:
{'acc': 0.9784952, 'precision': 0.8580749, 'recall': 0.8143219, 'specificity': 0.8143219, 'f1': 0.83464277, 'auroc': 0.9706701, 'binary_precision': 0.72959185, 'binary_recall': 0.63744426, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.68041235}
confusion matrix:
       0    1
0  17908  159
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.791841, 'recall': 0.7223712, 'specificity': 0.7223712, 'f1': 0.7518481, 'auroc': 0.952351, 'binary_precision': 0.60714287, 'binary_recall': 0.4576923, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.5219298}
confusion matrix:
      0    1
0  5869   77
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 09:14:28.610332,epoch time: 0:15:31.455713,used: 1:32:54.098913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97895384, 'precision': 0.82546544, 'recall': 0.86518687, 'specificity': 0.86518687, 'f1': 0.844075, 'auroc': 0.9785217, 'binary_precision': 0.6596923, 'binary_recall': 0.7434119, 'binary_specificity': 0.98696184, 'binary_f1_score': 0.6990544}
confusion matrix:
       0     1
0  41861   553
1    370  1072
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.85905373, 'recall': 0.83484745, 'specificity': 0.83484745, 'f1': 0.8464886, 'auroc': 0.9720572, 'binary_precision': 0.73003197, 'binary_recall': 0.679049, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.70361817}
confusion matrix:
       0    1
0  17898  169
1    216  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7858212, 'recall': 0.61954516, 'specificity': 0.61954516, 'f1': 0.6649846, 'auroc': 0.9581695, 'binary_precision': 0.6037736, 'binary_recall': 0.24615385, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.34972677}
confusion matrix:
      0   1
0  5904  42
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 09:29:44.990440,epoch time: 0:15:16.380108,used: 1:48:10.479021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9785662, 'precision': 0.8155782, 'recall': 0.89439464, 'specificity': 0.89439464, 'f1': 0.85017455, 'auroc': 0.9820689, 'binary_precision': 0.6378646, 'binary_recall': 0.8043026, 'binary_specificity': 0.98448664, 'binary_f1_score': 0.7114794}
confusion matrix:
       0     1
0  41757   658
1    282  1159
---- Validation: 
scalar performance:
{'acc': 0.9761473, 'precision': 0.81967545, 'recall': 0.8574507, 'specificity': 0.8574507, 'f1': 0.83739734, 'auroc': 0.9748908, 'binary_precision': 0.6494709, 'binary_recall': 0.7295691, 'binary_specificity': 0.98533237, 'binary_f1_score': 0.6871939}
confusion matrix:
       0    1
0  17802  265
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7742832, 'recall': 0.59872764, 'specificity': 0.59872764, 'f1': 0.6408405, 'auroc': 0.9534395, 'binary_precision': 0.5824176, 'binary_recall': 0.20384616, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.30199432}
confusion matrix:
      0   1
0  5908  38
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_8.png
early stop counter: 1
val acc:0.9761472940444946, best validation acc: 0.9794557094573975, corresponding to test acc:                         0.961650013923645 / 0.9676119685173035
after epoch: 8,now: 2024-06-09 09:45:00.588176,epoch time: 0:15:15.597736,used: 2:03:26.076757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9836739, 'precision': 0.86118865, 'recall': 0.8954281, 'specificity': 0.8954281, 'f1': 0.8774646, 'auroc': 0.9848274, 'binary_precision': 0.7291667, 'binary_recall': 0.80097085, 'binary_specificity': 0.9898854, 'binary_f1_score': 0.763384}
confusion matrix:
       0     1
0  41985   429
1    287  1155
---- Validation: 
scalar performance:
{'acc': 0.9813767, 'precision': 0.8624809, 'recall': 0.87232244, 'specificity': 0.87232244, 'f1': 0.86732936, 'auroc': 0.9753472, 'binary_precision': 0.73410404, 'binary_recall': 0.7548291, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.74432236}
confusion matrix:
       0    1
0  17883  184
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.72673225, 'recall': 0.602731, 'specificity': 0.602731, 'f1': 0.63840866, 'auroc': 0.9496777, 'binary_precision': 0.4869565, 'binary_recall': 0.21538462, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.29866666}
confusion matrix:
      0   1
0  5887  59
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_9.png
better model found
persisted
after epoch: 9,now: 2024-06-09 10:00:20.610760,epoch time: 0:15:20.022584,used: 2:18:46.099341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98004836, 'precision': 0.94341695, 'recall': 0.71870875, 'specificity': 0.71870875, 'f1': 0.79054356, 'auroc': 0.98384786, 'binary_precision': 0.9055794, 'binary_recall': 0.43897364, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.59131247}
confusion matrix:
       0    1
0  42348   66
1    809  633
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.9128324, 'recall': 0.71547234, 'specificity': 0.71547234, 'f1': 0.7808856, 'auroc': 0.9765129, 'binary_precision': 0.84637684, 'binary_recall': 0.43387815, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.5736739}
confusion matrix:
       0    1
0  18014   53
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7074283, 'recall': 0.52733254, 'specificity': 0.52733254, 'f1': 0.5403438, 'auroc': 0.9428637, 'binary_precision': 0.45454547, 'binary_recall': 0.057692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.102389075}
confusion matrix:
      0   1
0  5928  18
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_10.png
early stop counter: 1
val acc:0.9768409729003906, best validation acc: 0.9813767075538635, corresponding to test acc:                         0.9576216340065002 / 0.9676119685173035
after epoch: 10,now: 2024-06-09 10:15:36.526782,epoch time: 0:15:15.916022,used: 2:34:02.015363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9848139, 'precision': 0.9252434, 'recall': 0.8183087, 'specificity': 0.8183087, 'f1': 0.8635278, 'auroc': 0.986413, 'binary_precision': 0.86261684, 'binary_recall': 0.6400832, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.7348726}
confusion matrix:
       0    1
0  42267  147
1    519  923
---- Validation: 
scalar performance:
{'acc': 0.9814301, 'precision': 0.9330411, 'recall': 0.77721953, 'specificity': 0.77721953, 'f1': 0.8367474, 'auroc': 0.9781101, 'binary_precision': 0.88235295, 'binary_recall': 0.5572065, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.6830601}
confusion matrix:
       0    1
0  18017   50
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7226608, 'recall': 0.52933973, 'specificity': 0.52933973, 'f1': 0.54383934, 'auroc': 0.95178884, 'binary_precision': 0.4848485, 'binary_recall': 0.06153846, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.10921502}
confusion matrix:
      0   1
0  5929  17
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 10:30:56.809635,epoch time: 0:15:20.282853,used: 2:49:22.298216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9860224, 'precision': 0.90394354, 'recall': 0.8678365, 'specificity': 0.8678365, 'f1': 0.8849784, 'auroc': 0.98667145, 'binary_precision': 0.8166539, 'binary_recall': 0.74133146, 'binary_specificity': 0.9943415, 'binary_f1_score': 0.77717197}
confusion matrix:
       0     1
0  42174   240
1    373  1069
---- Validation: 
scalar performance:
{'acc': 0.9815368, 'precision': 0.88376725, 'recall': 0.8352115, 'specificity': 0.8352115, 'f1': 0.85770404, 'auroc': 0.9783339, 'binary_precision': 0.7794872, 'binary_recall': 0.67756313, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.72496027}
confusion matrix:
       0    1
0  17938  129
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.785115, 'recall': 0.5747367, 'specificity': 0.5747367, 'f1': 0.61252236, 'auroc': 0.9581532, 'binary_precision': 0.6060606, 'binary_recall': 0.15384616, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.24539877}
confusion matrix:
      0   1
0  5920  26
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 10:46:14.178103,epoch time: 0:15:17.368468,used: 3:04:39.666684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9859768, 'precision': 0.89311576, 'recall': 0.8838906, 'specificity': 0.8838906, 'f1': 0.8884439, 'auroc': 0.98793817, 'binary_precision': 0.7938877, 'binary_recall': 0.77461857, 'binary_specificity': 0.99316263, 'binary_f1_score': 0.78413475}
confusion matrix:
       0     1
0  42124   290
1    325  1117
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.8953042, 'recall': 0.8658105, 'specificity': 0.8658105, 'f1': 0.87993515, 'auroc': 0.9782921, 'binary_precision': 0.80032206, 'binary_recall': 0.7384844, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.76816076}
confusion matrix:
       0    1
0  17943  124
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7876648, 'recall': 0.6046651, 'specificity': 0.6046651, 'f1': 0.64914066, 'auroc': 0.9570809, 'binary_precision': 0.6086956, 'binary_recall': 0.21538462, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.31818184}
confusion matrix:
      0   1
0  5910  36
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_13.png
better model found
persisted
after epoch: 13,now: 2024-06-09 11:01:20.925911,epoch time: 0:15:06.747808,used: 3:19:46.414492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9868661, 'precision': 0.94534135, 'recall': 0.8357823, 'specificity': 0.8357823, 'f1': 0.8823337, 'auroc': 0.9881384, 'binary_precision': 0.90166974, 'binary_recall': 0.6740638, 'binary_specificity': 0.99750084, 'binary_f1_score': 0.7714286}
confusion matrix:
       0    1
0  42308  106
1    470  972
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.91668284, 'recall': 0.8246805, 'specificity': 0.8246805, 'f1': 0.8645053, 'auroc': 0.97948325, 'binary_precision': 0.84615386, 'binary_recall': 0.653789, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.73763627}
confusion matrix:
       0    1
0  17987   80
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8512211, 'recall': 0.5643755, 'specificity': 0.5643755, 'f1': 0.6012813, 'auroc': 0.9448394, 'binary_precision': 0.73913044, 'binary_recall': 0.13076924, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5934  12
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_14.png
early stop counter: 1
val acc:0.9832977652549744, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 14,now: 2024-06-09 11:16:31.460794,epoch time: 0:15:10.534883,used: 3:34:56.949375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98522437, 'precision': 0.95316577, 'recall': 0.80076844, 'specificity': 0.80076844, 'f1': 0.8605243, 'auroc': 0.9876617, 'binary_precision': 0.91966176, 'binary_recall': 0.6033287, 'binary_specificity': 0.99820817, 'binary_f1_score': 0.7286432}
confusion matrix:
       0    1
0  42338   76
1    572  870
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.92599535, 'recall': 0.81392384, 'specificity': 0.81392384, 'f1': 0.8607971, 'auroc': 0.976948, 'binary_precision': 0.86558044, 'binary_recall': 0.6315007, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.7302405}
confusion matrix:
       0    1
0  18001   66
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8119049, 'recall': 0.56579405, 'specificity': 0.56579405, 'f1': 0.6017789, 'auroc': 0.9485239, 'binary_precision': 0.6603774, 'binary_recall': 0.13461539, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5928  18
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_15.png
early stop counter: 2
val acc:0.9832444190979004, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 15,now: 2024-06-09 11:31:50.120531,epoch time: 0:15:18.659737,used: 3:50:15.609112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9864557, 'precision': 0.89976215, 'recall': 0.8831333, 'specificity': 0.8831333, 'f1': 0.8912568, 'auroc': 0.9890913, 'binary_precision': 0.8072464, 'binary_recall': 0.7725381, 'binary_specificity': 0.99372846, 'binary_f1_score': 0.78951097}
confusion matrix:
       0     1
0  42148   266
1    328  1114
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.8785114, 'recall': 0.8562587, 'specificity': 0.8562587, 'f1': 0.8670172, 'auroc': 0.9775081, 'binary_precision': 0.7674051, 'binary_recall': 0.7206538, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.743295}
confusion matrix:
       0    1
0  17920  147
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8208538, 'recall': 0.6242322, 'specificity': 0.6242322, 'f1': 0.6749831, 'auroc': 0.96108353, 'binary_precision': 0.67346936, 'binary_recall': 0.25384617, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3687151}
confusion matrix:
      0   1
0  5914  32
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_16.png
early stop counter: 3
val acc:0.9821237921714783, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 16,now: 2024-06-09 11:46:55.055562,epoch time: 0:15:04.935031,used: 4:05:20.544143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98873585, 'precision': 0.9138615, 'recall': 0.90775883, 'specificity': 0.90775883, 'f1': 0.9107857, 'auroc': 0.9912807, 'binary_precision': 0.8338028, 'binary_recall': 0.8210818, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.8273934}
confusion matrix:
       0     1
0  42178   236
1    258  1184
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.8968069, 'recall': 0.8768993, 'specificity': 0.8768993, 'f1': 0.88657415, 'auroc': 0.97980225, 'binary_precision': 0.8025078, 'binary_recall': 0.76077265, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.78108317}
confusion matrix:
       0    1
0  17941  126
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8390486, 'recall': 0.6378619, 'specificity': 0.6378619, 'f1': 0.69209707, 'auroc': 0.96093106, 'binary_precision': 0.70873785, 'binary_recall': 0.28076923, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.40220386}
confusion matrix:
      0   1
0  5916  30
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_17.png
better model found
persisted
after epoch: 17,now: 2024-06-09 12:01:59.597083,epoch time: 0:15:04.541521,used: 4:20:25.085664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9870485, 'precision': 0.89877594, 'recall': 0.8971728, 'specificity': 0.8971728, 'f1': 0.8979726, 'auroc': 0.9892374, 'binary_precision': 0.80431753, 'binary_recall': 0.80097085, 'binary_specificity': 0.9933748, 'binary_f1_score': 0.8026407}
confusion matrix:
       0     1
0  42133   281
1    287  1155
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.8864205, 'recall': 0.87202656, 'specificity': 0.87202656, 'f1': 0.8790745, 'auroc': 0.9800149, 'binary_precision': 0.7820711, 'binary_recall': 0.75185734, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.7666667}
confusion matrix:
       0    1
0  17926  141
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8051697, 'recall': 0.6050855, 'specificity': 0.6050855, 'f1': 0.65164435, 'auroc': 0.9547218, 'binary_precision': 0.6436782, 'binary_recall': 0.21538462, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.32276657}
confusion matrix:
      0   1
0  5915  31
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_18.png
early stop counter: 1
val acc:0.983564555644989, best validation acc: 0.9846851825714111, corresponding to test acc:                         0.9650338292121887 / 0.9676119685173035
after epoch: 18,now: 2024-06-09 12:17:10.116358,epoch time: 0:15:10.519275,used: 4:35:35.604939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9888499, 'precision': 0.94441724, 'recall': 0.87164295, 'specificity': 0.87164295, 'f1': 0.90454733, 'auroc': 0.991441, 'binary_precision': 0.8974145, 'binary_recall': 0.74618584, 'binary_specificity': 0.9971, 'binary_f1_score': 0.8148428}
confusion matrix:
       0     1
0  42291   123
1    366  1076
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9109467, 'recall': 0.8428943, 'specificity': 0.8428943, 'f1': 0.8735899, 'auroc': 0.9801985, 'binary_precision': 0.8333333, 'binary_recall': 0.6909361, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.7554833}
confusion matrix:
       0    1
0  17974   93
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.83339816, 'recall': 0.5887028, 'specificity': 0.5887028, 'f1': 0.63409084, 'auroc': 0.95731646, 'binary_precision': 0.70149255, 'binary_recall': 0.18076923, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2874618}
confusion matrix:
      0   1
0  5926  20
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_19.png
early stop counter: 2
val acc:0.9839380979537964, best validation acc: 0.9846851825714111, corresponding to test acc:                         0.9650338292121887 / 0.9676119685173035
after epoch: 19,now: 2024-06-09 12:32:19.073412,epoch time: 0:15:08.957054,used: 4:50:44.561993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98951113, 'precision': 0.9494858, 'recall': 0.87801397, 'specificity': 0.87801397, 'f1': 0.91043806, 'auroc': 0.9918406, 'binary_precision': 0.907131, 'binary_recall': 0.75866854, 'binary_specificity': 0.99735934, 'binary_f1_score': 0.82628393}
confusion matrix:
       0     1
0  42302   112
1    348  1094
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.92510414, 'recall': 0.8559394, 'specificity': 0.8559394, 'f1': 0.88720584, 'auroc': 0.9802256, 'binary_precision': 0.86071426, 'binary_recall': 0.7161961, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.78183293}
confusion matrix:
       0    1
0  17989   78
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8358165, 'recall': 0.5642074, 'specificity': 0.5642074, 'f1': 0.60047555, 'auroc': 0.95708054, 'binary_precision': 0.7083333, 'binary_recall': 0.13076924, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.22077924}
confusion matrix:
      0   1
0  5932  14
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 12:47:35.155003,epoch time: 0:15:16.081591,used: 5:06:00.643584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98903227, 'precision': 0.9603704, 'recall': 0.859344, 'specificity': 0.859344, 'f1': 0.90319365, 'auroc': 0.99290824, 'binary_precision': 0.9301701, 'binary_recall': 0.72052705, 'binary_specificity': 0.99816096, 'binary_f1_score': 0.812036}
confusion matrix:
       0     1
0  42336    78
1    403  1039
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.9152523, 'recall': 0.7877825, 'specificity': 0.7877825, 'f1': 0.83904546, 'auroc': 0.9785033, 'binary_precision': 0.84598696, 'binary_recall': 0.5794948, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.6878306}
confusion matrix:
       0    1
0  17996   71
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.80703795, 'recall': 0.5901213, 'specificity': 0.5901213, 'f1': 0.63385993, 'auroc': 0.93611586, 'binary_precision': 0.6486486, 'binary_recall': 0.18461539, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5920  26
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_21.png
early stop counter: 1
val acc:0.9811099171638489, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 21,now: 2024-06-09 13:02:48.349656,epoch time: 0:15:13.194653,used: 5:21:13.838237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98971635, 'precision': 0.9291618, 'recall': 0.90525115, 'specificity': 0.90525115, 'f1': 0.91683733, 'auroc': 0.9929221, 'binary_precision': 0.8646063, 'binary_recall': 0.8148405, 'binary_specificity': 0.9956618, 'binary_f1_score': 0.83898604}
confusion matrix:
       0     1
0  42230   184
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.8982118, 'recall': 0.82475924, 'specificity': 0.82475924, 'f1': 0.85743594, 'auroc': 0.98066616, 'binary_precision': 0.8091743, 'binary_recall': 0.65527487, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7241379}
confusion matrix:
       0    1
0  17963  104
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.81838834, 'recall': 0.6467205, 'specificity': 0.6467205, 'f1': 0.697715, 'auroc': 0.95198697, 'binary_precision': 0.6666667, 'binary_recall': 0.3, 'binary_specificity': 0.993441, 'binary_f1_score': 0.41379312}
confusion matrix:
      0   1
0  5907  39
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_22.png
early stop counter: 2
val acc:0.9820704460144043, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 22,now: 2024-06-09 13:17:55.622227,epoch time: 0:15:07.272571,used: 5:36:21.110808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9893515, 'precision': 0.9431074, 'recall': 0.88195086, 'specificity': 0.88195086, 'f1': 0.9100946, 'auroc': 0.99183965, 'binary_precision': 0.89409864, 'binary_recall': 0.7669903, 'binary_specificity': 0.9969114, 'binary_f1_score': 0.8256812}
confusion matrix:
       0     1
0  42283   131
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.91291046, 'recall': 0.8481226, 'specificity': 0.8481226, 'f1': 0.87752616, 'auroc': 0.98135847, 'binary_precision': 0.83687943, 'binary_recall': 0.7013373, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.7631366}
confusion matrix:
       0    1
0  17975   92
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8599994, 'recall': 0.6042556, 'specificity': 0.6042556, 'f1': 0.6559343, 'auroc': 0.95305, 'binary_precision': 0.75342464, 'binary_recall': 0.21153846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.33033034}
confusion matrix:
      0   1
0  5928  18
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_23.png
early stop counter: 3
val acc:0.9843649864196777, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 23,now: 2024-06-09 13:32:59.092835,epoch time: 0:15:03.470608,used: 5:51:24.581416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9910616, 'precision': 0.9362351, 'recall': 0.92101955, 'specificity': 0.92101955, 'f1': 0.9284818, 'auroc': 0.9936451, 'binary_precision': 0.8776978, 'binary_recall': 0.84604716, 'binary_specificity': 0.9959919, 'binary_f1_score': 0.8615819}
confusion matrix:
       0     1
0  42244   170
1    222  1220
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.90178823, 'recall': 0.8712325, 'specificity': 0.8712325, 'f1': 0.88585335, 'auroc': 0.98035884, 'binary_precision': 0.8129032, 'binary_recall': 0.7488856, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.7795824}
confusion matrix:
       0    1
0  17951  116
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.81063807, 'recall': 0.6033306, 'specificity': 0.6033306, 'f1': 0.6501887, 'auroc': 0.94667375, 'binary_precision': 0.6547619, 'binary_recall': 0.21153846, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.31976745}
confusion matrix:
      0   1
0  5917  29
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_24.png
early stop counter: 4
val acc:0.9847918748855591, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 24,now: 2024-06-09 13:48:04.433536,epoch time: 0:15:05.340701,used: 6:06:29.922117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9913125, 'precision': 0.9330499, 'recall': 0.92985797, 'specificity': 0.92985797, 'f1': 0.9314476, 'auroc': 0.9943362, 'binary_precision': 0.8707198, 'binary_recall': 0.8640777, 'binary_specificity': 0.99563825, 'binary_f1_score': 0.867386}
confusion matrix:
       0     1
0  42229   185
1    196  1246
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9004808, 'recall': 0.8711772, 'specificity': 0.8711772, 'f1': 0.8852234, 'auroc': 0.98177254, 'binary_precision': 0.8102894, 'binary_recall': 0.7488856, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.7783783}
confusion matrix:
       0    1
0  17949  118
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8739061, 'recall': 0.64622694, 'specificity': 0.64622694, 'f1': 0.70598054, 'auroc': 0.9546982, 'binary_precision': 0.7777778, 'binary_recall': 0.29615384, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.42896932}
confusion matrix:
      0   1
0  5924  22
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_25.png
early stop counter: 5
val acc:0.9846851825714111, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9613277316093445 / 0.9676119685173035
after epoch: 25,now: 2024-06-09 14:03:13.639301,epoch time: 0:15:09.205765,used: 6:21:39.127882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99113005, 'precision': 0.92776835, 'recall': 0.93378305, 'specificity': 0.93378305, 'f1': 0.93075305, 'auroc': 0.9949354, 'binary_precision': 0.859877, 'binary_recall': 0.87239945, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.866093}
confusion matrix:
       0     1
0  42209   205
1    184  1258
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.920053, 'recall': 0.8911302, 'specificity': 0.8911302, 'f1': 0.90503156, 'auroc': 0.9815417, 'binary_precision': 0.848, 'binary_recall': 0.78751856, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.816641}
confusion matrix:
       0    1
0  17972   95
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.87899315, 'recall': 0.63494074, 'specificity': 0.63494074, 'f1': 0.694235, 'auroc': 0.95675904, 'binary_precision': 0.7888889, 'binary_recall': 0.27307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.40571427}
confusion matrix:
      0   1
0  5927  19
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_26.png
better model found
persisted
after epoch: 26,now: 2024-06-09 14:18:20.865648,epoch time: 0:15:07.226347,used: 6:36:46.354229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99056, 'precision': 0.9334303, 'recall': 0.915401, 'specificity': 0.915401, 'f1': 0.92420936, 'auroc': 0.99458706, 'binary_precision': 0.87246376, 'binary_recall': 0.83495146, 'binary_specificity': 0.99585044, 'binary_f1_score': 0.85329556}
confusion matrix:
       0     1
0  42238   176
1    238  1204
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.9287286, 'recall': 0.87820005, 'specificity': 0.87820005, 'f1': 0.90174985, 'auroc': 0.98119354, 'binary_precision': 0.86632824, 'binary_recall': 0.76077265, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.81012654}
confusion matrix:
       0    1
0  17988   79
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8785114, 'recall': 0.57984424, 'specificity': 0.57984424, 'f1': 0.6247217, 'auroc': 0.9428604, 'binary_precision': 0.7924528, 'binary_recall': 0.16153847, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2683706}
confusion matrix:
      0   1
0  5935  11
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_27.png
early stop counter: 1
val acc:0.9871931672096252, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9664840698242188 / 0.9676119685173035
after epoch: 27,now: 2024-06-09 14:33:27.209819,epoch time: 0:15:06.344171,used: 6:51:52.698400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99097043, 'precision': 0.94083357, 'recall': 0.9136034, 'specificity': 0.9136034, 'f1': 0.9267515, 'auroc': 0.9945247, 'binary_precision': 0.8874074, 'binary_recall': 0.8307906, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.85816616}
confusion matrix:
       0     1
0  42262   152
1    244  1198
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.8991342, 'recall': 0.86303246, 'specificity': 0.86303246, 'f1': 0.88015306, 'auroc': 0.9814298, 'binary_precision': 0.8081967, 'binary_recall': 0.73254085, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.76851124}
confusion matrix:
       0    1
0  17950  117
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8693441, 'recall': 0.5968156, 'specificity': 0.5968156, 'f1': 0.6471748, 'auroc': 0.9413073, 'binary_precision': 0.77272725, 'binary_recall': 0.19615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.3128834}
confusion matrix:
      0   1
0  5931  15
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_28.png
early stop counter: 2
val acc:0.9841515421867371, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9664840698242188 / 0.9676119685173035
after epoch: 28,now: 2024-06-09 14:48:32.377260,epoch time: 0:15:05.167441,used: 7:06:57.865841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9914037, 'precision': 0.9322951, 'recall': 0.9325847, 'specificity': 0.9325847, 'f1': 0.9324398, 'auroc': 0.9939815, 'binary_precision': 0.86902285, 'binary_recall': 0.8696255, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.869324}
confusion matrix:
       0     1
0  42225   189
1    188  1254
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9063698, 'recall': 0.8596499, 'specificity': 0.8596499, 'f1': 0.8814621, 'auroc': 0.981409, 'binary_precision': 0.8229342, 'binary_recall': 0.7251114, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.7709321}
confusion matrix:
       0    1
0  17962  105
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8406795, 'recall': 0.58126277, 'specificity': 0.58126277, 'f1': 0.6246992, 'auroc': 0.9512885, 'binary_precision': 0.71666664, 'binary_recall': 0.16538462, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.26875}
confusion matrix:
      0   1
0  5929  17
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_29.png
early stop counter: 3
val acc:0.9845250844955444, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9664840698242188 / 0.9676119685173035
after epoch: 29,now: 2024-06-09 15:03:37.453548,epoch time: 0:15:05.076288,used: 7:22:02.942129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9916545, 'precision': 0.9570559, 'recall': 0.90725803, 'specificity': 0.90725803, 'f1': 0.93061686, 'auroc': 0.99624676, 'binary_precision': 0.9203125, 'binary_recall': 0.81692094, 'binary_specificity': 0.99759513, 'binary_f1_score': 0.8655401}
confusion matrix:
       0     1
0  42312   102
1    264  1178
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9414513, 'recall': 0.8491188, 'specificity': 0.8491188, 'f1': 0.88946384, 'auroc': 0.9809873, 'binary_precision': 0.8939394, 'binary_recall': 0.7013373, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.78601164}
confusion matrix:
       0    1
0  18011   56
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8972554, 'recall': 0.5381252, 'specificity': 0.5381252, 'f1': 0.5603632, 'auroc': 0.9493103, 'binary_precision': 0.8333333, 'binary_recall': 0.07692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.14084508}
confusion matrix:
      0   1
0  5942   4
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_30.png
early stop counter: 4
val acc:0.9862860441207886, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9664840698242188 / 0.9676119685173035
after epoch: 30,now: 2024-06-09 15:18:41.802751,epoch time: 0:15:04.349203,used: 7:37:07.291332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_07_41_34_seed_1_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:37:07.291332 at 2024-06-09 15:18:41.802751
persisted model performance metric: 

scalar performance:
{'acc': 0.9661618, 'precision': 0.8830467, 'recall': 0.6274166, 'specificity': 0.6274166, 'f1': 0.68606675, 'auroc': 0.95344865, 'binary_precision': 0.79761904, 'binary_recall': 0.2576923, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3895349}
confusion matrix:
      0   1
0  5929  17
1   193  67
oracle model performance metric: 

scalar performance:
{'acc': 0.9690622, 'precision': 0.8827586, 'recall': 0.67490494, 'specificity': 0.67490494, 'f1': 0.73670477, 'auroc': 0.9591603, 'binary_precision': 0.79310346, 'binary_recall': 0.35384616, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.4893617}
confusion matrix:
      0   1
0  5922  24
1   168  92
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502239 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502239 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496647 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14504 MiB |  14522 MiB |  28010 MiB |  13506 MiB |
|       from large pool |  14438 MiB |  14450 MiB |  27924 MiB |  13486 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 517665 KiB |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool | 506092 KiB |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |  11572 KiB |     37 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395836 K  |  395833 K  |
|       from large pool |     187    |    1413    |  206181 K  |  206181 K  |
|       from small pool |    3277    |    6298    |  189654 K  |  189651 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395836 K  |  395833 K  |
|       from large pool |     187    |    1413    |  206181 K  |  206181 K  |
|       from small pool |    3277    |    6298    |  189654 K  |  189651 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     639    |    1207    |     570    |
|       from large pool |     604    |     604    |    1164    |     560    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      86    |    2812    |  231813 K  |  231813 K  |
|       from large pool |      42    |     600    |  133285 K  |  133285 K  |
|       from small pool |      44    |    2768    |   98528 K  |   98528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14522 MiB |  28010 MiB |  27014 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool |      0 B   |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 B   |     40 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189654 K  |  189654 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189654 K  |  189654 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |    1207    |    1138    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  231815 K  |  231815 K  |
|       from large pool |       0    |     600    |  133285 K  |  133285 K  |
|       from small pool |       0    |    2768    |   98529 K  |   98529 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14522 MiB |  28010 MiB |  27014 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool |      0 B   |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 B   |     40 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189654 K  |  189654 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189654 K  |  189654 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |    1207    |    1138    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  231815 K  |  231815 K  |
|       from large pool |       0    |     600    |  133285 K  |  133285 K  |
|       from small pool |       0    |    2768    |   98529 K  |   98529 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160

 Experiment start at: 2024-06-09 15:26:35.033413
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9665936, 'precision': 0.74997985, 'recall': 0.8080782, 'specificity': 0.8080782, 'f1': 0.77563727, 'auroc': 0.94874775, 'binary_precision': 0.513025, 'binary_recall': 0.6378057, 'binary_specificity': 0.97835076, 'binary_f1_score': 0.56865054}
confusion matrix:
       0    1
0  41395  916
1    548  965
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7487564, 'recall': 0.7702645, 'specificity': 0.7702645, 'f1': 0.7590163, 'auroc': 0.9392913, 'binary_precision': 0.5121951, 'binary_recall': 0.55813956, 'binary_specificity': 0.9823895, 'binary_f1_score': 0.53418124}
confusion matrix:
       0    1
0  17851  320
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.8844494, 'recall': 0.75138086, 'specificity': 0.75138086, 'f1': 0.8027538, 'auroc': 0.9420432, 'binary_precision': 0.78846157, 'binary_recall': 0.5082645, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6180905}
confusion matrix:
      0    1
0  5964   33
1   119  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 15:42:22.845691,epoch time: 0:15:47.812278,used: 0:15:47.812278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710433, 'precision': 0.8031585, 'recall': 0.69407463, 'specificity': 0.69407463, 'f1': 0.73556435, 'auroc': 0.9607444, 'binary_precision': 0.62761503, 'binary_recall': 0.3965631, 'binary_specificity': 0.9915861, 'binary_f1_score': 0.4860267}
confusion matrix:
       0    1
0  41955  356
1    913  600
---- Validation: 
scalar performance:
{'acc': 0.97080916, 'precision': 0.79581165, 'recall': 0.6163218, 'specificity': 0.6163218, 'f1': 0.6639993, 'auroc': 0.95196915, 'binary_precision': 0.6163793, 'binary_recall': 0.23754153, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.34292567}
confusion matrix:
       0    1
0  18082   89
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.8677473, 'recall': 0.6632049, 'specificity': 0.6632049, 'f1': 0.72284, 'auroc': 0.9477904, 'binary_precision': 0.7619048, 'binary_recall': 0.3305785, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.46109512}
confusion matrix:
      0   1
0  5972  25
1   162  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 15:57:22.069340,epoch time: 0:14:59.223649,used: 0:30:47.035927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9755613, 'precision': 0.8723172, 'recall': 0.7085232, 'specificity': 0.7085232, 'f1': 0.7655586, 'auroc': 0.9675521, 'binary_precision': 0.764988, 'binary_recall': 0.42167878, 'binary_specificity': 0.99536765, 'binary_f1_score': 0.5436728}
confusion matrix:
       0    1
0  42115  196
1    875  638
---- Validation: 
scalar performance:
{'acc': 0.97395194, 'precision': 0.89911544, 'recall': 0.6187483, 'specificity': 0.6187483, 'f1': 0.6786786, 'auroc': 0.9500656, 'binary_precision': 0.82285714, 'binary_recall': 0.23920266, 'binary_specificity': 0.998294, 'binary_f1_score': 0.3706564}
confusion matrix:
       0    1
0  18140   31
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9308846, 'recall': 0.5534689, 'specificity': 0.5534689, 'f1': 0.5869707, 'auroc': 0.9457525, 'binary_precision': 0.8965517, 'binary_recall': 0.10743801, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19188192}
confusion matrix:
      0   1
0  5994   3
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 16:12:21.293312,epoch time: 0:14:59.223972,used: 0:45:46.259899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97499084, 'precision': 0.9214256, 'recall': 0.66202325, 'specificity': 0.66202325, 'f1': 0.7303871, 'auroc': 0.9724066, 'binary_precision': 0.8664323, 'binary_recall': 0.3258427, 'binary_specificity': 0.99820375, 'binary_f1_score': 0.47358307}
confusion matrix:
       0    1
0  42235   76
1   1020  493
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.94057703, 'recall': 0.56622505, 'specificity': 0.56622505, 'f1': 0.60875183, 'auroc': 0.9649569, 'binary_precision': 0.90909094, 'binary_recall': 0.13289036, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.23188403}
confusion matrix:
       0   1
0  18163   8
1    522  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.9821515, 'recall': 0.5413223, 'specificity': 0.5413223, 'f1': 0.5672494, 'auroc': 0.9558009, 'binary_precision': 1.0, 'binary_recall': 0.08264463, 'binary_specificity': 1.0, 'binary_f1_score': 0.15267175}
confusion matrix:
      0   1
0  5997   0
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_4.png
early stop counter: 1
val acc:0.9717679619789124, best validation acc: 0.9739519357681274, corresponding to test acc:                         0.9648982286453247 / 0.9756371378898621
after epoch: 4,now: 2024-06-09 16:27:22.389427,epoch time: 0:15:01.096115,used: 1:00:47.356014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9773412, 'precision': 0.8204607, 'recall': 0.86494714, 'specificity': 0.86494714, 'f1': 0.84111285, 'auroc': 0.9752659, 'binary_precision': 0.6501155, 'binary_recall': 0.7442168, 'binary_specificity': 0.9856775, 'binary_f1_score': 0.69399077}
confusion matrix:
       0     1
0  41705   606
1    387  1126
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.84408915, 'recall': 0.75879884, 'specificity': 0.75879884, 'f1': 0.7949256, 'auroc': 0.9662341, 'binary_precision': 0.7037862, 'binary_recall': 0.52491695, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.60133207}
confusion matrix:
       0    1
0  18038  133
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97515625, 'precision': 0.8576353, 'recall': 0.77888906, 'specificity': 0.77888906, 'f1': 0.8129152, 'auroc': 0.9530035, 'binary_precision': 0.7326203, 'binary_recall': 0.5661157, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6386946}
confusion matrix:
      0    1
0  5947   50
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 16:42:26.681181,epoch time: 0:15:04.291754,used: 1:15:51.647768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98035324, 'precision': 0.87243545, 'recall': 0.8129735, 'specificity': 0.8129735, 'f1': 0.8399042, 'auroc': 0.9741384, 'binary_precision': 0.7579114, 'binary_recall': 0.6331791, 'binary_specificity': 0.9927678, 'binary_f1_score': 0.68995315}
confusion matrix:
       0    1
0  42005  306
1    555  958
---- Validation: 
scalar performance:
{'acc': 0.97895914, 'precision': 0.8715627, 'recall': 0.74901956, 'specificity': 0.74901956, 'f1': 0.797293, 'auroc': 0.95941055, 'binary_precision': 0.7593985, 'binary_recall': 0.50332224, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.6053946}
confusion matrix:
       0    1
0  18075   96
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84695697, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.6392371, 'auroc': 0.94310534, 'binary_precision': 0.7258065, 'binary_recall': 0.18595041, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29605266}
confusion matrix:
      0   1
0  5980  17
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 16:57:34.560416,epoch time: 0:15:07.879235,used: 1:30:59.527003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97861904, 'precision': 0.8236908, 'recall': 0.8958808, 'specificity': 0.8958808, 'f1': 0.85578996, 'auroc': 0.97855425, 'binary_precision': 0.65434086, 'binary_recall': 0.80700594, 'binary_specificity': 0.98475575, 'binary_f1_score': 0.72269905}
confusion matrix:
       0     1
0  41666   645
1    292  1221
---- Validation: 
scalar performance:
{'acc': 0.97661537, 'precision': 0.80023813, 'recall': 0.8714783, 'specificity': 0.8714783, 'f1': 0.8317032, 'auroc': 0.968953, 'binary_precision': 0.608522, 'binary_recall': 0.7591362, 'binary_specificity': 0.9838204, 'binary_f1_score': 0.67553586}
confusion matrix:
       0    1
0  17877  294
1    145  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713095, 'precision': 0.85495305, 'recall': 0.7015439, 'specificity': 0.7015439, 'f1': 0.75520337, 'auroc': 0.94160855, 'binary_precision': 0.73333335, 'binary_recall': 0.4090909, 'binary_specificity': 0.993997, 'binary_f1_score': 0.525199}
confusion matrix:
      0   1
0  5961  36
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_7.png
early stop counter: 1
val acc:0.9766153693199158, best validation acc: 0.9789591431617737, corresponding to test acc:                         0.9656996130943298 / 0.9756371378898621
after epoch: 7,now: 2024-06-09 17:12:37.235186,epoch time: 0:15:02.674770,used: 1:46:02.201773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98151696, 'precision': 0.90677786, 'recall': 0.79095185, 'specificity': 0.79095185, 'f1': 0.83850515, 'auroc': 0.9809147, 'binary_precision': 0.82819796, 'binary_recall': 0.58625245, 'binary_specificity': 0.99565125, 'binary_f1_score': 0.6865325}
confusion matrix:
       0    1
0  42127  184
1    626  887
---- Validation: 
scalar performance:
{'acc': 0.9823683, 'precision': 0.8893083, 'recall': 0.80297875, 'specificity': 0.80297875, 'f1': 0.8403554, 'auroc': 0.9702287, 'binary_precision': 0.79139787, 'binary_recall': 0.6112957, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.6897845}
confusion matrix:
       0    1
0  18074   97
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8893193, 'recall': 0.62891465, 'specificity': 0.62891465, 'f1': 0.68889666, 'auroc': 0.946414, 'binary_precision': 0.8076923, 'binary_recall': 0.2603306, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.39375}
confusion matrix:
      0   1
0  5982  15
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 17:27:38.192411,epoch time: 0:15:00.957225,used: 2:01:03.158998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98295456, 'precision': 0.8667547, 'recall': 0.8837868, 'specificity': 0.8837868, 'f1': 0.87505966, 'auroc': 0.98400533, 'binary_precision': 0.74148804, 'binary_recall': 0.7772637, 'binary_specificity': 0.99030983, 'binary_f1_score': 0.7589545}
confusion matrix:
       0     1
0  41901   410
1    337  1176
---- Validation: 
scalar performance:
{'acc': 0.9823683, 'precision': 0.8610286, 'recall': 0.8511616, 'specificity': 0.8511616, 'f1': 0.85602105, 'auroc': 0.9720222, 'binary_precision': 0.73162395, 'binary_recall': 0.7109634, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.72114575}
confusion matrix:
       0    1
0  18014  157
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.87174255, 'recall': 0.6510583, 'specificity': 0.6510583, 'f1': 0.7111095, 'auroc': 0.9437766, 'binary_precision': 0.7708333, 'binary_recall': 0.30578512, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43786982}
confusion matrix:
      0   1
0  5975  22
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_9.png
early stop counter: 1
val acc:0.9823682904243469, best validation acc: 0.9823682904243469, corresponding to test acc:                         0.9689052700996399 / 0.9756371378898621
after epoch: 9,now: 2024-06-09 17:42:40.772358,epoch time: 0:15:02.579947,used: 2:16:05.738945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98468876, 'precision': 0.9196453, 'recall': 0.8352938, 'specificity': 0.8352938, 'f1': 0.8723861, 'auroc': 0.9824048, 'binary_precision': 0.85083336, 'binary_recall': 0.6748182, 'binary_specificity': 0.99576944, 'binary_f1_score': 0.7526723}
confusion matrix:
       0     1
0  42132   179
1    492  1021
---- Validation: 
scalar performance:
{'acc': 0.9841794, 'precision': 0.9053854, 'recall': 0.8207783, 'specificity': 0.8207783, 'f1': 0.8577887, 'auroc': 0.9718938, 'binary_precision': 0.82241017, 'binary_recall': 0.6461794, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.7237209}
confusion matrix:
       0    1
0  18087   84
1    213  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.81613684, 'recall': 0.61130184, 'specificity': 0.61130184, 'f1': 0.66038525, 'auroc': 0.9341315, 'binary_precision': 0.6626506, 'binary_recall': 0.22727273, 'binary_specificity': 0.995331, 'binary_f1_score': 0.33846155}
confusion matrix:
      0   1
0  5969  28
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 17:57:42.914499,epoch time: 0:15:02.142141,used: 2:31:07.881086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9821331, 'precision': 0.9553107, 'recall': 0.76099896, 'specificity': 0.76099896, 'f1': 0.83001006, 'auroc': 0.9844163, 'binary_precision': 0.92740047, 'binary_recall': 0.5234633, 'binary_specificity': 0.9985347, 'binary_f1_score': 0.6692015}
confusion matrix:
       0    1
0  42249   62
1    721  792
---- Validation: 
scalar performance:
{'acc': 0.9793853, 'precision': 0.8997394, 'recall': 0.7283604, 'specificity': 0.7283604, 'f1': 0.7890816, 'auroc': 0.9714309, 'binary_precision': 0.81710917, 'binary_recall': 0.4601329, 'binary_specificity': 0.996588, 'binary_f1_score': 0.5887354}
confusion matrix:
       0    1
0  18109   62
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9019083, 'recall': 0.56354934, 'specificity': 0.56354934, 'f1': 0.60221696, 'auroc': 0.9461001, 'binary_precision': 0.8378378, 'binary_recall': 0.12809917, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.22222221}
confusion matrix:
      0   1
0  5991   6
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_11.png
early stop counter: 1
val acc:0.9793853163719177, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 11,now: 2024-06-09 18:12:43.687202,epoch time: 0:15:00.772703,used: 2:46:08.653789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9869022, 'precision': 0.9126113, 'recall': 0.8851938, 'specificity': 0.8851938, 'f1': 0.89839226, 'auroc': 0.98753226, 'binary_precision': 0.83321506, 'binary_recall': 0.77594185, 'binary_specificity': 0.99444586, 'binary_f1_score': 0.8035593}
confusion matrix:
       0     1
0  42076   235
1    339  1174
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.904593, 'recall': 0.8504035, 'specificity': 0.8504035, 'f1': 0.8754058, 'auroc': 0.9723166, 'binary_precision': 0.81888247, 'binary_recall': 0.70598006, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.75825155}
confusion matrix:
       0    1
0  18077   94
1    177  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8092929, 'recall': 0.61923283, 'specificity': 0.61923283, 'f1': 0.6683258, 'auroc': 0.93391216, 'binary_precision': 0.64835167, 'binary_recall': 0.24380165, 'binary_specificity': 0.994664, 'binary_f1_score': 0.35435435}
confusion matrix:
      0   1
0  5965  32
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 18:27:46.029378,epoch time: 0:15:02.342176,used: 3:01:10.995965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98320556, 'precision': 0.88181776, 'recall': 0.8593806, 'specificity': 0.8593806, 'f1': 0.87022996, 'auroc': 0.9844301, 'binary_precision': 0.773399, 'binary_recall': 0.72637147, 'binary_specificity': 0.9923897, 'binary_f1_score': 0.74914795}
confusion matrix:
       0     1
0  41989   322
1    414  1099
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.8791082, 'recall': 0.83631647, 'specificity': 0.83631647, 'f1': 0.85633093, 'auroc': 0.97213805, 'binary_precision': 0.768797, 'binary_recall': 0.679402, 'binary_specificity': 0.993231, 'binary_f1_score': 0.7213403}
confusion matrix:
       0    1
0  18048  123
1    193  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.91335124, 'recall': 0.6108199, 'specificity': 0.6108199, 'f1': 0.66895753, 'auroc': 0.9461964, 'binary_precision': 0.85714287, 'binary_recall': 0.2231405, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.35409835}
confusion matrix:
      0   1
0  5988   9
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_13.png
early stop counter: 1
val acc:0.983167290687561, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 13,now: 2024-06-09 18:42:47.645538,epoch time: 0:15:01.616160,used: 3:16:12.612125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9869022, 'precision': 0.90888304, 'recall': 0.89061093, 'specificity': 0.89061093, 'f1': 0.8995206, 'auroc': 0.9887159, 'binary_precision': 0.8253638, 'binary_recall': 0.7871778, 'binary_specificity': 0.9940441, 'binary_f1_score': 0.8058187}
confusion matrix:
       0     1
0  42059   252
1    322  1191
---- Validation: 
scalar performance:
{'acc': 0.9841794, 'precision': 0.899716, 'recall': 0.8280058, 'specificity': 0.8280058, 'f1': 0.86006165, 'auroc': 0.97171414, 'binary_precision': 0.8105906, 'binary_recall': 0.6611296, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.72827077}
confusion matrix:
       0    1
0  18078   93
1    204  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.85459197, 'recall': 0.58759236, 'specificity': 0.58759236, 'f1': 0.634547, 'auroc': 0.93955743, 'binary_precision': 0.7413793, 'binary_recall': 0.17768595, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.28666666}
confusion matrix:
      0   1
0  5982  15
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_14.png
early stop counter: 2
val acc:0.9841793775558472, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 14,now: 2024-06-09 18:57:54.877568,epoch time: 0:15:07.232030,used: 3:31:19.844155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9873585, 'precision': 0.9242575, 'recall': 0.8781012, 'specificity': 0.8781012, 'f1': 0.8997444, 'auroc': 0.9905356, 'binary_precision': 0.8570365, 'binary_recall': 0.7607403, 'binary_specificity': 0.9954622, 'binary_f1_score': 0.80602247}
confusion matrix:
       0     1
0  42119   192
1    362  1151
---- Validation: 
scalar performance:
{'acc': 0.98540455, 'precision': 0.90398514, 'recall': 0.84791183, 'specificity': 0.84791183, 'f1': 0.87369895, 'auroc': 0.9772872, 'binary_precision': 0.81782943, 'binary_recall': 0.7009967, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.75491947}
confusion matrix:
       0    1
0  18077   94
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8802113, 'recall': 0.6083369, 'specificity': 0.6083369, 'f1': 0.6631801, 'auroc': 0.942745, 'binary_precision': 0.7910448, 'binary_recall': 0.21900827, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.34304208}
confusion matrix:
      0   1
0  5983  14
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_15.png
early stop counter: 3
val acc:0.9854045510292053, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 15,now: 2024-06-09 19:13:00.774803,epoch time: 0:15:05.897235,used: 3:46:25.741390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9874954, 'precision': 0.9197271, 'recall': 0.8864571, 'specificity': 0.8864571, 'f1': 0.9023492, 'auroc': 0.989388, 'binary_precision': 0.84737223, 'binary_recall': 0.77792466, 'binary_specificity': 0.99498945, 'binary_f1_score': 0.81116474}
confusion matrix:
       0     1
0  42099   212
1    336  1177
---- Validation: 
scalar performance:
{'acc': 0.9835402, 'precision': 0.87709665, 'recall': 0.84855485, 'specificity': 0.84855485, 'f1': 0.8622192, 'auroc': 0.9752699, 'binary_precision': 0.76396394, 'binary_recall': 0.70431894, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.73292994}
confusion matrix:
       0    1
0  18040  131
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.8201585, 'recall': 0.55470127, 'specificity': 0.55470127, 'f1': 0.58639735, 'auroc': 0.93897915, 'binary_precision': 0.675, 'binary_recall': 0.11157025, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.19148935}
confusion matrix:
      0   1
0  5984  13
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_16.png
early stop counter: 4
val acc:0.9835401773452759, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 16,now: 2024-06-09 19:28:05.144361,epoch time: 0:15:04.369558,used: 4:01:30.110948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9886364, 'precision': 0.9141432, 'recall': 0.91572666, 'specificity': 0.91572666, 'f1': 0.9149333, 'auroc': 0.99156505, 'binary_precision': 0.8341014, 'binary_recall': 0.83740914, 'binary_specificity': 0.9940441, 'binary_f1_score': 0.835752}
confusion matrix:
       0     1
0  42059   252
1    246  1267
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.9003278, 'recall': 0.8518995, 'specificity': 0.8518995, 'f1': 0.87443507, 'auroc': 0.97314525, 'binary_precision': 0.8102467, 'binary_recall': 0.7093023, 'binary_specificity': 0.9944967, 'binary_f1_score': 0.75642157}
confusion matrix:
       0    1
0  18071  100
1    175  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.88249123, 'recall': 0.64106125, 'specificity': 0.64106125, 'f1': 0.70186573, 'auroc': 0.93440044, 'binary_precision': 0.79310346, 'binary_recall': 0.28512397, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.4194529}
confusion matrix:
      0   1
0  5979  18
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_17.png
early stop counter: 5
val acc:0.9853513240814209, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 17,now: 2024-06-09 19:43:07.985589,epoch time: 0:15:02.841228,used: 4:16:32.952176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9892296, 'precision': 0.9518161, 'recall': 0.87938887, 'specificity': 0.87938887, 'f1': 0.9122049, 'auroc': 0.9917835, 'binary_precision': 0.912114, 'binary_recall': 0.7614012, 'binary_specificity': 0.99737656, 'binary_f1_score': 0.8299712}
confusion matrix:
       0     1
0  42200   111
1    361  1152
---- Validation: 
scalar performance:
{'acc': 0.9855111, 'precision': 0.907392, 'recall': 0.8455577, 'specificity': 0.8455577, 'f1': 0.87374496, 'auroc': 0.97474897, 'binary_precision': 0.8248032, 'binary_recall': 0.6960133, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.754955}
confusion matrix:
       0    1
0  18082   89
1    183  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.91993964, 'recall': 0.5842105, 'specificity': 0.5842105, 'f1': 0.63337725, 'auroc': 0.92130876, 'binary_precision': 0.87234044, 'binary_recall': 0.1694215, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.28373703}
confusion matrix:
      0   1
0  5991   6
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_18.png
early stop counter: 6
val acc:0.9855111241340637, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 18,now: 2024-06-09 19:58:25.657104,epoch time: 0:15:17.671515,used: 4:31:50.623691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98589814, 'precision': 0.96100646, 'recall': 0.8171197, 'specificity': 0.8171197, 'f1': 0.8748114, 'auroc': 0.990569, 'binary_precision': 0.93488824, 'binary_recall': 0.6358229, 'binary_specificity': 0.9984165, 'binary_f1_score': 0.7568844}
confusion matrix:
       0    1
0  42244   67
1    551  962
---- Validation: 
scalar performance:
{'acc': 0.98327386, 'precision': 0.9312227, 'recall': 0.77694595, 'specificity': 0.77694595, 'f1': 0.8361531, 'auroc': 0.96770024, 'binary_precision': 0.8769634, 'binary_recall': 0.5564784, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.6808943}
confusion matrix:
       0    1
0  18124   47
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.9275172, 'recall': 0.5657822, 'specificity': 0.5657822, 'f1': 0.6063374, 'auroc': 0.8981235, 'binary_precision': 0.8888889, 'binary_recall': 0.1322314, 'binary_specificity': 0.999333, 'binary_f1_score': 0.23021582}
confusion matrix:
      0   1
0  5993   4
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_19.png
early stop counter: 7
val acc:0.9832738637924194, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 19,now: 2024-06-09 20:13:39.863025,epoch time: 0:15:14.205921,used: 4:47:04.829612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9897545, 'precision': 0.92505515, 'recall': 0.9204481, 'specificity': 0.9204481, 'f1': 0.922738, 'auroc': 0.99274415, 'binary_precision': 0.85561496, 'binary_recall': 0.8460013, 'binary_specificity': 0.9948949, 'binary_f1_score': 0.85078096}
confusion matrix:
       0     1
0  42095   216
1    233  1280
---- Validation: 
scalar performance:
{'acc': 0.9855111, 'precision': 0.89351237, 'recall': 0.8656339, 'specificity': 0.8656339, 'f1': 0.8790209, 'auroc': 0.9776089, 'binary_precision': 0.79569894, 'binary_recall': 0.73754156, 'binary_specificity': 0.99372625, 'binary_f1_score': 0.76551723}
confusion matrix:
       0    1
0  18057  114
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.89909047, 'recall': 0.5901587, 'specificity': 0.5901587, 'f1': 0.6406571, 'auroc': 0.939919, 'binary_precision': 0.8301887, 'binary_recall': 0.18181819, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2983051}
confusion matrix:
      0   1
0  5988   9
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_20.png
early stop counter: 8
val acc:0.9855111241340637, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 20,now: 2024-06-09 20:28:46.616453,epoch time: 0:15:06.753428,used: 5:02:11.583040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98802024, 'precision': 0.93909633, 'recall': 0.87238955, 'specificity': 0.87238955, 'f1': 0.90278685, 'auroc': 0.99112487, 'binary_precision': 0.8871473, 'binary_recall': 0.7481824, 'binary_specificity': 0.99659663, 'binary_f1_score': 0.8117605}
confusion matrix:
       0     1
0  42167   144
1    381  1132
---- Validation: 
scalar performance:
{'acc': 0.9858307, 'precision': 0.91105366, 'recall': 0.8473289, 'specificity': 0.8473289, 'f1': 0.8763139, 'auroc': 0.9709347, 'binary_precision': 0.8320158, 'binary_recall': 0.6993356, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.75992787}
confusion matrix:
       0    1
0  18086   85
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.89088136, 'recall': 0.56346595, 'specificity': 0.56346595, 'f1': 0.6017784, 'auroc': 0.93526065, 'binary_precision': 0.81578946, 'binary_recall': 0.12809917, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.22142856}
confusion matrix:
      0   1
0  5990   7
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_21.png
better model found
persisted
after epoch: 21,now: 2024-06-09 20:44:11.867623,epoch time: 0:15:25.251170,used: 5:17:36.834210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902793, 'precision': 0.9400059, 'recall': 0.9102044, 'specificity': 0.9102044, 'f1': 0.9245409, 'auroc': 0.9936645, 'binary_precision': 0.88628286, 'binary_recall': 0.8241904, 'binary_specificity': 0.9962185, 'binary_f1_score': 0.8541096}
confusion matrix:
       0     1
0  42151   160
1    266  1247
---- Validation: 
scalar performance:
{'acc': 0.98609704, 'precision': 0.9009748, 'recall': 0.86673963, 'specificity': 0.86673963, 'f1': 0.8830347, 'auroc': 0.97381103, 'binary_precision': 0.81056464, 'binary_recall': 0.7392027, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.77324075}
confusion matrix:
       0    1
0  18067  104
1    157  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.8363245, 'recall': 0.6198164, 'specificity': 0.6198164, 'f1': 0.6724233, 'auroc': 0.92627275, 'binary_precision': 0.70238096, 'binary_recall': 0.24380165, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.36196318}
confusion matrix:
      0   1
0  5972  25
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_22.png
better model found
persisted
after epoch: 22,now: 2024-06-09 20:59:24.194985,epoch time: 0:15:12.327362,used: 5:32:49.161572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9896632, 'precision': 0.93466604, 'recall': 0.90606153, 'specificity': 0.90606153, 'f1': 0.91983783, 'auroc': 0.9938121, 'binary_precision': 0.8758865, 'binary_recall': 0.8162591, 'binary_specificity': 0.995864, 'binary_f1_score': 0.84502226}
confusion matrix:
       0     1
0  42136   175
1    278  1235
---- Validation: 
scalar performance:
{'acc': 0.9863634, 'precision': 0.9052608, 'recall': 0.8660742, 'specificity': 0.8660742, 'f1': 0.88459563, 'auroc': 0.97093403, 'binary_precision': 0.8191882, 'binary_recall': 0.73754156, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.7762238}
confusion matrix:
       0    1
0  18073   98
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8793578, 'recall': 0.5776787, 'specificity': 0.5776787, 'f1': 0.6222554, 'auroc': 0.91774076, 'binary_precision': 0.7916667, 'binary_recall': 0.1570248, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.262069}
confusion matrix:
      0   1
0  5987  10
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_23.png
better model found
persisted
after epoch: 23,now: 2024-06-09 21:14:37.219315,epoch time: 0:15:13.024330,used: 5:48:02.185902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9908954, 'precision': 0.9393432, 'recall': 0.9216763, 'specificity': 0.9216763, 'f1': 0.9303138, 'auroc': 0.99381024, 'binary_precision': 0.8841379, 'binary_recall': 0.8473232, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.8653392}
confusion matrix:
       0     1
0  42143   168
1    231  1282
---- Validation: 
scalar performance:
{'acc': 0.9864699, 'precision': 0.91087794, 'recall': 0.86050785, 'specificity': 0.86050785, 'f1': 0.88392407, 'auroc': 0.974532, 'binary_precision': 0.8307985, 'binary_recall': 0.72591364, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.7748227}
confusion matrix:
       0    1
0  18082   89
1    165  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.837388, 'recall': 0.6117187, 'specificity': 0.6117187, 'f1': 0.6632387, 'auroc': 0.9372568, 'binary_precision': 0.7051282, 'binary_recall': 0.22727273, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.34375}
confusion matrix:
      0   1
0  5974  23
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_24.png
better model found
persisted
after epoch: 24,now: 2024-06-09 21:29:53.985039,epoch time: 0:15:16.765724,used: 6:03:18.951626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98973167, 'precision': 0.91562843, 'recall': 0.9341383, 'specificity': 0.9341383, 'f1': 0.9246645, 'auroc': 0.99404037, 'binary_precision': 0.8357549, 'binary_recall': 0.87442166, 'binary_specificity': 0.993855, 'binary_f1_score': 0.8546512}
confusion matrix:
       0     1
0  42051   260
1    190  1323
---- Validation: 
scalar performance:
{'acc': 0.9830075, 'precision': 0.85495424, 'recall': 0.8828107, 'specificity': 0.8828107, 'f1': 0.8683107, 'auroc': 0.97324675, 'binary_precision': 0.71735793, 'binary_recall': 0.77574754, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.74541104}
confusion matrix:
       0    1
0  17987  184
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.81622005, 'recall': 0.56073284, 'specificity': 0.56073284, 'f1': 0.59521943, 'auroc': 0.9168486, 'binary_precision': 0.6666667, 'binary_recall': 0.12396694, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.20905922}
confusion matrix:
      0   1
0  5982  15
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_25.png
early stop counter: 1
val acc:0.9830074906349182, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 25,now: 2024-06-09 21:45:11.254190,epoch time: 0:15:17.269151,used: 6:18:36.220777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9913746, 'precision': 0.92872405, 'recall': 0.9445487, 'specificity': 0.9445487, 'f1': 0.9364809, 'auroc': 0.99421096, 'binary_precision': 0.8612349, 'binary_recall': 0.89424986, 'binary_specificity': 0.99484766, 'binary_f1_score': 0.87743187}
confusion matrix:
       0     1
0  42093   218
1    160  1353
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.8682575, 'recall': 0.87771225, 'specificity': 0.87771225, 'f1': 0.8729199, 'auroc': 0.9746655, 'binary_precision': 0.74433655, 'binary_recall': 0.7641196, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.75409836}
confusion matrix:
       0    1
0  18013  158
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.81962574, 'recall': 0.6498077, 'specificity': 0.6498077, 'f1': 0.70117813, 'auroc': 0.9318582, 'binary_precision': 0.6666667, 'binary_recall': 0.30578512, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.41926345}
confusion matrix:
      0   1
0  5960  37
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_26.png
early stop counter: 2
val acc:0.9840195775032043, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 26,now: 2024-06-09 22:00:39.180695,epoch time: 0:15:27.926505,used: 6:34:04.147282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9911008, 'precision': 0.9658407, 'recall': 0.89597183, 'specificity': 0.89597183, 'f1': 0.9278596, 'auroc': 0.9950266, 'binary_precision': 0.93901485, 'binary_recall': 0.7937872, 'binary_specificity': 0.9981565, 'binary_f1_score': 0.8603152}
confusion matrix:
       0     1
0  42233    78
1    312  1201
---- Validation: 
scalar performance:
{'acc': 0.98561764, 'precision': 0.9203833, 'recall': 0.8319609, 'specificity': 0.8319609, 'f1': 0.8706002, 'auroc': 0.9742855, 'binary_precision': 0.85169494, 'binary_recall': 0.6677741, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.7486034}
confusion matrix:
       0    1
0  18101   70
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.840266, 'recall': 0.59552336, 'specificity': 0.59552336, 'f1': 0.64380527, 'auroc': 0.92807734, 'binary_precision': 0.7121212, 'binary_recall': 0.19421488, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3051948}
confusion matrix:
      0   1
0  5978  19
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_27.png
early stop counter: 3
val acc:0.9856176376342773, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 27,now: 2024-06-09 22:16:27.848385,epoch time: 0:15:48.667690,used: 6:49:52.814972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9921504, 'precision': 0.95477605, 'recall': 0.9245568, 'specificity': 0.9245568, 'f1': 0.9391061, 'auroc': 0.9952373, 'binary_precision': 0.9148332, 'binary_recall': 0.85194975, 'binary_specificity': 0.99716383, 'binary_f1_score': 0.88227236}
confusion matrix:
       0     1
0  42191   120
1    224  1289
---- Validation: 
scalar performance:
{'acc': 0.9863101, 'precision': 0.914659, 'recall': 0.8523948, 'specificity': 0.8523948, 'f1': 0.88081163, 'auroc': 0.9735326, 'binary_precision': 0.8388998, 'binary_recall': 0.7093023, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.76867694}
confusion matrix:
       0    1
0  18089   82
1    175  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84695697, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.6392371, 'auroc': 0.906815, 'binary_precision': 0.7258065, 'binary_recall': 0.18595041, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29605266}
confusion matrix:
      0   1
0  5980  17
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_28.png
early stop counter: 4
val acc:0.9863101243972778, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 28,now: 2024-06-09 22:34:45.950136,epoch time: 0:18:18.101751,used: 7:08:10.916723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99119204, 'precision': 0.94872415, 'recall': 0.9154569, 'specificity': 0.9154569, 'f1': 0.93139935, 'auroc': 0.9953411, 'binary_precision': 0.90336436, 'binary_recall': 0.8341044, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.867354}
confusion matrix:
       0     1
0  42176   135
1    251  1262
---- Validation: 
scalar performance:
{'acc': 0.98524475, 'precision': 0.9088892, 'recall': 0.8381927, 'specificity': 0.8381927, 'f1': 0.8699467, 'auroc': 0.9746897, 'binary_precision': 0.82828283, 'binary_recall': 0.6810631, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.74749315}
confusion matrix:
       0    1
0  18086   85
1    192  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7724633, 'recall': 0.57419515, 'specificity': 0.57419515, 'f1': 0.611385, 'auroc': 0.91812575, 'binary_precision': 0.578125, 'binary_recall': 0.15289256, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.24183007}
confusion matrix:
      0   1
0  5970  27
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_29.png
early stop counter: 5
val acc:0.9852447509765625, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 29,now: 2024-06-09 22:52:04.903565,epoch time: 0:17:18.953429,used: 7:25:29.870152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99112356, 'precision': 0.93032724, 'recall': 0.9377271, 'specificity': 0.9377271, 'f1': 0.933993, 'auroc': 0.99517214, 'binary_precision': 0.86493504, 'binary_recall': 0.88037014, 'binary_specificity': 0.99508405, 'binary_f1_score': 0.87258434}
confusion matrix:
       0     1
0  42103   208
1    181  1332
---- Validation: 
scalar performance:
{'acc': 0.98545784, 'precision': 0.88892215, 'recall': 0.8720308, 'specificity': 0.8720308, 'f1': 0.880274, 'auroc': 0.9706991, 'binary_precision': 0.786087, 'binary_recall': 0.7508306, 'binary_specificity': 0.993231, 'binary_f1_score': 0.76805437}
confusion matrix:
       0    1
0  18048  123
1    150  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.88778245, 'recall': 0.577762, 'specificity': 0.577762, 'f1': 0.6227505, 'auroc': 0.8865263, 'binary_precision': 0.80851066, 'binary_recall': 0.1570248, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26297578}
confusion matrix:
      0   1
0  5988   9
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261160_30.png
early stop counter: 6
val acc:0.9854578375816345, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9663407802581787 / 0.9756371378898621
after epoch: 30,now: 2024-06-09 23:07:44.818116,epoch time: 0:15:39.914551,used: 7:41:09.784703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_15_26_35_seed_2_21261160
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:41:09.784703 at 2024-06-09 23:07:44.818116
persisted model performance metric: 

scalar performance:
{'acc': 0.9693861, 'precision': 0.87620294, 'recall': 0.6450267, 'specificity': 0.6450267, 'f1': 0.7053499, 'auroc': 0.9410894, 'binary_precision': 0.7802198, 'binary_recall': 0.29338843, 'binary_specificity': 0.996665, 'binary_f1_score': 0.42642644}
confusion matrix:
      0   1
0  5977  20
1   171  71
oracle model performance metric: 

scalar performance:
{'acc': 0.97611797, 'precision': 0.8903024, 'recall': 0.7536137, 'specificity': 0.7536137, 'f1': 0.8061758, 'auroc': 0.935928, 'binary_precision': 0.8, 'binary_recall': 0.5123967, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6246851}
confusion matrix:
      0    1
0  5966   31
1   118  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502021 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool | 460339 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502021 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool | 460339 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496649 KiB |  13261 MiB |   3380 TiB |   3380 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   3341 TiB |   3341 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14524 MiB |  14524 MiB |  41538 MiB |  27014 MiB |
|       from large pool |  14458 MiB |  14458 MiB |  41438 MiB |  26980 MiB |
|       from small pool |     66 MiB |     72 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 491259 KiB |   1253 MiB |   2448 TiB |   2448 TiB |
|       from large pool | 479692 KiB |   1244 MiB |   2408 TiB |   2408 TiB |
|       from small pool |  11566 KiB |     40 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  593148 K  |  593144 K  |
|       from large pool |     187    |    1413    |  308897 K  |  308897 K  |
|       from small pool |    3289    |    6298    |  284251 K  |  284247 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  593148 K  |  593144 K  |
|       from large pool |     187    |    1413    |  308897 K  |  308897 K  |
|       from small pool |    3289    |    6298    |  284251 K  |  284247 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     639    |     639    |    1777    |    1138    |
|       from large pool |     606    |     606    |    1727    |    1121    |
|       from small pool |      33    |      36    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |    2812    |  341222 K  |  341222 K  |
|       from large pool |      42    |     600    |  193104 K  |  193104 K  |
|       from small pool |      45    |    2768    |  148118 K  |  148118 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   3380 TiB |   3380 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   3341 TiB |   3341 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |  14524 MiB |  41538 MiB |  40568 MiB |
|       from large pool |    918 MiB |  14458 MiB |  41438 MiB |  40520 MiB |
|       from small pool |     52 MiB |     72 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1253 MiB |   2448 TiB |   2448 TiB |
|       from large pool |      0 B   |   1244 MiB |   2408 TiB |   2408 TiB |
|       from small pool |      0 B   |     44 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  593148 K  |  593148 K  |
|       from large pool |       2    |    1413    |  308897 K  |  308897 K  |
|       from small pool |       0    |    6298    |  284251 K  |  284251 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  593148 K  |  593148 K  |
|       from large pool |       2    |    1413    |  308897 K  |  308897 K  |
|       from small pool |       0    |    6298    |  284251 K  |  284251 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |    1777    |    1708    |
|       from large pool |      43    |     606    |    1727    |    1684    |
|       from small pool |      26    |      36    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  341224 K  |  341224 K  |
|       from large pool |       0    |     600    |  193104 K  |  193104 K  |
|       from small pool |       0    |    2768    |  148119 K  |  148119 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  9 23:09:23 2024]
Finished job 0.
1 of 1 steps (100%) done
