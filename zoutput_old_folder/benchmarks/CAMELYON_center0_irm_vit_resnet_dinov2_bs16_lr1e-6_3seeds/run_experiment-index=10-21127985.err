Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985

 Experiment start at: 2024-06-05 22:52:07.464087
before training, model accuracy: 0.24001279473304749
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96220773, 'precision': 0.541536, 'recall': 0.5070074, 'specificity': 0.5070074, 'f1': 0.50672835, 'auroc': 0.6133264, 'binary_precision': 0.11618257, 'binary_recall': 0.01904762, 'binary_specificity': 0.99496716, 'binary_f1_score': 0.0327294}
confusion matrix:
       0    1
0  42109  213
1   1442   28
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.4918008, 'recall': 0.49781466, 'specificity': 0.49781466, 'f1': 0.49277207, 'auroc': 0.50873363, 'binary_precision': 0.017964073, 'binary_recall': 0.00466563, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.0074074073}
confusion matrix:
       0    1
0  17985  164
1    640    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.478955, 'recall': 0.49524763, 'specificity': 0.49524763, 'f1': 0.4869651, 'auroc': 0.5092342, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5940  57
1   261   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:12:44.351338,epoch time: 0:20:36.887251,used: 0:20:36.887251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.71892375, 'recall': 0.51306456, 'specificity': 0.51306456, 'f1': 0.51712835, 'auroc': 0.7107637, 'binary_precision': 0.47058824, 'binary_recall': 0.027192386, 'binary_specificity': 0.9989367, 'binary_f1_score': 0.051413883}
confusion matrix:
       0   1
0  42276  45
1   1431  40
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.5663097, 'recall': 0.5025594, 'specificity': 0.5025594, 'f1': 0.4970716, 'auroc': 0.6407454, 'binary_precision': 0.16666667, 'binary_recall': 0.00622084, 'binary_specificity': 0.998898, 'binary_f1_score': 0.011994004}
confusion matrix:
       0   1
0  18129  20
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.4791033, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48880902, 'auroc': 0.65088993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   261   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 23:27:05.953421,epoch time: 0:14:21.602083,used: 0:34:58.489334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.69380367, 'recall': 0.50258744, 'specificity': 0.50258744, 'f1': 0.4967992, 'auroc': 0.8015164, 'binary_precision': 0.42105263, 'binary_recall': 0.0054347827, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.010731054}
confusion matrix:
       0   1
0  42309  11
1   1464   8
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6829403, 'recall': 0.5014726, 'specificity': 0.5014726, 'f1': 0.49436864, 'auroc': 0.7635573, 'binary_precision': 0.4, 'binary_recall': 0.00311042, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.00617284}
confusion matrix:
       0  1
0  18146  3
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.7732744, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 23:41:35.626980,epoch time: 0:14:29.673559,used: 0:49:28.162893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.79911256, 'recall': 0.5039934, 'specificity': 0.5039934, 'f1': 0.49952847, 'auroc': 0.8376106, 'binary_precision': 0.6315789, 'binary_recall': 0.008152174, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.016096579}
confusion matrix:
       0   1
0  42313   7
1   1460  12
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.62579566, 'recall': 0.50141746, 'specificity': 0.50141746, 'f1': 0.4943316, 'auroc': 0.8251647, 'binary_precision': 0.2857143, 'binary_recall': 0.00311042, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0061538466}
confusion matrix:
       0  1
0  18144  5
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.8141432, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_4.png
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 4,now: 2024-06-05 23:56:08.883078,epoch time: 0:14:33.256098,used: 1:04:01.418991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.7774186, 'recall': 0.503314, 'specificity': 0.503314, 'f1': 0.49818465, 'auroc': 0.86824334, 'binary_precision': 0.5882353, 'binary_recall': 0.006793478, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.013431832}
confusion matrix:
       0   1
0  42313   7
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.8465601, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.8495685, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_5.png
new oracle model saved
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.9581335783004761 / 0.9586129784584045
after epoch: 5,now: 2024-06-06 00:10:46.106129,epoch time: 0:14:37.223051,used: 1:18:38.642042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.84692824, 'recall': 0.5026838, 'specificity': 0.5026838, 'f1': 0.49688497, 'auroc': 0.8765936, 'binary_precision': 0.72727275, 'binary_recall': 0.0054384773, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.010796221}
confusion matrix:
       0  1
0  42318  3
1   1463  8
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7329165, 'recall': 0.50075006, 'specificity': 0.50075006, 'f1': 0.49284685, 'auroc': 0.8416115, 'binary_precision': 0.5, 'binary_recall': 0.00155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0031007752}
confusion matrix:
       0  1
0  18148  1
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.8650098, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-06 00:25:21.273498,epoch time: 0:14:35.167369,used: 1:33:13.809411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.71925807, 'recall': 0.5107721, 'specificity': 0.5107721, 'f1': 0.5128236, 'auroc': 0.88971686, 'binary_precision': 0.47142857, 'binary_recall': 0.022418479, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.042801555}
confusion matrix:
       0   1
0  42283  37
1   1439  33
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.67060953, 'recall': 0.5065852, 'specificity': 0.5065852, 'f1': 0.5047032, 'auroc': 0.8814404, 'binary_precision': 0.375, 'binary_recall': 0.01399689, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.026986506}
confusion matrix:
       0   1
0  18134  15
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.87833315, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_7.png
new oracle model saved
early stop counter: 1
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9603707194328308
after epoch: 7,now: 2024-06-06 00:39:55.599661,epoch time: 0:14:34.326163,used: 1:47:48.135574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.76214254, 'recall': 0.5211366, 'specificity': 0.5211366, 'f1': 0.53184485, 'auroc': 0.9003601, 'binary_precision': 0.5565217, 'binary_recall': 0.04347826, 'binary_specificity': 0.9987949, 'binary_f1_score': 0.08065533}
confusion matrix:
       0   1
0  42269  51
1   1408  64
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72882, 'recall': 0.5194739, 'specificity': 0.5194739, 'f1': 0.5286272, 'auroc': 0.8833951, 'binary_precision': 0.49056605, 'binary_recall': 0.04043546, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.07471265}
confusion matrix:
       0   1
0  18122  27
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8873775, 'recall': 0.5493082, 'specificity': 0.5493082, 'f1': 0.57887876, 'auroc': 0.8940102, 'binary_precision': 0.8125, 'binary_recall': 0.099616855, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1774744}
confusion matrix:
      0   1
0  5991   6
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_8.png
new oracle model saved
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9614893198013306
after epoch: 8,now: 2024-06-06 00:54:26.622500,epoch time: 0:14:31.022839,used: 2:02:19.158413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.719291, 'recall': 0.5159942, 'specificity': 0.5159942, 'f1': 0.52249914, 'auroc': 0.89788496, 'binary_precision': 0.47115386, 'binary_recall': 0.033288043, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.062182743}
confusion matrix:
       0   1
0  42265  55
1   1423  49
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.71167064, 'recall': 0.515641, 'specificity': 0.515641, 'f1': 0.5217108, 'auroc': 0.88783383, 'binary_precision': 0.45652175, 'binary_recall': 0.032659408, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.06095791}
confusion matrix:
       0   1
0  18124  25
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.90604436, 'recall': 0.57412905, 'specificity': 0.57412905, 'f1': 0.61765754, 'auroc': 0.88436556, 'binary_precision': 0.84782606, 'binary_recall': 0.14942528, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.25407165}
confusion matrix:
      0   1
0  5990   7
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_9.png
new oracle model saved
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9634068608283997
after epoch: 9,now: 2024-06-06 01:08:57.883759,epoch time: 0:14:31.261259,used: 2:16:50.419672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.7105278, 'recall': 0.5296107, 'specificity': 0.5296107, 'f1': 0.54571575, 'auroc': 0.90151983, 'binary_precision': 0.45273632, 'binary_recall': 0.061820652, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.10878661}
confusion matrix:
       0    1
0  42210  110
1   1381   91
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.68610454, 'recall': 0.5250611, 'specificity': 0.5250611, 'f1': 0.5378276, 'auroc': 0.8947946, 'binary_precision': 0.4047619, 'binary_recall': 0.05287714, 'binary_specificity': 0.997245, 'binary_f1_score': 0.09353508}
confusion matrix:
       0   1
0  18099  50
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.90889764, 'recall': 0.60836166, 'specificity': 0.60836166, 'f1': 0.6650014, 'auroc': 0.89577913, 'binary_precision': 0.8507463, 'binary_recall': 0.21839081, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.347561}
confusion matrix:
      0   1
0  5987  10
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_10.png
new oracle model saved
early stop counter: 4
val acc:0.9649319052696228, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9658037424087524
after epoch: 10,now: 2024-06-06 01:23:34.613214,epoch time: 0:14:36.729455,used: 2:31:27.149127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7336817, 'recall': 0.54359347, 'specificity': 0.54359347, 'f1': 0.5679013, 'auroc': 0.90348685, 'binary_precision': 0.49812734, 'binary_recall': 0.09035326, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.15296148}
confusion matrix:
       0    1
0  42186  134
1   1339  133
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7141434, 'recall': 0.54247767, 'specificity': 0.54247767, 'f1': 0.56544733, 'auroc': 0.8956835, 'binary_precision': 0.45967743, 'binary_recall': 0.08864697, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.14863102}
confusion matrix:
       0   1
0  18082  67
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.9082208, 'recall': 0.63684714, 'specificity': 0.63684714, 'f1': 0.6997934, 'auroc': 0.8973791, 'binary_precision': 0.84705883, 'binary_recall': 0.27586207, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.41618496}
confusion matrix:
      0   1
0  5984  13
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_11.png
new oracle model saved
early stop counter: 5
val acc:0.9652511477470398, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9677213430404663
after epoch: 11,now: 2024-06-06 01:38:14.354067,epoch time: 0:14:39.740853,used: 2:46:06.889980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.756973, 'recall': 0.5508926, 'specificity': 0.5508926, 'f1': 0.5794878, 'auroc': 0.9078183, 'binary_precision': 0.5441696, 'binary_recall': 0.10483322, 'binary_specificity': 0.996952, 'binary_f1_score': 0.17579909}
confusion matrix:
       0    1
0  42194  129
1   1315  154
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7082771, 'recall': 0.54164493, 'specificity': 0.54164493, 'f1': 0.5640075, 'auroc': 0.89502823, 'binary_precision': 0.448, 'binary_recall': 0.08709176, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.14583333}
confusion matrix:
       0   1
0  18080  69
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8972408, 'recall': 0.6176901, 'specificity': 0.6176901, 'f1': 0.675821, 'auroc': 0.8988869, 'binary_precision': 0.82666665, 'binary_recall': 0.23754789, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.36904758}
confusion matrix:
      0   1
0  5984  13
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_12.png
early stop counter: 6
val acc:0.9650915265083313, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9677213430404663
after epoch: 12,now: 2024-06-06 01:52:49.410204,epoch time: 0:14:35.056137,used: 3:00:41.946117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.7329427, 'recall': 0.58222175, 'specificity': 0.58222175, 'f1': 0.6181349, 'auroc': 0.91137624, 'binary_precision': 0.4940945, 'binary_recall': 0.1705163, 'binary_specificity': 0.99392724, 'binary_f1_score': 0.25353536}
confusion matrix:
       0    1
0  42063  257
1   1221  251
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7174455, 'recall': 0.5850104, 'specificity': 0.5850104, 'f1': 0.6192273, 'auroc': 0.90186596, 'binary_precision': 0.46341464, 'binary_recall': 0.17729394, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.25646794}
confusion matrix:
       0    1
0  18017  132
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.8904933, 'recall': 0.7047288, 'specificity': 0.7047288, 'f1': 0.7660338, 'auroc': 0.9053551, 'binary_precision': 0.80597013, 'binary_recall': 0.41379312, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5468354}
confusion matrix:
      0    1
0  5971   26
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_13.png
new oracle model saved
early stop counter: 7
val acc:0.964825451374054, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9713966250419617
after epoch: 13,now: 2024-06-06 02:06:55.890290,epoch time: 0:14:06.480086,used: 3:14:48.426203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96542746, 'precision': 0.7150403, 'recall': 0.5775775, 'specificity': 0.5775775, 'f1': 0.6107539, 'auroc': 0.91382694, 'binary_precision': 0.45857418, 'binary_recall': 0.16179469, 'binary_specificity': 0.9933603, 'binary_f1_score': 0.239196}
confusion matrix:
       0    1
0  42040  281
1   1233  238
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.7159462, 'recall': 0.5864554, 'specificity': 0.5864554, 'f1': 0.6205735, 'auroc': 0.9065255, 'binary_precision': 0.46031746, 'binary_recall': 0.18040435, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.25921786}
confusion matrix:
       0    1
0  18013  136
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.9270168, 'recall': 0.7189725, 'specificity': 0.7189725, 'f1': 0.7866864, 'auroc': 0.9129559, 'binary_precision': 0.8778626, 'binary_recall': 0.44061303, 'binary_specificity': 0.997332, 'binary_f1_score': 0.5867347}
confusion matrix:
      0    1
0  5981   16
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_14.png
new oracle model saved
early stop counter: 8
val acc:0.9647190570831299, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9741131067276001
after epoch: 14,now: 2024-06-06 02:20:54.355951,epoch time: 0:13:58.465661,used: 3:28:46.891864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.965633, 'precision': 0.72032815, 'recall': 0.58124703, 'specificity': 0.58124703, 'f1': 0.6155207, 'auroc': 0.91339874, 'binary_precision': 0.46892655, 'binary_recall': 0.16915761, 'binary_specificity': 0.9933365, 'binary_f1_score': 0.24862705}
confusion matrix:
       0    1
0  42038  282
1   1223  249
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.71967125, 'recall': 0.5955112, 'specificity': 0.5955112, 'f1': 0.630572, 'auroc': 0.904873, 'binary_precision': 0.46715328, 'binary_recall': 0.19906688, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.2791712}
confusion matrix:
       0    1
0  18003  146
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.90103364, 'recall': 0.71638983, 'specificity': 0.71638983, 'f1': 0.77865815, 'auroc': 0.9043375, 'binary_precision': 0.82608694, 'binary_recall': 0.43678162, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5973   24
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_15.png
early stop counter: 9
val acc:0.964825451374054, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9741131067276001
after epoch: 15,now: 2024-06-06 02:34:48.565063,epoch time: 0:13:54.209112,used: 3:42:41.100976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.965633, 'precision': 0.72389793, 'recall': 0.6012465, 'specificity': 0.6012465, 'f1': 0.637077, 'auroc': 0.9185201, 'binary_precision': 0.474732, 'binary_recall': 0.21059783, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.2917647}
confusion matrix:
       0    1
0  41977  343
1   1162  310
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.71538806, 'recall': 0.60876423, 'specificity': 0.60876423, 'f1': 0.64261967, 'auroc': 0.9092278, 'binary_precision': 0.45768026, 'binary_recall': 0.22706065, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.3035343}
confusion matrix:
       0    1
0  17976  173
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.90451884, 'recall': 0.75062245, 'specificity': 0.75062245, 'f1': 0.80783737, 'auroc': 0.9051028, 'binary_precision': 0.8301887, 'binary_recall': 0.50574714, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.62857145}
confusion matrix:
      0    1
0  5970   27
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_16.png
new oracle model saved
early stop counter: 10
val acc:0.9643465280532837, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.975071907043457
after epoch: 16,now: 2024-06-06 02:48:55.537193,epoch time: 0:14:06.972130,used: 3:56:48.073106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9655873, 'precision': 0.7252382, 'recall': 0.6156486, 'specificity': 0.6156486, 'f1': 0.650993, 'auroc': 0.91831195, 'binary_precision': 0.47644684, 'binary_recall': 0.24048913, 'binary_specificity': 0.9908081, 'binary_f1_score': 0.3196388}
confusion matrix:
       0    1
0  41931  389
1   1118  354
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.7227547, 'recall': 0.6232081, 'specificity': 0.6232081, 'f1': 0.65710354, 'auroc': 0.91142535, 'binary_precision': 0.47142857, 'binary_recall': 0.25660965, 'binary_specificity': 0.9898066, 'binary_f1_score': 0.3323263}
confusion matrix:
       0    1
0  17964  185
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.90316355, 'recall': 0.75437045, 'specificity': 0.75437045, 'f1': 0.81037617, 'auroc': 0.910427, 'binary_precision': 0.8271605, 'binary_recall': 0.51341, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6335697}
confusion matrix:
      0    1
0  5969   28
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_17.png
new oracle model saved
early stop counter: 11
val acc:0.9647190570831299, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 17,now: 2024-06-06 03:03:16.888500,epoch time: 0:14:21.351307,used: 4:11:09.424413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.74071777, 'recall': 0.63201046, 'specificity': 0.63201046, 'f1': 0.6689214, 'auroc': 0.9190484, 'binary_precision': 0.50629723, 'binary_recall': 0.27328348, 'binary_specificity': 0.99073744, 'binary_f1_score': 0.3549669}
confusion matrix:
       0    1
0  41929  392
1   1069  402
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73264253, 'recall': 0.64379025, 'specificity': 0.64379025, 'f1': 0.6766014, 'auroc': 0.9128533, 'binary_precision': 0.48979592, 'binary_recall': 0.29860032, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.37101448}
confusion matrix:
       0    1
0  17949  200
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.90714777, 'recall': 0.75070584, 'specificity': 0.75070584, 'f1': 0.8086293, 'auroc': 0.90056145, 'binary_precision': 0.835443, 'binary_recall': 0.50574714, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.63007164}
confusion matrix:
      0    1
0  5971   26
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_18.png
early stop counter: 12
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9752317070960999
after epoch: 18,now: 2024-06-06 03:17:36.246310,epoch time: 0:14:19.357810,used: 4:25:28.782223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.7365955, 'recall': 0.6383093, 'specificity': 0.6383093, 'f1': 0.6732411, 'auroc': 0.92102975, 'binary_precision': 0.4976415, 'binary_recall': 0.28668478, 'binary_specificity': 0.98993385, 'binary_f1_score': 0.3637931}
confusion matrix:
       0    1
0  41894  426
1   1050  422
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.7254727, 'recall': 0.6494325, 'specificity': 0.6494325, 'f1': 0.678879, 'auroc': 0.9153646, 'binary_precision': 0.4750594, 'binary_recall': 0.31104198, 'binary_specificity': 0.987823, 'binary_f1_score': 0.37593988}
confusion matrix:
       0    1
0  17928  221
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.89703584, 'recall': 0.76553124, 'specificity': 0.76553124, 'f1': 0.8169944, 'auroc': 0.9057589, 'binary_precision': 0.81395346, 'binary_recall': 0.5363985, 'binary_specificity': 0.994664, 'binary_f1_score': 0.64665127}
confusion matrix:
      0    1
0  5965   32
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_19.png
new oracle model saved
early stop counter: 13
val acc:0.9646658301353455, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9755513072013855
after epoch: 19,now: 2024-06-06 03:31:37.471776,epoch time: 0:14:01.225466,used: 4:39:30.007689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.737054, 'recall': 0.62630296, 'specificity': 0.62630296, 'f1': 0.66309756, 'auroc': 0.91936266, 'binary_precision': 0.4993515, 'binary_recall': 0.2617267, 'binary_specificity': 0.99087924, 'binary_f1_score': 0.34344333}
confusion matrix:
       0    1
0  41935  386
1   1086  385
---- Validation: 
scalar performance:
{'acc': 0.96450615, 'precision': 0.7223246, 'recall': 0.638099, 'specificity': 0.638099, 'f1': 0.66927403, 'auroc': 0.9094518, 'binary_precision': 0.46954316, 'binary_recall': 0.28771386, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.3567985}
confusion matrix:
       0    1
0  17940  209
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.92799056, 'recall': 0.75703657, 'specificity': 0.75703657, 'f1': 0.81930995, 'auroc': 0.90429956, 'binary_precision': 0.8766234, 'binary_recall': 0.51724136, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.6506024}
confusion matrix:
      0    1
0  5978   19
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_20.png
new oracle model saved
early stop counter: 14
val acc:0.9645061492919922, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9768296480178833
after epoch: 20,now: 2024-06-06 03:45:27.719896,epoch time: 0:13:50.248120,used: 4:53:20.255809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7385688, 'recall': 0.621683, 'specificity': 0.621683, 'f1': 0.6592759, 'auroc': 0.9175448, 'binary_precision': 0.50271004, 'binary_recall': 0.25203803, 'binary_specificity': 0.991328, 'binary_f1_score': 0.3357466}
confusion matrix:
       0    1
0  41953  367
1   1101  371
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.72107893, 'recall': 0.63357115, 'specificity': 0.63357115, 'f1': 0.6653278, 'auroc': 0.9130226, 'binary_precision': 0.4673629, 'binary_recall': 0.27838257, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.34892786}
confusion matrix:
       0    1
0  17945  204
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.8993584, 'recall': 0.74287623, 'specificity': 0.74287623, 'f1': 0.800301, 'auroc': 0.9092645, 'binary_precision': 0.82051283, 'binary_recall': 0.49042144, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6139089}
confusion matrix:
      0    1
0  5969   28
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_21.png
early stop counter: 15
val acc:0.9644529819488525, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9768296480178833
after epoch: 21,now: 2024-06-06 03:59:22.718131,epoch time: 0:13:54.998235,used: 5:07:15.254044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.7318774, 'recall': 0.63288635, 'specificity': 0.63288635, 'f1': 0.6675501, 'auroc': 0.9252845, 'binary_precision': 0.48856798, 'binary_recall': 0.27581522, 'binary_specificity': 0.98995745, 'binary_f1_score': 0.35258356}
confusion matrix:
       0    1
0  41895  425
1   1066  406
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7324329, 'recall': 0.64079, 'specificity': 0.64079, 'f1': 0.6741535, 'auroc': 0.9173031, 'binary_precision': 0.48958334, 'binary_recall': 0.29237947, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.36611488}
confusion matrix:
       0    1
0  17953  196
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.91419876, 'recall': 0.7566197, 'specificity': 0.7566197, 'f1': 0.81522816, 'auroc': 0.91216046, 'binary_precision': 0.8490566, 'binary_recall': 0.51724136, 'binary_specificity': 0.995998, 'binary_f1_score': 0.64285713}
confusion matrix:
      0    1
0  5973   24
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_22.png
early stop counter: 16
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9768296480178833
after epoch: 22,now: 2024-06-06 04:13:12.032670,epoch time: 0:13:49.314539,used: 5:21:04.568583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.7473049, 'recall': 0.69529915, 'specificity': 0.69529915, 'f1': 0.7179209, 'auroc': 0.9239441, 'binary_precision': 0.5151778, 'binary_recall': 0.40380692, 'binary_specificity': 0.98679143, 'binary_f1_score': 0.4527439}
confusion matrix:
       0    1
0  41762  559
1    877  594
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.73721224, 'recall': 0.70609987, 'specificity': 0.70609987, 'f1': 0.7204393, 'auroc': 0.9193369, 'binary_precision': 0.49460432, 'binary_recall': 0.42768273, 'binary_specificity': 0.98451704, 'binary_f1_score': 0.4587156}
confusion matrix:
       0    1
0  17868  281
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.88559055, 'recall': 0.7840213, 'specificity': 0.7840213, 'f1': 0.8263365, 'auroc': 0.91211, 'binary_precision': 0.7894737, 'binary_recall': 0.57471263, 'binary_specificity': 0.99333, 'binary_f1_score': 0.6651885}
confusion matrix:
      0    1
0  5957   40
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_23.png
early stop counter: 17
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9768296480178833
after epoch: 23,now: 2024-06-06 04:27:04.101182,epoch time: 0:13:52.068512,used: 5:34:56.637095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7376657, 'recall': 0.65799266, 'specificity': 0.65799266, 'f1': 0.68896025, 'auroc': 0.9275931, 'binary_precision': 0.49844882, 'binary_recall': 0.32744566, 'binary_specificity': 0.9885397, 'binary_f1_score': 0.39524397}
confusion matrix:
       0    1
0  41835  485
1    990  482
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7379881, 'recall': 0.6807082, 'specificity': 0.6807082, 'f1': 0.704996, 'auroc': 0.9225564, 'binary_precision': 0.4979339, 'binary_recall': 0.3748056, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.42768413}
confusion matrix:
       0    1
0  17906  243
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.89954245, 'recall': 0.7807735, 'specificity': 0.7807735, 'f1': 0.8287956, 'auroc': 0.91610754, 'binary_precision': 0.8176796, 'binary_recall': 0.5670498, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6696833}
confusion matrix:
      0    1
0  5964   33
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_24.png
early stop counter: 18
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9768296480178833
after epoch: 24,now: 2024-06-06 04:40:53.561773,epoch time: 0:13:49.460591,used: 5:48:46.097686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.74213934, 'recall': 0.7227109, 'specificity': 0.7227109, 'f1': 0.7319735, 'auroc': 0.9284658, 'binary_precision': 0.50296295, 'binary_recall': 0.4612772, 'binary_specificity': 0.9841446, 'binary_f1_score': 0.481219}
confusion matrix:
       0    1
0  41649  671
1    793  679
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.73587584, 'recall': 0.72843623, 'specificity': 0.72843623, 'f1': 0.7320894, 'auroc': 0.92255396, 'binary_precision': 0.4903537, 'binary_recall': 0.47433904, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.48221347}
confusion matrix:
       0    1
0  17832  317
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.8956143, 'recall': 0.8165884, 'specificity': 0.8165884, 'f1': 0.8512765, 'auroc': 0.9134248, 'binary_precision': 0.8067633, 'binary_recall': 0.63984674, 'binary_specificity': 0.99333, 'binary_f1_score': 0.7136752}
confusion matrix:
      0    1
0  5957   40
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_25.png
new oracle model saved
early stop counter: 19
val acc:0.9651447534561157, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9785873889923096
after epoch: 25,now: 2024-06-06 04:54:43.018054,epoch time: 0:13:49.456281,used: 6:02:35.553967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.74037105, 'recall': 0.7247183, 'specificity': 0.7247183, 'f1': 0.73225147, 'auroc': 0.9283833, 'binary_precision': 0.49927112, 'binary_recall': 0.4656696, 'binary_specificity': 0.9837669, 'binary_f1_score': 0.4818853}
confusion matrix:
       0    1
0  41634  687
1    786  685
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7347231, 'recall': 0.74702233, 'specificity': 0.74702233, 'f1': 0.7406968, 'auroc': 0.9182106, 'binary_precision': 0.48672566, 'binary_recall': 0.5132193, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.4996215}
confusion matrix:
       0    1
0  17801  348
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.89394957, 'recall': 0.8108412, 'specificity': 0.8108412, 'f1': 0.84700394, 'auroc': 0.9154079, 'binary_precision': 0.8039216, 'binary_recall': 0.62835246, 'binary_specificity': 0.99333, 'binary_f1_score': 0.70537627}
confusion matrix:
      0    1
0  5957   40
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_26.png
early stop counter: 20
val acc:0.964825451374054, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9785873889923096
after epoch: 26,now: 2024-06-06 05:08:12.395446,epoch time: 0:13:29.377392,used: 6:16:04.931359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96761966, 'precision': 0.75086355, 'recall': 0.7211029, 'specificity': 0.7211029, 'f1': 0.7349433, 'auroc': 0.93257415, 'binary_precision': 0.5205267, 'binary_recall': 0.45683208, 'binary_specificity': 0.9853737, 'binary_f1_score': 0.4866039}
confusion matrix:
       0    1
0  41702  619
1    799  672
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7377579, 'recall': 0.72632384, 'specificity': 0.72632384, 'f1': 0.7318836, 'auroc': 0.92127943, 'binary_precision': 0.4942717, 'binary_recall': 0.4696734, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.4816587}
confusion matrix:
       0    1
0  17840  309
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.88979286, 'recall': 0.78418803, 'specificity': 0.78418803, 'f1': 0.82790184, 'auroc': 0.92112404, 'binary_precision': 0.79787236, 'binary_recall': 0.57471263, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.66815144}
confusion matrix:
      0    1
0  5959   38
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_27.png
early stop counter: 21
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9785873889923096
after epoch: 27,now: 2024-06-06 05:21:33.528389,epoch time: 0:13:21.132943,used: 6:29:26.064302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9660212, 'precision': 0.735512, 'recall': 0.68221736, 'specificity': 0.68221736, 'f1': 0.70509154, 'auroc': 0.92736244, 'binary_precision': 0.49247122, 'binary_recall': 0.37797415, 'binary_specificity': 0.9864606, 'binary_f1_score': 0.4276923}
confusion matrix:
       0    1
0  41748  573
1    915  556
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7342695, 'recall': 0.71488017, 'specificity': 0.71488017, 'f1': 0.7241074, 'auroc': 0.92178744, 'binary_precision': 0.48809522, 'binary_recall': 0.44634527, 'binary_specificity': 0.98341507, 'binary_f1_score': 0.46628758}
confusion matrix:
       0    1
0  17848  301
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8900444, 'recall': 0.8106745, 'specificity': 0.8106745, 'f1': 0.84540963, 'auroc': 0.92264396, 'binary_precision': 0.79611653, 'binary_recall': 0.62835246, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.70235544}
confusion matrix:
      0    1
0  5955   42
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_28.png
early stop counter: 22
val acc:0.9650382995605469, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9785873889923096
after epoch: 28,now: 2024-06-06 05:35:02.920368,epoch time: 0:13:29.391979,used: 6:42:55.456281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96581566, 'precision': 0.7368163, 'recall': 0.7382145, 'specificity': 0.7382145, 'f1': 0.7375131, 'auroc': 0.9317584, 'binary_precision': 0.4912162, 'binary_recall': 0.49422163, 'binary_specificity': 0.9822074, 'binary_f1_score': 0.49271432}
confusion matrix:
       0    1
0  41568  753
1    744  727
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7387418, 'recall': 0.7473254, 'specificity': 0.7473254, 'f1': 0.74294883, 'auroc': 0.9260262, 'binary_precision': 0.49475262, 'binary_recall': 0.5132193, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.50381684}
confusion matrix:
       0    1
0  17812  337
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8823751, 'recall': 0.8216685, 'specificity': 0.8216685, 'f1': 0.8491322, 'auroc': 0.91515493, 'binary_precision': 0.7798165, 'binary_recall': 0.651341, 'binary_specificity': 0.991996, 'binary_f1_score': 0.70981205}
confusion matrix:
      0    1
0  5949   48
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_29.png
early stop counter: 23
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9785873889923096
after epoch: 29,now: 2024-06-06 05:48:47.669676,epoch time: 0:13:44.749308,used: 6:56:40.205589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9676425, 'precision': 0.7514876, 'recall': 0.70884037, 'specificity': 0.70884037, 'f1': 0.72797763, 'auroc': 0.92996824, 'binary_precision': 0.52263373, 'binary_recall': 0.43138587, 'binary_specificity': 0.9862949, 'binary_f1_score': 0.47264606}
confusion matrix:
       0    1
0  41740  580
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.73802507, 'recall': 0.7233512, 'specificity': 0.7233512, 'f1': 0.7304276, 'auroc': 0.9214845, 'binary_precision': 0.4950166, 'binary_recall': 0.46345258, 'binary_specificity': 0.9832498, 'binary_f1_score': 0.47871488}
confusion matrix:
       0    1
0  17845  304
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.91102815, 'recall': 0.8058445, 'specificity': 0.8058445, 'f1': 0.84997857, 'auroc': 0.91756225, 'binary_precision': 0.8385417, 'binary_recall': 0.61685824, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.71081674}
confusion matrix:
      0    1
0  5966   31
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_30.png
new oracle model saved
early stop counter: 24
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.979066789150238
after epoch: 30,now: 2024-06-06 06:02:35.480040,epoch time: 0:13:47.810364,used: 7:10:28.015953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:10:28.015953 at 2024-06-06 06:02:35.480040
persisted model performance metric: 

scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.86777556, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
oracle model performance metric: 

scalar performance:
{'acc': 0.9795462, 'precision': 0.91948926, 'recall': 0.8042623, 'specificity': 0.8042623, 'f1': 0.85183954, 'auroc': 0.92387587, 'binary_precision': 0.85561496, 'binary_recall': 0.6130268, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.71428573}
confusion matrix:
      0    1
0  5970   27
1   101  160
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 541915 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool | 452096 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 541915 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool | 452096 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525469 KiB |  10983 MiB |   1356 TiB |   1356 TiB |
|       from large pool | 436736 KiB |  10910 MiB |   1354 TiB |   1354 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11286 MiB |  11286 MiB |  11286 MiB |      0 B   |
|       from large pool |  11160 MiB |  11160 MiB |  11160 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1468 MiB |   1816 MiB | 565886 GiB | 565885 GiB |
|       from large pool |   1458 MiB |   1813 MiB | 563391 GiB | 563389 GiB |
|       from small pool |     10 MiB |     11 MiB |   2495 GiB |   2495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  136722 K  |  136718 K  |
|       from large pool |      87    |     909    |   64477 K  |   64477 K  |
|       from small pool |    3642    |    6631    |   72244 K  |   72240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  136722 K  |  136718 K  |
|       from large pool |      87    |     909    |   64477 K  |   64477 K  |
|       from small pool |    3642    |    6631    |   72244 K  |   72240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     231    |     231    |     231    |       0    |
|       from large pool |     168    |     168    |     168    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2772    |   75058 K  |   75058 K  |
|       from large pool |      25    |      60    |   36856 K  |   36856 K  |
|       from small pool |      52    |    2747    |   38202 K  |   38202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   1356 TiB |   1356 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   1354 TiB |   1354 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1998 MiB |  11286 MiB |  11286 MiB |   9288 MiB |
|       from large pool |   1900 MiB |  11160 MiB |  11160 MiB |   9260 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1816 MiB | 565887 GiB | 565886 GiB |
|       from large pool | 116736 KiB |   1813 MiB | 563391 GiB | 563391 GiB |
|       from small pool |      0 KiB |     24 MiB |   2495 GiB |   2495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  136722 K  |  136722 K  |
|       from large pool |       2    |     909    |   64477 K  |   64477 K  |
|       from small pool |       0    |    6631    |   72244 K  |   72244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  136722 K  |  136722 K  |
|       from large pool |       2    |     909    |   64477 K  |   64477 K  |
|       from small pool |       0    |    6631    |   72244 K  |   72244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     231    |     231    |     150    |
|       from large pool |      32    |     168    |     168    |     136    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2772    |   75060 K  |   75060 K  |
|       from large pool |       3    |      60    |   36856 K  |   36856 K  |
|       from small pool |       0    |    2747    |   38203 K  |   38203 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11097 MiB |   1365 TiB |   1365 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   1363 TiB |   1363 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   1356 TiB |   1356 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   1354 TiB |   1354 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1998 MiB |  11286 MiB |  11286 MiB |   9288 MiB |
|       from large pool |   1900 MiB |  11160 MiB |  11160 MiB |   9260 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   1816 MiB | 565887 GiB | 565886 GiB |
|       from large pool | 116736 KiB |   1813 MiB | 563391 GiB | 563391 GiB |
|       from small pool |      0 KiB |     24 MiB |   2495 GiB |   2495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  136722 K  |  136722 K  |
|       from large pool |       2    |     909    |   64477 K  |   64477 K  |
|       from small pool |       0    |    6631    |   72244 K  |   72244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  136722 K  |  136722 K  |
|       from large pool |       2    |     909    |   64477 K  |   64477 K  |
|       from small pool |       0    |    6631    |   72244 K  |   72244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     231    |     231    |     150    |
|       from large pool |      32    |     168    |     168    |     136    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2772    |   75060 K  |   75060 K  |
|       from large pool |       3    |      60    |   36856 K  |   36856 K  |
|       from small pool |       0    |    2747    |   38203 K  |   38203 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985

 Experiment start at: 2024-06-06 06:11:04.736696
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8938116, 'precision': 0.5123651, 'recall': 0.52942514, 'specificity': 0.52942514, 'f1': 0.5115591, 'auroc': 0.54512423, 'binary_precision': 0.055570915, 'binary_recall': 0.13938974, 'binary_specificity': 0.91946054, 'binary_f1_score': 0.07946234}
confusion matrix:
       0     1
0  38998  3416
1   1241   201
---- Validation: 
scalar performance:
{'acc': 0.8022412, 'precision': 0.51777375, 'recall': 0.57771283, 'specificity': 0.57771283, 'f1': 0.4987442, 'auroc': 0.52659273, 'binary_precision': 0.064849354, 'binary_recall': 0.3358098, 'binary_specificity': 0.8196159, 'binary_f1_score': 0.10870611}
confusion matrix:
       0     1
0  14808  3259
1    447   226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91169834, 'precision': 0.48680836, 'recall': 0.48497698, 'specificity': 0.48497698, 'f1': 0.485846, 'auroc': 0.4434054, 'binary_precision': 0.016778523, 'binary_recall': 0.01923077, 'binary_specificity': 0.9507232, 'binary_f1_score': 0.017921148}
confusion matrix:
      0    1
0  5653  293
1   255    5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 06:25:31.099127,epoch time: 0:14:26.362431,used: 0:14:26.362431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96121395, 'precision': 0.54733497, 'recall': 0.51168466, 'specificity': 0.51168466, 'f1': 0.51469636, 'auroc': 0.64520085, 'binary_precision': 0.12680115, 'binary_recall': 0.030513177, 'binary_specificity': 0.99285614, 'binary_f1_score': 0.04918949}
confusion matrix:
       0    1
0  42111  303
1   1398   44
---- Validation: 
scalar performance:
{'acc': 0.94519746, 'precision': 0.54651135, 'recall': 0.53311914, 'specificity': 0.53311914, 'f1': 0.5381772, 'auroc': 0.60794044, 'binary_precision': 0.12658228, 'binary_recall': 0.089153044, 'binary_specificity': 0.9770853, 'binary_f1_score': 0.10462075}
confusion matrix:
       0    1
0  17653  414
1    613   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.5113674, 'recall': 0.50140756, 'specificity': 0.50140756, 'f1': 0.4950339, 'auroc': 0.5995492, 'binary_precision': 0.06451613, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.013745704}
confusion matrix:
      0   1
0  5917  29
1   258   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 06:39:19.199352,epoch time: 0:13:48.100225,used: 0:28:14.462656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.69744366, 'recall': 0.512575, 'specificity': 0.512575, 'f1': 0.5163788, 'auroc': 0.7447527, 'binary_precision': 0.42696628, 'binary_recall': 0.026352288, 'binary_specificity': 0.9987976, 'binary_f1_score': 0.049640756}
confusion matrix:
       0   1
0  42363  51
1   1404  38
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.69490993, 'recall': 0.5331471, 'specificity': 0.5331471, 'f1': 0.55054736, 'auroc': 0.7071533, 'binary_precision': 0.4234234, 'binary_recall': 0.06983655, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.119897954}
confusion matrix:
       0   1
0  18003  64
1    626  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6457897, 'recall': 0.5017549, 'specificity': 0.5017549, 'f1': 0.49306068, 'auroc': 0.71685296, 'binary_precision': 0.33333334, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5944  2
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 06:53:02.890597,epoch time: 0:13:43.691245,used: 0:41:58.153901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.8106671, 'recall': 0.5057885, 'specificity': 0.5057885, 'f1': 0.5032668, 'auroc': 0.82016516, 'binary_precision': 0.65384614, 'binary_recall': 0.011789181, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.023160761}
confusion matrix:
       0   1
0  42405   9
1   1425  17
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.76019645, 'recall': 0.51081204, 'specificity': 0.51081204, 'f1': 0.51232034, 'auroc': 0.80993724, 'binary_precision': 0.5555556, 'binary_recall': 0.022288261, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.04285714}
confusion matrix:
       0   1
0  18055  12
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8073404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-06 07:06:55.895458,epoch time: 0:13:53.004861,used: 0:55:51.158762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7614449, 'recall': 0.5033731, 'specificity': 0.5033731, 'f1': 0.4985017, 'auroc': 0.84827256, 'binary_precision': 0.5555556, 'binary_recall': 0.0069348128, 'binary_specificity': 0.9998114, 'binary_f1_score': 0.01369863}
confusion matrix:
       0   1
0  42406   8
1   1432  10
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.6488534, 'recall': 0.50412554, 'specificity': 0.50412554, 'f1': 0.49945474, 'auroc': 0.84509385, 'binary_precision': 0.33333334, 'binary_recall': 0.008915304, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.017366135}
confusion matrix:
       0   1
0  18055  12
1    667   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.84069836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_5.png
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-06 07:20:40.968880,epoch time: 0:13:45.073422,used: 1:09:36.232184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.7663082, 'recall': 0.5043897, 'specificity': 0.5043897, 'f1': 0.5005314, 'auroc': 0.86706364, 'binary_precision': 0.5652174, 'binary_recall': 0.009015257, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.01774744}
confusion matrix:
       0   1
0  42404  10
1   1429  13
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.71910805, 'recall': 0.5064097, 'specificity': 0.5064097, 'f1': 0.5038452, 'auroc': 0.84974027, 'binary_precision': 0.47368422, 'binary_recall': 0.013372957, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.02601156}
confusion matrix:
       0   1
0  18057  10
1    664   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.84811896, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_6.png
new oracle model saved
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 6,now: 2024-06-06 07:34:26.013049,epoch time: 0:13:45.044169,used: 1:23:21.276353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7224193, 'recall': 0.5070104, 'specificity': 0.5070104, 'f1': 0.5057585, 'auroc': 0.8824791, 'binary_precision': 0.47727272, 'binary_recall': 0.014563107, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.028263794}
confusion matrix:
       0   1
0  42391  23
1   1421  21
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73258984, 'recall': 0.51573586, 'specificity': 0.51573586, 'f1': 0.5215302, 'auroc': 0.8801527, 'binary_precision': 0.5, 'binary_recall': 0.03268945, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.061366804}
confusion matrix:
       0   1
0  18045  22
1    651  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.87133944, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_7.png
new oracle model saved
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9593941569328308
after epoch: 7,now: 2024-06-06 07:48:09.797748,epoch time: 0:13:43.784699,used: 1:37:05.061052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.7996099, 'recall': 0.5180118, 'specificity': 0.5180118, 'f1': 0.5264933, 'auroc': 0.8848187, 'binary_precision': 0.63095236, 'binary_recall': 0.036754508, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.06946265}
confusion matrix:
       0   1
0  42383  31
1   1389  53
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.79301304, 'recall': 0.53194225, 'specificity': 0.53194225, 'f1': 0.5502112, 'auroc': 0.87108207, 'binary_precision': 0.6197183, 'binary_recall': 0.0653789, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.11827956}
confusion matrix:
       0   1
0  18040  27
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.8778138, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 08:01:56.898762,epoch time: 0:13:47.101014,used: 1:50:52.162066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9674617, 'precision': 0.76632166, 'recall': 0.5222837, 'specificity': 0.5222837, 'f1': 0.5340531, 'auroc': 0.8922006, 'binary_precision': 0.5641026, 'binary_recall': 0.045769766, 'binary_specificity': 0.9987976, 'binary_f1_score': 0.084669665}
confusion matrix:
       0   1
0  42363  51
1   1376  66
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7422896, 'recall': 0.54231143, 'specificity': 0.54231143, 'f1': 0.56585205, 'auroc': 0.88661146, 'binary_precision': 0.51754385, 'binary_recall': 0.08766716, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.14993647}
confusion matrix:
       0   1
0  18012  55
1    614  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.89469004, 'recall': 0.5457334, 'specificity': 0.5457334, 'f1': 0.5731052, 'auroc': 0.88392377, 'binary_precision': 0.82758623, 'binary_recall': 0.092307694, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.16608997}
confusion matrix:
      0   1
0  5941   5
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_9.png
new oracle model saved
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9593941569328308 / 0.9611666202545166
after epoch: 9,now: 2024-06-06 08:15:39.229892,epoch time: 0:13:42.331130,used: 2:04:34.493196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678493, 'precision': 0.7752064, 'recall': 0.53889674, 'specificity': 0.53889674, 'f1': 0.56193113, 'auroc': 0.895121, 'binary_precision': 0.5808081, 'binary_recall': 0.079750344, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.14024389}
confusion matrix:
       0    1
0  42331   83
1   1327  115
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.73733974, 'recall': 0.5522699, 'specificity': 0.5522699, 'f1': 0.5802004, 'auroc': 0.89580834, 'binary_precision': 0.5069444, 'binary_recall': 0.10846954, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.17870256}
confusion matrix:
       0   1
0  17996  71
1    600  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.92596793, 'recall': 0.5612021, 'specificity': 0.5612021, 'f1': 0.598534, 'auroc': 0.8826666, 'binary_precision': 0.8888889, 'binary_recall': 0.12307692, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5942   4
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_10.png
new oracle model saved
early stop counter: 2
val acc:0.9641942381858826, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9593941569328308 / 0.9626168012619019
after epoch: 10,now: 2024-06-06 08:29:09.708025,epoch time: 0:13:30.478133,used: 2:18:04.971329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.73702157, 'recall': 0.53720325, 'specificity': 0.53720325, 'f1': 0.55841976, 'auroc': 0.90069014, 'binary_precision': 0.50454545, 'binary_recall': 0.07697642, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.13357401}
confusion matrix:
       0    1
0  42305  109
1   1331  111
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7422303, 'recall': 0.572408, 'specificity': 0.572408, 'f1': 0.6071162, 'auroc': 0.8984624, 'binary_precision': 0.5153061, 'binary_recall': 0.15007429, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.23245107}
confusion matrix:
       0    1
0  17972   95
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.89841557, 'recall': 0.56671906, 'specificity': 0.56671906, 'f1': 0.6063152, 'auroc': 0.8860986, 'binary_precision': 0.8333333, 'binary_recall': 0.13461539, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.23178808}
confusion matrix:
      0   1
0  5939   7
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_11.png
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9593941569328308 / 0.9626168012619019
after epoch: 11,now: 2024-06-06 08:42:45.478585,epoch time: 0:13:35.770560,used: 2:31:40.741889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9675073, 'precision': 0.75423574, 'recall': 0.53972477, 'specificity': 0.53972477, 'f1': 0.56276155, 'auroc': 0.9029376, 'binary_precision': 0.53881276, 'binary_recall': 0.08183079, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.14208308}
confusion matrix:
       0    1
0  42313  101
1   1324  118
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75824016, 'recall': 0.5799205, 'specificity': 0.5799205, 'f1': 0.6177789, 'auroc': 0.8982599, 'binary_precision': 0.54679805, 'binary_recall': 0.16493313, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.25342464}
confusion matrix:
       0    1
0  17975   92
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.95303607, 'recall': 0.56329334, 'specificity': 0.56329334, 'f1': 0.6024149, 'auroc': 0.9018338, 'binary_precision': 0.94285715, 'binary_recall': 0.12692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.22372884}
confusion matrix:
      0   1
0  5944   2
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-06 08:56:31.822090,epoch time: 0:13:46.343505,used: 2:45:27.085394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.72338307, 'recall': 0.56474495, 'specificity': 0.56474495, 'f1': 0.59635115, 'auroc': 0.9088995, 'binary_precision': 0.47549018, 'binary_recall': 0.13453537, 'binary_specificity': 0.99495447, 'binary_f1_score': 0.20972973}
confusion matrix:
       0    1
0  42200  214
1   1248  194
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7430165, 'recall': 0.6282819, 'specificity': 0.6282819, 'f1': 0.6660404, 'auroc': 0.9035089, 'binary_precision': 0.512894, 'binary_recall': 0.26597324, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.35029352}
confusion matrix:
       0    1
0  17897  170
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.92409164, 'recall': 0.65099806, 'specificity': 0.65099806, 'f1': 0.71775544, 'auroc': 0.90253496, 'binary_precision': 0.87777776, 'binary_recall': 0.30384615, 'binary_specificity': 0.99815, 'binary_f1_score': 0.45142853}
confusion matrix:
      0   1
0  5935  11
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_13.png
new oracle model saved
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9690622091293335
after epoch: 13,now: 2024-06-06 09:10:25.436028,epoch time: 0:13:53.613938,used: 2:59:20.699332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7452104, 'recall': 0.56347096, 'specificity': 0.56347096, 'f1': 0.5963397, 'auroc': 0.91108775, 'binary_precision': 0.5192308, 'binary_recall': 0.13106796, 'binary_specificity': 0.995874, 'binary_f1_score': 0.20930234}
confusion matrix:
       0    1
0  42239  175
1   1253  189
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7463404, 'recall': 0.60619164, 'specificity': 0.60619164, 'f1': 0.64560086, 'auroc': 0.90545356, 'binary_precision': 0.52112675, 'binary_recall': 0.21991085, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.3092999}
confusion matrix:
       0    1
0  17931  136
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.90851533, 'recall': 0.61830574, 'specificity': 0.61830574, 'f1': 0.6775348, 'auroc': 0.9056106, 'binary_precision': 0.84931505, 'binary_recall': 0.23846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.3723724}
confusion matrix:
      0   1
0  5935  11
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_14.png
early stop counter: 2
val acc:0.9647278785705566, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9690622091293335
after epoch: 14,now: 2024-06-06 09:24:38.229592,epoch time: 0:14:12.793564,used: 3:13:33.492896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.74318564, 'recall': 0.57920194, 'specificity': 0.57920194, 'f1': 0.61581874, 'auroc': 0.91161966, 'binary_precision': 0.5141612, 'binary_recall': 0.16366158, 'binary_specificity': 0.9947423, 'binary_f1_score': 0.24829037}
confusion matrix:
       0    1
0  42191  223
1   1206  236
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74154234, 'recall': 0.63466394, 'specificity': 0.63466394, 'f1': 0.6712834, 'auroc': 0.90885925, 'binary_precision': 0.50948507, 'binary_recall': 0.2793462, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.36084452}
confusion matrix:
       0    1
0  17886  181
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.91538477, 'recall': 0.652753, 'specificity': 0.652753, 'f1': 0.71862656, 'auroc': 0.9060143, 'binary_precision': 0.86021507, 'binary_recall': 0.30769232, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.45325783}
confusion matrix:
      0   1
0  5933  13
1   180  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_15.png
early stop counter: 3
val acc:0.9644610285758972, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9690622091293335
after epoch: 15,now: 2024-06-06 09:38:47.292566,epoch time: 0:14:09.062974,used: 3:27:42.555870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.732118, 'recall': 0.603098, 'specificity': 0.603098, 'f1': 0.6403813, 'auroc': 0.91202164, 'binary_precision': 0.49044585, 'binary_recall': 0.21374045, 'binary_specificity': 0.9924555, 'binary_f1_score': 0.29772836}
confusion matrix:
       0    1
0  42095  320
1   1133  308
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74076337, 'recall': 0.67108727, 'specificity': 0.67108727, 'f1': 0.69935894, 'auroc': 0.9121183, 'binary_precision': 0.50528544, 'binary_recall': 0.3551263, 'binary_specificity': 0.9870482, 'binary_f1_score': 0.41710293}
confusion matrix:
       0    1
0  17833  234
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.90357196, 'recall': 0.67348635, 'specificity': 0.67348635, 'f1': 0.7388486, 'auroc': 0.9171777, 'binary_precision': 0.8348624, 'binary_recall': 0.35, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.49322495}
confusion matrix:
      0   1
0  5928  18
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_16.png
new oracle model saved
early stop counter: 4
val acc:0.9643543362617493, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9698678851127625
after epoch: 16,now: 2024-06-06 09:53:05.273740,epoch time: 0:14:17.981174,used: 3:42:00.537044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9667776, 'precision': 0.732573, 'recall': 0.6234205, 'specificity': 0.6234205, 'f1': 0.65959054, 'auroc': 0.912365, 'binary_precision': 0.49003986, 'binary_recall': 0.2558946, 'binary_specificity': 0.9909464, 'binary_f1_score': 0.33621866}
confusion matrix:
       0    1
0  42030  384
1   1073  369
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74119854, 'recall': 0.69039947, 'specificity': 0.69039947, 'f1': 0.71246046, 'auroc': 0.9156243, 'binary_precision': 0.5047438, 'binary_recall': 0.39524516, 'binary_specificity': 0.9855538, 'binary_f1_score': 0.4433333}
confusion matrix:
       0    1
0  17806  261
1    407  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.892578, 'recall': 0.7321768, 'specificity': 0.7321768, 'f1': 0.7898792, 'auroc': 0.90665215, 'binary_precision': 0.80794704, 'binary_recall': 0.46923077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.593674}
confusion matrix:
      0    1
0  5917   29
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_17.png
new oracle model saved
early stop counter: 5
val acc:0.9643543362617493, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9730905294418335
after epoch: 17,now: 2024-06-06 10:07:29.094739,epoch time: 0:14:23.820999,used: 3:56:24.358043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96620756, 'precision': 0.7228308, 'recall': 0.6100626, 'specificity': 0.6100626, 'f1': 0.6454021, 'auroc': 0.91494215, 'binary_precision': 0.47142857, 'binary_recall': 0.22884881, 'binary_specificity': 0.99127644, 'binary_f1_score': 0.30812323}
confusion matrix:
       0    1
0  42044  370
1   1112  330
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7362814, 'recall': 0.675845, 'specificity': 0.675845, 'f1': 0.70111406, 'auroc': 0.9156409, 'binary_precision': 0.49596775, 'binary_recall': 0.36552748, 'binary_specificity': 0.9861626, 'binary_f1_score': 0.4208725}
confusion matrix:
       0    1
0  17817  250
1    427  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.88323414, 'recall': 0.6958065, 'specificity': 0.6958065, 'f1': 0.75644994, 'auroc': 0.90643036, 'binary_precision': 0.7923077, 'binary_recall': 0.39615384, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.5282051}
confusion matrix:
      0    1
0  5919   27
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_18.png
early stop counter: 6
val acc:0.9638740420341492, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9730905294418335
after epoch: 18,now: 2024-06-06 10:21:45.206835,epoch time: 0:14:16.112096,used: 4:10:40.470139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.7440704, 'recall': 0.61309105, 'specificity': 0.61309105, 'f1': 0.6523128, 'auroc': 0.91495526, 'binary_precision': 0.5137195, 'binary_recall': 0.2337032, 'binary_specificity': 0.9924789, 'binary_f1_score': 0.32125834}
confusion matrix:
       0    1
0  42095  319
1   1105  337
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7445769, 'recall': 0.6669894, 'specificity': 0.6669894, 'f1': 0.69765216, 'auroc': 0.91375065, 'binary_precision': 0.51321584, 'binary_recall': 0.346211, 'binary_specificity': 0.98776776, 'binary_f1_score': 0.41348714}
confusion matrix:
       0    1
0  17846  221
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.9195411, 'recall': 0.72724843, 'specificity': 0.72724843, 'f1': 0.7923361, 'auroc': 0.91200095, 'binary_precision': 0.8623188, 'binary_recall': 0.4576923, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.5979899}
confusion matrix:
      0    1
0  5927   19
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_19.png
new oracle model saved
early stop counter: 7
val acc:0.9647278785705566, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.974218487739563
after epoch: 19,now: 2024-06-06 10:35:50.958579,epoch time: 0:14:05.751744,used: 4:24:46.221883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9666864, 'precision': 0.73256177, 'recall': 0.6401209, 'specificity': 0.6401209, 'f1': 0.6737006, 'auroc': 0.92152727, 'binary_precision': 0.48891482, 'binary_recall': 0.29056865, 'binary_specificity': 0.9896732, 'binary_f1_score': 0.36450633}
confusion matrix:
       0    1
0  41976  438
1   1023  419
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74317133, 'recall': 0.69337124, 'specificity': 0.69337124, 'f1': 0.71510047, 'auroc': 0.918731, 'binary_precision': 0.5084746, 'binary_recall': 0.4011887, 'binary_specificity': 0.9855538, 'binary_f1_score': 0.44850495}
confusion matrix:
       0    1
0  17806  261
1    403  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.9015646, 'recall': 0.7267439, 'specificity': 0.7267439, 'f1': 0.78764236, 'auroc': 0.9134054, 'binary_precision': 0.8263889, 'binary_recall': 0.4576923, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.5891089}
confusion matrix:
      0    1
0  5921   25
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_20.png
early stop counter: 8
val acc:0.9645677804946899, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.974218487739563
after epoch: 20,now: 2024-06-06 10:50:05.609724,epoch time: 0:14:14.651145,used: 4:39:00.873028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96586555, 'precision': 0.7229228, 'recall': 0.6413713, 'specificity': 0.6413713, 'f1': 0.67204225, 'auroc': 0.9215102, 'binary_precision': 0.46954596, 'binary_recall': 0.29403606, 'binary_specificity': 0.9887066, 'binary_f1_score': 0.3616205}
confusion matrix:
       0    1
0  41935  479
1   1018  424
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.7328317, 'recall': 0.70841527, 'specificity': 0.70841527, 'f1': 0.71986467, 'auroc': 0.91867197, 'binary_precision': 0.48666668, 'binary_recall': 0.43387815, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.45875883}
confusion matrix:
       0    1
0  17759  308
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.8946908, 'recall': 0.73794603, 'specificity': 0.73794603, 'f1': 0.7950978, 'auroc': 0.9014038, 'binary_precision': 0.8116883, 'binary_recall': 0.48076922, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.60386467}
confusion matrix:
      0    1
0  5917   29
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_21.png
early stop counter: 9
val acc:0.9632337093353271, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.974218487739563
after epoch: 21,now: 2024-06-06 11:04:03.648341,epoch time: 0:13:58.038617,used: 4:52:58.911645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96566033, 'precision': 0.72611773, 'recall': 0.68648374, 'specificity': 0.68648374, 'f1': 0.7041839, 'auroc': 0.9254545, 'binary_precision': 0.47292724, 'binary_recall': 0.38765603, 'binary_specificity': 0.98531145, 'binary_f1_score': 0.42606705}
confusion matrix:
       0    1
0  41791  623
1    883  559
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7391928, 'recall': 0.7402191, 'specificity': 0.7402191, 'f1': 0.7397047, 'auroc': 0.9217639, 'binary_precision': 0.49704143, 'binary_recall': 0.49925706, 'binary_specificity': 0.98118114, 'binary_f1_score': 0.4981468}
confusion matrix:
       0    1
0  17727  340
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9771189, 'precision': 0.89963204, 'recall': 0.7894486, 'specificity': 0.7894486, 'f1': 0.8348737, 'auroc': 0.9174714, 'binary_precision': 0.8172043, 'binary_recall': 0.5846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.68161434}
confusion matrix:
      0    1
0  5912   34
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_22.png
new oracle model saved
early stop counter: 10
val acc:0.9638740420341492, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9771189093589783
after epoch: 22,now: 2024-06-06 11:18:20.501567,epoch time: 0:14:16.853226,used: 5:07:15.764871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.73179626, 'recall': 0.6337451, 'specificity': 0.6337451, 'f1': 0.66827995, 'auroc': 0.9256425, 'binary_precision': 0.4878049, 'binary_recall': 0.2773925, 'binary_specificity': 0.9900976, 'binary_f1_score': 0.35366932}
confusion matrix:
       0    1
0  41994  420
1   1042  400
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74132097, 'recall': 0.6954063, 'specificity': 0.6954063, 'f1': 0.7156667, 'auroc': 0.92096996, 'binary_precision': 0.5046211, 'binary_recall': 0.40564635, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.44975287}
confusion matrix:
       0    1
0  17799  268
1    400  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.92807615, 'recall': 0.7236545, 'specificity': 0.7236545, 'f1': 0.7910954, 'auroc': 0.9283701, 'binary_precision': 0.87969923, 'binary_recall': 0.45, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.5954198}
confusion matrix:
      0    1
0  5930   16
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_23.png
early stop counter: 11
val acc:0.9643543362617493, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9771189093589783
after epoch: 23,now: 2024-06-06 11:32:18.848463,epoch time: 0:13:58.346896,used: 5:21:14.111767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.7331126, 'recall': 0.6217693, 'specificity': 0.6217693, 'f1': 0.6582371, 'auroc': 0.9214598, 'binary_precision': 0.49122807, 'binary_recall': 0.2524272, 'binary_specificity': 0.9911114, 'binary_f1_score': 0.33348602}
confusion matrix:
       0    1
0  42037  377
1   1078  364
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7427422, 'recall': 0.6962046, 'specificity': 0.6962046, 'f1': 0.7167181, 'auroc': 0.9219917, 'binary_precision': 0.5074074, 'binary_recall': 0.40713224, 'binary_specificity': 0.985277, 'binary_f1_score': 0.45177245}
confusion matrix:
       0    1
0  17801  266
1    399  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.9028764, 'recall': 0.7058423, 'specificity': 0.7058423, 'f1': 0.76968634, 'auroc': 0.9137075, 'binary_precision': 0.83076924, 'binary_recall': 0.41538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.5538462}
confusion matrix:
      0    1
0  5924   22
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_24.png
early stop counter: 12
val acc:0.964514434337616, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.963100254535675 / 0.9771189093589783
after epoch: 24,now: 2024-06-06 11:46:29.111160,epoch time: 0:14:10.262697,used: 5:35:24.374464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9666864, 'precision': 0.73216975, 'recall': 0.6347617, 'specificity': 0.6347617, 'f1': 0.6692186, 'auroc': 0.92655444, 'binary_precision': 0.48848486, 'binary_recall': 0.27947295, 'binary_specificity': 0.99005044, 'binary_f1_score': 0.35553592}
confusion matrix:
       0    1
0  41992  422
1   1039  403
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.75022984, 'recall': 0.6873213, 'specificity': 0.6873213, 'f1': 0.71374506, 'auroc': 0.91804355, 'binary_precision': 0.5230461, 'binary_recall': 0.38781574, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.44539246}
confusion matrix:
       0    1
0  17829  238
1    412  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.92366993, 'recall': 0.7197243, 'specificity': 0.7197243, 'f1': 0.78662854, 'auroc': 0.92006826, 'binary_precision': 0.8712121, 'binary_recall': 0.44230768, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.58673465}
confusion matrix:
      0    1
0  5929   17
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_25.png
better model found
persisted
after epoch: 25,now: 2024-06-06 12:00:18.142081,epoch time: 0:13:49.030921,used: 5:49:13.405385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.73539615, 'recall': 0.64992887, 'specificity': 0.64992887, 'f1': 0.6822088, 'auroc': 0.926109, 'binary_precision': 0.49393606, 'binary_recall': 0.3106796, 'binary_specificity': 0.9891781, 'binary_f1_score': 0.3814389}
confusion matrix:
       0    1
0  41955  459
1    994  448
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.735549, 'recall': 0.6979076, 'specificity': 0.6979076, 'f1': 0.7148971, 'auroc': 0.92357606, 'binary_precision': 0.49288255, 'binary_recall': 0.4115899, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.44858298}
confusion matrix:
       0    1
0  17782  285
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.90467894, 'recall': 0.7439675, 'specificity': 0.7439675, 'f1': 0.8025943, 'auroc': 0.90409386, 'binary_precision': 0.83116883, 'binary_recall': 0.4923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.6183575}
confusion matrix:
      0    1
0  5920   26
1   132  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_26.png
early stop counter: 1
val acc:0.9636605978012085, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9738962054252625 / 0.9771189093589783
after epoch: 26,now: 2024-06-06 12:13:38.857156,epoch time: 0:13:20.715075,used: 6:02:34.120460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.73730636, 'recall': 0.69780344, 'specificity': 0.69780344, 'f1': 0.71556705, 'auroc': 0.9272526, 'binary_precision': 0.49456066, 'binary_recall': 0.40984744, 'binary_specificity': 0.98575944, 'binary_f1_score': 0.4482366}
confusion matrix:
       0    1
0  41810  604
1    851  591
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.73832285, 'recall': 0.75226796, 'specificity': 0.75226796, 'f1': 0.7450721, 'auroc': 0.9275857, 'binary_precision': 0.49439776, 'binary_recall': 0.52451706, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.5090122}
confusion matrix:
       0    1
0  17706  361
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.89225864, 'recall': 0.7796651, 'specificity': 0.7796651, 'f1': 0.8256041, 'auroc': 0.9087816, 'binary_precision': 0.8032787, 'binary_recall': 0.5653846, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6636569}
confusion matrix:
      0    1
0  5910   36
1   113  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_27.png
early stop counter: 2
val acc:0.9636605978012085, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9738962054252625 / 0.9771189093589783
after epoch: 27,now: 2024-06-06 12:26:58.096972,epoch time: 0:13:19.239816,used: 6:15:53.360276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9665724, 'precision': 0.73258847, 'recall': 0.6591543, 'specificity': 0.6591543, 'f1': 0.6882631, 'auroc': 0.93166035, 'binary_precision': 0.48770493, 'binary_recall': 0.33009708, 'binary_specificity': 0.98821145, 'binary_f1_score': 0.3937138}
confusion matrix:
       0    1
0  41914  500
1    966  476
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7401955, 'recall': 0.727455, 'specificity': 0.727455, 'f1': 0.7336305, 'auroc': 0.9261477, 'binary_precision': 0.5, 'binary_recall': 0.47251114, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.48586705}
confusion matrix:
       0    1
0  17749  318
1    355  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.9168949, 'recall': 0.74815, 'specificity': 0.74815, 'f1': 0.80920064, 'auroc': 0.92895436, 'binary_precision': 0.8552632, 'binary_recall': 0.5, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.63106793}
confusion matrix:
      0    1
0  5924   22
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_28.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9738962054252625 / 0.9771189093589783
after epoch: 28,now: 2024-06-06 12:40:41.024883,epoch time: 0:13:42.927911,used: 6:29:36.288187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9664812, 'precision': 0.7325538, 'recall': 0.6721703, 'specificity': 0.6721703, 'f1': 0.69737446, 'auroc': 0.9260918, 'binary_precision': 0.4867675, 'binary_recall': 0.35714287, 'binary_specificity': 0.98719764, 'binary_f1_score': 0.41200003}
confusion matrix:
       0    1
0  41871  543
1    927  515
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7447984, 'recall': 0.73848844, 'specificity': 0.73848844, 'f1': 0.7415972, 'auroc': 0.9273955, 'binary_precision': 0.5083969, 'binary_recall': 0.4947994, 'binary_specificity': 0.98217744, 'binary_f1_score': 0.501506}
confusion matrix:
       0    1
0  17745  322
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.88575983, 'recall': 0.76043427, 'specificity': 0.76043427, 'f1': 0.80976063, 'auroc': 0.9239955, 'binary_precision': 0.7919075, 'binary_recall': 0.52692306, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6327945}
confusion matrix:
      0    1
0  5910   36
1   123  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_29.png
early stop counter: 4
val acc:0.9646744728088379, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9738962054252625 / 0.9771189093589783
after epoch: 29,now: 2024-06-06 12:54:30.417450,epoch time: 0:13:49.392567,used: 6:43:25.680754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96654963, 'precision': 0.73409116, 'recall': 0.68526876, 'specificity': 0.68526876, 'f1': 0.7065301, 'auroc': 0.9335377, 'binary_precision': 0.48896733, 'binary_recall': 0.38418862, 'binary_specificity': 0.98634887, 'binary_f1_score': 0.43029127}
confusion matrix:
       0    1
0  41835  579
1    888  554
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7456484, 'recall': 0.7621199, 'specificity': 0.7621199, 'f1': 0.7535839, 'auroc': 0.9315057, 'binary_precision': 0.5083333, 'binary_recall': 0.54383355, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.52548456}
confusion matrix:
       0    1
0  17713  354
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.89287466, 'recall': 0.7815882, 'specificity': 0.7815882, 'f1': 0.8271502, 'auroc': 0.9226903, 'binary_precision': 0.8043478, 'binary_recall': 0.5692308, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5910   36
1   112  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_30.png
early stop counter: 5
val acc:0.9647278785705566, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9738962054252625 / 0.9771189093589783
after epoch: 30,now: 2024-06-06 13:08:21.540970,epoch time: 0:13:51.123520,used: 6:57:16.804274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_11_04_seed_1_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:57:16.804274 at 2024-06-06 13:08:21.540970
persisted model performance metric: 

scalar performance:
{'acc': 0.9761521, 'precision': 0.9362167, 'recall': 0.7429694, 'specificity': 0.7429694, 'f1': 0.80975884, 'auroc': 0.9121245, 'binary_precision': 0.8943662, 'binary_recall': 0.48846152, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.63184077}
confusion matrix:
      0    1
0  5931   15
1   133  127
oracle model performance metric: 

scalar performance:
{'acc': 0.97599095, 'precision': 0.89225864, 'recall': 0.7796651, 'specificity': 0.7796651, 'f1': 0.8256041, 'auroc': 0.9185276, 'binary_precision': 0.8032787, 'binary_recall': 0.5653846, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6636569}
confusion matrix:
      0    1
0  5910   36
1   113  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 543631 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool | 453824 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |  89807 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 543631 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool | 453824 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |  89807 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525466 KiB |  10983 MiB |   2718 TiB |   2718 TiB |
|       from large pool | 436736 KiB |  10910 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  88730 KiB |    124 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11284 MiB |  11286 MiB |  20572 MiB |   9288 MiB |
|       from large pool |  11160 MiB |  11160 MiB |  20420 MiB |   9260 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1461 MiB |   2382 MiB |   1110 TiB |   1110 TiB |
|       from large pool |   1450 MiB |   2378 MiB |   1105 TiB |   1105 TiB |
|       from small pool |     10 MiB |     24 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  273895 K  |  273891 K  |
|       from large pool |      87    |     909    |  129216 K  |  129216 K  |
|       from small pool |    3618    |    6639    |  144678 K  |  144675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  273895 K  |  273891 K  |
|       from large pool |      87    |     909    |  129216 K  |  129216 K  |
|       from small pool |    3618    |    6639    |  144678 K  |  144675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     228    |     231    |     378    |     150    |
|       from large pool |     166    |     168    |     302    |     136    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2776    |  148637 K  |  148637 K  |
|       from large pool |      24    |      60    |   72276 K  |   72276 K  |
|       from small pool |      53    |    2751    |   76360 K  |   76360 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   2718 TiB |   2718 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    124 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1992 MiB |  11286 MiB |  20572 MiB |  18580 MiB |
|       from large pool |   1894 MiB |  11160 MiB |  20420 MiB |  18526 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2382 MiB |   1110 TiB |   1110 TiB |
|       from large pool | 116736 KiB |   2378 MiB |   1105 TiB |   1105 TiB |
|       from small pool |      0 KiB |     24 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  273895 K  |  273895 K  |
|       from large pool |       2    |     909    |  129216 K  |  129216 K  |
|       from small pool |       0    |    6639    |  144678 K  |  144678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  273895 K  |  273895 K  |
|       from large pool |       2    |     909    |  129216 K  |  129216 K  |
|       from small pool |       0    |    6639    |  144678 K  |  144678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     231    |     378    |     294    |
|       from large pool |      35    |     168    |     302    |     267    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2776    |  148638 K  |  148638 K  |
|       from large pool |       3    |      60    |   72276 K  |   72276 K  |
|       from small pool |       0    |    2751    |   76362 K  |   76362 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11097 MiB |   2735 TiB |   2735 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   2730 TiB |   2730 TiB |
|       from small pool |      0 KiB |    125 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   2718 TiB |   2718 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    124 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1992 MiB |  11286 MiB |  20572 MiB |  18580 MiB |
|       from large pool |   1894 MiB |  11160 MiB |  20420 MiB |  18526 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2382 MiB |   1110 TiB |   1110 TiB |
|       from large pool | 116736 KiB |   2378 MiB |   1105 TiB |   1105 TiB |
|       from small pool |      0 KiB |     24 MiB |      4 TiB |      4 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  273895 K  |  273895 K  |
|       from large pool |       2    |     909    |  129216 K  |  129216 K  |
|       from small pool |       0    |    6639    |  144678 K  |  144678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  273895 K  |  273895 K  |
|       from large pool |       2    |     909    |  129216 K  |  129216 K  |
|       from small pool |       0    |    6639    |  144678 K  |  144678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     231    |     378    |     294    |
|       from large pool |      35    |     168    |     302    |     267    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2776    |  148638 K  |  148638 K  |
|       from large pool |       3    |      60    |   72276 K  |   72276 K  |
|       from small pool |       0    |    2751    |   76362 K  |   76362 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985

 Experiment start at: 2024-06-06 13:15:39.098631
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9531307, 'precision': 0.49066883, 'recall': 0.4964747, 'specificity': 0.4964747, 'f1': 0.4923426, 'auroc': 0.4929483, 'binary_precision': 0.01610018, 'binary_recall': 0.0059484467, 'binary_specificity': 0.987001, 'binary_f1_score': 0.008687259}
confusion matrix:
       0    1
0  41761  550
1   1504    9
---- Validation: 
scalar performance:
{'acc': 0.9435359, 'precision': 0.48687467, 'recall': 0.48980662, 'specificity': 0.48980662, 'f1': 0.48828575, 'auroc': 0.39676976, 'binary_precision': 0.0064655175, 'binary_recall': 0.004983389, 'binary_specificity': 0.9746299, 'binary_f1_score': 0.005628518}
confusion matrix:
       0    1
0  17710  461
1    599    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94774806, 'precision': 0.49723262, 'recall': 0.49894473, 'specificity': 0.49894473, 'f1': 0.49561608, 'auroc': 0.4108144, 'binary_precision': 0.033333335, 'binary_recall': 0.012396694, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.01807229}
confusion matrix:
      0   1
0  5910  87
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 13:29:57.019529,epoch time: 0:14:17.920898,used: 0:14:17.920898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9648138, 'precision': 0.5468821, 'recall': 0.50125057, 'specificity': 0.50125057, 'f1': 0.49426654, 'auroc': 0.6842356, 'binary_precision': 0.12820514, 'binary_recall': 0.0033046927, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.0064432994}
confusion matrix:
       0   1
0  42277  34
1   1508   5
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.4839535, 'recall': 0.49958727, 'specificity': 0.49958727, 'f1': 0.4916461, 'auroc': 0.65206504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18156  15
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.603764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 13:43:50.627281,epoch time: 0:13:53.607752,used: 0:28:11.528650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.965293, 'precision': 0.48273462, 'recall': 0.49990547, 'specificity': 0.49990547, 'f1': 0.49117005, 'auroc': 0.78512657, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42303  8
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.7866771, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.75864655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 13:57:36.128185,epoch time: 0:13:45.500904,used: 0:41:57.029554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.98274875, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918835, 'auroc': 0.8434292, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42311  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83694804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8112407, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-06 14:11:24.897140,epoch time: 0:13:48.768955,used: 0:55:45.798509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.48273736, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.49121138, 'auroc': 0.86079574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  1
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.86728114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8665891, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_5.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9613720178604126
after epoch: 5,now: 2024-06-06 14:25:11.407714,epoch time: 0:13:46.510574,used: 1:09:32.309083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.8658511, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8728392, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.8555958, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_6.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9615322947502136
after epoch: 6,now: 2024-06-06 14:39:07.136527,epoch time: 0:13:55.728813,used: 1:23:28.037896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.85777044, 'recall': 0.5009796, 'specificity': 0.5009796, 'f1': 0.49320605, 'auroc': 0.8867021, 'binary_precision': 0.75, 'binary_recall': 0.0019828156, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0039551747}
confusion matrix:
       0  1
0  42310  1
1   1510  3
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.65065706, 'recall': 0.5007755, 'specificity': 0.5007755, 'f1': 0.49349123, 'auroc': 0.89304477, 'binary_precision': 0.33333334, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0033057851}
confusion matrix:
       0  1
0  18169  2
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.9810685, 'recall': 0.5123967, 'specificity': 0.5123967, 'f1': 0.51454514, 'auroc': 0.8676921, 'binary_precision': 1.0, 'binary_recall': 0.024793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.048387095}
confusion matrix:
      0  1
0  5997  0
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_7.png
new oracle model saved
early stop counter: 3
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9621734023094177
after epoch: 7,now: 2024-06-06 14:52:42.293612,epoch time: 0:13:35.157085,used: 1:37:03.194981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.7828346, 'recall': 0.50290334, 'specificity': 0.50290334, 'f1': 0.49712324, 'auroc': 0.8901956, 'binary_precision': 0.6, 'binary_recall': 0.0059484467, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.011780105}
confusion matrix:
       0  1
0  42305  6
1   1504  9
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.8173504, 'recall': 0.50163364, 'specificity': 0.50163364, 'f1': 0.49517122, 'auroc': 0.89577365, 'binary_precision': 0.6666667, 'binary_recall': 0.003322259, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0066115703}
confusion matrix:
       0  1
0  18170  1
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.87954104, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-06 15:06:09.609194,epoch time: 0:13:27.315582,used: 1:50:30.510563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7028535, 'recall': 0.5034697, 'specificity': 0.5034697, 'f1': 0.49834946, 'auroc': 0.89518297, 'binary_precision': 0.44, 'binary_recall': 0.007270324, 'binary_specificity': 0.99966913, 'binary_f1_score': 0.014304291}
confusion matrix:
       0   1
0  42297  14
1   1502  11
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7473746, 'recall': 0.508058, 'specificity': 0.508058, 'f1': 0.5079649, 'auroc': 0.89995766, 'binary_precision': 0.5263158, 'binary_recall': 0.016611295, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.032206118}
confusion matrix:
       0   1
0  18162   9
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.9483504, 'recall': 0.5288422, 'specificity': 0.5288422, 'f1': 0.5451056, 'auroc': 0.8843816, 'binary_precision': 0.93333334, 'binary_recall': 0.05785124, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.108949415}
confusion matrix:
      0   1
0  5996   1
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_9.png
new oracle model saved
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9632954001426697
after epoch: 9,now: 2024-06-06 15:19:37.130596,epoch time: 0:13:27.521402,used: 2:03:58.031965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96513325, 'precision': 0.6715011, 'recall': 0.5071517, 'specificity': 0.5071517, 'f1': 0.50573635, 'auroc': 0.899291, 'binary_precision': 0.37704918, 'binary_recall': 0.015201586, 'binary_specificity': 0.9991019, 'binary_f1_score': 0.029224904}
confusion matrix:
       0   1
0  42273  38
1   1490  23
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7343408, 'recall': 0.51204574, 'specificity': 0.51204574, 'f1': 0.5155801, 'auroc': 0.90210783, 'binary_precision': 0.5, 'binary_recall': 0.024916943, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.047468353}
confusion matrix:
       0   1
0  18156  15
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.9605646, 'recall': 0.5453712, 'specificity': 0.5453712, 'f1': 0.57397115, 'auroc': 0.873179, 'binary_precision': 0.95652175, 'binary_recall': 0.09090909, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.16603774}
confusion matrix:
      0   1
0  5996   1
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_10.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9645776748657227
after epoch: 10,now: 2024-06-06 15:33:13.345197,epoch time: 0:13:36.214601,used: 2:17:34.246566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9651104, 'precision': 0.7005091, 'recall': 0.5166995, 'specificity': 0.5166995, 'f1': 0.52352774, 'auroc': 0.907729, 'binary_precision': 0.43442622, 'binary_recall': 0.035029743, 'binary_specificity': 0.9983692, 'binary_f1_score': 0.06483181}
confusion matrix:
       0   1
0  42242  69
1   1460  53
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.6538292, 'recall': 0.5163137, 'specificity': 0.5163137, 'f1': 0.5231942, 'auroc': 0.9042359, 'binary_precision': 0.33870968, 'binary_recall': 0.034883723, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.063253015}
confusion matrix:
       0   1
0  18130  41
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.9381014, 'recall': 0.6008228, 'specificity': 0.6008228, 'f1': 0.6574138, 'auroc': 0.89059126, 'binary_precision': 0.9074074, 'binary_recall': 0.20247933, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.33108106}
confusion matrix:
      0   1
0  5992   5
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_11.png
new oracle model saved
early stop counter: 3
val acc:0.9668673276901245, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9682641625404358
after epoch: 11,now: 2024-06-06 15:47:10.461971,epoch time: 0:13:57.116774,used: 2:31:31.363340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96499634, 'precision': 0.7004461, 'recall': 0.5217388, 'specificity': 0.5217388, 'f1': 0.53234684, 'auroc': 0.9044134, 'binary_precision': 0.43396226, 'binary_recall': 0.045604758, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.082535885}
confusion matrix:
       0   1
0  42221  90
1   1444  69
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.71417046, 'recall': 0.52234775, 'specificity': 0.52234775, 'f1': 0.53400356, 'auroc': 0.90155923, 'binary_precision': 0.45901638, 'binary_recall': 0.046511628, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.08446455}
confusion matrix:
       0   1
0  18138  33
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.9535558, 'recall': 0.5947912, 'specificity': 0.5947912, 'f1': 0.64991117, 'auroc': 0.89139664, 'binary_precision': 0.93877554, 'binary_recall': 0.19008264, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3161512}
confusion matrix:
      0   1
0  5994   3
1   196  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_12.png
early stop counter: 4
val acc:0.9676663279533386, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9682641625404358
after epoch: 12,now: 2024-06-06 16:01:05.823767,epoch time: 0:13:55.361796,used: 2:45:26.725136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96527016, 'precision': 0.72463703, 'recall': 0.5368573, 'specificity': 0.5368573, 'f1': 0.5572748, 'auroc': 0.91129494, 'binary_precision': 0.4813278, 'binary_recall': 0.07666887, 'binary_specificity': 0.9970457, 'binary_f1_score': 0.1322691}
confusion matrix:
       0    1
0  42186  125
1   1397  116
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.6859687, 'recall': 0.5355318, 'specificity': 0.5355318, 'f1': 0.5545543, 'auroc': 0.9126293, 'binary_precision': 0.4017857, 'binary_recall': 0.07475083, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.12605041}
confusion matrix:
       0   1
0  18104  67
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.91115826, 'recall': 0.62924814, 'specificity': 0.62924814, 'f1': 0.6915559, 'auroc': 0.90083826, 'binary_precision': 0.8513514, 'binary_recall': 0.2603306, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3987342}
confusion matrix:
      0   1
0  5986  11
1   179  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_13.png
new oracle model saved
early stop counter: 5
val acc:0.9667607545852661, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.969546377658844
after epoch: 13,now: 2024-06-06 16:15:06.302692,epoch time: 0:14:00.478925,used: 2:59:27.204061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7344389, 'recall': 0.5506657, 'specificity': 0.5506657, 'f1': 0.5780225, 'auroc': 0.9115983, 'binary_precision': 0.5, 'binary_recall': 0.105089225, 'binary_specificity': 0.9962421, 'binary_f1_score': 0.17367558}
confusion matrix:
       0    1
0  42152  159
1   1354  159
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7327608, 'recall': 0.56258273, 'specificity': 0.56258273, 'f1': 0.59442186, 'auroc': 0.9126165, 'binary_precision': 0.49367088, 'binary_recall': 0.1295681, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.20526314}
confusion matrix:
       0   1
0  18091  80
1    524  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97082865, 'precision': 0.92353666, 'recall': 0.64379436, 'specificity': 0.64379436, 'f1': 0.70990527, 'auroc': 0.9084041, 'binary_precision': 0.875, 'binary_recall': 0.2892562, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.4347826}
confusion matrix:
      0   1
0  5987  10
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_14.png
new oracle model saved
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.970828652381897
after epoch: 14,now: 2024-06-06 16:29:03.604545,epoch time: 0:13:57.301853,used: 3:13:24.505914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96488225, 'precision': 0.71553427, 'recall': 0.5503584, 'specificity': 0.5503584, 'f1': 0.5766525, 'auroc': 0.9162519, 'binary_precision': 0.4622093, 'binary_recall': 0.105089225, 'binary_specificity': 0.99562764, 'binary_f1_score': 0.17124394}
confusion matrix:
       0    1
0  42126  185
1   1354  159
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7179664, 'recall': 0.57108605, 'specificity': 0.57108605, 'f1': 0.6037102, 'auroc': 0.91289866, 'binary_precision': 0.46354166, 'binary_recall': 0.14784053, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.22418137}
confusion matrix:
       0    1
0  18068  103
1    513   89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.9292472, 'recall': 0.67263657, 'specificity': 0.67263657, 'f1': 0.74229825, 'auroc': 0.91332996, 'binary_precision': 0.8842105, 'binary_recall': 0.34710744, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.49851632}
confusion matrix:
      0   1
0  5986  11
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_15.png
new oracle model saved
early stop counter: 7
val acc:0.9671869277954102, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9729123115539551
after epoch: 15,now: 2024-06-06 16:43:05.965452,epoch time: 0:14:02.360907,used: 3:27:26.866821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9648594, 'precision': 0.721269, 'recall': 0.5726523, 'specificity': 0.5726523, 'f1': 0.60562456, 'auroc': 0.9163474, 'binary_precision': 0.47216496, 'binary_recall': 0.15135492, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.22922923}
confusion matrix:
       0    1
0  42055  256
1   1284  229
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7281653, 'recall': 0.58972126, 'specificity': 0.58972126, 'f1': 0.62598467, 'auroc': 0.9171785, 'binary_precision': 0.4827586, 'binary_recall': 0.18604651, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.26858515}
confusion matrix:
       0    1
0  18051  120
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.9316699, 'recall': 0.72197324, 'specificity': 0.72197324, 'f1': 0.7905947, 'auroc': 0.9000002, 'binary_precision': 0.8852459, 'binary_recall': 0.446281, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.59340656}
confusion matrix:
      0    1
0  5983   14
1   134  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_16.png
new oracle model saved
early stop counter: 8
val acc:0.9675065279006958, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9762782454490662
after epoch: 16,now: 2024-06-06 16:57:08.565174,epoch time: 0:14:02.599722,used: 3:41:29.466543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9649735, 'precision': 0.72076315, 'recall': 0.5590093, 'specificity': 0.5590093, 'f1': 0.588584, 'auroc': 0.91675186, 'binary_precision': 0.4720812, 'binary_recall': 0.122934565, 'binary_specificity': 0.99508405, 'binary_f1_score': 0.19507079}
confusion matrix:
       0    1
0  42103  208
1   1327  186
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7261231, 'recall': 0.5752664, 'specificity': 0.5752664, 'f1': 0.60949475, 'auroc': 0.91442686, 'binary_precision': 0.47959185, 'binary_recall': 0.15614618, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.23558898}
confusion matrix:
       0    1
0  18069  102
1    508   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.9183245, 'recall': 0.65602434, 'specificity': 0.65602434, 'f1': 0.72297674, 'auroc': 0.90963304, 'binary_precision': 0.8636364, 'binary_recall': 0.3140496, 'binary_specificity': 0.997999, 'binary_f1_score': 0.46060607}
confusion matrix:
      0   1
0  5985  12
1   166  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_17.png
early stop counter: 9
val acc:0.9675065279006958, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9762782454490662
after epoch: 17,now: 2024-06-06 17:11:04.159325,epoch time: 0:13:55.594151,used: 3:55:25.060694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96495074, 'precision': 0.7241531, 'recall': 0.57779795, 'specificity': 0.57779795, 'f1': 0.61195827, 'auroc': 0.92069924, 'binary_precision': 0.47758284, 'binary_recall': 0.16192994, 'binary_specificity': 0.99366593, 'binary_f1_score': 0.24185586}
confusion matrix:
       0    1
0  42043  268
1   1268  245
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.72041136, 'recall': 0.60946727, 'specificity': 0.60946727, 'f1': 0.6444161, 'auroc': 0.9177195, 'binary_precision': 0.4659864, 'binary_recall': 0.22757475, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.30580357}
confusion matrix:
       0    1
0  18014  157
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97435486, 'precision': 0.9180695, 'recall': 0.7011453, 'specificity': 0.7011453, 'f1': 0.7686813, 'auroc': 0.9142034, 'binary_precision': 0.8596491, 'binary_recall': 0.40495867, 'binary_specificity': 0.997332, 'binary_f1_score': 0.5505618}
confusion matrix:
      0   1
0  5981  16
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_18.png
early stop counter: 10
val acc:0.9668673276901245, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9762782454490662
after epoch: 18,now: 2024-06-06 17:26:27.652341,epoch time: 0:15:23.493016,used: 4:10:48.553710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96584064, 'precision': 0.74271643, 'recall': 0.59865254, 'specificity': 0.59865254, 'f1': 0.6373483, 'auroc': 0.91966295, 'binary_precision': 0.51328903, 'binary_recall': 0.20423001, 'binary_specificity': 0.9930751, 'binary_f1_score': 0.2921986}
confusion matrix:
       0    1
0  42018  293
1   1204  309
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7374574, 'recall': 0.61082065, 'specificity': 0.61082065, 'f1': 0.6489666, 'auroc': 0.9194815, 'binary_precision': 0.5, 'binary_recall': 0.22923589, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.3143508}
confusion matrix:
       0    1
0  18033  138
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.92133844, 'recall': 0.73403645, 'specificity': 0.73403645, 'f1': 0.79878175, 'auroc': 0.8950593, 'binary_precision': 0.8636364, 'binary_recall': 0.47107437, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6096257}
confusion matrix:
      0    1
0  5979   18
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_19.png
new oracle model saved
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9765987992286682
after epoch: 19,now: 2024-06-06 17:40:29.837811,epoch time: 0:14:02.185470,used: 4:24:50.739180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9644715, 'precision': 0.7251773, 'recall': 0.6361817, 'specificity': 0.6361817, 'f1': 0.66850597, 'auroc': 0.9237014, 'binary_precision': 0.47560975, 'binary_recall': 0.28354263, 'binary_specificity': 0.98882085, 'binary_f1_score': 0.3552795}
confusion matrix:
       0    1
0  41838  473
1   1084  429
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.73875505, 'recall': 0.6694157, 'specificity': 0.6694157, 'f1': 0.69759816, 'auroc': 0.9223162, 'binary_precision': 0.49881798, 'binary_recall': 0.35049835, 'binary_specificity': 0.98833305, 'binary_f1_score': 0.4117073}
confusion matrix:
       0    1
0  17959  212
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782016, 'precision': 0.9219877, 'recall': 0.75866306, 'specificity': 0.75866306, 'f1': 0.8191178, 'auroc': 0.9023682, 'binary_precision': 0.8630137, 'binary_recall': 0.5206612, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6494846}
confusion matrix:
      0    1
0  5977   20
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_20.png
new oracle model saved
early stop counter: 12
val acc:0.9678794145584106, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9782016277313232
after epoch: 20,now: 2024-06-06 17:54:21.465494,epoch time: 0:13:51.627683,used: 4:38:42.366863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9653614, 'precision': 0.736235, 'recall': 0.6433343, 'specificity': 0.6433343, 'f1': 0.6771989, 'auroc': 0.9258895, 'binary_precision': 0.49723756, 'binary_recall': 0.29742235, 'binary_specificity': 0.9892463, 'binary_f1_score': 0.37220845}
confusion matrix:
       0    1
0  41856  455
1   1063  450
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73829246, 'recall': 0.6726004, 'specificity': 0.6726004, 'f1': 0.69965917, 'auroc': 0.92381495, 'binary_precision': 0.4976852, 'binary_recall': 0.35714287, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.41586074}
confusion matrix:
       0    1
0  17954  217
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.90025294, 'recall': 0.7437, 'specificity': 0.7437, 'f1': 0.8013319, 'auroc': 0.91300225, 'binary_precision': 0.8206897, 'binary_recall': 0.49173555, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.6149871}
confusion matrix:
      0    1
0  5971   26
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_21.png
early stop counter: 13
val acc:0.9678261280059814, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9782016277313232
after epoch: 21,now: 2024-06-06 18:08:01.543421,epoch time: 0:13:40.077927,used: 4:52:22.444790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96533865, 'precision': 0.7356324, 'recall': 0.6363121, 'specificity': 0.6363121, 'f1': 0.6713038, 'auroc': 0.9244385, 'binary_precision': 0.4965197, 'binary_recall': 0.28288168, 'binary_specificity': 0.98974264, 'binary_f1_score': 0.36042103}
confusion matrix:
       0    1
0  41877  434
1   1085  428
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73980206, 'recall': 0.66465247, 'specificity': 0.66465247, 'f1': 0.69454455, 'auroc': 0.92396164, 'binary_precision': 0.5012225, 'binary_recall': 0.34053156, 'binary_specificity': 0.98877335, 'binary_f1_score': 0.40553904}
confusion matrix:
       0    1
0  17967  204
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.91973656, 'recall': 0.75039864, 'specificity': 0.75039864, 'f1': 0.8119203, 'auroc': 0.91854, 'binary_precision': 0.85915494, 'binary_recall': 0.5041322, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6354166}
confusion matrix:
      0    1
0  5977   20
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_22.png
early stop counter: 14
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9782016277313232
after epoch: 22,now: 2024-06-06 18:21:33.507476,epoch time: 0:13:31.964055,used: 5:05:54.408845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.73874426, 'recall': 0.6533071, 'specificity': 0.6533071, 'f1': 0.6857153, 'auroc': 0.926205, 'binary_precision': 0.50156415, 'binary_recall': 0.31791145, 'binary_specificity': 0.9887027, 'binary_f1_score': 0.3891586}
confusion matrix:
       0    1
0  41833  478
1   1032  481
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.736661, 'recall': 0.6853391, 'specificity': 0.6853391, 'f1': 0.7075536, 'auroc': 0.9249587, 'binary_precision': 0.49358973, 'binary_recall': 0.38372093, 'binary_specificity': 0.98695725, 'binary_f1_score': 0.43177572}
confusion matrix:
       0    1
0  17934  237
1    371  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.8996477, 'recall': 0.7743583, 'specificity': 0.7743583, 'f1': 0.82433355, 'auroc': 0.91471493, 'binary_precision': 0.81707317, 'binary_recall': 0.553719, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.66009855}
confusion matrix:
      0    1
0  5967   30
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_23.png
early stop counter: 15
val acc:0.9676130414009094, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9782016277313232
after epoch: 23,now: 2024-06-06 18:35:09.022401,epoch time: 0:13:35.514925,used: 5:19:29.923770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7380532, 'recall': 0.648185, 'specificity': 0.648185, 'f1': 0.6815451, 'auroc': 0.9285487, 'binary_precision': 0.50053823, 'binary_recall': 0.30733642, 'binary_specificity': 0.9890336, 'binary_f1_score': 0.38083538}
confusion matrix:
       0    1
0  41847  464
1   1048  465
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.73892796, 'recall': 0.674234, 'specificity': 0.674234, 'f1': 0.70099926, 'auroc': 0.92599064, 'binary_precision': 0.49885058, 'binary_recall': 0.3604651, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.41851494}
confusion matrix:
       0    1
0  17953  218
1    385  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.90157354, 'recall': 0.75601333, 'specificity': 0.75601333, 'f1': 0.81130064, 'auroc': 0.9127015, 'binary_precision': 0.82236844, 'binary_recall': 0.5165289, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6345177}
confusion matrix:
      0    1
0  5970   27
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_24.png
early stop counter: 16
val acc:0.9678794145584106, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9782016277313232
after epoch: 24,now: 2024-06-06 18:48:53.806553,epoch time: 0:13:44.784152,used: 5:33:14.707922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9665252, 'precision': 0.7506807, 'recall': 0.65094733, 'specificity': 0.65094733, 'f1': 0.68716395, 'auroc': 0.9282136, 'binary_precision': 0.5256125, 'binary_recall': 0.311963, 'binary_specificity': 0.9899317, 'binary_f1_score': 0.39153877}
confusion matrix:
       0    1
0  41885  426
1   1041  472
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73829246, 'recall': 0.6726004, 'specificity': 0.6726004, 'f1': 0.69965917, 'auroc': 0.9275105, 'binary_precision': 0.4976852, 'binary_recall': 0.35714287, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.41586074}
confusion matrix:
       0    1
0  17954  217
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.93202585, 'recall': 0.76304543, 'specificity': 0.76304543, 'f1': 0.82533205, 'auroc': 0.905445, 'binary_precision': 0.8827586, 'binary_recall': 0.5289256, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.66149867}
confusion matrix:
      0    1
0  5980   17
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_25.png
new oracle model saved
early stop counter: 17
val acc:0.9678261280059814, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9790030717849731
after epoch: 25,now: 2024-06-06 19:02:52.753827,epoch time: 0:13:58.947274,used: 5:47:13.655196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.7380945, 'recall': 0.63068277, 'specificity': 0.63068277, 'f1': 0.6671164, 'auroc': 0.93057114, 'binary_precision': 0.501836, 'binary_recall': 0.2709848, 'binary_specificity': 0.99038076, 'binary_f1_score': 0.35193133}
confusion matrix:
       0    1
0  41904  407
1   1103  410
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.7345658, 'recall': 0.65720487, 'specificity': 0.65720487, 'f1': 0.687472, 'auroc': 0.92758894, 'binary_precision': 0.49122807, 'binary_recall': 0.3255814, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.39160842}
confusion matrix:
       0    1
0  17968  203
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785222, 'precision': 0.93318343, 'recall': 0.75486434, 'specificity': 0.75486434, 'f1': 0.8190683, 'auroc': 0.90898275, 'binary_precision': 0.8857143, 'binary_recall': 0.5123967, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6492146}
confusion matrix:
      0    1
0  5981   16
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_26.png
early stop counter: 18
val acc:0.967559814453125, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9790030717849731
after epoch: 26,now: 2024-06-06 19:16:50.036554,epoch time: 0:13:57.282727,used: 6:01:10.937923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96622854, 'precision': 0.7464429, 'recall': 0.67851645, 'specificity': 0.67851645, 'f1': 0.70646477, 'auroc': 0.9325099, 'binary_precision': 0.51520735, 'binary_recall': 0.36946464, 'binary_specificity': 0.98756826, 'binary_f1_score': 0.430331}
confusion matrix:
       0    1
0  41785  526
1    954  559
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7406317, 'recall': 0.70879257, 'specificity': 0.70879257, 'f1': 0.72346526, 'auroc': 0.9286474, 'binary_precision': 0.5, 'binary_recall': 0.43189368, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.4634581}
confusion matrix:
       0    1
0  17911  260
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.8936354, 'recall': 0.7782403, 'specificity': 0.7782403, 'f1': 0.8251407, 'auroc': 0.9193371, 'binary_precision': 0.80473375, 'binary_recall': 0.56198347, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6618005}
confusion matrix:
      0    1
0  5964   33
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_27.png
early stop counter: 19
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9790030717849731
after epoch: 27,now: 2024-06-06 19:30:41.786024,epoch time: 0:13:51.749470,used: 6:15:02.687393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96622854, 'precision': 0.74620295, 'recall': 0.7121084, 'specificity': 0.7121084, 'f1': 0.72774494, 'auroc': 0.9368447, 'binary_precision': 0.5123457, 'binary_recall': 0.43915343, 'binary_specificity': 0.9850633, 'binary_f1_score': 0.47293445}
confusion matrix:
       0    1
0  41680  632
1    848  664
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.73706067, 'recall': 0.7382027, 'specificity': 0.7382027, 'f1': 0.7376302, 'auroc': 0.9300901, 'binary_precision': 0.4909091, 'binary_recall': 0.49335548, 'binary_specificity': 0.9830499, 'binary_f1_score': 0.49212924}
confusion matrix:
       0    1
0  17863  308
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.8893156, 'recall': 0.78625464, 'specificity': 0.78625464, 'f1': 0.8292068, 'auroc': 0.91872656, 'binary_precision': 0.79545456, 'binary_recall': 0.5785124, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6698565}
confusion matrix:
      0    1
0  5961   36
1   102  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_28.png
early stop counter: 20
val acc:0.967346727848053, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9790030717849731
after epoch: 28,now: 2024-06-06 19:44:23.499148,epoch time: 0:13:41.713124,used: 6:28:44.400517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9662742, 'precision': 0.746891, 'recall': 0.6810893, 'specificity': 0.6810893, 'f1': 0.70838463, 'auroc': 0.9341145, 'binary_precision': 0.51592356, 'binary_recall': 0.37475213, 'binary_specificity': 0.98742646, 'binary_f1_score': 0.4341501}
confusion matrix:
       0    1
0  41779  532
1    946  567
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7365105, 'recall': 0.7021481, 'specificity': 0.7021481, 'f1': 0.7178401, 'auroc': 0.9260921, 'binary_precision': 0.4921875, 'binary_recall': 0.41860464, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.45242372}
confusion matrix:
       0    1
0  17911  260
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9802853, 'precision': 0.91598386, 'recall': 0.797419, 'specificity': 0.797419, 'f1': 0.8459922, 'auroc': 0.9186816, 'binary_precision': 0.8479532, 'binary_recall': 0.59917355, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.7021792}
confusion matrix:
      0    1
0  5971   26
1    97  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_29.png
new oracle model saved
early stop counter: 21
val acc:0.9675065279006958, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9802852869033813
after epoch: 29,now: 2024-06-06 19:58:08.824349,epoch time: 0:13:45.325201,used: 6:42:29.725718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96590906, 'precision': 0.74395174, 'recall': 0.7355394, 'specificity': 0.7355394, 'f1': 0.7396632, 'auroc': 0.9377755, 'binary_precision': 0.50617284, 'binary_recall': 0.48809522, 'binary_specificity': 0.9829835, 'binary_f1_score': 0.49696967}
confusion matrix:
       0    1
0  41592  720
1    774  738
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7409839, 'recall': 0.7648959, 'specificity': 0.7648959, 'f1': 0.75231177, 'auroc': 0.9316693, 'binary_precision': 0.49698794, 'binary_recall': 0.5481728, 'binary_specificity': 0.98161906, 'binary_f1_score': 0.52132696}
confusion matrix:
       0    1
0  17837  334
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.88041186, 'recall': 0.7920362, 'specificity': 0.7920362, 'f1': 0.8298726, 'auroc': 0.9231813, 'binary_precision': 0.77717394, 'binary_recall': 0.59090906, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.6713615}
confusion matrix:
      0    1
0  5956   41
1    99  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127985_30.png
early stop counter: 22
val acc:0.9677196145057678, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9629748463630676 / 0.9802852869033813
after epoch: 30,now: 2024-06-06 20:12:03.414620,epoch time: 0:13:54.590271,used: 6:56:24.315989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_13_15_39_seed_2_21127985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:56:24.315989 at 2024-06-06 20:12:03.414620
persisted model performance metric: 

scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.8698399, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
oracle model performance metric: 

scalar performance:
{'acc': 0.97884274, 'precision': 0.89980197, 'recall': 0.79072046, 'specificity': 0.79072046, 'f1': 0.83587444, 'auroc': 0.9237002, 'binary_precision': 0.81609195, 'binary_recall': 0.58677685, 'binary_specificity': 0.994664, 'binary_f1_score': 0.68269235}
confusion matrix:
      0    1
0  5965   32
1   100  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 544085 KiB |  11098 MiB |   4098 TiB |   4098 TiB |
|       from large pool | 454272 KiB |  11024 MiB |   4091 TiB |   4091 TiB |
|       from small pool |  89813 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 544085 KiB |  11098 MiB |   4098 TiB |   4098 TiB |
|       from large pool | 454272 KiB |  11024 MiB |   4091 TiB |   4091 TiB |
|       from small pool |  89813 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525468 KiB |  10983 MiB |   4073 TiB |   4073 TiB |
|       from large pool | 436736 KiB |  10910 MiB |   4066 TiB |   4066 TiB |
|       from small pool |  88732 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11286 MiB |  11286 MiB |  29866 MiB |  18580 MiB |
|       from large pool |  11162 MiB |  11162 MiB |  29688 MiB |  18526 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1346 MiB |   2656 MiB |   1716 TiB |   1716 TiB |
|       from large pool |   1336 MiB |   2653 MiB |   1709 TiB |   1709 TiB |
|       from small pool |     10 MiB |     24 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  410421 K  |  410417 K  |
|       from large pool |      87    |     909    |  193585 K  |  193585 K  |
|       from small pool |    3630    |    6639    |  216835 K  |  216832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  410421 K  |  410417 K  |
|       from large pool |      87    |     909    |  193585 K  |  193585 K  |
|       from small pool |    3630    |    6639    |  216835 K  |  216832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     229    |     231    |     523    |     294    |
|       from large pool |     167    |     168    |     434    |     267    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2776    |  222202 K  |  222202 K  |
|       from large pool |      24    |      60    |  107803 K  |  107803 K  |
|       from small pool |      56    |    2751    |  114398 K  |  114398 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  11098 MiB |   4098 TiB |   4098 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   4091 TiB |   4091 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  11098 MiB |   4098 TiB |   4098 TiB |
|       from large pool |  65536 KiB |  11024 MiB |   4091 TiB |   4091 TiB |
|       from small pool |      0 KiB |    125 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  10983 MiB |   4073 TiB |   4073 TiB |
|       from large pool |  65536 KiB |  10910 MiB |   4066 TiB |   4066 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  11286 MiB |  29866 MiB |  27988 MiB |
|       from large pool |   1780 MiB |  11162 MiB |  29688 MiB |  27908 MiB |
|       from small pool |     98 MiB |    126 MiB |    178 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |   2656 MiB |   1716 TiB |   1716 TiB |
|       from large pool | 116736 KiB |   2653 MiB |   1709 TiB |   1709 TiB |
|       from small pool |      0 KiB |     24 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  410421 K  |  410421 K  |
|       from large pool |       2    |     909    |  193585 K  |  193585 K  |
|       from small pool |       0    |    6639    |  216835 K  |  216835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  410421 K  |  410421 K  |
|       from large pool |       2    |     909    |  193585 K  |  193585 K  |
|       from small pool |       0    |    6639    |  216835 K  |  216835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     231    |     523    |     439    |
|       from large pool |      35    |     168    |     434    |     399    |
|       from small pool |      49    |      63    |      89    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2776    |  222204 K  |  222204 K  |
|       from large pool |       3    |      60    |  107803 K  |  107803 K  |
|       from small pool |       0    |    2751    |  114400 K  |  114400 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jun  6 20:13:35 2024]
Finished job 0.
1 of 1 steps (100%) done
