Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:11:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956

 Experiment start at: 2024-05-25 10:21:22.972224
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.81154597, 'recall': 0.5070032, 'specificity': 0.5070032, 'f1': 0.5054707, 'auroc': 0.88924456, 'binary_precision': 0.65625, 'binary_recall': 0.014266305, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.027925532}
confusion matrix:
       0   1
0  42309  11
1   1451  21
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7139569, 'recall': 0.5089456, 'specificity': 0.5089456, 'f1': 0.50920093, 'auroc': 0.8811834, 'binary_precision': 0.46153846, 'binary_recall': 0.01866252, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.03587444}
confusion matrix:
       0   1
0  18135  14
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.88011825, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:44:03.822739,epoch time: 0:22:40.850515,used: 0:22:40.850515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.7357192, 'recall': 0.6547405, 'specificity': 0.6547405, 'f1': 0.68594366, 'auroc': 0.91591704, 'binary_precision': 0.4947589, 'binary_recall': 0.32087016, 'binary_specificity': 0.98861086, 'binary_f1_score': 0.38927835}
confusion matrix:
       0    1
0  41839  482
1    999  472
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73782206, 'recall': 0.6627344, 'specificity': 0.6627344, 'f1': 0.69247824, 'auroc': 0.91351795, 'binary_precision': 0.49885058, 'binary_recall': 0.33748055, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.4025974}
confusion matrix:
       0    1
0  17931  218
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.90967023, 'recall': 0.7925179, 'specificity': 0.7925179, 'f1': 0.84039265, 'auroc': 0.9024276, 'binary_precision': 0.8369565, 'binary_recall': 0.5900383, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.69213486}
confusion matrix:
      0    1
0  5967   30
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-25 11:04:16.632491,epoch time: 0:20:12.809752,used: 0:42:53.660267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7420958, 'recall': 0.6745747, 'specificity': 0.6745747, 'f1': 0.7022839, 'auroc': 0.9280038, 'binary_precision': 0.5061846, 'binary_recall': 0.36141303, 'binary_specificity': 0.9877363, 'binary_f1_score': 0.42172018}
confusion matrix:
       0    1
0  41801  519
1    940  532
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7423825, 'recall': 0.69217944, 'specificity': 0.69217944, 'f1': 0.7140608, 'auroc': 0.9169879, 'binary_precision': 0.5059289, 'binary_recall': 0.39813375, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.44560486}
confusion matrix:
       0    1
0  17899  250
1    387  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.90458834, 'recall': 0.7980149, 'specificity': 0.7980149, 'f1': 0.84243774, 'auroc': 0.91171205, 'binary_precision': 0.82631576, 'binary_recall': 0.6015326, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6962306}
confusion matrix:
      0    1
0  5964   33
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
better model found
persisted
after epoch: 3,now: 2024-05-25 11:24:22.739808,epoch time: 0:20:06.107317,used: 1:02:59.767584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7442341, 'recall': 0.77311295, 'specificity': 0.77311295, 'f1': 0.7577734, 'auroc': 0.9338377, 'binary_precision': 0.50363195, 'binary_recall': 0.56560165, 'binary_specificity': 0.98062426, 'binary_f1_score': 0.532821}
confusion matrix:
       0    1
0  41501  820
1    639  832
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7398972, 'recall': 0.78030026, 'specificity': 0.78030026, 'f1': 0.75833833, 'auroc': 0.93114144, 'binary_precision': 0.49470899, 'binary_recall': 0.5816485, 'binary_specificity': 0.978952, 'binary_f1_score': 0.5346676}
confusion matrix:
       0    1
0  17767  382
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.8686349, 'recall': 0.8360771, 'specificity': 0.8360771, 'f1': 0.8515219, 'auroc': 0.9211074, 'binary_precision': 0.7510548, 'binary_recall': 0.68199235, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.7148594}
confusion matrix:
      0    1
0  5938   59
1    83  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 1
val acc:0.9653576016426086, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9781080484390259 / 0.9781080484390259
after epoch: 4,now: 2024-05-25 11:44:07.639482,epoch time: 0:19:44.899674,used: 1:22:44.667258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9680307, 'precision': 0.7554934, 'recall': 0.7024841, 'specificity': 0.7024841, 'f1': 0.7256005, 'auroc': 0.937317, 'binary_precision': 0.53108805, 'binary_recall': 0.4177989, 'binary_specificity': 0.9871692, 'binary_f1_score': 0.46768057}
confusion matrix:
       0    1
0  41777  543
1    857  615
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7492424, 'recall': 0.71881706, 'specificity': 0.71881706, 'f1': 0.73293114, 'auroc': 0.92844796, 'binary_precision': 0.5177936, 'binary_recall': 0.4525661, 'binary_specificity': 0.985068, 'binary_f1_score': 0.48298755}
confusion matrix:
       0    1
0  17878  271
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.92041624, 'recall': 0.7891034, 'specificity': 0.7891034, 'f1': 0.84148467, 'auroc': 0.9344665, 'binary_precision': 0.8587571, 'binary_recall': 0.58237547, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6940639}
confusion matrix:
      0    1
0  5972   25
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-25 12:06:44.859433,epoch time: 0:22:37.219951,used: 1:45:21.887209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.7496811, 'recall': 0.77221406, 'specificity': 0.77221406, 'f1': 0.76040554, 'auroc': 0.9455669, 'binary_precision': 0.51460534, 'binary_recall': 0.56288236, 'binary_specificity': 0.9815458, 'binary_f1_score': 0.5376623}
confusion matrix:
       0    1
0  41540  781
1    643  828
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.73763776, 'recall': 0.7920532, 'specificity': 0.7920532, 'f1': 0.76170313, 'auroc': 0.9394665, 'binary_precision': 0.489335, 'binary_recall': 0.60653186, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.5416666}
confusion matrix:
       0    1
0  17742  407
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.8740001, 'recall': 0.8118398, 'specificity': 0.8118398, 'f1': 0.8398068, 'auroc': 0.9330839, 'binary_precision': 0.7638889, 'binary_recall': 0.6321839, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.69182384}
confusion matrix:
      0    1
0  5946   51
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 1
val acc:0.9648786783218384, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 6,now: 2024-05-25 12:26:57.084497,epoch time: 0:20:12.225064,used: 2:05:34.112273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9684189, 'precision': 0.756621, 'recall': 0.77022386, 'specificity': 0.77022386, 'f1': 0.7632272, 'auroc': 0.94819355, 'binary_precision': 0.5286542, 'binary_recall': 0.55774456, 'binary_specificity': 0.9827032, 'binary_f1_score': 0.5428099}
confusion matrix:
       0    1
0  41588  732
1    651  821
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.74196446, 'recall': 0.78271574, 'specificity': 0.78271574, 'f1': 0.76056564, 'auroc': 0.9397886, 'binary_precision': 0.49867725, 'binary_recall': 0.58631414, 'binary_specificity': 0.97911733, 'binary_f1_score': 0.53895634}
confusion matrix:
       0    1
0  17770  379
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.88295937, 'recall': 0.8235842, 'specificity': 0.8235842, 'f1': 0.85051715, 'auroc': 0.93926775, 'binary_precision': 0.7808219, 'binary_recall': 0.6551724, 'binary_specificity': 0.991996, 'binary_f1_score': 0.7124999}
confusion matrix:
      0    1
0  5949   48
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 7,now: 2024-05-25 12:46:59.469272,epoch time: 0:20:02.384775,used: 2:25:36.497048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7474326, 'recall': 0.7882266, 'specificity': 0.7882266, 'f1': 0.7660944, 'auroc': 0.9490255, 'binary_precision': 0.5089855, 'binary_recall': 0.5964674, 'binary_specificity': 0.97998583, 'binary_f1_score': 0.5492649}
confusion matrix:
       0    1
0  41473  847
1    594  878
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7418485, 'recall': 0.81783056, 'specificity': 0.81783056, 'f1': 0.77403784, 'auroc': 0.9376006, 'binary_precision': 0.49590644, 'binary_recall': 0.65940905, 'binary_specificity': 0.97625214, 'binary_f1_score': 0.56608814}
confusion matrix:
       0    1
0  17718  431
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.861771, 'recall': 0.83382785, 'specificity': 0.83382785, 'f1': 0.8471761, 'auroc': 0.9296054, 'binary_precision': 0.7375, 'binary_recall': 0.6781609, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.70658684}
confusion matrix:
      0    1
0  5934   63
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 3
val acc:0.9654108285903931, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 8,now: 2024-05-25 13:07:01.445160,epoch time: 0:20:01.975888,used: 2:45:38.472936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.74743646, 'recall': 0.79530764, 'specificity': 0.79530764, 'f1': 0.7690126, 'auroc': 0.95166504, 'binary_precision': 0.5084842, 'binary_recall': 0.6111489, 'binary_specificity': 0.97946644, 'binary_f1_score': 0.5551096}
confusion matrix:
       0    1
0  41452  869
1    572  899
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7472834, 'recall': 0.79587996, 'specificity': 0.79587996, 'f1': 0.7691463, 'auroc': 0.9453232, 'binary_precision': 0.5083871, 'binary_recall': 0.61275274, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.5557123}
confusion matrix:
       0    1
0  17768  381
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.85079277, 'recall': 0.82758045, 'specificity': 0.82758045, 'f1': 0.8387446, 'auroc': 0.9414133, 'binary_precision': 0.7160494, 'binary_recall': 0.6666667, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.6904762}
confusion matrix:
      0    1
0  5928   69
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 4
val acc:0.9664750695228577, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 9,now: 2024-05-25 13:26:36.629959,epoch time: 0:19:35.184799,used: 3:05:13.657735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9691725, 'precision': 0.76230645, 'recall': 0.7719252, 'specificity': 0.7719252, 'f1': 0.76701975, 'auroc': 0.9558445, 'binary_precision': 0.53992146, 'binary_recall': 0.56046194, 'binary_specificity': 0.9833885, 'binary_f1_score': 0.54999995}
confusion matrix:
       0    1
0  41617  703
1    647  825
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.75014937, 'recall': 0.78337693, 'specificity': 0.78337693, 'f1': 0.76560664, 'auroc': 0.94803077, 'binary_precision': 0.51502734, 'binary_recall': 0.58631414, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.5483637}
confusion matrix:
       0    1
0  17794  355
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.89162296, 'recall': 0.78993523, 'specificity': 0.78993523, 'f1': 0.83244455, 'auroc': 0.93677616, 'binary_precision': 0.80104715, 'binary_recall': 0.5862069, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.67699116}
confusion matrix:
      0    1
0  5959   38
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
better model found
persisted
after epoch: 10,now: 2024-05-25 13:46:44.145249,epoch time: 0:20:07.515290,used: 3:25:21.173025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9688756, 'precision': 0.7590116, 'recall': 0.81209826, 'specificity': 0.81209826, 'f1': 0.78280497, 'auroc': 0.9574512, 'binary_precision': 0.530498, 'binary_recall': 0.64402175, 'binary_specificity': 0.98017484, 'binary_f1_score': 0.5817736}
confusion matrix:
       0    1
0  41481  839
1    524  948
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7471677, 'recall': 0.8175764, 'specificity': 0.8175764, 'f1': 0.77744555, 'auroc': 0.95046663, 'binary_precision': 0.50658685, 'binary_recall': 0.6578538, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.57239515}
confusion matrix:
       0    1
0  17737  412
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.8781048, 'recall': 0.7912673, 'specificity': 0.7912673, 'f1': 0.8284787, 'auroc': 0.94569063, 'binary_precision': 0.77386934, 'binary_recall': 0.5900383, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.66956526}
confusion matrix:
      0    1
0  5952   45
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9766698479652405 / 0.9785873889923096
after epoch: 11,now: 2024-05-25 14:07:16.124999,epoch time: 0:20:31.979750,used: 3:45:53.152775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9667976, 'precision': 0.7465322, 'recall': 0.8247932, 'specificity': 0.8247932, 'f1': 0.77965426, 'auroc': 0.95579064, 'binary_precision': 0.5045872, 'binary_recall': 0.6725544, 'binary_specificity': 0.9770321, 'binary_f1_score': 0.57658714}
confusion matrix:
       0    1
0  41348  972
1    482  990
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7515919, 'recall': 0.8262127, 'specificity': 0.8262127, 'f1': 0.7834991, 'auroc': 0.95383763, 'binary_precision': 0.51482797, 'binary_recall': 0.6749611, 'binary_specificity': 0.9774643, 'binary_f1_score': 0.5841184}
confusion matrix:
       0    1
0  17740  409
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8402696, 'recall': 0.79509676, 'specificity': 0.79509676, 'f1': 0.8158965, 'auroc': 0.9284636, 'binary_precision': 0.69777775, 'binary_recall': 0.6015326, 'binary_specificity': 0.988661, 'binary_f1_score': 0.64609057}
confusion matrix:
      0    1
0  5929   68
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
better model found
persisted
after epoch: 12,now: 2024-05-25 14:27:14.227832,epoch time: 0:19:58.102833,used: 4:05:51.255608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9688984, 'precision': 0.7600101, 'recall': 0.77735704, 'specificity': 0.77735704, 'f1': 0.7683726, 'auroc': 0.955475, 'binary_precision': 0.5349428, 'binary_recall': 0.5720109, 'binary_specificity': 0.9827032, 'binary_f1_score': 0.55285627}
confusion matrix:
       0    1
0  41588  732
1    630  842
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7612189, 'recall': 0.7827033, 'specificity': 0.7827033, 'f1': 0.7714888, 'auroc': 0.9537488, 'binary_precision': 0.53724927, 'binary_recall': 0.58320373, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.55928415}
confusion matrix:
       0    1
0  17826  323
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.808635, 'recall': 0.6570843, 'specificity': 0.6570843, 'f1': 0.7056379, 'auroc': 0.92843544, 'binary_precision': 0.64615387, 'binary_recall': 0.3218391, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.42966753}
confusion matrix:
      0   1
0  5951  46
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
better model found
persisted
after epoch: 13,now: 2024-05-25 14:46:41.320768,epoch time: 0:19:27.092936,used: 4:25:18.348544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.7444782, 'recall': 0.8241769, 'specificity': 0.8241769, 'f1': 0.7780629, 'auroc': 0.9585576, 'binary_precision': 0.5005066, 'binary_recall': 0.67165196, 'binary_specificity': 0.97670186, 'binary_f1_score': 0.573585}
confusion matrix:
       0    1
0  41335  986
1    483  988
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7471779, 'recall': 0.8392729, 'specificity': 0.8392729, 'f1': 0.7850939, 'auroc': 0.9535576, 'binary_precision': 0.50502795, 'binary_recall': 0.7029549, 'binary_specificity': 0.97559094, 'binary_f1_score': 0.5877764}
confusion matrix:
       0    1
0  17706  443
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.87539077, 'recall': 0.77227694, 'specificity': 0.77227694, 'f1': 0.8147994, 'auroc': 0.9350844, 'binary_precision': 0.77005345, 'binary_recall': 0.55172414, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.64285713}
confusion matrix:
      0    1
0  5954   43
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 1
val acc:0.9662622213363647, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 14,now: 2024-05-25 15:06:42.069535,epoch time: 0:20:00.748767,used: 4:45:19.097311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96825904, 'precision': 0.7550475, 'recall': 0.82456577, 'specificity': 0.82456577, 'f1': 0.7851485, 'auroc': 0.96036434, 'binary_precision': 0.52167016, 'binary_recall': 0.6705163, 'binary_specificity': 0.9786153, 'binary_f1_score': 0.5868014}
confusion matrix:
       0    1
0  41415  905
1    485  987
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75153446, 'recall': 0.8426864, 'specificity': 0.8426864, 'f1': 0.7892599, 'auroc': 0.9581188, 'binary_precision': 0.5135135, 'binary_recall': 0.70917577, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.59568906}
confusion matrix:
       0    1
0  17717  432
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.85131955, 'recall': 0.7336293, 'specificity': 0.7336293, 'f1': 0.77942365, 'auroc': 0.94077307, 'binary_precision': 0.7251462, 'binary_recall': 0.47509578, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.5740741}
confusion matrix:
      0    1
0  5950   47
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 2
val acc:0.9670604467391968, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 15,now: 2024-05-25 15:26:43.167902,epoch time: 0:20:01.098367,used: 5:05:20.195678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96437705, 'precision': 0.7350407, 'recall': 0.8458353, 'specificity': 0.8458353, 'f1': 0.77851695, 'auroc': 0.96468663, 'binary_precision': 0.4800363, 'binary_recall': 0.71875, 'binary_specificity': 0.9729206, 'binary_f1_score': 0.57562566}
confusion matrix:
       0     1
0  41174  1146
1    414  1058
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7414116, 'recall': 0.8506402, 'specificity': 0.8506402, 'f1': 0.7846581, 'auroc': 0.9534834, 'binary_precision': 0.49263158, 'binary_recall': 0.7278383, 'binary_specificity': 0.9734421, 'binary_f1_score': 0.58757067}
confusion matrix:
       0    1
0  17667  482
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.80940115, 'recall': 0.80259097, 'specificity': 0.80259097, 'f1': 0.8059535, 'auroc': 0.9469174, 'binary_precision': 0.63529414, 'binary_recall': 0.62068963, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.627907}
confusion matrix:
      0    1
0  5904   93
1    99  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 16,now: 2024-05-25 15:46:43.164717,epoch time: 0:19:59.996815,used: 5:25:20.192493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9679394, 'precision': 0.75305635, 'recall': 0.8116139, 'specificity': 0.8116139, 'f1': 0.7789438, 'auroc': 0.9642956, 'binary_precision': 0.51859957, 'binary_recall': 0.64402175, 'binary_specificity': 0.979206, 'binary_f1_score': 0.5745455}
confusion matrix:
       0    1
0  41440  880
1    524  948
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.75663674, 'recall': 0.8154027, 'specificity': 0.8154027, 'f1': 0.78264445, 'auroc': 0.95729136, 'binary_precision': 0.52572143, 'binary_recall': 0.65163296, 'binary_specificity': 0.9791724, 'binary_f1_score': 0.58194447}
confusion matrix:
       0    1
0  17771  378
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8507173, 'recall': 0.6771585, 'specificity': 0.6771585, 'f1': 0.7326964, 'auroc': 0.93375933, 'binary_precision': 0.72868216, 'binary_recall': 0.36015326, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.48205125}
confusion matrix:
      0   1
0  5962  35
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 4
val acc:0.9679650664329529, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 17,now: 2024-05-25 16:06:19.048936,epoch time: 0:19:35.884219,used: 5:44:56.076712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96819055, 'precision': 0.75462705, 'recall': 0.8196125, 'specificity': 0.8196125, 'f1': 0.7830123, 'auroc': 0.9655132, 'binary_precision': 0.5211796, 'binary_recall': 0.66032606, 'binary_specificity': 0.9788989, 'binary_f1_score': 0.58255917}
confusion matrix:
       0    1
0  41427  893
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.74972904, 'recall': 0.8237972, 'specificity': 0.8237972, 'f1': 0.7813972, 'auroc': 0.95689726, 'binary_precision': 0.5112693, 'binary_recall': 0.6702955, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.58008075}
confusion matrix:
       0    1
0  17737  412
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7989771, 'recall': 0.641842, 'specificity': 0.641842, 'f1': 0.68947536, 'auroc': 0.9416712, 'binary_precision': 0.6280992, 'binary_recall': 0.29118773, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.39790574}
confusion matrix:
      0   1
0  5952  45
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 5
val acc:0.9667943716049194, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 18,now: 2024-05-25 16:26:12.557274,epoch time: 0:19:53.508338,used: 6:04:49.585050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.74930817, 'recall': 0.84982973, 'specificity': 0.84982973, 'f1': 0.7901082, 'auroc': 0.96484905, 'binary_precision': 0.50835323, 'binary_recall': 0.7239973, 'binary_specificity': 0.9756622, 'binary_f1_score': 0.5973079}
confusion matrix:
       0     1
0  41291  1030
1    406  1065
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7446065, 'recall': 0.8375249, 'specificity': 0.8375249, 'f1': 0.78271925, 'auroc': 0.9568701, 'binary_precision': 0.5, 'binary_recall': 0.6998445, 'binary_specificity': 0.97520524, 'binary_f1_score': 0.5832793}
confusion matrix:
       0    1
0  17699  450
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.78392327, 'recall': 0.72296494, 'specificity': 0.72296494, 'f1': 0.74932766, 'auroc': 0.9347043, 'binary_precision': 0.591133, 'binary_recall': 0.4597701, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.5172414}
confusion matrix:
      0    1
0  5914   83
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 19,now: 2024-05-25 16:46:18.240751,epoch time: 0:20:05.683477,used: 6:24:55.268527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9686929, 'precision': 0.75758, 'recall': 0.846429, 'specificity': 0.846429, 'f1': 0.7946969, 'auroc': 0.96555376, 'binary_precision': 0.525187, 'binary_recall': 0.71535325, 'binary_specificity': 0.97750473, 'binary_f1_score': 0.60569453}
confusion matrix:
       0     1
0  41368   952
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74915266, 'recall': 0.8611623, 'specificity': 0.8611623, 'f1': 0.7935877, 'auroc': 0.95926833, 'binary_precision': 0.50738394, 'binary_recall': 0.748056, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.6046511}
confusion matrix:
       0    1
0  17682  467
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.81657076, 'recall': 0.715304, 'specificity': 0.715304, 'f1': 0.75523496, 'auroc': 0.9464854, 'binary_precision': 0.6571429, 'binary_recall': 0.44061303, 'binary_specificity': 0.989995, 'binary_f1_score': 0.5275229}
confusion matrix:
      0    1
0  5937   60
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 7
val acc:0.9665282964706421, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 20,now: 2024-05-25 17:06:23.310274,epoch time: 0:20:05.069523,used: 6:45:00.338050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.75811267, 'recall': 0.84483695, 'specificity': 0.84483695, 'f1': 0.7945026, 'auroc': 0.96822727, 'binary_precision': 0.5263687, 'binary_recall': 0.7119565, 'binary_specificity': 0.9777174, 'binary_f1_score': 0.6052556}
confusion matrix:
       0     1
0  41377   943
1    424  1048
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7541907, 'recall': 0.84593457, 'specificity': 0.84593457, 'f1': 0.79219407, 'auroc': 0.9561223, 'binary_precision': 0.518602, 'binary_recall': 0.7153966, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.6013072}
confusion matrix:
       0    1
0  17722  427
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.84904885, 'recall': 0.67899084, 'specificity': 0.67899084, 'f1': 0.73401636, 'auroc': 0.9430036, 'binary_precision': 0.7251908, 'binary_recall': 0.36398467, 'binary_specificity': 0.993997, 'binary_f1_score': 0.48469386}
confusion matrix:
      0   1
0  5961  36
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 8
val acc:0.967539370059967, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 21,now: 2024-05-25 17:26:23.035163,epoch time: 0:19:59.724889,used: 7:05:00.062939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96885276, 'precision': 0.75847155, 'recall': 0.852741, 'specificity': 0.852741, 'f1': 0.7974755, 'auroc': 0.9678085, 'binary_precision': 0.5265226, 'binary_recall': 0.7282609, 'binary_specificity': 0.9772212, 'binary_f1_score': 0.61117446}
confusion matrix:
       0     1
0  41356   964
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7477881, 'recall': 0.8684975, 'specificity': 0.8684975, 'f1': 0.79482114, 'auroc': 0.9580265, 'binary_precision': 0.50410676, 'binary_recall': 0.7636081, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.6072974}
confusion matrix:
       0    1
0  17666  483
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.8730699, 'recall': 0.73821104, 'specificity': 0.73821104, 'f1': 0.7893165, 'auroc': 0.94048125, 'binary_precision': 0.76829267, 'binary_recall': 0.4827586, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.5929411}
confusion matrix:
      0    1
0  5959   38
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 9
val acc:0.9662090539932251, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 22,now: 2024-05-25 17:46:01.662109,epoch time: 0:19:38.626946,used: 7:24:38.689885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96839607, 'precision': 0.7558729, 'recall': 0.8397182, 'specificity': 0.8397182, 'f1': 0.79119533, 'auroc': 0.9664405, 'binary_precision': 0.5222447, 'binary_recall': 0.7017663, 'binary_specificity': 0.97767013, 'binary_f1_score': 0.5988406}
confusion matrix:
       0     1
0  41375   945
1    439  1033
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7501576, 'recall': 0.84554887, 'specificity': 0.84554887, 'f1': 0.7892704, 'auroc': 0.9578463, 'binary_precision': 0.5105438, 'binary_recall': 0.7153966, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.5958549}
confusion matrix:
       0    1
0  17708  441
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.80736166, 'recall': 0.67757344, 'specificity': 0.67757344, 'f1': 0.72322947, 'auroc': 0.9415263, 'binary_precision': 0.6418919, 'binary_recall': 0.36398467, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.4645477}
confusion matrix:
      0   1
0  5944  53
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 10
val acc:0.9667943716049194, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 23,now: 2024-05-25 18:06:00.676257,epoch time: 0:19:59.014148,used: 7:44:37.704033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.75826395, 'recall': 0.8245097, 'specificity': 0.8245097, 'f1': 0.7871847, 'auroc': 0.9639262, 'binary_precision': 0.52812, 'binary_recall': 0.66983694, 'binary_specificity': 0.9791824, 'binary_f1_score': 0.590596}
confusion matrix:
       0    1
0  41439  881
1    486  986
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7516717, 'recall': 0.83221316, 'specificity': 0.83221316, 'f1': 0.78571045, 'auroc': 0.95484215, 'binary_precision': 0.5145518, 'binary_recall': 0.6874028, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.5885486}
confusion matrix:
       0    1
0  17732  417
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.77360433, 'recall': 0.5927839, 'specificity': 0.5927839, 'f1': 0.6339435, 'auroc': 0.913159, 'binary_precision': 0.5813953, 'binary_recall': 0.19157088, 'binary_specificity': 0.993997, 'binary_f1_score': 0.28818443}
confusion matrix:
      0   1
0  5961  36
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 11
val acc:0.9671136736869812, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 24,now: 2024-05-25 18:26:00.982059,epoch time: 0:20:00.305802,used: 8:04:38.009835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.74574745, 'recall': 0.86353594, 'specificity': 0.86353594, 'f1': 0.7918362, 'auroc': 0.967903, 'binary_precision': 0.5002257, 'binary_recall': 0.7532291, 'binary_specificity': 0.9738428, 'binary_f1_score': 0.60119367}
confusion matrix:
       0     1
0  41214  1107
1    363  1108
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7449665, 'recall': 0.86147153, 'specificity': 0.86147153, 'f1': 0.79060036, 'auroc': 0.96080995, 'binary_precision': 0.49896482, 'binary_recall': 0.7496112, 'binary_specificity': 0.97333187, 'binary_f1_score': 0.59912986}
confusion matrix:
       0    1
0  17665  484
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7777933, 'recall': 0.6763228, 'specificity': 0.6763228, 'f1': 0.71438074, 'auroc': 0.9324584, 'binary_precision': 0.5828221, 'binary_recall': 0.36398467, 'binary_specificity': 0.988661, 'binary_f1_score': 0.4481132}
confusion matrix:
      0   1
0  5929  68
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 12
val acc:0.9656769037246704, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 25,now: 2024-05-25 18:45:58.507048,epoch time: 0:19:57.524989,used: 8:24:35.534824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9660212, 'precision': 0.7452435, 'recall': 0.897832, 'specificity': 0.897832, 'f1': 0.8011179, 'auroc': 0.9709336, 'binary_precision': 0.4967267, 'binary_recall': 0.82472825, 'binary_specificity': 0.9709357, 'binary_f1_score': 0.6200204}
confusion matrix:
       0     1
0  41090  1230
1    258  1214
---- Validation: 
scalar performance:
{'acc': 0.96317583, 'precision': 0.7359497, 'recall': 0.8991796, 'specificity': 0.8991796, 'f1': 0.79375076, 'auroc': 0.96432316, 'binary_precision': 0.47806624, 'binary_recall': 0.8304821, 'binary_specificity': 0.96787703, 'binary_f1_score': 0.6068182}
confusion matrix:
       0    1
0  17566  583
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.770724, 'recall': 0.762776, 'specificity': 0.762776, 'f1': 0.76668286, 'auroc': 0.9384271, 'binary_precision': 0.5612648, 'binary_recall': 0.5440613, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.55252916}
confusion matrix:
      0    1
0  5886  111
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 13
val acc:0.9631758332252502, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 26,now: 2024-05-25 19:05:22.795616,epoch time: 0:19:24.288568,used: 8:43:59.823392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9649023, 'precision': 0.7372942, 'recall': 0.84118915, 'specificity': 0.84118915, 'f1': 0.7787299, 'auroc': 0.9673889, 'binary_precision': 0.48489076, 'binary_recall': 0.7085598, 'binary_specificity': 0.97381854, 'binary_f1_score': 0.57576597}
confusion matrix:
       0     1
0  41212  1108
1    429  1043
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.74397933, 'recall': 0.8426926, 'specificity': 0.8426926, 'f1': 0.7839825, 'auroc': 0.9610256, 'binary_precision': 0.49836424, 'binary_recall': 0.71073097, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.58589745}
confusion matrix:
       0    1
0  17689  460
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7189167, 'recall': 0.6038594, 'specificity': 0.6038594, 'f1': 0.6381713, 'auroc': 0.9164119, 'binary_precision': 0.47107437, 'binary_recall': 0.21839081, 'binary_specificity': 0.989328, 'binary_f1_score': 0.2984293}
confusion matrix:
      0   1
0  5933  64
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 14
val acc:0.965623676776886, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9643656015396118 / 0.9785873889923096
after epoch: 27,now: 2024-05-25 19:25:19.435628,epoch time: 0:19:56.640012,used: 9:03:56.463404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97104496, 'precision': 0.7717472, 'recall': 0.8489573, 'specificity': 0.8489573, 'f1': 0.80500746, 'auroc': 0.9721071, 'binary_precision': 0.55340314, 'binary_recall': 0.7180706, 'binary_specificity': 0.97984403, 'binary_f1_score': 0.6250739}
confusion matrix:
       0     1
0  41467   853
1    415  1057
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.76087546, 'recall': 0.8683198, 'specificity': 0.8683198, 'f1': 0.80431163, 'auroc': 0.96242404, 'binary_precision': 0.53036875, 'binary_recall': 0.7604977, 'binary_specificity': 0.9761419, 'binary_f1_score': 0.6249202}
confusion matrix:
       0    1
0  17716  433
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8042816, 'recall': 0.669994, 'specificity': 0.669994, 'f1': 0.71608305, 'auroc': 0.9224613, 'binary_precision': 0.6363636, 'binary_recall': 0.348659, 'binary_specificity': 0.991329, 'binary_f1_score': 0.45049503}
confusion matrix:
      0   1
0  5945  52
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
better model found
persisted
after epoch: 28,now: 2024-05-25 19:45:18.970234,epoch time: 0:19:59.534606,used: 9:23:55.998010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96867007, 'precision': 0.7574904, 'recall': 0.89487803, 'specificity': 0.89487803, 'f1': 0.8099487, 'auroc': 0.97266364, 'binary_precision': 0.5215124, 'binary_recall': 0.8157716, 'binary_specificity': 0.97398454, 'binary_f1_score': 0.63626724}
confusion matrix:
       0     1
0  41220  1101
1    271  1200
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74811244, 'recall': 0.89394426, 'specificity': 0.89394426, 'f1': 0.8023307, 'auroc': 0.9656184, 'binary_precision': 0.50287354, 'binary_recall': 0.8164852, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.6224066}
confusion matrix:
       0    1
0  17630  519
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8146737, 'recall': 0.7600304, 'specificity': 0.7600304, 'f1': 0.7844511, 'auroc': 0.94567585, 'binary_precision': 0.64953274, 'binary_recall': 0.532567, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.58526313}
confusion matrix:
      0    1
0  5922   75
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 1
val acc:0.9661026000976562, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9645254015922546 / 0.9785873889923096
after epoch: 29,now: 2024-05-25 20:05:16.006763,epoch time: 0:19:57.036529,used: 9:43:53.034539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9685102, 'precision': 0.7564363, 'recall': 0.8766753, 'specificity': 0.8766753, 'f1': 0.8037552, 'auroc': 0.9735934, 'binary_precision': 0.52071005, 'binary_recall': 0.77823126, 'binary_specificity': 0.97511935, 'binary_f1_score': 0.62394327}
confusion matrix:
       0     1
0  41269  1053
1    326  1144
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7535417, 'recall': 0.88107693, 'specificity': 0.88107693, 'f1': 0.80288684, 'auroc': 0.9635883, 'binary_precision': 0.5147208, 'binary_recall': 0.7884914, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.6228501}
confusion matrix:
       0    1
0  17671  478
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8447739, 'recall': 0.7070595, 'specificity': 0.7070595, 'f1': 0.75700307, 'auroc': 0.9336194, 'binary_precision': 0.71428573, 'binary_recall': 0.42145595, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5301205}
confusion matrix:
      0    1
0  5953   44
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839956.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9645254015922546 / 0.9785873889923096
after epoch: 30,now: 2024-05-25 20:24:43.536833,epoch time: 0:19:27.530070,used: 10:03:20.564609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_22_seed_0_20839956
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:03:20.564609 at 2024-05-25 20:24:43.536833
persisted model performance metric: 

scalar performance:
{'acc': 0.9654842, 'precision': 0.8382492, 'recall': 0.64484155, 'specificity': 0.64484155, 'f1': 0.69921625, 'auroc': 0.9266678, 'binary_precision': 0.70642203, 'binary_recall': 0.29501915, 'binary_specificity': 0.994664, 'binary_f1_score': 0.4162162}
confusion matrix:
      0   1
0  5965  32
1   184  77
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.9057085, 'recall': 0.7942669, 'specificity': 0.7942669, 'f1': 0.84026456, 'auroc': 0.9212576, 'binary_precision': 0.82887703, 'binary_recall': 0.59386975, 'binary_specificity': 0.994664, 'binary_f1_score': 0.6919643}
confusion matrix:
      0    1
0  5965   32
1   106  155
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1343 MiB |   1726 MiB | 593348 GiB | 593347 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590409 GiB | 590407 GiB |
|       from small pool |     10 MiB |     11 MiB |   2939 GiB |   2939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137762 K  |  137759 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72868 K  |   72864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137762 K  |  137759 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72868 K  |   72864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    2768    |   70600 K  |   70599 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      49    |    2747    |   38422 K  |   38422 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593348 GiB | 593348 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590409 GiB | 590409 GiB |
|       from small pool |      0 KiB |     26 MiB |   2939 GiB |   2939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137762 K  |  137762 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72868 K  |   72868 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137762 K  |  137762 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72868 K  |   72868 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70601 K  |   70601 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38423 K  |   38423 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 20:26:51 2024]
Finished job 0.
1 of 1 steps (100%) done
