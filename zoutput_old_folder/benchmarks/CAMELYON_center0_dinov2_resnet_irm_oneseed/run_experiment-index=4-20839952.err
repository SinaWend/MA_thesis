Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:11:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952

 Experiment start at: 2024-05-25 10:21:10.788732
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.7379911, 'recall': 0.53380495, 'specificity': 0.53380495, 'f1': 0.5529428, 'auroc': 0.8984027, 'binary_precision': 0.5073892, 'binary_recall': 0.06997283, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.12298509}
confusion matrix:
       0    1
0  42220  100
1   1369  103
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7277881, 'recall': 0.5299471, 'specificity': 0.5299471, 'f1': 0.54642284, 'auroc': 0.8873677, 'binary_precision': 0.4878049, 'binary_recall': 0.0622084, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.11034483}
confusion matrix:
       0   1
0  18107  42
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.91986716, 'recall': 0.5799595, 'specificity': 0.5799595, 'f1': 0.6267063, 'auroc': 0.88016355, 'binary_precision': 0.875, 'binary_recall': 0.16091955, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.27184466}
confusion matrix:
      0   1
0  5991   6
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:43:43.693341,epoch time: 0:22:32.904609,used: 0:22:32.904609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.748358, 'recall': 0.6128894, 'specificity': 0.6128894, 'f1': 0.6528288, 'auroc': 0.9180666, 'binary_precision': 0.52286583, 'binary_recall': 0.23317471, 'binary_specificity': 0.99260414, 'binary_f1_score': 0.32251996}
confusion matrix:
       0    1
0  42008  313
1   1128  343
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.73588973, 'recall': 0.63120455, 'specificity': 0.63120455, 'f1': 0.66706526, 'auroc': 0.90855294, 'binary_precision': 0.4971591, 'binary_recall': 0.27216175, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.35175878}
confusion matrix:
       0    1
0  17972  177
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.9107578, 'recall': 0.7451254, 'specificity': 0.7451254, 'f1': 0.80514896, 'auroc': 0.9143678, 'binary_precision': 0.84313726, 'binary_recall': 0.49425286, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6231884}
confusion matrix:
      0    1
0  5973   24
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
new oracle model saved
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.975071907043457
after epoch: 2,now: 2024-05-25 11:01:02.513474,epoch time: 0:17:18.820133,used: 0:39:51.724742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7446591, 'recall': 0.73646134, 'specificity': 0.73646134, 'f1': 0.74048257, 'auroc': 0.92996484, 'binary_precision': 0.5070422, 'binary_recall': 0.48946294, 'binary_specificity': 0.9834598, 'binary_f1_score': 0.49809754}
confusion matrix:
       0    1
0  41621  700
1    751  720
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7388791, 'recall': 0.7421025, 'specificity': 0.7421025, 'f1': 0.74047875, 'auroc': 0.92477983, 'binary_precision': 0.49539876, 'binary_recall': 0.5023328, 'binary_specificity': 0.98187226, 'binary_f1_score': 0.4988417}
confusion matrix:
       0    1
0  17820  329
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.88781947, 'recall': 0.8219186, 'specificity': 0.8219186, 'f1': 0.851495, 'auroc': 0.9167387, 'binary_precision': 0.7906977, 'binary_recall': 0.651341, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.7142857}
confusion matrix:
      0    1
0  5952   45
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
new oracle model saved
early stop counter: 2
val acc:0.9654640555381775, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9782677888870239
after epoch: 3,now: 2024-05-25 11:18:15.118259,epoch time: 0:17:12.604785,used: 0:57:04.329527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.74559236, 'recall': 0.77223504, 'specificity': 0.77223504, 'f1': 0.75814867, 'auroc': 0.9321442, 'binary_precision': 0.5064142, 'binary_recall': 0.5635622, 'binary_specificity': 0.9809078, 'binary_f1_score': 0.53346205}
confusion matrix:
       0    1
0  41513  808
1    642  829
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.73257434, 'recall': 0.7565527, 'specificity': 0.7565527, 'f1': 0.74390364, 'auroc': 0.9279953, 'binary_precision': 0.48174158, 'binary_recall': 0.533437, 'binary_specificity': 0.9796683, 'binary_f1_score': 0.5062731}
confusion matrix:
       0    1
0  17780  369
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.85261464, 'recall': 0.8370756, 'specificity': 0.8370756, 'f1': 0.84465015, 'auroc': 0.9198079, 'binary_precision': 0.7188755, 'binary_recall': 0.68582374, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.70196074}
confusion matrix:
      0    1
0  5927   70
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 3
val acc:0.9643997550010681, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9782677888870239
after epoch: 4,now: 2024-05-25 11:35:39.146210,epoch time: 0:17:24.027951,used: 1:14:28.357478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.7447599, 'recall': 0.7759068, 'specificity': 0.7759068, 'f1': 0.7592928, 'auroc': 0.94472927, 'binary_precision': 0.5044991, 'binary_recall': 0.5713315, 'binary_specificity': 0.98048204, 'binary_f1_score': 0.5358394}
confusion matrix:
       0    1
0  41494  826
1    631  841
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7328437, 'recall': 0.7744713, 'specificity': 0.7744713, 'f1': 0.75173676, 'auroc': 0.9343716, 'binary_precision': 0.48099607, 'binary_recall': 0.57076204, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.52204835}
confusion matrix:
       0    1
0  17753  396
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.8726976, 'recall': 0.82874775, 'specificity': 0.82874775, 'f1': 0.8491982, 'auroc': 0.9312389, 'binary_precision': 0.75982535, 'binary_recall': 0.6666667, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.7102041}
confusion matrix:
      0    1
0  5942   55
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 4
val acc:0.9642400741577148, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9782677888870239
after epoch: 5,now: 2024-05-25 11:52:52.061929,epoch time: 0:17:12.915719,used: 1:31:41.273197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96828187, 'precision': 0.75495183, 'recall': 0.78547263, 'specificity': 0.78547263, 'f1': 0.76925266, 'auroc': 0.9487181, 'binary_precision': 0.5242131, 'binary_recall': 0.5895167, 'binary_specificity': 0.98142856, 'binary_f1_score': 0.55495036}
confusion matrix:
       0    1
0  41537  786
1    603  866
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7415788, 'recall': 0.7894111, 'specificity': 0.7894111, 'f1': 0.76307744, 'auroc': 0.93738544, 'binary_precision': 0.4974227, 'binary_recall': 0.60031104, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.5440451}
confusion matrix:
       0    1
0  17759  390
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793864, 'precision': 0.89425695, 'recall': 0.8316639, 'specificity': 0.8316639, 'f1': 0.85998595, 'auroc': 0.9377415, 'binary_precision': 0.8027523, 'binary_recall': 0.6704981, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.7306889}
confusion matrix:
      0    1
0  5954   43
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
new oracle model saved
early stop counter: 5
val acc:0.9655704498291016, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 6,now: 2024-05-25 12:09:38.333401,epoch time: 0:16:46.271472,used: 1:48:27.544669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.74582416, 'recall': 0.8038986, 'specificity': 0.8038986, 'f1': 0.7714284, 'auroc': 0.9493972, 'binary_precision': 0.5046372, 'binary_recall': 0.6292517, 'binary_specificity': 0.9785454, 'binary_f1_score': 0.5600968}
confusion matrix:
       0    1
0  41414  908
1    545  925
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7392101, 'recall': 0.8108597, 'specificity': 0.8108597, 'f1': 0.76978326, 'auroc': 0.9389924, 'binary_precision': 0.49112427, 'binary_recall': 0.64541215, 'binary_specificity': 0.9763072, 'binary_f1_score': 0.5577957}
confusion matrix:
       0    1
0  17719  430
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.87882805, 'recall': 0.82150173, 'specificity': 0.82150173, 'f1': 0.84757245, 'auroc': 0.9327736, 'binary_precision': 0.77272725, 'binary_recall': 0.651341, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.7068607}
confusion matrix:
      0    1
0  5947   50
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 6
val acc:0.9649850726127625, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 7,now: 2024-05-25 12:26:45.380176,epoch time: 0:17:07.046775,used: 2:05:34.591444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7452831, 'recall': 0.7998287, 'specificity': 0.7998287, 'f1': 0.76950186, 'auroc': 0.9494878, 'binary_precision': 0.50385886, 'binary_recall': 0.62092394, 'binary_specificity': 0.9787335, 'binary_f1_score': 0.55629945}
confusion matrix:
       0    1
0  41420  900
1    558  914
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.7343612, 'recall': 0.8103913, 'specificity': 0.8103913, 'f1': 0.76639307, 'auroc': 0.9394914, 'binary_precision': 0.48143852, 'binary_recall': 0.64541215, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.551495}
confusion matrix:
       0    1
0  17702  447
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.86731803, 'recall': 0.8416574, 'specificity': 0.8416574, 'f1': 0.8539723, 'auroc': 0.9397119, 'binary_precision': 0.74793386, 'binary_recall': 0.6934866, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.71968186}
confusion matrix:
      0    1
0  5936   61
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 7
val acc:0.9640804529190063, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 8,now: 2024-05-25 12:43:50.757027,epoch time: 0:17:05.376851,used: 2:22:39.968295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7431559, 'recall': 0.79801214, 'specificity': 0.79801214, 'f1': 0.7674705, 'auroc': 0.95051503, 'binary_precision': 0.49972513, 'binary_recall': 0.6175272, 'binary_specificity': 0.97849715, 'binary_f1_score': 0.5524157}
confusion matrix:
       0    1
0  41410  910
1    563  909
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.739649, 'recall': 0.8138875, 'specificity': 0.8138875, 'f1': 0.7711651, 'auroc': 0.94476986, 'binary_precision': 0.49178404, 'binary_recall': 0.65163296, 'binary_specificity': 0.9761419, 'binary_f1_score': 0.56053513}
confusion matrix:
       0    1
0  17716  433
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.87910223, 'recall': 0.8498205, 'specificity': 0.8498205, 'f1': 0.86380994, 'auroc': 0.9329473, 'binary_precision': 0.7708333, 'binary_recall': 0.70881224, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.738523}
confusion matrix:
      0    1
0  5942   55
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 8
val acc:0.9650382995605469, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 9,now: 2024-05-25 13:01:00.764306,epoch time: 0:17:10.007279,used: 2:39:49.975574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9636692, 'precision': 0.731422, 'recall': 0.84153473, 'specificity': 0.84153473, 'f1': 0.7745261, 'auroc': 0.95027375, 'binary_precision': 0.4730891, 'binary_recall': 0.7105978, 'binary_specificity': 0.97247165, 'binary_f1_score': 0.56801516}
confusion matrix:
       0     1
0  41155  1165
1    426  1046
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.7342638, 'recall': 0.8558141, 'specificity': 0.8558141, 'f1': 0.7808647, 'auroc': 0.94819415, 'binary_precision': 0.47791165, 'binary_recall': 0.7402799, 'binary_specificity': 0.9713483, 'binary_f1_score': 0.58084196}
confusion matrix:
       0    1
0  17629  520
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8183806, 'recall': 0.8647255, 'specificity': 0.8647255, 'f1': 0.8397808, 'auroc': 0.9411628, 'binary_precision': 0.64784056, 'binary_recall': 0.74712646, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.6939502}
confusion matrix:
      0    1
0  5891  106
1    66  195
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 9
val acc:0.9634419083595276, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 10,now: 2024-05-25 13:20:48.027263,epoch time: 0:19:47.262957,used: 2:59:37.238531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9654046, 'precision': 0.738661, 'recall': 0.8191546, 'specificity': 0.8191546, 'f1': 0.7723802, 'auroc': 0.9562712, 'binary_precision': 0.48921224, 'binary_recall': 0.6623641, 'binary_specificity': 0.9759452, 'binary_f1_score': 0.56277055}
confusion matrix:
       0     1
0  41302  1018
1    497   975
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.73659873, 'recall': 0.8150845, 'specificity': 0.8150845, 'f1': 0.7695492, 'auroc': 0.94710755, 'binary_precision': 0.48558247, 'binary_recall': 0.6547434, 'binary_specificity': 0.97542566, 'binary_f1_score': 0.5576159}
confusion matrix:
       0    1
0  17703  446
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.8308946, 'recall': 0.83574164, 'specificity': 0.83574164, 'f1': 0.8332983, 'auroc': 0.9429319, 'binary_precision': 0.6754717, 'binary_recall': 0.68582374, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.6806084}
confusion matrix:
      0    1
0  5911   86
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 10
val acc:0.9644529819488525, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 11,now: 2024-05-25 13:38:03.536156,epoch time: 0:17:15.508893,used: 3:16:52.747424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9670716, 'precision': 0.74741936, 'recall': 0.80120146, 'specificity': 0.80120146, 'f1': 0.77136254, 'auroc': 0.9553273, 'binary_precision': 0.5080332, 'binary_recall': 0.6233854, 'binary_specificity': 0.9790175, 'binary_f1_score': 0.55982906}
confusion matrix:
       0    1
0  41433  888
1    554  917
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7392101, 'recall': 0.8108597, 'specificity': 0.8108597, 'f1': 0.76978326, 'auroc': 0.94627464, 'binary_precision': 0.49112427, 'binary_recall': 0.64541215, 'binary_specificity': 0.9763072, 'binary_f1_score': 0.5577957}
confusion matrix:
       0    1
0  17719  430
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.853475, 'recall': 0.8183354, 'specificity': 0.8183354, 'f1': 0.83488387, 'auroc': 0.9444713, 'binary_precision': 0.7222222, 'binary_recall': 0.6475096, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.68282825}
confusion matrix:
      0    1
0  5932   65
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 11
val acc:0.9649850726127625, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 12,now: 2024-05-25 13:54:47.532625,epoch time: 0:16:43.996469,used: 3:33:36.743893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.74474657, 'recall': 0.8171107, 'specificity': 0.8171107, 'f1': 0.7757047, 'auroc': 0.95690066, 'binary_precision': 0.50155604, 'binary_recall': 0.6569294, 'binary_specificity': 0.97729206, 'binary_f1_score': 0.5688236}
confusion matrix:
       0    1
0  41359  961
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.74146044, 'recall': 0.81555283, 'specificity': 0.81555283, 'f1': 0.7729637, 'auroc': 0.94817305, 'binary_precision': 0.49529412, 'binary_recall': 0.6547434, 'binary_specificity': 0.97636235, 'binary_f1_score': 0.56396514}
confusion matrix:
       0    1
0  17720  429
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.83882177, 'recall': 0.78376925, 'specificity': 0.78376925, 'f1': 0.80858934, 'auroc': 0.9477836, 'binary_precision': 0.6958525, 'binary_recall': 0.5785441, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.63179916}
confusion matrix:
      0    1
0  5931   66
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 12
val acc:0.9653576016426086, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 13,now: 2024-05-25 14:11:39.358435,epoch time: 0:16:51.825810,used: 3:50:28.569703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7404853, 'recall': 0.79276025, 'specificity': 0.79276025, 'f1': 0.76375186, 'auroc': 0.9574878, 'binary_precision': 0.49473685, 'binary_recall': 0.60707, 'binary_specificity': 0.9784504, 'binary_f1_score': 0.54517704}
confusion matrix:
       0    1
0  41409  912
1    578  893
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.7366872, 'recall': 0.7859976, 'specificity': 0.7859976, 'f1': 0.7587279, 'auroc': 0.951129, 'binary_precision': 0.48786718, 'binary_recall': 0.5940902, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.5357644}
confusion matrix:
       0    1
0  17748  401
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.82173413, 'recall': 0.72488254, 'specificity': 0.72488254, 'f1': 0.76378584, 'auroc': 0.93572414, 'binary_precision': 0.6666667, 'binary_recall': 0.4597701, 'binary_specificity': 0.989995, 'binary_f1_score': 0.5442177}
confusion matrix:
      0    1
0  5937   60
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 13
val acc:0.9647722244262695, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 14,now: 2024-05-25 14:28:39.224652,epoch time: 0:16:59.866217,used: 4:07:28.435920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7472895, 'recall': 0.8506132, 'specificity': 0.8506132, 'f1': 0.7889266, 'auroc': 0.96293473, 'binary_precision': 0.5042493, 'binary_recall': 0.7260367, 'binary_specificity': 0.9751896, 'binary_f1_score': 0.59515184}
confusion matrix:
       0     1
0  41271  1050
1    403  1068
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.7375753, 'recall': 0.8628952, 'specificity': 0.8628952, 'f1': 0.78544194, 'auroc': 0.95406365, 'binary_precision': 0.48403195, 'binary_recall': 0.7542768, 'binary_specificity': 0.97151357, 'binary_f1_score': 0.58966565}
confusion matrix:
       0    1
0  17632  517
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.82261455, 'recall': 0.8202492, 'specificity': 0.8202492, 'f1': 0.821427, 'auroc': 0.9421294, 'binary_precision': 0.66023165, 'binary_recall': 0.6551724, 'binary_specificity': 0.985326, 'binary_f1_score': 0.6576923}
confusion matrix:
      0    1
0  5909   88
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 14
val acc:0.9640804529190063, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 15,now: 2024-05-25 14:45:43.523117,epoch time: 0:17:04.298465,used: 4:24:32.734385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7459519, 'recall': 0.80849504, 'specificity': 0.80849504, 'f1': 0.77327454, 'auroc': 0.960045, 'binary_precision': 0.50456744, 'binary_recall': 0.6387755, 'binary_specificity': 0.9782146, 'binary_f1_score': 0.5637947}
confusion matrix:
       0    1
0  41400  922
1    531  939
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7419084, 'recall': 0.8051348, 'specificity': 0.8051348, 'f1': 0.76941615, 'auroc': 0.9551549, 'binary_precision': 0.4969475, 'binary_recall': 0.63297045, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.5567715}
confusion matrix:
       0    1
0  17737  412
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.80736196, 'recall': 0.7055587, 'specificity': 0.7055587, 'f1': 0.7452276, 'auroc': 0.9410093, 'binary_precision': 0.6395349, 'binary_recall': 0.42145595, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.50808316}
confusion matrix:
      0    1
0  5935   62
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 15
val acc:0.9655172228813171, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 16,now: 2024-05-25 15:04:04.357701,epoch time: 0:18:20.834584,used: 4:42:53.568969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.967711, 'precision': 0.7519828, 'recall': 0.84844923, 'specificity': 0.84844923, 'f1': 0.7915317, 'auroc': 0.96507, 'binary_precision': 0.5138148, 'binary_recall': 0.7205982, 'binary_specificity': 0.9763002, 'binary_f1_score': 0.5998868}
confusion matrix:
       0     1
0  41318  1003
1    411  1060
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7431792, 'recall': 0.84933287, 'specificity': 0.84933287, 'f1': 0.7855365, 'auroc': 0.95628905, 'binary_precision': 0.49627262, 'binary_recall': 0.7247278, 'binary_specificity': 0.9739379, 'binary_f1_score': 0.58912766}
confusion matrix:
       0    1
0  17676  473
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8403189, 'recall': 0.75195265, 'specificity': 0.75195265, 'f1': 0.7888342, 'auroc': 0.9509748, 'binary_precision': 0.7015707, 'binary_recall': 0.51341, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.5929204}
confusion matrix:
      0    1
0  5940   57
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 16
val acc:0.9654108285903931, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 17,now: 2024-05-25 15:21:16.675362,epoch time: 0:17:12.317661,used: 5:00:05.886630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7475931, 'recall': 0.8820977, 'specificity': 0.8820977, 'f1': 0.798676, 'auroc': 0.96581745, 'binary_precision': 0.50258845, 'binary_recall': 0.7914402, 'binary_specificity': 0.9727552, 'binary_f1_score': 0.6147757}
confusion matrix:
       0     1
0  41167  1153
1    307  1165
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7420273, 'recall': 0.88428247, 'specificity': 0.88428247, 'f1': 0.7948832, 'auroc': 0.959563, 'binary_precision': 0.49137932, 'binary_recall': 0.7978227, 'binary_specificity': 0.97074217, 'binary_f1_score': 0.6081802}
confusion matrix:
       0    1
0  17618  531
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8350384, 'recall': 0.8079231, 'specificity': 0.8079231, 'f1': 0.82084286, 'auroc': 0.9407021, 'binary_precision': 0.68619245, 'binary_recall': 0.62835246, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.656}
confusion matrix:
      0    1
0  5922   75
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 17
val acc:0.964825451374054, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 18,now: 2024-05-25 15:37:59.872500,epoch time: 0:16:43.197138,used: 5:16:49.083768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9630983, 'precision': 0.7302537, 'recall': 0.86025524, 'specificity': 0.86025524, 'f1': 0.7790563, 'auroc': 0.9632762, 'binary_precision': 0.46938777, 'binary_recall': 0.75, 'binary_specificity': 0.9705104, 'binary_f1_score': 0.57740587}
confusion matrix:
       0     1
0  41072  1248
1    368  1104
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.7333033, 'recall': 0.8690947, 'specificity': 0.8690947, 'f1': 0.783844, 'auroc': 0.9574156, 'binary_precision': 0.475, 'binary_recall': 0.7682737, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.5870469}
confusion matrix:
       0    1
0  17603  546
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.76420134, 'recall': 0.729127, 'specificity': 0.729127, 'f1': 0.74525213, 'auroc': 0.934128, 'binary_precision': 0.5511111, 'binary_recall': 0.47509578, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5102881}
confusion matrix:
      0    1
0  5896  101
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 18
val acc:0.963016152381897, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 19,now: 2024-05-25 15:54:49.428022,epoch time: 0:16:49.555522,used: 5:33:38.639290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9685102, 'precision': 0.75654906, 'recall': 0.85453093, 'specificity': 0.85453093, 'f1': 0.79674697, 'auroc': 0.965208, 'binary_precision': 0.52254, 'binary_recall': 0.73233694, 'binary_specificity': 0.976725, 'binary_f1_score': 0.609901}
confusion matrix:
       0     1
0  41335   985
1    394  1078
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.74183255, 'recall': 0.85964084, 'specificity': 0.85964084, 'f1': 0.78771263, 'auroc': 0.95915955, 'binary_precision': 0.49281314, 'binary_recall': 0.7465008, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.593692}
confusion matrix:
       0    1
0  17655  494
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8616955, 'recall': 0.73779416, 'specificity': 0.73779416, 'f1': 0.7856594, 'auroc': 0.9413532, 'binary_precision': 0.74556214, 'binary_recall': 0.4827586, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.5860465}
confusion matrix:
      0    1
0  5954   43
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 19
val acc:0.9650382995605469, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 20,now: 2024-05-25 16:11:54.983286,epoch time: 0:17:05.555264,used: 5:50:44.194554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9680992, 'precision': 0.7542497, 'recall': 0.86177367, 'specificity': 0.86177367, 'f1': 0.7974937, 'auroc': 0.96664965, 'binary_precision': 0.5174036, 'binary_recall': 0.74779063, 'binary_specificity': 0.9757567, 'binary_f1_score': 0.61162084}
confusion matrix:
       0     1
0  41295  1026
1    371  1100
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.74301374, 'recall': 0.8635013, 'specificity': 0.8635013, 'f1': 0.78975004, 'auroc': 0.9595288, 'binary_precision': 0.49489796, 'binary_recall': 0.7542768, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.59765863}
confusion matrix:
       0    1
0  17654  495
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8234611, 'recall': 0.7455385, 'specificity': 0.7455385, 'f1': 0.77856684, 'auroc': 0.94526505, 'binary_precision': 0.6683673, 'binary_recall': 0.5019157, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.5733041}
confusion matrix:
      0    1
0  5932   65
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839952.png
early stop counter: 20
val acc:0.9652511477470398, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9640460014343262 / 0.9793863892555237
after epoch: 21,now: 2024-05-25 16:29:03.671094,epoch time: 0:17:08.687808,used: 6:07:52.882362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_10_seed_0_20839952
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 6:07:52.882362 at 2024-05-25 16:29:03.671094
persisted model performance metric: 

scalar performance:
{'acc': 0.96612334, 'precision': 0.93419874, 'recall': 0.6048637, 'specificity': 0.6048637, 'f1': 0.6621147, 'auroc': 0.89261806, 'binary_precision': 0.90163934, 'binary_recall': 0.21072797, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.34161493}
confusion matrix:
      0   1
0  5991   6
1   206  55
oracle model performance metric: 

scalar performance:
{'acc': 0.97810805, 'precision': 0.88003945, 'recall': 0.8309969, 'specificity': 0.8309969, 'f1': 0.8536483, 'auroc': 0.93811595, 'binary_precision': 0.7743363, 'binary_recall': 0.6704981, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.7186858}
confusion matrix:
      0    1
0  5946   51
1    86  175
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1163 TiB |   1163 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1161 TiB |   1161 TiB |
|       from small pool |  89819 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1163 TiB |   1163 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1161 TiB |   1161 TiB |
|       from small pool |  89819 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1159 TiB |   1159 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1157 TiB |   1157 TiB |
|       from small pool |  88733 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1341 MiB |   1726 MiB | 415680 GiB | 415679 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 413619 GiB | 413618 GiB |
|       from small pool |      8 MiB |      9 MiB |   2061 GiB |   2061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |   96558 K  |   96554 K  |
|       from large pool |      87    |     909    |   45479 K  |   45479 K  |
|       from small pool |    3642    |    6631    |   51078 K  |   51075 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |   96558 K  |   96554 K  |
|       from large pool |      87    |     909    |   45479 K  |   45479 K  |
|       from small pool |    3642    |    6631    |   51078 K  |   51075 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2768    |   49506 K  |   49506 K  |
|       from large pool |      20    |      59    |   22551 K  |   22551 K  |
|       from small pool |      52    |    2747    |   26955 K  |   26955 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1163 TiB |   1163 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1161 TiB |   1161 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1163 TiB |   1163 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1161 TiB |   1161 TiB |
|       from small pool |      0 KiB |    124 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1159 TiB |   1159 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1157 TiB |   1157 TiB |
|       from small pool |      0 KiB |    123 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1824 MiB |  11226 MiB |  11226 MiB |   9402 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 415680 GiB | 415680 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 413619 GiB | 413619 GiB |
|       from small pool |      0 KiB |     24 MiB |   2061 GiB |   2061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |   96558 K  |   96558 K  |
|       from large pool |       2    |     909    |   45479 K  |   45479 K  |
|       from small pool |       0    |    6631    |   51078 K  |   51078 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |   96558 K  |   96558 K  |
|       from large pool |       2    |     909    |   45479 K  |   45479 K  |
|       from small pool |       0    |    6631    |   51078 K  |   51078 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     232    |     232    |     154    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   49508 K  |   49508 K  |
|       from large pool |       4    |      59    |   22551 K  |   22551 K  |
|       from small pool |       0    |    2747    |   26956 K  |   26956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 16:30:58 2024]
Finished job 0.
1 of 1 steps (100%) done
