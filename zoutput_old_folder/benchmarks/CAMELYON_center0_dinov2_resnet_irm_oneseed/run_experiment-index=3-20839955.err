Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:11:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955

 Experiment start at: 2024-05-25 10:21:02.284191
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97026855, 'precision': 0.92852795, 'recall': 0.56594104, 'specificity': 0.56594104, 'f1': 0.60766894, 'auroc': 0.9714483, 'binary_precision': 0.8863636, 'binary_recall': 0.13247283, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.23049644}
confusion matrix:
       0    1
0  42295   25
1   1277  195
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.9180329, 'recall': 0.535577, 'specificity': 0.535577, 'f1': 0.557905, 'auroc': 0.9661368, 'binary_precision': 0.8679245, 'binary_recall': 0.071539655, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.13218391}
confusion matrix:
       0   1
0  18142   7
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.9494121, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:48:03.202539,epoch time: 0:27:00.918348,used: 0:27:00.918348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9795168, 'precision': 0.94475013, 'recall': 0.7161032, 'specificity': 0.7161032, 'f1': 0.78835225, 'auroc': 0.9792929, 'binary_precision': 0.9088319, 'binary_recall': 0.43371856, 'binary_specificity': 0.9984878, 'binary_f1_score': 0.5872066}
confusion matrix:
       0    1
0  42257   64
1    833  638
---- Validation: 
scalar performance:
{'acc': 0.977384, 'precision': 0.9236869, 'recall': 0.69877005, 'specificity': 0.69877005, 'f1': 0.76789653, 'auroc': 0.9735263, 'binary_precision': 0.8682432, 'binary_recall': 0.39968896, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.5473909}
confusion matrix:
       0    1
0  18110   39
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77133363, 'recall': 0.5129931, 'specificity': 0.5129931, 'f1': 0.5150635, 'auroc': 0.96560276, 'binary_precision': 0.5833333, 'binary_recall': 0.026819924, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.05128205}
confusion matrix:
      0  1
0  5992  5
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 2,now: 2024-05-25 11:14:18.811518,epoch time: 0:26:15.608979,used: 0:53:16.527327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9831248, 'precision': 0.9051477, 'recall': 0.81488067, 'specificity': 0.81488067, 'f1': 0.85391796, 'auroc': 0.98234236, 'binary_precision': 0.8229075, 'binary_recall': 0.6345109, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.7165324}
confusion matrix:
       0    1
0  42119  201
1    538  934
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.869625, 'recall': 0.8496227, 'specificity': 0.8496227, 'f1': 0.8593212, 'auroc': 0.97826886, 'binary_precision': 0.74958813, 'binary_recall': 0.7076205, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.728}
confusion matrix:
       0    1
0  17997  152
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.9230018, 'recall': 0.6104441, 'specificity': 0.6104441, 'f1': 0.6687147, 'auroc': 0.9668864, 'binary_precision': 0.8787879, 'binary_recall': 0.22222222, 'binary_specificity': 0.998666, 'binary_f1_score': 0.35474008}
confusion matrix:
      0   1
0  5989   8
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-25 11:40:49.142200,epoch time: 0:26:30.330682,used: 1:19:46.858009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9025415, 'recall': 0.8686496, 'specificity': 0.8686496, 'f1': 0.88479006, 'auroc': 0.98514354, 'binary_precision': 0.8139881, 'binary_recall': 0.7432065, 'binary_specificity': 0.99409264, 'binary_f1_score': 0.77698857}
confusion matrix:
       0     1
0  42070   250
1    378  1094
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.89945114, 'recall': 0.85008484, 'specificity': 0.85008484, 'f1': 0.87300825, 'auroc': 0.9791919, 'binary_precision': 0.8092692, 'binary_recall': 0.7060653, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.75415283}
confusion matrix:
       0    1
0  18042  107
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8185448, 'recall': 0.55438834, 'specificity': 0.55438834, 'f1': 0.58532274, 'auroc': 0.9575572, 'binary_precision': 0.6744186, 'binary_recall': 0.11111111, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19078949}
confusion matrix:
      0   1
0  5983  14
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 4,now: 2024-05-25 12:06:44.127071,epoch time: 0:25:54.984871,used: 1:45:41.842880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.9379572, 'recall': 0.78613544, 'specificity': 0.78613544, 'f1': 0.8450122, 'auroc': 0.98230165, 'binary_precision': 0.8905263, 'binary_recall': 0.57472825, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.6985962}
confusion matrix:
       0    1
0  42216  104
1    626  846
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.9285966, 'recall': 0.7622582, 'specificity': 0.7622582, 'f1': 0.82397836, 'auroc': 0.9737891, 'binary_precision': 0.87371135, 'binary_recall': 0.5272162, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.657614}
confusion matrix:
       0    1
0  18100   49
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9400692, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 1
val acc:0.9812154173851013, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9606903195381165 / 0.9662831425666809
after epoch: 5,now: 2024-05-25 12:32:45.847410,epoch time: 0:26:01.720339,used: 2:11:43.563219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9814121, 'precision': 0.8380494, 'recall': 0.9123523, 'specificity': 0.9123523, 'f1': 0.8711623, 'auroc': 0.98698986, 'binary_precision': 0.68176794, 'binary_recall': 0.8383152, 'binary_specificity': 0.9863894, 'binary_f1_score': 0.7519804}
confusion matrix:
       0     1
0  41744   576
1    238  1234
---- Validation: 
scalar performance:
{'acc': 0.9794061, 'precision': 0.82464314, 'recall': 0.9128326, 'specificity': 0.9128326, 'f1': 0.86291987, 'auroc': 0.9800269, 'binary_precision': 0.6549637, 'binary_recall': 0.84136856, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.7365555}
confusion matrix:
       0    1
0  17864  285
1    102  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7606933, 'recall': 0.6256826, 'specificity': 0.6256826, 'f1': 0.6668625, 'auroc': 0.9515968, 'binary_precision': 0.55284554, 'binary_recall': 0.2605364, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.3541667}
confusion matrix:
      0   1
0  5942  55
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 2
val acc:0.9794061183929443, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9606903195381165 / 0.9662831425666809
after epoch: 6,now: 2024-05-25 12:59:05.702567,epoch time: 0:26:19.855157,used: 2:38:03.418376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.8917925, 'recall': 0.913584, 'specificity': 0.913584, 'f1': 0.902368, 'auroc': 0.9920132, 'binary_precision': 0.78933847, 'binary_recall': 0.8349185, 'binary_specificity': 0.99224955, 'binary_f1_score': 0.811489}
confusion matrix:
       0     1
0  41992   328
1    243  1229
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.88325864, 'recall': 0.88555783, 'specificity': 0.88555783, 'f1': 0.88440454, 'auroc': 0.98240274, 'binary_precision': 0.77434313, 'binary_recall': 0.7791602, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.77674425}
confusion matrix:
       0    1
0  18003  146
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80710244, 'recall': 0.5897863, 'specificity': 0.5897863, 'f1': 0.63347316, 'auroc': 0.9585369, 'binary_precision': 0.6486486, 'binary_recall': 0.18390805, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28656715}
confusion matrix:
      0   1
0  5971  26
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 7,now: 2024-05-25 13:25:18.910506,epoch time: 0:26:13.207939,used: 3:04:16.626315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9823712, 'precision': 0.87751687, 'recall': 0.8387524, 'specificity': 0.8387524, 'f1': 0.85699743, 'auroc': 0.98830736, 'binary_precision': 0.7659575, 'binary_recall': 0.6847826, 'binary_specificity': 0.9927221, 'binary_f1_score': 0.72309905}
confusion matrix:
       0     1
0  42012   308
1    464  1008
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.86792254, 'recall': 0.8480124, 'specificity': 0.8480124, 'f1': 0.85766613, 'auroc': 0.9803919, 'binary_precision': 0.74629325, 'binary_recall': 0.7045101, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.72480005}
confusion matrix:
       0    1
0  17995  154
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.84041065, 'recall': 0.7238006, 'specificity': 0.7238006, 'f1': 0.7688011, 'auroc': 0.9660138, 'binary_precision': 0.70414203, 'binary_recall': 0.4559387, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.55348843}
confusion matrix:
      0    1
0  5947   50
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
new oracle model saved
early stop counter: 1
val acc:0.9816943407058716, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9618088603019714 / 0.9693192839622498
after epoch: 8,now: 2024-05-25 13:51:07.017866,epoch time: 0:25:48.107360,used: 3:30:04.733675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98915327, 'precision': 0.90548575, 'recall': 0.93438977, 'specificity': 0.93438977, 'f1': 0.91939807, 'auroc': 0.99333674, 'binary_precision': 0.8153068, 'binary_recall': 0.8756794, 'binary_specificity': 0.99310017, 'binary_f1_score': 0.84441537}
confusion matrix:
       0     1
0  42028   292
1    183  1289
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.87564385, 'recall': 0.89364314, 'specificity': 0.89364314, 'f1': 0.884414, 'auroc': 0.9818772, 'binary_precision': 0.7585185, 'binary_recall': 0.7962675, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.77693474}
confusion matrix:
       0    1
0  17986  163
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.826233, 'recall': 0.5826237, 'specificity': 0.5826237, 'f1': 0.62566435, 'auroc': 0.9610704, 'binary_precision': 0.6875, 'binary_recall': 0.16858238, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27076924}
confusion matrix:
      0   1
0  5977  20
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 2
val acc:0.9843550324440002, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9618088603019714 / 0.9693192839622498
after epoch: 9,now: 2024-05-25 14:17:17.475533,epoch time: 0:26:10.457667,used: 3:56:15.191342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9883312, 'precision': 0.955591, 'recall': 0.85583675, 'specificity': 0.85583675, 'f1': 0.899138, 'auroc': 0.9917555, 'binary_precision': 0.92105263, 'binary_recall': 0.71380013, 'binary_specificity': 0.9978734, 'binary_f1_score': 0.8042896}
confusion matrix:
       0     1
0  42231    90
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.9418665, 'recall': 0.7935276, 'specificity': 0.7935276, 'f1': 0.85166526, 'auroc': 0.9844209, 'binary_precision': 0.89810425, 'binary_recall': 0.58942455, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7117371}
confusion matrix:
       0    1
0  18106   43
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.826233, 'recall': 0.5826237, 'specificity': 0.5826237, 'f1': 0.62566435, 'auroc': 0.9516845, 'binary_precision': 0.6875, 'binary_recall': 0.16858238, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27076924}
confusion matrix:
      0   1
0  5977  20
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 3
val acc:0.9836632609367371, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9618088603019714 / 0.9693192839622498
after epoch: 10,now: 2024-05-25 14:43:54.971160,epoch time: 0:26:37.495627,used: 4:22:52.686969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9884454, 'precision': 0.95129275, 'recall': 0.8618015, 'specificity': 0.8618015, 'f1': 0.90126073, 'auroc': 0.99352765, 'binary_precision': 0.912041, 'binary_recall': 0.7260367, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.8084785}
confusion matrix:
       0     1
0  42218   103
1    403  1068
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.93342674, 'recall': 0.80722153, 'specificity': 0.80722153, 'f1': 0.85877776, 'auroc': 0.98267555, 'binary_precision': 0.8802661, 'binary_recall': 0.61741835, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.725777}
confusion matrix:
       0    1
0  18095   54
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.80913633, 'recall': 0.5673814, 'specificity': 0.5673814, 'f1': 0.60392404, 'auroc': 0.9599967, 'binary_precision': 0.6545454, 'binary_recall': 0.13793103, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2278481}
confusion matrix:
      0   1
0  5978  19
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 4
val acc:0.9840357303619385, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9618088603019714 / 0.9693192839622498
after epoch: 11,now: 2024-05-25 15:09:40.656198,epoch time: 0:25:45.685038,used: 4:48:38.372007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9895871, 'precision': 0.9651704, 'recall': 0.86796975, 'specificity': 0.86796975, 'f1': 0.9104922, 'auroc': 0.9948772, 'binary_precision': 0.93939394, 'binary_recall': 0.7375935, 'binary_specificity': 0.998346, 'binary_f1_score': 0.8263518}
confusion matrix:
       0     1
0  42251    70
1    386  1085
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.93974304, 'recall': 0.7826412, 'specificity': 0.7826412, 'f1': 0.84289503, 'auroc': 0.98254746, 'binary_precision': 0.89460784, 'binary_recall': 0.5676516, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.69457656}
confusion matrix:
       0    1
0  18106   43
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.80913633, 'recall': 0.5673814, 'specificity': 0.5673814, 'f1': 0.60392404, 'auroc': 0.94024295, 'binary_precision': 0.6545454, 'binary_recall': 0.13793103, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2278481}
confusion matrix:
      0   1
0  5978  19
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 5
val acc:0.9829182624816895, best validation acc: 0.984674334526062, corresponding to test acc:                         0.9618088603019714 / 0.9693192839622498
after epoch: 12,now: 2024-05-25 15:35:52.462170,epoch time: 0:26:11.805972,used: 5:14:50.177979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9915738, 'precision': 0.94105405, 'recall': 0.92744565, 'specificity': 0.92744565, 'f1': 0.93413484, 'auroc': 0.99519247, 'binary_precision': 0.88701755, 'binary_recall': 0.8586956, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.87262684}
confusion matrix:
       0     1
0  42159   161
1    208  1264
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.9121859, 'recall': 0.8898804, 'specificity': 0.8898804, 'f1': 0.90069735, 'auroc': 0.98185027, 'binary_precision': 0.83196044, 'binary_recall': 0.785381, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.80799997}
confusion matrix:
       0    1
0  18047  102
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7830517, 'recall': 0.6190202, 'specificity': 0.6190202, 'f1': 0.6640349, 'auroc': 0.9471209, 'binary_precision': 0.5981308, 'binary_recall': 0.24521072, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3478261}
confusion matrix:
      0   1
0  5954  43
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 13,now: 2024-05-25 16:01:59.282210,epoch time: 0:26:06.820040,used: 5:40:56.998019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9911628, 'precision': 0.94749963, 'recall': 0.9124793, 'specificity': 0.9124793, 'f1': 0.9292215, 'auroc': 0.99457234, 'binary_precision': 0.9009608, 'binary_recall': 0.828125, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.86300886}
confusion matrix:
       0     1
0  42186   134
1    253  1219
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.90268844, 'recall': 0.8278649, 'specificity': 0.8278649, 'f1': 0.8611373, 'auroc': 0.98417306, 'binary_precision': 0.8173077, 'binary_recall': 0.66096425, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.7308685}
confusion matrix:
       0    1
0  18054   95
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82729435, 'recall': 0.64267576, 'specificity': 0.64267576, 'f1': 0.6952431, 'auroc': 0.95212066, 'binary_precision': 0.6846847, 'binary_recall': 0.29118773, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.40860215}
confusion matrix:
      0   1
0  5962  35
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 1
val acc:0.9833439588546753, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9616490602493286 / 0.9693192839622498
after epoch: 14,now: 2024-05-25 16:27:42.496730,epoch time: 0:25:43.214520,used: 6:06:40.212539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9889934, 'precision': 0.9177139, 'recall': 0.91168475, 'specificity': 0.91168475, 'f1': 0.91467565, 'auroc': 0.99552673, 'binary_precision': 0.8413793, 'binary_recall': 0.8288044, 'binary_specificity': 0.9945652, 'binary_f1_score': 0.8350445}
confusion matrix:
       0     1
0  42090   230
1    252  1220
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9005958, 'recall': 0.83164275, 'specificity': 0.83164275, 'f1': 0.86260986, 'auroc': 0.9812124, 'binary_precision': 0.81285447, 'binary_recall': 0.6687403, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.7337884}
confusion matrix:
       0    1
0  18050   99
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79654384, 'recall': 0.5541382, 'specificity': 0.5541382, 'f1': 0.5842652, 'auroc': 0.9584155, 'binary_precision': 0.6304348, 'binary_recall': 0.11111111, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.18892507}
confusion matrix:
      0   1
0  5980  17
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 2
val acc:0.9833971858024597, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9616490602493286 / 0.9693192839622498
after epoch: 15,now: 2024-05-25 16:53:53.160604,epoch time: 0:26:10.663874,used: 6:32:50.876413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9916651, 'precision': 0.9386623, 'recall': 0.9320382, 'specificity': 0.9320382, 'f1': 0.935323, 'auroc': 0.9965502, 'binary_precision': 0.8819061, 'binary_recall': 0.8681169, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.87495714}
confusion matrix:
       0     1
0  42150   171
1    194  1277
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9149393, 'recall': 0.86993825, 'specificity': 0.86993825, 'f1': 0.891044, 'auroc': 0.9842503, 'binary_precision': 0.83887917, 'binary_recall': 0.7449456, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7891269}
confusion matrix:
       0    1
0  18057   92
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80175424, 'recall': 0.59528327, 'specificity': 0.59528327, 'f1': 0.63974494, 'auroc': 0.94614744, 'binary_precision': 0.6375, 'binary_recall': 0.1954023, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.29912022}
confusion matrix:
      0   1
0  5968  29
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 3
val acc:0.9863771796226501, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9616490602493286 / 0.9693192839622498
after epoch: 16,now: 2024-05-25 17:20:03.266897,epoch time: 0:26:10.106293,used: 6:59:00.982706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99294394, 'precision': 0.9558302, 'recall': 0.933356, 'specificity': 0.933356, 'f1': 0.9442872, 'auroc': 0.99700856, 'binary_precision': 0.91618913, 'binary_recall': 0.86947656, 'binary_specificity': 0.9972354, 'binary_f1_score': 0.89222187}
confusion matrix:
       0     1
0  42204   117
1    192  1279
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9432627, 'recall': 0.8662919, 'specificity': 0.8662919, 'f1': 0.90083873, 'auroc': 0.97678256, 'binary_precision': 0.8958333, 'binary_recall': 0.7356143, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.80785656}
confusion matrix:
       0    1
0  18094   55
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84643674, 'recall': 0.59045327, 'specificity': 0.59045327, 'f1': 0.63731325, 'auroc': 0.93416953, 'binary_precision': 0.72727275, 'binary_recall': 0.18390805, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.29357797}
confusion matrix:
      0   1
0  5979  18
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 17,now: 2024-05-25 17:46:01.321652,epoch time: 0:25:58.054755,used: 7:24:59.037461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.9692905, 'recall': 0.9294689, 'specificity': 0.9294689, 'f1': 0.9484314, 'auroc': 0.99820554, 'binary_precision': 0.9434103, 'binary_recall': 0.8607337, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.90017766}
confusion matrix:
       0     1
0  42244    76
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9392778, 'recall': 0.85765564, 'specificity': 0.85765564, 'f1': 0.8939674, 'auroc': 0.9850979, 'binary_precision': 0.88846153, 'binary_recall': 0.718507, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.79449695}
confusion matrix:
       0    1
0  18091   58
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.83966255, 'recall': 0.6467573, 'specificity': 0.6467573, 'f1': 0.7013912, 'auroc': 0.94502556, 'binary_precision': 0.7090909, 'binary_recall': 0.29885057, 'binary_specificity': 0.994664, 'binary_f1_score': 0.42048514}
confusion matrix:
      0   1
0  5965  32
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 1
val acc:0.9872817993164062, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.963087260723114 / 0.9693192839622498
after epoch: 18,now: 2024-05-25 18:12:01.075145,epoch time: 0:25:59.753493,used: 7:50:58.790954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99314946, 'precision': 0.9756508, 'recall': 0.9160735, 'specificity': 0.9160735, 'f1': 0.943726, 'auroc': 0.99831265, 'binary_precision': 0.9570648, 'binary_recall': 0.8334466, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.8909884}
confusion matrix:
       0     1
0  42266    55
1    245  1226
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.94754946, 'recall': 0.81380045, 'specificity': 0.81380045, 'f1': 0.86807835, 'auroc': 0.98042166, 'binary_precision': 0.90807176, 'binary_recall': 0.62986004, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.74380165}
confusion matrix:
       0    1
0  18108   41
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8373673, 'recall': 0.6222699, 'specificity': 0.6222699, 'f1': 0.67496884, 'auroc': 0.9625443, 'binary_precision': 0.70652175, 'binary_recall': 0.24904214, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.36827195}
confusion matrix:
      0   1
0  5970  27
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 2
val acc:0.9851532578468323, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.963087260723114 / 0.9693192839622498
after epoch: 19,now: 2024-05-25 18:38:10.891398,epoch time: 0:26:09.816253,used: 8:17:08.607207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99029505, 'precision': 0.89909625, 'recall': 0.9700614, 'specificity': 0.9700614, 'f1': 0.9314259, 'auroc': 0.99801886, 'binary_precision': 0.8, 'binary_recall': 0.94836956, 'binary_specificity': 0.9917533, 'binary_f1_score': 0.86788934}
confusion matrix:
       0     1
0  41971   349
1     76  1396
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.8894131, 'recall': 0.9150517, 'specificity': 0.9150517, 'f1': 0.9017877, 'auroc': 0.98131883, 'binary_precision': 0.7845706, 'binary_recall': 0.83825815, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.8105263}
confusion matrix:
       0    1
0  18001  148
1    104  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8385607, 'recall': 0.6749093, 'specificity': 0.6749093, 'f1': 0.7281037, 'auroc': 0.9499012, 'binary_precision': 0.70454544, 'binary_recall': 0.35632184, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.47328243}
confusion matrix:
      0   1
0  5958  39
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 3
val acc:0.9865900278091431, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.963087260723114 / 0.9693192839622498
after epoch: 20,now: 2024-05-25 19:04:16.802875,epoch time: 0:26:05.911477,used: 8:43:14.518684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991962, 'precision': 0.91594905, 'recall': 0.9718907, 'specificity': 0.9718907, 'f1': 0.94200706, 'auroc': 0.9980322, 'binary_precision': 0.83363146, 'binary_recall': 0.9503739, 'binary_specificity': 0.99340755, 'binary_f1_score': 0.8881829}
confusion matrix:
       0     1
0  42042   279
1     73  1398
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.86196303, 'recall': 0.9052032, 'specificity': 0.9052032, 'f1': 0.8822504, 'auroc': 0.98129624, 'binary_precision': 0.7302905, 'binary_recall': 0.82115084, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.77306}
confusion matrix:
       0    1
0  17954  195
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.84930927, 'recall': 0.6978144, 'specificity': 0.6978144, 'f1': 0.7505282, 'auroc': 0.958791, 'binary_precision': 0.7241379, 'binary_recall': 0.40229884, 'binary_specificity': 0.99333, 'binary_f1_score': 0.5172414}
confusion matrix:
      0    1
0  5957   40
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 4
val acc:0.9835036396980286, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.963087260723114 / 0.9693192839622498
after epoch: 21,now: 2024-05-25 19:30:10.750902,epoch time: 0:25:53.948027,used: 9:09:08.466711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99225885, 'precision': 0.9689834, 'recall': 0.9080667, 'specificity': 0.9080667, 'f1': 0.9362534, 'auroc': 0.99794614, 'binary_precision': 0.94427, 'binary_recall': 0.817811, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.87650275}
confusion matrix:
       0     1
0  42250    71
1    268  1203
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9294958, 'recall': 0.8287465, 'specificity': 0.8287465, 'f1': 0.8719194, 'auroc': 0.9793243, 'binary_precision': 0.87090164, 'binary_recall': 0.66096425, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.75154734}
confusion matrix:
       0    1
0  18086   63
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8171095, 'recall': 0.64800596, 'specificity': 0.64800596, 'f1': 0.6987484, 'auroc': 0.9302716, 'binary_precision': 0.66386557, 'binary_recall': 0.30268198, 'binary_specificity': 0.99333, 'binary_f1_score': 0.41578948}
confusion matrix:
      0   1
0  5957  40
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 5
val acc:0.9850468039512634, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.963087260723114 / 0.9693192839622498
after epoch: 22,now: 2024-05-25 19:56:18.980109,epoch time: 0:26:08.229207,used: 9:35:16.695918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99518174, 'precision': 0.96111953, 'recall': 0.965049, 'specificity': 0.965049, 'f1': 0.96307534, 'auroc': 0.99857527, 'binary_precision': 0.92457914, 'binary_recall': 0.93274456, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.92864394}
confusion matrix:
       0     1
0  42208   112
1     99  1373
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.91670287, 'recall': 0.9085705, 'specificity': 0.9085705, 'f1': 0.91259325, 'auroc': 0.98272717, 'binary_precision': 0.8396825, 'binary_recall': 0.82270604, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.83110756}
confusion matrix:
       0    1
0  18048  101
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.80651855, 'recall': 0.63834405, 'specificity': 0.63834405, 'f1': 0.6874181, 'auroc': 0.9551215, 'binary_precision': 0.6434783, 'binary_recall': 0.2835249, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.39361703}
confusion matrix:
      0   1
0  5956  41
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
better model found
persisted
after epoch: 23,now: 2024-05-25 20:22:22.713134,epoch time: 0:26:03.733025,used: 10:01:20.428943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9955928, 'precision': 0.9769875, 'recall': 0.9541145, 'specificity': 0.9541145, 'f1': 0.9652489, 'auroc': 0.99916506, 'binary_precision': 0.95711225, 'binary_recall': 0.90964675, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.93277603}
confusion matrix:
       0     1
0  42260    60
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.92682767, 'recall': 0.8811828, 'specificity': 0.8811828, 'f1': 0.90261304, 'auroc': 0.98433757, 'binary_precision': 0.8618881, 'binary_recall': 0.7667185, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.81152266}
confusion matrix:
       0    1
0  18070   79
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.80027056, 'recall': 0.62510085, 'specificity': 0.62510085, 'f1': 0.6729721, 'auroc': 0.9408653, 'binary_precision': 0.6320755, 'binary_recall': 0.256705, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.36512262}
confusion matrix:
      0   1
0  5958  39
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 1
val acc:0.9878139495849609, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 24,now: 2024-05-25 20:48:44.385263,epoch time: 0:26:21.672129,used: 10:27:42.101072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99614084, 'precision': 0.9733609, 'recall': 0.9668348, 'specificity': 0.9668348, 'f1': 0.97007346, 'auroc': 0.9992765, 'binary_precision': 0.9489655, 'binary_recall': 0.93541807, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.9421431}
confusion matrix:
       0     1
0  42247    74
1     95  1376
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.9249021, 'recall': 0.8903763, 'specificity': 0.8903763, 'f1': 0.90684915, 'auroc': 0.98293793, 'binary_precision': 0.8573854, 'binary_recall': 0.785381, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8198052}
confusion matrix:
       0    1
0  18065   84
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8227453, 'recall': 0.6444247, 'specificity': 0.6444247, 'f1': 0.69623196, 'auroc': 0.95138645, 'binary_precision': 0.6754386, 'binary_recall': 0.29501915, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.41066664}
confusion matrix:
      0   1
0  5960  37
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 2
val acc:0.9881864786148071, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 25,now: 2024-05-25 21:15:10.696474,epoch time: 0:26:26.311211,used: 10:54:08.412283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9940172, 'precision': 0.94147074, 'recall': 0.97034794, 'specificity': 0.97034794, 'f1': 0.955415, 'auroc': 0.9987285, 'binary_precision': 0.88486004, 'binary_recall': 0.9449728, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.9139291}
confusion matrix:
       0     1
0  42139   181
1     81  1391
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.89988315, 'recall': 0.9070766, 'specificity': 0.9070766, 'f1': 0.903445, 'auroc': 0.98021823, 'binary_precision': 0.80610687, 'binary_recall': 0.82115084, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.8135593}
confusion matrix:
       0    1
0  18022  127
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.94842297, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 3
val acc:0.9871221780776978, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 26,now: 2024-05-25 21:41:42.703601,epoch time: 0:26:32.007127,used: 11:20:40.419410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9962322, 'precision': 0.9674212, 'recall': 0.9750843, 'specificity': 0.9750843, 'f1': 0.9712192, 'auroc': 0.99931324, 'binary_precision': 0.93649733, 'binary_recall': 0.9524133, 'binary_specificity': 0.9977552, 'binary_f1_score': 0.9443883}
confusion matrix:
       0     1
0  42226    95
1     70  1401
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9130088, 'recall': 0.8937685, 'specificity': 0.8937685, 'f1': 0.9031402, 'auroc': 0.98140347, 'binary_precision': 0.8333333, 'binary_recall': 0.7931571, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.812749}
confusion matrix:
       0    1
0  18047  102
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7509844, 'recall': 0.56454855, 'specificity': 0.56454855, 'f1': 0.59686154, 'auroc': 0.95061195, 'binary_precision': 0.53846157, 'binary_recall': 0.13409962, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.21472393}
confusion matrix:
      0   1
0  5967  30
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 4
val acc:0.987494707107544, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 27,now: 2024-05-25 22:08:36.377380,epoch time: 0:26:53.673779,used: 11:47:34.093189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.996392, 'precision': 0.9671169, 'recall': 0.9781339, 'specificity': 0.9781339, 'f1': 0.9725561, 'auroc': 0.9989463, 'binary_precision': 0.9356764, 'binary_recall': 0.9585598, 'binary_specificity': 0.99770796, 'binary_f1_score': 0.9469799}
confusion matrix:
       0     1
0  42223    97
1     61  1411
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.90084803, 'recall': 0.90865934, 'specificity': 0.90865934, 'f1': 0.9047128, 'auroc': 0.98435557, 'binary_precision': 0.80792683, 'binary_recall': 0.82426125, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.8160123}
confusion matrix:
       0    1
0  18023  126
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.81673145, 'recall': 0.6049452, 'specificity': 0.6049452, 'f1': 0.6527469, 'auroc': 0.94114363, 'binary_precision': 0.6666667, 'binary_recall': 0.21455939, 'binary_specificity': 0.995331, 'binary_f1_score': 0.32463768}
confusion matrix:
      0   1
0  5969  28
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 5
val acc:0.9872817993164062, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 28,now: 2024-05-25 22:35:13.631585,epoch time: 0:26:37.254205,used: 12:14:11.347394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99634635, 'precision': 0.9803641, 'recall': 0.96270084, 'specificity': 0.96270084, 'f1': 0.9713546, 'auroc': 0.9993024, 'binary_precision': 0.96327686, 'binary_recall': 0.92663044, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.9445983}
confusion matrix:
       0     1
0  42268    52
1    108  1364
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.93312323, 'recall': 0.86054564, 'specificity': 0.86054564, 'f1': 0.89325863, 'auroc': 0.98066884, 'binary_precision': 0.87593985, 'binary_recall': 0.7247278, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.79319143}
confusion matrix:
       0    1
0  18083   66
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8248669, 'recall': 0.60511196, 'specificity': 0.60511196, 'f1': 0.65377706, 'auroc': 0.93326354, 'binary_precision': 0.68292683, 'binary_recall': 0.21455939, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3265306}
confusion matrix:
      0   1
0  5971  26
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 6
val acc:0.9870689511299133, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 29,now: 2024-05-25 23:01:47.691330,epoch time: 0:26:34.059745,used: 12:40:45.407139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9942227, 'precision': 0.9388646, 'recall': 0.97764003, 'specificity': 0.97764003, 'f1': 0.9573649, 'auroc': 0.99888223, 'binary_precision': 0.87912774, 'binary_recall': 0.95986396, 'binary_specificity': 0.9954161, 'binary_f1_score': 0.91772366}
confusion matrix:
       0     1
0  42128   194
1     59  1411
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.90131724, 'recall': 0.9025212, 'specificity': 0.9025212, 'f1': 0.9019183, 'auroc': 0.98300695, 'binary_precision': 0.80930233, 'binary_recall': 0.8118196, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.81055903}
confusion matrix:
       0    1
0  18026  123
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7520958, 'recall': 0.5608839, 'specificity': 0.5608839, 'f1': 0.5919875, 'auroc': 0.93476677, 'binary_precision': 0.5409836, 'binary_recall': 0.12643678, 'binary_specificity': 0.995331, 'binary_f1_score': 0.20496894}
confusion matrix:
      0   1
0  5969  28
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839955.png
early stop counter: 7
val acc:0.9870157241821289, best validation acc: 0.9885589480400085, corresponding to test acc:                         0.9635666608810425 / 0.9693192839622498
after epoch: 30,now: 2024-05-25 23:28:47.321012,epoch time: 0:26:59.629682,used: 13:07:45.036821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_02_seed_0_20839955
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:07:45.036821 at 2024-05-25 23:28:47.321012
persisted model performance metric: 

scalar performance:
{'acc': 0.965644, 'precision': 0.84345484, 'recall': 0.64309263, 'specificity': 0.64309263, 'f1': 0.698236, 'auroc': 0.9494792, 'binary_precision': 0.7169811, 'binary_recall': 0.29118773, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.41416892}
confusion matrix:
      0   1
0  5967  30
1   185  76
oracle model performance metric: 

scalar performance:
{'acc': 0.9688399, 'precision': 0.84221727, 'recall': 0.7107241, 'specificity': 0.7107241, 'f1': 0.75924325, 'auroc': 0.95825595, 'binary_precision': 0.70886075, 'binary_recall': 0.42911878, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.5346062}
confusion matrix:
      0    1
0  5951   46
1   149  112
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14472 MiB |  14472 MiB |      0 B   |
|       from large pool |  14398 MiB |  14398 MiB |  14398 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461487 KiB |   1231 MiB | 784670 GiB | 784669 GiB |
|       from large pool | 451854 KiB |   1224 MiB | 771278 GiB | 771278 GiB |
|       from small pool |   9633 KiB |     17 MiB |  13391 GiB |  13391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196391 K  |  196387 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196391 K  |  196387 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2802    |  131139 K  |  131139 K  |
|       from large pool |      37    |     602    |   79819 K  |   79819 K  |
|       from small pool |      45    |    2765    |   51319 K  |   51319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1116 TiB |   1116 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1112 TiB |   1112 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1099 TiB |   1099 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    888 MiB |  14472 MiB |  14472 MiB |  13584 MiB |
|       from large pool |    836 MiB |  14398 MiB |  14398 MiB |  13562 MiB |
|       from small pool |     52 MiB |     74 MiB |     74 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1231 MiB | 784670 GiB | 784670 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 771279 GiB | 771279 GiB |
|       from small pool |      0 KiB |     42 MiB |  13391 GiB |  13391 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     638    |     638    |     575    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      37    |      37    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  131140 K  |  131140 K  |
|       from large pool |       4    |     602    |   79819 K  |   79819 K  |
|       from small pool |       0    |    2765    |   51320 K  |   51320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 23:31:08 2024]
Finished job 0.
1 of 1 steps (100%) done
