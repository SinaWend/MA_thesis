Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:11:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954

 Experiment start at: 2024-05-25 10:21:26.206282
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9749726, 'precision': 0.8183941, 'recall': 0.767076, 'specificity': 0.767076, 'f1': 0.79028034, 'auroc': 0.97010773, 'binary_precision': 0.6525285, 'binary_recall': 0.5442177, 'binary_specificity': 0.9899343, 'binary_f1_score': 0.5934718}
confusion matrix:
       0    1
0  41896  426
1    670  800
---- Validation: 
scalar performance:
{'acc': 0.97530866, 'precision': 0.86063135, 'recall': 0.7111966, 'specificity': 0.7111966, 'f1': 0.76485914, 'auroc': 0.9683258, 'binary_precision': 0.7412399, 'binary_recall': 0.42768273, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.54240626}
confusion matrix:
       0    1
0  18053   96
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.84221727, 'recall': 0.7107241, 'specificity': 0.7107241, 'f1': 0.75924325, 'auroc': 0.9553231, 'binary_precision': 0.70886075, 'binary_recall': 0.42911878, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.5346062}
confusion matrix:
      0    1
0  5951   46
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:45:20.747929,epoch time: 0:23:54.541647,used: 0:23:54.541647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9776443, 'precision': 0.8270885, 'recall': 0.83073306, 'specificity': 0.83073306, 'f1': 0.82889974, 'auroc': 0.9756006, 'binary_precision': 0.6655474, 'binary_recall': 0.6732337, 'binary_specificity': 0.9882325, 'binary_f1_score': 0.66936845}
confusion matrix:
       0    1
0  41822  498
1    481  991
---- Validation: 
scalar performance:
{'acc': 0.9763729, 'precision': 0.82560575, 'recall': 0.80700463, 'specificity': 0.80700463, 'f1': 0.81600577, 'auroc': 0.9733377, 'binary_precision': 0.6644628, 'binary_recall': 0.62519443, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.6442308}
confusion matrix:
       0    1
0  17946  203
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.80055285, 'recall': 0.5560539, 'specificity': 0.5560539, 'f1': 0.58724535, 'auroc': 0.96011865, 'binary_precision': 0.63829786, 'binary_recall': 0.11494253, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.19480518}
confusion matrix:
      0   1
0  5980  17
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 2,now: 2024-05-25 11:07:47.631830,epoch time: 0:22:26.883901,used: 0:46:21.425548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9824397, 'precision': 0.8584746, 'recall': 0.87936395, 'specificity': 0.87936395, 'f1': 0.86859673, 'auroc': 0.9806124, 'binary_precision': 0.725, 'binary_recall': 0.7688647, 'binary_specificity': 0.9898632, 'binary_f1_score': 0.74628836}
confusion matrix:
       0     1
0  41892   429
1    340  1131
---- Validation: 
scalar performance:
{'acc': 0.9804172, 'precision': 0.8461307, 'recall': 0.86685264, 'specificity': 0.86685264, 'f1': 0.8561621, 'auroc': 0.9777887, 'binary_precision': 0.7013177, 'binary_recall': 0.7449456, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.7224736}
confusion matrix:
       0    1
0  17945  204
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8432315, 'recall': 0.72954774, 'specificity': 0.72954774, 'f1': 0.77393425, 'auroc': 0.96550304, 'binary_precision': 0.7093023, 'binary_recall': 0.46743295, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.56351036}
confusion matrix:
      0    1
0  5947   50
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-25 11:30:13.895978,epoch time: 0:22:26.264148,used: 1:08:47.689696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9842665, 'precision': 0.92221093, 'recall': 0.81743854, 'specificity': 0.81743854, 'f1': 0.8618489, 'auroc': 0.9836376, 'binary_precision': 0.8568824, 'binary_recall': 0.63858694, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.7318022}
confusion matrix:
       0    1
0  42163  157
1    532  940
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.9319833, 'recall': 0.7375952, 'specificity': 0.7375952, 'f1': 0.80463684, 'auroc': 0.97932106, 'binary_precision': 0.8821839, 'binary_recall': 0.47744945, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6195762}
confusion matrix:
       0    1
0  18108   41
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.85129416, 'recall': 0.5641336, 'specificity': 0.5641336, 'f1': 0.6009613, 'auroc': 0.9613183, 'binary_precision': 0.73913044, 'binary_recall': 0.1302682, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22149837}
confusion matrix:
      0   1
0  5985  12
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 1
val acc:0.979938268661499, best validation acc: 0.9804171919822693, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 4,now: 2024-05-25 11:52:40.370149,epoch time: 0:22:26.474171,used: 1:31:14.163867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9839925, 'precision': 0.8648844, 'recall': 0.90280557, 'specificity': 0.90280557, 'f1': 0.8828232, 'auroc': 0.9863941, 'binary_precision': 0.73619634, 'binary_recall': 0.8157716, 'binary_specificity': 0.98983955, 'binary_f1_score': 0.77394396}
confusion matrix:
       0     1
0  41891   430
1    271  1200
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.8481585, 'recall': 0.88301706, 'specificity': 0.88301706, 'f1': 0.86467767, 'auroc': 0.9814149, 'binary_precision': 0.70422536, 'binary_recall': 0.777605, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.7390983}
confusion matrix:
       0    1
0  17939  210
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.82570124, 'recall': 0.6482561, 'specificity': 0.6482561, 'f1': 0.70052856, 'auroc': 0.9651807, 'binary_precision': 0.6810345, 'binary_recall': 0.30268198, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.41909814}
confusion matrix:
      0   1
0  5960  37
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 5,now: 2024-05-25 12:15:17.699447,epoch time: 0:22:37.329298,used: 1:53:51.493165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9872123, 'precision': 0.9366555, 'recall': 0.855355, 'specificity': 0.855355, 'f1': 0.89151883, 'auroc': 0.9892429, 'binary_precision': 0.88319325, 'binary_recall': 0.71399456, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.7896319}
confusion matrix:
       0     1
0  42181   139
1    421  1051
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.9416438, 'recall': 0.78114104, 'specificity': 0.78114104, 'f1': 0.8423121, 'auroc': 0.9804636, 'binary_precision': 0.89851487, 'binary_recall': 0.5645412, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6934098}
confusion matrix:
       0    1
0  18108   41
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.81911576, 'recall': 0.54314417, 'specificity': 0.54314417, 'f1': 0.56777877, 'auroc': 0.9563591, 'binary_precision': 0.6764706, 'binary_recall': 0.08812261, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5986  11
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 6,now: 2024-05-25 12:37:34.340671,epoch time: 0:22:16.641224,used: 2:16:08.134389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98819417, 'precision': 0.9171216, 'recall': 0.8971053, 'specificity': 0.8971053, 'f1': 0.9068475, 'auroc': 0.99200815, 'binary_precision': 0.8412017, 'binary_recall': 0.7994562, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.8197978}
confusion matrix:
       0     1
0  42099   222
1    295  1176
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9125353, 'recall': 0.8721608, 'specificity': 0.8721608, 'f1': 0.89122456, 'auroc': 0.98390186, 'binary_precision': 0.83391005, 'binary_recall': 0.7496112, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7895168}
confusion matrix:
       0    1
0  18053   96
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.746382, 'recall': 0.5478908, 'specificity': 0.5478908, 'f1': 0.5733024, 'auroc': 0.9578022, 'binary_precision': 0.53061223, 'binary_recall': 0.099616855, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.16774192}
confusion matrix:
      0   1
0  5974  23
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 7,now: 2024-05-25 12:59:55.082857,epoch time: 0:22:20.742186,used: 2:38:28.876575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9883312, 'precision': 0.90988016, 'recall': 0.91068643, 'specificity': 0.91068643, 'f1': 0.9102829, 'auroc': 0.9925703, 'binary_precision': 0.8257627, 'binary_recall': 0.8274456, 'binary_specificity': 0.99392724, 'binary_f1_score': 0.82660335}
confusion matrix:
       0     1
0  42063   257
1    254  1218
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9000553, 'recall': 0.8693597, 'specificity': 0.8693597, 'f1': 0.88404393, 'auroc': 0.9826192, 'binary_precision': 0.8091216, 'binary_recall': 0.7449456, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.7757085}
confusion matrix:
       0    1
0  18036  113
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8318802, 'recall': 0.64467484, 'specificity': 0.64467484, 'f1': 0.69801366, 'auroc': 0.96780515, 'binary_precision': 0.6936937, 'binary_recall': 0.29501915, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4139785}
confusion matrix:
      0   1
0  5963  34
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.9863239526748657, corresponding to test acc:                         0.9587727785110474 / 0.9697986841201782
after epoch: 8,now: 2024-05-25 13:22:28.692936,epoch time: 0:22:33.610079,used: 3:01:02.486654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9861162, 'precision': 0.8774835, 'recall': 0.9242941, 'specificity': 0.9242941, 'f1': 0.89939964, 'auroc': 0.9916322, 'binary_precision': 0.7599278, 'binary_recall': 0.8580163, 'binary_specificity': 0.99057186, 'binary_f1_score': 0.80599874}
confusion matrix:
       0     1
0  41921   399
1    209  1263
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9007425, 'recall': 0.8917173, 'specificity': 0.8917173, 'f1': 0.89617413, 'auroc': 0.98201364, 'binary_precision': 0.8089172, 'binary_recall': 0.79004663, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.7993705}
confusion matrix:
       0    1
0  18029  120
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8603541, 'recall': 0.61519074, 'specificity': 0.61519074, 'f1': 0.6693269, 'auroc': 0.9573251, 'binary_precision': 0.75308645, 'binary_recall': 0.23371647, 'binary_specificity': 0.996665, 'binary_f1_score': 0.35672513}
confusion matrix:
      0   1
0  5977  20
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 9,now: 2024-05-25 13:44:57.414672,epoch time: 0:22:28.721736,used: 3:23:31.208390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.94684017, 'recall': 0.8891363, 'specificity': 0.8891363, 'f1': 0.9158458, 'auroc': 0.9939935, 'binary_precision': 0.90125394, 'binary_recall': 0.78125, 'binary_specificity': 0.9970227, 'binary_f1_score': 0.83697236}
confusion matrix:
       0     1
0  42194   126
1    322  1150
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.93029714, 'recall': 0.85426974, 'specificity': 0.85426974, 'f1': 0.888314, 'auroc': 0.98422617, 'binary_precision': 0.8707224, 'binary_recall': 0.7122862, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7835758}
confusion matrix:
       0    1
0  18081   68
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82802624, 'recall': 0.5676315, 'specificity': 0.5676315, 'f1': 0.60514134, 'auroc': 0.9609971, 'binary_precision': 0.6923077, 'binary_recall': 0.13793103, 'binary_specificity': 0.997332, 'binary_f1_score': 0.23003194}
confusion matrix:
      0   1
0  5981  16
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 10,now: 2024-05-25 14:07:35.806150,epoch time: 0:22:38.391478,used: 3:46:09.599868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99045485, 'precision': 0.941451, 'recall': 0.9071952, 'specificity': 0.9071952, 'f1': 0.923578, 'auroc': 0.9946099, 'binary_precision': 0.88921714, 'binary_recall': 0.8179348, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.8520878}
confusion matrix:
       0     1
0  42170   150
1    268  1204
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9110073, 'recall': 0.8620795, 'specificity': 0.8620795, 'f1': 0.8848693, 'auroc': 0.983251, 'binary_precision': 0.83156025, 'binary_recall': 0.7293935, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.77713335}
confusion matrix:
       0    1
0  18054   95
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8680667, 'recall': 0.5453934, 'specificity': 0.5453934, 'f1': 0.5722114, 'auroc': 0.9601506, 'binary_precision': 0.7741935, 'binary_recall': 0.09195402, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5990   7
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 1
val acc:0.985685408115387, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9614893198013306 / 0.9697986841201782
after epoch: 11,now: 2024-05-25 14:29:50.256055,epoch time: 0:22:14.449905,used: 4:08:24.049773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98680127, 'precision': 0.96690416, 'recall': 0.82125187, 'specificity': 0.82125187, 'f1': 0.87969506, 'auroc': 0.99366856, 'binary_precision': 0.9460539, 'binary_recall': 0.64377975, 'binary_specificity': 0.99872404, 'binary_f1_score': 0.7661812}
confusion matrix:
       0    1
0  42267   54
1    524  947
---- Validation: 
scalar performance:
{'acc': 0.9800447, 'precision': 0.951219, 'recall': 0.72714955, 'specificity': 0.72714955, 'f1': 0.79977095, 'auroc': 0.9792631, 'binary_precision': 0.9213836, 'binary_recall': 0.45567653, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.60978144}
confusion matrix:
       0    1
0  18124   25
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.78049135, 'recall': 0.53348225, 'specificity': 0.53348225, 'f1': 0.55142623, 'auroc': 0.96183246, 'binary_precision': 0.6, 'binary_recall': 0.06896552, 'binary_specificity': 0.997999, 'binary_f1_score': 0.12371134}
confusion matrix:
      0   1
0  5985  12
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 2
val acc:0.9800447225570679, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9614893198013306 / 0.9697986841201782
after epoch: 12,now: 2024-05-25 14:52:01.430758,epoch time: 0:22:11.174703,used: 4:30:35.224476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99068326, 'precision': 0.92092836, 'recall': 0.93911564, 'specificity': 0.93911564, 'f1': 0.9298138, 'auroc': 0.9954014, 'binary_precision': 0.84590375, 'binary_recall': 0.8838315, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.8644518}
confusion matrix:
       0     1
0  42083   237
1    171  1301
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.9213966, 'recall': 0.8871557, 'specificity': 0.8871557, 'f1': 0.90349233, 'auroc': 0.98433036, 'binary_precision': 0.8505942, 'binary_recall': 0.7791602, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.8133117}
confusion matrix:
       0    1
0  18061   88
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7911337, 'recall': 0.578292, 'specificity': 0.578292, 'f1': 0.61760783, 'auroc': 0.94852376, 'binary_precision': 0.61764705, 'binary_recall': 0.16091955, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.25531915}
confusion matrix:
      0   1
0  5971  26
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 13,now: 2024-05-25 15:14:20.172460,epoch time: 0:22:18.741702,used: 4:52:53.966178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9915738, 'precision': 0.9474832, 'recall': 0.9195235, 'specificity': 0.9195235, 'f1': 0.9330176, 'auroc': 0.996384, 'binary_precision': 0.90043604, 'binary_recall': 0.84228414, 'binary_specificity': 0.9967628, 'binary_f1_score': 0.87038994}
confusion matrix:
       0     1
0  42184   137
1    232  1239
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.93518686, 'recall': 0.85829544, 'specificity': 0.85829544, 'f1': 0.89272857, 'auroc': 0.98418224, 'binary_precision': 0.88022816, 'binary_recall': 0.7200622, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7921301}
confusion matrix:
       0    1
0  18086   63
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.76883256, 'recall': 0.5722948, 'specificity': 0.5722948, 'f1': 0.60824317, 'auroc': 0.94792867, 'binary_precision': 0.5735294, 'binary_recall': 0.14942528, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.23708206}
confusion matrix:
      0   1
0  5968  29
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 1
val acc:0.9870689511299133, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 14,now: 2024-05-25 15:36:35.603207,epoch time: 0:22:15.430747,used: 5:15:09.396925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9917793, 'precision': 0.9473581, 'recall': 0.9232389, 'specificity': 0.9232389, 'f1': 0.93493843, 'auroc': 0.99666166, 'binary_precision': 0.89992803, 'binary_recall': 0.8497621, 'binary_specificity': 0.9967156, 'binary_f1_score': 0.87412596}
confusion matrix:
       0     1
0  42182   139
1    221  1250
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.91747534, 'recall': 0.84688556, 'specificity': 0.84688556, 'f1': 0.878663, 'auroc': 0.9817245, 'binary_precision': 0.8455744, 'binary_recall': 0.6982893, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.76490635}
confusion matrix:
       0    1
0  18067   82
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.76665556, 'recall': 0.6203523, 'specificity': 0.6203523, 'f1': 0.6627405, 'auroc': 0.9380907, 'binary_precision': 0.5652174, 'binary_recall': 0.24904214, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.34574467}
confusion matrix:
      0   1
0  5947  50
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 2
val acc:0.9853128790855408, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 15,now: 2024-05-25 15:58:54.354554,epoch time: 0:22:18.751347,used: 5:37:28.148272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98945016, 'precision': 0.8964313, 'recall': 0.95746756, 'specificity': 0.95746756, 'f1': 0.9245759, 'auroc': 0.99658453, 'binary_precision': 0.7955477, 'binary_recall': 0.92318153, 'binary_specificity': 0.9917535, 'binary_f1_score': 0.8546255}
confusion matrix:
       0     1
0  41972   349
1    113  1358
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.86843693, 'recall': 0.91628253, 'specificity': 0.91628253, 'f1': 0.8907655, 'auroc': 0.9838878, 'binary_precision': 0.74246573, 'binary_recall': 0.8429238, 'binary_specificity': 0.9896413, 'binary_f1_score': 0.789512}
confusion matrix:
       0    1
0  17961  188
1    101  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7545267, 'recall': 0.60702574, 'specificity': 0.60702574, 'f1': 0.64723665, 'auroc': 0.9368757, 'binary_precision': 0.5420561, 'binary_recall': 0.22222222, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.3152174}
confusion matrix:
      0   1
0  5948  49
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 3
val acc:0.9846211075782776, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 16,now: 2024-05-25 16:21:10.858164,epoch time: 0:22:16.503610,used: 5:59:44.651882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98926747, 'precision': 0.9400619, 'recall': 0.88789284, 'specificity': 0.88789284, 'f1': 0.9122077, 'auroc': 0.99626607, 'binary_precision': 0.8877709, 'binary_recall': 0.77921194, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.82995653}
confusion matrix:
       0     1
0  42175   145
1    325  1147
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9151981, 'recall': 0.8298334, 'specificity': 0.8298334, 'f1': 0.8672422, 'auroc': 0.9810516, 'binary_precision': 0.8422091, 'binary_recall': 0.66407466, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.74260867}
confusion matrix:
       0    1
0  18069   80
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8170396, 'recall': 0.6124413, 'specificity': 0.6124413, 'f1': 0.66144574, 'auroc': 0.9378669, 'binary_precision': 0.6666667, 'binary_recall': 0.22988506, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34188035}
confusion matrix:
      0   1
0  5967  30
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 4
val acc:0.9842486381530762, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 17,now: 2024-05-25 16:43:30.092970,epoch time: 0:22:19.234806,used: 6:22:03.886688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9921219, 'precision': 0.9384631, 'recall': 0.9404768, 'specificity': 0.9404768, 'f1': 0.93946743, 'auroc': 0.9967369, 'binary_precision': 0.8809202, 'binary_recall': 0.88511217, 'binary_specificity': 0.9958413, 'binary_f1_score': 0.88301116}
confusion matrix:
       0     1
0  42145   176
1    169  1302
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9089582, 'recall': 0.8720231, 'specificity': 0.8720231, 'f1': 0.88954544, 'auroc': 0.9829382, 'binary_precision': 0.82675815, 'binary_recall': 0.7496112, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7862969}
confusion matrix:
       0    1
0  18048  101
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.77752817, 'recall': 0.57246155, 'specificity': 0.57246155, 'f1': 0.60905194, 'auroc': 0.9376315, 'binary_precision': 0.59090906, 'binary_recall': 0.14942528, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.23853211}
confusion matrix:
      0   1
0  5970  27
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 5
val acc:0.9860578775405884, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 18,now: 2024-05-25 17:05:43.694514,epoch time: 0:22:13.601544,used: 6:44:17.488232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99378884, 'precision': 0.9686176, 'recall': 0.933465, 'specificity': 0.933465, 'f1': 0.95030487, 'auroc': 0.99762595, 'binary_precision': 0.94178337, 'binary_recall': 0.86879677, 'binary_specificity': 0.9981333, 'binary_f1_score': 0.90381896}
confusion matrix:
       0     1
0  42242    79
1    193  1278
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.92849463, 'recall': 0.853437, 'specificity': 0.853437, 'f1': 0.8870832, 'auroc': 0.98166096, 'binary_precision': 0.86717266, 'binary_recall': 0.71073097, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7811966}
confusion matrix:
       0    1
0  18079   70
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.94030607, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 6
val acc:0.9863771796226501, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 19,now: 2024-05-25 17:27:56.094041,epoch time: 0:22:12.399527,used: 7:06:29.887759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944739, 'precision': 0.96929204, 'recall': 0.94399023, 'specificity': 0.94399023, 'f1': 0.95626414, 'auroc': 0.99807215, 'binary_precision': 0.9424046, 'binary_recall': 0.8898708, 'binary_specificity': 0.9981097, 'binary_f1_score': 0.91538465}
confusion matrix:
       0     1
0  42241    80
1    162  1309
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9248751, 'recall': 0.863353, 'specificity': 0.863353, 'f1': 0.89152336, 'auroc': 0.98410034, 'binary_precision': 0.8592322, 'binary_recall': 0.7309487, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.789916}
confusion matrix:
       0    1
0  18072   77
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7964004, 'recall': 0.6417586, 'specificity': 0.6417586, 'f1': 0.68891394, 'auroc': 0.9549936, 'binary_precision': 0.6229508, 'binary_recall': 0.29118773, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.39686683}
confusion matrix:
      0   1
0  5951  46
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 7
val acc:0.9866964817047119, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 20,now: 2024-05-25 17:50:13.441956,epoch time: 0:22:17.347915,used: 7:28:47.235674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99438256, 'precision': 0.9761761, 'recall': 0.93545604, 'specificity': 0.93545604, 'f1': 0.954839, 'auroc': 0.9980206, 'binary_precision': 0.9567809, 'binary_recall': 0.8722826, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.91257995}
confusion matrix:
       0     1
0  42262    58
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9360255, 'recall': 0.858323, 'specificity': 0.858323, 'f1': 0.89308137, 'auroc': 0.98227227, 'binary_precision': 0.8819048, 'binary_recall': 0.7200622, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7928082}
confusion matrix:
       0    1
0  18087   62
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7729066, 'recall': 0.5519723, 'specificity': 0.5519723, 'f1': 0.580252, 'auroc': 0.9586288, 'binary_precision': 0.5833333, 'binary_recall': 0.107279696, 'binary_specificity': 0.996665, 'binary_f1_score': 0.18122977}
confusion matrix:
      0   1
0  5977  20
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 8
val acc:0.9871221780776978, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 21,now: 2024-05-25 18:12:25.554350,epoch time: 0:22:12.112394,used: 7:50:59.348068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.993903, 'precision': 0.94627523, 'recall': 0.9617646, 'specificity': 0.9617646, 'f1': 0.9538773, 'auroc': 0.9986236, 'binary_precision': 0.895082, 'binary_recall': 0.9273098, 'binary_specificity': 0.9962193, 'binary_f1_score': 0.910911}
confusion matrix:
       0     1
0  42160   160
1    107  1365
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.9166595, 'recall': 0.89160097, 'specificity': 0.89160097, 'f1': 0.90370977, 'auroc': 0.98434377, 'binary_precision': 0.840796, 'binary_recall': 0.7884914, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.8138041}
confusion matrix:
       0    1
0  18053   96
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7637972, 'recall': 0.5925338, 'specificity': 0.5925338, 'f1': 0.6325826, 'auroc': 0.95164347, 'binary_precision': 0.56179774, 'binary_recall': 0.19157088, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5958  39
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 9
val acc:0.9876543283462524, best validation acc: 0.9877607226371765, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 22,now: 2024-05-25 18:34:38.730178,epoch time: 0:22:13.175828,used: 8:13:12.523896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9942912, 'precision': 0.95261455, 'recall': 0.9603261, 'specificity': 0.9603261, 'f1': 0.9564352, 'auroc': 0.99831045, 'binary_precision': 0.90787715, 'binary_recall': 0.92391306, 'binary_specificity': 0.99673915, 'binary_f1_score': 0.9158249}
confusion matrix:
       0     1
0  42182   138
1    112  1360
---- Validation: 
scalar performance:
{'acc': 0.98887825, 'precision': 0.93089825, 'recall': 0.8952348, 'specificity': 0.8952348, 'f1': 0.9122351, 'auroc': 0.98361087, 'binary_precision': 0.86904764, 'binary_recall': 0.7947123, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.8302193}
confusion matrix:
       0    1
0  18072   77
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7709805, 'recall': 0.5686301, 'specificity': 0.5686301, 'f1': 0.6035517, 'auroc': 0.9570888, 'binary_precision': 0.578125, 'binary_recall': 0.14176245, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2276923}
confusion matrix:
      0   1
0  5970  27
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
better model found
persisted
after epoch: 23,now: 2024-05-25 18:56:52.901579,epoch time: 0:22:14.171401,used: 8:35:26.695297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99465656, 'precision': 0.96307397, 'recall': 0.9539579, 'specificity': 0.9539579, 'f1': 0.9584671, 'auroc': 0.99695826, 'binary_precision': 0.9292649, 'binary_recall': 0.91032606, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.91969794}
confusion matrix:
       0     1
0  42218   102
1    132  1340
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.92654455, 'recall': 0.8757671, 'specificity': 0.8757671, 'f1': 0.8994211, 'auroc': 0.9800916, 'binary_precision': 0.86170214, 'binary_recall': 0.755832, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.8053024}
confusion matrix:
       0    1
0  18071   78
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72258896, 'recall': 0.5511386, 'specificity': 0.5511386, 'f1': 0.576993, 'auroc': 0.9176917, 'binary_precision': 0.4827586, 'binary_recall': 0.107279696, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.1755486}
confusion matrix:
      0   1
0  5967  30
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 1
val acc:0.987494707107544, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 24,now: 2024-05-25 19:19:09.331322,epoch time: 0:22:16.429743,used: 8:57:43.125040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99404, 'precision': 0.9428921, 'recall': 0.96870065, 'specificity': 0.96870065, 'f1': 0.9554015, 'auroc': 0.99899817, 'binary_precision': 0.88782054, 'binary_recall': 0.94153637, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.9138898}
confusion matrix:
       0     1
0  42146   175
1     86  1385
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.91310084, 'recall': 0.8845198, 'specificity': 0.8845198, 'f1': 0.89825606, 'auroc': 0.9828036, 'binary_precision': 0.8341709, 'binary_recall': 0.7744945, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.80322576}
confusion matrix:
       0    1
0  18050   99
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7729144, 'recall': 0.57979083, 'specificity': 0.57979083, 'f1': 0.61813736, 'auroc': 0.950204, 'binary_precision': 0.5810811, 'binary_recall': 0.16475096, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.25671643}
confusion matrix:
      0   1
0  5966  31
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 2
val acc:0.9870157241821289, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 25,now: 2024-05-25 19:41:23.427530,epoch time: 0:22:14.096208,used: 9:19:57.221248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941085, 'precision': 0.94162774, 'recall': 0.9716889, 'specificity': 0.9716889, 'f1': 0.9561234, 'auroc': 0.99876606, 'binary_precision': 0.8850794, 'binary_recall': 0.94765466, 'binary_specificity': 0.9957232, 'binary_f1_score': 0.9152987}
confusion matrix:
       0     1
0  42140   181
1     77  1394
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9056996, 'recall': 0.8819115, 'specificity': 0.8819115, 'f1': 0.8934163, 'auroc': 0.98382956, 'binary_precision': 0.81953645, 'binary_recall': 0.7698289, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7939053}
confusion matrix:
       0    1
0  18040  109
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.82854176, 'recall': 0.6126914, 'specificity': 0.6126914, 'f1': 0.6630449, 'auroc': 0.95681393, 'binary_precision': 0.6896552, 'binary_recall': 0.22988506, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3448276}
confusion matrix:
      0   1
0  5970  27
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 3
val acc:0.9863239526748657, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 26,now: 2024-05-25 20:03:38.812672,epoch time: 0:22:15.385142,used: 9:42:12.606390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99394864, 'precision': 0.93902254, 'recall': 0.9726075, 'specificity': 0.9726075, 'f1': 0.95514584, 'auroc': 0.99868226, 'binary_precision': 0.8797986, 'binary_recall': 0.94972825, 'binary_specificity': 0.9954868, 'binary_f1_score': 0.91342694}
confusion matrix:
       0     1
0  42129   191
1     74  1398
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.90163374, 'recall': 0.8956054, 'specificity': 0.8956054, 'f1': 0.89859486, 'auroc': 0.9812009, 'binary_precision': 0.81042653, 'binary_recall': 0.7978227, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.8040753}
confusion matrix:
       0    1
0  18029  120
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8242049, 'recall': 0.5732119, 'specificity': 0.5732119, 'f1': 0.6128038, 'auroc': 0.9503139, 'binary_precision': 0.68421054, 'binary_recall': 0.14942528, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.24528302}
confusion matrix:
      0   1
0  5979  18
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 4
val acc:0.9866964817047119, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 27,now: 2024-05-25 20:25:54.556195,epoch time: 0:22:15.743523,used: 10:04:28.349913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99680305, 'precision': 0.98179305, 'recall': 0.96851075, 'specificity': 0.96851075, 'f1': 0.9750521, 'auroc': 0.9991056, 'binary_precision': 0.96573424, 'binary_recall': 0.9381794, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.95175743}
confusion matrix:
       0     1
0  42271    49
1     91  1381
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9417751, 'recall': 0.86237633, 'specificity': 0.86237633, 'f1': 0.8978567, 'auroc': 0.9821953, 'binary_precision': 0.89312977, 'binary_recall': 0.7278383, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.80205655}
confusion matrix:
       0    1
0  18093   56
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8185415, 'recall': 0.59561676, 'specificity': 0.59561676, 'f1': 0.6416876, 'auroc': 0.95654356, 'binary_precision': 0.67105263, 'binary_recall': 0.1954023, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3026706}
confusion matrix:
      0   1
0  5972  25
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 5
val acc:0.9877075552940369, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 28,now: 2024-05-25 20:48:07.070855,epoch time: 0:22:12.514660,used: 10:26:40.864573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99404, 'precision': 0.977753, 'recall': 0.92834556, 'specificity': 0.92834556, 'f1': 0.9516029, 'auroc': 0.99839467, 'binary_precision': 0.96042615, 'binary_recall': 0.8579198, 'binary_specificity': 0.9987713, 'binary_f1_score': 0.9062837}
confusion matrix:
       0     1
0  42269    52
1    209  1262
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9427838, 'recall': 0.84229636, 'specificity': 0.84229636, 'f1': 0.8856275, 'auroc': 0.9812414, 'binary_precision': 0.8965517, 'binary_recall': 0.6874028, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.77816904}
confusion matrix:
       0    1
0  18098   51
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.78924245, 'recall': 0.55963516, 'specificity': 0.55963516, 'f1': 0.59203404, 'auroc': 0.9474191, 'binary_precision': 0.61538464, 'binary_recall': 0.12260536, 'binary_specificity': 0.996665, 'binary_f1_score': 0.20447284}
confusion matrix:
      0   1
0  5977  20
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 6
val acc:0.9865900278091431, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 29,now: 2024-05-25 21:10:25.790572,epoch time: 0:22:18.719717,used: 10:48:59.584290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.97826385, 'recall': 0.92061675, 'specificity': 0.92061675, 'f1': 0.9474563, 'auroc': 0.99916077, 'binary_precision': 0.96198606, 'binary_recall': 0.8423913, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.89822537}
confusion matrix:
       0     1
0  42271    49
1    232  1240
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.9481046, 'recall': 0.78594446, 'specificity': 0.78594446, 'f1': 0.8478568, 'auroc': 0.9831068, 'binary_precision': 0.9111111, 'binary_recall': 0.57387245, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.7041984}
confusion matrix:
       0    1
0  18113   36
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.80978787, 'recall': 0.6122745, 'specificity': 0.6122745, 'f1': 0.6603934, 'auroc': 0.95177126, 'binary_precision': 0.65217394, 'binary_recall': 0.22988506, 'binary_specificity': 0.994664, 'binary_f1_score': 0.33994335}
confusion matrix:
      0   1
0  5965  32
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839954.png
early stop counter: 7
val acc:0.9835036396980286, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9598913192749023 / 0.9697986841201782
after epoch: 30,now: 2024-05-25 21:33:58.113867,epoch time: 0:23:32.323295,used: 11:12:31.907585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_21_26_seed_0_20839954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:12:31.907585 at 2024-05-25 21:33:58.113867
persisted model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.8081542, 'recall': 0.58045787, 'specificity': 0.58045787, 'f1': 0.6216125, 'auroc': 0.9539263, 'binary_precision': 0.6515151, 'binary_recall': 0.16475096, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.26299694}
confusion matrix:
      0   1
0  5974  23
1   218  43
oracle model performance metric: 

scalar performance:
{'acc': 0.9693193, 'precision': 0.84643936, 'recall': 0.71463895, 'specificity': 0.71463895, 'f1': 0.7634921, 'auroc': 0.9631107, 'binary_precision': 0.7169811, 'binary_recall': 0.43678162, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.54285717}
confusion matrix:
      0    1
0  5952   45
1   147  114
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1120 TiB |   1120 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14468 MiB |  14468 MiB |  14468 MiB |      0 B   |
|       from large pool |  14394 MiB |  14394 MiB |  14394 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461487 KiB |   1247 MiB |    840 TiB |    840 TiB |
|       from large pool | 451854 KiB |   1238 MiB |    827 TiB |    827 TiB |
|       from small pool |   9633 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196391 K  |  196388 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196391 K  |  196388 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94318 K  |   94315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     600    |     600    |     600    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2804    |  138196 K  |  138196 K  |
|       from large pool |      38    |     601    |   86331 K  |   86331 K  |
|       from small pool |      42    |    2765    |   51865 K  |   51865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1120 TiB |   1120 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    888 MiB |  14468 MiB |  14468 MiB |  13580 MiB |
|       from large pool |    836 MiB |  14394 MiB |  14394 MiB |  13558 MiB |
|       from small pool |     52 MiB |     74 MiB |     74 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1247 MiB |    840 TiB |    840 TiB |
|       from large pool |  24320 KiB |   1238 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     44 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196391 K  |  196391 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94318 K  |   94318 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     600    |     600    |     563    |
|       from small pool |      26    |      37    |      37    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  138198 K  |  138198 K  |
|       from large pool |       4    |     601    |   86331 K  |   86331 K  |
|       from small pool |       0    |    2765    |   51866 K  |   51866 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 21:36:18 2024]
Finished job 0.
1 of 1 steps (100%) done
