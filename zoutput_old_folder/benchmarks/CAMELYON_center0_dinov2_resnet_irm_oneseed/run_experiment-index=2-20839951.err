Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:10:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951

 Experiment start at: 2024-05-25 10:20:26.534268
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.969789, 'precision': 0.8486208, 'recall': 0.57983404, 'specificity': 0.57983404, 'f1': 0.6245846, 'auroc': 0.9626558, 'binary_precision': 0.7256098, 'binary_recall': 0.16179469, 'binary_specificity': 0.9978734, 'binary_f1_score': 0.26459146}
confusion matrix:
       0    1
0  42231   90
1   1233  238
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.844663, 'recall': 0.5199422, 'specificity': 0.5199422, 'f1': 0.52979684, 'auroc': 0.96382076, 'binary_precision': 0.7222222, 'binary_recall': 0.04043546, 'binary_specificity': 0.999449, 'binary_f1_score': 0.076583214}
confusion matrix:
       0   1
0  18139  10
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.79785204, 'recall': 0.5130765, 'specificity': 0.5130765, 'f1': 0.51519954, 'auroc': 0.9433836, 'binary_precision': 0.6363636, 'binary_recall': 0.026819924, 'binary_specificity': 0.999333, 'binary_f1_score': 0.051470585}
confusion matrix:
      0  1
0  5993  4
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:44:28.377434,epoch time: 0:24:01.843166,used: 0:24:01.843166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9737395, 'precision': 0.93265206, 'recall': 0.62412864, 'specificity': 0.62412864, 'f1': 0.68808883, 'auroc': 0.9761741, 'binary_precision': 0.8907767, 'binary_recall': 0.24932066, 'binary_specificity': 0.99893665, 'binary_f1_score': 0.38959658}
confusion matrix:
       0    1
0  42275   45
1   1105  367
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.8546802, 'recall': 0.6719245, 'specificity': 0.6719245, 'f1': 0.72920024, 'auroc': 0.97173756, 'binary_precision': 0.73202616, 'binary_recall': 0.34836704, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.4720759}
confusion matrix:
       0    1
0  18067   82
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8222303, 'recall': 0.5244039, 'specificity': 0.5244039, 'f1': 0.53604937, 'auroc': 0.96355414, 'binary_precision': 0.68421054, 'binary_recall': 0.049808428, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.09285714}
confusion matrix:
      0   1
0  5991   6
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-25 11:04:58.895892,epoch time: 0:20:30.518458,used: 0:44:32.361624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9803845, 'precision': 0.91066235, 'recall': 0.7564154, 'specificity': 0.7564154, 'f1': 0.8144212, 'auroc': 0.9781426, 'binary_precision': 0.8379272, 'binary_recall': 0.5163044, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.63892394}
confusion matrix:
       0    1
0  42173  147
1    712  760
---- Validation: 
scalar performance:
{'acc': 0.9774372, 'precision': 0.8656215, 'recall': 0.7535516, 'specificity': 0.7535516, 'f1': 0.79861987, 'auroc': 0.97548485, 'binary_precision': 0.7482993, 'binary_recall': 0.5132193, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.6088561}
confusion matrix:
       0    1
0  18038  111
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9272781, 'recall': 0.5914538, 'specificity': 0.5914538, 'f1': 0.6434063, 'auroc': 0.96263695, 'binary_precision': 0.8888889, 'binary_recall': 0.18390805, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.3047619}
confusion matrix:
      0   1
0  5991   6
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-25 11:25:33.340607,epoch time: 0:20:34.444715,used: 1:05:06.806339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9809554, 'precision': 0.84439015, 'recall': 0.8776908, 'specificity': 0.8776908, 'f1': 0.86020046, 'auroc': 0.98165107, 'binary_precision': 0.6969136, 'binary_recall': 0.7669837, 'binary_specificity': 0.9883979, 'binary_f1_score': 0.7302717}
confusion matrix:
       0     1
0  41829   491
1    343  1129
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8711753, 'recall': 0.8711753, 'specificity': 0.8711753, 'f1': 0.8711753, 'auroc': 0.97916657, 'binary_precision': 0.7511664, 'binary_recall': 0.7511664, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.7511664}
confusion matrix:
       0    1
0  17989  160
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.7983303, 'recall': 0.6734919, 'specificity': 0.6734919, 'f1': 0.71757764, 'auroc': 0.955932, 'binary_precision': 0.62416106, 'binary_recall': 0.35632184, 'binary_specificity': 0.990662, 'binary_f1_score': 0.45365852}
confusion matrix:
      0   1
0  5941  56
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 4,now: 2024-05-25 11:46:11.453885,epoch time: 0:20:38.113278,used: 1:25:44.919617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98374134, 'precision': 0.9253254, 'recall': 0.8047082, 'specificity': 0.8047082, 'f1': 0.85432065, 'auroc': 0.983311, 'binary_precision': 0.8639847, 'binary_recall': 0.61277175, 'binary_specificity': 0.9966446, 'binary_f1_score': 0.71701115}
confusion matrix:
       0    1
0  42178  142
1    570  902
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.86030734, 'recall': 0.8032144, 'specificity': 0.8032144, 'f1': 0.8290919, 'auroc': 0.9763838, 'binary_precision': 0.7342007, 'binary_recall': 0.61430794, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.6689247}
confusion matrix:
       0    1
0  18006  143
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87894416, 'recall': 0.55872, 'specificity': 0.55872, 'f1': 0.59359205, 'auroc': 0.9622402, 'binary_precision': 0.7948718, 'binary_recall': 0.118773945, 'binary_specificity': 0.998666, 'binary_f1_score': 0.20666666}
confusion matrix:
      0   1
0  5989   8
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 1
val acc:0.9791932702064514, best validation acc: 0.9829714894294739, corresponding to test acc:                         0.964205801486969 / 0.9650048017501831
after epoch: 5,now: 2024-05-25 12:06:46.957672,epoch time: 0:20:35.503787,used: 1:46:20.423404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9856138, 'precision': 0.9004077, 'recall': 0.87092096, 'specificity': 0.87092096, 'f1': 0.88505447, 'auroc': 0.9858634, 'binary_precision': 0.8095588, 'binary_recall': 0.74796194, 'binary_specificity': 0.99388, 'binary_f1_score': 0.77754235}
confusion matrix:
       0     1
0  42061   259
1    371  1101
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9048879, 'recall': 0.8395014, 'specificity': 0.8395014, 'f1': 0.86909103, 'auroc': 0.98265046, 'binary_precision': 0.8208955, 'binary_recall': 0.6842924, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.74639523}
confusion matrix:
       0    1
0  18053   96
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7944581, 'recall': 0.5895362, 'specificity': 0.5895362, 'f1': 0.6320759, 'auroc': 0.963446, 'binary_precision': 0.6233766, 'binary_recall': 0.18390805, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.28402367}
confusion matrix:
      0   1
0  5968  29
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 6,now: 2024-05-25 12:27:23.546419,epoch time: 0:20:36.588747,used: 2:06:57.012151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9831476, 'precision': 0.89040905, 'recall': 0.8347818, 'specificity': 0.8347818, 'f1': 0.8602884, 'auroc': 0.9850912, 'binary_precision': 0.7920319, 'binary_recall': 0.6757308, 'binary_specificity': 0.9938328, 'binary_f1_score': 0.7292737}
confusion matrix:
       0    1
0  42060  261
1    477  994
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.892824, 'recall': 0.8567527, 'specificity': 0.8567527, 'f1': 0.8738474, 'auroc': 0.9828905, 'binary_precision': 0.79553264, 'binary_recall': 0.7200622, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.7559184}
confusion matrix:
       0    1
0  18030  119
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8523444, 'recall': 0.70356154, 'specificity': 0.70356154, 'f1': 0.756088, 'auroc': 0.9594095, 'binary_precision': 0.7297297, 'binary_recall': 0.41379312, 'binary_specificity': 0.99333, 'binary_f1_score': 0.52811736}
confusion matrix:
      0    1
0  5957   40
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
new oracle model saved
early stop counter: 1
val acc:0.9840889573097229, best validation acc: 0.9840889573097229, corresponding to test acc:                         0.9613295197486877 / 0.9691594839096069
after epoch: 7,now: 2024-05-25 12:47:52.055397,epoch time: 0:20:28.508978,used: 2:27:25.521129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873949, 'precision': 0.9231305, 'recall': 0.87405354, 'specificity': 0.87405354, 'f1': 0.8969629, 'auroc': 0.98769283, 'binary_precision': 0.8548263, 'binary_recall': 0.7525493, 'binary_specificity': 0.9955578, 'binary_f1_score': 0.8004338}
confusion matrix:
       0     1
0  42133   188
1    364  1107
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9143745, 'recall': 0.8367492, 'specificity': 0.8367492, 'f1': 0.87123406, 'auroc': 0.9823788, 'binary_precision': 0.84007704, 'binary_recall': 0.67807156, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7504303}
confusion matrix:
       0    1
0  18066   83
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8388765, 'recall': 0.65425336, 'specificity': 0.65425336, 'f1': 0.70873326, 'auroc': 0.96560466, 'binary_precision': 0.70689654, 'binary_recall': 0.31417623, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.43501326}
confusion matrix:
      0   1
0  5963  34
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 8,now: 2024-05-25 13:08:21.311082,epoch time: 0:20:29.255685,used: 2:47:54.776814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.896142, 'recall': 0.84206164, 'specificity': 0.84206164, 'f1': 0.86696076, 'auroc': 0.98694444, 'binary_precision': 0.80300635, 'binary_recall': 0.6900068, 'binary_specificity': 0.9941164, 'binary_f1_score': 0.74223036}
confusion matrix:
       0     1
0  42072   249
1    456  1015
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.8796822, 'recall': 0.82240033, 'specificity': 0.82240033, 'f1': 0.8485079, 'auroc': 0.98037505, 'binary_precision': 0.77163905, 'binary_recall': 0.65163296, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7065767}
confusion matrix:
       0    1
0  18025  124
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.85729635, 'recall': 0.7658628, 'specificity': 0.7658628, 'f1': 0.8041705, 'auroc': 0.96822035, 'binary_precision': 0.734375, 'binary_recall': 0.54022986, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.6225166}
confusion matrix:
      0    1
0  5946   51
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
new oracle model saved
early stop counter: 1
val acc:0.9814814925193787, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9659635424613953 / 0.9726749658584595
after epoch: 9,now: 2024-05-25 13:29:03.689145,epoch time: 0:20:42.378063,used: 3:08:37.154877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9854768, 'precision': 0.96738935, 'recall': 0.7997047, 'specificity': 0.7997047, 'f1': 0.8639872, 'auroc': 0.9895551, 'binary_precision': 0.94849783, 'binary_recall': 0.6005435, 'binary_specificity': 0.9988658, 'binary_f1_score': 0.735441}
confusion matrix:
       0    1
0  42272   48
1    588  884
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.9411838, 'recall': 0.77880824, 'specificity': 0.77880824, 'f1': 0.8403941, 'auroc': 0.9821888, 'binary_precision': 0.8977556, 'binary_recall': 0.5598756, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6896552}
confusion matrix:
       0    1
0  18108   41
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.870243, 'recall': 0.6399282, 'specificity': 0.6399282, 'f1': 0.69868845, 'auroc': 0.9631353, 'binary_precision': 0.7708333, 'binary_recall': 0.2835249, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.41456583}
confusion matrix:
      0   1
0  5975  22
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 2
val acc:0.982758641242981, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9659635424613953 / 0.9726749658584595
after epoch: 10,now: 2024-05-25 13:49:36.333391,epoch time: 0:20:32.644246,used: 3:29:09.799123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98762333, 'precision': 0.9314592, 'recall': 0.86826605, 'specificity': 0.86826605, 'f1': 0.8971743, 'auroc': 0.9901809, 'binary_precision': 0.8718975, 'binary_recall': 0.7403127, 'binary_specificity': 0.9962194, 'binary_f1_score': 0.8007353}
confusion matrix:
       0     1
0  42161   160
1    382  1089
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.88241905, 'recall': 0.8432579, 'specificity': 0.8432579, 'f1': 0.86169183, 'auroc': 0.97854716, 'binary_precision': 0.77565217, 'binary_recall': 0.69362366, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.73234814}
confusion matrix:
       0    1
0  18020  129
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.85826963, 'recall': 0.63401437, 'specificity': 0.63401437, 'f1': 0.69063884, 'auroc': 0.95981807, 'binary_precision': 0.7473684, 'binary_recall': 0.27203065, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3988764}
confusion matrix:
      0   1
0  5973  24
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 3
val acc:0.9826521873474121, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9659635424613953 / 0.9726749658584595
after epoch: 11,now: 2024-05-25 14:10:06.265760,epoch time: 0:20:29.932369,used: 3:49:39.731492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98819417, 'precision': 0.9737636, 'recall': 0.8382675, 'specificity': 0.8382675, 'f1': 0.8939324, 'auroc': 0.99193305, 'binary_precision': 0.95861405, 'binary_recall': 0.67755103, 'binary_specificity': 0.998984, 'binary_f1_score': 0.7939418}
confusion matrix:
       0    1
0  42279   43
1    474  996
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.95060575, 'recall': 0.8007189, 'specificity': 0.8007189, 'f1': 0.8596519, 'auroc': 0.9821992, 'binary_precision': 0.9150943, 'binary_recall': 0.60342145, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.7272727}
confusion matrix:
       0    1
0  18113   36
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.81044894, 'recall': 0.5505569, 'specificity': 0.5505569, 'f1': 0.5792517, 'auroc': 0.9680351, 'binary_precision': 0.6585366, 'binary_recall': 0.10344828, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.17880796}
confusion matrix:
      0   1
0  5983  14
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 4
val acc:0.9845147132873535, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9659635424613953 / 0.9726749658584595
after epoch: 12,now: 2024-05-25 14:30:28.565677,epoch time: 0:20:22.299917,used: 4:10:02.031409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9901352, 'precision': 0.93663406, 'recall': 0.90735763, 'specificity': 0.90735763, 'f1': 0.9214483, 'auroc': 0.9918939, 'binary_precision': 0.879562, 'binary_recall': 0.8186141, 'binary_specificity': 0.99610114, 'binary_f1_score': 0.8479944}
confusion matrix:
       0     1
0  42155   165
1    267  1205
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.889853, 'recall': 0.86816883, 'specificity': 0.86816883, 'f1': 0.87867427, 'auroc': 0.9847159, 'binary_precision': 0.7887789, 'binary_recall': 0.7433904, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.76541233}
confusion matrix:
       0    1
0  18021  128
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8841443, 'recall': 0.5701309, 'specificity': 0.5701309, 'f1': 0.610979, 'auroc': 0.95917976, 'binary_precision': 0.8043478, 'binary_recall': 0.14176245, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.24104235}
confusion matrix:
      0   1
0  5988   9
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 5
val acc:0.9844082593917847, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9659635424613953 / 0.9726749658584595
after epoch: 13,now: 2024-05-25 14:50:53.955168,epoch time: 0:20:25.389491,used: 4:30:27.420900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9907974, 'precision': 0.91811, 'recall': 0.94573194, 'specificity': 0.94573194, 'f1': 0.93144244, 'auroc': 0.99564886, 'binary_precision': 0.83979654, 'binary_recall': 0.8974185, 'binary_specificity': 0.9940454, 'binary_f1_score': 0.8676519}
confusion matrix:
       0     1
0  42068   252
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.8873689, 'recall': 0.9041928, 'specificity': 0.9041928, 'f1': 0.89558625, 'auroc': 0.983884, 'binary_precision': 0.78125, 'binary_recall': 0.8164852, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.7984791}
confusion matrix:
       0    1
0  18002  147
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8157636, 'recall': 0.68723536, 'specificity': 0.68723536, 'f1': 0.73333126, 'auroc': 0.9594928, 'binary_precision': 0.65789473, 'binary_recall': 0.38314176, 'binary_specificity': 0.991329, 'binary_f1_score': 0.48426148}
confusion matrix:
      0    1
0  5945   52
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 14,now: 2024-05-25 15:11:27.050842,epoch time: 0:20:33.095674,used: 4:51:00.516574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9920077, 'precision': 0.95062166, 'recall': 0.923357, 'specificity': 0.923357, 'f1': 0.93653125, 'auroc': 0.99553686, 'binary_precision': 0.90645397, 'binary_recall': 0.8497621, 'binary_specificity': 0.9969519, 'binary_f1_score': 0.87719303}
confusion matrix:
       0     1
0  42192   129
1    221  1250
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9226728, 'recall': 0.8601875, 'specificity': 0.8601875, 'f1': 0.888739, 'auroc': 0.9820613, 'binary_precision': 0.85504586, 'binary_recall': 0.7247278, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.78451174}
confusion matrix:
       0    1
0  18070   79
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8717683, 'recall': 0.63618016, 'specificity': 0.63618016, 'f1': 0.6947564, 'auroc': 0.966038, 'binary_precision': 0.7741935, 'binary_recall': 0.27586207, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.40677965}
confusion matrix:
      0   1
0  5976  21
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 15,now: 2024-05-25 15:31:54.978824,epoch time: 0:20:27.927982,used: 5:11:28.444556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.9380692, 'recall': 0.9280069, 'specificity': 0.9280069, 'f1': 0.93297493, 'auroc': 0.9959464, 'binary_precision': 0.88100207, 'binary_recall': 0.8600544, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.8704022}
confusion matrix:
       0     1
0  42149   171
1    206  1266
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.91821325, 'recall': 0.87854695, 'specificity': 0.87854695, 'f1': 0.89731264, 'auroc': 0.98415154, 'binary_precision': 0.8448276, 'binary_recall': 0.7620529, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.8013083}
confusion matrix:
       0    1
0  18059   90
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8052292, 'recall': 0.6046951, 'specificity': 0.6046951, 'f1': 0.651222, 'auroc': 0.94868875, 'binary_precision': 0.6436782, 'binary_recall': 0.21455939, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3218391}
confusion matrix:
      0   1
0  5966  31
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 16,now: 2024-05-25 15:52:20.917043,epoch time: 0:20:25.938219,used: 5:31:54.382775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99321795, 'precision': 0.9494725, 'recall': 0.9456371, 'specificity': 0.9456371, 'f1': 0.9475459, 'auroc': 0.99661374, 'binary_precision': 0.9026063, 'binary_recall': 0.8946295, 'binary_specificity': 0.9966447, 'binary_f1_score': 0.8986002}
confusion matrix:
       0     1
0  42179   142
1    155  1316
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.9222054, 'recall': 0.89490426, 'specificity': 0.89490426, 'f1': 0.90806156, 'auroc': 0.98313594, 'binary_precision': 0.8516667, 'binary_recall': 0.7947123, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.82220435}
confusion matrix:
       0    1
0  18060   89
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.86174977, 'recall': 0.5944514, 'specificity': 0.5944514, 'f1': 0.64359355, 'auroc': 0.9610957, 'binary_precision': 0.75757575, 'binary_recall': 0.19157088, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3058104}
confusion matrix:
      0   1
0  5981  16
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
better model found
persisted
after epoch: 17,now: 2024-05-25 16:12:51.435574,epoch time: 0:20:30.518531,used: 5:52:24.901306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98979264, 'precision': 0.9626473, 'recall': 0.87373877, 'specificity': 0.87373877, 'f1': 0.9131242, 'auroc': 0.99673486, 'binary_precision': 0.9339543, 'binary_recall': 0.7493206, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.8315115}
confusion matrix:
       0     1
0  42242    78
1    369  1103
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.9287133, 'recall': 0.80322325, 'specificity': 0.80322325, 'f1': 0.854412, 'auroc': 0.98374194, 'binary_precision': 0.8711111, 'binary_recall': 0.6096423, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.71729183}
confusion matrix:
       0    1
0  18091   58
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8444811, 'recall': 0.6261847, 'specificity': 0.6261847, 'f1': 0.68022096, 'auroc': 0.9664623, 'binary_precision': 0.72043014, 'binary_recall': 0.256705, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3785311}
confusion matrix:
      0   1
0  5971  26
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 1
val acc:0.9835568070411682, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 18,now: 2024-05-25 16:33:30.924482,epoch time: 0:20:39.488908,used: 6:13:04.390214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9923274, 'precision': 0.95885146, 'recall': 0.9195853, 'specificity': 0.9195853, 'f1': 0.93827426, 'auroc': 0.9971527, 'binary_precision': 0.92319167, 'binary_recall': 0.84160435, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.88051206}
confusion matrix:
       0     1
0  42218   103
1    233  1238
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.9437382, 'recall': 0.8639867, 'specificity': 0.8639867, 'f1': 0.8996254, 'auroc': 0.9813645, 'binary_precision': 0.89694655, 'binary_recall': 0.7309487, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.8054841}
confusion matrix:
       0    1
0  18095   54
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8385618, 'recall': 0.55647075, 'specificity': 0.55647075, 'f1': 0.58906144, 'auroc': 0.9592968, 'binary_precision': 0.71428573, 'binary_recall': 0.11494253, 'binary_specificity': 0.997999, 'binary_f1_score': 0.19801979}
confusion matrix:
      0   1
0  5985  12
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 2
val acc:0.9879204034805298, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 19,now: 2024-05-25 16:54:07.935659,epoch time: 0:20:37.011177,used: 6:33:41.401391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.993629, 'precision': 0.9729152, 'recall': 0.9265418, 'specificity': 0.9265418, 'f1': 0.94844425, 'auroc': 0.9978998, 'binary_precision': 0.95086926, 'binary_recall': 0.85461956, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.9001789}
confusion matrix:
       0     1
0  42255    65
1    214  1258
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9493071, 'recall': 0.8548758, 'specificity': 0.8548758, 'f1': 0.8961327, 'auroc': 0.98307395, 'binary_precision': 0.90873015, 'binary_recall': 0.7122862, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7986051}
confusion matrix:
       0    1
0  18103   46
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.86327803, 'recall': 0.67374396, 'specificity': 0.67374396, 'f1': 0.7320081, 'auroc': 0.96613616, 'binary_precision': 0.75409836, 'binary_recall': 0.35249043, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.48041773}
confusion matrix:
      0   1
0  5967  30
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 3
val acc:0.9877075552940369, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 20,now: 2024-05-25 17:14:41.715632,epoch time: 0:20:33.779973,used: 6:54:15.181364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9905919, 'precision': 0.9730617, 'recall': 0.8774309, 'specificity': 0.8774309, 'f1': 0.91948545, 'auroc': 0.99619675, 'binary_precision': 0.95454544, 'binary_recall': 0.7561141, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.8438211}
confusion matrix:
       0     1
0  42267    53
1    359  1113
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.94748044, 'recall': 0.8254094, 'specificity': 0.8254094, 'f1': 0.8761008, 'auroc': 0.982809, 'binary_precision': 0.90712744, 'binary_recall': 0.65318817, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.75949365}
confusion matrix:
       0    1
0  18106   43
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.89727205, 'recall': 0.60061544, 'specificity': 0.60061544, 'f1': 0.6540949, 'auroc': 0.9590355, 'binary_precision': 0.828125, 'binary_recall': 0.20306513, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.32615384}
confusion matrix:
      0   1
0  5986  11
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 4
val acc:0.9858450293540955, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 21,now: 2024-05-25 17:35:10.772862,epoch time: 0:20:29.057230,used: 7:14:44.238594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.992236, 'precision': 0.9442948, 'recall': 0.9349583, 'specificity': 0.9349583, 'f1': 0.93957305, 'auroc': 0.9968804, 'binary_precision': 0.89298123, 'binary_recall': 0.8735554, 'binary_specificity': 0.99636114, 'binary_f1_score': 0.8831615}
confusion matrix:
       0     1
0  42167   154
1    186  1285
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.92134047, 'recall': 0.868631, 'specificity': 0.868631, 'f1': 0.8930867, 'auroc': 0.98471564, 'binary_precision': 0.8517857, 'binary_recall': 0.7418352, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7930175}
confusion matrix:
       0    1
0  18066   83
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.85855633, 'recall': 0.63967806, 'specificity': 0.63967806, 'f1': 0.6968356, 'auroc': 0.9588529, 'binary_precision': 0.74747473, 'binary_recall': 0.2835249, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.4111111}
confusion matrix:
      0   1
0  5972  25
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 5
val acc:0.9867497086524963, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 22,now: 2024-05-25 17:55:36.889618,epoch time: 0:20:26.116756,used: 7:35:10.355350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99381167, 'precision': 0.9805995, 'recall': 0.92199373, 'specificity': 0.92199373, 'f1': 0.949255, 'auroc': 0.9978639, 'binary_precision': 0.966563, 'binary_recall': 0.8450034, 'binary_specificity': 0.998984, 'binary_f1_score': 0.9017048}
confusion matrix:
       0     1
0  42278    43
1    228  1243
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.96124566, 'recall': 0.8467078, 'specificity': 0.8467078, 'f1': 0.89526916, 'auroc': 0.9792906, 'binary_precision': 0.93319416, 'binary_recall': 0.69517887, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.79679143}
confusion matrix:
       0    1
0  18117   32
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.9556408, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 6
val acc:0.9878671765327454, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 23,now: 2024-05-25 18:16:00.171245,epoch time: 0:20:23.281627,used: 7:55:33.636977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902722, 'precision': 0.9559761, 'recall': 0.8879342, 'specificity': 0.8879342, 'f1': 0.9190083, 'auroc': 0.9966984, 'binary_precision': 0.91961414, 'binary_recall': 0.77823126, 'binary_specificity': 0.99763715, 'binary_f1_score': 0.84303606}
confusion matrix:
       0     1
0  42222   100
1    326  1144
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.91538036, 'recall': 0.830611, 'specificity': 0.830611, 'f1': 0.867802, 'auroc': 0.9824765, 'binary_precision': 0.8425197, 'binary_recall': 0.66562986, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7437011}
confusion matrix:
       0    1
0  18069   80
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82423544, 'recall': 0.6463404, 'specificity': 0.6463404, 'f1': 0.6983859, 'auroc': 0.96226865, 'binary_precision': 0.67826086, 'binary_recall': 0.29885057, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.4148936}
confusion matrix:
      0   1
0  5960  37
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 7
val acc:0.9843018054962158, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 24,now: 2024-05-25 18:36:23.130348,epoch time: 0:20:22.959103,used: 8:15:56.596080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9931951, 'precision': 0.96649754, 'recall': 0.9259895, 'specificity': 0.9259895, 'f1': 0.94525516, 'auroc': 0.9975417, 'binary_precision': 0.9380597, 'binary_recall': 0.8539402, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.89402556}
confusion matrix:
       0     1
0  42237    83
1    215  1257
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9289995, 'recall': 0.84341073, 'specificity': 0.84341073, 'f1': 0.88109785, 'auroc': 0.978074, 'binary_precision': 0.86888456, 'binary_recall': 0.6905132, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7694974}
confusion matrix:
       0    1
0  18082   67
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.87630916, 'recall': 0.64950675, 'specificity': 0.64950675, 'f1': 0.7098397, 'auroc': 0.9533279, 'binary_precision': 0.7821782, 'binary_recall': 0.30268198, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43646407}
confusion matrix:
      0   1
0  5975  22
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 8
val acc:0.9858450293540955, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 25,now: 2024-05-25 18:56:47.747515,epoch time: 0:20:24.617167,used: 8:36:21.213247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.9630377, 'recall': 0.9536183, 'specificity': 0.9536183, 'f1': 0.9582758, 'auroc': 0.9989557, 'binary_precision': 0.92921585, 'binary_recall': 0.90964675, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.91932714}
confusion matrix:
       0     1
0  42218   102
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.93025523, 'recall': 0.8751273, 'specificity': 0.8751273, 'f1': 0.9006556, 'auroc': 0.9848001, 'binary_precision': 0.8691756, 'binary_recall': 0.7542768, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.8076603}
confusion matrix:
       0    1
0  18076   73
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8244326, 'recall': 0.6725767, 'specificity': 0.6725767, 'f1': 0.7229502, 'auroc': 0.95911205, 'binary_precision': 0.6764706, 'binary_recall': 0.35249043, 'binary_specificity': 0.992663, 'binary_f1_score': 0.4634761}
confusion matrix:
      0   1
0  5953  44
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 9
val acc:0.9877075552940369, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 26,now: 2024-05-25 19:17:17.021925,epoch time: 0:20:29.274410,used: 8:56:50.487657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.995844, 'precision': 0.9745066, 'recall': 0.9608016, 'specificity': 0.9608016, 'f1': 0.9675461, 'auroc': 0.9989877, 'binary_precision': 0.95168066, 'binary_recall': 0.9232337, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.9372414}
confusion matrix:
       0     1
0  42251    69
1    113  1359
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9300566, 'recall': 0.8782102, 'specificity': 0.8782102, 'f1': 0.90233886, 'auroc': 0.9826945, 'binary_precision': 0.86856127, 'binary_recall': 0.7604977, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.8109453}
confusion matrix:
       0    1
0  18075   74
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8186884, 'recall': 0.6031129, 'specificity': 0.6031129, 'f1': 0.6507795, 'auroc': 0.9553097, 'binary_precision': 0.6707317, 'binary_recall': 0.21072797, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.32069972}
confusion matrix:
      0   1
0  5970  27
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 10
val acc:0.9878671765327454, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 27,now: 2024-05-25 19:37:43.357569,epoch time: 0:20:26.335644,used: 9:17:16.823301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99465656, 'precision': 0.9784678, 'recall': 0.937523, 'specificity': 0.937523, 'f1': 0.9570124, 'auroc': 0.9987544, 'binary_precision': 0.96122295, 'binary_recall': 0.87627465, 'binary_specificity': 0.9987713, 'binary_f1_score': 0.9167852}
confusion matrix:
       0     1
0  42269    52
1    182  1289
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.93460804, 'recall': 0.85054696, 'specificity': 0.85054696, 'f1': 0.8877326, 'auroc': 0.98106587, 'binary_precision': 0.8796117, 'binary_recall': 0.7045101, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.78238344}
confusion matrix:
       0    1
0  18087   62
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.87047905, 'recall': 0.6928177, 'specificity': 0.6928177, 'f1': 0.7510462, 'auroc': 0.96309924, 'binary_precision': 0.7669173, 'binary_recall': 0.3908046, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.5177665}
confusion matrix:
      0    1
0  5966   31
1   159  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 11
val acc:0.9865900278091431, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 28,now: 2024-05-25 19:58:07.730076,epoch time: 0:20:24.372507,used: 9:37:41.195808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99438256, 'precision': 0.9632138, 'recall': 0.94922614, 'specificity': 0.94922614, 'f1': 0.9561045, 'auroc': 0.9979804, 'binary_precision': 0.92987376, 'binary_recall': 0.9008152, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.91511387}
confusion matrix:
       0     1
0  42220   100
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.93752295, 'recall': 0.8715148, 'specificity': 0.8715148, 'f1': 0.90161717, 'auroc': 0.98093784, 'binary_precision': 0.8839779, 'binary_recall': 0.7465008, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.80944353}
confusion matrix:
       0    1
0  18086   63
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7923224, 'recall': 0.5820401, 'specificity': 0.5820401, 'f1': 0.622517, 'auroc': 0.9421303, 'binary_precision': 0.6197183, 'binary_recall': 0.16858238, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.26506025}
confusion matrix:
      0   1
0  5970  27
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 12
val acc:0.9879736304283142, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 29,now: 2024-05-25 20:18:31.304891,epoch time: 0:20:23.574815,used: 9:58:04.770623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921219, 'precision': 0.92065024, 'recall': 0.9670723, 'specificity': 0.9670723, 'f1': 0.94254506, 'auroc': 0.99850833, 'binary_precision': 0.8433882, 'binary_recall': 0.9402174, 'binary_specificity': 0.99392724, 'binary_f1_score': 0.8891744}
confusion matrix:
       0     1
0  42063   257
1     88  1384
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.87349963, 'recall': 0.9081146, 'specificity': 0.9081146, 'f1': 0.88997054, 'auroc': 0.9818002, 'binary_precision': 0.7531915, 'binary_recall': 0.8258165, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.7878338}
confusion matrix:
       0    1
0  17975  174
1    112  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.8838117, 'recall': 0.7158896, 'specificity': 0.7158896, 'f1': 0.7741741, 'auroc': 0.9503673, 'binary_precision': 0.7916667, 'binary_recall': 0.43678162, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.56296295}
confusion matrix:
      0    1
0  5967   30
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839951.png
early stop counter: 13
val acc:0.9847807288169861, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9637264013290405 / 0.9726749658584595
after epoch: 30,now: 2024-05-25 20:38:55.964524,epoch time: 0:20:24.659633,used: 10:18:29.430256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_20_26_seed_0_20839951
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:18:29.430256 at 2024-05-25 20:38:55.964524
persisted model performance metric: 

scalar performance:
{'acc': 0.964046, 'precision': 0.86176467, 'recall': 0.6001152, 'specificity': 0.6001152, 'f1': 0.6508882, 'auroc': 0.96651965, 'binary_precision': 0.75714284, 'binary_recall': 0.20306513, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3202417}
confusion matrix:
      0   1
0  5980  17
1   208  53
oracle model performance metric: 

scalar performance:
{'acc': 0.971876, 'precision': 0.8489958, 'recall': 0.7636136, 'specificity': 0.7636136, 'f1': 0.79972064, 'auroc': 0.97120357, 'binary_precision': 0.71794873, 'binary_recall': 0.5363985, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.61403507}
confusion matrix:
      0    1
0  5942   55
1   121  140
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 447825 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 447825 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool | 404210 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |  43615 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |  13206 MiB |   1120 TiB |   1120 TiB |
|       from large pool | 396800 KiB |  13167 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  42606 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14468 MiB |  14468 MiB |  14468 MiB |      0 B   |
|       from large pool |  14394 MiB |  14394 MiB |  14394 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 463535 KiB |   1247 MiB |    840 TiB |    840 TiB |
|       from large pool | 451854 KiB |   1238 MiB |    827 TiB |    827 TiB |
|       from small pool |  11681 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  196392 K  |  196389 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94319 K  |   94316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  196392 K  |  196389 K  |
|       from large pool |     182    |    1409    |  102072 K  |  102072 K  |
|       from small pool |    3306    |    6295    |   94319 K  |   94316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     600    |     600    |     600    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2805    |  137749 K  |  137749 K  |
|       from large pool |      38    |     601    |   86331 K  |   86331 K  |
|       from small pool |      45    |    2766    |   51418 K  |   51418 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13211 MiB |   1122 TiB |   1122 TiB |
|       from large pool |  16640 KiB |  13171 MiB |   1109 TiB |   1109 TiB |
|       from small pool |      0 KiB |     63 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13206 MiB |   1120 TiB |   1120 TiB |
|       from large pool |  16640 KiB |  13167 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     62 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    890 MiB |  14468 MiB |  14468 MiB |  13578 MiB |
|       from large pool |    836 MiB |  14394 MiB |  14394 MiB |  13558 MiB |
|       from small pool |     54 MiB |     74 MiB |     74 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1247 MiB |    840 TiB |    840 TiB |
|       from large pool |  24320 KiB |   1238 MiB |    827 TiB |    827 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  196392 K  |  196392 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94319 K  |   94319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  196392 K  |  196392 K  |
|       from large pool |       2    |    1409    |  102072 K  |  102072 K  |
|       from small pool |       0    |    6295    |   94319 K  |   94319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      37    |     600    |     600    |     563    |
|       from small pool |      27    |      37    |      37    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  137751 K  |  137751 K  |
|       from large pool |       4    |     601    |   86331 K  |   86331 K  |
|       from small pool |       0    |    2766    |   51419 K  |   51419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 20:40:58 2024]
Finished job 0.
1 of 1 steps (100%) done
