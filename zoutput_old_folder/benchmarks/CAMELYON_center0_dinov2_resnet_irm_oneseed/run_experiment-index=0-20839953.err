Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat May 25 10:11:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953

 Experiment start at: 2024-05-25 10:22:14.463980
before training, model accuracy: 0.6481304168701172
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9707709, 'precision': 0.7707194, 'recall': 0.8340619, 'specificity': 0.8340619, 'f1': 0.79870164, 'auroc': 0.9682603, 'binary_precision': 0.5524017, 'binary_recall': 0.6875, 'binary_specificity': 0.98062384, 'binary_f1_score': 0.61259073}
confusion matrix:
       0     1
0  41500   820
1    460  1012
---- Validation: 
scalar performance:
{'acc': 0.97498935, 'precision': 0.8038779, 'recall': 0.84379107, 'specificity': 0.84379107, 'f1': 0.8224766, 'auroc': 0.9729432, 'binary_precision': 0.6183311, 'binary_recall': 0.7029549, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.65793306}
confusion matrix:
       0    1
0  17870  279
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8170707, 'recall': 0.81241965, 'specificity': 0.81241965, 'f1': 0.8147259, 'auroc': 0.95934176, 'binary_precision': 0.6498054, 'binary_recall': 0.63984674, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.64478767}
confusion matrix:
      0    1
0  5907   90
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-25 10:43:44.846168,epoch time: 0:21:30.382188,used: 0:21:30.382188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9739222, 'precision': 0.8488919, 'recall': 0.6812707, 'specificity': 0.6812707, 'f1': 0.73656607, 'auroc': 0.9559605, 'binary_precision': 0.7194149, 'binary_recall': 0.3675272, 'binary_specificity': 0.9950142, 'binary_f1_score': 0.4865108}
confusion matrix:
       0    1
0  42109  211
1    931  541
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.8264346, 'recall': 0.6505985, 'specificity': 0.6505985, 'f1': 0.7035538, 'auroc': 0.8898904, 'binary_precision': 0.67697597, 'binary_recall': 0.30637637, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.42184156}
confusion matrix:
       0    1
0  18055   94
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9019265, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 1
val acc:0.9712643623352051, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9705976247787476 / 0.9705976247787476
after epoch: 2,now: 2024-05-25 11:04:23.490234,epoch time: 0:20:38.644066,used: 0:42:09.026254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9716158, 'precision': 0.7803153, 'recall': 0.7918774, 'specificity': 0.7918774, 'f1': 0.78596723, 'auroc': 0.97467625, 'binary_precision': 0.5745928, 'binary_recall': 0.5991848, 'binary_specificity': 0.98456997, 'binary_f1_score': 0.58663124}
confusion matrix:
       0    1
0  41667  653
1    590  882
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.78828454, 'recall': 0.7700777, 'specificity': 0.7700777, 'f1': 0.77885383, 'auroc': 0.96866226, 'binary_precision': 0.5923461, 'binary_recall': 0.55365473, 'binary_specificity': 0.9865006, 'binary_f1_score': 0.5723472}
confusion matrix:
       0    1
0  17904  245
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.84532887, 'recall': 0.8516509, 'specificity': 0.8516509, 'f1': 0.8484579, 'auroc': 0.9672761, 'binary_precision': 0.7030075, 'binary_recall': 0.71647507, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.70967746}
confusion matrix:
      0    1
0  5918   79
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
new oracle model saved
early stop counter: 2
val acc:0.9716900587081909, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9705976247787476 / 0.9755513072013855
after epoch: 3,now: 2024-05-25 11:25:23.094571,epoch time: 0:20:59.604337,used: 1:03:08.630591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9819602, 'precision': 0.90989745, 'recall': 0.7870658, 'specificity': 0.7870658, 'f1': 0.83685076, 'auroc': 0.9795256, 'binary_precision': 0.83431375, 'binary_recall': 0.578125, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.68298554}
confusion matrix:
       0    1
0  42151  169
1    621  851
---- Validation: 
scalar performance:
{'acc': 0.9818008, 'precision': 0.9074615, 'recall': 0.79256344, 'specificity': 0.79256344, 'f1': 0.8398585, 'auroc': 0.9749444, 'binary_precision': 0.8293217, 'binary_recall': 0.58942455, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.6890909}
confusion matrix:
       0    1
0  18071   78
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.76272094, 'recall': 0.52407044, 'specificity': 0.52407044, 'f1': 0.53522855, 'auroc': 0.94573736, 'binary_precision': 0.5652174, 'binary_recall': 0.049808428, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09154929}
confusion matrix:
      0   1
0  5987  10
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 4,now: 2024-05-25 11:46:19.493894,epoch time: 0:20:56.399323,used: 1:24:05.029914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98479176, 'precision': 0.88827074, 'recall': 0.8729509, 'specificity': 0.8729509, 'f1': 0.8804437, 'auroc': 0.98651373, 'binary_precision': 0.78510636, 'binary_recall': 0.75306123, 'binary_specificity': 0.9928406, 'binary_f1_score': 0.76875}
confusion matrix:
       0     1
0  42019   303
1    363  1107
---- Validation: 
scalar performance:
{'acc': 0.9820668, 'precision': 0.8699395, 'recall': 0.8527056, 'specificity': 0.8527056, 'f1': 0.8610988, 'auroc': 0.98019075, 'binary_precision': 0.75, 'binary_recall': 0.7138414, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.73147404}
confusion matrix:
       0    1
0  17996  153
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.86085343, 'recall': 0.632182, 'specificity': 0.632182, 'f1': 0.6889422, 'auroc': 0.9636058, 'binary_precision': 0.75268817, 'binary_recall': 0.26819924, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.39548025}
confusion matrix:
      0   1
0  5974  23
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 5,now: 2024-05-25 12:07:13.254984,epoch time: 0:20:53.761090,used: 1:44:58.791004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98648155, 'precision': 0.9009236, 'recall': 0.8877629, 'specificity': 0.8877629, 'f1': 0.8942243, 'auroc': 0.986482, 'binary_precision': 0.8094233, 'binary_recall': 0.7819294, 'binary_specificity': 0.99359643, 'binary_f1_score': 0.7954388}
confusion matrix:
       0     1
0  42049   271
1    321  1151
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9018464, 'recall': 0.83939123, 'specificity': 0.83939123, 'f1': 0.8677738, 'auroc': 0.9784478, 'binary_precision': 0.8148148, 'binary_recall': 0.6842924, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7438715}
confusion matrix:
       0    1
0  18049  100
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8990091, 'recall': 0.629101, 'specificity': 0.629101, 'f1': 0.6897483, 'auroc': 0.95456433, 'binary_precision': 0.8292683, 'binary_recall': 0.2605364, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.39650148}
confusion matrix:
      0   1
0  5983  14
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 6,now: 2024-05-25 12:27:54.603119,epoch time: 0:20:41.348135,used: 2:05:40.139139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9873949, 'precision': 0.8940936, 'recall': 0.9183457, 'specificity': 0.9183457, 'f1': 0.90582645, 'auroc': 0.99183786, 'binary_precision': 0.7936102, 'binary_recall': 0.8443236, 'binary_specificity': 0.99236786, 'binary_f1_score': 0.8181818}
confusion matrix:
       0     1
0  41998   323
1    229  1242
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.8916993, 'recall': 0.872862, 'specificity': 0.872862, 'f1': 0.88202876, 'auroc': 0.9856658, 'binary_precision': 0.792144, 'binary_recall': 0.7527216, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.7719298}
confusion matrix:
       0    1
0  18022  127
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8410519, 'recall': 0.648673, 'specificity': 0.648673, 'f1': 0.70355463, 'auroc': 0.9513143, 'binary_precision': 0.7117117, 'binary_recall': 0.30268198, 'binary_specificity': 0.994664, 'binary_f1_score': 0.42473117}
confusion matrix:
      0   1
0  5965  32
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 7,now: 2024-05-25 12:48:22.424603,epoch time: 0:20:27.821484,used: 2:26:07.960623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9863217, 'precision': 0.9068521, 'recall': 0.87554944, 'specificity': 0.87554944, 'f1': 0.8905237, 'auroc': 0.9913826, 'binary_precision': 0.8221402, 'binary_recall': 0.7567935, 'binary_specificity': 0.9943053, 'binary_f1_score': 0.7881146}
confusion matrix:
       0     1
0  42079   241
1    358  1114
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.9144709, 'recall': 0.8406096, 'specificity': 0.8406096, 'f1': 0.87364167, 'auroc': 0.98211485, 'binary_precision': 0.84, 'binary_recall': 0.6858476, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.755137}
confusion matrix:
       0    1
0  18065   84
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.84930694, 'recall': 0.5980327, 'specificity': 0.5980327, 'f1': 0.64726996, 'auroc': 0.95873195, 'binary_precision': 0.73239434, 'binary_recall': 0.19923371, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.313253}
confusion matrix:
      0   1
0  5978  19
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 1
val acc:0.9847807288169861, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 8,now: 2024-05-25 13:09:24.016969,epoch time: 0:21:01.592366,used: 2:47:09.552989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98143494, 'precision': 0.93979394, 'recall': 0.752041, 'specificity': 0.752041, 'f1': 0.8187245, 'auroc': 0.99072677, 'binary_precision': 0.89651024, 'binary_recall': 0.5061141, 'binary_specificity': 0.99796784, 'binary_f1_score': 0.6469822}
confusion matrix:
       0    1
0  42234   86
1    727  745
---- Validation: 
scalar performance:
{'acc': 0.9774372, 'precision': 0.89802223, 'recall': 0.71829903, 'specificity': 0.71829903, 'f1': 0.7800653, 'auroc': 0.97592235, 'binary_precision': 0.81556195, 'binary_recall': 0.44012442, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.57171714}
confusion matrix:
       0    1
0  18085   64
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.82367504, 'recall': 0.58070797, 'specificity': 0.58070797, 'f1': 0.62295556, 'auroc': 0.9572959, 'binary_precision': 0.6825397, 'binary_recall': 0.16475096, 'binary_specificity': 0.996665, 'binary_f1_score': 0.26543212}
confusion matrix:
      0   1
0  5977  20
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 2
val acc:0.9774371981620789, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 9,now: 2024-05-25 13:30:37.118737,epoch time: 0:21:13.101768,used: 3:08:22.654757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.987943, 'precision': 0.93204874, 'recall': 0.87335277, 'specificity': 0.87335277, 'f1': 0.9003973, 'auroc': 0.9920198, 'binary_precision': 0.8727273, 'binary_recall': 0.75050986, 'binary_specificity': 0.99619573, 'binary_f1_score': 0.80701756}
confusion matrix:
       0     1
0  42160   161
1    367  1104
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.9196524, 'recall': 0.8160844, 'specificity': 0.8160844, 'f1': 0.8600205, 'auroc': 0.97999996, 'binary_precision': 0.8520833, 'binary_recall': 0.63608086, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7284061}
confusion matrix:
       0    1
0  18078   71
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.92748797, 'recall': 0.5476426, 'specificity': 0.5476426, 'f1': 0.57673174, 'auroc': 0.9507638, 'binary_precision': 0.89285713, 'binary_recall': 0.09578544, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5994   3
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 3
val acc:0.9837697148323059, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 10,now: 2024-05-25 13:51:28.391408,epoch time: 0:20:51.272671,used: 3:29:13.927428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873949, 'precision': 0.89133954, 'recall': 0.9235952, 'specificity': 0.9235952, 'f1': 0.90677345, 'auroc': 0.9942552, 'binary_precision': 0.787727, 'binary_recall': 0.8552005, 'binary_specificity': 0.9919898, 'binary_f1_score': 0.82007825}
confusion matrix:
       0     1
0  41982   339
1    213  1258
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.88478506, 'recall': 0.85642207, 'specificity': 0.85642207, 'f1': 0.8700144, 'auroc': 0.981316, 'binary_precision': 0.77946126, 'binary_recall': 0.7200622, 'binary_specificity': 0.992782, 'binary_f1_score': 0.7485853}
confusion matrix:
       0    1
0  18018  131
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7571619, 'recall': 0.5941994, 'specificity': 0.5941994, 'f1': 0.63370764, 'auroc': 0.95520794, 'binary_precision': 0.5483871, 'binary_recall': 0.1954023, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.2881356}
confusion matrix:
      0   1
0  5955  42
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 4
val acc:0.9834504127502441, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 11,now: 2024-05-25 14:11:55.383491,epoch time: 0:20:26.992083,used: 3:49:40.919511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9868241, 'precision': 0.9078599, 'recall': 0.8840058, 'specificity': 0.8840058, 'f1': 0.89554423, 'auroc': 0.9931452, 'binary_precision': 0.8235719, 'binary_recall': 0.7737772, 'binary_specificity': 0.9942344, 'binary_f1_score': 0.79789835}
confusion matrix:
       0     1
0  42076   244
1    333  1139
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.8996232, 'recall': 0.83083755, 'specificity': 0.83083755, 'f1': 0.86172915, 'auroc': 0.97659767, 'binary_precision': 0.8109641, 'binary_recall': 0.66718507, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7320819}
confusion matrix:
       0    1
0  18049  100
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8891538, 'recall': 0.6137753, 'specificity': 0.6137753, 'f1': 0.67027926, 'auroc': 0.9488775, 'binary_precision': 0.8108108, 'binary_recall': 0.22988506, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.35820895}
confusion matrix:
      0   1
0  5983  14
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 5
val acc:0.9832907915115356, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 12,now: 2024-05-25 14:32:16.927700,epoch time: 0:20:21.544209,used: 4:10:02.463720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9896785, 'precision': 0.9589073, 'recall': 0.87523496, 'specificity': 0.87523496, 'f1': 0.9125675, 'auroc': 0.9958513, 'binary_precision': 0.92635983, 'binary_recall': 0.7525493, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.8304577}
confusion matrix:
       0     1
0  42233    88
1    364  1107
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.92126334, 'recall': 0.81150144, 'specificity': 0.81150144, 'f1': 0.8575368, 'auroc': 0.9807185, 'binary_precision': 0.85562634, 'binary_recall': 0.62674963, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7235189}
confusion matrix:
       0    1
0  18081   68
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.81316876, 'recall': 0.58054125, 'specificity': 0.58054125, 'f1': 0.62205774, 'auroc': 0.95474464, 'binary_precision': 0.6615385, 'binary_recall': 0.16475096, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2638037}
confusion matrix:
      0   1
0  5975  22
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 6
val acc:0.9836100339889526, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 13,now: 2024-05-25 14:52:55.265282,epoch time: 0:20:38.337582,used: 4:30:40.801302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98942727, 'precision': 0.96755815, 'recall': 0.8633861, 'specificity': 0.8633861, 'f1': 0.90847635, 'auroc': 0.99738085, 'binary_precision': 0.9444934, 'binary_recall': 0.7282609, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.8224012}
confusion matrix:
       0     1
0  42257    63
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.9822797, 'precision': 0.9278144, 'recall': 0.78156054, 'specificity': 0.78156054, 'f1': 0.8385138, 'auroc': 0.9813458, 'binary_precision': 0.87081337, 'binary_recall': 0.5660964, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.6861451}
confusion matrix:
       0    1
0  18095   54
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8106981, 'recall': 0.6029461, 'specificity': 0.6029461, 'f1': 0.6497662, 'auroc': 0.9419788, 'binary_precision': 0.6547619, 'binary_recall': 0.21072797, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31884056}
confusion matrix:
      0   1
0  5968  29
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 7
val acc:0.9822797179222107, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 14,now: 2024-05-25 15:13:37.795408,epoch time: 0:20:42.530126,used: 4:51:23.331428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.990158, 'precision': 0.97879195, 'recall': 0.86573136, 'specificity': 0.86573136, 'f1': 0.9141635, 'auroc': 0.9968605, 'binary_precision': 0.9668161, 'binary_recall': 0.73233694, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.83339775}
confusion matrix:
       0     1
0  42283    37
1    394  1078
---- Validation: 
scalar performance:
{'acc': 0.9820668, 'precision': 0.94847864, 'recall': 0.76194894, 'specificity': 0.76194894, 'f1': 0.82905495, 'auroc': 0.9782853, 'binary_precision': 0.91351354, 'binary_recall': 0.525661, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.66732484}
confusion matrix:
       0    1
0  18117   32
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.80579174, 'recall': 0.59536666, 'specificity': 0.59536666, 'f1': 0.64022666, 'auroc': 0.94109654, 'binary_precision': 0.6455696, 'binary_recall': 0.1954023, 'binary_specificity': 0.995331, 'binary_f1_score': 0.29999998}
confusion matrix:
      0   1
0  5969  28
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 8
val acc:0.982066810131073, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 15,now: 2024-05-25 15:34:21.206697,epoch time: 0:20:43.411289,used: 5:12:06.742717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98885643, 'precision': 0.9162006, 'recall': 0.911286, 'specificity': 0.911286, 'f1': 0.9137275, 'auroc': 0.99607754, 'binary_precision': 0.8383769, 'binary_recall': 0.828125, 'binary_specificity': 0.99444705, 'binary_f1_score': 0.8332194}
confusion matrix:
       0     1
0  42085   235
1    253  1219
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.8957857, 'recall': 0.8414761, 'specificity': 0.8414761, 'f1': 0.86646557, 'auroc': 0.97501934, 'binary_precision': 0.80253625, 'binary_recall': 0.688958, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.74142265}
confusion matrix:
       0    1
0  18040  109
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8015387, 'recall': 0.5467255, 'specificity': 0.5467255, 'f1': 0.57310086, 'auroc': 0.90649235, 'binary_precision': 0.64102566, 'binary_recall': 0.09578544, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5983  14
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 9
val acc:0.9835568070411682, best validation acc: 0.9847807288169861, corresponding to test acc:                         0.9658037424087524 / 0.9755513072013855
after epoch: 16,now: 2024-05-25 15:54:55.981115,epoch time: 0:20:34.774418,used: 5:32:41.517135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.9343679, 'recall': 0.94574964, 'specificity': 0.94574964, 'f1': 0.93997926, 'auroc': 0.99675155, 'binary_precision': 0.8723545, 'binary_recall': 0.8960598, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.88404834}
confusion matrix:
       0     1
0  42127   193
1    153  1319
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.9046869, 'recall': 0.865692, 'specificity': 0.865692, 'f1': 0.88412106, 'auroc': 0.9785672, 'binary_precision': 0.81865287, 'binary_recall': 0.7371695, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.77577746}
confusion matrix:
       0    1
0  18044  105
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8133402, 'recall': 0.7095569, 'specificity': 0.7095569, 'f1': 0.75001204, 'auroc': 0.9412879, 'binary_precision': 0.6511628, 'binary_recall': 0.42911878, 'binary_specificity': 0.989995, 'binary_f1_score': 0.517321}
confusion matrix:
      0    1
0  5937   60
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 17,now: 2024-05-25 16:15:20.847260,epoch time: 0:20:24.866145,used: 5:53:06.383280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9918935, 'precision': 0.9355025, 'recall': 0.9403586, 'specificity': 0.9403586, 'f1': 0.93791604, 'auroc': 0.99700034, 'binary_precision': 0.875, 'binary_recall': 0.88511217, 'binary_specificity': 0.995605, 'binary_f1_score': 0.880027}
confusion matrix:
       0     1
0  42135   186
1    169  1302
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.91175663, 'recall': 0.878299, 'specificity': 0.878299, 'f1': 0.8942611, 'auroc': 0.98260903, 'binary_precision': 0.8319185, 'binary_recall': 0.7620529, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.79545456}
confusion matrix:
       0    1
0  18050   99
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8081342, 'recall': 0.64025974, 'specificity': 0.64025974, 'f1': 0.68958896, 'auroc': 0.9484086, 'binary_precision': 0.6465517, 'binary_recall': 0.28735632, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.39787796}
confusion matrix:
      0   1
0  5956  41
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
better model found
persisted
after epoch: 18,now: 2024-05-25 16:35:59.992855,epoch time: 0:20:39.145595,used: 6:13:45.528875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9903179, 'precision': 0.95356333, 'recall': 0.89138705, 'specificity': 0.89138705, 'f1': 0.92001605, 'auroc': 0.9964148, 'binary_precision': 0.914557, 'binary_recall': 0.78532606, 'binary_specificity': 0.997448, 'binary_f1_score': 0.84502923}
confusion matrix:
       0     1
0  42212   108
1    316  1156
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.91117966, 'recall': 0.8065603, 'specificity': 0.8065603, 'f1': 0.8506559, 'auroc': 0.97617793, 'binary_precision': 0.8357895, 'binary_recall': 0.61741835, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.71019685}
confusion matrix:
       0    1
0  18071   78
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7613467, 'recall': 0.5425606, 'specificity': 0.5425606, 'f1': 0.56567913, 'auroc': 0.9372258, 'binary_precision': 0.5609756, 'binary_recall': 0.08812261, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.15231788}
confusion matrix:
      0   1
0  5979  18
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 1
val acc:0.982758641242981, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 19,now: 2024-05-25 16:57:14.711857,epoch time: 0:21:14.719002,used: 6:35:00.247877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99415416, 'precision': 0.9569104, 'recall': 0.95271444, 'specificity': 0.95271444, 'f1': 0.954802, 'auroc': 0.9984163, 'binary_precision': 0.9170096, 'binary_recall': 0.90828806, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.912628}
confusion matrix:
       0     1
0  42199   121
1    135  1337
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.93358916, 'recall': 0.84510374, 'specificity': 0.84510374, 'f1': 0.88393474, 'auroc': 0.97851586, 'binary_precision': 0.87795275, 'binary_recall': 0.69362366, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7749783}
confusion matrix:
       0    1
0  18087   62
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8126024, 'recall': 0.57304513, 'specificity': 0.57304513, 'f1': 0.61195374, 'auroc': 0.9427923, 'binary_precision': 0.66101694, 'binary_recall': 0.14942528, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24375}
confusion matrix:
      0   1
0  5977  20
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 2
val acc:0.9862175583839417, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 20,now: 2024-05-25 17:18:25.293457,epoch time: 0:21:10.581600,used: 6:56:10.829477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99369746, 'precision': 0.9580601, 'recall': 0.9436259, 'specificity': 0.9436259, 'f1': 0.9507185, 'auroc': 0.99823415, 'binary_precision': 0.9199438, 'binary_recall': 0.8899456, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.9046961}
confusion matrix:
       0     1
0  42206   114
1    162  1310
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.93346375, 'recall': 0.8489642, 'specificity': 0.8489642, 'f1': 0.88630104, 'auroc': 0.9835334, 'binary_precision': 0.8774319, 'binary_recall': 0.7013997, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7796024}
confusion matrix:
       0    1
0  18086   63
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7909009, 'recall': 0.60994196, 'specificity': 0.60994196, 'f1': 0.655438, 'auroc': 0.9242121, 'binary_precision': 0.6145833, 'binary_recall': 0.22605364, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.33053222}
confusion matrix:
      0   1
0  5960  37
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 3
val acc:0.9864304065704346, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 21,now: 2024-05-25 17:39:32.443661,epoch time: 0:21:07.150204,used: 7:17:17.979681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99310374, 'precision': 0.9607965, 'recall': 0.93048584, 'specificity': 0.93048584, 'f1': 0.9450865, 'auroc': 0.9975125, 'binary_precision': 0.92633116, 'binary_recall': 0.86335826, 'binary_specificity': 0.9976135, 'binary_f1_score': 0.8937368}
confusion matrix:
       0     1
0  42220   101
1    201  1270
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.931826, 'recall': 0.8404106, 'specificity': 0.8404106, 'f1': 0.8802941, 'auroc': 0.97887826, 'binary_precision': 0.8747515, 'binary_recall': 0.6842924, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7678883}
confusion matrix:
       0    1
0  18086   63
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.83794534, 'recall': 0.59220225, 'specificity': 0.59220225, 'f1': 0.6389657, 'auroc': 0.93725467, 'binary_precision': 0.71014494, 'binary_recall': 0.18773946, 'binary_specificity': 0.996665, 'binary_f1_score': 0.29696968}
confusion matrix:
      0   1
0  5977  20
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 4
val acc:0.9858450293540955, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 22,now: 2024-05-25 18:00:36.856806,epoch time: 0:21:04.413145,used: 7:38:22.392826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99349195, 'precision': 0.9474554, 'recall': 0.95302755, 'specificity': 0.95302755, 'f1': 0.95022285, 'auroc': 0.997752, 'binary_precision': 0.898055, 'binary_recall': 0.90964675, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.9038137}
confusion matrix:
       0     1
0  42168   152
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9043493, 'recall': 0.8672197, 'specificity': 0.8672197, 'f1': 0.88481724, 'auroc': 0.9791453, 'binary_precision': 0.8178694, 'binary_recall': 0.7402799, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.7771428}
confusion matrix:
       0    1
0  18043  106
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8310454, 'recall': 0.60711104, 'specificity': 0.60711104, 'f1': 0.6567747, 'auroc': 0.9434948, 'binary_precision': 0.69512194, 'binary_recall': 0.21839081, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33236152}
confusion matrix:
      0   1
0  5972  25
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 5
val acc:0.985472559928894, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 23,now: 2024-05-25 18:21:40.220044,epoch time: 0:21:03.363238,used: 7:59:25.756064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.968459, 'recall': 0.93519616, 'specificity': 0.93519616, 'f1': 0.95116925, 'auroc': 0.9980278, 'binary_precision': 0.94134897, 'binary_recall': 0.8722826, 'binary_specificity': 0.99810964, 'binary_f1_score': 0.90550077}
confusion matrix:
       0     1
0  42240    80
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9384773, 'recall': 0.83829814, 'specificity': 0.83829814, 'f1': 0.88144165, 'auroc': 0.98209774, 'binary_precision': 0.88821137, 'binary_recall': 0.67962676, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.770044}
confusion matrix:
       0    1
0  18094   55
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8043295, 'recall': 0.5411451, 'specificity': 0.5411451, 'f1': 0.56430703, 'auroc': 0.9376457, 'binary_precision': 0.64705884, 'binary_recall': 0.08429119, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14915255}
confusion matrix:
      0   1
0  5985  12
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 6
val acc:0.9861111044883728, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 24,now: 2024-05-25 18:42:46.646496,epoch time: 0:21:06.426452,used: 8:20:32.182516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928069, 'precision': 0.9567652, 'recall': 0.93005085, 'specificity': 0.93005085, 'f1': 0.9429747, 'auroc': 0.99803543, 'binary_precision': 0.91829354, 'binary_recall': 0.86277175, 'binary_specificity': 0.9973299, 'binary_f1_score': 0.8896672}
confusion matrix:
       0     1
0  42207   113
1    202  1270
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9232893, 'recall': 0.85171646, 'specificity': 0.85171646, 'f1': 0.88393843, 'auroc': 0.97754717, 'binary_precision': 0.8568738, 'binary_recall': 0.7076205, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7751277}
confusion matrix:
       0    1
0  18073   76
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.849161, 'recall': 0.58295715, 'specificity': 0.58295715, 'f1': 0.62751853, 'auroc': 0.936159, 'binary_precision': 0.73333335, 'binary_recall': 0.16858238, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2741433}
confusion matrix:
      0   1
0  5981  16
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 7
val acc:0.9859514832496643, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 25,now: 2024-05-25 19:03:53.059042,epoch time: 0:21:06.412546,used: 8:41:38.595062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9931951, 'precision': 0.94328976, 'recall': 0.9531714, 'specificity': 0.9531714, 'f1': 0.94817173, 'auroc': 0.998603, 'binary_precision': 0.889701, 'binary_recall': 0.91026515, 'binary_specificity': 0.9960776, 'binary_f1_score': 0.8998656}
confusion matrix:
       0     1
0  42155   166
1    132  1339
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9104016, 'recall': 0.8689953, 'specificity': 0.8689953, 'f1': 0.88850856, 'auroc': 0.98410124, 'binary_precision': 0.8298611, 'binary_recall': 0.7433904, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.78424937}
confusion matrix:
       0    1
0  18051   98
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.81642395, 'recall': 0.59744906, 'specificity': 0.59744906, 'f1': 0.643743, 'auroc': 0.9525125, 'binary_precision': 0.6666667, 'binary_recall': 0.19923371, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30678466}
confusion matrix:
      0   1
0  5971  26
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 8
val acc:0.9860047101974487, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 26,now: 2024-05-25 19:25:01.152524,epoch time: 0:21:08.093482,used: 9:02:46.688544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.97539353, 'recall': 0.9388173, 'specificity': 0.9388173, 'f1': 0.9563191, 'auroc': 0.9987358, 'binary_precision': 0.95498157, 'binary_recall': 0.87907606, 'binary_specificity': 0.9985586, 'binary_f1_score': 0.9154581}
confusion matrix:
       0     1
0  42259    61
1    178  1294
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.93883765, 'recall': 0.8452691, 'specificity': 0.8452691, 'f1': 0.8860481, 'auroc': 0.97915685, 'binary_precision': 0.8884462, 'binary_recall': 0.69362366, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.77903926}
confusion matrix:
       0    1
0  18093   56
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8298459, 'recall': 0.6221032, 'specificity': 0.6221032, 'f1': 0.6738477, 'auroc': 0.9353281, 'binary_precision': 0.69148934, 'binary_recall': 0.24904214, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.36619717}
confusion matrix:
      0   1
0  5968  29
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 9
val acc:0.9865368008613586, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 27,now: 2024-05-25 19:46:08.302004,epoch time: 0:21:07.149480,used: 9:23:53.838024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9948621, 'precision': 0.95895123, 'recall': 0.9622607, 'specificity': 0.9622607, 'f1': 0.96059954, 'auroc': 0.99836916, 'binary_precision': 0.92043155, 'binary_recall': 0.9273098, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.92385787}
confusion matrix:
       0     1
0  42202   118
1    107  1365
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9231322, 'recall': 0.8547994, 'specificity': 0.8547994, 'f1': 0.88572824, 'auroc': 0.9796976, 'binary_precision': 0.85634327, 'binary_recall': 0.7138414, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.7786259}
confusion matrix:
       0    1
0  18072   77
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.78656167, 'recall': 0.5893694, 'specificity': 0.5893694, 'f1': 0.6311568, 'auroc': 0.95030624, 'binary_precision': 0.6075949, 'binary_recall': 0.18390805, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.28235295}
confusion matrix:
      0   1
0  5966  31
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 10
val acc:0.9861111044883728, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 28,now: 2024-05-25 20:07:13.802506,epoch time: 0:21:05.500502,used: 9:44:59.338526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99159664, 'precision': 0.95266426, 'recall': 0.91390026, 'specificity': 0.91390026, 'f1': 0.9323491, 'auroc': 0.99787575, 'binary_precision': 0.911194, 'binary_recall': 0.83061224, 'binary_specificity': 0.9971882, 'binary_f1_score': 0.8690392}
confusion matrix:
       0     1
0  42203   119
1    249  1221
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9179249, 'recall': 0.8198898, 'specificity': 0.8198898, 'f1': 0.86189175, 'auroc': 0.97606194, 'binary_precision': 0.84836066, 'binary_recall': 0.64385694, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7320956}
confusion matrix:
       0    1
0  18075   74
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.65604115, 'recall': 0.51057714, 'specificity': 0.51057714, 'f1': 0.51071495, 'auroc': 0.9504677, 'binary_precision': 0.3529412, 'binary_recall': 0.022988506, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.043165468}
confusion matrix:
      0   1
0  5986  11
1   255   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 11
val acc:0.98387610912323, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 29,now: 2024-05-25 20:28:09.876448,epoch time: 0:20:56.073942,used: 10:05:55.412468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98629886, 'precision': 0.8916306, 'recall': 0.89933974, 'specificity': 0.89933974, 'f1': 0.89544433, 'auroc': 0.9926951, 'binary_precision': 0.79, 'binary_recall': 0.8061224, 'binary_specificity': 0.99255705, 'binary_f1_score': 0.7979797}
confusion matrix:
       0     1
0  42007   315
1    285  1185
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.8851831, 'recall': 0.82414836, 'specificity': 0.82414836, 'f1': 0.8518213, 'auroc': 0.9767815, 'binary_precision': 0.78252786, 'binary_recall': 0.6547434, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.71295506}
confusion matrix:
       0    1
0  18032  117
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.83072567, 'recall': 0.6746592, 'specificity': 0.6746592, 'f1': 0.72618514, 'auroc': 0.94950664, 'binary_precision': 0.6888889, 'binary_recall': 0.35632184, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.46969697}
confusion matrix:
      0   1
0  5955  42
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20839953.png
early stop counter: 12
val acc:0.9819604158401489, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9637264013290405 / 0.9755513072013855
after epoch: 30,now: 2024-05-25 20:49:11.338309,epoch time: 0:21:01.461861,used: 10:26:56.874329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_25_10_22_14_seed_0_20839953
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:26:56.874329 at 2024-05-25 20:49:11.338309
persisted model performance metric: 

scalar performance:
{'acc': 0.96356666, 'precision': 0.80426013, 'recall': 0.6420087, 'specificity': 0.6420087, 'f1': 0.6906065, 'auroc': 0.9512674, 'binary_precision': 0.6386555, 'binary_recall': 0.29118773, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5954  43
1   185  76
oracle model performance metric: 

scalar performance:
{'acc': 0.9753915, 'precision': 0.8440113, 'recall': 0.8515675, 'specificity': 0.8515675, 'f1': 0.8477435, 'auroc': 0.9670862, 'binary_precision': 0.70037454, 'binary_recall': 0.71647507, 'binary_specificity': 0.98666, 'binary_f1_score': 0.7083333}
confusion matrix:
      0    1
0  5917   80
1    74  187
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2_resnet_irm/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 446436 KiB |   1995 MiB |    933 TiB |    933 TiB |
|       from large pool | 402821 KiB |   1960 MiB |    921 TiB |    921 TiB |
|       from small pool |  43615 KiB |     63 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 446436 KiB |   1995 MiB |    933 TiB |    933 TiB |
|       from large pool | 402821 KiB |   1960 MiB |    921 TiB |    921 TiB |
|       from small pool |  43615 KiB |     63 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 439406 KiB |   1992 MiB |    933 TiB |    933 TiB |
|       from large pool | 396800 KiB |   1958 MiB |    921 TiB |    921 TiB |
|       from small pool |  42606 KiB |     62 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2284 MiB |   2284 MiB |   2284 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339996 KiB | 378663 KiB | 773249 GiB | 773249 GiB |
|       from large pool | 334459 KiB | 370811 KiB | 760511 GiB | 760511 GiB |
|       from small pool |   5537 KiB |  10770 KiB |  12738 GiB |  12738 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  179536 K  |  179533 K  |
|       from large pool |     182    |     307    |   87446 K  |   87446 K  |
|       from small pool |    3306    |    6276    |   92090 K  |   92086 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  179536 K  |  179533 K  |
|       from large pool |     182    |     307    |   87446 K  |   87446 K  |
|       from small pool |    3306    |    6276    |   92090 K  |   92086 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    2787    |  107617 K  |  107617 K  |
|       from large pool |      35    |      92    |   65161 K  |   65161 K  |
|       from small pool |      28    |    2752    |   42456 K  |   42455 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1995 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1960 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     63 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1995 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1960 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     63 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1992 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1958 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     62 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    768 MiB |   2284 MiB |   2284 MiB |   1516 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     48 MiB |     72 MiB |     72 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 436873 KiB | 773250 GiB | 773250 GiB |
|       from large pool |  24320 KiB | 418091 KiB | 760511 GiB | 760511 GiB |
|       from small pool |      0 KiB |  25320 KiB |  12738 GiB |  12738 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  179536 K  |  179536 K  |
|       from large pool |       2    |     307    |   87446 K  |   87446 K  |
|       from small pool |       0    |    6276    |   92090 K  |   92090 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  179536 K  |  179536 K  |
|       from large pool |       2    |     307    |   87446 K  |   87446 K  |
|       from small pool |       0    |    6276    |   92090 K  |   92090 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     128    |     128    |      71    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      24    |      36    |      36    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2787    |  107618 K  |  107618 K  |
|       from large pool |       3    |      92    |   65161 K  |   65161 K  |
|       from small pool |       0    |    2752    |   42457 K  |   42457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat May 25 20:51:09 2024]
Finished job 0.
1 of 1 steps (100%) done
