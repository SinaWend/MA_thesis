Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 16:20:08 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199

 Experiment start at: 2024-06-10 16:26:07.300867
before training, model accuracy: 0.8902654647827148
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.997304, 'precision': 0.9985158, 'recall': 0.98573047, 'specificity': 0.98573047, 'f1': 0.9920187, 'auroc': 0.99967015, 'binary_precision': 1.0, 'binary_recall': 0.97146094, 'binary_specificity': 1.0, 'binary_f1_score': 0.9855239}
confusion matrix:
       0     1
0  42321     0
1    126  4289
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73294127, 'recall': 0.5015001, 'specificity': 0.5015001, 'f1': 0.49438718, 'auroc': 0.9100139, 'binary_precision': 0.5, 'binary_recall': 0.00311042, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0061823805}
confusion matrix:
       0  1
0  18147  2
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942478, 'precision': 0.9967694, 'recall': 0.97509575, 'specificity': 0.97509575, 'f1': 0.9856093, 'auroc': 0.99867564, 'binary_precision': 1.0, 'binary_recall': 0.95019156, 'binary_specificity': 1.0, 'binary_f1_score': 0.97445977}
confusion matrix:
      0    1
0  5997    0
1    39  744
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 17:02:25.468177,epoch time: 0:36:18.167310,used: 0:36:18.167310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.996063, 'precision': 0.99783564, 'recall': 0.9791525, 'specificity': 0.9791525, 'f1': 0.9882698, 'auroc': 0.9989898, 'binary_precision': 1.0, 'binary_recall': 0.958305, 'binary_specificity': 1.0, 'binary_f1_score': 0.9787086}
confusion matrix:
       0     1
0  42323     0
1    184  4229
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.98299444, 'recall': 0.5031104, 'specificity': 0.5031104, 'f1': 0.49753252, 'auroc': 0.94144386, 'binary_precision': 1.0, 'binary_recall': 0.00622084, 'binary_specificity': 1.0, 'binary_f1_score': 0.012364761}
confusion matrix:
       0  1
0  18149  0
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9932153, 'precision': 0.99619395, 'recall': 0.97062576, 'specificity': 0.97062576, 'f1': 0.98295814, 'auroc': 0.9994124, 'binary_precision': 1.0, 'binary_recall': 0.9412516, 'binary_specificity': 1.0, 'binary_f1_score': 0.9697369}
confusion matrix:
      0    1
0  5997    0
1    46  737
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_2.png
better model found
persisted
after epoch: 2,now: 2024-06-10 17:38:14.786823,epoch time: 0:35:49.318646,used: 1:12:07.485956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.998598, 'recall': 0.98652625, 'specificity': 0.98652625, 'f1': 0.9924692, 'auroc': 0.99948776, 'binary_precision': 1.0, 'binary_recall': 0.97305256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9863423}
confusion matrix:
       0     1
0  42320     0
1    119  4297
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7408904, 'recall': 0.51277846, 'specificity': 0.51277846, 'f1': 0.51645064, 'auroc': 0.9442552, 'binary_precision': 0.5151515, 'binary_recall': 0.02643857, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.050295856}
confusion matrix:
       0   1
0  18133  16
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.9975112, 'recall': 0.98084295, 'specificity': 0.98084295, 'f1': 0.98898685, 'auroc': 0.9993186, 'binary_precision': 1.0, 'binary_recall': 0.96168584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98046875}
confusion matrix:
      0    1
0  5997    0
1    30  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_3.png
new oracle model saved
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9932153224945068 / 0.9955752491950989
after epoch: 3,now: 2024-06-10 18:14:56.933003,epoch time: 0:36:42.146180,used: 1:48:49.632136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9989649, 'recall': 0.9911547, 'specificity': 0.9911547, 'f1': 0.995021, 'auroc': 0.9995928, 'binary_precision': 0.99976945, 'binary_recall': 0.98233294, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9909745}
confusion matrix:
       0     1
0  42320     1
1     78  4337
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.85202456, 'recall': 0.5214974, 'specificity': 0.5214974, 'f1': 0.5326479, 'auroc': 0.9546549, 'binary_precision': 0.7368421, 'binary_recall': 0.04354588, 'binary_specificity': 0.999449, 'binary_f1_score': 0.082232006}
confusion matrix:
       0   1
0  18139  10
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.99993, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-10 18:50:46.383186,epoch time: 0:35:49.450183,used: 2:24:39.082319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.9978318, 'recall': 0.995407, 'specificity': 0.995407, 'f1': 0.9966157, 'auroc': 0.9997381, 'binary_precision': 0.9965847, 'binary_recall': 0.9911685, 'binary_specificity': 0.99964553, 'binary_f1_score': 0.99386925}
confusion matrix:
       0     1
0  42305    15
1     39  4377
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.8684875, 'recall': 0.60229194, 'specificity': 0.60229194, 'f1': 0.6552975, 'auroc': 0.9625225, 'binary_precision': 0.7643678, 'binary_recall': 0.20684293, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.3255814}
confusion matrix:
       0    1
0  18108   41
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.9999293, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_5.png
better model found
persisted
after epoch: 5,now: 2024-06-10 19:26:38.422370,epoch time: 0:35:52.039184,used: 3:00:31.121503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9982241, 'precision': 0.9990213, 'recall': 0.9906024, 'specificity': 0.9906024, 'f1': 0.9947667, 'auroc': 0.9995845, 'binary_precision': 1.0, 'binary_recall': 0.9812047, 'binary_specificity': 1.0, 'binary_f1_score': 0.99051315}
confusion matrix:
       0     1
0  42320     0
1     83  4333
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7540494, 'recall': 0.5098058, 'specificity': 0.5098058, 'f1': 0.5108086, 'auroc': 0.9643516, 'binary_precision': 0.5416667, 'binary_recall': 0.02021773, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.03898051}
confusion matrix:
       0   1
0  18138  11
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9996209, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_6.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.970678985118866, corresponding to test acc:                         0.9969026446342468 / 0.9971976280212402
after epoch: 6,now: 2024-06-10 20:02:15.206350,epoch time: 0:35:36.783980,used: 3:36:07.905483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99837387, 'precision': 0.99445474, 'recall': 0.99605906, 'specificity': 0.99605906, 'f1': 0.99525523, 'auroc': 0.99984026, 'binary_precision': 0.9896186, 'binary_recall': 0.993205, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.9914085}
confusion matrix:
       0     1
0  42275    46
1     30  4385
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.7997049, 'recall': 0.6810753, 'specificity': 0.6810753, 'f1': 0.7244465, 'auroc': 0.9572485, 'binary_precision': 0.6214099, 'binary_recall': 0.37013996, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.4639376}
confusion matrix:
       0    1
0  18004  145
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.99997896, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-10 20:37:50.438526,epoch time: 0:35:35.232176,used: 4:11:43.137659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.9994689, 'recall': 0.9949026, 'specificity': 0.9949026, 'f1': 0.99717253, 'auroc': 0.99981046, 'binary_precision': 1.0, 'binary_recall': 0.98980516, 'binary_specificity': 1.0, 'binary_f1_score': 0.99487644}
confusion matrix:
       0     1
0  42322     0
1     45  4369
---- Validation: 
scalar performance:
{'acc': 0.97243506, 'precision': 0.8762859, 'recall': 0.6347034, 'specificity': 0.6347034, 'f1': 0.69455874, 'auroc': 0.95355403, 'binary_precision': 0.7777778, 'binary_recall': 0.27216175, 'binary_specificity': 0.997245, 'binary_f1_score': 0.40322584}
confusion matrix:
       0    1
0  18099   50
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.99999785, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_8.png
better model found
persisted
after epoch: 8,now: 2024-06-10 21:13:20.338569,epoch time: 0:35:29.900043,used: 4:47:13.037702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99918693, 'precision': 0.99904037, 'recall': 0.9962028, 'specificity': 0.9962028, 'f1': 0.9976165, 'auroc': 0.9997866, 'binary_precision': 0.99886, 'binary_recall': 0.9925238, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9956818}
confusion matrix:
       0     1
0  42317     5
1     33  4381
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.808205, 'recall': 0.6006327, 'specificity': 0.6006327, 'f1': 0.64771175, 'auroc': 0.9537686, 'binary_precision': 0.6439024, 'binary_recall': 0.20528771, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.31132075}
confusion matrix:
       0    1
0  18076   73
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.99990696, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_9.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9983775615692139
after epoch: 9,now: 2024-06-10 21:48:46.552293,epoch time: 0:35:26.213724,used: 5:22:39.251426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99901575, 'precision': 0.9993545, 'recall': 0.99489194, 'specificity': 0.99489194, 'f1': 0.9971106, 'auroc': 0.9998243, 'binary_precision': 0.99977124, 'binary_recall': 0.9898075, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9947644}
confusion matrix:
       0     1
0  42320     1
1     45  4370
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.82412785, 'recall': 0.5244701, 'specificity': 0.5244701, 'f1': 0.53789306, 'auroc': 0.9557467, 'binary_precision': 0.68085104, 'binary_recall': 0.04976672, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.09275363}
confusion matrix:
       0   1
0  18134  15
1    611  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.99975634, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_10.png
new oracle model saved
early stop counter: 2
val acc:0.9666879773139954, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9986725449562073
after epoch: 10,now: 2024-06-10 22:23:45.362758,epoch time: 0:34:58.810465,used: 5:57:38.061891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.99902713, 'recall': 0.9928432, 'specificity': 0.9928432, 'f1': 0.9959109, 'auroc': 0.99973214, 'binary_precision': 0.99954075, 'binary_recall': 0.9857337, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99258924}
confusion matrix:
       0     1
0  42318     2
1     63  4353
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.9446664, 'recall': 0.55348945, 'specificity': 0.55348945, 'f1': 0.58823395, 'auroc': 0.95747626, 'binary_precision': 0.92, 'binary_recall': 0.10730949, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.19220056}
confusion matrix:
       0   1
0  18143   6
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.99987173, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_11.png
early stop counter: 3
val acc:0.9691358208656311, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9986725449562073
after epoch: 11,now: 2024-06-10 22:59:01.897969,epoch time: 0:35:16.535211,used: 6:32:54.597102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.9994963, 'recall': 0.99624926, 'specificity': 0.99624926, 'f1': 0.9978661, 'auroc': 0.9999349, 'binary_precision': 0.9997717, 'binary_recall': 0.9925221, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99613374}
confusion matrix:
       0     1
0  42322     1
1     33  4380
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.9043878, 'recall': 0.552519, 'specificity': 0.552519, 'f1': 0.58594656, 'auroc': 0.96329033, 'binary_precision': 0.83950615, 'binary_recall': 0.10575428, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.1878453}
confusion matrix:
       0   1
0  18136  13
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9995003, 'recall': 0.9961686, 'specificity': 0.9961686, 'f1': 0.99782693, 'auroc': 0.999987, 'binary_precision': 1.0, 'binary_recall': 0.99233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.99615383}
confusion matrix:
      0    1
0  5997    0
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_12.png
new oracle model saved
early stop counter: 4
val acc:0.9687100648880005, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 12,now: 2024-06-10 23:34:36.511174,epoch time: 0:35:34.613205,used: 7:08:29.210307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.99693936, 'recall': 0.9944173, 'specificity': 0.9944173, 'f1': 0.9956744, 'auroc': 0.999627, 'binary_precision': 0.9949886, 'binary_recall': 0.9893545, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.9921636}
confusion matrix:
       0     1
0  42299    22
1     47  4368
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.83787954, 'recall': 0.64320815, 'specificity': 0.64320815, 'f1': 0.6981869, 'auroc': 0.9551537, 'binary_precision': 0.70037454, 'binary_recall': 0.29082426, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.41098902}
confusion matrix:
       0    1
0  18069   80
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.9998795, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_13.png
early stop counter: 5
val acc:0.971477210521698, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 13,now: 2024-06-11 00:10:14.873324,epoch time: 0:35:38.362150,used: 7:44:07.572457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99899435, 'precision': 0.99903536, 'recall': 0.995083, 'specificity': 0.995083, 'f1': 0.9970493, 'auroc': 0.99973756, 'binary_precision': 0.9990859, 'binary_recall': 0.9902605, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9946536}
confusion matrix:
       0     1
0  42317     4
1     43  4372
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.8543149, 'recall': 0.5714081, 'specificity': 0.5714081, 'f1': 0.61301833, 'auroc': 0.9499154, 'binary_precision': 0.7380952, 'binary_recall': 0.14463453, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.24187256}
confusion matrix:
       0   1
0  18116  33
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9985215, 'recall': 0.9935309, 'specificity': 0.9935309, 'f1': 0.99600935, 'auroc': 0.9997246, 'binary_precision': 0.998708, 'binary_recall': 0.98722863, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9929352}
confusion matrix:
      0    1
0  5996    1
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_14.png
early stop counter: 6
val acc:0.9689761400222778, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 14,now: 2024-06-11 00:45:44.807428,epoch time: 0:35:29.934104,used: 8:19:37.506561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.99930394, 'recall': 0.9933167, 'specificity': 0.9933167, 'f1': 0.9962876, 'auroc': 0.9998189, 'binary_precision': 1.0, 'binary_recall': 0.9866334, 'binary_specificity': 1.0, 'binary_f1_score': 0.99327177}
confusion matrix:
       0     1
0  42322     0
1     59  4355
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.8829936, 'recall': 0.5030829, 'specificity': 0.5030829, 'f1': 0.49750918, 'auroc': 0.96120703, 'binary_precision': 0.8, 'binary_recall': 0.00622084, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.01234568}
confusion matrix:
       0  1
0  18148  1
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9999565, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_15.png
early stop counter: 7
val acc:0.9659429788589478, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 15,now: 2024-06-11 01:21:15.961729,epoch time: 0:35:31.154301,used: 8:55:08.660862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.9995791, 'recall': 0.9970437, 'specificity': 0.9970437, 'f1': 0.99830735, 'auroc': 0.99990404, 'binary_precision': 0.9997722, 'binary_recall': 0.994111, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99693364}
confusion matrix:
       0     1
0  42320     1
1     26  4389
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.98322594, 'recall': 0.5101089, 'specificity': 0.5101089, 'f1': 0.511287, 'auroc': 0.9659395, 'binary_precision': 1.0, 'binary_recall': 0.02021773, 'binary_specificity': 1.0, 'binary_f1_score': 0.039634146}
confusion matrix:
       0   1
0  18149   0
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.9997816, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_16.png
early stop counter: 8
val acc:0.9664750695228577, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 16,now: 2024-06-11 01:56:42.493265,epoch time: 0:35:26.531536,used: 9:30:35.192398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.99903095, 'recall': 0.9939623, 'specificity': 0.9939623, 'f1': 0.99648035, 'auroc': 0.9996529, 'binary_precision': 0.9993127, 'binary_recall': 0.98799545, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9936218}
confusion matrix:
       0     1
0  42318     3
1     53  4362
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.7943822, 'recall': 0.6801324, 'specificity': 0.6801324, 'f1': 0.7222549, 'auroc': 0.9466015, 'binary_precision': 0.61082476, 'binary_recall': 0.36858475, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.45974782}
confusion matrix:
       0    1
0  17998  151
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9964202, 'recall': 0.9920037, 'specificity': 0.9920037, 'f1': 0.9941987, 'auroc': 0.9989061, 'binary_precision': 0.9948387, 'binary_recall': 0.98467433, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9897304}
confusion matrix:
      0    1
0  5993    4
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_17.png
early stop counter: 9
val acc:0.970359742641449, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 17,now: 2024-06-11 02:32:09.742985,epoch time: 0:35:27.249720,used: 10:06:02.442118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.9882746, 'recall': 0.99707216, 'specificity': 0.99707216, 'f1': 0.9926237, 'auroc': 0.9998791, 'binary_precision': 0.9769043, 'binary_recall': 0.9966017, 'binary_specificity': 0.9975426, 'binary_f1_score': 0.9866547}
confusion matrix:
       0     1
0  42218   104
1     15  4399
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7529373, 'recall': 0.5813917, 'specificity': 0.5813917, 'f1': 0.61925024, 'auroc': 0.9590597, 'binary_precision': 0.5346535, 'binary_recall': 0.16796267, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.25562128}
confusion matrix:
       0    1
0  18055   94
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.9999306, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_18.png
early stop counter: 10
val acc:0.9665282964706421, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 18,now: 2024-06-11 03:07:40.539871,epoch time: 0:35:30.796886,used: 10:41:33.239004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99918693, 'precision': 0.9995515, 'recall': 0.9956955, 'specificity': 0.9956955, 'f1': 0.99761415, 'auroc': 0.9999001, 'binary_precision': 1.0, 'binary_recall': 0.991391, 'binary_specificity': 1.0, 'binary_f1_score': 0.99567693}
confusion matrix:
       0     1
0  42322     0
1     38  4376
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.96070373, 'recall': 0.51630217, 'specificity': 0.51630217, 'f1': 0.52314156, 'auroc': 0.9355057, 'binary_precision': 0.95454544, 'binary_recall': 0.032659408, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.06315789}
confusion matrix:
       0   1
0  18148   1
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.999954, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_19.png
early stop counter: 11
val acc:0.9668475985527039, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9991150498390198
after epoch: 19,now: 2024-06-11 03:43:09.074897,epoch time: 0:35:28.535026,used: 11:17:01.774030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9993153, 'precision': 0.99931586, 'recall': 0.9966803, 'specificity': 0.9966803, 'f1': 0.9979937, 'auroc': 0.99984515, 'binary_precision': 0.99931645, 'binary_recall': 0.9934315, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99636525}
confusion matrix:
       0     1
0  42318     3
1     29  4386
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.9472822, 'recall': 0.52946633, 'specificity': 0.52946633, 'f1': 0.5473171, 'auroc': 0.9530691, 'binary_precision': 0.9268293, 'binary_recall': 0.05909798, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.11111111}
confusion matrix:
       0   1
0  18146   3
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.99992996, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_20.png
new oracle model saved
early stop counter: 12
val acc:0.9676458239555359, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9992625117301941
after epoch: 20,now: 2024-06-11 04:18:05.464499,epoch time: 0:34:56.389602,used: 11:51:58.163632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9993795, 'precision': 0.99965763, 'recall': 0.9967158, 'specificity': 0.9967158, 'f1': 0.99818116, 'auroc': 0.9999528, 'binary_precision': 1.0, 'binary_recall': 0.9934315, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967049}
confusion matrix:
       0     1
0  42321     0
1     29  4386
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.97172576, 'recall': 0.53107667, 'specificity': 0.53107667, 'f1': 0.5502953, 'auroc': 0.96448916, 'binary_precision': 0.9756098, 'binary_recall': 0.0622084, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.116959065}
confusion matrix:
       0   1
0  18148   1
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.99998057, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_21.png
early stop counter: 13
val acc:0.9678586721420288, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9992625117301941
after epoch: 21,now: 2024-06-11 04:53:10.861597,epoch time: 0:35:05.397098,used: 12:27:03.560730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9995868, 'recall': 0.99603444, 'specificity': 0.99603444, 'f1': 0.9978027, 'auroc': 0.9999472, 'binary_precision': 1.0, 'binary_recall': 0.9920689, 'binary_specificity': 1.0, 'binary_f1_score': 0.99601865}
confusion matrix:
       0     1
0  42323     0
1     35  4378
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.9627055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99941003, 'precision': 0.9996667, 'recall': 0.9974457, 'specificity': 0.9974457, 'f1': 0.9985529, 'auroc': 0.9999689, 'binary_precision': 1.0, 'binary_recall': 0.99489146, 'binary_specificity': 1.0, 'binary_f1_score': 0.9974392}
confusion matrix:
      0    1
0  5997    0
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_22.png
new oracle model saved
early stop counter: 14
val acc:0.9657300710678101, best validation acc: 0.9724350571632385, corresponding to test acc:                         0.9979351162910461 / 0.9994100332260132
after epoch: 22,now: 2024-06-11 05:28:23.565486,epoch time: 0:35:12.703889,used: 13:02:16.264619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9995397, 'recall': 0.99558324, 'specificity': 0.99558324, 'f1': 0.99755156, 'auroc': 0.99993443, 'binary_precision': 1.0, 'binary_recall': 0.9911665, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955636}
confusion matrix:
       0     1
0  42321     0
1     39  4376
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.9413709, 'recall': 0.6092566, 'specificity': 0.6092566, 'f1': 0.6696782, 'auroc': 0.96589106, 'binary_precision': 0.90967745, 'binary_recall': 0.21928461, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.35338348}
confusion matrix:
       0    1
0  18135   14
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9989185, 'recall': 0.9916986, 'specificity': 0.9916986, 'f1': 0.9952732, 'auroc': 0.9998055, 'binary_precision': 1.0, 'binary_recall': 0.9833972, 'binary_specificity': 1.0, 'binary_f1_score': 0.99162906}
confusion matrix:
      0    1
0  5997    0
1    13  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_23.png
better model found
persisted
after epoch: 23,now: 2024-06-11 06:03:45.761133,epoch time: 0:35:22.195647,used: 13:37:38.460266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9982455, 'precision': 0.998826, 'recall': 0.9909164, 'specificity': 0.9909164, 'f1': 0.9948313, 'auroc': 0.999437, 'binary_precision': 0.99953884, 'binary_recall': 0.98187995, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9906307}
confusion matrix:
       0     1
0  42319     2
1     80  4335
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.83603024, 'recall': 0.68064964, 'specificity': 0.68064964, 'f1': 0.7331007, 'auroc': 0.9366356, 'binary_precision': 0.69411767, 'binary_recall': 0.36702955, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.48016277}
confusion matrix:
       0    1
0  18045  104
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.99955654, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_24.png
better model found
persisted
after epoch: 24,now: 2024-06-11 06:39:15.214509,epoch time: 0:35:29.453376,used: 14:13:07.913642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.9995791, 'recall': 0.9970437, 'specificity': 0.9970437, 'f1': 0.99830735, 'auroc': 0.999951, 'binary_precision': 0.9997722, 'binary_recall': 0.994111, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99693364}
confusion matrix:
       0     1
0  42320     1
1     26  4389
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.9651401, 'recall': 0.57376224, 'specificity': 0.57376224, 'f1': 0.62054086, 'auroc': 0.9710927, 'binary_precision': 0.959596, 'binary_recall': 0.14774494, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.25606465}
confusion matrix:
       0   1
0  18145   4
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.99992585, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_25.png
early stop counter: 1
val acc:0.9706258177757263, best validation acc: 0.9728075861930847, corresponding to test acc:                         0.9973451495170593 / 0.9994100332260132
after epoch: 25,now: 2024-06-11 07:14:46.607718,epoch time: 0:35:31.393209,used: 14:48:39.306851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9986734, 'precision': 0.9968251, 'recall': 0.9954139, 'specificity': 0.9954139, 'f1': 0.9961183, 'auroc': 0.9996868, 'binary_precision': 0.9945479, 'binary_recall': 0.99139494, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9929689}
confusion matrix:
       0     1
0  42296    24
1     38  4378
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.8843634, 'recall': 0.6586989, 'specificity': 0.6586989, 'f1': 0.72143567, 'auroc': 0.9606505, 'binary_precision': 0.7923077, 'binary_recall': 0.32037324, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.45625693}
confusion matrix:
       0    1
0  18095   54
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.99921995, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_26.png
better model found
persisted
after epoch: 26,now: 2024-06-11 07:50:13.314138,epoch time: 0:35:26.706420,used: 15:24:06.013271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.9993396, 'recall': 0.9969068, 'specificity': 0.9969068, 'f1': 0.9981195, 'auroc': 0.9998566, 'binary_precision': 0.9993168, 'binary_recall': 0.9938845, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9965933}
confusion matrix:
       0     1
0  42318     3
1     27  4388
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.94306374, 'recall': 0.6208931, 'specificity': 0.6208931, 'f1': 0.68481994, 'auroc': 0.9625219, 'binary_precision': 0.9122807, 'binary_recall': 0.24261275, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.38329238}
confusion matrix:
       0    1
0  18134   15
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.9998054, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_27.png
early stop counter: 1
val acc:0.973286509513855, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9979351162910461 / 0.9994100332260132
after epoch: 27,now: 2024-06-11 08:25:51.790808,epoch time: 0:35:38.476670,used: 15:59:44.489941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99850225, 'precision': 0.99824834, 'recall': 0.99298227, 'specificity': 0.99298227, 'f1': 0.9955977, 'auroc': 0.9998238, 'binary_precision': 0.99793625, 'binary_recall': 0.9861772, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9920219}
confusion matrix:
       0     1
0  42314     9
1     61  4352
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6974716, 'recall': 0.50889045, 'specificity': 0.50889045, 'f1': 0.5091199, 'auroc': 0.9441434, 'binary_precision': 0.42857143, 'binary_recall': 0.01866252, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.03576751}
confusion matrix:
       0   1
0  18133  16
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.9990548, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_28.png
early stop counter: 2
val acc:0.9655704498291016, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9979351162910461 / 0.9994100332260132
after epoch: 28,now: 2024-06-11 09:01:16.863115,epoch time: 0:35:25.072307,used: 16:35:09.562248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.99941, 'recall': 0.9943375, 'specificity': 0.9943375, 'f1': 0.9968574, 'auroc': 0.999915, 'binary_precision': 1.0, 'binary_recall': 0.988675, 'binary_specificity': 1.0, 'binary_f1_score': 0.99430525}
confusion matrix:
       0     1
0  42321     0
1     50  4365
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.98314875, 'recall': 0.507776, 'specificity': 0.507776, 'f1': 0.5067439, 'auroc': 0.9574462, 'binary_precision': 1.0, 'binary_recall': 0.0155521, 'binary_specificity': 1.0, 'binary_f1_score': 0.030627873}
confusion matrix:
       0   1
0  18149   0
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.9998827, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_29.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9979351162910461 / 0.9994100332260132
after epoch: 29,now: 2024-06-11 09:36:52.257642,epoch time: 0:35:35.394527,used: 17:10:44.956775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99957204, 'precision': 0.9996619, 'recall': 0.997836, 'specificity': 0.997836, 'f1': 0.99874675, 'auroc': 0.99994576, 'binary_precision': 0.99977255, 'binary_recall': 0.99569553, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99772984}
confusion matrix:
       0     1
0  42321     1
1     19  4395
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.9164024, 'recall': 0.5394375, 'specificity': 0.5394375, 'f1': 0.56451553, 'auroc': 0.93786955, 'binary_precision': 0.86440676, 'binary_recall': 0.07931571, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.14529914}
confusion matrix:
       0   1
0  18141   8
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.999925, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_30.png
early stop counter: 4
val acc:0.9680715203285217, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9979351162910461 / 0.9994100332260132
after epoch: 30,now: 2024-06-11 10:12:23.842197,epoch time: 0:35:31.584555,used: 17:46:16.541330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:46:16.541330 at 2024-06-11 10:12:23.842197
persisted model performance metric: 

scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.99981, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
oracle model performance metric: 

scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.9999621, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      5 MiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430142 KiB |    863 MiB | 443139 GiB | 443139 GiB |
|       from large pool | 410304 KiB |    862 MiB | 429400 GiB | 429399 GiB |
|       from small pool |  19838 KiB |     21 MiB |  13739 GiB |  13739 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3558    |    6725    |  162363 K  |  162359 K  |
|       from large pool |     247    |     989    |   66807 K  |   66807 K  |
|       from small pool |    3311    |    6476    |   95555 K  |   95552 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3558    |    6725    |  162363 K  |  162359 K  |
|       from large pool |     247    |     989    |   66807 K  |   66807 K  |
|       from small pool |    3311    |    6476    |   95555 K  |   95552 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    3056    |   96881 K  |   96881 K  |
|       from large pool |     112    |     516    |   50600 K  |   50599 K  |
|       from small pool |      32    |    2944    |   46281 K  |   46281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443140 GiB | 443140 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429401 GiB | 429401 GiB |
|       from small pool |      0 KiB |     25 MiB |  13739 GiB |  13739 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162363 K  |  162363 K  |
|       from large pool |       2    |     989    |   66807 K  |   66807 K  |
|       from small pool |       0    |    6476    |   95555 K  |   95555 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162363 K  |  162363 K  |
|       from large pool |       2    |     989    |   66807 K  |   66807 K  |
|       from small pool |       0    |    6476    |   95555 K  |   95555 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96882 K  |   96882 K  |
|       from large pool |       2    |     516    |   50600 K  |   50600 K  |
|       from small pool |       0    |    2944    |   46282 K  |   46282 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443140 GiB | 443140 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429401 GiB | 429401 GiB |
|       from small pool |      0 KiB |     25 MiB |  13739 GiB |  13739 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162363 K  |  162363 K  |
|       from large pool |       2    |     989    |   66807 K  |   66807 K  |
|       from small pool |       0    |    6476    |   95555 K  |   95555 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162363 K  |  162363 K  |
|       from large pool |       2    |     989    |   66807 K  |   66807 K  |
|       from small pool |       0    |    6476    |   95555 K  |   95555 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96882 K  |   96882 K  |
|       from large pool |       2    |     516    |   50600 K  |   50600 K  |
|       from small pool |       0    |    2944    |   46282 K  |   46282 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199

 Experiment start at: 2024-06-11 10:19:06.191946
before training, model accuracy: 0.12533451616764069
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99439406, 'precision': 0.9745515, 'recall': 0.9931747, 'specificity': 0.9931747, 'f1': 0.9836364, 'auroc': 0.99959654, 'binary_precision': 0.9499557, 'binary_recall': 0.99167824, 'binary_specificity': 0.99467105, 'binary_f1_score': 0.9703687}
confusion matrix:
       0     1
0  42184   226
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7250079, 'recall': 0.73625106, 'specificity': 0.73625106, 'f1': 0.7304745, 'auroc': 0.9034699, 'binary_precision': 0.46892655, 'binary_recall': 0.49331352, 'binary_specificity': 0.97918856, 'binary_f1_score': 0.48081097}
confusion matrix:
       0    1
0  17691  376
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910794, 'precision': 0.9660068, 'recall': 0.99272686, 'specificity': 0.99272686, 'f1': 0.9788558, 'auroc': 0.99902695, 'binary_precision': 0.9326923, 'binary_recall': 0.9948718, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.9627791}
confusion matrix:
      0    1
0  5890   56
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 10:55:46.252106,epoch time: 0:36:40.060160,used: 0:36:40.060160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9972398, 'precision': 0.99837637, 'recall': 0.98519397, 'specificity': 0.98519397, 'f1': 0.99167466, 'auroc': 0.9990437, 'binary_precision': 0.9997618, 'binary_recall': 0.9704115, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.984868}
confusion matrix:
       0     1
0  42409     1
1    128  4198
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.89922166, 'recall': 0.51474816, 'specificity': 0.51474816, 'f1': 0.51976365, 'auroc': 0.93013227, 'binary_precision': 0.8333333, 'binary_recall': 0.029717682, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.057388812}
confusion matrix:
       0   1
0  18063   4
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.99874383, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 11:31:21.482450,epoch time: 0:35:35.230344,used: 1:12:15.290504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99685466, 'precision': 0.99827296, 'recall': 0.98300576, 'specificity': 0.98300576, 'f1': 0.99049103, 'auroc': 0.99946773, 'binary_precision': 1.0, 'binary_recall': 0.9660116, 'binary_specificity': 1.0, 'binary_f1_score': 0.98271203}
confusion matrix:
       0     1
0  42411     0
1    147  4178
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.5534923, 'recall': 0.50057685, 'specificity': 0.50057685, 'f1': 0.49225864, 'auroc': 0.9066979, 'binary_precision': 0.14285715, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.0029411765}
confusion matrix:
       0  1
0  18061  6
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99824035, 'recall': 0.98653847, 'specificity': 0.98653847, 'f1': 0.992296, 'auroc': 0.99986184, 'binary_precision': 1.0, 'binary_recall': 0.97307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.98635477}
confusion matrix:
      0    1
0  5946    0
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_3.png
new oracle model saved
early stop counter: 1
val acc:0.9638206958770752, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9962830543518066 / 0.9968777894973755
after epoch: 3,now: 2024-06-11 12:06:30.815372,epoch time: 0:35:09.332922,used: 1:47:24.623426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9979459, 'precision': 0.99887073, 'recall': 0.98890173, 'specificity': 0.98890173, 'f1': 0.99382335, 'auroc': 0.99984825, 'binary_precision': 1.0, 'binary_recall': 0.97780347, 'binary_specificity': 1.0, 'binary_f1_score': 0.98877716}
confusion matrix:
       0     1
0  42411     0
1     96  4229
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.93865263, 'recall': 0.5303499, 'specificity': 0.5303499, 'f1': 0.54845285, 'auroc': 0.93585134, 'binary_precision': 0.9111111, 'binary_recall': 0.060921248, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.11420612}
confusion matrix:
       0   1
0  18063   4
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.9992309, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 12:41:30.200363,epoch time: 0:34:59.384991,used: 2:22:24.008417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9978175, 'precision': 0.9988004, 'recall': 0.98820806, 'specificity': 0.98820806, 'f1': 0.9934331, 'auroc': 0.9998471, 'binary_precision': 1.0, 'binary_recall': 0.9764162, 'binary_specificity': 1.0, 'binary_f1_score': 0.9880674}
confusion matrix:
       0     1
0  42411     0
1    102  4223
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.9248135, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99509364, 'precision': 0.9972403, 'recall': 0.9788462, 'specificity': 0.9788462, 'f1': 0.98781085, 'auroc': 0.99957764, 'binary_precision': 1.0, 'binary_recall': 0.9576923, 'binary_specificity': 1.0, 'binary_f1_score': 0.97838897}
confusion matrix:
      0    1
0  5946    0
1    33  747
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_5.png
early stop counter: 1
val acc:0.9639807939529419, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9964317679405212 / 0.9968777894973755
after epoch: 5,now: 2024-06-11 13:17:12.726804,epoch time: 0:35:42.526441,used: 2:58:06.534858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9981171, 'precision': 0.99875236, 'recall': 0.9900365, 'specificity': 0.9900365, 'f1': 0.9943464, 'auroc': 0.9997939, 'binary_precision': 0.9995285, 'binary_recall': 0.9801202, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9897292}
confusion matrix:
       0     1
0  42408     2
1     86  4240
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73209333, 'recall': 0.5014305, 'specificity': 0.5014305, 'f1': 0.49381095, 'auroc': 0.9490785, 'binary_precision': 0.5, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0059084194}
confusion matrix:
       0  1
0  18065  2
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.9988687, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_6.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9964317679405212 / 0.9968777894973755
after epoch: 6,now: 2024-06-11 13:53:40.624824,epoch time: 0:36:27.898020,used: 3:34:34.432878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9943698, 'recall': 0.9941646, 'specificity': 0.9941646, 'f1': 0.99426717, 'auroc': 0.999756, 'binary_precision': 0.98982424, 'binary_recall': 0.9893666, 'binary_specificity': 0.9989625, 'binary_f1_score': 0.98959535}
confusion matrix:
       0     1
0  42366    44
1     46  4280
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7461333, 'recall': 0.76858497, 'specificity': 0.76858497, 'f1': 0.7568086, 'auroc': 0.9400713, 'binary_precision': 0.5088195, 'binary_recall': 0.5572065, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.5319149}
confusion matrix:
       0    1
0  17705  362
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99777937, 'recall': 0.99278057, 'specificity': 0.99278057, 'f1': 0.995263, 'auroc': 0.999489, 'binary_precision': 0.99740595, 'binary_recall': 0.9858974, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.99161834}
confusion matrix:
      0    1
0  5944    2
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_7.png
new oracle model saved
early stop counter: 3
val acc:0.9647812247276306, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9964317679405212 / 0.9980672001838684
after epoch: 7,now: 2024-06-11 14:28:38.516721,epoch time: 0:34:57.891897,used: 4:09:32.324775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9977747, 'precision': 0.99227166, 'recall': 0.99451846, 'specificity': 0.99451846, 'f1': 0.9933919, 'auroc': 0.9996749, 'binary_precision': 0.9855106, 'binary_recall': 0.99052244, 'binary_specificity': 0.9985145, 'binary_f1_score': 0.98801017}
confusion matrix:
       0     1
0  42347    63
1     41  4285
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.72375333, 'recall': 0.69996613, 'specificity': 0.69996613, 'f1': 0.7111075, 'auroc': 0.9344982, 'binary_precision': 0.4691152, 'binary_recall': 0.41753343, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.4418239}
confusion matrix:
       0    1
0  17749  318
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.999457, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_8.png
early stop counter: 4
val acc:0.9621131420135498, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9964317679405212 / 0.9980672001838684
after epoch: 8,now: 2024-06-11 15:03:17.205302,epoch time: 0:34:38.688581,used: 4:44:11.013356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.9994112, 'recall': 0.994221, 'specificity': 0.994221, 'f1': 0.9967991, 'auroc': 0.9998972, 'binary_precision': 1.0, 'binary_recall': 0.988442, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941874}
confusion matrix:
       0     1
0  42410     0
1     50  4276
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.9432535, 'recall': 0.550354, 'specificity': 0.550354, 'f1': 0.582714, 'auroc': 0.94017476, 'binary_precision': 0.9189189, 'binary_recall': 0.10104012, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.18206158}
confusion matrix:
       0   1
0  18061   6
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.999066, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_9.png
better model found
persisted
after epoch: 9,now: 2024-06-11 15:38:14.190819,epoch time: 0:34:56.985517,used: 5:19:07.998873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99905854, 'precision': 0.9989581, 'recall': 0.99543345, 'specificity': 0.99543345, 'f1': 0.9971879, 'auroc': 0.9999099, 'binary_precision': 0.998835, 'binary_recall': 0.99098474, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9948944}
confusion matrix:
       0     1
0  42405     5
1     39  4287
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.94954836, 'recall': 0.55038166, 'specificity': 0.55038166, 'f1': 0.58284986, 'auroc': 0.9329678, 'binary_precision': 0.9315069, 'binary_recall': 0.10104012, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.18230563}
confusion matrix:
       0   1
0  18062   5
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.9980043, 'recall': 0.9896595, 'specificity': 0.9896595, 'f1': 0.99378455, 'auroc': 0.9997184, 'binary_precision': 0.9986928, 'binary_recall': 0.9794872, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9889968}
confusion matrix:
      0    1
0  5945    1
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_10.png
better model found
persisted
after epoch: 10,now: 2024-06-11 16:13:07.401418,epoch time: 0:34:53.210599,used: 5:54:01.209472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9995406, 'recall': 0.99549234, 'specificity': 0.99549234, 'f1': 0.9975062, 'auroc': 0.99971235, 'binary_precision': 1.0, 'binary_recall': 0.99098474, 'binary_specificity': 1.0, 'binary_f1_score': 0.995472}
confusion matrix:
       0     1
0  42410     0
1     39  4287
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.93638074, 'recall': 0.55624217, 'specificity': 0.55624217, 'f1': 0.592159, 'auroc': 0.9663789, 'binary_precision': 0.9047619, 'binary_recall': 0.11292719, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.2007926}
confusion matrix:
       0   1
0  18059   8
1    597  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99998665, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-11 16:48:45.011137,epoch time: 0:35:37.609719,used: 6:29:38.819191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.99932134, 'recall': 0.9967284, 'specificity': 0.9967284, 'f1': 0.99802065, 'auroc': 0.9999195, 'binary_precision': 0.9993025, 'binary_recall': 0.99352753, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9964067}
confusion matrix:
       0     1
0  42407     3
1     28  4298
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7439802, 'recall': 0.5165065, 'specificity': 0.5165065, 'f1': 0.5229521, 'auroc': 0.9170755, 'binary_precision': 0.52272725, 'binary_recall': 0.034175333, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.064156204}
confusion matrix:
       0   1
0  18046  21
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.9999902, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_12.png
new oracle model saved
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9677160978317261, corresponding to test acc:                         0.9985132217407227 / 0.9986619353294373
after epoch: 12,now: 2024-06-11 17:23:49.980797,epoch time: 0:35:04.969660,used: 7:04:43.788851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98117083, 'precision': 0.91657543, 'recall': 0.9874455, 'specificity': 0.9874455, 'f1': 0.9483962, 'auroc': 0.9996424, 'binary_precision': 0.8336561, 'binary_recall': 0.9951456, 'binary_specificity': 0.9797453, 'binary_f1_score': 0.90727085}
confusion matrix:
       0     1
0  41551   859
1     21  4305
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7336926, 'recall': 0.70918584, 'specificity': 0.70918584, 'f1': 0.72067785, 'auroc': 0.92293495, 'binary_precision': 0.48833334, 'binary_recall': 0.43536404, 'binary_specificity': 0.98300767, 'binary_f1_score': 0.46032995}
confusion matrix:
       0    1
0  17760  307
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.99986994, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_13.png
new oracle model saved
early stop counter: 2
val acc:0.9633404612541199, best validation acc: 0.9677160978317261, corresponding to test acc:                         0.9985132217407227 / 0.9988105893135071
after epoch: 13,now: 2024-06-11 17:59:16.687991,epoch time: 0:35:26.707194,used: 7:40:10.496045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.999576, 'recall': 0.9958391, 'specificity': 0.9958391, 'f1': 0.9976987, 'auroc': 0.9998648, 'binary_precision': 1.0, 'binary_recall': 0.99167824, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958217}
confusion matrix:
       0     1
0  42410     0
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.8541337, 'recall': 0.5190674, 'specificity': 0.5190674, 'f1': 0.5278033, 'auroc': 0.9586931, 'binary_precision': 0.74285716, 'binary_recall': 0.038632985, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.073446326}
confusion matrix:
       0   1
0  18058   9
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.9999634, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_14.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9677160978317261, corresponding to test acc:                         0.9985132217407227 / 0.9988105893135071
after epoch: 14,now: 2024-06-11 18:34:19.789422,epoch time: 0:35:03.101431,used: 8:15:13.597476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.99947, 'recall': 0.9947989, 'specificity': 0.9947989, 'f1': 0.99712074, 'auroc': 0.999861, 'binary_precision': 1.0, 'binary_recall': 0.9895978, 'binary_specificity': 1.0, 'binary_f1_score': 0.9947717}
confusion matrix:
       0     1
0  42410     0
1     45  4281
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.92933476, 'recall': 0.5658174, 'specificity': 0.5658174, 'f1': 0.6070311, 'auroc': 0.9525895, 'binary_precision': 0.89, 'binary_recall': 0.13224368, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.23027167}
confusion matrix:
       0   1
0  18056  11
1    584  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.9999767, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_15.png
better model found
persisted
after epoch: 15,now: 2024-06-11 19:09:18.508376,epoch time: 0:34:58.718954,used: 8:50:12.316430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99918693, 'precision': 0.99955237, 'recall': 0.995608, 'specificity': 0.995608, 'f1': 0.9975704, 'auroc': 0.9999101, 'binary_precision': 1.0, 'binary_recall': 0.9912159, 'binary_specificity': 1.0, 'binary_f1_score': 0.99558854}
confusion matrix:
       0     1
0  42410     0
1     38  4288
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.9412247, 'recall': 0.52443403, 'specificity': 0.52443403, 'f1': 0.5378011, 'auroc': 0.9607683, 'binary_precision': 0.9166667, 'binary_recall': 0.049034175, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.09308885}
confusion matrix:
       0   1
0  18064   3
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9999678, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_16.png
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.9682497382164001, corresponding to test acc:                         0.9983645677566528 / 0.9988105893135071
after epoch: 16,now: 2024-06-11 19:44:17.615136,epoch time: 0:34:59.106760,used: 9:25:11.423190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9994712, 'recall': 0.9959429, 'specificity': 0.9959429, 'f1': 0.99769926, 'auroc': 0.9999, 'binary_precision': 0.999767, 'binary_recall': 0.9919094, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9958227}
confusion matrix:
       0     1
0  42409     1
1     35  4291
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.8955727, 'recall': 0.5140052, 'specificity': 0.5140052, 'f1': 0.5183548, 'auroc': 0.9579264, 'binary_precision': 0.82608694, 'binary_recall': 0.028231798, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.054597702}
confusion matrix:
       0   1
0  18063   4
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.99935484, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_17.png
early stop counter: 2
val acc:0.9648879170417786, best validation acc: 0.9682497382164001, corresponding to test acc:                         0.9983645677566528 / 0.9988105893135071
after epoch: 17,now: 2024-06-11 20:19:13.637919,epoch time: 0:34:56.022783,used: 10:00:07.445973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9993795, 'precision': 0.99965835, 'recall': 0.9966482, 'specificity': 0.9966482, 'f1': 0.99814755, 'auroc': 0.99984264, 'binary_precision': 1.0, 'binary_recall': 0.9932963, 'binary_specificity': 1.0, 'binary_f1_score': 0.99663687}
confusion matrix:
       0     1
0  42410     0
1     29  4297
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.9236045, 'recall': 0.5110888, 'specificity': 0.5110888, 'f1': 0.51276934, 'auroc': 0.9598355, 'binary_precision': 0.88235295, 'binary_recall': 0.022288261, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.04347826}
confusion matrix:
       0   1
0  18065   2
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9999504, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_18.png
early stop counter: 3
val acc:0.9647812247276306, best validation acc: 0.9682497382164001, corresponding to test acc:                         0.9983645677566528 / 0.9988105893135071
after epoch: 18,now: 2024-06-11 20:54:04.139941,epoch time: 0:34:50.502022,used: 10:34:57.947995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9945799, 'recall': 0.9970423, 'specificity': 0.9970423, 'f1': 0.9958073, 'auroc': 0.9999198, 'binary_precision': 0.9896552, 'binary_recall': 0.9951456, 'binary_specificity': 0.9989389, 'binary_f1_score': 0.99239284}
confusion matrix:
       0     1
0  42365    45
1     21  4305
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.759551, 'recall': 0.6935416, 'specificity': 0.6935416, 'f1': 0.72121173, 'auroc': 0.94046855, 'binary_precision': 0.5412475, 'binary_recall': 0.39970282, 'binary_specificity': 0.9873803, 'binary_f1_score': 0.45982906}
confusion matrix:
       0    1
0  17839  228
1    404  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99910796, 'precision': 0.999496, 'recall': 0.99615383, 'specificity': 0.99615383, 'f1': 0.99781734, 'auroc': 0.9997742, 'binary_precision': 1.0, 'binary_recall': 0.99230766, 'binary_specificity': 1.0, 'binary_f1_score': 0.996139}
confusion matrix:
      0    1
0  5946    0
1     6  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_19.png
new oracle model saved
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9682497382164001, corresponding to test acc:                         0.9983645677566528 / 0.9991079568862915
after epoch: 19,now: 2024-06-11 21:28:52.702425,epoch time: 0:34:48.562484,used: 11:09:46.510479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99895155, 'precision': 0.999423, 'recall': 0.9943353, 'specificity': 0.9943353, 'f1': 0.99686277, 'auroc': 0.9999374, 'binary_precision': 1.0, 'binary_recall': 0.9886705, 'binary_specificity': 1.0, 'binary_f1_score': 0.994303}
confusion matrix:
       0     1
0  42411     0
1     49  4276
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.9820695, 'recall': 0.5007429, 'specificity': 0.5007429, 'f1': 0.49235475, 'auroc': 0.9598979, 'binary_precision': 1.0, 'binary_recall': 0.0014858841, 'binary_specificity': 1.0, 'binary_f1_score': 0.0029673593}
confusion matrix:
       0  1
0  18067  0
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.9999573, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_20.png
early stop counter: 5
val acc:0.9641408920288086, best validation acc: 0.9682497382164001, corresponding to test acc:                         0.9983645677566528 / 0.9991079568862915
after epoch: 20,now: 2024-06-11 22:03:41.133059,epoch time: 0:34:48.430634,used: 11:44:34.941113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99689746, 'precision': 0.98670566, 'recall': 0.99507296, 'specificity': 0.99507296, 'f1': 0.9908445, 'auroc': 0.99991584, 'binary_precision': 0.9741438, 'binary_recall': 0.99283403, 'binary_specificity': 0.99731195, 'binary_f1_score': 0.98340017}
confusion matrix:
       0     1
0  42296   114
1     31  4295
---- Validation: 
scalar performance:
{'acc': 0.97171825, 'precision': 0.90604687, 'recall': 0.6305598, 'specificity': 0.6305598, 'f1': 0.692985, 'auroc': 0.95756984, 'binary_precision': 0.83886254, 'binary_recall': 0.26300147, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.40045246}
confusion matrix:
       0    1
0  18033   34
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9996979, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_21.png
better model found
persisted
after epoch: 21,now: 2024-06-11 22:38:23.882916,epoch time: 0:34:42.749857,used: 12:19:17.690970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.9994112, 'recall': 0.994221, 'specificity': 0.994221, 'f1': 0.9967991, 'auroc': 0.9999554, 'binary_precision': 1.0, 'binary_recall': 0.988442, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941874}
confusion matrix:
       0     1
0  42410     0
1     50  4276
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.9821981, 'recall': 0.50445765, 'specificity': 0.50445765, 'f1': 0.4997743, 'auroc': 0.9595442, 'binary_precision': 1.0, 'binary_recall': 0.008915304, 'binary_specificity': 1.0, 'binary_f1_score': 0.017673047}
confusion matrix:
       0  1
0  18067  0
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.9998281, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_22.png
early stop counter: 1
val acc:0.9644076824188232, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 22,now: 2024-06-11 23:13:15.007235,epoch time: 0:34:51.124319,used: 12:54:08.815289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.998759, 'precision': 0.99931717, 'recall': 0.9932964, 'specificity': 0.9932964, 'f1': 0.9962839, 'auroc': 0.9999367, 'binary_precision': 1.0, 'binary_recall': 0.9865927, 'binary_specificity': 1.0, 'binary_f1_score': 0.9932511}
confusion matrix:
       0     1
0  42410     0
1     58  4268
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.9322744, 'recall': 0.5066588, 'specificity': 0.5066588, 'f1': 0.5041411, 'auroc': 0.94831216, 'binary_precision': 0.9, 'binary_recall': 0.013372957, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.026354318}
confusion matrix:
       0  1
0  18066  1
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.9999168, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_23.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 23,now: 2024-06-11 23:48:04.839840,epoch time: 0:34:49.832605,used: 13:28:58.647894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9982027, 'precision': 0.99890554, 'recall': 0.9903928, 'specificity': 0.9903928, 'f1': 0.9946034, 'auroc': 0.9996805, 'binary_precision': 0.9997643, 'binary_recall': 0.9808093, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99019605}
confusion matrix:
       0     1
0  42410     1
1     83  4242
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.9197229, 'recall': 0.5051729, 'specificity': 0.5051729, 'f1': 0.5012163, 'auroc': 0.94130695, 'binary_precision': 0.875, 'binary_recall': 0.010401188, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.020558001}
confusion matrix:
       0  1
0  18066  1
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994945, 'precision': 0.9971572, 'recall': 0.9782051, 'specificity': 0.9782051, 'f1': 0.98743427, 'auroc': 0.9998609, 'binary_precision': 1.0, 'binary_recall': 0.9564102, 'binary_specificity': 1.0, 'binary_f1_score': 0.97771955}
confusion matrix:
      0    1
0  5946    0
1    34  746
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_24.png
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 24,now: 2024-06-12 00:23:50.392590,epoch time: 0:35:45.552750,used: 14:04:44.200644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99886596, 'precision': 0.9990606, 'recall': 0.99418426, 'specificity': 0.99418426, 'f1': 0.9966074, 'auroc': 0.9999702, 'binary_precision': 0.99929875, 'binary_recall': 0.9884393, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9938393}
confusion matrix:
       0     1
0  42408     3
1     50  4275
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.63598424, 'recall': 0.5027227, 'specificity': 0.5027227, 'f1': 0.4966175, 'auroc': 0.9483911, 'binary_precision': 0.30769232, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.011661808}
confusion matrix:
       0  1
0  18058  9
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.9999248, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_25.png
early stop counter: 4
val acc:0.9638206958770752, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 25,now: 2024-06-12 00:59:19.095628,epoch time: 0:35:28.703038,used: 14:40:12.903682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9993153, 'precision': 0.999623, 'recall': 0.9963014, 'specificity': 0.9963014, 'f1': 0.9979553, 'auroc': 0.9999609, 'binary_precision': 1.0, 'binary_recall': 0.9926029, 'binary_specificity': 1.0, 'binary_f1_score': 0.99628776}
confusion matrix:
       0     1
0  42410     0
1     32  4294
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.8872396, 'recall': 0.5125193, 'specificity': 0.5125193, 'f1': 0.51552486, 'auroc': 0.96181536, 'binary_precision': 0.8095238, 'binary_recall': 0.02526003, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.048991352}
confusion matrix:
       0   1
0  18063   4
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99984604, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_26.png
early stop counter: 5
val acc:0.9647812247276306, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 26,now: 2024-06-12 01:34:41.770807,epoch time: 0:35:22.675179,used: 15:15:35.578861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99910134, 'precision': 0.99940044, 'recall': 0.9952494, 'specificity': 0.9952494, 'f1': 0.9973141, 'auroc': 0.9999185, 'binary_precision': 0.9997667, 'binary_recall': 0.99052244, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9951231}
confusion matrix:
       0     1
0  42409     1
1     41  4285
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.8731035, 'recall': 0.5389608, 'specificity': 0.5389608, 'f1': 0.5628829, 'auroc': 0.9594023, 'binary_precision': 0.7794118, 'binary_recall': 0.078751855, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.14304993}
confusion matrix:
       0   1
0  18052  15
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.9983238, 'recall': 0.9871795, 'specificity': 0.9871795, 'f1': 0.992667, 'auroc': 0.9992621, 'binary_precision': 1.0, 'binary_recall': 0.974359, 'binary_specificity': 1.0, 'binary_f1_score': 0.987013}
confusion matrix:
      0    1
0  5946    0
1    20  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_27.png
early stop counter: 6
val acc:0.9661152362823486, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 27,now: 2024-06-12 02:09:37.439429,epoch time: 0:34:55.668622,used: 15:50:31.247483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987162, 'precision': 0.9992936, 'recall': 0.9930652, 'specificity': 0.9930652, 'f1': 0.99615496, 'auroc': 0.9998967, 'binary_precision': 1.0, 'binary_recall': 0.98613036, 'binary_specificity': 1.0, 'binary_f1_score': 0.9930168}
confusion matrix:
       0     1
0  42410     0
1     60  4266
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.97054815, 'recall': 0.52894706, 'specificity': 0.52894706, 'f1': 0.546063, 'auroc': 0.9621626, 'binary_precision': 0.975, 'binary_recall': 0.05794948, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.10939692}
confusion matrix:
       0   1
0  18066   1
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99989843, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_28.png
early stop counter: 7
val acc:0.9661152362823486, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 28,now: 2024-06-12 02:44:49.913424,epoch time: 0:35:12.473995,used: 16:25:43.721478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9986372, 'recall': 0.99677324, 'specificity': 0.99677324, 'f1': 0.9977031, 'auroc': 0.99974024, 'binary_precision': 0.99791086, 'binary_recall': 0.9937587, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9958305}
confusion matrix:
       0     1
0  42401     9
1     27  4299
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7459317, 'recall': 0.5861088, 'specificity': 0.5861088, 'f1': 0.62382734, 'auroc': 0.9227592, 'binary_precision': 0.5217391, 'binary_recall': 0.17830609, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.26578072}
confusion matrix:
       0    1
0  17957  110
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.99974984, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_29.png
early stop counter: 8
val acc:0.9646211266517639, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 29,now: 2024-06-12 03:19:39.216475,epoch time: 0:34:49.303051,used: 17:00:33.024529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99888736, 'precision': 0.99938774, 'recall': 0.9939884, 'specificity': 0.9939884, 'f1': 0.9966697, 'auroc': 0.99993086, 'binary_precision': 1.0, 'binary_recall': 0.98797685, 'binary_specificity': 1.0, 'binary_f1_score': 0.9939521}
confusion matrix:
       0     1
0  42411     0
1     52  4273
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.96660876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.9999342, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_30.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9717182517051697, corresponding to test acc:                         0.9982158541679382 / 0.9991079568862915
after epoch: 30,now: 2024-06-12 03:54:22.480715,epoch time: 0:34:43.264240,used: 17:35:16.288769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_10_19_06_seed_1_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:35:16.288769 at 2024-06-12 03:54:22.480715
persisted model performance metric: 

scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9995623, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
oracle model performance metric: 

scalar performance:
{'acc': 0.99895924, 'precision': 0.99941206, 'recall': 0.99551284, 'specificity': 0.99551284, 'f1': 0.99745214, 'auroc': 0.9995429, 'binary_precision': 1.0, 'binary_recall': 0.9910256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954926}
confusion matrix:
      0    1
0  5946    0
1     7  773
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      5 MiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397079 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool | 377232 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |  19847 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6725    |  324789 K  |  324786 K  |
|       from large pool |     247    |     989    |  133677 K  |  133677 K  |
|       from small pool |    3293    |    6476    |  191111 K  |  191108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6725    |  324789 K  |  324786 K  |
|       from large pool |     247    |     989    |  133677 K  |  133677 K  |
|       from small pool |    3293    |    6476    |  191111 K  |  191108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    3056    |  192347 K  |  192347 K  |
|       from large pool |     107    |     516    |  100168 K  |  100167 K  |
|       from small pool |      37    |    2944    |   92179 K  |   92179 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324789 K  |  324789 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191111 K  |  191111 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324789 K  |  324789 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191111 K  |  191111 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  192349 K  |  192349 K  |
|       from large pool |       2    |     516    |  100168 K  |  100168 K  |
|       from small pool |       0    |    2944    |   92181 K  |   92181 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324789 K  |  324789 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191111 K  |  191111 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324789 K  |  324789 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191111 K  |  191111 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  192349 K  |  192349 K  |
|       from large pool |       2    |     516    |  100168 K  |  100168 K  |
|       from small pool |       0    |    2944    |   92181 K  |   92181 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199

 Experiment start at: 2024-06-12 04:00:26.043693
before training, model accuracy: 0.18399523198604584
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99622184, 'precision': 0.9949753, 'recall': 0.9833541, 'specificity': 0.9833541, 'f1': 0.98907727, 'auroc': 0.99864495, 'binary_precision': 0.9934389, 'binary_recall': 0.9673937, 'binary_specificity': 0.99931455, 'binary_f1_score': 0.9802433}
confusion matrix:
       0     1
0  42280    29
1    148  4391
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.7719376, 'recall': 0.7111916, 'specificity': 0.7111916, 'f1': 0.73738444, 'auroc': 0.92775977, 'binary_precision': 0.5625, 'binary_recall': 0.43355483, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.48968107}
confusion matrix:
       0    1
0  17968  203
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.9982047, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-12 04:36:21.324091,epoch time: 0:35:55.280398,used: 0:35:55.280398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.997097, 'precision': 0.99819446, 'recall': 0.9852154, 'specificity': 0.9852154, 'f1': 0.99159646, 'auroc': 0.99970716, 'binary_precision': 0.9995462, 'binary_recall': 0.97047806, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98479766}
confusion matrix:
       0     1
0  42307     2
1    134  4405
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.48394668, 'recall': 0.49936712, 'specificity': 0.49936712, 'f1': 0.491536, 'auroc': 0.9292388, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18148  23
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956865, 'precision': 0.99759376, 'recall': 0.98002756, 'specificity': 0.98002756, 'f1': 0.98860425, 'auroc': 0.9997486, 'binary_precision': 1.0, 'binary_recall': 0.9600551, 'binary_specificity': 1.0, 'binary_f1_score': 0.9796205}
confusion matrix:
      0    1
0  5997    0
1    29  697
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_2.png
early stop counter: 1
val acc:0.9667075276374817, best validation acc: 0.9710221886634827, corresponding to test acc:                         0.9967276453971863 / 0.9967276453971863
after epoch: 2,now: 2024-06-12 05:11:08.690737,epoch time: 0:34:47.366646,used: 1:10:42.647044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9987193, 'precision': 0.99869454, 'recall': 0.99398065, 'specificity': 0.99398065, 'f1': 0.99632347, 'auroc': 0.99964476, 'binary_precision': 0.998664, 'binary_recall': 0.9881031, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9933555}
confusion matrix:
       0     1
0  42303     6
1     54  4485
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.79134285, 'recall': 0.56504184, 'specificity': 0.56504184, 'f1': 0.60135794, 'auroc': 0.9257586, 'binary_precision': 0.610687, 'binary_recall': 0.13289036, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.21828102}
confusion matrix:
       0   1
0  18120  51
1    522  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9978416, 'recall': 0.9820937, 'specificity': 0.9820937, 'f1': 0.98980206, 'auroc': 0.99933505, 'binary_precision': 1.0, 'binary_recall': 0.9641873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817672}
confusion matrix:
      0    1
0  5997    0
1    26  700
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_3.png
early stop counter: 2
val acc:0.9694774150848389, best validation acc: 0.9710221886634827, corresponding to test acc:                         0.9967276453971863 / 0.9967276453971863
after epoch: 3,now: 2024-06-12 05:45:53.211515,epoch time: 0:34:44.520778,used: 1:45:27.167822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99773735, 'precision': 0.99875045, 'recall': 0.9883208, 'specificity': 0.9883208, 'f1': 0.9934659, 'auroc': 0.99987984, 'binary_precision': 1.0, 'binary_recall': 0.9766417, 'binary_specificity': 1.0, 'binary_f1_score': 0.9881829}
confusion matrix:
       0     1
0  42310     0
1    106  4432
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.48396206, 'recall': 0.49986243, 'specificity': 0.49986243, 'f1': 0.49178377, 'auroc': 0.92841244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18166  5
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956865, 'precision': 0.99759376, 'recall': 0.98002756, 'specificity': 0.98002756, 'f1': 0.98860425, 'auroc': 0.9999343, 'binary_precision': 1.0, 'binary_recall': 0.9600551, 'binary_specificity': 1.0, 'binary_f1_score': 0.9796205}
confusion matrix:
      0    1
0  5997    0
1    29  697
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_4.png
early stop counter: 3
val acc:0.9676663279533386, best validation acc: 0.9710221886634827, corresponding to test acc:                         0.9967276453971863 / 0.9967276453971863
after epoch: 4,now: 2024-06-12 06:20:43.246799,epoch time: 0:34:50.035284,used: 2:20:17.203106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99884737, 'precision': 0.9991634, 'recall': 0.9942483, 'specificity': 0.9942483, 'f1': 0.9966904, 'auroc': 0.9998872, 'binary_precision': 0.99955446, 'binary_recall': 0.98854375, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9940187}
confusion matrix:
       0     1
0  42307     2
1     52  4487
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.75801456, 'recall': 0.5541069, 'specificity': 0.5541069, 'f1': 0.5843885, 'auroc': 0.8659338, 'binary_precision': 0.54471546, 'binary_recall': 0.11129568, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.18482758}
confusion matrix:
       0   1
0  18115  56
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9997912, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_5.png
new oracle model saved
early stop counter: 4
val acc:0.9685186147689819, best validation acc: 0.9710221886634827, corresponding to test acc:                         0.9967276453971863 / 0.9986613392829895
after epoch: 5,now: 2024-06-12 06:55:32.304173,epoch time: 0:34:49.057374,used: 2:55:06.260480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99899673, 'precision': 0.9993457, 'recall': 0.99492097, 'specificity': 0.99492097, 'f1': 0.99712086, 'auroc': 0.99989116, 'binary_precision': 0.9997775, 'binary_recall': 0.9898656, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9947969}
confusion matrix:
       0     1
0  42308     1
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.9010175, 'recall': 0.5123759, 'specificity': 0.5123759, 'f1': 0.5162046, 'auroc': 0.94697565, 'binary_precision': 0.8333333, 'binary_recall': 0.024916943, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.048387095}
confusion matrix:
       0   1
0  18168   3
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.99999523, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_6.png
new oracle model saved
early stop counter: 5
val acc:0.9685719013214111, best validation acc: 0.9710221886634827, corresponding to test acc:                         0.9967276453971863 / 0.9995537996292114
after epoch: 6,now: 2024-06-12 07:29:59.434718,epoch time: 0:34:27.130545,used: 3:29:33.391025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.99856544, 'recall': 0.99581784, 'specificity': 0.99581784, 'f1': 0.99718684, 'auroc': 0.99989283, 'binary_precision': 0.99800485, 'binary_recall': 0.9918484, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9949171}
confusion matrix:
       0     1
0  42300     9
1     37  4502
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.88121605, 'recall': 0.5921978, 'specificity': 0.5921978, 'f1': 0.6434728, 'auroc': 0.95543873, 'binary_precision': 0.7887324, 'binary_recall': 0.18604651, 'binary_specificity': 0.998349, 'binary_f1_score': 0.30107528}
confusion matrix:
       0    1
0  18141   30
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.999941, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_7.png
better model found
persisted
after epoch: 7,now: 2024-06-12 08:04:32.358331,epoch time: 0:34:32.923613,used: 4:04:06.314638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99786544, 'precision': 0.99603546, 'recall': 0.99173784, 'specificity': 0.99173784, 'f1': 0.9938748, 'auroc': 0.9997189, 'binary_precision': 0.99377084, 'binary_recall': 0.9841375, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.9889307}
confusion matrix:
       0     1
0  42281    28
1     72  4467
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.73166835, 'recall': 0.8168515, 'specificity': 0.8168515, 'f1': 0.7668488, 'auroc': 0.95301974, 'binary_precision': 0.47482014, 'binary_recall': 0.6578073, 'binary_specificity': 0.97589564, 'binary_f1_score': 0.551532}
confusion matrix:
       0    1
0  17733  438
1    206  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9997636, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_8.png
early stop counter: 1
val acc:0.9656954407691956, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 8,now: 2024-06-12 08:39:35.336752,epoch time: 0:35:02.978421,used: 4:39:09.293059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9986125, 'precision': 0.9991331, 'recall': 0.9929366, 'specificity': 0.9929366, 'f1': 0.9960103, 'auroc': 0.9997151, 'binary_precision': 0.99977654, 'binary_recall': 0.9858969, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9927882}
confusion matrix:
       0     1
0  42309     1
1     64  4474
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.5554156, 'recall': 0.5006655, 'specificity': 0.5006655, 'f1': 0.49342537, 'auroc': 0.91278946, 'binary_precision': 0.14285715, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.0032840718}
confusion matrix:
       0  1
0  18165  6
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9978416, 'recall': 0.9820937, 'specificity': 0.9820937, 'f1': 0.98980206, 'auroc': 0.9999951, 'binary_precision': 1.0, 'binary_recall': 0.9641873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817672}
confusion matrix:
      0    1
0  5997    0
1    26  700
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_9.png
early stop counter: 2
val acc:0.9676663279533386, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 9,now: 2024-06-12 09:14:42.373982,epoch time: 0:35:07.037230,used: 5:14:16.330289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9988687, 'precision': 0.99937445, 'recall': 0.9941617, 'specificity': 0.9941617, 'f1': 0.9967507, 'auroc': 0.9998374, 'binary_precision': 1.0, 'binary_recall': 0.9883234, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941274}
confusion matrix:
       0     1
0  42309     0
1     53  4486
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.8840686, 'recall': 0.50329477, 'specificity': 0.50329477, 'f1': 0.4984818, 'auroc': 0.9341356, 'binary_precision': 0.8, 'binary_recall': 0.006644518, 'binary_specificity': 0.999945, 'binary_f1_score': 0.01317957}
confusion matrix:
       0  1
0  18170  1
1    598  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.9999893, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_10.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 10,now: 2024-06-12 09:50:13.463052,epoch time: 0:35:31.089070,used: 5:49:47.419359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99908215, 'precision': 0.9994924, 'recall': 0.9952612, 'specificity': 0.9952612, 'f1': 0.99736536, 'auroc': 0.99991286, 'binary_precision': 1.0, 'binary_recall': 0.9905224, 'binary_specificity': 1.0, 'binary_f1_score': 0.9952386}
confusion matrix:
       0     1
0  42311     0
1     43  4494
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.8318249, 'recall': 0.52046144, 'specificity': 0.52046144, 'f1': 0.5312192, 'auroc': 0.961852, 'binary_precision': 0.6944444, 'binary_recall': 0.04152824, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.07836991}
confusion matrix:
       0   1
0  18160  11
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9990015, 'recall': 0.9917356, 'specificity': 0.9917356, 'f1': 0.99533355, 'auroc': 0.9999043, 'binary_precision': 1.0, 'binary_recall': 0.9834711, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916667}
confusion matrix:
      0    1
0  5997    0
1    12  714
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_11.png
early stop counter: 4
val acc:0.9686784148216248, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 11,now: 2024-06-12 10:29:15.163029,epoch time: 0:39:01.699977,used: 6:28:49.119336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99899673, 'precision': 0.99884975, 'recall': 0.9954127, 'specificity': 0.9954127, 'f1': 0.9971237, 'auroc': 0.99981266, 'binary_precision': 0.99866784, 'binary_recall': 0.99096715, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9948026}
confusion matrix:
       0     1
0  42303     6
1     41  4498
---- Validation: 
scalar performance:
{'acc': 0.9745912, 'precision': 0.8761803, 'recall': 0.6447761, 'specificity': 0.6447761, 'f1': 0.7058084, 'auroc': 0.9399897, 'binary_precision': 0.7753304, 'binary_recall': 0.29235882, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.42460802}
confusion matrix:
       0    1
0  18120   51
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.99962634, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_12.png
better model found
persisted
after epoch: 12,now: 2024-06-12 11:06:47.938362,epoch time: 0:37:32.775333,used: 7:06:21.894669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99931693, 'precision': 0.99902904, 'recall': 0.99706507, 'specificity': 0.99706507, 'f1': 0.9980446, 'auroc': 0.99993217, 'binary_precision': 0.99867225, 'binary_recall': 0.9942719, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99646723}
confusion matrix:
       0     1
0  42303     6
1     26  4513
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7918039, 'recall': 0.55773187, 'specificity': 0.55773187, 'f1': 0.5910657, 'auroc': 0.9556867, 'binary_precision': 0.61206895, 'binary_recall': 0.1179402, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.1977716}
confusion matrix:
       0   1
0  18126  45
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.9999913, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_13.png
early stop counter: 1
val acc:0.969317615032196, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 13,now: 2024-06-12 11:47:24.331636,epoch time: 0:40:36.393274,used: 7:46:58.287943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99844176, 'precision': 0.9988386, 'recall': 0.9922519, 'specificity': 0.9922519, 'f1': 0.99551755, 'auroc': 0.99968374, 'binary_precision': 0.99932903, 'binary_recall': 0.9845747, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99189705}
confusion matrix:
       0     1
0  42307     3
1     70  4468
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.9355905, 'recall': 0.55213296, 'specificity': 0.55213296, 'f1': 0.5863464, 'auroc': 0.9618314, 'binary_precision': 0.9, 'binary_recall': 0.10465116, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.1875}
confusion matrix:
       0   1
0  18164   7
1    539  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9999867, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_14.png
early stop counter: 2
val acc:0.970915675163269, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 14,now: 2024-06-12 12:24:33.733873,epoch time: 0:37:09.402237,used: 8:24:07.690180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99931693, 'precision': 0.9996221, 'recall': 0.996475, 'specificity': 0.996475, 'f1': 0.9980422, 'auroc': 0.9999667, 'binary_precision': 1.0, 'binary_recall': 0.99294996, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964625}
confusion matrix:
       0     1
0  42309     0
1     32  4507
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.8905492, 'recall': 0.51071477, 'specificity': 0.51071477, 'f1': 0.51302, 'auroc': 0.95564467, 'binary_precision': 0.8125, 'binary_recall': 0.021594685, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.042071197}
confusion matrix:
       0   1
0  18168   3
1    589  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.99999654, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_15.png
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 15,now: 2024-06-12 13:00:45.932508,epoch time: 0:36:12.198635,used: 9:00:19.888815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9975666, 'precision': 0.9893905, 'recall': 0.9968827, 'specificity': 0.9968827, 'f1': 0.99310035, 'auroc': 0.9997653, 'binary_precision': 0.9792073, 'binary_recall': 0.9960344, 'binary_specificity': 0.997731, 'binary_f1_score': 0.9875491}
confusion matrix:
       0     1
0  42213    96
1     18  4521
---- Validation: 
scalar performance:
{'acc': 0.9587706, 'precision': 0.70044124, 'recall': 0.8188957, 'specificity': 0.8188957, 'f1': 0.7443031, 'auroc': 0.95562875, 'binary_precision': 0.41206545, 'binary_recall': 0.6694352, 'binary_specificity': 0.9683562, 'binary_f1_score': 0.5101266}
confusion matrix:
       0    1
0  17596  575
1    199  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.99527854, 'recall': 0.9946788, 'specificity': 0.9946788, 'f1': 0.9949784, 'auroc': 0.99969566, 'binary_precision': 0.99172413, 'binary_recall': 0.9903581, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.99104065}
confusion matrix:
      0    1
0  5991    6
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_16.png
early stop counter: 4
val acc:0.9587705731391907, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 16,now: 2024-06-12 13:44:47.217892,epoch time: 0:44:01.285384,used: 9:44:21.174199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.9941445, 'recall': 0.9968637, 'specificity': 0.9968637, 'f1': 0.9954993, 'auroc': 0.9998008, 'binary_precision': 0.98883295, 'binary_recall': 0.99493283, 'binary_specificity': 0.99879456, 'binary_f1_score': 0.99187344}
confusion matrix:
       0     1
0  42258    51
1     23  4516
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7404529, 'recall': 0.82246774, 'specificity': 0.82246774, 'f1': 0.7747865, 'auroc': 0.95974326, 'binary_precision': 0.49204406, 'binary_recall': 0.6677741, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.56659615}
confusion matrix:
       0    1
0  17756  415
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99341846, 'recall': 0.9958061, 'specificity': 0.9958061, 'f1': 0.9946085, 'auroc': 0.99993825, 'binary_precision': 0.98767126, 'binary_recall': 0.9931129, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.99038464}
confusion matrix:
      0    1
0  5988    9
1     5  721
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_17.png
early stop counter: 5
val acc:0.9672402143478394, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 17,now: 2024-06-12 14:29:01.893753,epoch time: 0:44:14.675861,used: 10:28:35.850060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.999445, 'precision': 0.999594, 'recall': 0.9972336, 'specificity': 0.9972336, 'f1': 0.9984102, 'auroc': 0.99998045, 'binary_precision': 0.99977845, 'binary_recall': 0.994491, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9971277}
confusion matrix:
       0     1
0  42309     1
1     25  4513
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.85235506, 'recall': 0.5385688, 'specificity': 0.5385688, 'f1': 0.5628157, 'auroc': 0.9501381, 'binary_precision': 0.734375, 'binary_recall': 0.07807309, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.14114115}
confusion matrix:
       0   1
0  18154  17
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99910754, 'precision': 0.9995003, 'recall': 0.9958677, 'specificity': 0.9958677, 'f1': 0.9976753, 'auroc': 0.99996257, 'binary_precision': 1.0, 'binary_recall': 0.9917355, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958506}
confusion matrix:
      0    1
0  5997    0
1     6  720
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_18.png
early stop counter: 6
val acc:0.9695307016372681, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 18,now: 2024-06-12 15:08:04.085980,epoch time: 0:39:02.192227,used: 11:07:38.042287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99667007, 'precision': 0.9919157, 'recall': 0.98901093, 'specificity': 0.98901093, 'f1': 0.9904579, 'auroc': 0.9996633, 'binary_precision': 0.98602796, 'binary_recall': 0.9795109, 'binary_specificity': 0.99851096, 'binary_f1_score': 0.98275864}
confusion matrix:
       0     1
0  42246    63
1     93  4446
---- Validation: 
scalar performance:
{'acc': 0.95445585, 'precision': 0.68764794, 'recall': 0.8343339, 'specificity': 0.8343339, 'f1': 0.7373392, 'auroc': 0.9491593, 'binary_precision': 0.3853128, 'binary_recall': 0.70598006, 'binary_specificity': 0.9626878, 'binary_f1_score': 0.49853373}
confusion matrix:
       0    1
0  17493  678
1    177  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9944965, 'precision': 0.9931465, 'recall': 0.9781499, 'specificity': 0.9781499, 'f1': 0.9854965, 'auroc': 0.9989333, 'binary_precision': 0.9914408, 'binary_recall': 0.95730025, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.9740715}
confusion matrix:
      0    1
0  5991    6
1    31  695
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277199_19.png
early stop counter: 7
val acc:0.9544558525085449, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9977688789367676 / 0.9995537996292114
after epoch: 19,now: 2024-06-12 15:54:32.773426,epoch time: 0:46:28.687446,used: 11:54:06.729733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_04_00_26_seed_2_21277199
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
slurmstepd: error: *** JOB 21277199 ON gpusrv51 CANCELLED AT 2024-06-12T16:20:20 DUE TO TIME LIMIT ***
