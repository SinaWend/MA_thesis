Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 18:12:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204

 Experiment start at: 2024-06-10 18:21:21.386053
before training, model accuracy: 0.4373156428337097
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9847227, 'precision': 0.94179934, 'recall': 0.97340745, 'specificity': 0.97340745, 'f1': 0.95690095, 'auroc': 0.9962497, 'binary_precision': 0.8878642, 'binary_recall': 0.9594564, 'binary_specificity': 0.9873585, 'binary_f1_score': 0.92227304}
confusion matrix:
       0     1
0  41786   535
1    179  4236
---- Validation: 
scalar performance:
{'acc': 0.9511494, 'precision': 0.681756, 'recall': 0.80594695, 'specificity': 0.80594695, 'f1': 0.7255019, 'auroc': 0.91511613, 'binary_precision': 0.37623763, 'binary_recall': 0.65007776, 'binary_specificity': 0.9618161, 'binary_f1_score': 0.47662482}
confusion matrix:
       0    1
0  17456  693
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99439526, 'precision': 0.9951, 'recall': 0.97739995, 'specificity': 0.97739995, 'f1': 0.98603415, 'auroc': 0.9958967, 'binary_precision': 0.9960053, 'binary_recall': 0.95530015, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9752282}
confusion matrix:
      0    1
0  5994    3
1    35  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 18:48:02.338553,epoch time: 0:26:40.952500,used: 0:26:40.952500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99638397, 'precision': 0.99263877, 'recall': 0.9861264, 'specificity': 0.9861264, 'f1': 0.98935527, 'auroc': 0.9986068, 'binary_precision': 0.9880377, 'binary_recall': 0.9734814, 'binary_specificity': 0.99877137, 'binary_f1_score': 0.98070556}
confusion matrix:
       0     1
0  42272    52
1    117  4295
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7581348, 'recall': 0.6801999, 'specificity': 0.6801999, 'f1': 0.71152806, 'auroc': 0.93312633, 'binary_precision': 0.5382883, 'binary_recall': 0.3716952, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.43974242}
confusion matrix:
       0    1
0  17944  205
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.9991164, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 19:11:43.287836,epoch time: 0:23:40.949283,used: 0:50:21.901783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.995456, 'recall': 0.9911301, 'specificity': 0.9911301, 'f1': 0.993281, 'auroc': 0.99938405, 'binary_precision': 0.9926824, 'binary_recall': 0.9830163, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.9878257}
confusion matrix:
       0     1
0  42288    32
1     75  4341
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7490112, 'recall': 0.6700084, 'specificity': 0.6700084, 'f1': 0.7012822, 'auroc': 0.9372972, 'binary_precision': 0.52073735, 'binary_recall': 0.35147744, 'binary_specificity': 0.98853934, 'binary_f1_score': 0.41968432}
confusion matrix:
       0    1
0  17941  208
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99734616, 'recall': 0.97956574, 'specificity': 0.97956574, 'f1': 0.9882393, 'auroc': 0.99907786, 'binary_precision': 1.0, 'binary_recall': 0.95913154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9791395}
confusion matrix:
      0    1
0  5997    0
1    32  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_3.png
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9960176944732666
after epoch: 3,now: 2024-06-10 19:35:38.797061,epoch time: 0:23:55.509225,used: 1:14:17.411008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99709004, 'precision': 0.99756074, 'recall': 0.9854095, 'specificity': 0.9854095, 'f1': 0.9913907, 'auroc': 0.9994222, 'binary_precision': 0.99813735, 'binary_recall': 0.97100794, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9843858}
confusion matrix:
       0     1
0  42313     8
1    128  4287
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7391542, 'recall': 0.70996034, 'specificity': 0.70996034, 'f1': 0.72350013, 'auroc': 0.93734324, 'binary_precision': 0.49822065, 'binary_recall': 0.43545878, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.4647303}
confusion matrix:
       0    1
0  17867  282
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9938053, 'precision': 0.9965226, 'recall': 0.97318006, 'specificity': 0.97318006, 'f1': 0.98447573, 'auroc': 0.9996351, 'binary_precision': 1.0, 'binary_recall': 0.9463602, 'binary_specificity': 1.0, 'binary_f1_score': 0.97244096}
confusion matrix:
      0    1
0  5997    0
1    42  741
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_4.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9960176944732666
after epoch: 4,now: 2024-06-10 20:01:48.302071,epoch time: 0:26:09.505010,used: 1:40:26.916018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9977319, 'precision': 0.99607503, 'recall': 0.9906328, 'specificity': 0.9906328, 'f1': 0.993335, 'auroc': 0.9994346, 'binary_precision': 0.99403805, 'binary_recall': 0.98187995, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.98792154}
confusion matrix:
       0     1
0  42295    26
1     80  4335
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.6569553, 'recall': 0.70235664, 'specificity': 0.70235664, 'f1': 0.6763063, 'auroc': 0.9116077, 'binary_precision': 0.3341289, 'binary_recall': 0.43545878, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.37812293}
confusion matrix:
       0    1
0  17591  558
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.99296844, 'recall': 0.98528445, 'specificity': 0.98528445, 'f1': 0.98908585, 'auroc': 0.99977064, 'binary_precision': 0.9895969, 'binary_recall': 0.97190297, 'binary_specificity': 0.998666, 'binary_f1_score': 0.9806701}
confusion matrix:
      0    1
0  5989    8
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_5.png
early stop counter: 3
val acc:0.9509897828102112, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9960176944732666
after epoch: 5,now: 2024-06-10 20:25:43.516459,epoch time: 0:23:55.214388,used: 2:04:22.130406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99486476, 'precision': 0.99718046, 'recall': 0.9728261, 'specificity': 0.9728261, 'f1': 0.98461974, 'auroc': 0.9993988, 'binary_precision': 1.0, 'binary_recall': 0.9456522, 'binary_specificity': 1.0, 'binary_f1_score': 0.972067}
confusion matrix:
       0     1
0  42320     0
1    240  4176
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.782967, 'recall': 0.50227773, 'specificity': 0.50227773, 'f1': 0.49593896, 'auroc': 0.92858994, 'binary_precision': 0.6, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.009259259}
confusion matrix:
       0  1
0  18147  2
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9887906, 'precision': 0.9937428, 'recall': 0.9514687, 'specificity': 0.9514687, 'f1': 0.9713483, 'auroc': 0.99939907, 'binary_precision': 1.0, 'binary_recall': 0.9029374, 'binary_specificity': 1.0, 'binary_f1_score': 0.94899327}
confusion matrix:
      0    1
0  5997    0
1    76  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_6.png
early stop counter: 4
val acc:0.9658365249633789, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9960176944732666
after epoch: 6,now: 2024-06-10 20:49:38.413797,epoch time: 0:23:54.897338,used: 2:28:17.027744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99709004, 'precision': 0.9979787, 'recall': 0.9850037, 'specificity': 0.9850037, 'f1': 0.99138355, 'auroc': 0.9995971, 'binary_precision': 0.99906695, 'binary_recall': 0.97010195, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9843714}
confusion matrix:
       0     1
0  42317     4
1    132  4283
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.5864734, 'recall': 0.50403196, 'specificity': 0.50403196, 'f1': 0.49998838, 'auroc': 0.9241898, 'binary_precision': 0.20689656, 'binary_recall': 0.00933126, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.017857144}
confusion matrix:
       0   1
0  18126  23
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99439526, 'precision': 0.99568033, 'recall': 0.9768448, 'specificity': 0.9768448, 'f1': 0.98601824, 'auroc': 0.99934804, 'binary_precision': 0.9973298, 'binary_recall': 0.954023, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9751958}
confusion matrix:
      0    1
0  5995    2
1    36  747
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_7.png
early stop counter: 5
val acc:0.9648786783218384, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9960176944732666
after epoch: 7,now: 2024-06-10 21:13:36.168918,epoch time: 0:23:57.755121,used: 2:52:14.782865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99756074, 'precision': 0.9964849, 'recall': 0.9892172, 'specificity': 0.9892172, 'f1': 0.99281734, 'auroc': 0.9991569, 'binary_precision': 0.9951635, 'binary_recall': 0.97893065, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.9869804}
confusion matrix:
       0     1
0  42301    21
1     93  4321
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7231724, 'recall': 0.70369065, 'specificity': 0.70369065, 'f1': 0.71293324, 'auroc': 0.937835, 'binary_precision': 0.46666667, 'binary_recall': 0.42457232, 'binary_specificity': 0.98280895, 'binary_f1_score': 0.4446254}
confusion matrix:
       0    1
0  17837  312
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.99970907, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_8.png
new oracle model saved
early stop counter: 6
val acc:0.9637079834938049, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9971976280212402
after epoch: 8,now: 2024-06-10 21:37:46.978192,epoch time: 0:24:10.809274,used: 3:16:25.592139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9982241, 'precision': 0.99758035, 'recall': 0.99202037, 'specificity': 0.99202037, 'f1': 0.99478066, 'auroc': 0.9996976, 'binary_precision': 0.996789, 'binary_recall': 0.9843715, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99054134}
confusion matrix:
       0     1
0  42307    14
1     69  4346
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.6990232, 'recall': 0.51853096, 'specificity': 0.51853096, 'f1': 0.5268381, 'auroc': 0.9271653, 'binary_precision': 0.43103448, 'binary_recall': 0.038880248, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.07132667}
confusion matrix:
       0   1
0  18116  33
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99587023, 'precision': 0.9959521, 'recall': 0.9837856, 'specificity': 0.9837856, 'f1': 0.98976755, 'auroc': 0.9996233, 'binary_precision': 0.9960578, 'binary_recall': 0.9680715, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9818653}
confusion matrix:
      0    1
0  5994    3
1    25  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_9.png
early stop counter: 7
val acc:0.9653576016426086, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9971976280212402
after epoch: 9,now: 2024-06-10 22:01:57.674567,epoch time: 0:24:10.696375,used: 3:40:36.288514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9972826, 'precision': 0.996634, 'recall': 0.98744583, 'specificity': 0.98744583, 'f1': 0.9919859, 'auroc': 0.9993886, 'binary_precision': 0.99583817, 'binary_recall': 0.975317, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.9854707}
confusion matrix:
       0     1
0  42302    18
1    109  4307
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.5301465, 'recall': 0.5025656, 'specificity': 0.5025656, 'f1': 0.4978855, 'auroc': 0.88800585, 'binary_precision': 0.094339624, 'binary_recall': 0.00777605, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.014367816}
confusion matrix:
       0   1
0  18101  48
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.995512, 'recall': 0.9755676, 'specificity': 0.9755676, 'f1': 0.9852656, 'auroc': 0.99886703, 'binary_precision': 0.9973226, 'binary_recall': 0.9514687, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9738562}
confusion matrix:
      0    1
0  5995    2
1    38  745
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_10.png
early stop counter: 8
val acc:0.9634950757026672, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9971976280212402
after epoch: 10,now: 2024-06-10 22:25:48.869239,epoch time: 0:23:51.194672,used: 4:04:27.483186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9962556, 'precision': 0.99794114, 'recall': 0.9801632, 'specificity': 0.9801632, 'f1': 0.9888494, 'auroc': 0.9994483, 'binary_precision': 1.0, 'binary_recall': 0.96032643, 'binary_specificity': 1.0, 'binary_f1_score': 0.9797618}
confusion matrix:
       0     1
0  42325     0
1    175  4236
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.5072978, 'recall': 0.5004808, 'specificity': 0.5004808, 'f1': 0.49370986, 'auroc': 0.9380078, 'binary_precision': 0.048780486, 'binary_recall': 0.00311042, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.0058479533}
confusion matrix:
       0   1
0  18110  39
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9923304, 'precision': 0.9951009, 'recall': 0.9673495, 'specificity': 0.9673495, 'f1': 0.98069084, 'auroc': 0.9993094, 'binary_precision': 0.99863577, 'binary_recall': 0.9348659, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9656992}
confusion matrix:
      0    1
0  5996    1
1    51  732
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_11.png
early stop counter: 9
val acc:0.963814377784729, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9971976280212402
after epoch: 11,now: 2024-06-10 22:50:11.864174,epoch time: 0:24:22.994935,used: 4:28:50.478121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9977747, 'precision': 0.99711925, 'recall': 0.9898404, 'specificity': 0.9898404, 'f1': 0.993446, 'auroc': 0.9996719, 'binary_precision': 0.9963142, 'binary_recall': 0.9800589, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.98811966}
confusion matrix:
       0     1
0  42307    16
1     88  4325
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.78349507, 'recall': 0.51822174, 'specificity': 0.51822174, 'f1': 0.526535, 'auroc': 0.94131994, 'binary_precision': 0.6, 'binary_recall': 0.03732504, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.07027818}
confusion matrix:
       0   1
0  18133  16
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99676424, 'recall': 0.98012096, 'specificity': 0.98012096, 'f1': 0.98825264, 'auroc': 0.9993924, 'binary_precision': 0.998672, 'binary_recall': 0.9604087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9791667}
confusion matrix:
      0    1
0  5996    1
1    31  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_12.png
early stop counter: 10
val acc:0.9662090539932251, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9960176944732666 / 0.9971976280212402
after epoch: 12,now: 2024-06-10 23:14:41.461314,epoch time: 0:24:29.597140,used: 4:53:20.075261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.997123, 'recall': 0.99197125, 'specificity': 0.99197125, 'f1': 0.99453026, 'auroc': 0.99949086, 'binary_precision': 0.9958744, 'binary_recall': 0.9843679, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.99008775}
confusion matrix:
       0     1
0  42304    18
1     69  4345
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.8180529, 'recall': 0.5549958, 'specificity': 0.5549958, 'f1': 0.5876323, 'auroc': 0.9414546, 'binary_precision': 0.6666667, 'binary_recall': 0.11197512, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.19174434}
confusion matrix:
       0   1
0  18113  36
1    571  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.9967208, 'recall': 0.98953277, 'specificity': 0.98953277, 'f1': 0.9930916, 'auroc': 0.99902034, 'binary_precision': 0.9961039, 'binary_recall': 0.9795658, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.98776567}
confusion matrix:
      0    1
0  5994    3
1    16  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_13.png
better model found
persisted
after epoch: 13,now: 2024-06-10 23:39:02.253433,epoch time: 0:24:20.792119,used: 5:17:40.867380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9990152, 'recall': 0.9927267, 'specificity': 0.9927267, 'f1': 0.9958459, 'auroc': 0.99985343, 'binary_precision': 0.99954045, 'binary_recall': 0.9855007, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9924709}
confusion matrix:
       0     1
0  42320     2
1     64  4350
---- Validation: 
scalar performance:
{'acc': 0.97083867, 'precision': 0.8264817, 'recall': 0.6383772, 'specificity': 0.6383772, 'f1': 0.69142985, 'auroc': 0.93986833, 'binary_precision': 0.67790264, 'binary_recall': 0.281493, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.3978022}
confusion matrix:
       0    1
0  18063   86
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9999206, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_14.png
better model found
persisted
after epoch: 14,now: 2024-06-11 00:03:27.099753,epoch time: 0:24:24.846320,used: 5:42:05.713700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.99863476, 'recall': 0.9879837, 'specificity': 0.9879837, 'f1': 0.9932369, 'auroc': 0.99972326, 'binary_precision': 0.99976796, 'binary_recall': 0.97599095, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98773634}
confusion matrix:
       0     1
0  42320     1
1    106  4309
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.90435314, 'recall': 0.512359, 'specificity': 0.512359, 'f1': 0.5156377, 'auroc': 0.94153684, 'binary_precision': 0.84210527, 'binary_recall': 0.02488336, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.048338365}
confusion matrix:
       0   1
0  18146   3
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99587023, 'precision': 0.9976764, 'recall': 0.98212004, 'specificity': 0.98212004, 'f1': 0.98973274, 'auroc': 0.99885726, 'binary_precision': 1.0, 'binary_recall': 0.9642401, 'binary_specificity': 1.0, 'binary_f1_score': 0.98179454}
confusion matrix:
      0    1
0  5997    0
1    28  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_15.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9971976280212402
after epoch: 15,now: 2024-06-11 00:27:09.015780,epoch time: 0:23:41.916027,used: 6:05:47.629727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99505734, 'precision': 0.9786103, 'recall': 0.9932134, 'specificity': 0.9932134, 'f1': 0.9857725, 'auroc': 0.9997176, 'binary_precision': 0.9581691, 'binary_recall': 0.99094, 'binary_specificity': 0.99548686, 'binary_f1_score': 0.97427905}
confusion matrix:
       0     1
0  42130   191
1     40  4375
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74294776, 'recall': 0.69595724, 'specificity': 0.69595724, 'f1': 0.7166586, 'auroc': 0.9318022, 'binary_precision': 0.5067961, 'binary_recall': 0.4059098, 'binary_specificity': 0.9860047, 'binary_f1_score': 0.4507772}
confusion matrix:
       0    1
0  17895  254
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9938795, 'recall': 0.9872836, 'specificity': 0.9872836, 'f1': 0.9905517, 'auroc': 0.9994639, 'binary_precision': 0.9909209, 'binary_recall': 0.97573435, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.983269}
confusion matrix:
      0    1
0  5990    7
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_16.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9971976280212402
after epoch: 16,now: 2024-06-11 00:50:48.753494,epoch time: 0:23:39.737714,used: 6:29:27.367441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9952927, 'precision': 0.9968778, 'recall': 0.9755866, 'specificity': 0.9755866, 'f1': 0.9859397, 'auroc': 0.99920726, 'binary_precision': 0.99881065, 'binary_recall': 0.9512913, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.97447205}
confusion matrix:
       0     1
0  42317     5
1    215  4199
---- Validation: 
scalar performance:
{'acc': 0.96184546, 'precision': 0.48942786, 'recall': 0.49871138, 'specificity': 0.49871138, 'f1': 0.49166614, 'auroc': 0.91804385, 'binary_precision': 0.013157895, 'binary_recall': 0.00155521, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.0027816412}
confusion matrix:
       0   1
0  18074  75
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9924779, 'precision': 0.9957837, 'recall': 0.967433, 'specificity': 0.967433, 'f1': 0.9810512, 'auroc': 0.99966884, 'binary_precision': 1.0, 'binary_recall': 0.9348659, 'binary_specificity': 1.0, 'binary_f1_score': 0.9663366}
confusion matrix:
      0    1
0  5997    0
1    51  732
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_17.png
early stop counter: 3
val acc:0.9618454575538635, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9971976280212402
after epoch: 17,now: 2024-06-11 01:14:34.366663,epoch time: 0:23:45.613169,used: 6:53:12.980610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.99913013, 'recall': 0.99273854, 'specificity': 0.99273854, 'f1': 0.9959084, 'auroc': 0.9998599, 'binary_precision': 0.99977016, 'binary_recall': 0.9855007, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99258417}
confusion matrix:
       0     1
0  42321     1
1     64  4350
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.8609942, 'recall': 0.54457766, 'specificity': 0.54457766, 'f1': 0.57236326, 'auroc': 0.94245213, 'binary_precision': 0.7532467, 'binary_recall': 0.090202175, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.1611111}
confusion matrix:
       0   1
0  18130  19
1    585  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.99995446, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_18.png
early stop counter: 4
val acc:0.9678586721420288, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9971976280212402
after epoch: 18,now: 2024-06-11 01:38:17.568217,epoch time: 0:23:43.201554,used: 7:16:56.182164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9976891, 'precision': 0.99768883, 'recall': 0.98878086, 'specificity': 0.98878086, 'f1': 0.9931842, 'auroc': 0.9990796, 'binary_precision': 0.9976884, 'binary_recall': 0.9777979, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.98764306}
confusion matrix:
       0     1
0  42312    10
1     98  4316
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.80804574, 'recall': 0.6569909, 'specificity': 0.6569909, 'f1': 0.70592076, 'auroc': 0.9272698, 'binary_precision': 0.63975155, 'binary_recall': 0.32037324, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.42694297}
confusion matrix:
       0    1
0  18033  116
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99734616, 'recall': 0.97956574, 'specificity': 0.97956574, 'f1': 0.9882393, 'auroc': 0.9991789, 'binary_precision': 1.0, 'binary_recall': 0.95913154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9791395}
confusion matrix:
      0    1
0  5997    0
1    32  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_19.png
early stop counter: 5
val acc:0.9705725908279419, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9971976280212402
after epoch: 19,now: 2024-06-11 02:01:59.228729,epoch time: 0:23:41.660512,used: 7:40:37.842676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9984491, 'recall': 0.9916637, 'specificity': 0.9916637, 'f1': 0.9950271, 'auroc': 0.99965996, 'binary_precision': 0.9986204, 'binary_recall': 0.9834692, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99098694}
confusion matrix:
       0     1
0  42314     6
1     73  4343
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7807417, 'recall': 0.51669407, 'specificity': 0.51669407, 'f1': 0.523736, 'auroc': 0.9356797, 'binary_precision': 0.5945946, 'binary_recall': 0.03421462, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.06470588}
confusion matrix:
       0   1
0  18134  15
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.99810207, 'recall': 0.9903381, 'specificity': 0.9903381, 'f1': 0.9941791, 'auroc': 0.99991757, 'binary_precision': 0.9986996, 'binary_recall': 0.9808429, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9896907}
confusion matrix:
      0    1
0  5996    1
1    15  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_20.png
new oracle model saved
early stop counter: 6
val acc:0.9661558270454407, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9976401329040527
after epoch: 20,now: 2024-06-11 02:25:39.679977,epoch time: 0:23:40.451248,used: 8:04:18.293924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.9977709, 'recall': 0.99484086, 'specificity': 0.99484086, 'f1': 0.99630046, 'auroc': 0.99935853, 'binary_precision': 0.9965808, 'binary_recall': 0.99003625, 'binary_specificity': 0.99964553, 'binary_f1_score': 0.99329776}
confusion matrix:
       0     1
0  42305    15
1     44  4372
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.70077443, 'recall': 0.5148358, 'specificity': 0.5148358, 'f1': 0.5202323, 'auroc': 0.9374776, 'binary_precision': 0.4347826, 'binary_recall': 0.0311042, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.05805515}
confusion matrix:
       0   1
0  18123  26
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.9918947, 'recall': 0.9951681, 'specificity': 0.9951681, 'f1': 0.9935241, 'auroc': 0.9997008, 'binary_precision': 0.98479086, 'binary_recall': 0.99233717, 'binary_specificity': 0.997999, 'binary_f1_score': 0.9885496}
confusion matrix:
      0    1
0  5985   12
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_21.png
early stop counter: 7
val acc:0.9654640555381775, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9976401329040527
after epoch: 21,now: 2024-06-11 02:49:24.924118,epoch time: 0:23:45.244141,used: 8:28:03.538065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9973896, 'precision': 0.9984581, 'recall': 0.98627245, 'specificity': 0.98627245, 'f1': 0.99227047, 'auroc': 0.99961674, 'binary_precision': 0.99976695, 'binary_recall': 0.9725686, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98598015}
confusion matrix:
       0     1
0  42324     1
1    121  4290
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.9228157, 'recall': 0.5441031, 'specificity': 0.5441031, 'f1': 0.57245445, 'auroc': 0.9361799, 'binary_precision': 0.8769231, 'binary_recall': 0.08864697, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.16101696}
confusion matrix:
       0   1
0  18141   8
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99483776, 'precision': 0.9970988, 'recall': 0.97765005, 'specificity': 0.97765005, 'f1': 0.9871148, 'auroc': 0.9992565, 'binary_precision': 1.0, 'binary_recall': 0.95530015, 'binary_specificity': 1.0, 'binary_f1_score': 0.9771392}
confusion matrix:
      0    1
0  5997    0
1    35  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_22.png
early stop counter: 8
val acc:0.9683908224105835, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9976401329040527
after epoch: 22,now: 2024-06-11 03:13:06.450636,epoch time: 0:23:41.526518,used: 8:51:45.064583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99882317, 'precision': 0.99853075, 'recall': 0.9945803, 'specificity': 0.9945803, 'f1': 0.9965457, 'auroc': 0.999864, 'binary_precision': 0.99817103, 'binary_recall': 0.98934966, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9937408}
confusion matrix:
       0     1
0  42315     8
1     47  4366
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.811895, 'recall': 0.6380466, 'specificity': 0.6380466, 'f1': 0.68867505, 'auroc': 0.93720025, 'binary_precision': 0.64874554, 'binary_recall': 0.281493, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.39262474}
confusion matrix:
       0    1
0  18051   98
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99728405, 'recall': 0.98897755, 'specificity': 0.98897755, 'f1': 0.99308383, 'auroc': 0.9999012, 'binary_precision': 0.9973958, 'binary_recall': 0.97828865, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9877499}
confusion matrix:
      0    1
0  5995    2
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_23.png
early stop counter: 9
val acc:0.9702000617980957, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9976401329040527
after epoch: 23,now: 2024-06-11 03:36:48.271172,epoch time: 0:23:41.820536,used: 9:15:26.885119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.9991336, 'recall': 0.99385947, 'specificity': 0.99385947, 'f1': 0.9964789, 'auroc': 0.9998615, 'binary_precision': 0.9995415, 'binary_recall': 0.9877662, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99361897}
confusion matrix:
       0     1
0  42320     2
1     54  4360
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.86336637, 'recall': 0.59684867, 'specificity': 0.59684867, 'f1': 0.64796865, 'auroc': 0.946984, 'binary_precision': 0.75449103, 'binary_recall': 0.19595645, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.3111111}
confusion matrix:
       0    1
0  18108   41
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9992406, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_24.png
early stop counter: 10
val acc:0.9703065156936646, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9976401329040527
after epoch: 24,now: 2024-06-11 04:00:34.343446,epoch time: 0:23:46.072274,used: 9:39:12.957393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.9935427, 'recall': 0.99484384, 'specificity': 0.99484384, 'f1': 0.9941921, 'auroc': 0.999863, 'binary_precision': 0.98803073, 'binary_recall': 0.99094, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9894832}
confusion matrix:
       0     1
0  42268    53
1     40  4375
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.7901963, 'recall': 0.678467, 'specificity': 0.678467, 'f1': 0.7197912, 'auroc': 0.94379, 'binary_precision': 0.6025641, 'binary_recall': 0.36547434, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.45498547}
confusion matrix:
       0    1
0  17994  155
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99933386, 'recall': 0.9948914, 'specificity': 0.9948914, 'f1': 0.9970994, 'auroc': 0.9998728, 'binary_precision': 1.0, 'binary_recall': 0.98978287, 'binary_specificity': 1.0, 'binary_f1_score': 0.99486524}
confusion matrix:
      0    1
0  5997    0
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_25.png
new oracle model saved
early stop counter: 11
val acc:0.9700404405593872, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 25,now: 2024-06-11 04:24:11.907994,epoch time: 0:23:37.564548,used: 10:02:50.521941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99700445, 'precision': 0.9982462, 'recall': 0.98424286, 'specificity': 0.98424286, 'f1': 0.99111915, 'auroc': 0.999107, 'binary_precision': 0.9997661, 'binary_recall': 0.9685093, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9838896}
confusion matrix:
       0     1
0  42321     1
1    139  4275
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.8645507, 'recall': 0.5415223, 'specificity': 0.5415223, 'f1': 0.56741214, 'auroc': 0.9399439, 'binary_precision': 0.7605634, 'binary_recall': 0.083981335, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.1512605}
confusion matrix:
       0   1
0  18132  17
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9924779, 'precision': 0.9957837, 'recall': 0.967433, 'specificity': 0.967433, 'f1': 0.9810512, 'auroc': 0.99615234, 'binary_precision': 1.0, 'binary_recall': 0.9348659, 'binary_specificity': 1.0, 'binary_f1_score': 0.9663366}
confusion matrix:
      0    1
0  5997    0
1    51  732
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_26.png
early stop counter: 12
val acc:0.96775221824646, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 26,now: 2024-06-11 04:47:50.618652,epoch time: 0:23:38.710658,used: 10:26:29.232599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9976841, 'recall': 0.9940431, 'specificity': 0.9940431, 'f1': 0.9958552, 'auroc': 0.99944323, 'binary_precision': 0.9965722, 'binary_recall': 0.98844063, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9924898}
confusion matrix:
       0     1
0  42309    15
1     51  4361
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.7704923, 'recall': 0.75544715, 'specificity': 0.75544715, 'f1': 0.76273155, 'auroc': 0.94354147, 'binary_precision': 0.55775577, 'binary_recall': 0.525661, 'binary_specificity': 0.98523337, 'binary_f1_score': 0.541233}
confusion matrix:
       0    1
0  17881  268
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.9971994, 'recall': 0.988339, 'specificity': 0.988339, 'f1': 0.9927158, 'auroc': 0.9999517, 'binary_precision': 0.9973924, 'binary_recall': 0.9770115, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9870968}
confusion matrix:
      0    1
0  5995    2
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_27.png
early stop counter: 13
val acc:0.9695082902908325, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 27,now: 2024-06-11 05:11:31.372025,epoch time: 0:23:40.753373,used: 10:50:09.985972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9959724, 'recall': 0.99275064, 'specificity': 0.99275064, 'f1': 0.9943549, 'auroc': 0.9996258, 'binary_precision': 0.993385, 'binary_recall': 0.9861866, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.98977274}
confusion matrix:
       0     1
0  42291    29
1     61  4355
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.52457404, 'recall': 0.5004746, 'specificity': 0.5004746, 'f1': 0.49268544, 'auroc': 0.922824, 'binary_precision': 0.083333336, 'binary_recall': 0.00155521, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.0030534351}
confusion matrix:
       0   1
0  18138  11
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.99751604, 'recall': 0.9858681, 'specificity': 0.9858681, 'f1': 0.99159956, 'auroc': 0.9994079, 'binary_precision': 0.9986877, 'binary_recall': 0.97190297, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9851133}
confusion matrix:
      0    1
0  5996    1
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_28.png
early stop counter: 14
val acc:0.9652511477470398, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 28,now: 2024-06-11 05:35:33.207854,epoch time: 0:24:01.835829,used: 11:14:11.821801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.998759, 'precision': 0.9990072, 'recall': 0.9937358, 'specificity': 0.9937358, 'f1': 0.99635386, 'auroc': 0.9998395, 'binary_precision': 0.9993124, 'binary_recall': 0.98754245, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9933926}
confusion matrix:
       0     1
0  42318     3
1     55  4360
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.91084236, 'recall': 0.5664608, 'specificity': 0.5664608, 'f1': 0.6078281, 'auroc': 0.943529, 'binary_precision': 0.85148513, 'binary_recall': 0.13374805, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.23118278}
confusion matrix:
       0   1
0  18134  15
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.9992378, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_29.png
early stop counter: 15
val acc:0.9695615172386169, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 29,now: 2024-06-11 05:59:29.506429,epoch time: 0:23:56.298575,used: 11:38:08.120376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9990121, 'recall': 0.99160767, 'specificity': 0.99160767, 'f1': 0.995275, 'auroc': 0.99977773, 'binary_precision': 0.9997697, 'binary_recall': 0.98323894, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9914354}
confusion matrix:
       0     1
0  42320     1
1     74  4341
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.79078513, 'recall': 0.5060831, 'specificity': 0.5060831, 'f1': 0.5035296, 'auroc': 0.946878, 'binary_precision': 0.61538464, 'binary_recall': 0.01244168, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.024390245}
confusion matrix:
       0  1
0  18144  5
1    635  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9978416, 'recall': 0.9833972, 'specificity': 0.9833972, 'f1': 0.9904769, 'auroc': 0.99993706, 'binary_precision': 1.0, 'binary_recall': 0.9667944, 'binary_specificity': 1.0, 'binary_f1_score': 0.98311687}
confusion matrix:
      0    1
0  5997    0
1    26  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_30.png
early stop counter: 16
val acc:0.9659429788589478, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 30,now: 2024-06-11 06:23:37.003556,epoch time: 0:24:07.497127,used: 12:02:15.617503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_18_21_21_seed_0_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:02:15.617503 at 2024-06-11 06:23:37.003556
persisted model performance metric: 

scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9998537, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
oracle model performance metric: 

scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.9998366, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456645 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456645 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447778 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  40703 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473147 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |  11464 KiB |     17 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3680    |    6847    |  210921 K  |  210918 K  |
|       from large pool |     187    |    1413    |  109923 K  |  109922 K  |
|       from small pool |    3493    |    6658    |  100998 K  |  100995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3680    |    6847    |  210921 K  |  210918 K  |
|       from large pool |     187    |    1413    |  109923 K  |  109922 K  |
|       from small pool |    3493    |    6658    |  100998 K  |  100995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2988    |  141753 K  |  141753 K  |
|       from large pool |      39    |     600    |   89616 K  |   89616 K  |
|       from small pool |      41    |    2948    |   52136 K  |   52136 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |      0 KiB |     44 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  100998 K  |  100998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  100998 K  |  100998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  141754 K  |  141754 K  |
|       from large pool |       4    |     600    |   89616 K  |   89616 K  |
|       from small pool |       0    |    2948    |   52138 K  |   52138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |      0 KiB |     44 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  100998 K  |  100998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  100998 K  |  100998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  141754 K  |  141754 K  |
|       from large pool |       4    |     600    |   89616 K  |   89616 K  |
|       from small pool |       0    |    2948    |   52138 K  |   52138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204

 Experiment start at: 2024-06-11 06:30:00.175687
before training, model accuracy: 0.18123698234558105
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99116313, 'precision': 0.9941362, 'recall': 0.9531995, 'specificity': 0.9531995, 'f1': 0.9725677, 'auroc': 0.9982597, 'binary_precision': 0.9977105, 'binary_recall': 0.9066112, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.94998187}
confusion matrix:
       0     1
0  42401     9
1    404  3922
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74501836, 'recall': 0.56027615, 'specificity': 0.56027615, 'f1': 0.5916325, 'auroc': 0.91960144, 'binary_precision': 0.5217391, 'binary_recall': 0.124814264, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.20143886}
confusion matrix:
       0   1
0  17990  77
1    589  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98736244, 'precision': 0.99295306, 'recall': 0.94551283, 'specificity': 0.94551283, 'f1': 0.967638, 'auroc': 0.9937659, 'binary_precision': 1.0, 'binary_recall': 0.89102566, 'binary_specificity': 1.0, 'binary_f1_score': 0.9423729}
confusion matrix:
      0    1
0  5946    0
1    85  695
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 06:54:46.667168,epoch time: 0:24:46.491481,used: 0:24:46.491481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99492896, 'precision': 0.9968898, 'recall': 0.9729126, 'specificity': 0.9729126, 'f1': 0.9845314, 'auroc': 0.9988501, 'binary_precision': 0.9992672, 'binary_recall': 0.94589597, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9718494}
confusion matrix:
       0     1
0  42408     3
1    234  4091
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.93526757, 'recall': 0.56141514, 'specificity': 0.56141514, 'f1': 0.6003393, 'auroc': 0.93119776, 'binary_precision': 0.90217394, 'binary_recall': 0.12332838, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.21699345}
confusion matrix:
       0   1
0  18058   9
1    590  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99122804, 'precision': 0.9950874, 'recall': 0.9621795, 'specificity': 0.9621795, 'f1': 0.97787803, 'auroc': 0.99875164, 'binary_precision': 1.0, 'binary_recall': 0.92435896, 'binary_specificity': 1.0, 'binary_f1_score': 0.9606929}
confusion matrix:
      0    1
0  5946    0
1    59  721
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 07:18:57.852147,epoch time: 0:24:11.184979,used: 0:48:57.676460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99165523, 'precision': 0.96569, 'recall': 0.9862662, 'specificity': 0.9862662, 'f1': 0.9756962, 'auroc': 0.9985497, 'binary_precision': 0.93346554, 'binary_recall': 0.9796532, 'binary_specificity': 0.9928792, 'binary_f1_score': 0.9560018}
confusion matrix:
       0     1
0  42109   302
1     88  4237
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7635324, 'recall': 0.6210782, 'specificity': 0.6210782, 'f1': 0.663365, 'auroc': 0.9140035, 'binary_precision': 0.55445546, 'binary_recall': 0.24962853, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.3442623}
confusion matrix:
       0    1
0  17932  135
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9947909, 'recall': 0.984836, 'specificity': 0.984836, 'f1': 0.9897454, 'auroc': 0.99856186, 'binary_precision': 0.9934383, 'binary_recall': 0.9705128, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.98184174}
confusion matrix:
      0    1
0  5941    5
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_3.png
new oracle model saved
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9680362939834595, corresponding to test acc:                         0.9912280440330505 / 0.9958370327949524
after epoch: 3,now: 2024-06-11 07:42:49.189848,epoch time: 0:23:51.337701,used: 1:12:49.014161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99715424, 'precision': 0.9963078, 'recall': 0.98670065, 'specificity': 0.98670065, 'f1': 0.9914455, 'auroc': 0.99931145, 'binary_precision': 0.9952741, 'binary_recall': 0.97387284, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.9844572}
confusion matrix:
       0     1
0  42391    20
1    113  4212
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.8550955, 'recall': 0.5997117, 'specificity': 0.5997117, 'f1': 0.6507063, 'auroc': 0.944023, 'binary_precision': 0.73913044, 'binary_recall': 0.20208023, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.3173862}
confusion matrix:
       0    1
0  18019   48
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955397, 'precision': 0.9963294, 'recall': 0.9818831, 'specificity': 0.9818831, 'f1': 0.988963, 'auroc': 0.99875814, 'binary_precision': 0.9973475, 'binary_recall': 0.96410257, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9804433}
confusion matrix:
      0    1
0  5944    2
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 08:06:33.845580,epoch time: 0:23:44.655732,used: 1:36:33.669893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9977533, 'precision': 0.99561286, 'recall': 0.99097776, 'specificity': 0.99097776, 'f1': 0.99328166, 'auroc': 0.9996106, 'binary_precision': 0.9929923, 'binary_recall': 0.982663, 'binary_specificity': 0.9992926, 'binary_f1_score': 0.9878006}
confusion matrix:
       0     1
0  42380    30
1     75  4251
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.84609854, 'recall': 0.55200166, 'specificity': 0.55200166, 'f1': 0.5835208, 'auroc': 0.93807644, 'binary_precision': 0.7244898, 'binary_recall': 0.10549777, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.18417639}
confusion matrix:
       0   1
0  18040  27
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.99707633, 'recall': 0.9826082, 'specificity': 0.9826082, 'f1': 0.9896988, 'auroc': 0.99944866, 'binary_precision': 0.99867374, 'binary_recall': 0.9653846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.98174703}
confusion matrix:
      0    1
0  5945    1
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_5.png
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9955397248268127 / 0.9958370327949524
after epoch: 5,now: 2024-06-11 08:30:09.399636,epoch time: 0:23:35.554056,used: 2:00:09.223949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99565643, 'precision': 0.9976181, 'recall': 0.9765372, 'specificity': 0.9765372, 'f1': 0.986793, 'auroc': 0.9996984, 'binary_precision': 1.0, 'binary_recall': 0.95307446, 'binary_specificity': 1.0, 'binary_f1_score': 0.9759735}
confusion matrix:
       0     1
0  42410     0
1    203  4123
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.56539804, 'recall': 0.50060457, 'specificity': 0.50060457, 'f1': 0.49227464, 'auroc': 0.941861, 'binary_precision': 0.16666667, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0029455079}
confusion matrix:
       0  1
0  18062  5
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99286354, 'precision': 0.995996, 'recall': 0.9692308, 'specificity': 0.9692308, 'f1': 0.98211694, 'auroc': 0.9988756, 'binary_precision': 1.0, 'binary_recall': 0.93846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.96825397}
confusion matrix:
      0    1
0  5946    0
1    48  732
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_6.png
early stop counter: 2
val acc:0.9638740420341492, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9955397248268127 / 0.9958370327949524
after epoch: 6,now: 2024-06-11 08:53:33.635641,epoch time: 0:23:24.236005,used: 2:23:33.459954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99756074, 'precision': 0.99844575, 'recall': 0.9870285, 'specificity': 0.9870285, 'f1': 0.99265444, 'auroc': 0.9992635, 'binary_precision': 0.9995255, 'binary_recall': 0.97410405, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.98665106}
confusion matrix:
       0     1
0  42409     2
1    112  4213
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.8343774, 'recall': 0.5138945, 'specificity': 0.5138945, 'f1': 0.5181434, 'auroc': 0.94722474, 'binary_precision': 0.7037037, 'binary_recall': 0.028231798, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.054285713}
confusion matrix:
       0   1
0  18059   8
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.998921, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_7.png
new oracle model saved
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9955397248268127 / 0.995985746383667
after epoch: 7,now: 2024-06-11 09:17:02.902213,epoch time: 0:23:29.266572,used: 2:47:02.726526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.995742, 'precision': 0.9975554, 'recall': 0.97710335, 'specificity': 0.97710335, 'f1': 0.9870615, 'auroc': 0.9983065, 'binary_precision': 0.9997578, 'binary_recall': 0.95423025, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9764637}
confusion matrix:
       0     1
0  42409     1
1    198  4128
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.7967757, 'recall': 0.61326987, 'specificity': 0.61326987, 'f1': 0.6604605, 'auroc': 0.91167146, 'binary_precision': 0.62151396, 'binary_recall': 0.23179792, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.33766234}
confusion matrix:
       0    1
0  17972   95
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910794, 'precision': 0.99439406, 'recall': 0.9620954, 'specificity': 0.9620954, 'f1': 0.9775162, 'auroc': 0.99740976, 'binary_precision': 0.99861497, 'binary_recall': 0.92435896, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9600533}
confusion matrix:
      0    1
0  5945    1
1    59  721
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_8.png
early stop counter: 4
val acc:0.9673425555229187, best validation acc: 0.9687833786010742, corresponding to test acc:                         0.9955397248268127 / 0.995985746383667
after epoch: 8,now: 2024-06-11 09:41:18.959962,epoch time: 0:24:16.057749,used: 3:11:18.784275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99704725, 'precision': 0.9902153, 'recall': 0.99224937, 'specificity': 0.99224937, 'f1': 0.99122965, 'auroc': 0.9993682, 'binary_precision': 0.9818224, 'binary_recall': 0.98636156, 'binary_specificity': 0.99813724, 'binary_f1_score': 0.9840867}
confusion matrix:
       0     1
0  42331    79
1     59  4267
---- Validation: 
scalar performance:
{'acc': 0.9702775, 'precision': 0.7876301, 'recall': 0.77072024, 'specificity': 0.77072024, 'f1': 0.7788913, 'auroc': 0.9521363, 'binary_precision': 0.59177214, 'binary_recall': 0.5557206, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.5731801}
confusion matrix:
       0    1
0  17809  258
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99435025, 'precision': 0.9962354, 'recall': 0.97619796, 'specificity': 0.97619796, 'f1': 0.98593986, 'auroc': 0.9996108, 'binary_precision': 0.9986559, 'binary_recall': 0.9525641, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.97506565}
confusion matrix:
      0    1
0  5945    1
1    37  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_9.png
better model found
persisted
after epoch: 9,now: 2024-06-11 10:05:11.424437,epoch time: 0:23:52.464475,used: 3:35:11.248750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9974752, 'precision': 0.9976531, 'recall': 0.9872956, 'specificity': 0.9872956, 'f1': 0.99240625, 'auroc': 0.9994323, 'binary_precision': 0.9978703, 'binary_recall': 0.9748035, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.986202}
confusion matrix:
       0     1
0  42401     9
1    109  4217
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.8849361, 'recall': 0.5360721, 'specificity': 0.5360721, 'f1': 0.5581035, 'auroc': 0.9333576, 'binary_precision': 0.8032787, 'binary_recall': 0.07280832, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.13351499}
confusion matrix:
       0   1
0  18055  12
1    624  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994945, 'precision': 0.9971572, 'recall': 0.9782051, 'specificity': 0.9782051, 'f1': 0.98743427, 'auroc': 0.99960136, 'binary_precision': 1.0, 'binary_recall': 0.9564102, 'binary_specificity': 1.0, 'binary_f1_score': 0.97771955}
confusion matrix:
      0    1
0  5946    0
1    34  746
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_10.png
early stop counter: 1
val acc:0.9660618901252747, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.995985746383667
after epoch: 10,now: 2024-06-11 10:28:40.242403,epoch time: 0:23:28.817966,used: 3:58:40.066716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99833107, 'precision': 0.9979231, 'recall': 0.99212646, 'specificity': 0.99212646, 'f1': 0.99500346, 'auroc': 0.99957156, 'binary_precision': 0.9974239, 'binary_recall': 0.98451227, 'binary_specificity': 0.9997406, 'binary_f1_score': 0.99092597}
confusion matrix:
       0     1
0  42399    11
1     67  4259
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.76044697, 'recall': 0.51802003, 'specificity': 0.51802003, 'f1': 0.5257335, 'auroc': 0.9211822, 'binary_precision': 0.5555556, 'binary_recall': 0.0371471, 'binary_specificity': 0.998893, 'binary_f1_score': 0.06963788}
confusion matrix:
       0   1
0  18047  20
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.9984877, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_11.png
early stop counter: 2
val acc:0.9643543362617493, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.995985746383667
after epoch: 11,now: 2024-06-11 10:52:09.652319,epoch time: 0:23:29.409916,used: 4:22:09.476632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99764633, 'precision': 0.9984929, 'recall': 0.9874909, 'specificity': 0.9874909, 'f1': 0.99291515, 'auroc': 0.999395, 'binary_precision': 0.99952596, 'binary_recall': 0.9750289, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9871255}
confusion matrix:
       0     1
0  42409     2
1    108  4217
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.76351875, 'recall': 0.50649273, 'specificity': 0.50649273, 'f1': 0.5039433, 'auroc': 0.92082715, 'binary_precision': 0.5625, 'binary_recall': 0.013372957, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.026124818}
confusion matrix:
       0  1
0  18060  7
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390423, 'precision': 0.99657595, 'recall': 0.9737179, 'specificity': 0.9737179, 'f1': 0.9847864, 'auroc': 0.9993245, 'binary_precision': 1.0, 'binary_recall': 0.9474359, 'binary_specificity': 1.0, 'binary_f1_score': 0.9730086}
confusion matrix:
      0    1
0  5946    0
1    41  739
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_12.png
early stop counter: 3
val acc:0.9641942381858826, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.995985746383667
after epoch: 12,now: 2024-06-11 11:16:03.321476,epoch time: 0:23:53.669157,used: 4:46:03.145789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99895155, 'precision': 0.99910796, 'recall': 0.99464667, 'specificity': 0.99464667, 'f1': 0.9968648, 'auroc': 0.9997144, 'binary_precision': 0.9992994, 'binary_recall': 0.98936415, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.994307}
confusion matrix:
       0     1
0  42408     3
1     46  4279
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.940303, 'recall': 0.53923756, 'specificity': 0.53923756, 'f1': 0.5639998, 'auroc': 0.958693, 'binary_precision': 0.9137931, 'binary_recall': 0.078751855, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.14500684}
confusion matrix:
       0   1
0  18062   5
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.9983238, 'recall': 0.9871795, 'specificity': 0.9871795, 'f1': 0.992667, 'auroc': 0.9998534, 'binary_precision': 1.0, 'binary_recall': 0.974359, 'binary_specificity': 1.0, 'binary_f1_score': 0.987013}
confusion matrix:
      0    1
0  5946    0
1    20  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_13.png
new oracle model saved
early stop counter: 4
val acc:0.9666488766670227, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 13,now: 2024-06-11 11:44:44.623966,epoch time: 0:28:41.302490,used: 5:14:44.448279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.997304, 'precision': 0.99618435, 'recall': 0.98772025, 'specificity': 0.98772025, 'f1': 0.99190676, 'auroc': 0.9990251, 'binary_precision': 0.9948162, 'binary_recall': 0.9759593, 'binary_specificity': 0.99948126, 'binary_f1_score': 0.98529756}
confusion matrix:
       0     1
0  42388    22
1    104  4222
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7627448, 'recall': 0.5201935, 'specificity': 0.5201935, 'f1': 0.5296544, 'auroc': 0.9308938, 'binary_precision': 0.56, 'binary_recall': 0.041604754, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.077455044}
confusion matrix:
       0   1
0  18045  22
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.99888414, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_14.png
early stop counter: 5
val acc:0.9644076824188232, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 14,now: 2024-06-11 12:20:33.298015,epoch time: 0:35:48.674049,used: 5:50:33.122328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9955067, 'precision': 0.98267573, 'recall': 0.9908782, 'specificity': 0.9908782, 'f1': 0.98673344, 'auroc': 0.9991598, 'binary_precision': 0.9668634, 'binary_recall': 0.9851989, 'binary_specificity': 0.9965576, 'binary_f1_score': 0.97594506}
confusion matrix:
       0     1
0  42266   146
1     64  4260
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.73564756, 'recall': 0.78478277, 'specificity': 0.78478277, 'f1': 0.7575909, 'auroc': 0.94094384, 'binary_precision': 0.48658538, 'binary_recall': 0.59286773, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.5344943}
confusion matrix:
       0    1
0  17646  421
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9947909, 'recall': 0.984836, 'specificity': 0.984836, 'f1': 0.9897454, 'auroc': 0.99969983, 'binary_precision': 0.9934383, 'binary_recall': 0.9705128, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.98184174}
confusion matrix:
      0    1
0  5941    5
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_15.png
early stop counter: 6
val acc:0.9629135727882385, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 15,now: 2024-06-11 12:56:54.970405,epoch time: 0:36:21.672390,used: 6:26:54.794718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9967049, 'precision': 0.9952067, 'recall': 0.98510677, 'specificity': 0.98510677, 'f1': 0.9900916, 'auroc': 0.9993298, 'binary_precision': 0.9933775, 'binary_recall': 0.9708738, 'binary_specificity': 0.99933976, 'binary_f1_score': 0.9819967}
confusion matrix:
       0     1
0  42382    28
1    126  4200
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.8694786, 'recall': 0.58081037, 'specificity': 0.58081037, 'f1': 0.6266761, 'auroc': 0.9374146, 'binary_precision': 0.7692308, 'binary_recall': 0.16344725, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.26960784}
confusion matrix:
       0    1
0  18034   33
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99316084, 'precision': 0.9875834, 'recall': 0.9788668, 'specificity': 0.9788668, 'f1': 0.9831722, 'auroc': 0.9990679, 'binary_precision': 0.98036647, 'binary_recall': 0.9602564, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.9702072}
confusion matrix:
      0    1
0  5931   15
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_16.png
early stop counter: 7
val acc:0.9681963920593262, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 16,now: 2024-06-11 13:33:43.605901,epoch time: 0:36:48.635496,used: 7:03:43.430214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99709004, 'precision': 0.997651, 'recall': 0.98500764, 'specificity': 0.98500764, 'f1': 0.9912276, 'auroc': 0.99927807, 'binary_precision': 0.99833494, 'binary_recall': 0.97018033, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9840563}
confusion matrix:
       0     1
0  42403     7
1    129  4197
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8714483, 'recall': 0.5507095, 'specificity': 0.5507095, 'f1': 0.58205396, 'auroc': 0.9415716, 'binary_precision': 0.7752809, 'binary_recall': 0.102526, 'binary_specificity': 0.998893, 'binary_f1_score': 0.18110237}
confusion matrix:
       0   1
0  18047  20
1    604  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910794, 'precision': 0.98735714, 'recall': 0.9687786, 'specificity': 0.9687786, 'f1': 0.9778253, 'auroc': 0.9977828, 'binary_precision': 0.98257375, 'binary_recall': 0.9397436, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.96068156}
confusion matrix:
      0    1
0  5933   13
1    47  733
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_17.png
early stop counter: 8
val acc:0.9667022228240967, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 17,now: 2024-06-11 14:03:47.260460,epoch time: 0:30:03.654559,used: 7:33:47.084773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99756074, 'precision': 0.99263763, 'recall': 0.9928422, 'specificity': 0.9928422, 'f1': 0.9927399, 'auroc': 0.99927413, 'binary_precision': 0.9865958, 'binary_recall': 0.987052, 'binary_specificity': 0.99863243, 'binary_f1_score': 0.98682386}
confusion matrix:
       0     1
0  42353    58
1     56  4269
---- Validation: 
scalar performance:
{'acc': 0.96958375, 'precision': 0.84330523, 'recall': 0.6258765, 'specificity': 0.6258765, 'f1': 0.68038964, 'auroc': 0.9367988, 'binary_precision': 0.71369296, 'binary_recall': 0.25557205, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.3763676}
confusion matrix:
       0    1
0  17998   69
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.99658483, 'recall': 0.9838062, 'specificity': 0.9838062, 'f1': 0.9900837, 'auroc': 0.9986795, 'binary_precision': 0.99735796, 'binary_recall': 0.96794873, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9824333}
confusion matrix:
      0    1
0  5944    2
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_18.png
early stop counter: 9
val acc:0.9695837497711182, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 18,now: 2024-06-11 14:27:20.034840,epoch time: 0:23:32.774380,used: 7:57:19.859153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9986948, 'precision': 0.9992819, 'recall': 0.9929496, 'specificity': 0.9929496, 'f1': 0.9960904, 'auroc': 0.99989617, 'binary_precision': 1.0, 'binary_recall': 0.9858992, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289954}
confusion matrix:
       0     1
0  42410     0
1     61  4265
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.8714678, 'recall': 0.5154357, 'specificity': 0.5154357, 'f1': 0.52105486, 'auroc': 0.9588009, 'binary_precision': 0.7777778, 'binary_recall': 0.031203566, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.060000002}
confusion matrix:
       0   1
0  18061   6
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.9983238, 'recall': 0.9871795, 'specificity': 0.9871795, 'f1': 0.992667, 'auroc': 0.9997739, 'binary_precision': 1.0, 'binary_recall': 0.974359, 'binary_specificity': 1.0, 'binary_f1_score': 0.987013}
confusion matrix:
      0    1
0  5946    0
1    20  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_19.png
early stop counter: 10
val acc:0.9648879170417786, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 19,now: 2024-06-11 14:52:35.410732,epoch time: 0:25:15.375892,used: 8:22:35.235045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.9964014, 'recall': 0.9908291, 'specificity': 0.9908291, 'f1': 0.9935956, 'auroc': 0.9995655, 'binary_precision': 0.9946161, 'binary_recall': 0.9822006, 'binary_specificity': 0.99945766, 'binary_f1_score': 0.9883694}
confusion matrix:
       0     1
0  42387    23
1     77  4249
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.8988204, 'recall': 0.56782484, 'specificity': 0.56782484, 'f1': 0.6091716, 'auroc': 0.9505413, 'binary_precision': 0.8288288, 'binary_recall': 0.13670133, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.23469386}
confusion matrix:
       0   1
0  18048  19
1    581  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99824035, 'recall': 0.98653847, 'specificity': 0.98653847, 'f1': 0.992296, 'auroc': 0.9996055, 'binary_precision': 1.0, 'binary_recall': 0.97307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.98635477}
confusion matrix:
      0    1
0  5946    0
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_20.png
early stop counter: 11
val acc:0.9679829478263855, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.9970264434814453
after epoch: 20,now: 2024-06-11 15:17:45.886684,epoch time: 0:25:10.475952,used: 8:47:45.710997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9980675, 'recall': 0.9935119, 'specificity': 0.9935119, 'f1': 0.99577665, 'auroc': 0.99919724, 'binary_precision': 0.9974305, 'binary_recall': 0.98728323, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9923309}
confusion matrix:
       0     1
0  42400    11
1     55  4270
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7061078, 'recall': 0.5403828, 'specificity': 0.5403828, 'f1': 0.561796, 'auroc': 0.93495154, 'binary_precision': 0.4453125, 'binary_recall': 0.08469539, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.1423221}
confusion matrix:
       0   1
0  17996  71
1    616  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.9981734, 'recall': 0.9909415, 'specificity': 0.9909415, 'f1': 0.9945219, 'auroc': 0.9998342, 'binary_precision': 0.9986962, 'binary_recall': 0.98205125, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9903038}
confusion matrix:
      0    1
0  5945    1
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_21.png
new oracle model saved
early stop counter: 12
val acc:0.9633404612541199, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 21,now: 2024-06-11 15:43:01.026677,epoch time: 0:25:15.139993,used: 9:13:00.850990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.998652, 'precision': 0.99915284, 'recall': 0.99282223, 'specificity': 0.99282223, 'f1': 0.99596226, 'auroc': 0.99991155, 'binary_precision': 0.9997655, 'binary_recall': 0.98566806, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9926667}
confusion matrix:
       0     1
0  42409     1
1     62  4264
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.9822496, 'recall': 0.50594354, 'specificity': 0.50594354, 'f1': 0.50271183, 'auroc': 0.9618819, 'binary_precision': 1.0, 'binary_recall': 0.011887073, 'binary_specificity': 1.0, 'binary_f1_score': 0.02349486}
confusion matrix:
       0  1
0  18067  0
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.9999224, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_22.png
early stop counter: 13
val acc:0.964514434337616, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 22,now: 2024-06-11 16:08:30.270370,epoch time: 0:25:29.243693,used: 9:38:30.094683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99694026, 'precision': 0.9961854, 'recall': 0.98554784, 'specificity': 0.98554784, 'f1': 0.99079454, 'auroc': 0.99919105, 'binary_precision': 0.99526405, 'binary_recall': 0.9715673, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.9832729}
confusion matrix:
       0     1
0  42390    20
1    123  4203
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.7936253, 'recall': 0.6226237, 'specificity': 0.6226237, 'f1': 0.66992116, 'auroc': 0.9281767, 'binary_precision': 0.61454546, 'binary_recall': 0.2511144, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.35654008}
confusion matrix:
       0    1
0  17961  106
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955397, 'precision': 0.99690795, 'recall': 0.98132616, 'specificity': 0.98132616, 'f1': 0.9889505, 'auroc': 0.9989557, 'binary_precision': 0.9986702, 'binary_recall': 0.96282053, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9804177}
confusion matrix:
      0    1
0  5945    1
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_23.png
early stop counter: 14
val acc:0.9674493074417114, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 23,now: 2024-06-11 16:35:04.896521,epoch time: 0:26:34.626151,used: 10:05:04.720834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99758214, 'precision': 0.99856436, 'recall': 0.9870432, 'specificity': 0.9870432, 'f1': 0.9927196, 'auroc': 0.9996685, 'binary_precision': 0.9997628, 'binary_recall': 0.97411, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9867697}
confusion matrix:
       0     1
0  42409     1
1    112  4214
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.88224775, 'recall': 0.50588816, 'specificity': 0.50588816, 'f1': 0.50264984, 'auroc': 0.9541378, 'binary_precision': 0.8, 'binary_recall': 0.011887073, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.023426061}
confusion matrix:
       0  1
0  18065  2
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99316084, 'precision': 0.9961616, 'recall': 0.9705128, 'specificity': 0.9705128, 'f1': 0.9828818, 'auroc': 0.99881625, 'binary_precision': 1.0, 'binary_recall': 0.9410256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9696169}
confusion matrix:
      0    1
0  5946    0
1    46  734
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_24.png
early stop counter: 15
val acc:0.9644076824188232, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 24,now: 2024-06-11 16:59:00.050309,epoch time: 0:23:55.153788,used: 10:28:59.874622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9982455, 'precision': 0.9989291, 'recall': 0.99062407, 'specificity': 0.99062407, 'f1': 0.994733, 'auroc': 0.9998735, 'binary_precision': 0.99976444, 'binary_recall': 0.9812717, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9904317}
confusion matrix:
       0     1
0  42410     1
1     81  4244
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.8156803, 'recall': 0.50874925, 'specificity': 0.50874925, 'f1': 0.5083009, 'auroc': 0.94731665, 'binary_precision': 0.6666667, 'binary_recall': 0.017830608, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.03473227}
confusion matrix:
       0   1
0  18061   6
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390423, 'precision': 0.99657595, 'recall': 0.9737179, 'specificity': 0.9737179, 'f1': 0.9847864, 'auroc': 0.9997784, 'binary_precision': 1.0, 'binary_recall': 0.9474359, 'binary_specificity': 1.0, 'binary_f1_score': 0.9730086}
confusion matrix:
      0    1
0  5946    0
1    41  739
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_25.png
early stop counter: 16
val acc:0.9644076824188232, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 25,now: 2024-06-11 17:22:55.721129,epoch time: 0:23:55.670820,used: 10:52:55.545442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.9986985, 'recall': 0.99403334, 'specificity': 0.99403334, 'f1': 0.99635214, 'auroc': 0.99953413, 'binary_precision': 0.99859816, 'binary_recall': 0.9882081, 'binary_specificity': 0.9998585, 'binary_f1_score': 0.99337596}
confusion matrix:
       0     1
0  42405     6
1     51  4274
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7855667, 'recall': 0.5572533, 'specificity': 0.5572533, 'f1': 0.58945185, 'auroc': 0.925982, 'binary_precision': 0.60305345, 'binary_recall': 0.11738484, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.19651742}
confusion matrix:
       0   1
0  18015  52
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.99808884, 'recall': 0.99030054, 'specificity': 0.99030054, 'f1': 0.9941534, 'auroc': 0.9997635, 'binary_precision': 0.99869454, 'binary_recall': 0.9807692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.98965067}
confusion matrix:
      0    1
0  5945    1
1    15  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_26.png
early stop counter: 17
val acc:0.9655283093452454, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 26,now: 2024-06-11 17:47:17.972354,epoch time: 0:24:22.251225,used: 11:17:17.796667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99850225, 'precision': 0.99781, 'recall': 0.9932556, 'specificity': 0.9932556, 'f1': 0.99551976, 'auroc': 0.99979913, 'binary_precision': 0.9969626, 'binary_recall': 0.9868178, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.99186426}
confusion matrix:
       0     1
0  42399    13
1     57  4267
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.76351875, 'recall': 0.50649273, 'specificity': 0.50649273, 'f1': 0.5039433, 'auroc': 0.94120085, 'binary_precision': 0.5625, 'binary_recall': 0.013372957, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.026124818}
confusion matrix:
       0  1
0  18060  7
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961344, 'precision': 0.9978232, 'recall': 0.98333335, 'specificity': 0.98333335, 'f1': 0.99043465, 'auroc': 0.9991454, 'binary_precision': 1.0, 'binary_recall': 0.96666664, 'binary_specificity': 1.0, 'binary_f1_score': 0.9830508}
confusion matrix:
      0    1
0  5946    0
1    26  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_27.png
early stop counter: 18
val acc:0.9641942381858826, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 27,now: 2024-06-11 18:11:22.044324,epoch time: 0:24:04.071970,used: 11:41:21.868637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9977747, 'precision': 0.9987769, 'recall': 0.9879769, 'specificity': 0.9879769, 'f1': 0.99330294, 'auroc': 0.9998374, 'binary_precision': 1.0, 'binary_recall': 0.97595376, 'binary_specificity': 1.0, 'binary_f1_score': 0.9878305}
confusion matrix:
       0     1
0  42411     0
1    104  4221
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.8824519, 'recall': 0.5117764, 'specificity': 0.5117764, 'f1': 0.5141039, 'auroc': 0.9429066, 'binary_precision': 0.8, 'binary_recall': 0.023774145, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.046176046}
confusion matrix:
       0   1
0  18063   4
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9967396, 'recall': 0.9800441, 'specificity': 0.9800441, 'f1': 0.9882004, 'auroc': 0.9990424, 'binary_precision': 0.99866664, 'binary_recall': 0.9602564, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9790849}
confusion matrix:
      0    1
0  5945    1
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_28.png
early stop counter: 19
val acc:0.9647278785705566, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 28,now: 2024-06-11 18:34:33.925343,epoch time: 0:23:11.881019,used: 12:04:33.749656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99766773, 'precision': 0.99871826, 'recall': 0.98739886, 'specificity': 0.98739886, 'f1': 0.99297726, 'auroc': 0.9991374, 'binary_precision': 1.0, 'binary_recall': 0.97479767, 'binary_specificity': 1.0, 'binary_f1_score': 0.987238}
confusion matrix:
       0     1
0  42411     0
1    109  4216
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.8870064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9946476, 'precision': 0.996991, 'recall': 0.9769231, 'specificity': 0.9769231, 'f1': 0.9866799, 'auroc': 0.9989721, 'binary_precision': 1.0, 'binary_recall': 0.95384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.9763779}
confusion matrix:
      0    1
0  5946    0
1    36  744
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_29.png
early stop counter: 20
val acc:0.9639807939529419, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 29,now: 2024-06-11 18:57:50.620467,epoch time: 0:23:16.695124,used: 12:27:50.444780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9986734, 'precision': 0.99895394, 'recall': 0.9931438, 'specificity': 0.9931438, 'f1': 0.9960276, 'auroc': 0.99970233, 'binary_precision': 0.99929726, 'binary_recall': 0.9863584, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9927857}
confusion matrix:
       0     1
0  42408     3
1     59  4266
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.9126079, 'recall': 0.57456666, 'specificity': 0.57456666, 'f1': 0.61965954, 'auroc': 0.9447433, 'binary_precision': 0.8559322, 'binary_recall': 0.15007429, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.25537294}
confusion matrix:
       0    1
0  18050   17
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.999925, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_30.png
early stop counter: 21
val acc:0.9685698747634888, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.994350254535675 / 0.997769832611084
after epoch: 30,now: 2024-06-11 19:21:11.757549,epoch time: 0:23:21.137082,used: 12:51:11.581862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_06_30_00_seed_1_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:51:11.581862 at 2024-06-11 19:21:11.757549
persisted model performance metric: 

scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.999804, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
oracle model performance metric: 

scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9998989, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456578 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456578 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447776 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |  40701 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28040 MiB |  13562 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446590 KiB |   1232 MiB |   1679 TiB |   1679 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |  11473 KiB |     44 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6847    |  421941 K  |  421937 K  |
|       from large pool |     187    |    1413    |  219934 K  |  219934 K  |
|       from small pool |    3475    |    6658    |  202006 K  |  202002 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6847    |  421941 K  |  421937 K  |
|       from large pool |     187    |    1413    |  219934 K  |  219934 K  |
|       from small pool |    3475    |    6658    |  202006 K  |  202002 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1205    |     570    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2988    |  278601 K  |  278601 K  |
|       from large pool |      38    |     605    |  173495 K  |  173495 K  |
|       from small pool |      42    |    2948    |  105105 K  |  105105 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28040 MiB |  27158 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   1679 TiB |   1679 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |      0 KiB |     44 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421941 K  |  421941 K  |
|       from large pool |       2    |    1413    |  219934 K  |  219934 K  |
|       from small pool |       0    |    6658    |  202006 K  |  202006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421941 K  |  421941 K  |
|       from large pool |       2    |    1413    |  219934 K  |  219934 K  |
|       from small pool |       0    |    6658    |  202006 K  |  202006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1205    |    1142    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  278602 K  |  278602 K  |
|       from large pool |       4    |     605    |  173495 K  |  173495 K  |
|       from small pool |       0    |    2948    |  105107 K  |  105107 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28040 MiB |  27158 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   1679 TiB |   1679 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |      0 KiB |     44 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421941 K  |  421941 K  |
|       from large pool |       2    |    1413    |  219934 K  |  219934 K  |
|       from small pool |       0    |    6658    |  202006 K  |  202006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421941 K  |  421941 K  |
|       from large pool |       2    |    1413    |  219934 K  |  219934 K  |
|       from small pool |       0    |    6658    |  202006 K  |  202006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1205    |    1142    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  278602 K  |  278602 K  |
|       from large pool |       4    |     605    |  173495 K  |  173495 K  |
|       from small pool |       0    |    2948    |  105107 K  |  105107 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204

 Experiment start at: 2024-06-11 19:27:11.127100
before training, model accuracy: 0.7911646366119385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98655224, 'precision': 0.9455321, 'recall': 0.98262024, 'specificity': 0.98262024, 'f1': 0.9631146, 'auroc': 0.99797547, 'binary_precision': 0.89347565, 'binary_recall': 0.9777435, 'binary_specificity': 0.98749703, 'binary_f1_score': 0.9337121}
confusion matrix:
       0     1
0  41781   529
1    101  4437
---- Validation: 
scalar performance:
{'acc': 0.9503542, 'precision': 0.6660003, 'recall': 0.78644145, 'specificity': 0.78644145, 'f1': 0.70763505, 'auroc': 0.91567814, 'binary_precision': 0.34521577, 'binary_recall': 0.6112957, 'binary_specificity': 0.96158713, 'binary_f1_score': 0.44124702}
confusion matrix:
       0    1
0  17473  698
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99434775, 'precision': 0.99061036, 'recall': 0.9798825, 'specificity': 0.9798825, 'f1': 0.9851686, 'auroc': 0.9983213, 'binary_precision': 0.9858757, 'binary_recall': 0.9614325, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.97350067}
confusion matrix:
      0    1
0  5987   10
1    28  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 19:51:11.763674,epoch time: 0:24:00.636574,used: 0:24:00.636574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.995368, 'precision': 0.9956949, 'recall': 0.97776294, 'specificity': 0.97776294, 'f1': 0.98651993, 'auroc': 0.99870276, 'binary_precision': 0.99609643, 'binary_recall': 0.9559277, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.97559875}
confusion matrix:
       0     1
0  42293    17
1    200  4338
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.5069872, 'recall': 0.5010384, 'specificity': 0.5010384, 'f1': 0.4965671, 'auroc': 0.8804619, 'binary_precision': 0.04597701, 'binary_recall': 0.006644518, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.01161103}
confusion matrix:
       0   1
0  18088  83
1    598   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9978416, 'recall': 0.9820937, 'specificity': 0.9820937, 'f1': 0.98980206, 'auroc': 0.9978704, 'binary_precision': 1.0, 'binary_recall': 0.9641873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817672}
confusion matrix:
      0    1
0  5997    0
1    26  700
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 20:14:27.175450,epoch time: 0:23:15.411776,used: 0:47:16.048350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9915471, 'precision': 0.9951454, 'recall': 0.95657474, 'specificity': 0.95657474, 'f1': 0.97487557, 'auroc': 0.998744, 'binary_precision': 0.99951774, 'binary_recall': 0.91319674, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.95440936}
confusion matrix:
       0     1
0  42307     2
1    394  4145
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.6637938, 'recall': 0.51094, 'specificity': 0.51094, 'f1': 0.51353574, 'auroc': 0.9182851, 'binary_precision': 0.35897437, 'binary_recall': 0.023255814, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.04368175}
confusion matrix:
       0   1
0  18146  25
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98720807, 'precision': 0.9929311, 'recall': 0.94077134, 'specificity': 0.94077134, 'f1': 0.96496165, 'auroc': 0.99874854, 'binary_precision': 1.0, 'binary_recall': 0.8815427, 'binary_specificity': 1.0, 'binary_f1_score': 0.9370425}
confusion matrix:
      0    1
0  5997    0
1    86  640
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_3.png
better model found
persisted
after epoch: 3,now: 2024-06-11 20:37:51.802953,epoch time: 0:23:24.627503,used: 1:10:40.675853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9944928, 'precision': 0.99696946, 'recall': 0.9715797, 'specificity': 0.9715797, 'f1': 0.9838543, 'auroc': 0.99894, 'binary_precision': 1.0, 'binary_recall': 0.9431593, 'binary_specificity': 1.0, 'binary_f1_score': 0.97074825}
confusion matrix:
       0     1
0  42309     0
1    258  4281
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.81504446, 'recall': 0.52857447, 'specificity': 0.52857447, 'f1': 0.54550636, 'auroc': 0.9290071, 'binary_precision': 0.6603774, 'binary_recall': 0.058139537, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.10687023}
confusion matrix:
       0   1
0  18153  18
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910754, 'precision': 0.9950471, 'recall': 0.95867765, 'specificity': 0.95867765, 'f1': 0.9759595, 'auroc': 0.99786705, 'binary_precision': 1.0, 'binary_recall': 0.91735536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9568966}
confusion matrix:
      0    1
0  5997    0
1    60  666
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 21:01:02.495579,epoch time: 0:23:10.692626,used: 1:33:51.368479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99750257, 'precision': 0.996913, 'recall': 0.9887835, 'specificity': 0.9887835, 'f1': 0.9928057, 'auroc': 0.99955845, 'binary_precision': 0.99618495, 'binary_recall': 0.9779687, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9869928}
confusion matrix:
       0     1
0  42292    17
1    100  4439
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.7691333, 'recall': 0.6666387, 'specificity': 0.6666387, 'f1': 0.7047432, 'auroc': 0.9409001, 'binary_precision': 0.5597826, 'binary_recall': 0.34219268, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.42474228}
confusion matrix:
       0    1
0  18009  162
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99662626, 'recall': 0.97787803, 'specificity': 0.97787803, 'f1': 0.9870163, 'auroc': 0.99885666, 'binary_precision': 0.99856114, 'binary_recall': 0.95592284, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9767769}
confusion matrix:
      0    1
0  5996    1
1    32  694
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_5.png
better model found
persisted
after epoch: 5,now: 2024-06-11 21:24:08.829355,epoch time: 0:23:06.333776,used: 1:56:57.702255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9965847, 'precision': 0.99811625, 'recall': 0.98237497, 'specificity': 0.98237497, 'f1': 0.9900857, 'auroc': 0.9992982, 'binary_precision': 1.0, 'binary_recall': 0.96474993, 'binary_specificity': 1.0, 'binary_f1_score': 0.98205876}
confusion matrix:
       0     1
0  42309     0
1    160  4379
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.8240907, 'recall': 0.6127744, 'specificity': 0.6127744, 'f1': 0.66377705, 'auroc': 0.9148438, 'binary_precision': 0.67317075, 'binary_recall': 0.22923589, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.34200743}
confusion matrix:
       0    1
0  18104   67
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99718124, 'recall': 0.976584, 'specificity': 0.976584, 'f1': 0.9865979, 'auroc': 0.9990785, 'binary_precision': 1.0, 'binary_recall': 0.95316803, 'binary_specificity': 1.0, 'binary_f1_score': 0.97602254}
confusion matrix:
      0    1
0  5997    0
1    34  692
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_6.png
better model found
persisted
after epoch: 6,now: 2024-06-11 21:47:17.383592,epoch time: 0:23:08.554237,used: 2:20:06.256492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9974599, 'precision': 0.99778974, 'recall': 0.9876781, 'specificity': 0.9876781, 'f1': 0.99266815, 'auroc': 0.99959886, 'binary_precision': 0.9981966, 'binary_recall': 0.9755453, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.98674095}
confusion matrix:
       0     1
0  42301     8
1    111  4428
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.695776, 'recall': 0.5087235, 'specificity': 0.5087235, 'f1': 0.5093086, 'auroc': 0.93556976, 'binary_precision': 0.42307693, 'binary_recall': 0.018272426, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.035031848}
confusion matrix:
       0   1
0  18156  15
1    591  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9968771, 'recall': 0.97994417, 'specificity': 0.97994417, 'f1': 0.9882186, 'auroc': 0.9992268, 'binary_precision': 0.99856734, 'binary_recall': 0.9600551, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9789326}
confusion matrix:
      0    1
0  5996    1
1    29  697
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_7.png
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9961326718330383
after epoch: 7,now: 2024-06-11 22:10:22.040509,epoch time: 0:23:04.656917,used: 2:43:10.913409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99741715, 'precision': 0.9977658, 'recall': 0.98745775, 'specificity': 0.98745775, 'f1': 0.99254346, 'auroc': 0.9990276, 'binary_precision': 0.99819577, 'binary_recall': 0.97510463, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9865151}
confusion matrix:
       0     1
0  42301     8
1    113  4426
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73031574, 'recall': 0.5400974, 'specificity': 0.5400974, 'f1': 0.56282556, 'auroc': 0.90486884, 'binary_precision': 0.49019608, 'binary_recall': 0.08305648, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.14204547}
confusion matrix:
       0   1
0  18119  52
1    552  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99654275, 'recall': 0.9771893, 'specificity': 0.9771893, 'f1': 0.9866145, 'auroc': 0.9978807, 'binary_precision': 0.99855906, 'binary_recall': 0.95454544, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.97605634}
confusion matrix:
      0    1
0  5996    1
1    33  693
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_8.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9961326718330383
after epoch: 8,now: 2024-06-11 22:33:24.483677,epoch time: 0:23:02.443168,used: 3:06:13.356577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99786544, 'precision': 0.99613357, 'recall': 0.9916395, 'specificity': 0.9916395, 'f1': 0.99387354, 'auroc': 0.999347, 'binary_precision': 0.99399066, 'binary_recall': 0.9839172, 'binary_specificity': 0.9993618, 'binary_f1_score': 0.9889282}
confusion matrix:
       0     1
0  42282    27
1     73  4466
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.75311744, 'recall': 0.7721733, 'specificity': 0.7721733, 'f1': 0.7622627, 'auroc': 0.9375607, 'binary_precision': 0.52080125, 'binary_recall': 0.5614618, 'binary_specificity': 0.9828848, 'binary_f1_score': 0.5403678}
confusion matrix:
       0    1
0  17860  311
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.99700993, 'recall': 0.98674786, 'specificity': 0.98674786, 'f1': 0.9918088, 'auroc': 0.99987733, 'binary_precision': 0.99717915, 'binary_recall': 0.9738292, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9853659}
confusion matrix:
      0    1
0  5995    2
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_9.png
new oracle model saved
early stop counter: 3
val acc:0.9693709015846252, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9968764185905457
after epoch: 9,now: 2024-06-11 22:56:30.446614,epoch time: 0:23:05.962937,used: 3:29:19.319514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99741715, 'precision': 0.9968642, 'recall': 0.9883428, 'specificity': 0.9883428, 'f1': 0.9925568, 'auroc': 0.999285, 'binary_precision': 0.9961815, 'binary_recall': 0.97708744, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.98654205}
confusion matrix:
       0     1
0  42292    17
1    104  4435
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.74432296, 'recall': 0.6905426, 'specificity': 0.6905426, 'f1': 0.71376824, 'auroc': 0.92631674, 'binary_precision': 0.50858366, 'binary_recall': 0.3936877, 'binary_specificity': 0.9873975, 'binary_f1_score': 0.4438202}
confusion matrix:
       0    1
0  17942  229
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9997928, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_10.png
early stop counter: 4
val acc:0.9683588147163391, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9968764185905457
after epoch: 10,now: 2024-06-11 23:19:38.509961,epoch time: 0:23:08.063347,used: 3:52:27.382861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99551743, 'precision': 0.99032164, 'recall': 0.9839442, 'specificity': 0.9839442, 'f1': 0.9871064, 'auroc': 0.99839723, 'binary_precision': 0.98389983, 'binary_recall': 0.9695901, 'binary_specificity': 0.9982983, 'binary_f1_score': 0.9766925}
confusion matrix:
       0     1
0  42238    72
1    138  4400
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.72832566, 'recall': 0.7615237, 'specificity': 0.7615237, 'f1': 0.74366856, 'auroc': 0.9214791, 'binary_precision': 0.47186148, 'binary_recall': 0.54318935, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.5050193}
confusion matrix:
       0    1
0  17805  366
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9930091, 'precision': 0.9897759, 'recall': 0.9736842, 'specificity': 0.9736842, 'f1': 0.9815539, 'auroc': 0.99886656, 'binary_precision': 0.9856939, 'binary_recall': 0.9490358, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.96701753}
confusion matrix:
      0    1
0  5987   10
1    37  689
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_11.png
early stop counter: 5
val acc:0.9658552408218384, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9968764185905457
after epoch: 11,now: 2024-06-11 23:42:41.824904,epoch time: 0:23:03.314943,used: 4:15:30.697804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9982923, 'precision': 0.99905634, 'recall': 0.99118555, 'specificity': 0.99118555, 'f1': 0.9950813, 'auroc': 0.9998034, 'binary_precision': 1.0, 'binary_recall': 0.9823711, 'binary_specificity': 1.0, 'binary_f1_score': 0.99110717}
confusion matrix:
       0     1
0  42310     0
1     80  4458
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.87321305, 'recall': 0.5115178, 'specificity': 0.5115178, 'f1': 0.51456463, 'auroc': 0.9460882, 'binary_precision': 0.7777778, 'binary_recall': 0.023255814, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.04516129}
confusion matrix:
       0   1
0  18167   4
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.9998672, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_12.png
new oracle model saved
early stop counter: 6
val acc:0.9684653282165527, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9973226189613342
after epoch: 12,now: 2024-06-12 00:05:50.430025,epoch time: 0:23:08.605121,used: 4:38:39.302925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9984631, 'precision': 0.99905044, 'recall': 0.99216706, 'specificity': 0.99216706, 'f1': 0.99557847, 'auroc': 0.9996895, 'binary_precision': 0.99977624, 'binary_recall': 0.9843578, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99200714}
confusion matrix:
       0     1
0  42308     1
1     71  4468
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.9084128, 'recall': 0.5586124, 'specificity': 0.5586124, 'f1': 0.5961193, 'auroc': 0.9323337, 'binary_precision': 0.8452381, 'binary_recall': 0.1179402, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.2069971}
confusion matrix:
       0   1
0  18158  13
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9986783, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_13.png
early stop counter: 7
val acc:0.9710221886634827, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9973226189613342
after epoch: 13,now: 2024-06-12 00:29:37.327698,epoch time: 0:23:46.897673,used: 5:02:26.200598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9981643, 'precision': 0.9988853, 'recall': 0.9906228, 'specificity': 0.9906228, 'f1': 0.9947103, 'auroc': 0.9996345, 'binary_precision': 0.99977547, 'binary_recall': 0.9812693, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99043596}
confusion matrix:
       0     1
0  42309     1
1     85  4453
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.8038707, 'recall': 0.53015304, 'specificity': 0.53015304, 'f1': 0.5481172, 'auroc': 0.9371523, 'binary_precision': 0.63793105, 'binary_recall': 0.061461795, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.11212121}
confusion matrix:
       0   1
0  18150  21
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.997759, 'recall': 0.98140496, 'specificity': 0.98140496, 'f1': 0.98940325, 'auroc': 0.9999049, 'binary_precision': 1.0, 'binary_recall': 0.9628099, 'binary_specificity': 1.0, 'binary_f1_score': 0.98105264}
confusion matrix:
      0    1
0  5997    0
1    27  699
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_14.png
early stop counter: 8
val acc:0.9687849283218384, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9949427247047424 / 0.9973226189613342
after epoch: 14,now: 2024-06-12 00:53:25.557675,epoch time: 0:23:48.229977,used: 5:26:14.430575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9954961, 'precision': 0.99731123, 'recall': 0.9769537, 'specificity': 0.9769537, 'f1': 0.9868636, 'auroc': 0.99883246, 'binary_precision': 0.9995383, 'binary_recall': 0.95395464, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9762147}
confusion matrix:
       0     1
0  42307     2
1    209  4330
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.9038599, 'recall': 0.6031327, 'specificity': 0.6031327, 'f1': 0.65940166, 'auroc': 0.9440564, 'binary_precision': 0.8333333, 'binary_recall': 0.2076412, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.3324468}
confusion matrix:
       0    1
0  18146   25
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9907779, 'precision': 0.99488366, 'recall': 0.9573003, 'specificity': 0.9573003, 'f1': 0.9751265, 'auroc': 0.99919575, 'binary_precision': 1.0, 'binary_recall': 0.91460055, 'binary_specificity': 1.0, 'binary_f1_score': 0.95539564}
confusion matrix:
      0    1
0  5997    0
1    62  664
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_15.png
better model found
persisted
after epoch: 15,now: 2024-06-12 01:16:57.151028,epoch time: 0:23:31.593353,used: 5:49:46.023928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.9972414, 'recall': 0.9927373, 'specificity': 0.9927373, 'f1': 0.9949763, 'auroc': 0.99951124, 'binary_precision': 0.9959938, 'binary_recall': 0.9859, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.9909212}
confusion matrix:
       0     1
0  42291    18
1     64  4475
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7556758, 'recall': 0.579084, 'specificity': 0.579084, 'f1': 0.6170026, 'auroc': 0.927558, 'binary_precision': 0.53846157, 'binary_recall': 0.1627907, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.25}
confusion matrix:
       0   1
0  18087  84
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99675536, 'recall': 0.9846817, 'specificity': 0.9846817, 'f1': 0.9906212, 'auroc': 0.99965596, 'binary_precision': 0.9971671, 'binary_recall': 0.969697, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9832402}
confusion matrix:
      0    1
0  5995    2
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_16.png
early stop counter: 1
val acc:0.9686784148216248, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 16,now: 2024-06-12 01:40:44.174416,epoch time: 0:23:47.023388,used: 6:13:33.047316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9970116, 'precision': 0.9899522, 'recall': 0.9930339, 'specificity': 0.9930339, 'f1': 0.9914869, 'auroc': 0.9995862, 'binary_precision': 0.9811816, 'binary_recall': 0.98810047, 'binary_specificity': 0.99796736, 'binary_f1_score': 0.98462886}
confusion matrix:
       0     1
0  42224    86
1     54  4484
---- Validation: 
scalar performance:
{'acc': 0.9700101, 'precision': 0.7636378, 'recall': 0.6801529, 'specificity': 0.6801529, 'f1': 0.71330637, 'auroc': 0.9357202, 'binary_precision': 0.5479115, 'binary_recall': 0.3704319, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.4420218}
confusion matrix:
       0    1
0  17987  184
1    379  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9995985, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_17.png
early stop counter: 2
val acc:0.9700101017951965, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 17,now: 2024-06-12 02:06:10.377657,epoch time: 0:25:26.203241,used: 6:38:59.250557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99652064, 'precision': 0.99808115, 'recall': 0.9820405, 'specificity': 0.9820405, 'f1': 0.9898948, 'auroc': 0.99974585, 'binary_precision': 1.0, 'binary_recall': 0.9640811, 'binary_specificity': 1.0, 'binary_f1_score': 0.98171216}
confusion matrix:
       0     1
0  42310     0
1    163  4375
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.91763335, 'recall': 0.5107423, 'specificity': 0.5107423, 'f1': 0.51306784, 'auroc': 0.9415231, 'binary_precision': 0.8666667, 'binary_recall': 0.021594685, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.04213938}
confusion matrix:
       0   1
0  18169   2
1    589  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9996629, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_18.png
early stop counter: 3
val acc:0.9685186147689819, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 18,now: 2024-06-12 02:31:34.353250,epoch time: 0:25:23.975593,used: 7:04:23.226150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9981643, 'precision': 0.9977866, 'recall': 0.9917066, 'specificity': 0.9917066, 'f1': 0.99472296, 'auroc': 0.9995435, 'binary_precision': 0.99731964, 'binary_recall': 0.9836969, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9904614}
confusion matrix:
       0     1
0  42297    12
1     74  4465
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7026978, 'recall': 0.6214906, 'specificity': 0.6214906, 'f1': 0.6507977, 'auroc': 0.8953634, 'binary_precision': 0.42977527, 'binary_recall': 0.25415283, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.31941545}
confusion matrix:
       0    1
0  17968  203
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.9976306, 'recall': 0.9861425, 'specificity': 0.9861425, 'f1': 0.99179864, 'auroc': 0.9968938, 'binary_precision': 0.9985856, 'binary_recall': 0.9724518, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9853455}
confusion matrix:
      0    1
0  5996    1
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_19.png
early stop counter: 4
val acc:0.9652692675590515, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 19,now: 2024-06-12 02:57:01.645423,epoch time: 0:25:27.292173,used: 7:29:50.518323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980789, 'precision': 0.9987376, 'recall': 0.9902805, 'specificity': 0.9902805, 'f1': 0.9944632, 'auroc': 0.9998454, 'binary_precision': 0.99955076, 'binary_recall': 0.9806082, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98998886}
confusion matrix:
       0     1
0  42308     2
1     88  4450
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7675755, 'recall': 0.5687819, 'specificity': 0.5687819, 'f1': 0.60495913, 'auroc': 0.9272901, 'binary_precision': 0.5629139, 'binary_recall': 0.14119601, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.22576362}
confusion matrix:
       0   1
0  18105  66
1    517  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99726367, 'recall': 0.97727275, 'specificity': 0.97727275, 'f1': 0.98700017, 'auroc': 0.99982154, 'binary_precision': 1.0, 'binary_recall': 0.95454544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9767442}
confusion matrix:
      0    1
0  5997    0
1    33  693
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_20.png
early stop counter: 5
val acc:0.968944787979126, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 20,now: 2024-06-12 03:22:21.120348,epoch time: 0:25:19.474925,used: 7:55:09.993248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99741715, 'precision': 0.99806803, 'recall': 0.98715997, 'specificity': 0.98715997, 'f1': 0.9925375, 'auroc': 0.9992696, 'binary_precision': 0.99887055, 'binary_recall': 0.9744381, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.98650306}
confusion matrix:
       0     1
0  42305     5
1    116  4422
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.8324636, 'recall': 0.5409229, 'specificity': 0.5409229, 'f1': 0.5664003, 'auroc': 0.90729046, 'binary_precision': 0.6944444, 'binary_recall': 0.08305648, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.14836796}
confusion matrix:
       0   1
0  18149  22
1    552  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99718124, 'recall': 0.976584, 'specificity': 0.976584, 'f1': 0.9865979, 'auroc': 0.9987085, 'binary_precision': 1.0, 'binary_recall': 0.95316803, 'binary_specificity': 1.0, 'binary_f1_score': 0.97602254}
confusion matrix:
      0    1
0  5997    0
1    34  692
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_21.png
early stop counter: 6
val acc:0.9694241881370544, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 21,now: 2024-06-12 03:47:50.635281,epoch time: 0:25:29.514933,used: 8:20:39.508181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9987193, 'precision': 0.99869454, 'recall': 0.99398065, 'specificity': 0.99398065, 'f1': 0.99632347, 'auroc': 0.9997119, 'binary_precision': 0.998664, 'binary_recall': 0.9881031, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9933555}
confusion matrix:
       0     1
0  42303     6
1     54  4485
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.826733, 'recall': 0.5212645, 'specificity': 0.5212645, 'f1': 0.5326588, 'auroc': 0.94353557, 'binary_precision': 0.68421054, 'binary_recall': 0.04318937, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.081250004}
confusion matrix:
       0   1
0  18159  12
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.99934775, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_22.png
early stop counter: 7
val acc:0.9686784148216248, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 22,now: 2024-06-12 04:13:10.842043,epoch time: 0:25:20.206762,used: 8:45:59.714943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9985485, 'precision': 0.99909765, 'recall': 0.9926077, 'specificity': 0.9926077, 'f1': 0.99582577, 'auroc': 0.9998951, 'binary_precision': 0.9997764, 'binary_recall': 0.985239, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9924545}
confusion matrix:
       0     1
0  42308     1
1     67  4472
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.79795027, 'recall': 0.56349075, 'specificity': 0.56349075, 'f1': 0.59953606, 'auroc': 0.933284, 'binary_precision': 0.624, 'binary_recall': 0.1295681, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.21458046}
confusion matrix:
       0   1
0  18124  47
1    524  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.996247, 'recall': 0.9805495, 'specificity': 0.9805495, 'f1': 0.98823315, 'auroc': 0.9992691, 'binary_precision': 0.99714285, 'binary_recall': 0.9614325, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9789621}
confusion matrix:
      0    1
0  5995    2
1    28  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_23.png
early stop counter: 8
val acc:0.9695839881896973, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9973226189613342
after epoch: 23,now: 2024-06-12 04:38:25.951983,epoch time: 0:25:15.109940,used: 9:11:14.824883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99848443, 'precision': 0.9989623, 'recall': 0.9923756, 'specificity': 0.9923756, 'f1': 0.99564123, 'auroc': 0.9997946, 'binary_precision': 0.9995528, 'binary_recall': 0.98479843, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9921208}
confusion matrix:
       0     1
0  42307     2
1     69  4470
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7569948, 'recall': 0.5096916, 'specificity': 0.5096916, 'f1': 0.51110554, 'auroc': 0.9345354, 'binary_precision': 0.54545456, 'binary_recall': 0.019933555, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.038461536}
confusion matrix:
       0   1
0  18161  10
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.9990634, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_24.png
new oracle model saved
early stop counter: 9
val acc:0.9680392146110535, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9977688789367676
after epoch: 24,now: 2024-06-12 05:03:47.408586,epoch time: 0:25:21.456603,used: 9:36:36.281486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.9970726, 'recall': 0.9970726, 'specificity': 0.9970726, 'f1': 0.9970726, 'auroc': 0.9996897, 'binary_precision': 0.9947125, 'binary_recall': 0.9947125, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.9947125}
confusion matrix:
       0     1
0  42285    24
1     24  4515
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.71898246, 'recall': 0.65646195, 'specificity': 0.65646195, 'f1': 0.68195343, 'auroc': 0.91423905, 'binary_precision': 0.4600939, 'binary_recall': 0.3255814, 'binary_specificity': 0.9873425, 'binary_f1_score': 0.38132295}
confusion matrix:
       0    1
0  17941  230
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9999508, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_25.png
new oracle model saved
early stop counter: 10
val acc:0.9661215543746948, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9983638525009155
after epoch: 25,now: 2024-06-12 05:29:05.722689,epoch time: 0:25:18.314103,used: 10:01:54.595589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9987833, 'precision': 0.99744934, 'recall': 0.9955895, 'specificity': 0.9955895, 'f1': 0.9965172, 'auroc': 0.9998924, 'binary_precision': 0.99579644, 'binary_recall': 0.9916281, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.99370784}
confusion matrix:
       0     1
0  42290    19
1     38  4501
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.6507053, 'recall': 0.5023266, 'specificity': 0.5023266, 'f1': 0.49671993, 'auroc': 0.92210025, 'binary_precision': 0.33333334, 'binary_recall': 0.004983389, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.009819968}
confusion matrix:
       0  1
0  18165  6
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.99995863, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_26.png
early stop counter: 11
val acc:0.9677728414535522, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9983638525009155
after epoch: 26,now: 2024-06-12 05:54:26.311730,epoch time: 0:25:20.589041,used: 10:27:15.184630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983137, 'precision': 0.9987675, 'recall': 0.99159265, 'specificity': 0.99159265, 'f1': 0.9951471, 'auroc': 0.9996896, 'binary_precision': 0.99932826, 'binary_recall': 0.9832562, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9912271}
confusion matrix:
       0     1
0  42306     3
1     76  4463
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7542535, 'recall': 0.5338931, 'specificity': 0.5338931, 'f1': 0.5536814, 'auroc': 0.9340812, 'binary_precision': 0.53846157, 'binary_recall': 0.069767445, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.123529404}
confusion matrix:
       0   1
0  18135  36
1    560  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9999607, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_27.png
early stop counter: 12
val acc:0.9682523012161255, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9983638525009155
after epoch: 27,now: 2024-06-12 06:19:55.558499,epoch time: 0:25:29.246769,used: 10:52:44.431399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99882597, 'precision': 0.9971808, 'recall': 0.99610484, 'specificity': 0.99610484, 'f1': 0.9966421, 'auroc': 0.99970734, 'binary_precision': 0.9951413, 'binary_recall': 0.99272966, 'binary_specificity': 0.99948, 'binary_f1_score': 0.9939341}
confusion matrix:
       0     1
0  42287    22
1     33  4506
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.8621299, 'recall': 0.6010313, 'specificity': 0.6010313, 'f1': 0.6535054, 'auroc': 0.95218277, 'binary_precision': 0.75, 'binary_recall': 0.20431894, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.32114884}
confusion matrix:
       0    1
0  18130   41
1    479  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.998134, 'recall': 0.9902747, 'specificity': 0.9902747, 'f1': 0.9941634, 'auroc': 0.9999274, 'binary_precision': 0.9985975, 'binary_recall': 0.9807162, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9895761}
confusion matrix:
      0    1
0  5996    1
1    14  712
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_28.png
early stop counter: 13
val acc:0.97230064868927, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9983638525009155
after epoch: 28,now: 2024-06-12 06:45:34.955600,epoch time: 0:25:39.397101,used: 11:18:23.828500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986552, 'precision': 0.9958187, 'recall': 0.9965013, 'specificity': 0.9965013, 'f1': 0.9961597, 'auroc': 0.99968445, 'binary_precision': 0.99229926, 'binary_recall': 0.9938299, 'binary_specificity': 0.99917275, 'binary_f1_score': 0.993064}
confusion matrix:
       0     1
0  42275    35
1     28  4510
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7047596, 'recall': 0.5373856, 'specificity': 0.5373856, 'f1': 0.5579429, 'auroc': 0.92404497, 'binary_precision': 0.43925235, 'binary_recall': 0.07807309, 'binary_specificity': 0.996698, 'binary_f1_score': 0.1325811}
confusion matrix:
       0   1
0  18111  60
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.99996877, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_29.png
new oracle model saved
early stop counter: 14
val acc:0.9672402143478394, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9989588260650635
after epoch: 29,now: 2024-06-12 07:11:07.514021,epoch time: 0:25:32.558421,used: 11:43:56.386921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99837774, 'precision': 0.9989031, 'recall': 0.9918248, 'specificity': 0.9918248, 'f1': 0.9953319, 'auroc': 0.9995826, 'binary_precision': 0.99955225, 'binary_recall': 0.9836969, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9915611}
confusion matrix:
       0     1
0  42307     2
1     74  4465
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.8993162, 'recall': 0.566808, 'specificity': 0.566808, 'f1': 0.60841364, 'auroc': 0.9167215, 'binary_precision': 0.82653064, 'binary_recall': 0.1345515, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.23142858}
confusion matrix:
       0   1
0  18154  17
1    521  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.9999389, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277204_30.png
early stop counter: 15
val acc:0.9713418483734131, best validation acc: 0.973259449005127, corresponding to test acc:                         0.9907779097557068 / 0.9989588260650635
after epoch: 30,now: 2024-06-12 07:36:42.993886,epoch time: 0:25:35.479865,used: 12:09:31.866786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_19_27_11_seed_2_21277204
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:09:31.866786 at 2024-06-12 07:36:42.993886
persisted model performance metric: 

scalar performance:
{'acc': 0.9910754, 'precision': 0.9950471, 'recall': 0.95867765, 'specificity': 0.95867765, 'f1': 0.9759595, 'auroc': 0.99854803, 'binary_precision': 1.0, 'binary_recall': 0.91735536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9568966}
confusion matrix:
      0    1
0  5997    0
1    60  666
oracle model performance metric: 

scalar performance:
{'acc': 0.9982151, 'precision': 0.9983861, 'recall': 0.99234086, 'specificity': 0.99234086, 'f1': 0.9953393, 'auroc': 0.9999291, 'binary_precision': 0.99860334, 'binary_recall': 0.9848485, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99167824}
confusion matrix:
      0    1
0  5996    1
1    11  715
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456578 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456578 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3579 TiB |   3579 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3536 TiB |   3536 TiB |
|       from small pool |  40700 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41636 MiB |  27158 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     66 MiB |     94 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444542 KiB |   1232 MiB |   2510 TiB |   2510 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2468 TiB |   2468 TiB |
|       from small pool |   9425 KiB |     44 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  632640 K  |  632636 K  |
|       from large pool |     187    |    1413    |  329702 K  |  329702 K  |
|       from small pool |    3475    |    6672    |  302937 K  |  302934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  632640 K  |  632636 K  |
|       from large pool |     187    |    1413    |  329702 K  |  329702 K  |
|       from small pool |    3475    |    6672    |  302937 K  |  302934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1777    |    1142    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      33    |      47    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2992    |  415132 K  |  415132 K  |
|       from large pool |      38    |     605    |  257044 K  |  257044 K  |
|       from small pool |      40    |    2954    |  158088 K  |  158088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3579 TiB |   3579 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3536 TiB |   3536 TiB |
|       from small pool |      0 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14478 MiB |  41636 MiB |  40756 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     66 MiB |     94 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1232 MiB |   2510 TiB |   2510 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2468 TiB |   2468 TiB |
|       from small pool |      0 KiB |     44 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  632640 K  |  632640 K  |
|       from large pool |       2    |    1413    |  329702 K  |  329702 K  |
|       from small pool |       0    |    6672    |  302937 K  |  302937 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  632640 K  |  632640 K  |
|       from large pool |       2    |    1413    |  329702 K  |  329702 K  |
|       from small pool |       0    |    6672    |  302937 K  |  302937 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |    1777    |    1715    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      33    |      47    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2992    |  415134 K  |  415134 K  |
|       from large pool |       4    |     605    |  257044 K  |  257044 K  |
|       from small pool |       0    |    2954    |  158090 K  |  158090 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 12 07:38:39 2024]
Finished job 0.
1 of 1 steps (100%) done
