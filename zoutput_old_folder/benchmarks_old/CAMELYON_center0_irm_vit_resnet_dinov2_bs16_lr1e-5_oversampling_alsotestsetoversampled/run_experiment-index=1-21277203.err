Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 17:23:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203

 Experiment start at: 2024-06-10 17:34:44.002678
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4373156428337097
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9935168, 'precision': 0.99341094, 'recall': 0.9685254, 'specificity': 0.9685254, 'f1': 0.9805641, 'auroc': 0.9980481, 'binary_precision': 0.99328214, 'binary_recall': 0.9377124, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.96469766}
confusion matrix:
       0     1
0  42293    28
1    275  4140
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96110046, 'precision': 0.71759677, 'recall': 0.7900971, 'specificity': 0.7900971, 'f1': 0.747975, 'auroc': 0.9320413, 'binary_precision': 0.44930875, 'binary_recall': 0.60653186, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.51621443}
confusion matrix:
       0    1
0  17671  478
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9905605, 'precision': 0.9916954, 'recall': 0.9619075, 'specificity': 0.9619075, 'f1': 0.9761799, 'auroc': 0.99702847, 'binary_precision': 0.9931413, 'binary_recall': 0.92464876, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.95767194}
confusion matrix:
      0    1
0  5992    5
1    59  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 18:02:14.306071,epoch time: 0:27:30.303393,used: 0:27:30.303393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99644816, 'precision': 0.9958433, 'recall': 0.98331946, 'specificity': 0.98331946, 'f1': 0.9894807, 'auroc': 0.99863935, 'binary_precision': 0.9951026, 'binary_recall': 0.9671351, 'binary_specificity': 0.99950385, 'binary_f1_score': 0.98091954}
confusion matrix:
       0     1
0  42303    21
1    145  4267
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.8366883, 'recall': 0.5528558, 'specificity': 0.5528558, 'f1': 0.584934, 'auroc': 0.9206067, 'binary_precision': 0.70408165, 'binary_recall': 0.10730949, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.18623483}
confusion matrix:
       0   1
0  18120  29
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.99668705, 'recall': 0.9744572, 'specificity': 0.9744572, 'f1': 0.9852319, 'auroc': 0.99856013, 'binary_precision': 1.0, 'binary_recall': 0.9489144, 'binary_specificity': 1.0, 'binary_f1_score': 0.97378767}
confusion matrix:
      0    1
0  5997    0
1    40  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 18:24:32.053587,epoch time: 0:22:17.747516,used: 0:49:48.050909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99497175, 'precision': 0.97872645, 'recall': 0.99255866, 'specificity': 0.99255866, 'f1': 0.9855175, 'auroc': 0.99929476, 'binary_precision': 0.95854354, 'binary_recall': 0.9895833, 'binary_specificity': 0.995534, 'binary_f1_score': 0.97381616}
confusion matrix:
       0     1
0  42131   189
1     46  4370
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6727652, 'recall': 0.7827014, 'specificity': 0.7827014, 'f1': 0.71227515, 'auroc': 0.9282, 'binary_precision': 0.35992578, 'binary_recall': 0.60342145, 'binary_specificity': 0.96198136, 'binary_f1_score': 0.4509006}
confusion matrix:
       0    1
0  17459  690
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.9959883, 'recall': 0.98881084, 'specificity': 0.98881084, 'f1': 0.9923644, 'auroc': 0.9990764, 'binary_precision': 0.9948052, 'binary_recall': 0.97828865, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9864778}
confusion matrix:
      0    1
0  5993    4
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_3.png
new oracle model saved
early stop counter: 1
val acc:0.9497126340866089, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9941002726554871 / 0.9969026446342468
after epoch: 3,now: 2024-06-10 18:45:46.042913,epoch time: 0:21:13.989326,used: 1:11:02.040235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9962556, 'precision': 0.99057233, 'recall': 0.9874846, 'specificity': 0.9874846, 'f1': 0.98902225, 'auroc': 0.9986745, 'binary_precision': 0.98357666, 'binary_recall': 0.97667044, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.9801114}
confusion matrix:
       0     1
0  42249    72
1    103  4312
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.7011897, 'recall': 0.7764433, 'specificity': 0.7764433, 'f1': 0.73204255, 'auroc': 0.92739165, 'binary_precision': 0.4174107, 'binary_recall': 0.5816485, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.4860299}
confusion matrix:
       0    1
0  17627  522
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469024, 'precision': 0.9958487, 'recall': 0.9781219, 'specificity': 0.9781219, 'f1': 0.9867692, 'auroc': 0.99970675, 'binary_precision': 0.99733686, 'binary_recall': 0.95657724, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.97653186}
confusion matrix:
      0    1
0  5995    2
1    34  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_4.png
early stop counter: 2
val acc:0.9579076170921326, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9941002726554871 / 0.9969026446342468
after epoch: 4,now: 2024-06-10 19:06:37.849433,epoch time: 0:20:51.806520,used: 1:31:53.846755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99685466, 'precision': 0.98940146, 'recall': 0.9922786, 'specificity': 0.9922786, 'f1': 0.9908347, 'auroc': 0.9994921, 'binary_precision': 0.980198, 'binary_recall': 0.98663646, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.9834067}
confusion matrix:
       0     1
0  42233    88
1     59  4356
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.6821445, 'recall': 0.7637661, 'specificity': 0.7637661, 'f1': 0.7143298, 'auroc': 0.9230033, 'binary_precision': 0.38014784, 'binary_recall': 0.5598756, 'binary_specificity': 0.9676566, 'binary_f1_score': 0.45283023}
confusion matrix:
       0    1
0  17562  587
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.996379, 'recall': 0.9869785, 'specificity': 0.9869785, 'f1': 0.9916184, 'auroc': 0.99987155, 'binary_precision': 0.99608356, 'binary_recall': 0.9744572, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9851517}
confusion matrix:
      0    1
0  5994    3
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_5.png
early stop counter: 3
val acc:0.9537037014961243, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9941002726554871 / 0.9969026446342468
after epoch: 5,now: 2024-06-10 19:27:19.599282,epoch time: 0:20:41.749849,used: 1:52:35.596604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99685466, 'precision': 0.9981639, 'recall': 0.9834574, 'specificity': 0.9834574, 'f1': 0.99067223, 'auroc': 0.9994799, 'binary_precision': 0.9997659, 'binary_recall': 0.9669384, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9830782}
confusion matrix:
       0     1
0  42319     1
1    146  4270
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.79668653, 'recall': 0.6391886, 'specificity': 0.6391886, 'f1': 0.6870699, 'auroc': 0.9372164, 'binary_precision': 0.6182432, 'binary_recall': 0.28460342, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.38977635}
confusion matrix:
       0    1
0  18036  113
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9917404, 'precision': 0.9953742, 'recall': 0.9642401, 'specificity': 0.9642401, 'f1': 0.9791333, 'auroc': 0.9997021, 'binary_precision': 1.0, 'binary_recall': 0.9284802, 'binary_specificity': 1.0, 'binary_f1_score': 0.96291393}
confusion matrix:
      0    1
0  5997    0
1    56  727
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_6.png
better model found
persisted
after epoch: 6,now: 2024-06-10 19:48:06.010276,epoch time: 0:20:46.410994,used: 2:13:22.007598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9978175, 'precision': 0.9975552, 'recall': 0.98966575, 'specificity': 0.98966575, 'f1': 0.9935708, 'auroc': 0.99969953, 'binary_precision': 0.9972331, 'binary_recall': 0.979615, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9883455}
confusion matrix:
       0     1
0  42309    12
1     90  4325
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7819842, 'recall': 0.5773872, 'specificity': 0.5773872, 'f1': 0.6168448, 'auroc': 0.92055583, 'binary_precision': 0.59302324, 'binary_recall': 0.15863141, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.25030676}
confusion matrix:
       0    1
0  18079   70
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99759966, 'recall': 0.98650664, 'specificity': 0.98650664, 'f1': 0.9919693, 'auroc': 0.9995148, 'binary_precision': 0.9986894, 'binary_recall': 0.97318006, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98576975}
confusion matrix:
      0    1
0  5996    1
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_7.png
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 7,now: 2024-06-10 20:08:45.803538,epoch time: 0:20:39.793262,used: 2:34:01.800860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99715424, 'precision': 0.99594283, 'recall': 0.9873694, 'specificity': 0.9873694, 'f1': 0.99160904, 'auroc': 0.99934137, 'binary_precision': 0.994456, 'binary_recall': 0.97530586, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9847878}
confusion matrix:
       0     1
0  42298    24
1    109  4305
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.61475533, 'recall': 0.56151426, 'specificity': 0.56151426, 'f1': 0.57860273, 'auroc': 0.9230704, 'binary_precision': 0.25958702, 'binary_recall': 0.13685848, 'binary_specificity': 0.98617005, 'binary_f1_score': 0.17922607}
confusion matrix:
       0    1
0  17898  251
1    555   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99646443, 'recall': 0.987617, 'specificity': 0.987617, 'f1': 0.99198735, 'auroc': 0.999254, 'binary_precision': 0.9960887, 'binary_recall': 0.97573435, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.98580647}
confusion matrix:
      0    1
0  5994    3
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_8.png
early stop counter: 2
val acc:0.9571093916893005, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 8,now: 2024-06-10 20:29:17.700923,epoch time: 0:20:31.897385,used: 2:54:33.698245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9977533, 'precision': 0.9963925, 'recall': 0.99044174, 'specificity': 0.99044174, 'f1': 0.9933945, 'auroc': 0.99965477, 'binary_precision': 0.9947199, 'binary_recall': 0.98142695, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.9880287}
confusion matrix:
       0     1
0  42298    23
1     82  4333
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72695243, 'recall': 0.5142235, 'specificity': 0.5142235, 'f1': 0.5191334, 'auroc': 0.88063174, 'binary_precision': 0.4871795, 'binary_recall': 0.02954899, 'binary_specificity': 0.998898, 'binary_f1_score': 0.055718478}
confusion matrix:
       0   1
0  18129  20
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9957227, 'precision': 0.99759376, 'recall': 0.9814815, 'specificity': 0.9814815, 'f1': 0.98936003, 'auroc': 0.9994689, 'binary_precision': 1.0, 'binary_recall': 0.962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811321}
confusion matrix:
      0    1
0  5997    0
1    29  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_9.png
early stop counter: 3
val acc:0.9657300710678101, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 9,now: 2024-06-10 20:49:56.846474,epoch time: 0:20:39.145551,used: 3:15:12.843796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99636257, 'precision': 0.9931346, 'recall': 0.9855181, 'specificity': 0.9855181, 'f1': 0.98928905, 'auroc': 0.9991705, 'binary_precision': 0.9891705, 'binary_recall': 0.97214675, 'binary_specificity': 0.9988894, 'binary_f1_score': 0.98058474}
confusion matrix:
       0     1
0  42273    47
1    123  4293
---- Validation: 
scalar performance:
{'acc': 0.9582269, 'precision': 0.5504225, 'recall': 0.51558936, 'specificity': 0.51558936, 'f1': 0.52038217, 'auroc': 0.90419924, 'binary_precision': 0.13402061, 'binary_recall': 0.04043546, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.06212664}
confusion matrix:
       0    1
0  17981  168
1    617   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99336284, 'precision': 0.9950915, 'recall': 0.9723748, 'specificity': 0.9723748, 'f1': 0.9833764, 'auroc': 0.9983351, 'binary_precision': 0.99730456, 'binary_recall': 0.945083, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.97049177}
confusion matrix:
      0    1
0  5995    2
1    43  740
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_10.png
early stop counter: 4
val acc:0.9582269191741943, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 10,now: 2024-06-10 21:10:33.792793,epoch time: 0:20:36.946319,used: 3:35:49.790115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9957206, 'precision': 0.9966892, 'recall': 0.97824323, 'specificity': 0.97824323, 'f1': 0.9872471, 'auroc': 0.99926794, 'binary_precision': 0.9978718, 'binary_recall': 0.95669913, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9768518}
confusion matrix:
       0     1
0  42316     9
1    191  4220
---- Validation: 
scalar performance:
{'acc': 0.9578544, 'precision': 0.4955937, 'recall': 0.4988953, 'specificity': 0.4988953, 'f1': 0.49423444, 'auroc': 0.8775109, 'binary_precision': 0.025477707, 'binary_recall': 0.00622084, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.01}
confusion matrix:
       0    1
0  17996  153
1    639    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9899705, 'precision': 0.99377733, 'recall': 0.95713246, 'specificity': 0.95713246, 'f1': 0.974514, 'auroc': 0.99849766, 'binary_precision': 0.9986053, 'binary_recall': 0.9144317, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9546666}
confusion matrix:
      0    1
0  5996    1
1    67  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_11.png
early stop counter: 5
val acc:0.9578543901443481, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 11,now: 2024-06-10 21:31:24.889653,epoch time: 0:20:51.096860,used: 3:56:40.886975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9982909, 'recall': 0.9923143, 'specificity': 0.9923143, 'f1': 0.9952799, 'auroc': 0.9997231, 'binary_precision': 0.9981626, 'binary_recall': 0.98481756, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9914452}
confusion matrix:
       0     1
0  42315     8
1     67  4346
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7087116, 'recall': 0.542395, 'specificity': 0.542395, 'f1': 0.5651163, 'auroc': 0.9338739, 'binary_precision': 0.4488189, 'binary_recall': 0.08864697, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.14805195}
confusion matrix:
       0   1
0  18079  70
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.9996408, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_12.png
early stop counter: 6
val acc:0.9650915265083313, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9917404055595398 / 0.9969026446342468
after epoch: 12,now: 2024-06-10 21:52:06.289950,epoch time: 0:20:41.400297,used: 4:17:22.287272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99841666, 'precision': 0.9987143, 'recall': 0.9920234, 'specificity': 0.9920234, 'f1': 0.99534047, 'auroc': 0.9996681, 'binary_precision': 0.99908006, 'binary_recall': 0.98414135, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99155444}
confusion matrix:
       0     1
0  42318     4
1     70  4344
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7841613, 'recall': 0.6865798, 'specificity': 0.6865798, 'f1': 0.7242997, 'auroc': 0.93058944, 'binary_precision': 0.58992803, 'binary_recall': 0.38258165, 'binary_specificity': 0.990578, 'binary_f1_score': 0.46415094}
confusion matrix:
       0    1
0  17978  171
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.9998121, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_13.png
better model found
persisted
after epoch: 13,now: 2024-06-10 22:12:41.630513,epoch time: 0:20:35.340563,used: 4:37:57.627835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99355954, 'precision': 0.99603, 'recall': 0.9663098, 'specificity': 0.9663098, 'f1': 0.9805948, 'auroc': 0.9990274, 'binary_precision': 0.99902934, 'binary_recall': 0.9327141, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9647335}
confusion matrix:
       0     1
0  42318     4
1    297  4117
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.9130623, 'recall': 0.5687936, 'specificity': 0.5687936, 'f1': 0.61142004, 'auroc': 0.9181778, 'binary_precision': 0.8557692, 'binary_recall': 0.13841368, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.23828648}
confusion matrix:
       0   1
0  18134  15
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9899705, 'precision': 0.99439406, 'recall': 0.9565773, 'specificity': 0.9565773, 'f1': 0.9744843, 'auroc': 0.998709, 'binary_precision': 1.0, 'binary_recall': 0.91315454, 'binary_specificity': 1.0, 'binary_f1_score': 0.9546061}
confusion matrix:
      0    1
0  5997    0
1    68  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_14.png
early stop counter: 1
val acc:0.9697211384773254, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9969026446342468 / 0.9969026446342468
after epoch: 14,now: 2024-06-10 22:33:21.546445,epoch time: 0:20:39.915932,used: 4:58:37.543767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9966621, 'precision': 0.9981637, 'recall': 0.98233294, 'specificity': 0.98233294, 'f1': 0.99008775, 'auroc': 0.999444, 'binary_precision': 1.0, 'binary_recall': 0.9646659, 'binary_specificity': 1.0, 'binary_f1_score': 0.9820152}
confusion matrix:
       0     1
0  42321     0
1    156  4259
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.6080526, 'recall': 0.5048647, 'specificity': 0.5048647, 'f1': 0.5015329, 'auroc': 0.90608156, 'binary_precision': 0.25, 'binary_recall': 0.01088647, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.020864382}
confusion matrix:
       0   1
0  18128  21
1    636   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9957227, 'precision': 0.99759376, 'recall': 0.9814815, 'specificity': 0.9814815, 'f1': 0.98936003, 'auroc': 0.99948937, 'binary_precision': 1.0, 'binary_recall': 0.962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811321}
confusion matrix:
      0    1
0  5997    0
1    29  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_15.png
early stop counter: 2
val acc:0.9650382995605469, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9969026446342468 / 0.9969026446342468
after epoch: 15,now: 2024-06-10 22:54:10.513205,epoch time: 0:20:48.966760,used: 5:19:26.510527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.9992283, 'recall': 0.99476683, 'specificity': 0.99476683, 'f1': 0.996985, 'auroc': 0.9998727, 'binary_precision': 0.9995424, 'binary_recall': 0.989581, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9945368}
confusion matrix:
       0     1
0  42319     2
1     46  4369
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.8465545, 'recall': 0.60659945, 'specificity': 0.60659945, 'f1': 0.65867573, 'auroc': 0.9558536, 'binary_precision': 0.7202073, 'binary_recall': 0.21617419, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.3325359}
confusion matrix:
       0    1
0  18095   54
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.9975112, 'recall': 0.98084295, 'specificity': 0.98084295, 'f1': 0.98898685, 'auroc': 0.9995808, 'binary_precision': 1.0, 'binary_recall': 0.96168584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98046875}
confusion matrix:
      0    1
0  5997    0
1    30  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_16.png
better model found
persisted
after epoch: 16,now: 2024-06-10 23:14:43.823751,epoch time: 0:20:33.310546,used: 5:39:59.821073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9978389, 'precision': 0.9968493, 'recall': 0.99048686, 'specificity': 0.99048686, 'f1': 0.9936423, 'auroc': 0.9993988, 'binary_precision': 0.9956332, 'binary_recall': 0.9814227, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.9884769}
confusion matrix:
       0     1
0  42303    19
1     82  4332
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.66727835, 'recall': 0.5437911, 'specificity': 0.5437911, 'f1': 0.5650094, 'auroc': 0.93302196, 'binary_precision': 0.36585367, 'binary_recall': 0.0933126, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.1486989}
confusion matrix:
       0    1
0  18045  104
1    583   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99587023, 'precision': 0.9976764, 'recall': 0.98212004, 'specificity': 0.98212004, 'f1': 0.98973274, 'auroc': 0.99977404, 'binary_precision': 1.0, 'binary_recall': 0.9642401, 'binary_specificity': 1.0, 'binary_f1_score': 0.98179454}
confusion matrix:
      0    1
0  5997    0
1    28  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_17.png
early stop counter: 1
val acc:0.9634419083595276, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9955752491950989 / 0.9969026446342468
after epoch: 17,now: 2024-06-10 23:35:12.906378,epoch time: 0:20:29.082627,used: 6:00:28.903700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99843806, 'precision': 0.9990357, 'recall': 0.9918323, 'specificity': 0.9918323, 'f1': 0.995401, 'auroc': 0.9998286, 'binary_precision': 0.99976975, 'binary_recall': 0.98368824, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99166375}
confusion matrix:
       0     1
0  42321     1
1     72  4342
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.91207707, 'recall': 0.5185523, 'specificity': 0.5185523, 'f1': 0.5273287, 'auroc': 0.93995285, 'binary_precision': 0.85714287, 'binary_recall': 0.03732504, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.07153502}
confusion matrix:
       0   1
0  18145   4
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9999125, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_18.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9955752491950989 / 0.9969026446342468
after epoch: 18,now: 2024-06-10 23:55:47.954093,epoch time: 0:20:35.047715,used: 6:21:03.951415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99753934, 'precision': 0.99404705, 'recall': 0.991539, 'specificity': 0.991539, 'f1': 0.99278903, 'auroc': 0.99975836, 'binary_precision': 0.9897471, 'binary_recall': 0.98414135, 'binary_specificity': 0.9989367, 'binary_f1_score': 0.98693633}
confusion matrix:
       0     1
0  42277    45
1     70  4344
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.66134894, 'recall': 0.6538324, 'specificity': 0.6538324, 'f1': 0.65748715, 'auroc': 0.902713, 'binary_precision': 0.34640524, 'binary_recall': 0.32970452, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.3378486}
confusion matrix:
       0    1
0  17749  400
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9945428, 'precision': 0.988503, 'recall': 0.98470086, 'specificity': 0.98470086, 'f1': 0.98659194, 'auroc': 0.9995072, 'binary_precision': 0.9806701, 'binary_recall': 0.97190297, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.97626686}
confusion matrix:
      0    1
0  5982   15
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_19.png
early stop counter: 3
val acc:0.9557790756225586, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9955752491950989 / 0.9969026446342468
after epoch: 19,now: 2024-06-11 00:16:21.333487,epoch time: 0:20:33.379394,used: 6:41:37.330809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9965765, 'precision': 0.9972739, 'recall': 0.98269534, 'specificity': 0.98269534, 'f1': 0.98984826, 'auroc': 0.99920344, 'binary_precision': 0.99812734, 'binary_recall': 0.9655797, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9815838}
confusion matrix:
       0     1
0  42312     8
1    152  4264
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.72614694, 'recall': 0.56956226, 'specificity': 0.56956226, 'f1': 0.6024, 'auroc': 0.9228664, 'binary_precision': 0.4818653, 'binary_recall': 0.14463453, 'binary_specificity': 0.99449, 'binary_f1_score': 0.22248805}
confusion matrix:
       0    1
0  18049  100
1    550   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9939528, 'precision': 0.9966048, 'recall': 0.97381866, 'specificity': 0.97381866, 'f1': 0.98485404, 'auroc': 0.99878657, 'binary_precision': 1.0, 'binary_recall': 0.9476373, 'binary_specificity': 1.0, 'binary_f1_score': 0.9731148}
confusion matrix:
      0    1
0  5997    0
1    41  742
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_20.png
early stop counter: 4
val acc:0.9654108285903931, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9955752491950989 / 0.9969026446342468
after epoch: 20,now: 2024-06-11 00:36:51.344178,epoch time: 0:20:30.010691,used: 7:02:07.341500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9953098, 'recall': 0.9948074, 'specificity': 0.9948074, 'f1': 0.9950584, 'auroc': 0.99952686, 'binary_precision': 0.9916119, 'binary_recall': 0.9904891, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.9910502}
confusion matrix:
       0     1
0  42283    37
1     42  4374
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.7959037, 'recall': 0.7264918, 'specificity': 0.7264918, 'f1': 0.7561455, 'auroc': 0.9521706, 'binary_precision': 0.6106557, 'binary_recall': 0.46345258, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.5269673}
confusion matrix:
       0    1
0  17959  190
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.99931705, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-11 00:57:45.398174,epoch time: 0:20:54.053996,used: 7:23:01.395496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9982883, 'precision': 0.9986428, 'recall': 0.9913379, 'specificity': 0.9913379, 'f1': 0.99495643, 'auroc': 0.9997066, 'binary_precision': 0.99907815, 'binary_recall': 0.9827703, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9908571}
confusion matrix:
       0     1
0  42321     4
1     76  4335
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7335124, 'recall': 0.5629771, 'specificity': 0.5629771, 'f1': 0.59469163, 'auroc': 0.92923194, 'binary_precision': 0.49704143, 'binary_recall': 0.13063763, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.20689656}
confusion matrix:
       0   1
0  18064  85
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.9995044, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_22.png
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9982300996780396
after epoch: 22,now: 2024-06-11 01:21:31.452113,epoch time: 0:23:46.053939,used: 7:46:47.449435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99850225, 'precision': 0.99722946, 'recall': 0.99399716, 'specificity': 0.99399716, 'f1': 0.9956067, 'auroc': 0.99985826, 'binary_precision': 0.9956631, 'binary_recall': 0.98844326, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.9920401}
confusion matrix:
       0     1
0  42304    19
1     51  4362
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7584733, 'recall': 0.6553654, 'specificity': 0.6553654, 'f1': 0.6928021, 'auroc': 0.91737854, 'binary_precision': 0.54068244, 'binary_recall': 0.32037324, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.40234375}
confusion matrix:
       0    1
0  17974  175
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.99973416, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_23.png
early stop counter: 2
val acc:0.967432975769043, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9982300996780396
after epoch: 23,now: 2024-06-11 01:45:36.352906,epoch time: 0:24:04.900793,used: 8:10:52.350228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.99072605, 'recall': 0.9959964, 'specificity': 0.9959964, 'f1': 0.9933435, 'auroc': 0.9997233, 'binary_precision': 0.9820909, 'binary_recall': 0.9938831, 'binary_specificity': 0.99810976, 'binary_f1_score': 0.9879518}
confusion matrix:
       0     1
0  42242    80
1     27  4387
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7527196, 'recall': 0.6949806, 'specificity': 0.6949806, 'f1': 0.71972996, 'auroc': 0.93930215, 'binary_precision': 0.52642274, 'binary_recall': 0.40279937, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.45638767}
confusion matrix:
       0    1
0  17916  233
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.9994592, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_24.png
early stop counter: 3
val acc:0.9671669006347656, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9982300996780396
after epoch: 24,now: 2024-06-11 02:09:29.743023,epoch time: 0:23:53.390117,used: 8:34:45.740345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.99460936, 'recall': 0.994509, 'specificity': 0.994509, 'f1': 0.99455917, 'auroc': 0.9998077, 'binary_precision': 0.9902583, 'binary_recall': 0.990034, 'binary_specificity': 0.998984, 'binary_f1_score': 0.9901461}
confusion matrix:
       0     1
0  42278    43
1     44  4371
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7404927, 'recall': 0.710043, 'specificity': 0.710043, 'f1': 0.72412205, 'auroc': 0.9397259, 'binary_precision': 0.5008944, 'binary_recall': 0.43545878, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.46589017}
confusion matrix:
       0    1
0  17870  279
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99242747, 'recall': 0.9946129, 'specificity': 0.9946129, 'f1': 0.99351686, 'auroc': 0.9999154, 'binary_precision': 0.9860229, 'binary_recall': 0.99106, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.988535}
confusion matrix:
      0    1
0  5986   11
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_25.png
early stop counter: 4
val acc:0.9658365249633789, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9982300996780396
after epoch: 25,now: 2024-06-11 02:33:18.418245,epoch time: 0:23:48.675222,used: 8:58:34.415567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.998545, 'precision': 0.9980682, 'recall': 0.9934133, 'specificity': 0.9934133, 'f1': 0.995727, 'auroc': 0.9998754, 'binary_precision': 0.9974817, 'binary_recall': 0.98708653, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.99225694}
confusion matrix:
       0     1
0  42311    11
1     57  4357
---- Validation: 
scalar performance:
{'acc': 0.96285653, 'precision': 0.64876246, 'recall': 0.5382377, 'specificity': 0.5382377, 'f1': 0.55643153, 'auroc': 0.9298889, 'binary_precision': 0.32919255, 'binary_recall': 0.08242613, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.1318408}
confusion matrix:
       0    1
0  18041  108
1    590   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99654984, 'recall': 0.9882556, 'specificity': 0.9882556, 'f1': 0.9923558, 'auroc': 0.99903893, 'binary_precision': 0.99609375, 'binary_recall': 0.9770115, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9864604}
confusion matrix:
      0    1
0  5994    3
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_26.png
early stop counter: 5
val acc:0.9628565311431885, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9982300996780396
after epoch: 26,now: 2024-06-11 02:56:36.312867,epoch time: 0:23:17.894622,used: 9:21:52.310189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.9955288, 'recall': 0.9928105, 'specificity': 0.9928105, 'f1': 0.99416494, 'auroc': 0.99954504, 'binary_precision': 0.9924743, 'binary_recall': 0.9864007, 'binary_specificity': 0.9992203, 'binary_f1_score': 0.9894282}
confusion matrix:
       0     1
0  42291    33
1     60  4352
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.78668267, 'recall': 0.53494334, 'specificity': 0.53494334, 'f1': 0.55547374, 'auroc': 0.943798, 'binary_precision': 0.6052632, 'binary_recall': 0.071539655, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.1279555}
confusion matrix:
       0   1
0  18119  30
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99877346, 'recall': 0.9954466, 'specificity': 0.9954466, 'f1': 0.99710256, 'auroc': 0.99998474, 'binary_precision': 0.998713, 'binary_recall': 0.99106, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9948718}
confusion matrix:
      0    1
0  5996    1
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_27.png
new oracle model saved
early stop counter: 6
val acc:0.9666347503662109, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9988200664520264
after epoch: 27,now: 2024-06-11 03:20:21.876854,epoch time: 0:23:45.563987,used: 9:45:37.874176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9967049, 'precision': 0.9859905, 'recall': 0.99503684, 'specificity': 0.99503684, 'f1': 0.9904609, 'auroc': 0.99964094, 'binary_precision': 0.9727152, 'binary_recall': 0.99298006, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.98274314}
confusion matrix:
       0     1
0  42197   123
1     31  4385
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7358376, 'recall': 0.7538279, 'specificity': 0.7538279, 'f1': 0.7444623, 'auroc': 0.93587327, 'binary_precision': 0.4884726, 'binary_recall': 0.5272162, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.50710547}
confusion matrix:
       0    1
0  17794  355
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.97805583, 'recall': 0.99388903, 'specificity': 0.99388903, 'f1': 0.98579705, 'auroc': 0.99965155, 'binary_precision': 0.9569496, 'binary_recall': 0.9936143, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.9749374}
confusion matrix:
      0    1
0  5962   35
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_28.png
early stop counter: 7
val acc:0.9649319052696228, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9988200664520264
after epoch: 28,now: 2024-06-11 03:43:54.861125,epoch time: 0:23:32.984271,used: 10:09:10.858447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99886596, 'precision': 0.9993746, 'recall': 0.9939977, 'specificity': 0.9939977, 'f1': 0.99666786, 'auroc': 0.9999399, 'binary_precision': 1.0, 'binary_recall': 0.98799545, 'binary_specificity': 1.0, 'binary_f1_score': 0.9939615}
confusion matrix:
       0     1
0  42321     0
1     53  4362
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.90919816, 'recall': 0.5394099, 'specificity': 0.5394099, 'f1': 0.5643984, 'auroc': 0.95216435, 'binary_precision': 0.85, 'binary_recall': 0.07931571, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.14509246}
confusion matrix:
       0   1
0  18140   9
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9986695, 'recall': 0.9897829, 'specificity': 0.9897829, 'f1': 0.9941726, 'auroc': 0.99902236, 'binary_precision': 1.0, 'binary_recall': 0.9795658, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896774}
confusion matrix:
      0    1
0  5997    0
1    16  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_29.png
early stop counter: 8
val acc:0.9680182933807373, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9988200664520264
after epoch: 29,now: 2024-06-11 04:07:18.455540,epoch time: 0:23:23.594415,used: 10:32:34.452862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.99926, 'recall': 0.9939859, 'specificity': 0.9939859, 'f1': 0.9966053, 'auroc': 0.99982554, 'binary_precision': 0.9997708, 'binary_recall': 0.98799545, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99384826}
confusion matrix:
       0     1
0  42320     1
1     53  4362
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.8858591, 'recall': 0.5562693, 'specificity': 0.5562693, 'f1': 0.59147674, 'auroc': 0.95659757, 'binary_precision': 0.8021978, 'binary_recall': 0.11353032, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.19891007}
confusion matrix:
       0   1
0  18131  18
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9998677, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_30.png
early stop counter: 9
val acc:0.9687100648880005, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9982300996780396 / 0.9988200664520264
after epoch: 30,now: 2024-06-11 04:30:49.654457,epoch time: 0:23:31.198917,used: 10:56:05.651779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_17_34_43_seed_0_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:56:05.651779 at 2024-06-11 04:30:49.654457
persisted model performance metric: 

scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.9997417, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
oracle model performance metric: 

scalar performance:
{'acc': 0.99734515, 'precision': 0.9962474, 'recall': 0.99072653, 'specificity': 0.99072653, 'f1': 0.9934662, 'auroc': 0.99994445, 'binary_precision': 0.99482536, 'binary_recall': 0.98212004, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9884319}
confusion matrix:
      0    1
0  5993    4
1    14  769
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456645 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456645 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447778 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  40703 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14482 MiB |  14482 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444475 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |   9416 KiB |     17 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3680    |    6847    |  210922 K  |  210918 K  |
|       from large pool |     187    |    1413    |  109805 K  |  109805 K  |
|       from small pool |    3493    |    6658    |  101116 K  |  101113 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3680    |    6847    |  210922 K  |  210918 K  |
|       from large pool |     187    |    1413    |  109805 K  |  109805 K  |
|       from small pool |    3493    |    6658    |  101116 K  |  101113 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |     635    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    2986    |  134096 K  |  134096 K  |
|       from large pool |      37    |     600    |   82212 K  |   82212 K  |
|       from small pool |      41    |    2948    |   51883 K  |   51883 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  14482 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210922 K  |  210922 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101116 K  |  101116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210922 K  |  210922 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101116 K  |  101116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |     635    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2986    |  134097 K  |  134097 K  |
|       from large pool |       4    |     600    |   82212 K  |   82212 K  |
|       from small pool |       0    |    2948    |   51884 K  |   51884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14482 MiB |  14482 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210922 K  |  210922 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101116 K  |  101116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210922 K  |  210922 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101116 K  |  101116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |     635    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2986    |  134097 K  |  134097 K  |
|       from large pool |       4    |     600    |   82212 K  |   82212 K  |
|       from small pool |       0    |    2948    |   51884 K  |   51884 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203

 Experiment start at: 2024-06-11 04:38:32.222286
before training, model accuracy: 0.18123698234558105
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.993367, 'precision': 0.9942477, 'recall': 0.9661422, 'specificity': 0.9661422, 'f1': 0.97968197, 'auroc': 0.9978914, 'binary_precision': 0.9953133, 'binary_recall': 0.93273234, 'binary_specificity': 0.999552, 'binary_f1_score': 0.96300715}
confusion matrix:
       0     1
0  42391    19
1    291  4035
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.69143605, 'recall': 0.5970741, 'specificity': 0.5970741, 'f1': 0.6268697, 'auroc': 0.875986, 'binary_precision': 0.4119403, 'binary_recall': 0.205052, 'binary_specificity': 0.98909616, 'binary_f1_score': 0.27380952}
confusion matrix:
       0    1
0  17870  197
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9888492, 'precision': 0.98947203, 'recall': 0.95582163, 'specificity': 0.95582163, 'f1': 0.9718461, 'auroc': 0.9930978, 'binary_precision': 0.99026424, 'binary_recall': 0.9128205, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.94996667}
confusion matrix:
      0    1
0  5939    7
1    68  712
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 05:02:51.011350,epoch time: 0:24:18.789064,used: 0:24:18.789064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.991912, 'precision': 0.9699387, 'recall': 0.982774, 'specificity': 0.982774, 'f1': 0.976247, 'auroc': 0.99879694, 'binary_precision': 0.94278663, 'binary_recall': 0.9715607, 'binary_specificity': 0.9939874, 'binary_f1_score': 0.9569574}
confusion matrix:
       0     1
0  42156   255
1    123  4202
---- Validation: 
scalar performance:
{'acc': 0.94727856, 'precision': 0.68430877, 'recall': 0.8439092, 'specificity': 0.8439092, 'f1': 0.7358336, 'auroc': 0.9332239, 'binary_precision': 0.37893927, 'binary_recall': 0.73254085, 'binary_specificity': 0.95527756, 'binary_f1_score': 0.4994934}
confusion matrix:
       0    1
0  17259  808
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934582, 'precision': 0.9872335, 'recall': 0.98070586, 'specificity': 0.98070586, 'f1': 0.98394, 'auroc': 0.99907887, 'binary_precision': 0.9791667, 'binary_recall': 0.96410257, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.9715762}
confusion matrix:
      0    1
0  5930   16
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_2.png
new oracle model saved
early stop counter: 1
val acc:0.9472785592079163, best validation acc: 0.9609391689300537, corresponding to test acc:                         0.9888492226600647 / 0.9934582114219666
after epoch: 2,now: 2024-06-11 05:26:15.651742,epoch time: 0:23:24.640392,used: 0:47:43.429456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99638397, 'precision': 0.99779844, 'recall': 0.9806701, 'specificity': 0.9806701, 'f1': 0.98904693, 'auroc': 0.9992858, 'binary_precision': 0.9995192, 'binary_recall': 0.9613873, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.98008245}
confusion matrix:
       0     1
0  42409     2
1    167  4158
---- Validation: 
scalar performance:
{'acc': 0.96723586, 'precision': 0.79346126, 'recall': 0.61464506, 'specificity': 0.61464506, 'f1': 0.66149306, 'auroc': 0.91980314, 'binary_precision': 0.61478597, 'binary_recall': 0.23476969, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.33978492}
confusion matrix:
       0    1
0  17968   99
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9950094, 'recall': 0.98171496, 'specificity': 0.98171496, 'f1': 0.9882406, 'auroc': 0.9994502, 'binary_precision': 0.994709, 'binary_recall': 0.96410257, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.97916675}
confusion matrix:
      0    1
0  5942    4
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-11 05:50:38.559124,epoch time: 0:24:22.907382,used: 1:12:06.336838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9952285, 'precision': 0.9830457, 'recall': 0.98875415, 'specificity': 0.98875415, 'f1': 0.9858788, 'auroc': 0.9988029, 'binary_precision': 0.96805114, 'binary_recall': 0.9808093, 'binary_specificity': 0.996699, 'binary_f1_score': 0.9743884}
confusion matrix:
       0     1
0  42271   140
1     83  4242
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.7263499, 'recall': 0.74345905, 'specificity': 0.74345905, 'f1': 0.734552, 'auroc': 0.92543924, 'binary_precision': 0.47107437, 'binary_recall': 0.50817233, 'binary_specificity': 0.97874576, 'binary_f1_score': 0.48892063}
confusion matrix:
       0    1
0  17683  384
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961344, 'precision': 0.9938482, 'recall': 0.98723185, 'specificity': 0.98723185, 'f1': 0.99051, 'auroc': 0.9982735, 'binary_precision': 0.99088544, 'binary_recall': 0.975641, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.9832041}
confusion matrix:
      0    1
0  5939    7
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_4.png
new oracle model saved
early stop counter: 1
val acc:0.9618462920188904, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9952423572540283 / 0.9961344003677368
after epoch: 4,now: 2024-06-11 06:15:35.159287,epoch time: 0:24:56.600163,used: 1:37:02.937001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99717563, 'precision': 0.9955864, 'recall': 0.9875457, 'specificity': 0.9875457, 'f1': 0.9915249, 'auroc': 0.99907917, 'binary_precision': 0.99364406, 'binary_recall': 0.97572815, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.9846046}
confusion matrix:
       0     1
0  42383    27
1    105  4221
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.80506766, 'recall': 0.54583675, 'specificity': 0.54583675, 'f1': 0.5729267, 'auroc': 0.9448954, 'binary_precision': 0.64285713, 'binary_recall': 0.0936107, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.16342412}
confusion matrix:
       0   1
0  18032  35
1    610  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99449897, 'precision': 0.99690795, 'recall': 0.97628206, 'specificity': 0.97628206, 'f1': 0.9863021, 'auroc': 0.9988782, 'binary_precision': 1.0, 'binary_recall': 0.9525641, 'binary_specificity': 1.0, 'binary_f1_score': 0.97570586}
confusion matrix:
      0    1
0  5946    0
1    37  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_5.png
early stop counter: 2
val acc:0.9655816555023193, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9952423572540283 / 0.9961344003677368
after epoch: 5,now: 2024-06-11 06:41:14.490960,epoch time: 0:25:39.331673,used: 2:02:42.268674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99516433, 'precision': 0.9973496, 'recall': 0.97387886, 'specificity': 0.97387886, 'f1': 0.9852605, 'auroc': 0.9995258, 'binary_precision': 1.0, 'binary_recall': 0.9477577, 'binary_specificity': 1.0, 'binary_f1_score': 0.97317827}
confusion matrix:
       0     1
0  42410     0
1    226  4100
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.9345233, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99256617, 'precision': 0.99583054, 'recall': 0.9679487, 'specificity': 0.9679487, 'f1': 0.9813503, 'auroc': 0.99723244, 'binary_precision': 1.0, 'binary_recall': 0.9358974, 'binary_specificity': 1.0, 'binary_f1_score': 0.9668874}
confusion matrix:
      0    1
0  5946    0
1    50  730
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_6.png
early stop counter: 3
val acc:0.9636605978012085, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9952423572540283 / 0.9961344003677368
after epoch: 6,now: 2024-06-11 07:06:39.801227,epoch time: 0:25:25.310267,used: 2:28:07.578941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9962128, 'precision': 0.984604, 'recall': 0.99313766, 'specificity': 0.99313766, 'f1': 0.98882395, 'auroc': 0.9991764, 'binary_precision': 0.9702948, 'binary_recall': 0.98936415, 'binary_specificity': 0.99691117, 'binary_f1_score': 0.97973675}
confusion matrix:
       0     1
0  42280   131
1     46  4279
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.72038335, 'recall': 0.7740729, 'specificity': 0.7740729, 'f1': 0.7439099, 'auroc': 0.9389214, 'binary_precision': 0.45680472, 'binary_recall': 0.57355124, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.50856394}
confusion matrix:
       0    1
0  17608  459
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9883576, 'recall': 0.9921602, 'specificity': 0.9921602, 'f1': 0.9902489, 'auroc': 0.9985942, 'binary_precision': 0.978399, 'binary_recall': 0.98717946, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.9827696}
confusion matrix:
      0    1
0  5929   17
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_7.png
early stop counter: 4
val acc:0.960192084312439, best validation acc: 0.9672358632087708, corresponding to test acc:                         0.9952423572540283 / 0.9961344003677368
after epoch: 7,now: 2024-06-11 07:31:26.344849,epoch time: 0:24:46.543622,used: 2:52:54.122563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9977747, 'precision': 0.9965604, 'recall': 0.9901593, 'specificity': 0.9901593, 'f1': 0.9933338, 'auroc': 0.9993659, 'binary_precision': 0.99507505, 'binary_recall': 0.9808137, 'binary_specificity': 0.9995048, 'binary_f1_score': 0.98789287}
confusion matrix:
       0     1
0  42389    21
1     83  4243
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.8105042, 'recall': 0.6208376, 'specificity': 0.6208376, 'f1': 0.67052007, 'auroc': 0.9315036, 'binary_precision': 0.6484375, 'binary_recall': 0.24665676, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.3573735}
confusion matrix:
       0    1
0  17977   90
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99449897, 'precision': 0.99400127, 'recall': 0.9790667, 'specificity': 0.9790667, 'f1': 0.98638004, 'auroc': 0.998652, 'binary_precision': 0.9933599, 'binary_recall': 0.95897436, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.9758643}
confusion matrix:
      0    1
0  5941    5
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_8.png
better model found
persisted
after epoch: 8,now: 2024-06-11 07:55:49.549260,epoch time: 0:24:23.204411,used: 3:17:17.326974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.9973627, 'recall': 0.9889822, 'specificity': 0.9889822, 'f1': 0.9931278, 'auroc': 0.99928296, 'binary_precision': 0.9969376, 'binary_recall': 0.97827095, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.98751605}
confusion matrix:
       0     1
0  42397    13
1     94  4232
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.872726, 'recall': 0.5911285, 'specificity': 0.5911285, 'f1': 0.64087796, 'auroc': 0.9433429, 'binary_precision': 0.775, 'binary_recall': 0.18424962, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.2977191}
confusion matrix:
       0    1
0  18031   36
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955397, 'precision': 0.9974899, 'recall': 0.9807692, 'specificity': 0.9807692, 'f1': 0.9889379, 'auroc': 0.99961793, 'binary_precision': 1.0, 'binary_recall': 0.96153843, 'binary_specificity': 1.0, 'binary_f1_score': 0.98039216}
confusion matrix:
      0    1
0  5946    0
1    30  750
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_9.png
better model found
persisted
after epoch: 9,now: 2024-06-11 08:20:01.713811,epoch time: 0:24:12.164551,used: 3:41:29.491525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9974324, 'precision': 0.99155617, 'recall': 0.99318814, 'specificity': 0.99318814, 'f1': 0.9923704, 'auroc': 0.9995507, 'binary_precision': 0.984339, 'binary_recall': 0.98797965, 'binary_specificity': 0.9983966, 'binary_f1_score': 0.9861559}
confusion matrix:
       0     1
0  42342    68
1     52  4274
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.8102407, 'recall': 0.6862633, 'specificity': 0.6862633, 'f1': 0.73135227, 'auroc': 0.943712, 'binary_precision': 0.6432161, 'binary_recall': 0.38038632, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.4780579}
confusion matrix:
       0    1
0  17925  142
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.9964433, 'recall': 0.98756826, 'specificity': 0.98756826, 'f1': 0.99195194, 'auroc': 0.999748, 'binary_precision': 0.9960733, 'binary_recall': 0.975641, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5943    3
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-11 08:44:22.038372,epoch time: 0:24:20.324561,used: 4:05:49.816086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99563503, 'precision': 0.9822142, 'recall': 0.99219775, 'specificity': 0.99219775, 'f1': 0.9871416, 'auroc': 0.99925464, 'binary_precision': 0.9656575, 'binary_recall': 0.98797965, 'binary_specificity': 0.9964159, 'binary_f1_score': 0.97669107}
confusion matrix:
       0     1
0  42258   152
1     52  4274
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.79662806, 'recall': 0.63937926, 'specificity': 0.63937926, 'f1': 0.6871143, 'auroc': 0.9318121, 'binary_precision': 0.61935484, 'binary_recall': 0.28528973, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.39064088}
confusion matrix:
       0    1
0  17949  118
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99479634, 'precision': 0.99474895, 'recall': 0.9797919, 'specificity': 0.9797919, 'f1': 0.9871162, 'auroc': 0.9980016, 'binary_precision': 0.9946879, 'binary_recall': 0.9602564, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.9771689}
confusion matrix:
      0    1
0  5942    4
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_11.png
early stop counter: 1
val acc:0.9680362939834595, best validation acc: 0.9701707363128662, corresponding to test acc:                         0.9967291355133057 / 0.9967291355133057
after epoch: 11,now: 2024-06-11 09:08:33.161539,epoch time: 0:24:11.123167,used: 4:30:00.939253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9989644, 'recall': 0.99097085, 'specificity': 0.99097085, 'f1': 0.9949272, 'auroc': 0.99964905, 'binary_precision': 0.9997646, 'binary_recall': 0.9819653, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.990785}
confusion matrix:
       0     1
0  42410     1
1     78  4247
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.747061, 'recall': 0.55815804, 'specificity': 0.55815804, 'f1': 0.5888728, 'auroc': 0.92539644, 'binary_precision': 0.52597404, 'binary_recall': 0.12035661, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.19588876}
confusion matrix:
       0   1
0  17994  73
1    592  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.99952114, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_12.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9701707363128662, corresponding to test acc:                         0.9967291355133057 / 0.9967291355133057
after epoch: 12,now: 2024-06-11 09:29:50.370344,epoch time: 0:21:17.208805,used: 4:51:18.148058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.99863493, 'recall': 0.98773384, 'specificity': 0.98773384, 'f1': 0.99310905, 'auroc': 0.9992852, 'binary_precision': 0.999763, 'binary_recall': 0.97549134, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9874781}
confusion matrix:
       0     1
0  42410     1
1    106  4219
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.83364254, 'recall': 0.6293421, 'specificity': 0.6293421, 'f1': 0.68288094, 'auroc': 0.94560814, 'binary_precision': 0.69411767, 'binary_recall': 0.26300147, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.3814655}
confusion matrix:
       0    1
0  17989   78
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99449897, 'precision': 0.99690795, 'recall': 0.97628206, 'specificity': 0.97628206, 'f1': 0.9863021, 'auroc': 0.99908966, 'binary_precision': 1.0, 'binary_recall': 0.9525641, 'binary_specificity': 1.0, 'binary_f1_score': 0.97570586}
confusion matrix:
      0    1
0  5946    0
1    37  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_13.png
early stop counter: 3
val acc:0.9693703055381775, best validation acc: 0.9701707363128662, corresponding to test acc:                         0.9967291355133057 / 0.9967291355133057
after epoch: 13,now: 2024-06-11 09:50:30.707237,epoch time: 0:20:40.336893,used: 5:11:58.484951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99516433, 'precision': 0.9811206, 'recall': 0.99048537, 'specificity': 0.99048537, 'f1': 0.98574615, 'auroc': 0.99898076, 'binary_precision': 0.9638009, 'binary_recall': 0.9847434, 'binary_specificity': 0.9962273, 'binary_f1_score': 0.97415966}
confusion matrix:
       0     1
0  42250   160
1     66  4260
---- Validation: 
scalar performance:
{'acc': 0.95997864, 'precision': 0.71189535, 'recall': 0.71674085, 'specificity': 0.71674085, 'f1': 0.714287, 'auroc': 0.9312508, 'binary_precision': 0.44412193, 'binary_recall': 0.45468053, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.4493392}
confusion matrix:
       0    1
0  17684  383
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.99624443, 'recall': 0.98124206, 'specificity': 0.98124206, 'f1': 0.9885887, 'auroc': 0.9977404, 'binary_precision': 0.99734396, 'binary_recall': 0.96282053, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.97977823}
confusion matrix:
      0    1
0  5944    2
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_14.png
early stop counter: 4
val acc:0.9599786400794983, best validation acc: 0.9701707363128662, corresponding to test acc:                         0.9967291355133057 / 0.9967291355133057
after epoch: 14,now: 2024-06-11 10:11:35.453814,epoch time: 0:21:04.746577,used: 5:33:03.231528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9976891, 'precision': 0.99787843, 'recall': 0.9883423, 'specificity': 0.9883423, 'f1': 0.99305266, 'auroc': 0.99946475, 'binary_precision': 0.99810964, 'binary_recall': 0.9768733, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9873772}
confusion matrix:
       0     1
0  42404     8
1    100  4224
---- Validation: 
scalar performance:
{'acc': 0.97049093, 'precision': 0.8039804, 'recall': 0.71289426, 'specificity': 0.71289426, 'f1': 0.7496347, 'auroc': 0.9513055, 'binary_precision': 0.6287554, 'binary_recall': 0.43536404, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.5144864}
confusion matrix:
       0    1
0  17894  173
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.9974067, 'recall': 0.98012817, 'specificity': 0.98012817, 'f1': 0.9885627, 'auroc': 0.9988086, 'binary_precision': 1.0, 'binary_recall': 0.9602564, 'binary_specificity': 1.0, 'binary_f1_score': 0.97972536}
confusion matrix:
      0    1
0  5946    0
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_15.png
better model found
persisted
after epoch: 15,now: 2024-06-11 10:33:23.456884,epoch time: 0:21:48.003070,used: 5:54:51.234598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99762493, 'precision': 0.9986948, 'recall': 0.9871706, 'specificity': 0.9871706, 'f1': 0.9928485, 'auroc': 0.9995202, 'binary_precision': 1.0, 'binary_recall': 0.9743412, 'binary_specificity': 1.0, 'binary_f1_score': 0.9870039}
confusion matrix:
       0     1
0  42410     0
1    111  4215
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8994757, 'recall': 0.55087554, 'specificity': 0.55087554, 'f1': 0.5828557, 'auroc': 0.9550946, 'binary_precision': 0.8313253, 'binary_recall': 0.102526, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.18253969}
confusion matrix:
       0   1
0  18053  14
1    604  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956884, 'precision': 0.99757326, 'recall': 0.98141026, 'specificity': 0.98141026, 'f1': 0.9893127, 'auroc': 0.9993394, 'binary_precision': 1.0, 'binary_recall': 0.96282053, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810581}
confusion matrix:
      0    1
0  5946    0
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_16.png
early stop counter: 1
val acc:0.9670224189758301, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9967291355133057
after epoch: 16,now: 2024-06-11 10:55:07.800351,epoch time: 0:21:44.343467,used: 6:16:35.578065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9979031, 'precision': 0.9944699, 'recall': 0.99303234, 'specificity': 0.99303234, 'f1': 0.9937498, 'auroc': 0.9994385, 'binary_precision': 0.99025977, 'binary_recall': 0.987055, 'binary_specificity': 0.99900967, 'binary_f1_score': 0.9886548}
confusion matrix:
       0     1
0  42368    42
1     56  4270
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79420507, 'recall': 0.57549477, 'specificity': 0.57549477, 'f1': 0.615024, 'auroc': 0.9509718, 'binary_precision': 0.61904764, 'binary_recall': 0.15453194, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.2473246}
confusion matrix:
       0    1
0  18003   64
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.9984436, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_17.png
early stop counter: 2
val acc:0.9662219882011414, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9967291355133057
after epoch: 17,now: 2024-06-11 11:16:54.213557,epoch time: 0:21:46.413206,used: 6:38:21.991271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9987162, 'precision': 0.99908286, 'recall': 0.99327123, 'specificity': 0.99327123, 'f1': 0.99615574, 'auroc': 0.99964184, 'binary_precision': 0.9995315, 'binary_recall': 0.9865896, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9930183}
confusion matrix:
       0     1
0  42409     2
1     58  4267
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.70943946, 'recall': 0.5035486, 'specificity': 0.5035486, 'f1': 0.49815136, 'auroc': 0.9581862, 'binary_precision': 0.45454547, 'binary_recall': 0.0074294205, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.014619883}
confusion matrix:
       0  1
0  18061  6
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.9991709, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_18.png
early stop counter: 3
val acc:0.9640341401100159, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9967291355133057
after epoch: 18,now: 2024-06-11 11:38:18.883174,epoch time: 0:21:24.669617,used: 6:59:46.660888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9979459, 'precision': 0.99887073, 'recall': 0.9889043, 'specificity': 0.9889043, 'f1': 0.99382466, 'auroc': 0.9997604, 'binary_precision': 1.0, 'binary_recall': 0.9778086, 'binary_specificity': 1.0, 'binary_f1_score': 0.9887798}
confusion matrix:
       0     1
0  42410     0
1     96  4230
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.71310866, 'recall': 0.5085278, 'specificity': 0.5085278, 'f1': 0.50799143, 'auroc': 0.94512415, 'binary_precision': 0.46153846, 'binary_recall': 0.017830608, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.034334764}
confusion matrix:
       0   1
0  18053  14
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.99913144, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_19.png
new oracle model saved
early stop counter: 4
val acc:0.9639807939529419, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9971751570701599
after epoch: 19,now: 2024-06-11 11:59:32.000036,epoch time: 0:21:13.116862,used: 7:20:59.777750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.99858725, 'recall': 0.9895624, 'specificity': 0.9895624, 'f1': 0.9940233, 'auroc': 0.9997276, 'binary_precision': 0.9992923, 'binary_recall': 0.97919554, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9891419}
confusion matrix:
       0     1
0  42407     3
1     90  4236
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.9461908, 'recall': 0.56295633, 'specificity': 0.56295633, 'f1': 0.60300815, 'auroc': 0.95973927, 'binary_precision': 0.92391306, 'binary_recall': 0.12630014, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.22222221}
confusion matrix:
       0   1
0  18060   7
1    588  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961344, 'precision': 0.9978232, 'recall': 0.98333335, 'specificity': 0.98333335, 'f1': 0.99043465, 'auroc': 0.99943745, 'binary_precision': 1.0, 'binary_recall': 0.96666664, 'binary_specificity': 1.0, 'binary_f1_score': 0.9830508}
confusion matrix:
      0    1
0  5946    0
1    26  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_20.png
early stop counter: 5
val acc:0.9682497382164001, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9971751570701599
after epoch: 20,now: 2024-06-11 12:20:43.652820,epoch time: 0:21:11.652784,used: 7:42:11.430534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9978817, 'precision': 0.9939472, 'recall': 0.9934343, 'specificity': 0.9934343, 'f1': 0.9936906, 'auroc': 0.9993793, 'binary_precision': 0.98912036, 'binary_recall': 0.98797685, 'binary_specificity': 0.9988918, 'binary_f1_score': 0.9885483}
confusion matrix:
       0     1
0  42364    47
1     52  4273
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7714077, 'recall': 0.6039948, 'specificity': 0.6039948, 'f1': 0.6469628, 'auroc': 0.936556, 'binary_precision': 0.5714286, 'binary_recall': 0.21396731, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.31135133}
confusion matrix:
       0    1
0  17959  108
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405295, 'precision': 0.98445475, 'recall': 0.98661155, 'specificity': 0.98661155, 'f1': 0.9855299, 'auroc': 0.99893266, 'binary_precision': 0.9719388, 'binary_recall': 0.97692305, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.97442454}
confusion matrix:
      0    1
0  5924   22
1    18  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_21.png
early stop counter: 6
val acc:0.9660085439682007, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9971751570701599
after epoch: 21,now: 2024-06-11 12:41:55.276994,epoch time: 0:21:11.624174,used: 8:03:23.054708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9979673, 'precision': 0.9988825, 'recall': 0.9890199, 'specificity': 0.9890199, 'f1': 0.9938896, 'auroc': 0.99987674, 'binary_precision': 1.0, 'binary_recall': 0.97803974, 'binary_specificity': 1.0, 'binary_f1_score': 0.988898}
confusion matrix:
       0     1
0  42410     0
1     95  4231
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.94699734, 'recall': 0.5192611, 'specificity': 0.5192611, 'f1': 0.5282669, 'auroc': 0.9602203, 'binary_precision': 0.9285714, 'binary_recall': 0.038632985, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.07417974}
confusion matrix:
       0   1
0  18065   2
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99256617, 'precision': 0.99583054, 'recall': 0.9679487, 'specificity': 0.9679487, 'f1': 0.9813503, 'auroc': 0.99956906, 'binary_precision': 1.0, 'binary_recall': 0.9358974, 'binary_specificity': 1.0, 'binary_f1_score': 0.9668874}
confusion matrix:
      0    1
0  5946    0
1    50  730
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_22.png
early stop counter: 7
val acc:0.9653682112693787, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9971751570701599
after epoch: 22,now: 2024-06-11 13:05:06.097807,epoch time: 0:23:10.820813,used: 8:26:33.875521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99835247, 'precision': 0.9955552, 'recall': 0.9946292, 'specificity': 0.9946292, 'f1': 0.9950917, 'auroc': 0.9996731, 'binary_precision': 0.99212414, 'binary_recall': 0.9900601, 'binary_specificity': 0.9991983, 'binary_f1_score': 0.9910911}
confusion matrix:
       0     1
0  42376    34
1     43  4283
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.760725, 'recall': 0.68641657, 'specificity': 0.68641657, 'f1': 0.7167294, 'auroc': 0.93270373, 'binary_precision': 0.5441176, 'binary_recall': 0.38484398, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.45082676}
confusion matrix:
       0    1
0  17850  217
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9998534, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_23.png
new oracle model saved
early stop counter: 8
val acc:0.9663286805152893, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 23,now: 2024-06-11 13:34:07.375493,epoch time: 0:29:01.277686,used: 8:55:35.153207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9973254, 'precision': 0.9985306, 'recall': 0.98555243, 'specificity': 0.98555243, 'f1': 0.9919346, 'auroc': 0.999717, 'binary_precision': 1.0, 'binary_recall': 0.9711049, 'binary_specificity': 1.0, 'binary_f1_score': 0.9853407}
confusion matrix:
       0     1
0  42410     0
1    125  4201
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.95309114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99212015, 'precision': 0.9955826, 'recall': 0.96602565, 'specificity': 0.96602565, 'f1': 0.98019695, 'auroc': 0.9979669, 'binary_precision': 1.0, 'binary_recall': 0.9320513, 'binary_specificity': 1.0, 'binary_f1_score': 0.9648308}
confusion matrix:
      0    1
0  5946    0
1    53  727
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_24.png
early stop counter: 9
val acc:0.9640341401100159, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 24,now: 2024-06-11 14:04:41.343053,epoch time: 0:30:33.967560,used: 9:26:09.120767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.9980998, 'recall': 0.99271446, 'specificity': 0.99271446, 'f1': 0.99538887, 'auroc': 0.9997555, 'binary_precision': 0.99765974, 'binary_recall': 0.9856647, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99162596}
confusion matrix:
       0     1
0  42401    10
1     62  4263
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.8604039, 'recall': 0.56677747, 'specificity': 0.56677747, 'f1': 0.6062685, 'auroc': 0.94604003, 'binary_precision': 0.75206614, 'binary_recall': 0.13521545, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.22921912}
confusion matrix:
       0   1
0  18037  30
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99449897, 'precision': 0.99690795, 'recall': 0.97628206, 'specificity': 0.97628206, 'f1': 0.9863021, 'auroc': 0.99951434, 'binary_precision': 1.0, 'binary_recall': 0.9525641, 'binary_specificity': 1.0, 'binary_f1_score': 0.97570586}
confusion matrix:
      0    1
0  5946    0
1    37  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_25.png
early stop counter: 10
val acc:0.9673425555229187, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 25,now: 2024-06-11 14:45:42.955553,epoch time: 0:41:01.612500,used: 10:07:10.733267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99837387, 'precision': 0.99495554, 'recall': 0.9953666, 'specificity': 0.9953666, 'f1': 0.99516094, 'auroc': 0.99977416, 'binary_precision': 0.99075997, 'binary_recall': 0.9916763, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.9912179}
confusion matrix:
       0     1
0  42371    40
1     36  4289
---- Validation: 
scalar performance:
{'acc': 0.9700107, 'precision': 0.84725255, 'recall': 0.6325353, 'specificity': 0.6325353, 'f1': 0.6882006, 'auroc': 0.9398508, 'binary_precision': 0.7211155, 'binary_recall': 0.268945, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.39177486}
confusion matrix:
       0    1
0  17997   70
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.9984909, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9934078, 'auroc': 0.99921733, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0    1
0  5946    0
1    18  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_26.png
early stop counter: 11
val acc:0.9700106978416443, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 26,now: 2024-06-11 15:31:39.107781,epoch time: 0:45:56.152228,used: 10:53:06.885495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9985664, 'precision': 0.9992114, 'recall': 0.9922526, 'specificity': 0.9922526, 'f1': 0.99570143, 'auroc': 0.9998816, 'binary_precision': 1.0, 'binary_recall': 0.9845051, 'binary_specificity': 1.0, 'binary_f1_score': 0.99219203}
confusion matrix:
       0     1
0  42412     0
1     67  4257
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.88991517, 'recall': 0.5257816, 'specificity': 0.5257816, 'f1': 0.54009694, 'auroc': 0.95060414, 'binary_precision': 0.81395346, 'binary_recall': 0.052005943, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.097765364}
confusion matrix:
       0   1
0  18059   8
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99824035, 'recall': 0.98653847, 'specificity': 0.98653847, 'f1': 0.992296, 'auroc': 0.99924326, 'binary_precision': 1.0, 'binary_recall': 0.97307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.98635477}
confusion matrix:
      0    1
0  5946    0
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_27.png
early stop counter: 12
val acc:0.9655283093452454, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 27,now: 2024-06-11 16:16:28.308282,epoch time: 0:44:49.200501,used: 11:37:56.085996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9960844, 'precision': 0.99785185, 'recall': 0.9788439, 'specificity': 0.9788439, 'f1': 0.9881169, 'auroc': 0.9995279, 'binary_precision': 1.0, 'binary_recall': 0.95768785, 'binary_specificity': 1.0, 'binary_f1_score': 0.9783867}
confusion matrix:
       0     1
0  42411     0
1    183  4142
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.95150244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918228, 'precision': 0.9954174, 'recall': 0.9647436, 'specificity': 0.9647436, 'f1': 0.9794257, 'auroc': 0.99846727, 'binary_precision': 1.0, 'binary_recall': 0.92948717, 'binary_specificity': 1.0, 'binary_f1_score': 0.96345514}
confusion matrix:
      0    1
0  5946    0
1    55  725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_28.png
early stop counter: 13
val acc:0.9638740420341492, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 28,now: 2024-06-11 17:00:37.627622,epoch time: 0:44:09.319340,used: 12:22:05.405336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9977961, 'precision': 0.9987886, 'recall': 0.9880925, 'specificity': 0.9880925, 'f1': 0.9933681, 'auroc': 0.9994093, 'binary_precision': 1.0, 'binary_recall': 0.97618496, 'binary_specificity': 1.0, 'binary_f1_score': 0.987949}
confusion matrix:
       0     1
0  42411     0
1    103  4222
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.8867288, 'recall': 0.5338709, 'specificity': 0.5338709, 'f1': 0.5543334, 'auroc': 0.9300902, 'binary_precision': 0.80701756, 'binary_recall': 0.068350665, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.12602739}
confusion matrix:
       0   1
0  18056  11
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.99875224, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_29.png
early stop counter: 14
val acc:0.9659551978111267, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 29,now: 2024-06-11 17:45:25.088996,epoch time: 0:44:47.461374,used: 13:06:52.866710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99841666, 'precision': 0.99902326, 'recall': 0.9915489, 'specificity': 0.9915489, 'f1': 0.9952508, 'auroc': 0.999741, 'binary_precision': 0.99976486, 'binary_recall': 0.9831214, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9913733}
confusion matrix:
       0     1
0  42410     1
1     73  4252
---- Validation: 
scalar performance:
{'acc': 0.9676094, 'precision': 0.93040156, 'recall': 0.5554716, 'specificity': 0.5554716, 'f1': 0.5908107, 'auroc': 0.9573374, 'binary_precision': 0.89285713, 'binary_recall': 0.11144131, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.19815059}
confusion matrix:
       0   1
0  18058   9
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.99974424, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_30.png
early stop counter: 15
val acc:0.9676094055175781, best validation acc: 0.9704909324645996, corresponding to test acc:                         0.9953910112380981 / 0.9974724650382996
after epoch: 30,now: 2024-06-11 18:09:02.480903,epoch time: 0:23:37.391907,used: 13:30:30.258617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_38_32_seed_1_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:30:30.258617 at 2024-06-11 18:09:02.480903
persisted model performance metric: 

scalar performance:
{'acc': 0.9955397, 'precision': 0.9974899, 'recall': 0.9807692, 'specificity': 0.9807692, 'f1': 0.9889379, 'auroc': 0.999738, 'binary_precision': 1.0, 'binary_recall': 0.96153843, 'binary_specificity': 1.0, 'binary_f1_score': 0.98039216}
confusion matrix:
      0    1
0  5946    0
1    30  750
oracle model performance metric: 

scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.9998025, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447776 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |  40701 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14482 MiB |  28076 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     68 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446862 KiB |   1252 MiB |   1714 TiB |   1714 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |  11473 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6847    |  421942 K  |  421939 K  |
|       from large pool |     187    |    1413    |  219699 K  |  219699 K  |
|       from small pool |    3475    |    6658    |  202243 K  |  202239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6847    |  421942 K  |  421939 K  |
|       from large pool |     187    |    1413    |  219699 K  |  219699 K  |
|       from small pool |    3475    |    6658    |  202243 K  |  202239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     635    |    1207    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      34    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2988    |  264171 K  |  264171 K  |
|       from large pool |      40    |     604    |  159499 K  |  159499 K  |
|       from small pool |      43    |    2948    |  104671 K  |  104671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     68 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |      0 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421942 K  |  421942 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202243 K  |  202243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421942 K  |  421942 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202243 K  |  202243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      34    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  264173 K  |  264173 K  |
|       from large pool |       4    |     604    |  159499 K  |  159499 K  |
|       from small pool |       0    |    2948    |  104673 K  |  104673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     68 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |      0 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421942 K  |  421942 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202243 K  |  202243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421942 K  |  421942 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202243 K  |  202243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      34    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  264173 K  |  264173 K  |
|       from large pool |       4    |     604    |  159499 K  |  159499 K  |
|       from small pool |       0    |    2948    |  104673 K  |  104673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203

 Experiment start at: 2024-06-11 18:16:57.556511
before training, model accuracy: 0.7911646366119385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9915685, 'precision': 0.96549946, 'recall': 0.98815155, 'specificity': 0.98815155, 'f1': 0.97647953, 'auroc': 0.9985728, 'binary_precision': 0.9327345, 'binary_recall': 0.9839136, 'binary_specificity': 0.9923895, 'binary_f1_score': 0.9576407}
confusion matrix:
       0     1
0  41988   322
1     73  4465
---- Validation: 
scalar performance:
{'acc': 0.9509402, 'precision': 0.6760243, 'recall': 0.8285026, 'specificity': 0.8285026, 'f1': 0.7256323, 'auroc': 0.9303423, 'binary_precision': 0.36238137, 'binary_recall': 0.6976744, 'binary_specificity': 0.9593308, 'binary_f1_score': 0.4770017}
confusion matrix:
       0    1
0  17432  739
1    182  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.99700993, 'recall': 0.98674786, 'specificity': 0.98674786, 'f1': 0.9918088, 'auroc': 0.99883157, 'binary_precision': 0.99717915, 'binary_recall': 0.9738292, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9853659}
confusion matrix:
      0    1
0  5995    2
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 18:42:11.444673,epoch time: 0:25:13.888162,used: 0:25:13.888162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99393785, 'precision': 0.99613786, 'recall': 0.9692005, 'specificity': 0.9692005, 'f1': 0.98219466, 'auroc': 0.9986422, 'binary_precision': 0.9988274, 'binary_recall': 0.9385192, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.96773463}
confusion matrix:
       0     1
0  42305     5
1    279  4259
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.73031604, 'recall': 0.6889966, 'specificity': 0.6889966, 'f1': 0.70740163, 'auroc': 0.9229074, 'binary_precision': 0.48065174, 'binary_recall': 0.39202657, 'binary_specificity': 0.9859666, 'binary_f1_score': 0.431839}
confusion matrix:
       0    1
0  17916  255
1    366  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9928603, 'precision': 0.99537593, 'recall': 0.9675475, 'specificity': 0.9675475, 'f1': 0.98093694, 'auroc': 0.99806404, 'binary_precision': 0.99852943, 'binary_recall': 0.9352617, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9658606}
confusion matrix:
      0    1
0  5996    1
1    47  679
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_2.png
better model found
persisted
after epoch: 2,now: 2024-06-11 19:08:15.227530,epoch time: 0:26:03.782857,used: 0:51:17.671019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9878116, 'precision': 0.9933419, 'recall': 0.93710065, 'specificity': 0.93710065, 'f1': 0.96308804, 'auroc': 0.99928015, 'binary_precision': 1.0, 'binary_recall': 0.87420136, 'binary_specificity': 1.0, 'binary_f1_score': 0.93287885}
confusion matrix:
       0     1
0  42309     0
1    571  3968
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.9270735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9836382, 'precision': 0.990994, 'recall': 0.92424244, 'specificity': 0.92424244, 'f1': 0.9544724, 'auroc': 0.9995693, 'binary_precision': 1.0, 'binary_recall': 0.8484849, 'binary_specificity': 1.0, 'binary_f1_score': 0.9180328}
confusion matrix:
      0    1
0  5997    0
1   110  616
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_3.png
better model found
persisted
after epoch: 3,now: 2024-06-11 19:34:12.148526,epoch time: 0:25:56.920996,used: 1:17:14.592015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9899889, 'precision': 0.9945182, 'recall': 0.9483366, 'specificity': 0.9483366, 'f1': 0.97000504, 'auroc': 0.99847543, 'binary_precision': 1.0, 'binary_recall': 0.89667326, 'binary_specificity': 1.0, 'binary_f1_score': 0.9455221}
confusion matrix:
       0     1
0  42309     0
1    469  4070
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.8173504, 'recall': 0.50163364, 'specificity': 0.50163364, 'f1': 0.49517122, 'auroc': 0.9422541, 'binary_precision': 0.6666667, 'binary_recall': 0.003322259, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0066115703}
confusion matrix:
       0  1
0  18170  1
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98676187, 'precision': 0.9926882, 'recall': 0.9387052, 'specificity': 0.9387052, 'f1': 0.9636686, 'auroc': 0.997748, 'binary_precision': 1.0, 'binary_recall': 0.8774105, 'binary_specificity': 1.0, 'binary_f1_score': 0.9347029}
confusion matrix:
      0    1
0  5997    0
1    89  637
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 20:00:45.127403,epoch time: 0:26:32.978877,used: 1:43:47.570892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99637127, 'precision': 0.99416906, 'recall': 0.98501027, 'specificity': 0.98501027, 'f1': 0.98953533, 'auroc': 0.9994427, 'binary_precision': 0.9914511, 'binary_recall': 0.9709187, 'binary_specificity': 0.9991018, 'binary_f1_score': 0.9810775}
confusion matrix:
       0     1
0  42271    38
1    132  4407
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.70041925, 'recall': 0.56906724, 'specificity': 0.56906724, 'f1': 0.5994874, 'auroc': 0.9403168, 'binary_precision': 0.42857143, 'binary_recall': 0.14451827, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.21614906}
confusion matrix:
       0    1
0  18055  116
1    515   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99464524, 'precision': 0.99701643, 'recall': 0.9752066, 'specificity': 0.9752066, 'f1': 0.98579186, 'auroc': 0.9975134, 'binary_precision': 1.0, 'binary_recall': 0.9504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.9745763}
confusion matrix:
      0    1
0  5997    0
1    36  690
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_5.png
early stop counter: 1
val acc:0.9663878679275513, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9867618680000305 / 0.9968764185905457
after epoch: 5,now: 2024-06-11 20:27:11.520985,epoch time: 0:26:26.393582,used: 2:10:13.964474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99577355, 'precision': 0.997671, 'recall': 0.978189, 'specificity': 0.978189, 'f1': 0.98768413, 'auroc': 0.99952984, 'binary_precision': 1.0, 'binary_recall': 0.95637804, 'binary_specificity': 1.0, 'binary_f1_score': 0.97770274}
confusion matrix:
       0     1
0  42309     0
1    198  4341
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.9396271, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9933066, 'precision': 0.9962761, 'recall': 0.96900827, 'specificity': 0.96900827, 'f1': 0.9821396, 'auroc': 0.9990009, 'binary_precision': 1.0, 'binary_recall': 0.93801653, 'binary_specificity': 1.0, 'binary_f1_score': 0.96801704}
confusion matrix:
      0    1
0  5997    0
1    45  681
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_6.png
early stop counter: 2
val acc:0.9677728414535522, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9867618680000305 / 0.9968764185905457
after epoch: 6,now: 2024-06-11 20:54:03.159795,epoch time: 0:26:51.638810,used: 2:37:05.603284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9963499, 'precision': 0.9966599, 'recall': 0.98244166, 'specificity': 0.98244166, 'f1': 0.98942006, 'auroc': 0.9996633, 'binary_precision': 0.9970414, 'binary_recall': 0.9651906, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9808575}
confusion matrix:
       0     1
0  42296    13
1    158  4381
---- Validation: 
scalar performance:
{'acc': 0.96415067, 'precision': 0.48390546, 'recall': 0.49804634, 'specificity': 0.49804634, 'f1': 0.49087405, 'auroc': 0.9273058, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18100  71
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99419904, 'precision': 0.99548584, 'recall': 0.97435117, 'specificity': 0.97435117, 'f1': 0.9846175, 'auroc': 0.99833894, 'binary_precision': 0.99710566, 'binary_recall': 0.9490358, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9724771}
confusion matrix:
      0    1
0  5995    2
1    37  689
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_7.png
early stop counter: 3
val acc:0.9641506671905518, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9867618680000305 / 0.9968764185905457
after epoch: 7,now: 2024-06-11 21:20:42.317316,epoch time: 0:26:39.157521,used: 3:03:44.760805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99711835, 'precision': 0.99267447, 'recall': 0.99083257, 'specificity': 0.99083257, 'f1': 0.9917513, 'auroc': 0.9990364, 'binary_precision': 0.98716813, 'binary_recall': 0.9830359, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.98509765}
confusion matrix:
       0     1
0  42251    58
1     77  4462
---- Validation: 
scalar performance:
{'acc': 0.9511533, 'precision': 0.6642261, 'recall': 0.767581, 'specificity': 0.767581, 'f1': 0.70157325, 'auroc': 0.9133688, 'binary_precision': 0.3429711, 'binary_recall': 0.5714286, 'binary_specificity': 0.96373343, 'binary_f1_score': 0.42866045}
confusion matrix:
       0    1
0  17512  659
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99419904, 'precision': 0.9893156, 'recall': 0.9804045, 'specificity': 0.9804045, 'f1': 0.9848063, 'auroc': 0.9985759, 'binary_precision': 0.98312235, 'binary_recall': 0.9628099, 'binary_specificity': 0.997999, 'binary_f1_score': 0.97286016}
confusion matrix:
      0    1
0  5985   12
1    27  699
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_8.png
early stop counter: 4
val acc:0.9511532783508301, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9867618680000305 / 0.9968764185905457
after epoch: 8,now: 2024-06-11 21:44:46.911948,epoch time: 0:24:04.594632,used: 3:27:49.355437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9978014, 'precision': 0.99838257, 'recall': 0.9890473, 'specificity': 0.9890473, 'f1': 0.993659, 'auroc': 0.99941313, 'binary_precision': 0.9990999, 'binary_recall': 0.97818905, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9885339}
confusion matrix:
       0     1
0  42305     4
1     99  4440
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.77591777, 'recall': 0.61588156, 'specificity': 0.61588156, 'f1': 0.6605505, 'auroc': 0.9236527, 'binary_precision': 0.5766129, 'binary_recall': 0.23754153, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.3364706}
confusion matrix:
       0    1
0  18066  105
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956865, 'precision': 0.99696064, 'recall': 0.9806329, 'specificity': 0.9806329, 'f1': 0.9886184, 'auroc': 0.9998045, 'binary_precision': 0.99856937, 'binary_recall': 0.9614325, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9796491}
confusion matrix:
      0    1
0  5996    1
1    28  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_9.png
better model found
persisted
after epoch: 9,now: 2024-06-11 22:07:09.715736,epoch time: 0:22:22.803788,used: 3:50:12.159225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9965634, 'precision': 0.9981046, 'recall': 0.9822648, 'specificity': 0.9822648, 'f1': 0.9900228, 'auroc': 0.999501, 'binary_precision': 1.0, 'binary_recall': 0.96452963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9819446}
confusion matrix:
       0     1
0  42309     0
1    161  4378
---- Validation: 
scalar performance:
{'acc': 0.97144836, 'precision': 0.8528323, 'recall': 0.5853331, 'specificity': 0.5853331, 'f1': 0.63250273, 'auroc': 0.93544376, 'binary_precision': 0.73239434, 'binary_recall': 0.17275748, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.27956986}
confusion matrix:
       0    1
0  18133   38
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.99974465, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_10.png
better model found
persisted
after epoch: 10,now: 2024-06-11 22:29:56.422463,epoch time: 0:22:46.706727,used: 4:12:58.865952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99404454, 'precision': 0.9825697, 'recall': 0.9834239, 'specificity': 0.9834239, 'f1': 0.98299634, 'auroc': 0.99860823, 'binary_precision': 0.96833074, 'binary_recall': 0.9702512, 'binary_specificity': 0.9965966, 'binary_f1_score': 0.96929}
confusion matrix:
       0     1
0  42166   144
1    135  4403
---- Validation: 
scalar performance:
{'acc': 0.95978266, 'precision': 0.7083065, 'recall': 0.84832823, 'specificity': 0.84832823, 'f1': 0.7583189, 'auroc': 0.9403124, 'binary_precision': 0.4258002, 'binary_recall': 0.7292359, 'binary_specificity': 0.96742064, 'binary_f1_score': 0.5376608}
confusion matrix:
       0    1
0  17579  592
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405026, 'precision': 0.99476486, 'recall': 0.9742678, 'specificity': 0.9742678, 'f1': 0.9842328, 'auroc': 0.99963224, 'binary_precision': 0.9956647, 'binary_recall': 0.9490358, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.97179127}
confusion matrix:
      0    1
0  5994    3
1    37  689
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_11.png
early stop counter: 1
val acc:0.9597826600074768, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 11,now: 2024-06-11 22:52:18.482767,epoch time: 0:22:22.060304,used: 4:35:20.926256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9969049, 'precision': 0.99808824, 'recall': 0.9842205, 'specificity': 0.9842205, 'f1': 0.99103045, 'auroc': 0.9994694, 'binary_precision': 0.99954516, 'binary_recall': 0.96848834, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9837716}
confusion matrix:
       0     1
0  42308     2
1    143  4395
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.5839887, 'recall': 0.5007205, 'specificity': 0.5007205, 'f1': 0.49345827, 'auroc': 0.9377358, 'binary_precision': 0.2, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0032948926}
confusion matrix:
       0  1
0  18167  4
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994794, 'precision': 0.9970988, 'recall': 0.9758953, 'specificity': 0.9758953, 'f1': 0.98619515, 'auroc': 0.99981236, 'binary_precision': 1.0, 'binary_recall': 0.95179063, 'binary_specificity': 1.0, 'binary_f1_score': 0.97529995}
confusion matrix:
      0    1
0  5997    0
1    35  691
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_12.png
early stop counter: 2
val acc:0.9677728414535522, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 12,now: 2024-06-11 23:14:43.552322,epoch time: 0:22:25.069555,used: 4:57:45.995811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99735314, 'precision': 0.9932036, 'recall': 0.9916509, 'specificity': 0.9916509, 'f1': 0.9924257, 'auroc': 0.99924535, 'binary_precision': 0.988061, 'binary_recall': 0.9845781, 'binary_specificity': 0.9987237, 'binary_f1_score': 0.98631644}
confusion matrix:
       0     1
0  42255    54
1     70  4469
---- Validation: 
scalar performance:
{'acc': 0.9552016, 'precision': 0.6566146, 'recall': 0.68535215, 'specificity': 0.68535215, 'f1': 0.66959053, 'auroc': 0.88916534, 'binary_precision': 0.33333334, 'binary_recall': 0.39700997, 'binary_specificity': 0.9736943, 'binary_f1_score': 0.36239576}
confusion matrix:
       0    1
0  17693  478
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99360406, 'precision': 0.9803461, 'recall': 0.9867296, 'specificity': 0.9867296, 'f1': 0.98351, 'auroc': 0.9981177, 'binary_precision': 0.963365, 'binary_recall': 0.9779614, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.9706084}
confusion matrix:
      0    1
0  5970   27
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_13.png
early stop counter: 3
val acc:0.9552016258239746, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 13,now: 2024-06-11 23:37:30.356380,epoch time: 0:22:46.804058,used: 5:20:32.799869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979508, 'precision': 0.9981648, 'recall': 0.9901112, 'specificity': 0.9901112, 'f1': 0.9940964, 'auroc': 0.9997901, 'binary_precision': 0.99842906, 'binary_recall': 0.9803878, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9893262}
confusion matrix:
       0     1
0  42303     7
1     89  4449
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.6012804, 'recall': 0.5207243, 'specificity': 0.5207243, 'f1': 0.5297381, 'auroc': 0.9341365, 'binary_precision': 0.23333333, 'binary_recall': 0.046511628, 'binary_specificity': 0.994937, 'binary_f1_score': 0.077562325}
confusion matrix:
       0   1
0  18079  92
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99726367, 'recall': 0.97727275, 'specificity': 0.97727275, 'f1': 0.98700017, 'auroc': 0.9998883, 'binary_precision': 1.0, 'binary_recall': 0.95454544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9767442}
confusion matrix:
      0    1
0  5997    0
1    33  693
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_14.png
early stop counter: 4
val acc:0.9645234942436218, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 14,now: 2024-06-12 00:05:18.280977,epoch time: 0:27:47.924597,used: 5:48:20.724466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9922302, 'precision': 0.995303, 'recall': 0.9602964, 'specificity': 0.9602964, 'f1': 0.97699136, 'auroc': 0.9970788, 'binary_precision': 0.99904376, 'binary_recall': 0.9206874, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.95826644}
confusion matrix:
       0     1
0  42305     4
1    360  4179
---- Validation: 
scalar performance:
{'acc': 0.97080916, 'precision': 0.8119575, 'recall': 0.59544253, 'specificity': 0.59544253, 'f1': 0.64216346, 'auroc': 0.92206025, 'binary_precision': 0.65, 'binary_recall': 0.19435216, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.29923275}
confusion matrix:
       0    1
0  18108   63
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9879518, 'precision': 0.9933366, 'recall': 0.9442149, 'specificity': 0.9442149, 'f1': 0.9671055, 'auroc': 0.9950621, 'binary_precision': 1.0, 'binary_recall': 0.88842976, 'binary_specificity': 1.0, 'binary_f1_score': 0.94091904}
confusion matrix:
      0    1
0  5997    0
1    81  645
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_15.png
early stop counter: 5
val acc:0.9708091616630554, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 15,now: 2024-06-12 00:30:45.111586,epoch time: 0:25:26.830609,used: 6:13:47.555075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99852717, 'precision': 0.9973022, 'recall': 0.99426764, 'specificity': 0.99426764, 'f1': 0.99577904, 'auroc': 0.9996618, 'binary_precision': 0.9957853, 'binary_recall': 0.98898435, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.9923732}
confusion matrix:
       0     1
0  42290    19
1     50  4489
---- Validation: 
scalar performance:
{'acc': 0.965216, 'precision': 0.72251207, 'recall': 0.74352646, 'specificity': 0.74352646, 'f1': 0.7324898, 'auroc': 0.9359857, 'binary_precision': 0.4614221, 'binary_recall': 0.50664455, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.48297706}
confusion matrix:
       0    1
0  17815  356
1    297  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9959641, 'recall': 0.9839096, 'specificity': 0.9839096, 'f1': 0.98983973, 'auroc': 0.9993806, 'binary_precision': 0.9957507, 'binary_recall': 0.96831954, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9818436}
confusion matrix:
      0    1
0  5994    3
1    23  703
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_16.png
early stop counter: 6
val acc:0.9652159810066223, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 16,now: 2024-06-12 00:56:29.929492,epoch time: 0:25:44.817906,used: 6:39:32.372981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99844176, 'precision': 0.99656683, 'recall': 0.9945142, 'specificity': 0.9945142, 'f1': 0.9955379, 'auroc': 0.999748, 'binary_precision': 0.994244, 'binary_recall': 0.98964304, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.9919382}
confusion matrix:
       0     1
0  42284    26
1     47  4491
---- Validation: 
scalar performance:
{'acc': 0.96478987, 'precision': 0.691287, 'recall': 0.6035759, 'specificity': 0.6035759, 'f1': 0.6329041, 'auroc': 0.92058146, 'binary_precision': 0.40809968, 'binary_recall': 0.21760798, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.283857}
confusion matrix:
       0    1
0  17981  190
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.9998826, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_17.png
new oracle model saved
early stop counter: 7
val acc:0.964789867401123, best validation acc: 0.9714483618736267, corresponding to test acc:                         0.9958351850509644 / 0.9985125660896301
after epoch: 17,now: 2024-06-12 01:22:28.393038,epoch time: 0:25:58.463546,used: 7:05:30.836527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99805754, 'precision': 0.99822456, 'recall': 0.9906621, 'specificity': 0.9906621, 'f1': 0.9944067, 'auroc': 0.9997262, 'binary_precision': 0.99843085, 'binary_recall': 0.98148966, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9898878}
confusion matrix:
       0     1
0  42303     7
1     84  4454
---- Validation: 
scalar performance:
{'acc': 0.9742183, 'precision': 0.8689388, 'recall': 0.64137125, 'specificity': 0.64137125, 'f1': 0.70113873, 'auroc': 0.954713, 'binary_precision': 0.76106197, 'binary_recall': 0.2857143, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.41545895}
confusion matrix:
       0    1
0  18117   54
1    430  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9999789, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_18.png
better model found
persisted
after epoch: 18,now: 2024-06-12 01:48:27.660457,epoch time: 0:25:59.267419,used: 7:31:30.103946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9987833, 'precision': 0.9975473, 'recall': 0.99549115, 'specificity': 0.99549115, 'f1': 0.9965166, 'auroc': 0.99985003, 'binary_precision': 0.99601597, 'binary_recall': 0.9914078, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.9937065}
confusion matrix:
       0     1
0  42291    18
1     39  4500
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.8102625, 'recall': 0.5823736, 'specificity': 0.5823736, 'f1': 0.62568855, 'auroc': 0.91613084, 'binary_precision': 0.6474359, 'binary_recall': 0.16777408, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.26649076}
confusion matrix:
       0    1
0  18116   55
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.99890876, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_19.png
early stop counter: 1
val acc:0.9703829884529114, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 19,now: 2024-06-12 02:14:22.120086,epoch time: 0:25:54.459629,used: 7:57:24.563575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980362, 'precision': 0.9985131, 'recall': 0.99025685, 'specificity': 0.99025685, 'f1': 0.99434125, 'auroc': 0.9998828, 'binary_precision': 0.99910194, 'binary_recall': 0.9806082, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.98976874}
confusion matrix:
       0     1
0  42306     4
1     88  4450
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.823651, 'recall': 0.56293535, 'specificity': 0.56293535, 'f1': 0.5999123, 'auroc': 0.92862755, 'binary_precision': 0.6754386, 'binary_recall': 0.12790698, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.21508381}
confusion matrix:
       0   1
0  18134  37
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9931578, 'precision': 0.99619395, 'recall': 0.96831954, 'specificity': 0.96831954, 'f1': 0.9817313, 'auroc': 0.9988478, 'binary_precision': 1.0, 'binary_recall': 0.93663913, 'binary_specificity': 1.0, 'binary_f1_score': 0.9672831}
confusion matrix:
      0    1
0  5997    0
1    46  680
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_20.png
early stop counter: 2
val acc:0.9700633883476257, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 20,now: 2024-06-12 02:40:07.135459,epoch time: 0:25:45.015373,used: 8:23:09.578948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9963926, 'precision': 0.99801075, 'recall': 0.98137945, 'specificity': 0.98137945, 'f1': 0.9895165, 'auroc': 0.9994689, 'binary_precision': 1.0, 'binary_recall': 0.9627589, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810262}
confusion matrix:
       0     1
0  42310     0
1    169  4369
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.5840111, 'recall': 0.501441, 'specificity': 0.501441, 'f1': 0.49503705, 'auroc': 0.9259814, 'binary_precision': 0.2, 'binary_recall': 0.003322259, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.0065359473}
confusion matrix:
       0  1
0  18163  8
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99226534, 'precision': 0.9957018, 'recall': 0.9641873, 'specificity': 0.9641873, 'f1': 0.97927016, 'auroc': 0.99941707, 'binary_precision': 1.0, 'binary_recall': 0.92837465, 'binary_specificity': 1.0, 'binary_f1_score': 0.9628571}
confusion matrix:
      0    1
0  5997    0
1    52  674
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_21.png
early stop counter: 3
val acc:0.9676130414009094, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 21,now: 2024-06-12 03:05:56.343631,epoch time: 0:25:49.208172,used: 8:48:58.787120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99882597, 'precision': 0.9992512, 'recall': 0.9940397, 'specificity': 0.9940397, 'f1': 0.9966281, 'auroc': 0.9997134, 'binary_precision': 0.9997771, 'binary_recall': 0.9881031, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9939057}
confusion matrix:
       0     1
0  42308     1
1     54  4485
---- Validation: 
scalar performance:
{'acc': 0.97272676, 'precision': 0.89764607, 'recall': 0.59482706, 'specificity': 0.59482706, 'f1': 0.64803076, 'auroc': 0.9526727, 'binary_precision': 0.8214286, 'binary_recall': 0.1910299, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.30997303}
confusion matrix:
       0    1
0  18146   25
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.99927926, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_22.png
early stop counter: 4
val acc:0.9727267622947693, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 22,now: 2024-06-12 03:31:33.947425,epoch time: 0:25:37.603794,used: 9:14:36.390914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.99912703, 'recall': 0.99184847, 'specificity': 0.99184847, 'f1': 0.99545383, 'auroc': 0.9999061, 'binary_precision': 1.0, 'binary_recall': 0.9836969, 'binary_specificity': 1.0, 'binary_f1_score': 0.9917814}
confusion matrix:
       0     1
0  42309     0
1     74  4465
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.8230777, 'recall': 0.54086787, 'specificity': 0.54086787, 'f1': 0.5661533, 'auroc': 0.9196942, 'binary_precision': 0.6756757, 'binary_recall': 0.08305648, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.147929}
confusion matrix:
       0   1
0  18147  24
1    552  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995389, 'precision': 0.99742866, 'recall': 0.9786501, 'specificity': 0.9786501, 'f1': 0.9878032, 'auroc': 0.9976004, 'binary_precision': 1.0, 'binary_recall': 0.95730025, 'binary_specificity': 1.0, 'binary_f1_score': 0.9781844}
confusion matrix:
      0    1
0  5997    0
1    31  695
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_23.png
early stop counter: 5
val acc:0.969317615032196, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 23,now: 2024-06-12 03:57:09.717822,epoch time: 0:25:35.770397,used: 9:40:12.161311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99801487, 'precision': 0.9985013, 'recall': 0.9901488, 'specificity': 0.9901488, 'f1': 0.99428034, 'auroc': 0.9993235, 'binary_precision': 0.99910194, 'binary_recall': 0.98039216, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9896586}
confusion matrix:
       0     1
0  42305     4
1     89  4450
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.8144033, 'recall': 0.54244643, 'specificity': 0.54244643, 'f1': 0.56853247, 'auroc': 0.9474801, 'binary_precision': 0.65822786, 'binary_recall': 0.08637874, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.15271659}
confusion matrix:
       0   1
0  18144  27
1    550  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9989969, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_24.png
early stop counter: 6
val acc:0.9692643880844116, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 24,now: 2024-06-12 04:22:46.692954,epoch time: 0:25:36.975132,used: 10:05:49.136443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9885374, 'precision': 0.948766, 'recall': 0.9911953, 'specificity': 0.9911953, 'f1': 0.9687374, 'auroc': 0.9993162, 'binary_precision': 0.8981297, 'binary_recall': 0.9944922, 'binary_specificity': 0.9878985, 'binary_f1_score': 0.9438578}
confusion matrix:
       0     1
0  41797   512
1     25  4514
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7615396, 'recall': 0.6679696, 'specificity': 0.6679696, 'f1': 0.7036145, 'auroc': 0.9285495, 'binary_precision': 0.5445026, 'binary_recall': 0.34551495, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.4227642}
confusion matrix:
       0    1
0  17997  174
1    394  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9845307, 'precision': 0.940355, 'recall': 0.9864863, 'specificity': 0.9864863, 'f1': 0.9618662, 'auroc': 0.99934494, 'binary_precision': 0.88206387, 'binary_recall': 0.9889807, 'binary_specificity': 0.983992, 'binary_f1_score': 0.93246746}
confusion matrix:
      0    1
0  5901   96
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_25.png
early stop counter: 7
val acc:0.9697437882423401, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 25,now: 2024-06-12 04:48:22.285961,epoch time: 0:25:35.593007,used: 10:31:24.729450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.997097, 'precision': 0.99829614, 'recall': 0.9851171, 'specificity': 0.9851171, 'f1': 0.99159473, 'auroc': 0.9996856, 'binary_precision': 0.99977297, 'binary_recall': 0.97025776, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9847942}
confusion matrix:
       0     1
0  42308     1
1    135  4404
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7473746, 'recall': 0.508058, 'specificity': 0.508058, 'f1': 0.5079649, 'auroc': 0.9475205, 'binary_precision': 0.5263158, 'binary_recall': 0.016611295, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.032206118}
confusion matrix:
       0   1
0  18162   9
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99718124, 'recall': 0.976584, 'specificity': 0.976584, 'f1': 0.9865979, 'auroc': 0.99925125, 'binary_precision': 1.0, 'binary_recall': 0.95316803, 'binary_specificity': 1.0, 'binary_f1_score': 0.97602254}
confusion matrix:
      0    1
0  5997    0
1    34  692
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_26.png
early stop counter: 8
val acc:0.9679859280586243, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 26,now: 2024-06-12 05:13:55.454591,epoch time: 0:25:33.168630,used: 10:56:57.898080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983564, 'precision': 0.99899143, 'recall': 0.99161625, 'specificity': 0.99161625, 'f1': 0.99526906, 'auroc': 0.9996165, 'binary_precision': 0.999776, 'binary_recall': 0.9832562, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9914473}
confusion matrix:
       0     1
0  42308     1
1     76  4463
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.5397123, 'recall': 0.50610435, 'specificity': 0.50610435, 'f1': 0.5053338, 'auroc': 0.93779886, 'binary_precision': 0.11111111, 'binary_recall': 0.016611295, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.028901732}
confusion matrix:
       0   1
0  18091  80
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9999474, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_27.png
early stop counter: 9
val acc:0.9642038941383362, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 27,now: 2024-06-12 05:39:23.250335,epoch time: 0:25:27.795744,used: 11:22:25.693824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.9989324, 'recall': 0.9910655, 'specificity': 0.9910655, 'f1': 0.99495935, 'auroc': 0.9995632, 'binary_precision': 0.9997757, 'binary_recall': 0.98215467, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99088687}
confusion matrix:
       0     1
0  42308     1
1     81  4458
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.84174633, 'recall': 0.520489, 'specificity': 0.520489, 'f1': 0.53129447, 'auroc': 0.9305836, 'binary_precision': 0.71428573, 'binary_recall': 0.04152824, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.07849294}
confusion matrix:
       0   1
0  18161  10
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.99825525, 'recall': 0.9855372, 'specificity': 0.9855372, 'f1': 0.99178857, 'auroc': 0.99974394, 'binary_precision': 1.0, 'binary_recall': 0.9710744, 'binary_specificity': 1.0, 'binary_f1_score': 0.985325}
confusion matrix:
      0    1
0  5997    0
1    21  705
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_28.png
early stop counter: 10
val acc:0.968731701374054, best validation acc: 0.9742183089256287, corresponding to test acc:                         0.9955376982688904 / 0.9985125660896301
after epoch: 28,now: 2024-06-12 06:02:33.346702,epoch time: 0:23:10.096367,used: 11:45:35.790191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9990608, 'precision': 0.9985893, 'recall': 0.9960373, 'specificity': 0.9960373, 'f1': 0.99730915, 'auroc': 0.99983776, 'binary_precision': 0.99800533, 'binary_recall': 0.99228734, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9951381}
confusion matrix:
       0     1
0  42301     9
1     35  4503
---- Validation: 
scalar performance:
{'acc': 0.9744846, 'precision': 0.846405, 'recall': 0.66800946, 'specificity': 0.66800946, 'f1': 0.7240626, 'auroc': 0.9388344, 'binary_precision': 0.71428573, 'binary_recall': 0.34053156, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.46119234}
confusion matrix:
       0    1
0  18089   82
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9999727, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_29.png
better model found
persisted
after epoch: 29,now: 2024-06-12 06:25:39.612266,epoch time: 0:23:06.265564,used: 12:08:42.055755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99899673, 'precision': 0.9994452, 'recall': 0.9948226, 'specificity': 0.9948226, 'f1': 0.99712026, 'auroc': 0.9997418, 'binary_precision': 1.0, 'binary_recall': 0.9896453, 'binary_specificity': 1.0, 'binary_f1_score': 0.99479574}
confusion matrix:
       0     1
0  42309     0
1     47  4492
---- Validation: 
scalar performance:
{'acc': 0.97128856, 'precision': 0.94031787, 'recall': 0.5579469, 'specificity': 0.5579469, 'f1': 0.59578276, 'auroc': 0.9474721, 'binary_precision': 0.90909094, 'binary_recall': 0.11627907, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.20618556}
confusion matrix:
       0   1
0  18164   7
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.9999819, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277203_30.png
early stop counter: 1
val acc:0.9712885618209839, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9983638525009155 / 0.9985125660896301
after epoch: 30,now: 2024-06-12 06:48:14.208648,epoch time: 0:22:34.596382,used: 12:31:16.652137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_16_57_seed_2_21277203
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:31:16.652137 at 2024-06-12 06:48:14.208648
persisted model performance metric: 

scalar performance:
{'acc': 0.9968764, 'precision': 0.99825525, 'recall': 0.9855372, 'specificity': 0.9855372, 'f1': 0.99178857, 'auroc': 0.99964446, 'binary_precision': 1.0, 'binary_recall': 0.9710744, 'binary_specificity': 1.0, 'binary_f1_score': 0.985325}
confusion matrix:
      0    1
0  5997    0
1    21  705
oracle model performance metric: 

scalar performance:
{'acc': 0.99836385, 'precision': 0.9984702, 'recall': 0.9930296, 'specificity': 0.9930296, 'f1': 0.9957303, 'auroc': 0.9996291, 'binary_precision': 0.9986053, 'binary_recall': 0.9862259, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.992377}
confusion matrix:
      0    1
0  5996    1
1    10  716
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3599 TiB |   3599 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3556 TiB |   3556 TiB |
|       from small pool |  40700 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14482 MiB |  41668 MiB |  27194 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     68 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446862 KiB |   1252 MiB |   2568 TiB |   2568 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2526 TiB |   2526 TiB |
|       from small pool |  11473 KiB |     42 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  632640 K  |  632636 K  |
|       from large pool |     187    |    1413    |  329350 K  |  329349 K  |
|       from small pool |    3475    |    6672    |  303290 K  |  303287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  632640 K  |  632636 K  |
|       from large pool |     187    |    1413    |  329350 K  |  329349 K  |
|       from small pool |    3475    |    6672    |  303290 K  |  303287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     635    |    1778    |    1144    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      34    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    2997    |  394217 K  |  394217 K  |
|       from large pool |      40    |     604    |  236594 K  |  236594 K  |
|       from small pool |      41    |    2955    |  157623 K  |  157623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3599 TiB |   3599 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3556 TiB |   3556 TiB |
|       from small pool |      0 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14482 MiB |  41668 MiB |  40786 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     68 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   2568 TiB |   2568 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2526 TiB |   2526 TiB |
|       from small pool |      0 KiB |     42 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  632640 K  |  632640 K  |
|       from large pool |       2    |    1413    |  329350 K  |  329350 K  |
|       from small pool |       0    |    6672    |  303290 K  |  303290 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  632640 K  |  632640 K  |
|       from large pool |       2    |    1413    |  329350 K  |  329350 K  |
|       from small pool |       0    |    6672    |  303290 K  |  303290 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1778    |    1715    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      34    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2997    |  394219 K  |  394219 K  |
|       from large pool |       4    |     604    |  236594 K  |  236594 K  |
|       from small pool |       0    |    2955    |  157624 K  |  157624 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 12 06:50:08 2024]
Finished job 0.
1 of 1 steps (100%) done
