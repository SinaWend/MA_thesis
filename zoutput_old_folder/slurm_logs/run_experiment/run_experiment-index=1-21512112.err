Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 22:57:33 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112

 Experiment start at: 2024-06-19 23:10:44.364982
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94511986, 'precision': 0.96658444, 'recall': 0.7114882, 'specificity': 0.7114882, 'f1': 0.78186023, 'auroc': 0.94448245, 'binary_precision': 0.9899364, 'binary_recall': 0.42342547, 'binary_specificity': 0.9995509, 'binary_f1_score': 0.593145}
confusion matrix:
       0     1
0  42287    19
1   2545  1869
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.5296103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.55247223, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:29:13.438765,epoch time: 0:18:29.073783,used: 0:18:29.073783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9705265, 'precision': 0.9821047, 'recall': 0.84540445, 'specificity': 0.84540445, 'f1': 0.8999083, 'auroc': 0.9758879, 'binary_precision': 0.9954308, 'binary_recall': 0.6911398, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.81583524}
confusion matrix:
       0     1
0  42293    14
1   1363  3050
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.79614806, 'recall': 0.5228323, 'specificity': 0.5228323, 'f1': 0.5348636, 'auroc': 0.64891064, 'binary_precision': 0.625, 'binary_recall': 0.0466563, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.086830676}
confusion matrix:
       0   1
0  18131  18
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7549615, 'recall': 0.52032244, 'specificity': 0.52032244, 'f1': 0.52856153, 'auroc': 0.70130277, 'binary_precision': 0.55, 'binary_recall': 0.042145595, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.07829181}
confusion matrix:
      0   1
0  5988   9
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 23:46:22.278007,epoch time: 0:17:08.839242,used: 0:35:37.913025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97851026, 'precision': 0.9810772, 'recall': 0.8919525, 'specificity': 0.8919525, 'f1': 0.93087286, 'auroc': 0.98486185, 'binary_precision': 0.9840999, 'binary_recall': 0.7852288, 'binary_specificity': 0.9986763, 'binary_f1_score': 0.8734879}
confusion matrix:
       0     1
0  42250    56
1    948  3466
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7601645, 'recall': 0.5573899, 'specificity': 0.5573899, 'f1': 0.5887656, 'auroc': 0.7100864, 'binary_precision': 0.5507246, 'binary_recall': 0.11819596, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.1946223}
confusion matrix:
       0   1
0  18087  62
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81163657, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.59607244, 'auroc': 0.7523768, 'binary_precision': 0.66, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5980  17
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 00:05:06.842466,epoch time: 0:18:44.564459,used: 0:54:22.477484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98133564, 'precision': 0.9829812, 'recall': 0.90676165, 'specificity': 0.90676165, 'f1': 0.94081247, 'auroc': 0.9872918, 'binary_precision': 0.9849315, 'binary_recall': 0.8148232, 'binary_specificity': 0.9987, 'binary_f1_score': 0.89183825}
confusion matrix:
       0     1
0  42253    55
1    817  3595
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7627673, 'recall': 0.5725287, 'specificity': 0.5725287, 'f1': 0.60916144, 'auroc': 0.728999, 'binary_precision': 0.5549133, 'binary_recall': 0.14930016, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.23529412}
confusion matrix:
       0   1
0  18072  77
1    547  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81842273, 'recall': 0.5881207, 'specificity': 0.5881207, 'f1': 0.63226885, 'auroc': 0.75807905, 'binary_precision': 0.67142856, 'binary_recall': 0.18007663, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2839879}
confusion matrix:
      0   1
0  5974  23
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 00:22:21.120274,epoch time: 0:17:14.277808,used: 1:11:36.755292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9848459, 'precision': 0.98176455, 'recall': 0.9284245, 'specificity': 0.9284245, 'f1': 0.9531406, 'auroc': 0.98971415, 'binary_precision': 0.9780702, 'binary_recall': 0.85885817, 'binary_specificity': 0.99799085, 'binary_f1_score': 0.9145959}
confusion matrix:
       0     1
0  42221    85
1    623  3791
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76259845, 'recall': 0.5944181, 'specificity': 0.5944181, 'f1': 0.6354137, 'auroc': 0.75510883, 'binary_precision': 0.55309737, 'binary_recall': 0.19440125, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.287687}
confusion matrix:
       0    1
0  18048  101
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8168855, 'recall': 0.60869324, 'specificity': 0.60869324, 'f1': 0.65713346, 'auroc': 0.7777996, 'binary_precision': 0.6666667, 'binary_recall': 0.22222222, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.33333334}
confusion matrix:
      0   1
0  5968  29
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 00:41:03.198477,epoch time: 0:18:42.078203,used: 1:30:18.833495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98570204, 'precision': 0.98245037, 'recall': 0.932869, 'specificity': 0.932869, 'f1': 0.9559796, 'auroc': 0.9915342, 'binary_precision': 0.97854406, 'binary_recall': 0.86772364, 'binary_specificity': 0.9980144, 'binary_f1_score': 0.9198079}
confusion matrix:
       0     1
0  42221    84
1    584  3831
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74808425, 'recall': 0.5888096, 'specificity': 0.5888096, 'f1': 0.6273381, 'auroc': 0.7729187, 'binary_precision': 0.52444446, 'binary_recall': 0.18351477, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.2718894}
confusion matrix:
       0    1
0  18042  107
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.84262395, 'recall': 0.61485726, 'specificity': 0.61485726, 'f1': 0.6670976, 'auroc': 0.7896907, 'binary_precision': 0.7176471, 'binary_recall': 0.23371647, 'binary_specificity': 0.995998, 'binary_f1_score': 0.35260117}
confusion matrix:
      0   1
0  5973  24
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_6.png
new oracle model saved
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9629274606704712 / 0.964205801486969
after epoch: 6,now: 2024-06-20 00:57:05.129301,epoch time: 0:16:01.930824,used: 1:46:20.764319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9871147, 'precision': 0.9818657, 'recall': 0.94171196, 'specificity': 0.94171196, 'f1': 0.9606947, 'auroc': 0.99340737, 'binary_precision': 0.97553056, 'binary_recall': 0.8857402, 'binary_specificity': 0.9976837, 'binary_f1_score': 0.9284696}
confusion matrix:
       0     1
0  42211    98
1    504  3907
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75390923, 'recall': 0.58969736, 'specificity': 0.58969736, 'f1': 0.62903446, 'auroc': 0.78213954, 'binary_precision': 0.536036, 'binary_recall': 0.18506998, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27514452}
confusion matrix:
       0    1
0  18046  103
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8268553, 'recall': 0.60702765, 'specificity': 0.60702765, 'f1': 0.65624976, 'auroc': 0.7913107, 'binary_precision': 0.686747, 'binary_recall': 0.21839081, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.33139536}
confusion matrix:
      0   1
0  5971  26
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_7.png
early stop counter: 2
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9629274606704712 / 0.964205801486969
after epoch: 7,now: 2024-06-20 01:15:54.955356,epoch time: 0:18:49.826055,used: 2:05:10.590374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98660105, 'precision': 0.980337, 'recall': 0.94012165, 'specificity': 0.94012165, 'f1': 0.95912766, 'auroc': 0.99302804, 'binary_precision': 0.97277725, 'binary_recall': 0.8828196, 'binary_specificity': 0.99742365, 'binary_f1_score': 0.92561793}
confusion matrix:
       0     1
0  42199   109
1    517  3895
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7625745, 'recall': 0.598946, 'specificity': 0.598946, 'f1': 0.640445, 'auroc': 0.7864586, 'binary_precision': 0.5527426, 'binary_recall': 0.2037325, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.2977273}
confusion matrix:
       0    1
0  18043  106
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.832554, 'recall': 0.6127748, 'specificity': 0.6127748, 'f1': 0.6635837, 'auroc': 0.7910073, 'binary_precision': 0.6976744, 'binary_recall': 0.22988506, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.34582135}
confusion matrix:
      0   1
0  5971  26
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 01:32:07.004963,epoch time: 0:16:12.049607,used: 2:21:22.639981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9872217, 'precision': 0.98389196, 'recall': 0.9404776, 'specificity': 0.9404776, 'f1': 0.96090806, 'auroc': 0.9946945, 'binary_precision': 0.97987926, 'binary_recall': 0.8828461, 'binary_specificity': 0.99810904, 'binary_f1_score': 0.9288354}
confusion matrix:
       0     1
0  42227    80
1    517  3896
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77057576, 'recall': 0.5968611, 'specificity': 0.5968611, 'f1': 0.6391312, 'auroc': 0.79404616, 'binary_precision': 0.5688889, 'binary_recall': 0.19906688, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.29493088}
confusion matrix:
       0    1
0  18052   97
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8415928, 'recall': 0.6091935, 'specificity': 0.6091935, 'f1': 0.66030854, 'auroc': 0.79676366, 'binary_precision': 0.7160494, 'binary_recall': 0.22222222, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.33918127}
confusion matrix:
      0   1
0  5974  23
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 01:48:02.335570,epoch time: 0:15:55.330607,used: 2:37:17.970588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98743576, 'precision': 0.9807121, 'recall': 0.9447566, 'specificity': 0.9447566, 'f1': 0.9618577, 'auroc': 0.99442255, 'binary_precision': 0.97257906, 'binary_recall': 0.8921369, 'binary_specificity': 0.9973763, 'binary_f1_score': 0.9306229}
confusion matrix:
       0     1
0  42196   111
1    476  3937
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7536831, 'recall': 0.6122817, 'specificity': 0.6122817, 'f1': 0.653095, 'auroc': 0.804528, 'binary_precision': 0.53405017, 'binary_recall': 0.23172629, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.32321042}
confusion matrix:
       0    1
0  18019  130
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.81416696, 'recall': 0.62360203, 'specificity': 0.62360203, 'f1': 0.6734055, 'auroc': 0.8086272, 'binary_precision': 0.66, 'binary_recall': 0.25287357, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.36565098}
confusion matrix:
      0   1
0  5963  34
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_10.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 10,now: 2024-06-20 02:04:06.436845,epoch time: 0:16:04.101275,used: 2:53:22.071863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9879067, 'precision': 0.9839175, 'recall': 0.9445461, 'specificity': 0.9445461, 'f1': 0.9631852, 'auroc': 0.9941157, 'binary_precision': 0.9790993, 'binary_recall': 0.8910779, 'binary_specificity': 0.9980144, 'binary_f1_score': 0.93301713}
confusion matrix:
       0     1
0  42220    84
1    481  3935
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7622014, 'recall': 0.604974, 'specificity': 0.604974, 'f1': 0.64689875, 'auroc': 0.79523396, 'binary_precision': 0.5515873, 'binary_recall': 0.21617419, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.31061453}
confusion matrix:
       0    1
0  18036  113
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8306973, 'recall': 0.61085904, 'specificity': 0.61085904, 'f1': 0.6611529, 'auroc': 0.78916323, 'binary_precision': 0.69411767, 'binary_recall': 0.22605364, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.34104046}
confusion matrix:
      0   1
0  5971  26
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_11.png
early stop counter: 2
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 11,now: 2024-06-20 02:20:51.115007,epoch time: 0:16:44.678162,used: 3:10:06.750025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98951197, 'precision': 0.98710334, 'recall': 0.95094436, 'specificity': 0.95094436, 'f1': 0.9681504, 'auroc': 0.9946704, 'binary_precision': 0.98418975, 'binary_recall': 0.9034014, 'binary_specificity': 0.99848735, 'binary_f1_score': 0.9420667}
confusion matrix:
       0     1
0  42246    64
1    426  3984
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7548317, 'recall': 0.591225, 'specificity': 0.591225, 'f1': 0.63087606, 'auroc': 0.8087353, 'binary_precision': 0.5377778, 'binary_recall': 0.1881804, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.27880186}
confusion matrix:
       0    1
0  18045  104
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.79938173, 'recall': 0.5933676, 'specificity': 0.5933676, 'f1': 0.63720334, 'auroc': 0.8101776, 'binary_precision': 0.6329114, 'binary_recall': 0.19157088, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.29411763}
confusion matrix:
      0   1
0  5968  29
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_12.png
early stop counter: 3
val acc:0.9666879773139954, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 12,now: 2024-06-20 02:35:46.043112,epoch time: 0:14:54.928105,used: 3:25:01.678130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9890411, 'precision': 0.98360586, 'recall': 0.95153975, 'specificity': 0.95153975, 'f1': 0.9668825, 'auroc': 0.9942578, 'binary_precision': 0.9770171, 'binary_recall': 0.90530133, 'binary_specificity': 0.9977781, 'binary_f1_score': 0.93979305}
confusion matrix:
       0     1
0  42212    94
1    418  3996
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7498883, 'recall': 0.6023932, 'specificity': 0.6023932, 'f1': 0.6423699, 'auroc': 0.80789554, 'binary_precision': 0.5271318, 'binary_recall': 0.21150856, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3018868}
confusion matrix:
       0    1
0  18027  122
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.79491717, 'recall': 0.59886456, 'specificity': 0.59886456, 'f1': 0.64331883, 'auroc': 0.79947186, 'binary_precision': 0.62352943, 'binary_recall': 0.20306513, 'binary_specificity': 0.994664, 'binary_f1_score': 0.30635837}
confusion matrix:
      0   1
0  5965  32
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_13.png
early stop counter: 4
val acc:0.9665282964706421, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 13,now: 2024-06-20 02:50:50.437370,epoch time: 0:15:04.394258,used: 3:40:06.072388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98996145, 'precision': 0.9832945, 'recall': 0.9573237, 'specificity': 0.9573237, 'f1': 0.9698583, 'auroc': 0.99505675, 'binary_precision': 0.9751867, 'binary_recall': 0.917082, 'binary_specificity': 0.9975653, 'binary_f1_score': 0.94524235}
confusion matrix:
       0     1
0  42203   103
1    366  4048
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7491677, 'recall': 0.60989374, 'specificity': 0.60989374, 'f1': 0.6499452, 'auroc': 0.8135264, 'binary_precision': 0.52517986, 'binary_recall': 0.22706065, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.31704667}
confusion matrix:
       0    1
0  18017  132
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7805313, 'recall': 0.5929507, 'specificity': 0.5929507, 'f1': 0.63486266, 'auroc': 0.80469483, 'binary_precision': 0.5952381, 'binary_recall': 0.19157088, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.28985506}
confusion matrix:
      0   1
0  5963  34
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_14.png
early stop counter: 5
val acc:0.9665282964706421, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 14,now: 2024-06-20 03:05:41.456961,epoch time: 0:14:51.019591,used: 3:54:57.091979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.9868089, 'recall': 0.95641506, 'specificity': 0.95641506, 'f1': 0.97099733, 'auroc': 0.99596936, 'binary_precision': 0.9824647, 'binary_recall': 0.9145318, 'binary_specificity': 0.9982982, 'binary_f1_score': 0.9472819}
confusion matrix:
       0     1
0  42237    72
1    377  4034
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7538183, 'recall': 0.60400355, 'specificity': 0.60400355, 'f1': 0.64464426, 'auroc': 0.8129329, 'binary_precision': 0.53488374, 'binary_recall': 0.21461898, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.30632633}
confusion matrix:
       0    1
0  18029  120
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.77807623, 'recall': 0.5780419, 'specificity': 0.5780419, 'f1': 0.6163287, 'auroc': 0.80415225, 'binary_precision': 0.5915493, 'binary_recall': 0.16091955, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.25301206}
confusion matrix:
      0   1
0  5968  29
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_15.png
early stop counter: 6
val acc:0.966741144657135, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 15,now: 2024-06-20 03:21:48.554146,epoch time: 0:16:07.097185,used: 4:11:04.189164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.98440695, 'recall': 0.9587685, 'specificity': 0.9587685, 'f1': 0.9711496, 'auroc': 0.99557245, 'binary_precision': 0.9771305, 'binary_recall': 0.91978246, 'binary_specificity': 0.9977545, 'binary_f1_score': 0.9475896}
confusion matrix:
       0     1
0  42212    95
1    354  4059
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75855947, 'recall': 0.6124194, 'specificity': 0.6124194, 'f1': 0.6540456, 'auroc': 0.8237976, 'binary_precision': 0.54379565, 'binary_recall': 0.23172629, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.32497275}
confusion matrix:
       0    1
0  18024  125
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7658046, 'recall': 0.5870368, 'specificity': 0.5870368, 'f1': 0.62635845, 'auroc': 0.814319, 'binary_precision': 0.56626505, 'binary_recall': 0.18007663, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2732558}
confusion matrix:
      0   1
0  5961  36
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_16.png
early stop counter: 7
val acc:0.9670604467391968, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 16,now: 2024-06-20 03:37:04.541998,epoch time: 0:15:15.987852,used: 4:26:20.177016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.990411, 'precision': 0.98746604, 'recall': 0.95594853, 'specificity': 0.95594853, 'f1': 0.9710467, 'auroc': 0.9963926, 'binary_precision': 0.9838946, 'binary_recall': 0.91345716, 'binary_specificity': 0.9984399, 'binary_f1_score': 0.9473684}
confusion matrix:
       0     1
0  42240    66
1    382  4032
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74894214, 'recall': 0.6016156, 'specificity': 0.6016156, 'f1': 0.64141315, 'auroc': 0.8252601, 'binary_precision': 0.5252918, 'binary_recall': 0.20995334, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.29999998}
confusion matrix:
       0    1
0  18027  122
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.77280116, 'recall': 0.58720356, 'specificity': 0.58720356, 'f1': 0.62724125, 'auroc': 0.81115574, 'binary_precision': 0.5802469, 'binary_recall': 0.18007663, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.27485383}
confusion matrix:
      0   1
0  5963  34
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_17.png
early stop counter: 8
val acc:0.9664750695228577, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 17,now: 2024-06-20 03:52:27.124194,epoch time: 0:15:22.582196,used: 4:41:42.759212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99126714, 'precision': 0.98530644, 'recall': 0.9631175, 'specificity': 0.9631175, 'f1': 0.9738854, 'auroc': 0.9964473, 'binary_precision': 0.97804296, 'binary_recall': 0.9284096, 'binary_specificity': 0.9978254, 'binary_f1_score': 0.95258015}
confusion matrix:
       0     1
0  42214    92
1    316  4098
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7571041, 'recall': 0.6033361, 'specificity': 0.6033361, 'f1': 0.6444249, 'auroc': 0.82652646, 'binary_precision': 0.541502, 'binary_recall': 0.21306376, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.30580357}
confusion matrix:
       0    1
0  18033  116
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7573465, 'recall': 0.5702123, 'specificity': 0.5702123, 'f1': 0.6047297, 'auroc': 0.81368095, 'binary_precision': 0.5507246, 'binary_recall': 0.14559387, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.23030302}
confusion matrix:
      0   1
0  5966  31
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_18.png
early stop counter: 9
val acc:0.9669008255004883, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 18,now: 2024-06-20 04:07:17.207725,epoch time: 0:14:50.083531,used: 4:56:32.842743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.990411, 'precision': 0.9872551, 'recall': 0.9561612, 'specificity': 0.9561612, 'f1': 0.97106504, 'auroc': 0.9954555, 'binary_precision': 0.98342675, 'binary_recall': 0.91392976, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.94740546}
confusion matrix:
       0     1
0  42237    68
1    380  4035
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7603591, 'recall': 0.59361297, 'specificity': 0.59361297, 'f1': 0.63423574, 'auroc': 0.81630147, 'binary_precision': 0.54867256, 'binary_recall': 0.19284603, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.2853855}
confusion matrix:
       0    1
0  18047  102
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7354856, 'recall': 0.558718, 'specificity': 0.558718, 'f1': 0.5881027, 'auroc': 0.78948045, 'binary_precision': 0.50793654, 'binary_recall': 0.12260536, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19753085}
confusion matrix:
      0   1
0  5966  31
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_19.png
early stop counter: 10
val acc:0.9669540524482727, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 19,now: 2024-06-20 04:22:19.693138,epoch time: 0:15:02.485413,used: 5:11:35.328156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9915454, 'precision': 0.9890219, 'recall': 0.96109736, 'specificity': 0.96109736, 'f1': 0.97454464, 'auroc': 0.99691725, 'binary_precision': 0.98595643, 'binary_recall': 0.92356545, 'binary_specificity': 0.9986292, 'binary_f1_score': 0.9537417}
confusion matrix:
       0     1
0  42253    58
1    337  4072
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7690493, 'recall': 0.5870002, 'specificity': 0.5870002, 'f1': 0.6275501, 'auroc': 0.81133306, 'binary_precision': 0.56650245, 'binary_recall': 0.17884915, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.2718676}
confusion matrix:
       0    1
0  18061   88
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7527436, 'recall': 0.54614186, 'specificity': 0.54614186, 'f1': 0.5709082, 'auroc': 0.7879909, 'binary_precision': 0.54347825, 'binary_recall': 0.09578544, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.16286644}
confusion matrix:
      0   1
0  5976  21
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_20.png
early stop counter: 11
val acc:0.9672200679779053, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 20,now: 2024-06-20 04:37:22.031686,epoch time: 0:15:02.338548,used: 5:26:37.666704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9921019, 'precision': 0.986474, 'recall': 0.9669265, 'specificity': 0.9669265, 'f1': 0.97644806, 'auroc': 0.99746644, 'binary_precision': 0.97960633, 'binary_recall': 0.93588585, 'binary_specificity': 0.9979672, 'binary_f1_score': 0.95724714}
confusion matrix:
       0     1
0  42220    86
1    283  4131
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7589537, 'recall': 0.59961337, 'specificity': 0.59961337, 'f1': 0.6406918, 'auroc': 0.8297142, 'binary_precision': 0.54545456, 'binary_recall': 0.20528771, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.2983051}
confusion matrix:
       0    1
0  18039  110
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72329444, 'recall': 0.55480325, 'specificity': 0.55480325, 'f1': 0.5820944, 'auroc': 0.80020535, 'binary_precision': 0.48387095, 'binary_recall': 0.11494253, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18575852}
confusion matrix:
      0   1
0  5965  32
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_21.png
early stop counter: 12
val acc:0.9669540524482727, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 21,now: 2024-06-20 04:52:51.409415,epoch time: 0:15:29.377729,used: 5:42:07.044433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99197346, 'precision': 0.9864894, 'recall': 0.96613795, 'specificity': 0.96613795, 'f1': 0.9760402, 'auroc': 0.99665284, 'binary_precision': 0.9798004, 'binary_recall': 0.93428504, 'binary_specificity': 0.99799085, 'binary_f1_score': 0.9565016}
confusion matrix:
       0     1
0  42222    85
1    290  4123
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74590933, 'recall': 0.60153294, 'specificity': 0.60153294, 'f1': 0.6408732, 'auroc': 0.8261967, 'binary_precision': 0.5192308, 'binary_recall': 0.20995334, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.2990033}
confusion matrix:
       0    1
0  18024  125
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7083099, 'recall': 0.5617157, 'specificity': 0.5617157, 'f1': 0.59018886, 'auroc': 0.79559493, 'binary_precision': 0.45333335, 'binary_recall': 0.1302682, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.20238096}
confusion matrix:
      0   1
0  5956  41
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_22.png
early stop counter: 13
val acc:0.9663154482841492, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 22,now: 2024-06-20 05:08:14.393034,epoch time: 0:15:22.983619,used: 5:57:30.028052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99244434, 'precision': 0.9904307, 'recall': 0.9650787, 'specificity': 0.9650787, 'f1': 0.97733235, 'auroc': 0.99724877, 'binary_precision': 0.9879808, 'binary_recall': 0.9313392, 'binary_specificity': 0.99881816, 'binary_f1_score': 0.95882416}
confusion matrix:
       0     1
0  42257    50
1    303  4110
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7649932, 'recall': 0.5906954, 'specificity': 0.5906954, 'f1': 0.6314465, 'auroc': 0.8308849, 'binary_precision': 0.55813956, 'binary_recall': 0.1866252, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.2797203}
confusion matrix:
       0    1
0  18054   95
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7194512, 'recall': 0.55471987, 'specificity': 0.55471987, 'f1': 0.5817658, 'auroc': 0.8086949, 'binary_precision': 0.47619048, 'binary_recall': 0.11494253, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.1851852}
confusion matrix:
      0   1
0  5964  33
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_23.png
early stop counter: 14
val acc:0.9671136736869812, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 23,now: 2024-06-20 05:23:36.432990,epoch time: 0:15:22.039956,used: 6:12:52.068008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99248713, 'precision': 0.9897185, 'recall': 0.9660082, 'specificity': 0.9660082, 'f1': 0.9774939, 'auroc': 0.9965756, 'binary_precision': 0.9863473, 'binary_recall': 0.93336356, 'binary_specificity': 0.99865276, 'binary_f1_score': 0.95912427}
confusion matrix:
       0     1
0  42251    57
1    294  4118
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7549757, 'recall': 0.59047496, 'specificity': 0.59047496, 'f1': 0.6300437, 'auroc': 0.82366174, 'binary_precision': 0.5381166, 'binary_recall': 0.1866252, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27713627}
confusion matrix:
       0    1
0  18046  103
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7043461, 'recall': 0.5525541, 'specificity': 0.5525541, 'f1': 0.5779644, 'auroc': 0.7928083, 'binary_precision': 0.44615385, 'binary_recall': 0.11111111, 'binary_specificity': 0.993997, 'binary_f1_score': 0.1779141}
confusion matrix:
      0   1
0  5961  36
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_24.png
early stop counter: 15
val acc:0.9666879773139954, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 24,now: 2024-06-20 05:38:35.892841,epoch time: 0:14:59.459851,used: 6:27:51.527859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.98986936, 'recall': 0.9662765, 'specificity': 0.9662765, 'f1': 0.97770715, 'auroc': 0.9962176, 'binary_precision': 0.98660284, 'binary_recall': 0.9338768, 'binary_specificity': 0.99867624, 'binary_f1_score': 0.95951605}
confusion matrix:
       0     1
0  42248    56
1    292  4124
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76432586, 'recall': 0.58463985, 'specificity': 0.58463985, 'f1': 0.62426376, 'auroc': 0.82040346, 'binary_precision': 0.5572139, 'binary_recall': 0.17418352, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.26540285}
confusion matrix:
       0    1
0  18060   89
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7222066, 'recall': 0.5493063, 'specificity': 0.5493063, 'f1': 0.5743939, 'auroc': 0.791822, 'binary_precision': 0.48214287, 'binary_recall': 0.10344828, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.170347}
confusion matrix:
      0   1
0  5968  29
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_25.png
early stop counter: 16
val acc:0.9670072197914124, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 25,now: 2024-06-20 05:53:49.716743,epoch time: 0:15:13.823902,used: 6:43:05.351761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9925728, 'precision': 0.98698294, 'recall': 0.9692022, 'specificity': 0.9692022, 'f1': 0.97788453, 'auroc': 0.9968144, 'binary_precision': 0.98015594, 'binary_recall': 0.9403899, 'binary_specificity': 0.99801457, 'binary_f1_score': 0.9598612}
confusion matrix:
       0     1
0  42224    84
1    263  4149
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75118697, 'recall': 0.6001706, 'specificity': 0.6001706, 'f1': 0.64021134, 'auroc': 0.8259127, 'binary_precision': 0.52988046, 'binary_recall': 0.20684293, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.29753914}
confusion matrix:
       0    1
0  18031  118
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72505116, 'recall': 0.56579727, 'specificity': 0.56579727, 'f1': 0.5966672, 'auroc': 0.8024705, 'binary_precision': 0.4864865, 'binary_recall': 0.13793103, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.21492536}
confusion matrix:
      0   1
0  5959  38
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_26.png
early stop counter: 17
val acc:0.9665815234184265, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 26,now: 2024-06-20 06:08:47.956646,epoch time: 0:14:58.239903,used: 6:58:03.591664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9904579, 'recall': 0.9673283, 'specificity': 0.9673283, 'f1': 0.9785422, 'auroc': 0.99763954, 'binary_precision': 0.98756874, 'binary_recall': 0.93588585, 'binary_specificity': 0.99877083, 'binary_f1_score': 0.961033}
confusion matrix:
       0     1
0  42254    52
1    283  4131
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76932687, 'recall': 0.5794445, 'specificity': 0.5794445, 'f1': 0.6184048, 'auroc': 0.82383937, 'binary_precision': 0.5675676, 'binary_recall': 0.16329704, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.2536232}
confusion matrix:
       0    1
0  18069   80
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7309179, 'recall': 0.543976, 'specificity': 0.543976, 'f1': 0.5669793, 'auroc': 0.7968501, 'binary_precision': 0.5, 'binary_recall': 0.09195402, 'binary_specificity': 0.995998, 'binary_f1_score': 0.1553398}
confusion matrix:
      0   1
0  5973  24
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_27.png
early stop counter: 18
val acc:0.9671136736869812, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 27,now: 2024-06-20 06:23:38.363006,epoch time: 0:14:50.406360,used: 7:12:53.998024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9933219, 'precision': 0.9894085, 'recall': 0.97123367, 'specificity': 0.97123367, 'f1': 0.9801048, 'auroc': 0.9968089, 'binary_precision': 0.9846299, 'binary_recall': 0.94400364, 'binary_specificity': 0.9984637, 'binary_f1_score': 0.96388894}
confusion matrix:
       0     1
0  42244    65
1    247  4164
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7726158, 'recall': 0.588583, 'specificity': 0.588583, 'f1': 0.6297915, 'auroc': 0.82620025, 'binary_precision': 0.5735294, 'binary_recall': 0.18195957, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.2762692}
confusion matrix:
       0    1
0  18062   87
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.71683216, 'recall': 0.5455582, 'specificity': 0.5455582, 'f1': 0.5688, 'auroc': 0.79822385, 'binary_precision': 0.4716981, 'binary_recall': 0.09578544, 'binary_specificity': 0.995331, 'binary_f1_score': 0.15923567}
confusion matrix:
      0   1
0  5969  28
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_28.png
early stop counter: 19
val acc:0.9673797488212585, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 28,now: 2024-06-20 06:38:37.482477,epoch time: 0:14:59.119471,used: 7:27:53.117495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9926798, 'precision': 0.9901527, 'recall': 0.96672356, 'specificity': 0.96672356, 'f1': 0.97807777, 'auroc': 0.99781847, 'binary_precision': 0.98707515, 'binary_recall': 0.9347235, 'binary_specificity': 0.9987236, 'binary_f1_score': 0.96018624}
confusion matrix:
       0     1
0  42254    54
1    288  4124
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.767421, 'recall': 0.58394486, 'specificity': 0.58394486, 'f1': 0.6237333, 'auroc': 0.8284029, 'binary_precision': 0.56345177, 'binary_recall': 0.1726283, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.2642857}
confusion matrix:
       0    1
0  18063   86
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73609734, 'recall': 0.54589176, 'specificity': 0.54589176, 'f1': 0.5699946, 'auroc': 0.80033374, 'binary_precision': 0.5102041, 'binary_recall': 0.09578544, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16129032}
confusion matrix:
      0   1
0  5973  24
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_29.png
early stop counter: 20
val acc:0.9671136736869812, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.964205801486969
after epoch: 29,now: 2024-06-20 06:53:32.847304,epoch time: 0:14:55.364827,used: 7:42:48.482322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 7:42:48.482322 at 2024-06-20 06:53:32.847304
persisted model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.8415928, 'recall': 0.6091935, 'specificity': 0.6091935, 'f1': 0.66030854, 'auroc': 0.79676366, 'binary_precision': 0.7160494, 'binary_recall': 0.22222222, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.33918127}
confusion matrix:
      0   1
0  5974  23
1   203  58
oracle model performance metric: 

scalar performance:
{'acc': 0.9642058, 'precision': 0.84262395, 'recall': 0.61485726, 'specificity': 0.61485726, 'f1': 0.6670976, 'auroc': 0.7896907, 'binary_precision': 0.7176471, 'binary_recall': 0.23371647, 'binary_specificity': 0.995998, 'binary_f1_score': 0.35260117}
confusion matrix:
      0   1
0  5973  24
1   200  61
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |  36161 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |  36161 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 365058 GiB | 365058 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 364957 GiB | 364957 GiB |
|       from small pool |  35968 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 256886 GiB | 256886 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 256780 GiB | 256780 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    105 GiB |    105 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10947 K  |   10946 K  |
|       from large pool |      36    |      76    |    3468 K  |    3468 K  |
|       from small pool |    1158    |    1780    |    7479 K  |    7478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10947 K  |   10946 K  |
|       from large pool |      36    |      76    |    3468 K  |    3468 K  |
|       from small pool |    1158    |    1780    |    7479 K  |    7478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     378    |    5479 K  |    5479 K  |
|       from large pool |       5    |      10    |    1308 K  |    1308 K  |
|       from small pool |      23    |     373    |    4170 K  |    4170 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 365058 GiB | 365058 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 364957 GiB | 364957 GiB |
|       from small pool |      0 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 256886 GiB | 256886 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 256780 GiB | 256780 GiB |
|       from small pool |      0 KiB |  14441 KiB |    105 GiB |    105 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10947 K  |   10947 K  |
|       from large pool |       2    |      76    |    3468 K  |    3468 K  |
|       from small pool |       0    |    1780    |    7479 K  |    7479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10947 K  |   10947 K  |
|       from large pool |       2    |      76    |    3468 K  |    3468 K  |
|       from small pool |       0    |    1780    |    7479 K  |    7479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5479 K  |    5479 K  |
|       from large pool |       1    |      11    |    1308 K  |    1308 K  |
|       from small pool |       0    |     373    |    4171 K  |    4171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 365074 GiB | 365074 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 364971 GiB | 364971 GiB |
|       from small pool |      0 KiB |     72 MiB |    102 GiB |    102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 365058 GiB | 365058 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 364957 GiB | 364957 GiB |
|       from small pool |      0 KiB |     71 MiB |    100 GiB |    100 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 256886 GiB | 256886 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 256780 GiB | 256780 GiB |
|       from small pool |      0 KiB |  14441 KiB |    105 GiB |    105 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10947 K  |   10947 K  |
|       from large pool |       2    |      76    |    3468 K  |    3468 K  |
|       from small pool |       0    |    1780    |    7479 K  |    7479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10947 K  |   10947 K  |
|       from large pool |       2    |      76    |    3468 K  |    3468 K  |
|       from small pool |       0    |    1780    |    7479 K  |    7479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5479 K  |    5479 K  |
|       from large pool |       1    |      11    |    1308 K  |    1308 K  |
|       from small pool |       0    |     373    |    4171 K  |    4171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112

 Experiment start at: 2024-06-20 07:00:22.592503
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9385702, 'precision': 0.9256216, 'recall': 0.68425786, 'specificity': 0.68425786, 'f1': 0.74786264, 'auroc': 0.93500435, 'binary_precision': 0.9116147, 'binary_recall': 0.37219524, 'binary_specificity': 0.9963205, 'binary_f1_score': 0.52858084}
confusion matrix:
       0     1
0  42241   156
1   2714  1609
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.56539804, 'recall': 0.50060457, 'specificity': 0.50060457, 'f1': 0.49227464, 'auroc': 0.50663745, 'binary_precision': 0.16666667, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0029455079}
confusion matrix:
       0  1
0  18062  5
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.52627623, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 07:16:11.315376,epoch time: 0:15:48.722873,used: 0:15:48.722873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96744436, 'precision': 0.9784069, 'recall': 0.826861, 'specificity': 0.826861, 'f1': 0.88527906, 'auroc': 0.96918386, 'binary_precision': 0.99089634, 'binary_recall': 0.65433526, 'binary_specificity': 0.9993867, 'binary_f1_score': 0.7881911}
confusion matrix:
       0     1
0  42369    26
1   1495  2830
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.8791823, 'recall': 0.5169216, 'specificity': 0.5169216, 'f1': 0.52384514, 'auroc': 0.63542855, 'binary_precision': 0.79310346, 'binary_recall': 0.034175333, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.06552707}
confusion matrix:
       0   1
0  18061   6
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.62204736, 'recall': 0.5034257, 'specificity': 0.5034257, 'f1': 0.49666312, 'auroc': 0.6892643, 'binary_precision': 0.2857143, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.014981274}
confusion matrix:
      0  1
0  5941  5
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 07:31:09.506006,epoch time: 0:14:58.190630,used: 0:30:46.913503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9750856, 'precision': 0.9818861, 'recall': 0.8688896, 'specificity': 0.8688896, 'f1': 0.91617835, 'auroc': 0.9789241, 'binary_precision': 0.98977697, 'binary_recall': 0.7385576, 'binary_specificity': 0.99922156, 'binary_f1_score': 0.8459095}
confusion matrix:
       0     1
0  42361    33
1   1131  3195
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.8301852, 'recall': 0.54457223, 'specificity': 0.54457223, 'f1': 0.5714565, 'auroc': 0.6705697, 'binary_precision': 0.6931818, 'binary_recall': 0.09063893, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.16031536}
confusion matrix:
       0   1
0  18040  27
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7693509, 'recall': 0.5204811, 'specificity': 0.5204811, 'f1': 0.5288356, 'auroc': 0.70690006, 'binary_precision': 0.57894737, 'binary_recall': 0.042307694, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5938   8
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-20 07:46:22.292538,epoch time: 0:15:12.786532,used: 0:45:59.700035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9803938, 'precision': 0.98221827, 'recall': 0.89979076, 'specificity': 0.89979076, 'f1': 0.9362459, 'auroc': 0.9855634, 'binary_precision': 0.9843661, 'binary_recall': 0.8008788, 'binary_specificity': 0.9987027, 'binary_f1_score': 0.8831931}
confusion matrix:
       0     1
0  42341    55
1    861  3463
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.8027432, 'recall': 0.56253695, 'specificity': 0.56253695, 'f1': 0.5977642, 'auroc': 0.72351384, 'binary_precision': 0.63703704, 'binary_recall': 0.12778603, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.21287128}
confusion matrix:
       0   1
0  18018  49
1    587  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8418865, 'recall': 0.5586063, 'specificity': 0.5586063, 'f1': 0.59235895, 'auroc': 0.7439475, 'binary_precision': 0.7209302, 'binary_recall': 0.11923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5934  12
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 08:01:19.983438,epoch time: 0:14:57.690900,used: 1:00:57.390935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9833262, 'precision': 0.9832256, 'recall': 0.9163786, 'specificity': 0.9163786, 'f1': 0.9467236, 'auroc': 0.9880532, 'binary_precision': 0.98310626, 'binary_recall': 0.83421963, 'binary_specificity': 0.99853754, 'binary_f1_score': 0.9025641}
confusion matrix:
       0     1
0  42333    62
1    717  3608
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7891609, 'recall': 0.5855639, 'specificity': 0.5855639, 'f1': 0.6274843, 'auroc': 0.7541291, 'binary_precision': 0.6082474, 'binary_recall': 0.17533432, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.27220297}
confusion matrix:
       0    1
0  17991   76
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8505405, 'recall': 0.5946402, 'specificity': 0.5946402, 'f1': 0.6430051, 'auroc': 0.7796602, 'binary_precision': 0.7352941, 'binary_recall': 0.1923077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.30487806}
confusion matrix:
      0   1
0  5928  18
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-20 08:17:02.109961,epoch time: 0:15:42.126523,used: 1:16:39.517458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847175, 'precision': 0.98142123, 'recall': 0.9261967, 'specificity': 0.9261967, 'f1': 0.9517211, 'auroc': 0.98994255, 'binary_precision': 0.9774894, 'binary_recall': 0.85439813, 'binary_specificity': 0.99799526, 'binary_f1_score': 0.9118083}
confusion matrix:
       0     1
0  42315    85
1    629  3691
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7674344, 'recall': 0.59524554, 'specificity': 0.59524554, 'f1': 0.63674414, 'auroc': 0.769125, 'binary_precision': 0.5641026, 'binary_recall': 0.1961367, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.29106945}
confusion matrix:
       0    1
0  17965  102
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.83249736, 'recall': 0.6131983, 'specificity': 0.6131983, 'f1': 0.6640452, 'auroc': 0.7876148, 'binary_precision': 0.6976744, 'binary_recall': 0.23076923, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.34682083}
confusion matrix:
      0   1
0  5920  26
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_6.png
new oracle model saved
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9632613658905029 / 0.9635836482048035
after epoch: 6,now: 2024-06-20 08:35:51.278405,epoch time: 0:18:49.168444,used: 1:35:28.685902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9861515, 'precision': 0.98239547, 'recall': 0.93399644, 'specificity': 0.93399644, 'f1': 0.9566053, 'auroc': 0.9910317, 'binary_precision': 0.97789913, 'binary_recall': 0.8699977, 'binary_specificity': 0.99799514, 'binary_f1_score': 0.9207982}
confusion matrix:
       0     1
0  42312    85
1    562  3761
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7774248, 'recall': 0.5954669, 'specificity': 0.5954669, 'f1': 0.63815045, 'auroc': 0.7766044, 'binary_precision': 0.5840708, 'binary_recall': 0.1961367, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.29365963}
confusion matrix:
       0    1
0  17973   94
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.86345804, 'recall': 0.6251572, 'specificity': 0.6251572, 'f1': 0.6812917, 'auroc': 0.78764313, 'binary_precision': 0.7586207, 'binary_recall': 0.25384617, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.38040346}
confusion matrix:
      0   1
0  5925  21
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_7.png
new oracle model saved
early stop counter: 2
val acc:0.9661152362823486, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9632613658905029 / 0.9653561115264893
after epoch: 7,now: 2024-06-20 08:53:04.368319,epoch time: 0:17:13.089914,used: 1:52:41.775816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9864298, 'precision': 0.9834864, 'recall': 0.9346691, 'specificity': 0.9346691, 'f1': 0.9574631, 'auroc': 0.9910133, 'binary_precision': 0.97996354, 'binary_recall': 0.8711543, 'binary_specificity': 0.99818385, 'binary_f1_score': 0.922361}
confusion matrix:
       0     1
0  42320    77
1    557  3766
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.7926672, 'recall': 0.5892509, 'specificity': 0.5892509, 'f1': 0.6323295, 'auroc': 0.7952083, 'binary_precision': 0.615, 'binary_recall': 0.18276374, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.28178695}
confusion matrix:
       0    1
0  17990   77
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8601443, 'recall': 0.60994077, 'specificity': 0.60994077, 'f1': 0.6629557, 'auroc': 0.8147267, 'binary_precision': 0.7532467, 'binary_recall': 0.22307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.34421363}
confusion matrix:
      0   1
0  5927  19
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 09:11:14.299265,epoch time: 0:18:09.930946,used: 2:10:51.706762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98779964, 'precision': 0.983724, 'recall': 0.94270754, 'specificity': 0.94270754, 'f1': 0.9620842, 'auroc': 0.9917631, 'binary_precision': 0.9788265, 'binary_recall': 0.8873728, 'binary_specificity': 0.9980423, 'binary_f1_score': 0.93085885}
confusion matrix:
       0     1
0  42313    83
1    487  3837
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.79393435, 'recall': 0.59362555, 'specificity': 0.59362555, 'f1': 0.63773346, 'auroc': 0.78573143, 'binary_precision': 0.6172249, 'binary_recall': 0.19167905, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.292517}
confusion matrix:
       0    1
0  17987   80
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.83846056, 'recall': 0.6019962, 'specificity': 0.6019962, 'f1': 0.6512741, 'auroc': 0.79240036, 'binary_precision': 0.7105263, 'binary_recall': 0.20769231, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.32142857}
confusion matrix:
      0   1
0  5924  22
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_9.png
better model found
persisted
after epoch: 9,now: 2024-06-20 09:28:59.085901,epoch time: 0:17:44.786636,used: 2:28:36.493398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9882491, 'precision': 0.98413575, 'recall': 0.9450445, 'specificity': 0.9450445, 'f1': 0.9635649, 'auroc': 0.99231064, 'binary_precision': 0.97918785, 'binary_recall': 0.89202315, 'binary_specificity': 0.9980658, 'binary_f1_score': 0.9335753}
confusion matrix:
       0     1
0  42313    82
1    467  3858
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8024252, 'recall': 0.59450686, 'specificity': 0.59450686, 'f1': 0.6396216, 'auroc': 0.7900737, 'binary_precision': 0.63414633, 'binary_recall': 0.19316493, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.29612756}
confusion matrix:
       0    1
0  17992   75
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8249613, 'recall': 0.6017439, 'specificity': 0.6017439, 'f1': 0.64972526, 'auroc': 0.79816365, 'binary_precision': 0.6835443, 'binary_recall': 0.20769231, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.31858408}
confusion matrix:
      0   1
0  5921  25
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_10.png
better model found
persisted
after epoch: 10,now: 2024-06-20 09:45:39.444519,epoch time: 0:16:40.358618,used: 2:45:16.852016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885274, 'precision': 0.98520267, 'recall': 0.94571686, 'specificity': 0.94571686, 'f1': 0.96441597, 'auroc': 0.9936607, 'binary_precision': 0.981204, 'binary_recall': 0.8931792, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.93512464}
confusion matrix:
       0     1
0  42321    74
1    462  3863
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.8123045, 'recall': 0.589583, 'specificity': 0.589583, 'f1': 0.63445985, 'auroc': 0.79705167, 'binary_precision': 0.65425533, 'binary_recall': 0.18276374, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  18002   65
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8209688, 'recall': 0.57908744, 'specificity': 0.57908744, 'f1': 0.6205919, 'auroc': 0.8025599, 'binary_precision': 0.67741936, 'binary_recall': 0.16153847, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  5926  20
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_11.png
better model found
persisted
after epoch: 11,now: 2024-06-20 10:02:36.270672,epoch time: 0:16:56.826153,used: 3:02:13.678169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98884845, 'precision': 0.98442376, 'recall': 0.94838524, 'specificity': 0.94838524, 'f1': 0.9655361, 'auroc': 0.9947467, 'binary_precision': 0.9790932, 'binary_recall': 0.8987283, 'binary_specificity': 0.9980422, 'binary_f1_score': 0.9371911}
confusion matrix:
       0     1
0  42312    83
1    438  3887
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79095286, 'recall': 0.59574366, 'specificity': 0.59574366, 'f1': 0.6399411, 'auroc': 0.80767405, 'binary_precision': 0.6111111, 'binary_recall': 0.1961367, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.29696286}
confusion matrix:
       0    1
0  17983   84
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8356717, 'recall': 0.5906259, 'specificity': 0.5906259, 'f1': 0.636742, 'auroc': 0.80544823, 'binary_precision': 0.7058824, 'binary_recall': 0.18461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.29268295}
confusion matrix:
      0   1
0  5926  20
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_12.png
early stop counter: 1
val acc:0.9666488766670227, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 12,now: 2024-06-20 10:20:16.961045,epoch time: 0:17:40.690373,used: 3:19:54.368542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9890625, 'precision': 0.98167205, 'recall': 0.95235497, 'specificity': 0.95235497, 'f1': 0.96643835, 'auroc': 0.99497116, 'binary_precision': 0.97273856, 'binary_recall': 0.90730464, 'binary_specificity': 0.9974053, 'binary_f1_score': 0.9388829}
confusion matrix:
       0     1
0  42284   110
1    401  3925
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7856558, 'recall': 0.61373603, 'specificity': 0.61373603, 'f1': 0.65941805, 'auroc': 0.8234966, 'binary_precision': 0.59923667, 'binary_recall': 0.2332838, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.33582887}
confusion matrix:
       0    1
0  17962  105
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.83431387, 'recall': 0.61512136, 'specificity': 0.61512136, 'f1': 0.666468, 'auroc': 0.8212197, 'binary_precision': 0.7011494, 'binary_recall': 0.23461539, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.35158503}
confusion matrix:
      0   1
0  5920  26
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_13.png
early stop counter: 2
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 13,now: 2024-06-20 10:37:25.486725,epoch time: 0:17:08.525680,used: 3:37:02.894222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9893622, 'precision': 0.98497456, 'recall': 0.9509189, 'specificity': 0.9509189, 'f1': 0.9671737, 'auroc': 0.99509513, 'binary_precision': 0.979684, 'binary_recall': 0.9037483, 'binary_specificity': 0.99808955, 'binary_f1_score': 0.94018537}
confusion matrix:
       0     1
0  42317    81
1    416  3906
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79843104, 'recall': 0.5937086, 'specificity': 0.5937086, 'f1': 0.6382743, 'auroc': 0.82099605, 'binary_precision': 0.6262136, 'binary_recall': 0.19167905, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.29351535}
confusion matrix:
       0    1
0  17990   77
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.81282294, 'recall': 0.57708025, 'specificity': 0.57708025, 'f1': 0.6174036, 'auroc': 0.8266765, 'binary_precision': 0.66129035, 'binary_recall': 0.15769231, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2546584}
confusion matrix:
      0   1
0  5925  21
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_14.png
early stop counter: 3
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 14,now: 2024-06-20 10:55:26.586872,epoch time: 0:18:01.100147,used: 3:55:03.994369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99019694, 'precision': 0.9838202, 'recall': 0.95710266, 'specificity': 0.95710266, 'f1': 0.9699873, 'auroc': 0.9960449, 'binary_precision': 0.9761025, 'binary_recall': 0.9164932, 'binary_specificity': 0.9977121, 'binary_f1_score': 0.9453591}
confusion matrix:
       0     1
0  42300    97
1    361  3962
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7922189, 'recall': 0.6001183, 'specificity': 0.6001183, 'f1': 0.6451734, 'auroc': 0.8224846, 'binary_precision': 0.61333334, 'binary_recall': 0.205052, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.30734965}
confusion matrix:
       0    1
0  17980   87
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7922553, 'recall': 0.58234495, 'specificity': 0.58234495, 'f1': 0.6228734, 'auroc': 0.8218201, 'binary_precision': 0.6197183, 'binary_recall': 0.16923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5919  27
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_15.png
early stop counter: 4
val acc:0.9668089747428894, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 15,now: 2024-06-20 11:15:10.483763,epoch time: 0:19:43.896891,used: 4:14:47.891260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9911601, 'precision': 0.98744655, 'recall': 0.9593991, 'specificity': 0.9593991, 'f1': 0.9729041, 'auroc': 0.99659526, 'binary_precision': 0.98295456, 'binary_recall': 0.92042565, 'binary_specificity': 0.99837255, 'binary_f1_score': 0.95066303}
confusion matrix:
       0     1
0  42328    69
1    344  3979
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7941026, 'recall': 0.58347344, 'specificity': 0.58347344, 'f1': 0.62528867, 'auroc': 0.8176676, 'binary_precision': 0.6182796, 'binary_recall': 0.17087667, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.26775318}
confusion matrix:
       0    1
0  17996   71
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.81119657, 'recall': 0.5582699, 'specificity': 0.5582699, 'f1': 0.5908574, 'auroc': 0.8131229, 'binary_precision': 0.65957445, 'binary_recall': 0.11923077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.20195441}
confusion matrix:
      0   1
0  5930  16
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_16.png
early stop counter: 5
val acc:0.966435432434082, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 16,now: 2024-06-20 11:34:07.772742,epoch time: 0:18:57.288979,used: 4:33:45.180239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9907534, 'precision': 0.98729, 'recall': 0.9570782, 'specificity': 0.9570782, 'f1': 0.971581, 'auroc': 0.9957888, 'binary_precision': 0.9831056, 'binary_recall': 0.9157602, 'binary_specificity': 0.9983962, 'binary_f1_score': 0.9482387}
confusion matrix:
       0     1
0  42331    68
1    364  3957
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.80183184, 'recall': 0.5915904, 'specificity': 0.5915904, 'f1': 0.63602734, 'auroc': 0.82354796, 'binary_precision': 0.63316584, 'binary_recall': 0.1872214, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.2889908}
confusion matrix:
       0    1
0  17994   73
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.795204, 'recall': 0.55994076, 'specificity': 0.55994076, 'f1': 0.5926881, 'auroc': 0.8154189, 'binary_precision': 0.627451, 'binary_recall': 0.12307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20578778}
confusion matrix:
      0   1
0  5927  19
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_17.png
early stop counter: 6
val acc:0.9669156670570374, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 17,now: 2024-06-20 11:53:17.839753,epoch time: 0:19:10.067011,used: 4:52:55.247250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99195206, 'precision': 0.9879601, 'recall': 0.9637031, 'specificity': 0.9637031, 'f1': 0.97544515, 'auroc': 0.9963383, 'binary_precision': 0.98312134, 'binary_recall': 0.92903376, 'binary_specificity': 0.99837244, 'binary_f1_score': 0.95531255}
confusion matrix:
       0     1
0  42325    69
1    307  4019
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7903531, 'recall': 0.60515285, 'specificity': 0.60515285, 'f1': 0.65067494, 'auroc': 0.83026576, 'binary_precision': 0.6092437, 'binary_recall': 0.2154532, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.31833148}
confusion matrix:
       0    1
0  17974   93
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.76550096, 'recall': 0.5706383, 'specificity': 0.5706383, 'f1': 0.60582316, 'auroc': 0.8281493, 'binary_precision': 0.5671642, 'binary_recall': 0.14615385, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.2324159}
confusion matrix:
      0   1
0  5917  29
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_18.png
early stop counter: 7
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 18,now: 2024-06-20 12:14:22.224726,epoch time: 0:21:04.384973,used: 5:13:59.632223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9907748, 'precision': 0.98763543, 'recall': 0.9569115, 'specificity': 0.9569115, 'f1': 0.97164977, 'auroc': 0.99620944, 'binary_precision': 0.9838429, 'binary_recall': 0.91535616, 'binary_specificity': 0.99846685, 'binary_f1_score': 0.9483647}
confusion matrix:
       0     1
0  42331    65
1    366  3958
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8049631, 'recall': 0.5865559, 'specificity': 0.5865559, 'f1': 0.6300545, 'auroc': 0.8296635, 'binary_precision': 0.63978493, 'binary_recall': 0.1768202, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.27706635}
confusion matrix:
       0    1
0  18000   67
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8370521, 'recall': 0.5604453, 'specificity': 0.5604453, 'f1': 0.5949651, 'auroc': 0.8198411, 'binary_precision': 0.7111111, 'binary_recall': 0.12307692, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.20983607}
confusion matrix:
      0   1
0  5933  13
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_19.png
early stop counter: 8
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 19,now: 2024-06-20 12:32:55.688217,epoch time: 0:18:33.463491,used: 5:32:33.095714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9912243, 'precision': 0.9878094, 'recall': 0.9594253, 'specificity': 0.9594253, 'f1': 0.97308636, 'auroc': 0.9961256, 'binary_precision': 0.98367953, 'binary_recall': 0.92040724, 'binary_specificity': 0.9984433, 'binary_f1_score': 0.95099205}
confusion matrix:
       0     1
0  42332    66
1    344  3978
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.78435636, 'recall': 0.5927165, 'specificity': 0.5927165, 'f1': 0.6356848, 'auroc': 0.82907665, 'binary_precision': 0.5981308, 'binary_recall': 0.19019316, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.2886133}
confusion matrix:
       0    1
0  17981   86
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8125322, 'recall': 0.5733182, 'specificity': 0.5733182, 'f1': 0.61229265, 'auroc': 0.8154943, 'binary_precision': 0.66101694, 'binary_recall': 0.15, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.24451412}
confusion matrix:
      0   1
0  5926  20
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_20.png
early stop counter: 9
val acc:0.9663286805152893, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 20,now: 2024-06-20 12:50:58.265693,epoch time: 0:18:02.577476,used: 5:50:35.673190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99141693, 'precision': 0.98413527, 'recall': 0.96423054, 'specificity': 0.96423054, 'f1': 0.9739214, 'auroc': 0.9964415, 'binary_precision': 0.9752907, 'binary_recall': 0.9308671, 'binary_specificity': 0.99759406, 'binary_f1_score': 0.95256126}
confusion matrix:
       0     1
0  42293   102
1    299  4026
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7713724, 'recall': 0.6104875, 'specificity': 0.6104875, 'f1': 0.6539036, 'auroc': 0.84054196, 'binary_precision': 0.5708955, 'binary_recall': 0.22734027, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.32518595}
confusion matrix:
       0    1
0  17952  115
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7657391, 'recall': 0.5873574, 'specificity': 0.5873574, 'f1': 0.6267106, 'auroc': 0.830148, 'binary_precision': 0.56626505, 'binary_recall': 0.18076923, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.27405247}
confusion matrix:
      0   1
0  5910  36
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_21.png
early stop counter: 10
val acc:0.9661152362823486, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 21,now: 2024-06-20 13:08:59.766899,epoch time: 0:18:01.501206,used: 6:08:37.174396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.9882945, 'recall': 0.9645277, 'specificity': 0.9645277, 'f1': 0.9760406, 'auroc': 0.99605036, 'binary_precision': 0.9836266, 'binary_recall': 0.9306358, 'binary_specificity': 0.99841964, 'binary_f1_score': 0.9563977}
confusion matrix:
       0     1
0  42328    67
1    300  4025
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79203284, 'recall': 0.59213966, 'specificity': 0.59213966, 'f1': 0.63576627, 'auroc': 0.8395513, 'binary_precision': 0.6135266, 'binary_recall': 0.18870728, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.28863636}
confusion matrix:
       0    1
0  17987   80
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.773844, 'recall': 0.5577654, 'specificity': 0.5577654, 'f1': 0.58866876, 'auroc': 0.8232021, 'binary_precision': 0.5849057, 'binary_recall': 0.11923077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.19808307}
confusion matrix:
      0   1
0  5924  22
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_22.png
early stop counter: 11
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 22,now: 2024-06-20 13:29:19.990030,epoch time: 0:20:20.223131,used: 6:28:57.397527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99233735, 'precision': 0.9874604, 'recall': 0.9664875, 'specificity': 0.9664875, 'f1': 0.97668564, 'auroc': 0.9969519, 'binary_precision': 0.98153996, 'binary_recall': 0.93476754, 'binary_specificity': 0.99820745, 'binary_f1_score': 0.957583}
confusion matrix:
       0     1
0  42321    76
1    282  4041
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7862693, 'recall': 0.5942024, 'specificity': 0.5942024, 'f1': 0.6376367, 'auroc': 0.8395151, 'binary_precision': 0.6018519, 'binary_recall': 0.19316493, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.29246345}
confusion matrix:
       0    1
0  17981   86
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73536384, 'recall': 0.56077063, 'specificity': 0.56077063, 'f1': 0.5908245, 'auroc': 0.827742, 'binary_precision': 0.50769234, 'binary_recall': 0.12692308, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.20307693}
confusion matrix:
      0   1
0  5914  32
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_23.png
early stop counter: 12
val acc:0.966435432434082, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 23,now: 2024-06-20 13:49:19.518802,epoch time: 0:19:59.528772,used: 6:48:56.926299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921019, 'precision': 0.9864727, 'recall': 0.9660689, 'specificity': 0.9660689, 'f1': 0.9759974, 'auroc': 0.9977375, 'binary_precision': 0.9796364, 'binary_recall': 0.9341193, 'binary_specificity': 0.99801856, 'binary_f1_score': 0.95633656}
confusion matrix:
       0     1
0  42310    84
1    285  4041
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.789544, 'recall': 0.595716, 'specificity': 0.595716, 'f1': 0.6397604, 'auroc': 0.83850574, 'binary_precision': 0.6082949, 'binary_recall': 0.1961367, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.29662922}
confusion matrix:
       0    1
0  17982   85
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.73917186, 'recall': 0.5626937, 'specificity': 0.5626937, 'f1': 0.59362096, 'auroc': 0.8227005, 'binary_precision': 0.5151515, 'binary_recall': 0.13076924, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.20858896}
confusion matrix:
      0   1
0  5914  32
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_24.png
early stop counter: 13
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 24,now: 2024-06-20 14:14:38.907236,epoch time: 0:25:19.388434,used: 7:14:16.314733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9916738, 'precision': 0.98629296, 'recall': 0.9636454, 'specificity': 0.9636454, 'f1': 0.97463155, 'auroc': 0.99695504, 'binary_precision': 0.97976595, 'binary_recall': 0.9292486, 'binary_specificity': 0.9980422, 'binary_f1_score': 0.9538389}
confusion matrix:
       0     1
0  42312    83
1    306  4019
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79563653, 'recall': 0.5972849, 'specificity': 0.5972849, 'f1': 0.6422455, 'auroc': 0.83998275, 'binary_precision': 0.6203704, 'binary_recall': 0.19910847, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.30146232}
confusion matrix:
       0    1
0  17985   82
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7684252, 'recall': 0.5576813, 'specificity': 0.5576813, 'f1': 0.5883112, 'auroc': 0.8172189, 'binary_precision': 0.5740741, 'binary_recall': 0.11923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.19745223}
confusion matrix:
      0   1
0  5923  23
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_25.png
early stop counter: 14
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 25,now: 2024-06-20 14:42:01.625194,epoch time: 0:27:22.717958,used: 7:41:39.032691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9918236, 'precision': 0.9902519, 'recall': 0.96069944, 'specificity': 0.96069944, 'f1': 0.97490275, 'auroc': 0.99687874, 'binary_precision': 0.98835194, 'binary_recall': 0.9225075, 'binary_specificity': 0.9988914, 'binary_f1_score': 0.95429534}
confusion matrix:
       0     1
0  42350    47
1    335  3988
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79759276, 'recall': 0.58716047, 'specificity': 0.58716047, 'f1': 0.63019353, 'auroc': 0.8379104, 'binary_precision': 0.625, 'binary_recall': 0.17830609, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.27745664}
confusion matrix:
       0    1
0  17995   72
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7684252, 'recall': 0.5576813, 'specificity': 0.5576813, 'f1': 0.5883112, 'auroc': 0.8215065, 'binary_precision': 0.5740741, 'binary_recall': 0.11923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.19745223}
confusion matrix:
      0   1
0  5923  23
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_26.png
early stop counter: 15
val acc:0.9666488766670227, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 26,now: 2024-06-20 15:09:51.495269,epoch time: 0:27:49.870075,used: 8:09:28.902766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99229455, 'precision': 0.98892003, 'recall': 0.964802, 'specificity': 0.964802, 'f1': 0.97648, 'auroc': 0.9971818, 'binary_precision': 0.98482996, 'binary_recall': 0.9310664, 'binary_specificity': 0.99853766, 'binary_f1_score': 0.9571938}
confusion matrix:
       0     1
0  42335    62
1    298  4025
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.78812575, 'recall': 0.58264744, 'specificity': 0.58264744, 'f1': 0.6237612, 'auroc': 0.8467927, 'binary_precision': 0.60638297, 'binary_recall': 0.16939078, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.26480836}
confusion matrix:
       0    1
0  17993   74
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7497441, 'recall': 0.55366695, 'specificity': 0.55366695, 'f1': 0.58177644, 'auroc': 0.8342554, 'binary_precision': 0.537037, 'binary_recall': 0.11153846, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.18471338}
confusion matrix:
      0   1
0  5921  25
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_27.png
early stop counter: 16
val acc:0.9662219882011414, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 27,now: 2024-06-20 15:32:07.324377,epoch time: 0:22:15.829108,used: 8:31:44.731874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9925728, 'precision': 0.990065, 'recall': 0.9653944, 'specificity': 0.9653944, 'f1': 0.97733176, 'auroc': 0.99769855, 'binary_precision': 0.9870257, 'binary_recall': 0.93203884, 'binary_specificity': 0.99874985, 'binary_f1_score': 0.95874447}
confusion matrix:
       0     1
0  42341    53
1    294  4032
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79098743, 'recall': 0.5790711, 'specificity': 0.5790711, 'f1': 0.6194439, 'auroc': 0.8403431, 'binary_precision': 0.6123595, 'binary_recall': 0.16196136, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.2561692}
confusion matrix:
       0    1
0  17998   69
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73083794, 'recall': 0.5441357, 'specificity': 0.5441357, 'f1': 0.5671818, 'auroc': 0.8159208, 'binary_precision': 0.5, 'binary_recall': 0.092307694, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.15584417}
confusion matrix:
      0   1
0  5922  24
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_28.png
early stop counter: 17
val acc:0.9662219882011414, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 28,now: 2024-06-20 15:55:26.872130,epoch time: 0:23:19.547753,used: 8:55:04.279627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99201626, 'precision': 0.9870471, 'recall': 0.96498394, 'specificity': 0.96498394, 'f1': 0.9756958, 'auroc': 0.9971776, 'binary_precision': 0.9810173, 'binary_recall': 0.9318077, 'binary_specificity': 0.9981601, 'binary_f1_score': 0.95577955}
confusion matrix:
       0     1
0  42316    78
1    295  4031
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7872858, 'recall': 0.59929234, 'specificity': 0.59929234, 'f1': 0.6436657, 'auroc': 0.84644645, 'binary_precision': 0.6035242, 'binary_recall': 0.20356612, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.30444443}
confusion matrix:
       0    1
0  17977   90
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.71768916, 'recall': 0.56218916, 'specificity': 0.56218916, 'f1': 0.59148246, 'auroc': 0.82196665, 'binary_precision': 0.4722222, 'binary_recall': 0.13076924, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.20481928}
confusion matrix:
      0   1
0  5908  38
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_29.png
early stop counter: 18
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 29,now: 2024-06-20 16:20:23.608291,epoch time: 0:24:56.736161,used: 9:20:01.015788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9925728, 'precision': 0.9891008, 'recall': 0.9663284, 'specificity': 0.9663284, 'f1': 0.9773754, 'auroc': 0.996518, 'binary_precision': 0.9848891, 'binary_recall': 0.9341193, 'binary_specificity': 0.99853754, 'binary_f1_score': 0.9588326}
confusion matrix:
       0     1
0  42332    62
1    285  4041
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7979648, 'recall': 0.58861864, 'specificity': 0.58861864, 'f1': 0.6320312, 'auroc': 0.8493244, 'binary_precision': 0.62564105, 'binary_recall': 0.18127786, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.281106}
confusion matrix:
       0    1
0  17994   73
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.69328225, 'recall': 0.5361911, 'specificity': 0.5361911, 'f1': 0.5541181, 'auroc': 0.81738544, 'binary_precision': 0.42553192, 'binary_recall': 0.07692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.13029316}
confusion matrix:
      0   1
0  5919  27
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_30.png
early stop counter: 19
val acc:0.9667022228240967, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.961650013923645 / 0.9653561115264893
after epoch: 30,now: 2024-06-20 16:47:43.350577,epoch time: 0:27:19.742286,used: 9:47:20.758074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_00_22_seed_1_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:47:20.758074 at 2024-06-20 16:47:43.350577
persisted model performance metric: 

scalar performance:
{'acc': 0.96165, 'precision': 0.8209688, 'recall': 0.57908744, 'specificity': 0.57908744, 'f1': 0.6205919, 'auroc': 0.8025599, 'binary_precision': 0.67741936, 'binary_recall': 0.16153847, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  5926  20
1   218  42
oracle model performance metric: 

scalar performance:
{'acc': 0.9653561, 'precision': 0.86345804, 'recall': 0.6251572, 'specificity': 0.6251572, 'f1': 0.6812917, 'auroc': 0.78764313, 'binary_precision': 0.7586207, 'binary_recall': 0.25384617, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.38040346}
confusion matrix:
      0   1
0  5925  21
1   194  66
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 741949 GiB | 741948 GiB |
|       from small pool |  36158 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 741949 GiB | 741948 GiB |
|       from small pool |  36158 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB | 742140 GiB | 742139 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 741934 GiB | 741934 GiB |
|       from small pool |  35966 KiB |     71 MiB |    205 GiB |    205 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 525587 GiB | 525586 GiB |
|       from large pool | 397312 KiB |    899 MiB | 525372 GiB | 525371 GiB |
|       from small pool |   6849 KiB |     14 MiB |    215 GiB |    215 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   22271 K  |   22270 K  |
|       from large pool |      36    |      76    |    7056 K  |    7056 K  |
|       from small pool |    1158    |    1780    |   15215 K  |   15214 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   22271 K  |   22270 K  |
|       from large pool |      36    |      76    |    7056 K  |    7056 K  |
|       from small pool |    1158    |    1780    |   15215 K  |   15214 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   11319 K  |   11319 K  |
|       from large pool |       5    |      11    |    2778 K  |    2778 K  |
|       from small pool |      29    |     375    |    8541 K  |    8541 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 741949 GiB | 741949 GiB |
|       from small pool |      0 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 741949 GiB | 741949 GiB |
|       from small pool |      0 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 742140 GiB | 742140 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 741934 GiB | 741934 GiB |
|       from small pool |      0 KiB |     71 MiB |    205 GiB |    205 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 525587 GiB | 525587 GiB |
|       from large pool | 384768 KiB |    899 MiB | 525372 GiB | 525372 GiB |
|       from small pool |      0 KiB |     14 MiB |    215 GiB |    215 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22271 K  |   22271 K  |
|       from large pool |       2    |      76    |    7056 K  |    7056 K  |
|       from small pool |       0    |    1780    |   15215 K  |   15215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22271 K  |   22271 K  |
|       from large pool |       2    |      76    |    7056 K  |    7056 K  |
|       from small pool |       0    |    1780    |   15215 K  |   15215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11320 K  |   11320 K  |
|       from large pool |       1    |      11    |    2778 K  |    2778 K  |
|       from small pool |       0    |     375    |    8541 K  |    8541 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 741949 GiB | 741949 GiB |
|       from small pool |      0 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 742157 GiB | 742157 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 741949 GiB | 741949 GiB |
|       from small pool |      0 KiB |     72 MiB |    208 GiB |    208 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 742140 GiB | 742140 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 741934 GiB | 741934 GiB |
|       from small pool |      0 KiB |     71 MiB |    205 GiB |    205 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 525587 GiB | 525587 GiB |
|       from large pool | 384768 KiB |    899 MiB | 525372 GiB | 525372 GiB |
|       from small pool |      0 KiB |     14 MiB |    215 GiB |    215 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   22271 K  |   22271 K  |
|       from large pool |       2    |      76    |    7056 K  |    7056 K  |
|       from small pool |       0    |    1780    |   15215 K  |   15215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   22271 K  |   22271 K  |
|       from large pool |       2    |      76    |    7056 K  |    7056 K  |
|       from small pool |       0    |    1780    |   15215 K  |   15215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   11320 K  |   11320 K  |
|       from large pool |       1    |      11    |    2778 K  |    2778 K  |
|       from small pool |       0    |     375    |    8541 K  |    8541 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112

 Experiment start at: 2024-06-20 17:03:13.813959
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9454619, 'precision': 0.96425587, 'recall': 0.72159886, 'specificity': 0.72159886, 'f1': 0.7913333, 'auroc': 0.94580734, 'binary_precision': 0.9848485, 'binary_recall': 0.4439304, 'binary_specificity': 0.9992673, 'binary_f1_score': 0.611997}
confusion matrix:
       0     1
0  42278    31
1   2524  2015
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.48395267, 'recall': 0.49955973, 'specificity': 0.49955973, 'f1': 0.49163237, 'auroc': 0.56264096, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18155  16
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.60883814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 17:33:40.788558,epoch time: 0:30:26.974599,used: 0:30:26.974599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96821636, 'precision': 0.97820437, 'recall': 0.83912396, 'specificity': 0.83912396, 'f1': 0.89406526, 'auroc': 0.9737637, 'binary_precision': 0.9897238, 'binary_recall': 0.6790042, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.8054358}
confusion matrix:
       0     1
0  42277    32
1   1457  3082
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7984637, 'recall': 0.5301255, 'specificity': 0.5301255, 'f1': 0.54801863, 'auroc': 0.6607789, 'binary_precision': 0.62711865, 'binary_recall': 0.061461795, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.11195159}
confusion matrix:
       0   1
0  18149  22
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.6685381, 'recall': 0.51156294, 'specificity': 0.51156294, 'f1': 0.5131903, 'auroc': 0.6916935, 'binary_precision': 0.375, 'binary_recall': 0.024793388, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.046511628}
confusion matrix:
      0   1
0  5987  10
1   236   6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 18:03:22.465967,epoch time: 0:29:41.677409,used: 1:00:08.652008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97696805, 'precision': 0.98084134, 'recall': 0.8862548, 'specificity': 0.8862548, 'f1': 0.92711663, 'auroc': 0.98278475, 'binary_precision': 0.9854097, 'binary_recall': 0.7737387, 'binary_specificity': 0.99877095, 'binary_f1_score': 0.8668394}
confusion matrix:
       0     1
0  42257    52
1   1027  3512
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7570505, 'recall': 0.5565161, 'specificity': 0.5565161, 'f1': 0.5877326, 'auroc': 0.7125249, 'binary_precision': 0.5426357, 'binary_recall': 0.11627907, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.19151847}
confusion matrix:
       0   1
0  18112  59
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.83536035, 'recall': 0.57717836, 'specificity': 0.57717836, 'f1': 0.61934865, 'auroc': 0.7364522, 'binary_precision': 0.7037037, 'binary_recall': 0.1570248, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25675678}
confusion matrix:
      0   1
0  5981  16
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_3.png
new oracle model saved
early stop counter: 1
val acc:0.9685186147689819, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9605706334114075 / 0.9647379517555237
after epoch: 3,now: 2024-06-20 18:31:19.369769,epoch time: 0:27:56.903802,used: 1:28:05.555810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9797857, 'precision': 0.98295677, 'recall': 0.9005005, 'specificity': 0.9005005, 'f1': 0.93691945, 'auroc': 0.9870759, 'binary_precision': 0.98672086, 'binary_recall': 0.8021591, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.88491917}
confusion matrix:
       0     1
0  42260    49
1    898  3641
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.77856207, 'recall': 0.5640737, 'specificity': 0.5640737, 'f1': 0.5993264, 'auroc': 0.7299943, 'binary_precision': 0.58518517, 'binary_recall': 0.13122924, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.21438263}
confusion matrix:
       0   1
0  18115  56
1    523  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.8632935, 'recall': 0.5897418, 'specificity': 0.5897418, 'f1': 0.63796246, 'auroc': 0.74292517, 'binary_precision': 0.7586207, 'binary_recall': 0.18181819, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.29333332}
confusion matrix:
      0   1
0  5983  14
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-20 18:55:24.766949,epoch time: 0:24:05.397180,used: 1:52:10.952990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98243254, 'precision': 0.98365027, 'recall': 0.9148908, 'specificity': 0.9148908, 'f1': 0.94597286, 'auroc': 0.9881424, 'binary_precision': 0.9851058, 'binary_recall': 0.8311288, 'binary_specificity': 0.9986529, 'binary_f1_score': 0.90159035}
confusion matrix:
       0     1
0  42255    57
1    766  3770
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7716006, 'recall': 0.57531637, 'specificity': 0.57531637, 'f1': 0.61369777, 'auroc': 0.7596261, 'binary_precision': 0.5705522, 'binary_recall': 0.15448505, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.24313724}
confusion matrix:
       0   1
0  18101  70
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8876843, 'recall': 0.6023053, 'specificity': 0.6023053, 'f1': 0.65609515, 'auroc': 0.7690266, 'binary_precision': 0.8064516, 'binary_recall': 0.20661157, 'binary_specificity': 0.997999, 'binary_f1_score': 0.32894737}
confusion matrix:
      0   1
0  5985  12
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_5.png
new oracle model saved
early stop counter: 1
val acc:0.9691578149795532, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9660201668739319 / 0.9673024415969849
after epoch: 5,now: 2024-06-20 19:19:25.618208,epoch time: 0:24:00.851259,used: 2:16:11.804249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98561305, 'precision': 0.9830187, 'recall': 0.93372, 'specificity': 0.93372, 'f1': 0.9566997, 'auroc': 0.98925936, 'binary_precision': 0.97988576, 'binary_recall': 0.8693545, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.9213168}
confusion matrix:
       0     1
0  42228    81
1    593  3946
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74459183, 'recall': 0.59495234, 'specificity': 0.59495234, 'f1': 0.6338946, 'auroc': 0.7868918, 'binary_precision': 0.5152838, 'binary_recall': 0.19601329, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.28399518}
confusion matrix:
       0    1
0  18060  111
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.84411764, 'recall': 0.6240321, 'specificity': 0.6240321, 'f1': 0.6781088, 'auroc': 0.791205, 'binary_precision': 0.7176471, 'binary_recall': 0.2520661, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3730887}
confusion matrix:
      0   1
0  5973  24
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_6.png
early stop counter: 2
val acc:0.9683055281639099, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9660201668739319 / 0.9673024415969849
after epoch: 6,now: 2024-06-20 19:42:20.484353,epoch time: 0:22:54.866145,used: 2:39:06.670394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98490864, 'precision': 0.9823386, 'recall': 0.9302815, 'specificity': 0.9302815, 'f1': 0.95444095, 'auroc': 0.99074936, 'binary_precision': 0.97923964, 'binary_recall': 0.8625248, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.91718405}
confusion matrix:
       0     1
0  42226    83
1    624  3915
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7763297, 'recall': 0.5826814, 'specificity': 0.5826814, 'f1': 0.6232997, 'auroc': 0.7775933, 'binary_precision': 0.57954544, 'binary_recall': 0.16943522, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.26221082}
confusion matrix:
       0    1
0  18097   74
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8908654, 'recall': 0.6064375, 'specificity': 0.6064375, 'f1': 0.6616369, 'auroc': 0.7758961, 'binary_precision': 0.8125, 'binary_recall': 0.21487603, 'binary_specificity': 0.997999, 'binary_f1_score': 0.33986926}
confusion matrix:
      0   1
0  5985  12
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-20 20:03:45.353953,epoch time: 0:21:24.869600,used: 3:00:31.539994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98695785, 'precision': 0.985288, 'recall': 0.9393815, 'specificity': 0.9393815, 'f1': 0.96089894, 'auroc': 0.9932476, 'binary_precision': 0.9832677, 'binary_recall': 0.88037014, 'binary_specificity': 0.99839276, 'binary_f1_score': 0.92897826}
confusion matrix:
       0     1
0  42241    68
1    543  3996
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7846763, 'recall': 0.5803823, 'specificity': 0.5803823, 'f1': 0.621157, 'auroc': 0.7803862, 'binary_precision': 0.59638554, 'binary_recall': 0.16445182, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.25781247}
confusion matrix:
       0   1
0  18104  67
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.83066607, 'recall': 0.5872589, 'specificity': 0.5872589, 'f1': 0.63249385, 'auroc': 0.76858675, 'binary_precision': 0.6935484, 'binary_recall': 0.17768595, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5978  19
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_8.png
better model found
persisted
after epoch: 8,now: 2024-06-20 20:23:46.807873,epoch time: 0:20:01.453920,used: 3:20:32.993914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9882386, 'precision': 0.9815534, 'recall': 0.95030713, 'specificity': 0.95030713, 'f1': 0.9652674, 'auroc': 0.99407166, 'binary_precision': 0.973403, 'binary_recall': 0.90326136, 'binary_specificity': 0.9973529, 'binary_f1_score': 0.9370213}
confusion matrix:
       0     1
0  42198   112
1    439  4099
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75754917, 'recall': 0.6017069, 'specificity': 0.6017069, 'f1': 0.6429578, 'auroc': 0.7910284, 'binary_precision': 0.54077256, 'binary_recall': 0.20930232, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.3017964}
confusion matrix:
       0    1
0  18064  107
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.84196925, 'recall': 0.6118021, 'specificity': 0.6118021, 'f1': 0.6638193, 'auroc': 0.77639663, 'binary_precision': 0.71428573, 'binary_recall': 0.22727273, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3448276}
confusion matrix:
      0   1
0  5975  22
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_9.png
early stop counter: 1
val acc:0.968944787979126, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 9,now: 2024-06-20 20:45:31.071201,epoch time: 0:21:44.263328,used: 3:42:17.257242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98719263, 'precision': 0.9820634, 'recall': 0.9437279, 'specificity': 0.9437279, 'f1': 0.96189326, 'auroc': 0.9934107, 'binary_precision': 0.9758337, 'binary_recall': 0.8898193, 'binary_specificity': 0.9976365, 'binary_f1_score': 0.9308437}
confusion matrix:
       0     1
0  42210   100
1    500  4038
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75519884, 'recall': 0.587945, 'specificity': 0.587945, 'f1': 0.6274154, 'auroc': 0.8006649, 'binary_precision': 0.5369458, 'binary_recall': 0.18106312, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.27080745}
confusion matrix:
       0    1
0  18077   94
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.82420725, 'recall': 0.6195663, 'specificity': 0.6195663, 'f1': 0.6706475, 'auroc': 0.78594476, 'binary_precision': 0.6781609, 'binary_recall': 0.24380165, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3586626}
confusion matrix:
      0   1
0  5969  28
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_10.png
early stop counter: 2
val acc:0.968731701374054, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 10,now: 2024-06-20 21:05:32.890819,epoch time: 0:20:01.819618,used: 4:02:19.076860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98840934, 'precision': 0.9827888, 'recall': 0.95011723, 'specificity': 0.95011723, 'f1': 0.9657296, 'auroc': 0.99450374, 'binary_precision': 0.97594094, 'binary_recall': 0.90262175, 'binary_specificity': 0.9976128, 'binary_f1_score': 0.93785053}
confusion matrix:
       0     1
0  42208   101
1    442  4097
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7688885, 'recall': 0.5849805, 'specificity': 0.5849805, 'f1': 0.6253865, 'auroc': 0.80450255, 'binary_precision': 0.5645161, 'binary_recall': 0.1744186, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.26649743}
confusion matrix:
       0    1
0  18090   81
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8467597, 'recall': 0.60172164, 'specificity': 0.60172164, 'f1': 0.6521007, 'auroc': 0.77827895, 'binary_precision': 0.7246377, 'binary_recall': 0.20661157, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.32154343}
confusion matrix:
      0   1
0  5978  19
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_11.png
early stop counter: 3
val acc:0.9692111015319824, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 11,now: 2024-06-20 21:24:29.890799,epoch time: 0:18:56.999980,used: 4:21:16.076840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9898395, 'precision': 0.98456085, 'recall': 0.95671105, 'specificity': 0.95671105, 'f1': 0.9701146, 'auroc': 0.9950189, 'binary_precision': 0.9781125, 'binary_recall': 0.9156202, 'binary_specificity': 0.9978019, 'binary_f1_score': 0.94583523}
confusion matrix:
       0     1
0  42216    93
1    383  4156
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.77277976, 'recall': 0.5866691, 'specificity': 0.5866691, 'f1': 0.6277931, 'auroc': 0.80938977, 'binary_precision': 0.5721925, 'binary_recall': 0.17774086, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2712294}
confusion matrix:
       0    1
0  18091   80
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8249525, 'recall': 0.5912243, 'specificity': 0.5912243, 'f1': 0.6371474, 'auroc': 0.7874418, 'binary_precision': 0.6818182, 'binary_recall': 0.18595041, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.29220778}
confusion matrix:
      0   1
0  5976  21
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_12.png
early stop counter: 4
val acc:0.9693709015846252, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 12,now: 2024-06-20 21:42:56.667174,epoch time: 0:18:26.776375,used: 4:39:42.853215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98962605, 'precision': 0.98605275, 'recall': 0.954036, 'specificity': 0.954036, 'f1': 0.96935534, 'auroc': 0.99482185, 'binary_precision': 0.98169714, 'binary_recall': 0.909892, 'binary_specificity': 0.99818003, 'binary_f1_score': 0.9444317}
confusion matrix:
       0     1
0  42232    77
1    409  4130
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.77346194, 'recall': 0.58182335, 'specificity': 0.58182335, 'f1': 0.62198716, 'auroc': 0.81727815, 'binary_precision': 0.5738636, 'binary_recall': 0.16777408, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.2596401}
confusion matrix:
       0    1
0  18096   75
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.77459955, 'recall': 0.57824403, 'specificity': 0.57824403, 'f1': 0.6167222, 'auroc': 0.7942885, 'binary_precision': 0.58208954, 'binary_recall': 0.16115703, 'binary_specificity': 0.995331, 'binary_f1_score': 0.2524272}
confusion matrix:
      0   1
0  5969  28
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_13.png
early stop counter: 5
val acc:0.969317615032196, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 13,now: 2024-06-20 22:01:14.015130,epoch time: 0:18:17.347956,used: 4:58:00.201171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98633283, 'recall': 0.9535107, 'specificity': 0.9535107, 'f1': 0.96919763, 'auroc': 0.99610907, 'binary_precision': 0.9823726, 'binary_recall': 0.9087704, 'binary_specificity': 0.998251, 'binary_f1_score': 0.9441392}
confusion matrix:
       0     1
0  42236    74
1    414  4124
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7661097, 'recall': 0.5760369, 'specificity': 0.5760369, 'f1': 0.6141652, 'auroc': 0.8143623, 'binary_precision': 0.5595238, 'binary_recall': 0.15614618, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.24415587}
confusion matrix:
       0   1
0  18097  74
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.78310156, 'recall': 0.5663476, 'specificity': 0.5663476, 'f1': 0.60162914, 'auroc': 0.77925617, 'binary_precision': 0.6, 'binary_recall': 0.13636364, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5975  22
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_14.png
early stop counter: 6
val acc:0.9689980149269104, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 14,now: 2024-06-20 22:19:51.951788,epoch time: 0:18:37.936658,used: 5:16:38.137829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98969007, 'precision': 0.98335487, 'recall': 0.95702165, 'specificity': 0.95702165, 'f1': 0.96972144, 'auroc': 0.995885, 'binary_precision': 0.9756098, 'binary_recall': 0.9165014, 'binary_specificity': 0.9975419, 'binary_f1_score': 0.9451324}
confusion matrix:
       0     1
0  42205   104
1    379  4160
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.77277976, 'recall': 0.5866691, 'specificity': 0.5866691, 'f1': 0.6277931, 'auroc': 0.821523, 'binary_precision': 0.5721925, 'binary_recall': 0.17774086, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2712294}
confusion matrix:
       0    1
0  18091   80
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7886598, 'recall': 0.5664309, 'specificity': 0.5664309, 'f1': 0.6020464, 'auroc': 0.77692974, 'binary_precision': 0.6111111, 'binary_recall': 0.13636364, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.22297299}
confusion matrix:
      0   1
0  5976  21
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_15.png
early stop counter: 7
val acc:0.9693709015846252, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 15,now: 2024-06-20 22:37:50.024523,epoch time: 0:17:58.072735,used: 5:34:36.210564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9909708, 'precision': 0.9849102, 'recall': 0.96292686, 'specificity': 0.96292686, 'f1': 0.97359556, 'auroc': 0.9958396, 'binary_precision': 0.97748375, 'binary_recall': 0.92814636, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.95217633}
confusion matrix:
       0     1
0  42214    97
1    326  4211
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7622142, 'recall': 0.58727956, 'specificity': 0.58727956, 'f1': 0.6274196, 'auroc': 0.81975925, 'binary_precision': 0.5510204, 'binary_recall': 0.179402, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.27067667}
confusion matrix:
       0    1
0  18083   88
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7675761, 'recall': 0.56609744, 'specificity': 0.56609744, 'f1': 0.6003925, 'auroc': 0.78102773, 'binary_precision': 0.5689655, 'binary_recall': 0.13636364, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.22}
confusion matrix:
      0   1
0  5972  25
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_16.png
early stop counter: 8
val acc:0.9689980149269104, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 16,now: 2024-06-20 22:55:58.640814,epoch time: 0:18:08.616291,used: 5:52:44.826855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9901383, 'precision': 0.98405784, 'recall': 0.9589416, 'specificity': 0.9589416, 'f1': 0.97107613, 'auroc': 0.99660933, 'binary_precision': 0.9766191, 'binary_recall': 0.9202468, 'binary_specificity': 0.99763644, 'binary_f1_score': 0.9475953}
confusion matrix:
       0     1
0  42209   100
1    362  4177
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7527088, 'recall': 0.5870869, 'specificity': 0.5870869, 'f1': 0.6261459, 'auroc': 0.8254682, 'binary_precision': 0.5320197, 'binary_recall': 0.179402, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.26832297}
confusion matrix:
       0    1
0  18076   95
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7524669, 'recall': 0.5698128, 'specificity': 0.5698128, 'f1': 0.6042702, 'auroc': 0.7922847, 'binary_precision': 0.53846157, 'binary_recall': 0.1446281, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.22801302}
confusion matrix:
      0   1
0  5967  30
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_17.png
early stop counter: 9
val acc:0.9686251282691956, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 17,now: 2024-06-20 23:14:52.430092,epoch time: 0:18:53.789278,used: 6:11:38.616133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99067193, 'precision': 0.9882653, 'recall': 0.95795864, 'specificity': 0.95795864, 'f1': 0.9724986, 'auroc': 0.9958078, 'binary_precision': 0.9853289, 'binary_recall': 0.91738266, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.95014256}
confusion matrix:
       0     1
0  42247    62
1    375  4164
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.78640735, 'recall': 0.5779732, 'specificity': 0.5779732, 'f1': 0.6182363, 'auroc': 0.8214985, 'binary_precision': 0.6, 'binary_recall': 0.15946844, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.25196853}
confusion matrix:
       0   1
0  18107  64
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.77145267, 'recall': 0.5521349, 'specificity': 0.5521349, 'f1': 0.5809541, 'auroc': 0.7760737, 'binary_precision': 0.5777778, 'binary_recall': 0.10743801, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5978  19
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_18.png
early stop counter: 10
val acc:0.9696372747421265, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 18,now: 2024-06-20 23:33:27.249474,epoch time: 0:18:34.819382,used: 6:30:13.435515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9915471, 'precision': 0.9866879, 'recall': 0.9645326, 'specificity': 0.9645326, 'f1': 0.9752835, 'auroc': 0.9964365, 'binary_precision': 0.9807335, 'binary_recall': 0.9310269, 'binary_specificity': 0.9980383, 'binary_f1_score': 0.95523405}
confusion matrix:
       0     1
0  42227    83
1    313  4225
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7523257, 'recall': 0.5894961, 'specificity': 0.5894961, 'f1': 0.6288512, 'auroc': 0.82908744, 'binary_precision': 0.53110045, 'binary_recall': 0.18438539, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.27373615}
confusion matrix:
       0    1
0  18073   98
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73314697, 'recall': 0.5674132, 'specificity': 0.5674132, 'f1': 0.5997333, 'auroc': 0.79113835, 'binary_precision': 0.5, 'binary_recall': 0.14049587, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.21935482}
confusion matrix:
      0   1
0  5963  34
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_19.png
early stop counter: 11
val acc:0.9686251282691956, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 19,now: 2024-06-20 23:57:53.366428,epoch time: 0:24:26.116954,used: 6:54:39.552469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9916752, 'precision': 0.9883842, 'recall': 0.9636277, 'specificity': 0.9636277, 'f1': 0.97559863, 'auroc': 0.9958488, 'binary_precision': 0.98435676, 'binary_recall': 0.92883897, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9557923}
confusion matrix:
       0     1
0  42242    67
1    323  4216
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7456277, 'recall': 0.5796944, 'specificity': 0.5796944, 'f1': 0.61674774, 'auroc': 0.83107483, 'binary_precision': 0.5183246, 'binary_recall': 0.16445182, 'binary_specificity': 0.994937, 'binary_f1_score': 0.24968472}
confusion matrix:
       0   1
0  18079  92
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7739298, 'recall': 0.5641981, 'specificity': 0.5641981, 'f1': 0.59818006, 'auroc': 0.7806743, 'binary_precision': 0.58181816, 'binary_recall': 0.1322314, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2154882}
confusion matrix:
      0   1
0  5974  23
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_20.png
early stop counter: 12
val acc:0.9683055281639099, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 20,now: 2024-06-21 00:21:54.178859,epoch time: 0:24:00.812431,used: 7:18:40.364900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9908641, 'precision': 0.9876667, 'recall': 0.9596384, 'specificity': 0.9596384, 'f1': 0.9731282, 'auroc': 0.99580336, 'binary_precision': 0.9837609, 'binary_recall': 0.9209077, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.95129716}
confusion matrix:
       0     1
0  42240    69
1    359  4180
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76395655, 'recall': 0.5953926, 'specificity': 0.5953926, 'f1': 0.63690364, 'auroc': 0.8367928, 'binary_precision': 0.5539906, 'binary_recall': 0.19601329, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.28957054}
confusion matrix:
       0    1
0  18076   95
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.76275164, 'recall': 0.56601405, 'specificity': 0.56601405, 'f1': 0.59998524, 'auroc': 0.79280466, 'binary_precision': 0.55932206, 'binary_recall': 0.13636364, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.21926911}
confusion matrix:
      0   1
0  5971  26
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_21.png
early stop counter: 13
val acc:0.9691578149795532, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 21,now: 2024-06-21 00:45:18.331354,epoch time: 0:23:24.152495,used: 7:42:04.517395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991291, 'precision': 0.9846364, 'recall': 0.9650867, 'specificity': 0.9650867, 'f1': 0.97460645, 'auroc': 0.99641913, 'binary_precision': 0.9764706, 'binary_recall': 0.9325843, 'binary_specificity': 0.9975892, 'binary_f1_score': 0.954023}
confusion matrix:
       0     1
0  42207   102
1    306  4233
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7578249, 'recall': 0.5823512, 'specificity': 0.5823512, 'f1': 0.62114245, 'auroc': 0.83751786, 'binary_precision': 0.5425532, 'binary_recall': 0.16943522, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.25822785}
confusion matrix:
       0    1
0  18085   86
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.78102505, 'recall': 0.5622987, 'specificity': 0.5622987, 'f1': 0.5959215, 'auroc': 0.79490256, 'binary_precision': 0.59615386, 'binary_recall': 0.12809917, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5976  21
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_22.png
early stop counter: 14
val acc:0.9687849283218384, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 22,now: 2024-06-21 01:12:44.922246,epoch time: 0:27:26.590892,used: 8:09:31.108287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99201673, 'precision': 0.9878948, 'recall': 0.9660785, 'specificity': 0.9660785, 'f1': 0.97667074, 'auroc': 0.9959574, 'binary_precision': 0.98284256, 'binary_recall': 0.93390614, 'binary_specificity': 0.99825096, 'binary_f1_score': 0.9577496}
confusion matrix:
       0     1
0  42235    74
1    300  4239
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7511742, 'recall': 0.5798045, 'specificity': 0.5798045, 'f1': 0.617436, 'auroc': 0.8357965, 'binary_precision': 0.5294118, 'binary_recall': 0.16445182, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.25095055}
confusion matrix:
       0   1
0  18083  88
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.7160166, 'recall': 0.55518323, 'specificity': 0.55518323, 'f1': 0.58261335, 'auroc': 0.79426336, 'binary_precision': 0.46666667, 'binary_recall': 0.11570248, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18543047}
confusion matrix:
      0   1
0  5965  32
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_23.png
early stop counter: 15
val acc:0.9685186147689819, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 23,now: 2024-06-21 01:41:48.695886,epoch time: 0:29:03.773640,used: 8:38:34.881927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9913123, 'precision': 0.988767, 'recall': 0.9611566, 'specificity': 0.9611566, 'f1': 0.97445446, 'auroc': 0.9966209, 'binary_precision': 0.98565716, 'binary_recall': 0.92375493, 'binary_specificity': 0.9985583, 'binary_f1_score': 0.95370257}
confusion matrix:
       0     1
0  42249    61
1    346  4192
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.781011, 'recall': 0.56653786, 'specificity': 0.56653786, 'f1': 0.60282266, 'auroc': 0.8338111, 'binary_precision': 0.58992803, 'binary_recall': 0.13621262, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.22132254}
confusion matrix:
       0   1
0  18114  57
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7632059, 'recall': 0.53602284, 'specificity': 0.53602284, 'f1': 0.55594254, 'auroc': 0.7827459, 'binary_precision': 0.5625, 'binary_recall': 0.07438017, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.13138686}
confusion matrix:
      0   1
0  5983  14
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_24.png
early stop counter: 16
val acc:0.9692643880844116, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 24,now: 2024-06-21 02:09:56.910312,epoch time: 0:28:08.214426,used: 9:06:43.096353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99208075, 'precision': 0.9879358, 'recall': 0.966409, 'specificity': 0.966409, 'f1': 0.97686493, 'auroc': 0.9964874, 'binary_precision': 0.9828545, 'binary_recall': 0.9345671, 'binary_specificity': 0.99825096, 'binary_f1_score': 0.95810276}
confusion matrix:
       0     1
0  42235    74
1    297  4242
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7670864, 'recall': 0.58979875, 'specificity': 0.58979875, 'f1': 0.6308852, 'auroc': 0.84246016, 'binary_precision': 0.56060606, 'binary_recall': 0.18438539, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.27750003}
confusion matrix:
       0    1
0  18084   87
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7326945, 'recall': 0.5555167, 'specificity': 0.5555167, 'f1': 0.5840254, 'auroc': 0.79079556, 'binary_precision': 0.5, 'binary_recall': 0.11570248, 'binary_specificity': 0.995331, 'binary_f1_score': 0.18791945}
confusion matrix:
      0   1
0  5969  28
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_25.png
early stop counter: 17
val acc:0.9692111015319824, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 25,now: 2024-06-21 02:37:37.629226,epoch time: 0:27:40.718914,used: 9:34:23.815267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.98700774, 'recall': 0.9679432, 'specificity': 0.9679432, 'f1': 0.97723424, 'auroc': 0.9972322, 'binary_precision': 0.9806496, 'binary_recall': 0.93787175, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.95878375}
confusion matrix:
       0     1
0  42225    84
1    282  4257
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75140417, 'recall': 0.58705944, 'specificity': 0.58705944, 'f1': 0.62596565, 'auroc': 0.8440594, 'binary_precision': 0.5294118, 'binary_recall': 0.179402, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.26799008}
confusion matrix:
       0    1
0  18075   96
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.69077384, 'recall': 0.5487348, 'specificity': 0.5487348, 'f1': 0.57243323, 'auroc': 0.79182017, 'binary_precision': 0.41666666, 'binary_recall': 0.10330579, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.16556291}
confusion matrix:
      0   1
0  5962  35
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_26.png
early stop counter: 18
val acc:0.9685719013214111, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 26,now: 2024-06-21 03:04:55.982628,epoch time: 0:27:18.353402,used: 10:01:42.168669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928279, 'precision': 0.9900171, 'recall': 0.9686911, 'specificity': 0.9686911, 'f1': 0.97905385, 'auroc': 0.9979552, 'binary_precision': 0.98657095, 'binary_recall': 0.938753, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.96206814}
confusion matrix:
       0     1
0  42251    58
1    278  4261
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75591254, 'recall': 0.571829, 'specificity': 0.571829, 'f1': 0.60802925, 'auroc': 0.84288406, 'binary_precision': 0.53939396, 'binary_recall': 0.14784053, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.232073}
confusion matrix:
       0   1
0  18095  76
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.70935506, 'recall': 0.5393213, 'specificity': 0.5393213, 'f1': 0.5598415, 'auroc': 0.7927653, 'binary_precision': 0.45454547, 'binary_recall': 0.08264463, 'binary_specificity': 0.995998, 'binary_f1_score': 0.13986015}
confusion matrix:
      0   1
0  5973  24
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_27.png
early stop counter: 19
val acc:0.9686251282691956, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 27,now: 2024-06-21 03:31:29.325909,epoch time: 0:26:33.343281,used: 10:28:15.511950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99297726, 'precision': 0.98791575, 'recall': 0.9716256, 'specificity': 0.9716256, 'f1': 0.97959536, 'auroc': 0.9968436, 'binary_precision': 0.9816934, 'binary_recall': 0.9451421, 'binary_specificity': 0.99810916, 'binary_f1_score': 0.96307105}
confusion matrix:
       0     1
0  42229    80
1    249  4290
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7543255, 'recall': 0.58550835, 'specificity': 0.58550835, 'f1': 0.6244991, 'auroc': 0.8443732, 'binary_precision': 0.53535354, 'binary_recall': 0.17607974, 'binary_specificity': 0.994937, 'binary_f1_score': 0.265}
confusion matrix:
       0    1
0  18079   92
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.7146756, 'recall': 0.55121773, 'specificity': 0.55121773, 'f1': 0.5771498, 'auroc': 0.7903063, 'binary_precision': 0.4642857, 'binary_recall': 0.10743801, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.17449664}
confusion matrix:
      0   1
0  5967  30
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512112_28.png
early stop counter: 20
val acc:0.9686784148216248, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9650585055351257 / 0.9676229953765869
after epoch: 28,now: 2024-06-21 03:59:10.828469,epoch time: 0:27:41.502560,used: 10:55:57.014510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_03_13_seed_2_21512112
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 10:55:57.014510 at 2024-06-21 03:59:10.828469
persisted model performance metric: 

scalar performance:
{'acc': 0.9650585, 'precision': 0.83066607, 'recall': 0.5872589, 'specificity': 0.5872589, 'f1': 0.63249385, 'auroc': 0.76858675, 'binary_precision': 0.6935484, 'binary_recall': 0.17768595, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5978  19
1   199  43
oracle model performance metric: 

scalar performance:
{'acc': 0.967623, 'precision': 0.8908654, 'recall': 0.6064375, 'specificity': 0.6064375, 'f1': 0.6616369, 'auroc': 0.7758961, 'binary_precision': 0.8125, 'binary_recall': 0.21487603, 'binary_specificity': 0.997999, 'binary_f1_score': 0.33986926}
confusion matrix:
      0   1
0  5985  12
1   190  52
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1069 TiB |   1069 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   4292 MiB |   2490 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   4154 MiB |   2426 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB | 777256 GiB | 777256 GiB |
|       from large pool | 397312 KiB |    899 MiB | 776939 GiB | 776939 GiB |
|       from small pool |   6846 KiB |     14 MiB |    317 GiB |    317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   32863 K  |   32862 K  |
|       from large pool |      36    |      76    |   10412 K  |   10412 K  |
|       from small pool |    1158    |    1780    |   22451 K  |   22450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   32863 K  |   32862 K  |
|       from large pool |      36    |      76    |   10412 K  |   10412 K  |
|       from small pool |    1158    |    1780    |   22451 K  |   22450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |     380    |   16842 K  |   16842 K  |
|       from large pool |       5    |      11    |    4154 K  |    4154 K  |
|       from small pool |      24    |     375    |   12688 K  |   12688 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1069 TiB |   1069 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   4292 MiB |   3698 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   4154 MiB |   3602 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 777257 GiB | 777256 GiB |
|       from large pool | 384768 KiB |    899 MiB | 776939 GiB | 776939 GiB |
|       from small pool |      0 KiB |     14 MiB |    317 GiB |    317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   32863 K  |   32863 K  |
|       from large pool |       2    |      76    |   10412 K  |   10412 K  |
|       from small pool |       0    |    1780    |   22451 K  |   22451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   32863 K  |   32863 K  |
|       from large pool |       2    |      76    |   10412 K  |   10412 K  |
|       from small pool |       0    |    1780    |   22451 K  |   22451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   16842 K  |   16842 K  |
|       from large pool |       1    |      11    |    4154 K  |    4154 K  |
|       from small pool |       0    |     375    |   12688 K  |   12688 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 21 04:00:39 2024]
Finished job 0.
1 of 1 steps (100%) done
