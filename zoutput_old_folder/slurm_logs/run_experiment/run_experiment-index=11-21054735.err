Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun  2 01:59:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735

 Experiment start at: 2024-06-02 02:11:33.558230
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.73981714, 'recall': 0.506569, 'specificity': 0.506569, 'f1': 0.5046912, 'auroc': 0.88986915, 'binary_precision': 0.51282054, 'binary_recall': 0.013586956, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.026472535}
confusion matrix:
       0   1
0  42301  19
1   1452  20
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6998774, 'recall': 0.5096405, 'specificity': 0.5096405, 'f1': 0.51055217, 'auroc': 0.88219965, 'binary_precision': 0.43333334, 'binary_recall': 0.02021773, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.03863299}
confusion matrix:
       0   1
0  18132  17
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.8770075, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 02:38:44.944176,epoch time: 0:27:11.385946,used: 0:27:11.385946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.738954, 'recall': 0.657507, 'specificity': 0.657507, 'f1': 0.6889868, 'auroc': 0.91673386, 'binary_precision': 0.50104386, 'binary_recall': 0.32630864, 'binary_specificity': 0.9887054, 'binary_f1_score': 0.3952244}
confusion matrix:
       0    1
0  41843  478
1    991  480
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73868346, 'recall': 0.6710126, 'specificity': 0.6710126, 'f1': 0.6986495, 'auroc': 0.91320336, 'binary_precision': 0.5, 'binary_recall': 0.35458788, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.41492265}
confusion matrix:
       0    1
0  17921  228
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.91195846, 'recall': 0.7926013, 'specificity': 0.7926013, 'f1': 0.84121394, 'auroc': 0.9008585, 'binary_precision': 0.84153, 'binary_recall': 0.5900383, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.69369364}
confusion matrix:
      0    1
0  5968   29
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 03:04:08.361083,epoch time: 0:25:23.416907,used: 0:52:34.802853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.74528456, 'recall': 0.6704661, 'specificity': 0.6704661, 'f1': 0.7004413, 'auroc': 0.9270594, 'binary_precision': 0.5128459, 'binary_recall': 0.35258153, 'binary_specificity': 0.9883507, 'binary_f1_score': 0.41787443}
confusion matrix:
       0    1
0  41827  493
1    953  519
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74193275, 'recall': 0.69440204, 'specificity': 0.69440204, 'f1': 0.71529144, 'auroc': 0.9175415, 'binary_precision': 0.5048733, 'binary_recall': 0.40279937, 'binary_specificity': 0.9860047, 'binary_f1_score': 0.4480969}
confusion matrix:
       0    1
0  17895  254
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9040479, 'recall': 0.7960992, 'specificity': 0.7960992, 'f1': 0.8409481, 'auroc': 0.9092548, 'binary_precision': 0.82539684, 'binary_recall': 0.59770113, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6933333}
confusion matrix:
      0    1
0  5964   33
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_3.png
better model found
persisted
after epoch: 3,now: 2024-06-02 03:29:36.620325,epoch time: 0:25:28.259242,used: 1:18:03.062095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.7401167, 'recall': 0.7531676, 'specificity': 0.7531676, 'f1': 0.7464494, 'auroc': 0.93379307, 'binary_precision': 0.4967825, 'binary_recall': 0.52481306, 'binary_specificity': 0.9815222, 'binary_f1_score': 0.5104132}
confusion matrix:
       0    1
0  41539  782
1    699  772
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7395908, 'recall': 0.7735498, 'specificity': 0.7735498, 'f1': 0.7553103, 'auroc': 0.9289455, 'binary_precision': 0.49457994, 'binary_recall': 0.5676516, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.5286025}
confusion matrix:
       0    1
0  17776  373
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8683995, 'recall': 0.8304133, 'specificity': 0.8304133, 'f1': 0.84826195, 'auroc': 0.92057127, 'binary_precision': 0.75107294, 'binary_recall': 0.6704981, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.708502}
confusion matrix:
      0    1
0  5939   58
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_4.png
early stop counter: 1
val acc:0.9653576016426086, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9779482483863831 / 0.9782677888870239
after epoch: 4,now: 2024-06-02 03:54:57.796885,epoch time: 0:25:21.176560,used: 1:43:24.238655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9677567, 'precision': 0.75303304, 'recall': 0.6948015, 'specificity': 0.6948015, 'f1': 0.7197361, 'auroc': 0.9367339, 'binary_precision': 0.52669036, 'binary_recall': 0.4021739, 'binary_specificity': 0.9874291, 'binary_f1_score': 0.45608628}
confusion matrix:
       0    1
0  41788  532
1    880  592
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.750689, 'recall': 0.71514946, 'specificity': 0.71514946, 'f1': 0.7314145, 'auroc': 0.9270011, 'binary_precision': 0.52094716, 'binary_recall': 0.44479004, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.47986573}
confusion matrix:
       0    1
0  17886  263
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.9161155, 'recall': 0.7908523, 'specificity': 0.7908523, 'f1': 0.8413487, 'auroc': 0.9308516, 'binary_precision': 0.85, 'binary_recall': 0.5862069, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6938776}
confusion matrix:
      0    1
0  5970   27
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-02 04:20:23.964038,epoch time: 0:25:26.167153,used: 2:08:50.405808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7504869, 'recall': 0.7729293, 'specificity': 0.7729293, 'f1': 0.76117206, 'auroc': 0.9470284, 'binary_precision': 0.51616913, 'binary_recall': 0.564242, 'binary_specificity': 0.9816167, 'binary_f1_score': 0.53913605}
confusion matrix:
       0    1
0  41543  778
1    641  830
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.73657924, 'recall': 0.77852464, 'specificity': 0.77852464, 'f1': 0.75563353, 'auroc': 0.9379643, 'binary_precision': 0.48818898, 'binary_recall': 0.5785381, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.5295373}
confusion matrix:
       0    1
0  17759  390
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.8799988, 'recall': 0.8196694, 'specificity': 0.8196694, 'f1': 0.8469614, 'auroc': 0.93456614, 'binary_precision': 0.77522933, 'binary_recall': 0.6475096, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.70563674}
confusion matrix:
      0    1
0  5948   49
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_6.png
early stop counter: 1
val acc:0.964825451374054, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9784275889396667 / 0.9784275889396667
after epoch: 6,now: 2024-06-02 04:45:54.776858,epoch time: 0:25:30.812820,used: 2:34:21.218628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9681449, 'precision': 0.75449836, 'recall': 0.7782786, 'specificity': 0.7782786, 'f1': 0.76579773, 'auroc': 0.94871867, 'binary_precision': 0.523839, 'binary_recall': 0.57472825, 'binary_specificity': 0.9818289, 'binary_f1_score': 0.54810494}
confusion matrix:
       0    1
0  41551  769
1    626  846
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7401922, 'recall': 0.77957773, 'specificity': 0.77957773, 'f1': 0.75821114, 'auroc': 0.9432997, 'binary_precision': 0.49535194, 'binary_recall': 0.5800933, 'binary_specificity': 0.9790622, 'binary_f1_score': 0.53438395}
confusion matrix:
       0    1
0  17769  380
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.87534475, 'recall': 0.821335, 'specificity': 0.821335, 'f1': 0.8460249, 'auroc': 0.93865, 'binary_precision': 0.7657658, 'binary_recall': 0.651341, 'binary_specificity': 0.991329, 'binary_f1_score': 0.7039338}
confusion matrix:
      0    1
0  5945   52
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_7.png
early stop counter: 2
val acc:0.9654108285903931, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9784275889396667 / 0.9784275889396667
after epoch: 7,now: 2024-06-02 05:11:15.486028,epoch time: 0:25:20.709170,used: 2:59:41.927798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.75021785, 'recall': 0.7822218, 'specificity': 0.7822218, 'f1': 0.7651471, 'auroc': 0.9490025, 'binary_precision': 0.514988, 'binary_recall': 0.5835598, 'binary_specificity': 0.9808837, 'binary_f1_score': 0.54713374}
confusion matrix:
       0    1
0  41511  809
1    613  859
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7424228, 'recall': 0.81041265, 'specificity': 0.81041265, 'f1': 0.771719, 'auroc': 0.9359971, 'binary_precision': 0.49759614, 'binary_recall': 0.64385694, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.56135595}
confusion matrix:
       0    1
0  17731  418
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.8620566, 'recall': 0.8300798, 'specificity': 0.8300798, 'f1': 0.84524816, 'auroc': 0.9264282, 'binary_precision': 0.73839664, 'binary_recall': 0.6704981, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.70281124}
confusion matrix:
      0    1
0  5935   62
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_8.png
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9784275889396667 / 0.9784275889396667
after epoch: 8,now: 2024-06-02 05:36:33.227735,epoch time: 0:25:17.741707,used: 3:24:59.669505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96798503, 'precision': 0.7531775, 'recall': 0.7954403, 'specificity': 0.7954403, 'f1': 0.7724935, 'auroc': 0.95036083, 'binary_precision': 0.51997685, 'binary_recall': 0.61046904, 'binary_specificity': 0.9804116, 'binary_f1_score': 0.561601}
confusion matrix:
       0    1
0  41492  829
1    573  898
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.74919486, 'recall': 0.79079485, 'specificity': 0.79079485, 'f1': 0.7682019, 'auroc': 0.94403994, 'binary_precision': 0.5125828, 'binary_recall': 0.60186625, 'binary_specificity': 0.9797234, 'binary_f1_score': 0.55364805}
confusion matrix:
       0    1
0  17781  368
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.85808194, 'recall': 0.8317454, 'specificity': 0.8317454, 'f1': 0.8443549, 'auroc': 0.9394964, 'binary_precision': 0.7302905, 'binary_recall': 0.6743295, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.7011953}
confusion matrix:
      0    1
0  5932   65
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_9.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9784275889396667 / 0.9784275889396667
after epoch: 9,now: 2024-06-02 06:01:53.455978,epoch time: 0:25:20.228243,used: 3:50:19.897748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9694008, 'precision': 0.7641039, 'recall': 0.7717155, 'specificity': 0.7717155, 'f1': 0.7678498, 'auroc': 0.9555601, 'binary_precision': 0.54353565, 'binary_recall': 0.5597826, 'binary_specificity': 0.9836484, 'binary_f1_score': 0.55153954}
confusion matrix:
       0    1
0  41628  692
1    648  824
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7508219, 'recall': 0.77668154, 'specificity': 0.77668154, 'f1': 0.7630439, 'auroc': 0.9492923, 'binary_precision': 0.5168539, 'binary_recall': 0.57231724, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.54317343}
confusion matrix:
       0    1
0  17805  344
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.8860478, 'recall': 0.79160076, 'specificity': 0.79160076, 'f1': 0.83158326, 'auroc': 0.934339, 'binary_precision': 0.7897436, 'binary_recall': 0.5900383, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.6754386}
confusion matrix:
      0    1
0  5956   41
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 06:26:58.790288,epoch time: 0:25:05.334310,used: 4:15:25.232058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.7636455, 'recall': 0.809502, 'specificity': 0.809502, 'f1': 0.7845328, 'auroc': 0.9580648, 'binary_precision': 0.5399655, 'binary_recall': 0.6379076, 'binary_specificity': 0.9810964, 'binary_f1_score': 0.58486456}
confusion matrix:
       0    1
0  41520  800
1    533  939
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.74841166, 'recall': 0.8034631, 'specificity': 0.8034631, 'f1': 0.77286065, 'auroc': 0.9497374, 'binary_precision': 0.510101, 'binary_recall': 0.62830484, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.56306624}
confusion matrix:
       0    1
0  17761  388
1    239  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.87621456, 'recall': 0.7968477, 'specificity': 0.7968477, 'f1': 0.8313694, 'auroc': 0.94834375, 'binary_precision': 0.76960784, 'binary_recall': 0.6015326, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.67526877}
confusion matrix:
      0    1
0  5950   47
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_11.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9763502478599548 / 0.9784275889396667
after epoch: 11,now: 2024-06-02 06:52:18.934054,epoch time: 0:25:20.143766,used: 4:40:45.375824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.745433, 'recall': 0.8302487, 'specificity': 0.8302487, 'f1': 0.78083086, 'auroc': 0.9557253, 'binary_precision': 0.501994, 'binary_recall': 0.68410325, 'binary_specificity': 0.9763941, 'binary_f1_score': 0.5790684}
confusion matrix:
       0     1
0  41321   999
1    465  1007
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.74944043, 'recall': 0.82451975, 'specificity': 0.82451975, 'f1': 0.78146994, 'auroc': 0.9521891, 'binary_precision': 0.5106383, 'binary_recall': 0.6718507, 'binary_specificity': 0.9771888, 'binary_f1_score': 0.5802552}
confusion matrix:
       0    1
0  17735  414
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.82602274, 'recall': 0.80925524, 'specificity': 0.80925524, 'f1': 0.81739146, 'auroc': 0.93144083, 'binary_precision': 0.6680162, 'binary_recall': 0.6321839, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.6496063}
confusion matrix:
      0    1
0  5915   82
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_12.png
early stop counter: 2
val acc:0.966741144657135, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9763502478599548 / 0.9784275889396667
after epoch: 12,now: 2024-06-02 07:17:30.631195,epoch time: 0:25:11.697141,used: 5:05:57.072965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96882993, 'precision': 0.7592846, 'recall': 0.7848624, 'specificity': 0.7848624, 'f1': 0.7714051, 'auroc': 0.95615065, 'binary_precision': 0.53296363, 'binary_recall': 0.5876359, 'binary_specificity': 0.98208886, 'binary_f1_score': 0.5589661}
confusion matrix:
       0    1
0  41562  758
1    607  865
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7569425, 'recall': 0.7884007, 'specificity': 0.7884007, 'f1': 0.7716595, 'auroc': 0.9527193, 'binary_precision': 0.52827585, 'binary_recall': 0.5956454, 'binary_specificity': 0.981156, 'binary_f1_score': 0.5599415}
confusion matrix:
       0    1
0  17807  342
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8065245, 'recall': 0.6700774, 'specificity': 0.6700774, 'f1': 0.716684, 'auroc': 0.9274229, 'binary_precision': 0.64084506, 'binary_recall': 0.348659, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.4516129}
confusion matrix:
      0   1
0  5946  51
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_13.png
better model found
persisted
after epoch: 13,now: 2024-06-02 07:42:42.552195,epoch time: 0:25:11.921000,used: 5:31:08.993965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.74606264, 'recall': 0.8302125, 'specificity': 0.8302125, 'f1': 0.78124666, 'auroc': 0.95915985, 'binary_precision': 0.5032516, 'binary_recall': 0.6838885, 'binary_specificity': 0.97653645, 'binary_f1_score': 0.5798271}
confusion matrix:
       0     1
0  41328   993
1    465  1006
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7457156, 'recall': 0.8286619, 'specificity': 0.8286619, 'f1': 0.78045595, 'auroc': 0.95237696, 'binary_precision': 0.50287026, 'binary_recall': 0.68118197, 'binary_specificity': 0.9761419, 'binary_f1_score': 0.57859975}
confusion matrix:
       0    1
0  17716  433
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.8652116, 'recall': 0.7963474, 'specificity': 0.7963474, 'f1': 0.8268161, 'auroc': 0.93499625, 'binary_precision': 0.74761903, 'binary_recall': 0.6015326, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5944   53
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_14.png
early stop counter: 1
val acc:0.9660493731498718, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 14,now: 2024-06-02 08:08:02.813674,epoch time: 0:25:20.261479,used: 5:56:29.255444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.967848, 'precision': 0.75267184, 'recall': 0.83320534, 'specificity': 0.83320534, 'f1': 0.78674436, 'auroc': 0.9615873, 'binary_precision': 0.5162933, 'binary_recall': 0.6888587, 'binary_specificity': 0.977552, 'binary_f1_score': 0.59022117}
confusion matrix:
       0     1
0  41370   950
1    458  1014
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74776447, 'recall': 0.84007806, 'specificity': 0.84007806, 'f1': 0.7857718, 'auroc': 0.9590097, 'binary_precision': 0.50614524, 'binary_recall': 0.7045101, 'binary_specificity': 0.975646, 'binary_f1_score': 0.5890767}
confusion matrix:
       0    1
0  17707  442
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.837976, 'recall': 0.7349614, 'specificity': 0.7349614, 'f1': 0.7762241, 'auroc': 0.9423176, 'binary_precision': 0.698324, 'binary_recall': 0.4789272, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.5681818}
confusion matrix:
      0    1
0  5943   54
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_15.png
early stop counter: 2
val acc:0.9663686752319336, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 15,now: 2024-06-02 08:32:28.779640,epoch time: 0:24:25.965966,used: 6:20:55.221410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9648109, 'precision': 0.7371111, 'recall': 0.8457319, 'specificity': 0.8457319, 'f1': 0.7800125, 'auroc': 0.9651487, 'binary_precision': 0.48419607, 'binary_recall': 0.7180706, 'binary_specificity': 0.9733932, 'binary_f1_score': 0.5783858}
confusion matrix:
       0     1
0  41194  1126
1    415  1057
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.7376218, 'recall': 0.8375586, 'specificity': 0.8375586, 'f1': 0.77778995, 'auroc': 0.9537753, 'binary_precision': 0.4859914, 'binary_recall': 0.7013997, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.5741566}
confusion matrix:
       0    1
0  17672  477
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8112704, 'recall': 0.7952616, 'specificity': 0.7952616, 'f1': 0.80302894, 'auroc': 0.950584, 'binary_precision': 0.6396761, 'binary_recall': 0.60536397, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.62204725}
confusion matrix:
      0    1
0  5908   89
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_16.png
early stop counter: 3
val acc:0.9643997550010681, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 16,now: 2024-06-02 08:56:20.120269,epoch time: 0:23:51.340629,used: 6:44:46.562039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96828187, 'precision': 0.7551857, 'recall': 0.8226105, 'specificity': 0.8226105, 'f1': 0.7845034, 'auroc': 0.9639237, 'binary_precision': 0.5220862, 'binary_recall': 0.6664402, 'binary_specificity': 0.97878075, 'binary_f1_score': 0.58549684}
confusion matrix:
       0    1
0  41422  898
1    491  981
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7520338, 'recall': 0.80751646, 'specificity': 0.80751646, 'f1': 0.7766961, 'auroc': 0.9586192, 'binary_precision': 0.517067, 'binary_recall': 0.63608086, 'binary_specificity': 0.978952, 'binary_f1_score': 0.5704323}
confusion matrix:
       0    1
0  17767  382
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.82592905, 'recall': 0.69698066, 'specificity': 0.69698066, 'f1': 0.7438915, 'auroc': 0.9308388, 'binary_precision': 0.67741936, 'binary_recall': 0.40229884, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.50480765}
confusion matrix:
      0    1
0  5947   50
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_17.png
early stop counter: 4
val acc:0.9672200679779053, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 17,now: 2024-06-02 09:20:22.151847,epoch time: 0:24:02.031578,used: 7:08:48.593617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9686244, 'precision': 0.7573119, 'recall': 0.819837, 'specificity': 0.819837, 'f1': 0.7847948, 'auroc': 0.96552694, 'binary_precision': 0.52654386, 'binary_recall': 0.66032606, 'binary_specificity': 0.9793478, 'binary_f1_score': 0.5858951}
confusion matrix:
       0    1
0  41446  874
1    500  972
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7527102, 'recall': 0.81132185, 'specificity': 0.81132185, 'f1': 0.778607, 'auroc': 0.95713437, 'binary_precision': 0.5181477, 'binary_recall': 0.64385694, 'binary_specificity': 0.9787867, 'binary_f1_score': 0.5742025}
confusion matrix:
       0    1
0  17764  385
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.81804645, 'recall': 0.6667462, 'specificity': 0.6667462, 'f1': 0.71636504, 'auroc': 0.93871456, 'binary_precision': 0.6641791, 'binary_recall': 0.34099618, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.45063293}
confusion matrix:
      0   1
0  5952  45
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_18.png
early stop counter: 5
val acc:0.9673265218734741, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 18,now: 2024-06-02 09:45:13.238078,epoch time: 0:24:51.086231,used: 7:33:39.679848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.7478416, 'recall': 0.85328513, 'specificity': 0.85328513, 'f1': 0.79017913, 'auroc': 0.9642317, 'binary_precision': 0.5051643, 'binary_recall': 0.7314752, 'binary_specificity': 0.9750951, 'binary_f1_score': 0.5976117}
confusion matrix:
       0     1
0  41267  1054
1    395  1076
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.74224025, 'recall': 0.8335542, 'specificity': 0.8335542, 'f1': 0.7797427, 'auroc': 0.9565103, 'binary_precision': 0.49554566, 'binary_recall': 0.69206846, 'binary_specificity': 0.97503996, 'binary_f1_score': 0.5775471}
confusion matrix:
       0    1
0  17696  453
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7788598, 'recall': 0.73562455, 'specificity': 0.73562455, 'f1': 0.75519484, 'auroc': 0.9337362, 'binary_precision': 0.57990867, 'binary_recall': 0.48659003, 'binary_specificity': 0.984659, 'binary_f1_score': 0.52916664}
confusion matrix:
      0    1
0  5905   92
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_19.png
early stop counter: 6
val acc:0.9653576016426086, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 19,now: 2024-06-02 10:10:09.500844,epoch time: 0:24:56.262766,used: 7:58:35.942614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96924096, 'precision': 0.7608552, 'recall': 0.84015536, 'specificity': 0.84015536, 'f1': 0.79466474, 'auroc': 0.9651217, 'binary_precision': 0.5321999, 'binary_recall': 0.7017663, 'binary_specificity': 0.9785444, 'binary_f1_score': 0.60533255}
confusion matrix:
       0     1
0  41412   908
1    439  1033
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7544894, 'recall': 0.8467122, 'specificity': 0.8467122, 'f1': 0.7926645, 'auroc': 0.95928824, 'binary_precision': 0.5191441, 'binary_recall': 0.7169518, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.6022207}
confusion matrix:
       0    1
0  17722  427
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.818932, 'recall': 0.706059, 'specificity': 0.706059, 'f1': 0.7490497, 'auroc': 0.94146514, 'binary_precision': 0.6626506, 'binary_recall': 0.42145595, 'binary_specificity': 0.990662, 'binary_f1_score': 0.5152225}
confusion matrix:
      0    1
0  5941   56
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_20.png
early stop counter: 7
val acc:0.9675925970077515, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 20,now: 2024-06-02 10:34:12.332147,epoch time: 0:24:02.831303,used: 8:22:38.773917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9686244, 'precision': 0.7571843, 'recall': 0.84967214, 'specificity': 0.84967214, 'f1': 0.7955439, 'auroc': 0.9677963, 'binary_precision': 0.52416176, 'binary_recall': 0.72214675, 'binary_specificity': 0.9771975, 'binary_f1_score': 0.60742855}
confusion matrix:
       0     1
0  41355   965
1    409  1063
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7541542, 'recall': 0.84143424, 'specificity': 0.84143424, 'f1': 0.790621, 'auroc': 0.9559844, 'binary_precision': 0.5188571, 'binary_recall': 0.7060653, 'binary_specificity': 0.9768031, 'binary_f1_score': 0.59815544}
confusion matrix:
       0    1
0  17728  421
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.84144986, 'recall': 0.6881525, 'specificity': 0.6881525, 'f1': 0.74041873, 'auroc': 0.93928456, 'binary_precision': 0.7092199, 'binary_recall': 0.38314176, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.49751237}
confusion matrix:
      0    1
0  5956   41
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_21.png
early stop counter: 8
val acc:0.967539370059967, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 21,now: 2024-06-02 10:58:14.970408,epoch time: 0:24:02.638261,used: 8:46:41.412178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9688071, 'precision': 0.75819945, 'recall': 0.85829103, 'specificity': 0.85829103, 'f1': 0.79915285, 'auroc': 0.9671995, 'binary_precision': 0.52557915, 'binary_recall': 0.7398098, 'binary_specificity': 0.9767722, 'binary_f1_score': 0.6145598}
confusion matrix:
       0     1
0  41337   983
1    383  1089
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7446879, 'recall': 0.86741686, 'specificity': 0.86741686, 'f1': 0.7921709, 'auroc': 0.9565153, 'binary_precision': 0.49796748, 'binary_recall': 0.7620529, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.6023356}
confusion matrix:
       0    1
0  17655  494
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.8649584, 'recall': 0.745457, 'specificity': 0.745457, 'f1': 0.7923384, 'auroc': 0.9392806, 'binary_precision': 0.7514451, 'binary_recall': 0.49808428, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.59907836}
confusion matrix:
      0    1
0  5954   43
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_22.png
early stop counter: 9
val acc:0.9655704498291016, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 22,now: 2024-06-02 11:22:19.414653,epoch time: 0:24:04.444245,used: 9:10:45.856423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96912676, 'precision': 0.76025105, 'recall': 0.83419484, 'specificity': 0.83419484, 'f1': 0.79209, 'auroc': 0.96536744, 'binary_precision': 0.5314136, 'binary_recall': 0.68953806, 'binary_specificity': 0.9788516, 'binary_f1_score': 0.6002366}
confusion matrix:
       0     1
0  41425   895
1    457  1015
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.75228167, 'recall': 0.8330183, 'specificity': 0.8330183, 'f1': 0.78640395, 'auroc': 0.9562845, 'binary_precision': 0.51571596, 'binary_recall': 0.688958, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.5898801}
confusion matrix:
       0    1
0  17733  416
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.81449884, 'recall': 0.6684952, 'specificity': 0.6684952, 'f1': 0.7171357, 'auroc': 0.9388455, 'binary_precision': 0.6569343, 'binary_recall': 0.3448276, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.4522613}
confusion matrix:
      0   1
0  5950  47
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_23.png
early stop counter: 10
val acc:0.9672200679779053, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 23,now: 2024-06-02 11:46:12.350888,epoch time: 0:23:52.936235,used: 9:34:38.792658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9691496, 'precision': 0.7604154, 'recall': 0.83256733, 'specificity': 0.83256733, 'f1': 0.791593, 'auroc': 0.9635303, 'binary_precision': 0.53185886, 'binary_recall': 0.6861413, 'binary_specificity': 0.97899336, 'binary_f1_score': 0.5992287}
confusion matrix:
       0     1
0  41431   889
1    462  1010
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.75437003, 'recall': 0.8257106, 'specificity': 0.8257106, 'f1': 0.7851265, 'auroc': 0.95410657, 'binary_precision': 0.5204327, 'binary_recall': 0.6734059, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.5871186}
confusion matrix:
       0    1
0  17750  399
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.75170445, 'recall': 0.5922003, 'specificity': 0.5922003, 'f1': 0.63080055, 'auroc': 0.9005066, 'binary_precision': 0.53763443, 'binary_recall': 0.19157088, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.28248587}
confusion matrix:
      0   1
0  5954  43
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_24.png
early stop counter: 11
val acc:0.9675925970077515, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 24,now: 2024-06-02 12:09:58.223484,epoch time: 0:23:45.872596,used: 9:58:24.665254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9658613, 'precision': 0.7427826, 'recall': 0.8593035, 'specificity': 0.8593035, 'f1': 0.78835094, 'auroc': 0.9667475, 'binary_precision': 0.49458483, 'binary_recall': 0.74507135, 'binary_specificity': 0.9735356, 'binary_f1_score': 0.5945212}
confusion matrix:
       0     1
0  41201  1120
1    375  1096
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7499071, 'recall': 0.84702146, 'specificity': 0.84702146, 'f1': 0.7895848, 'auroc': 0.9603635, 'binary_precision': 0.50993377, 'binary_recall': 0.718507, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.59651387}
confusion matrix:
       0    1
0  17705  444
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7746438, 'recall': 0.67432374, 'specificity': 0.67432374, 'f1': 0.7119396, 'auroc': 0.9238278, 'binary_precision': 0.5766871, 'binary_recall': 0.36015326, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.4433962}
confusion matrix:
      0   1
0  5928  69
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_25.png
early stop counter: 12
val acc:0.966741144657135, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 25,now: 2024-06-02 12:33:12.193133,epoch time: 0:23:13.969649,used: 10:21:38.634903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9653133, 'precision': 0.74189293, 'recall': 0.89254785, 'specificity': 0.89254785, 'f1': 0.79702395, 'auroc': 0.96869504, 'binary_precision': 0.49038854, 'binary_recall': 0.81453806, 'binary_specificity': 0.97055763, 'binary_f1_score': 0.61220324}
confusion matrix:
       0     1
0  41074  1246
1    273  1199
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.736877, 'recall': 0.8933444, 'specificity': 0.8933444, 'f1': 0.79307806, 'auroc': 0.9627045, 'binary_precision': 0.4803653, 'binary_recall': 0.81804043, 'binary_specificity': 0.96864843, 'binary_f1_score': 0.60529345}
confusion matrix:
       0    1
0  17580  569
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74816155, 'recall': 0.7536124, 'specificity': 0.7536124, 'f1': 0.75085306, 'auroc': 0.9305956, 'binary_precision': 0.5168539, 'binary_recall': 0.52873564, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.5227273}
confusion matrix:
      0    1
0  5868  129
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_26.png
early stop counter: 13
val acc:0.9634950757026672, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 26,now: 2024-06-02 12:56:25.541998,epoch time: 0:23:13.348865,used: 10:44:51.983768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96444553, 'precision': 0.7356953, 'recall': 0.8511165, 'specificity': 0.8511165, 'f1': 0.78059727, 'auroc': 0.9674914, 'binary_precision': 0.4809673, 'binary_recall': 0.72961956, 'binary_specificity': 0.9726134, 'binary_f1_score': 0.57975703}
confusion matrix:
       0     1
0  41161  1159
1    398  1074
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7427548, 'recall': 0.84555507, 'specificity': 0.84555507, 'f1': 0.7840316, 'auroc': 0.95903563, 'binary_precision': 0.49569893, 'binary_recall': 0.7169518, 'binary_specificity': 0.97415835, 'binary_f1_score': 0.5861411}
confusion matrix:
       0    1
0  17680  469
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7274357, 'recall': 0.62792987, 'specificity': 0.62792987, 'f1': 0.66189903, 'auroc': 0.90966237, 'binary_precision': 0.4861111, 'binary_recall': 0.26819924, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.345679}
confusion matrix:
      0   1
0  5923  74
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_27.png
early stop counter: 14
val acc:0.9653576016426086, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 27,now: 2024-06-02 13:20:14.352196,epoch time: 0:23:48.810198,used: 11:08:40.793966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97045124, 'precision': 0.76750547, 'recall': 0.8643874, 'specificity': 0.8643874, 'f1': 0.80765885, 'auroc': 0.97085667, 'binary_precision': 0.5437992, 'binary_recall': 0.7506794, 'binary_specificity': 0.9780955, 'binary_f1_score': 0.63070774}
confusion matrix:
       0     1
0  41393   927
1    367  1105
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7533941, 'recall': 0.8720763, 'specificity': 0.8720763, 'f1': 0.800071, 'auroc': 0.96061844, 'binary_precision': 0.51508844, 'binary_recall': 0.7698289, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.617207}
confusion matrix:
       0    1
0  17683  466
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8112788, 'recall': 0.69639707, 'specificity': 0.69639707, 'f1': 0.7394202, 'auroc': 0.9179064, 'binary_precision': 0.6481481, 'binary_recall': 0.40229884, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.49645385}
confusion matrix:
      0    1
0  5940   57
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_28.png
early stop counter: 15
val acc:0.9673265218734741, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 28,now: 2024-06-02 13:43:43.210356,epoch time: 0:23:28.858160,used: 11:32:09.652126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9674826, 'precision': 0.751863, 'recall': 0.9001694, 'specificity': 0.9001694, 'f1': 0.80703986, 'auroc': 0.9727274, 'binary_precision': 0.50983673, 'binary_recall': 0.8280082, 'binary_specificity': 0.9723305, 'binary_f1_score': 0.6310881}
confusion matrix:
       0     1
0  41150  1171
1    253  1218
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7441527, 'recall': 0.8897532, 'specificity': 0.8897532, 'f1': 0.79805017, 'auroc': 0.9647615, 'binary_precision': 0.4952381, 'binary_recall': 0.8087092, 'binary_specificity': 0.9707973, 'binary_f1_score': 0.6142942}
confusion matrix:
       0    1
0  17619  530
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.80155146, 'recall': 0.75927997, 'specificity': 0.75927997, 'f1': 0.77862954, 'auroc': 0.94457126, 'binary_precision': 0.6233184, 'binary_recall': 0.532567, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.5743801}
confusion matrix:
      0    1
0  5913   84
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_29.png
early stop counter: 16
val acc:0.9652511477470398, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 29,now: 2024-06-02 14:07:12.683442,epoch time: 0:23:29.473086,used: 11:55:39.125212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96825904, 'precision': 0.7551677, 'recall': 0.87917197, 'specificity': 0.87917197, 'f1': 0.8035724, 'auroc': 0.97424036, 'binary_precision': 0.5179856, 'binary_recall': 0.78367347, 'binary_specificity': 0.9746704, 'binary_f1_score': 0.6237141}
confusion matrix:
       0     1
0  41250  1072
1    318  1152
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.750935, 'recall': 0.8688281, 'specificity': 0.8688281, 'f1': 0.7972612, 'auroc': 0.9653895, 'binary_precision': 0.510395, 'binary_recall': 0.7636081, 'binary_specificity': 0.97404814, 'binary_f1_score': 0.61183804}
confusion matrix:
       0    1
0  17678  471
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8230982, 'recall': 0.70997375, 'specificity': 0.70997375, 'f1': 0.75324416, 'auroc': 0.9254536, 'binary_precision': 0.6706587, 'binary_recall': 0.42911878, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5233645}
confusion matrix:
      0    1
0  5942   55
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_30.png
early stop counter: 17
val acc:0.9668475985527039, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9646852016448975 / 0.9784275889396667
after epoch: 30,now: 2024-06-02 14:30:34.612006,epoch time: 0:23:21.928564,used: 12:19:01.053776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_02_11_33_seed_0_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:19:01.053776 at 2024-06-02 14:30:34.612006
persisted model performance metric: 

scalar performance:
{'acc': 0.9701182, 'precision': 0.8611362, 'recall': 0.71139115, 'specificity': 0.71139115, 'f1': 0.764782, 'auroc': 0.9306812, 'binary_precision': 0.74666667, 'binary_recall': 0.42911878, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.5450122}
confusion matrix:
      0    1
0  5959   38
1   149  112
oracle model performance metric: 

scalar performance:
{'acc': 0.97762865, 'precision': 0.90132, 'recall': 0.79410017, 'specificity': 0.79410017, 'f1': 0.838643, 'auroc': 0.9202157, 'binary_precision': 0.8201058, 'binary_recall': 0.59386975, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6888889}
confusion matrix:
      0    1
0  5963   34
1   106  155
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 747940 KiB |   1325 MiB | 384640 GiB | 384640 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381642 GiB | 381641 GiB |
|       from small pool |   6436 KiB |      8 MiB |   2998 GiB |   2998 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2768    |   74931 K  |   74931 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      52    |    2748    |   40120 K  |   40120 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  11482 MiB |  11482 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384641 GiB | 384641 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     20 MiB |   2998 GiB |   2998 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     404    |     404    |     327    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   74932 K  |   74932 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2748    |   40122 K  |   40122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1212 MiB |  11482 MiB |  11482 MiB |  10270 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384641 GiB | 384641 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     20 MiB |   2998 GiB |   2998 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     404    |     404    |     327    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   74932 K  |   74932 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2748    |   40122 K  |   40122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735

 Experiment start at: 2024-06-02 14:41:04.504260
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.7996099, 'recall': 0.5180118, 'specificity': 0.5180118, 'f1': 0.5264933, 'auroc': 0.8941493, 'binary_precision': 0.63095236, 'binary_recall': 0.036754508, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.06946265}
confusion matrix:
       0   1
0  42383  31
1   1389  53
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7898705, 'recall': 0.53337276, 'specificity': 0.53337276, 'f1': 0.5525678, 'auroc': 0.8974913, 'binary_precision': 0.61333334, 'binary_recall': 0.068350665, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.12299465}
confusion matrix:
       0   1
0  18038  29
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9153745, 'recall': 0.53820926, 'specificity': 0.53820926, 'f1': 0.5606541, 'auroc': 0.87391067, 'binary_precision': 0.8695652, 'binary_recall': 0.07692308, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5943   3
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 15:05:47.241074,epoch time: 0:24:42.736814,used: 0:24:42.736814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.72891414, 'recall': 0.6122728, 'specificity': 0.6122728, 'f1': 0.64867, 'auroc': 0.9171177, 'binary_precision': 0.48345324, 'binary_recall': 0.23300971, 'binary_specificity': 0.99153584, 'binary_f1_score': 0.3144595}
confusion matrix:
       0    1
0  42055  359
1   1106  336
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7345863, 'recall': 0.67218566, 'specificity': 0.67218566, 'f1': 0.6980393, 'auroc': 0.90926117, 'binary_precision': 0.49284253, 'binary_recall': 0.35809806, 'binary_specificity': 0.9862733, 'binary_f1_score': 0.41480207}
confusion matrix:
       0    1
0  17819  248
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.87703854, 'recall': 0.6766598, 'specificity': 0.6766598, 'f1': 0.737363, 'auroc': 0.9079174, 'binary_precision': 0.7815126, 'binary_recall': 0.3576923, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.49076515}
confusion matrix:
      0   1
0  5920  26
1   167  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_2.png
new oracle model saved
early stop counter: 1
val acc:0.9637140035629272, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9689010381698608
after epoch: 2,now: 2024-06-02 15:29:14.856104,epoch time: 0:23:27.615030,used: 0:48:10.351844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.7380127, 'recall': 0.6674289, 'specificity': 0.6674289, 'f1': 0.695936, 'auroc': 0.9240514, 'binary_precision': 0.49800798, 'binary_recall': 0.34674063, 'binary_specificity': 0.98811716, 'binary_f1_score': 0.40883073}
confusion matrix:
       0    1
0  41910  504
1    942  500
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7396424, 'recall': 0.7331218, 'specificity': 0.7331218, 'f1': 0.73633164, 'auroc': 0.91311276, 'binary_precision': 0.49847096, 'binary_recall': 0.48439822, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.49133387}
confusion matrix:
       0    1
0  17739  328
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.8962788, 'recall': 0.75700855, 'specificity': 0.75700855, 'f1': 0.8103938, 'auroc': 0.9090799, 'binary_precision': 0.813253, 'binary_recall': 0.5192308, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.63380283}
confusion matrix:
      0    1
0  5915   31
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_3.png
new oracle model saved
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9748630523681641
after epoch: 3,now: 2024-06-02 15:53:49.656770,epoch time: 0:24:34.800666,used: 1:12:45.152510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.739058, 'recall': 0.69456, 'specificity': 0.69456, 'f1': 0.7142806, 'auroc': 0.9359509, 'binary_precision': 0.49828473, 'binary_recall': 0.40291262, 'binary_specificity': 0.98620737, 'binary_f1_score': 0.44555217}
confusion matrix:
       0    1
0  41829  585
1    861  581
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7445583, 'recall': 0.7848701, 'specificity': 0.7848701, 'f1': 0.76298445, 'auroc': 0.92791545, 'binary_precision': 0.504436, 'binary_recall': 0.59138185, 'binary_specificity': 0.9783583, 'binary_f1_score': 0.5444597}
confusion matrix:
       0    1
0  17676  391
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.8688452, 'recall': 0.7559995, 'specificity': 0.7559995, 'f1': 0.80120397, 'auroc': 0.9272853, 'binary_precision': 0.75842696, 'binary_recall': 0.5192308, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6164383}
confusion matrix:
      0    1
0  5903   43
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_4.png
early stop counter: 3
val acc:0.9644610285758972, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9748630523681641
after epoch: 4,now: 2024-06-02 16:20:56.346595,epoch time: 0:27:06.689825,used: 1:39:51.842335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96812296, 'precision': 0.74970543, 'recall': 0.69847536, 'specificity': 0.69847536, 'f1': 0.720859, 'auroc': 0.9411441, 'binary_precision': 0.5193322, 'binary_recall': 0.40984744, 'binary_specificity': 0.98710334, 'binary_f1_score': 0.45813954}
confusion matrix:
       0    1
0  41867  547
1    851  591
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74755704, 'recall': 0.7708415, 'specificity': 0.7708415, 'f1': 0.75861144, 'auroc': 0.9330128, 'binary_precision': 0.511502, 'binary_recall': 0.56166416, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.53541076}
confusion matrix:
       0    1
0  17706  361
1    295  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.8884361, 'recall': 0.7681266, 'specificity': 0.7681266, 'f1': 0.8161826, 'auroc': 0.93481153, 'binary_precision': 0.7966102, 'binary_recall': 0.5423077, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.6453089}
confusion matrix:
      0    1
0  5910   36
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_5.png
new oracle model saved
early stop counter: 4
val acc:0.9649946689605713, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9750241637229919
after epoch: 5,now: 2024-06-02 16:48:28.722008,epoch time: 0:27:32.375413,used: 2:07:24.217748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.968579, 'precision': 0.75334835, 'recall': 0.7305316, 'specificity': 0.7305316, 'f1': 0.74134505, 'auroc': 0.94641757, 'binary_precision': 0.52446485, 'binary_recall': 0.47572815, 'binary_specificity': 0.98533505, 'binary_f1_score': 0.4989091}
confusion matrix:
       0    1
0  41792  622
1    756  686
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7413953, 'recall': 0.77675307, 'specificity': 0.77675307, 'f1': 0.7577138, 'auroc': 0.9438237, 'binary_precision': 0.49871135, 'binary_recall': 0.5750371, 'binary_specificity': 0.978469, 'binary_f1_score': 0.53416145}
confusion matrix:
       0    1
0  17678  389
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.8694711, 'recall': 0.75223744, 'specificity': 0.75223744, 'f1': 0.7986919, 'auroc': 0.9304555, 'binary_precision': 0.76, 'binary_recall': 0.51153845, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.6114942}
confusion matrix:
      0    1
0  5904   42
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_6.png
early stop counter: 5
val acc:0.9639807939529419, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9750241637229919
after epoch: 6,now: 2024-06-02 17:14:43.464430,epoch time: 0:26:14.742422,used: 2:33:38.960170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96791774, 'precision': 0.74845445, 'recall': 0.798185, 'specificity': 0.798185, 'f1': 0.7707981, 'auroc': 0.94819975, 'binary_precision': 0.51004016, 'binary_recall': 0.61650485, 'binary_specificity': 0.97986513, 'binary_f1_score': 0.5582418}
confusion matrix:
       0    1
0  41560  854
1    553  889
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7457684, 'recall': 0.8049529, 'specificity': 0.8049529, 'f1': 0.77177113, 'auroc': 0.9487124, 'binary_precision': 0.5053381, 'binary_recall': 0.6329866, 'binary_specificity': 0.97691923, 'binary_f1_score': 0.5620052}
confusion matrix:
       0    1
0  17650  417
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.86355203, 'recall': 0.787935, 'specificity': 0.787935, 'f1': 0.82089055, 'auroc': 0.93453646, 'binary_precision': 0.74509805, 'binary_recall': 0.5846154, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.65517247}
confusion matrix:
      0    1
0  5894   52
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_7.png
early stop counter: 6
val acc:0.9645677804946899, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9750241637229919
after epoch: 7,now: 2024-06-02 17:40:28.729770,epoch time: 0:25:45.265340,used: 2:59:24.225510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9687158, 'precision': 0.7536849, 'recall': 0.79926753, 'specificity': 0.79926753, 'f1': 0.7743857, 'auroc': 0.95506084, 'binary_precision': 0.5204439, 'binary_recall': 0.6178918, 'binary_specificity': 0.9806432, 'binary_f1_score': 0.56499684}
confusion matrix:
       0    1
0  41593  821
1    551  891
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7463895, 'recall': 0.80572355, 'specificity': 0.80572355, 'f1': 0.7724587, 'auroc': 0.94971496, 'binary_precision': 0.5065243, 'binary_recall': 0.6344725, 'binary_specificity': 0.9769746, 'binary_f1_score': 0.5633246}
confusion matrix:
       0    1
0  17651  416
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.8694862, 'recall': 0.79955757, 'specificity': 0.79955757, 'f1': 0.8304815, 'auroc': 0.9390683, 'binary_precision': 0.75598085, 'binary_recall': 0.6076923, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.67377394}
confusion matrix:
      0    1
0  5895   51
1   102  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_8.png
new oracle model saved
early stop counter: 7
val acc:0.9646744728088379, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9608443379402161 / 0.9753464460372925
after epoch: 8,now: 2024-06-02 18:06:41.380334,epoch time: 0:26:12.650564,used: 3:25:36.876074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96855617, 'precision': 0.752735, 'recall': 0.7586558, 'specificity': 0.7586558, 'f1': 0.75565743, 'auroc': 0.9561758, 'binary_precision': 0.521327, 'binary_recall': 0.5339806, 'binary_specificity': 0.98333097, 'binary_f1_score': 0.52757794}
confusion matrix:
       0    1
0  41707  707
1    672  770
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7544037, 'recall': 0.76421463, 'specificity': 0.76421463, 'f1': 0.7592052, 'auroc': 0.95057863, 'binary_precision': 0.5257143, 'binary_recall': 0.5468053, 'binary_specificity': 0.98162395, 'binary_f1_score': 0.53605247}
confusion matrix:
       0    1
0  17735  332
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.84436625, 'recall': 0.7662766, 'specificity': 0.7662766, 'f1': 0.7997855, 'auroc': 0.93777007, 'binary_precision': 0.7085427, 'binary_recall': 0.5423077, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.61437905}
confusion matrix:
      0    1
0  5888   58
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 18:31:49.900573,epoch time: 0:25:08.520239,used: 3:50:45.396313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96898943, 'precision': 0.7554151, 'recall': 0.83323914, 'specificity': 0.83323914, 'f1': 0.7885908, 'auroc': 0.9616671, 'binary_precision': 0.52155626, 'binary_recall': 0.68793344, 'binary_specificity': 0.97854483, 'binary_f1_score': 0.5933015}
confusion matrix:
       0    1
0  41504  910
1    450  992
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7488737, 'recall': 0.808806, 'specificity': 0.808806, 'f1': 0.77520835, 'auroc': 0.9539779, 'binary_precision': 0.5112693, 'binary_recall': 0.640416, 'binary_specificity': 0.977196, 'binary_f1_score': 0.5686016}
confusion matrix:
       0    1
0  17655  412
1    242  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.83120763, 'recall': 0.79570043, 'specificity': 0.79570043, 'f1': 0.81233174, 'auroc': 0.9415988, 'binary_precision': 0.6796537, 'binary_recall': 0.60384613, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.6395112}
confusion matrix:
      0    1
0  5872   74
1   103  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_10.png
early stop counter: 1
val acc:0.9651013612747192, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 10,now: 2024-06-02 18:56:27.970729,epoch time: 0:24:38.070156,used: 4:15:23.466469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96805453, 'precision': 0.74977875, 'recall': 0.8257218, 'specificity': 0.8257218, 'f1': 0.7821549, 'auroc': 0.9604015, 'binary_precision': 0.5107838, 'binary_recall': 0.6733703, 'binary_specificity': 0.9780733, 'binary_f1_score': 0.5809154}
confusion matrix:
       0    1
0  41484  930
1    471  971
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.73699856, 'recall': 0.81691444, 'specificity': 0.81691444, 'f1': 0.7704173, 'auroc': 0.95208585, 'binary_precision': 0.4868421, 'binary_recall': 0.6597325, 'binary_specificity': 0.9740964, 'binary_f1_score': 0.56025237}
confusion matrix:
       0    1
0  17599  468
1    229  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.82974136, 'recall': 0.79561627, 'specificity': 0.79561627, 'f1': 0.81163925, 'auroc': 0.94169044, 'binary_precision': 0.67672414, 'binary_recall': 0.60384613, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.63821137}
confusion matrix:
      0    1
0  5871   75
1   103  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_11.png
early stop counter: 2
val acc:0.9628068208694458, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 11,now: 2024-06-02 19:21:06.964241,epoch time: 0:24:38.993512,used: 4:40:02.459981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9682826, 'precision': 0.7511766, 'recall': 0.8291892, 'specificity': 0.8291892, 'f1': 0.7843293, 'auroc': 0.957814, 'binary_precision': 0.5133438, 'binary_recall': 0.6803051, 'binary_specificity': 0.9780733, 'binary_f1_score': 0.5851477}
confusion matrix:
       0    1
0  41484  930
1    461  981
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7476316, 'recall': 0.8072648, 'specificity': 0.8072648, 'f1': 0.7738335, 'auroc': 0.95240366, 'binary_precision': 0.50889677, 'binary_recall': 0.63744426, 'binary_specificity': 0.9770853, 'binary_f1_score': 0.56596303}
confusion matrix:
       0    1
0  17653  414
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8243002, 'recall': 0.78591686, 'specificity': 0.78591686, 'f1': 0.80375993, 'auroc': 0.9421123, 'binary_precision': 0.6666667, 'binary_recall': 0.5846154, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.62295085}
confusion matrix:
      0    1
0  5870   76
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_12.png
early stop counter: 3
val acc:0.9648879170417786, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 12,now: 2024-06-02 19:46:00.276575,epoch time: 0:24:53.312334,used: 5:04:55.772315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96639, 'precision': 0.7405289, 'recall': 0.82921565, 'specificity': 0.82921565, 'f1': 0.77713466, 'auroc': 0.9582814, 'binary_precision': 0.492, 'binary_recall': 0.68238556, 'binary_specificity': 0.97604567, 'binary_f1_score': 0.57176065}
confusion matrix:
       0     1
0  41398  1016
1    458   984
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7371236, 'recall': 0.81906027, 'specificity': 0.81906027, 'f1': 0.7712449, 'auroc': 0.95373094, 'binary_precision': 0.4869281, 'binary_recall': 0.6641902, 'binary_specificity': 0.97393036, 'binary_f1_score': 0.56191075}
confusion matrix:
       0    1
0  17596  471
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.80328107, 'recall': 0.78089345, 'specificity': 0.78089345, 'f1': 0.7916051, 'auroc': 0.9444554, 'binary_precision': 0.625, 'binary_recall': 0.5769231, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.59999996}
confusion matrix:
      0    1
0  5856   90
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_13.png
early stop counter: 4
val acc:0.9628068208694458, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 13,now: 2024-06-02 20:10:44.388258,epoch time: 0:24:44.111683,used: 5:29:39.883998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.7462014, 'recall': 0.8461116, 'specificity': 0.8461116, 'f1': 0.786719, 'auroc': 0.9624056, 'binary_precision': 0.50218767, 'binary_recall': 0.7163662, 'binary_specificity': 0.975857, 'binary_f1_score': 0.59045446}
confusion matrix:
       0     1
0  41390  1024
1    409  1033
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7406595, 'recall': 0.82013535, 'specificity': 0.82013535, 'f1': 0.7740179, 'auroc': 0.95665467, 'binary_precision': 0.49393606, 'binary_recall': 0.66567606, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.5670886}
confusion matrix:
       0    1
0  17608  459
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.83646363, 'recall': 0.77530336, 'specificity': 0.77530336, 'f1': 0.80248356, 'auroc': 0.9431298, 'binary_precision': 0.6919431, 'binary_recall': 0.56153846, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.6199575}
confusion matrix:
      0    1
0  5881   65
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_14.png
early stop counter: 5
val acc:0.9635005593299866, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 14,now: 2024-06-02 20:35:58.717354,epoch time: 0:25:14.329096,used: 5:54:54.213094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9693087, 'precision': 0.7574159, 'recall': 0.82369053, 'specificity': 0.82369053, 'f1': 0.78634524, 'auroc': 0.9640843, 'binary_precision': 0.5262295, 'binary_recall': 0.6678225, 'binary_specificity': 0.97955865, 'binary_f1_score': 0.5886308}
confusion matrix:
       0    1
0  41547  867
1    479  963
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7538202, 'recall': 0.7956587, 'specificity': 0.7956587, 'f1': 0.7729491, 'auroc': 0.9585027, 'binary_precision': 0.52217996, 'binary_recall': 0.6121842, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.5636115}
confusion matrix:
       0    1
0  17690  377
1    261  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.86427927, 'recall': 0.7293287, 'specificity': 0.7293287, 'f1': 0.779947, 'auroc': 0.95193845, 'binary_precision': 0.7515528, 'binary_recall': 0.4653846, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.5748218}
confusion matrix:
      0    1
0  5906   40
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_15.png
early stop counter: 6
val acc:0.9659551978111267, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 15,now: 2024-06-02 20:59:30.086446,epoch time: 0:23:31.369092,used: 6:18:25.582186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96928585, 'precision': 0.7572237, 'recall': 0.8310477, 'specificity': 0.8310477, 'f1': 0.78897476, 'auroc': 0.9664863, 'binary_precision': 0.52533334, 'binary_recall': 0.68307906, 'binary_specificity': 0.97901636, 'binary_f1_score': 0.5939102}
confusion matrix:
       0    1
0  41524  890
1    457  985
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7493259, 'recall': 0.81670165, 'specificity': 0.81670165, 'f1': 0.77848935, 'auroc': 0.95952886, 'binary_precision': 0.5115741, 'binary_recall': 0.65676075, 'binary_specificity': 0.9766425, 'binary_f1_score': 0.5751464}
confusion matrix:
       0    1
0  17645  422
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.8556149, 'recall': 0.74412465, 'specificity': 0.74412465, 'f1': 0.7884401, 'auroc': 0.9480326, 'binary_precision': 0.73295456, 'binary_recall': 0.49615383, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.5917432}
confusion matrix:
      0    1
0  5899   47
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_16.png
early stop counter: 7
val acc:0.965154767036438, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 16,now: 2024-06-02 21:23:05.180380,epoch time: 0:23:35.093934,used: 6:42:00.676120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96675485, 'precision': 0.74352217, 'recall': 0.8541907, 'specificity': 0.8541907, 'f1': 0.7873625, 'auroc': 0.965055, 'binary_precision': 0.49624765, 'binary_recall': 0.7337032, 'binary_specificity': 0.97467816, 'binary_f1_score': 0.5920537}
confusion matrix:
       0     1
0  41340  1074
1    384  1058
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.74051887, 'recall': 0.83364236, 'specificity': 0.83364236, 'f1': 0.77851456, 'auroc': 0.957964, 'binary_precision': 0.49261603, 'binary_recall': 0.69390786, 'binary_specificity': 0.97337687, 'binary_f1_score': 0.5761875}
confusion matrix:
       0    1
0  17586  481
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.81657195, 'recall': 0.7873354, 'specificity': 0.7873354, 'f1': 0.80116105, 'auroc': 0.94807947, 'binary_precision': 0.65106386, 'binary_recall': 0.5884615, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.6181818}
confusion matrix:
      0    1
0  5864   82
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_17.png
early stop counter: 8
val acc:0.9633404612541199, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 17,now: 2024-06-02 21:45:52.772924,epoch time: 0:22:47.592544,used: 7:04:48.268664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96830535, 'precision': 0.7515099, 'recall': 0.842934, 'specificity': 0.842934, 'f1': 0.7893656, 'auroc': 0.96725255, 'binary_precision': 0.5130522, 'binary_recall': 0.70873785, 'binary_specificity': 0.9771302, 'binary_f1_score': 0.59522426}
confusion matrix:
       0     1
0  41444   970
1    420  1022
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7469243, 'recall': 0.8343066, 'specificity': 0.8343066, 'f1': 0.7831849, 'auroc': 0.9578388, 'binary_precision': 0.50541127, 'binary_recall': 0.69390786, 'binary_specificity': 0.9747053, 'binary_f1_score': 0.58484656}
confusion matrix:
       0    1
0  17610  457
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.81885624, 'recall': 0.7237167, 'specificity': 0.7237167, 'f1': 0.7620182, 'auroc': 0.95289075, 'binary_precision': 0.6611111, 'binary_recall': 0.4576923, 'binary_specificity': 0.989741, 'binary_f1_score': 0.54090905}
confusion matrix:
      0    1
0  5885   61
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_18.png
early stop counter: 9
val acc:0.9646211266517639, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 18,now: 2024-06-02 22:08:40.920263,epoch time: 0:22:48.147339,used: 7:27:36.416003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96835095, 'precision': 0.75270146, 'recall': 0.89588, 'specificity': 0.89588, 'f1': 0.80656916, 'auroc': 0.9675845, 'binary_precision': 0.51170856, 'binary_recall': 0.8183079, 'binary_specificity': 0.97345215, 'binary_f1_score': 0.6296692}
confusion matrix:
       0     1
0  41288  1126
1    262  1180
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7481225, 'recall': 0.880056, 'specificity': 0.880056, 'f1': 0.7983621, 'auroc': 0.9616831, 'binary_precision': 0.50427353, 'binary_recall': 0.78900445, 'binary_specificity': 0.97110754, 'binary_f1_score': 0.61529547}
confusion matrix:
       0    1
0  17545  522
1    142  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.8372278, 'recall': 0.811085, 'specificity': 0.811085, 'f1': 0.8235682, 'auroc': 0.9518484, 'binary_precision': 0.6903766, 'binary_recall': 0.63461536, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.66132265}
confusion matrix:
      0    1
0  5872   74
1    95  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_19.png
early stop counter: 10
val acc:0.9645677804946899, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 19,now: 2024-06-02 22:31:55.768198,epoch time: 0:23:14.847935,used: 7:50:51.263938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97047156, 'precision': 0.76447594, 'recall': 0.8400345, 'specificity': 0.8400345, 'f1': 0.7970037, 'auroc': 0.9706693, 'binary_precision': 0.53924185, 'binary_recall': 0.7004161, 'binary_specificity': 0.97965294, 'binary_f1_score': 0.60935146}
confusion matrix:
       0     1
0  41551   863
1    432  1010
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7539835, 'recall': 0.8378595, 'specificity': 0.8378595, 'f1': 0.78921545, 'auroc': 0.9597826, 'binary_precision': 0.5192944, 'binary_recall': 0.6998514, 'binary_specificity': 0.9758676, 'binary_f1_score': 0.5962025}
confusion matrix:
       0    1
0  17631  436
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8134103, 'recall': 0.67096364, 'specificity': 0.67096364, 'f1': 0.7190383, 'auroc': 0.95194566, 'binary_precision': 0.65467626, 'binary_recall': 0.35, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.45614037}
confusion matrix:
      0   1
0  5898  48
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_20.png
early stop counter: 11
val acc:0.9659551978111267, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 20,now: 2024-06-02 22:54:46.539521,epoch time: 0:22:50.771323,used: 8:13:42.035261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96919465, 'precision': 0.7566471, 'recall': 0.8366947, 'specificity': 0.8366947, 'f1': 0.7906511, 'auroc': 0.96970224, 'binary_precision': 0.52378464, 'binary_recall': 0.69486827, 'binary_specificity': 0.9785212, 'binary_f1_score': 0.5973174}
confusion matrix:
       0     1
0  41503   911
1    440  1002
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.74363995, 'recall': 0.8261342, 'specificity': 0.8261342, 'f1': 0.77812696, 'auroc': 0.95931756, 'binary_precision': 0.49945235, 'binary_recall': 0.67756313, 'binary_specificity': 0.9747053, 'binary_f1_score': 0.57503146}
confusion matrix:
       0    1
0  17610  457
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8281034, 'recall': 0.69780266, 'specificity': 0.69780266, 'f1': 0.7451218, 'auroc': 0.95140433, 'binary_precision': 0.6818182, 'binary_recall': 0.40384614, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.5072464}
confusion matrix:
      0    1
0  5897   49
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_21.png
early stop counter: 12
val acc:0.9640341401100159, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 21,now: 2024-06-02 23:17:26.696907,epoch time: 0:22:40.157386,used: 8:36:22.192647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9706312, 'precision': 0.7655735, 'recall': 0.8374374, 'specificity': 0.8374374, 'f1': 0.7967458, 'auroc': 0.9699712, 'binary_precision': 0.5416216, 'binary_recall': 0.69486827, 'binary_specificity': 0.9800066, 'binary_f1_score': 0.6087485}
confusion matrix:
       0     1
0  41566   848
1    440  1002
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7538632, 'recall': 0.8199778, 'specificity': 0.8199778, 'f1': 0.78262985, 'auroc': 0.9625968, 'binary_precision': 0.5204201, 'binary_recall': 0.6627043, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.58300656}
confusion matrix:
       0    1
0  17656  411
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7949097, 'recall': 0.6347616, 'specificity': 0.6347616, 'f1': 0.6818516, 'auroc': 0.9359497, 'binary_precision': 0.62068963, 'binary_recall': 0.2769231, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.38297874}
confusion matrix:
      0   1
0  5902  44
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_22.png
early stop counter: 13
val acc:0.9659551978111267, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9714792370796204 / 0.9753464460372925
after epoch: 22,now: 2024-06-02 23:40:05.782021,epoch time: 0:22:39.085114,used: 8:59:01.277761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.76285225, 'recall': 0.8643917, 'specificity': 0.8643917, 'f1': 0.80446017, 'auroc': 0.9714904, 'binary_precision': 0.5342871, 'binary_recall': 0.7510402, 'binary_specificity': 0.9777432, 'binary_f1_score': 0.62438744}
confusion matrix:
       0     1
0  41470   944
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.75490904, 'recall': 0.847241, 'specificity': 0.847241, 'f1': 0.79308414, 'auroc': 0.9619805, 'binary_precision': 0.5204301, 'binary_recall': 0.7191679, 'binary_specificity': 0.9753141, 'binary_f1_score': 0.6038677}
confusion matrix:
       0    1
0  17621  446
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.79278994, 'recall': 0.6664448, 'specificity': 0.6664448, 'f1': 0.7103003, 'auroc': 0.9453183, 'binary_precision': 0.6137931, 'binary_recall': 0.3423077, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.43950617}
confusion matrix:
      0   1
0  5890  56
1   171  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_23.png
better model found
persisted
after epoch: 23,now: 2024-06-03 00:03:18.899474,epoch time: 0:23:13.117453,used: 9:22:14.395214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9678037, 'precision': 0.7495892, 'recall': 0.87784463, 'specificity': 0.87784463, 'f1': 0.79901934, 'auroc': 0.9707037, 'binary_precision': 0.5067446, 'binary_recall': 0.7815534, 'binary_specificity': 0.9741359, 'binary_f1_score': 0.6148391}
confusion matrix:
       0     1
0  41317  1097
1    315  1127
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.74384874, 'recall': 0.85678, 'specificity': 0.85678, 'f1': 0.7882644, 'auroc': 0.9603289, 'binary_precision': 0.49750748, 'binary_recall': 0.74145615, 'binary_specificity': 0.97210383, 'binary_f1_score': 0.59546536}
confusion matrix:
       0    1
0  17563  504
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.78965354, 'recall': 0.71852505, 'specificity': 0.71852505, 'f1': 0.7485104, 'auroc': 0.94497675, 'binary_precision': 0.6030928, 'binary_recall': 0.45, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.5154185}
confusion matrix:
      0    1
0  5869   77
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_24.png
early stop counter: 1
val acc:0.9638206958770752, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 24,now: 2024-06-03 00:26:46.816262,epoch time: 0:23:27.916788,used: 9:45:42.312002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9688526, 'precision': 0.7547274, 'recall': 0.8559451, 'specificity': 0.8559451, 'f1': 0.79596424, 'auroc': 0.9694896, 'binary_precision': 0.518591, 'binary_recall': 0.73509014, 'binary_specificity': 0.9768001, 'binary_f1_score': 0.60814685}
confusion matrix:
       0     1
0  41430   984
1    382  1060
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7461952, 'recall': 0.84492487, 'specificity': 0.84492487, 'f1': 0.78622127, 'auroc': 0.959176, 'binary_precision': 0.5031315, 'binary_recall': 0.7161961, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.5910484}
confusion matrix:
       0    1
0  17591  476
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.82546616, 'recall': 0.725892, 'specificity': 0.725892, 'f1': 0.7657047, 'auroc': 0.94541514, 'binary_precision': 0.6741573, 'binary_recall': 0.46153846, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5479452}
confusion matrix:
      0    1
0  5888   58
1   140  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_25.png
early stop counter: 2
val acc:0.9644076824188232, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 25,now: 2024-06-03 00:50:16.903440,epoch time: 0:23:30.087178,used: 10:09:12.399180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9636766, 'precision': 0.73239005, 'recall': 0.9018372, 'specificity': 0.9018372, 'f1': 0.7915091, 'auroc': 0.97159815, 'binary_precision': 0.47051933, 'binary_recall': 0.83564496, 'binary_specificity': 0.96802944, 'binary_f1_score': 0.60204846}
confusion matrix:
       0     1
0  41058  1356
1    237  1205
---- Validation: 
scalar performance:
{'acc': 0.9609925, 'precision': 0.7346206, 'recall': 0.9010904, 'specificity': 0.9010904, 'f1': 0.79291695, 'auroc': 0.96243733, 'binary_precision': 0.47550675, 'binary_recall': 0.83655274, 'binary_specificity': 0.96562797, 'binary_f1_score': 0.6063543}
confusion matrix:
       0    1
0  17446  621
1    110  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7384719, 'recall': 0.76464593, 'specificity': 0.76464593, 'f1': 0.75077456, 'auroc': 0.93466324, 'binary_precision': 0.49655172, 'binary_recall': 0.5538462, 'binary_specificity': 0.9754457, 'binary_f1_score': 0.5236364}
confusion matrix:
      0    1
0  5800  146
1   116  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_26.png
early stop counter: 3
val acc:0.9609925150871277, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 26,now: 2024-06-03 01:13:55.654258,epoch time: 0:23:38.750818,used: 10:32:51.149998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.969263, 'precision': 0.7570664, 'recall': 0.8705603, 'specificity': 0.8705603, 'f1': 0.80234575, 'auroc': 0.971071, 'binary_precision': 0.5222538, 'binary_recall': 0.76490986, 'binary_specificity': 0.9762107, 'binary_f1_score': 0.62070906}
confusion matrix:
       0     1
0  41405  1009
1    339  1103
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7500283, 'recall': 0.87029135, 'specificity': 0.87029135, 'f1': 0.79694796, 'auroc': 0.9605293, 'binary_precision': 0.50885826, 'binary_recall': 0.76820207, 'binary_specificity': 0.9723806, 'binary_f1_score': 0.6121966}
confusion matrix:
       0    1
0  17568  499
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7860117, 'recall': 0.70715475, 'specificity': 0.70715475, 'f1': 0.7395191, 'auroc': 0.93493897, 'binary_precision': 0.5967742, 'binary_recall': 0.42692307, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.49775788}
confusion matrix:
      0    1
0  5871   75
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_27.png
early stop counter: 4
val acc:0.9650480151176453, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 27,now: 2024-06-03 01:37:27.717753,epoch time: 0:23:32.063495,used: 10:56:23.213493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.74908876, 'recall': 0.8918183, 'specificity': 0.8918183, 'f1': 0.8026127, 'auroc': 0.9739239, 'binary_precision': 0.5047496, 'binary_recall': 0.8106796, 'binary_specificity': 0.972957, 'binary_f1_score': 0.62213945}
confusion matrix:
       0     1
0  41267  1147
1    273  1169
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7472513, 'recall': 0.8949106, 'specificity': 0.8949106, 'f1': 0.80177903, 'auroc': 0.9621855, 'binary_precision': 0.5013624, 'binary_recall': 0.820208, 'binary_specificity': 0.96961313, 'binary_f1_score': 0.62232244}
confusion matrix:
       0    1
0  17518  549
1    121  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8024213, 'recall': 0.7733693, 'specificity': 0.7733693, 'f1': 0.787072, 'auroc': 0.94026494, 'binary_precision': 0.62393165, 'binary_recall': 0.56153846, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.5910931}
confusion matrix:
      0    1
0  5858   88
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_28.png
early stop counter: 5
val acc:0.9642475843429565, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 28,now: 2024-06-03 02:00:55.321434,epoch time: 0:23:27.603681,used: 11:19:50.817174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9615104, 'precision': 0.7247831, 'recall': 0.91009593, 'specificity': 0.91009593, 'f1': 0.7867216, 'auroc': 0.97062033, 'binary_precision': 0.45464602, 'binary_recall': 0.8550624, 'binary_specificity': 0.96512944, 'binary_f1_score': 0.5936447}
confusion matrix:
       0     1
0  40935  1479
1    209  1233
---- Validation: 
scalar performance:
{'acc': 0.9596585, 'precision': 0.7295865, 'recall': 0.8989679, 'specificity': 0.8989679, 'f1': 0.78810465, 'auroc': 0.95926595, 'binary_precision': 0.46556017, 'binary_recall': 0.833581, 'binary_specificity': 0.9643549, 'binary_f1_score': 0.59744406}
confusion matrix:
       0    1
0  17423  644
1    112  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.7656783, 'recall': 0.81506634, 'specificity': 0.81506634, 'f1': 0.787969, 'auroc': 0.9411136, 'binary_precision': 0.54662377, 'binary_recall': 0.65384614, 'binary_specificity': 0.9762866, 'binary_f1_score': 0.5954465}
confusion matrix:
      0    1
0  5805  141
1    90  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_29.png
early stop counter: 6
val acc:0.9596585035324097, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 29,now: 2024-06-03 02:24:22.048662,epoch time: 0:23:26.727228,used: 11:43:17.544402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9631065, 'precision': 0.73090875, 'recall': 0.91226095, 'specificity': 0.91226095, 'f1': 0.79262245, 'auroc': 0.9723772, 'binary_precision': 0.46679246, 'binary_recall': 0.85783637, 'binary_specificity': 0.96668553, 'binary_f1_score': 0.60459435}
confusion matrix:
       0     1
0  41001  1413
1    205  1237
---- Validation: 
scalar performance:
{'acc': 0.95987195, 'precision': 0.72974646, 'recall': 0.8912107, 'specificity': 0.8912107, 'f1': 0.7864227, 'auroc': 0.9619092, 'binary_precision': 0.46649703, 'binary_recall': 0.81723624, 'binary_specificity': 0.96518517, 'binary_f1_score': 0.5939525}
confusion matrix:
       0    1
0  17438  629
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.76596045, 'recall': 0.7873975, 'specificity': 0.7873975, 'f1': 0.7762053, 'auroc': 0.9360111, 'binary_precision': 0.54964536, 'binary_recall': 0.59615386, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.57195574}
confusion matrix:
      0    1
0  5819  127
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_30.png
early stop counter: 7
val acc:0.9598719477653503, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9634224772453308 / 0.9753464460372925
after epoch: 30,now: 2024-06-03 02:47:51.902289,epoch time: 0:23:29.853627,used: 12:06:47.398029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_14_41_04_seed_1_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:06:47.398029 at 2024-06-03 02:47:51.902289
persisted model performance metric: 

scalar performance:
{'acc': 0.96406704, 'precision': 0.80514085, 'recall': 0.6594252, 'specificity': 0.6594252, 'f1': 0.707008, 'auroc': 0.93959934, 'binary_precision': 0.63909775, 'binary_recall': 0.32692307, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.43256998}
confusion matrix:
      0   1
0  5898  48
1   175  85
oracle model performance metric: 

scalar performance:
{'acc': 0.97502416, 'precision': 0.8637472, 'recall': 0.8030673, 'specificity': 0.8030673, 'f1': 0.8303497, 'auroc': 0.93496275, 'binary_precision': 0.74418604, 'binary_recall': 0.61538464, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.6736842}
confusion matrix:
      0    1
0  5891   55
1   100  160
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21730 MiB |  10270 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |  10544 KiB |     20 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279923 K  |  279920 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166136 K  |  166132 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279923 K  |  279920 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166136 K  |  166132 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     726    |     327    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    2772    |  150146 K  |  150145 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      55    |    2751    |   80208 K  |   80208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     28 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     726    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150147 K  |  150147 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80209 K  |   80209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21730 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    156 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     28 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     726    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      78    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150147 K  |  150147 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80209 K  |   80209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735

 Experiment start at: 2024-06-03 02:54:26.325715
before training, model accuracy: 0.172542005777359
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9714182, 'precision': 0.8956344, 'recall': 0.95978224, 'specificity': 0.95978224, 'f1': 0.9245118, 'auroc': 0.9888319, 'binary_precision': 0.79724956, 'binary_recall': 0.94535035, 'binary_specificity': 0.97421414, 'binary_f1_score': 0.8650065}
confusion matrix:
       0     1
0  41219  1091
1    248  4290
---- Validation: 
scalar performance:
{'acc': 0.9279284, 'precision': 0.58002526, 'recall': 0.65199065, 'specificity': 0.65199065, 'f1': 0.6016671, 'auroc': 0.7294142, 'binary_precision': 0.18204911, 'binary_recall': 0.35714287, 'binary_specificity': 0.9468384, 'binary_f1_score': 0.24116659}
confusion matrix:
       0    1
0  17205  966
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98705935, 'precision': 0.96158576, 'recall': 0.9721651, 'specificity': 0.9721651, 'f1': 0.9667957, 'auroc': 0.99036646, 'binary_precision': 0.92885906, 'binary_recall': 0.95316803, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.9408565}
confusion matrix:
      0    1
0  5944   53
1    34  692
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 03:13:01.902641,epoch time: 0:18:35.576926,used: 0:18:35.576926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8094689, 'precision': 0.66664827, 'recall': 0.88763046, 'specificity': 0.88763046, 'f1': 0.6913141, 'auroc': 0.9768466, 'binary_precision': 0.3353846, 'binary_recall': 0.9845781, 'binary_specificity': 0.79068285, 'binary_f1_score': 0.5003358}
confusion matrix:
       0     1
0  33453  8856
1     70  4469
---- Validation: 
scalar performance:
{'acc': 0.63047993, 'precision': 0.5080255, 'recall': 0.5601739, 'specificity': 0.5601739, 'f1': 0.42330423, 'auroc': 0.5984386, 'binary_precision': 0.04220263, 'binary_recall': 0.48504984, 'binary_specificity': 0.635298, 'binary_f1_score': 0.07764924}
confusion matrix:
       0     1
0  11544  6627
1    310   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8932024, 'precision': 0.751107, 'recall': 0.93832076, 'specificity': 0.93832076, 'f1': 0.8022829, 'auroc': 0.9915196, 'binary_precision': 0.5027816, 'binary_recall': 0.9958678, 'binary_specificity': 0.8807737, 'binary_f1_score': 0.66820705}
confusion matrix:
      0    1
0  5282  715
1     3  723
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_2.png
early stop counter: 1
val acc:0.6304799318313599, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 2,now: 2024-06-03 03:30:51.262966,epoch time: 0:17:49.360325,used: 0:36:24.937251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7705345, 'precision': 0.6465727, 'recall': 0.86666477, 'specificity': 0.86666477, 'f1': 0.6545183, 'auroc': 0.97288835, 'binary_precision': 0.29516524, 'binary_recall': 0.9859, 'binary_specificity': 0.7474296, 'binary_f1_score': 0.45431474}
confusion matrix:
       0      1
0  31623  10686
1     64   4475
---- Validation: 
scalar performance:
{'acc': 0.62771, 'precision': 0.5049435, 'recall': 0.53706074, 'specificity': 0.53706074, 'f1': 0.41886544, 'auroc': 0.56708217, 'binary_precision': 0.038311407, 'binary_recall': 0.44019935, 'binary_specificity': 0.63392216, 'binary_f1_score': 0.070488095}
confusion matrix:
       0     1
0  11519  6652
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78625613, 'precision': 0.66745114, 'recall': 0.87897944, 'specificity': 0.87897944, 'f1': 0.68291986, 'auroc': 0.9895379, 'binary_precision': 0.33534044, 'binary_recall': 0.9972452, 'binary_specificity': 0.7607137, 'binary_f1_score': 0.5019064}
confusion matrix:
      0     1
0  4562  1435
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_3.png
early stop counter: 2
val acc:0.6277099847793579, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 3,now: 2024-06-03 03:48:53.052651,epoch time: 0:18:01.789685,used: 0:54:26.726936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.832757, 'precision': 0.68072, 'recall': 0.8969835, 'specificity': 0.8969835, 'f1': 0.71455324, 'auroc': 0.9817525, 'binary_precision': 0.36449596, 'binary_recall': 0.97664684, 'binary_specificity': 0.81732017, 'binary_f1_score': 0.5308664}
confusion matrix:
       0     1
0  34580  7729
1    106  4433
---- Validation: 
scalar performance:
{'acc': 0.71869177, 'precision': 0.51118904, 'recall': 0.572013, 'specificity': 0.572013, 'f1': 0.46011904, 'auroc': 0.5544024, 'binary_precision': 0.04827187, 'binary_recall': 0.4152824, 'binary_specificity': 0.7287436, 'binary_f1_score': 0.08649023}
confusion matrix:
       0     1
0  13242  4929
1    352   250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88531905, 'precision': 0.7416407, 'recall': 0.9308752, 'specificity': 0.9308752, 'f1': 0.7910283, 'auroc': 0.9946525, 'binary_precision': 0.48480755, 'binary_recall': 0.9889807, 'binary_specificity': 0.8727697, 'binary_f1_score': 0.650657}
confusion matrix:
      0    1
0  5234  763
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_4.png
early stop counter: 3
val acc:0.7186917662620544, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 4,now: 2024-06-03 04:06:36.250123,epoch time: 0:17:43.197472,used: 1:12:09.924408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6645748, 'precision': 0.61056614, 'recall': 0.80977124, 'specificity': 0.80977124, 'f1': 0.56802666, 'auroc': 0.9519787, 'binary_precision': 0.22285601, 'binary_recall': 0.9898656, 'binary_specificity': 0.6296769, 'binary_f1_score': 0.36380568}
confusion matrix:
       0      1
0  26641  15668
1     46   4493
---- Validation: 
scalar performance:
{'acc': 0.4362116, 'precision': 0.49351823, 'recall': 0.448579, 'specificity': 0.448579, 'f1': 0.32454613, 'auroc': 0.517818, 'binary_precision': 0.026380718, 'binary_recall': 0.46179402, 'binary_specificity': 0.43536404, 'binary_f1_score': 0.049910232}
confusion matrix:
      0      1
0  7911  10260
1   324    278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5897665, 'precision': 0.6039525, 'recall': 0.7694464, 'specificity': 0.7694464, 'f1': 0.52301615, 'auroc': 0.964063, 'binary_precision': 0.20821367, 'binary_recall': 0.9986226, 'binary_specificity': 0.54027015, 'binary_f1_score': 0.34458178}
confusion matrix:
      0     1
0  3240  2757
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_5.png
early stop counter: 4
val acc:0.43621158599853516, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 5,now: 2024-06-03 04:24:25.657924,epoch time: 0:17:49.407801,used: 1:29:59.332209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6818861, 'precision': 0.61411095, 'recall': 0.8158153, 'specificity': 0.8158153, 'f1': 0.5805009, 'auroc': 0.9663327, 'binary_precision': 0.23119618, 'binary_recall': 0.98193437, 'binary_specificity': 0.6496963, 'binary_f1_score': 0.37427047}
confusion matrix:
       0      1
0  27488  14821
1     82   4457
---- Validation: 
scalar performance:
{'acc': 0.558941, 'precision': 0.5012062, 'recall': 0.5095676, 'specificity': 0.5095676, 'f1': 0.3869733, 'auroc': 0.5443685, 'binary_precision': 0.03342246, 'binary_recall': 0.45681062, 'binary_specificity': 0.5623246, 'binary_f1_score': 0.062287655}
confusion matrix:
       0     1
0  10218  7953
1    327   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65640336, 'precision': 0.6193437, 'recall': 0.80679834, 'specificity': 0.80679834, 'f1': 0.5735749, 'auroc': 0.9875319, 'binary_precision': 0.23895848, 'binary_recall': 0.9986226, 'binary_specificity': 0.61497414, 'binary_f1_score': 0.38563833}
confusion matrix:
      0     1
0  3688  2309
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_6.png
early stop counter: 5
val acc:0.5589410066604614, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 6,now: 2024-06-03 04:41:51.948485,epoch time: 0:17:26.290561,used: 1:47:25.622770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6302937, 'precision': 0.6008229, 'recall': 0.7864649, 'specificity': 0.7864649, 'f1': 0.5413544, 'auroc': 0.9424517, 'binary_precision': 0.20522164, 'binary_recall': 0.98017186, 'binary_specificity': 0.59275806, 'binary_f1_score': 0.33938515}
confusion matrix:
       0      1
0  25079  17230
1     90   4449
---- Validation: 
scalar performance:
{'acc': 0.41565013, 'precision': 0.4922885, 'recall': 0.4395638, 'specificity': 0.4395638, 'f1': 0.3134527, 'auroc': 0.51230705, 'binary_precision': 0.025622254, 'binary_recall': 0.4651163, 'binary_specificity': 0.41401133, 'binary_f1_score': 0.04856895}
confusion matrix:
      0      1
0  7523  10648
1   322    280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6140116, 'precision': 0.60907274, 'recall': 0.7830365, 'specificity': 0.7830365, 'f1': 0.54121643, 'auroc': 0.9805629, 'binary_precision': 0.2184393, 'binary_recall': 0.9986226, 'binary_specificity': 0.5674504, 'binary_f1_score': 0.35846725}
confusion matrix:
      0     1
0  3403  2594
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_7.png
early stop counter: 6
val acc:0.4156501293182373, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 7,now: 2024-06-03 04:59:02.840192,epoch time: 0:17:10.891707,used: 2:04:36.514477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6127476, 'precision': 0.5979613, 'recall': 0.7795042, 'specificity': 0.7795042, 'f1': 0.52902615, 'auroc': 0.9292777, 'binary_precision': 0.19847497, 'binary_recall': 0.9863406, 'binary_specificity': 0.5726678, 'binary_f1_score': 0.33045468}
confusion matrix:
       0      1
0  24229  18080
1     62   4477
---- Validation: 
scalar performance:
{'acc': 0.38544717, 'precision': 0.49016178, 'recall': 0.42476508, 'specificity': 0.42476508, 'f1': 0.29653823, 'auroc': 0.5151675, 'binary_precision': 0.024441158, 'binary_recall': 0.4667774, 'binary_specificity': 0.38275275, 'binary_f1_score': 0.04645012}
confusion matrix:
      0      1
0  6955  11216
1   321    281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55451435, 'precision': 0.5970577, 'recall': 0.74908113, 'specificity': 0.74908113, 'f1': 0.49661955, 'auroc': 0.9597263, 'binary_precision': 0.19478074, 'binary_recall': 0.9972452, 'binary_specificity': 0.50091714, 'binary_f1_score': 0.32590592}
confusion matrix:
      0     1
0  3004  2993
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_8.png
early stop counter: 7
val acc:0.3854471743106842, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 8,now: 2024-06-03 05:16:28.650699,epoch time: 0:17:25.810507,used: 2:22:02.324984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7200734, 'precision': 0.6261812, 'recall': 0.8374491, 'specificity': 0.8374491, 'f1': 0.61096436, 'auroc': 0.9708606, 'binary_precision': 0.254986, 'binary_recall': 0.9830359, 'binary_specificity': 0.6918622, 'binary_f1_score': 0.40493694}
confusion matrix:
       0      1
0  29272  13037
1     77   4462
---- Validation: 
scalar performance:
{'acc': 0.5963352, 'precision': 0.5039396, 'recall': 0.53049016, 'specificity': 0.53049016, 'f1': 0.40524673, 'auroc': 0.5652406, 'binary_precision': 0.036786187, 'binary_recall': 0.4601329, 'binary_specificity': 0.6008475, 'binary_f1_score': 0.06812592}
confusion matrix:
       0     1
0  10918  7253
1    325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921017, 'precision': 0.62961507, 'recall': 0.8268084, 'specificity': 0.8268084, 'f1': 0.60169435, 'auroc': 0.98813105, 'binary_precision': 0.25948462, 'binary_recall': 0.9986226, 'binary_specificity': 0.6549942, 'binary_f1_score': 0.41193184}
confusion matrix:
      0     1
0  3928  2069
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_9.png
early stop counter: 8
val acc:0.5963351726531982, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 9,now: 2024-06-03 05:34:06.176908,epoch time: 0:17:37.526209,used: 2:39:39.851193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.69983774, 'precision': 0.6194595, 'recall': 0.82585245, 'specificity': 0.82585245, 'f1': 0.59458864, 'auroc': 0.9609012, 'binary_precision': 0.24177016, 'binary_recall': 0.98215467, 'binary_specificity': 0.66955024, 'binary_f1_score': 0.38802332}
confusion matrix:
       0      1
0  28328  13981
1     81   4458
---- Validation: 
scalar performance:
{'acc': 0.48100996, 'precision': 0.49648505, 'recall': 0.47172028, 'specificity': 0.47172028, 'f1': 0.34820262, 'auroc': 0.5265938, 'binary_precision': 0.02866866, 'binary_recall': 0.46179402, 'binary_specificity': 0.48164657, 'binary_f1_score': 0.053985823}
confusion matrix:
      0     1
0  8752  9419
1   324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6953741, 'precision': 0.63043296, 'recall': 0.82803726, 'specificity': 0.82803726, 'f1': 0.60417926, 'auroc': 0.98726696, 'binary_precision': 0.26137185, 'binary_recall': 0.9972452, 'binary_specificity': 0.6588294, 'binary_f1_score': 0.41418767}
confusion matrix:
      0     1
0  3951  2046
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_10.png
early stop counter: 9
val acc:0.48100996017456055, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 10,now: 2024-06-03 05:51:31.653158,epoch time: 0:17:25.476250,used: 2:57:05.327443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.64491546, 'precision': 0.6040866, 'recall': 0.7941668, 'specificity': 0.7941668, 'f1': 0.5521337, 'auroc': 0.95615196, 'binary_precision': 0.21180788, 'binary_recall': 0.9792906, 'binary_specificity': 0.609043, 'binary_f1_score': 0.348286}
confusion matrix:
       0      1
0  25768  16541
1     94   4445
---- Validation: 
scalar performance:
{'acc': 0.43754327, 'precision': 0.49360913, 'recall': 0.44926694, 'specificity': 0.44926694, 'f1': 0.32526475, 'auroc': 0.51640594, 'binary_precision': 0.026443452, 'binary_recall': 0.46179402, 'binary_specificity': 0.43673986, 'binary_f1_score': 0.050022494}
confusion matrix:
      0      1
0  7936  10235
1   324    278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6150528, 'precision': 0.6093039, 'recall': 0.7836201, 'specificity': 0.7836201, 'f1': 0.54200184, 'auroc': 0.9883384, 'binary_precision': 0.21890096, 'binary_recall': 0.9986226, 'binary_specificity': 0.56861764, 'binary_f1_score': 0.35908866}
confusion matrix:
      0     1
0  3410  2587
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_11.png
early stop counter: 10
val acc:0.43754327297210693, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 11,now: 2024-06-03 06:08:57.146830,epoch time: 0:17:25.493672,used: 3:14:30.821115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.6688866, 'precision': 0.61069894, 'recall': 0.8091099, 'specificity': 0.8091099, 'f1': 0.5706156, 'auroc': 0.95739764, 'binary_precision': 0.2242549, 'binary_recall': 0.9830359, 'binary_specificity': 0.635184, 'binary_f1_score': 0.36519885}
confusion matrix:
       0      1
0  26874  15435
1     77   4462
---- Validation: 
scalar performance:
{'acc': 0.48612368, 'precision': 0.4974136, 'recall': 0.47918016, 'specificity': 0.47918016, 'f1': 0.35131767, 'auroc': 0.5546273, 'binary_precision': 0.029543327, 'binary_recall': 0.4717608, 'binary_specificity': 0.48659953, 'binary_f1_score': 0.055604503}
confusion matrix:
      0     1
0  8842  9329
1   318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7040012, 'precision': 0.633442, 'recall': 0.8334784, 'specificity': 0.8334784, 'f1': 0.6113155, 'auroc': 0.99129754, 'binary_precision': 0.26713338, 'binary_recall': 0.9986226, 'binary_specificity': 0.6683342, 'binary_f1_score': 0.42151165}
confusion matrix:
      0     1
0  4008  1989
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_12.png
early stop counter: 11
val acc:0.4861236810684204, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 12,now: 2024-06-03 06:26:22.251439,epoch time: 0:17:25.104609,used: 3:31:55.925724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.5977416, 'precision': 0.59478676, 'recall': 0.77080286, 'specificity': 0.77080286, 'f1': 0.51798046, 'auroc': 0.91817975, 'binary_precision': 0.19237055, 'binary_recall': 0.9854593, 'binary_specificity': 0.55614644, 'binary_f1_score': 0.32190278}
confusion matrix:
       0      1
0  23530  18779
1     66   4473
---- Validation: 
scalar performance:
{'acc': 0.45458904, 'precision': 0.49515674, 'recall': 0.46128437, 'specificity': 0.46128437, 'f1': 0.33467057, 'auroc': 0.5378498, 'binary_precision': 0.02764435, 'binary_recall': 0.46843854, 'binary_specificity': 0.4541302, 'binary_f1_score': 0.05220772}
confusion matrix:
      0     1
0  8252  9919
1   320   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5159899, 'precision': 0.591206, 'recall': 0.72869766, 'specificity': 0.72869766, 'f1': 0.46811557, 'auroc': 0.9362299, 'binary_precision': 0.18241206, 'binary_recall': 1.0, 'binary_specificity': 0.45739537, 'binary_f1_score': 0.30854228}
confusion matrix:
      0     1
0  2743  3254
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_13.png
early stop counter: 12
val acc:0.45458903908729553, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 13,now: 2024-06-03 06:43:48.817243,epoch time: 0:17:26.565804,used: 3:49:22.491528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.745432, 'precision': 0.6337658, 'recall': 0.845785, 'specificity': 0.845785, 'f1': 0.6306772, 'auroc': 0.9579301, 'binary_precision': 0.2719358, 'binary_recall': 0.97025776, 'binary_specificity': 0.7213122, 'binary_f1_score': 0.42480946}
confusion matrix:
       0      1
0  30518  11791
1    135   4404
---- Validation: 
scalar performance:
{'acc': 0.68225646, 'precision': 0.5098577, 'recall': 0.56844974, 'specificity': 0.56844974, 'f1': 0.44528916, 'auroc': 0.5592512, 'binary_precision': 0.045585494, 'binary_recall': 0.44684386, 'binary_specificity': 0.6900556, 'binary_f1_score': 0.08273105}
confusion matrix:
       0     1
0  12539  5632
1    333   269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.664138, 'precision': 0.62055033, 'recall': 0.80871254, 'specificity': 0.80871254, 'f1': 0.57902247, 'auroc': 0.9814243, 'binary_precision': 0.24243443, 'binary_recall': 0.9931129, 'binary_specificity': 0.62431216, 'binary_f1_score': 0.38972974}
confusion matrix:
      0     1
0  3744  2253
1     5   721
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_14.png
early stop counter: 13
val acc:0.6822564601898193, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 14,now: 2024-06-03 07:01:06.778034,epoch time: 0:17:17.960791,used: 4:06:40.452319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.70671105, 'precision': 0.6212794, 'recall': 0.828576, 'specificity': 0.828576, 'f1': 0.59979814, 'auroc': 0.9644573, 'binary_precision': 0.2457585, 'binary_recall': 0.9797312, 'binary_specificity': 0.67742085, 'binary_f1_score': 0.39294866}
confusion matrix:
       0      1
0  28661  13648
1     92   4447
---- Validation: 
scalar performance:
{'acc': 0.59148777, 'precision': 0.50370514, 'recall': 0.5287893, 'specificity': 0.5287893, 'f1': 0.4030228, 'auroc': 0.5495789, 'binary_precision': 0.03646858, 'binary_recall': 0.46179402, 'binary_specificity': 0.5957845, 'binary_f1_score': 0.06759878}
confusion matrix:
       0     1
0  10826  7345
1    324   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6385542, 'precision': 0.6147933, 'recall': 0.79679334, 'specificity': 0.79679334, 'f1': 0.55984336, 'auroc': 0.983464, 'binary_precision': 0.22986683, 'binary_recall': 0.9986226, 'binary_specificity': 0.59496415, 'binary_f1_score': 0.37371135}
confusion matrix:
      0     1
0  3568  2429
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_15.png
early stop counter: 14
val acc:0.5914877653121948, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 15,now: 2024-06-03 07:18:11.480847,epoch time: 0:17:04.702813,used: 4:23:45.155132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.70908046, 'precision': 0.6227316, 'recall': 0.8320513, 'specificity': 0.8320513, 'f1': 0.6022277, 'auroc': 0.966859, 'binary_precision': 0.24789217, 'binary_recall': 0.9845781, 'binary_specificity': 0.6795244, 'binary_f1_score': 0.39606503}
confusion matrix:
       0      1
0  28750  13559
1     70   4469
---- Validation: 
scalar performance:
{'acc': 0.560326, 'precision': 0.50149983, 'recall': 0.5118891, 'specificity': 0.5118891, 'f1': 0.38784093, 'auroc': 0.5450407, 'binary_precision': 0.033755787, 'binary_recall': 0.4601329, 'binary_specificity': 0.56364536, 'binary_f1_score': 0.06289736}
confusion matrix:
       0     1
0  10242  7929
1    325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6522386, 'precision': 0.6180277, 'recall': 0.8038585, 'specificity': 0.8038585, 'f1': 0.57021636, 'auroc': 0.98458415, 'binary_precision': 0.23660131, 'binary_recall': 0.9972452, 'binary_specificity': 0.6104719, 'binary_f1_score': 0.3824617}
confusion matrix:
      0     1
0  3661  2336
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_16.png
early stop counter: 15
val acc:0.5603259801864624, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 16,now: 2024-06-03 07:35:17.207479,epoch time: 0:17:05.726632,used: 4:40:50.881764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.59797645, 'precision': 0.5949015, 'recall': 0.7711296, 'specificity': 0.7711296, 'f1': 0.5181916, 'auroc': 0.9375315, 'binary_precision': 0.19251452, 'binary_recall': 0.9859, 'binary_specificity': 0.5563592, 'binary_f1_score': 0.32212788}
confusion matrix:
       0      1
0  23539  18770
1     64   4475
---- Validation: 
scalar performance:
{'acc': 0.41042987, 'precision': 0.492324, 'recall': 0.4400794, 'specificity': 0.4400794, 'f1': 0.31082153, 'auroc': 0.51553726, 'binary_precision': 0.025738627, 'binary_recall': 0.4717608, 'binary_specificity': 0.408398, 'binary_f1_score': 0.04881403}
confusion matrix:
      0      1
0  7421  10750
1   318    284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53755766, 'precision': 0.5946545, 'recall': 0.740787, 'specificity': 0.740787, 'f1': 0.48421782, 'auroc': 0.96852523, 'binary_precision': 0.189309, 'binary_recall': 1.0, 'binary_specificity': 0.48157412, 'binary_f1_score': 0.31835124}
confusion matrix:
      0     1
0  2888  3109
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_17.png
early stop counter: 16
val acc:0.41042986512184143, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 17,now: 2024-06-03 07:52:39.415645,epoch time: 0:17:22.208166,used: 4:58:13.089930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.5862577, 'precision': 0.59348094, 'recall': 0.76700175, 'specificity': 0.76700175, 'f1': 0.5101406, 'auroc': 0.95580876, 'binary_precision': 0.18870062, 'binary_recall': 0.9911875, 'binary_specificity': 0.5428159, 'binary_f1_score': 0.3170431}
confusion matrix:
       0      1
0  22966  19343
1     40   4499
---- Validation: 
scalar performance:
{'acc': 0.4059021, 'precision': 0.49230525, 'recall': 0.44014966, 'specificity': 0.44014966, 'f1': 0.30848908, 'auroc': 0.5256943, 'binary_precision': 0.025797753, 'binary_recall': 0.47674417, 'binary_specificity': 0.40355512, 'binary_f1_score': 0.04894688}
confusion matrix:
      0      1
0  7333  10838
1   315    287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5043879, 'precision': 0.5894529, 'recall': 0.72219443, 'specificity': 0.72219443, 'f1': 0.45942152, 'auroc': 0.972974, 'binary_precision': 0.17890586, 'binary_recall': 1.0, 'binary_specificity': 0.44438887, 'binary_f1_score': 0.3035117}
confusion matrix:
      0     1
0  2665  3332
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_18.png
early stop counter: 17
val acc:0.40590208768844604, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 18,now: 2024-06-03 08:10:00.654277,epoch time: 0:17:21.238632,used: 5:15:34.328562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.5559469, 'precision': 0.58844274, 'recall': 0.7511055, 'specificity': 0.7511055, 'f1': 0.4883424, 'auroc': 0.95320374, 'binary_precision': 0.17832279, 'binary_recall': 0.9931703, 'binary_specificity': 0.50904065, 'binary_f1_score': 0.30235758}
confusion matrix:
       0      1
0  21537  20772
1     31   4508
---- Validation: 
scalar performance:
{'acc': 0.32770467, 'precision': 0.4862416, 'recall': 0.40216476, 'specificity': 0.40216476, 'f1': 0.2627567, 'auroc': 0.46751782, 'binary_precision': 0.023017699, 'binary_recall': 0.48172757, 'binary_specificity': 0.32260194, 'binary_f1_score': 0.043936066}
confusion matrix:
      0      1
0  5862  12309
1   312    290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48579502, 'precision': 0.58677983, 'recall': 0.71177256, 'specificity': 0.71177256, 'f1': 0.44542003, 'auroc': 0.9561203, 'binary_precision': 0.17355965, 'binary_recall': 1.0, 'binary_specificity': 0.4235451, 'binary_f1_score': 0.29578325}
confusion matrix:
      0     1
0  2540  3457
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_19.png
early stop counter: 18
val acc:0.32770466804504395, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 19,now: 2024-06-03 08:27:21.752357,epoch time: 0:17:21.098080,used: 5:32:55.426642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.5165215, 'precision': 0.58211684, 'recall': 0.72878623, 'specificity': 0.72878623, 'f1': 0.4597044, 'auroc': 0.9229266, 'binary_precision': 0.1660582, 'binary_recall': 0.9920687, 'binary_specificity': 0.46550378, 'binary_f1_score': 0.28449583}
confusion matrix:
       0      1
0  19695  22614
1     36   4503
---- Validation: 
scalar performance:
{'acc': 0.30101743, 'precision': 0.48368496, 'recall': 0.3891821, 'specificity': 0.3891821, 'f1': 0.24604803, 'auroc': 0.47316572, 'binary_precision': 0.02221035, 'binary_recall': 0.4833887, 'binary_specificity': 0.29497552, 'binary_f1_score': 0.042469356}
confusion matrix:
      0      1
0  5360  12811
1   311    291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43968466, 'precision': 0.58079237, 'recall': 0.6859263, 'specificity': 0.6859263, 'f1': 0.41016582, 'auroc': 0.94434917, 'binary_precision': 0.16158469, 'binary_recall': 1.0, 'binary_specificity': 0.3718526, 'binary_f1_score': 0.27821422}
confusion matrix:
      0     1
0  2230  3767
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_20.png
early stop counter: 19
val acc:0.3010174334049225, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 20,now: 2024-06-03 08:44:43.330294,epoch time: 0:17:21.577937,used: 5:50:17.004579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.5685835, 'precision': 0.5905646, 'recall': 0.75800323, 'specificity': 0.75800323, 'f1': 0.4974724, 'auroc': 0.96182704, 'binary_precision': 0.18257312, 'binary_recall': 0.99294996, 'binary_specificity': 0.52305657, 'binary_f1_score': 0.30843458}
confusion matrix:
       0      1
0  22130  20179
1     32   4507
---- Validation: 
scalar performance:
{'acc': 0.35369948, 'precision': 0.4884489, 'recall': 0.4147897, 'specificity': 0.4147897, 'f1': 0.27846402, 'auroc': 0.50579953, 'binary_precision': 0.023866545, 'binary_recall': 0.48006645, 'binary_specificity': 0.34951296, 'binary_f1_score': 0.045472424}
confusion matrix:
      0      1
0  6351  11820
1   313    289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48207647, 'precision': 0.58626425, 'recall': 0.7096882, 'specificity': 0.7096882, 'f1': 0.44260746, 'auroc': 0.9805634, 'binary_precision': 0.17252852, 'binary_recall': 1.0, 'binary_specificity': 0.41937634, 'binary_f1_score': 0.29428455}
confusion matrix:
      0     1
0  2515  3482
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_21.png
early stop counter: 20
val acc:0.3536994755268097, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 21,now: 2024-06-03 09:02:03.868985,epoch time: 0:17:20.538691,used: 6:07:37.543270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.5412825, 'precision': 0.585441, 'recall': 0.7413149, 'specificity': 0.7413149, 'f1': 0.47742993, 'auroc': 0.91898936, 'binary_precision': 0.17317703, 'binary_recall': 0.989425, 'binary_specificity': 0.49320474, 'binary_f1_score': 0.2947624}
confusion matrix:
       0      1
0  20867  21442
1     48   4491
---- Validation: 
scalar performance:
{'acc': 0.32637298, 'precision': 0.48567295, 'recall': 0.39826465, 'specificity': 0.39826465, 'f1': 0.26173088, 'auroc': 0.46898618, 'binary_precision': 0.022669626, 'binary_recall': 0.47508305, 'binary_specificity': 0.32144627, 'binary_f1_score': 0.043274324}
confusion matrix:
      0      1
0  5841  12330
1   316    286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4374535, 'precision': 0.5805235, 'recall': 0.6846757, 'specificity': 0.6846757, 'f1': 0.40843567, 'auroc': 0.9342996, 'binary_precision': 0.16104703, 'binary_recall': 1.0, 'binary_specificity': 0.36935136, 'binary_f1_score': 0.27741688}
confusion matrix:
      0     1
0  2215  3782
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_22.png
early stop counter: 21
val acc:0.32637298107147217, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 22,now: 2024-06-03 09:20:14.687242,epoch time: 0:18:10.818257,used: 6:25:48.361527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.56518954, 'precision': 0.58894706, 'recall': 0.7532724, 'specificity': 0.7532724, 'f1': 0.49447143, 'auroc': 0.95040834, 'binary_precision': 0.18065922, 'binary_recall': 0.98656094, 'binary_specificity': 0.51998395, 'binary_f1_score': 0.30539456}
confusion matrix:
       0      1
0  22000  20309
1     61   4478
---- Validation: 
scalar performance:
{'acc': 0.32493475, 'precision': 0.48564667, 'recall': 0.39832476, 'specificity': 0.39832476, 'f1': 0.2608932, 'auroc': 0.46970955, 'binary_precision': 0.022696719, 'binary_recall': 0.47674417, 'binary_specificity': 0.31990534, 'binary_f1_score': 0.043330565}
confusion matrix:
      0      1
0  5813  12358
1   315    287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45872378, 'precision': 0.58287317, 'recall': 0.69599295, 'specificity': 0.69599295, 'f1': 0.42474246, 'auroc': 0.97214293, 'binary_precision': 0.16617006, 'binary_recall': 0.9986226, 'binary_specificity': 0.39336336, 'binary_f1_score': 0.28492826}
confusion matrix:
      0     1
0  2359  3638
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_23.png
early stop counter: 22
val acc:0.3249347507953644, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 23,now: 2024-06-03 09:37:32.666124,epoch time: 0:17:17.978882,used: 6:43:06.340409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.54894555, 'precision': 0.5866759, 'recall': 0.7455575, 'specificity': 0.7455575, 'f1': 0.4829696, 'auroc': 0.935098, 'binary_precision': 0.17560804, 'binary_recall': 0.989425, 'binary_specificity': 0.50169, 'binary_f1_score': 0.29827648}
confusion matrix:
       0      1
0  21226  21083
1     48   4491
---- Validation: 
scalar performance:
{'acc': 0.3007511, 'precision': 0.48331168, 'recall': 0.3866354, 'specificity': 0.3866354, 'f1': 0.24573736, 'auroc': 0.45101428, 'binary_precision': 0.021983055, 'binary_recall': 0.47840533, 'binary_specificity': 0.29486546, 'binary_f1_score': 0.042034592}
confusion matrix:
      0      1
0  5358  12813
1   314    288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45411274, 'precision': 0.5825751, 'recall': 0.69401366, 'specificity': 0.69401366, 'f1': 0.42129463, 'auroc': 0.95250845, 'binary_precision': 0.16515014, 'binary_recall': 1.0, 'binary_specificity': 0.38802734, 'binary_f1_score': 0.283483}
confusion matrix:
      0     1
0  2327  3670
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_24.png
early stop counter: 23
val acc:0.30075109004974365, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 24,now: 2024-06-03 09:54:40.591274,epoch time: 0:17:07.925150,used: 7:00:14.265559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.48066086, 'precision': 0.57709444, 'recall': 0.70874155, 'specificity': 0.70874155, 'f1': 0.4334928, 'auroc': 0.92041755, 'binary_precision': 0.15629342, 'binary_recall': 0.99162626, 'binary_specificity': 0.42585677, 'binary_f1_score': 0.27002704}
confusion matrix:
       0      1
0  18018  24292
1     38   4500
---- Validation: 
scalar performance:
{'acc': 0.27118734, 'precision': 0.4807097, 'recall': 0.37698513, 'specificity': 0.37698513, 'f1': 0.22673671, 'auroc': 0.41658083, 'binary_precision': 0.021580102, 'binary_recall': 0.4900332, 'binary_specificity': 0.26393706, 'binary_f1_score': 0.041339684}
confusion matrix:
      0      1
0  4796  13375
1   307    295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37126282, 'precision': 0.5732889, 'recall': 0.64757377, 'specificity': 0.64757377, 'f1': 0.35572663, 'auroc': 0.9289022, 'binary_precision': 0.14657784, 'binary_recall': 1.0, 'binary_specificity': 0.29514757, 'binary_f1_score': 0.25567883}
confusion matrix:
      0     1
0  1770  4227
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_25.png
early stop counter: 24
val acc:0.27118733525276184, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 25,now: 2024-06-03 10:11:57.532397,epoch time: 0:17:16.941123,used: 7:17:31.206682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.571273, 'precision': 0.5908608, 'recall': 0.75900066, 'specificity': 0.75900066, 'f1': 0.49932662, 'auroc': 0.976091, 'binary_precision': 0.18338086, 'binary_recall': 0.9918484, 'binary_specificity': 0.52615285, 'binary_f1_score': 0.30953282}
confusion matrix:
       0      1
0  22261  20048
1     37   4502
---- Validation: 
scalar performance:
{'acc': 0.3678155, 'precision': 0.49077928, 'recall': 0.43091506, 'specificity': 0.43091506, 'f1': 0.28743985, 'auroc': 0.5136305, 'binary_precision': 0.02528232, 'binary_recall': 0.49833888, 'binary_specificity': 0.36349127, 'binary_f1_score': 0.048123196}
confusion matrix:
      0      1
0  6605  11566
1   302    300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.481184, 'precision': 0.5861414, 'recall': 0.7091879, 'specificity': 0.7091879, 'f1': 0.4419318, 'auroc': 0.98643017, 'binary_precision': 0.17228286, 'binary_recall': 1.0, 'binary_specificity': 0.41837585, 'binary_f1_score': 0.29392713}
confusion matrix:
      0     1
0  2509  3488
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_26.png
early stop counter: 25
val acc:0.3678154945373535, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 26,now: 2024-06-03 10:29:31.176740,epoch time: 0:17:33.644343,used: 7:35:04.851025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.61103994, 'precision': 0.5971658, 'recall': 0.77728033, 'specificity': 0.77728033, 'f1': 0.52750707, 'auroc': 0.9751463, 'binary_precision': 0.19742604, 'binary_recall': 0.9834765, 'binary_specificity': 0.57108414, 'binary_f1_score': 0.32883978}
confusion matrix:
       0      1
0  24162  18147
1     75   4464
---- Validation: 
scalar performance:
{'acc': 0.48026422, 'precision': 0.49703547, 'recall': 0.47615337, 'specificity': 0.47615337, 'f1': 0.3482878, 'auroc': 0.5356761, 'binary_precision': 0.029209092, 'binary_recall': 0.4717608, 'binary_specificity': 0.48054594, 'binary_f1_score': 0.05501211}
confusion matrix:
      0     1
0  8732  9439
1   318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4840101, 'precision': 0.586256, 'recall': 0.7101667, 'specificity': 0.7101667, 'f1': 0.44397497, 'auroc': 0.98877096, 'binary_precision': 0.17290723, 'binary_recall': 0.9986226, 'binary_specificity': 0.42171085, 'binary_f1_score': 0.2947754}
confusion matrix:
      0     1
0  2529  3468
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_27.png
early stop counter: 26
val acc:0.48026421666145325, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 27,now: 2024-06-03 10:46:38.662275,epoch time: 0:17:07.485535,used: 7:52:12.336560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.5161373, 'precision': 0.5823993, 'recall': 0.7294586, 'specificity': 0.7294586, 'f1': 0.4595756, 'auroc': 0.95770395, 'binary_precision': 0.16616948, 'binary_recall': 0.9940516, 'binary_specificity': 0.46486562, 'binary_f1_score': 0.2847406}
confusion matrix:
       0      1
0  19668  22641
1     27   4512
---- Validation: 
scalar performance:
{'acc': 0.28812656, 'precision': 0.48390952, 'recall': 0.39376584, 'specificity': 0.39376584, 'f1': 0.23835434, 'auroc': 0.46243757, 'binary_precision': 0.022808854, 'binary_recall': 0.50664455, 'binary_specificity': 0.28088713, 'binary_f1_score': 0.043652494}
confusion matrix:
      0      1
0  5104  13067
1   297    305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43195003, 'precision': 0.57956374, 'recall': 0.68098545, 'specificity': 0.68098545, 'f1': 0.4040764, 'auroc': 0.97213435, 'binary_precision': 0.15958618, 'binary_recall': 0.9986226, 'binary_specificity': 0.36334834, 'binary_f1_score': 0.27519453}
confusion matrix:
      0     1
0  2179  3818
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_28.png
early stop counter: 27
val acc:0.28812655806541443, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 28,now: 2024-06-03 11:03:44.931488,epoch time: 0:17:06.269213,used: 8:09:18.605773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.5586791, 'precision': 0.5888487, 'recall': 0.7525248, 'specificity': 0.7525248, 'f1': 0.4902829, 'auroc': 0.97327125, 'binary_precision': 0.17917213, 'binary_recall': 0.9929484, 'binary_specificity': 0.5121012, 'binary_f1_score': 0.3035672}
confusion matrix:
       0      1
0  21667  20643
1     32   4506
---- Validation: 
scalar performance:
{'acc': 0.33409685, 'precision': 0.48738328, 'recall': 0.40948194, 'specificity': 0.40948194, 'f1': 0.26694265, 'auroc': 0.4921677, 'binary_precision': 0.023620786, 'binary_recall': 0.4900332, 'binary_specificity': 0.3289307, 'binary_f1_score': 0.045069132}
confusion matrix:
      0      1
0  5977  12194
1   307    295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45381525, 'precision': 0.58253753, 'recall': 0.69384694, 'specificity': 0.69384694, 'f1': 0.42106616, 'auroc': 0.98339224, 'binary_precision': 0.16507503, 'binary_recall': 1.0, 'binary_specificity': 0.38769385, 'binary_f1_score': 0.28337237}
confusion matrix:
      0     1
0  2325  3672
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_29.png
early stop counter: 28
val acc:0.33409684896469116, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 29,now: 2024-06-03 11:20:55.963443,epoch time: 0:17:11.031955,used: 8:26:29.637728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.48155737, 'precision': 0.5772505, 'recall': 0.7093362, 'specificity': 0.7093362, 'f1': 0.43416616, 'auroc': 0.95496917, 'binary_precision': 0.15654564, 'binary_recall': 0.9918466, 'binary_specificity': 0.42682582, 'binary_f1_score': 0.27041155}
confusion matrix:
       0      1
0  18059  24251
1     37   4501
---- Validation: 
scalar performance:
{'acc': 0.28913864, 'precision': 0.4834334, 'recall': 0.3902734, 'specificity': 0.3902734, 'f1': 0.238792, 'auroc': 0.46717802, 'binary_precision': 0.022483699, 'binary_recall': 0.49833888, 'binary_specificity': 0.2822079, 'binary_f1_score': 0.043026175}
confusion matrix:
      0      1
0  5128  13043
1   302    300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38033617, 'precision': 0.5742028, 'recall': 0.65265965, 'specificity': 0.65265965, 'f1': 0.36313143, 'auroc': 0.9716284, 'binary_precision': 0.14840557, 'binary_recall': 1.0, 'binary_specificity': 0.30531934, 'binary_f1_score': 0.25845498}
confusion matrix:
      0     1
0  1831  4166
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054735_30.png
early stop counter: 29
val acc:0.28913864493370056, best validation acc: 0.9279283881187439, corresponding to test acc:                         0.9870593547821045 / 0.9870593547821045
after epoch: 30,now: 2024-06-03 11:38:21.368709,epoch time: 0:17:25.405266,used: 8:43:55.042994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_02_54_26_seed_2_21054735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:43:55.042994 at 2024-06-03 11:38:21.368709
persisted model performance metric: 

scalar performance:
{'acc': 0.9892905, 'precision': 0.9680097, 'recall': 0.9770478, 'specificity': 0.9770478, 'f1': 0.97247136, 'auroc': 0.9915056, 'binary_precision': 0.9407008, 'binary_recall': 0.9614325, 'binary_specificity': 0.992663, 'binary_f1_score': 0.9509537}
confusion matrix:
      0    1
0  5953   44
1    28  698
oracle model performance metric: 

scalar performance:
{'acc': 0.98720807, 'precision': 0.9627075, 'recall': 0.9716432, 'specificity': 0.9716432, 'f1': 0.9671185, 'auroc': 0.9935219, 'binary_precision': 0.93126684, 'binary_recall': 0.95179063, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.9414169}
confusion matrix:
      0    1
0  5946   51
1    35  691
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491314 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  89906 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491314 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  89906 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |  10880 MiB |   2761 TiB |   2761 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2752 TiB |   2752 TiB |
|       from small pool |  88755 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  32244 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    126 MiB |    126 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 635085 KiB |   1325 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1307 TiB |   1307 TiB |
|       from small pool |   8397 KiB |     28 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7102    |  428901 K  |  428897 K  |
|       from large pool |      87    |     908    |  174519 K  |  174519 K  |
|       from small pool |    3816    |    7013    |  254381 K  |  254377 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7102    |  428901 K  |  428897 K  |
|       from large pool |      87    |     908    |  174519 K  |  174519 K  |
|       from small pool |    3816    |    7013    |  254381 K  |  254377 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     411    |     411    |    1055    |     644    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      63    |      63    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2963    |  228037 K  |  228037 K  |
|       from large pool |      24    |     203    |  105271 K  |  105271 K  |
|       from small pool |      53    |    2937    |  122766 K  |  122766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2761 TiB |   2761 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2752 TiB |   2752 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1100 MiB |  11506 MiB |  32244 MiB |  31144 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1307 TiB |   1307 TiB |
|       from small pool |      0 KiB |     28 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7102    |  428901 K  |  428901 K  |
|       from large pool |       2    |     908    |  174519 K  |  174519 K  |
|       from small pool |       0    |    7013    |  254381 K  |  254381 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7102    |  428901 K  |  428901 K  |
|       from large pool |       2    |     908    |  174519 K  |  174519 K  |
|       from small pool |       0    |    7013    |  254381 K  |  254381 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     411    |    1055    |     973    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2963    |  228039 K  |  228039 K  |
|       from large pool |       4    |     203    |  105271 K  |  105271 K  |
|       from small pool |       0    |    2937    |  122767 K  |  122767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 11:39:59 2024]
Finished job 0.
1 of 1 steps (100%) done
