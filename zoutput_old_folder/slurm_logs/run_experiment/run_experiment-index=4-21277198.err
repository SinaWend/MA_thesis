Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 16:20:08 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198

 Experiment start at: 2024-06-10 16:26:07.300904
before training, model accuracy: 0.891887903213501
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9973468, 'precision': 0.9976006, 'recall': 0.9868728, 'specificity': 0.9868728, 'f1': 0.9921632, 'auroc': 0.99947274, 'binary_precision': 0.9979118, 'binary_recall': 0.9739583, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.98578954}
confusion matrix:
       0     1
0  42311     9
1    115  4301
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.76641107, 'recall': 0.67000216, 'specificity': 0.67000216, 'f1': 0.70651096, 'auroc': 0.9459436, 'binary_precision': 0.5555556, 'binary_recall': 0.34992224, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.4293893}
confusion matrix:
       0    1
0  17969  180
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.9995419, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 16:59:43.174903,epoch time: 0:33:35.873999,used: 0:33:35.873999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9979837, 'recall': 0.99262035, 'specificity': 0.99262035, 'f1': 0.9952838, 'auroc': 0.99981403, 'binary_precision': 0.99747765, 'binary_recall': 0.9855007, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.99145305}
confusion matrix:
       0     1
0  42311    11
1     64  4350
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.8014514, 'recall': 0.6225772, 'specificity': 0.6225772, 'f1': 0.6712236, 'auroc': 0.94091904, 'binary_precision': 0.62890625, 'binary_recall': 0.2503888, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.35817572}
confusion matrix:
       0    1
0  18054   95
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9999974, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 17:32:40.081541,epoch time: 0:32:56.906638,used: 1:06:32.780637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9981171, 'precision': 0.9977245, 'recall': 0.99125123, 'specificity': 0.99125123, 'f1': 0.9944612, 'auroc': 0.99933183, 'binary_precision': 0.99724203, 'binary_recall': 0.98278594, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.98996127}
confusion matrix:
       0     1
0  42309    12
1     76  4339
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.8642509, 'recall': 0.64525926, 'specificity': 0.64525926, 'f1': 0.7043775, 'auroc': 0.95345426, 'binary_precision': 0.75298804, 'binary_recall': 0.29393467, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.42281878}
confusion matrix:
       0    1
0  18087   62
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9982673, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_3.png
better model found
persisted
after epoch: 3,now: 2024-06-10 18:05:26.623966,epoch time: 0:32:46.542425,used: 1:39:19.323062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9991183, 'recall': 0.99262524, 'specificity': 0.99262524, 'f1': 0.9958451, 'auroc': 0.99985814, 'binary_precision': 0.9997701, 'binary_recall': 0.98527414, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9924692}
confusion matrix:
       0     1
0  42321     1
1     65  4349
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.8878696, 'recall': 0.5732388, 'specificity': 0.5732388, 'f1': 0.6170824, 'auroc': 0.9462218, 'binary_precision': 0.80508476, 'binary_recall': 0.14774494, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.24967147}
confusion matrix:
       0   1
0  18126  23
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9963127, 'precision': 0.99792427, 'recall': 0.98403573, 'specificity': 0.98403573, 'f1': 0.9908484, 'auroc': 0.9994831, 'binary_precision': 1.0, 'binary_recall': 0.9680715, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837768}
confusion matrix:
      0    1
0  5997    0
1    25  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_4.png
early stop counter: 1
val acc:0.9696147441864014, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 4,now: 2024-06-10 18:38:09.010646,epoch time: 0:32:42.386680,used: 2:12:01.709742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9966835, 'precision': 0.99817544, 'recall': 0.9824462, 'specificity': 0.9824462, 'f1': 0.99015236, 'auroc': 0.99887717, 'binary_precision': 1.0, 'binary_recall': 0.9648924, 'binary_specificity': 1.0, 'binary_f1_score': 0.98213255}
confusion matrix:
       0     1
0  42321     0
1    155  4260
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.87737167, 'recall': 0.5862377, 'specificity': 0.5862377, 'f1': 0.6348573, 'auroc': 0.9527893, 'binary_precision': 0.7832168, 'binary_recall': 0.17418352, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.28498727}
confusion matrix:
       0    1
0  18118   31
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9939528, 'precision': 0.9966048, 'recall': 0.97381866, 'specificity': 0.97381866, 'f1': 0.98485404, 'auroc': 0.9991875, 'binary_precision': 1.0, 'binary_recall': 0.9476373, 'binary_specificity': 1.0, 'binary_f1_score': 0.9731148}
confusion matrix:
      0    1
0  5997    0
1    41  742
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_5.png
early stop counter: 2
val acc:0.9700936675071716, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 5,now: 2024-06-10 19:10:22.268943,epoch time: 0:32:13.258297,used: 2:44:14.968039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9982669, 'precision': 0.9989413, 'recall': 0.9909282, 'specificity': 0.9909282, 'f1': 0.9948939, 'auroc': 0.99987406, 'binary_precision': 0.9997694, 'binary_recall': 0.98187995, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9907439}
confusion matrix:
       0     1
0  42320     1
1     80  4335
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.70811313, 'recall': 0.5066954, 'specificity': 0.5066954, 'f1': 0.5048398, 'auroc': 0.939728, 'binary_precision': 0.45, 'binary_recall': 0.01399689, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.027149322}
confusion matrix:
       0   1
0  18138  11
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9975381, 'recall': 0.99089324, 'specificity': 0.99089324, 'f1': 0.9941857, 'auroc': 0.9997031, 'binary_precision': 0.99740595, 'binary_recall': 0.98212004, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.98970395}
confusion matrix:
      0    1
0  5995    2
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_6.png
early stop counter: 3
val acc:0.9656769037246704, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 6,now: 2024-06-10 19:42:42.659373,epoch time: 0:32:20.390430,used: 3:16:35.358469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9979673, 'precision': 0.9987762, 'recall': 0.98933786, 'specificity': 0.98933786, 'f1': 0.9940003, 'auroc': 0.9993638, 'binary_precision': 0.9997685, 'binary_recall': 0.9786993, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98912174}
confusion matrix:
       0     1
0  42322     1
1     94  4319
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.83922446, 'recall': 0.56513214, 'specificity': 0.56513214, 'f1': 0.6033499, 'auroc': 0.9518026, 'binary_precision': 0.7083333, 'binary_recall': 0.13219285, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.22280473}
confusion matrix:
       0   1
0  18114  35
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9963127, 'precision': 0.99792427, 'recall': 0.98403573, 'specificity': 0.98403573, 'f1': 0.9908484, 'auroc': 0.9998665, 'binary_precision': 1.0, 'binary_recall': 0.9680715, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837768}
confusion matrix:
      0    1
0  5997    0
1    25  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_7.png
early stop counter: 4
val acc:0.9684439897537231, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 7,now: 2024-06-10 20:15:01.445161,epoch time: 0:32:18.785788,used: 3:48:54.144257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9979459, 'precision': 0.99845314, 'recall': 0.98953605, 'specificity': 0.98953605, 'f1': 0.993944, 'auroc': 0.9993832, 'binary_precision': 0.9990758, 'binary_recall': 0.9791667, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.98902106}
confusion matrix:
       0     1
0  42316     4
1     92  4324
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.8096554, 'recall': 0.58693886, 'specificity': 0.58693886, 'f1': 0.63115656, 'auroc': 0.943165, 'binary_precision': 0.64772725, 'binary_recall': 0.17729394, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.27838826}
confusion matrix:
       0    1
0  18087   62
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.9988214, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_8.png
early stop counter: 5
val acc:0.968550443649292, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 8,now: 2024-06-10 20:47:16.583179,epoch time: 0:32:15.138018,used: 4:21:09.282275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99715424, 'precision': 0.99573874, 'recall': 0.98757505, 'specificity': 0.98757505, 'f1': 0.9916142, 'auroc': 0.99937606, 'binary_precision': 0.9940009, 'binary_recall': 0.97576445, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.9847982}
confusion matrix:
       0     1
0  42295    26
1    107  4308
---- Validation: 
scalar performance:
{'acc': 0.95657724, 'precision': 0.68813336, 'recall': 0.7367517, 'specificity': 0.7367517, 'f1': 0.7092535, 'auroc': 0.9141362, 'binary_precision': 0.39412484, 'binary_recall': 0.5007776, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.44109586}
confusion matrix:
       0    1
0  17654  495
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949852, 'precision': 0.99718124, 'recall': 0.97828865, 'specificity': 0.97828865, 'f1': 0.98749, 'auroc': 0.99882466, 'binary_precision': 1.0, 'binary_recall': 0.95657724, 'binary_specificity': 1.0, 'binary_f1_score': 0.97780675}
confusion matrix:
      0    1
0  5997    0
1    34  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_9.png
early stop counter: 6
val acc:0.9565772414207458, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 9,now: 2024-06-10 21:19:12.168324,epoch time: 0:31:55.585145,used: 4:53:04.867420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9994727, 'recall': 0.9960244, 'specificity': 0.9960244, 'f1': 0.997741, 'auroc': 0.9999776, 'binary_precision': 0.9997717, 'binary_recall': 0.99207246, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9959072}
confusion matrix:
       0     1
0  42320     1
1     35  4380
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.942922, 'recall': 0.55115664, 'specificity': 0.55115664, 'f1': 0.58440137, 'auroc': 0.968107, 'binary_precision': 0.9166667, 'binary_recall': 0.102643855, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.18461537}
confusion matrix:
       0   1
0  18143   6
1    577  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9999981, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_10.png
early stop counter: 7
val acc:0.9689761400222778, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 10,now: 2024-06-10 21:50:49.012462,epoch time: 0:31:36.844138,used: 5:24:41.711558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99709004, 'precision': 0.98831606, 'recall': 0.994843, 'specificity': 0.994843, 'f1': 0.9915521, 'auroc': 0.9998414, 'binary_precision': 0.9774604, 'binary_recall': 0.99207246, 'binary_specificity': 0.9976135, 'binary_f1_score': 0.98471224}
confusion matrix:
       0     1
0  42220   101
1     35  4380
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.80102694, 'recall': 0.7244345, 'specificity': 0.7244345, 'f1': 0.7566244, 'auroc': 0.95899945, 'binary_precision': 0.6210526, 'binary_recall': 0.45878693, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.5277281}
confusion matrix:
       0    1
0  17969  180
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.99835366, 'recall': 0.9922538, 'specificity': 0.9922538, 'f1': 0.9952785, 'auroc': 0.9998511, 'binary_precision': 0.9987047, 'binary_recall': 0.98467433, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99163985}
confusion matrix:
      0    1
0  5996    1
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_11.png
early stop counter: 8
val acc:0.9719029664993286, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9983775615692139
after epoch: 11,now: 2024-06-10 22:22:47.576566,epoch time: 0:31:58.564104,used: 5:56:40.275662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.9959253, 'recall': 0.9973333, 'specificity': 0.9973333, 'f1': 0.99662805, 'auroc': 0.99982977, 'binary_precision': 0.99232334, 'binary_recall': 0.99547, 'binary_specificity': 0.9991966, 'binary_f1_score': 0.99389416}
confusion matrix:
       0     1
0  42287    34
1     20  4395
---- Validation: 
scalar performance:
{'acc': 0.97232866, 'precision': 0.8672704, 'recall': 0.6383985, 'specificity': 0.6383985, 'f1': 0.6974618, 'auroc': 0.95071995, 'binary_precision': 0.75949365, 'binary_recall': 0.2799378, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.40909094}
confusion matrix:
       0    1
0  18092   57
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.9986894, 'recall': 0.9948081, 'specificity': 0.9948081, 'f1': 0.99673855, 'auroc': 0.9999218, 'binary_precision': 0.99871135, 'binary_recall': 0.98978287, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9942271}
confusion matrix:
      0    1
0  5996    1
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_12.png
new oracle model saved
early stop counter: 9
val acc:0.9723286628723145, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 12,now: 2024-06-10 22:55:19.475355,epoch time: 0:32:31.898789,used: 6:29:12.174451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9993795, 'precision': 0.99965763, 'recall': 0.9967158, 'specificity': 0.9967158, 'f1': 0.99818116, 'auroc': 0.99988693, 'binary_precision': 1.0, 'binary_recall': 0.9934315, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967049}
confusion matrix:
       0     1
0  42321     0
1     29  4386
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.92012733, 'recall': 0.5672935, 'specificity': 0.5672935, 'f1': 0.60937047, 'auroc': 0.95838857, 'binary_precision': 0.87, 'binary_recall': 0.13530326, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.23418573}
confusion matrix:
       0   1
0  18136  13
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.99906814, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_13.png
early stop counter: 10
val acc:0.9697211384773254, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 13,now: 2024-06-10 23:27:36.229487,epoch time: 0:32:16.754132,used: 7:01:28.928583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99905854, 'precision': 0.9993781, 'recall': 0.99511623, 'specificity': 0.99511623, 'f1': 0.99723566, 'auroc': 0.9997828, 'binary_precision': 0.99977124, 'binary_recall': 0.9902561, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9949909}
confusion matrix:
       0     1
0  42322     1
1     43  4370
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.87387526, 'recall': 0.60851276, 'specificity': 0.60851276, 'f1': 0.66352314, 'auroc': 0.9516452, 'binary_precision': 0.77472526, 'binary_recall': 0.21928461, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.34181818}
confusion matrix:
       0    1
0  18108   41
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977876, 'precision': 0.9987525, 'recall': 0.9904214, 'specificity': 0.9904214, 'f1': 0.9945399, 'auroc': 0.9997393, 'binary_precision': 1.0, 'binary_recall': 0.9808429, 'binary_specificity': 1.0, 'binary_f1_score': 0.99032885}
confusion matrix:
      0    1
0  5997    0
1    15  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_14.png
early stop counter: 11
val acc:0.9711047410964966, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 14,now: 2024-06-10 23:59:59.851616,epoch time: 0:32:23.622129,used: 7:33:52.550712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.99901664, 'recall': 0.99597716, 'specificity': 0.99597716, 'f1': 0.9974911, 'auroc': 0.99992526, 'binary_precision': 0.99885976, 'binary_recall': 0.99207246, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99545455}
confusion matrix:
       0     1
0  42316     5
1     35  4380
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.8484845, 'recall': 0.60279405, 'specificity': 0.60279405, 'f1': 0.65421796, 'auroc': 0.95690703, 'binary_precision': 0.72432435, 'binary_recall': 0.20839813, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.3236715}
confusion matrix:
       0    1
0  18098   51
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977876, 'precision': 0.9981859, 'recall': 0.99097663, 'specificity': 0.99097663, 'f1': 0.994546, 'auroc': 0.99984777, 'binary_precision': 0.9987013, 'binary_recall': 0.98212004, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99034125}
confusion matrix:
      0    1
0  5996    1
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_15.png
early stop counter: 12
val acc:0.9702000617980957, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 15,now: 2024-06-11 00:32:11.126106,epoch time: 0:32:11.274490,used: 8:06:03.825202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.9993942, 'recall': 0.9963523, 'specificity': 0.9963523, 'f1': 0.99786735, 'auroc': 0.99994624, 'binary_precision': 0.9995439, 'binary_recall': 0.99275196, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9961363}
confusion matrix:
       0     1
0  42319     2
1     32  4383
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.88402414, 'recall': 0.59323615, 'specificity': 0.59323615, 'f1': 0.64468545, 'auroc': 0.9568044, 'binary_precision': 0.79605263, 'binary_recall': 0.1881804, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.30440253}
confusion matrix:
       0    1
0  18118   31
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.9966353, 'recall': 0.9888942, 'specificity': 0.9888942, 'f1': 0.99272394, 'auroc': 0.99980235, 'binary_precision': 0.9960988, 'binary_recall': 0.97828865, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9871134}
confusion matrix:
      0    1
0  5994    3
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_16.png
early stop counter: 13
val acc:0.9705725908279419, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 16,now: 2024-06-11 01:04:17.344589,epoch time: 0:32:06.218483,used: 8:38:10.043685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.9994925, 'recall': 0.9951291, 'specificity': 0.9951291, 'f1': 0.9972988, 'auroc': 0.99999, 'binary_precision': 1.0, 'binary_recall': 0.9902583, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951053}
confusion matrix:
       0     1
0  42322     0
1     43  4371
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.9378536, 'recall': 0.5379649, 'specificity': 0.5379649, 'f1': 0.5621819, 'auroc': 0.96122146, 'binary_precision': 0.9074074, 'binary_recall': 0.07620529, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.14060259}
confusion matrix:
       0   1
0  18144   5
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.9999927, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_17.png
early stop counter: 14
val acc:0.9681247472763062, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 17,now: 2024-06-11 01:36:27.939983,epoch time: 0:32:10.595394,used: 9:10:20.639079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9994009, 'precision': 0.9995673, 'recall': 0.9969305, 'specificity': 0.9969305, 'f1': 0.9982444, 'auroc': 0.99994206, 'binary_precision': 0.99977213, 'binary_recall': 0.9938845, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9968196}
confusion matrix:
       0     1
0  42320     1
1     27  4388
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.9394996, 'recall': 0.5317716, 'specificity': 0.5317716, 'f1': 0.55138075, 'auroc': 0.95362973, 'binary_precision': 0.9111111, 'binary_recall': 0.06376361, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.11918605}
confusion matrix:
       0   1
0  18145   4
1    602  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9989185, 'recall': 0.9916986, 'specificity': 0.9916986, 'f1': 0.9952732, 'auroc': 0.99993527, 'binary_precision': 1.0, 'binary_recall': 0.9833972, 'binary_specificity': 1.0, 'binary_f1_score': 0.99162906}
confusion matrix:
      0    1
0  5997    0
1    13  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_18.png
early stop counter: 15
val acc:0.96775221824646, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 18,now: 2024-06-11 02:08:36.290069,epoch time: 0:32:08.350086,used: 9:42:28.989165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99890876, 'precision': 0.9992954, 'recall': 0.99432445, 'specificity': 0.99432445, 'f1': 0.9967942, 'auroc': 0.9999207, 'binary_precision': 0.9997709, 'binary_recall': 0.98867244, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9941907}
confusion matrix:
       0     1
0  42321     1
1     50  4364
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.892442, 'recall': 0.5138867, 'specificity': 0.5138867, 'f1': 0.518549, 'auroc': 0.95399594, 'binary_precision': 0.8181818, 'binary_recall': 0.02799378, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.054135337}
confusion matrix:
       0   1
0  18145   4
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.99999464, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_19.png
early stop counter: 16
val acc:0.9665282964706421, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9986725449562073
after epoch: 19,now: 2024-06-11 02:40:43.433444,epoch time: 0:32:07.143375,used: 10:14:36.132540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.99941355, 'recall': 0.9954561, 'specificity': 0.9954561, 'f1': 0.99742496, 'auroc': 0.9997497, 'binary_precision': 0.99977136, 'binary_recall': 0.99093586, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.995334}
confusion matrix:
       0     1
0  42322     1
1     40  4373
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.89938587, 'recall': 0.6234801, 'specificity': 0.6234801, 'f1': 0.68412435, 'auroc': 0.9528055, 'binary_precision': 0.82474226, 'binary_recall': 0.2488336, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.38231778}
confusion matrix:
       0    1
0  18115   34
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99877346, 'recall': 0.9954466, 'specificity': 0.9954466, 'f1': 0.99710256, 'auroc': 0.9998237, 'binary_precision': 0.998713, 'binary_recall': 0.99106, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9948718}
confusion matrix:
      0    1
0  5996    1
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_20.png
new oracle model saved
early stop counter: 17
val acc:0.972488284111023, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 20,now: 2024-06-11 03:12:40.355666,epoch time: 0:31:56.922222,used: 10:46:33.054762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.99924505, 'recall': 0.99275196, 'specificity': 0.99275196, 'f1': 0.99597174, 'auroc': 0.99984956, 'binary_precision': 1.0, 'binary_recall': 0.985504, 'binary_specificity': 1.0, 'binary_f1_score': 0.9926991}
confusion matrix:
       0     1
0  42321     0
1     64  4351
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.8950137, 'recall': 0.5108038, 'specificity': 0.5108038, 'f1': 0.512654, 'auroc': 0.96270764, 'binary_precision': 0.8235294, 'binary_recall': 0.02177294, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.042424243}
confusion matrix:
       0   1
0  18146   3
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.99987155, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_21.png
early stop counter: 18
val acc:0.9663686752319336, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 21,now: 2024-06-11 03:44:17.296899,epoch time: 0:31:36.941233,used: 11:18:09.995995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978817, 'precision': 0.99883306, 'recall': 0.98879075, 'specificity': 0.98879075, 'f1': 0.9937477, 'auroc': 0.9998023, 'binary_precision': 1.0, 'binary_recall': 0.9775815, 'binary_specificity': 1.0, 'binary_f1_score': 0.9886637}
confusion matrix:
       0     1
0  42320     0
1     99  4317
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.97068554, 'recall': 0.52874386, 'specificity': 0.52874386, 'f1': 0.5461076, 'auroc': 0.9358821, 'binary_precision': 0.9736842, 'binary_recall': 0.057542767, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.10866372}
confusion matrix:
       0   1
0  18148   1
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9964602, 'precision': 0.99800694, 'recall': 0.98467433, 'specificity': 0.98467433, 'f1': 0.9912194, 'auroc': 0.99990976, 'binary_precision': 1.0, 'binary_recall': 0.96934867, 'binary_specificity': 1.0, 'binary_f1_score': 0.9844358}
confusion matrix:
      0    1
0  5997    0
1    24  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_22.png
early stop counter: 19
val acc:0.9676989912986755, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 22,now: 2024-06-11 04:16:21.233645,epoch time: 0:32:03.936746,used: 11:50:13.932741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.99949634, 'recall': 0.9962509, 'specificity': 0.9962509, 'f1': 0.997867, 'auroc': 0.9998975, 'binary_precision': 0.99977183, 'binary_recall': 0.99252546, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9961355}
confusion matrix:
       0     1
0  42320     1
1     33  4382
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.84972787, 'recall': 0.5437449, 'specificity': 0.5437449, 'f1': 0.57082367, 'auroc': 0.9369655, 'binary_precision': 0.7307692, 'binary_recall': 0.08864697, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.15811373}
confusion matrix:
       0   1
0  18128  21
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9993937, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_23.png
early stop counter: 20
val acc:0.9676989912986755, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.9966076612472534 / 0.9988200664520264
after epoch: 23,now: 2024-06-11 04:48:33.482493,epoch time: 0:32:12.248848,used: 12:22:26.181589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 12:22:26.181589 at 2024-06-11 04:48:33.482493
persisted model performance metric: 

scalar performance:
{'acc': 0.9974926, 'precision': 0.99858665, 'recall': 0.9891443, 'specificity': 0.9891443, 'f1': 0.9938049, 'auroc': 0.9998535, 'binary_precision': 1.0, 'binary_recall': 0.97828865, 'binary_specificity': 1.0, 'binary_f1_score': 0.9890252}
confusion matrix:
      0    1
0  5997    0
1    17  766
oracle model performance metric: 

scalar performance:
{'acc': 0.9985251, 'precision': 0.9986055, 'recall': 0.9941695, 'specificity': 0.9941695, 'f1': 0.99637413, 'auroc': 0.99996424, 'binary_precision': 0.9987097, 'binary_recall': 0.9885057, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99358153}
confusion matrix:
      0    1
0  5996    1
1     9  774
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB | 697913 GiB | 697911 GiB |
|       from large pool |   1663 MiB |   3191 MiB | 688572 GiB | 688570 GiB |
|       from small pool |      6 MiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB | 697913 GiB | 697911 GiB |
|       from large pool |   1663 MiB |   3191 MiB | 688572 GiB | 688570 GiB |
|       from small pool |      6 MiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB | 697344 GiB | 697343 GiB |
|       from large pool |   1647 MiB |   3177 MiB | 688020 GiB | 688019 GiB |
|       from small pool |      5 MiB |      9 MiB |   9324 GiB |   9324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   3518 MiB |   3518 MiB |      0 B   |
|       from large pool |   3506 MiB |   3506 MiB |   3506 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258094 KiB | 316551 KiB | 390714 GiB | 390714 GiB |
|       from large pool | 254640 KiB | 313088 KiB | 381367 GiB | 381366 GiB |
|       from small pool |   3454 KiB |   5463 KiB |   9347 GiB |   9347 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3558    |    6705    |  114516 K  |  114512 K  |
|       from large pool |     247    |     352    |   44453 K  |   44453 K  |
|       from small pool |    3311    |    6457    |   70062 K  |   70059 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3558    |    6705    |  114516 K  |  114512 K  |
|       from large pool |     247    |     352    |   44453 K  |   44453 K  |
|       from small pool |    3311    |    6457    |   70062 K  |   70059 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     140    |       0    |
|       from large pool |     134    |     134    |     134    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |    3008    |   55502 K  |   55502 K  |
|       from large pool |      78    |     119    |   27287 K  |   27287 K  |
|       from small pool |      18    |    2930    |   28215 K  |   28215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB | 697913 GiB | 697913 GiB |
|       from large pool |  16640 KiB |   3191 MiB | 688572 GiB | 688572 GiB |
|       from small pool |      0 KiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB | 697913 GiB | 697913 GiB |
|       from large pool |  16640 KiB |   3191 MiB | 688572 GiB | 688572 GiB |
|       from small pool |      0 KiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB | 697344 GiB | 697344 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 688020 GiB | 688020 GiB |
|       from small pool |      0 KiB |      9 MiB |   9324 GiB |   9324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 390715 GiB | 390715 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 381368 GiB | 381368 GiB |
|       from small pool |      0 KiB |   9062 KiB |   9347 GiB |   9347 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  114516 K  |  114516 K  |
|       from large pool |       2    |     352    |   44453 K  |   44453 K  |
|       from small pool |       0    |    6457    |   70062 K  |   70062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  114516 K  |  114516 K  |
|       from large pool |       2    |     352    |   44453 K  |   44453 K  |
|       from small pool |       0    |    6457    |   70062 K  |   70062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |   55504 K  |   55504 K  |
|       from large pool |       3    |     119    |   27287 K  |   27287 K  |
|       from small pool |       0    |    2930    |   28216 K  |   28216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB | 697913 GiB | 697913 GiB |
|       from large pool |  16640 KiB |   3191 MiB | 688572 GiB | 688572 GiB |
|       from small pool |      0 KiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB | 697913 GiB | 697913 GiB |
|       from large pool |  16640 KiB |   3191 MiB | 688572 GiB | 688572 GiB |
|       from small pool |      0 KiB |     11 MiB |   9340 GiB |   9340 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB | 697344 GiB | 697344 GiB |
|       from large pool |  16640 KiB |   3177 MiB | 688020 GiB | 688020 GiB |
|       from small pool |      0 KiB |      9 MiB |   9324 GiB |   9324 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 390715 GiB | 390715 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 381368 GiB | 381368 GiB |
|       from small pool |      0 KiB |   9062 KiB |   9347 GiB |   9347 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  114516 K  |  114516 K  |
|       from large pool |       2    |     352    |   44453 K  |   44453 K  |
|       from small pool |       0    |    6457    |   70062 K  |   70062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  114516 K  |  114516 K  |
|       from large pool |       2    |     352    |   44453 K  |   44453 K  |
|       from small pool |       0    |    6457    |   70062 K  |   70062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |   55504 K  |   55504 K  |
|       from large pool |       3    |     119    |   27287 K  |   27287 K  |
|       from small pool |       0    |    2930    |   28216 K  |   28216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198

 Experiment start at: 2024-06-11 04:54:46.699151
before training, model accuracy: 0.1214689239859581
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.996063, 'precision': 0.99784017, 'recall': 0.9787283, 'specificity': 0.9787283, 'f1': 0.98805076, 'auroc': 0.99934137, 'binary_precision': 1.0, 'binary_recall': 0.95745665, 'binary_specificity': 1.0, 'binary_f1_score': 0.97826606}
confusion matrix:
       0     1
0  42411     0
1    184  4141
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.9735285, 'recall': 0.5371194, 'specificity': 0.5371194, 'f1': 0.5605724, 'auroc': 0.9408438, 'binary_precision': 0.98039216, 'binary_recall': 0.0742942, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.13812155}
confusion matrix:
       0   1
0  18066   1
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99479634, 'precision': 0.99707407, 'recall': 0.9775641, 'specificity': 0.9775641, 'f1': 0.9870573, 'auroc': 0.9995452, 'binary_precision': 1.0, 'binary_recall': 0.9551282, 'binary_specificity': 1.0, 'binary_f1_score': 0.9770492}
confusion matrix:
      0    1
0  5946    0
1    35  745
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 05:27:53.391108,epoch time: 0:33:06.691957,used: 0:33:06.691957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9954853, 'precision': 0.99752474, 'recall': 0.9756069, 'specificity': 0.9756069, 'f1': 0.98625785, 'auroc': 0.99952036, 'binary_precision': 1.0, 'binary_recall': 0.9512139, 'binary_specificity': 1.0, 'binary_f1_score': 0.9749971}
confusion matrix:
       0     1
0  42411     0
1    211  4114
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.9391434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9916741, 'precision': 0.99533486, 'recall': 0.96410257, 'specificity': 0.96410257, 'f1': 0.9790395, 'auroc': 0.9987508, 'binary_precision': 1.0, 'binary_recall': 0.92820513, 'binary_specificity': 1.0, 'binary_f1_score': 0.96276593}
confusion matrix:
      0    1
0  5946    0
1    56  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_2.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9947963356971741 / 0.9947963356971741
after epoch: 2,now: 2024-06-11 06:00:00.176219,epoch time: 0:32:06.785111,used: 1:05:13.477068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99696165, 'precision': 0.99822366, 'recall': 0.98368764, 'specificity': 0.98368764, 'f1': 0.9908212, 'auroc': 0.9992353, 'binary_precision': 0.99976104, 'binary_recall': 0.9673988, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98331374}
confusion matrix:
       0     1
0  42410     1
1    141  4184
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73224205, 'recall': 0.5057221, 'specificity': 0.5057221, 'f1': 0.5024648, 'auroc': 0.9117118, 'binary_precision': 0.5, 'binary_recall': 0.011887073, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.02322206}
confusion matrix:
       0  1
0  18059  8
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99479634, 'precision': 0.99707407, 'recall': 0.9775641, 'specificity': 0.9775641, 'f1': 0.9870573, 'auroc': 0.99984694, 'binary_precision': 1.0, 'binary_recall': 0.9551282, 'binary_specificity': 1.0, 'binary_f1_score': 0.9770492}
confusion matrix:
      0    1
0  5946    0
1    35  745
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_3.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9947963356971741 / 0.9947963356971741
after epoch: 3,now: 2024-06-11 06:32:17.674423,epoch time: 0:32:17.498204,used: 1:37:30.975272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99837387, 'precision': 0.99857736, 'recall': 0.99173486, 'specificity': 0.99173486, 'f1': 0.9951265, 'auroc': 0.9995278, 'binary_precision': 0.99882627, 'binary_recall': 0.9835876, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99114835}
confusion matrix:
       0     1
0  42405     5
1     71  4255
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.88968205, 'recall': 0.61413205, 'specificity': 0.61413205, 'f1': 0.6716119, 'auroc': 0.9391978, 'binary_precision': 0.8072917, 'binary_recall': 0.23031203, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.35838148}
confusion matrix:
       0    1
0  18030   37
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99766654, 'recall': 0.98709536, 'specificity': 0.98709536, 'f1': 0.9923047, 'auroc': 0.9999, 'binary_precision': 0.99868596, 'binary_recall': 0.974359, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.98637253}
confusion matrix:
      0    1
0  5945    1
1    20  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-11 07:04:29.622045,epoch time: 0:32:11.947622,used: 2:09:42.922894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9979887, 'precision': 0.9979409, 'recall': 0.9900696, 'specificity': 0.9900696, 'f1': 0.993966, 'auroc': 0.99977577, 'binary_precision': 0.99788237, 'binary_recall': 0.9803514, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9890392}
confusion matrix:
       0     1
0  42401     9
1     85  4241
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.66226023, 'recall': 0.50624365, 'specificity': 0.50624365, 'f1': 0.5036503, 'auroc': 0.9413961, 'binary_precision': 0.36, 'binary_recall': 0.013372957, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.025787966}
confusion matrix:
       0   1
0  18051  16
1    664   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99815685, 'recall': 0.9858974, 'specificity': 0.9858974, 'f1': 0.9919246, 'auroc': 0.9998523, 'binary_precision': 1.0, 'binary_recall': 0.97179484, 'binary_specificity': 1.0, 'binary_f1_score': 0.9856957}
confusion matrix:
      0    1
0  5946    0
1    22  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_5.png
early stop counter: 1
val acc:0.9637140035629272, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9968777894973755
after epoch: 5,now: 2024-06-11 07:36:38.375089,epoch time: 0:32:08.753044,used: 2:41:51.675938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.99907035, 'recall': 0.99086916, 'specificity': 0.99086916, 'f1': 0.9949272, 'auroc': 0.99988973, 'binary_precision': 1.0, 'binary_recall': 0.9817383, 'binary_specificity': 1.0, 'binary_f1_score': 0.990785}
confusion matrix:
       0     1
0  42410     0
1     79  4247
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.8915944, 'recall': 0.5132623, 'specificity': 0.5132623, 'f1': 0.51694185, 'auroc': 0.9562361, 'binary_precision': 0.8181818, 'binary_recall': 0.026745914, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.05179856}
confusion matrix:
       0   1
0  18063   4
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.99986905, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_6.png
new oracle model saved
early stop counter: 2
val acc:0.9648345708847046, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9974724650382996
after epoch: 6,now: 2024-06-11 08:08:49.486493,epoch time: 0:32:11.111404,used: 3:14:02.787342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9981813, 'precision': 0.9989999, 'recall': 0.9901757, 'specificity': 0.9901757, 'f1': 0.99453855, 'auroc': 0.99987376, 'binary_precision': 1.0, 'binary_recall': 0.9803514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9900782}
confusion matrix:
       0     1
0  42410     0
1     85  4241
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.9025808, 'recall': 0.51549107, 'specificity': 0.51549107, 'f1': 0.52116853, 'auroc': 0.9586926, 'binary_precision': 0.84, 'binary_recall': 0.031203566, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.06017192}
confusion matrix:
       0   1
0  18063   4
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.9994731, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_7.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9974724650382996
after epoch: 7,now: 2024-06-11 08:40:56.819170,epoch time: 0:32:07.332677,used: 3:46:10.120019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.99887025, 'recall': 0.9900483, 'specificity': 0.9900483, 'f1': 0.99441004, 'auroc': 0.9997578, 'binary_precision': 0.9997642, 'binary_recall': 0.9801202, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98984474}
confusion matrix:
       0     1
0  42409     1
1     86  4240
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.88505244, 'recall': 0.53018385, 'specificity': 0.53018385, 'f1': 0.54789656, 'auroc': 0.9475739, 'binary_precision': 0.8039216, 'binary_recall': 0.060921248, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.11325967}
confusion matrix:
       0   1
0  18057  10
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.99977344, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_8.png
early stop counter: 4
val acc:0.965741753578186, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9974724650382996
after epoch: 8,now: 2024-06-11 09:13:09.367869,epoch time: 0:32:12.548699,used: 4:18:22.668718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.99930745, 'recall': 0.9954688, 'specificity': 0.9954688, 'f1': 0.9973788, 'auroc': 0.9997015, 'binary_precision': 0.9995337, 'binary_recall': 0.99098474, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99524087}
confusion matrix:
       0     1
0  42408     2
1     39  4287
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.89673793, 'recall': 0.56928307, 'specificity': 0.56928307, 'f1': 0.6112786, 'auroc': 0.94428104, 'binary_precision': 0.8245614, 'binary_recall': 0.1396731, 'binary_specificity': 0.998893, 'binary_f1_score': 0.23888181}
confusion matrix:
       0   1
0  18047  20
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.9999793, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_9.png
new oracle model saved
early stop counter: 5
val acc:0.9680362939834595, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 9,now: 2024-06-11 09:45:21.775149,epoch time: 0:32:12.407280,used: 4:50:35.075998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99899435, 'precision': 0.9993415, 'recall': 0.99467146, 'specificity': 0.99467146, 'f1': 0.9969927, 'auroc': 0.9999254, 'binary_precision': 0.9997664, 'binary_recall': 0.9893666, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9945393}
confusion matrix:
       0     1
0  42409     1
1     46  4280
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.9523386, 'recall': 0.54446584, 'specificity': 0.54446584, 'f1': 0.573015, 'auroc': 0.96171653, 'binary_precision': 0.9375, 'binary_recall': 0.089153044, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.16282225}
confusion matrix:
       0   1
0  18063   4
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.99874187, 'recall': 0.9903846, 'specificity': 0.9903846, 'f1': 0.9945158, 'auroc': 0.9998452, 'binary_precision': 1.0, 'binary_recall': 0.9807692, 'binary_specificity': 1.0, 'binary_f1_score': 0.9902913}
confusion matrix:
      0    1
0  5946    0
1    15  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_10.png
early stop counter: 6
val acc:0.967075765132904, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 10,now: 2024-06-11 10:17:19.198257,epoch time: 0:31:57.423108,used: 5:22:32.499106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.9995066, 'recall': 0.9962896, 'specificity': 0.9962896, 'f1': 0.99789155, 'auroc': 0.9997986, 'binary_precision': 0.9997672, 'binary_recall': 0.9926029, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99617213}
confusion matrix:
       0     1
0  42409     1
1     32  4294
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.93294036, 'recall': 0.55844337, 'specificity': 0.55844337, 'f1': 0.5955998, 'auroc': 0.9625231, 'binary_precision': 0.89772725, 'binary_recall': 0.11738484, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.20762156}
confusion matrix:
       0   1
0  18058   9
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.99992, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_11.png
early stop counter: 7
val acc:0.9678228497505188, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 11,now: 2024-06-11 10:49:31.194604,epoch time: 0:32:11.996347,used: 5:54:44.495453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.9993547, 'recall': 0.9959302, 'specificity': 0.9959302, 'f1': 0.9976351, 'auroc': 0.9998913, 'binary_precision': 0.999534, 'binary_recall': 0.99190754, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9957062}
confusion matrix:
       0     1
0  42409     2
1     35  4290
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.8545766, 'recall': 0.52126855, 'specificity': 0.52126855, 'f1': 0.53183675, 'auroc': 0.95578396, 'binary_precision': 0.74358976, 'binary_recall': 0.043090638, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.08146068}
confusion matrix:
       0   1
0  18057  10
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.99602205, 'recall': 0.9938103, 'specificity': 0.9938103, 'f1': 0.99491286, 'auroc': 0.9998112, 'binary_precision': 0.9935567, 'binary_recall': 0.98846155, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.99100256}
confusion matrix:
      0    1
0  5941    5
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_12.png
early stop counter: 8
val acc:0.9651013612747192, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 12,now: 2024-06-11 11:21:45.036842,epoch time: 0:32:13.842238,used: 6:26:58.337691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.99909824, 'recall': 0.9956764, 'specificity': 0.9956764, 'f1': 0.99737996, 'auroc': 0.9998481, 'binary_precision': 0.99906826, 'binary_recall': 0.9914471, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.99524313}
confusion matrix:
       0     1
0  42406     4
1     37  4289
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.84803426, 'recall': 0.55494577, 'specificity': 0.55494577, 'f1': 0.58812183, 'auroc': 0.9498471, 'binary_precision': 0.7281553, 'binary_recall': 0.11144131, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.19329897}
confusion matrix:
       0   1
0  18039  28
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.9999461, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_13.png
early stop counter: 9
val acc:0.9665955305099487, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 13,now: 2024-06-11 11:53:45.069132,epoch time: 0:32:00.032290,used: 6:58:58.369981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99895155, 'precision': 0.9990032, 'recall': 0.9947505, 'specificity': 0.9947505, 'f1': 0.99686545, 'auroc': 0.9998195, 'binary_precision': 0.9990663, 'binary_recall': 0.98959535, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9943083}
confusion matrix:
       0     1
0  42407     4
1     45  4280
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.8359881, 'recall': 0.61258656, 'specificity': 0.61258656, 'f1': 0.66445774, 'auroc': 0.94623554, 'binary_precision': 0.7, 'binary_recall': 0.22882615, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.3449048}
confusion matrix:
       0    1
0  18001   66
1    519  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.99993294, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_14.png
early stop counter: 10
val acc:0.9687833786010742, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 14,now: 2024-06-11 12:24:59.290045,epoch time: 0:31:14.220913,used: 7:30:12.590894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99835247, 'precision': 0.99814457, 'recall': 0.99203265, 'specificity': 0.99203265, 'f1': 0.995065, 'auroc': 0.99971914, 'binary_precision': 0.9978903, 'binary_recall': 0.9842774, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99103713}
confusion matrix:
       0     1
0  42402     9
1     68  4257
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.5820876, 'recall': 0.50126445, 'specificity': 0.50126445, 'f1': 0.49370196, 'auroc': 0.9545299, 'binary_precision': 0.2, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0058565154}
confusion matrix:
       0  1
0  18059  8
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.99996936, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_15.png
early stop counter: 11
val acc:0.9637673497200012, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 15,now: 2024-06-11 12:56:38.606966,epoch time: 0:31:39.316921,used: 8:01:51.907815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9994712, 'recall': 0.995942, 'specificity': 0.995942, 'f1': 0.9976988, 'auroc': 0.99989927, 'binary_precision': 0.99976695, 'binary_recall': 0.99190754, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9958218}
confusion matrix:
       0     1
0  42410     1
1     35  4290
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.95753205, 'recall': 0.5140882, 'specificity': 0.5140882, 'f1': 0.5185144, 'auroc': 0.9628208, 'binary_precision': 0.95, 'binary_recall': 0.028231798, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.054834053}
confusion matrix:
       0   1
0  18066   1
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.99998903, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_16.png
early stop counter: 12
val acc:0.9650480151176453, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 16,now: 2024-06-11 13:29:11.442065,epoch time: 0:32:32.835099,used: 8:34:24.742914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.9989412, 'recall': 0.9918858, 'specificity': 0.9918858, 'f1': 0.9953821, 'auroc': 0.9998828, 'binary_precision': 0.9995303, 'binary_recall': 0.98381877, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9916123}
confusion matrix:
       0     1
0  42408     2
1     70  4256
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.9371265, 'recall': 0.55032635, 'specificity': 0.55032635, 'f1': 0.58257854, 'auroc': 0.9509311, 'binary_precision': 0.9066667, 'binary_recall': 0.10104012, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.18181819}
confusion matrix:
       0   1
0  18060   7
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.99996525, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_17.png
early stop counter: 13
val acc:0.9673425555229187, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9968777894973755 / 0.9988105893135071
after epoch: 17,now: 2024-06-11 14:00:57.212617,epoch time: 0:31:45.770552,used: 9:06:10.513466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99713284, 'precision': 0.9872477, 'recall': 0.9959286, 'specificity': 0.9959286, 'f1': 0.99153996, 'auroc': 0.99951327, 'binary_precision': 0.9750624, 'binary_recall': 0.99445087, 'binary_specificity': 0.9974063, 'binary_f1_score': 0.9846612}
confusion matrix:
       0     1
0  42301   110
1     24  4301
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.82239616, 'recall': 0.69831645, 'specificity': 0.69831645, 'f1': 0.7442423, 'auroc': 0.9585361, 'binary_precision': 0.6666667, 'binary_recall': 0.40416047, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.5032378}
confusion matrix:
       0    1
0  17931  136
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.9999937, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-06-11 14:31:51.519489,epoch time: 0:30:54.306872,used: 9:37:04.820338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.99859375, 'recall': 0.99413717, 'specificity': 0.99413717, 'f1': 0.9963529, 'auroc': 0.999972, 'binary_precision': 0.9983652, 'binary_recall': 0.9884393, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9933775}
confusion matrix:
       0     1
0  42404     7
1     50  4275
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.88378453, 'recall': 0.5500496, 'specificity': 0.5500496, 'f1': 0.5812407, 'auroc': 0.95618224, 'binary_precision': 0.8, 'binary_recall': 0.10104012, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.17941952}
confusion matrix:
       0   1
0  18050  17
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.9984909, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9934078, 'auroc': 0.9997895, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0    1
0  5946    0
1    18  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_19.png
early stop counter: 1
val acc:0.9668089747428894, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 19,now: 2024-06-11 15:03:16.029787,epoch time: 0:31:24.510298,used: 10:08:29.330636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9986734, 'precision': 0.99916464, 'recall': 0.9929378, 'specificity': 0.9929378, 'f1': 0.99602675, 'auroc': 0.9999562, 'binary_precision': 0.9997656, 'binary_recall': 0.9858992, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9927839}
confusion matrix:
       0     1
0  42409     1
1     61  4265
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.9483719, 'recall': 0.6096233, 'specificity': 0.6096233, 'f1': 0.6703445, 'auroc': 0.96236134, 'binary_precision': 0.925, 'binary_recall': 0.21991085, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.35534215}
confusion matrix:
       0    1
0  18055   12
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961344, 'precision': 0.9978232, 'recall': 0.98333335, 'specificity': 0.98333335, 'f1': 0.99043465, 'auroc': 0.99966574, 'binary_precision': 1.0, 'binary_recall': 0.96666664, 'binary_specificity': 1.0, 'binary_f1_score': 0.9830508}
confusion matrix:
      0    1
0  5946    0
1    26  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_20.png
early stop counter: 2
val acc:0.9713447093963623, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 20,now: 2024-06-11 15:36:41.156046,epoch time: 0:33:25.126259,used: 10:41:54.456895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9937949, 'precision': 0.9725747, 'recall': 0.9917028, 'specificity': 0.9917028, 'f1': 0.98189867, 'auroc': 0.9995209, 'binary_precision': 0.9462627, 'binary_recall': 0.98913544, 'binary_specificity': 0.9942702, 'binary_f1_score': 0.96722424}
confusion matrix:
       0     1
0  42167   243
1     47  4279
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7548409, 'recall': 0.7262778, 'specificity': 0.7262778, 'f1': 0.7396135, 'auroc': 0.95642424, 'binary_precision': 0.5294118, 'binary_recall': 0.4680535, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.49684545}
confusion matrix:
       0    1
0  17787  280
1    358  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.9939275, 'recall': 0.99227595, 'specificity': 0.99227595, 'f1': 0.99309987, 'auroc': 0.99948657, 'binary_precision': 0.989704, 'binary_recall': 0.9858974, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.987797}
confusion matrix:
      0    1
0  5938    8
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_21.png
early stop counter: 3
val acc:0.9659551978111267, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 21,now: 2024-06-11 16:08:46.882015,epoch time: 0:32:05.725969,used: 11:14:00.182864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.99936414, 'recall': 0.99375725, 'specificity': 0.99375725, 'f1': 0.9965409, 'auroc': 0.999729, 'binary_precision': 1.0, 'binary_recall': 0.98751444, 'binary_specificity': 1.0, 'binary_f1_score': 0.99371797}
confusion matrix:
       0     1
0  42411     0
1     54  4271
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.8154276, 'recall': 0.50145817, 'specificity': 0.50145817, 'f1': 0.4938291, 'auroc': 0.9548557, 'binary_precision': 0.6666667, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0059171594}
confusion matrix:
       0  1
0  18066  1
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.9999813, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_22.png
early stop counter: 4
val acc:0.9641408920288086, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 22,now: 2024-06-11 16:41:38.132215,epoch time: 0:32:51.250200,used: 11:46:51.433064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.99759, 'recall': 0.9955231, 'specificity': 0.9955231, 'f1': 0.9965539, 'auroc': 0.9998727, 'binary_precision': 0.996052, 'binary_recall': 0.9914471, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.99374425}
confusion matrix:
       0     1
0  42393    17
1     37  4289
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.85803723, 'recall': 0.52861494, 'specificity': 0.52861494, 'f1': 0.5449916, 'auroc': 0.9582851, 'binary_precision': 0.75, 'binary_recall': 0.05794948, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.107586205}
confusion matrix:
       0   1
0  18054  13
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9993682, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_23.png
early stop counter: 5
val acc:0.9654749035835266, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 23,now: 2024-06-11 17:13:12.300393,epoch time: 0:31:34.168178,used: 12:18:25.601242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.9995171, 'recall': 0.9952601, 'specificity': 0.9952601, 'f1': 0.9973772, 'auroc': 0.9999291, 'binary_precision': 1.0, 'binary_recall': 0.99052024, 'binary_specificity': 1.0, 'binary_f1_score': 0.9952375}
confusion matrix:
       0     1
0  42411     0
1     41  4284
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.8625274, 'recall': 0.5139498, 'specificity': 0.5139498, 'f1': 0.51824886, 'auroc': 0.94326067, 'binary_precision': 0.76, 'binary_recall': 0.028231798, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.05444126}
confusion matrix:
       0   1
0  18061   6
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9998316, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_24.png
early stop counter: 6
val acc:0.9647812247276306, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 24,now: 2024-06-11 17:45:11.742973,epoch time: 0:31:59.442580,used: 12:50:25.043822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.998759, 'precision': 0.99868655, 'recall': 0.9939177, 'specificity': 0.9939177, 'f1': 0.99628776, 'auroc': 0.9999068, 'binary_precision': 0.9985978, 'binary_recall': 0.98797685, 'binary_specificity': 0.9998585, 'binary_f1_score': 0.99325895}
confusion matrix:
       0     1
0  42405     6
1     52  4273
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.795998, 'recall': 0.5813276, 'specificity': 0.5813276, 'f1': 0.62271476, 'auroc': 0.9592142, 'binary_precision': 0.62222224, 'binary_recall': 0.16641901, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.26260257}
confusion matrix:
       0    1
0  17999   68
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99815685, 'recall': 0.9858974, 'specificity': 0.9858974, 'f1': 0.9919246, 'auroc': 0.9998089, 'binary_precision': 1.0, 'binary_recall': 0.97179484, 'binary_specificity': 1.0, 'binary_f1_score': 0.9856957}
confusion matrix:
      0    1
0  5946    0
1    22  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_25.png
early stop counter: 7
val acc:0.966435432434082, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 25,now: 2024-06-11 18:17:03.556528,epoch time: 0:31:51.813555,used: 13:22:16.857377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.9995774, 'recall': 0.99698246, 'specificity': 0.99698246, 'f1': 0.99827564, 'auroc': 0.9999517, 'binary_precision': 0.9997674, 'binary_recall': 0.99398845, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99686956}
confusion matrix:
       0     1
0  42410     1
1     26  4299
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.89109254, 'recall': 0.53904384, 'specificity': 0.53904384, 'f1': 0.5632152, 'auroc': 0.954888, 'binary_precision': 0.8153846, 'binary_recall': 0.078751855, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.14363143}
confusion matrix:
       0   1
0  18055  12
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9999575, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_26.png
early stop counter: 8
val acc:0.9662753343582153, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 26,now: 2024-06-11 18:48:29.174123,epoch time: 0:31:25.617595,used: 13:53:42.474972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9994009, 'precision': 0.99967015, 'recall': 0.99676377, 'specificity': 0.99676377, 'f1': 0.9982116, 'auroc': 0.9999881, 'binary_precision': 1.0, 'binary_recall': 0.99352753, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967533}
confusion matrix:
       0     1
0  42410     0
1     28  4298
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.95557874, 'recall': 0.537807, 'specificity': 0.537807, 'f1': 0.5616486, 'auroc': 0.96110463, 'binary_precision': 0.9444444, 'binary_recall': 0.075780086, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.14030261}
confusion matrix:
       0   1
0  18064   3
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9999877, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_27.png
early stop counter: 9
val acc:0.9666488766670227, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 27,now: 2024-06-11 19:20:48.837979,epoch time: 0:32:19.663856,used: 14:26:02.138828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99841666, 'precision': 0.9991291, 'recall': 0.99144506, 'specificity': 0.99144506, 'f1': 0.99524987, 'auroc': 0.9996568, 'binary_precision': 1.0, 'binary_recall': 0.9828902, 'binary_specificity': 1.0, 'binary_f1_score': 0.99137133}
confusion matrix:
       0     1
0  42411     0
1     74  4251
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.9641008, 'recall': 0.53709173, 'specificity': 0.53709173, 'f1': 0.56046325, 'auroc': 0.9453892, 'binary_precision': 0.96153843, 'binary_recall': 0.0742942, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.13793103}
confusion matrix:
       0   1
0  18065   2
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.9997065, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_28.png
early stop counter: 10
val acc:0.9666488766670227, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 28,now: 2024-06-11 19:52:09.100475,epoch time: 0:31:20.262496,used: 14:57:22.401324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9995877, 'recall': 0.9959547, 'specificity': 0.9959547, 'f1': 0.9977629, 'auroc': 0.99986243, 'binary_precision': 1.0, 'binary_recall': 0.9919094, 'binary_specificity': 1.0, 'binary_f1_score': 0.99593824}
confusion matrix:
       0     1
0  42410     0
1     35  4291
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.9115621, 'recall': 0.62178284, 'specificity': 0.62178284, 'f1': 0.6829779, 'auroc': 0.9554062, 'binary_precision': 0.8505155, 'binary_recall': 0.24517088, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.38062283}
confusion matrix:
       0    1
0  18038   29
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.9984909, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9934078, 'auroc': 0.99995995, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0    1
0  5946    0
1    18  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_29.png
early stop counter: 11
val acc:0.9713447093963623, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 29,now: 2024-06-11 20:22:58.382456,epoch time: 0:30:49.281981,used: 15:28:11.683305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.99961126, 'recall': 0.99618495, 'specificity': 0.99618495, 'f1': 0.9978907, 'auroc': 0.9999833, 'binary_precision': 1.0, 'binary_recall': 0.99236995, 'binary_specificity': 1.0, 'binary_f1_score': 0.9961704}
confusion matrix:
       0     1
0  42411     0
1     33  4292
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.9522427, 'recall': 0.5748434, 'specificity': 0.5748434, 'f1': 0.6214329, 'auroc': 0.9483117, 'binary_precision': 0.9351852, 'binary_recall': 0.15007429, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.25864276}
confusion matrix:
       0    1
0  18060    7
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99990016, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_30.png
early stop counter: 12
val acc:0.9691035151481628, best validation acc: 0.9713447093963623, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 30,now: 2024-06-11 20:54:03.768973,epoch time: 0:31:05.386517,used: 15:59:17.069822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_54_46_seed_1_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:59:17.069822 at 2024-06-11 20:54:03.768973
persisted model performance metric: 

scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.99924874, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
oracle model performance metric: 

scalar performance:
{'acc': 0.99895924, 'precision': 0.99941206, 'recall': 0.99551284, 'specificity': 0.99551284, 'f1': 0.99745214, 'auroc': 0.99997413, 'binary_precision': 1.0, 'binary_recall': 0.9910256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954926}
confusion matrix:
      0    1
0  5946    0
1     7  773
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      6 MiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      6 MiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1567 TiB |   1567 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      5 MiB |      9 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3500 MiB |   3518 MiB |   5096 MiB |   1596 MiB |
|       from large pool |   3488 MiB |   3506 MiB |   5082 MiB |   1594 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 219671 KiB | 316551 KiB |    887 TiB |    887 TiB |
|       from large pool | 216208 KiB | 313088 KiB |    866 TiB |    866 TiB |
|       from small pool |   3463 KiB |   9062 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6705    |  263602 K  |  263598 K  |
|       from large pool |     247    |     352    |  102351 K  |  102351 K  |
|       from small pool |    3293    |    6457    |  161250 K  |  161246 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6705    |  263602 K  |  263598 K  |
|       from large pool |     247    |     352    |  102351 K  |  102351 K  |
|       from small pool |    3293    |    6457    |  161250 K  |  161246 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     187    |      47    |
|       from large pool |     134    |     134    |     180    |      46    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    3008    |  129749 K  |  129749 K  |
|       from large pool |      76    |     119    |   63469 K  |   63469 K  |
|       from small pool |      19    |    2930    |   66280 K  |   66280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      0 KiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      0 KiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1567 TiB |   1567 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |      9 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |   3518 MiB |   5096 MiB |   3212 MiB |
|       from large pool |   1874 MiB |   3506 MiB |   5082 MiB |   3208 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    887 TiB |    887 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |   9311 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  263602 K  |  263602 K  |
|       from large pool |       2    |     352    |  102351 K  |  102351 K  |
|       from small pool |       0    |    6457    |  161250 K  |  161250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  263602 K  |  263602 K  |
|       from large pool |       2    |     352    |  102351 K  |  102351 K  |
|       from small pool |       0    |    6457    |  161250 K  |  161250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     140    |     187    |      95    |
|       from large pool |      87    |     134    |     180    |      93    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |  129751 K  |  129751 K  |
|       from large pool |       3    |     119    |   63469 K  |   63469 K  |
|       from small pool |       0    |    2930    |   66281 K  |   66281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      0 KiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1569 TiB |   1569 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1548 TiB |   1548 TiB |
|       from small pool |      0 KiB |     11 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1567 TiB |   1567 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |      9 MiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |   3518 MiB |   5096 MiB |   3212 MiB |
|       from large pool |   1874 MiB |   3506 MiB |   5082 MiB |   3208 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    887 TiB |    887 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |   9311 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  263602 K  |  263602 K  |
|       from large pool |       2    |     352    |  102351 K  |  102351 K  |
|       from small pool |       0    |    6457    |  161250 K  |  161250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  263602 K  |  263602 K  |
|       from large pool |       2    |     352    |  102351 K  |  102351 K  |
|       from small pool |       0    |    6457    |  161250 K  |  161250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     140    |     187    |      95    |
|       from large pool |      87    |     134    |     180    |      93    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |  129751 K  |  129751 K  |
|       from large pool |       3    |     119    |   63469 K  |   63469 K  |
|       from small pool |       0    |    2930    |   66281 K  |   66281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198

 Experiment start at: 2024-06-11 21:00:15.923304
before training, model accuracy: 0.18399523198604584
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9963499, 'precision': 0.99278194, 'recall': 0.98627687, 'specificity': 0.98627687, 'f1': 0.98950195, 'auroc': 0.9993112, 'binary_precision': 0.9883721, 'binary_recall': 0.9737828, 'binary_specificity': 0.99877095, 'binary_f1_score': 0.9810232}
confusion matrix:
       0     1
0  42257    52
1    119  4420
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.7684727, 'recall': 0.67065394, 'specificity': 0.67065394, 'f1': 0.7076761, 'auroc': 0.93559813, 'binary_precision': 0.5582011, 'binary_recall': 0.35049835, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.43061227}
confusion matrix:
       0    1
0  18004  167
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.9987894, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 21:32:34.005749,epoch time: 0:32:18.082445,used: 0:32:18.082445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99652064, 'precision': 0.99797857, 'recall': 0.9821428, 'specificity': 0.9821428, 'f1': 0.9898988, 'auroc': 0.9995724, 'binary_precision': 0.9997716, 'binary_recall': 0.96430933, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9817203}
confusion matrix:
       0     1
0  42308     1
1    162  4377
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.9404571, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99360406, 'precision': 0.9964404, 'recall': 0.9703857, 'specificity': 0.9703857, 'f1': 0.9829548, 'auroc': 0.9982468, 'binary_precision': 1.0, 'binary_recall': 0.94077134, 'binary_specificity': 1.0, 'binary_f1_score': 0.9694819}
confusion matrix:
      0    1
0  5997    0
1    43  683
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9702764749526978, corresponding to test acc:                         0.9958351850509644 / 0.9958351850509644
after epoch: 2,now: 2024-06-11 22:03:57.437906,epoch time: 0:31:23.432157,used: 1:03:41.514602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9970757, 'precision': 0.99757427, 'recall': 0.98569214, 'specificity': 0.98569214, 'f1': 0.99154234, 'auroc': 0.9991504, 'binary_precision': 0.9981888, 'binary_recall': 0.97157335, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9847013}
confusion matrix:
       0     1
0  42302     8
1    129  4409
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.9341976, 'recall': 0.5074476, 'specificity': 0.5074476, 'f1': 0.5066645, 'auroc': 0.9481708, 'binary_precision': 0.9, 'binary_recall': 0.014950166, 'binary_specificity': 0.999945, 'binary_f1_score': 0.029411767}
confusion matrix:
       0  1
0  18170  1
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.9993153, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_3.png
new oracle model saved
early stop counter: 2
val acc:0.9683588147163391, best validation acc: 0.9702764749526978, corresponding to test acc:                         0.9958351850509644 / 0.9965789318084717
after epoch: 3,now: 2024-06-11 22:35:18.554936,epoch time: 0:31:21.117030,used: 1:35:02.631632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9964993, 'precision': 0.99444294, 'recall': 0.9854746, 'specificity': 0.9854746, 'f1': 0.98990667, 'auroc': 0.9995161, 'binary_precision': 0.9919047, 'binary_recall': 0.97179997, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.9817494}
confusion matrix:
       0     1
0  42273    36
1    128  4411
---- Validation: 
scalar performance:
{'acc': 0.97299314, 'precision': 0.84742934, 'recall': 0.62788963, 'specificity': 0.62788963, 'f1': 0.68357396, 'auroc': 0.94189894, 'binary_precision': 0.718894, 'binary_recall': 0.2591362, 'binary_specificity': 0.996643, 'binary_f1_score': 0.38095236}
confusion matrix:
       0    1
0  18110   61
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99360406, 'precision': 0.9964404, 'recall': 0.9703857, 'specificity': 0.9703857, 'f1': 0.9829548, 'auroc': 0.99955165, 'binary_precision': 1.0, 'binary_recall': 0.94077134, 'binary_specificity': 1.0, 'binary_f1_score': 0.9694819}
confusion matrix:
      0    1
0  5997    0
1    43  683
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 23:06:45.528624,epoch time: 0:31:26.973688,used: 2:06:29.605320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99850583, 'precision': 0.9987744, 'recall': 0.9926824, 'specificity': 0.9926824, 'f1': 0.9957047, 'auroc': 0.99982333, 'binary_precision': 0.9991065, 'binary_recall': 0.9854593, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.992236}
confusion matrix:
       0     1
0  42305     4
1     66  4473
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.90964895, 'recall': 0.54623646, 'specificity': 0.54623646, 'f1': 0.57629395, 'auroc': 0.9548024, 'binary_precision': 0.8484849, 'binary_recall': 0.093023255, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.16766468}
confusion matrix:
       0   1
0  18161  10
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.99985075, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_5.png
new oracle model saved
early stop counter: 1
val acc:0.9703829884529114, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9977688789367676
after epoch: 5,now: 2024-06-11 23:38:13.116048,epoch time: 0:31:27.587424,used: 2:37:57.192744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99850583, 'precision': 0.9990741, 'recall': 0.9923874, 'specificity': 0.9923874, 'f1': 0.99570215, 'auroc': 0.99952674, 'binary_precision': 0.99977636, 'binary_recall': 0.98479843, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9922309}
confusion matrix:
       0     1
0  42308     1
1     69  4470
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.8126213, 'recall': 0.5554878, 'specificity': 0.5554878, 'f1': 0.58858114, 'auroc': 0.9415674, 'binary_precision': 0.65384614, 'binary_recall': 0.11295681, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.19263457}
confusion matrix:
       0   1
0  18135  36
1    534  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.997759, 'recall': 0.98140496, 'specificity': 0.98140496, 'f1': 0.98940325, 'auroc': 0.9990821, 'binary_precision': 1.0, 'binary_recall': 0.9628099, 'binary_specificity': 1.0, 'binary_f1_score': 0.98105264}
confusion matrix:
      0    1
0  5997    0
1    27  699
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_6.png
early stop counter: 2
val acc:0.9696372747421265, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9977688789367676
after epoch: 6,now: 2024-06-12 00:09:43.583075,epoch time: 0:31:30.467027,used: 3:09:27.659771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9991248, 'precision': 0.9989215, 'recall': 0.9960736, 'specificity': 0.9960736, 'f1': 0.9974924, 'auroc': 0.9998826, 'binary_precision': 0.9986696, 'binary_recall': 0.99228907, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9954691}
confusion matrix:
       0     1
0  42303     6
1     35  4504
---- Validation: 
scalar performance:
{'acc': 0.97283334, 'precision': 0.8232081, 'recall': 0.6486863, 'specificity': 0.6486863, 'f1': 0.7012844, 'auroc': 0.9610482, 'binary_precision': 0.6691176, 'binary_recall': 0.30232558, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.41647598}
confusion matrix:
       0    1
0  18081   90
1    420  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.99992055, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_7.png
new oracle model saved
early stop counter: 3
val acc:0.9728333353996277, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 7,now: 2024-06-12 00:41:14.297612,epoch time: 0:31:30.714537,used: 3:40:58.374308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99848443, 'precision': 0.9983643, 'recall': 0.9929656, 'specificity': 0.9929656, 'f1': 0.99564636, 'auroc': 0.99972165, 'binary_precision': 0.99821585, 'binary_recall': 0.9861203, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9921312}
confusion matrix:
       0     1
0  42301     8
1     63  4476
---- Validation: 
scalar performance:
{'acc': 0.97182125, 'precision': 0.8780369, 'recall': 0.5831166, 'specificity': 0.5831166, 'f1': 0.63098234, 'auroc': 0.9605413, 'binary_precision': 0.78294575, 'binary_recall': 0.16777408, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.27633378}
confusion matrix:
       0    1
0  18143   28
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.9997917, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_8.png
early stop counter: 4
val acc:0.9718212485313416, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 8,now: 2024-06-12 01:12:48.524753,epoch time: 0:31:34.227141,used: 4:12:32.601449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9987406, 'precision': 0.9992039, 'recall': 0.9935977, 'specificity': 0.9935977, 'f1': 0.9963807, 'auroc': 0.99963, 'binary_precision': 0.99977684, 'binary_recall': 0.98721904, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9934582}
confusion matrix:
       0     1
0  42309     1
1     58  4480
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.9551786, 'recall': 0.538954, 'specificity': 0.538954, 'f1': 0.5645237, 'auroc': 0.95740664, 'binary_precision': 0.94, 'binary_recall': 0.07807309, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.14417177}
confusion matrix:
       0   1
0  18168   3
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99959433, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_9.png
early stop counter: 5
val acc:0.9702764749526978, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 9,now: 2024-06-12 01:44:11.092496,epoch time: 0:31:22.567743,used: 4:43:55.169192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9986766, 'precision': 0.99926835, 'recall': 0.99317026, 'specificity': 0.99317026, 'f1': 0.99619555, 'auroc': 0.9999044, 'binary_precision': 1.0, 'binary_recall': 0.9863406, 'binary_specificity': 1.0, 'binary_f1_score': 0.99312335}
confusion matrix:
       0     1
0  42309     0
1     62  4477
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6089896, 'recall': 0.50074804, 'specificity': 0.50074804, 'f1': 0.49347475, 'auroc': 0.9528562, 'binary_precision': 0.25, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0033003301}
confusion matrix:
       0  1
0  18168  3
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.99996877, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_10.png
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 10,now: 2024-06-12 02:15:29.657680,epoch time: 0:31:18.565184,used: 5:15:13.734376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99863386, 'precision': 0.9991449, 'recall': 0.99304676, 'specificity': 0.99304676, 'f1': 0.99607205, 'auroc': 0.9998471, 'binary_precision': 0.9997766, 'binary_recall': 0.98611724, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99289995}
confusion matrix:
       0     1
0  42309     1
1     63  4475
---- Validation: 
scalar performance:
{'acc': 0.97246045, 'precision': 0.8691195, 'recall': 0.60111386, 'specificity': 0.60111386, 'f1': 0.654178, 'auroc': 0.9544542, 'binary_precision': 0.76397514, 'binary_recall': 0.20431894, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.32241154}
confusion matrix:
       0    1
0  18133   38
1    479  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.99983084, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_11.png
early stop counter: 7
val acc:0.9724604487419128, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 11,now: 2024-06-12 02:46:41.838122,epoch time: 0:31:12.180442,used: 5:46:25.914818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9983137, 'precision': 0.99906814, 'recall': 0.9912976, 'specificity': 0.9912976, 'f1': 0.99514425, 'auroc': 0.99976563, 'binary_precision': 1.0, 'binary_recall': 0.98259526, 'binary_specificity': 1.0, 'binary_f1_score': 0.99122125}
confusion matrix:
       0     1
0  42309     0
1     79  4460
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.93879706, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.99987257, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_12.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 12,now: 2024-06-12 03:17:59.327771,epoch time: 0:31:17.489649,used: 6:17:43.404467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99526125, 'precision': 0.9789658, 'recall': 0.9947213, 'specificity': 0.9947213, 'f1': 0.98668045, 'auroc': 0.99972695, 'binary_precision': 0.9585723, 'binary_recall': 0.9940516, 'binary_specificity': 0.9953911, 'binary_f1_score': 0.97598964}
confusion matrix:
       0     1
0  42114   195
1     27  4512
---- Validation: 
scalar performance:
{'acc': 0.9555745, 'precision': 0.6638449, 'recall': 0.7040149, 'specificity': 0.7040149, 'f1': 0.68140763, 'auroc': 0.9226611, 'binary_precision': 0.34656084, 'binary_recall': 0.43521595, 'binary_specificity': 0.97281384, 'binary_f1_score': 0.38586158}
confusion matrix:
       0    1
0  17677  494
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.9928677, 'recall': 0.9916739, 'specificity': 0.9916739, 'f1': 0.9922698, 'auroc': 0.99891543, 'binary_precision': 0.98756903, 'binary_recall': 0.9848485, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.9862069}
confusion matrix:
      0    1
0  5988    9
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_13.png
early stop counter: 9
val acc:0.9555745124816895, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 13,now: 2024-06-12 03:49:19.806681,epoch time: 0:31:20.478910,used: 6:49:03.883377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979508, 'precision': 0.99886805, 'recall': 0.98942494, 'specificity': 0.98942494, 'f1': 0.99408937, 'auroc': 0.99974823, 'binary_precision': 1.0, 'binary_recall': 0.97884995, 'binary_specificity': 1.0, 'binary_f1_score': 0.989312}
confusion matrix:
       0     1
0  42309     0
1     96  4443
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7654426, 'recall': 0.5072825, 'specificity': 0.5072825, 'f1': 0.50643915, 'auroc': 0.952703, 'binary_precision': 0.5625, 'binary_recall': 0.014950166, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.029126214}
confusion matrix:
       0  1
0  18164  7
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.99997497, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_14.png
early stop counter: 10
val acc:0.9680392146110535, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9983638525009155
after epoch: 14,now: 2024-06-12 04:20:37.465260,epoch time: 0:31:17.658579,used: 7:20:21.541956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99921024, 'precision': 0.9992658, 'recall': 0.9962192, 'specificity': 0.9962192, 'f1': 0.9977366, 'auroc': 0.99985796, 'binary_precision': 0.9993345, 'binary_recall': 0.99250937, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9959102}
confusion matrix:
       0     1
0  42306     3
1     34  4505
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.8476559, 'recall': 0.5303457, 'specificity': 0.5303457, 'f1': 0.54881454, 'auroc': 0.9519669, 'binary_precision': 0.7254902, 'binary_recall': 0.061461795, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.11332312}
confusion matrix:
       0   1
0  18157  14
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.99975884, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_15.png
new oracle model saved
early stop counter: 11
val acc:0.9691578149795532, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9986613392829895
after epoch: 15,now: 2024-06-12 04:51:58.430456,epoch time: 0:31:20.965196,used: 7:51:42.507152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99908215, 'precision': 0.99949235, 'recall': 0.9952633, 'specificity': 0.9952633, 'f1': 0.9973664, 'auroc': 0.99986947, 'binary_precision': 1.0, 'binary_recall': 0.99052656, 'binary_specificity': 1.0, 'binary_f1_score': 0.99524075}
confusion matrix:
       0     1
0  42309     0
1     43  4496
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7968458, 'recall': 0.5122108, 'specificity': 0.5122108, 'f1': 0.5158901, 'auroc': 0.91601527, 'binary_precision': 0.625, 'binary_recall': 0.024916943, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.047923323}
confusion matrix:
       0   1
0  18162   9
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.99997103, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_16.png
new oracle model saved
early stop counter: 12
val acc:0.9682523012161255, best validation acc: 0.9729931354522705, corresponding to test acc:                         0.9936040639877319 / 0.9988100528717041
after epoch: 16,now: 2024-06-12 05:23:17.984781,epoch time: 0:31:19.554325,used: 8:23:02.061477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99933827, 'precision': 0.99953485, 'recall': 0.9966835, 'specificity': 0.9966835, 'f1': 0.998104, 'auroc': 0.9998578, 'binary_precision': 0.9997783, 'binary_recall': 0.9933906, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9965743}
confusion matrix:
       0     1
0  42308     1
1     30  4509
---- Validation: 
scalar performance:
{'acc': 0.9750173, 'precision': 0.92173415, 'recall': 0.6297383, 'specificity': 0.6297383, 'f1': 0.69413215, 'auroc': 0.9481057, 'binary_precision': 0.8674033, 'binary_recall': 0.26079735, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.40102175}
confusion matrix:
       0    1
0  18147   24
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9990015, 'recall': 0.9917356, 'specificity': 0.9917356, 'f1': 0.99533355, 'auroc': 0.9999869, 'binary_precision': 1.0, 'binary_recall': 0.9834711, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916667}
confusion matrix:
      0    1
0  5997    0
1    12  714
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_17.png
better model found
persisted
after epoch: 17,now: 2024-06-12 05:54:39.177870,epoch time: 0:31:21.193089,used: 8:54:23.254566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9990395, 'precision': 0.9994688, 'recall': 0.99504185, 'specificity': 0.99504185, 'f1': 0.9972428, 'auroc': 0.99986374, 'binary_precision': 1.0, 'binary_recall': 0.99008375, 'binary_specificity': 1.0, 'binary_f1_score': 0.99501723}
confusion matrix:
       0     1
0  42310     0
1     45  4493
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.86960554, 'recall': 0.5328924, 'specificity': 0.5328924, 'f1': 0.55338264, 'auroc': 0.9506926, 'binary_precision': 0.7692308, 'binary_recall': 0.06644518, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.122324154}
confusion matrix:
       0   1
0  18159  12
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.9999435, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_18.png
early stop counter: 1
val acc:0.9694241881370544, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9988100528717041
after epoch: 18,now: 2024-06-12 06:25:49.364796,epoch time: 0:31:10.186926,used: 9:25:33.441492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.9993575, 'recall': 0.9950311, 'specificity': 0.9950311, 'f1': 0.99718237, 'auroc': 0.9999573, 'binary_precision': 0.99977756, 'binary_recall': 0.9900859, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99490815}
confusion matrix:
       0     1
0  42308     1
1     45  4494
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.716432, 'recall': 0.5103846, 'specificity': 0.5103846, 'f1': 0.5124542, 'auroc': 0.9405113, 'binary_precision': 0.4642857, 'binary_recall': 0.021594685, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.041269843}
confusion matrix:
       0   1
0  18156  15
1    589  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.9992115, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_19.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9988100528717041
after epoch: 19,now: 2024-06-12 06:56:50.728430,epoch time: 0:31:01.363634,used: 9:56:34.805126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99927425, 'precision': 0.9993013, 'recall': 0.9965497, 'specificity': 0.9965497, 'f1': 0.9979207, 'auroc': 0.99984175, 'binary_precision': 0.99933493, 'binary_recall': 0.9931703, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99624306}
confusion matrix:
       0     1
0  42306     3
1     31  4508
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.84339714, 'recall': 0.5352465, 'specificity': 0.5352465, 'f1': 0.55714643, 'auroc': 0.9601048, 'binary_precision': 0.71666664, 'binary_recall': 0.071428575, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.12990937}
confusion matrix:
       0   1
0  18154  17
1    559  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.9999451, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_20.png
new oracle model saved
early stop counter: 3
val acc:0.969317615032196, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 20,now: 2024-06-12 07:28:18.718337,epoch time: 0:31:27.989907,used: 10:28:02.795033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99918884, 'precision': 0.9991548, 'recall': 0.9962066, 'specificity': 0.9962066, 'f1': 0.9976752, 'auroc': 0.999913, 'binary_precision': 0.99911267, 'binary_recall': 0.9925077, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9957993}
confusion matrix:
       0     1
0  42306     4
1     34  4504
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.85507345, 'recall': 0.6050465, 'specificity': 0.6050465, 'f1': 0.65787745, 'auroc': 0.9633441, 'binary_precision': 0.7356322, 'binary_recall': 0.21262458, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.3298969}
confusion matrix:
       0    1
0  18125   46
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.99984705, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_21.png
early stop counter: 4
val acc:0.97230064868927, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 21,now: 2024-06-12 07:59:58.752052,epoch time: 0:31:40.033715,used: 10:59:42.828748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.999381, 'precision': 0.999262, 'recall': 0.9971988, 'specificity': 0.9971988, 'f1': 0.9982277, 'auroc': 0.99997663, 'binary_precision': 0.99911463, 'binary_recall': 0.9944922, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99679804}
confusion matrix:
       0     1
0  42305     4
1     25  4514
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.8100307, 'recall': 0.566065, 'specificity': 0.566065, 'f1': 0.6037441, 'auroc': 0.9507482, 'binary_precision': 0.648, 'binary_recall': 0.1345515, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.22283356}
confusion matrix:
       0   1
0  18127  44
1    521  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9999988, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_22.png
early stop counter: 5
val acc:0.9699035882949829, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 22,now: 2024-06-12 08:32:02.501234,epoch time: 0:32:03.749182,used: 11:31:46.577930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99918884, 'precision': 0.9995513, 'recall': 0.9958141, 'specificity': 0.9958141, 'f1': 0.9976738, 'auroc': 0.9998671, 'binary_precision': 1.0, 'binary_recall': 0.9916281, 'binary_specificity': 1.0, 'binary_f1_score': 0.99579644}
confusion matrix:
       0     1
0  42309     0
1     38  4501
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.5839887, 'recall': 0.5007205, 'specificity': 0.5007205, 'f1': 0.49345827, 'auroc': 0.9520009, 'binary_precision': 0.2, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0032948926}
confusion matrix:
       0  1
0  18167  4
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9983861, 'recall': 0.99234086, 'specificity': 0.99234086, 'f1': 0.9953393, 'auroc': 0.9995978, 'binary_precision': 0.99860334, 'binary_recall': 0.9848485, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99167824}
confusion matrix:
      0    1
0  5996    1
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_23.png
early stop counter: 6
val acc:0.9677728414535522, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 23,now: 2024-06-12 09:03:37.163538,epoch time: 0:31:34.662304,used: 12:03:21.240234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9992316, 'precision': 0.9995749, 'recall': 0.9960344, 'specificity': 0.9960344, 'f1': 0.99779665, 'auroc': 0.99993217, 'binary_precision': 1.0, 'binary_recall': 0.9920687, 'binary_specificity': 1.0, 'binary_f1_score': 0.9960185}
confusion matrix:
       0     1
0  42309     0
1     36  4503
---- Validation: 
scalar performance:
{'acc': 0.9707026, 'precision': 0.839419, 'recall': 0.57290214, 'specificity': 0.57290214, 'f1': 0.6147836, 'auroc': 0.9433131, 'binary_precision': 0.7063492, 'binary_recall': 0.14784053, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.24450548}
confusion matrix:
       0   1
0  18134  37
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.9999782, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_24.png
early stop counter: 7
val acc:0.970702588558197, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 24,now: 2024-06-12 09:36:56.902032,epoch time: 0:33:19.738494,used: 12:36:40.978728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9991035, 'precision': 0.99910736, 'recall': 0.99576676, 'specificity': 0.99576676, 'f1': 0.99742997, 'auroc': 0.9999536, 'binary_precision': 0.99911207, 'binary_recall': 0.9916281, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.995356}
confusion matrix:
       0     1
0  42305     4
1     38  4501
---- Validation: 
scalar performance:
{'acc': 0.97048956, 'precision': 0.86344576, 'recall': 0.5583372, 'specificity': 0.5583372, 'f1': 0.5944945, 'auroc': 0.9521056, 'binary_precision': 0.7553192, 'binary_recall': 0.1179402, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.20402299}
confusion matrix:
       0   1
0  18148  23
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.9982002, 'recall': 0.99638975, 'specificity': 0.99638975, 'f1': 0.9972928, 'auroc': 0.9996827, 'binary_precision': 0.99723375, 'binary_recall': 0.9931129, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9951691}
confusion matrix:
      0    1
0  5995    2
1     5  721
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_25.png
early stop counter: 8
val acc:0.9704895615577698, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 25,now: 2024-06-12 10:10:34.616446,epoch time: 0:33:37.714414,used: 13:10:18.693142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99699026, 'precision': 0.99833924, 'recall': 0.984468, 'specificity': 0.984468, 'f1': 0.9912797, 'auroc': 0.99990296, 'binary_precision': 1.0, 'binary_recall': 0.9689359, 'binary_specificity': 1.0, 'binary_f1_score': 0.9842229}
confusion matrix:
       0     1
0  42309     0
1    141  4398
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.9512795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99726367, 'recall': 0.97727275, 'specificity': 0.97727275, 'f1': 0.98700017, 'auroc': 0.99899495, 'binary_precision': 1.0, 'binary_recall': 0.95454544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9767442}
confusion matrix:
      0    1
0  5997    0
1    33  693
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_26.png
early stop counter: 9
val acc:0.9678261280059814, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 26,now: 2024-06-12 10:45:10.302528,epoch time: 0:34:35.686082,used: 13:44:54.379224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9987833, 'precision': 0.9985322, 'recall': 0.9945078, 'specificity': 0.9945078, 'f1': 0.9965097, 'auroc': 0.9998567, 'binary_precision': 0.99822146, 'binary_recall': 0.98920465, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.99369264}
confusion matrix:
       0     1
0  42301     8
1     49  4490
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.8858425, 'recall': 0.5848327, 'specificity': 0.5848327, 'f1': 0.6337726, 'auroc': 0.94542503, 'binary_precision': 0.79844964, 'binary_recall': 0.17109634, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.28180572}
confusion matrix:
       0    1
0  18145   26
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.9991144, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_27.png
early stop counter: 10
val acc:0.9720342755317688, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 27,now: 2024-06-12 11:17:33.635320,epoch time: 0:32:23.332792,used: 14:17:17.712016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9985485, 'precision': 0.9991977, 'recall': 0.99250937, 'specificity': 0.99250937, 'f1': 0.99582493, 'auroc': 0.9998798, 'binary_precision': 1.0, 'binary_recall': 0.98501873, 'binary_specificity': 1.0, 'binary_f1_score': 0.99245286}
confusion matrix:
       0     1
0  42309     0
1     68  4471
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.89608973, 'recall': 0.51154536, 'specificity': 0.51154536, 'f1': 0.5146149, 'auroc': 0.9447926, 'binary_precision': 0.8235294, 'binary_recall': 0.023255814, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.04523425}
confusion matrix:
       0   1
0  18168   3
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.9996557, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_28.png
early stop counter: 11
val acc:0.9685186147689819, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 28,now: 2024-06-12 11:50:58.331546,epoch time: 0:33:24.696226,used: 14:50:42.408242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9973958, 'precision': 0.99057484, 'recall': 0.9946237, 'specificity': 0.9946237, 'f1': 0.9925887, 'auroc': 0.99953735, 'binary_precision': 0.9820961, 'binary_recall': 0.99118555, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.9866199}
confusion matrix:
       0     1
0  42228    82
1     40  4498
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.74782, 'recall': 0.8038825, 'specificity': 0.8038825, 'f1': 0.7726829, 'auroc': 0.9432069, 'binary_precision': 0.5080645, 'binary_recall': 0.627907, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.56166416}
confusion matrix:
       0    1
0  17805  366
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.9934273, 'recall': 0.9856423, 'specificity': 0.9856423, 'f1': 0.9894942, 'auroc': 0.99520206, 'binary_precision': 0.99018234, 'binary_recall': 0.9724518, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.98123705}
confusion matrix:
      0    1
0  5990    7
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_29.png
early stop counter: 12
val acc:0.9685719013214111, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 29,now: 2024-06-12 12:25:34.250897,epoch time: 0:34:35.919351,used: 15:25:18.327593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.999445, 'precision': 0.9996929, 'recall': 0.99713594, 'specificity': 0.99713594, 'f1': 0.9984102, 'auroc': 0.9999901, 'binary_precision': 1.0, 'binary_recall': 0.9942719, 'binary_specificity': 1.0, 'binary_f1_score': 0.9971277}
confusion matrix:
       0     1
0  42309     0
1     26  4513
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.89986104, 'recall': 0.5321719, 'specificity': 0.5321719, 'f1': 0.5523547, 'auroc': 0.9537114, 'binary_precision': 0.82978725, 'binary_recall': 0.06478405, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.12018489}
confusion matrix:
       0   1
0  18163   8
1    563  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.99991226, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277198_30.png
early stop counter: 13
val acc:0.9695839881896973, best validation acc: 0.9750173091888428, corresponding to test acc:                         0.9982150793075562 / 0.9989588260650635
after epoch: 30,now: 2024-06-12 13:00:43.474605,epoch time: 0:35:09.223708,used: 16:00:27.551301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_21_00_15_seed_2_21277198
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:00:27.551301 at 2024-06-12 13:00:43.474605
persisted model performance metric: 

scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.9999047, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
oracle model performance metric: 

scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.999995, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |   2458 TiB |   2458 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      6 MiB |     11 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |   2458 TiB |   2458 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      6 MiB |     11 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   2456 TiB |   2456 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   2423 TiB |   2423 TiB |
|       from small pool |      5 MiB |      9 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3500 MiB |   3518 MiB |   6712 MiB |   3212 MiB |
|       from large pool |   3488 MiB |   3506 MiB |   6696 MiB |   3208 MiB |
|       from small pool |     12 MiB |     12 MiB |     16 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 219671 KiB | 316551 KiB |   1395 TiB |   1395 TiB |
|       from large pool | 216208 KiB | 313088 KiB |   1362 TiB |   1362 TiB |
|       from small pool |   3463 KiB |   9311 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6719    |  413009 K  |  413005 K  |
|       from large pool |     247    |     352    |  160378 K  |  160377 K  |
|       from small pool |    3293    |    6471    |  252631 K  |  252627 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6719    |  413009 K  |  413005 K  |
|       from large pool |     247    |     352    |  160378 K  |  160377 K  |
|       from small pool |    3293    |    6471    |  252631 K  |  252627 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     235    |      95    |
|       from large pool |     134    |     134    |     227    |      93    |
|       from small pool |       6    |       6    |       8    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |    3014    |  203192 K  |  203192 K  |
|       from large pool |      76    |     119    |   99732 K  |   99732 K  |
|       from small pool |      18    |    2938    |  103459 K  |  103459 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   2458 TiB |   2458 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     11 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   2458 TiB |   2458 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     11 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   2456 TiB |   2456 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   2423 TiB |   2423 TiB |
|       from small pool |      0 KiB |      9 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |   3518 MiB |   6712 MiB |   4828 MiB |
|       from large pool |   1874 MiB |   3506 MiB |   6696 MiB |   4822 MiB |
|       from small pool |     10 MiB |     12 MiB |     16 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |   1395 TiB |   1395 TiB |
|       from large pool |  24320 KiB | 313088 KiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |   9311 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6719    |  413009 K  |  413009 K  |
|       from large pool |       2    |     352    |  160378 K  |  160378 K  |
|       from small pool |       0    |    6471    |  252631 K  |  252631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6719    |  413009 K  |  413009 K  |
|       from large pool |       2    |     352    |  160378 K  |  160378 K  |
|       from small pool |       0    |    6471    |  252631 K  |  252631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     140    |     235    |     143    |
|       from large pool |      87    |     134    |     227    |     140    |
|       from small pool |       5    |       6    |       8    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3014    |  203193 K  |  203193 K  |
|       from large pool |       3    |     119    |   99732 K  |   99732 K  |
|       from small pool |       0    |    2938    |  103461 K  |  103461 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 12 13:03:01 2024]
Finished job 0.
1 of 1 steps (100%) done
