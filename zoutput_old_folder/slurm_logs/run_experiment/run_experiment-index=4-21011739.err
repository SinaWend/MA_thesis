Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 12:35:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739

 Experiment start at: 2024-05-31 12:45:50.052436
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.973671, 'precision': 0.88845646, 'recall': 0.6425392, 'specificity': 0.6425392, 'f1': 0.7048698, 'auroc': 0.9690267, 'binary_precision': 0.8011364, 'binary_recall': 0.28755948, 'binary_specificity': 0.99751896, 'binary_f1_score': 0.4232116}
confusion matrix:
       0    1
0  42216  105
1   1048  423
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9728608, 'precision': 0.9335361, 'recall': 0.6169225, 'specificity': 0.6169225, 'f1': 0.679026, 'auroc': 0.96849275, 'binary_precision': 0.89349115, 'binary_recall': 0.2348367, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.37192118}
confusion matrix:
       0    1
0  18131   18
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.9546975, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 13:20:43.232933,epoch time: 0:34:53.180497,used: 0:34:53.180497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9745159, 'precision': 0.8847486, 'recall': 0.6620056, 'specificity': 0.6620056, 'f1': 0.7249467, 'auroc': 0.9768566, 'binary_precision': 0.79242176, 'binary_recall': 0.32698843, 'binary_specificity': 0.99702275, 'binary_f1_score': 0.46294513}
confusion matrix:
       0    1
0  42195  126
1    990  481
---- Validation: 
scalar performance:
{'acc': 0.97232866, 'precision': 0.8539203, 'recall': 0.6488993, 'specificity': 0.6488993, 'f1': 0.7065673, 'auroc': 0.97591615, 'binary_precision': 0.73207545, 'binary_recall': 0.30171072, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.42731276}
confusion matrix:
       0    1
0  18078   71
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9546483, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9723286628723145, best validation acc: 0.9728608131408691, corresponding to test acc:                         0.959092378616333 / 0.959092378616333
after epoch: 2,now: 2024-05-31 13:54:00.878099,epoch time: 0:33:17.645166,used: 1:08:10.825663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98285073, 'precision': 0.87112254, 'recall': 0.86162275, 'specificity': 0.86162275, 'f1': 0.8663057, 'auroc': 0.9859202, 'binary_precision': 0.7515701, 'binary_recall': 0.7316576, 'binary_specificity': 0.9915879, 'binary_f1_score': 0.74148023}
confusion matrix:
       0     1
0  41964   356
1    395  1077
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.8980953, 'recall': 0.8307825, 'specificity': 0.8307825, 'f1': 0.8610779, 'auroc': 0.9807326, 'binary_precision': 0.8079096, 'binary_recall': 0.66718507, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.7308348}
confusion matrix:
       0    1
0  18047  102
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7370342, 'recall': 0.53673005, 'specificity': 0.53673005, 'f1': 0.5560249, 'auroc': 0.9532397, 'binary_precision': 0.51282054, 'binary_recall': 0.07662835, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5978  19
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 3,now: 2024-05-31 14:26:49.800497,epoch time: 0:32:48.922398,used: 1:40:59.748061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9825311, 'precision': 0.93820447, 'recall': 0.7714885, 'specificity': 0.7714885, 'f1': 0.8339145, 'auroc': 0.9887959, 'binary_precision': 0.8919822, 'binary_recall': 0.5452689, 'binary_specificity': 0.9977081, 'binary_f1_score': 0.6768061}
confusion matrix:
       0    1
0  42226   97
1    668  801
---- Validation: 
scalar performance:
{'acc': 0.9796722, 'precision': 0.9569889, 'recall': 0.717956, 'specificity': 0.717956, 'f1': 0.7924566, 'auroc': 0.9815638, 'binary_precision': 0.9335548, 'binary_recall': 0.43701398, 'binary_specificity': 0.998898, 'binary_f1_score': 0.595339}
confusion matrix:
       0    1
0  18129   20
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.95683396, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9796721935272217, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9584531784057617 / 0.959092378616333
after epoch: 4,now: 2024-05-31 15:00:09.339870,epoch time: 0:33:19.539373,used: 2:14:19.287434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.91240376, 'recall': 0.85907185, 'specificity': 0.85907185, 'f1': 0.88374853, 'auroc': 0.9904324, 'binary_precision': 0.8343799, 'binary_recall': 0.7231293, 'binary_specificity': 0.9950144, 'binary_f1_score': 0.77478135}
confusion matrix:
       0     1
0  42111   211
1    407  1063
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.89619595, 'recall': 0.823784, 'specificity': 0.823784, 'f1': 0.8560531, 'auroc': 0.9801552, 'binary_precision': 0.8045977, 'binary_recall': 0.65318817, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.72103006}
confusion matrix:
       0    1
0  18047  102
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.96104425, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
early stop counter: 2
val acc:0.9827054142951965, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 5,now: 2024-05-31 15:33:04.380442,epoch time: 0:32:55.040572,used: 2:47:14.328006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9823027, 'precision': 0.92157423, 'recall': 0.7818502, 'specificity': 0.7818502, 'f1': 0.8368323, 'auroc': 0.98912036, 'binary_precision': 0.8580247, 'binary_recall': 0.5669612, 'binary_specificity': 0.9967392, 'binary_f1_score': 0.6827671}
confusion matrix:
       0    1
0  42183  138
1    637  834
---- Validation: 
scalar performance:
{'acc': 0.9785015, 'precision': 0.932166, 'recall': 0.71284956, 'specificity': 0.71284956, 'f1': 0.78274536, 'auroc': 0.9785724, 'binary_precision': 0.8842444, 'binary_recall': 0.42768273, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.57651997}
confusion matrix:
       0    1
0  18113   36
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.9668015, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 3
val acc:0.9785014986991882, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 6,now: 2024-05-31 16:06:09.668322,epoch time: 0:33:05.287880,used: 3:20:19.615886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9875776, 'precision': 0.9310986, 'recall': 0.8680028, 'specificity': 0.8680028, 'f1': 0.8968682, 'auroc': 0.9936732, 'binary_precision': 0.8712, 'binary_recall': 0.7398098, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.80014694}
confusion matrix:
       0     1
0  42159   161
1    383  1089
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9290057, 'recall': 0.8001404, 'specificity': 0.8001404, 'f1': 0.8523432, 'auroc': 0.9813709, 'binary_precision': 0.8719101, 'binary_recall': 0.60342145, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.71323526}
confusion matrix:
       0    1
0  18092   57
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6843402, 'recall': 0.5161575, 'specificity': 0.5161575, 'f1': 0.52097076, 'auroc': 0.9290986, 'binary_precision': 0.4090909, 'binary_recall': 0.03448276, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.06360424}
confusion matrix:
      0   1
0  5984  13
1   252   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 7,now: 2024-05-31 16:39:03.470991,epoch time: 0:32:53.802669,used: 3:53:13.418555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9879658, 'precision': 0.9327282, 'recall': 0.8731215, 'specificity': 0.8731215, 'f1': 0.9005507, 'auroc': 0.9939877, 'binary_precision': 0.87410927, 'binary_recall': 0.75, 'binary_specificity': 0.99624294, 'binary_f1_score': 0.8073126}
confusion matrix:
       0     1
0  42161   159
1    368  1104
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.92754483, 'recall': 0.8194152, 'specificity': 0.8194152, 'f1': 0.865062, 'auroc': 0.98426723, 'binary_precision': 0.86764705, 'binary_recall': 0.64230174, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7381591}
confusion matrix:
       0    1
0  18086   63
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.96037036, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-31 17:12:32.728458,epoch time: 0:33:29.257467,used: 4:26:42.676022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98732644, 'precision': 0.955776, 'recall': 0.83902115, 'specificity': 0.83902115, 'f1': 0.8882107, 'auroc': 0.9946589, 'binary_precision': 0.92258066, 'binary_recall': 0.6800272, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.7829488}
confusion matrix:
       0     1
0  42236    84
1    471  1001
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9402007, 'recall': 0.79038966, 'specificity': 0.79038966, 'f1': 0.84883595, 'auroc': 0.9843535, 'binary_precision': 0.89498806, 'binary_recall': 0.58320373, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.70621467}
confusion matrix:
       0    1
0  18105   44
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9176469, 'recall': 0.56471723, 'specificity': 0.56471723, 'f1': 0.6038376, 'auroc': 0.957263, 'binary_precision': 0.8717949, 'binary_recall': 0.1302682, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.22666667}
confusion matrix:
      0   1
0  5992   5
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9624480605125427 / 0.9629274606704712
after epoch: 9,now: 2024-05-31 17:47:16.942770,epoch time: 0:34:44.214312,used: 5:01:26.890334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98602486, 'precision': 0.8661343, 'recall': 0.9504459, 'specificity': 0.9504459, 'f1': 0.90352976, 'auroc': 0.9940082, 'binary_precision': 0.73534244, 'binary_recall': 0.9123046, 'binary_specificity': 0.9885872, 'binary_f1_score': 0.8143204}
confusion matrix:
       0     1
0  41838   483
1    129  1342
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.8561024, 'recall': 0.9018173, 'specificity': 0.9018173, 'f1': 0.8774506, 'auroc': 0.9831724, 'binary_precision': 0.71879286, 'binary_recall': 0.81493, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.7638484}
confusion matrix:
       0    1
0  17944  205
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7675545, 'recall': 0.5667144, 'specificity': 0.5667144, 'f1': 0.60077643, 'auroc': 0.95518196, 'binary_precision': 0.5714286, 'binary_recall': 0.13793103, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5970  27
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.982758641242981, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9624480605125427 / 0.9629274606704712
after epoch: 10,now: 2024-05-31 18:21:40.679226,epoch time: 0:34:23.736456,used: 5:35:50.626790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9850886, 'precision': 0.87030303, 'recall': 0.9164963, 'specificity': 0.9164963, 'f1': 0.8919207, 'auroc': 0.9891716, 'binary_precision': 0.74608904, 'binary_recall': 0.842964, 'binary_specificity': 0.9900286, 'binary_f1_score': 0.7915736}
confusion matrix:
       0     1
0  41899   422
1    231  1240
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.8527267, 'recall': 0.88173735, 'specificity': 0.88173735, 'f1': 0.86660516, 'auroc': 0.9705827, 'binary_precision': 0.71346706, 'binary_recall': 0.7744945, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.74272937}
confusion matrix:
       0    1
0  17949  200
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8936369, 'recall': 0.536065, 'specificity': 0.536065, 'f1': 0.55684584, 'auroc': 0.9430028, 'binary_precision': 0.82608694, 'binary_recall': 0.07279693, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5993   4
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 3
val acc:0.9816411137580872, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9624480605125427 / 0.9629274606704712
after epoch: 11,now: 2024-05-31 18:56:06.145289,epoch time: 0:34:25.466063,used: 6:10:16.092853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9904092, 'precision': 0.9441502, 'recall': 0.9032372, 'specificity': 0.9032372, 'f1': 0.92262995, 'auroc': 0.9961139, 'binary_precision': 0.8948949, 'binary_recall': 0.8097826, 'binary_specificity': 0.9966919, 'binary_f1_score': 0.85021394}
confusion matrix:
       0     1
0  42180   140
1    280  1192
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.92063284, 'recall': 0.83927476, 'specificity': 0.83927476, 'f1': 0.87525845, 'auroc': 0.9804467, 'binary_precision': 0.8524272, 'binary_recall': 0.6827372, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7582038}
confusion matrix:
       0    1
0  18073   76
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8126024, 'recall': 0.57304513, 'specificity': 0.57304513, 'f1': 0.61195374, 'auroc': 0.9515791, 'binary_precision': 0.66101694, 'binary_recall': 0.14942528, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24375}
confusion matrix:
      0   1
0  5977  20
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 12,now: 2024-05-31 19:30:35.603789,epoch time: 0:34:29.458500,used: 6:44:45.551353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9922132, 'precision': 0.9391235, 'recall': 0.9411416, 'specificity': 0.9411416, 'f1': 0.94013005, 'auroc': 0.99691975, 'binary_precision': 0.8821936, 'binary_recall': 0.88639456, 'binary_specificity': 0.99588865, 'binary_f1_score': 0.8842891}
confusion matrix:
       0     1
0  42148   174
1    167  1303
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.90843225, 'recall': 0.8820217, 'specificity': 0.8820217, 'f1': 0.89474916, 'auroc': 0.9816048, 'binary_precision': 0.825, 'binary_recall': 0.7698289, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.79646015}
confusion matrix:
       0    1
0  18044  105
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.79744434, 'recall': 0.6101087, 'specificity': 0.6101087, 'f1': 0.6564529, 'auroc': 0.9442627, 'binary_precision': 0.62765956, 'binary_recall': 0.22605364, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.33239436}
confusion matrix:
      0   1
0  5962  35
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 13,now: 2024-05-31 20:05:03.362347,epoch time: 0:34:27.758558,used: 7:19:13.309911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9917793, 'precision': 0.9263786, 'recall': 0.95148575, 'specificity': 0.95148575, 'f1': 0.93854356, 'auroc': 0.9973012, 'binary_precision': 0.85595393, 'binary_recall': 0.90828806, 'binary_specificity': 0.9946834, 'binary_f1_score': 0.88134485}
confusion matrix:
       0     1
0  42095   225
1    135  1337
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.91122204, 'recall': 0.87904906, 'specificity': 0.87904906, 'f1': 0.89442676, 'auroc': 0.97752035, 'binary_precision': 0.8307953, 'binary_recall': 0.7636081, 'binary_specificity': 0.99449, 'binary_f1_score': 0.79578614}
confusion matrix:
       0    1
0  18049  100
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8389435, 'recall': 0.56588256, 'specificity': 0.56588256, 'f1': 0.603072, 'auroc': 0.935926, 'binary_precision': 0.71428573, 'binary_recall': 0.13409962, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.22580646}
confusion matrix:
      0   1
0  5983  14
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 14,now: 2024-05-31 20:39:45.931776,epoch time: 0:34:42.569429,used: 7:53:55.879340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.9442631, 'recall': 0.9390135, 'specificity': 0.9390135, 'f1': 0.9416215, 'auroc': 0.9975492, 'binary_precision': 0.89263594, 'binary_recall': 0.8817131, 'binary_specificity': 0.99631387, 'binary_f1_score': 0.8871409}
confusion matrix:
       0     1
0  42165   156
1    174  1297
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9377748, 'recall': 0.84910196, 'specificity': 0.84910196, 'f1': 0.888062, 'auroc': 0.97814804, 'binary_precision': 0.88605106, 'binary_recall': 0.7013997, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7829861}
confusion matrix:
       0    1
0  18091   58
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8434025, 'recall': 0.6111092, 'specificity': 0.6111092, 'f1': 0.6627699, 'auroc': 0.9479018, 'binary_precision': 0.7195122, 'binary_recall': 0.22605364, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.34402335}
confusion matrix:
      0   1
0  5974  23
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-05-31 21:14:24.375725,epoch time: 0:34:38.443949,used: 8:28:34.323289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9920305, 'precision': 0.91992086, 'recall': 0.9663279, 'specificity': 0.9663279, 'f1': 0.9418069, 'auroc': 0.99825215, 'binary_precision': 0.8419768, 'binary_recall': 0.93877554, 'binary_specificity': 0.9938803, 'binary_f1_score': 0.88774526}
confusion matrix:
       0     1
0  42063   259
1     90  1380
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.89283264, 'recall': 0.8875263, 'specificity': 0.8875263, 'f1': 0.8901599, 'auroc': 0.9745861, 'binary_precision': 0.7933754, 'binary_recall': 0.7822706, 'binary_specificity': 0.992782, 'binary_f1_score': 0.7877839}
confusion matrix:
       0    1
0  18018  131
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8984878, 'recall': 0.5664662, 'specificity': 0.5664662, 'f1': 0.6059725, 'auroc': 0.9232689, 'binary_precision': 0.8333333, 'binary_recall': 0.13409962, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2310231}
confusion matrix:
      0   1
0  5990   7
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9855789542198181, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9640460014343262 / 0.9640460014343262
after epoch: 16,now: 2024-05-31 21:49:11.561640,epoch time: 0:34:47.185915,used: 9:03:21.509204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99381167, 'precision': 0.9498856, 'recall': 0.95548797, 'specificity': 0.95548797, 'f1': 0.9526681, 'auroc': 0.9983397, 'binary_precision': 0.90274984, 'binary_recall': 0.9144022, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.90853864}
confusion matrix:
       0     1
0  42175   145
1    126  1346
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.92395693, 'recall': 0.8741293, 'specificity': 0.8741293, 'f1': 0.89736336, 'auroc': 0.97854936, 'binary_precision': 0.8566372, 'binary_recall': 0.7527216, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.8013245}
confusion matrix:
       0    1
0  18068   81
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8502389, 'recall': 0.61877203, 'specificity': 0.61877203, 'f1': 0.6724757, 'auroc': 0.94928116, 'binary_precision': 0.73255813, 'binary_recall': 0.2413793, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3631124}
confusion matrix:
      0   1
0  5974  23
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-05-31 22:23:59.566397,epoch time: 0:34:48.004757,used: 9:38:09.513961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99465656, 'precision': 0.9647813, 'recall': 0.95195895, 'specificity': 0.95195895, 'f1': 0.9582736, 'auroc': 0.99864745, 'binary_precision': 0.93282014, 'binary_recall': 0.9061863, 'binary_specificity': 0.9977316, 'binary_f1_score': 0.9193104}
confusion matrix:
       0     1
0  42225    96
1    138  1333
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.92895186, 'recall': 0.8557698, 'specificity': 0.8557698, 'f1': 0.8886826, 'auroc': 0.9851285, 'binary_precision': 0.8679245, 'binary_recall': 0.7153966, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.78431374}
confusion matrix:
       0    1
0  18079   70
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8673812, 'recall': 0.5699641, 'specificity': 0.5699641, 'f1': 0.61011547, 'auroc': 0.94975924, 'binary_precision': 0.7708333, 'binary_recall': 0.14176245, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5986  11
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 18,now: 2024-05-31 22:58:38.023751,epoch time: 0:34:38.457354,used: 10:12:47.971315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.94725037, 'recall': 0.9493029, 'specificity': 0.9493029, 'f1': 0.94827414, 'auroc': 0.9980589, 'binary_precision': 0.897904, 'binary_recall': 0.90217394, 'binary_specificity': 0.99643195, 'binary_f1_score': 0.9000339}
confusion matrix:
       0     1
0  42169   151
1    144  1328
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.92853934, 'recall': 0.86193556, 'specificity': 0.86193556, 'f1': 0.8922116, 'auroc': 0.9781114, 'binary_precision': 0.8666667, 'binary_recall': 0.7278383, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7912088}
confusion matrix:
       0    1
0  18077   72
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9378507, 'recall': 0.5782106, 'specificity': 0.5782106, 'f1': 0.6248141, 'auroc': 0.9415642, 'binary_precision': 0.9111111, 'binary_recall': 0.15708812, 'binary_specificity': 0.999333, 'binary_f1_score': 0.26797384}
confusion matrix:
      0   1
0  5993   4
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9868561029434204, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9646852016448975
after epoch: 19,now: 2024-05-31 23:33:23.463087,epoch time: 0:34:45.439336,used: 10:47:33.410651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99415416, 'precision': 0.9823774, 'recall': 0.92583, 'specificity': 0.92583, 'f1': 0.95221466, 'auroc': 0.9989586, 'binary_precision': 0.9698609, 'binary_recall': 0.8525815, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.9074476}
confusion matrix:
       0     1
0  42281    39
1    217  1255
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9498172, 'recall': 0.82779735, 'specificity': 0.82779735, 'f1': 0.8785362, 'auroc': 0.9768837, 'binary_precision': 0.9116379, 'binary_recall': 0.6578538, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.7642277}
confusion matrix:
       0    1
0  18108   41
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.88637257, 'recall': 0.6535049, 'specificity': 0.6535049, 'f1': 0.7155292, 'auroc': 0.93651664, 'binary_precision': 0.8019802, 'binary_recall': 0.31034482, 'binary_specificity': 0.996665, 'binary_f1_score': 0.44751382}
confusion matrix:
      0   1
0  5977  20
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 20,now: 2024-06-01 00:08:16.077291,epoch time: 0:34:52.614204,used: 11:22:26.024855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9944054, 'precision': 0.9507711, 'recall': 0.9646473, 'specificity': 0.9646473, 'f1': 0.9575957, 'auroc': 0.9986272, 'binary_precision': 0.9038841, 'binary_recall': 0.93274456, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.91808754}
confusion matrix:
       0     1
0  42174   146
1     99  1373
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9086056, 'recall': 0.8704679, 'specificity': 0.8704679, 'f1': 0.8885265, 'auroc': 0.9802119, 'binary_precision': 0.8261618, 'binary_recall': 0.7465008, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.78431374}
confusion matrix:
       0    1
0  18048  101
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.824932, 'recall': 0.5657158, 'specificity': 0.5657158, 'f1': 0.6022647, 'auroc': 0.9473822, 'binary_precision': 0.6862745, 'binary_recall': 0.13409962, 'binary_specificity': 0.997332, 'binary_f1_score': 0.22435899}
confusion matrix:
      0   1
0  5981  16
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 4
val acc:0.9859514832496643, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 21,now: 2024-06-01 00:42:53.594407,epoch time: 0:34:37.517116,used: 11:57:03.541971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.92168933, 'recall': 0.9600204, 'specificity': 0.9600204, 'f1': 0.9399519, 'auroc': 0.99785507, 'binary_precision': 0.8459627, 'binary_recall': 0.92590076, 'binary_specificity': 0.99414, 'binary_f1_score': 0.8841285}
confusion matrix:
       0     1
0  42073   248
1    109  1362
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.90038264, 'recall': 0.876303, 'specificity': 0.876303, 'f1': 0.88793814, 'auroc': 0.9741496, 'binary_precision': 0.8092869, 'binary_recall': 0.7589425, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.78330654}
confusion matrix:
       0    1
0  18034  115
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8128918, 'recall': 0.5767932, 'specificity': 0.5767932, 'f1': 0.61705226, 'auroc': 0.93359596, 'binary_precision': 0.66129035, 'binary_recall': 0.15708812, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.25386995}
confusion matrix:
      0   1
0  5976  21
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 5
val acc:0.9856321811676025, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 22,now: 2024-06-01 01:17:13.400462,epoch time: 0:34:19.806055,used: 12:31:23.348026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9939715, 'precision': 0.9363896, 'recall': 0.9768815, 'specificity': 0.9768815, 'f1': 0.9556639, 'auroc': 0.9989549, 'binary_precision': 0.8742255, 'binary_recall': 0.9585598, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.9144523}
confusion matrix:
       0     1
0  42117   203
1     61  1411
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.8950261, 'recall': 0.89146936, 'specificity': 0.89146936, 'f1': 0.893239, 'auroc': 0.97623396, 'binary_precision': 0.7974882, 'binary_recall': 0.79004663, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7937499}
confusion matrix:
       0    1
0  18020  129
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78340375, 'recall': 0.55397147, 'specificity': 0.55397147, 'f1': 0.5835702, 'auroc': 0.92263275, 'binary_precision': 0.6041667, 'binary_recall': 0.11111111, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18770227}
confusion matrix:
      0   1
0  5978  19
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 6
val acc:0.9859514832496643, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 23,now: 2024-06-01 01:51:26.872878,epoch time: 0:34:13.472416,used: 13:05:36.820442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9934463, 'precision': 0.97501475, 'recall': 0.9215294, 'specificity': 0.9215294, 'f1': 0.94655895, 'auroc': 0.9986005, 'binary_precision': 0.9554189, 'binary_recall': 0.8444294, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.89650196}
confusion matrix:
       0     1
0  42262    58
1    229  1243
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.9278163, 'recall': 0.8078338, 'specificity': 0.8078338, 'f1': 0.8573095, 'auroc': 0.9730765, 'binary_precision': 0.8689956, 'binary_recall': 0.61897355, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7229791}
confusion matrix:
       0    1
0  18089   60
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.85688406, 'recall': 0.56796503, 'specificity': 0.56796503, 'f1': 0.6067973, 'auroc': 0.9434264, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2330097}
confusion matrix:
      0   1
0  5985  12
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 7
val acc:0.9837697148323059, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 24,now: 2024-06-01 02:26:14.699321,epoch time: 0:34:47.826443,used: 13:40:24.646885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99550146, 'precision': 0.98406315, 'recall': 0.9455429, 'specificity': 0.9455429, 'f1': 0.963946, 'auroc': 0.9991684, 'binary_precision': 0.9718727, 'binary_recall': 0.8919837, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.93021613}
confusion matrix:
       0     1
0  42282    38
1    159  1313
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9556801, 'recall': 0.82718503, 'specificity': 0.82718503, 'f1': 0.88012797, 'auroc': 0.98110867, 'binary_precision': 0.9234136, 'binary_recall': 0.6562986, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.7672727}
confusion matrix:
       0    1
0  18114   35
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8603541, 'recall': 0.61519074, 'specificity': 0.61519074, 'f1': 0.6693269, 'auroc': 0.93521535, 'binary_precision': 0.75308645, 'binary_recall': 0.23371647, 'binary_specificity': 0.996665, 'binary_f1_score': 0.35672513}
confusion matrix:
      0   1
0  5977  20
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 8
val acc:0.9863771796226501, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 25,now: 2024-06-01 03:01:06.144029,epoch time: 0:34:51.444708,used: 14:15:16.091593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9952731, 'precision': 0.98214203, 'recall': 0.94374764, 'specificity': 0.94374764, 'f1': 0.9620899, 'auroc': 0.99911225, 'binary_precision': 0.9681482, 'binary_recall': 0.88851124, 'binary_specificity': 0.998984, 'binary_f1_score': 0.9266218}
confusion matrix:
       0     1
0  42278    43
1    164  1307
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.94857013, 'recall': 0.813828, 'specificity': 0.813828, 'f1': 0.868434, 'auroc': 0.97480595, 'binary_precision': 0.9101124, 'binary_recall': 0.62986004, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7444853}
confusion matrix:
       0    1
0  18109   40
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.84930694, 'recall': 0.5980327, 'specificity': 0.5980327, 'f1': 0.64726996, 'auroc': 0.9429257, 'binary_precision': 0.73239434, 'binary_recall': 0.19923371, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.313253}
confusion matrix:
      0   1
0  5978  19
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 9
val acc:0.9852064847946167, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 26,now: 2024-06-01 03:36:01.652189,epoch time: 0:34:55.508160,used: 14:50:11.599753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9955243, 'precision': 0.9686715, 'recall': 0.9618974, 'specificity': 0.9618974, 'f1': 0.9652579, 'auroc': 0.9988897, 'binary_precision': 0.93991715, 'binary_recall': 0.92585033, 'binary_specificity': 0.99794436, 'binary_f1_score': 0.93283075}
confusion matrix:
       0     1
0  42235    87
1    109  1361
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.93402857, 'recall': 0.84743655, 'specificity': 0.84743655, 'f1': 0.88556784, 'auroc': 0.97826225, 'binary_precision': 0.87866926, 'binary_recall': 0.6982893, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7781629}
confusion matrix:
       0    1
0  18087   62
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9220419, 'recall': 0.63326585, 'specificity': 0.63326585, 'f1': 0.697024, 'auroc': 0.93608266, 'binary_precision': 0.875, 'binary_recall': 0.26819924, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.4105572}
confusion matrix:
      0   1
0  5987  10
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 10
val acc:0.9863771796226501, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 27,now: 2024-06-01 04:10:54.676939,epoch time: 0:34:53.024750,used: 15:25:04.624503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9957983, 'precision': 0.97880757, 'recall': 0.95553225, 'specificity': 0.95553225, 'f1': 0.96685827, 'auroc': 0.9991273, 'binary_precision': 0.9606581, 'binary_recall': 0.9123641, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.9358885}
confusion matrix:
       0     1
0  42265    55
1    129  1343
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.91188323, 'recall': 0.8659675, 'specificity': 0.8659675, 'f1': 0.88745993, 'auroc': 0.97846, 'binary_precision': 0.8330404, 'binary_recall': 0.7371695, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.78217816}
confusion matrix:
       0    1
0  18054   95
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7824944, 'recall': 0.6078595, 'specificity': 0.6078595, 'f1': 0.6520589, 'auroc': 0.9113015, 'binary_precision': 0.5979381, 'binary_recall': 0.22222222, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.32402235}
confusion matrix:
      0   1
0  5958  39
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 11
val acc:0.9859514832496643, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 28,now: 2024-06-01 04:45:51.016606,epoch time: 0:34:56.339667,used: 16:00:00.964170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9952731, 'precision': 0.95672673, 'recall': 0.97198135, 'specificity': 0.97198135, 'f1': 0.96421885, 'auroc': 0.9990904, 'binary_precision': 0.91529876, 'binary_recall': 0.9470109, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.9308848}
confusion matrix:
       0     1
0  42191   129
1     78  1394
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9094833, 'recall': 0.8743559, 'specificity': 0.8743559, 'f1': 0.89106774, 'auroc': 0.97359085, 'binary_precision': 0.82764506, 'binary_recall': 0.7542768, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7892596}
confusion matrix:
       0    1
0  18048  101
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.93479997, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 12
val acc:0.9862175583839417, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 29,now: 2024-06-01 05:20:40.216713,epoch time: 0:34:49.200107,used: 16:34:50.164277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9967574, 'precision': 0.98429, 'recall': 0.96520853, 'specificity': 0.96520853, 'f1': 0.9745432, 'auroc': 0.9996525, 'binary_precision': 0.9709632, 'binary_recall': 0.9313859, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.95076287}
confusion matrix:
       0     1
0  42279    41
1    101  1371
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9323992, 'recall': 0.8566576, 'specificity': 0.8566576, 'f1': 0.89061177, 'auroc': 0.98243463, 'binary_precision': 0.87476283, 'binary_recall': 0.7169518, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.78803414}
confusion matrix:
       0    1
0  18083   66
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.83564806, 'recall': 0.54139525, 'specificity': 0.54139525, 'f1': 0.5651985, 'auroc': 0.91844213, 'binary_precision': 0.7096774, 'binary_recall': 0.08429119, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5988   9
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 13
val acc:0.986802875995636, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 30,now: 2024-06-01 05:55:17.578285,epoch time: 0:34:37.361572,used: 17:09:27.525849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_45_50_seed_0_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:09:27.525849 at 2024-06-01 05:55:17.578285
persisted model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.86186206, 'recall': 0.6114427, 'specificity': 0.6114427, 'f1': 0.6649668, 'auroc': 0.9535569, 'binary_precision': 0.75641024, 'binary_recall': 0.22605364, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3480826}
confusion matrix:
      0   1
0  5978  19
1   202  59
oracle model performance metric: 

scalar performance:
{'acc': 0.9693193, 'precision': 0.90987325, 'recall': 0.6596689, 'specificity': 0.6596689, 'f1': 0.72543603, 'auroc': 0.93195677, 'binary_precision': 0.8484849, 'binary_recall': 0.3218391, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.4666667}
confusion matrix:
      0   1
0  5982  15
1   177  84
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    861 TiB |    861 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3476 MiB |   3476 MiB |   3476 MiB |      0 B   |
|       from large pool |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 275054 KiB | 312915 KiB | 507552 GiB | 507552 GiB |
|       from large pool | 271504 KiB | 309392 KiB | 496049 GiB | 496048 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140837 K  |  140834 K  |
|       from large pool |     247    |     352    |   54216 K  |   54216 K  |
|       from small pool |    3119    |    6089    |   86621 K  |   86618 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140837 K  |  140834 K  |
|       from large pool |     247    |     352    |   54216 K  |   54216 K  |
|       from small pool |    3119    |    6089    |   86621 K  |   86618 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     137    |     137    |     137    |       0    |
|       from large pool |     131    |     131    |     131    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |    2826    |   79197 K  |   79197 K  |
|       from large pool |      81    |     117    |   41501 K  |   41501 K  |
|       from small pool |      18    |    2746    |   37696 K  |   37696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    861 TiB |    861 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1938 MiB |   3476 MiB |   3476 MiB |   1538 MiB |
|       from large pool |   1928 MiB |   3464 MiB |   3464 MiB |   1536 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB | 507553 GiB | 507553 GiB |
|       from large pool |  24320 KiB | 315536 KiB | 496050 GiB | 496050 GiB |
|       from small pool |      0 KiB |   9145 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140837 K  |  140837 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86621 K  |   86621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140837 K  |  140837 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86621 K  |   86621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     137    |     137    |      44    |
|       from large pool |      88    |     131    |     131    |      43    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2826    |   79199 K  |   79199 K  |
|       from large pool |       3    |     117    |   41501 K  |   41501 K  |
|       from small pool |       0    |    2746    |   37697 K  |   37697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    861 TiB |    861 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1938 MiB |   3476 MiB |   3476 MiB |   1538 MiB |
|       from large pool |   1928 MiB |   3464 MiB |   3464 MiB |   1536 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB | 507553 GiB | 507553 GiB |
|       from large pool |  24320 KiB | 315536 KiB | 496050 GiB | 496050 GiB |
|       from small pool |      0 KiB |   9145 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140837 K  |  140837 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86621 K  |   86621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140837 K  |  140837 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86621 K  |   86621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     137    |     137    |      44    |
|       from large pool |      88    |     131    |     131    |      43    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2826    |   79199 K  |   79199 K  |
|       from large pool |       3    |     117    |   41501 K  |   41501 K  |
|       from small pool |       0    |    2746    |   37697 K  |   37697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739

 Experiment start at: 2024-06-01 06:08:13.553152
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97085917, 'precision': 0.9632389, 'recall': 0.5595451, 'specificity': 0.5595451, 'f1': 0.59861946, 'auroc': 0.96873, 'binary_precision': 0.95555556, 'binary_recall': 0.11927878, 'binary_specificity': 0.9998114, 'binary_f1_score': 0.21208385}
confusion matrix:
       0    1
0  42406    8
1   1270  172
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.98372155, 'recall': 0.5482912, 'specificity': 0.5482912, 'f1': 0.579802, 'auroc': 0.9671072, 'binary_precision': 1.0, 'binary_recall': 0.096582465, 'binary_specificity': 1.0, 'binary_f1_score': 0.17615177}
confusion matrix:
       0   1
0  18067   0
1    608  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.95112616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 06:44:39.325092,epoch time: 0:36:25.771940,used: 0:36:25.771940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97373223, 'precision': 0.9195279, 'recall': 0.6186422, 'specificity': 0.6186422, 'f1': 0.68024886, 'auroc': 0.97608805, 'binary_precision': 0.8643216, 'binary_recall': 0.23855756, 'binary_specificity': 0.99872684, 'binary_f1_score': 0.37391305}
confusion matrix:
       0    1
0  42360   54
1   1098  344
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.9735872, 'recall': 0.6157883, 'specificity': 0.6157883, 'f1': 0.68016654, 'auroc': 0.9717229, 'binary_precision': 0.975, 'binary_recall': 0.23179792, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.3745498}
confusion matrix:
       0    1
0  18063    4
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.96167046, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 07:19:38.950415,epoch time: 0:34:59.625323,used: 1:11:25.397263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9768333, 'precision': 0.8395418, 'recall': 0.7592505, 'specificity': 0.7592505, 'f1': 0.7935625, 'auroc': 0.9766196, 'binary_precision': 0.69505495, 'binary_recall': 0.5263523, 'binary_specificity': 0.9921488, 'binary_f1_score': 0.5990529}
confusion matrix:
       0    1
0  42081  333
1    683  759
---- Validation: 
scalar performance:
{'acc': 0.97310567, 'precision': 0.82475656, 'recall': 0.74500686, 'specificity': 0.74500686, 'f1': 0.77877295, 'auroc': 0.9568025, 'binary_precision': 0.66799206, 'binary_recall': 0.49925706, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.5714286}
confusion matrix:
       0    1
0  17900  167
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.95361894, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 07:54:41.569148,epoch time: 0:35:02.618733,used: 1:46:28.015996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98143923, 'precision': 0.8784851, 'recall': 0.8075203, 'specificity': 0.8075203, 'f1': 0.8390397, 'auroc': 0.9831439, 'binary_precision': 0.7697595, 'binary_recall': 0.6213592, 'binary_specificity': 0.9936813, 'binary_f1_score': 0.6876439}
confusion matrix:
       0    1
0  42146  268
1    546  896
---- Validation: 
scalar performance:
{'acc': 0.9807898, 'precision': 0.9031994, 'recall': 0.7947691, 'specificity': 0.7947691, 'f1': 0.83987164, 'auroc': 0.97654945, 'binary_precision': 0.8213552, 'binary_recall': 0.5943536, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.6896552}
confusion matrix:
       0    1
0  17980   87
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.8295836, 'recall': 0.5132093, 'specificity': 0.5132093, 'f1': 0.515384, 'auroc': 0.95578444, 'binary_precision': 0.7, 'binary_recall': 0.026923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5943  3
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 4,now: 2024-06-01 08:29:24.174132,epoch time: 0:34:42.604984,used: 2:21:10.620980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98467714, 'precision': 0.9098149, 'recall': 0.83297586, 'specificity': 0.83297586, 'f1': 0.8671187, 'auroc': 0.98840535, 'binary_precision': 0.830756, 'binary_recall': 0.6705964, 'binary_specificity': 0.9953553, 'binary_f1_score': 0.74213356}
confusion matrix:
       0    1
0  42217  197
1    475  967
---- Validation: 
scalar performance:
{'acc': 0.97993594, 'precision': 0.8953689, 'recall': 0.7878889, 'specificity': 0.7878889, 'f1': 0.8324752, 'auroc': 0.97923446, 'binary_precision': 0.80618554, 'binary_recall': 0.58098066, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.6753022}
confusion matrix:
       0    1
0  17973   94
1    282  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.637791, 'recall': 0.5208906, 'specificity': 0.5208906, 'f1': 0.5289592, 'auroc': 0.95259565, 'binary_precision': 0.31578946, 'binary_recall': 0.046153847, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.08053692}
confusion matrix:
      0   1
0  5920  26
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9799359440803528, best validation acc: 0.9807897806167603, corresponding to test acc:                         0.9587495923042297 / 0.9590718746185303
after epoch: 5,now: 2024-06-01 09:04:01.865991,epoch time: 0:34:37.691859,used: 2:55:48.312839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9829898, 'precision': 0.88739324, 'recall': 0.828419, 'specificity': 0.828419, 'f1': 0.8552835, 'auroc': 0.9880581, 'binary_precision': 0.7861842, 'binary_recall': 0.6629681, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.7193378}
confusion matrix:
       0    1
0  42154  260
1    486  956
---- Validation: 
scalar performance:
{'acc': 0.9827641, 'precision': 0.9195597, 'recall': 0.8122442, 'specificity': 0.8122442, 'f1': 0.8574, 'auroc': 0.979959, 'binary_precision': 0.8528226, 'binary_recall': 0.62852895, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7236954}
confusion matrix:
       0    1
0  17994   73
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8841975, 'recall': 0.5475724, 'specificity': 0.5475724, 'f1': 0.5759692, 'auroc': 0.95522237, 'binary_precision': 0.8064516, 'binary_recall': 0.09615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1718213}
confusion matrix:
      0   1
0  5940   6
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-01 09:38:49.888539,epoch time: 0:34:48.022548,used: 3:30:36.335387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9821233, 'precision': 0.8934846, 'recall': 0.80150986, 'specificity': 0.80150986, 'f1': 0.84094536, 'auroc': 0.98648643, 'binary_precision': 0.80018246, 'binary_recall': 0.6081831, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.69109535}
confusion matrix:
       0    1
0  42195  219
1    565  877
---- Validation: 
scalar performance:
{'acc': 0.9803095, 'precision': 0.91152453, 'recall': 0.77735364, 'specificity': 0.77735364, 'f1': 0.8303404, 'auroc': 0.9707383, 'binary_precision': 0.83928573, 'binary_recall': 0.5586924, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.67082965}
confusion matrix:
       0    1
0  17995   72
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.9314033, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9803094863891602, best validation acc: 0.9827641248703003, corresponding to test acc:                         0.9611666202545166 / 0.9611666202545166
after epoch: 7,now: 2024-06-01 10:13:30.704213,epoch time: 0:34:40.815674,used: 4:05:17.151061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98595405, 'precision': 0.91329193, 'recall': 0.8537332, 'specificity': 0.8537332, 'f1': 0.88102245, 'auroc': 0.9899914, 'binary_precision': 0.8363192, 'binary_recall': 0.7122053, 'binary_specificity': 0.995261, 'binary_f1_score': 0.76928836}
confusion matrix:
       0     1
0  42213   201
1    415  1027
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.9374914, 'recall': 0.8031948, 'specificity': 0.8031948, 'f1': 0.85723245, 'auroc': 0.97587097, 'binary_precision': 0.8893709, 'binary_recall': 0.60921246, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.723104}
confusion matrix:
       0    1
0  18016   51
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.9306827, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 8,now: 2024-06-01 10:48:22.945282,epoch time: 0:34:52.241069,used: 4:40:09.392130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9882114, 'precision': 0.90548795, 'recall': 0.9101072, 'specificity': 0.9101072, 'f1': 0.90778345, 'auroc': 0.9933224, 'binary_precision': 0.8168724, 'binary_recall': 0.82650936, 'binary_specificity': 0.99370503, 'binary_f1_score': 0.8216626}
confusion matrix:
       0     1
0  42148   267
1    250  1191
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.90460324, 'recall': 0.87208617, 'specificity': 0.87208617, 'f1': 0.88760436, 'auroc': 0.9802632, 'binary_precision': 0.8184765, 'binary_recall': 0.75037146, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.7829457}
confusion matrix:
       0    1
0  17955  112
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8991927, 'recall': 0.5857817, 'specificity': 0.5857817, 'f1': 0.63405436, 'auroc': 0.93713635, 'binary_precision': 0.8333333, 'binary_recall': 0.17307693, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5937   9
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-01 11:23:11.072013,epoch time: 0:34:48.126731,used: 5:14:57.518861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98169005, 'precision': 0.833555, 'recall': 0.926223, 'specificity': 0.926223, 'f1': 0.87368727, 'auroc': 0.9911765, 'binary_precision': 0.6716819, 'binary_recall': 0.86685157, 'binary_specificity': 0.9855944, 'binary_f1_score': 0.7568877}
confusion matrix:
       0     1
0  41803   611
1    192  1250
---- Validation: 
scalar performance:
{'acc': 0.9786553, 'precision': 0.83727324, 'recall': 0.870911, 'specificity': 0.870911, 'f1': 0.8532114, 'auroc': 0.9702839, 'binary_precision': 0.6837147, 'binary_recall': 0.7548291, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.71751416}
confusion matrix:
       0    1
0  17832  235
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.70215344, 'recall': 0.6288022, 'specificity': 0.6288022, 'f1': 0.6561296, 'auroc': 0.9140743, 'binary_precision': 0.43558282, 'binary_recall': 0.27307692, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.33569738}
confusion matrix:
      0   1
0  5854  92
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9786552786827087, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 10,now: 2024-06-01 11:57:53.438493,epoch time: 0:34:42.366480,used: 5:49:39.885341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9871397, 'precision': 0.9562093, 'recall': 0.8308995, 'specificity': 0.8308995, 'f1': 0.88289005, 'auroc': 0.9944403, 'binary_precision': 0.92374516, 'binary_recall': 0.6636616, 'binary_specificity': 0.9981374, 'binary_f1_score': 0.77239716}
confusion matrix:
       0    1
0  42335   79
1    485  957
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.93405986, 'recall': 0.7676443, 'specificity': 0.7676443, 'f1': 0.8296478, 'auroc': 0.9788712, 'binary_precision': 0.8850856, 'binary_recall': 0.53789, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.6691312}
confusion matrix:
       0    1
0  18020   47
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.76566577, 'recall': 0.52232015, 'specificity': 0.52232015, 'f1': 0.53211194, 'auroc': 0.9502099, 'binary_precision': 0.5714286, 'binary_recall': 0.046153847, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5937   9
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9808964729309082, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 11,now: 2024-06-01 12:32:46.691422,epoch time: 0:34:53.252929,used: 6:24:33.138270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9879378, 'precision': 0.97415483, 'recall': 0.82997227, 'specificity': 0.82997227, 'f1': 0.88827413, 'auroc': 0.9956836, 'binary_precision': 0.95971805, 'binary_recall': 0.66088766, 'binary_specificity': 0.99905694, 'binary_f1_score': 0.78275156}
confusion matrix:
       0    1
0  42374   40
1    489  953
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.9520631, 'recall': 0.7747459, 'specificity': 0.7747459, 'f1': 0.8402081, 'auroc': 0.97358644, 'binary_precision': 0.9205955, 'binary_recall': 0.551263, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.68959105}
confusion matrix:
       0    1
0  18035   32
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8840582, 'recall': 0.5551806, 'specificity': 0.5551806, 'f1': 0.5881512, 'auroc': 0.93733406, 'binary_precision': 0.8055556, 'binary_recall': 0.11153846, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5939   7
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 3
val acc:0.9821771383285522, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 12,now: 2024-06-01 13:07:46.589081,epoch time: 0:34:59.897659,used: 6:59:33.035929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9892603, 'precision': 0.96967447, 'recall': 0.8550074, 'specificity': 0.8550074, 'f1': 0.9038204, 'auroc': 0.9947136, 'binary_precision': 0.9490741, 'binary_recall': 0.7113116, 'binary_specificity': 0.9987033, 'binary_f1_score': 0.8131694}
confusion matrix:
       0     1
0  42360    55
1    416  1025
---- Validation: 
scalar performance:
{'acc': 0.98036283, 'precision': 0.9269302, 'recall': 0.76450646, 'specificity': 0.76450646, 'f1': 0.8252028, 'auroc': 0.9622511, 'binary_precision': 0.87104625, 'binary_recall': 0.5319465, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.6605166}
confusion matrix:
       0    1
0  18014   53
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7296446, 'recall': 0.5147119, 'specificity': 0.5147119, 'f1': 0.5182736, 'auroc': 0.80940115, 'binary_precision': 0.5, 'binary_recall': 0.03076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.057971016}
confusion matrix:
      0  1
0  5938  8
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 4
val acc:0.9803628325462341, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 13,now: 2024-06-01 13:42:30.886490,epoch time: 0:34:44.297409,used: 7:34:17.333338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989876, 'precision': 0.9652412, 'recall': 0.86915886, 'specificity': 0.86915886, 'f1': 0.9112791, 'auroc': 0.99628913, 'binary_precision': 0.93926054, 'binary_recall': 0.7399445, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.82777345}
confusion matrix:
       0     1
0  42345    69
1    375  1067
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9533992, 'recall': 0.8162123, 'specificity': 0.8162123, 'f1': 0.8716562, 'auroc': 0.96810853, 'binary_precision': 0.92025864, 'binary_recall': 0.6344725, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.7510994}
confusion matrix:
       0    1
0  18030   37
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.6559503, 'recall': 0.51061344, 'specificity': 0.51061344, 'f1': 0.51074183, 'auroc': 0.90912133, 'binary_precision': 0.3529412, 'binary_recall': 0.023076924, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0433213}
confusion matrix:
      0   1
0  5935  11
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 5
val acc:0.9848986268043518, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 14,now: 2024-06-01 14:17:04.950662,epoch time: 0:34:34.064172,used: 8:08:51.397510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9925666, 'precision': 0.94337475, 'recall': 0.93921506, 'specificity': 0.93921506, 'f1': 0.94128436, 'auroc': 0.9969944, 'binary_precision': 0.8907563, 'binary_recall': 0.8821082, 'binary_specificity': 0.996322, 'binary_f1_score': 0.8864112}
confusion matrix:
       0     1
0  42258   156
1    170  1272
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.9055882, 'recall': 0.87065566, 'specificity': 0.87065566, 'f1': 0.8872673, 'auroc': 0.9634669, 'binary_precision': 0.8205547, 'binary_recall': 0.7473997, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.78227067}
confusion matrix:
       0    1
0  17957  110
1    170  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.84452087, 'recall': 0.54539704, 'specificity': 0.54539704, 'f1': 0.57180315, 'auroc': 0.89601606, 'binary_precision': 0.72727275, 'binary_recall': 0.092307694, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.16382252}
confusion matrix:
      0   1
0  5937   9
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 6
val acc:0.9850587248802185, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 15,now: 2024-06-01 14:51:19.290206,epoch time: 0:34:14.339544,used: 8:43:05.737054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9912897, 'precision': 0.95995116, 'recall': 0.89802575, 'specificity': 0.89802575, 'f1': 0.9265913, 'auroc': 0.9962251, 'binary_precision': 0.92673105, 'binary_recall': 0.798197, 'binary_specificity': 0.9978545, 'binary_f1_score': 0.8576751}
confusion matrix:
       0     1
0  42323    91
1    291  1151
---- Validation: 
scalar performance:
{'acc': 0.9827108, 'precision': 0.92432797, 'recall': 0.8064944, 'specificity': 0.8064944, 'f1': 0.8551591, 'auroc': 0.96939105, 'binary_precision': 0.8627859, 'binary_recall': 0.6166419, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.71923745}
confusion matrix:
       0    1
0  18001   66
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7452984, 'recall': 0.5517439, 'specificity': 0.5517439, 'f1': 0.57883614, 'auroc': 0.9136087, 'binary_precision': 0.5283019, 'binary_recall': 0.10769231, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.17891374}
confusion matrix:
      0   1
0  5921  25
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 7
val acc:0.9827107787132263, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 16,now: 2024-06-01 15:25:32.139840,epoch time: 0:34:12.849634,used: 9:17:18.586688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99185973, 'precision': 0.9431406, 'recall': 0.92679137, 'specificity': 0.92679137, 'f1': 0.9348006, 'auroc': 0.99704003, 'binary_precision': 0.89113194, 'binary_recall': 0.85714287, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.873807}
confusion matrix:
       0     1
0  42263   151
1    206  1236
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.92735374, 'recall': 0.8479054, 'specificity': 0.8479054, 'f1': 0.88322556, 'auroc': 0.972745, 'binary_precision': 0.86580884, 'binary_recall': 0.6998514, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7740345}
confusion matrix:
       0    1
0  17994   73
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8690117, 'recall': 0.5265867, 'specificity': 0.5265867, 'f1': 0.5400581, 'auroc': 0.925788, 'binary_precision': 0.7777778, 'binary_recall': 0.053846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.10071942}
confusion matrix:
      0   1
0  5942   4
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 17,now: 2024-06-01 15:59:55.347484,epoch time: 0:34:23.207644,used: 9:51:41.794332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9946644, 'precision': 0.9655825, 'recall': 0.9493433, 'specificity': 0.9493433, 'f1': 0.957308, 'auroc': 0.9986353, 'binary_precision': 0.93453234, 'binary_recall': 0.9008322, 'binary_specificity': 0.9978545, 'binary_f1_score': 0.9173728}
confusion matrix:
       0     1
0  42323    91
1    143  1299
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9321052, 'recall': 0.8643055, 'specificity': 0.8643055, 'f1': 0.8950821, 'auroc': 0.9704466, 'binary_precision': 0.8741135, 'binary_recall': 0.73254085, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.7970897}
confusion matrix:
       0    1
0  17996   71
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.855427, 'recall': 0.53411084, 'specificity': 0.53411084, 'f1': 0.553156, 'auroc': 0.9289333, 'binary_precision': 0.75, 'binary_recall': 0.06923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12676057}
confusion matrix:
      0   1
0  5940   6
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 18,now: 2024-06-01 16:34:46.665941,epoch time: 0:34:51.318457,used: 10:26:33.112789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911985, 'precision': 0.91384584, 'recall': 0.95693016, 'specificity': 0.95693016, 'f1': 0.9342338, 'auroc': 0.99760044, 'binary_precision': 0.83041304, 'binary_recall': 0.92024964, 'binary_specificity': 0.9936106, 'binary_f1_score': 0.8730263}
confusion matrix:
       0     1
0  42143   271
1    115  1327
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.8563647, 'recall': 0.8807672, 'specificity': 0.8807672, 'f1': 0.86812234, 'auroc': 0.96808016, 'binary_precision': 0.72122055, 'binary_recall': 0.7726597, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.74605453}
confusion matrix:
       0    1
0  17866  201
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.6841935, 'recall': 0.5432107, 'specificity': 0.5432107, 'f1': 0.5640303, 'auroc': 0.8661759, 'binary_precision': 0.40677965, 'binary_recall': 0.092307694, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.15047023}
confusion matrix:
      0   1
0  5911  35
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9811099171638489, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 19,now: 2024-06-01 17:09:11.839932,epoch time: 0:34:25.173991,used: 11:00:58.286780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99336463, 'precision': 0.9660442, 'recall': 0.9268995, 'specificity': 0.9268995, 'f1': 0.9455508, 'auroc': 0.9982922, 'binary_precision': 0.936978, 'binary_recall': 0.85575587, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.89452696}
confusion matrix:
       0     1
0  42331    83
1    208  1234
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.91464096, 'recall': 0.84597677, 'specificity': 0.84597677, 'f1': 0.87694955, 'auroc': 0.97237027, 'binary_precision': 0.8405018, 'binary_recall': 0.6968796, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.76198214}
confusion matrix:
       0    1
0  17978   89
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7443589, 'recall': 0.5351089, 'specificity': 0.5351089, 'f1': 0.55354214, 'auroc': 0.92987204, 'binary_precision': 0.5277778, 'binary_recall': 0.073076926, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.12837839}
confusion matrix:
      0   1
0  5929  17
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9843649864196777, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 20,now: 2024-06-01 17:43:48.969285,epoch time: 0:34:37.129353,used: 11:35:35.416133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98957956, 'precision': 0.94770336, 'recall': 0.8810639, 'specificity': 0.8810639, 'f1': 0.91150784, 'auroc': 0.99576366, 'binary_precision': 0.9033579, 'binary_recall': 0.76490986, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.8283891}
confusion matrix:
       0     1
0  42296   118
1    339  1103
---- Validation: 
scalar performance:
{'acc': 0.97860193, 'precision': 0.8894289, 'recall': 0.76931536, 'specificity': 0.76931536, 'f1': 0.8175199, 'auroc': 0.9651205, 'binary_precision': 0.79565215, 'binary_recall': 0.54383355, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.6460724}
confusion matrix:
       0    1
0  17973   94
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8633964, 'recall': 0.54932725, 'specificity': 0.54932725, 'f1': 0.5784502, 'auroc': 0.88795084, 'binary_precision': 0.7647059, 'binary_recall': 0.1, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.17687075}
confusion matrix:
      0   1
0  5938   8
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 3
val acc:0.9786019325256348, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 21,now: 2024-06-01 18:18:32.835589,epoch time: 0:34:43.866304,used: 12:10:19.282437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99455035, 'precision': 0.9564644, 'recall': 0.95799315, 'specificity': 0.95799315, 'f1': 0.95722735, 'auroc': 0.9988224, 'binary_precision': 0.9156876, 'binary_recall': 0.9188627, 'binary_specificity': 0.9971236, 'binary_f1_score': 0.9172724}
confusion matrix:
       0     1
0  42292   122
1    117  1325
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.9258309, 'recall': 0.86702824, 'specificity': 0.86702824, 'f1': 0.894067, 'auroc': 0.9686975, 'binary_precision': 0.86135185, 'binary_recall': 0.7384844, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.7952}
confusion matrix:
       0    1
0  17987   80
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8050356, 'recall': 0.5244114, 'specificity': 0.5244114, 'f1': 0.53596044, 'auroc': 0.9134381, 'binary_precision': 0.65, 'binary_recall': 0.05, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.09285714}
confusion matrix:
      0   1
0  5939   7
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 4
val acc:0.9863393902778625, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 22,now: 2024-06-01 18:53:08.699087,epoch time: 0:34:35.863498,used: 12:44:55.145935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9945275, 'precision': 0.9447756, 'recall': 0.97271925, 'specificity': 0.97271925, 'f1': 0.9582883, 'auroc': 0.9990647, 'binary_precision': 0.89127606, 'binary_recall': 0.94937587, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.919409}
confusion matrix:
       0     1
0  42247   167
1     73  1369
---- Validation: 
scalar performance:
{'acc': 0.9859125, 'precision': 0.9035702, 'recall': 0.8896954, 'specificity': 0.8896954, 'f1': 0.8965006, 'auroc': 0.96614367, 'binary_precision': 0.81510013, 'binary_recall': 0.7860327, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.8003025}
confusion matrix:
       0    1
0  17947  120
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8152816, 'recall': 0.5714792, 'specificity': 0.5714792, 'f1': 0.609911, 'auroc': 0.9294293, 'binary_precision': 0.6666667, 'binary_recall': 0.14615385, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.23974764}
confusion matrix:
      0   1
0  5927  19
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 5
val acc:0.9859125018119812, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 23,now: 2024-06-01 19:27:55.495885,epoch time: 0:34:46.796798,used: 13:19:41.942733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9926122, 'precision': 0.9853983, 'recall': 0.8963648, 'specificity': 0.8963648, 'f1': 0.9360749, 'auroc': 0.9985587, 'binary_precision': 0.9777778, 'binary_recall': 0.7933426, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.87595713}
confusion matrix:
       0     1
0  42388    26
1    298  1144
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.93807757, 'recall': 0.7913908, 'specificity': 0.7913908, 'f1': 0.8488672, 'auroc': 0.97194517, 'binary_precision': 0.8914027, 'binary_recall': 0.5854383, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7067265}
confusion matrix:
       0    1
0  18019   48
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.93289834, 'recall': 0.5363703, 'specificity': 0.5363703, 'f1': 0.5576, 'auroc': 0.939111, 'binary_precision': 0.9047619, 'binary_recall': 0.073076926, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.13523133}
confusion matrix:
      0   1
0  5944   2
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 6
val acc:0.9825506806373596, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 24,now: 2024-06-01 20:02:38.451160,epoch time: 0:34:42.955275,used: 13:54:24.898008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9929314, 'precision': 0.92724156, 'recall': 0.96887946, 'specificity': 0.96887946, 'f1': 0.9470146, 'auroc': 0.99814093, 'binary_precision': 0.8564232, 'binary_recall': 0.94313455, 'binary_specificity': 0.99462444, 'binary_f1_score': 0.8976898}
confusion matrix:
       0     1
0  42186   228
1     82  1360
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.8832404, 'recall': 0.8799498, 'specificity': 0.8799498, 'f1': 0.8815874, 'auroc': 0.96876705, 'binary_precision': 0.77511245, 'binary_recall': 0.76820207, 'binary_specificity': 0.99169755, 'binary_f1_score': 0.77164185}
confusion matrix:
       0    1
0  17917  150
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7444779, 'recall': 0.5794128, 'specificity': 0.5794128, 'f1': 0.6151262, 'auroc': 0.88294214, 'binary_precision': 0.5243902, 'binary_recall': 0.16538462, 'binary_specificity': 0.993441, 'binary_f1_score': 0.25146198}
confusion matrix:
      0   1
0  5907  39
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 7
val acc:0.9836713075637817, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 25,now: 2024-06-01 20:38:20.520365,epoch time: 0:35:42.069205,used: 14:30:06.967213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9953028, 'precision': 0.96165437, 'recall': 0.96474624, 'specificity': 0.96474624, 'f1': 0.9631948, 'auroc': 0.99890816, 'binary_precision': 0.92561984, 'binary_recall': 0.93203884, 'binary_specificity': 0.9974537, 'binary_f1_score': 0.9288183}
confusion matrix:
       0     1
0  42306   108
1     98  1344
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.90167594, 'recall': 0.8653443, 'specificity': 0.8653443, 'f1': 0.8825743, 'auroc': 0.9647751, 'binary_precision': 0.81311476, 'binary_recall': 0.7369985, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.7731879}
confusion matrix:
       0    1
0  17953  114
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7575991, 'recall': 0.5482341, 'specificity': 0.5482341, 'f1': 0.5741577, 'auroc': 0.91040874, 'binary_precision': 0.5531915, 'binary_recall': 0.1, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1693811}
confusion matrix:
      0   1
0  5925  21
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 8
val acc:0.9844717383384705, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 26,now: 2024-06-01 21:14:26.999977,epoch time: 0:36:06.479612,used: 15:06:13.446825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.995166, 'precision': 0.97341526, 'recall': 0.94926775, 'specificity': 0.94926775, 'f1': 0.96100223, 'auroc': 0.9991327, 'binary_precision': 0.95021963, 'binary_recall': 0.9001387, 'binary_specificity': 0.99839675, 'binary_f1_score': 0.9245015}
confusion matrix:
       0     1
0  42346    68
1    144  1298
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.9167719, 'recall': 0.83868575, 'specificity': 0.83868575, 'f1': 0.87335837, 'auroc': 0.97518075, 'binary_precision': 0.8453039, 'binary_recall': 0.6820208, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.75493425}
confusion matrix:
       0    1
0  17983   84
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.90066653, 'recall': 0.54004824, 'specificity': 0.54004824, 'f1': 0.5636652, 'auroc': 0.9258686, 'binary_precision': 0.84, 'binary_recall': 0.08076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5942   4
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 9
val acc:0.9840981960296631, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 27,now: 2024-06-01 21:50:43.828683,epoch time: 0:36:16.828706,used: 15:42:30.275531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99459594, 'precision': 0.9842517, 'recall': 0.929162, 'specificity': 0.929162, 'f1': 0.9549273, 'auroc': 0.9989488, 'binary_precision': 0.9732704, 'binary_recall': 0.8591256, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.91264284}
confusion matrix:
       0     1
0  42381    34
1    203  1238
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.9306428, 'recall': 0.8192351, 'specificity': 0.8192351, 'f1': 0.86600786, 'auroc': 0.976056, 'binary_precision': 0.87449396, 'binary_recall': 0.6419019, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.7403599}
confusion matrix:
       0    1
0  18005   62
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.75451744, 'recall': 0.53151506, 'specificity': 0.53151506, 'f1': 0.5478178, 'auroc': 0.9164912, 'binary_precision': 0.5483871, 'binary_recall': 0.06538462, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.11683849}
confusion matrix:
      0   1
0  5932  14
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 10
val acc:0.9838314056396484, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 28,now: 2024-06-01 22:27:09.565780,epoch time: 0:36:25.737097,used: 16:18:56.012628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9965341, 'precision': 0.98508376, 'recall': 0.95968866, 'specificity': 0.95968866, 'f1': 0.97202003, 'auroc': 0.99957216, 'binary_precision': 0.9728739, 'binary_recall': 0.92024964, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.9458303}
confusion matrix:
       0     1
0  42377    37
1    115  1327
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.93683326, 'recall': 0.8511816, 'specificity': 0.8511816, 'f1': 0.88897777, 'auroc': 0.9747212, 'binary_precision': 0.8845438, 'binary_recall': 0.70579493, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.78512394}
confusion matrix:
       0    1
0  18005   62
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74213284, 'recall': 0.54246485, 'specificity': 0.54246485, 'f1': 0.56500375, 'auroc': 0.87366474, 'binary_precision': 0.52272725, 'binary_recall': 0.08846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1513158}
confusion matrix:
      0   1
0  5925  21
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 11
val acc:0.9861259460449219, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 29,now: 2024-06-01 23:02:49.355417,epoch time: 0:35:39.789637,used: 16:54:35.802265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99014956, 'precision': 0.9902187, 'recall': 0.8535576, 'specificity': 0.8535576, 'f1': 0.91008735, 'auroc': 0.9987521, 'binary_precision': 0.99029124, 'binary_recall': 0.7073509, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.8252427}
confusion matrix:
       0     1
0  42404    10
1    422  1020
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.9416758, 'recall': 0.721997, 'specificity': 0.721997, 'f1': 0.79295576, 'auroc': 0.9690645, 'binary_precision': 0.90361446, 'binary_recall': 0.44576523, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.59701496}
confusion matrix:
       0    1
0  18035   32
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.69717455, 'recall': 0.5181376, 'specificity': 0.5181376, 'f1': 0.52449393, 'auroc': 0.8679625, 'binary_precision': 0.4347826, 'binary_recall': 0.03846154, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.07067138}
confusion matrix:
      0   1
0  5933  13
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 12
val acc:0.9783884882926941, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9600386619567871 / 0.9639058709144592
after epoch: 30,now: 2024-06-01 23:38:17.419741,epoch time: 0:35:28.064324,used: 17:30:03.866589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_08_13_seed_1_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:30:03.866589 at 2024-06-01 23:38:17.419741
persisted model performance metric: 

scalar performance:
{'acc': 0.959233, 'precision': 0.8062746, 'recall': 0.52817345, 'specificity': 0.52817345, 'f1': 0.542574, 'auroc': 0.92927, 'binary_precision': 0.65217394, 'binary_recall': 0.057692308, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.10600708}
confusion matrix:
      0   1
0  5938   8
1   245  15
oracle model performance metric: 

scalar performance:
{'acc': 0.9634225, 'precision': 0.89405555, 'recall': 0.58001244, 'specificity': 0.58001244, 'f1': 0.6256689, 'auroc': 0.9387586, 'binary_precision': 0.8235294, 'binary_recall': 0.16153847, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.27009648}
confusion matrix:
      0   1
0  5937   9
1   218  42
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      5 MiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3478 MiB |   3478 MiB |   5016 MiB |   1538 MiB |
|       from large pool |   3466 MiB |   3466 MiB |   5002 MiB |   1536 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 217722 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool | 214160 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |   3562 KiB |   9145 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6345    |  281699 K  |  281696 K  |
|       from large pool |     247    |     352    |  108458 K  |  108457 K  |
|       from small pool |    3095    |    6097    |  173241 K  |  173238 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6345    |  281699 K  |  281696 K  |
|       from large pool |     247    |     352    |  108458 K  |  108457 K  |
|       from small pool |    3095    |    6097    |  173241 K  |  173238 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     182    |      44    |
|       from large pool |     132    |     132    |     175    |      43    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2827    |  151948 K  |  151947 K  |
|       from large pool |      77    |     117    |   75590 K  |   75590 K  |
|       from small pool |      18    |    2750    |   76357 K  |   76357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |   3478 MiB |   5016 MiB |   3134 MiB |
|       from large pool |   1872 MiB |   3466 MiB |   5002 MiB |   3130 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool |  24320 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |      0 KiB |   9344 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281699 K  |  281699 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173241 K  |  173241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281699 K  |  281699 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173241 K  |  173241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     138    |     182    |      90    |
|       from large pool |      87    |     132    |     175    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  151949 K  |  151949 K  |
|       from large pool |       3    |     117    |   75590 K  |   75590 K  |
|       from small pool |       0    |    2750    |   76358 K  |   76358 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |   3478 MiB |   5016 MiB |   3134 MiB |
|       from large pool |   1872 MiB |   3466 MiB |   5002 MiB |   3130 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool |  24320 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |      0 KiB |   9344 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281699 K  |  281699 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173241 K  |  173241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281699 K  |  281699 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173241 K  |  173241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     138    |     182    |      90    |
|       from large pool |      87    |     132    |     175    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  151949 K  |  151949 K  |
|       from large pool |       3    |     117    |   75590 K  |   75590 K  |
|       from small pool |       0    |    2750    |   76358 K  |   76358 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739

 Experiment start at: 2024-06-01 23:51:32.604466
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96940035, 'precision': 0.766164, 'recall': 0.8560549, 'specificity': 0.8560549, 'f1': 0.8038418, 'auroc': 0.97112364, 'binary_precision': 0.54195124, 'binary_recall': 0.7343027, 'binary_specificity': 0.97780716, 'binary_f1_score': 0.6236318}
confusion matrix:
       0     1
0  41372   939
1    402  1111
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.7656412, 'recall': 0.83663225, 'specificity': 0.83663225, 'f1': 0.79649955, 'auroc': 0.965094, 'binary_precision': 0.54155844, 'binary_recall': 0.692691, 'binary_specificity': 0.9805734, 'binary_f1_score': 0.6078717}
confusion matrix:
       0    1
0  17818  353
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.8793447, 'recall': 0.7573291, 'specificity': 0.7573291, 'f1': 0.80558664, 'auroc': 0.957639, 'binary_precision': 0.7777778, 'binary_recall': 0.5206612, 'binary_specificity': 0.993997, 'binary_f1_score': 0.62376237}
confusion matrix:
      0    1
0  5961   36
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 00:27:22.565971,epoch time: 0:35:49.961505,used: 0:35:49.961505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9777291, 'precision': 0.8492503, 'recall': 0.792814, 'specificity': 0.792814, 'f1': 0.818331, 'auroc': 0.97670007, 'binary_precision': 0.71292627, 'binary_recall': 0.59418374, 'binary_specificity': 0.9914443, 'binary_f1_score': 0.6481615}
confusion matrix:
       0    1
0  41949  362
1    614  899
---- Validation: 
scalar performance:
{'acc': 0.9762425, 'precision': 0.82050264, 'recall': 0.76769245, 'specificity': 0.76769245, 'f1': 0.79152167, 'auroc': 0.9696311, 'binary_precision': 0.656, 'binary_recall': 0.54485047, 'binary_specificity': 0.99053437, 'binary_f1_score': 0.5952813}
confusion matrix:
       0    1
0  17999  172
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8902724, 'recall': 0.57164705, 'specificity': 0.57164705, 'f1': 0.6139905, 'auroc': 0.95336115, 'binary_precision': 0.81395346, 'binary_recall': 0.1446281, 'binary_specificity': 0.998666, 'binary_f1_score': 0.24561402}
confusion matrix:
      0   1
0  5989   8
1   207  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 2,now: 2024-06-02 01:01:47.266396,epoch time: 0:34:24.700425,used: 1:10:14.661930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9761318, 'precision': 0.9380733, 'recall': 0.6729139, 'specificity': 0.6729139, 'f1': 0.7443639, 'auroc': 0.97988456, 'binary_precision': 0.89897263, 'binary_recall': 0.3472222, 'binary_specificity': 0.9986056, 'binary_f1_score': 0.5009542}
confusion matrix:
       0    1
0  42253   59
1    987  525
---- Validation: 
scalar performance:
{'acc': 0.9751771, 'precision': 0.94770634, 'recall': 0.62339646, 'specificity': 0.62339646, 'f1': 0.68869156, 'auroc': 0.9691814, 'binary_precision': 0.9197531, 'binary_recall': 0.2475083, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.39005235}
confusion matrix:
       0    1
0  18158   13
1    453  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.9535465, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9751771092414856, best validation acc: 0.9762424826622009, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 3,now: 2024-06-02 01:36:01.060365,epoch time: 0:34:13.793969,used: 1:44:28.455899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97654253, 'precision': 0.8106404, 'recall': 0.8820594, 'specificity': 0.8820594, 'f1': 0.8422773, 'auroc': 0.9809805, 'binary_precision': 0.6291955, 'binary_recall': 0.7805684, 'binary_specificity': 0.98355037, 'binary_f1_score': 0.6967552}
confusion matrix:
       0     1
0  41615   696
1    332  1181
---- Validation: 
scalar performance:
{'acc': 0.9758696, 'precision': 0.79446816, 'recall': 0.87269914, 'specificity': 0.87269914, 'f1': 0.8285309, 'auroc': 0.97518015, 'binary_precision': 0.59687907, 'binary_recall': 0.76245844, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.6695842}
confusion matrix:
       0    1
0  17861  310
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.81560856, 'recall': 0.5445374, 'specificity': 0.5445374, 'f1': 0.5705351, 'auroc': 0.9473847, 'binary_precision': 0.6666667, 'binary_recall': 0.09090909, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16000001}
confusion matrix:
      0   1
0  5986  11
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9758695960044861, best validation acc: 0.9762424826622009, corresponding to test acc:                         0.9655393362045288 / 0.9756371378898621
after epoch: 4,now: 2024-06-02 02:09:54.601527,epoch time: 0:33:53.541162,used: 2:18:21.997061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9806727, 'precision': 0.83513075, 'recall': 0.9157449, 'specificity': 0.9157449, 'f1': 0.87066984, 'auroc': 0.9872251, 'binary_precision': 0.6758184, 'binary_recall': 0.8460013, 'binary_specificity': 0.9854884, 'binary_f1_score': 0.7513942}
confusion matrix:
       0     1
0  41697   614
1    233  1280
---- Validation: 
scalar performance:
{'acc': 0.97965163, 'precision': 0.81958765, 'recall': 0.89794123, 'specificity': 0.89794123, 'f1': 0.854074, 'auroc': 0.9771284, 'binary_precision': 0.6455026, 'binary_recall': 0.8106312, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.718704}
confusion matrix:
       0    1
0  17903  268
1    114  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8301375, 'recall': 0.5689973, 'specificity': 0.5689973, 'f1': 0.6076894, 'auroc': 0.95558226, 'binary_precision': 0.6938776, 'binary_recall': 0.14049587, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.23367696}
confusion matrix:
      0   1
0  5982  15
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 5,now: 2024-06-02 02:43:39.142832,epoch time: 0:33:44.541305,used: 2:52:06.538366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847572, 'precision': 0.8718828, 'recall': 0.914355, 'specificity': 0.914355, 'f1': 0.89186496, 'auroc': 0.99163723, 'binary_precision': 0.749557, 'binary_recall': 0.838731, 'binary_specificity': 0.98997897, 'binary_f1_score': 0.79164064}
confusion matrix:
       0     1
0  41887   424
1    244  1269
---- Validation: 
scalar performance:
{'acc': 0.9802376, 'precision': 0.82759726, 'recall': 0.88459206, 'specificity': 0.88459206, 'f1': 0.85360086, 'auroc': 0.97784, 'binary_precision': 0.6624473, 'binary_recall': 0.782392, 'binary_specificity': 0.98679215, 'binary_f1_score': 0.71744096}
confusion matrix:
       0    1
0  17931  240
1    131  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.8763343, 'recall': 0.6919638, 'specificity': 0.6919638, 'f1': 0.75173074, 'auroc': 0.9599905, 'binary_precision': 0.7768595, 'binary_recall': 0.38842976, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.51790637}
confusion matrix:
      0   1
0  5970  27
1   148  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 6,now: 2024-06-02 03:17:29.534840,epoch time: 0:33:50.392008,used: 3:25:56.930374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98713034, 'precision': 0.9123664, 'recall': 0.8897022, 'specificity': 0.8897022, 'f1': 0.90068734, 'auroc': 0.9927727, 'binary_precision': 0.8323983, 'binary_recall': 0.7850529, 'binary_specificity': 0.9943515, 'binary_f1_score': 0.8080327}
confusion matrix:
       0     1
0  42073   239
1    325  1187
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.87722445, 'recall': 0.8395287, 'specificity': 0.8395287, 'f1': 0.857306, 'auroc': 0.9765306, 'binary_precision': 0.7648148, 'binary_recall': 0.68604654, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.72329247}
confusion matrix:
       0    1
0  18044  127
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.791311, 'recall': 0.5584166, 'specificity': 0.5584166, 'f1': 0.59087026, 'auroc': 0.95564055, 'binary_precision': 0.61702126, 'binary_recall': 0.11983471, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20069204}
confusion matrix:
      0   1
0  5979  18
1   213  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 7,now: 2024-06-02 03:51:22.940155,epoch time: 0:33:53.405315,used: 3:59:50.335689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98649144, 'precision': 0.9478774, 'recall': 0.83782065, 'specificity': 0.83782065, 'f1': 0.88456625, 'auroc': 0.99345756, 'binary_precision': 0.90716183, 'binary_recall': 0.67812294, 'binary_specificity': 0.99751836, 'binary_f1_score': 0.7760969}
confusion matrix:
       0     1
0  42206   105
1    487  1026
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.9274481, 'recall': 0.7941952, 'specificity': 0.7941952, 'f1': 0.84767294, 'auroc': 0.97913146, 'binary_precision': 0.8682927, 'binary_recall': 0.5913621, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.7035573}
confusion matrix:
       0    1
0  18117   54
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.91102195, 'recall': 0.5492533, 'specificity': 0.5492533, 'f1': 0.5797965, 'auroc': 0.95590305, 'binary_precision': 0.85714287, 'binary_recall': 0.09917355, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17777778}
confusion matrix:
      0   1
0  5993   4
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 8,now: 2024-06-02 04:25:10.923645,epoch time: 0:33:47.983490,used: 4:33:38.319179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9776378, 'precision': 0.8070184, 'recall': 0.95493793, 'specificity': 0.95493793, 'f1': 0.86500525, 'auroc': 0.9928521, 'binary_precision': 0.6165644, 'binary_recall': 0.9305556, 'binary_specificity': 0.9793203, 'binary_f1_score': 0.74169743}
confusion matrix:
       0     1
0  41437   875
1    105  1407
---- Validation: 
scalar performance:
{'acc': 0.9768284, 'precision': 0.7952897, 'recall': 0.9245896, 'specificity': 0.9245896, 'f1': 0.84710896, 'auroc': 0.97871655, 'binary_precision': 0.5949943, 'binary_recall': 0.8687708, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.7062795}
confusion matrix:
       0    1
0  17815  356
1     79  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.8070388, 'recall': 0.7220201, 'specificity': 0.7220201, 'f1': 0.7569777, 'auroc': 0.9534514, 'binary_precision': 0.63583815, 'binary_recall': 0.45454547, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.5301205}
confusion matrix:
      0    1
0  5934   63
1   132  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.976828396320343, best validation acc: 0.9840195775032043, corresponding to test acc:                         0.9644173979759216 / 0.9756371378898621
after epoch: 9,now: 2024-06-02 04:59:03.932431,epoch time: 0:33:53.008786,used: 5:07:31.327965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9874954, 'precision': 0.929879, 'recall': 0.873711, 'specificity': 0.873711, 'f1': 0.8996756, 'auroc': 0.9930409, 'binary_precision': 0.868602, 'binary_recall': 0.75148714, 'binary_specificity': 0.99593484, 'binary_f1_score': 0.8058115}
confusion matrix:
       0     1
0  42139   172
1    376  1137
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.89899373, 'recall': 0.8222194, 'specificity': 0.8222194, 'f1': 0.85621357, 'auroc': 0.97391194, 'binary_precision': 0.8095238, 'binary_recall': 0.6495017, 'binary_specificity': 0.994937, 'binary_f1_score': 0.7207373}
confusion matrix:
       0    1
0  18079   92
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.9401957, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9838597774505615, best validation acc: 0.9840195775032043, corresponding to test acc:                         0.9644173979759216 / 0.9756371378898621
after epoch: 10,now: 2024-06-02 05:32:37.753343,epoch time: 0:33:33.820912,used: 5:41:05.148877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9891612, 'precision': 0.90246534, 'recall': 0.94563305, 'specificity': 0.94563305, 'f1': 0.92285293, 'auroc': 0.99476045, 'binary_precision': 0.80856127, 'binary_recall': 0.8988764, 'binary_specificity': 0.9923897, 'binary_f1_score': 0.8513302}
confusion matrix:
       0     1
0  41989   322
1    153  1360
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.8767068, 'recall': 0.87973106, 'specificity': 0.87973106, 'f1': 0.87821245, 'auroc': 0.9706323, 'binary_precision': 0.76112026, 'binary_recall': 0.76744187, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.76426804}
confusion matrix:
       0    1
0  18026  145
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8360653, 'recall': 0.53454036, 'specificity': 0.53454036, 'f1': 0.55441093, 'auroc': 0.9263712, 'binary_precision': 0.7083333, 'binary_recall': 0.07024793, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.12781955}
confusion matrix:
      0   1
0  5990   7
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 11,now: 2024-06-02 06:06:30.647311,epoch time: 0:33:52.893968,used: 6:14:58.042845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9894122, 'precision': 0.91513455, 'recall': 0.9288745, 'specificity': 0.9288745, 'f1': 0.9218831, 'auroc': 0.99518645, 'binary_precision': 0.83514374, 'binary_recall': 0.86384666, 'binary_specificity': 0.99390227, 'binary_f1_score': 0.84925276}
confusion matrix:
       0     1
0  42053   258
1    206  1307
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.8712878, 'recall': 0.8712878, 'specificity': 0.8712878, 'f1': 0.8712878, 'auroc': 0.9733592, 'binary_precision': 0.7508306, 'binary_recall': 0.7508306, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.7508306}
confusion matrix:
       0    1
0  18021  150
1    150  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.83813214, 'recall': 0.5792445, 'specificity': 0.5792445, 'f1': 0.6223237, 'auroc': 0.95312285, 'binary_precision': 0.7090909, 'binary_recall': 0.16115703, 'binary_specificity': 0.997332, 'binary_f1_score': 0.26262626}
confusion matrix:
      0   1
0  5981  16
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9840195775032043, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9628145694732666 / 0.9756371378898621
after epoch: 12,now: 2024-06-02 06:40:14.452239,epoch time: 0:33:43.804928,used: 6:48:41.847773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99126047, 'precision': 0.9569448, 'recall': 0.907526, 'specificity': 0.907526, 'f1': 0.9307132, 'auroc': 0.9964814, 'binary_precision': 0.9203869, 'binary_recall': 0.81758094, 'binary_specificity': 0.9974711, 'binary_f1_score': 0.8659433}
confusion matrix:
       0     1
0  42204   107
1    276  1237
---- Validation: 
scalar performance:
{'acc': 0.98465884, 'precision': 0.9072865, 'recall': 0.8282534, 'specificity': 0.8282534, 'f1': 0.86320937, 'auroc': 0.9717297, 'binary_precision': 0.82572615, 'binary_recall': 0.6611296, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.7343173}
confusion matrix:
       0    1
0  18087   84
1    204  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.86159694, 'recall': 0.5448709, 'specificity': 0.5448709, 'f1': 0.5718829, 'auroc': 0.96022975, 'binary_precision': 0.7586207, 'binary_recall': 0.09090909, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16236164}
confusion matrix:
      0   1
0  5990   7
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9846588373184204, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9628145694732666 / 0.9756371378898621
after epoch: 13,now: 2024-06-02 07:13:59.026663,epoch time: 0:33:44.574424,used: 7:22:26.422197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9921961, 'precision': 0.94049823, 'recall': 0.94274366, 'specificity': 0.94274366, 'f1': 0.94161785, 'auroc': 0.996826, 'binary_precision': 0.88494414, 'binary_recall': 0.8896233, 'binary_specificity': 0.995864, 'binary_f1_score': 0.88727754}
confusion matrix:
       0     1
0  42136   175
1    167  1346
---- Validation: 
scalar performance:
{'acc': 0.98545784, 'precision': 0.88526595, 'recall': 0.87845516, 'specificity': 0.87845516, 'f1': 0.8818277, 'auroc': 0.9740057, 'binary_precision': 0.77834177, 'binary_recall': 0.7641196, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.77116513}
confusion matrix:
       0    1
0  18040  131
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8311955, 'recall': 0.58321, 'specificity': 0.58321, 'f1': 0.6272203, 'auroc': 0.94895, 'binary_precision': 0.69491524, 'binary_recall': 0.1694215, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.27242526}
confusion matrix:
      0   1
0  5979  18
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 14,now: 2024-06-02 07:47:35.401986,epoch time: 0:33:36.375323,used: 7:56:02.797520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9927209, 'precision': 0.939504, 'recall': 0.95321226, 'specificity': 0.95321226, 'f1': 0.9462441, 'auroc': 0.9968977, 'binary_precision': 0.8822023, 'binary_recall': 0.9107733, 'binary_specificity': 0.99565125, 'binary_f1_score': 0.89626014}
confusion matrix:
       0     1
0  42127   184
1    135  1378
---- Validation: 
scalar performance:
{'acc': 0.98460555, 'precision': 0.8750043, 'recall': 0.8780149, 'specificity': 0.8780149, 'f1': 0.8765031, 'auroc': 0.9770357, 'binary_precision': 0.7578254, 'binary_recall': 0.7641196, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.7609595}
confusion matrix:
       0    1
0  18024  147
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8962408, 'recall': 0.5491699, 'specificity': 0.5491699, 'f1': 0.5794268, 'auroc': 0.944891, 'binary_precision': 0.82758623, 'binary_recall': 0.09917355, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.17712177}
confusion matrix:
      0   1
0  5992   5
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9846055507659912, best validation acc: 0.9854578375816345, corresponding to test acc:                         0.9648982286453247 / 0.9756371378898621
after epoch: 15,now: 2024-06-02 08:21:16.930710,epoch time: 0:33:41.528724,used: 8:29:44.326244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99292624, 'precision': 0.94694555, 'recall': 0.94694555, 'specificity': 0.94694555, 'f1': 0.94694555, 'auroc': 0.9971943, 'binary_precision': 0.8975545, 'binary_recall': 0.8975545, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.8975545}
confusion matrix:
       0     1
0  42156   155
1    155  1358
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.8937223, 'recall': 0.8664645, 'specificity': 0.8664645, 'f1': 0.8795662, 'auroc': 0.97211975, 'binary_precision': 0.7960644, 'binary_recall': 0.7392027, 'binary_specificity': 0.99372625, 'binary_f1_score': 0.7665805}
confusion matrix:
       0    1
0  18057  114
1    157  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8251898, 'recall': 0.5223104, 'specificity': 0.5223104, 'f1': 0.53297937, 'auroc': 0.9191271, 'binary_precision': 0.6875, 'binary_recall': 0.045454547, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.085271314}
confusion matrix:
      0   1
0  5992   5
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
better model found
persisted
after epoch: 16,now: 2024-06-02 08:53:26.787874,epoch time: 0:32:09.857164,used: 9:01:54.183408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99196786, 'precision': 0.9499994, 'recall': 0.9270115, 'specificity': 0.9270115, 'f1': 0.9381801, 'auroc': 0.99761057, 'binary_precision': 0.9050942, 'binary_recall': 0.8572373, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.880516}
confusion matrix:
       0     1
0  42175   136
1    216  1297
---- Validation: 
scalar performance:
{'acc': 0.9827412, 'precision': 0.8816037, 'recall': 0.82244456, 'specificity': 0.82244456, 'f1': 0.84934473, 'auroc': 0.97272694, 'binary_precision': 0.77470356, 'binary_recall': 0.6511628, 'binary_specificity': 0.99372625, 'binary_f1_score': 0.7075812}
confusion matrix:
       0    1
0  18057  114
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.74665594, 'recall': 0.53585607, 'specificity': 0.53585607, 'f1': 0.5553829, 'auroc': 0.92194045, 'binary_precision': 0.5294118, 'binary_recall': 0.07438017, 'binary_specificity': 0.997332, 'binary_f1_score': 0.13043478}
confusion matrix:
      0   1
0  5981  16
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 1
val acc:0.9827411770820618, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 17,now: 2024-06-02 09:25:47.512473,epoch time: 0:32:20.724599,used: 9:34:14.908007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99235576, 'precision': 0.940604, 'recall': 0.94537556, 'specificity': 0.94537556, 'f1': 0.9429758, 'auroc': 0.99705803, 'binary_precision': 0.8849673, 'binary_recall': 0.89491075, 'binary_specificity': 0.9958403, 'binary_f1_score': 0.88991123}
confusion matrix:
       0     1
0  42135   176
1    159  1354
---- Validation: 
scalar performance:
{'acc': 0.9830608, 'precision': 0.8561282, 'recall': 0.88123214, 'specificity': 0.88123214, 'f1': 0.86821574, 'auroc': 0.9744098, 'binary_precision': 0.71981424, 'binary_recall': 0.77242523, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.7451923}
confusion matrix:
       0    1
0  17990  181
1    137  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8087772, 'recall': 0.64344263, 'specificity': 0.64344263, 'f1': 0.69304544, 'auroc': 0.9385936, 'binary_precision': 0.6454545, 'binary_recall': 0.29338843, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4034091}
confusion matrix:
      0   1
0  5958  39
1   171  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 2
val acc:0.9830607771873474, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 18,now: 2024-06-02 09:59:20.036287,epoch time: 0:33:32.523814,used: 10:07:47.431821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9904162, 'precision': 0.9018825, 'recall': 0.9720938, 'specificity': 0.9720938, 'f1': 0.9339124, 'auroc': 0.9968764, 'binary_precision': 0.8054779, 'binary_recall': 0.9524124, 'binary_specificity': 0.9917752, 'binary_f1_score': 0.87280434}
confusion matrix:
       0     1
0  41963   348
1     72  1441
---- Validation: 
scalar performance:
{'acc': 0.9820487, 'precision': 0.83796835, 'recall': 0.9064069, 'specificity': 0.9064069, 'f1': 0.8687507, 'auroc': 0.9761467, 'binary_precision': 0.68175584, 'binary_recall': 0.8255814, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.7468069}
confusion matrix:
       0    1
0  17939  232
1    105  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7277194, 'recall': 0.5811256, 'specificity': 0.5811256, 'f1': 0.61572737, 'auroc': 0.9422051, 'binary_precision': 0.48809522, 'binary_recall': 0.1694215, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.25153375}
confusion matrix:
      0   1
0  5954  43
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 3
val acc:0.9820486903190613, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 19,now: 2024-06-02 10:31:48.666024,epoch time: 0:32:28.629737,used: 10:40:16.061558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9915343, 'precision': 0.9373419, 'recall': 0.9353906, 'specificity': 0.9353906, 'f1': 0.93636394, 'auroc': 0.996186, 'binary_precision': 0.8791501, 'binary_recall': 0.8750826, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.8771117}
confusion matrix:
       0     1
0  42129   182
1    189  1324
---- Validation: 
scalar performance:
{'acc': 0.98449904, 'precision': 0.89468515, 'recall': 0.8418227, 'specificity': 0.8418227, 'f1': 0.8662107, 'auroc': 0.9645109, 'binary_precision': 0.79961467, 'binary_recall': 0.6893688, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.74041045}
confusion matrix:
       0    1
0  18067  104
1    187  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.86598384, 'recall': 0.520411, 'specificity': 0.520411, 'f1': 0.5296027, 'auroc': 0.92640084, 'binary_precision': 0.7692308, 'binary_recall': 0.041322313, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.078431375}
confusion matrix:
      0   1
0  5994   3
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 4
val acc:0.9844990372657776, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 20,now: 2024-06-02 11:04:09.238523,epoch time: 0:32:20.572499,used: 11:12:36.634057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98945785, 'precision': 0.98102814, 'recall': 0.85720146, 'specificity': 0.85720146, 'f1': 0.9093166, 'auroc': 0.9969331, 'binary_precision': 0.97214735, 'binary_recall': 0.7151355, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.82406706}
confusion matrix:
       0     1
0  42280    31
1    431  1082
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.9226103, 'recall': 0.7957187, 'specificity': 0.7957187, 'f1': 0.8471772, 'auroc': 0.9605545, 'binary_precision': 0.8585132, 'binary_recall': 0.59468436, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.70264965}
confusion matrix:
       0    1
0  18112   59
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.58067054, 'recall': 0.50173265, 'specificity': 0.50173265, 'f1': 0.49403307, 'auroc': 0.9014566, 'binary_precision': 0.2, 'binary_recall': 0.004132231, 'binary_specificity': 0.999333, 'binary_f1_score': 0.008097166}
confusion matrix:
      0  1
0  5993  4
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 5
val acc:0.9838597774505615, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 21,now: 2024-06-02 11:36:23.007962,epoch time: 0:32:13.769439,used: 11:44:50.403496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99450076, 'precision': 0.9560006, 'recall': 0.9621003, 'specificity': 0.9621003, 'f1': 0.9590286, 'auroc': 0.99853504, 'binary_precision': 0.91460234, 'binary_recall': 0.92729676, 'binary_specificity': 0.9969039, 'binary_f1_score': 0.92090577}
confusion matrix:
       0     1
0  42180   131
1    110  1403
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.8779652, 'recall': 0.87978613, 'specificity': 0.87978613, 'f1': 0.8788733, 'auroc': 0.9725872, 'binary_precision': 0.76363635, 'binary_recall': 0.76744187, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.7655344}
confusion matrix:
       0    1
0  18028  143
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.91009754, 'recall': 0.5246267, 'specificity': 0.5246267, 'f1': 0.5373839, 'auroc': 0.9300768, 'binary_precision': 0.85714287, 'binary_recall': 0.049586777, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09375}
confusion matrix:
      0   1
0  5995   2
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011739.png
early stop counter: 6
val acc:0.9849251508712769, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9621734023094177 / 0.9756371378898621
after epoch: 22,now: 2024-06-02 12:08:29.552069,epoch time: 0:32:06.544107,used: 12:16:56.947603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_51_32_seed_2_21011739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9918081, 'precision': 0.982274, 'recall': 0.8921957, 'specificity': 0.8921957, 'f1': 0.9322554, 'auroc': 0.9970158, 'binary_precision': 0.97217673, 'binary_recall': 0.785195, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.8687386}
confusion matrix:
       0     1
0  42277    34
1    325  1188
---- Validation: 
slurmstepd: error: *** JOB 21011739 ON supergpu03 CANCELLED AT 2024-06-02T12:35:07 DUE TO TIME LIMIT ***
