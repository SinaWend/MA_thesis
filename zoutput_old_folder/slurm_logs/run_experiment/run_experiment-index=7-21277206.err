Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 23:41:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206

 Experiment start at: 2024-06-10 23:48:25.526058
before training, model accuracy: 0.891887903213501
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99753934, 'precision': 0.9982275, 'recall': 0.9873762, 'specificity': 0.9873762, 'f1': 0.99272674, 'auroc': 0.9993904, 'binary_precision': 0.99907106, 'binary_recall': 0.974847, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9868104}
confusion matrix:
       0     1
0  42319     4
1    111  4302
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7927426, 'recall': 0.50988847, 'specificity': 0.50988847, 'f1': 0.51093805, 'auroc': 0.9309453, 'binary_precision': 0.61904764, 'binary_recall': 0.02021773, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.039156627}
confusion matrix:
       0   1
0  18141   8
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9932153, 'precision': 0.99619395, 'recall': 0.97062576, 'specificity': 0.97062576, 'f1': 0.98295814, 'auroc': 0.9998991, 'binary_precision': 1.0, 'binary_recall': 0.9412516, 'binary_specificity': 1.0, 'binary_f1_score': 0.9697369}
confusion matrix:
      0    1
0  5997    0
1    46  737
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 00:27:55.996243,epoch time: 0:39:30.470185,used: 0:39:30.470185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.99231446, 'recall': 0.9928137, 'specificity': 0.9928137, 'f1': 0.99256396, 'auroc': 0.99963474, 'binary_precision': 0.98597604, 'binary_recall': 0.9870924, 'binary_specificity': 0.998535, 'binary_f1_score': 0.9865339}
confusion matrix:
       0     1
0  42258    62
1     57  4359
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.7313366, 'recall': 0.634762, 'specificity': 0.634762, 'f1': 0.6689517, 'auroc': 0.90054464, 'binary_precision': 0.4878049, 'binary_recall': 0.2799378, 'binary_specificity': 0.9895862, 'binary_f1_score': 0.35573125}
confusion matrix:
       0    1
0  17960  189
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9975381, 'recall': 0.99089324, 'specificity': 0.99089324, 'f1': 0.9941857, 'auroc': 0.9993566, 'binary_precision': 0.99740595, 'binary_recall': 0.98212004, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.98970395}
confusion matrix:
      0    1
0  5995    2
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_2.png
new oracle model saved
early stop counter: 1
val acc:0.9653043746948242, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9932153224945068 / 0.9976401329040527
after epoch: 2,now: 2024-06-11 01:06:39.867697,epoch time: 0:38:43.871454,used: 1:18:14.341639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.99901205, 'recall': 0.99160004, 'specificity': 0.99160004, 'f1': 0.9952712, 'auroc': 0.9993355, 'binary_precision': 0.99976945, 'binary_recall': 0.98322374, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9914276}
confusion matrix:
       0     1
0  42324     1
1     74  4337
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.84612846, 'recall': 0.5222475, 'specificity': 0.5222475, 'f1': 0.53399116, 'auroc': 0.92199016, 'binary_precision': 0.725, 'binary_recall': 0.045101088, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.08491947}
confusion matrix:
       0   1
0  18138  11
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.99981153, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_3.png
better model found
persisted
after epoch: 3,now: 2024-06-11 01:45:42.208733,epoch time: 0:39:02.341036,used: 1:57:16.682675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99835247, 'precision': 0.9987819, 'recall': 0.99158406, 'specificity': 0.99158406, 'f1': 0.99515, 'auroc': 0.99974275, 'binary_precision': 0.9993094, 'binary_recall': 0.98323894, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99120903}
confusion matrix:
       0     1
0  42318     3
1     74  4341
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7839494, 'recall': 0.531888, 'specificity': 0.531888, 'f1': 0.5503763, 'auroc': 0.9491556, 'binary_precision': 0.6, 'binary_recall': 0.065318815, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.11781206}
confusion matrix:
       0   1
0  18121  28
1    601  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.99970484, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_4.png
early stop counter: 1
val acc:0.9665282964706421, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9971976280212402 / 0.9976401329040527
after epoch: 4,now: 2024-06-11 02:24:46.536727,epoch time: 0:39:04.327994,used: 2:36:21.010669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.996917, 'recall': 0.9931834, 'specificity': 0.9931834, 'f1': 0.99504125, 'auroc': 0.99966836, 'binary_precision': 0.9952033, 'binary_recall': 0.98686296, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.99101555}
confusion matrix:
       0     1
0  42300    21
1     58  4357
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.88036954, 'recall': 0.60859543, 'specificity': 0.60859543, 'f1': 0.66418827, 'auroc': 0.9471984, 'binary_precision': 0.7877095, 'binary_recall': 0.21928461, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.34306568}
confusion matrix:
       0    1
0  18111   38
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.99995255, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_5.png
better model found
persisted
after epoch: 5,now: 2024-06-11 03:03:45.906710,epoch time: 0:38:59.369983,used: 3:15:20.380652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9990121, 'recall': 0.99160767, 'specificity': 0.99160767, 'f1': 0.995275, 'auroc': 0.9997447, 'binary_precision': 0.9997697, 'binary_recall': 0.98323894, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9914354}
confusion matrix:
       0     1
0  42320     1
1     74  4341
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.89393985, 'recall': 0.53163385, 'specificity': 0.53163385, 'f1': 0.55088186, 'auroc': 0.93682516, 'binary_precision': 0.82, 'binary_recall': 0.06376361, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.11832612}
confusion matrix:
       0   1
0  18140   9
1    602  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9978416, 'recall': 0.9833972, 'specificity': 0.9833972, 'f1': 0.9904769, 'auroc': 0.99979067, 'binary_precision': 1.0, 'binary_recall': 0.9667944, 'binary_specificity': 1.0, 'binary_f1_score': 0.98311687}
confusion matrix:
      0    1
0  5997    0
1    26  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_6.png
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.9712643623352051, corresponding to test acc:                         0.9970501661300659 / 0.9976401329040527
after epoch: 6,now: 2024-06-11 03:42:36.486507,epoch time: 0:38:50.579797,used: 3:54:10.960449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.998545, 'precision': 0.99899155, 'recall': 0.99249846, 'specificity': 0.99249846, 'f1': 0.99571824, 'auroc': 0.9998052, 'binary_precision': 0.99954015, 'binary_recall': 0.9850442, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9922392}
confusion matrix:
       0     1
0  42321     2
1     66  4347
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.9018799, 'recall': 0.5880133, 'specificity': 0.5880133, 'f1': 0.63865465, 'auroc': 0.95111084, 'binary_precision': 0.8321168, 'binary_recall': 0.17729394, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.29230767}
confusion matrix:
       0    1
0  18126   23
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9986695, 'recall': 0.9897829, 'specificity': 0.9897829, 'f1': 0.9941726, 'auroc': 0.99877894, 'binary_precision': 1.0, 'binary_recall': 0.9795658, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896774}
confusion matrix:
      0    1
0  5997    0
1    16  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_7.png
early stop counter: 2
val acc:0.9706258177757263, best validation acc: 0.9712643623352051, corresponding to test acc:                         0.9970501661300659 / 0.9976401329040527
after epoch: 7,now: 2024-06-11 04:21:21.707379,epoch time: 0:38:45.220872,used: 4:32:56.181321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99841666, 'precision': 0.99912727, 'recall': 0.99161756, 'specificity': 0.99161756, 'f1': 0.99533665, 'auroc': 0.9999184, 'binary_precision': 1.0, 'binary_recall': 0.9832352, 'binary_specificity': 1.0, 'binary_f1_score': 0.99154675}
confusion matrix:
       0     1
0  42322     0
1     74  4340
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.9546504, 'recall': 0.57137436, 'specificity': 0.57137436, 'f1': 0.6165974, 'auroc': 0.9623245, 'binary_precision': 0.93877554, 'binary_recall': 0.14307931, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.24831308}
confusion matrix:
       0   1
0  18143   6
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9989599, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_8.png
early stop counter: 3
val acc:0.970359742641449, best validation acc: 0.9712643623352051, corresponding to test acc:                         0.9970501661300659 / 0.9976401329040527
after epoch: 8,now: 2024-06-11 04:59:50.924972,epoch time: 0:38:29.217593,used: 5:11:25.398914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.9980196, 'recall': 0.99295866, 'specificity': 0.99295866, 'f1': 0.9954729, 'auroc': 0.9996133, 'binary_precision': 0.9974788, 'binary_recall': 0.9861772, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.99179584}
confusion matrix:
       0     1
0  42312    11
1     61  4352
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.80922186, 'recall': 0.6494077, 'specificity': 0.6494077, 'f1': 0.6991629, 'auroc': 0.95213187, 'binary_precision': 0.64262295, 'binary_recall': 0.30482116, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.41350213}
confusion matrix:
       0    1
0  18040  109
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954277, 'precision': 0.99742866, 'recall': 0.98020434, 'specificity': 0.98020434, 'f1': 0.9886133, 'auroc': 0.9995834, 'binary_precision': 1.0, 'binary_recall': 0.9604087, 'binary_specificity': 1.0, 'binary_f1_score': 0.9798046}
confusion matrix:
      0    1
0  5997    0
1    31  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_9.png
early stop counter: 4
val acc:0.9704129695892334, best validation acc: 0.9712643623352051, corresponding to test acc:                         0.9970501661300659 / 0.9976401329040527
after epoch: 9,now: 2024-06-11 05:37:55.933003,epoch time: 0:38:05.008031,used: 5:49:30.406945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.99902856, 'recall': 0.9960904, 'specificity': 0.9960904, 'f1': 0.99755406, 'auroc': 0.99984354, 'binary_precision': 0.99886, 'binary_recall': 0.99229896, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99556863}
confusion matrix:
       0     1
0  42316     5
1     34  4381
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7208618, 'recall': 0.5141959, 'specificity': 0.5141959, 'f1': 0.51907885, 'auroc': 0.95574814, 'binary_precision': 0.475, 'binary_recall': 0.02954899, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.055636898}
confusion matrix:
       0   1
0  18128  21
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.9988575, 'recall': 0.99608517, 'specificity': 0.99608517, 'f1': 0.9974661, 'auroc': 0.9999331, 'binary_precision': 0.9987146, 'binary_recall': 0.99233717, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99551564}
confusion matrix:
      0    1
0  5996    1
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_10.png
new oracle model saved
early stop counter: 5
val acc:0.9656769037246704, best validation acc: 0.9712643623352051, corresponding to test acc:                         0.9970501661300659 / 0.9989675283432007
after epoch: 10,now: 2024-06-11 06:16:43.510794,epoch time: 0:38:47.577791,used: 6:28:17.984736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.99404275, 'recall': 0.9934411, 'specificity': 0.9934411, 'f1': 0.9937417, 'auroc': 0.99955887, 'binary_precision': 0.98933756, 'binary_recall': 0.98799276, 'binary_specificity': 0.99888945, 'binary_f1_score': 0.9886647}
confusion matrix:
       0     1
0  42275    47
1     53  4361
---- Validation: 
scalar performance:
{'acc': 0.9723819, 'precision': 0.81306857, 'recall': 0.7089313, 'specificity': 0.7089313, 'f1': 0.7496885, 'auroc': 0.95245713, 'binary_precision': 0.6462264, 'binary_recall': 0.42612752, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.5135895}
confusion matrix:
       0    1
0  17999  150
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.9997823, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_11.png
better model found
persisted
after epoch: 11,now: 2024-06-11 06:51:53.287083,epoch time: 0:35:09.776289,used: 7:03:27.761025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9991183, 'recall': 0.99262524, 'specificity': 0.99262524, 'f1': 0.9958451, 'auroc': 0.9999293, 'binary_precision': 0.9997701, 'binary_recall': 0.98527414, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9924692}
confusion matrix:
       0     1
0  42321     1
1     65  4349
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.95119405, 'recall': 0.583761, 'specificity': 0.583761, 'f1': 0.63491976, 'auroc': 0.95384836, 'binary_precision': 0.9310345, 'binary_recall': 0.16796267, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.284585}
confusion matrix:
       0    1
0  18141    8
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9964602, 'precision': 0.99800694, 'recall': 0.98467433, 'specificity': 0.98467433, 'f1': 0.9912194, 'auroc': 0.99985707, 'binary_precision': 1.0, 'binary_recall': 0.96934867, 'binary_specificity': 1.0, 'binary_f1_score': 0.9844358}
confusion matrix:
      0    1
0  5997    0
1    24  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_12.png
early stop counter: 1
val acc:0.9711047410964966, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9989675283432007
after epoch: 12,now: 2024-06-11 07:26:39.136965,epoch time: 0:34:45.849882,used: 7:38:13.610907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99905854, 'precision': 0.99815595, 'recall': 0.99633646, 'specificity': 0.99633646, 'f1': 0.9972441, 'auroc': 0.9999368, 'binary_precision': 0.9970441, 'binary_recall': 0.99298006, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.99500793}
confusion matrix:
       0     1
0  42307    13
1     31  4385
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.9621513, 'recall': 0.54968405, 'specificity': 0.54968405, 'f1': 0.5822491, 'auroc': 0.9559277, 'binary_precision': 0.95522386, 'binary_recall': 0.09953344, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.18028168}
confusion matrix:
       0   1
0  18146   3
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9989185, 'recall': 0.9916986, 'specificity': 0.9916986, 'f1': 0.9952732, 'auroc': 0.99916613, 'binary_precision': 1.0, 'binary_recall': 0.9833972, 'binary_specificity': 1.0, 'binary_f1_score': 0.99162906}
confusion matrix:
      0    1
0  5997    0
1    13  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_13.png
early stop counter: 2
val acc:0.9690293669700623, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9989675283432007
after epoch: 13,now: 2024-06-11 08:01:24.115324,epoch time: 0:34:44.978359,used: 8:12:58.589266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9986948, 'precision': 0.99928033, 'recall': 0.9930917, 'specificity': 0.9930917, 'f1': 0.9961618, 'auroc': 0.9998492, 'binary_precision': 1.0, 'binary_recall': 0.98618346, 'binary_specificity': 1.0, 'binary_f1_score': 0.9930437}
confusion matrix:
       0     1
0  42321     0
1     61  4354
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.9415069, 'recall': 0.50852615, 'specificity': 0.50852615, 'f1': 0.50822335, 'auroc': 0.94360316, 'binary_precision': 0.9166667, 'binary_recall': 0.01710731, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.033587787}
confusion matrix:
       0   1
0  18148   1
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.99858665, 'recall': 0.9891443, 'specificity': 0.9891443, 'f1': 0.9938049, 'auroc': 0.99962723, 'binary_precision': 1.0, 'binary_recall': 0.97828865, 'binary_specificity': 1.0, 'binary_f1_score': 0.9890252}
confusion matrix:
      0    1
0  5997    0
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_14.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9989675283432007
after epoch: 14,now: 2024-06-11 08:36:11.722299,epoch time: 0:34:47.606975,used: 8:47:46.196241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.9993393, 'recall': 0.9936551, 'specificity': 0.9936551, 'f1': 0.99647677, 'auroc': 0.99993277, 'binary_precision': 1.0, 'binary_recall': 0.98731023, 'binary_specificity': 1.0, 'binary_f1_score': 0.9936146}
confusion matrix:
       0     1
0  42323     0
1     56  4357
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.96801746, 'recall': 0.5458236, 'specificity': 0.5458236, 'f1': 0.57586217, 'auroc': 0.96533644, 'binary_precision': 0.9672131, 'binary_recall': 0.09175739, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.16761364}
confusion matrix:
       0   1
0  18147   2
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9989185, 'recall': 0.9916986, 'specificity': 0.9916986, 'f1': 0.9952732, 'auroc': 0.999635, 'binary_precision': 1.0, 'binary_recall': 0.9833972, 'binary_specificity': 1.0, 'binary_f1_score': 0.99162906}
confusion matrix:
      0    1
0  5997    0
1    13  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_15.png
early stop counter: 4
val acc:0.9688165187835693, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9989675283432007
after epoch: 15,now: 2024-06-11 09:11:00.616611,epoch time: 0:34:48.894312,used: 9:22:35.090553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99890876, 'precision': 0.9968609, 'recall': 0.99676013, 'specificity': 0.99676013, 'f1': 0.99681056, 'auroc': 0.9999285, 'binary_precision': 0.9943362, 'binary_recall': 0.994111, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.9942236}
confusion matrix:
       0     1
0  42296    25
1     26  4389
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.8260913, 'recall': 0.5688274, 'specificity': 0.5688274, 'f1': 0.60804677, 'auroc': 0.9433504, 'binary_precision': 0.6818182, 'binary_recall': 0.1399689, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.23225805}
confusion matrix:
       0   1
0  18107  42
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.9999751, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_16.png
new oracle model saved
early stop counter: 5
val acc:0.9683375954627991, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 16,now: 2024-06-11 09:49:37.609293,epoch time: 0:38:36.992682,used: 10:01:12.083235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9995868, 'recall': 0.9960371, 'specificity': 0.9960371, 'f1': 0.997804, 'auroc': 0.9999248, 'binary_precision': 1.0, 'binary_recall': 0.99207425, 'binary_specificity': 1.0, 'binary_f1_score': 0.99602133}
confusion matrix:
       0     1
0  42320     0
1     35  4381
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.9833546, 'recall': 0.5139969, 'specificity': 0.5139969, 'f1': 0.5187679, 'auroc': 0.9590851, 'binary_precision': 1.0, 'binary_recall': 0.02799378, 'binary_specificity': 1.0, 'binary_f1_score': 0.054462936}
confusion matrix:
       0   1
0  18149   0
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.9998157, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_17.png
early stop counter: 6
val acc:0.966741144657135, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 17,now: 2024-06-11 10:26:08.175245,epoch time: 0:36:30.565952,used: 10:37:42.649187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.999634, 'recall': 0.9964892, 'specificity': 0.9964892, 'f1': 0.99805534, 'auroc': 0.9999082, 'binary_precision': 1.0, 'binary_recall': 0.99297845, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964768}
confusion matrix:
       0     1
0  42321     0
1     31  4384
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.9333528, 'recall': 0.51394176, 'specificity': 0.51394176, 'f1': 0.5186582, 'auroc': 0.9687951, 'binary_precision': 0.9, 'binary_recall': 0.02799378, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.054298643}
confusion matrix:
       0   1
0  18147   2
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.99991715, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_18.png
early stop counter: 7
val acc:0.9666347503662109, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 18,now: 2024-06-11 11:02:03.602761,epoch time: 0:35:55.427516,used: 11:13:38.076703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.9994689, 'recall': 0.99490374, 'specificity': 0.99490374, 'f1': 0.99717313, 'auroc': 0.99998516, 'binary_precision': 1.0, 'binary_recall': 0.9898075, 'binary_specificity': 1.0, 'binary_f1_score': 0.99487764}
confusion matrix:
       0     1
0  42321     0
1     45  4370
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.9833032, 'recall': 0.5124417, 'specificity': 0.5124417, 'f1': 0.51578903, 'auroc': 0.9612038, 'binary_precision': 1.0, 'binary_recall': 0.02488336, 'binary_specificity': 1.0, 'binary_f1_score': 0.04855842}
confusion matrix:
       0   1
0  18149   0
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.9999725, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_19.png
early stop counter: 8
val acc:0.9666347503662109, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 19,now: 2024-06-11 11:36:55.958606,epoch time: 0:34:52.355845,used: 11:48:30.432548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.99949634, 'recall': 0.9962518, 'specificity': 0.9962518, 'f1': 0.99786735, 'auroc': 0.9999603, 'binary_precision': 0.9997719, 'binary_recall': 0.9925272, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99613637}
confusion matrix:
       0     1
0  42319     1
1     33  4383
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.9710487, 'recall': 0.52952147, 'specificity': 0.52952147, 'f1': 0.5475075, 'auroc': 0.97108734, 'binary_precision': 0.974359, 'binary_recall': 0.05909798, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.111436956}
confusion matrix:
       0   1
0  18148   1
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99933386, 'recall': 0.9948914, 'specificity': 0.9948914, 'f1': 0.9970994, 'auroc': 0.99996674, 'binary_precision': 1.0, 'binary_recall': 0.98978287, 'binary_specificity': 1.0, 'binary_f1_score': 0.99486524}
confusion matrix:
      0    1
0  5997    0
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_20.png
early stop counter: 9
val acc:0.96775221824646, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 20,now: 2024-06-11 12:13:06.425335,epoch time: 0:36:10.466729,used: 12:24:40.899277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.9992563, 'recall': 0.99611235, 'specificity': 0.99611235, 'f1': 0.99767804, 'auroc': 0.99989974, 'binary_precision': 0.9993154, 'binary_recall': 0.9922955, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99579304}
confusion matrix:
       0     1
0  42320     3
1     34  4379
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.916306, 'recall': 0.6043706, 'specificity': 0.6043706, 'f1': 0.66154575, 'auroc': 0.96803796, 'binary_precision': 0.85987264, 'binary_recall': 0.20995334, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.33749998}
confusion matrix:
       0    1
0  18127   22
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.9999446, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_21.png
early stop counter: 10
val acc:0.9717965126037598, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 21,now: 2024-06-11 12:48:36.458187,epoch time: 0:35:30.032852,used: 13:00:10.932129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9995868, 'recall': 0.99603623, 'specificity': 0.99603623, 'f1': 0.99780357, 'auroc': 0.99994457, 'binary_precision': 1.0, 'binary_recall': 0.99207246, 'binary_specificity': 1.0, 'binary_f1_score': 0.99602044}
confusion matrix:
       0     1
0  42321     0
1     35  4380
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.9141768, 'recall': 0.5564346, 'specificity': 0.5564346, 'f1': 0.5923791, 'auroc': 0.96235836, 'binary_precision': 0.85882354, 'binary_recall': 0.11353032, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.20054944}
confusion matrix:
       0   1
0  18137  12
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.9986894, 'recall': 0.9948081, 'specificity': 0.9948081, 'f1': 0.99673855, 'auroc': 0.99960744, 'binary_precision': 0.99871135, 'binary_recall': 0.98978287, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9942271}
confusion matrix:
      0    1
0  5996    1
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_22.png
early stop counter: 11
val acc:0.9690293669700623, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 22,now: 2024-06-11 13:24:29.728984,epoch time: 0:35:53.270797,used: 13:36:04.202926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99955064, 'precision': 0.99975204, 'recall': 0.99762225, 'specificity': 0.99762225, 'f1': 0.9986843, 'auroc': 0.999963, 'binary_precision': 1.0, 'binary_recall': 0.99524456, 'binary_specificity': 1.0, 'binary_f1_score': 0.99761665}
confusion matrix:
       0     1
0  42320     0
1     21  4395
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.8533446, 'recall': 0.5368567, 'specificity': 0.5368567, 'f1': 0.5594985, 'auroc': 0.96270216, 'binary_precision': 0.73846155, 'binary_recall': 0.07465008, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.13559322}
confusion matrix:
       0   1
0  18132  17
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.9998161, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_23.png
early stop counter: 12
val acc:0.967432975769043, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 23,now: 2024-06-11 14:00:11.355314,epoch time: 0:35:41.626330,used: 14:11:45.829256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.99950814, 'recall': 0.9963642, 'specificity': 0.9963642, 'f1': 0.99792993, 'auroc': 0.9997436, 'binary_precision': 0.9997719, 'binary_recall': 0.99275196, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99624956}
confusion matrix:
       0     1
0  42320     1
1     32  4383
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.9318339, 'recall': 0.5201351, 'specificity': 0.5201351, 'f1': 0.5302921, 'auroc': 0.9483268, 'binary_precision': 0.8965517, 'binary_recall': 0.04043546, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.077380955}
confusion matrix:
       0   1
0  18146   3
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.99858665, 'recall': 0.9891443, 'specificity': 0.9891443, 'f1': 0.9938049, 'auroc': 0.9993704, 'binary_precision': 1.0, 'binary_recall': 0.97828865, 'binary_specificity': 1.0, 'binary_f1_score': 0.9890252}
confusion matrix:
      0    1
0  5997    0
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_24.png
early stop counter: 13
val acc:0.9670072197914124, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 24,now: 2024-06-11 14:39:58.901013,epoch time: 0:39:47.545699,used: 14:51:33.374955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9994865, 'precision': 0.9993092, 'recall': 0.9976877, 'specificity': 0.9976877, 'f1': 0.9984968, 'auroc': 0.99994355, 'binary_precision': 0.99909073, 'binary_recall': 0.99547, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9972771}
confusion matrix:
       0     1
0  42317     4
1     20  4395
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.9477471, 'recall': 0.5488514, 'specificity': 0.5488514, 'f1': 0.58067495, 'auroc': 0.9698617, 'binary_precision': 0.9264706, 'binary_recall': 0.09797823, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.1772152}
confusion matrix:
       0   1
0  18144   5
1    580  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.9999521, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_25.png
early stop counter: 14
val acc:0.9688697457313538, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 25,now: 2024-06-11 15:20:22.364497,epoch time: 0:40:23.463484,used: 15:31:56.838439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9974992, 'recall': 0.9974992, 'specificity': 0.9974992, 'f1': 0.9974992, 'auroc': 0.99990225, 'binary_precision': 0.995471, 'binary_recall': 0.995471, 'binary_specificity': 0.9995274, 'binary_f1_score': 0.995471}
confusion matrix:
       0     1
0  42300    20
1     20  4396
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.8616224, 'recall': 0.62831724, 'specificity': 0.62831724, 'f1': 0.6855962, 'auroc': 0.9582852, 'binary_precision': 0.7488789, 'binary_recall': 0.25972006, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.3856813}
confusion matrix:
       0    1
0  18093   56
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99485326, 'recall': 0.9986944, 'specificity': 0.9986944, 'f1': 0.9967638, 'auroc': 0.9999908, 'binary_precision': 0.9898734, 'binary_recall': 0.99872285, 'binary_specificity': 0.998666, 'binary_f1_score': 0.9942785}
confusion matrix:
      0    1
0  5989    8
1     1  782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_26.png
early stop counter: 15
val acc:0.9716900587081909, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 26,now: 2024-06-11 16:01:24.474716,epoch time: 0:41:02.110219,used: 16:12:58.948658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99910134, 'precision': 0.99950427, 'recall': 0.99524456, 'specificity': 0.99524456, 'f1': 0.997363, 'auroc': 0.9999242, 'binary_precision': 1.0, 'binary_recall': 0.9904891, 'binary_specificity': 1.0, 'binary_f1_score': 0.99522185}
confusion matrix:
       0     1
0  42320     0
1     42  4374
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.957501, 'recall': 0.52793866, 'specificity': 0.52793866, 'f1': 0.54461205, 'auroc': 0.95638114, 'binary_precision': 0.94736844, 'binary_recall': 0.05598756, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.105726875}
confusion matrix:
       0   1
0  18147   2
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.9999136, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_27.png
early stop counter: 16
val acc:0.9675925970077515, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 27,now: 2024-06-11 16:41:47.062330,epoch time: 0:40:22.587614,used: 16:53:21.536272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9995396, 'recall': 0.99558425, 'specificity': 0.99558425, 'f1': 0.99755204, 'auroc': 0.9999163, 'binary_precision': 1.0, 'binary_recall': 0.9911685, 'binary_specificity': 1.0, 'binary_f1_score': 0.99556464}
confusion matrix:
       0     1
0  42320     0
1     39  4377
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.9382067, 'recall': 0.5232455, 'specificity': 0.5232455, 'f1': 0.53603363, 'auroc': 0.95580024, 'binary_precision': 0.90909094, 'binary_recall': 0.0466563, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.088757396}
confusion matrix:
       0   1
0  18146   3
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.99993354, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_28.png
early stop counter: 17
val acc:0.9672200679779053, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 28,now: 2024-06-11 17:21:34.292539,epoch time: 0:39:47.230209,used: 17:33:08.766481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9987162, 'precision': 0.99929214, 'recall': 0.9932034, 'specificity': 0.9932034, 'f1': 0.99622434, 'auroc': 0.9998858, 'binary_precision': 1.0, 'binary_recall': 0.98640686, 'binary_specificity': 1.0, 'binary_f1_score': 0.99315697}
confusion matrix:
       0     1
0  42322     0
1     60  4354
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7329165, 'recall': 0.50075006, 'specificity': 0.50075006, 'f1': 0.49284685, 'auroc': 0.95613945, 'binary_precision': 0.5, 'binary_recall': 0.00155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0031007752}
confusion matrix:
       0  1
0  18148  1
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9967552, 'precision': 0.99817246, 'recall': 0.9859515, 'specificity': 0.9859515, 'f1': 0.9919602, 'auroc': 0.9996507, 'binary_precision': 1.0, 'binary_recall': 0.97190297, 'binary_specificity': 1.0, 'binary_f1_score': 0.98575133}
confusion matrix:
      0    1
0  5997    0
1    22  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_29.png
early stop counter: 18
val acc:0.9657832980155945, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 29,now: 2024-06-11 18:02:44.852726,epoch time: 0:41:10.560187,used: 18:14:19.326668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9994651, 'precision': 0.99970484, 'recall': 0.9971694, 'specificity': 0.9971694, 'f1': 0.998433, 'auroc': 0.9999268, 'binary_precision': 1.0, 'binary_recall': 0.99433875, 'binary_specificity': 1.0, 'binary_f1_score': 0.9971613}
confusion matrix:
       0     1
0  42320     0
1     25  4391
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.95110464, 'recall': 0.59306467, 'specificity': 0.59306467, 'f1': 0.6482145, 'auroc': 0.97006357, 'binary_precision': 0.9302326, 'binary_recall': 0.1866252, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.31088084}
confusion matrix:
       0    1
0  18140    9
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.99991846, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_30.png
early stop counter: 19
val acc:0.9716900587081909, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.9970501661300659 / 0.9992625117301941
after epoch: 30,now: 2024-06-11 18:42:22.298457,epoch time: 0:39:37.445731,used: 18:53:56.772399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_48_25_seed_0_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:53:56.772399 at 2024-06-11 18:42:22.298457
persisted model performance metric: 

scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.999908, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
oracle model performance metric: 

scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.9999902, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      5 MiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430142 KiB |    863 MiB | 443130 GiB | 443129 GiB |
|       from large pool | 410304 KiB |    862 MiB | 429396 GiB | 429396 GiB |
|       from small pool |  19838 KiB |     21 MiB |  13733 GiB |  13733 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3558    |    6725    |  162360 K  |  162356 K  |
|       from large pool |     247    |     989    |   66806 K  |   66806 K  |
|       from small pool |    3311    |    6476    |   95553 K  |   95550 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3558    |    6725    |  162360 K  |  162356 K  |
|       from large pool |     247    |     989    |   66806 K  |   66806 K  |
|       from small pool |    3311    |    6476    |   95553 K  |   95550 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    3056    |   96326 K  |   96326 K  |
|       from large pool |     112    |     516    |   50599 K  |   50599 K  |
|       from small pool |      34    |    2944    |   45726 K  |   45726 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443131 GiB | 443131 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429397 GiB | 429397 GiB |
|       from small pool |      0 KiB |     24 MiB |  13733 GiB |  13733 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96327 K  |   96327 K  |
|       from large pool |       2    |     516    |   50599 K  |   50599 K  |
|       from small pool |       0    |    2944    |   45728 K  |   45728 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443131 GiB | 443131 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429397 GiB | 429397 GiB |
|       from small pool |      0 KiB |     24 MiB |  13733 GiB |  13733 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96327 K  |   96327 K  |
|       from large pool |       2    |     516    |   50599 K  |   50599 K  |
|       from small pool |       0    |    2944    |   45728 K  |   45728 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206

 Experiment start at: 2024-06-11 18:51:00.830495
before training, model accuracy: 0.1214689239859581
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9940945, 'precision': 0.9785502, 'recall': 0.98667836, 'specificity': 0.98667836, 'f1': 0.9825711, 'auroc': 0.9984528, 'binary_precision': 0.959392, 'binary_recall': 0.97757745, 'binary_specificity': 0.9957793, 'binary_f1_score': 0.96839935}
confusion matrix:
       0     1
0  42231   179
1     97  4229
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.75716245, 'recall': 0.74721426, 'specificity': 0.74721426, 'f1': 0.7520788, 'auroc': 0.9371983, 'binary_precision': 0.5325077, 'binary_recall': 0.5111441, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.5216073}
confusion matrix:
       0    1
0  17765  302
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99675524, 'recall': 0.9850882, 'specificity': 0.9850882, 'f1': 0.99082863, 'auroc': 0.9960575, 'binary_precision': 0.99736494, 'binary_recall': 0.9705128, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9837557}
confusion matrix:
      0    1
0  5944    2
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 19:32:50.201674,epoch time: 0:41:49.371179,used: 0:41:49.371179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9981599, 'precision': 0.99564534, 'recall': 0.99337995, 'specificity': 0.99337995, 'f1': 0.9945094, 'auroc': 0.99976707, 'binary_precision': 0.9925633, 'binary_recall': 0.98751444, 'binary_specificity': 0.99924546, 'binary_f1_score': 0.99003243}
confusion matrix:
       0     1
0  42379    32
1     54  4271
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.8249947, 'recall': 0.6357242, 'specificity': 0.6357242, 'f1': 0.688319, 'auroc': 0.92270136, 'binary_precision': 0.67636365, 'binary_recall': 0.27637443, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.39240506}
confusion matrix:
       0    1
0  17978   89
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.9972669, 'recall': 0.9889344, 'specificity': 0.9889344, 'f1': 0.9930533, 'auroc': 0.9992069, 'binary_precision': 0.9973856, 'binary_recall': 0.97820514, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9877023}
confusion matrix:
      0    1
0  5944    2
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 20:12:18.714513,epoch time: 0:39:28.512839,used: 1:21:17.884018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99698305, 'precision': 0.9885999, 'recall': 0.9935633, 'specificity': 0.9935633, 'f1': 0.99106586, 'auroc': 0.99934185, 'binary_precision': 0.97828573, 'binary_recall': 0.9893666, 'binary_specificity': 0.99775994, 'binary_f1_score': 0.983795}
confusion matrix:
       0     1
0  42315    95
1     46  4280
---- Validation: 
scalar performance:
{'acc': 0.95880467, 'precision': 0.7184744, 'recall': 0.8148389, 'specificity': 0.8148389, 'f1': 0.7566937, 'auroc': 0.9327498, 'binary_precision': 0.44984803, 'binary_recall': 0.6597325, 'binary_specificity': 0.9699452, 'binary_f1_score': 0.53493977}
confusion matrix:
       0    1
0  17524  543
1    229  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.9942963, 'recall': 0.99043703, 'specificity': 0.99043703, 'f1': 0.9923565, 'auroc': 0.9996419, 'binary_precision': 0.9909444, 'binary_recall': 0.98205125, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.9864778}
confusion matrix:
      0    1
0  5939    7
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_3.png
early stop counter: 1
val acc:0.9588046669960022, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9971751570701599 / 0.9971751570701599
after epoch: 3,now: 2024-06-11 20:48:14.076921,epoch time: 0:35:55.362408,used: 1:57:13.246426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.9990822, 'recall': 0.99212694, 'specificity': 0.99212694, 'f1': 0.995574, 'auroc': 0.99949795, 'binary_precision': 0.99976516, 'binary_recall': 0.9842774, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9919608}
confusion matrix:
       0     1
0  42410     1
1     68  4257
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.87716305, 'recall': 0.5110334, 'specificity': 0.5110334, 'f1': 0.5126788, 'auroc': 0.9375697, 'binary_precision': 0.7894737, 'binary_recall': 0.022288261, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.043352596}
confusion matrix:
       0   1
0  18063   4
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.9998284, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_4.png
early stop counter: 2
val acc:0.9646744728088379, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9971751570701599 / 0.9971751570701599
after epoch: 4,now: 2024-06-11 21:23:33.033698,epoch time: 0:35:18.956777,used: 2:32:32.203203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9944111, 'recall': 0.9955397, 'specificity': 0.9955397, 'f1': 0.9949746, 'auroc': 0.9998607, 'binary_precision': 0.98962414, 'binary_recall': 0.99214053, 'binary_specificity': 0.9989389, 'binary_f1_score': 0.9908807}
confusion matrix:
       0     1
0  42365    45
1     34  4292
---- Validation: 
scalar performance:
{'acc': 0.9537887, 'precision': 0.67692244, 'recall': 0.70208627, 'specificity': 0.70208627, 'f1': 0.6885368, 'auroc': 0.9175613, 'binary_precision': 0.3751617, 'binary_recall': 0.4309064, 'binary_specificity': 0.9732662, 'binary_f1_score': 0.4011065}
confusion matrix:
       0    1
0  17584  483
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.99859655, 'recall': 0.9941467, 'specificity': 0.9941467, 'f1': 0.99635816, 'auroc': 0.999765, 'binary_precision': 0.9987047, 'binary_recall': 0.98846155, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99355674}
confusion matrix:
      0    1
0  5945    1
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_5.png
new oracle model saved
early stop counter: 3
val acc:0.953788697719574, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9971751570701599 / 0.9985132217407227
after epoch: 5,now: 2024-06-11 21:59:56.903762,epoch time: 0:36:23.870064,used: 3:08:56.073267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9955281, 'precision': 0.97982275, 'recall': 0.9942138, 'specificity': 0.9942138, 'f1': 0.9868841, 'auroc': 0.99933666, 'binary_precision': 0.96040267, 'binary_recall': 0.99260116, 'binary_specificity': 0.99582654, 'binary_f1_score': 0.97623646}
confusion matrix:
       0     1
0  42234   177
1     32  4293
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.81191385, 'recall': 0.6914086, 'specificity': 0.6914086, 'f1': 0.7359086, 'auroc': 0.94487756, 'binary_precision': 0.64619166, 'binary_recall': 0.3907875, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.48703703}
confusion matrix:
       0    1
0  17923  144
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9867997, 'recall': 0.99383104, 'specificity': 0.99383104, 'f1': 0.9902812, 'auroc': 0.9989318, 'binary_precision': 0.9747793, 'binary_recall': 0.9910256, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.9828353}
confusion matrix:
      0    1
0  5926   20
1     7  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_6.png
better model found
persisted
after epoch: 6,now: 2024-06-11 22:35:24.295368,epoch time: 0:35:27.391606,used: 3:44:23.464873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.99777275, 'recall': 0.9950844, 'specificity': 0.9950844, 'f1': 0.9964241, 'auroc': 0.9994955, 'binary_precision': 0.99651164, 'binary_recall': 0.99052244, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.99350804}
confusion matrix:
       0     1
0  42395    15
1     41  4285
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.8476999, 'recall': 0.568125, 'specificity': 0.568125, 'f1': 0.6077213, 'auroc': 0.95160747, 'binary_precision': 0.7265625, 'binary_recall': 0.13818721, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.23220973}
confusion matrix:
       0   1
0  18032  35
1    580  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9998851, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_7.png
early stop counter: 1
val acc:0.9671825170516968, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9985132217407227
after epoch: 7,now: 2024-06-11 23:11:55.371558,epoch time: 0:36:31.076190,used: 4:20:54.541063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.99880594, 'recall': 0.99507487, 'specificity': 0.99507487, 'f1': 0.9969317, 'auroc': 0.9998858, 'binary_precision': 0.9986014, 'binary_recall': 0.99029124, 'binary_specificity': 0.9998585, 'binary_f1_score': 0.994429}
confusion matrix:
       0     1
0  42404     6
1     42  4284
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.843838, 'recall': 0.5783324, 'specificity': 0.5783324, 'f1': 0.62187743, 'auroc': 0.9459495, 'binary_precision': 0.7181208, 'binary_recall': 0.1589896, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.2603406}
confusion matrix:
       0    1
0  18025   42
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.9999275, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_8.png
new oracle model saved
early stop counter: 2
val acc:0.9675560593605042, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9986619353294373
after epoch: 8,now: 2024-06-11 23:47:22.595436,epoch time: 0:35:27.223878,used: 4:56:21.764941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9993311, 'recall': 0.9957, 'specificity': 0.9957, 'f1': 0.9975072, 'auroc': 0.99990094, 'binary_precision': 0.9995339, 'binary_recall': 0.9914471, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9954741}
confusion matrix:
       0     1
0  42408     2
1     37  4289
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7081846, 'recall': 0.5226948, 'specificity': 0.5226948, 'f1': 0.5337555, 'auroc': 0.95378065, 'binary_precision': 0.45070422, 'binary_recall': 0.04754829, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.086021505}
confusion matrix:
       0   1
0  18028  39
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.9999882, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_9.png
new oracle model saved
early stop counter: 3
val acc:0.9637140035629272, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 9,now: 2024-06-12 00:23:56.485978,epoch time: 0:36:33.890542,used: 5:32:55.655483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99905854, 'precision': 0.9994818, 'recall': 0.99491096, 'specificity': 0.99491096, 'f1': 0.9971832, 'auroc': 0.9996886, 'binary_precision': 1.0, 'binary_recall': 0.9898219, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948849}
confusion matrix:
       0     1
0  42413     0
1     44  4279
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.8872396, 'recall': 0.5125193, 'specificity': 0.5125193, 'f1': 0.51552486, 'auroc': 0.95732665, 'binary_precision': 0.8095238, 'binary_recall': 0.02526003, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.048991352}
confusion matrix:
       0   1
0  18063   4
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9999747, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_10.png
early stop counter: 4
val acc:0.9647812247276306, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 10,now: 2024-06-12 00:59:23.116423,epoch time: 0:35:26.630445,used: 6:08:22.285928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9977747, 'precision': 0.9987769, 'recall': 0.98797965, 'specificity': 0.98797965, 'f1': 0.9933044, 'auroc': 0.9996696, 'binary_precision': 1.0, 'binary_recall': 0.9759593, 'binary_specificity': 1.0, 'binary_f1_score': 0.9878334}
confusion matrix:
       0     1
0  42410     0
1    104  4222
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73214287, 'recall': 0.5028611, 'specificity': 0.5028611, 'f1': 0.49672946, 'auroc': 0.941973, 'binary_precision': 0.5, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.01174743}
confusion matrix:
       0  1
0  18063  4
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.9995761, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_11.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 11,now: 2024-06-12 01:35:16.992376,epoch time: 0:35:53.875953,used: 6:44:16.161881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.9935, 'recall': 0.9954454, 'specificity': 0.9954454, 'f1': 0.99447036, 'auroc': 0.99979246, 'binary_precision': 0.9878021, 'binary_recall': 0.99214053, 'binary_specificity': 0.99875027, 'binary_f1_score': 0.9899666}
confusion matrix:
       0     1
0  42357    53
1     34  4292
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7583344, 'recall': 0.5568935, 'specificity': 0.5568935, 'f1': 0.58770794, 'auroc': 0.9463794, 'binary_precision': 0.5486111, 'binary_recall': 0.11738484, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.19339046}
confusion matrix:
       0   1
0  18002  65
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.9981215, 'recall': 0.99534464, 'specificity': 0.99534464, 'f1': 0.9967278, 'auroc': 0.99996483, 'binary_precision': 0.99741936, 'binary_recall': 0.9910256, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9942122}
confusion matrix:
      0    1
0  5944    2
1     7  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_12.png
early stop counter: 6
val acc:0.9648345708847046, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 12,now: 2024-06-12 02:10:23.308989,epoch time: 0:35:06.316613,used: 7:19:22.478494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.9989201, 'recall': 0.9939427, 'specificity': 0.9939427, 'f1': 0.99641585, 'auroc': 0.9997914, 'binary_precision': 0.999065, 'binary_recall': 0.98797965, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9934915}
confusion matrix:
       0     1
0  42406     4
1     52  4274
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.9640624, 'recall': 0.5697259, 'specificity': 0.5697259, 'f1': 0.61397874, 'auroc': 0.96073925, 'binary_precision': 0.9591837, 'binary_recall': 0.1396731, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.24383914}
confusion matrix:
       0   1
0  18063   4
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.9994781, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_13.png
early stop counter: 7
val acc:0.9688900709152222, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 13,now: 2024-06-12 02:45:47.040265,epoch time: 0:35:23.731276,used: 7:54:46.209770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9982669, 'precision': 0.9989408, 'recall': 0.9907418, 'specificity': 0.9907418, 'f1': 0.99479884, 'auroc': 0.9996466, 'binary_precision': 0.99976456, 'binary_recall': 0.9815072, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99055177}
confusion matrix:
       0     1
0  42409     1
1     80  4246
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.95998466, 'recall': 0.5585817, 'specificity': 0.5585817, 'f1': 0.59635556, 'auroc': 0.9570312, 'binary_precision': 0.9518072, 'binary_recall': 0.11738484, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.2089947}
confusion matrix:
       0   1
0  18063   4
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.99968314, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_14.png
early stop counter: 8
val acc:0.9680896401405334, best validation acc: 0.9704375863075256, corresponding to test acc:                         0.995985746383667 / 0.9988105893135071
after epoch: 14,now: 2024-06-12 03:21:15.173052,epoch time: 0:35:28.132787,used: 8:30:14.342557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.99797297, 'recall': 0.9959034, 'specificity': 0.9959034, 'f1': 0.9969355, 'auroc': 0.999822, 'binary_precision': 0.9967472, 'binary_recall': 0.9921369, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9944367}
confusion matrix:
       0     1
0  42398    14
1     34  4290
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.85361564, 'recall': 0.6787871, 'specificity': 0.6787871, 'f1': 0.735189, 'auroc': 0.9524183, 'binary_precision': 0.7305389, 'binary_recall': 0.3625557, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.48460773}
confusion matrix:
       0    1
0  17977   90
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9993282, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_15.png
better model found
persisted
after epoch: 15,now: 2024-06-12 03:56:19.966608,epoch time: 0:35:04.793556,used: 9:05:19.136113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.99674106, 'recall': 0.99612224, 'specificity': 0.99612224, 'f1': 0.99643147, 'auroc': 0.9998349, 'binary_precision': 0.994213, 'binary_recall': 0.99283403, 'binary_specificity': 0.9994105, 'binary_f1_score': 0.99352306}
confusion matrix:
       0     1
0  42385    25
1     31  4295
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.8724403, 'recall': 0.55879885, 'specificity': 0.55879885, 'f1': 0.59470135, 'auroc': 0.9525391, 'binary_precision': 0.776699, 'binary_recall': 0.11887073, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.20618556}
confusion matrix:
       0   1
0  18044  23
1    593  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99868125, 'recall': 0.9947877, 'specificity': 0.9947877, 'f1': 0.99672425, 'auroc': 0.9998627, 'binary_precision': 0.99870634, 'binary_recall': 0.9897436, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9942048}
confusion matrix:
      0    1
0  5945    1
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_16.png
early stop counter: 1
val acc:0.967129111289978, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9974724650382996 / 0.9988105893135071
after epoch: 16,now: 2024-06-12 04:31:57.938506,epoch time: 0:35:37.971898,used: 9:40:57.108011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9990057, 'recall': 0.99589574, 'specificity': 0.99589574, 'f1': 0.9974446, 'auroc': 0.9998653, 'binary_precision': 0.9988361, 'binary_recall': 0.9919094, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9953607}
confusion matrix:
       0     1
0  42405     5
1     35  4291
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.9398251, 'recall': 0.58216214, 'specificity': 0.58216214, 'f1': 0.6318129, 'auroc': 0.9575178, 'binary_precision': 0.90983605, 'binary_recall': 0.16493313, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.2792453}
confusion matrix:
       0    1
0  18056   11
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.9999819, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_17.png
early stop counter: 2
val acc:0.9694237112998962, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9974724650382996 / 0.9988105893135071
after epoch: 17,now: 2024-06-12 05:06:54.269179,epoch time: 0:34:56.330673,used: 10:15:53.438684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.9994936, 'recall': 0.99503005, 'specificity': 0.99503005, 'f1': 0.99724925, 'auroc': 0.99997973, 'binary_precision': 1.0, 'binary_recall': 0.9900601, 'binary_specificity': 1.0, 'binary_f1_score': 0.99500525}
confusion matrix:
       0     1
0  42410     0
1     43  4283
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.98209524, 'recall': 0.5014859, 'specificity': 0.5014859, 'f1': 0.49384734, 'auroc': 0.9564919, 'binary_precision': 1.0, 'binary_recall': 0.0029717681, 'binary_specificity': 1.0, 'binary_f1_score': 0.005925926}
confusion matrix:
       0  1
0  18067  0
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.99998164, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_18.png
early stop counter: 3
val acc:0.9641942381858826, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9974724650382996 / 0.9988105893135071
after epoch: 18,now: 2024-06-12 05:41:51.512402,epoch time: 0:34:57.243223,used: 10:50:50.681907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.9961272, 'recall': 0.996745, 'specificity': 0.996745, 'f1': 0.9964359, 'auroc': 0.99992484, 'binary_precision': 0.9928439, 'binary_recall': 0.994221, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.993532}
confusion matrix:
       0     1
0  42379    31
1     25  4301
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.90488577, 'recall': 0.6460232, 'specificity': 0.6460232, 'f1': 0.7105548, 'auroc': 0.95729446, 'binary_precision': 0.835443, 'binary_recall': 0.29420504, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.4351648}
confusion matrix:
       0    1
0  18028   39
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.99998814, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_19.png
better model found
persisted
after epoch: 19,now: 2024-06-12 06:17:16.025852,epoch time: 0:35:24.513450,used: 11:26:15.195357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.998652, 'precision': 0.9992584, 'recall': 0.9927168, 'specificity': 0.9927168, 'f1': 0.9959606, 'auroc': 0.99994135, 'binary_precision': 1.0, 'binary_recall': 0.9854335, 'binary_specificity': 1.0, 'binary_f1_score': 0.9926633}
confusion matrix:
       0     1
0  42411     0
1     63  4262
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.9479599, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99982446, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_20.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9988105893135071
after epoch: 20,now: 2024-06-12 06:52:29.681291,epoch time: 0:35:13.655439,used: 12:01:28.850796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9995289, 'recall': 0.99537575, 'specificity': 0.99537575, 'f1': 0.9974414, 'auroc': 0.9998386, 'binary_precision': 1.0, 'binary_recall': 0.99075145, 'binary_specificity': 1.0, 'binary_f1_score': 0.99535424}
confusion matrix:
       0     1
0  42411     0
1     40  4285
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.88214576, 'recall': 0.50294405, 'specificity': 0.50294405, 'f1': 0.49679694, 'auroc': 0.94379187, 'binary_precision': 0.8, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.01179941}
confusion matrix:
       0  1
0  18066  1
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.9999914, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_21.png
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9988105893135071
after epoch: 21,now: 2024-06-12 07:27:40.436842,epoch time: 0:35:10.755551,used: 12:36:39.606347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.9995171, 'recall': 0.9952612, 'specificity': 0.9952612, 'f1': 0.99737775, 'auroc': 0.999843, 'binary_precision': 1.0, 'binary_recall': 0.99052244, 'binary_specificity': 1.0, 'binary_f1_score': 0.99523866}
confusion matrix:
       0     1
0  42410     0
1     41  4285
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.9197229, 'recall': 0.5051729, 'specificity': 0.5051729, 'f1': 0.5012163, 'auroc': 0.9620894, 'binary_precision': 0.875, 'binary_recall': 0.010401188, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.020558001}
confusion matrix:
       0  1
0  18066  1
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.9984909, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9934078, 'auroc': 0.9999137, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0    1
0  5946    0
1    18  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_22.png
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9988105893135071
after epoch: 22,now: 2024-06-12 08:02:44.597785,epoch time: 0:35:04.160943,used: 13:11:43.767290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9994865, 'precision': 0.99961275, 'recall': 0.99732864, 'specificity': 0.99732864, 'f1': 0.9984674, 'auroc': 0.99996406, 'binary_precision': 0.99976754, 'binary_recall': 0.9946808, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99721766}
confusion matrix:
       0     1
0  42411     1
1     23  4301
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.9559169, 'recall': 0.52594763, 'specificity': 0.52594763, 'f1': 0.540593, 'auroc': 0.9658669, 'binary_precision': 0.9459459, 'binary_recall': 0.052005943, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.098591544}
confusion matrix:
       0   1
0  18065   2
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.9996433, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_23.png
new oracle model saved
early stop counter: 4
val acc:0.965848445892334, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 23,now: 2024-06-12 08:38:15.820744,epoch time: 0:35:31.222959,used: 13:47:14.990249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9994865, 'precision': 0.99971724, 'recall': 0.9972248, 'specificity': 0.9972248, 'f1': 0.9984671, 'auroc': 0.9999603, 'binary_precision': 1.0, 'binary_recall': 0.99444956, 'binary_specificity': 1.0, 'binary_f1_score': 0.997217}
confusion matrix:
       0     1
0  42412     0
1     24  4300
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7822697, 'recall': 0.5065204, 'specificity': 0.5065204, 'f1': 0.50397617, 'auroc': 0.95037884, 'binary_precision': 0.6, 'binary_recall': 0.013372957, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.02616279}
confusion matrix:
       0  1
0  18061  6
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99940526, 'precision': 0.99966383, 'recall': 0.9974359, 'specificity': 0.9974359, 'f1': 0.9985465, 'auroc': 0.99999917, 'binary_precision': 1.0, 'binary_recall': 0.9948718, 'binary_specificity': 1.0, 'binary_f1_score': 0.99742925}
confusion matrix:
      0    1
0  5946    0
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_24.png
new oracle model saved
early stop counter: 5
val acc:0.9642475843429565, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 24,now: 2024-06-12 09:13:26.496986,epoch time: 0:35:10.676242,used: 14:22:25.666491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.99776816, 'recall': 0.9982849, 'specificity': 0.9982849, 'f1': 0.9980264, 'auroc': 0.9999397, 'binary_precision': 0.99584293, 'binary_recall': 0.9969942, 'binary_specificity': 0.99957556, 'binary_f1_score': 0.99641824}
confusion matrix:
       0     1
0  42393    18
1     13  4312
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.85339034, 'recall': 0.6253272, 'specificity': 0.6253272, 'f1': 0.68103135, 'auroc': 0.95636326, 'binary_precision': 0.73390555, 'binary_recall': 0.25408617, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.37748343}
confusion matrix:
       0    1
0  18005   62
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9984641, 'recall': 0.9979087, 'specificity': 0.9979087, 'f1': 0.99818623, 'auroc': 0.9999875, 'binary_precision': 0.9974326, 'binary_recall': 0.99615383, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9967928}
confusion matrix:
      0    1
0  5944    2
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_25.png
early stop counter: 6
val acc:0.9699039459228516, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 25,now: 2024-06-12 09:49:38.833523,epoch time: 0:36:12.336537,used: 14:58:38.003028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99957204, 'precision': 0.9997643, 'recall': 0.9976878, 'specificity': 0.9976878, 'f1': 0.9987234, 'auroc': 0.99982184, 'binary_precision': 1.0, 'binary_recall': 0.9953757, 'binary_specificity': 1.0, 'binary_f1_score': 0.9976825}
confusion matrix:
       0     1
0  42411     0
1     20  4305
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.9501517, 'recall': 0.5414941, 'specificity': 0.5414941, 'f1': 0.5679487, 'auroc': 0.9600071, 'binary_precision': 0.93333334, 'binary_recall': 0.08320951, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.15279673}
confusion matrix:
       0   1
0  18063   4
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.9999978, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_26.png
early stop counter: 7
val acc:0.9668623208999634, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 26,now: 2024-06-12 10:29:31.090989,epoch time: 0:39:52.257466,used: 15:38:30.260494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.9994347, 'recall': 0.99445087, 'specificity': 0.99445087, 'f1': 0.99692714, 'auroc': 0.9998542, 'binary_precision': 1.0, 'binary_recall': 0.98890173, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944199}
confusion matrix:
       0     1
0  42411     0
1     48  4277
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.9406593, 'recall': 0.5081447, 'specificity': 0.5081447, 'f1': 0.507049, 'auroc': 0.94904906, 'binary_precision': 0.9166667, 'binary_recall': 0.016344724, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.032116786}
confusion matrix:
       0   1
0  18066   1
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.9999317, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_27.png
early stop counter: 8
val acc:0.9646211266517639, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 27,now: 2024-06-12 11:07:14.140212,epoch time: 0:37:43.049223,used: 16:16:13.309717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9994712, 'recall': 0.99594104, 'specificity': 0.99594104, 'f1': 0.99769825, 'auroc': 0.99992245, 'binary_precision': 0.9997669, 'binary_recall': 0.9919056, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99582076}
confusion matrix:
       0     1
0  42411     1
1     35  4289
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.91637695, 'recall': 0.52880865, 'specificity': 0.52880865, 'f1': 0.54561293, 'auroc': 0.96431935, 'binary_precision': 0.8666667, 'binary_recall': 0.05794948, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.10863509}
confusion matrix:
       0   1
0  18061   6
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99948895, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_28.png
early stop counter: 9
val acc:0.965848445892334, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 28,now: 2024-06-12 11:48:20.309172,epoch time: 0:41:06.168960,used: 16:57:19.478677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9994437, 'precision': 0.9993806, 'recall': 0.9973063, 'specificity': 0.9973063, 'f1': 0.9983407, 'auroc': 0.99997574, 'binary_precision': 0.9993033, 'binary_recall': 0.9946833, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99698794}
confusion matrix:
       0     1
0  42407     3
1     23  4303
---- Validation: 
scalar performance:
{'acc': 0.9685165, 'precision': 0.9320837, 'recall': 0.5695321, 'specificity': 0.5695321, 'f1': 0.61278486, 'auroc': 0.9612699, 'binary_precision': 0.8952381, 'binary_recall': 0.1396731, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.24164525}
confusion matrix:
       0   1
0  18056  11
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99940526, 'precision': 0.99966383, 'recall': 0.9974359, 'specificity': 0.9974359, 'f1': 0.9985465, 'auroc': 0.99999267, 'binary_precision': 1.0, 'binary_recall': 0.9948718, 'binary_specificity': 1.0, 'binary_f1_score': 0.99742925}
confusion matrix:
      0    1
0  5946    0
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_29.png
early stop counter: 10
val acc:0.9685165286064148, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 29,now: 2024-06-12 12:28:12.849020,epoch time: 0:39:52.539848,used: 17:37:12.018525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9994009, 'precision': 0.99935687, 'recall': 0.9970751, 'specificity': 0.9970751, 'f1': 0.99821275, 'auroc': 0.9999472, 'binary_precision': 0.999303, 'binary_recall': 0.994221, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99675554}
confusion matrix:
       0     1
0  42407     3
1     25  4301
---- Validation: 
scalar performance:
{'acc': 0.9722519, 'precision': 0.8610255, 'recall': 0.67017627, 'specificity': 0.67017627, 'f1': 0.7286483, 'auroc': 0.96600914, 'binary_precision': 0.7459807, 'binary_recall': 0.3447251, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.47154474}
confusion matrix:
       0    1
0  17988   79
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.9999001, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_30.png
early stop counter: 11
val acc:0.9722518920898438, best validation acc: 0.9725720286369324, corresponding to test acc:                         0.9988105893135071 / 0.9994052648544312
after epoch: 30,now: 2024-06-12 13:05:27.154501,epoch time: 0:37:14.305481,used: 18:14:26.324006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_18_51_00_seed_1_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:14:26.324006 at 2024-06-12 13:05:27.154501
persisted model performance metric: 

scalar performance:
{'acc': 0.99895924, 'precision': 0.99941206, 'recall': 0.99551284, 'specificity': 0.99551284, 'f1': 0.99745214, 'auroc': 0.99992406, 'binary_precision': 1.0, 'binary_recall': 0.9910256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954926}
confusion matrix:
      0    1
0  5946    0
1     7  773
oracle model performance metric: 

scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.99999607, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      5 MiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397079 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool | 377232 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |  19847 KiB |     24 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6725    |  324785 K  |  324782 K  |
|       from large pool |     247    |     989    |  133677 K  |  133676 K  |
|       from small pool |    3293    |    6476    |  191108 K  |  191105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6725    |  324785 K  |  324782 K  |
|       from large pool |     247    |     989    |  133677 K  |  133676 K  |
|       from small pool |    3293    |    6476    |  191108 K  |  191105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |    3056    |  191891 K  |  191891 K  |
|       from large pool |     107    |     516    |  100167 K  |  100167 K  |
|       from small pool |      32    |    2946    |   91724 K  |   91724 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  191893 K  |  191893 K  |
|       from large pool |       2    |     516    |  100167 K  |  100167 K  |
|       from small pool |       0    |    2946    |   91725 K  |   91725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  191893 K  |  191893 K  |
|       from large pool |       2    |     516    |  100167 K  |  100167 K  |
|       from small pool |       0    |    2946    |   91725 K  |   91725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206

 Experiment start at: 2024-06-12 13:13:39.958004
before training, model accuracy: 0.18399523198604584
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99731046, 'precision': 0.9980087, 'recall': 0.98661196, 'specificity': 0.98661196, 'f1': 0.99222684, 'auroc': 0.99956137, 'binary_precision': 0.99886954, 'binary_recall': 0.9733421, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9859407}
confusion matrix:
       0     1
0  42304     5
1    121  4418
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.60198283, 'recall': 0.5118582, 'specificity': 0.5118582, 'f1': 0.51523, 'auroc': 0.8950559, 'binary_precision': 0.23529412, 'binary_recall': 0.026578072, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.04776119}
confusion matrix:
       0   1
0  18119  52
1    586  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.9998652, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-12 13:51:50.276483,epoch time: 0:38:10.318479,used: 0:38:10.318479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99818563, 'precision': 0.9977987, 'recall': 0.99181676, 'specificity': 0.99181676, 'f1': 0.9947848, 'auroc': 0.9998648, 'binary_precision': 0.99732023, 'binary_recall': 0.9839172, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.99057335}
confusion matrix:
       0     1
0  42297    12
1     73  4466
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.5841007, 'recall': 0.504323, 'specificity': 0.504323, 'f1': 0.5010958, 'auroc': 0.9027667, 'binary_precision': 0.2, 'binary_recall': 0.009966778, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.018987343}
confusion matrix:
       0   1
0  18147  24
1    596   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.99986243, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_2.png
better model found
persisted
after epoch: 2,now: 2024-06-12 14:29:06.214958,epoch time: 0:37:15.938475,used: 1:15:26.256954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9980789, 'precision': 0.9984367, 'recall': 0.9905776, 'specificity': 0.9905776, 'f1': 0.99446756, 'auroc': 0.9992822, 'binary_precision': 0.99887866, 'binary_recall': 0.9812734, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.98999774}
confusion matrix:
       0     1
0  42304     5
1     85  4454
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.48394668, 'recall': 0.49936712, 'specificity': 0.49936712, 'f1': 0.491536, 'auroc': 0.85996115, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18148  23
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.99894416, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_3.png
new oracle model saved
early stop counter: 1
val acc:0.9667075276374817, best validation acc: 0.9669738411903381, corresponding to test acc:                         0.9955376982688904 / 0.9976201057434082
after epoch: 3,now: 2024-06-12 15:08:08.359390,epoch time: 0:39:02.144432,used: 1:54:28.401386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99812156, 'precision': 0.9987612, 'recall': 0.9905008, 'specificity': 0.9905008, 'f1': 0.9945873, 'auroc': 0.99980396, 'binary_precision': 0.99955094, 'binary_recall': 0.98104894, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9902135}
confusion matrix:
       0     1
0  42308     2
1     86  4452
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.921646, 'recall': 0.5057864, 'specificity': 0.5057864, 'f1': 0.5034074, 'auroc': 0.9398878, 'binary_precision': 0.875, 'binary_recall': 0.011627907, 'binary_specificity': 0.999945, 'binary_f1_score': 0.02295082}
confusion matrix:
       0  1
0  18170  1
1    595  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9994598, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_4.png
better model found
persisted
after epoch: 4,now: 2024-06-12 15:54:33.858275,epoch time: 0:46:25.498885,used: 2:40:53.900271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99852717, 'precision': 0.9977944, 'recall': 0.99377596, 'specificity': 0.99377596, 'f1': 0.99577487, 'auroc': 0.99977255, 'binary_precision': 0.9968875, 'binary_recall': 0.9878828, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.99236476}
confusion matrix:
       0     1
0  42295    14
1     55  4484
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.86207175, 'recall': 0.5501141, 'specificity': 0.5501141, 'f1': 0.5817026, 'auroc': 0.94792044, 'binary_precision': 0.75308645, 'binary_recall': 0.1013289, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.1786237}
confusion matrix:
       0   1
0  18151  20
1    541  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.9988864, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-12 16:46:19.422263,epoch time: 0:51:45.563988,used: 3:32:39.464259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99863386, 'precision': 0.9992448, 'recall': 0.9929484, 'specificity': 0.9929484, 'f1': 0.99607134, 'auroc': 0.9998044, 'binary_precision': 1.0, 'binary_recall': 0.9858969, 'binary_specificity': 1.0, 'binary_f1_score': 0.9928984}
confusion matrix:
       0     1
0  42310     0
1     64  4474
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.48396036, 'recall': 0.4998074, 'specificity': 0.4998074, 'f1': 0.49175623, 'auroc': 0.93886566, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18164  7
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99905086, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_6.png
early stop counter: 1
val acc:0.967559814453125, best validation acc: 0.9701166749000549, corresponding to test acc:                         0.9985125660896301 / 0.9985125660896301
after epoch: 6,now: 2024-06-12 17:44:16.155202,epoch time: 0:57:56.732939,used: 4:30:36.197198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9988046, 'precision': 0.99755955, 'recall': 0.9956013, 'specificity': 0.9956013, 'f1': 0.996578, 'auroc': 0.9999532, 'binary_precision': 0.9960168, 'binary_recall': 0.9916281, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.99381757}
confusion matrix:
       0     1
0  42291    18
1     38  4501
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.8208746, 'recall': 0.5759767, 'specificity': 0.5759767, 'f1': 0.6179663, 'auroc': 0.94042265, 'binary_precision': 0.66906476, 'binary_recall': 0.15448505, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.25101215}
confusion matrix:
       0   1
0  18125  46
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.99805003, 'recall': 0.989586, 'specificity': 0.989586, 'f1': 0.9937705, 'auroc': 0.9999492, 'binary_precision': 0.9985955, 'binary_recall': 0.9793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98887336}
confusion matrix:
      0    1
0  5996    1
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_7.png
better model found
persisted
after epoch: 7,now: 2024-06-12 18:40:33.331027,epoch time: 0:56:17.175825,used: 5:26:53.373023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9991248, 'precision': 0.9992182, 'recall': 0.99577856, 'specificity': 0.99577856, 'f1': 0.9974909, 'auroc': 0.99993074, 'binary_precision': 0.9993339, 'binary_recall': 0.9916281, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9954661}
confusion matrix:
       0     1
0  42306     3
1     38  4501
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.9239166, 'recall': 0.52976274, 'specificity': 0.52976274, 'f1': 0.54825103, 'auroc': 0.94774634, 'binary_precision': 0.8780488, 'binary_recall': 0.059800666, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.11197511}
confusion matrix:
       0   1
0  18166   5
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9997149, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_8.png
early stop counter: 1
val acc:0.9695839881896973, best validation acc: 0.9704362750053406, corresponding to test acc:                         0.9976201057434082 / 0.9985125660896301
after epoch: 8,now: 2024-06-12 19:34:55.832399,epoch time: 0:54:22.501372,used: 6:21:15.874395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9987406, 'precision': 0.9990046, 'recall': 0.99379444, 'specificity': 0.99379444, 'f1': 0.9963821, 'auroc': 0.99944997, 'binary_precision': 0.9993311, 'binary_recall': 0.98765975, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9934611}
confusion matrix:
       0     1
0  42307     3
1     56  4482
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74239427, 'recall': 0.5273587, 'specificity': 0.5273587, 'f1': 0.5427633, 'auroc': 0.90732527, 'binary_precision': 0.5151515, 'binary_recall': 0.056478404, 'binary_specificity': 0.998239, 'binary_f1_score': 0.10179641}
confusion matrix:
       0   1
0  18139  32
1    568  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.99992836, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_9.png
early stop counter: 2
val acc:0.9680392146110535, best validation acc: 0.9704362750053406, corresponding to test acc:                         0.9976201057434082 / 0.9985125660896301
after epoch: 9,now: 2024-06-12 20:29:13.909251,epoch time: 0:54:18.076852,used: 7:15:33.951247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99895406, 'precision': 0.9994216, 'recall': 0.9946023, 'specificity': 0.9946023, 'f1': 0.9969971, 'auroc': 0.99979293, 'binary_precision': 1.0, 'binary_recall': 0.98920465, 'binary_specificity': 1.0, 'binary_f1_score': 0.99457306}
confusion matrix:
       0     1
0  42309     0
1     49  4490
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.8465707, 'recall': 0.51722175, 'specificity': 0.51722175, 'f1': 0.5253027, 'auroc': 0.9622511, 'binary_precision': 0.7241379, 'binary_recall': 0.034883723, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.06656101}
confusion matrix:
       0   1
0  18163   8
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9998622, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_10.png
early stop counter: 3
val acc:0.9686251282691956, best validation acc: 0.9704362750053406, corresponding to test acc:                         0.9976201057434082 / 0.9985125660896301
after epoch: 10,now: 2024-06-12 21:23:19.094807,epoch time: 0:54:05.185556,used: 8:09:39.136803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99750257, 'precision': 0.98815954, 'recall': 0.9978306, 'specificity': 0.9978306, 'f1': 0.9929346, 'auroc': 0.99991906, 'binary_precision': 0.9765086, 'binary_recall': 0.9982375, 'binary_specificity': 0.9974237, 'binary_f1_score': 0.98725355}
confusion matrix:
       0     1
0  42200   109
1      8  4531
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.7324486, 'recall': 0.7346878, 'specificity': 0.7346878, 'f1': 0.73356223, 'auroc': 0.93058825, 'binary_precision': 0.4819079, 'binary_recall': 0.48671097, 'binary_specificity': 0.9826647, 'binary_f1_score': 0.48429754}
confusion matrix:
       0    1
0  17856  315
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9997703, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_11.png
new oracle model saved
early stop counter: 4
val acc:0.9667607545852661, best validation acc: 0.9704362750053406, corresponding to test acc:                         0.9976201057434082 / 0.9986613392829895
after epoch: 11,now: 2024-06-12 22:16:18.653386,epoch time: 0:52:59.558579,used: 9:02:38.695382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.9994334, 'recall': 0.9947125, 'specificity': 0.9947125, 'f1': 0.99705875, 'auroc': 0.9998914, 'binary_precision': 1.0, 'binary_recall': 0.989425, 'binary_specificity': 1.0, 'binary_f1_score': 0.9946844}
confusion matrix:
       0     1
0  42309     0
1     48  4491
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.85934913, 'recall': 0.5123209, 'specificity': 0.5123209, 'f1': 0.5160993, 'auroc': 0.9381017, 'binary_precision': 0.75, 'binary_recall': 0.024916943, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.04823151}
confusion matrix:
       0   1
0  18166   5
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.9996963, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277206_12.png
early stop counter: 5
val acc:0.9684653282165527, best validation acc: 0.9704362750053406, corresponding to test acc:                         0.9976201057434082 / 0.9986613392829895
after epoch: 12,now: 2024-06-12 23:04:26.874208,epoch time: 0:48:08.220822,used: 9:50:46.916204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_13_13_39_seed_2_21277206
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9978441, 'precision': 0.99870837, 'recall': 0.9889701, 'specificity': 0.9889701, 'f1': 0.99377835, 'auroc': 0.9996889, 'binary_precision': 0.9997747, 'binary_recall': 0.97796386, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98874897}
confusion matrix:
       0     1
0  42309     1
1    100  4438
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.9403837, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
slurmstepd: error: *** JOB 21277206 ON gpusrv28 CANCELLED AT 2024-06-12T23:40:06 DUE TO TIME LIMIT ***
