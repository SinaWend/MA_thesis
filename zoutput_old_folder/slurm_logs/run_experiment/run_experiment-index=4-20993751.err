Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751

 Experiment start at: 2024-05-29 13:38:03.321782
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9729859, 'precision': 0.7891541, 'recall': 0.81127423, 'specificity': 0.81127423, 'f1': 0.7997644, 'auroc': 0.96315837, 'binary_precision': 0.5909377, 'binary_recall': 0.6379076, 'binary_specificity': 0.98464084, 'binary_f1_score': 0.613525}
confusion matrix:
       0    1
0  41670  650
1    533  939
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.793934, 'recall': 0.78554714, 'specificity': 0.78554714, 'f1': 0.7896736, 'auroc': 0.9632102, 'binary_precision': 0.6025641, 'binary_recall': 0.58475894, 'binary_specificity': 0.98633534, 'binary_f1_score': 0.593528}
confusion matrix:
       0    1
0  17901  248
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793864, 'precision': 0.9350835, 'recall': 0.7876879, 'specificity': 0.7876879, 'f1': 0.8450108, 'auroc': 0.9438211, 'binary_precision': 0.8882353, 'binary_recall': 0.5785441, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.70069605}
confusion matrix:
      0    1
0  5978   19
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:18:13.726487,epoch time: 0:40:10.404705,used: 0:40:10.404705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9791286, 'precision': 0.85122657, 'recall': 0.8105181, 'specificity': 0.8105181, 'f1': 0.8295107, 'auroc': 0.97760785, 'binary_precision': 0.7152778, 'binary_recall': 0.62975544, 'binary_specificity': 0.99128073, 'binary_f1_score': 0.6697977}
confusion matrix:
       0    1
0  41951  369
1    545  927
---- Validation: 
scalar performance:
{'acc': 0.9804172, 'precision': 0.8733642, 'recall': 0.80909836, 'specificity': 0.80909836, 'f1': 0.8379501, 'auroc': 0.97551763, 'binary_precision': 0.7599244, 'binary_recall': 0.62519443, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.68600684}
confusion matrix:
       0    1
0  18022  127
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.93470377, 'recall': 0.637264, 'specificity': 0.637264, 'f1': 0.70305336, 'auroc': 0.955197, 'binary_precision': 0.9, 'binary_recall': 0.27586207, 'binary_specificity': 0.998666, 'binary_f1_score': 0.42228737}
confusion matrix:
      0   1
0  5989   8
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 2,now: 2024-05-29 14:56:41.390136,epoch time: 0:38:27.663649,used: 1:18:38.068354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97488123, 'precision': 0.9182201, 'recall': 0.6497272, 'specificity': 0.6497272, 'f1': 0.71663606, 'auroc': 0.9809636, 'binary_precision': 0.86019415, 'binary_recall': 0.3011557, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.4461229}
confusion matrix:
       0    1
0  42249   72
1   1028  443
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.92190593, 'recall': 0.65699977, 'specificity': 0.65699977, 'f1': 0.7250552, 'auroc': 0.97664404, 'binary_precision': 0.86752135, 'binary_recall': 0.31570762, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.46294186}
confusion matrix:
       0    1
0  18118   31
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9359913, 'recall': 0.5572211, 'specificity': 0.5572211, 'f1': 0.5924679, 'auroc': 0.95504487, 'binary_precision': 0.90909094, 'binary_recall': 0.11494253, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.20408164}
confusion matrix:
      0   1
0  5994   3
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9749361276626587, best validation acc: 0.9804171919822693, corresponding to test acc:                         0.9685202836990356 / 0.9793863892555237
after epoch: 3,now: 2024-05-29 15:37:41.805662,epoch time: 0:41:00.415526,used: 1:59:38.483880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9855453, 'precision': 0.90864974, 'recall': 0.85777116, 'specificity': 0.85777116, 'f1': 0.88138694, 'auroc': 0.98741853, 'binary_precision': 0.826968, 'binary_recall': 0.72078806, 'binary_specificity': 0.99475425, 'binary_f1_score': 0.77023596}
confusion matrix:
       0     1
0  42098   222
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9028908, 'recall': 0.8286425, 'specificity': 0.8286425, 'f1': 0.861696, 'auroc': 0.98138046, 'binary_precision': 0.81765836, 'binary_recall': 0.66251945, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.7319587}
confusion matrix:
       0    1
0  18054   95
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.9566999, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 4,now: 2024-05-29 16:16:14.416104,epoch time: 0:38:32.610442,used: 2:38:11.094322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98467755, 'precision': 0.9270637, 'recall': 0.8199462, 'specificity': 0.8199462, 'f1': 0.8652546, 'auroc': 0.9887208, 'binary_precision': 0.8664227, 'binary_recall': 0.6433424, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.7384015}
confusion matrix:
       0    1
0  42174  146
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.9123653, 'recall': 0.79039586, 'specificity': 0.79039586, 'f1': 0.83999324, 'auroc': 0.9814216, 'binary_precision': 0.83928573, 'binary_recall': 0.58475894, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.6892759}
confusion matrix:
       0    1
0  18077   72
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.85312897, 'recall': 0.60186416, 'specificity': 0.60186416, 'f1': 0.6524007, 'auroc': 0.9580873, 'binary_precision': 0.739726, 'binary_recall': 0.20689656, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.32335332}
confusion matrix:
      0   1
0  5978  19
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9819604158401489, best validation acc: 0.9833971858024597, corresponding to test acc:                         0.9646852016448975 / 0.9793863892555237
after epoch: 5,now: 2024-05-29 16:55:26.020859,epoch time: 0:39:11.604755,used: 3:17:22.699077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.9253458, 'recall': 0.8633301, 'specificity': 0.8633301, 'f1': 0.89171106, 'auroc': 0.99079007, 'binary_precision': 0.86, 'binary_recall': 0.7307954, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.79015064}
confusion matrix:
       0     1
0  42146   175
1    396  1075
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9163188, 'recall': 0.85224617, 'specificity': 0.85224617, 'f1': 0.8813989, 'auroc': 0.9809937, 'binary_precision': 0.8428835, 'binary_recall': 0.70917577, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7702703}
confusion matrix:
       0    1
0  18064   85
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.94820714, 'recall': 0.5782939, 'specificity': 0.5782939, 'f1': 0.6252951, 'auroc': 0.96201134, 'binary_precision': 0.9318182, 'binary_recall': 0.15708812, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.26885244}
confusion matrix:
      0   1
0  5994   3
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 6,now: 2024-05-29 17:36:23.792918,epoch time: 0:40:57.772059,used: 3:58:20.471136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9886966, 'precision': 0.9372112, 'recall': 0.8810403, 'specificity': 0.8810403, 'f1': 0.9070499, 'auroc': 0.99241877, 'binary_precision': 0.8825372, 'binary_recall': 0.765625, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.8199346}
confusion matrix:
       0     1
0  42170   150
1    345  1127
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9239328, 'recall': 0.8548269, 'specificity': 0.8548269, 'f1': 0.88607264, 'auroc': 0.9839872, 'binary_precision': 0.85794395, 'binary_recall': 0.7138414, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7792869}
confusion matrix:
       0    1
0  18073   76
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9004331, 'recall': 0.5588867, 'specificity': 0.5588867, 'f1': 0.59436893, 'auroc': 0.9529578, 'binary_precision': 0.8378378, 'binary_recall': 0.118773945, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.20805368}
confusion matrix:
      0   1
0  5991   6
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 7,now: 2024-05-29 18:22:14.861333,epoch time: 0:45:51.068415,used: 4:44:11.539551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98922175, 'precision': 0.9379074, 'recall': 0.8894347, 'specificity': 0.8894347, 'f1': 0.9121417, 'auroc': 0.99276817, 'binary_precision': 0.88334614, 'binary_recall': 0.7824609, 'binary_specificity': 0.9964084, 'binary_f1_score': 0.82984865}
confusion matrix:
       0     1
0  42169   152
1    320  1151
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9216939, 'recall': 0.8740466, 'specificity': 0.8740466, 'f1': 0.8963293, 'auroc': 0.983559, 'binary_precision': 0.85211265, 'binary_recall': 0.7527216, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.79933935}
confusion matrix:
       0    1
0  18065   84
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.904746, 'recall': 0.56271815, 'specificity': 0.56271815, 'f1': 0.6004224, 'auroc': 0.9544514, 'binary_precision': 0.84615386, 'binary_recall': 0.12643678, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.22000001}
confusion matrix:
      0   1
0  5991   6
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 8,now: 2024-05-29 19:00:15.172879,epoch time: 0:38:00.311546,used: 5:22:11.851097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98970133, 'precision': 0.9454037, 'recall': 0.8892805, 'specificity': 0.8892805, 'f1': 0.91531205, 'auroc': 0.9949256, 'binary_precision': 0.8983581, 'binary_recall': 0.78163266, 'binary_specificity': 0.99692833, 'binary_f1_score': 0.83594036}
confusion matrix:
       0     1
0  42192   130
1    321  1149
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9357481, 'recall': 0.8521297, 'specificity': 0.8521297, 'f1': 0.8891618, 'auroc': 0.9838696, 'binary_precision': 0.88178295, 'binary_recall': 0.7076205, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.78515965}
confusion matrix:
       0    1
0  18088   61
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9086533, 'recall': 0.56654954, 'specificity': 0.56654954, 'f1': 0.60639673, 'auroc': 0.953878, 'binary_precision': 0.85365856, 'binary_recall': 0.13409962, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.23178808}
confusion matrix:
      0   1
0  5991   6
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9867497086524963, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 9,now: 2024-05-29 19:38:06.882553,epoch time: 0:37:51.709674,used: 6:00:03.560771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.91270244, 'recall': 0.93808186, 'specificity': 0.93808186, 'f1': 0.92498183, 'auroc': 0.996099, 'binary_precision': 0.8295019, 'binary_recall': 0.8824728, 'binary_specificity': 0.9936909, 'binary_f1_score': 0.8551679}
confusion matrix:
       0     1
0  42053   267
1    173  1299
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.899534, 'recall': 0.90013325, 'specificity': 0.90013325, 'f1': 0.8998334, 'auroc': 0.983456, 'binary_precision': 0.80590063, 'binary_recall': 0.80715394, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.80652684}
confusion matrix:
       0    1
0  18024  125
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8717683, 'recall': 0.63618016, 'specificity': 0.63618016, 'f1': 0.6947564, 'auroc': 0.95146966, 'binary_precision': 0.7741935, 'binary_recall': 0.27586207, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.40677965}
confusion matrix:
      0   1
0  5976  21
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9867497086524963, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 10,now: 2024-05-29 20:15:45.425131,epoch time: 0:37:38.542578,used: 6:37:42.103349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9909116, 'precision': 0.963482, 'recall': 0.89129317, 'specificity': 0.89129317, 'f1': 0.9241152, 'auroc': 0.99628663, 'binary_precision': 0.93441296, 'binary_recall': 0.78450036, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.85291946}
confusion matrix:
       0     1
0  42240    81
1    317  1154
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9486369, 'recall': 0.83860123, 'specificity': 0.83860123, 'f1': 0.8853616, 'auroc': 0.9828212, 'binary_precision': 0.9085239, 'binary_recall': 0.67962676, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.77758}
confusion matrix:
       0    1
0  18105   44
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.93900365, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 3
val acc:0.9866964817047119, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 11,now: 2024-05-29 20:53:23.757943,epoch time: 0:37:38.332812,used: 7:15:20.436161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9890848, 'precision': 0.95959145, 'recall': 0.8648482, 'specificity': 0.8648482, 'f1': 0.9063812, 'auroc': 0.99602306, 'binary_precision': 0.92844826, 'binary_recall': 0.7316576, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.81838906}
confusion matrix:
       0     1
0  42237    83
1    395  1077
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9133572, 'recall': 0.82900065, 'specificity': 0.82900065, 'f1': 0.86600953, 'auroc': 0.9819635, 'binary_precision': 0.8385827, 'binary_recall': 0.66251945, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.74022585}
confusion matrix:
       0    1
0  18067   82
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.90712297, 'recall': 0.5855399, 'specificity': 0.5855399, 'f1': 0.6341333, 'auroc': 0.9460286, 'binary_precision': 0.8490566, 'binary_recall': 0.1724138, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5989   8
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 4
val acc:0.9840889573097229, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 12,now: 2024-05-29 21:30:55.276342,epoch time: 0:37:31.518399,used: 7:52:51.954560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9923959, 'precision': 0.97331053, 'recall': 0.90623224, 'specificity': 0.90623224, 'f1': 0.9370265, 'auroc': 0.9979253, 'binary_precision': 0.95306283, 'binary_recall': 0.8138587, 'binary_specificity': 0.99860585, 'binary_f1_score': 0.8779773}
confusion matrix:
       0     1
0  42261    59
1    274  1198
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9426698, 'recall': 0.84693444, 'specificity': 0.84693444, 'f1': 0.88856196, 'auroc': 0.9823133, 'binary_precision': 0.896, 'binary_recall': 0.6967341, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.783902}
confusion matrix:
       0    1
0  18097   52
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.93696004, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 5
val acc:0.9868561029434204, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 13,now: 2024-05-29 22:08:34.398850,epoch time: 0:37:39.122508,used: 8:30:31.077068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9929668, 'precision': 0.9599925, 'recall': 0.9291499, 'specificity': 0.9291499, 'f1': 0.9439955, 'auroc': 0.9977238, 'binary_precision': 0.9248175, 'binary_recall': 0.8607337, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.8916256}
confusion matrix:
       0     1
0  42217   103
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9104754, 'recall': 0.8597467, 'specificity': 0.8597467, 'f1': 0.88330483, 'auroc': 0.9823036, 'binary_precision': 0.8306595, 'binary_recall': 0.7247278, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.77408636}
confusion matrix:
       0    1
0  18054   95
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8899187, 'recall': 0.58345747, 'specificity': 0.58345747, 'f1': 0.63038003, 'auroc': 0.94774675, 'binary_precision': 0.8148148, 'binary_recall': 0.16858238, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2793651}
confusion matrix:
      0   1
0  5987  10
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 6
val acc:0.9855257272720337, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 14,now: 2024-05-29 22:46:02.517875,epoch time: 0:37:28.119025,used: 9:07:59.196093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9856823, 'precision': 0.9898296, 'recall': 0.7885201, 'specificity': 0.7885201, 'f1': 0.8614842, 'auroc': 0.9982563, 'binary_precision': 0.9941452, 'binary_recall': 0.5771584, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.73032254}
confusion matrix:
       0    1
0  42316    5
1    622  849
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.97278345, 'recall': 0.7306456, 'specificity': 0.7306456, 'f1': 0.80743015, 'auroc': 0.9789593, 'binary_precision': 0.96428573, 'binary_recall': 0.46189734, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.62460566}
confusion matrix:
       0    1
0  18138   11
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.91412354, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
confusion matrix:
      0  1
0  5995  2
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 7
val acc:0.9810025691986084, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9626078605651855 / 0.9793863892555237
after epoch: 15,now: 2024-05-29 23:23:31.475769,epoch time: 0:37:28.957894,used: 9:45:28.153987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9943597, 'precision': 0.9781403, 'recall': 0.9331492, 'specificity': 0.9331492, 'f1': 0.9544519, 'auroc': 0.99865866, 'binary_precision': 0.9608728, 'binary_recall': 0.8675272, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.9118172}
confusion matrix:
       0     1
0  42268    52
1    195  1277
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9276338, 'recall': 0.8734894, 'specificity': 0.8734894, 'f1': 0.8985869, 'auroc': 0.98281085, 'binary_precision': 0.86404294, 'binary_recall': 0.7511664, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.8036606}
confusion matrix:
       0    1
0  18073   76
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.89787686, 'recall': 0.6271852, 'specificity': 0.6271852, 'f1': 0.6873636, 'auroc': 0.95280397, 'binary_precision': 0.8271605, 'binary_recall': 0.256705, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3918129}
confusion matrix:
      0   1
0  5983  14
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 16,now: 2024-05-30 00:00:59.145516,epoch time: 0:37:27.669747,used: 10:22:55.823734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99330926, 'precision': 0.9769003, 'recall': 0.9175242, 'specificity': 0.9175242, 'f1': 0.94509697, 'auroc': 0.9985893, 'binary_precision': 0.95947, 'binary_recall': 0.8362772, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.8936479}
confusion matrix:
       0     1
0  42268    52
1    241  1231
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9253011, 'recall': 0.8417454, 'specificity': 0.8417454, 'f1': 0.87861955, 'auroc': 0.9808423, 'binary_precision': 0.86159843, 'binary_recall': 0.6874028, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7647059}
confusion matrix:
       0    1
0  18078   71
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89520574, 'recall': 0.6062792, 'specificity': 0.6062792, 'f1': 0.66130984, 'auroc': 0.94635975, 'binary_precision': 0.8235294, 'binary_recall': 0.21455939, 'binary_specificity': 0.997999, 'binary_f1_score': 0.34042555}
confusion matrix:
      0   1
0  5985  12
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9855257272720337, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9667625427246094 / 0.9793863892555237
after epoch: 17,now: 2024-05-30 00:38:22.361460,epoch time: 0:37:23.215944,used: 11:00:19.039678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9939258, 'precision': 0.9756148, 'recall': 0.92866254, 'specificity': 0.92866254, 'f1': 0.9508294, 'auroc': 0.9986273, 'binary_precision': 0.9561271, 'binary_recall': 0.8586956, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.904796}
confusion matrix:
       0     1
0  42262    58
1    208  1264
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9420093, 'recall': 0.8430464, 'specificity': 0.8430464, 'f1': 0.8858223, 'auroc': 0.98142105, 'binary_precision': 0.8949495, 'binary_recall': 0.688958, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7785589}
confusion matrix:
       0    1
0  18097   52
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8669131, 'recall': 0.55105716, 'specificity': 0.55105716, 'f1': 0.58131444, 'auroc': 0.92772436, 'binary_precision': 0.7714286, 'binary_recall': 0.10344828, 'binary_specificity': 0.998666, 'binary_f1_score': 0.18243244}
confusion matrix:
      0   1
0  5989   8
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9865900278091431, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9667625427246094 / 0.9793863892555237
after epoch: 18,now: 2024-05-30 01:15:48.405754,epoch time: 0:37:26.044294,used: 11:37:45.083972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9947479, 'precision': 0.97436714, 'recall': 0.94318587, 'specificity': 0.94318587, 'f1': 0.9582069, 'auroc': 0.9990921, 'binary_precision': 0.9526239, 'binary_recall': 0.8879076, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.91912794}
confusion matrix:
       0     1
0  42255    65
1    165  1307
---- Validation: 
scalar performance:
{'acc': 0.98845255, 'precision': 0.9640282, 'recall': 0.85376143, 'specificity': 0.85376143, 'f1': 0.900921, 'auroc': 0.98074186, 'binary_precision': 0.9382716, 'binary_recall': 0.70917577, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.8077946}
confusion matrix:
       0    1
0  18119   30
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.89304686, 'recall': 0.55313957, 'specificity': 0.55313957, 'f1': 0.58513695, 'auroc': 0.9338285, 'binary_precision': 0.8235294, 'binary_recall': 0.107279696, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.18983051}
confusion matrix:
      0   1
0  5991   6
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 19,now: 2024-05-30 01:53:18.058174,epoch time: 0:37:29.652420,used: 12:15:14.736392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99586684, 'precision': 0.96462977, 'recall': 0.9722525, 'specificity': 0.9722525, 'f1': 0.96840775, 'auroc': 0.99929047, 'binary_precision': 0.9311037, 'binary_recall': 0.94693875, 'binary_specificity': 0.9975663, 'binary_f1_score': 0.9389545}
confusion matrix:
       0     1
0  42219   103
1     78  1392
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.915768, 'recall': 0.9039049, 'specificity': 0.9039049, 'f1': 0.9097435, 'auroc': 0.9827194, 'binary_precision': 0.838141, 'binary_recall': 0.8133748, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.82557225}
confusion matrix:
       0    1
0  18048  101
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8420195, 'recall': 0.5866219, 'specificity': 0.5866219, 'f1': 0.63198227, 'auroc': 0.9210771, 'binary_precision': 0.71875, 'binary_recall': 0.17624521, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.2830769}
confusion matrix:
      0   1
0  5979  18
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9882397055625916, best validation acc: 0.9884525537490845, corresponding to test acc:                         0.9618088603019714 / 0.9793863892555237
after epoch: 20,now: 2024-05-30 02:30:49.670303,epoch time: 0:37:31.612129,used: 12:52:46.348521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9964834, 'precision': 0.96890163, 'recall': 0.97751087, 'specificity': 0.97751087, 'f1': 0.9731641, 'auroc': 0.99947476, 'binary_precision': 0.93929285, 'binary_recall': 0.957172, 'binary_specificity': 0.99784976, 'binary_f1_score': 0.94814813}
confusion matrix:
       0     1
0  42230    91
1     63  1408
---- Validation: 
scalar performance:
{'acc': 0.9894104, 'precision': 0.9293487, 'recall': 0.90676117, 'specificity': 0.90676117, 'f1': 0.9177251, 'auroc': 0.9840827, 'binary_precision': 0.86513156, 'binary_recall': 0.81804043, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.84092724}
confusion matrix:
       0    1
0  18067   82
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8853693, 'recall': 0.62318707, 'specificity': 0.62318707, 'f1': 0.68135136, 'auroc': 0.94614255, 'binary_precision': 0.80246913, 'binary_recall': 0.24904214, 'binary_specificity': 0.997332, 'binary_f1_score': 0.38011694}
confusion matrix:
      0   1
0  5981  16
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 21,now: 2024-05-30 03:08:21.295595,epoch time: 0:37:31.625292,used: 13:30:17.973813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99595815, 'precision': 0.98995936, 'recall': 0.9470906, 'specificity': 0.9470906, 'f1': 0.96747255, 'auroc': 0.99939764, 'binary_precision': 0.9835698, 'binary_recall': 0.89470106, 'binary_specificity': 0.9994801, 'binary_f1_score': 0.93703306}
confusion matrix:
       0     1
0  42298    22
1    155  1317
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9540794, 'recall': 0.85656875, 'specificity': 0.85656875, 'f1': 0.89902437, 'auroc': 0.98253185, 'binary_precision': 0.91816366, 'binary_recall': 0.7153966, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.8041959}
confusion matrix:
       0    1
0  18108   41
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.9209517, 'recall': 0.6066127, 'specificity': 0.6066127, 'f1': 0.6635717, 'auroc': 0.9409511, 'binary_precision': 0.875, 'binary_recall': 0.21455939, 'binary_specificity': 0.998666, 'binary_f1_score': 0.34461537}
confusion matrix:
      0   1
0  5989   8
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9880800247192383, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 22,now: 2024-05-30 03:45:48.863956,epoch time: 0:37:27.568361,used: 14:07:45.542174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99556994, 'precision': 0.9914282, 'recall': 0.9395951, 'specificity': 0.9395951, 'f1': 0.96396405, 'auroc': 0.999483, 'binary_precision': 0.9870229, 'binary_recall': 0.8795918, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.9302158}
confusion matrix:
       0     1
0  42305    17
1    177  1293
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9605676, 'recall': 0.8335161, 'specificity': 0.8335161, 'f1': 0.88614845, 'auroc': 0.9800747, 'binary_precision': 0.9327549, 'binary_recall': 0.6687403, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.77898556}
confusion matrix:
       0    1
0  18118   31
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.89772, 'recall': 0.5474758, 'specificity': 0.5474758, 'f1': 0.5760538, 'auroc': 0.9405416, 'binary_precision': 0.8333333, 'binary_recall': 0.09578544, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.17182131}
confusion matrix:
      0   1
0  5992   5
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9870157241821289, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 23,now: 2024-05-30 04:23:13.786220,epoch time: 0:37:24.922264,used: 14:45:10.464438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99607235, 'precision': 0.97239935, 'recall': 0.9668212, 'specificity': 0.9668212, 'f1': 0.96959245, 'auroc': 0.9993422, 'binary_precision': 0.94704264, 'binary_recall': 0.93546194, 'binary_specificity': 0.9981805, 'binary_f1_score': 0.9412167}
confusion matrix:
       0     1
0  42243    77
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.9886122, 'precision': 0.9439155, 'recall': 0.8755956, 'specificity': 0.8755956, 'f1': 0.9066888, 'auroc': 0.9841288, 'binary_precision': 0.896488, 'binary_recall': 0.7542768, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.8192567}
confusion matrix:
       0    1
0  18093   56
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84643674, 'recall': 0.59045327, 'specificity': 0.59045327, 'f1': 0.63731325, 'auroc': 0.93168277, 'binary_precision': 0.72727275, 'binary_recall': 0.18390805, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.29357797}
confusion matrix:
      0   1
0  5979  18
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 3
val acc:0.988612174987793, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 24,now: 2024-05-30 05:01:11.188640,epoch time: 0:37:57.402420,used: 15:23:07.866858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99700856, 'precision': 0.9759408, 'recall': 0.978125, 'specificity': 0.978125, 'f1': 0.97703016, 'auroc': 0.9996568, 'binary_precision': 0.95334685, 'binary_recall': 0.95788044, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.95560825}
confusion matrix:
       0     1
0  42251    69
1     62  1410
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9311143, 'recall': 0.8797929, 'specificity': 0.8797929, 'f1': 0.9037011, 'auroc': 0.9825587, 'binary_precision': 0.8705674, 'binary_recall': 0.7636081, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.8135874}
confusion matrix:
       0    1
0  18076   73
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.897883, 'recall': 0.61011064, 'specificity': 0.61011064, 'f1': 0.66640425, 'auroc': 0.937284, 'binary_precision': 0.82857144, 'binary_recall': 0.22222222, 'binary_specificity': 0.997999, 'binary_f1_score': 0.35045317}
confusion matrix:
      0   1
0  5985  12
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 4
val acc:0.9880267977714539, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 25,now: 2024-05-30 05:38:54.956523,epoch time: 0:37:43.767883,used: 16:00:51.634741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9974653, 'precision': 0.9764881, 'recall': 0.9849185, 'specificity': 0.9849185, 'f1': 0.9806635, 'auroc': 0.99979126, 'binary_precision': 0.9539693, 'binary_recall': 0.9714674, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.9626388}
confusion matrix:
       0     1
0  42251    69
1     42  1430
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9223136, 'recall': 0.8918213, 'specificity': 0.8918213, 'f1': 0.90645003, 'auroc': 0.98288083, 'binary_precision': 0.85210085, 'binary_recall': 0.7884914, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.819063}
confusion matrix:
       0    1
0  18061   88
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8767388, 'recall': 0.643843, 'specificity': 0.643843, 'f1': 0.7038187, 'auroc': 0.9402652, 'binary_precision': 0.78350514, 'binary_recall': 0.29118773, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.42458102}
confusion matrix:
      0   1
0  5976  21
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 5
val acc:0.9880800247192383, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 26,now: 2024-05-30 06:16:37.925789,epoch time: 0:37:42.969266,used: 16:38:34.604007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9971456, 'precision': 0.9809116, 'recall': 0.9749173, 'specificity': 0.9749173, 'f1': 0.9778942, 'auroc': 0.999672, 'binary_precision': 0.96352375, 'binary_recall': 0.95108694, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.95726496}
confusion matrix:
       0     1
0  42267    53
1     72  1400
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.91697717, 'recall': 0.8931562, 'specificity': 0.8931562, 'f1': 0.90468764, 'auroc': 0.98321784, 'binary_precision': 0.8413223, 'binary_recall': 0.79160184, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.8157051}
confusion matrix:
       0    1
0  18053   96
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.82762396, 'recall': 0.63143164, 'specificity': 0.63143164, 'f1': 0.6836628, 'auroc': 0.9343257, 'binary_precision': 0.6862745, 'binary_recall': 0.26819924, 'binary_specificity': 0.994664, 'binary_f1_score': 0.38567495}
confusion matrix:
      0   1
0  5965  32
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 6
val acc:0.9877607226371765, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 27,now: 2024-05-30 06:54:14.952630,epoch time: 0:37:37.026841,used: 17:16:11.630848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.996118, 'precision': 0.9801159, 'recall': 0.9593041, 'specificity': 0.9593041, 'f1': 0.96946216, 'auroc': 0.9993536, 'binary_precision': 0.9630157, 'binary_recall': 0.91983694, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.94093126}
confusion matrix:
       0     1
0  42268    52
1    118  1354
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9290822, 'recall': 0.84804887, 'specificity': 0.84804887, 'f1': 0.884014, 'auroc': 0.9814695, 'binary_precision': 0.8687259, 'binary_recall': 0.6998445, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7751938}
confusion matrix:
       0    1
0  18081   68
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.88782674, 'recall': 0.619439, 'specificity': 0.619439, 'f1': 0.6770947, 'auroc': 0.9412938, 'binary_precision': 0.8076923, 'binary_recall': 0.2413793, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.37168142}
confusion matrix:
      0   1
0  5982  15
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 7
val acc:0.9861111044883728, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 28,now: 2024-05-30 07:31:45.880142,epoch time: 0:37:30.927512,used: 17:53:42.558360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976023, 'precision': 0.98635, 'recall': 0.9764494, 'specificity': 0.9764494, 'f1': 0.98134494, 'auroc': 0.99979556, 'binary_precision': 0.97430557, 'binary_recall': 0.95377296, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.96392995}
confusion matrix:
       0     1
0  42284    37
1     68  1403
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.93463427, 'recall': 0.8822359, 'specificity': 0.8822359, 'f1': 0.9066223, 'auroc': 0.97984314, 'binary_precision': 0.8774423, 'binary_recall': 0.7682737, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.8192372}
confusion matrix:
       0    1
0  18080   69
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8773203, 'recall': 0.5852064, 'specificity': 0.5852064, 'f1': 0.63216364, 'auroc': 0.945521, 'binary_precision': 0.7894737, 'binary_recall': 0.1724138, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2830189}
confusion matrix:
      0   1
0  5985  12
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 8
val acc:0.9883993268013, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 29,now: 2024-05-30 08:09:22.857645,epoch time: 0:37:36.977503,used: 18:31:19.535863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.997922, 'precision': 0.98203063, 'recall': 0.98613834, 'specificity': 0.98613834, 'f1': 0.9840751, 'auroc': 0.99984145, 'binary_precision': 0.96498317, 'binary_recall': 0.97350544, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.9692256}
confusion matrix:
       0     1
0  42268    52
1     39  1433
---- Validation: 
scalar performance:
{'acc': 0.98887825, 'precision': 0.9297056, 'recall': 0.89673495, 'specificity': 0.89673495, 'f1': 0.9125098, 'auroc': 0.9844986, 'binary_precision': 0.8665541, 'binary_recall': 0.7978227, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.8307693}
confusion matrix:
       0    1
0  18070   79
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8187705, 'recall': 0.6068609, 'specificity': 0.6068609, 'f1': 0.6552083, 'auroc': 0.898896, 'binary_precision': 0.67058825, 'binary_recall': 0.21839081, 'binary_specificity': 0.995331, 'binary_f1_score': 0.32947978}
confusion matrix:
      0   1
0  5969  28
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 9
val acc:0.9888782501220703, best validation acc: 0.989410400390625, corresponding to test acc:                         0.9661233425140381 / 0.9793863892555237
after epoch: 30,now: 2024-05-30 08:47:01.301530,epoch time: 0:37:38.443885,used: 19:08:57.979748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:08:57.979748 at 2024-05-30 08:47:01.301530
persisted model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.87706506, 'recall': 0.62493604, 'specificity': 0.62493604, 'f1': 0.682554, 'auroc': 0.9475007, 'binary_precision': 0.78571427, 'binary_recall': 0.25287357, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.3826087}
confusion matrix:
      0   1
0  5979  18
1   195  66
oracle model performance metric: 

scalar performance:
{'acc': 0.9790668, 'precision': 0.9299164, 'recall': 0.7875211, 'specificity': 0.7875211, 'f1': 0.8433089, 'auroc': 0.9434901, 'binary_precision': 0.877907, 'binary_recall': 0.5785441, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6974596}
confusion matrix:
      0    1
0  5976   21
1   110  151
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   3518 MiB |   3518 MiB |      0 B   |
|       from large pool |   3506 MiB |   3506 MiB |   3506 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258190 KiB | 316551 KiB | 479311 GiB | 479311 GiB |
|       from large pool | 254640 KiB | 313088 KiB | 467816 GiB | 467815 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     140    |       0    |
|       from large pool |     134    |     134    |     134    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2824    |   71556 K  |   71556 K  |
|       from large pool |      78    |     119    |   33483 K  |   33483 K  |
|       from small pool |      17    |    2746    |   38073 K  |   38073 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479312 GiB | 479312 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467817 GiB | 467817 GiB |
|       from small pool |      0 KiB |   9341 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71558 K  |   71558 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   38074 K  |   38074 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479312 GiB | 479312 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467817 GiB | 467817 GiB |
|       from small pool |      0 KiB |   9341 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71558 K  |   71558 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   38074 K  |   38074 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751

 Experiment start at: 2024-05-30 08:57:50.858387
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97430223, 'precision': 0.84851277, 'recall': 0.67721856, 'specificity': 0.67721856, 'f1': 0.7328954, 'auroc': 0.9659871, 'binary_precision': 0.7184466, 'binary_recall': 0.3592233, 'binary_specificity': 0.99521387, 'binary_f1_score': 0.47896445}
confusion matrix:
       0    1
0  42211  203
1    924  518
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.8267096, 'recall': 0.7283343, 'specificity': 0.7283343, 'f1': 0.76799977, 'auroc': 0.9663637, 'binary_precision': 0.6731183, 'binary_recall': 0.46508172, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.55008787}
confusion matrix:
       0    1
0  17915  152
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.9243026, 'recall': 0.559279, 'specificity': 0.559279, 'f1': 0.5954702, 'auroc': 0.9509827, 'binary_precision': 0.8857143, 'binary_recall': 0.11923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2101695}
confusion matrix:
      0   1
0  5942   4
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 09:36:53.450976,epoch time: 0:39:02.592589,used: 0:39:02.592589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97929585, 'precision': 0.8604132, 'recall': 0.7859801, 'specificity': 0.7859801, 'f1': 0.81856173, 'auroc': 0.9744466, 'binary_precision': 0.73503524, 'binary_recall': 0.57905686, 'binary_specificity': 0.9929033, 'binary_f1_score': 0.64778894}
confusion matrix:
       0    1
0  42113  301
1    607  835
---- Validation: 
scalar performance:
{'acc': 0.97604054, 'precision': 0.84194255, 'recall': 0.78729916, 'specificity': 0.78729916, 'f1': 0.81202465, 'auroc': 0.97254884, 'binary_precision': 0.69928825, 'binary_recall': 0.5839524, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.63643724}
confusion matrix:
       0    1
0  17898  169
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.8131428, 'recall': 0.51881033, 'specificity': 0.51881033, 'f1': 0.5258586, 'auroc': 0.9511629, 'binary_precision': 0.6666667, 'binary_recall': 0.03846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5941   5
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 2,now: 2024-05-30 10:14:21.360309,epoch time: 0:37:27.909333,used: 1:16:30.501922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9809604, 'precision': 0.93088025, 'recall': 0.74296194, 'specificity': 0.74296194, 'f1': 0.8089806, 'auroc': 0.9834821, 'binary_precision': 0.87890136, 'binary_recall': 0.48821083, 'binary_specificity': 0.997713, 'binary_f1_score': 0.6277307}
confusion matrix:
       0    1
0  42317   97
1    738  704
---- Validation: 
scalar performance:
{'acc': 0.97577375, 'precision': 0.90459794, 'recall': 0.70275927, 'specificity': 0.70275927, 'f1': 0.7676811, 'auroc': 0.9765903, 'binary_precision': 0.83081573, 'binary_recall': 0.40861812, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.54780877}
confusion matrix:
       0    1
0  18011   56
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.8793582, 'recall': 0.50760823, 'specificity': 0.50760823, 'f1': 0.50451565, 'auroc': 0.9546847, 'binary_precision': 0.8, 'binary_recall': 0.015384615, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.03018868}
confusion matrix:
      0  1
0  5945  1
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9757737517356873, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.9589107036590576 / 0.962455689907074
after epoch: 3,now: 2024-05-30 10:51:55.339680,epoch time: 0:37:33.979371,used: 1:54:04.481293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98383343, 'precision': 0.9060564, 'recall': 0.8208164, 'specificity': 0.8208164, 'f1': 0.8580593, 'auroc': 0.9854723, 'binary_precision': 0.82404953, 'binary_recall': 0.6463246, 'binary_specificity': 0.99530816, 'binary_f1_score': 0.7244462}
confusion matrix:
       0    1
0  42215  199
1    510  932
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.88620245, 'recall': 0.813283, 'specificity': 0.813283, 'f1': 0.84561247, 'auroc': 0.97343886, 'binary_precision': 0.78597784, 'binary_recall': 0.6329866, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.7012346}
confusion matrix:
       0    1
0  17951  116
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.94679916, 'recall': 0.52683896, 'specificity': 0.52683896, 'f1': 0.5407336, 'auroc': 0.9545517, 'binary_precision': 0.93333334, 'binary_recall': 0.053846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5945   1
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 4,now: 2024-05-30 11:29:22.597361,epoch time: 0:37:27.257681,used: 2:31:31.738974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98711693, 'precision': 0.9037792, 'recall': 0.8905092, 'specificity': 0.8905092, 'f1': 0.8970244, 'auroc': 0.99027437, 'binary_precision': 0.8147882, 'binary_recall': 0.78710127, 'binary_specificity': 0.9939171, 'binary_f1_score': 0.80070543}
confusion matrix:
       0     1
0  42156   258
1    307  1135
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.88362086, 'recall': 0.8748323, 'specificity': 0.8748323, 'f1': 0.8791709, 'auroc': 0.9787717, 'binary_precision': 0.7762557, 'binary_recall': 0.7578009, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.7669173}
confusion matrix:
       0    1
0  17920  147
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.93514055, 'recall': 0.53829336, 'specificity': 0.53829336, 'f1': 0.5609467, 'auroc': 0.95379746, 'binary_precision': 0.90909094, 'binary_recall': 0.07692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.14184397}
confusion matrix:
      0   1
0  5944   2
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 5,now: 2024-05-30 12:06:50.242674,epoch time: 0:37:27.645313,used: 3:08:59.384287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9877782, 'precision': 0.9385387, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.89432585, 'auroc': 0.99116904, 'binary_precision': 0.8865188, 'binary_recall': 0.72052705, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.79495025}
confusion matrix:
       0     1
0  42281   133
1    403  1039
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.91215265, 'recall': 0.82894444, 'specificity': 0.82894444, 'f1': 0.8654894, 'auroc': 0.98007405, 'binary_precision': 0.836773, 'binary_recall': 0.6627043, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.73963517}
confusion matrix:
       0    1
0  17980   87
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8796643, 'recall': 0.51521647, 'specificity': 0.51521647, 'f1': 0.5191701, 'auroc': 0.94919324, 'binary_precision': 0.8, 'binary_recall': 0.03076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5944  2
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9832444190979004, best validation acc: 0.9834578633308411, corresponding to test acc:                         0.961005449295044 / 0.962455689907074
after epoch: 6,now: 2024-05-30 12:44:14.504976,epoch time: 0:37:24.262302,used: 3:46:23.646589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9890095, 'precision': 0.9149212, 'recall': 0.91158473, 'specificity': 0.91158473, 'f1': 0.9132457, 'auroc': 0.99264777, 'binary_precision': 0.83566433, 'binary_recall': 0.82871014, 'binary_specificity': 0.9944594, 'binary_f1_score': 0.8321727}
confusion matrix:
       0     1
0  42179   235
1    247  1195
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.8880489, 'recall': 0.8713666, 'specificity': 0.8713666, 'f1': 0.8795079, 'auroc': 0.9824636, 'binary_precision': 0.785381, 'binary_recall': 0.75037146, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.76747715}
confusion matrix:
       0    1
0  17929  138
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.915224, 'recall': 0.58594984, 'specificity': 0.58594984, 'f1': 0.6350572, 'auroc': 0.9463582, 'binary_precision': 0.86538464, 'binary_recall': 0.17307693, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.28846154}
confusion matrix:
      0   1
0  5939   7
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-30 13:22:16.992115,epoch time: 0:38:02.487139,used: 4:24:26.133728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98999, 'precision': 0.9498839, 'recall': 0.88596535, 'specificity': 0.88596535, 'f1': 0.9153014, 'auroc': 0.9953104, 'binary_precision': 0.9073924, 'binary_recall': 0.77461857, 'binary_specificity': 0.9973122, 'binary_f1_score': 0.8357651}
confusion matrix:
       0     1
0  42300   114
1    325  1117
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.9217992, 'recall': 0.8329636, 'specificity': 0.8329636, 'f1': 0.8717264, 'auroc': 0.98104787, 'binary_precision': 0.85578746, 'binary_recall': 0.6701337, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7516667}
confusion matrix:
       0    1
0  17991   76
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.95901453, 'recall': 0.5422236, 'specificity': 0.5422236, 'f1': 0.5678861, 'auroc': 0.941237, 'binary_precision': 0.95652175, 'binary_recall': 0.08461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.15547705}
confusion matrix:
      0   1
0  5945   1
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 8,now: 2024-05-30 13:59:53.302397,epoch time: 0:37:36.310282,used: 5:02:02.444010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9903776, 'precision': 0.9599884, 'recall': 0.88248134, 'specificity': 0.88248134, 'f1': 0.9174137, 'auroc': 0.9950485, 'binary_precision': 0.92785233, 'binary_recall': 0.7669903, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.8397875}
confusion matrix:
       0     1
0  42328    86
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.98340446, 'precision': 0.94209325, 'recall': 0.80184734, 'specificity': 0.80184734, 'f1': 0.8577456, 'auroc': 0.98239404, 'binary_precision': 0.8986784, 'binary_recall': 0.6062407, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.7240462}
confusion matrix:
       0    1
0  18021   46
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.90066653, 'recall': 0.54004824, 'specificity': 0.54004824, 'f1': 0.5636652, 'auroc': 0.94671935, 'binary_precision': 0.84, 'binary_recall': 0.08076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5942   4
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9834044575691223, best validation acc: 0.9840981960296631, corresponding to test acc:                         0.9614889025688171 / 0.9642281532287598
after epoch: 9,now: 2024-05-30 14:37:29.626415,epoch time: 0:37:36.324018,used: 5:39:38.768028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9914949, 'precision': 0.9678528, 'recall': 0.89377743, 'specificity': 0.89377743, 'f1': 0.92740357, 'auroc': 0.99666804, 'binary_precision': 0.9428335, 'binary_recall': 0.7891817, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.8591922}
confusion matrix:
       0     1
0  42345    69
1    304  1138
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.9384124, 'recall': 0.8320312, 'specificity': 0.8320312, 'f1': 0.877298, 'auroc': 0.98196, 'binary_precision': 0.8891089, 'binary_recall': 0.66716194, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.762309}
confusion matrix:
       0    1
0  18011   56
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.93908393, 'recall': 0.54213953, 'specificity': 0.54213953, 'f1': 0.5675703, 'auroc': 0.89827937, 'binary_precision': 0.9166667, 'binary_recall': 0.08461539, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5944   2
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 10,now: 2024-05-30 15:15:03.593492,epoch time: 0:37:33.967077,used: 6:17:12.735105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99117565, 'precision': 0.9523666, 'recall': 0.9039959, 'specificity': 0.9039959, 'f1': 0.92671394, 'auroc': 0.9962049, 'binary_precision': 0.91114575, 'binary_recall': 0.8106796, 'binary_specificity': 0.9973122, 'binary_f1_score': 0.8579816}
confusion matrix:
       0     1
0  42300   114
1    273  1169
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.93233216, 'recall': 0.8318375, 'specificity': 0.8318375, 'f1': 0.8749493, 'auroc': 0.9795513, 'binary_precision': 0.8769531, 'binary_recall': 0.66716194, 'binary_specificity': 0.996513, 'binary_f1_score': 0.75780594}
confusion matrix:
       0    1
0  18004   63
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.96090925, 'recall': 0.54606974, 'specificity': 0.54606974, 'f1': 0.5744389, 'auroc': 0.9362787, 'binary_precision': 0.96, 'binary_recall': 0.092307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5945   1
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9846851825714111, best validation acc: 0.9850587248802185, corresponding to test acc:                         0.9613277316093445 / 0.9642281532287598
after epoch: 11,now: 2024-05-30 15:52:39.113277,epoch time: 0:37:35.519785,used: 6:54:48.254890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9934102, 'precision': 0.96143013, 'recall': 0.93261725, 'specificity': 0.93261725, 'f1': 0.94652486, 'auroc': 0.99739707, 'binary_precision': 0.9273536, 'binary_recall': 0.86754507, 'binary_specificity': 0.9976894, 'binary_f1_score': 0.8964529}
confusion matrix:
       0     1
0  42316    98
1    191  1251
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9325568, 'recall': 0.85841733, 'specificity': 0.85841733, 'f1': 0.8917285, 'auroc': 0.9824914, 'binary_precision': 0.87545127, 'binary_recall': 0.7206538, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.79054606}
confusion matrix:
       0    1
0  17998   69
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.90545094, 'recall': 0.5534257, 'specificity': 0.5534257, 'f1': 0.5857851, 'auroc': 0.91602594, 'binary_precision': 0.8484849, 'binary_recall': 0.10769231, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.19112627}
confusion matrix:
      0   1
0  5941   5
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 12,now: 2024-05-30 16:30:18.176180,epoch time: 0:37:39.062903,used: 7:32:27.317793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99206495, 'precision': 0.97227156, 'recall': 0.8990964, 'specificity': 0.8990964, 'f1': 0.9323929, 'auroc': 0.9972986, 'binary_precision': 0.9513201, 'binary_recall': 0.7995839, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.8688771}
confusion matrix:
       0     1
0  42355    59
1    289  1153
---- Validation: 
scalar performance:
{'acc': 0.982604, 'precision': 0.9340368, 'recall': 0.7957101, 'specificity': 0.7957101, 'f1': 0.85075605, 'auroc': 0.9807708, 'binary_precision': 0.8830022, 'binary_recall': 0.5943536, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.71047956}
confusion matrix:
       0    1
0  18014   53
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.86050475, 'recall': 0.5360339, 'specificity': 0.5360339, 'f1': 0.5564828, 'auroc': 0.8881072, 'binary_precision': 0.76, 'binary_recall': 0.073076926, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5940   6
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9826040267944336, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9618111252784729 / 0.9642281532287598
after epoch: 13,now: 2024-05-30 17:08:14.738471,epoch time: 0:37:56.562291,used: 8:10:23.880084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9943907, 'precision': 0.96187556, 'recall': 0.9488669, 'specificity': 0.9488669, 'f1': 0.95527136, 'auroc': 0.99814427, 'binary_precision': 0.92714286, 'binary_recall': 0.9001387, 'binary_specificity': 0.99759513, 'binary_f1_score': 0.91344124}
confusion matrix:
       0     1
0  42312   102
1    144  1298
---- Validation: 
scalar performance:
{'acc': 0.98580575, 'precision': 0.91737217, 'recall': 0.868182, 'specificity': 0.868182, 'f1': 0.89110607, 'auroc': 0.9814365, 'binary_precision': 0.8443316, 'binary_recall': 0.74145615, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.7895569}
confusion matrix:
       0    1
0  17975   92
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.93823326, 'recall': 0.52106977, 'specificity': 0.52106977, 'f1': 0.5301446, 'auroc': 0.905709, 'binary_precision': 0.9166667, 'binary_recall': 0.042307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5945   1
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9858057498931885, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9618111252784729 / 0.9642281532287598
after epoch: 14,now: 2024-05-30 17:45:42.305542,epoch time: 0:37:27.567071,used: 8:47:51.447155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941399, 'precision': 0.9492659, 'recall': 0.95979065, 'specificity': 0.95979065, 'f1': 0.95446265, 'auroc': 0.99832666, 'binary_precision': 0.901151, 'binary_recall': 0.9230236, 'binary_specificity': 0.9965577, 'binary_f1_score': 0.9119562}
confusion matrix:
       0     1
0  42268   146
1    111  1331
---- Validation: 
scalar performance:
{'acc': 0.98639274, 'precision': 0.90930337, 'recall': 0.88994443, 'specificity': 0.88994443, 'f1': 0.8993688, 'auroc': 0.98283917, 'binary_precision': 0.8265625, 'binary_recall': 0.7860327, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.8057883}
confusion matrix:
       0    1
0  17956  111
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8594415, 'recall': 0.5701448, 'specificity': 0.5701448, 'f1': 0.61003274, 'auroc': 0.93586445, 'binary_precision': 0.75510204, 'binary_recall': 0.1423077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5934  12
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 15,now: 2024-05-30 18:22:53.987887,epoch time: 0:37:11.682345,used: 9:25:03.129500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9939575, 'precision': 0.950482, 'recall': 0.955007, 'specificity': 0.955007, 'f1': 0.9527323, 'auroc': 0.99868524, 'binary_precision': 0.9039121, 'binary_recall': 0.9133148, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.9085892}
confusion matrix:
       0     1
0  42274   140
1    125  1317
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.9089701, 'recall': 0.8855145, 'specificity': 0.8855145, 'f1': 0.89686567, 'auroc': 0.98325247, 'binary_precision': 0.8262243, 'binary_recall': 0.7771174, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.8009188}
confusion matrix:
       0    1
0  17957  110
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8285857, 'recall': 0.5641233, 'specificity': 0.5641233, 'f1': 0.60007614, 'auroc': 0.9002188, 'binary_precision': 0.6938776, 'binary_recall': 0.13076924, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.22006473}
confusion matrix:
      0   1
0  5931  15
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9861259460449219, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9621334075927734 / 0.9642281532287598
after epoch: 16,now: 2024-05-30 19:00:14.051550,epoch time: 0:37:20.063663,used: 10:02:23.193163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99475557, 'precision': 0.9808916, 'recall': 0.93498755, 'specificity': 0.93498755, 'f1': 0.9567064, 'auroc': 0.99872756, 'binary_precision': 0.96615386, 'binary_recall': 0.8710125, 'binary_specificity': 0.9989626, 'binary_f1_score': 0.9161197}
confusion matrix:
       0     1
0  42370    44
1    186  1256
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.94208467, 'recall': 0.85283357, 'specificity': 0.85283357, 'f1': 0.89204884, 'auroc': 0.9806845, 'binary_precision': 0.89493436, 'binary_recall': 0.7087667, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7910448}
confusion matrix:
       0    1
0  18011   56
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8641461, 'recall': 0.54364216, 'specificity': 0.54364216, 'f1': 0.569246, 'auroc': 0.92368966, 'binary_precision': 0.76666665, 'binary_recall': 0.08846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.1586207}
confusion matrix:
      0   1
0  5939   7
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 17,now: 2024-05-30 19:37:47.737972,epoch time: 0:37:33.686422,used: 10:39:56.879585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9942767, 'precision': 0.98001635, 'recall': 0.928041, 'specificity': 0.928041, 'f1': 0.9524344, 'auroc': 0.99886316, 'binary_precision': 0.96487117, 'binary_recall': 0.85714287, 'binary_specificity': 0.99893904, 'binary_f1_score': 0.90782225}
confusion matrix:
       0     1
0  42369    45
1    206  1236
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9356048, 'recall': 0.8444952, 'specificity': 0.8444952, 'f1': 0.8843026, 'auroc': 0.9807247, 'binary_precision': 0.88257575, 'binary_recall': 0.692422, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.77602005}
confusion matrix:
       0    1
0  18005   62
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9343679, 'recall': 0.5191467, 'specificity': 0.5191467, 'f1': 0.52656347, 'auroc': 0.8959583, 'binary_precision': 0.90909094, 'binary_recall': 0.03846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.07380074}
confusion matrix:
      0   1
0  5945   1
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9856456518173218, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9606832265853882 / 0.9642281532287598
after epoch: 18,now: 2024-05-30 20:15:14.118374,epoch time: 0:37:26.380402,used: 11:17:23.259987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9939575, 'precision': 0.9579389, 'recall': 0.9459633, 'specificity': 0.9459633, 'f1': 0.9518658, 'auroc': 0.9988067, 'binary_precision': 0.9194583, 'binary_recall': 0.89459085, 'binary_specificity': 0.9973358, 'binary_f1_score': 0.90685415}
confusion matrix:
       0     1
0  42301   113
1    152  1290
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9031416, 'recall': 0.849221, 'specificity': 0.849221, 'f1': 0.87408257, 'auroc': 0.9797273, 'binary_precision': 0.8172414, 'binary_recall': 0.70430905, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.75658417}
confusion matrix:
       0    1
0  17961  106
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.89630485, 'recall': 0.564796, 'specificity': 0.564796, 'f1': 0.60333747, 'auroc': 0.86794645, 'binary_precision': 0.8292683, 'binary_recall': 0.13076924, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.22591363}
confusion matrix:
      0   1
0  5939   7
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9837246537208557, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9606832265853882 / 0.9642281532287598
after epoch: 19,now: 2024-05-30 20:52:15.369761,epoch time: 0:37:01.251387,used: 11:54:24.511374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9955992, 'precision': 0.96382713, 'recall': 0.96724415, 'specificity': 0.96724415, 'f1': 0.96552896, 'auroc': 0.99922705, 'binary_precision': 0.9298004, 'binary_recall': 0.9368932, 'binary_specificity': 0.99759513, 'binary_f1_score': 0.93333334}
confusion matrix:
       0     1
0  42312   102
1     91  1351
---- Validation: 
scalar performance:
{'acc': 0.9884205, 'precision': 0.9230993, 'recall': 0.90673196, 'specificity': 0.90673196, 'f1': 0.91474026, 'auroc': 0.9821286, 'binary_precision': 0.85294116, 'binary_recall': 0.8187221, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.8354814}
confusion matrix:
       0    1
0  17972   95
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.855427, 'recall': 0.53411084, 'specificity': 0.53411084, 'f1': 0.553156, 'auroc': 0.8824862, 'binary_precision': 0.75, 'binary_recall': 0.06923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12676057}
confusion matrix:
      0   1
0  5940   6
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 20,now: 2024-05-30 21:28:59.828548,epoch time: 0:36:44.458787,used: 12:31:08.970161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99206495, 'precision': 0.97409105, 'recall': 0.8974217, 'specificity': 0.8974217, 'f1': 0.93214524, 'auroc': 0.9979821, 'binary_precision': 0.95507485, 'binary_recall': 0.79611653, 'binary_specificity': 0.99872684, 'binary_f1_score': 0.86838126}
confusion matrix:
       0     1
0  42360    54
1    294  1148
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.91434646, 'recall': 0.79807293, 'specificity': 0.79807293, 'f1': 0.8459598, 'auroc': 0.9819492, 'binary_precision': 0.8434238, 'binary_recall': 0.60029715, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.7013889}
confusion matrix:
       0    1
0  17992   75
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9123324, 'recall': 0.5362862, 'specificity': 0.5362862, 'f1': 0.5573182, 'auroc': 0.926643, 'binary_precision': 0.8636364, 'binary_recall': 0.073076926, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.13475178}
confusion matrix:
      0   1
0  5943   3
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.981643557548523, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 21,now: 2024-05-30 22:05:53.200940,epoch time: 0:36:53.372392,used: 13:08:02.342553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99553084, 'precision': 0.9654416, 'recall': 0.9641942, 'specificity': 0.9641942, 'f1': 0.964817, 'auroc': 0.9993812, 'binary_precision': 0.9332406, 'binary_recall': 0.93065184, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.93194443}
confusion matrix:
       0     1
0  42318    96
1    100  1342
---- Validation: 
scalar performance:
{'acc': 0.98762006, 'precision': 0.92809576, 'recall': 0.88628936, 'specificity': 0.88628936, 'f1': 0.906029, 'auroc': 0.98149943, 'binary_precision': 0.8644628, 'binary_recall': 0.7771174, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.81846637}
confusion matrix:
       0    1
0  17985   82
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.87173456, 'recall': 0.53419495, 'specificity': 0.53419495, 'f1': 0.55342203, 'auroc': 0.88615763, 'binary_precision': 0.7826087, 'binary_recall': 0.06923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5941   5
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9876200556755066, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 22,now: 2024-05-30 22:42:57.900908,epoch time: 0:37:04.699968,used: 13:45:07.042521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9965797, 'precision': 0.96479034, 'recall': 0.9828239, 'specificity': 0.9828239, 'f1': 0.97362244, 'auroc': 0.99936783, 'binary_precision': 0.9306667, 'binary_recall': 0.96809983, 'binary_specificity': 0.997548, 'binary_f1_score': 0.9490143}
confusion matrix:
       0     1
0  42310   104
1     46  1396
---- Validation: 
scalar performance:
{'acc': 0.98778015, 'precision': 0.91531944, 'recall': 0.90639985, 'specificity': 0.90639985, 'f1': 0.910807, 'auroc': 0.98113763, 'binary_precision': 0.837386, 'binary_recall': 0.8187221, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.82794887}
confusion matrix:
       0    1
0  17960  107
1    122  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.84961426, 'recall': 0.5530053, 'specificity': 0.5530053, 'f1': 0.58397126, 'auroc': 0.85989594, 'binary_precision': 0.7368421, 'binary_recall': 0.10769231, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5936  10
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 3
val acc:0.9877801537513733, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 23,now: 2024-05-30 23:19:59.569249,epoch time: 0:37:01.668341,used: 14:22:08.710862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9953256, 'precision': 0.9525454, 'recall': 0.97646624, 'specificity': 0.97646624, 'f1': 0.9641739, 'auroc': 0.9992776, 'binary_precision': 0.90657896, 'binary_recall': 0.95628035, 'binary_specificity': 0.9966521, 'binary_f1_score': 0.9307667}
confusion matrix:
       0     1
0  42273   142
1     63  1378
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.8955897, 'recall': 0.88198924, 'specificity': 0.88198924, 'f1': 0.88865983, 'auroc': 0.9824919, 'binary_precision': 0.79969186, 'binary_recall': 0.77117383, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.785174}
confusion matrix:
       0    1
0  17937  130
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7636152, 'recall': 0.5483182, 'specificity': 0.5483182, 'f1': 0.57447666, 'auroc': 0.8452334, 'binary_precision': 0.5652174, 'binary_recall': 0.1, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.16993465}
confusion matrix:
      0   1
0  5926  20
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 4
val acc:0.9848452210426331, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 24,now: 2024-05-30 23:56:40.377880,epoch time: 0:36:40.808631,used: 14:58:49.519493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9964201, 'precision': 0.98397124, 'recall': 0.9589598, 'specificity': 0.9589598, 'f1': 0.9711096, 'auroc': 0.9995917, 'binary_precision': 0.970696, 'binary_recall': 0.9188627, 'binary_specificity': 0.99905694, 'binary_f1_score': 0.9440684}
confusion matrix:
       0     1
0  42374    40
1    117  1325
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.9320867, 'recall': 0.8517585, 'specificity': 0.8517585, 'f1': 0.88747185, 'auroc': 0.98375565, 'binary_precision': 0.875, 'binary_recall': 0.7072808, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.7822514}
confusion matrix:
       0    1
0  17999   68
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7773577, 'recall': 0.5354453, 'specificity': 0.5354453, 'f1': 0.5545899, 'auroc': 0.8472365, 'binary_precision': 0.59375, 'binary_recall': 0.073076926, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.130137}
confusion matrix:
      0   1
0  5933  13
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 5
val acc:0.9858590960502625, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 25,now: 2024-05-31 00:34:00.620870,epoch time: 0:37:20.242990,used: 15:36:09.762483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99689895, 'precision': 0.9741194, 'recall': 0.9772948, 'specificity': 0.9772948, 'f1': 0.9757014, 'auroc': 0.99963486, 'binary_precision': 0.9497245, 'binary_recall': 0.9563107, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.9530062}
confusion matrix:
       0     1
0  42341    73
1     63  1379
---- Validation: 
scalar performance:
{'acc': 0.9878335, 'precision': 0.9275125, 'recall': 0.89069164, 'specificity': 0.89069164, 'f1': 0.90820336, 'auroc': 0.9816828, 'binary_precision': 0.862969, 'binary_recall': 0.7860327, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.8227061}
confusion matrix:
       0    1
0  17983   84
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.86239815, 'recall': 0.5246636, 'specificity': 0.5246636, 'f1': 0.5365894, 'auroc': 0.87049663, 'binary_precision': 0.7647059, 'binary_recall': 0.05, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5942   4
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 6
val acc:0.9878334999084473, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 26,now: 2024-05-31 01:12:30.094940,epoch time: 0:38:29.474070,used: 16:14:39.236553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99708134, 'precision': 0.98494345, 'recall': 0.9686803, 'specificity': 0.9686803, 'f1': 0.97666305, 'auroc': 0.9995382, 'binary_precision': 0.9719828, 'binary_recall': 0.93828017, 'binary_specificity': 0.9990805, 'binary_f1_score': 0.95483416}
confusion matrix:
       0     1
0  42375    39
1     89  1353
---- Validation: 
scalar performance:
{'acc': 0.9883138, 'precision': 0.94469243, 'recall': 0.8787812, 'specificity': 0.8787812, 'f1': 0.9088849, 'auroc': 0.97609115, 'binary_precision': 0.89824563, 'binary_recall': 0.76077265, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.8238133}
confusion matrix:
       0    1
0  18009   58
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.77392054, 'recall': 0.5186421, 'specificity': 0.5186421, 'f1': 0.5255119, 'auroc': 0.76885736, 'binary_precision': 0.5882353, 'binary_recall': 0.03846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.07220217}
confusion matrix:
      0   1
0  5939   7
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 7
val acc:0.9883137941360474, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 27,now: 2024-05-31 01:51:24.543531,epoch time: 0:38:54.448591,used: 16:53:33.685144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9974006, 'precision': 0.978037, 'recall': 0.9812386, 'specificity': 0.9812386, 'f1': 0.9796321, 'auroc': 0.99954724, 'binary_precision': 0.95730025, 'binary_recall': 0.96393895, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.9606082}
confusion matrix:
       0     1
0  42352    62
1     52  1390
---- Validation: 
scalar performance:
{'acc': 0.9883138, 'precision': 0.9382131, 'recall': 0.8859339, 'specificity': 0.8859339, 'f1': 0.9102782, 'auroc': 0.98260546, 'binary_precision': 0.8847458, 'binary_recall': 0.7756315, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.8266033}
confusion matrix:
       0    1
0  17999   68
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.82657456, 'recall': 0.53394264, 'specificity': 0.53394264, 'f1': 0.55262864, 'auroc': 0.9025607, 'binary_precision': 0.6923077, 'binary_recall': 0.06923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.12587413}
confusion matrix:
      0   1
0  5938   8
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 8
val acc:0.9883137941360474, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 28,now: 2024-05-31 02:30:15.485718,epoch time: 0:38:50.942187,used: 17:32:24.627331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9965797, 'precision': 0.9704545, 'recall': 0.9761249, 'specificity': 0.9761249, 'f1': 0.9732714, 'auroc': 0.99957126, 'binary_precision': 0.9424658, 'binary_recall': 0.95423025, 'binary_specificity': 0.9980195, 'binary_f1_score': 0.9483115}
confusion matrix:
       0     1
0  42330    84
1     66  1376
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9101168, 'recall': 0.8848269, 'specificity': 0.8848269, 'f1': 0.8970343, 'auroc': 0.9830383, 'binary_precision': 0.82857144, 'binary_recall': 0.7756315, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.8012279}
confusion matrix:
       0    1
0  17959  108
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.78018117, 'recall': 0.52800524, 'specificity': 0.52800524, 'f1': 0.54211783, 'auroc': 0.90482354, 'binary_precision': 0.6, 'binary_recall': 0.057692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.10526316}
confusion matrix:
      0   1
0  5936  10
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 9
val acc:0.9861792922019958, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 29,now: 2024-05-31 03:08:39.009409,epoch time: 0:38:23.523691,used: 18:10:48.151022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9967849, 'precision': 0.9621357, 'recall': 0.98962903, 'specificity': 0.98962903, 'f1': 0.9754547, 'auroc': 0.99978733, 'binary_precision': 0.9248857, 'binary_recall': 0.9819695, 'binary_specificity': 0.99728864, 'binary_f1_score': 0.9525732}
confusion matrix:
       0     1
0  42299   115
1     26  1416
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.9082736, 'recall': 0.9053525, 'specificity': 0.9053525, 'f1': 0.90680736, 'auroc': 0.98102784, 'binary_precision': 0.8233533, 'binary_recall': 0.81723624, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.8202834}
confusion matrix:
       0    1
0  17949  118
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.75190175, 'recall': 0.535193, 'specificity': 0.535193, 'f1': 0.55380183, 'auroc': 0.7204348, 'binary_precision': 0.54285717, 'binary_recall': 0.073076926, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.12881356}
confusion matrix:
      0   1
0  5930  16
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 10
val acc:0.9871398210525513, best validation acc: 0.9884204864501953, corresponding to test acc:                         0.9600386619567871 / 0.9642281532287598
after epoch: 30,now: 2024-05-31 03:47:03.355301,epoch time: 0:38:24.345892,used: 18:49:12.496914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_08_57_50_seed_1_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:49:12.496914 at 2024-05-31 03:47:03.355301
persisted model performance metric: 

scalar performance:
{'acc': 0.96036094, 'precision': 0.85565716, 'recall': 0.539796, 'specificity': 0.539796, 'f1': 0.5627715, 'auroc': 0.89918935, 'binary_precision': 0.75, 'binary_recall': 0.08076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.14583333}
confusion matrix:
      0   1
0  5939   7
1   239  21
oracle model performance metric: 

scalar performance:
{'acc': 0.96422815, 'precision': 0.915224, 'recall': 0.58594984, 'specificity': 0.58594984, 'f1': 0.6350572, 'auroc': 0.9446003, 'binary_precision': 0.86538464, 'binary_recall': 0.17307693, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.28846154}
confusion matrix:
      0   1
0  5939   7
1   215  45
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |   1662 MiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1671 TiB |   1671 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1648 TiB |   1648 TiB |
|       from small pool |      5 MiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3500 MiB |   3518 MiB |   5096 MiB |   1596 MiB |
|       from large pool |   3488 MiB |   3506 MiB |   5082 MiB |   1594 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 240250 KiB | 316551 KiB |    945 TiB |    945 TiB |
|       from large pool | 236688 KiB | 313088 KiB |    923 TiB |    923 TiB |
|       from small pool |   3562 KiB |   9341 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6345    |  281697 K  |  281693 K  |
|       from large pool |     247    |     352    |  109070 K  |  109070 K  |
|       from small pool |    3095    |    6097    |  172626 K  |  172623 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6345    |  281697 K  |  281693 K  |
|       from large pool |     247    |     352    |  109070 K  |  109070 K  |
|       from small pool |    3095    |    6097    |  172626 K  |  172623 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     187    |      47    |
|       from large pool |     134    |     134    |     180    |      46    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2827    |  144051 K  |  144051 K  |
|       from large pool |      77    |     119    |   67340 K  |   67340 K  |
|       from small pool |      18    |    2750    |   76710 K  |   76710 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1671 TiB |   1671 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1648 TiB |   1648 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |   3518 MiB |   5096 MiB |   3192 MiB |
|       from large pool |   1894 MiB |   3506 MiB |   5082 MiB |   3188 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    945 TiB |    945 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    923 TiB |    923 TiB |
|       from small pool |      0 KiB |   9343 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281697 K  |  281697 K  |
|       from large pool |       2    |     352    |  109070 K  |  109070 K  |
|       from small pool |       0    |    6097    |  172626 K  |  172626 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281697 K  |  281697 K  |
|       from large pool |       2    |     352    |  109070 K  |  109070 K  |
|       from small pool |       0    |    6097    |  172626 K  |  172626 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     187    |      94    |
|       from large pool |      88    |     134    |     180    |      92    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  144052 K  |  144052 K  |
|       from large pool |       3    |     119    |   67340 K  |   67340 K  |
|       from small pool |       0    |    2750    |   76712 K  |   76712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |   1672 TiB |   1672 TiB |
|       from large pool |  16640 KiB |   3191 MiB |   1650 TiB |   1649 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1671 TiB |   1671 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1648 TiB |   1648 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |   3518 MiB |   5096 MiB |   3192 MiB |
|       from large pool |   1894 MiB |   3506 MiB |   5082 MiB |   3188 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB |    945 TiB |    945 TiB |
|       from large pool |  24320 KiB | 313088 KiB |    923 TiB |    923 TiB |
|       from small pool |      0 KiB |   9343 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281697 K  |  281697 K  |
|       from large pool |       2    |     352    |  109070 K  |  109070 K  |
|       from small pool |       0    |    6097    |  172626 K  |  172626 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281697 K  |  281697 K  |
|       from large pool |       2    |     352    |  109070 K  |  109070 K  |
|       from small pool |       0    |    6097    |  172626 K  |  172626 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     187    |      94    |
|       from large pool |      88    |     134    |     180    |      92    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  144052 K  |  144052 K  |
|       from large pool |       3    |     119    |   67340 K  |   67340 K  |
|       from small pool |       0    |    2750    |   76712 K  |   76712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751

 Experiment start at: 2024-05-31 03:57:45.668369
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97469425, 'precision': 0.88000786, 'recall': 0.6832193, 'specificity': 0.6832193, 'f1': 0.7447422, 'auroc': 0.96797687, 'binary_precision': 0.7821229, 'binary_recall': 0.3701256, 'binary_specificity': 0.99631304, 'binary_f1_score': 0.50246745}
confusion matrix:
       0    1
0  42155  156
1    953  560
---- Validation: 
scalar performance:
{'acc': 0.97262025, 'precision': 0.88179445, 'recall': 0.59878725, 'specificity': 0.59878725, 'f1': 0.652166, 'auroc': 0.96104884, 'binary_precision': 0.7894737, 'binary_recall': 0.19933555, 'binary_specificity': 0.998239, 'binary_f1_score': 0.31830242}
confusion matrix:
       0    1
0  18139   32
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9508442, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 04:37:49.495341,epoch time: 0:40:03.826972,used: 0:40:03.826972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97597206, 'precision': 0.8086891, 'recall': 0.86901784, 'specificity': 0.86901784, 'f1': 0.83588433, 'auroc': 0.97675604, 'binary_precision': 0.6262349, 'binary_recall': 0.75413084, 'binary_specificity': 0.9839049, 'binary_f1_score': 0.68425786}
confusion matrix:
       0     1
0  41630   681
1    372  1141
---- Validation: 
scalar performance:
{'acc': 0.9765088, 'precision': 0.8038111, 'recall': 0.8441196, 'specificity': 0.8441196, 'f1': 0.82259005, 'auroc': 0.9691226, 'binary_precision': 0.61751825, 'binary_recall': 0.7026578, 'binary_specificity': 0.9855814, 'binary_f1_score': 0.6573426}
confusion matrix:
       0    1
0  17909  262
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.8269532, 'recall': 0.5405719, 'specificity': 0.5405719, 'f1': 0.564339, 'auroc': 0.9416966, 'binary_precision': 0.6896552, 'binary_recall': 0.08264463, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.14760147}
confusion matrix:
      0   1
0  5988   9
1   222  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 05:16:17.040487,epoch time: 0:38:27.545146,used: 1:18:31.372118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9831371, 'precision': 0.8989161, 'recall': 0.83162236, 'specificity': 0.83162236, 'f1': 0.8619156, 'auroc': 0.98433125, 'binary_precision': 0.8096, 'binary_recall': 0.6688698, 'binary_specificity': 0.994375, 'binary_f1_score': 0.73253703}
confusion matrix:
       0     1
0  42073   238
1    501  1012
---- Validation: 
scalar performance:
{'acc': 0.98013103, 'precision': 0.8836, 'recall': 0.7608676, 'specificity': 0.7608676, 'f1': 0.8096923, 'auroc': 0.97679704, 'binary_precision': 0.78271604, 'binary_recall': 0.52657807, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.62959284}
confusion matrix:
       0    1
0  18083   88
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7812822, 'recall': 0.5180948, 'specificity': 0.5180948, 'f1': 0.52524114, 'auroc': 0.9538902, 'binary_precision': 0.6, 'binary_recall': 0.037190083, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.070038915}
confusion matrix:
      0  1
0  5991  6
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 3,now: 2024-05-31 05:54:41.834818,epoch time: 0:38:24.794331,used: 1:56:56.166449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9848941, 'precision': 0.8931179, 'recall': 0.8755504, 'specificity': 0.8755504, 'f1': 0.8841161, 'auroc': 0.9887822, 'binary_precision': 0.7948718, 'binary_recall': 0.7580965, 'binary_specificity': 0.9930042, 'binary_f1_score': 0.7760488}
confusion matrix:
       0     1
0  42015   296
1    366  1147
---- Validation: 
scalar performance:
{'acc': 0.98327386, 'precision': 0.87455595, 'recall': 0.8468112, 'specificity': 0.8468112, 'f1': 0.86010677, 'auroc': 0.9763357, 'binary_precision': 0.7589928, 'binary_recall': 0.7009967, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.7288428}
confusion matrix:
       0    1
0  18037  134
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.80782765, 'recall': 0.53032476, 'specificity': 0.53032476, 'f1': 0.5469829, 'auroc': 0.9517572, 'binary_precision': 0.65217394, 'binary_recall': 0.06198347, 'binary_specificity': 0.998666, 'binary_f1_score': 0.11320755}
confusion matrix:
      0   1
0  5989   8
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 4,now: 2024-05-31 06:32:55.872582,epoch time: 0:38:14.037764,used: 2:35:10.204213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9861263, 'precision': 0.944247, 'recall': 0.83508235, 'specificity': 0.83508235, 'f1': 0.88144636, 'auroc': 0.9906326, 'binary_precision': 0.9000884, 'binary_recall': 0.6728354, 'binary_specificity': 0.9973293, 'binary_f1_score': 0.7700454}
confusion matrix:
       0     1
0  42198   113
1    495  1018
---- Validation: 
scalar performance:
{'acc': 0.9824216, 'precision': 0.93531036, 'recall': 0.75803554, 'specificity': 0.75803554, 'f1': 0.8225348, 'auroc': 0.98022485, 'binary_precision': 0.8863636, 'binary_recall': 0.5182724, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.654088}
confusion matrix:
       0    1
0  18131   40
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.80271375, 'recall': 0.51817816, 'specificity': 0.51817816, 'f1': 0.5254197, 'auroc': 0.948061, 'binary_precision': 0.64285713, 'binary_recall': 0.037190083, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0703125}
confusion matrix:
      0  1
0  5992  5
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9824215769767761, best validation acc: 0.9832738637924194, corresponding to test acc:                         0.9623336791992188 / 0.9629748463630676
after epoch: 5,now: 2024-05-31 07:10:52.169503,epoch time: 0:37:56.296921,used: 3:13:06.501134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98797464, 'precision': 0.9249834, 'recall': 0.8882985, 'specificity': 0.8882985, 'f1': 0.90574616, 'auroc': 0.9909776, 'binary_precision': 0.8577649, 'binary_recall': 0.7812293, 'binary_specificity': 0.99536765, 'binary_f1_score': 0.8177101}
confusion matrix:
       0     1
0  42115   196
1    331  1182
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.8822185, 'recall': 0.84711385, 'specificity': 0.84711385, 'f1': 0.86375403, 'auroc': 0.9826104, 'binary_precision': 0.7743119, 'binary_recall': 0.7009967, 'binary_specificity': 0.993231, 'binary_f1_score': 0.7358325}
confusion matrix:
       0    1
0  18048  123
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.83711964, 'recall': 0.5447042, 'specificity': 0.5447042, 'f1': 0.5712047, 'auroc': 0.9443095, 'binary_precision': 0.7096774, 'binary_recall': 0.09090909, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16117217}
confusion matrix:
      0   1
0  5988   9
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-05-31 07:48:54.633457,epoch time: 0:38:02.463954,used: 3:51:08.965088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98804307, 'precision': 0.9403267, 'recall': 0.8714454, 'specificity': 0.8714454, 'f1': 0.90273595, 'auroc': 0.9930262, 'binary_precision': 0.8896769, 'binary_recall': 0.7461996, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.81164634}
confusion matrix:
       0     1
0  42171   140
1    384  1129
---- Validation: 
scalar performance:
{'acc': 0.9828477, 'precision': 0.89458096, 'recall': 0.80643857, 'specificity': 0.80643857, 'f1': 0.84455466, 'auroc': 0.97850055, 'binary_precision': 0.80172414, 'binary_recall': 0.6179402, 'binary_specificity': 0.994937, 'binary_f1_score': 0.6979362}
confusion matrix:
       0    1
0  18079   92
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.8142414, 'recall': 0.5080977, 'specificity': 0.5080977, 'f1': 0.5063171, 'auroc': 0.92682225, 'binary_precision': 0.6666667, 'binary_recall': 0.016528925, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.032258064}
confusion matrix:
      0  1
0  5995  2
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9828476905822754, best validation acc: 0.9838597774505615, corresponding to test acc:                         0.9632954001426697 / 0.9632954001426697
after epoch: 7,now: 2024-05-31 08:26:33.962015,epoch time: 0:37:39.328558,used: 4:28:48.293646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98802024, 'precision': 0.95429206, 'recall': 0.8570942, 'specificity': 0.8570942, 'f1': 0.89943516, 'auroc': 0.99417204, 'binary_precision': 0.9186441, 'binary_recall': 0.71645737, 'binary_specificity': 0.9977311, 'binary_f1_score': 0.80505013}
confusion matrix:
       0     1
0  42215    96
1    429  1084
---- Validation: 
scalar performance:
{'acc': 0.98449904, 'precision': 0.9291045, 'recall': 0.80167025, 'specificity': 0.80167025, 'f1': 0.85350907, 'auroc': 0.9775629, 'binary_precision': 0.8711217, 'binary_recall': 0.6063123, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.7149853}
confusion matrix:
       0    1
0  18117   54
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.9365511, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 8,now: 2024-05-31 09:04:22.814611,epoch time: 0:37:48.852596,used: 5:06:37.146242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98854506, 'precision': 0.9573847, 'recall': 0.8627831, 'specificity': 0.8627831, 'f1': 0.9042196, 'auroc': 0.99455214, 'binary_precision': 0.92443323, 'binary_recall': 0.7276933, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.81434906}
confusion matrix:
       0     1
0  42221    90
1    412  1101
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.9301468, 'recall': 0.80169773, 'specificity': 0.80169773, 'f1': 0.8538734, 'auroc': 0.98358685, 'binary_precision': 0.8732057, 'binary_recall': 0.6063123, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.71568626}
confusion matrix:
       0    1
0  18118   53
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.9317286, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 9,now: 2024-05-31 09:42:11.241672,epoch time: 0:37:48.427061,used: 5:44:25.573303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99059874, 'precision': 0.9420447, 'recall': 0.9132377, 'specificity': 0.9132377, 'f1': 0.9271171, 'auroc': 0.9960691, 'binary_precision': 0.8901488, 'binary_recall': 0.8301388, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.8590972}
confusion matrix:
       0     1
0  42156   155
1    257  1256
---- Validation: 
scalar performance:
{'acc': 0.9860438, 'precision': 0.8986509, 'recall': 0.86912125, 'specificity': 0.86912125, 'f1': 0.8832738, 'auroc': 0.983454, 'binary_precision': 0.8057554, 'binary_recall': 0.74418604, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.7737478}
confusion matrix:
       0    1
0  18063  108
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.93316907, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 10,now: 2024-05-31 10:20:03.022156,epoch time: 0:37:51.780484,used: 6:22:17.353787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9921504, 'precision': 0.9396771, 'recall': 0.9430386, 'specificity': 0.9430386, 'f1': 0.94135094, 'auroc': 0.997015, 'binary_precision': 0.88327867, 'binary_recall': 0.8902842, 'binary_specificity': 0.99579304, 'binary_f1_score': 0.88676757}
confusion matrix:
       0     1
0  42133   178
1    166  1347
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.8963163, 'recall': 0.88548493, 'specificity': 0.88548493, 'f1': 0.89081955, 'auroc': 0.9838448, 'binary_precision': 0.8, 'binary_recall': 0.77740866, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.78854257}
confusion matrix:
       0    1
0  18054  117
1    134  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.76252913, 'recall': 0.51801145, 'specificity': 0.51801145, 'f1': 0.52506375, 'auroc': 0.9157108, 'binary_precision': 0.5625, 'binary_recall': 0.037190083, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.069767445}
confusion matrix:
      0  1
0  5990  7
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 11,now: 2024-05-31 10:58:08.836823,epoch time: 0:38:05.814667,used: 7:00:23.168454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9913518, 'precision': 0.9748013, 'recall': 0.89164066, 'specificity': 0.89164066, 'f1': 0.9289338, 'auroc': 0.9965694, 'binary_precision': 0.95725805, 'binary_recall': 0.78453404, 'binary_specificity': 0.99874735, 'binary_f1_score': 0.862332}
confusion matrix:
       0     1
0  42258    53
1    326  1187
---- Validation: 
scalar performance:
{'acc': 0.986683, 'precision': 0.92464185, 'recall': 0.84776914, 'specificity': 0.84776914, 'f1': 0.8821022, 'auroc': 0.98528516, 'binary_precision': 0.85918367, 'binary_recall': 0.6993356, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.7710623}
confusion matrix:
       0    1
0  18102   69
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.93298185, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
better model found
persisted
after epoch: 12,now: 2024-05-31 11:36:15.033480,epoch time: 0:38:06.196657,used: 7:38:29.365111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99274373, 'precision': 0.9598322, 'recall': 0.92868793, 'specificity': 0.92868793, 'f1': 0.94367135, 'auroc': 0.9980018, 'binary_precision': 0.9246624, 'binary_recall': 0.85988104, 'binary_specificity': 0.99749476, 'binary_f1_score': 0.8910959}
confusion matrix:
       0     1
0  42205   106
1    212  1301
---- Validation: 
scalar performance:
{'acc': 0.9859905, 'precision': 0.9067705, 'recall': 0.8562449, 'specificity': 0.8562449, 'f1': 0.8797078, 'auroc': 0.9801178, 'binary_precision': 0.82285714, 'binary_recall': 0.717608, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.7666371}
confusion matrix:
       0    1
0  18078   93
1    170  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.8809111, 'recall': 0.5081811, 'specificity': 0.5081811, 'f1': 0.50642407, 'auroc': 0.89965886, 'binary_precision': 0.8, 'binary_recall': 0.016528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.032388665}
confusion matrix:
      0  1
0  5996  1
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 1
val acc:0.9859905242919922, best validation acc: 0.9866830110549927, corresponding to test acc:                         0.9626542925834656 / 0.9632954001426697
after epoch: 13,now: 2024-05-31 12:14:11.298045,epoch time: 0:37:56.264565,used: 8:16:25.629676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99288064, 'precision': 0.98082423, 'recall': 0.9098991, 'specificity': 0.9098991, 'f1': 0.9423277, 'auroc': 0.9979607, 'binary_precision': 0.9680187, 'binary_recall': 0.8207672, 'binary_specificity': 0.999031, 'binary_f1_score': 0.8883322}
confusion matrix:
       0     1
0  42271    41
1    271  1241
---- Validation: 
scalar performance:
{'acc': 0.98657644, 'precision': 0.9309252, 'recall': 0.83888054, 'specificity': 0.83888054, 'f1': 0.8790082, 'auroc': 0.9798926, 'binary_precision': 0.87234044, 'binary_recall': 0.6810631, 'binary_specificity': 0.996698, 'binary_f1_score': 0.76492536}
confusion matrix:
       0    1
0  18111   60
1    192  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9096247, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993751.png
early stop counter: 2
val acc:0.9865764379501343, best validation acc: 0.9866830110549927, corresponding to test acc:                         0.9626542925834656 / 0.9632954001426697
after epoch: 14,now: 2024-05-31 12:52:29.632852,epoch time: 0:38:18.334807,used: 8:54:43.964483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_03_57_45_seed_2_20993751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99253833, 'precision': 0.97558296, 'recall': 0.9094624, 'specificity': 0.9094624, 'f1': 0.939867, 'auroc': 0.9982809, 'binary_precision': 0.95756173, 'binary_recall': 0.8202247, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.88358843}
confusion matrix:
       0     1
0  42256    55
1    272  1241
---- Validation: 
slurmstepd: error: *** JOB 20993751 ON gpusrv27 CANCELLED AT 2024-05-31T13:26:11 DUE TO TIME LIMIT ***
