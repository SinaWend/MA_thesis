Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 18:29:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing_test/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing_test/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954

 Experiment start at: 2024-06-19 18:37:49.607688
before training, model accuracy: 0.31563422083854675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.53328276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3271256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.29857647, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 18:50:45.212956,epoch time: 0:12:55.605268,used: 0:12:55.605268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.76130974, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37064946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.42674214, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 2,now: 2024-06-19 19:03:02.216633,epoch time: 0:12:17.003677,used: 0:25:12.608945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90866864, 'precision': 0.924515, 'recall': 0.51777536, 'specificity': 0.51777536, 'f1': 0.5104647, 'auroc': 0.8797666, 'binary_precision': 0.9404762, 'binary_recall': 0.03578709, 'binary_specificity': 0.9997636, 'binary_f1_score': 0.06895047}
confusion matrix:
       0    1
0  42295   10
1   4257  158
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44371507, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.6099485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 3,now: 2024-06-19 19:17:42.669440,epoch time: 0:14:40.452807,used: 0:39:53.061752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9264769, 'precision': 0.9435118, 'recall': 0.6150569, 'specificity': 0.6150569, 'f1': 0.6667766, 'auroc': 0.9083756, 'binary_precision': 0.96135724, 'binary_recall': 0.23108292, 'binary_specificity': 0.9990309, 'binary_f1_score': 0.37260273}
confusion matrix:
       0     1
0  42265    41
1   3394  1020
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.49231717, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8853982, 'precision': 0.94264835, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4771841, 'auroc': 0.6735481, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   777  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_4.png
new oracle model saved
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8853982090950012
after epoch: 4,now: 2024-06-19 19:30:33.721437,epoch time: 0:12:51.051997,used: 0:52:44.113749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9395334, 'precision': 0.9419807, 'recall': 0.69010967, 'specificity': 0.69010967, 'f1': 0.7560961, 'auroc': 0.91566926, 'binary_precision': 0.94463086, 'binary_recall': 0.38255945, 'binary_specificity': 0.99765986, 'binary_f1_score': 0.5445752}
confusion matrix:
       0     1
0  42206    99
1   2726  1689
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.4828716, 'recall': 0.4993939, 'specificity': 0.4993939, 'f1': 0.49099383, 'auroc': 0.496324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18127  22
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.889823, 'precision': 0.88246435, 'recall': 0.5263197, 'specificity': 0.5263197, 'f1': 0.52119905, 'auroc': 0.69012105, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5991   6
1   741  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_5.png
new oracle model saved
early stop counter: 4
val acc:0.964612603187561, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8898230195045471
after epoch: 5,now: 2024-06-19 19:41:44.958678,epoch time: 0:11:11.237241,used: 1:03:55.350990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94796664, 'precision': 0.94497925, 'recall': 0.7379761, 'specificity': 0.7379761, 'f1': 0.80351305, 'auroc': 0.93151194, 'binary_precision': 0.9416741, 'binary_recall': 0.4790487, 'binary_specificity': 0.9969034, 'binary_f1_score': 0.6350398}
confusion matrix:
       0     1
0  42174   131
1   2300  2115
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.5178161, 'recall': 0.50123084, 'specificity': 0.50123084, 'f1': 0.49515855, 'auroc': 0.5411744, 'binary_precision': 0.069767445, 'binary_recall': 0.00466563, 'binary_specificity': 0.997796, 'binary_f1_score': 0.008746356}
confusion matrix:
       0   1
0  18109  40
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8955752, 'precision': 0.867187, 'recall': 0.55788624, 'specificity': 0.55788624, 'f1': 0.576078, 'auroc': 0.73371935, 'binary_precision': 0.8378378, 'binary_recall': 0.118773945, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20805368}
confusion matrix:
      0   1
0  5979  18
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_6.png
new oracle model saved
early stop counter: 5
val acc:0.963814377784729, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.895575225353241
after epoch: 6,now: 2024-06-19 19:53:11.817437,epoch time: 0:11:26.858759,used: 1:15:22.209749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95648545, 'precision': 0.9463949, 'recall': 0.78776944, 'specificity': 0.78776944, 'f1': 0.84607184, 'auroc': 0.94635713, 'binary_precision': 0.9349653, 'binary_recall': 0.57974625, 'binary_specificity': 0.99579257, 'binary_f1_score': 0.715704}
confusion matrix:
       0     1
0  42128   178
1   1855  2559
---- Validation: 
scalar performance:
{'acc': 0.9616326, 'precision': 0.5210381, 'recall': 0.5031015, 'specificity': 0.5031015, 'f1': 0.49974063, 'auroc': 0.5836146, 'binary_precision': 0.07608695, 'binary_recall': 0.01088647, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.01904762}
confusion matrix:
       0   1
0  18064  85
1    636   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9061947, 'precision': 0.8720834, 'recall': 0.61385673, 'specificity': 0.61385673, 'f1': 0.6573122, 'auroc': 0.76478136, 'binary_precision': 0.8356164, 'binary_recall': 0.23371647, 'binary_specificity': 0.993997, 'binary_f1_score': 0.36526945}
confusion matrix:
      0    1
0  5961   36
1   600  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_7.png
new oracle model saved
early stop counter: 6
val acc:0.9616326093673706, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9061946868896484
after epoch: 7,now: 2024-06-19 20:07:55.701455,epoch time: 0:14:43.884018,used: 1:30:06.093767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95646405, 'precision': 0.93687475, 'recall': 0.7943162, 'specificity': 0.7943162, 'f1': 0.84846044, 'auroc': 0.9454651, 'binary_precision': 0.9145448, 'binary_recall': 0.59442306, 'binary_specificity': 0.9942093, 'binary_f1_score': 0.72052765}
confusion matrix:
       0     1
0  42064   245
1   1789  2622
---- Validation: 
scalar performance:
{'acc': 0.96099406, 'precision': 0.53574, 'recall': 0.5065212, 'specificity': 0.5065212, 'f1': 0.5059001, 'auroc': 0.6146121, 'binary_precision': 0.10526316, 'binary_recall': 0.01866252, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.031704094}
confusion matrix:
       0    1
0  18047  102
1    631   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91253686, 'precision': 0.8752277, 'recall': 0.6474224, 'specificity': 0.6474224, 'f1': 0.69838476, 'auroc': 0.7889615, 'binary_precision': 0.83450705, 'binary_recall': 0.30268198, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.44423616}
confusion matrix:
      0    1
0  5950   47
1   546  237
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_8.png
new oracle model saved
early stop counter: 7
val acc:0.9609940648078918, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9125368595123291
after epoch: 8,now: 2024-06-19 20:23:03.610693,epoch time: 0:15:07.909238,used: 1:45:14.003005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9592252, 'precision': 0.9377252, 'recall': 0.81091, 'specificity': 0.81091, 'f1': 0.86101973, 'auroc': 0.9537368, 'binary_precision': 0.9130148, 'binary_recall': 0.62805986, 'binary_specificity': 0.99376005, 'binary_f1_score': 0.7441923}
confusion matrix:
       0     1
0  42044   264
1   1641  2771
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.5620329, 'recall': 0.51574844, 'specificity': 0.51574844, 'f1': 0.52094966, 'auroc': 0.6255263, 'binary_precision': 0.1572327, 'binary_recall': 0.038880248, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.06234414}
confusion matrix:
       0    1
0  18015  134
1    618   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91681415, 'precision': 0.8750938, 'recall': 0.6714928, 'specificity': 0.6714928, 'f1': 0.72465026, 'auroc': 0.80153805, 'binary_precision': 0.8288288, 'binary_recall': 0.35249043, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.49462366}
confusion matrix:
      0    1
0  5940   57
1   507  276
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_9.png
new oracle model saved
early stop counter: 8
val acc:0.9599829912185669, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9168141484260559
after epoch: 9,now: 2024-06-19 20:38:01.131341,epoch time: 0:14:57.520648,used: 2:00:11.523653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9602312, 'precision': 0.925048, 'recall': 0.8283679, 'specificity': 0.8283679, 'f1': 0.8689492, 'auroc': 0.95130527, 'binary_precision': 0.8840361, 'binary_recall': 0.66583484, 'binary_specificity': 0.99090093, 'binary_f1_score': 0.75957555}
confusion matrix:
       0     1
0  41927   385
1   1473  2935
---- Validation: 
scalar performance:
{'acc': 0.959238, 'precision': 0.5759879, 'recall': 0.5236134, 'specificity': 0.5236134, 'f1': 0.5325365, 'auroc': 0.6439422, 'binary_precision': 0.18461539, 'binary_recall': 0.05598756, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.08591886}
confusion matrix:
       0    1
0  17990  159
1    607   36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91932154, 'precision': 0.86740744, 'recall': 0.6912316, 'specificity': 0.6912316, 'f1': 0.74317074, 'auroc': 0.8102659, 'binary_precision': 0.80890054, 'binary_recall': 0.394636, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.53047216}
confusion matrix:
      0    1
0  5924   73
1   474  309
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_10.png
new oracle model saved
early stop counter: 9
val acc:0.9592379927635193, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9193215370178223
after epoch: 10,now: 2024-06-19 20:51:18.598933,epoch time: 0:13:17.467592,used: 2:13:28.991245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9602098, 'precision': 0.9275371, 'recall': 0.8260709, 'specificity': 0.8260709, 'f1': 0.8682735, 'auroc': 0.9545362, 'binary_precision': 0.8895331, 'binary_recall': 0.6606981, 'binary_specificity': 0.9914437, 'binary_f1_score': 0.75822604}
confusion matrix:
       0     1
0  41946   362
1   1497  2915
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.5924101, 'recall': 0.5332263, 'specificity': 0.5332263, 'f1': 0.5458869, 'auroc': 0.6630751, 'binary_precision': 0.21681416, 'binary_recall': 0.07620529, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.112773314}
confusion matrix:
       0    1
0  17972  177
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219764, 'precision': 0.8687933, 'recall': 0.7060571, 'specificity': 0.7060571, 'f1': 0.7572701, 'auroc': 0.8225466, 'binary_precision': 0.80825245, 'binary_recall': 0.42528737, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.5573222}
confusion matrix:
      0    1
0  5918   79
1   450  333
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_11.png
new oracle model saved
early stop counter: 10
val acc:0.9589719176292419, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9219763875007629
after epoch: 11,now: 2024-06-19 21:03:45.380274,epoch time: 0:12:26.781341,used: 2:25:55.772586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9652611, 'precision': 0.92912924, 'recall': 0.85768855, 'specificity': 0.85768855, 'f1': 0.8893279, 'auroc': 0.96248394, 'binary_precision': 0.8863951, 'binary_recall': 0.725068, 'binary_specificity': 0.9903092, 'binary_f1_score': 0.7976561}
confusion matrix:
       0     1
0  41898   410
1   1213  3199
---- Validation: 
scalar performance:
{'acc': 0.9582269, 'precision': 0.6067734, 'recall': 0.5470917, 'specificity': 0.5470917, 'f1': 0.56312716, 'auroc': 0.67398906, 'binary_precision': 0.24460432, 'binary_recall': 0.10575428, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.14766559}
confusion matrix:
       0    1
0  17939  210
1    575   68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9264012, 'precision': 0.871832, 'recall': 0.7302109, 'specificity': 0.7302109, 'f1': 0.7790194, 'auroc': 0.82448244, 'binary_precision': 0.8086957, 'binary_recall': 0.47509578, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5985519}
confusion matrix:
      0    1
0  5909   88
1   411  372
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_12.png
new oracle model saved
early stop counter: 11
val acc:0.9582269191741943, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9264011979103088
after epoch: 12,now: 2024-06-19 21:22:43.547967,epoch time: 0:18:58.167693,used: 2:44:53.940279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96397686, 'precision': 0.9163151, 'recall': 0.8635055, 'specificity': 0.8635055, 'f1': 0.88764215, 'auroc': 0.9606879, 'binary_precision': 0.8593997, 'binary_recall': 0.7396329, 'binary_specificity': 0.987378, 'binary_f1_score': 0.795031}
confusion matrix:
       0     1
0  41773   534
1   1149  3264
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.60888135, 'recall': 0.5534565, 'specificity': 0.5534565, 'f1': 0.5698914, 'auroc': 0.6826065, 'binary_precision': 0.2483871, 'binary_recall': 0.11975116, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.16159496}
confusion matrix:
       0    1
0  17916  233
1    566   77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9249263, 'precision': 0.85003465, 'recall': 0.74436736, 'specificity': 0.74436736, 'f1': 0.7845088, 'auroc': 0.8284966, 'binary_precision': 0.7614504, 'binary_recall': 0.5095785, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.6105585}
confusion matrix:
      0    1
0  5872  125
1   384  399
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_13.png
early stop counter: 12
val acc:0.9574819207191467, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9264011979103088
after epoch: 13,now: 2024-06-19 21:39:13.059720,epoch time: 0:16:29.511753,used: 3:01:23.452032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96329194, 'precision': 0.90913, 'recall': 0.86763763, 'specificity': 0.86763763, 'f1': 0.88697135, 'auroc': 0.9618153, 'binary_precision': 0.8440531, 'binary_recall': 0.74971664, 'binary_specificity': 0.9855586, 'binary_f1_score': 0.7940929}
confusion matrix:
       0     1
0  41698   611
1   1104  3307
---- Validation: 
scalar performance:
{'acc': 0.95498085, 'precision': 0.59954476, 'recall': 0.55891216, 'specificity': 0.55891216, 'f1': 0.57291126, 'auroc': 0.69726235, 'binary_precision': 0.22933333, 'binary_recall': 0.13374805, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.16895872}
confusion matrix:
       0    1
0  17860  289
1    557   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92876107, 'precision': 0.85596114, 'recall': 0.763191, 'specificity': 0.763191, 'f1': 0.80014616, 'auroc': 0.84289205, 'binary_precision': 0.7688172, 'binary_recall': 0.54789275, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.639821}
confusion matrix:
      0    1
0  5868  129
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_14.png
new oracle model saved
early stop counter: 13
val acc:0.9549808502197266, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9287610650062561
after epoch: 14,now: 2024-06-19 21:54:22.848802,epoch time: 0:15:09.789082,used: 3:16:33.241114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9665882, 'precision': 0.9253201, 'recall': 0.8708333, 'specificity': 0.8708333, 'f1': 0.89571804, 'auroc': 0.9664649, 'binary_precision': 0.8760548, 'binary_recall': 0.7527759, 'binary_specificity': 0.9888907, 'binary_f1_score': 0.80975014}
confusion matrix:
       0     1
0  41837   470
1   1091  3322
---- Validation: 
scalar performance:
{'acc': 0.9563644, 'precision': 0.61852753, 'recall': 0.5708793, 'specificity': 0.5708793, 'f1': 0.587612, 'auroc': 0.7095746, 'binary_precision': 0.26649076, 'binary_recall': 0.15707621, 'binary_specificity': 0.9846824, 'binary_f1_score': 0.19765167}
confusion matrix:
       0    1
0  17871  278
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318584, 'precision': 0.8710896, 'recall': 0.7649419, 'specificity': 0.7649419, 'f1': 0.8061274, 'auroc': 0.8459747, 'binary_precision': 0.79888266, 'binary_recall': 0.54789275, 'binary_specificity': 0.981991, 'binary_f1_score': 0.65000004}
confusion matrix:
      0    1
0  5889  108
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_15.png
new oracle model saved
early stop counter: 14
val acc:0.9563643932342529, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 15,now: 2024-06-19 22:12:48.050804,epoch time: 0:18:25.202002,used: 3:34:58.443116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659247, 'precision': 0.9185202, 'recall': 0.87445164, 'specificity': 0.87445164, 'f1': 0.89492977, 'auroc': 0.965955, 'binary_precision': 0.86160946, 'binary_recall': 0.76166743, 'binary_specificity': 0.98723584, 'binary_f1_score': 0.80856174}
confusion matrix:
       0     1
0  41766   540
1   1052  3362
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.6115388, 'recall': 0.5716906, 'specificity': 0.5716906, 'f1': 0.586437, 'auroc': 0.70465946, 'binary_precision': 0.25245097, 'binary_recall': 0.16018662, 'binary_specificity': 0.98319465, 'binary_f1_score': 0.1960038}
confusion matrix:
       0    1
0  17844  305
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9277286, 'precision': 0.8511665, 'recall': 0.76260734, 'specificity': 0.76260734, 'f1': 0.798187, 'auroc': 0.8428812, 'binary_precision': 0.759292, 'binary_recall': 0.54789275, 'binary_specificity': 0.977322, 'binary_f1_score': 0.6364986}
confusion matrix:
      0    1
0  5861  136
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_16.png
early stop counter: 15
val acc:0.955034077167511, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 16,now: 2024-06-19 22:30:13.560354,epoch time: 0:17:25.509550,used: 3:52:23.952666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9651969, 'precision': 0.91195166, 'recall': 0.87782955, 'specificity': 0.87782955, 'f1': 0.8939498, 'auroc': 0.96713054, 'binary_precision': 0.8476689, 'binary_recall': 0.7701019, 'binary_specificity': 0.98555726, 'binary_f1_score': 0.80702585}
confusion matrix:
       0     1
0  41694   611
1   1015  3400
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.61777204, 'recall': 0.57151914, 'specificity': 0.57151914, 'f1': 0.5879514, 'auroc': 0.7086868, 'binary_precision': 0.26493508, 'binary_recall': 0.15863141, 'binary_specificity': 0.9844068, 'binary_f1_score': 0.19844359}
confusion matrix:
       0    1
0  17866  283
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93156344, 'precision': 0.8695983, 'recall': 0.76477516, 'specificity': 0.76477516, 'f1': 0.805551, 'auroc': 0.8466685, 'binary_precision': 0.79591835, 'binary_recall': 0.54789275, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.6490167}
confusion matrix:
      0    1
0  5887  110
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510954_17.png
early stop counter: 16
val acc:0.95615154504776, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 17,now: 2024-06-19 22:50:38.332935,epoch time: 0:20:24.772581,used: 4:12:48.725247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510954
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21510954 ON gpusrv48 CANCELLED AT 2024-06-19T22:52:11 ***
