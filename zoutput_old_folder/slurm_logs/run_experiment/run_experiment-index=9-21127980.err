Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980

 Experiment start at: 2024-06-05 22:52:25.018656
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9647881, 'precision': 0.52976334, 'recall': 0.5017958, 'specificity': 0.5017958, 'f1': 0.49617237, 'auroc': 0.6321542, 'binary_precision': 0.093023255, 'binary_recall': 0.0054347827, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.010269577}
confusion matrix:
       0   1
0  42242  78
1   1464   8
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.4953818, 'recall': 0.49970317, 'specificity': 0.49970317, 'f1': 0.49223673, 'auroc': 0.5435913, 'binary_precision': 0.025, 'binary_recall': 0.00155521, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.0029282577}
confusion matrix:
       0   1
0  18110  39
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.5391035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:14:05.063023,epoch time: 0:21:40.044367,used: 0:21:40.044367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9658842, 'precision': 0.6548694, 'recall': 0.5076087, 'specificity': 0.5076087, 'f1': 0.50688237, 'auroc': 0.720657, 'binary_precision': 0.34285715, 'binary_recall': 0.016304348, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.031128405}
confusion matrix:
       0   1
0  42274  46
1   1448  24
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.55795336, 'recall': 0.5018645, 'specificity': 0.5018645, 'f1': 0.49562752, 'auroc': 0.6638373, 'binary_precision': 0.15, 'binary_recall': 0.00466563, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.009049774}
confusion matrix:
       0   1
0  18132  17
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.67538, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 23:34:12.286952,epoch time: 0:20:07.223929,used: 0:41:47.268296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.6777222, 'recall': 0.50224936, 'specificity': 0.50224936, 'f1': 0.49613503, 'auroc': 0.80718243, 'binary_precision': 0.3888889, 'binary_recall': 0.0047586677, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.0094022835}
confusion matrix:
       0   1
0  42310  11
1   1464   7
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.56624615, 'recall': 0.50063986, 'specificity': 0.50063986, 'f1': 0.4927822, 'auroc': 0.7918658, 'binary_precision': 0.16666667, 'binary_recall': 0.00155521, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0030816644}
confusion matrix:
       0  1
0  18144  5
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6042133, 'recall': 0.5016656, 'specificity': 0.5016656, 'f1': 0.49303976, 'auroc': 0.7380774, 'binary_precision': 0.25, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0075471695}
confusion matrix:
      0  1
0  5994  3
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 23:54:25.103796,epoch time: 0:20:12.816844,used: 1:02:00.085140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.649973, 'recall': 0.5034765, 'specificity': 0.5034765, 'f1': 0.49869478, 'auroc': 0.83412385, 'binary_precision': 0.33333334, 'binary_recall': 0.007472826, 'binary_specificity': 0.9994801, 'binary_f1_score': 0.014617941}
confusion matrix:
       0   1
0  42298  22
1   1461  11
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.5829358, 'recall': 0.50133485, 'specificity': 0.50133485, 'f1': 0.49427614, 'auroc': 0.8355744, 'binary_precision': 0.2, 'binary_recall': 0.00311042, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0061255745}
confusion matrix:
       0  1
0  18141  8
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.81672764, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_4.png
new oracle model saved
early stop counter: 1
val acc:0.9654640555381775, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9579737782478333 / 0.9587727785110474
after epoch: 4,now: 2024-06-06 00:14:35.975976,epoch time: 0:20:10.872180,used: 1:22:10.957320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.6976053, 'recall': 0.50388706, 'specificity': 0.50388706, 'f1': 0.49942696, 'auroc': 0.86681616, 'binary_precision': 0.42857143, 'binary_recall': 0.008152174, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.015999999}
confusion matrix:
       0   1
0  42304  16
1   1460  12
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6079376, 'recall': 0.5013899, 'specificity': 0.5013899, 'f1': 0.4943131, 'auroc': 0.8533881, 'binary_precision': 0.25, 'binary_recall': 0.00311042, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0061443937}
confusion matrix:
       0  1
0  18143  6
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.84853923, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_5.png
early stop counter: 2
val acc:0.9655704498291016, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9579737782478333 / 0.9587727785110474
after epoch: 5,now: 2024-06-06 00:34:50.145549,epoch time: 0:20:14.169573,used: 1:42:25.126893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.73344994, 'recall': 0.50754607, 'specificity': 0.50754607, 'f1': 0.5066158, 'auroc': 0.8777789, 'binary_precision': 0.5, 'binary_recall': 0.015635623, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.030323008}
confusion matrix:
       0   1
0  42298  23
1   1448  23
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73296607, 'recall': 0.5022502, 'specificity': 0.5022502, 'f1': 0.495918, 'auroc': 0.87021965, 'binary_precision': 0.5, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.009244992}
confusion matrix:
       0  1
0  18146  3
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.8622677, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-06 00:55:02.821226,epoch time: 0:20:12.675677,used: 2:02:37.802570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9665921, 'precision': 0.80482817, 'recall': 0.50600016, 'specificity': 0.50600016, 'f1': 0.5035106, 'auroc': 0.884611, 'binary_precision': 0.64285713, 'binary_recall': 0.012236574, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.02401601}
confusion matrix:
       0   1
0  42311  10
1   1453  18
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.62579566, 'recall': 0.50141746, 'specificity': 0.50141746, 'f1': 0.4943316, 'auroc': 0.8738271, 'binary_precision': 0.2857143, 'binary_recall': 0.00311042, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0061538466}
confusion matrix:
       0  1
0  18144  5
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.8721328, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5995  2
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_7.png
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 7,now: 2024-06-06 01:15:06.912671,epoch time: 0:20:04.091445,used: 2:22:41.894015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.7256251, 'recall': 0.5192964, 'specificity': 0.5192964, 'f1': 0.5284314, 'auroc': 0.89084375, 'binary_precision': 0.48360655, 'binary_recall': 0.040081523, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.074027605}
confusion matrix:
       0   1
0  42257  63
1   1413  59
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.71260136, 'recall': 0.51639104, 'specificity': 0.51639104, 'f1': 0.5230693, 'auroc': 0.88563967, 'binary_precision': 0.45833334, 'binary_recall': 0.03421462, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.063675836}
confusion matrix:
       0   1
0  18123  26
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.91878814, 'recall': 0.55330634, 'specificity': 0.55330634, 'f1': 0.5858683, 'auroc': 0.8768749, 'binary_precision': 0.875, 'binary_recall': 0.107279696, 'binary_specificity': 0.999333, 'binary_f1_score': 0.19112627}
confusion matrix:
      0   1
0  5993   4
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_8.png
new oracle model saved
early stop counter: 2
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9621284604072571
after epoch: 8,now: 2024-06-06 01:35:14.855766,epoch time: 0:20:07.943095,used: 2:42:49.837110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7336658, 'recall': 0.5131514, 'specificity': 0.5131514, 'f1': 0.5173085, 'auroc': 0.89711016, 'binary_precision': 0.5, 'binary_recall': 0.027247956, 'binary_specificity': 0.9990549, 'binary_f1_score': 0.051679585}
confusion matrix:
       0   1
0  42284  40
1   1428  40
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.6783669, 'recall': 0.51689315, 'specificity': 0.51689315, 'f1': 0.5238703, 'auroc': 0.8936832, 'binary_precision': 0.3898305, 'binary_recall': 0.035769828, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.06552707}
confusion matrix:
       0   1
0  18113  36
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.85129416, 'recall': 0.5641336, 'specificity': 0.5641336, 'f1': 0.6009613, 'auroc': 0.8880098, 'binary_precision': 0.73913044, 'binary_recall': 0.1302682, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22149837}
confusion matrix:
      0   1
0  5985  12
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_9.png
early stop counter: 3
val acc:0.9650915265083313, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9621284604072571
after epoch: 9,now: 2024-06-06 01:55:23.259004,epoch time: 0:20:08.403238,used: 3:02:58.240348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7275846, 'recall': 0.53014654, 'specificity': 0.53014654, 'f1': 0.546872, 'auroc': 0.90411353, 'binary_precision': 0.48677248, 'binary_recall': 0.06258503, 'binary_specificity': 0.997708, 'binary_f1_score': 0.11091018}
confusion matrix:
       0   1
0  42225  97
1   1378  92
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.69402754, 'recall': 0.52736634, 'specificity': 0.52736634, 'f1': 0.5417018, 'auroc': 0.89483064, 'binary_precision': 0.42045453, 'binary_recall': 0.057542767, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.10123119}
confusion matrix:
       0   1
0  18098  51
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.887772, 'recall': 0.6042801, 'specificity': 0.6042801, 'f1': 0.6581883, 'auroc': 0.8847401, 'binary_precision': 0.8088235, 'binary_recall': 0.21072797, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3343465}
confusion matrix:
      0   1
0  5984  13
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_10.png
new oracle model saved
early stop counter: 4
val acc:0.9650382995605469, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9650048017501831
after epoch: 10,now: 2024-06-06 02:15:32.679216,epoch time: 0:20:09.420212,used: 3:23:07.660560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9660212, 'precision': 0.71458507, 'recall': 0.53062975, 'specificity': 0.53062975, 'f1': 0.5474255, 'auroc': 0.9025104, 'binary_precision': 0.46078432, 'binary_recall': 0.063858695, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.112171836}
confusion matrix:
       0    1
0  42210  110
1   1378   94
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7033398, 'recall': 0.53192174, 'specificity': 0.53192174, 'f1': 0.54914063, 'auroc': 0.8972584, 'binary_precision': 0.4387755, 'binary_recall': 0.06687403, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.11605937}
confusion matrix:
       0   1
0  18094  55
1    600  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8996485, 'recall': 0.6215215, 'specificity': 0.6215215, 'f1': 0.680727, 'auroc': 0.887609, 'binary_precision': 0.83116883, 'binary_recall': 0.24521072, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.37869823}
confusion matrix:
      0   1
0  5984  13
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_11.png
new oracle model saved
early stop counter: 5
val acc:0.9651447534561157, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9664429426193237
after epoch: 11,now: 2024-06-06 02:35:39.262496,epoch time: 0:20:06.583280,used: 3:43:14.243840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96627235, 'precision': 0.7311976, 'recall': 0.5537098, 'specificity': 0.5537098, 'f1': 0.5822494, 'auroc': 0.9035991, 'binary_precision': 0.4924925, 'binary_recall': 0.11141305, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.18171746}
confusion matrix:
       0    1
0  42151  169
1   1308  164
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.71448857, 'recall': 0.5625914, 'specificity': 0.5625914, 'f1': 0.59274447, 'auroc': 0.90108, 'binary_precision': 0.45901638, 'binary_recall': 0.13063763, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.20338982}
confusion matrix:
       0   1
0  18050  99
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9015888, 'recall': 0.64242756, 'specificity': 0.64242756, 'f1': 0.7054138, 'auroc': 0.8900638, 'binary_precision': 0.8333333, 'binary_recall': 0.28735632, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.42735043}
confusion matrix:
      0   1
0  5982  15
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_12.png
new oracle model saved
early stop counter: 6
val acc:0.9649850726127625, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 12,now: 2024-06-06 02:55:42.314829,epoch time: 0:20:03.052333,used: 4:03:17.296173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96627235, 'precision': 0.7315184, 'recall': 0.5569884, 'specificity': 0.5569884, 'f1': 0.58673114, 'auroc': 0.9117633, 'binary_precision': 0.49291784, 'binary_recall': 0.11820652, 'binary_specificity': 0.99577034, 'binary_f1_score': 0.19068494}
confusion matrix:
       0    1
0  42141  179
1   1298  174
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7286713, 'recall': 0.5696174, 'specificity': 0.5696174, 'f1': 0.6026945, 'auroc': 0.90751654, 'binary_precision': 0.486911, 'binary_recall': 0.14463453, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2230216}
confusion matrix:
       0   1
0  18051  98
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.89567965, 'recall': 0.6480079, 'specificity': 0.6480079, 'f1': 0.7108774, 'auroc': 0.88294417, 'binary_precision': 0.8210526, 'binary_recall': 0.29885057, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.43820223}
confusion matrix:
      0   1
0  5980  17
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_13.png
new oracle model saved
early stop counter: 7
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9680408835411072
after epoch: 13,now: 2024-06-06 03:15:43.714895,epoch time: 0:20:01.400066,used: 4:23:18.696239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.965359, 'precision': 0.7061841, 'recall': 0.55720043, 'specificity': 0.55720043, 'f1': 0.5853189, 'auroc': 0.90730464, 'binary_precision': 0.44221106, 'binary_recall': 0.1196465, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.188336}
confusion matrix:
       0    1
0  42099  222
1   1295  176
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7164658, 'recall': 0.5730646, 'specificity': 0.5730646, 'f1': 0.6056488, 'auroc': 0.912131, 'binary_precision': 0.46226415, 'binary_recall': 0.15241058, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.22923978}
confusion matrix:
       0    1
0  18035  114
1    545   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8841344, 'recall': 0.6969826, 'specificity': 0.6969826, 'f1': 0.7577179, 'auroc': 0.89690316, 'binary_precision': 0.79389316, 'binary_recall': 0.39846742, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.53061223}
confusion matrix:
      0    1
0  5970   27
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_14.png
new oracle model saved
early stop counter: 8
val acc:0.9649319052696228, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9705976247787476
after epoch: 14,now: 2024-06-06 03:35:49.588202,epoch time: 0:20:05.873307,used: 4:43:24.569546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.73079675, 'recall': 0.5425744, 'specificity': 0.5425744, 'f1': 0.5662882, 'auroc': 0.90446794, 'binary_precision': 0.49242425, 'binary_recall': 0.08831522, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.14976957}
confusion matrix:
       0    1
0  42186  134
1   1342  130
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.6951733, 'recall': 0.56065047, 'specificity': 0.56065047, 'f1': 0.588681, 'auroc': 0.90623534, 'binary_precision': 0.42051283, 'binary_recall': 0.12752722, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.19570407}
confusion matrix:
       0    1
0  18036  113
1    561   82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.9272876, 'recall': 0.6714133, 'specificity': 0.6714133, 'f1': 0.74040484, 'auroc': 0.9158257, 'binary_precision': 0.88235295, 'binary_recall': 0.3448276, 'binary_specificity': 0.997999, 'binary_f1_score': 0.4958678}
confusion matrix:
      0   1
0  5985  12
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_15.png
new oracle model saved
early stop counter: 9
val acc:0.9641336798667908, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9707574248313904
after epoch: 15,now: 2024-06-06 03:55:53.834398,epoch time: 0:20:04.246196,used: 5:03:28.815742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.7458761, 'recall': 0.633418, 'specificity': 0.633418, 'f1': 0.67133176, 'auroc': 0.91016686, 'binary_precision': 0.51653945, 'binary_recall': 0.27581522, 'binary_specificity': 0.9910208, 'binary_f1_score': 0.35961026}
confusion matrix:
       0    1
0  41940  380
1   1066  406
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7292233, 'recall': 0.64662516, 'specificity': 0.64662516, 'f1': 0.6778532, 'auroc': 0.9111843, 'binary_precision': 0.4827586, 'binary_recall': 0.30482116, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.37368923}
confusion matrix:
       0    1
0  17939  210
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.8947039, 'recall': 0.73704576, 'specificity': 0.73704576, 'f1': 0.7943872, 'auroc': 0.884941, 'binary_precision': 0.8116883, 'binary_recall': 0.4789272, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.6024096}
confusion matrix:
      0    1
0  5968   29
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_16.png
new oracle model saved
early stop counter: 10
val acc:0.9650382995605469, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9736337661743164
after epoch: 16,now: 2024-06-06 04:15:57.023088,epoch time: 0:20:03.188690,used: 5:23:32.004432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7437535, 'recall': 0.6234995, 'specificity': 0.6234995, 'f1': 0.6620124, 'auroc': 0.9183123, 'binary_precision': 0.51296043, 'binary_recall': 0.25543478, 'binary_specificity': 0.9915643, 'binary_f1_score': 0.34104308}
confusion matrix:
       0    1
0  41963  357
1   1096  376
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.73483926, 'recall': 0.62442654, 'specificity': 0.62442654, 'f1': 0.6609105, 'auroc': 0.9142121, 'binary_precision': 0.49552238, 'binary_recall': 0.25816485, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.3394683}
confusion matrix:
       0    1
0  17980  169
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.9109721, 'recall': 0.7546206, 'specificity': 0.7546206, 'f1': 0.8127645, 'auroc': 0.8995762, 'binary_precision': 0.8427673, 'binary_recall': 0.51341, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6380952}
confusion matrix:
      0    1
0  5972   25
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_17.png
new oracle model saved
early stop counter: 11
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9757111072540283
after epoch: 17,now: 2024-06-06 04:36:08.864846,epoch time: 0:20:11.841758,used: 5:43:43.846190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7387756, 'recall': 0.6144819, 'specificity': 0.6144819, 'f1': 0.6526138, 'auroc': 0.91738915, 'binary_precision': 0.5036075, 'binary_recall': 0.23709239, 'binary_specificity': 0.9918715, 'binary_f1_score': 0.32240185}
confusion matrix:
       0    1
0  41976  344
1   1123  349
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.731547, 'recall': 0.62878907, 'specificity': 0.62878907, 'f1': 0.6639682, 'auroc': 0.9133451, 'binary_precision': 0.48863637, 'binary_recall': 0.2674961, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.34572864}
confusion matrix:
       0    1
0  17969  180
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.90808827, 'recall': 0.7621167, 'specificity': 0.7621167, 'f1': 0.8177402, 'auroc': 0.91097736, 'binary_precision': 0.8363636, 'binary_recall': 0.52873564, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.64788735}
confusion matrix:
      0    1
0  5970   27
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_18.png
new oracle model saved
early stop counter: 12
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.976030707359314
after epoch: 18,now: 2024-06-06 04:56:07.748069,epoch time: 0:19:58.883223,used: 6:03:42.729413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7307245, 'recall': 0.6222278, 'specificity': 0.6222278, 'f1': 0.6580868, 'auroc': 0.92253053, 'binary_precision': 0.48694518, 'binary_recall': 0.2537415, 'binary_specificity': 0.9907141, 'binary_f1_score': 0.33363152}
confusion matrix:
       0    1
0  41929  393
1   1097  373
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.72894424, 'recall': 0.63017905, 'specificity': 0.63017905, 'f1': 0.6645268, 'auroc': 0.91801214, 'binary_precision': 0.48333332, 'binary_recall': 0.27060652, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.34695908}
confusion matrix:
       0    1
0  17963  186
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.9058808, 'recall': 0.7791079, 'specificity': 0.7791079, 'f1': 0.8296552, 'auroc': 0.9040631, 'binary_precision': 0.8305085, 'binary_recall': 0.5632184, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.67123294}
confusion matrix:
      0    1
0  5967   30
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_19.png
new oracle model saved
early stop counter: 13
val acc:0.9651447534561157, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9769894480705261
after epoch: 19,now: 2024-06-06 05:16:07.081639,epoch time: 0:19:59.333570,used: 6:23:42.062983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7379981, 'recall': 0.64468783, 'specificity': 0.64468783, 'f1': 0.6787908, 'auroc': 0.91795945, 'binary_precision': 0.5, 'binary_recall': 0.29979604, 'binary_specificity': 0.9895796, 'binary_f1_score': 0.37484062}
confusion matrix:
       0    1
0  41880  441
1   1030  441
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7338209, 'recall': 0.66179156, 'specificity': 0.66179156, 'f1': 0.6905284, 'auroc': 0.91590303, 'binary_precision': 0.4909091, 'binary_recall': 0.33592534, 'binary_specificity': 0.9876577, 'binary_f1_score': 0.398892}
confusion matrix:
       0    1
0  17925  224
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.89776385, 'recall': 0.77502644, 'specificity': 0.77502644, 'f1': 0.8241274, 'auroc': 0.91080475, 'binary_precision': 0.8146067, 'binary_recall': 0.5555556, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6605923}
confusion matrix:
      0    1
0  5964   33
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_20.png
early stop counter: 14
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9769894480705261
after epoch: 20,now: 2024-06-06 05:36:05.974384,epoch time: 0:19:58.892745,used: 6:43:40.955728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.966044, 'precision': 0.7347209, 'recall': 0.65981805, 'specificity': 0.65981805, 'f1': 0.6893977, 'auroc': 0.9209494, 'binary_precision': 0.49243188, 'binary_recall': 0.33152175, 'binary_specificity': 0.98811436, 'binary_f1_score': 0.39626473}
confusion matrix:
       0    1
0  41817  503
1    984  488
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7345995, 'recall': 0.66556937, 'specificity': 0.66556937, 'f1': 0.6934749, 'auroc': 0.9202162, 'binary_precision': 0.4922049, 'binary_recall': 0.3437014, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.4047619}
confusion matrix:
       0    1
0  17921  228
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.8787646, 'recall': 0.7875192, 'specificity': 0.7875192, 'f1': 0.8262601, 'auroc': 0.9085711, 'binary_precision': 0.7755102, 'binary_recall': 0.58237547, 'binary_specificity': 0.992663, 'binary_f1_score': 0.66520786}
confusion matrix:
      0    1
0  5953   44
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_21.png
early stop counter: 15
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9769894480705261
after epoch: 21,now: 2024-06-06 05:56:06.627216,epoch time: 0:20:00.652832,used: 7:03:41.608560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.73837274, 'recall': 0.6697188, 'specificity': 0.6697188, 'f1': 0.697654, 'auroc': 0.9195722, 'binary_precision': 0.49903476, 'binary_recall': 0.3517007, 'binary_specificity': 0.9877369, 'binary_f1_score': 0.41260976}
confusion matrix:
       0    1
0  41803  519
1    953  517
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7364893, 'recall': 0.6813756, 'specificity': 0.6813756, 'f1': 0.7048925, 'auroc': 0.92099714, 'binary_precision': 0.49488753, 'binary_recall': 0.3763608, 'binary_specificity': 0.9863904, 'binary_f1_score': 0.42756185}
confusion matrix:
       0    1
0  17902  247
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.89348155, 'recall': 0.7824391, 'specificity': 0.7824391, 'f1': 0.8279498, 'auroc': 0.91661733, 'binary_precision': 0.8054054, 'binary_recall': 0.57088125, 'binary_specificity': 0.993997, 'binary_f1_score': 0.66816145}
confusion matrix:
      0    1
0  5961   36
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_22.png
early stop counter: 16
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9595717191696167 / 0.9769894480705261
after epoch: 22,now: 2024-06-06 06:16:08.583116,epoch time: 0:20:01.955900,used: 7:23:43.564460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7392647, 'recall': 0.6885072, 'specificity': 0.6885072, 'f1': 0.71054596, 'auroc': 0.92426467, 'binary_precision': 0.4995656, 'binary_recall': 0.390625, 'binary_specificity': 0.9863894, 'binary_f1_score': 0.43842927}
confusion matrix:
       0    1
0  41744  576
1    897  575
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74161136, 'recall': 0.701125, 'specificity': 0.701125, 'f1': 0.7193098, 'auroc': 0.92282283, 'binary_precision': 0.5037594, 'binary_recall': 0.41679627, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.45617023}
confusion matrix:
       0    1
0  17885  264
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.8888824, 'recall': 0.80684304, 'specificity': 0.80684304, 'f1': 0.8425369, 'auroc': 0.916471, 'binary_precision': 0.7941176, 'binary_recall': 0.62068963, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.6967741}
confusion matrix:
      0    1
0  5955   42
1    99  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-06 06:36:08.312654,epoch time: 0:19:59.729538,used: 7:43:43.293998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7385224, 'recall': 0.6524663, 'specificity': 0.6524663, 'f1': 0.68503493, 'auroc': 0.9223689, 'binary_precision': 0.50053823, 'binary_recall': 0.31589675, 'binary_specificity': 0.9890359, 'binary_f1_score': 0.3873386}
confusion matrix:
       0    1
0  41856  464
1   1007  465
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.73906887, 'recall': 0.6657898, 'specificity': 0.6657898, 'f1': 0.69508004, 'auroc': 0.9187505, 'binary_precision': 0.5011338, 'binary_recall': 0.3437014, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.40774912}
confusion matrix:
       0    1
0  17929  220
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.8913454, 'recall': 0.7691125, 'specificity': 0.7691125, 'f1': 0.8178257, 'auroc': 0.91331637, 'binary_precision': 0.80225986, 'binary_recall': 0.5440613, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.64840186}
confusion matrix:
      0    1
0  5962   35
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_24.png
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9774688482284546 / 0.9774688482284546
after epoch: 24,now: 2024-06-06 06:56:12.604833,epoch time: 0:20:04.292179,used: 8:03:47.586177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96734565, 'precision': 0.7488364, 'recall': 0.69753957, 'specificity': 0.69753957, 'f1': 0.71992695, 'auroc': 0.9263071, 'binary_precision': 0.5181034, 'binary_recall': 0.40828803, 'binary_specificity': 0.98679113, 'binary_f1_score': 0.45668688}
confusion matrix:
       0    1
0  41761  559
1    871  601
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74544513, 'recall': 0.6983452, 'specificity': 0.6983452, 'f1': 0.719121, 'auroc': 0.9210526, 'binary_precision': 0.5116279, 'binary_recall': 0.41057542, 'binary_specificity': 0.9861149, 'binary_f1_score': 0.45556515}
confusion matrix:
       0    1
0  17897  252
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.89548886, 'recall': 0.7957657, 'specificity': 0.7957657, 'f1': 0.8377261, 'auroc': 0.91418123, 'binary_precision': 0.8082902, 'binary_recall': 0.59770113, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6872247}
confusion matrix:
      0    1
0  5960   37
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_25.png
better model found
persisted
after epoch: 25,now: 2024-06-06 07:16:17.549514,epoch time: 0:20:04.944681,used: 8:23:52.530858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.74376506, 'recall': 0.66559386, 'specificity': 0.66559386, 'f1': 0.6964386, 'auroc': 0.92810094, 'binary_precision': 0.51012146, 'binary_recall': 0.34262407, 'binary_specificity': 0.9885636, 'binary_f1_score': 0.40992275}
confusion matrix:
       0    1
0  41837  484
1    967  504
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73889196, 'recall': 0.67701304, 'specificity': 0.67701304, 'f1': 0.70284355, 'auroc': 0.92137253, 'binary_precision': 0.5, 'binary_recall': 0.36702955, 'binary_specificity': 0.98699653, 'binary_f1_score': 0.4233184}
confusion matrix:
       0    1
0  17913  236
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9008351, 'recall': 0.79976386, 'specificity': 0.79976386, 'f1': 0.8422972, 'auroc': 0.9244751, 'binary_precision': 0.81865287, 'binary_recall': 0.60536397, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6960352}
confusion matrix:
      0    1
0  5962   35
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_26.png
new oracle model saved
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9773090481758118 / 0.9779482483863831
after epoch: 26,now: 2024-06-06 07:36:10.986054,epoch time: 0:19:53.436540,used: 8:43:45.967398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.7437767, 'recall': 0.72019434, 'specificity': 0.72019434, 'f1': 0.73131955, 'auroc': 0.9284872, 'binary_precision': 0.50641507, 'binary_recall': 0.4558424, 'binary_specificity': 0.9845463, 'binary_f1_score': 0.47979978}
confusion matrix:
       0    1
0  41666  654
1    801  671
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.73671854, 'recall': 0.7217684, 'specificity': 0.7217684, 'f1': 0.72897124, 'auroc': 0.92166495, 'binary_precision': 0.49251246, 'binary_recall': 0.46034214, 'binary_specificity': 0.98319465, 'binary_f1_score': 0.4758842}
confusion matrix:
       0    1
0  17844  305
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.89141595, 'recall': 0.8088422, 'specificity': 0.8088422, 'f1': 0.84477043, 'auroc': 0.92156744, 'binary_precision': 0.79901963, 'binary_recall': 0.6245211, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.70107526}
confusion matrix:
      0    1
0  5956   41
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_27.png
early stop counter: 2
val acc:0.9653043746948242, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9773090481758118 / 0.9779482483863831
after epoch: 27,now: 2024-06-06 07:56:05.023350,epoch time: 0:19:54.037296,used: 9:03:40.004694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.966044, 'precision': 0.73516136, 'recall': 0.6757797, 'specificity': 0.6757797, 'f1': 0.7007123, 'auroc': 0.92816794, 'binary_precision': 0.49219468, 'binary_recall': 0.36462584, 'binary_specificity': 0.9869335, 'binary_f1_score': 0.41891363}
confusion matrix:
       0    1
0  41769  553
1    934  536
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73651946, 'recall': 0.70979506, 'specificity': 0.70979506, 'f1': 0.72226495, 'auroc': 0.9226286, 'binary_precision': 0.49295774, 'binary_recall': 0.43545878, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.46242777}
confusion matrix:
       0    1
0  17861  288
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.89222205, 'recall': 0.7918509, 'specificity': 0.7918509, 'f1': 0.83394575, 'auroc': 0.91201717, 'binary_precision': 0.8020833, 'binary_recall': 0.5900383, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.6799117}
confusion matrix:
      0    1
0  5959   38
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_28.png
early stop counter: 3
val acc:0.9653576016426086, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9773090481758118 / 0.9779482483863831
after epoch: 28,now: 2024-06-06 08:15:59.842395,epoch time: 0:19:54.819045,used: 9:23:34.823739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9672771, 'precision': 0.74805665, 'recall': 0.7230772, 'specificity': 0.7230772, 'f1': 0.734832, 'auroc': 0.9290607, 'binary_precision': 0.5147839, 'binary_recall': 0.4612772, 'binary_specificity': 0.9848771, 'binary_f1_score': 0.48656395}
confusion matrix:
       0    1
0  41680  640
1    793  679
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73768544, 'recall': 0.73304677, 'specificity': 0.73304677, 'f1': 0.7353406, 'auroc': 0.92647105, 'binary_precision': 0.4936508, 'binary_recall': 0.4836703, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.48860958}
confusion matrix:
       0    1
0  17830  319
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.89133394, 'recall': 0.82774913, 'specificity': 0.82774913, 'f1': 0.85644203, 'auroc': 0.91166914, 'binary_precision': 0.797235, 'binary_recall': 0.66283524, 'binary_specificity': 0.992663, 'binary_f1_score': 0.72384936}
confusion matrix:
      0    1
0  5953   44
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_29.png
new oracle model saved
early stop counter: 4
val acc:0.9653576016426086, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9773090481758118 / 0.9789069890975952
after epoch: 29,now: 2024-06-06 08:35:55.876749,epoch time: 0:19:56.034354,used: 9:43:30.858093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.7448927, 'recall': 0.6996219, 'specificity': 0.6996219, 'f1': 0.71970254, 'auroc': 0.92586213, 'binary_precision': 0.5100671, 'binary_recall': 0.41304347, 'binary_specificity': 0.9862004, 'binary_f1_score': 0.45645642}
confusion matrix:
       0    1
0  41736  584
1    864  608
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7441449, 'recall': 0.71101344, 'specificity': 0.71101344, 'f1': 0.72623813, 'auroc': 0.92367077, 'binary_precision': 0.5081374, 'binary_recall': 0.43701398, 'binary_specificity': 0.98501295, 'binary_f1_score': 0.46989965}
confusion matrix:
       0    1
0  17877  272
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.8875346, 'recall': 0.8086754, 'specificity': 0.8086754, 'f1': 0.8431853, 'auroc': 0.9152202, 'binary_precision': 0.79126215, 'binary_recall': 0.6245211, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.69807285}
confusion matrix:
      0    1
0  5954   43
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_30.png
early stop counter: 5
val acc:0.9662622213363647, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9773090481758118 / 0.9789069890975952
after epoch: 30,now: 2024-06-06 08:55:53.357580,epoch time: 0:19:57.480831,used: 10:03:28.338924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_24_seed_0_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:03:28.338924 at 2024-06-06 08:55:53.357580
persisted model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.88649887, 'recall': 0.79918027, 'specificity': 0.79918027, 'f1': 0.8367191, 'auroc': 0.9270144, 'binary_precision': 0.79, 'binary_recall': 0.60536397, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.68546635}
confusion matrix:
      0    1
0  5955   42
1   103  158
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.88541114, 'recall': 0.8199195, 'specificity': 0.8199195, 'f1': 0.8493111, 'auroc': 0.92238665, 'binary_precision': 0.7860465, 'binary_recall': 0.6475096, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.710084}
confusion matrix:
      0    1
0  5951   46
1    92  169
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1343 MiB |   1726 MiB | 593338 GiB | 593337 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590410 GiB | 590409 GiB |
|       from small pool |     10 MiB |     11 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137826 K  |  137822 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72931 K  |   72928 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137826 K  |  137822 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72931 K  |   72928 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2768    |   70708 K  |   70708 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      51    |    2747    |   38530 K  |   38530 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593339 GiB | 593339 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590410 GiB | 590410 GiB |
|       from small pool |      0 KiB |     24 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137826 K  |  137826 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72931 K  |   72931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137826 K  |  137826 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72931 K  |   72931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70709 K  |   70709 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38531 K  |   38531 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1826 MiB |  11226 MiB |  11226 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593339 GiB | 593339 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590410 GiB | 590410 GiB |
|       from small pool |      0 KiB |     24 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137826 K  |  137826 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72931 K  |   72931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137826 K  |  137826 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72931 K  |   72931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     232    |     232    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70709 K  |   70709 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38531 K  |   38531 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980

 Experiment start at: 2024-06-06 09:04:55.831650
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91045696, 'precision': 0.50360376, 'recall': 0.5065453, 'specificity': 0.5065453, 'f1': 0.5023442, 'auroc': 0.5227845, 'binary_precision': 0.039644312, 'binary_recall': 0.07420249, 'binary_specificity': 0.93888813, 'binary_f1_score': 0.051678333}
confusion matrix:
       0     1
0  39822  2592
1   1335   107
---- Validation: 
scalar performance:
{'acc': 0.826254, 'precision': 0.5098927, 'recall': 0.5372367, 'specificity': 0.5372367, 'f1': 0.49470136, 'auroc': 0.5115124, 'binary_precision': 0.05264981, 'binary_recall': 0.22585438, 'binary_specificity': 0.84861904, 'binary_f1_score': 0.085393265}
confusion matrix:
       0     1
0  15332  2735
1    521   152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233, 'precision': 0.480667, 'recall': 0.4836755, 'specificity': 0.4836755, 'f1': 0.48214903, 'auroc': 0.44107205, 'binary_precision': 0.0045871558, 'binary_recall': 0.0038461538, 'binary_specificity': 0.96350485, 'binary_f1_score': 0.004184101}
confusion matrix:
      0    1
0  5729  217
1   259    1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 09:25:56.115320,epoch time: 0:21:00.283670,used: 0:21:00.283670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95984584, 'precision': 0.5277322, 'recall': 0.50762784, 'specificity': 0.50762784, 'f1': 0.5083371, 'auroc': 0.64588296, 'binary_precision': 0.087855294, 'binary_recall': 0.023578363, 'binary_specificity': 0.9916773, 'binary_f1_score': 0.037178785}
confusion matrix:
       0    1
0  42061  353
1   1408   34
---- Validation: 
scalar performance:
{'acc': 0.94770545, 'precision': 0.5395568, 'recall': 0.5236909, 'specificity': 0.5236909, 'f1': 0.52859825, 'auroc': 0.5972615, 'binary_precision': 0.11335012, 'binary_recall': 0.06686478, 'binary_specificity': 0.98051697, 'binary_f1_score': 0.08411214}
confusion matrix:
       0    1
0  17715  352
1    628   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.478995, 'recall': 0.49857047, 'specificity': 0.49857047, 'f1': 0.48858672, 'auroc': 0.5682838, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5929  17
1   260   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 09:45:58.841527,epoch time: 0:20:02.726207,used: 0:41:03.009877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.7171903, 'recall': 0.5093315, 'specificity': 0.5093315, 'f1': 0.51025534, 'auroc': 0.7699933, 'binary_precision': 0.46666667, 'binary_recall': 0.019417476, 'binary_specificity': 0.9992455, 'binary_f1_score': 0.037283625}
confusion matrix:
       0   1
0  42382  32
1   1414  28
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74862474, 'recall': 0.5179647, 'specificity': 0.5179647, 'f1': 0.5256091, 'auroc': 0.7510247, 'binary_precision': 0.5319149, 'binary_recall': 0.0371471, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.06944444}
confusion matrix:
       0   1
0  18045  22
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.75865126, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 10:06:29.304167,epoch time: 0:20:30.462640,used: 1:01:33.472517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7336557, 'recall': 0.50301456, 'specificity': 0.50301456, 'f1': 0.49780515, 'auroc': 0.8150222, 'binary_precision': 0.5, 'binary_recall': 0.0062413313, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.012328767}
confusion matrix:
       0  1
0  42405  9
1   1433  9
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.6249943, 'recall': 0.502695, 'specificity': 0.502695, 'f1': 0.49659514, 'auroc': 0.79615426, 'binary_precision': 0.2857143, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.011644833}
confusion matrix:
       0   1
0  18057  10
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.8165101, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_4.png
new oracle model saved
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 4,now: 2024-06-06 10:26:52.440671,epoch time: 0:20:23.136504,used: 1:21:56.609021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.68362266, 'recall': 0.50197434, 'specificity': 0.50197434, 'f1': 0.49574172, 'auroc': 0.8385351, 'binary_precision': 0.4, 'binary_recall': 0.0041608876, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.008236102}
confusion matrix:
       0  1
0  42405  9
1   1436  6
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.66961616, 'recall': 0.50209045, 'specificity': 0.50209045, 'f1': 0.49523383, 'auroc': 0.84535456, 'binary_precision': 0.375, 'binary_recall': 0.004457652, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.008810572}
confusion matrix:
       0  1
0  18062  5
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.8301767, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_5.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 5,now: 2024-06-06 10:47:35.628736,epoch time: 0:20:43.188065,used: 1:42:39.797086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7336451, 'recall': 0.50267965, 'specificity': 0.50267965, 'f1': 0.49712792, 'auroc': 0.8563325, 'binary_precision': 0.5, 'binary_recall': 0.0055478504, 'binary_specificity': 0.9998114, 'binary_f1_score': 0.010973938}
confusion matrix:
       0  1
0  42406  8
1   1434  8
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.68214095, 'recall': 0.5028057, 'specificity': 0.5028057, 'f1': 0.49668458, 'auroc': 0.8692866, 'binary_precision': 0.4, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.011713031}
confusion matrix:
       0  1
0  18061  6
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.8517064, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_6.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 6,now: 2024-06-06 11:07:54.173359,epoch time: 0:20:18.544623,used: 2:02:58.341709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9669601, 'precision': 0.688856, 'recall': 0.5052767, 'specificity': 0.5052767, 'f1': 0.50240165, 'auroc': 0.8688743, 'binary_precision': 0.41025642, 'binary_recall': 0.011095701, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.021607025}
confusion matrix:
       0   1
0  42391  23
1   1426  16
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7619307, 'recall': 0.5137008, 'specificity': 0.5137008, 'f1': 0.5177778, 'auroc': 0.88469267, 'binary_precision': 0.5588235, 'binary_recall': 0.028231798, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.05374823}
confusion matrix:
       0   1
0  18052  15
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.87317896, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-06 11:29:38.329850,epoch time: 0:21:44.156491,used: 2:24:42.498200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.81312084, 'recall': 0.50919694, 'specificity': 0.50919694, 'f1': 0.5099203, 'auroc': 0.8825617, 'binary_precision': 0.6585366, 'binary_recall': 0.018723994, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.036412675}
confusion matrix:
       0   1
0  42400  14
1   1415  27
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.766761, 'recall': 0.5180477, 'specificity': 0.5180477, 'f1': 0.52579594, 'auroc': 0.89484537, 'binary_precision': 0.5681818, 'binary_recall': 0.0371471, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.069735}
confusion matrix:
       0   1
0  18048  19
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.94896, 'recall': 0.52876204, 'specificity': 0.52876204, 'f1': 0.5442127, 'auroc': 0.86846405, 'binary_precision': 0.9375, 'binary_recall': 0.057692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.108695656}
confusion matrix:
      0   1
0  5945   1
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-06 11:50:33.568998,epoch time: 0:20:55.239148,used: 2:45:37.737348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.7477405, 'recall': 0.52655554, 'specificity': 0.52655554, 'f1': 0.5412975, 'auroc': 0.8912879, 'binary_precision': 0.52666664, 'binary_recall': 0.05478502, 'binary_specificity': 0.998326, 'binary_f1_score': 0.09924623}
confusion matrix:
       0   1
0  42343  71
1   1363  79
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.77345824, 'recall': 0.55565673, 'specificity': 0.55565673, 'f1': 0.5866444, 'auroc': 0.8966438, 'binary_precision': 0.57894737, 'binary_recall': 0.114413075, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.191067}
confusion matrix:
       0   1
0  18011  56
1    596  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.87316924, 'recall': 0.5550965, 'specificity': 0.5550965, 'f1': 0.5877793, 'auroc': 0.8877946, 'binary_precision': 0.7837838, 'binary_recall': 0.11153846, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.19528618}
confusion matrix:
      0   1
0  5938   8
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-06 12:12:43.404577,epoch time: 0:22:09.835579,used: 3:07:47.572927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7600766, 'recall': 0.5124757, 'specificity': 0.5124757, 'f1': 0.5161962, 'auroc': 0.88877416, 'binary_precision': 0.5522388, 'binary_recall': 0.025658807, 'binary_specificity': 0.9992927, 'binary_f1_score': 0.0490391}
confusion matrix:
       0   1
0  42384  30
1   1405  37
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.76463866, 'recall': 0.522367, 'specificity': 0.522367, 'f1': 0.53352165, 'auroc': 0.8967438, 'binary_precision': 0.56363636, 'binary_recall': 0.046062406, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.08516484}
confusion matrix:
       0   1
0  18043  24
1    642  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9029736, 'recall': 0.52098566, 'specificity': 0.52098566, 'f1': 0.5299545, 'auroc': 0.8961417, 'binary_precision': 0.84615386, 'binary_recall': 0.042307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.08058608}
confusion matrix:
      0   1
0  5944   2
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_10.png
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 10,now: 2024-06-06 12:33:51.840498,epoch time: 0:21:08.435921,used: 3:28:56.008848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.7463018, 'recall': 0.53393626, 'specificity': 0.53393626, 'f1': 0.55344975, 'auroc': 0.8990098, 'binary_precision': 0.5233161, 'binary_recall': 0.07004161, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.12354741}
confusion matrix:
       0    1
0  42322   92
1   1341  101
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7616298, 'recall': 0.5699067, 'specificity': 0.5699067, 'f1': 0.60546017, 'auroc': 0.8981306, 'binary_precision': 0.5542857, 'binary_recall': 0.14413075, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.22877358}
confusion matrix:
       0   1
0  17989  78
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.95768595, 'recall': 0.57483184, 'specificity': 0.57483184, 'f1': 0.62036157, 'auroc': 0.894027, 'binary_precision': 0.9512195, 'binary_recall': 0.15, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5944   2
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_11.png
new oracle model saved
early stop counter: 2
val acc:0.9651013612747192, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9640670418739319
after epoch: 11,now: 2024-06-06 12:53:56.058640,epoch time: 0:20:04.218142,used: 3:49:00.226990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7358981, 'recall': 0.5412109, 'specificity': 0.5412109, 'f1': 0.564535, 'auroc': 0.9020215, 'binary_precision': 0.5020408, 'binary_recall': 0.085298195, 'binary_specificity': 0.9971236, 'binary_f1_score': 0.14582098}
confusion matrix:
       0    1
0  42292  122
1   1319  123
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7259792, 'recall': 0.57061774, 'specificity': 0.57061774, 'f1': 0.6034671, 'auroc': 0.90789974, 'binary_precision': 0.48292682, 'binary_recall': 0.14710252, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.22551252}
confusion matrix:
       0    1
0  17961  106
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.88985217, 'recall': 0.5837745, 'specificity': 0.5837745, 'f1': 0.630787, 'auroc': 0.887347, 'binary_precision': 0.8148148, 'binary_recall': 0.16923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.28025478}
confusion matrix:
      0   1
0  5936  10
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_12.png
early stop counter: 3
val acc:0.9637140035629272, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9640670418739319
after epoch: 12,now: 2024-06-06 13:14:04.750859,epoch time: 0:20:08.692219,used: 4:09:08.919209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9663444, 'precision': 0.6976398, 'recall': 0.5324245, 'specificity': 0.5324245, 'f1': 0.55003506, 'auroc': 0.9053823, 'binary_precision': 0.42608696, 'binary_recall': 0.067961164, 'binary_specificity': 0.9968878, 'binary_f1_score': 0.11722488}
confusion matrix:
       0    1
0  42282  132
1   1344   98
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.75333947, 'recall': 0.58412904, 'specificity': 0.58412904, 'f1': 0.622335, 'auroc': 0.9079486, 'binary_precision': 0.53669727, 'binary_recall': 0.17384844, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.26262626}
confusion matrix:
       0    1
0  17966  101
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.93231505, 'recall': 0.6014185, 'specificity': 0.6014185, 'f1': 0.6573374, 'auroc': 0.90927964, 'binary_precision': 0.89830506, 'binary_recall': 0.20384616, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.3322884}
confusion matrix:
      0   1
0  5940   6
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_13.png
new oracle model saved
early stop counter: 4
val acc:0.9649413228034973, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9656783938407898
after epoch: 13,now: 2024-06-06 13:34:09.388162,epoch time: 0:20:04.637303,used: 4:29:13.556512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7370254, 'recall': 0.5710334, 'specificity': 0.5710334, 'f1': 0.605347, 'auroc': 0.90866494, 'binary_precision': 0.50236964, 'binary_recall': 0.14701803, 'binary_specificity': 0.9950488, 'binary_f1_score': 0.22746782}
confusion matrix:
       0    1
0  42204  210
1   1230  212
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7376488, 'recall': 0.6144981, 'specificity': 0.6144981, 'f1': 0.6522585, 'auroc': 0.91009974, 'binary_precision': 0.5031447, 'binary_recall': 0.23774146, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.32290617}
confusion matrix:
       0    1
0  17909  158
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8860662, 'recall': 0.64647925, 'specificity': 0.64647925, 'f1': 0.7079146, 'auroc': 0.8949404, 'binary_precision': 0.8020833, 'binary_recall': 0.29615384, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.43258426}
confusion matrix:
      0   1
0  5927  19
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_14.png
new oracle model saved
early stop counter: 5
val acc:0.9641942381858826, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9674508571624756
after epoch: 14,now: 2024-06-06 13:54:21.489266,epoch time: 0:20:12.101104,used: 4:49:25.657616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96664083, 'precision': 0.7212808, 'recall': 0.55836904, 'specificity': 0.55836904, 'f1': 0.5880093, 'auroc': 0.899886, 'binary_precision': 0.4716981, 'binary_recall': 0.12135922, 'binary_specificity': 0.9953789, 'binary_f1_score': 0.19305019}
confusion matrix:
       0    1
0  42218  196
1   1267  175
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.73171663, 'recall': 0.6071517, 'specificity': 0.6071517, 'f1': 0.6440871, 'auroc': 0.9109383, 'binary_precision': 0.4918033, 'binary_recall': 0.22288261, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.30674845}
confusion matrix:
       0    1
0  17912  155
1    523  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.9174957, 'recall': 0.63561344, 'specificity': 0.63561344, 'f1': 0.69931734, 'auroc': 0.88139343, 'binary_precision': 0.86585367, 'binary_recall': 0.27307692, 'binary_specificity': 0.99815, 'binary_f1_score': 0.41520467}
confusion matrix:
      0   1
0  5935  11
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_15.png
new oracle model saved
early stop counter: 6
val acc:0.9638206958770752, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9677731394767761
after epoch: 15,now: 2024-06-06 14:14:24.904583,epoch time: 0:20:03.415317,used: 5:09:29.072933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9662304, 'precision': 0.71621346, 'recall': 0.57557434, 'specificity': 0.57557434, 'f1': 0.6086798, 'auroc': 0.90922445, 'binary_precision': 0.46044624, 'binary_recall': 0.15742025, 'binary_specificity': 0.99372846, 'binary_f1_score': 0.23462531}
confusion matrix:
       0    1
0  42148  266
1   1215  227
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.74495375, 'recall': 0.6383787, 'specificity': 0.6383787, 'f1': 0.6752647, 'auroc': 0.9148983, 'binary_precision': 0.51604277, 'binary_recall': 0.28677562, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.36867237}
confusion matrix:
       0    1
0  17886  181
1    480  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.90811175, 'recall': 0.65643096, 'specificity': 0.65643096, 'f1': 0.72168696, 'auroc': 0.9007361, 'binary_precision': 0.8453608, 'binary_recall': 0.31538463, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.4593838}
confusion matrix:
      0   1
0  5931  15
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_16.png
new oracle model saved
early stop counter: 7
val acc:0.9647278785705566, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9689010381698608
after epoch: 16,now: 2024-06-06 14:34:43.390762,epoch time: 0:20:18.486179,used: 5:29:47.559112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.72714734, 'recall': 0.59686494, 'specificity': 0.59686494, 'f1': 0.63325876, 'auroc': 0.91432583, 'binary_precision': 0.4809287, 'binary_recall': 0.20110957, 'binary_specificity': 0.99262035, 'binary_f1_score': 0.2836186}
confusion matrix:
       0    1
0  42101  313
1   1152  290
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7446002, 'recall': 0.6626978, 'specificity': 0.6626978, 'f1': 0.694499, 'auroc': 0.91667557, 'binary_precision': 0.51357466, 'binary_recall': 0.33729568, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.4071749}
confusion matrix:
       0    1
0  17852  215
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.9175794, 'recall': 0.67950785, 'specificity': 0.67950785, 'f1': 0.7472278, 'auroc': 0.9044515, 'binary_precision': 0.86238533, 'binary_recall': 0.36153847, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.50948507}
confusion matrix:
      0   1
0  5931  15
1   166  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_17.png
new oracle model saved
early stop counter: 8
val acc:0.9647278785705566, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9708346724510193
after epoch: 17,now: 2024-06-06 14:54:54.825780,epoch time: 0:20:11.435018,used: 5:49:58.994130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96654963, 'precision': 0.7247262, 'recall': 0.585788, 'specificity': 0.585788, 'f1': 0.62117666, 'auroc': 0.91527915, 'binary_precision': 0.4768089, 'binary_recall': 0.17822468, 'binary_specificity': 0.9933513, 'binary_f1_score': 0.25946492}
confusion matrix:
       0    1
0  42132  282
1   1185  257
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.73901236, 'recall': 0.64385176, 'specificity': 0.64385176, 'f1': 0.6782987, 'auroc': 0.9133392, 'binary_precision': 0.5037594, 'binary_recall': 0.2986627, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.375}
confusion matrix:
       0    1
0  17869  198
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.92595065, 'recall': 0.7045079, 'specificity': 0.7045079, 'f1': 0.77312213, 'auroc': 0.90579915, 'binary_precision': 0.8770492, 'binary_recall': 0.41153845, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.5602094}
confusion matrix:
      0    1
0  5931   15
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_18.png
new oracle model saved
early stop counter: 9
val acc:0.9642475843429565, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9729294180870056
after epoch: 18,now: 2024-06-06 15:15:00.188918,epoch time: 0:20:05.363138,used: 6:10:04.357268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.7421846, 'recall': 0.60867774, 'specificity': 0.60867774, 'f1': 0.64765066, 'auroc': 0.92136633, 'binary_precision': 0.5102362, 'binary_recall': 0.22468793, 'binary_specificity': 0.9926675, 'binary_f1_score': 0.31198844}
confusion matrix:
       0    1
0  42103  311
1   1118  324
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74291515, 'recall': 0.6704827, 'specificity': 0.6704827, 'f1': 0.699636, 'auroc': 0.91826415, 'binary_precision': 0.509636, 'binary_recall': 0.3536404, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.41754386}
confusion matrix:
       0    1
0  17838  229
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.8904686, 'recall': 0.70550597, 'specificity': 0.70550597, 'f1': 0.7667061, 'auroc': 0.9021889, 'binary_precision': 0.80597013, 'binary_recall': 0.41538462, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.5482234}
confusion matrix:
      0    1
0  5920   26
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_19.png
early stop counter: 10
val acc:0.9645677804946899, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9729294180870056
after epoch: 19,now: 2024-06-06 15:35:04.248397,epoch time: 0:20:04.059479,used: 6:30:08.416747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.73004085, 'recall': 0.6167348, 'specificity': 0.6167348, 'f1': 0.65302956, 'auroc': 0.9215249, 'binary_precision': 0.4853964, 'binary_recall': 0.24219292, 'binary_specificity': 0.9912767, 'binary_f1_score': 0.32314813}
confusion matrix:
       0    1
0  42045  370
1   1092  349
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7462177, 'recall': 0.67207927, 'specificity': 0.67207927, 'f1': 0.7018434, 'auroc': 0.91953886, 'binary_precision': 0.516129, 'binary_recall': 0.35661218, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.4217926}
confusion matrix:
       0    1
0  17842  225
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.9121299, 'recall': 0.72323406, 'specificity': 0.72323406, 'f1': 0.7871444, 'auroc': 0.9096638, 'binary_precision': 0.84782606, 'binary_recall': 0.45, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.5879397}
confusion matrix:
      0    1
0  5925   21
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_20.png
new oracle model saved
early stop counter: 11
val acc:0.9648879170417786, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9735739827156067
after epoch: 20,now: 2024-06-06 15:55:04.623472,epoch time: 0:20:00.375075,used: 6:50:08.791822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9658884, 'precision': 0.72113013, 'recall': 0.6269802, 'specificity': 0.6269802, 'f1': 0.6599802, 'auroc': 0.9206897, 'binary_precision': 0.46691176, 'binary_recall': 0.26421636, 'binary_specificity': 0.98974395, 'binary_f1_score': 0.3374668}
confusion matrix:
       0    1
0  41979  435
1   1061  381
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74607897, 'recall': 0.6949678, 'specificity': 0.6949678, 'f1': 0.71722066, 'auroc': 0.92041487, 'binary_precision': 0.5141777, 'binary_recall': 0.40416047, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.45257902}
confusion matrix:
       0    1
0  17810  257
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.90128326, 'recall': 0.7495686, 'specificity': 0.7495686, 'f1': 0.80610365, 'auroc': 0.9032756, 'binary_precision': 0.8238994, 'binary_recall': 0.50384617, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.6252983}
confusion matrix:
      0    1
0  5918   28
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_21.png
new oracle model saved
early stop counter: 12
val acc:0.9648879170417786, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9614889025688171 / 0.9747018814086914
after epoch: 21,now: 2024-06-06 16:15:13.750158,epoch time: 0:20:09.126686,used: 7:10:17.918508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96791774, 'precision': 0.74975765, 'recall': 0.62769437, 'specificity': 0.62769437, 'f1': 0.66713387, 'auroc': 0.9233277, 'binary_precision': 0.5241379, 'binary_recall': 0.2635229, 'binary_specificity': 0.9918659, 'binary_f1_score': 0.35071525}
confusion matrix:
       0    1
0  42069  345
1   1062  380
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.75152075, 'recall': 0.6809392, 'specificity': 0.6809392, 'f1': 0.7098313, 'auroc': 0.91873014, 'binary_precision': 0.52609605, 'binary_recall': 0.3744428, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.43750003}
confusion matrix:
       0    1
0  17840  227
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.8937191, 'recall': 0.7208065, 'specificity': 0.7208065, 'f1': 0.78072155, 'auroc': 0.91664755, 'binary_precision': 0.8111888, 'binary_recall': 0.44615385, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.5756824}
confusion matrix:
      0    1
0  5919   27
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_22.png
better model found
persisted
after epoch: 22,now: 2024-06-06 16:35:30.237690,epoch time: 0:20:16.487532,used: 7:30:34.406040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9663216, 'precision': 0.7257328, 'recall': 0.6191653, 'specificity': 0.6191653, 'f1': 0.65430397, 'auroc': 0.9199102, 'binary_precision': 0.47663552, 'binary_recall': 0.24757281, 'binary_specificity': 0.99075776, 'binary_f1_score': 0.32587856}
confusion matrix:
       0    1
0  42022  392
1   1085  357
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.7368796, 'recall': 0.6780185, 'specificity': 0.6780185, 'f1': 0.7027856, 'auroc': 0.9244416, 'binary_precision': 0.497006, 'binary_recall': 0.36998513, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.4241908}
confusion matrix:
       0    1
0  17815  252
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.89731133, 'recall': 0.7304219, 'specificity': 0.7304219, 'f1': 0.78965425, 'auroc': 0.9031341, 'binary_precision': 0.8175676, 'binary_recall': 0.4653846, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.59313726}
confusion matrix:
      0    1
0  5919   27
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_23.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9747018814086914
after epoch: 23,now: 2024-06-06 16:56:15.056418,epoch time: 0:20:44.818728,used: 7:51:19.224768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.966618, 'precision': 0.73114747, 'recall': 0.6330516, 'specificity': 0.6330516, 'f1': 0.66753995, 'auroc': 0.9252403, 'binary_precision': 0.48655257, 'binary_recall': 0.27600554, 'binary_specificity': 0.9900976, 'binary_f1_score': 0.35221237}
confusion matrix:
       0    1
0  41994  420
1   1044  398
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74660754, 'recall': 0.68712753, 'specificity': 0.68712753, 'f1': 0.71232474, 'auroc': 0.92458385, 'binary_precision': 0.51581025, 'binary_recall': 0.38781574, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.4427481}
confusion matrix:
       0    1
0  17822  245
1    412  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.8966625, 'recall': 0.736107, 'specificity': 0.736107, 'f1': 0.7941375, 'auroc': 0.91274416, 'binary_precision': 0.81578946, 'binary_recall': 0.47692308, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.6019417}
confusion matrix:
      0    1
0  5918   28
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_24.png
early stop counter: 2
val acc:0.9649413228034973, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9747018814086914
after epoch: 24,now: 2024-06-06 17:16:33.098397,epoch time: 0:20:18.041979,used: 8:11:37.266747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.966048, 'precision': 0.72599566, 'recall': 0.6498394, 'specificity': 0.6498394, 'f1': 0.6793768, 'auroc': 0.9247813, 'binary_precision': 0.4751323, 'binary_recall': 0.31137308, 'binary_specificity': 0.98830575, 'binary_f1_score': 0.37620446}
confusion matrix:
       0    1
0  41918  496
1    993  449
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74182254, 'recall': 0.7147186, 'specificity': 0.7147186, 'f1': 0.7273696, 'auroc': 0.9271809, 'binary_precision': 0.5042017, 'binary_recall': 0.44576523, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.47318614}
confusion matrix:
       0    1
0  17772  295
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.8936492, 'recall': 0.7493163, 'specificity': 0.7493163, 'f1': 0.8037543, 'auroc': 0.9073249, 'binary_precision': 0.80864197, 'binary_recall': 0.50384617, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.6208531}
confusion matrix:
      0    1
0  5915   31
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_25.png
early stop counter: 3
val acc:0.9643543362617493, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9747018814086914
after epoch: 25,now: 2024-06-06 17:37:45.015565,epoch time: 0:21:11.917168,used: 8:32:49.183915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663672, 'precision': 0.72901565, 'recall': 0.6439753, 'specificity': 0.6439753, 'f1': 0.6757861, 'auroc': 0.92353743, 'binary_precision': 0.48156425, 'binary_recall': 0.29889044, 'binary_specificity': 0.9890602, 'binary_f1_score': 0.36884895}
confusion matrix:
       0    1
0  41950  464
1   1011  431
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7437235, 'recall': 0.69912106, 'specificity': 0.69912106, 'f1': 0.71891373, 'auroc': 0.92298186, 'binary_precision': 0.50915754, 'binary_recall': 0.41307577, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.45611158}
confusion matrix:
       0    1
0  17799  268
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.8960596, 'recall': 0.74179214, 'specificity': 0.74179214, 'f1': 0.7985362, 'auroc': 0.90793955, 'binary_precision': 0.8141026, 'binary_recall': 0.48846152, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.61057687}
confusion matrix:
      0    1
0  5917   29
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_26.png
early stop counter: 4
val acc:0.9646211266517639, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9747018814086914
after epoch: 26,now: 2024-06-06 17:58:47.111098,epoch time: 0:21:02.095533,used: 8:53:51.279448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9662532, 'precision': 0.72913635, 'recall': 0.6589892, 'specificity': 0.6589892, 'f1': 0.6870464, 'auroc': 0.9245099, 'binary_precision': 0.48080808, 'binary_recall': 0.33009708, 'binary_specificity': 0.98788136, 'binary_f1_score': 0.39144737}
confusion matrix:
       0    1
0  41900  514
1    966  476
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7395266, 'recall': 0.7302607, 'specificity': 0.7302607, 'f1': 0.73479104, 'auroc': 0.9266112, 'binary_precision': 0.498452, 'binary_recall': 0.47845468, 'binary_specificity': 0.98206675, 'binary_f1_score': 0.48824868}
confusion matrix:
       0    1
0  17743  324
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.901858, 'recall': 0.75909984, 'specificity': 0.75909984, 'f1': 0.8136181, 'auroc': 0.901654, 'binary_precision': 0.8242424, 'binary_recall': 0.52307695, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.64000005}
confusion matrix:
      0    1
0  5917   29
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_27.png
new oracle model saved
early stop counter: 5
val acc:0.9639807939529419, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9753464460372925
after epoch: 27,now: 2024-06-06 18:20:02.687078,epoch time: 0:21:15.575980,used: 9:15:06.855428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7389209, 'recall': 0.65676934, 'specificity': 0.65676934, 'f1': 0.68844366, 'auroc': 0.9251096, 'binary_precision': 0.5005348, 'binary_recall': 0.32454923, 'binary_specificity': 0.9889895, 'binary_f1_score': 0.39377367}
confusion matrix:
       0    1
0  41947  467
1    974  468
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74180317, 'recall': 0.71400326, 'specificity': 0.71400326, 'f1': 0.726954, 'auroc': 0.9261687, 'binary_precision': 0.50421584, 'binary_recall': 0.44427934, 'binary_specificity': 0.9837272, 'binary_f1_score': 0.4723539}
confusion matrix:
       0    1
0  17773  294
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.89935064, 'recall': 0.75140756, 'specificity': 0.75140756, 'f1': 0.80699265, 'auroc': 0.9143592, 'binary_precision': 0.8198758, 'binary_recall': 0.50769234, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.6270785}
confusion matrix:
      0    1
0  5917   29
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_28.png
early stop counter: 6
val acc:0.9643543362617493, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9753464460372925
after epoch: 28,now: 2024-06-06 18:40:25.969437,epoch time: 0:20:23.282359,used: 9:35:30.137787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9677581, 'precision': 0.74621856, 'recall': 0.6678061, 'specificity': 0.6678061, 'f1': 0.6988365, 'auroc': 0.9263652, 'binary_precision': 0.5144033, 'binary_recall': 0.34674063, 'binary_specificity': 0.9888716, 'binary_f1_score': 0.41425017}
confusion matrix:
       0    1
0  41942  472
1    942  500
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7470215, 'recall': 0.7164812, 'specificity': 0.7164812, 'f1': 0.73062676, 'auroc': 0.92653936, 'binary_precision': 0.5144804, 'binary_recall': 0.448737, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.47936508}
confusion matrix:
       0    1
0  17782  285
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.8964079, 'recall': 0.76461685, 'specificity': 0.76461685, 'f1': 0.8161207, 'auroc': 0.9176303, 'binary_precision': 0.8128655, 'binary_recall': 0.5346154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.6450116}
confusion matrix:
      0    1
0  5914   32
1   121  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_29.png
early stop counter: 7
val acc:0.9649946689605713, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9753464460372925
after epoch: 29,now: 2024-06-06 19:00:29.559914,epoch time: 0:20:03.590477,used: 9:55:33.728264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9664356, 'precision': 0.7339622, 'recall': 0.69961274, 'specificity': 0.69961274, 'f1': 0.71527684, 'auroc': 0.9317261, 'binary_precision': 0.4877451, 'binary_recall': 0.41400832, 'binary_specificity': 0.98521715, 'binary_f1_score': 0.44786197}
confusion matrix:
       0    1
0  41787  627
1    845  597
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7454001, 'recall': 0.74996036, 'specificity': 0.74996036, 'f1': 0.74765664, 'auroc': 0.92918396, 'binary_precision': 0.5087463, 'binary_recall': 0.5185735, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.5136129}
confusion matrix:
       0    1
0  17730  337
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.8885472, 'recall': 0.78142, 'specificity': 0.78142, 'f1': 0.8255709, 'auroc': 0.9226364, 'binary_precision': 0.79569894, 'binary_recall': 0.5692308, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6636772}
confusion matrix:
      0    1
0  5908   38
1   112  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_30.png
new oracle model saved
early stop counter: 8
val acc:0.9647278785705566, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9724460244178772 / 0.9758298397064209
after epoch: 30,now: 2024-06-06 19:20:30.080484,epoch time: 0:20:00.520570,used: 10:15:34.248834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_09_04_55_seed_1_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:15:34.248834 at 2024-06-06 19:20:30.080484
persisted model performance metric: 

scalar performance:
{'acc': 0.9727683, 'precision': 0.9195021, 'recall': 0.70626277, 'specificity': 0.70626277, 'f1': 0.77349365, 'auroc': 0.92003477, 'binary_precision': 0.864, 'binary_recall': 0.41538462, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.561039}
confusion matrix:
      0    1
0  5929   17
1   152  108
oracle model performance metric: 

scalar performance:
{'acc': 0.97582984, 'precision': 0.8787587, 'recall': 0.79429287, 'specificity': 0.79429287, 'f1': 0.83068144, 'auroc': 0.9241777, 'binary_precision': 0.775, 'binary_recall': 0.59615386, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.67391306}
confusion matrix:
      0    1
0  5901   45
1   105  155
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |  88730 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11390 MiB |  11390 MiB |  20790 MiB |   9400 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1482 MiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool |   1472 MiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |     10 MiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  276103 K  |  276100 K  |
|       from large pool |      87    |     909    |  130046 K  |  130046 K  |
|       from small pool |    3618    |    6639    |  146057 K  |  146054 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  276103 K  |  276100 K  |
|       from large pool |      87    |     909    |  130046 K  |  130046 K  |
|       from small pool |    3618    |    6639    |  146057 K  |  146054 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     387    |     153    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2775    |  144458 K  |  144458 K  |
|       from large pool |      24    |      65    |   67365 K  |   67365 K  |
|       from small pool |      53    |    2751    |   77093 K  |   77093 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1968 MiB |  11390 MiB |  20790 MiB |  18822 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  276103 K  |  276103 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  146057 K  |  146057 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  276103 K  |  276103 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  146057 K  |  146057 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     234    |     387    |     303    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144460 K  |  144460 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77094 K  |   77094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1968 MiB |  11390 MiB |  20790 MiB |  18822 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  276103 K  |  276103 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  146057 K  |  146057 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  276103 K  |  276103 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  146057 K  |  146057 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     234    |     387    |     303    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144460 K  |  144460 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77094 K  |   77094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980

 Experiment start at: 2024-06-06 19:29:40.409357
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9553441, 'precision': 0.4975418, 'recall': 0.49921426, 'specificity': 0.49921426, 'f1': 0.49563023, 'auroc': 0.51331735, 'binary_precision': 0.029661017, 'binary_recall': 0.00925314, 'binary_specificity': 0.9891754, 'binary_f1_score': 0.014105794}
confusion matrix:
       0    1
0  41853  458
1   1499   14
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94918233, 'precision': 0.48509774, 'recall': 0.49111727, 'specificity': 0.49111727, 'f1': 0.4880097, 'auroc': 0.4026687, 'binary_precision': 0.0028248588, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9805734, 'binary_f1_score': 0.0020920504}
confusion matrix:
       0    1
0  17818  353
1    601    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9519154, 'precision': 0.4888318, 'recall': 0.497147, 'specificity': 0.497147, 'f1': 0.49099192, 'auroc': 0.39913, 'binary_precision': 0.016666668, 'binary_recall': 0.004132231, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.0066225166}
confusion matrix:
      0   1
0  5938  59
1   241   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 19:50:48.855872,epoch time: 0:21:08.446515,used: 0:21:08.446515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9645628, 'precision': 0.53277516, 'recall': 0.50112057, 'specificity': 0.50112057, 'f1': 0.49417883, 'auroc': 0.6917591, 'binary_precision': 0.1, 'binary_recall': 0.0033046927, 'binary_specificity': 0.9989365, 'binary_f1_score': 0.006397953}
confusion matrix:
       0   1
0  42266  45
1   1508   5
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.53955984, 'recall': 0.5012209, 'specificity': 0.5012209, 'f1': 0.4948848, 'auroc': 0.67925787, 'binary_precision': 0.11111111, 'binary_recall': 0.003322259, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.006451613}
confusion matrix:
       0   1
0  18155  16
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.48058408, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48981926, 'auroc': 0.6117594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 20:11:05.596607,epoch time: 0:20:16.740735,used: 0:41:25.187250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9653614, 'precision': 0.59386814, 'recall': 0.5005782, 'specificity': 0.5005782, 'f1': 0.4925014, 'auroc': 0.7935126, 'binary_precision': 0.22222222, 'binary_recall': 0.0013218771, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.0026281208}
confusion matrix:
       0  1
0  42304  7
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.78958595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.762842, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 20:31:14.441487,epoch time: 0:20:08.844880,used: 1:01:34.032130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.6827586, 'recall': 0.5006255, 'specificity': 0.5006255, 'f1': 0.4925285, 'auroc': 0.8402214, 'binary_precision': 0.4, 'binary_recall': 0.0013218771, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.0026350464}
confusion matrix:
       0  1
0  42308  3
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.85218716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8233228, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_4.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9613720178604126
after epoch: 4,now: 2024-06-06 20:51:13.730719,epoch time: 0:19:59.289232,used: 1:21:33.321362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.98274875, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918835, 'auroc': 0.85555315, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42311  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.86776066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.84931636, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_5.png
new oracle model saved
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9615322947502136
after epoch: 5,now: 2024-06-06 21:11:15.676089,epoch time: 0:20:01.945370,used: 1:41:35.266732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.6077476, 'recall': 0.500295, 'specificity': 0.500295, 'f1': 0.49186444, 'auroc': 0.87707067, 'binary_precision': 0.25, 'binary_recall': 0.00066093856, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.0013183916}
confusion matrix:
       0  1
0  42308  3
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.88280475, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.85158074, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_6.png
new oracle model saved
early stop counter: 3
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9620131254196167
after epoch: 6,now: 2024-06-06 21:31:12.981668,epoch time: 0:19:57.305579,used: 2:01:32.572311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.48273736, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.49121138, 'auroc': 0.8883643, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  1
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.89926946, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.89765495, 'recall': 0.5102472, 'specificity': 0.5102472, 'f1': 0.5104311, 'auroc': 0.8843403, 'binary_precision': 0.8333333, 'binary_recall': 0.020661157, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04032258}
confusion matrix:
      0  1
0  5996  1
1   237  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_7.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9620131254196167
after epoch: 7,now: 2024-06-06 21:51:06.280576,epoch time: 0:19:53.298908,used: 2:21:25.871219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96565807, 'precision': 0.93283653, 'recall': 0.5029624, 'specificity': 0.5029624, 'f1': 0.49717212, 'auroc': 0.88942945, 'binary_precision': 0.9, 'binary_recall': 0.0059484467, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.011818779}
confusion matrix:
       0  1
0  42310  1
1   1504  9
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6089896, 'recall': 0.50074804, 'specificity': 0.50074804, 'f1': 0.49347475, 'auroc': 0.8995379, 'binary_precision': 0.25, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0033003301}
confusion matrix:
       0  1
0  18168  3
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.8866494, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_8.png
new oracle model saved
early stop counter: 5
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9624940156936646
after epoch: 8,now: 2024-06-06 22:11:01.893034,epoch time: 0:19:55.612458,used: 2:41:21.483677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9651561, 'precision': 0.6531262, 'recall': 0.50492465, 'specificity': 0.50492465, 'f1': 0.5013943, 'auroc': 0.8953326, 'binary_precision': 0.34042552, 'binary_recall': 0.01058201, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.020525979}
confusion matrix:
       0   1
0  42281  31
1   1496  16
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.70288926, 'recall': 0.5055663, 'specificity': 0.5055663, 'f1': 0.5031488, 'auroc': 0.90946025, 'binary_precision': 0.4375, 'binary_recall': 0.011627907, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.022653721}
confusion matrix:
       0  1
0  18162  9
1    595  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9397851, 'recall': 0.52264386, 'specificity': 0.52264386, 'f1': 0.5338175, 'auroc': 0.8834741, 'binary_precision': 0.9166667, 'binary_recall': 0.045454547, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08661417}
confusion matrix:
      0   1
0  5996   1
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_9.png
new oracle model saved
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9628145694732666
after epoch: 9,now: 2024-06-06 22:30:56.754940,epoch time: 0:19:54.861906,used: 3:01:16.345583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96495074, 'precision': 0.6813954, 'recall': 0.5137489, 'specificity': 0.5137489, 'f1': 0.5181659, 'auroc': 0.896381, 'binary_precision': 0.3963964, 'binary_recall': 0.029081296, 'binary_specificity': 0.9984165, 'binary_f1_score': 0.054187194}
confusion matrix:
       0   1
0  42244  67
1   1469  44
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.68183714, 'recall': 0.5220726, 'specificity': 0.5220726, 'f1': 0.53323823, 'auroc': 0.9033216, 'binary_precision': 0.3943662, 'binary_recall': 0.046511628, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.083209515}
confusion matrix:
       0   1
0  18128  43
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.9159392, 'recall': 0.5533855, 'specificity': 0.5533855, 'f1': 0.5865763, 'auroc': 0.88248324, 'binary_precision': 0.8666667, 'binary_recall': 0.10743801, 'binary_specificity': 0.999333, 'binary_f1_score': 0.19117646}
confusion matrix:
      0   1
0  5993   4
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_10.png
new oracle model saved
early stop counter: 7
val acc:0.967133641242981, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9647379517555237
after epoch: 10,now: 2024-06-06 22:50:57.925395,epoch time: 0:20:01.170455,used: 3:21:17.516038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9647682, 'precision': 0.6645781, 'recall': 0.5126984, 'specificity': 0.5126984, 'f1': 0.5162408, 'auroc': 0.9046169, 'binary_precision': 0.36283186, 'binary_recall': 0.02709848, 'binary_specificity': 0.9982983, 'binary_f1_score': 0.050430506}
confusion matrix:
       0   1
0  42239  72
1   1472  41
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7100271, 'recall': 0.51833254, 'specificity': 0.51833254, 'f1': 0.5269956, 'auroc': 0.9056239, 'binary_precision': 0.4509804, 'binary_recall': 0.03820598, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.07044411}
confusion matrix:
       0   1
0  18143  28
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.93887997, 'recall': 0.56379944, 'specificity': 0.56379944, 'f1': 0.60354984, 'auroc': 0.88162607, 'binary_precision': 0.9117647, 'binary_recall': 0.12809917, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.22463769}
confusion matrix:
      0   1
0  5994   3
1   211  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_11.png
new oracle model saved
early stop counter: 8
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9656996130943298
after epoch: 11,now: 2024-06-06 23:10:56.407150,epoch time: 0:19:58.481755,used: 3:41:15.997793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9648138, 'precision': 0.68038195, 'recall': 0.51686454, 'specificity': 0.51686454, 'f1': 0.523762, 'auroc': 0.9092723, 'binary_precision': 0.3941606, 'binary_recall': 0.03569068, 'binary_specificity': 0.99803835, 'binary_f1_score': 0.06545454}
confusion matrix:
       0   1
0  42228  83
1   1459  54
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.68599826, 'recall': 0.52606034, 'specificity': 0.52606034, 'f1': 0.539863, 'auroc': 0.91282153, 'binary_precision': 0.40243903, 'binary_recall': 0.054817274, 'binary_specificity': 0.99730337, 'binary_f1_score': 0.096491225}
confusion matrix:
       0   1
0  18122  49
1    569  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.9252586, 'recall': 0.59247494, 'specificity': 0.59247494, 'f1': 0.6452537, 'auroc': 0.8971722, 'binary_precision': 0.88235295, 'binary_recall': 0.18595041, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.30716726}
confusion matrix:
      0   1
0  5991   6
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_12.png
new oracle model saved
early stop counter: 9
val acc:0.9670803546905518, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9674627184867859
after epoch: 12,now: 2024-06-06 23:31:03.568678,epoch time: 0:20:07.161528,used: 4:01:23.159321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.734385, 'recall': 0.54907244, 'specificity': 0.54907244, 'f1': 0.5757547, 'auroc': 0.9107684, 'binary_precision': 0.5, 'binary_recall': 0.101784535, 'binary_specificity': 0.9963603, 'binary_f1_score': 0.16913784}
confusion matrix:
       0    1
0  42157  154
1   1359  154
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.71505755, 'recall': 0.5614495, 'specificity': 0.5614495, 'f1': 0.591625, 'auroc': 0.91320086, 'binary_precision': 0.45833334, 'binary_recall': 0.12790698, 'binary_specificity': 0.994992, 'binary_f1_score': 0.20000002}
confusion matrix:
       0   1
0  18080  91
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.9034358, 'recall': 0.6352798, 'specificity': 0.6352798, 'f1': 0.69783413, 'auroc': 0.8984668, 'binary_precision': 0.835443, 'binary_recall': 0.27272728, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.41121495}
confusion matrix:
      0   1
0  5984  13
1   176  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_13.png
new oracle model saved
early stop counter: 10
val acc:0.9671869277954102, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.969706654548645
after epoch: 13,now: 2024-06-06 23:51:04.814328,epoch time: 0:20:01.245650,used: 4:21:24.404971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9651789, 'precision': 0.7239539, 'recall': 0.5476442, 'specificity': 0.5476442, 'f1': 0.57325625, 'auroc': 0.9048441, 'binary_precision': 0.47923324, 'binary_recall': 0.09914078, 'binary_specificity': 0.9961476, 'binary_f1_score': 0.16429353}
confusion matrix:
       0    1
0  42148  163
1   1363  150
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7286536, 'recall': 0.55530024, 'specificity': 0.55530024, 'f1': 0.58450866, 'auroc': 0.913731, 'binary_precision': 0.48591548, 'binary_recall': 0.114617944, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.18548387}
confusion matrix:
       0   1
0  18098  73
1    533  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.9263854, 'recall': 0.6643721, 'specificity': 0.6643721, 'f1': 0.73311794, 'auroc': 0.8972186, 'binary_precision': 0.8791209, 'binary_recall': 0.3305785, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.4804805}
confusion matrix:
      0   1
0  5986  11
1   162  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_14.png
new oracle model saved
early stop counter: 11
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.972271203994751
after epoch: 14,now: 2024-06-07 00:11:12.186891,epoch time: 0:20:07.372563,used: 4:41:31.777534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9651104, 'precision': 0.721678, 'recall': 0.54760873, 'specificity': 0.54760873, 'f1': 0.5731038, 'auroc': 0.91389847, 'binary_precision': 0.47468355, 'binary_recall': 0.09914078, 'binary_specificity': 0.99607664, 'binary_f1_score': 0.16402406}
confusion matrix:
       0    1
0  42145  166
1   1363  150
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.7064239, 'recall': 0.5596783, 'specificity': 0.5596783, 'f1': 0.5886932, 'auroc': 0.91907644, 'binary_precision': 0.44117647, 'binary_recall': 0.12458472, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.19430052}
confusion matrix:
       0   1
0  18076  95
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.9113381, 'recall': 0.6825503, 'specificity': 0.6825503, 'f1': 0.7495185, 'auroc': 0.9169792, 'binary_precision': 0.84761906, 'binary_recall': 0.3677686, 'binary_specificity': 0.997332, 'binary_f1_score': 0.51296836}
confusion matrix:
      0   1
0  5981  16
1   153  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_15.png
new oracle model saved
early stop counter: 12
val acc:0.9668673276901245, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9729123115539551
after epoch: 15,now: 2024-06-07 00:31:17.904339,epoch time: 0:20:05.717448,used: 5:01:37.494982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.965293, 'precision': 0.7324778, 'recall': 0.5926332, 'specificity': 0.5926332, 'f1': 0.6294837, 'auroc': 0.9171064, 'binary_precision': 0.49322033, 'binary_recall': 0.19233312, 'binary_specificity': 0.9929333, 'binary_f1_score': 0.27674752}
confusion matrix:
       0    1
0  42012  299
1   1222  291
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.730551, 'recall': 0.6210127, 'specificity': 0.6210127, 'f1': 0.65704936, 'auroc': 0.9186903, 'binary_precision': 0.48553056, 'binary_recall': 0.25083056, 'binary_specificity': 0.9911948, 'binary_f1_score': 0.33077765}
confusion matrix:
       0    1
0  18011  160
1    451  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.90726346, 'recall': 0.72957075, 'specificity': 0.72957075, 'f1': 0.79159236, 'auroc': 0.90599847, 'binary_precision': 0.8358209, 'binary_recall': 0.46280992, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.59574467}
confusion matrix:
      0    1
0  5975   22
1   130  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_16.png
new oracle model saved
early stop counter: 13
val acc:0.9674532413482666, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9756371378898621
after epoch: 16,now: 2024-06-07 00:51:13.656547,epoch time: 0:19:55.752208,used: 5:21:33.247190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96513325, 'precision': 0.7299273, 'recall': 0.5960556, 'specificity': 0.5960556, 'f1': 0.632717, 'auroc': 0.9176369, 'binary_precision': 0.4878837, 'binary_recall': 0.19960344, 'binary_specificity': 0.9925079, 'binary_f1_score': 0.28330207}
confusion matrix:
       0    1
0  41994  317
1   1211  302
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7362185, 'recall': 0.6228114, 'specificity': 0.6228114, 'f1': 0.6598886, 'auroc': 0.9248049, 'binary_precision': 0.49675325, 'binary_recall': 0.25415283, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.33626375}
confusion matrix:
       0    1
0  18016  155
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.9161334, 'recall': 0.7482491, 'specificity': 0.7482491, 'f1': 0.8092334, 'auroc': 0.90692866, 'binary_precision': 0.85211265, 'binary_recall': 0.5, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6302083}
confusion matrix:
      0    1
0  5976   21
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_17.png
new oracle model saved
early stop counter: 14
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9772399663925171
after epoch: 17,now: 2024-06-07 01:11:04.183227,epoch time: 0:19:50.526680,used: 5:41:23.773870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96520174, 'precision': 0.7318041, 'recall': 0.6046947, 'specificity': 0.6046947, 'f1': 0.64178824, 'auroc': 0.9221543, 'binary_precision': 0.4910448, 'binary_recall': 0.21744877, 'binary_specificity': 0.9919406, 'binary_f1_score': 0.30142006}
confusion matrix:
       0    1
0  41970  341
1   1184  329
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73835945, 'recall': 0.6389274, 'specificity': 0.6389274, 'f1': 0.67426497, 'auroc': 0.92301834, 'binary_precision': 0.5, 'binary_recall': 0.28737542, 'binary_specificity': 0.99047935, 'binary_f1_score': 0.36497888}
confusion matrix:
       0    1
0  17998  173
1    429  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.8838922, 'recall': 0.7084927, 'specificity': 0.7084927, 'f1': 0.76803577, 'auroc': 0.8995944, 'binary_precision': 0.7906977, 'binary_recall': 0.4214876, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.54986525}
confusion matrix:
      0    1
0  5970   27
1   140  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_18.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9772399663925171
after epoch: 18,now: 2024-06-07 01:30:58.690007,epoch time: 0:19:54.506780,used: 6:01:18.280650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96572655, 'precision': 0.7405297, 'recall': 0.6234483, 'specificity': 0.6234483, 'f1': 0.6612384, 'auroc': 0.921481, 'binary_precision': 0.5072084, 'binary_recall': 0.2557832, 'binary_specificity': 0.9911134, 'binary_f1_score': 0.3400703}
confusion matrix:
       0    1
0  41935  376
1   1126  387
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7399643, 'recall': 0.6702738, 'specificity': 0.6702738, 'f1': 0.6986011, 'auroc': 0.92247564, 'binary_precision': 0.501182, 'binary_recall': 0.35215947, 'binary_specificity': 0.98838806, 'binary_f1_score': 0.41365856}
confusion matrix:
       0    1
0  17960  211
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.9222232, 'recall': 0.7484159, 'specificity': 0.7484159, 'f1': 0.8109669, 'auroc': 0.9143925, 'binary_precision': 0.8642857, 'binary_recall': 0.5, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.63350785}
confusion matrix:
      0    1
0  5978   19
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-07 01:50:56.684790,epoch time: 0:19:57.994783,used: 6:21:16.275433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96454, 'precision': 0.70594597, 'recall': 0.55147964, 'specificity': 0.55147964, 'f1': 0.5776428, 'auroc': 0.91586375, 'binary_precision': 0.44293478, 'binary_recall': 0.10780423, 'binary_specificity': 0.99515504, 'binary_f1_score': 0.17340426}
confusion matrix:
       0    1
0  42107  205
1   1349  163
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.71471065, 'recall': 0.57579434, 'specificity': 0.57579434, 'f1': 0.60884535, 'auroc': 0.9219868, 'binary_precision': 0.45673078, 'binary_recall': 0.1578073, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.23456791}
confusion matrix:
       0    1
0  18058  113
1    507   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740343, 'precision': 0.9136019, 'recall': 0.6989958, 'specificity': 0.6989958, 'f1': 0.76578987, 'auroc': 0.91286635, 'binary_precision': 0.85087717, 'binary_recall': 0.40082645, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5449438}
confusion matrix:
      0   1
0  5980  17
1   145  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_20.png
early stop counter: 1
val acc:0.9669738411903381, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9775605201721191 / 0.9775605201721191
after epoch: 20,now: 2024-06-07 02:10:47.199670,epoch time: 0:19:50.514880,used: 6:41:06.790313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.73560095, 'recall': 0.6149979, 'specificity': 0.6149979, 'f1': 0.65242994, 'auroc': 0.922583, 'binary_precision': 0.49793103, 'binary_recall': 0.23859881, 'binary_specificity': 0.991397, 'binary_f1_score': 0.32260948}
confusion matrix:
       0    1
0  41947  364
1   1152  361
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7295551, 'recall': 0.626579, 'specificity': 0.626579, 'f1': 0.6617049, 'auroc': 0.9250874, 'binary_precision': 0.48318043, 'binary_recall': 0.26245847, 'binary_specificity': 0.99069947, 'binary_f1_score': 0.34015068}
confusion matrix:
       0    1
0  18002  169
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.9341491, 'recall': 0.7589966, 'specificity': 0.7589966, 'f1': 0.8226677, 'auroc': 0.91310537, 'binary_precision': 0.8873239, 'binary_recall': 0.5206612, 'binary_specificity': 0.997332, 'binary_f1_score': 0.65625}
confusion matrix:
      0    1
0  5981   16
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_21.png
new oracle model saved
early stop counter: 2
val acc:0.967346727848053, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9775605201721191 / 0.9788427352905273
after epoch: 21,now: 2024-06-07 02:30:40.834085,epoch time: 0:19:53.634415,used: 7:01:00.424728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.964791, 'precision': 0.72579235, 'recall': 0.6076685, 'specificity': 0.6076685, 'f1': 0.64360285, 'auroc': 0.92557776, 'binary_precision': 0.47881356, 'binary_recall': 0.22405817, 'binary_specificity': 0.9912789, 'binary_f1_score': 0.3052679}
confusion matrix:
       0    1
0  41942  369
1   1174  339
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.72906685, 'recall': 0.6361605, 'specificity': 0.6361605, 'f1': 0.6696068, 'auroc': 0.9226429, 'binary_precision': 0.4815864, 'binary_recall': 0.28239202, 'binary_specificity': 0.989929, 'binary_f1_score': 0.35602096}
confusion matrix:
       0    1
0  17988  183
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.905324, 'recall': 0.74180067, 'specificity': 0.74180067, 'f1': 0.801173, 'auroc': 0.9170177, 'binary_precision': 0.8309859, 'binary_recall': 0.4876033, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6145833}
confusion matrix:
      0    1
0  5973   24
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_22.png
early stop counter: 3
val acc:0.9672402143478394, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9775605201721191 / 0.9788427352905273
after epoch: 22,now: 2024-06-07 02:50:35.987995,epoch time: 0:19:55.153910,used: 7:20:55.578638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9657037, 'precision': 0.74027026, 'recall': 0.64997566, 'specificity': 0.64997566, 'f1': 0.6835665, 'auroc': 0.9252539, 'binary_precision': 0.5048335, 'binary_recall': 0.31084657, 'binary_specificity': 0.98910475, 'binary_f1_score': 0.38477284}
confusion matrix:
       0    1
0  41851  461
1   1042  470
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74233556, 'recall': 0.6687777, 'specificity': 0.6687777, 'f1': 0.69831806, 'auroc': 0.9267936, 'binary_precision': 0.5060241, 'binary_recall': 0.3488372, 'binary_specificity': 0.9887183, 'binary_f1_score': 0.41297933}
confusion matrix:
       0    1
0  17966  205
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.90684235, 'recall': 0.76436114, 'specificity': 0.76436114, 'f1': 0.8191842, 'auroc': 0.9148593, 'binary_precision': 0.83225805, 'binary_recall': 0.53305787, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.64987403}
confusion matrix:
      0    1
0  5971   26
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_23.png
better model found
persisted
after epoch: 23,now: 2024-06-07 03:10:30.796543,epoch time: 0:19:54.808548,used: 7:40:50.387186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9653158, 'precision': 0.7367219, 'recall': 0.66561633, 'specificity': 0.66561633, 'f1': 0.6941931, 'auroc': 0.93230474, 'binary_precision': 0.4966571, 'binary_recall': 0.34368804, 'binary_specificity': 0.9875446, 'binary_f1_score': 0.40625}
confusion matrix:
       0    1
0  41784  527
1    993  520
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74029344, 'recall': 0.68151647, 'specificity': 0.68151647, 'f1': 0.7063904, 'auroc': 0.9263721, 'binary_precision': 0.50110865, 'binary_recall': 0.3754153, 'binary_specificity': 0.9876176, 'binary_f1_score': 0.42924976}
confusion matrix:
       0    1
0  17946  225
1    376  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.89585596, 'recall': 0.7701427, 'specificity': 0.7701427, 'f1': 0.8200865, 'auroc': 0.90873814, 'binary_precision': 0.80981594, 'binary_recall': 0.54545456, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6518519}
confusion matrix:
      0    1
0  5966   31
1   110  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_24.png
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9777207970619202 / 0.9788427352905273
after epoch: 24,now: 2024-06-07 03:30:25.296393,epoch time: 0:19:54.499850,used: 8:00:44.887036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96508765, 'precision': 0.7334949, 'recall': 0.6511588, 'specificity': 0.6511588, 'f1': 0.68255, 'auroc': 0.9284353, 'binary_precision': 0.49120992, 'binary_recall': 0.3139458, 'binary_specificity': 0.9883718, 'binary_f1_score': 0.3830645}
confusion matrix:
       0    1
0  41819  492
1   1038  475
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.73858374, 'recall': 0.6934521, 'specificity': 0.6934521, 'f1': 0.71341413, 'auroc': 0.9273945, 'binary_precision': 0.4969072, 'binary_recall': 0.4003322, 'binary_specificity': 0.986572, 'binary_f1_score': 0.44342223}
confusion matrix:
       0    1
0  17927  244
1    361  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.89603186, 'recall': 0.77832377, 'specificity': 0.77832377, 'f1': 0.8259897, 'auroc': 0.92302835, 'binary_precision': 0.8095238, 'binary_recall': 0.56198347, 'binary_specificity': 0.994664, 'binary_f1_score': 0.66341466}
confusion matrix:
      0    1
0  5965   32
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_25.png
early stop counter: 2
val acc:0.9677728414535522, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9777207970619202 / 0.9788427352905273
after epoch: 25,now: 2024-06-07 03:50:21.762647,epoch time: 0:19:56.466254,used: 8:20:41.353290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96584064, 'precision': 0.7426131, 'recall': 0.6878751, 'specificity': 0.6878751, 'f1': 0.7113782, 'auroc': 0.9332868, 'binary_precision': 0.5068847, 'binary_recall': 0.3892928, 'binary_specificity': 0.9864574, 'binary_f1_score': 0.44037384}
confusion matrix:
       0    1
0  41738  573
1    924  589
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74520236, 'recall': 0.721889, 'specificity': 0.721889, 'f1': 0.73290265, 'auroc': 0.93003696, 'binary_precision': 0.5082873, 'binary_recall': 0.45847178, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.48209608}
confusion matrix:
       0    1
0  17904  267
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.8651477, 'recall': 0.78327143, 'specificity': 0.78327143, 'f1': 0.8185423, 'auroc': 0.9189975, 'binary_precision': 0.74731183, 'binary_recall': 0.57438016, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.64953274}
confusion matrix:
      0    1
0  5950   47
1   103  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_26.png
better model found
persisted
after epoch: 26,now: 2024-06-07 04:10:16.996442,epoch time: 0:19:55.233795,used: 8:40:36.587085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9660688, 'precision': 0.74485314, 'recall': 0.7142578, 'specificity': 0.7142578, 'f1': 0.72842056, 'auroc': 0.9300095, 'binary_precision': 0.50949126, 'binary_recall': 0.44378307, 'binary_specificity': 0.98473245, 'binary_f1_score': 0.47437257}
confusion matrix:
       0    1
0  41666  646
1    841  671
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.74010646, 'recall': 0.73199844, 'specificity': 0.73199844, 'f1': 0.73597527, 'auroc': 0.932064, 'binary_precision': 0.49741825, 'binary_recall': 0.48006645, 'binary_specificity': 0.9839304, 'binary_f1_score': 0.48858836}
confusion matrix:
       0    1
0  17879  292
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9748357, 'precision': 0.8560277, 'recall': 0.7747569, 'specificity': 0.7747569, 'f1': 0.8096453, 'auroc': 0.9140066, 'binary_precision': 0.7297297, 'binary_recall': 0.55785125, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.63231856}
confusion matrix:
      0    1
0  5947   50
1   107  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_27.png
early stop counter: 1
val acc:0.9677728414535522, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9759576916694641 / 0.9788427352905273
after epoch: 27,now: 2024-06-07 04:30:12.539873,epoch time: 0:19:55.543431,used: 9:00:32.130516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96501917, 'precision': 0.7336728, 'recall': 0.6654627, 'specificity': 0.6654627, 'f1': 0.693089, 'auroc': 0.92905915, 'binary_precision': 0.49056605, 'binary_recall': 0.34368804, 'binary_specificity': 0.98723733, 'binary_f1_score': 0.40419742}
confusion matrix:
       0    1
0  41771  540
1    993  520
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7465194, 'recall': 0.69707704, 'specificity': 0.69707704, 'f1': 0.71876216, 'auroc': 0.9293119, 'binary_precision': 0.5125523, 'binary_recall': 0.40697673, 'binary_specificity': 0.9871774, 'binary_f1_score': 0.4537037}
confusion matrix:
       0    1
0  17938  233
1    357  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767591, 'precision': 0.876894, 'recall': 0.7817056, 'specificity': 0.7817056, 'f1': 0.8217778, 'auroc': 0.9092661, 'binary_precision': 0.7709497, 'binary_recall': 0.57024795, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.65558195}
confusion matrix:
      0    1
0  5956   41
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_28.png
better model found
persisted
after epoch: 28,now: 2024-06-07 04:50:10.328250,epoch time: 0:19:57.788377,used: 9:20:29.918893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9651561, 'precision': 0.734717, 'recall': 0.65916055, 'specificity': 0.65916055, 'f1': 0.6888935, 'auroc': 0.9317955, 'binary_precision': 0.49309665, 'binary_recall': 0.33046928, 'binary_specificity': 0.98785186, 'binary_f1_score': 0.39572617}
confusion matrix:
       0    1
0  41797  514
1   1013  500
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.73345304, 'recall': 0.6915709, 'specificity': 0.6915709, 'f1': 0.7102287, 'auroc': 0.93229795, 'binary_precision': 0.48676172, 'binary_recall': 0.39700997, 'binary_specificity': 0.9861317, 'binary_f1_score': 0.4373285}
confusion matrix:
       0    1
0  17919  252
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.879061, 'recall': 0.78178895, 'specificity': 0.78178895, 'f1': 0.8226003, 'auroc': 0.9230599, 'binary_precision': 0.7752809, 'binary_recall': 0.57024795, 'binary_specificity': 0.99333, 'binary_f1_score': 0.6571429}
confusion matrix:
      0    1
0  5957   40
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_29.png
early stop counter: 1
val acc:0.9672402143478394, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9767590761184692 / 0.9788427352905273
after epoch: 29,now: 2024-06-07 05:10:04.289644,epoch time: 0:19:53.961394,used: 9:40:23.880287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96622854, 'precision': 0.74636966, 'recall': 0.69094384, 'specificity': 0.69094384, 'f1': 0.7147591, 'auroc': 0.93513405, 'binary_precision': 0.51418746, 'binary_recall': 0.39524123, 'binary_specificity': 0.9866465, 'binary_f1_score': 0.4469357}
confusion matrix:
       0    1
0  41746  565
1    915  598
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7419603, 'recall': 0.70405686, 'specificity': 0.70405686, 'f1': 0.72122973, 'auroc': 0.93234646, 'binary_precision': 0.5029703, 'binary_recall': 0.42192692, 'binary_specificity': 0.9861868, 'binary_f1_score': 0.45889792}
confusion matrix:
       0    1
0  17920  251
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.89640987, 'recall': 0.79468596, 'specificity': 0.79468596, 'f1': 0.8373836, 'auroc': 0.9186115, 'binary_precision': 0.80898875, 'binary_recall': 0.59504133, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6857143}
confusion matrix:
      0    1
0  5963   34
1    98  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127980_30.png
early stop counter: 2
val acc:0.9680925011634827, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9767590761184692 / 0.9788427352905273
after epoch: 30,now: 2024-06-07 05:30:03.089233,epoch time: 0:19:58.799589,used: 10:00:22.679876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_19_29_40_seed_2_21127980
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:00:22.679876 at 2024-06-07 05:30:03.089233
persisted model performance metric: 

scalar performance:
{'acc': 0.9770797, 'precision': 0.889228, 'recall': 0.77195865, 'specificity': 0.77195865, 'f1': 0.81925905, 'auroc': 0.92168605, 'binary_precision': 0.79640716, 'binary_recall': 0.5495868, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6503667}
confusion matrix:
      0    1
0  5963   34
1   109  133
oracle model performance metric: 

scalar performance:
{'acc': 0.97740024, 'precision': 0.9076916, 'recall': 0.7582462, 'specificity': 0.7582462, 'f1': 0.814777, 'auroc': 0.9138757, 'binary_precision': 0.8344371, 'binary_recall': 0.5206612, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6412214}
confusion matrix:
      0    1
0  5972   25
1   116  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |  88732 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11390 MiB |  30058 MiB |  18822 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    124 MiB |    126 MiB |    178 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1345 MiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      6 MiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  413732 K  |  413728 K  |
|       from large pool |      87    |     909    |  194832 K  |  194832 K  |
|       from small pool |    3630    |    6639    |  218899 K  |  218896 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  413732 K  |  413728 K  |
|       from large pool |      87    |     909    |  194832 K  |  194832 K  |
|       from small pool |    3630    |    6639    |  218899 K  |  218896 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     537    |     303    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      62    |      63    |      89    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  217257 K  |  217257 K  |
|       from large pool |      24    |      65    |  101690 K  |  101690 K  |
|       from small pool |      50    |    2751    |  115567 K  |  115567 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |      0 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1830 MiB |  11390 MiB |  30058 MiB |  28228 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     94 MiB |    126 MiB |    178 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      0 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  413732 K  |  413732 K  |
|       from large pool |       2    |     909    |  194832 K  |  194832 K  |
|       from small pool |       0    |    6639    |  218899 K  |  218899 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  413732 K  |  413732 K  |
|       from large pool |       2    |     909    |  194832 K  |  194832 K  |
|       from small pool |       0    |    6639    |  218899 K  |  218899 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     234    |     537    |     456    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      47    |      63    |      89    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  217259 K  |  217259 K  |
|       from large pool |       4    |      65    |  101690 K  |  101690 K  |
|       from small pool |       0    |    2751    |  115569 K  |  115569 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun  7 05:32:08 2024]
Finished job 0.
1 of 1 steps (100%) done
