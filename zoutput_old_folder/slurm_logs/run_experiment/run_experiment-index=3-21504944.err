Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 02:30:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944

 Experiment start at: 2024-06-19 02:48:55.938316
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.5332645, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.32716095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.2985963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 03:25:34.283050,epoch time: 0:36:38.344734,used: 0:36:38.344734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.76126087, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37072143, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.42703474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 2,now: 2024-06-19 03:54:18.987638,epoch time: 0:28:44.704588,used: 1:05:23.049322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90864724, 'precision': 0.924327, 'recall': 0.5176621, 'specificity': 0.5176621, 'f1': 0.51024866, 'auroc': 0.8797358, 'binary_precision': 0.94011974, 'binary_recall': 0.03556059, 'binary_specificity': 0.9997636, 'binary_f1_score': 0.06852903}
confusion matrix:
       0    1
0  42295   10
1   4258  157
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.443779, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.6100732, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 3,now: 2024-06-19 04:22:53.026812,epoch time: 0:28:34.039174,used: 1:33:57.088496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9264769, 'precision': 0.94393814, 'recall': 0.6149554, 'specificity': 0.6149554, 'f1': 0.66666234, 'auroc': 0.9084021, 'binary_precision': 0.96222854, 'binary_recall': 0.23085636, 'binary_specificity': 0.9990545, 'binary_f1_score': 0.37237343}
confusion matrix:
       0     1
0  42266    40
1   3395  1019
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.49246758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8853982, 'precision': 0.94264835, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4771841, 'auroc': 0.67374045, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   777  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_4.png
new oracle model saved
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8853982090950012
after epoch: 4,now: 2024-06-19 04:51:44.713884,epoch time: 0:28:51.687072,used: 2:02:48.775568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9395762, 'precision': 0.9422715, 'recall': 0.6902347, 'specificity': 0.6902347, 'f1': 0.75626874, 'auroc': 0.915712, 'binary_precision': 0.94519013, 'binary_recall': 0.38278595, 'binary_specificity': 0.99768347, 'binary_f1_score': 0.5448976}
confusion matrix:
       0     1
0  42207    98
1   2725  1690
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.4828707, 'recall': 0.49936634, 'specificity': 0.49936634, 'f1': 0.49098, 'auroc': 0.4964167, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18126  23
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.889823, 'precision': 0.88246435, 'recall': 0.5263197, 'specificity': 0.5263197, 'f1': 0.52119905, 'auroc': 0.6901133, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5991   6
1   741  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_5.png
new oracle model saved
early stop counter: 4
val acc:0.9645593762397766, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8898230195045471
after epoch: 5,now: 2024-06-19 05:20:20.136529,epoch time: 0:28:35.422645,used: 2:31:24.198213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.947881, 'precision': 0.94488454, 'recall': 0.7375231, 'specificity': 0.7375231, 'f1': 0.80308056, 'auroc': 0.9314892, 'binary_precision': 0.94157004, 'binary_recall': 0.4781427, 'binary_specificity': 0.9969034, 'binary_f1_score': 0.63421965}
confusion matrix:
       0     1
0  42174   131
1   2304  2111
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.51702243, 'recall': 0.5012033, 'specificity': 0.5012033, 'f1': 0.49513844, 'auroc': 0.5411465, 'binary_precision': 0.06818182, 'binary_recall': 0.00466563, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.0087336255}
confusion matrix:
       0   1
0  18108  41
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8955752, 'precision': 0.867187, 'recall': 0.55788624, 'specificity': 0.55788624, 'f1': 0.576078, 'auroc': 0.7338656, 'binary_precision': 0.8378378, 'binary_recall': 0.118773945, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20805368}
confusion matrix:
      0   1
0  5979  18
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_6.png
new oracle model saved
early stop counter: 5
val acc:0.9637611508369446, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.895575225353241
after epoch: 6,now: 2024-06-19 05:48:56.088407,epoch time: 0:28:35.951878,used: 3:00:00.150091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95646405, 'precision': 0.94637215, 'recall': 0.7876561, 'specificity': 0.7876561, 'f1': 0.84597635, 'auroc': 0.94632125, 'binary_precision': 0.93494153, 'binary_recall': 0.5795197, 'binary_specificity': 0.99579257, 'binary_f1_score': 0.71552444}
confusion matrix:
       0     1
0  42128   178
1   1856  2558
---- Validation: 
scalar performance:
{'acc': 0.9615794, 'precision': 0.52062815, 'recall': 0.50307393, 'specificity': 0.50307393, 'f1': 0.4997139, 'auroc': 0.5835215, 'binary_precision': 0.07526882, 'binary_recall': 0.01088647, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.019021738}
confusion matrix:
       0   1
0  18063  86
1    636   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9061947, 'precision': 0.8720834, 'recall': 0.61385673, 'specificity': 0.61385673, 'f1': 0.6573122, 'auroc': 0.764853, 'binary_precision': 0.8356164, 'binary_recall': 0.23371647, 'binary_specificity': 0.993997, 'binary_f1_score': 0.36526945}
confusion matrix:
      0    1
0  5961   36
1   600  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_7.png
new oracle model saved
early stop counter: 6
val acc:0.9615793824195862, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9061946868896484
after epoch: 7,now: 2024-06-19 06:18:57.726325,epoch time: 0:30:01.637918,used: 3:30:01.788009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95650685, 'precision': 0.9373294, 'recall': 0.7942382, 'specificity': 0.7942382, 'f1': 0.8485333, 'auroc': 0.9454478, 'binary_precision': 0.9154733, 'binary_recall': 0.5941963, 'binary_specificity': 0.99428016, 'binary_f1_score': 0.72064894}
confusion matrix:
       0     1
0  42067   242
1   1790  2621
---- Validation: 
scalar performance:
{'acc': 0.96099406, 'precision': 0.53574, 'recall': 0.5065212, 'specificity': 0.5065212, 'f1': 0.5059001, 'auroc': 0.6146023, 'binary_precision': 0.10526316, 'binary_recall': 0.01866252, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.031704094}
confusion matrix:
       0    1
0  18047  102
1    631   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9126844, 'precision': 0.8767085, 'recall': 0.64750576, 'specificity': 0.64750576, 'f1': 0.6986351, 'auroc': 0.7892171, 'binary_precision': 0.8374558, 'binary_recall': 0.30268198, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.44465292}
confusion matrix:
      0    1
0  5951   46
1   546  237
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_8.png
new oracle model saved
early stop counter: 7
val acc:0.9609940648078918, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9126843810081482
after epoch: 8,now: 2024-06-19 06:48:38.671211,epoch time: 0:29:40.944886,used: 3:59:42.732895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.959268, 'precision': 0.938153, 'recall': 0.8108321, 'specificity': 0.8108321, 'f1': 0.86109746, 'auroc': 0.95372695, 'binary_precision': 0.9138898, 'binary_recall': 0.6278332, 'binary_specificity': 0.993831, 'binary_f1_score': 0.7443235}
confusion matrix:
       0     1
0  42047   261
1   1642  2770
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.5620329, 'recall': 0.51574844, 'specificity': 0.51574844, 'f1': 0.52094966, 'auroc': 0.62557256, 'binary_precision': 0.1572327, 'binary_recall': 0.038880248, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.06234414}
confusion matrix:
       0    1
0  18015  134
1    618   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9166667, 'precision': 0.8738469, 'recall': 0.6714095, 'specificity': 0.6714095, 'f1': 0.7243869, 'auroc': 0.801618, 'binary_precision': 0.8263473, 'binary_recall': 0.35249043, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.4941808}
confusion matrix:
      0    1
0  5939   58
1   507  276
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_9.png
new oracle model saved
early stop counter: 8
val acc:0.9599829912185669, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9166666865348816
after epoch: 9,now: 2024-06-19 07:17:27.684189,epoch time: 0:28:49.012978,used: 4:28:31.745873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9602098, 'precision': 0.92522967, 'recall': 0.8280512, 'specificity': 0.8280512, 'f1': 0.8688014, 'auroc': 0.95132565, 'binary_precision': 0.88446456, 'binary_recall': 0.6651543, 'binary_specificity': 0.9909482, 'binary_f1_score': 0.75929046}
confusion matrix:
       0     1
0  41929   383
1   1476  2932
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.57646453, 'recall': 0.52364093, 'specificity': 0.52364093, 'f1': 0.5326018, 'auroc': 0.64404345, 'binary_precision': 0.185567, 'binary_recall': 0.05598756, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.086021505}
confusion matrix:
       0    1
0  17991  158
1    607   36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91902655, 'precision': 0.86528933, 'recall': 0.6910649, 'specificity': 0.6910649, 'f1': 0.7426319, 'auroc': 0.81042755, 'binary_precision': 0.8046875, 'binary_recall': 0.394636, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.52956295}
confusion matrix:
      0    1
0  5922   75
1   474  309
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_10.png
new oracle model saved
early stop counter: 9
val acc:0.9592911601066589, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9190265536308289
after epoch: 10,now: 2024-06-19 07:46:37.101586,epoch time: 0:29:09.417397,used: 4:57:41.163270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9601883, 'precision': 0.92729306, 'recall': 0.82616055, 'specificity': 0.82616055, 'f1': 0.8682494, 'auroc': 0.9545423, 'binary_precision': 0.8890244, 'binary_recall': 0.66092473, 'binary_specificity': 0.9913964, 'binary_f1_score': 0.7581903}
confusion matrix:
       0     1
0  41944   364
1   1496  2916
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.59193164, 'recall': 0.5331988, 'specificity': 0.5331988, 'f1': 0.54580814, 'auroc': 0.66312104, 'binary_precision': 0.21585903, 'binary_recall': 0.07620529, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.11264369}
confusion matrix:
       0    1
0  17971  178
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219764, 'precision': 0.8687933, 'recall': 0.7060571, 'specificity': 0.7060571, 'f1': 0.7572701, 'auroc': 0.8227134, 'binary_precision': 0.80825245, 'binary_recall': 0.42528737, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.5573222}
confusion matrix:
      0    1
0  5918   79
1   450  333
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_11.png
new oracle model saved
early stop counter: 10
val acc:0.9589186906814575, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9219763875007629
after epoch: 11,now: 2024-06-19 08:17:05.514158,epoch time: 0:30:28.412572,used: 5:28:09.575842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9652611, 'precision': 0.92922544, 'recall': 0.8575871, 'specificity': 0.8575871, 'f1': 0.88930285, 'auroc': 0.9625294, 'binary_precision': 0.8866094, 'binary_recall': 0.72484136, 'binary_specificity': 0.9903328, 'binary_f1_score': 0.79760575}
confusion matrix:
       0     1
0  41899   409
1   1214  3198
---- Validation: 
scalar performance:
{'acc': 0.95812047, 'precision': 0.6058981, 'recall': 0.5470366, 'specificity': 0.5470366, 'f1': 0.56293935, 'auroc': 0.674119, 'binary_precision': 0.24285714, 'binary_recall': 0.10575428, 'binary_specificity': 0.9883189, 'binary_f1_score': 0.14734562}
confusion matrix:
       0    1
0  17937  212
1    575   68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9261062, 'precision': 0.8700713, 'recall': 0.7300441, 'specificity': 0.7300441, 'f1': 0.7784541, 'auroc': 0.82450616, 'binary_precision': 0.8051948, 'binary_recall': 0.47509578, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5975903}
confusion matrix:
      0    1
0  5907   90
1   411  372
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_12.png
new oracle model saved
early stop counter: 11
val acc:0.9581204652786255, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9261062145233154
after epoch: 12,now: 2024-06-19 08:46:21.968905,epoch time: 0:29:16.454747,used: 5:57:26.030589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96391267, 'precision': 0.915975, 'recall': 0.86346996, 'specificity': 0.86346996, 'f1': 0.88747895, 'auroc': 0.96068704, 'binary_precision': 0.8587214, 'binary_recall': 0.7396329, 'binary_specificity': 0.9873071, 'binary_f1_score': 0.7947406}
confusion matrix:
       0     1
0  41770   537
1   1149  3264
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.60888135, 'recall': 0.5534565, 'specificity': 0.5534565, 'f1': 0.5698914, 'auroc': 0.6826973, 'binary_precision': 0.2483871, 'binary_recall': 0.11975116, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.16159496}
confusion matrix:
       0    1
0  17916  233
1    566   77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92477876, 'precision': 0.84930456, 'recall': 0.74428403, 'specificity': 0.74428403, 'f1': 0.784233, 'auroc': 0.8284615, 'binary_precision': 0.76, 'binary_recall': 0.5095785, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.6100918}
confusion matrix:
      0    1
0  5871  126
1   384  399
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_13.png
early stop counter: 12
val acc:0.9574819207191467, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9261062145233154
after epoch: 13,now: 2024-06-19 09:18:55.911079,epoch time: 0:32:33.942174,used: 6:29:59.972763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96329194, 'precision': 0.90905327, 'recall': 0.86773914, 'specificity': 0.86773914, 'f1': 0.88699585, 'auroc': 0.961812, 'binary_precision': 0.84387755, 'binary_recall': 0.7499433, 'binary_specificity': 0.98553497, 'binary_f1_score': 0.79414237}
confusion matrix:
       0     1
0  41697   612
1   1103  3308
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.5998522, 'recall': 0.5589397, 'specificity': 0.5589397, 'f1': 0.5730083, 'auroc': 0.69727457, 'binary_precision': 0.22994652, 'binary_recall': 0.13374805, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.16912487}
confusion matrix:
       0    1
0  17861  288
1    557   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92861354, 'precision': 0.85526896, 'recall': 0.76310766, 'specificity': 0.76310766, 'f1': 0.79986537, 'auroc': 0.84294575, 'binary_precision': 0.76744187, 'binary_recall': 0.54789275, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.63934433}
confusion matrix:
      0    1
0  5867  130
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_14.png
new oracle model saved
early stop counter: 13
val acc:0.955034077167511, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.928613543510437
after epoch: 14,now: 2024-06-19 09:50:32.507532,epoch time: 0:31:36.596453,used: 7:01:36.569216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9666096, 'precision': 0.9254359, 'recall': 0.87084514, 'specificity': 0.87084514, 'f1': 0.8957734, 'auroc': 0.9664431, 'binary_precision': 0.8762859, 'binary_recall': 0.7527759, 'binary_specificity': 0.9889144, 'binary_f1_score': 0.80984885}
confusion matrix:
       0     1
0  41838   469
1   1091  3322
---- Validation: 
scalar performance:
{'acc': 0.9563112, 'precision': 0.6181761, 'recall': 0.57085174, 'specificity': 0.57085174, 'f1': 0.5875014, 'auroc': 0.70959234, 'binary_precision': 0.26578948, 'binary_recall': 0.15707621, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.19745846}
confusion matrix:
       0    1
0  17870  279
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318584, 'precision': 0.8710896, 'recall': 0.7649419, 'specificity': 0.7649419, 'f1': 0.8061274, 'auroc': 0.84605396, 'binary_precision': 0.79888266, 'binary_recall': 0.54789275, 'binary_specificity': 0.981991, 'binary_f1_score': 0.65000004}
confusion matrix:
      0    1
0  5889  108
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_15.png
new oracle model saved
early stop counter: 14
val acc:0.9563112258911133, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 15,now: 2024-06-19 10:24:10.321408,epoch time: 0:33:37.813876,used: 7:35:14.383092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659889, 'precision': 0.91852605, 'recall': 0.87489295, 'specificity': 0.87489295, 'f1': 0.8951847, 'auroc': 0.9659498, 'binary_precision': 0.8615306, 'binary_recall': 0.7625736, 'binary_specificity': 0.98721224, 'binary_f1_score': 0.8090374}
confusion matrix:
       0     1
0  41765   541
1   1048  3366
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.6124791, 'recall': 0.5724682, 'specificity': 0.5724682, 'f1': 0.5873078, 'auroc': 0.70480216, 'binary_precision': 0.25427872, 'binary_recall': 0.16174184, 'binary_specificity': 0.98319465, 'binary_f1_score': 0.19771862}
confusion matrix:
       0    1
0  17844  305
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9277286, 'precision': 0.8511665, 'recall': 0.76260734, 'specificity': 0.76260734, 'f1': 0.798187, 'auroc': 0.8430959, 'binary_precision': 0.759292, 'binary_recall': 0.54789275, 'binary_specificity': 0.977322, 'binary_f1_score': 0.6364986}
confusion matrix:
      0    1
0  5861  136
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_16.png
early stop counter: 15
val acc:0.9550872445106506, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 16,now: 2024-06-19 10:58:31.931062,epoch time: 0:34:21.609654,used: 8:09:35.992746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96538955, 'precision': 0.91260326, 'recall': 0.8783417, 'specificity': 0.8783417, 'f1': 0.8945255, 'auroc': 0.9671198, 'binary_precision': 0.8488778, 'binary_recall': 0.77100796, 'binary_specificity': 0.98567545, 'binary_f1_score': 0.80807126}
confusion matrix:
       0     1
0  41699   606
1   1011  3404
---- Validation: 
scalar performance:
{'acc': 0.95604515, 'precision': 0.6170858, 'recall': 0.57146406, 'specificity': 0.57146406, 'f1': 0.58773077, 'auroc': 0.70870376, 'binary_precision': 0.2635659, 'binary_recall': 0.15863141, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.19805825}
confusion matrix:
       0    1
0  17864  285
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93156344, 'precision': 0.8695983, 'recall': 0.76477516, 'specificity': 0.76477516, 'f1': 0.805551, 'auroc': 0.8467586, 'binary_precision': 0.79591835, 'binary_recall': 0.54789275, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.6490167}
confusion matrix:
      0    1
0  5887  110
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_17.png
early stop counter: 16
val acc:0.9560451507568359, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 17,now: 2024-06-19 11:38:12.429439,epoch time: 0:39:40.498377,used: 8:49:16.491123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9655394, 'precision': 0.9142338, 'recall': 0.87715507, 'specificity': 0.87715507, 'f1': 0.8945874, 'auroc': 0.9658377, 'binary_precision': 0.8524013, 'binary_recall': 0.7681849, 'binary_specificity': 0.98612523, 'binary_f1_score': 0.80810493}
confusion matrix:
       0     1
0  41720   587
1   1023  3390
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.6093148, 'recall': 0.57563996, 'specificity': 0.57563996, 'f1': 0.5887974, 'auroc': 0.7010126, 'binary_precision': 0.24772727, 'binary_recall': 0.16951789, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.20129272}
confusion matrix:
       0    1
0  17818  331
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9278761, 'precision': 0.84955776, 'recall': 0.7660219, 'specificity': 0.7660219, 'f1': 0.800049, 'auroc': 0.8457562, 'binary_precision': 0.7552083, 'binary_recall': 0.5555556, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.64017665}
confusion matrix:
      0    1
0  5856  141
1   348  435
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_18.png
early stop counter: 17
val acc:0.9539697766304016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 18,now: 2024-06-19 12:16:53.841775,epoch time: 0:38:41.412336,used: 9:27:57.903459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96472603, 'precision': 0.9051223, 'recall': 0.8839356, 'specificity': 0.8839356, 'f1': 0.89416385, 'auroc': 0.9699689, 'binary_precision': 0.83261186, 'binary_recall': 0.7843226, 'binary_specificity': 0.98354846, 'binary_f1_score': 0.8077461}
confusion matrix:
       0     1
0  41610   696
1    952  3462
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.61820257, 'recall': 0.58903074, 'specificity': 0.58903074, 'f1': 0.6011731, 'auroc': 0.7191224, 'binary_precision': 0.26458332, 'binary_recall': 0.19751166, 'binary_specificity': 0.9805499, 'binary_f1_score': 0.22617987}
confusion matrix:
       0    1
0  17796  353
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306785, 'precision': 0.8575804, 'recall': 0.7742684, 'specificity': 0.7742684, 'f1': 0.808444, 'auroc': 0.8534553, 'binary_precision': 0.76936316, 'binary_recall': 0.57088125, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.65542525}
confusion matrix:
      0    1
0  5863  134
1   336  447
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_19.png
early stop counter: 18
val acc:0.9537569284439087, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9318584203720093
after epoch: 19,now: 2024-06-19 12:50:30.635089,epoch time: 0:33:36.793314,used: 10:01:34.696773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_55_seed_0_21504944
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9691139, 'precision': 0.9227359, 'recall': 0.8912837, 'specificity': 0.8912837, 'f1': 0.90623605, 'auroc': 0.9730353, 'binary_precision': 0.8666337, 'binary_recall': 0.79533094, 'binary_specificity': 0.98723644, 'binary_f1_score': 0.82945275}
confusion matrix:
       0     1
0  41768   540
1    903  3509
---- Validation: 
scalar performance:
{'acc': 0.95663047, 'precision': 0.6297843, 'recall': 0.58301795, 'specificity': 0.58301795, 'f1': 0.60038114, 'auroc': 0.7227675, 'binary_precision': 0.28817734, 'binary_recall': 0.18195957, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.2230696}
confusion matrix:
       0    1
0  17860  289
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9324484, 'precision': 0.87262166, 'recall': 0.76694095, 'specificity': 0.76694095, 'f1': 0.8080654, 'auroc': 0.8490171, 'binary_precision': 0.8014842, 'binary_recall': 0.55172414, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.6535552}
confusion matrix:
      0    1
0  5890  107
1   351  432
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504944_20.png
[Wed Jun 19 13:25:55 2024]
--- Logging error ---
Traceback (most recent call last):
--- Logging error ---
--- Logging error ---
