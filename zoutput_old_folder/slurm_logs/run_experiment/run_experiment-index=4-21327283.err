Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 15 22:12:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283

 Experiment start at: 2024-06-15 22:21:01.134885
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.46933752, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4000511, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41037154, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:37:36.318711,epoch time: 0:16:35.183826,used: 0:16:35.183826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.4964997, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41896397, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42230088, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:52:27.602465,epoch time: 0:14:51.283754,used: 0:31:26.467580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5174817, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44702426, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.45679128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:07:17.274855,epoch time: 0:14:49.672390,used: 0:46:16.139970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5588546, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4749544, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49343926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:22:01.004325,epoch time: 0:14:43.729470,used: 1:00:59.869440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.5984708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5327063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.53818417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:36:39.141770,epoch time: 0:14:38.137445,used: 1:15:38.006885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6299052, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5621805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5828202, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-15 23:51:21.400899,epoch time: 0:14:42.259129,used: 1:30:20.266014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.68087864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6253981, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.63795197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:06:06.714089,epoch time: 0:14:45.313190,used: 1:45:05.579204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7232641, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6688752, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.703045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:20:43.305313,epoch time: 0:14:36.591224,used: 1:59:42.170428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.760735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.72240365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7375834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:35:42.811382,epoch time: 0:14:59.506069,used: 2:14:41.676497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7884635, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.76000404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.770283, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 00:50:39.480668,epoch time: 0:14:56.669286,used: 2:29:38.345783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7968625, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7795175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7944125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:05:39.641312,epoch time: 0:15:00.160644,used: 2:44:38.506427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.8262168, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8101679, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8118708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:20:14.562254,epoch time: 0:14:34.920942,used: 2:59:13.427369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.48319557, 'recall': 0.49997637, 'specificity': 0.49997637, 'f1': 0.49144277, 'auroc': 0.8366375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42326  2
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8236332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82585096, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 01:34:49.607275,epoch time: 0:14:35.045021,used: 3:13:48.472390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.48319557, 'recall': 0.49997637, 'specificity': 0.49997637, 'f1': 0.49144277, 'auroc': 0.85057664, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42326  2
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83123994, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82995313, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 01:49:35.893015,epoch time: 0:14:46.285740,used: 3:28:34.758130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96636987, 'precision': 0.67073894, 'recall': 0.50096065, 'specificity': 0.50096065, 'f1': 0.49347645, 'auroc': 0.8698189, 'binary_precision': 0.375, 'binary_recall': 0.002039429, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.0040567955}
confusion matrix:
       0  1
0  42324  5
1   1468  3
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84891444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.84444636, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:04:16.373378,epoch time: 0:14:40.480363,used: 3:43:15.238493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7332709, 'recall': 0.502295, 'specificity': 0.502295, 'f1': 0.49616385, 'auroc': 0.8627522, 'binary_precision': 0.5, 'binary_recall': 0.0047554346, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.009421265}
confusion matrix:
       0  1
0  42321  7
1   1465  7
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8519064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8442722, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_16.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:18:53.096823,epoch time: 0:14:36.723445,used: 3:57:51.961938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9666438, 'precision': 0.79461014, 'recall': 0.50931007, 'specificity': 0.50931007, 'f1': 0.5099715, 'auroc': 0.8736299, 'binary_precision': 0.62222224, 'binary_recall': 0.019021738, 'binary_specificity': 0.9995984, 'binary_f1_score': 0.03691496}
confusion matrix:
       0   1
0  42311  17
1   1444  28
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8630522, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85441136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_17.png
early stop counter: 16
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-16 02:33:39.044984,epoch time: 0:14:45.948161,used: 4:12:37.910099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96650684, 'precision': 0.7554586, 'recall': 0.5102228, 'specificity': 0.5102228, 'f1': 0.51175267, 'auroc': 0.8760046, 'binary_precision': 0.54385966, 'binary_recall': 0.021059783, 'binary_specificity': 0.9993858, 'binary_f1_score': 0.040549375}
confusion matrix:
       0   1
0  42302  26
1   1441  31
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.8657751, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85601693, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_18.png
early stop counter: 17
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 18,now: 2024-06-16 02:48:24.238139,epoch time: 0:14:45.193155,used: 4:27:23.103254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9665753, 'precision': 0.75382686, 'recall': 0.51550305, 'specificity': 0.51550305, 'f1': 0.5216594, 'auroc': 0.883394, 'binary_precision': 0.54022986, 'binary_recall': 0.031951055, 'binary_specificity': 0.999055, 'binary_f1_score': 0.060333766}
confusion matrix:
       0   1
0  42289  40
1   1424  47
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.8744825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.86346817, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_19.png
new oracle model saved
early stop counter: 18
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 19,now: 2024-06-16 03:02:59.861124,epoch time: 0:14:35.622985,used: 4:41:58.726239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.72579134, 'recall': 0.5150462, 'specificity': 0.5150462, 'f1': 0.5207832, 'auroc': 0.8835437, 'binary_precision': 0.48421052, 'binary_recall': 0.03125, 'binary_specificity': 0.99884236, 'binary_f1_score': 0.058710914}
confusion matrix:
       0   1
0  42279  49
1   1426  46
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.59404784, 'recall': 0.5013624, 'specificity': 0.5013624, 'f1': 0.4942946, 'auroc': 0.87660444, 'binary_precision': 0.22222222, 'binary_recall': 0.00311042, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.006134969}
confusion matrix:
       0  1
0  18142  7
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.86208093, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_20.png
early stop counter: 19
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 20,now: 2024-06-16 03:17:56.639099,epoch time: 0:14:56.777975,used: 4:56:55.504214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.7503102, 'recall': 0.52700275, 'specificity': 0.52700275, 'f1': 0.54192793, 'auroc': 0.88866675, 'binary_precision': 0.53246754, 'binary_recall': 0.055706523, 'binary_specificity': 0.998299, 'binary_f1_score': 0.10086102}
confusion matrix:
       0   1
0  42256  72
1   1390  82
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.70811313, 'recall': 0.5066954, 'specificity': 0.5066954, 'f1': 0.5048398, 'auroc': 0.88648796, 'binary_precision': 0.45, 'binary_recall': 0.01399689, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.027149322}
confusion matrix:
       0   1
0  18138  11
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8703617, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_21.png
new oracle model saved
early stop counter: 20
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 21,now: 2024-06-16 03:32:54.949599,epoch time: 0:14:58.310500,used: 5:11:53.814714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:11:53.814714 at 2024-06-16 03:32:54.949599
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41037154, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8703617, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212040 GiB | 212040 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211982 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9362 K  |    9361 K  |
|       from large pool |      36    |      76    |    3726 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5635 K  |    5634 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9362 K  |    9361 K  |
|       from large pool |      36    |      76    |    3726 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5635 K  |    5634 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4943 K  |    4943 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3558 K  |    3558 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9362 K  |    9362 K  |
|       from large pool |       2    |      76    |    3726 K  |    3726 K  |
|       from small pool |       0    |    1864    |    5635 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9362 K  |    9362 K  |
|       from large pool |       2    |      76    |    3726 K  |    3726 K  |
|       from small pool |       0    |    1864    |    5635 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     51 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9362 K  |    9362 K  |
|       from large pool |       2    |      76    |    3726 K  |    3726 K  |
|       from small pool |       0    |    1864    |    5635 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9362 K  |    9362 K  |
|       from large pool |       2    |      76    |    3726 K  |    3726 K  |
|       from small pool |       0    |    1864    |    5635 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283

 Experiment start at: 2024-06-16 03:40:49.490414
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48353896, 'recall': 0.4996459, 'specificity': 0.4996459, 'f1': 0.4914605, 'auroc': 0.42046148, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9992918, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42329  30
1   1441   0
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.4820121, 'recall': 0.49908674, 'specificity': 0.49908674, 'f1': 0.49040082, 'auroc': 0.3807199, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18034  33
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.332006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 03:55:44.272568,epoch time: 0:14:54.782154,used: 0:14:54.782154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.48358446, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49165526, 'auroc': 0.43482387, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42362  0
1   1438  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.37475276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3265851, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 04:10:39.040004,epoch time: 0:14:54.767436,used: 0:29:49.549590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.48359588, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166116, 'auroc': 0.4833681, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42363  0
1   1437  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4226269, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3818527, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 04:25:35.058751,epoch time: 0:14:56.018747,used: 0:44:45.568337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.51346123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4449417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.41588286, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 04:40:38.446735,epoch time: 0:15:03.387984,used: 0:59:48.956321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.56609666, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.49469775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.46103328, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 04:55:29.117372,epoch time: 0:14:50.670637,used: 1:14:39.626958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.48359588, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166116, 'auroc': 0.5772352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42363  0
1   1437  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.51584494, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.500821, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 05:10:37.131406,epoch time: 0:15:08.014034,used: 1:29:47.640992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.62616336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.56703925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5637221, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 05:25:31.309220,epoch time: 0:14:54.177814,used: 1:44:41.818806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.6688374, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.5880434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.60951483, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 05:40:15.141887,epoch time: 0:14:43.832667,used: 1:59:25.651473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.7173823, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6692524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.68849325, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 05:55:01.946173,epoch time: 0:14:46.804286,used: 2:14:12.455759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.74460375, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6914355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7120818, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 06:10:59.670493,epoch time: 0:15:57.724320,used: 2:30:10.180079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.77397454, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7237918, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.74513745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 06:26:01.969412,epoch time: 0:15:02.298919,used: 2:45:12.478998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.4835727, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.49164343, 'auroc': 0.7971054, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  1
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7573321, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7763603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 06:40:55.798637,epoch time: 0:14:53.829225,used: 3:00:06.308223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.48354986, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.4916317, 'auroc': 0.8186085, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  1
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7853758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.79099977, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 06:56:03.273039,epoch time: 0:15:07.474402,used: 3:15:13.782625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7335723, 'recall': 0.5003354, 'specificity': 0.5003354, 'f1': 0.49233672, 'auroc': 0.83441794, 'binary_precision': 0.5, 'binary_recall': 0.00069444446, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0013869626}
confusion matrix:
       0  1
0  42359  1
1   1439  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8041257, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8067901, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 07:10:56.593250,epoch time: 0:14:53.320211,used: 3:30:07.102836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.73359287, 'recall': 0.50134075, 'specificity': 0.50134075, 'f1': 0.49439734, 'auroc': 0.8416122, 'binary_precision': 0.5, 'binary_recall': 0.00277585, 'binary_specificity': 0.9999056, 'binary_f1_score': 0.005521049}
confusion matrix:
       0  1
0  42355  4
1   1437  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.83014536, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8215449, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 07:25:41.112269,epoch time: 0:14:44.519019,used: 3:44:51.621855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.73363554, 'recall': 0.50268143, 'specificity': 0.50268143, 'f1': 0.49712673, 'auroc': 0.85944796, 'binary_precision': 0.5, 'binary_recall': 0.0055517, 'binary_specificity': 0.9998111, 'binary_f1_score': 0.0109814685}
confusion matrix:
       0  1
0  42351  8
1   1433  8
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.83802795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8270128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 07:41:02.970002,epoch time: 0:15:21.857733,used: 4:00:13.479588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7436893, 'recall': 0.5043691, 'specificity': 0.5043691, 'f1': 0.50050855, 'auroc': 0.87013096, 'binary_precision': 0.52, 'binary_recall': 0.009021513, 'binary_specificity': 0.9997167, 'binary_f1_score': 0.017735336}
confusion matrix:
       0   1
0  42347  12
1   1428  13
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.8554912, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83590746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_17.png
early stop counter: 15
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 07:55:37.164456,epoch time: 0:14:34.194454,used: 4:14:47.674042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.74914646, 'recall': 0.5087563, 'specificity': 0.5087563, 'f1': 0.5091175, 'auroc': 0.87596667, 'binary_precision': 0.53061223, 'binary_recall': 0.018055556, 'binary_specificity': 0.99945706, 'binary_f1_score': 0.034922767}
confusion matrix:
       0   1
0  42337  23
1   1414  26
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.8566668, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8411699, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_18.png
early stop counter: 16
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 08:10:07.936723,epoch time: 0:14:30.772267,used: 4:29:18.446309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.6394936, 'recall': 0.5061015, 'specificity': 0.5061015, 'f1': 0.5041622, 'auroc': 0.87109625, 'binary_precision': 0.3114754, 'binary_recall': 0.013194445, 'binary_specificity': 0.9990085, 'binary_f1_score': 0.025316456}
confusion matrix:
       0   1
0  42318  42
1   1421  19
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7043641, 'recall': 0.50283337, 'specificity': 0.50283337, 'f1': 0.496707, 'auroc': 0.86262596, 'binary_precision': 0.44444445, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.011730205}
confusion matrix:
       0  1
0  18062  5
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.84851664, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_19.png
early stop counter: 17
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-16 08:24:44.069591,epoch time: 0:14:36.132868,used: 4:43:54.579177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96694064, 'precision': 0.7170704, 'recall': 0.5160059, 'specificity': 0.5160059, 'f1': 0.5226749, 'auroc': 0.881884, 'binary_precision': 0.46601942, 'binary_recall': 0.0333102, 'binary_specificity': 0.9987016, 'binary_f1_score': 0.062176164}
confusion matrix:
       0   1
0  42304  55
1   1393  48
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7489097, 'recall': 0.5057498, 'specificity': 0.5057498, 'f1': 0.50249547, 'auroc': 0.86746395, 'binary_precision': 0.53333336, 'binary_recall': 0.011887073, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.023255814}
confusion matrix:
       0  1
0  18060  7
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.84978235, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-16 08:39:39.967580,epoch time: 0:14:55.897989,used: 4:58:50.477166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.7308952, 'recall': 0.5241092, 'specificity': 0.5241092, 'f1': 0.5369804, 'auroc': 0.88716197, 'binary_precision': 0.49315068, 'binary_recall': 0.049965303, 'binary_specificity': 0.99825305, 'binary_f1_score': 0.090737246}
confusion matrix:
       0   1
0  42285  74
1   1369  72
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7867435, 'recall': 0.5101521, 'specificity': 0.5101521, 'f1': 0.5110349, 'auroc': 0.8726117, 'binary_precision': 0.6086956, 'binary_recall': 0.020802377, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.040229883}
confusion matrix:
       0   1
0  18058   9
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.8540483, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-16 08:54:18.269494,epoch time: 0:14:38.301914,used: 5:13:28.779080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96753424, 'precision': 0.7611538, 'recall': 0.53340685, 'specificity': 0.53340685, 'f1': 0.5528417, 'auroc': 0.8932595, 'binary_precision': 0.55307263, 'binary_recall': 0.06870229, 'binary_specificity': 0.99811137, 'binary_f1_score': 0.122222215}
confusion matrix:
       0   1
0  42279  80
1   1342  99
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7603216, 'recall': 0.51441604, 'specificity': 0.51441604, 'f1': 0.51911193, 'auroc': 0.8792771, 'binary_precision': 0.5555556, 'binary_recall': 0.029717682, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.056417488}
confusion matrix:
       0   1
0  18051  16
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.855072, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_22.png
new oracle model saved
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9593941569328308 / 0.9595552682876587
after epoch: 22,now: 2024-06-16 09:08:52.897173,epoch time: 0:14:34.627679,used: 5:28:03.406759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9677397, 'precision': 0.7675678, 'recall': 0.54088694, 'specificity': 0.54088694, 'f1': 0.5648914, 'auroc': 0.8925942, 'binary_precision': 0.56542057, 'binary_recall': 0.08396947, 'binary_specificity': 0.99780446, 'binary_f1_score': 0.14622357}
confusion matrix:
       0    1
0  42266   93
1   1320  121
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.75440735, 'recall': 0.5179924, 'specificity': 0.5179924, 'f1': 0.5256712, 'auroc': 0.88302994, 'binary_precision': 0.54347825, 'binary_recall': 0.0371471, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.06954102}
confusion matrix:
       0   1
0  18046  21
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8581238, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_23.png
new oracle model saved
early stop counter: 2
val acc:0.9643009901046753, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9593941569328308 / 0.9600386619567871
after epoch: 23,now: 2024-06-16 09:23:26.880145,epoch time: 0:14:33.982972,used: 5:42:37.389731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96737444, 'precision': 0.745489, 'recall': 0.54140425, 'specificity': 0.54140425, 'f1': 0.5651175, 'auroc': 0.89097846, 'binary_precision': 0.5211864, 'binary_recall': 0.085476026, 'binary_specificity': 0.99733245, 'binary_f1_score': 0.14686567}
confusion matrix:
       0    1
0  42248  113
1   1316  123
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7653037, 'recall': 0.518763, 'specificity': 0.518763, 'f1': 0.52708924, 'auroc': 0.8816278, 'binary_precision': 0.5652174, 'binary_recall': 0.038632985, 'binary_specificity': 0.998893, 'binary_f1_score': 0.07232267}
confusion matrix:
       0   1
0  18047  20
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.85774374, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 09:38:40.768333,epoch time: 0:15:13.888188,used: 5:57:51.277919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7402649, 'recall': 0.53927475, 'specificity': 0.53927475, 'f1': 0.5617043, 'auroc': 0.8918421, 'binary_precision': 0.510917, 'binary_recall': 0.08119362, 'binary_specificity': 0.99735594, 'binary_f1_score': 0.14011976}
confusion matrix:
       0    1
0  42247  112
1   1324  117
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.77619994, 'recall': 0.5195336, 'specificity': 0.5195336, 'f1': 0.5285073, 'auroc': 0.8845551, 'binary_precision': 0.5869565, 'binary_recall': 0.04011887, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.07510431}
confusion matrix:
       0   1
0  18048  19
1    646  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8590109, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_25.png
better model found
persisted
after epoch: 25,now: 2024-06-16 09:53:44.620146,epoch time: 0:15:03.851813,used: 6:12:55.129732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.73776805, 'recall': 0.54625666, 'specificity': 0.54625666, 'f1': 0.57208896, 'auroc': 0.8946227, 'binary_precision': 0.50549453, 'binary_recall': 0.09570041, 'binary_specificity': 0.9968129, 'binary_f1_score': 0.16093293}
confusion matrix:
       0    1
0  42223  135
1   1304  138
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7616159, 'recall': 0.5209088, 'specificity': 0.5209088, 'f1': 0.5309264, 'auroc': 0.8862029, 'binary_precision': 0.5576923, 'binary_recall': 0.043090638, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.08}
confusion matrix:
       0   1
0  18044  23
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.86028856, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_26.png
new oracle model saved
early stop counter: 1
val acc:0.9644076824188232, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9603609442710876
after epoch: 26,now: 2024-06-16 10:08:17.292673,epoch time: 0:14:32.672527,used: 6:27:27.802259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9674429, 'precision': 0.7464154, 'recall': 0.5555093, 'specificity': 0.5555093, 'f1': 0.5856578, 'auroc': 0.90061986, 'binary_precision': 0.5221519, 'binary_recall': 0.114583336, 'binary_specificity': 0.99643534, 'binary_f1_score': 0.18792711}
confusion matrix:
       0    1
0  42209  151
1   1275  165
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7635471, 'recall': 0.52308226, 'specificity': 0.52308226, 'f1': 0.53477436, 'auroc': 0.89146835, 'binary_precision': 0.5614035, 'binary_recall': 0.04754829, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.087671235}
confusion matrix:
       0   1
0  18042  25
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.86333406, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_27.png
new oracle model saved
early stop counter: 2
val acc:0.9644610285758972, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9606832265853882
after epoch: 27,now: 2024-06-16 10:22:56.700004,epoch time: 0:14:39.407331,used: 6:42:07.209590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9667352, 'precision': 0.7220412, 'recall': 0.5511184, 'specificity': 0.5511184, 'f1': 0.5782969, 'auroc': 0.89883876, 'binary_precision': 0.47368422, 'binary_recall': 0.10625, 'binary_specificity': 0.99598676, 'binary_f1_score': 0.17356779}
confusion matrix:
       0    1
0  42190  170
1   1287  153
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7516, 'recall': 0.52588797, 'specificity': 0.52588797, 'f1': 0.53955775, 'auroc': 0.89454275, 'binary_precision': 0.53731346, 'binary_recall': 0.053491827, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.097297296}
confusion matrix:
       0   1
0  18036  31
1    637  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8653736, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_28.png
early stop counter: 3
val acc:0.9643543362617493, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9606832265853882
after epoch: 28,now: 2024-06-16 10:37:35.715490,epoch time: 0:14:39.015486,used: 6:56:46.225076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.73239183, 'recall': 0.5638084, 'specificity': 0.5638084, 'f1': 0.5958756, 'auroc': 0.90218127, 'binary_precision': 0.4935065, 'binary_recall': 0.1322199, 'binary_specificity': 0.9953969, 'binary_f1_score': 0.20856202}
confusion matrix:
       0    1
0  42168  195
1   1247  190
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.75876176, 'recall': 0.5309779, 'specificity': 0.5309779, 'f1': 0.5482042, 'auroc': 0.89633036, 'binary_precision': 0.55128205, 'binary_recall': 0.06389301, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.11451397}
confusion matrix:
       0   1
0  18032  35
1    630  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.8666293, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_29.png
new oracle model saved
early stop counter: 4
val acc:0.964514434337616, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9608443379402161
after epoch: 29,now: 2024-06-16 10:52:38.362830,epoch time: 0:15:02.647340,used: 7:11:48.872416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96703196, 'precision': 0.7325053, 'recall': 0.5653947, 'specificity': 0.5653947, 'f1': 0.5979067, 'auroc': 0.9047811, 'binary_precision': 0.49367088, 'binary_recall': 0.13551077, 'binary_specificity': 0.99527866, 'binary_f1_score': 0.21264996}
confusion matrix:
       0    1
0  42161  200
1   1244  195
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7690646, 'recall': 0.53755367, 'specificity': 0.53755367, 'f1': 0.55907494, 'auroc': 0.89670527, 'binary_precision': 0.5714286, 'binary_recall': 0.07726597, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.13612564}
confusion matrix:
       0   1
0  18028  39
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8689295, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_30.png
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-06-16 11:08:12.852344,epoch time: 0:15:34.489514,used: 7:27:23.361930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_40_49_seed_1_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:27:23.361930 at 2024-06-16 11:08:12.852344
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8689295, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
oracle model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8689295, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527769 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283

 Experiment start at: 2024-06-16 11:16:40.528740
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.43229562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.35916567, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3632412, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 11:33:31.487632,epoch time: 0:16:50.958892,used: 0:16:50.958892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.45376733, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.39178917, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.35970223, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 11:48:54.751720,epoch time: 0:15:23.264088,used: 0:32:14.222980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.4975842, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.43322694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4067461, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 12:04:20.432383,epoch time: 0:15:25.680663,used: 0:47:39.903643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5221641, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4533844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.427796, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 12:19:49.083516,epoch time: 0:15:28.651133,used: 1:03:08.554776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.5521742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49415946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.46905237, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 12:35:38.541022,epoch time: 0:15:49.457506,used: 1:18:58.012282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.6092548, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.56054324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5289902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 12:50:22.644952,epoch time: 0:14:44.103930,used: 1:33:42.116212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.6451778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.5814654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.58079314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 13:05:06.487862,epoch time: 0:14:43.842910,used: 1:48:25.959122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.70892406, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6483305, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.64956707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 13:20:31.477463,epoch time: 0:15:24.989601,used: 2:03:50.948723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7309514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7094358, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.70297253, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 13:35:07.980268,epoch time: 0:14:36.502805,used: 2:18:27.451528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.78041434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.74947965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7308344, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 13:49:42.377056,epoch time: 0:14:34.396788,used: 2:33:01.848316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7887765, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7725565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7673405, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 14:04:18.849789,epoch time: 0:14:36.472733,used: 2:47:38.321049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.9827393, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918786, 'auroc': 0.8208827, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42287  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.80023366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.78541684, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 14:18:56.692243,epoch time: 0:14:37.842454,used: 3:02:16.163503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.9827393, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918786, 'auroc': 0.83695436, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42287  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.82197654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80275416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 14:33:53.015180,epoch time: 0:14:56.322937,used: 3:17:12.486440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9654338, 'precision': 0.48272792, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.49120647, 'auroc': 0.85088587, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42286  1
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.831731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8057438, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 14:48:48.724955,epoch time: 0:14:55.709775,used: 3:32:08.196215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9655479, 'precision': 0.8042541, 'recall': 0.5029151, 'specificity': 0.5029151, 'f1': 0.4971281, 'auroc': 0.85787034, 'binary_precision': 0.64285713, 'binary_recall': 0.0059484467, 'binary_specificity': 0.99988174, 'binary_f1_score': 0.01178782}
confusion matrix:
       0  1
0  42282  5
1   1504  9
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8519002, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8317771, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 15:03:39.953310,epoch time: 0:14:51.228355,used: 3:46:59.424570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96541095, 'precision': 0.71362436, 'recall': 0.5038001, 'specificity': 0.5038001, 'f1': 0.49899533, 'auroc': 0.874509, 'binary_precision': 0.46153846, 'binary_recall': 0.007931262, 'binary_specificity': 0.99966896, 'binary_f1_score': 0.015594542}
confusion matrix:
       0   1
0  42273  14
1   1501  12
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8591852, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8357878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 15:19:46.657241,epoch time: 0:16:06.703931,used: 4:03:06.128501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9656621, 'precision': 0.77650833, 'recall': 0.50870395, 'specificity': 0.50870395, 'f1': 0.50859, 'auroc': 0.8762732, 'binary_precision': 0.5869565, 'binary_recall': 0.017857144, 'binary_specificity': 0.9995507, 'binary_f1_score': 0.03465982}
confusion matrix:
       0   1
0  42269  19
1   1485  27
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.9839921, 'recall': 0.5008306, 'specificity': 0.5008306, 'f1': 0.49352425, 'auroc': 0.8612537, 'binary_precision': 1.0, 'binary_recall': 0.0016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.0033167494}
confusion matrix:
       0  1
0  18171  0
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8355622, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_17.png
better model found
persisted
after epoch: 17,now: 2024-06-16 15:34:29.438637,epoch time: 0:14:42.781396,used: 4:17:48.909897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9655479, 'precision': 0.74430746, 'recall': 0.5111957, 'specificity': 0.5111957, 'f1': 0.51339483, 'auroc': 0.8787208, 'binary_precision': 0.52238804, 'binary_recall': 0.023148147, 'binary_specificity': 0.99924326, 'binary_f1_score': 0.044331856}
confusion matrix:
       0   1
0  42256  32
1   1477  35
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.65065706, 'recall': 0.5007755, 'specificity': 0.5007755, 'f1': 0.49349123, 'auroc': 0.8710161, 'binary_precision': 0.33333334, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0033057851}
confusion matrix:
       0  1
0  18169  2
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.8435595, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_18.png
new oracle model saved
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 18,now: 2024-06-16 15:49:08.996352,epoch time: 0:14:39.557715,used: 4:32:28.467612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9654338, 'precision': 0.7252563, 'recall': 0.5098612, 'specificity': 0.5098612, 'f1': 0.51087016, 'auroc': 0.88176227, 'binary_precision': 0.484375, 'binary_recall': 0.020502646, 'binary_specificity': 0.99921966, 'binary_f1_score': 0.039340105}
confusion matrix:
       0   1
0  42255  33
1   1481  31
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.784042, 'recall': 0.50243664, 'specificity': 0.50243664, 'f1': 0.49680728, 'auroc': 0.87098897, 'binary_precision': 0.6, 'binary_recall': 0.004983389, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.00988468}
confusion matrix:
       0  1
0  18169  2
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84287596, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_19.png
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 19,now: 2024-06-16 16:03:51.242750,epoch time: 0:14:42.246398,used: 4:47:10.714010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.7369542, 'recall': 0.5236196, 'specificity': 0.5236196, 'f1': 0.53584707, 'auroc': 0.8879592, 'binary_precision': 0.5068493, 'binary_recall': 0.0489418, 'binary_specificity': 0.9982974, 'binary_f1_score': 0.08926418}
confusion matrix:
       0   1
0  42216  72
1   1438  74
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73414093, 'recall': 0.5056213, 'specificity': 0.5056213, 'f1': 0.50321305, 'auroc': 0.8811126, 'binary_precision': 0.5, 'binary_recall': 0.011627907, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.022727272}
confusion matrix:
       0  1
0  18164  7
1    595  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.8549356, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_20.png
new oracle model saved
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9623336791992188
after epoch: 20,now: 2024-06-16 16:18:37.428772,epoch time: 0:14:46.186022,used: 5:01:56.900032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9660274, 'precision': 0.77351767, 'recall': 0.52929235, 'specificity': 0.52929235, 'f1': 0.5458328, 'auroc': 0.88918465, 'binary_precision': 0.57961786, 'binary_recall': 0.060145408, 'binary_specificity': 0.99843925, 'binary_f1_score': 0.10898204}
confusion matrix:
       0   1
0  42221  66
1   1422  91
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7842692, 'recall': 0.5097467, 'specificity': 0.5097467, 'f1': 0.5111949, 'auroc': 0.8802725, 'binary_precision': 0.6, 'binary_recall': 0.019933555, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.03858521}
confusion matrix:
       0   1
0  18163   8
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.85452354, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-16 16:33:23.348600,epoch time: 0:14:45.919828,used: 5:16:42.819860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9653653, 'precision': 0.7274919, 'recall': 0.53087074, 'specificity': 0.53087074, 'f1': 0.5478608, 'auroc': 0.89454865, 'binary_precision': 0.4874372, 'binary_recall': 0.06415344, 'binary_specificity': 0.997588, 'binary_f1_score': 0.113383986}
confusion matrix:
       0    1
0  42186  102
1   1415   97
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7344159, 'recall': 0.5144549, 'specificity': 0.5144549, 'f1': 0.52005774, 'auroc': 0.88425815, 'binary_precision': 0.5, 'binary_recall': 0.029900333, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.056426335}
confusion matrix:
       0   1
0  18153  18
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.85657847, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_22.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9628145694732666 / 0.9629748463630676
after epoch: 22,now: 2024-06-16 16:48:00.106244,epoch time: 0:14:36.757644,used: 5:31:19.577504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9658676, 'precision': 0.7539501, 'recall': 0.53908753, 'specificity': 0.53908753, 'f1': 0.5614493, 'auroc': 0.90153766, 'binary_precision': 0.539823, 'binary_recall': 0.080634505, 'binary_specificity': 0.9975406, 'binary_f1_score': 0.14031053}
confusion matrix:
       0    1
0  42183  104
1   1391  122
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7469926, 'recall': 0.516919, 'specificity': 0.516919, 'f1': 0.524581, 'auroc': 0.88623106, 'binary_precision': 0.525, 'binary_recall': 0.034883723, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.06542056}
confusion matrix:
       0   1
0  18152  19
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.98184156, 'recall': 0.53305787, 'specificity': 0.53305787, 'f1': 0.55276835, 'auroc': 0.85943455, 'binary_precision': 1.0, 'binary_recall': 0.0661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.124031}
confusion matrix:
      0   1
0  5997   0
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_23.png
new oracle model saved
early stop counter: 2
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9628145694732666 / 0.9637762308120728
after epoch: 23,now: 2024-06-16 17:02:38.845056,epoch time: 0:14:38.738812,used: 5:45:58.316316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7511469, 'recall': 0.54837316, 'specificity': 0.54837316, 'f1': 0.57542264, 'auroc': 0.8938832, 'binary_precision': 0.5335689, 'binary_recall': 0.099867724, 'binary_specificity': 0.99687856, 'binary_f1_score': 0.16824514}
confusion matrix:
       0    1
0  42156  132
1   1361  151
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73454106, 'recall': 0.5184701, 'specificity': 0.5184701, 'f1': 0.5273362, 'auroc': 0.88800925, 'binary_precision': 0.5, 'binary_recall': 0.03820598, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.07098766}
confusion matrix:
       0   1
0  18148  23
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.9823066, 'recall': 0.54545456, 'specificity': 0.54545456, 'f1': 0.57432723, 'auroc': 0.8594595, 'binary_precision': 1.0, 'binary_recall': 0.09090909, 'binary_specificity': 1.0, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5997   0
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_24.png
new oracle model saved
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9628145694732666 / 0.9647379517555237
after epoch: 24,now: 2024-06-16 17:17:14.603732,epoch time: 0:14:35.758676,used: 6:00:34.074992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7534637, 'recall': 0.54484683, 'specificity': 0.54484683, 'f1': 0.57026446, 'auroc': 0.8942814, 'binary_precision': 0.53846157, 'binary_recall': 0.0925314, 'binary_specificity': 0.9971622, 'binary_f1_score': 0.15792444}
confusion matrix:
       0    1
0  42167  120
1   1373  140
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74543726, 'recall': 0.5193282, 'specificity': 0.5193282, 'f1': 0.5289065, 'auroc': 0.8900353, 'binary_precision': 0.5217391, 'binary_recall': 0.03986711, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.074074075}
confusion matrix:
       0   1
0  18149  22
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.982229, 'recall': 0.5433884, 'specificity': 0.5433884, 'f1': 0.5708017, 'auroc': 0.8614748, 'binary_precision': 1.0, 'binary_recall': 0.08677686, 'binary_specificity': 1.0, 'binary_f1_score': 0.15969582}
confusion matrix:
      0   1
0  5997   0
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_25.png
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9628145694732666 / 0.9647379517555237
after epoch: 25,now: 2024-06-16 17:31:51.657914,epoch time: 0:14:37.054182,used: 6:15:11.129174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.76391506, 'recall': 0.56486297, 'specificity': 0.56486297, 'f1': 0.5991536, 'auroc': 0.9041301, 'binary_precision': 0.55801105, 'binary_recall': 0.13350958, 'binary_specificity': 0.99621636, 'binary_f1_score': 0.21546666}
confusion matrix:
       0    1
0  42127  160
1   1311  202
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7530122, 'recall': 0.52985036, 'specificity': 0.52985036, 'f1': 0.54704666, 'auroc': 0.89422596, 'binary_precision': 0.5362319, 'binary_recall': 0.061461795, 'binary_specificity': 0.998239, 'binary_f1_score': 0.11028316}
confusion matrix:
       0   1
0  18139  32
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8653631, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-06-16 17:46:28.594537,epoch time: 0:14:36.936623,used: 6:29:48.065797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9661644, 'precision': 0.75429887, 'recall': 0.56951255, 'specificity': 0.56951255, 'f1': 0.6046088, 'auroc': 0.90656996, 'binary_precision': 0.53846157, 'binary_recall': 0.14342366, 'binary_specificity': 0.9956015, 'binary_f1_score': 0.22651356}
confusion matrix:
       0    1
0  42101  186
1   1296  217
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7292024, 'recall': 0.533673, 'specificity': 0.533673, 'f1': 0.55285287, 'auroc': 0.8972609, 'binary_precision': 0.4883721, 'binary_recall': 0.069767445, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.12209302}
confusion matrix:
       0   1
0  18127  44
1    560  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.9832393, 'recall': 0.57024795, 'specificity': 0.57024795, 'f1': 0.6146652, 'auroc': 0.87124294, 'binary_precision': 1.0, 'binary_recall': 0.14049587, 'binary_specificity': 1.0, 'binary_f1_score': 0.2463768}
confusion matrix:
      0   1
0  5997   0
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_27.png
new oracle model saved
early stop counter: 1
val acc:0.9678261280059814, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9661805033683777 / 0.9666613340377808
after epoch: 27,now: 2024-06-16 18:01:06.556342,epoch time: 0:14:37.961805,used: 6:44:26.027602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.762759, 'recall': 0.56227833, 'specificity': 0.56227833, 'f1': 0.5955931, 'auroc': 0.90151536, 'binary_precision': 0.55587393, 'binary_recall': 0.12822208, 'binary_specificity': 0.99633455, 'binary_f1_score': 0.20837809}
confusion matrix:
       0    1
0  42132  155
1   1319  194
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.779958, 'recall': 0.5292124, 'specificity': 0.5292124, 'f1': 0.5462868, 'auroc': 0.89169264, 'binary_precision': 0.59016395, 'binary_recall': 0.059800666, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.108597286}
confusion matrix:
       0   1
0  18146  25
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8639065, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_28.png
better model found
persisted
after epoch: 28,now: 2024-06-16 18:15:50.774903,epoch time: 0:14:44.218561,used: 6:59:10.246163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9661416, 'precision': 0.7534618, 'recall': 0.56762326, 'specificity': 0.56762326, 'f1': 0.60210836, 'auroc': 0.9062749, 'binary_precision': 0.5368957, 'binary_recall': 0.13955027, 'binary_specificity': 0.9956962, 'binary_f1_score': 0.22152232}
confusion matrix:
       0    1
0  42106  182
1   1301  211
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7313201, 'recall': 0.52807915, 'specificity': 0.52807915, 'f1': 0.5438292, 'auroc': 0.8954367, 'binary_precision': 0.49295774, 'binary_recall': 0.058139537, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.10401189}
confusion matrix:
       0   1
0  18135  36
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.8669383, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_29.png
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9661805033683777 / 0.9666613340377808
after epoch: 29,now: 2024-06-16 18:30:40.038424,epoch time: 0:14:49.263521,used: 7:13:59.509684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96621007, 'precision': 0.75247014, 'recall': 0.5804133, 'specificity': 0.5804133, 'f1': 0.6179967, 'auroc': 0.90832806, 'binary_precision': 0.53404254, 'binary_recall': 0.16600528, 'binary_specificity': 0.99482125, 'binary_f1_score': 0.2532795}
confusion matrix:
       0    1
0  42069  219
1   1261  251
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7401732, 'recall': 0.54181355, 'specificity': 0.54181355, 'f1': 0.5657208, 'auroc': 0.89971745, 'binary_precision': 0.50980395, 'binary_recall': 0.08637874, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.14772727}
confusion matrix:
       0   1
0  18121  50
1    550  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.983551, 'recall': 0.57851243, 'specificity': 0.57851243, 'f1': 0.62735224, 'auroc': 0.8723913, 'binary_precision': 1.0, 'binary_recall': 0.1570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.27142856}
confusion matrix:
      0   1
0  5997   0
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327283_30.png
new oracle model saved
early stop counter: 2
val acc:0.9680392146110535, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9661805033683777 / 0.9673024415969849
after epoch: 30,now: 2024-06-16 18:45:29.680024,epoch time: 0:14:49.641600,used: 7:28:49.151284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327283
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:28:49.151284 at 2024-06-16 18:45:29.680024
persisted model performance metric: 

scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8639065, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
oracle model performance metric: 

scalar performance:
{'acc': 0.96730244, 'precision': 0.983551, 'recall': 0.57851243, 'specificity': 0.57851243, 'f1': 0.62735224, 'auroc': 0.8723913, 'binary_precision': 1.0, 'binary_recall': 0.1570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.27142856}
confusion matrix:
      0   1
0  5997   0
1   204  38
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun 16 18:46:09 2024]
Finished job 0.
1 of 1 steps (100%) done
