Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 04:49:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314

 Experiment start at: 2024-06-05 05:00:50.684996
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9694693, 'precision': 0.84798884, 'recall': 0.57245064, 'specificity': 0.57245064, 'f1': 0.6143129, 'auroc': 0.94756603, 'binary_precision': 0.72483224, 'binary_recall': 0.14683889, 'binary_specificity': 0.99806243, 'binary_f1_score': 0.24420577}
confusion matrix:
       0    1
0  42239   82
1   1255  216
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9663687, 'precision': 0.7947085, 'recall': 0.5213046, 'specificity': 0.5213046, 'f1': 0.5321331, 'auroc': 0.94799536, 'binary_precision': 0.62222224, 'binary_recall': 0.04354588, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.08139535}
confusion matrix:
       0   1
0  18132  17
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.930352, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 05:27:27.108574,epoch time: 0:26:36.423578,used: 0:26:36.423578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9700402, 'precision': 0.79582536, 'recall': 0.64123046, 'specificity': 0.64123046, 'f1': 0.6888977, 'auroc': 0.95768034, 'binary_precision': 0.615942, 'binary_recall': 0.2887228, 'binary_specificity': 0.9937382, 'binary_f1_score': 0.39315447}
confusion matrix:
       0    1
0  42055  265
1   1047  425
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.78298426, 'recall': 0.6380528, 'specificity': 0.6380528, 'f1': 0.6833656, 'auroc': 0.9587126, 'binary_precision': 0.59090906, 'binary_recall': 0.2830482, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.382755}
confusion matrix:
       0    1
0  18023  126
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8818009, 'recall': 0.62501943, 'specificity': 0.62501943, 'f1': 0.68315196, 'auroc': 0.9521868, 'binary_precision': 0.79518074, 'binary_recall': 0.25287357, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.38372093}
confusion matrix:
      0   1
0  5980  17
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 05:52:27.641334,epoch time: 0:25:00.532760,used: 0:51:36.956338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9746529, 'precision': 0.8092581, 'recall': 0.7868915, 'specificity': 0.7868915, 'f1': 0.79761505, 'auroc': 0.9665606, 'binary_precision': 0.6328928, 'binary_recall': 0.5855978, 'binary_specificity': 0.9881852, 'binary_f1_score': 0.60832745}
confusion matrix:
       0    1
0  41820  500
1    610  862
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.8377178, 'recall': 0.73575556, 'specificity': 0.73575556, 'f1': 0.776896, 'auroc': 0.96486133, 'binary_precision': 0.6936937, 'binary_recall': 0.47900465, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.5666973}
confusion matrix:
       0    1
0  18013  136
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.950487, 'recall': 0.6737459, 'specificity': 0.6737459, 'f1': 0.7462021, 'auroc': 0.950887, 'binary_precision': 0.9285714, 'binary_recall': 0.348659, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5069638}
confusion matrix:
      0   1
0  5990   7
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 06:17:53.775993,epoch time: 0:25:26.134659,used: 1:17:03.090997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9763884, 'precision': 0.9097612, 'recall': 0.6822188, 'specificity': 0.6822188, 'f1': 0.74939096, 'auroc': 0.9721736, 'binary_precision': 0.8411215, 'binary_recall': 0.3668478, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.5108799}
confusion matrix:
       0    1
0  42218  102
1    932  540
---- Validation: 
scalar performance:
{'acc': 0.9750958, 'precision': 0.91689837, 'recall': 0.6623328, 'specificity': 0.6623328, 'f1': 0.73010975, 'auroc': 0.9692374, 'binary_precision': 0.85714287, 'binary_recall': 0.32659408, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.47297302}
confusion matrix:
       0    1
0  18114   35
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9574013, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_4.png
better model found
persisted
after epoch: 4,now: 2024-06-05 06:43:12.008996,epoch time: 0:25:18.233003,used: 1:42:21.324000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97967666, 'precision': 0.8455992, 'recall': 0.83834183, 'specificity': 0.83834183, 'f1': 0.8419285, 'auroc': 0.9732568, 'binary_precision': 0.70208335, 'binary_recall': 0.6868206, 'binary_specificity': 0.989863, 'binary_f1_score': 0.6943681}
confusion matrix:
       0     1
0  41891   429
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.9790868, 'precision': 0.8741865, 'recall': 0.77840745, 'specificity': 0.77840745, 'f1': 0.81869394, 'auroc': 0.9713768, 'binary_precision': 0.76371306, 'binary_recall': 0.562986, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.64816475}
confusion matrix:
       0    1
0  18037  112
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.9307617, 'recall': 0.7799417, 'specificity': 0.7799417, 'f1': 0.83791524, 'auroc': 0.9595114, 'binary_precision': 0.88023955, 'binary_recall': 0.5632184, 'binary_specificity': 0.996665, 'binary_f1_score': 0.68691593}
confusion matrix:
      0    1
0  5977   20
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-05 07:08:38.401828,epoch time: 0:25:26.392832,used: 2:07:47.716832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9793798, 'precision': 0.92754817, 'recall': 0.72474897, 'specificity': 0.72474897, 'f1': 0.7925157, 'auroc': 0.9779955, 'binary_precision': 0.8738502, 'binary_recall': 0.4517663, 'binary_specificity': 0.99773157, 'binary_f1_score': 0.5956113}
confusion matrix:
       0    1
0  42224   96
1    807  665
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.94168925, 'recall': 0.6913521, 'specificity': 0.6913521, 'f1': 0.76389635, 'auroc': 0.97221935, 'binary_precision': 0.9047619, 'binary_recall': 0.38413686, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.53930134}
confusion matrix:
       0    1
0  18123   26
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.95718634, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_6.png
early stop counter: 1
val acc:0.9775436520576477, best validation acc: 0.9790868163108826, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 6,now: 2024-06-05 07:33:49.595264,epoch time: 0:25:11.193436,used: 2:32:58.910268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98193735, 'precision': 0.8991878, 'recall': 0.798529, 'specificity': 0.798529, 'f1': 0.8410368, 'auroc': 0.97974837, 'binary_precision': 0.812099, 'binary_recall': 0.6019022, 'binary_specificity': 0.99515593, 'binary_f1_score': 0.6913773}
confusion matrix:
       0    1
0  42115  205
1    586  886
---- Validation: 
scalar performance:
{'acc': 0.9802576, 'precision': 0.91248196, 'recall': 0.758762, 'specificity': 0.758762, 'f1': 0.8167297, 'auroc': 0.9750575, 'binary_precision': 0.84170854, 'binary_recall': 0.5209953, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.6436119}
confusion matrix:
       0    1
0  18086   63
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.9518058, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_7.png
better model found
persisted
after epoch: 7,now: 2024-06-05 07:58:46.512884,epoch time: 0:24:56.917620,used: 2:57:55.827888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98298776, 'precision': 0.9123111, 'recall': 0.80385864, 'specificity': 0.80385864, 'f1': 0.84925425, 'auroc': 0.98050857, 'binary_precision': 0.83798885, 'binary_recall': 0.6118287, 'binary_specificity': 0.9958886, 'binary_f1_score': 0.7072692}
confusion matrix:
       0    1
0  42147  174
1    571  900
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.9259779, 'recall': 0.74287313, 'specificity': 0.74287313, 'f1': 0.8076096, 'auroc': 0.97215724, 'binary_precision': 0.8698061, 'binary_recall': 0.48833594, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.625498}
confusion matrix:
       0    1
0  18102   47
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.91341454, 'recall': 0.6160245, 'specificity': 0.6160245, 'f1': 0.6751171, 'auroc': 0.95778924, 'binary_precision': 0.85915494, 'binary_recall': 0.23371647, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.36746988}
confusion matrix:
      0   1
0  5987  10
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_8.png
early stop counter: 1
val acc:0.9799914956092834, best validation acc: 0.9802575707435608, corresponding to test acc:                         0.9598913192749023 / 0.9785873889923096
after epoch: 8,now: 2024-06-05 08:23:56.664782,epoch time: 0:25:10.151898,used: 3:23:05.979786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9813208, 'precision': 0.95243007, 'recall': 0.7418183, 'specificity': 0.7418183, 'f1': 0.81310576, 'auroc': 0.98409086, 'binary_precision': 0.92248064, 'binary_recall': 0.48505434, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.63579696}
confusion matrix:
       0    1
0  42260   60
1    758  714
---- Validation: 
scalar performance:
{'acc': 0.97765005, 'precision': 0.94653267, 'recall': 0.69065714, 'specificity': 0.69065714, 'f1': 0.76401037, 'auroc': 0.97262466, 'binary_precision': 0.91449815, 'binary_recall': 0.38258165, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.53947365}
confusion matrix:
       0    1
0  18126   23
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9568703, 'recall': 0.5382308, 'specificity': 0.5382308, 'f1': 0.5610315, 'auroc': 0.95173836, 'binary_precision': 0.95238096, 'binary_recall': 0.07662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.14184396}
confusion matrix:
      0   1
0  5996   1
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_9.png
early stop counter: 2
val acc:0.9776500463485718, best validation acc: 0.9802575707435608, corresponding to test acc:                         0.9598913192749023 / 0.9785873889923096
after epoch: 9,now: 2024-06-05 08:48:48.795177,epoch time: 0:24:52.130395,used: 3:47:58.110181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9842665, 'precision': 0.9133004, 'recall': 0.8272743, 'specificity': 0.8272743, 'f1': 0.86490655, 'auroc': 0.98395145, 'binary_precision': 0.8383751, 'binary_recall': 0.6589674, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.7379232}
confusion matrix:
       0    1
0  42133  187
1    502  970
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.9065867, 'recall': 0.8087278, 'specificity': 0.8087278, 'f1': 0.85043985, 'auroc': 0.9778297, 'binary_precision': 0.8264463, 'binary_recall': 0.62208396, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7098492}
confusion matrix:
       0    1
0  18065   84
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.84470093, 'recall': 0.569714, 'specificity': 0.569714, 'f1': 0.60883886, 'auroc': 0.94766986, 'binary_precision': 0.7254902, 'binary_recall': 0.14176245, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23717949}
confusion matrix:
      0   1
0  5983  14
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_10.png
better model found
persisted
after epoch: 10,now: 2024-06-05 09:14:04.153587,epoch time: 0:25:15.358410,used: 4:13:13.468591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98506576, 'precision': 0.88180447, 'recall': 0.89082205, 'specificity': 0.89082205, 'f1': 0.8862561, 'auroc': 0.9856019, 'binary_precision': 0.77091634, 'binary_recall': 0.78979594, 'binary_specificity': 0.99184823, 'binary_f1_score': 0.7802419}
confusion matrix:
       0     1
0  41977   345
1    309  1161
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.887676, 'recall': 0.85500467, 'specificity': 0.85500467, 'f1': 0.87056065, 'auroc': 0.97771674, 'binary_precision': 0.78534925, 'binary_recall': 0.7169518, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7495935}
confusion matrix:
       0    1
0  18023  126
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.85015595, 'recall': 0.66208297, 'specificity': 0.66208297, 'f1': 0.7183853, 'auroc': 0.9624151, 'binary_precision': 0.7288136, 'binary_recall': 0.32950193, 'binary_specificity': 0.994664, 'binary_f1_score': 0.45382586}
confusion matrix:
      0   1
0  5965  32
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_11.png
better model found
persisted
after epoch: 11,now: 2024-06-05 09:39:18.238313,epoch time: 0:25:14.084726,used: 4:38:27.553317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98310196, 'precision': 0.9650724, 'recall': 0.7630671, 'specificity': 0.7630671, 'f1': 0.8342309, 'auroc': 0.98670167, 'binary_precision': 0.94634145, 'binary_recall': 0.52717394, 'binary_specificity': 0.9989603, 'binary_f1_score': 0.6771379}
confusion matrix:
       0    1
0  42276   44
1    696  776
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.9504791, 'recall': 0.7379809, 'specificity': 0.7379809, 'f1': 0.8092692, 'auroc': 0.9762503, 'binary_precision': 0.9191617, 'binary_recall': 0.47744945, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.62845445}
confusion matrix:
       0    1
0  18122   27
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8863033, 'recall': 0.5720466, 'specificity': 0.5720466, 'f1': 0.6138747, 'auroc': 0.9593686, 'binary_precision': 0.80851066, 'binary_recall': 0.14559387, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.24675325}
confusion matrix:
      0   1
0  5988   9
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_12.png
early stop counter: 1
val acc:0.9806832671165466, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 12,now: 2024-06-05 10:04:43.145970,epoch time: 0:25:24.907657,used: 5:03:52.460974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9847689, 'precision': 0.8666632, 'recall': 0.91764325, 'specificity': 0.91764325, 'f1': 0.8903447, 'auroc': 0.9865414, 'binary_precision': 0.7387173, 'binary_recall': 0.8456832, 'binary_specificity': 0.9896033, 'binary_f1_score': 0.7885895}
confusion matrix:
       0     1
0  41881   440
1    227  1244
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.85714877, 'recall': 0.9003447, 'specificity': 0.9003447, 'f1': 0.87739885, 'auroc': 0.97980267, 'binary_precision': 0.7209945, 'binary_recall': 0.8118196, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.76371616}
confusion matrix:
       0    1
0  17947  202
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8232212, 'recall': 0.7137218, 'specificity': 0.7137218, 'f1': 0.7561023, 'auroc': 0.9530738, 'binary_precision': 0.67058825, 'binary_recall': 0.43678162, 'binary_specificity': 0.990662, 'binary_f1_score': 0.5290023}
confusion matrix:
      0    1
0  5941   56
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096314_13.png
early stop counter: 2
val acc:0.9828118085861206, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9669223427772522 / 0.9785873889923096
after epoch: 13,now: 2024-06-05 10:29:54.353255,epoch time: 0:25:11.207285,used: 5:29:03.668259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_00_50_seed_0_21096314
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
[Wed Jun  5 10:40:30 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv

RuleException:
OSError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[Errno 122] Disk quota exceeded
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 64, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 154, in plot_losses
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/pyplot.py", line 1119, in savefig
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/figure.py", line 3390, in savefig
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2193, in print_figure
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2043, in <lambda>
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 497, in print_png
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 446, in _print_pil
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/image.py", line 1656, in imsave
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/PIL/Image.py", line 2462, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
