Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 14 12:48:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356

 Experiment start at: 2024-06-14 13:05:43.807388
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.48308137, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43681735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3271572, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 13:27:17.615737,epoch time: 0:21:33.808349,used: 0:21:33.808349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.5926881, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.58100265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5223084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-14 13:47:27.412455,epoch time: 0:20:09.796718,used: 0:41:43.605067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.6342045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6353088, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6056144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-14 14:06:05.382365,epoch time: 0:18:37.969910,used: 1:00:21.574977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.73665965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.73607934, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7330172, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-14 14:23:49.943873,epoch time: 0:17:44.561508,used: 1:18:06.136485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.4832161, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914648, 'auroc': 0.7846529, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42322  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.78112423, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.78221166, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-14 14:41:46.138726,epoch time: 0:17:56.194853,used: 1:36:02.331338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.81824946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8251838, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.823839, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-14 14:59:40.795413,epoch time: 0:17:54.656687,used: 1:53:56.988025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.8258088, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.82330084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8128788, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-14 15:17:32.962041,epoch time: 0:17:52.166628,used: 2:11:49.154653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.86192393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8575386, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.84941846, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-14 15:35:22.562241,epoch time: 0:17:49.600200,used: 2:29:38.754853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.883237, 'recall': 0.5013469, 'specificity': 0.5013469, 'f1': 0.49417812, 'auroc': 0.8659245, 'binary_precision': 0.8, 'binary_recall': 0.0027173914, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.005416385}
confusion matrix:
       0  1
0  42319  1
1   1468  4
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.87538767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8585756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-14 15:54:38.674238,epoch time: 0:19:16.111997,used: 2:48:54.866850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.8582587, 'recall': 0.5020144, 'specificity': 0.5020144, 'f1': 0.49552947, 'auroc': 0.86780506, 'binary_precision': 0.75, 'binary_recall': 0.004076087, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.008108108}
confusion matrix:
       0  1
0  42318  2
1   1466  6
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8525356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.85393465, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_10.png
new oracle model saved
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 10,now: 2024-06-14 16:14:57.947073,epoch time: 0:20:19.272835,used: 3:09:14.139685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7216073, 'recall': 0.5098003, 'specificity': 0.5098003, 'f1': 0.5109732, 'auroc': 0.877524, 'binary_precision': 0.47619048, 'binary_recall': 0.020380436, 'binary_specificity': 0.99922025, 'binary_f1_score': 0.039087947}
confusion matrix:
       0   1
0  42287  33
1   1442  30
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.87514365, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8633239, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_11.png
new oracle model saved
early stop counter: 10
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9598913192749023
after epoch: 11,now: 2024-06-14 16:34:05.306788,epoch time: 0:19:07.359715,used: 3:28:21.499400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9661582, 'precision': 0.6967341, 'recall': 0.50938976, 'specificity': 0.50938976, 'f1': 0.51021934, 'auroc': 0.885615, 'binary_precision': 0.42647058, 'binary_recall': 0.019701088, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.03766234}
confusion matrix:
       0   1
0  42281  39
1   1443  29
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73299086, 'recall': 0.5030002, 'specificity': 0.5030002, 'f1': 0.49743947, 'auroc': 0.8904333, 'binary_precision': 0.5, 'binary_recall': 0.00622084, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.012288787}
confusion matrix:
       0  1
0  18145  4
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.97999036, 'recall': 0.5210728, 'specificity': 0.5210728, 'f1': 0.53023213, 'auroc': 0.87139916, 'binary_precision': 1.0, 'binary_recall': 0.042145595, 'binary_specificity': 1.0, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5997   0
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_12.png
new oracle model saved
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9600511193275452
after epoch: 12,now: 2024-06-14 16:52:09.955177,epoch time: 0:18:04.648389,used: 3:46:26.147789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7790684, 'recall': 0.5129283, 'specificity': 0.5129283, 'f1': 0.51687384, 'auroc': 0.88608235, 'binary_precision': 0.59090906, 'binary_recall': 0.026494564, 'binary_specificity': 0.999362, 'binary_f1_score': 0.050715216}
confusion matrix:
       0   1
0  42293  27
1   1433  39
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6913472, 'recall': 0.5036952, 'specificity': 0.5036952, 'f1': 0.49890062, 'auroc': 0.8772974, 'binary_precision': 0.41666666, 'binary_recall': 0.00777605, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.015267176}
confusion matrix:
       0  1
0  18142  7
1    638  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.867345, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_13.png
early stop counter: 12
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9600511193275452
after epoch: 13,now: 2024-06-14 17:10:00.559055,epoch time: 0:17:50.603878,used: 4:04:16.751667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96620387, 'precision': 0.71768063, 'recall': 0.5189213, 'specificity': 0.5189213, 'f1': 0.527735, 'auroc': 0.88258433, 'binary_precision': 0.46774194, 'binary_recall': 0.039402176, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.07268171}
confusion matrix:
       0   1
0  42254  66
1   1414  58
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.84983754, 'recall': 0.5084435, 'specificity': 0.5084435, 'f1': 0.50810546, 'auroc': 0.8797108, 'binary_precision': 0.73333335, 'binary_recall': 0.01710731, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.03343465}
confusion matrix:
       0   1
0  18145   4
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.98006725, 'recall': 0.5229885, 'specificity': 0.5229885, 'f1': 0.533787, 'auroc': 0.8726207, 'binary_precision': 1.0, 'binary_recall': 0.04597701, 'binary_specificity': 1.0, 'binary_f1_score': 0.08791209}
confusion matrix:
      0   1
0  5997   0
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_14.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-06-14 17:31:21.125924,epoch time: 0:21:20.566869,used: 4:25:37.318536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7769313, 'recall': 0.53414774, 'specificity': 0.53414774, 'f1': 0.5541539, 'auroc': 0.8816161, 'binary_precision': 0.58522725, 'binary_recall': 0.07002039, 'binary_specificity': 0.9982751, 'binary_f1_score': 0.12507589}
confusion matrix:
       0    1
0  42248   73
1   1368  103
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.76436675, 'recall': 0.5068056, 'specificity': 0.5068056, 'f1': 0.50497735, 'auroc': 0.88036305, 'binary_precision': 0.5625, 'binary_recall': 0.01399689, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.027314112}
confusion matrix:
       0  1
0  18142  7
1    634  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.86952543, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_15.png
new oracle model saved
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.960210919380188 / 0.9611697196960449
after epoch: 15,now: 2024-06-14 17:53:43.072100,epoch time: 0:22:21.946176,used: 4:47:59.264712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9665921, 'precision': 0.74664366, 'recall': 0.5312529, 'specificity': 0.5312529, 'f1': 0.5489586, 'auroc': 0.89428294, 'binary_precision': 0.5248619, 'binary_recall': 0.06453805, 'binary_specificity': 0.99796784, 'binary_f1_score': 0.114942536}
confusion matrix:
       0   1
0  42234  86
1   1377  95
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7220479, 'recall': 0.51569605, 'specificity': 0.51569605, 'f1': 0.5218271, 'auroc': 0.8908495, 'binary_precision': 0.47727272, 'binary_recall': 0.032659408, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.061135374}
confusion matrix:
       0   1
0  18126  23
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8732585, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_16.png
new oracle model saved
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.960210919380188 / 0.963087260723114
after epoch: 16,now: 2024-06-14 18:15:39.804574,epoch time: 0:21:56.732474,used: 5:09:55.997186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7149354, 'recall': 0.53486824, 'specificity': 0.53486824, 'f1': 0.5541185, 'auroc': 0.89171493, 'binary_precision': 0.46120688, 'binary_recall': 0.07269022, 'binary_specificity': 0.9970463, 'binary_f1_score': 0.12558685}
confusion matrix:
       0    1
0  42195  125
1   1365  107
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7514982, 'recall': 0.52261186, 'specificity': 0.52261186, 'f1': 0.5342564, 'auroc': 0.8959724, 'binary_precision': 0.53571427, 'binary_recall': 0.0466563, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.08583691}
confusion matrix:
       0   1
0  18123  26
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9710953, 'recall': 0.5822921, 'specificity': 0.5822921, 'f1': 0.6320163, 'auroc': 0.8776336, 'binary_precision': 0.97727275, 'binary_recall': 0.16475096, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28196722}
confusion matrix:
      0   1
0  5996   1
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_17.png
new oracle model saved
early stop counter: 3
val acc:0.9659961462020874, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.960210919380188 / 0.9650048017501831
after epoch: 17,now: 2024-06-14 18:37:20.718402,epoch time: 0:21:40.913828,used: 5:31:36.911014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96581566, 'precision': 0.70924366, 'recall': 0.5377513, 'specificity': 0.5377513, 'f1': 0.5583726, 'auroc': 0.88951457, 'binary_precision': 0.4496124, 'binary_recall': 0.07885792, 'binary_specificity': 0.9966447, 'binary_f1_score': 0.1341816}
confusion matrix:
       0    1
0  42179  142
1   1355  116
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.764742, 'recall': 0.5310002, 'specificity': 0.5310002, 'f1': 0.54866433, 'auroc': 0.8855628, 'binary_precision': 0.56164384, 'binary_recall': 0.06376361, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.11452514}
confusion matrix:
       0   1
0  18117  32
1    602  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9737248, 'recall': 0.59953344, 'specificity': 0.59953344, 'f1': 0.6569999, 'auroc': 0.8759754, 'binary_precision': 0.9811321, 'binary_recall': 0.19923371, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33121017}
confusion matrix:
      0   1
0  5996   1
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-06-14 19:00:15.932030,epoch time: 0:22:55.213628,used: 5:54:32.124642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.7447306, 'recall': 0.5420841, 'specificity': 0.5420841, 'f1': 0.565992, 'auroc': 0.89306617, 'binary_precision': 0.5203252, 'binary_recall': 0.08695652, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.1490105}
confusion matrix:
       0    1
0  42202  118
1   1344  128
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7793272, 'recall': 0.52958274, 'specificity': 0.52958274, 'f1': 0.5464511, 'auroc': 0.8970911, 'binary_precision': 0.59090906, 'binary_recall': 0.060653187, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.1100141}
confusion matrix:
       0   1
0  18122  27
1    604  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.983551, 'recall': 0.6091954, 'specificity': 0.6091954, 'f1': 0.67088324, 'auroc': 0.88003135, 'binary_precision': 1.0, 'binary_recall': 0.21839081, 'binary_specificity': 1.0, 'binary_f1_score': 0.35849056}
confusion matrix:
      0   1
0  5997   0
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-14 19:22:52.599920,epoch time: 0:22:36.667890,used: 6:17:08.792532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.72564435, 'recall': 0.54384595, 'specificity': 0.54384595, 'f1': 0.56798816, 'auroc': 0.89754313, 'binary_precision': 0.4820144, 'binary_recall': 0.091094494, 'binary_specificity': 0.9965974, 'binary_f1_score': 0.15323041}
confusion matrix:
       0    1
0  42177  144
1   1337  134
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.73730934, 'recall': 0.5270295, 'specificity': 0.5270295, 'f1': 0.5417139, 'auroc': 0.89731586, 'binary_precision': 0.5070422, 'binary_recall': 0.05598756, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.100840345}
confusion matrix:
       0   1
0  18114  35
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.98300576, 'recall': 0.59578544, 'specificity': 0.59578544, 'f1': 0.65212774, 'auroc': 0.8747784, 'binary_precision': 1.0, 'binary_recall': 0.19157088, 'binary_specificity': 1.0, 'binary_f1_score': 0.3215434}
confusion matrix:
      0   1
0  5997   0
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_20.png
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9674017429351807 / 0.9674017429351807
after epoch: 20,now: 2024-06-14 19:42:13.763337,epoch time: 0:19:21.163417,used: 6:36:29.955949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.74297553, 'recall': 0.5594725, 'specificity': 0.5594725, 'f1': 0.59076905, 'auroc': 0.9029101, 'binary_precision': 0.5156695, 'binary_recall': 0.12296195, 'binary_specificity': 0.995983, 'binary_f1_score': 0.19857378}
confusion matrix:
       0    1
0  42150  170
1   1291  181
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74844396, 'recall': 0.5421684, 'specificity': 0.5421684, 'f1': 0.5661197, 'auroc': 0.90362465, 'binary_precision': 0.5283019, 'binary_recall': 0.08709176, 'binary_specificity': 0.997245, 'binary_f1_score': 0.1495327}
confusion matrix:
       0   1
0  18099  50
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.98472357, 'recall': 0.63793105, 'specificity': 0.63793105, 'f1': 0.7084595, 'auroc': 0.8796086, 'binary_precision': 1.0, 'binary_recall': 0.27586207, 'binary_specificity': 1.0, 'binary_f1_score': 0.4324324}
confusion matrix:
      0   1
0  5997   0
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_21.png
new oracle model saved
early stop counter: 2
val acc:0.9661026000976562, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9674017429351807 / 0.9697986841201782
after epoch: 21,now: 2024-06-14 20:00:37.709723,epoch time: 0:18:23.946386,used: 6:54:53.902335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7360245, 'recall': 0.56787866, 'specificity': 0.56787866, 'f1': 0.601232, 'auroc': 0.90614283, 'binary_precision': 0.50121063, 'binary_recall': 0.140625, 'binary_specificity': 0.9951323, 'binary_f1_score': 0.21962865}
confusion matrix:
       0    1
0  42114  206
1   1265  207
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.77279127, 'recall': 0.54847187, 'specificity': 0.54847187, 'f1': 0.57638216, 'auroc': 0.902123, 'binary_precision': 0.5765766, 'binary_recall': 0.09953344, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.16976129}
confusion matrix:
       0   1
0  18102  47
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9701196, 'recall': 0.63010144, 'specificity': 0.63010144, 'f1': 0.69743645, 'auroc': 0.88475144, 'binary_precision': 0.9714286, 'binary_recall': 0.2605364, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.41087613}
confusion matrix:
      0   1
0  5995   2
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_22.png
better model found
persisted
after epoch: 22,now: 2024-06-14 20:18:32.582902,epoch time: 0:17:54.873179,used: 7:12:48.775514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.7365618, 'recall': 0.5626447, 'specificity': 0.5626447, 'f1': 0.5945585, 'auroc': 0.90189004, 'binary_precision': 0.5026316, 'binary_recall': 0.12975544, 'binary_specificity': 0.995534, 'binary_f1_score': 0.20626351}
confusion matrix:
       0    1
0  42131  189
1   1281  191
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7591975, 'recall': 0.5460564, 'specificity': 0.5460564, 'f1': 0.5723219, 'auroc': 0.90517354, 'binary_precision': 0.5495495, 'binary_recall': 0.09486781, 'binary_specificity': 0.997245, 'binary_f1_score': 0.16180371}
confusion matrix:
       0   1
0  18099  50
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.96401143, 'recall': 0.6338495, 'specificity': 0.6338495, 'f1': 0.70161825, 'auroc': 0.88451827, 'binary_precision': 0.9589041, 'binary_recall': 0.26819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.41916168}
confusion matrix:
      0   1
0  5994   3
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_23.png
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9688398838043213 / 0.9697986841201782
after epoch: 23,now: 2024-06-14 20:36:19.861942,epoch time: 0:17:47.279040,used: 7:30:36.054554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96695745, 'precision': 0.75293756, 'recall': 0.56226075, 'specificity': 0.56226075, 'f1': 0.5951252, 'auroc': 0.89381826, 'binary_precision': 0.53541076, 'binary_recall': 0.12839673, 'binary_specificity': 0.99612474, 'binary_f1_score': 0.20712328}
confusion matrix:
       0    1
0  42156  164
1   1283  189
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7578795, 'recall': 0.5392508, 'specificity': 0.5392508, 'f1': 0.56185734, 'auroc': 0.9051479, 'binary_precision': 0.5473684, 'binary_recall': 0.08087092, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.14092141}
confusion matrix:
       0   1
0  18106  43
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.97659737, 'recall': 0.6244377, 'specificity': 0.6244377, 'f1': 0.6906957, 'auroc': 0.88534886, 'binary_precision': 0.9848485, 'binary_recall': 0.24904214, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3975535}
confusion matrix:
      0   1
0  5996   1
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_24.png
early stop counter: 2
val acc:0.9662622213363647, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9688398838043213 / 0.9697986841201782
after epoch: 24,now: 2024-06-14 20:54:27.493838,epoch time: 0:18:07.631896,used: 7:48:43.686450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.734638, 'recall': 0.59542704, 'specificity': 0.59542704, 'f1': 0.63284516, 'auroc': 0.90235007, 'binary_precision': 0.49658704, 'binary_recall': 0.19782461, 'binary_specificity': 0.9930295, 'binary_f1_score': 0.28293633}
confusion matrix:
       0    1
0  42026  295
1   1180  291
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7544575, 'recall': 0.5625852, 'specificity': 0.5625852, 'f1': 0.5955641, 'auroc': 0.90729237, 'binary_precision': 0.53896105, 'binary_recall': 0.12908243, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.20828106}
confusion matrix:
       0   1
0  18078  71
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.96727186, 'recall': 0.65300655, 'specificity': 0.65300655, 'f1': 0.7249998, 'auroc': 0.8844365, 'binary_precision': 0.96385545, 'binary_recall': 0.3065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.46511626}
confusion matrix:
      0   1
0  5994   3
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_25.png
new oracle model saved
early stop counter: 3
val acc:0.966421902179718, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9688398838043213 / 0.9705976247787476
after epoch: 25,now: 2024-06-14 21:13:10.965153,epoch time: 0:18:43.471315,used: 8:07:27.157765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.7496553, 'recall': 0.5819441, 'specificity': 0.5819441, 'f1': 0.61964417, 'auroc': 0.90321004, 'binary_precision': 0.52754235, 'binary_recall': 0.16915761, 'binary_specificity': 0.99473065, 'binary_f1_score': 0.25617284}
confusion matrix:
       0    1
0  42097  223
1   1223  249
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.75621957, 'recall': 0.5626127, 'specificity': 0.5626127, 'f1': 0.5957087, 'auroc': 0.9107691, 'binary_precision': 0.5424837, 'binary_recall': 0.12908243, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.2085427}
confusion matrix:
       0   1
0  18079  70
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.978703, 'recall': 0.6474262, 'specificity': 0.6474262, 'f1': 0.7195423, 'auroc': 0.8897375, 'binary_precision': 0.98717946, 'binary_recall': 0.29501915, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.45427725}
confusion matrix:
      0   1
0  5996   1
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_26.png
early stop counter: 4
val acc:0.9664750695228577, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9688398838043213 / 0.9705976247787476
after epoch: 26,now: 2024-06-14 21:31:06.052065,epoch time: 0:17:55.086912,used: 8:25:22.244677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7419001, 'recall': 0.57357043, 'specificity': 0.57357043, 'f1': 0.6088125, 'auroc': 0.90560675, 'binary_precision': 0.5125858, 'binary_recall': 0.1521739, 'binary_specificity': 0.9949669, 'binary_f1_score': 0.23467782}
confusion matrix:
       0    1
0  42107  213
1   1248  224
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.75975645, 'recall': 0.5407785, 'specificity': 0.5407785, 'f1': 0.56428397, 'auroc': 0.902639, 'binary_precision': 0.5510204, 'binary_recall': 0.083981335, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.14574897}
confusion matrix:
       0   1
0  18105  44
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9737248, 'recall': 0.59953344, 'specificity': 0.59953344, 'f1': 0.6569999, 'auroc': 0.8841055, 'binary_precision': 0.9811321, 'binary_recall': 0.19923371, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33121017}
confusion matrix:
      0   1
0  5996   1
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_27.png
early stop counter: 5
val acc:0.9663154482841492, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9688398838043213 / 0.9705976247787476
after epoch: 27,now: 2024-06-14 21:48:56.065306,epoch time: 0:17:50.013241,used: 8:43:12.257918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9671173, 'precision': 0.75677663, 'recall': 0.56693345, 'specificity': 0.56693345, 'f1': 0.60156983, 'auroc': 0.9022639, 'binary_precision': 0.54278076, 'binary_recall': 0.13790761, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.219935}
confusion matrix:
       0    1
0  42149  171
1   1269  203
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.77769774, 'recall': 0.5462493, 'specificity': 0.5462493, 'f1': 0.5731766, 'auroc': 0.908782, 'binary_precision': 0.58653843, 'binary_recall': 0.09486781, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.16331995}
confusion matrix:
       0   1
0  18106  43
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.983551, 'recall': 0.6091954, 'specificity': 0.6091954, 'f1': 0.67088324, 'auroc': 0.88299775, 'binary_precision': 1.0, 'binary_recall': 0.21839081, 'binary_specificity': 1.0, 'binary_f1_score': 0.35849056}
confusion matrix:
      0   1
0  5997   0
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_28.png
better model found
persisted
after epoch: 28,now: 2024-06-14 22:07:54.359298,epoch time: 0:18:58.293992,used: 9:02:10.551910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96606684, 'precision': 0.73078674, 'recall': 0.59884804, 'specificity': 0.59884804, 'f1': 0.6358069, 'auroc': 0.90946627, 'binary_precision': 0.48867315, 'binary_recall': 0.20516305, 'binary_specificity': 0.9925331, 'binary_f1_score': 0.2889952}
confusion matrix:
       0    1
0  42004  316
1   1170  302
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76669884, 'recall': 0.5710837, 'specificity': 0.5710837, 'f1': 0.60759234, 'auroc': 0.9052588, 'binary_precision': 0.56287426, 'binary_recall': 0.14618973, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.23209876}
confusion matrix:
       0   1
0  18076  73
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.97049963, 'recall': 0.6759951, 'specificity': 0.6759951, 'f1': 0.7513546, 'auroc': 0.88659084, 'binary_precision': 0.96842104, 'binary_recall': 0.35249043, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5168539}
confusion matrix:
      0   1
0  5994   3
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_29.png
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-06-14 22:25:44.978997,epoch time: 0:17:50.619699,used: 9:20:01.171609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.73896646, 'recall': 0.5775002, 'specificity': 0.5775002, 'f1': 0.61328536, 'auroc': 0.90109605, 'binary_precision': 0.5064378, 'binary_recall': 0.16043508, 'binary_specificity': 0.99456537, 'binary_f1_score': 0.24367578}
confusion matrix:
       0    1
0  42091  230
1   1235  236
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.755265, 'recall': 0.5656129, 'specificity': 0.5656129, 'f1': 0.5996445, 'auroc': 0.90361685, 'binary_precision': 0.54037267, 'binary_recall': 0.13530326, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.21641791}
confusion matrix:
       0   1
0  18075  74
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.9731514, 'recall': 0.65308994, 'specificity': 0.65308994, 'f1': 0.72571945, 'auroc': 0.8816663, 'binary_precision': 0.9756098, 'binary_recall': 0.3065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.46647227}
confusion matrix:
      0   1
0  5995   2
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_30.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9725151658058167 / 0.9725151658058167
after epoch: 30,now: 2024-06-14 22:43:25.911270,epoch time: 0:17:40.932273,used: 9:37:42.103882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_13_05_43_seed_0_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:37:42.103882 at 2024-06-14 22:43:25.911270
persisted model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.97049963, 'recall': 0.6759951, 'specificity': 0.6759951, 'f1': 0.7513546, 'auroc': 0.88659084, 'binary_precision': 0.96842104, 'binary_recall': 0.35249043, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5168539}
confusion matrix:
      0   1
0  5994   3
1   169  92
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.97049963, 'recall': 0.6759951, 'specificity': 0.6759951, 'f1': 0.7513546, 'auroc': 0.88659084, 'binary_precision': 0.96842104, 'binary_recall': 0.35249043, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.5168539}
confusion matrix:
      0   1
0  5994   3
1   169  92
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |  12108 KiB |  14049 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83721 K  |   83718 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49875 K  |   49872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83721 K  |   83718 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49875 K  |   49872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2753    |   37652 K  |   37652 K  |
|       from large pool |       7    |      11    |   12103 K  |   12103 K  |
|       from small pool |      32    |    2746    |   25548 K  |   25548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83721 K  |   83721 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83721 K  |   83721 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37653 K  |   37653 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 380569 GiB | 380569 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380265 GiB | 380265 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83721 K  |   83721 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83721 K  |   83721 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2753    |   37653 K  |   37653 K  |
|       from large pool |       3    |      13    |   12103 K  |   12103 K  |
|       from small pool |       0    |    2746    |   25549 K  |   25549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356

 Experiment start at: 2024-06-14 22:50:28.463856
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.48193687, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.50330144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.34384215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 23:08:16.094442,epoch time: 0:17:47.630586,used: 0:17:47.630586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.54735017, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.5200498, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.44835198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-14 23:25:33.997174,epoch time: 0:17:17.902732,used: 0:35:05.533318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.48357123, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4916484, 'auroc': 0.6226232, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42415  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.5822352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.54096967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_3.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-14 23:43:01.655740,epoch time: 0:17:27.658566,used: 0:52:33.191884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.7033099, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6609851, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6740724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_4.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-15 00:01:04.823061,epoch time: 0:18:03.167321,used: 1:10:36.359205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.7568078, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7368723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7592273, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_5.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-15 00:19:17.815124,epoch time: 0:18:12.992063,used: 1:28:49.351268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.7864411, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.79675007, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7980198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_6.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-15 00:37:04.984214,epoch time: 0:17:47.169090,used: 1:46:36.520358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.8103233, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.81335986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8108198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_7.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-15 00:54:50.369965,epoch time: 0:17:45.385751,used: 2:04:21.906109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.9835708, 'recall': 0.5003467, 'specificity': 0.5003467, 'f1': 0.49234122, 'auroc': 0.8368763, 'binary_precision': 1.0, 'binary_recall': 0.0006934813, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013860015}
confusion matrix:
       0  1
0  42414  0
1   1441  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8228437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.82764685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_8.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-15 01:12:33.751424,epoch time: 0:17:43.381459,used: 2:22:05.287568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.73362374, 'recall': 0.50200975, 'specificity': 0.50200975, 'f1': 0.4957679, 'auroc': 0.85761213, 'binary_precision': 0.5, 'binary_recall': 0.0041608876, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.008253095}
confusion matrix:
       0  1
0  42408  6
1   1436  6
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8651242, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8419992, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_9.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-15 01:30:22.053421,epoch time: 0:17:48.301997,used: 2:39:53.589565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7336344, 'recall': 0.50234467, 'specificity': 0.50234467, 'f1': 0.49644887, 'auroc': 0.863045, 'binary_precision': 0.5, 'binary_recall': 0.004854369, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.009615384}
confusion matrix:
       0  1
0  42407  7
1   1435  7
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.9820695, 'recall': 0.5007429, 'specificity': 0.5007429, 'f1': 0.49235475, 'auroc': 0.8761155, 'binary_precision': 1.0, 'binary_recall': 0.0014858841, 'binary_specificity': 1.0, 'binary_f1_score': 0.0029673593}
confusion matrix:
       0  1
0  18067  0
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8508344, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_10.png
better model found
persisted
after epoch: 10,now: 2024-06-15 01:48:19.897568,epoch time: 0:17:57.844147,used: 2:57:51.433712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7273517, 'recall': 0.5063523, 'specificity': 0.5063523, 'f1': 0.5044621, 'auroc': 0.86306405, 'binary_precision': 0.4871795, 'binary_recall': 0.013176144, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.025658337}
confusion matrix:
       0   1
0  42394  20
1   1423  19
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.98212093, 'recall': 0.5022288, 'specificity': 0.5022288, 'f1': 0.49533558, 'auroc': 0.8650757, 'binary_precision': 1.0, 'binary_recall': 0.004457652, 'binary_specificity': 1.0, 'binary_f1_score': 0.00887574}
confusion matrix:
       0  1
0  18067  0
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.8548113, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-15 02:06:09.320524,epoch time: 0:17:49.422956,used: 3:15:40.856668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96693724, 'precision': 0.6882942, 'recall': 0.50593483, 'specificity': 0.50593483, 'f1': 0.5037049, 'auroc': 0.86073244, 'binary_precision': 0.4090909, 'binary_recall': 0.012482663, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.024226109}
confusion matrix:
       0   1
0  42388  26
1   1424  18
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7821944, 'recall': 0.50434697, 'specificity': 0.50434697, 'f1': 0.49966717, 'auroc': 0.8674927, 'binary_precision': 0.6, 'binary_recall': 0.008915304, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.017569544}
confusion matrix:
       0  1
0  18063  4
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8531385, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_12.png
new oracle model saved
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9585884809494019
after epoch: 12,now: 2024-06-15 02:24:01.167043,epoch time: 0:17:51.846519,used: 3:33:32.703187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7573333, 'recall': 0.5138156, 'specificity': 0.5138156, 'f1': 0.51870286, 'auroc': 0.87861013, 'binary_precision': 0.5466667, 'binary_recall': 0.028432732, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.05405405}
confusion matrix:
       0   1
0  42380  34
1   1401  41
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7323165, 'recall': 0.50786793, 'specificity': 0.50786793, 'f1': 0.5066796, 'auroc': 0.88948905, 'binary_precision': 0.5, 'binary_recall': 0.016344724, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.031654675}
confusion matrix:
       0   1
0  18056  11
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.859133, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_13.png
new oracle model saved
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9589107036590576
after epoch: 13,now: 2024-06-15 02:41:49.993062,epoch time: 0:17:48.826019,used: 3:51:21.529206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.74115753, 'recall': 0.5184577, 'specificity': 0.5184577, 'f1': 0.52715635, 'auroc': 0.8791368, 'binary_precision': 0.5140187, 'binary_recall': 0.03814147, 'binary_specificity': 0.998774, 'binary_f1_score': 0.071013555}
confusion matrix:
       0   1
0  42362  52
1   1387  55
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73226684, 'recall': 0.5064374, 'specificity': 0.5064374, 'f1': 0.5038779, 'auroc': 0.8708358, 'binary_precision': 0.5, 'binary_recall': 0.013372957, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.026049204}
confusion matrix:
       0  1
0  18058  9
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8582822, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_14.png
new oracle model saved
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9595552682876587
after epoch: 14,now: 2024-06-15 02:59:38.166803,epoch time: 0:17:48.173741,used: 4:09:09.702947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.71727675, 'recall': 0.52499175, 'specificity': 0.52499175, 'f1': 0.5383503, 'auroc': 0.8855481, 'binary_precision': 0.46583852, 'binary_recall': 0.052011095, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.09357455}
confusion matrix:
       0   1
0  42328  86
1   1367  75
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7264416, 'recall': 0.51427764, 'specificity': 0.51427764, 'f1': 0.51884514, 'auroc': 0.8897764, 'binary_precision': 0.4878049, 'binary_recall': 0.029717682, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.05602241}
confusion matrix:
       0   1
0  18046  21
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8665612, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_15.png
new oracle model saved
early stop counter: 4
val acc:0.9640341401100159, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9611666202545166
after epoch: 15,now: 2024-06-15 03:17:29.162997,epoch time: 0:17:50.996194,used: 4:27:00.699141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.72894394, 'recall': 0.52942866, 'specificity': 0.52942866, 'f1': 0.5458558, 'auroc': 0.8909763, 'binary_precision': 0.4888889, 'binary_recall': 0.061026353, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.10850801}
confusion matrix:
       0   1
0  42322  92
1   1354  88
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.72835237, 'recall': 0.5199998, 'specificity': 0.5199998, 'f1': 0.5291861, 'auroc': 0.89526415, 'binary_precision': 0.49122807, 'binary_recall': 0.041604754, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.07671233}
confusion matrix:
       0   1
0  18038  29
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8643861, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_16.png
new oracle model saved
early stop counter: 5
val acc:0.9640341401100159, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9613277316093445
after epoch: 16,now: 2024-06-15 03:35:12.298801,epoch time: 0:17:43.135804,used: 4:44:43.834945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7358793, 'recall': 0.53685653, 'specificity': 0.53685653, 'f1': 0.5578522, 'auroc': 0.8940101, 'binary_precision': 0.5022831, 'binary_recall': 0.07628294, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.13245034}
confusion matrix:
       0    1
0  42305  109
1   1332  110
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.70905006, 'recall': 0.51702803, 'specificity': 0.51702803, 'f1': 0.52383435, 'auroc': 0.8955137, 'binary_precision': 0.4528302, 'binary_recall': 0.035661217, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.0661157}
confusion matrix:
       0   1
0  18038  29
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.86686605, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_17.png
new oracle model saved
early stop counter: 6
val acc:0.9638206958770752, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.9619722962379456
after epoch: 17,now: 2024-06-15 03:52:51.434345,epoch time: 0:17:39.135544,used: 5:02:22.970489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96675485, 'precision': 0.71663845, 'recall': 0.5343115, 'specificity': 0.5343115, 'f1': 0.55342704, 'auroc': 0.8878804, 'binary_precision': 0.46396396, 'binary_recall': 0.071428575, 'binary_specificity': 0.99719435, 'binary_f1_score': 0.12379808}
confusion matrix:
       0    1
0  42295  119
1   1339  103
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7370273, 'recall': 0.5214857, 'specificity': 0.5214857, 'f1': 0.53184026, 'auroc': 0.887566, 'binary_precision': 0.5084746, 'binary_recall': 0.044576522, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.081967205}
confusion matrix:
       0   1
0  18038  29
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9814575, 'recall': 0.5596154, 'specificity': 0.5596154, 'f1': 0.59708285, 'auroc': 0.8672851, 'binary_precision': 1.0, 'binary_recall': 0.11923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5946   0
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_18.png
new oracle model saved
early stop counter: 7
val acc:0.9641408920288086, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9584273099899292 / 0.963100254535675
after epoch: 18,now: 2024-06-15 04:10:24.766956,epoch time: 0:17:33.332611,used: 5:19:56.303100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73607856, 'recall': 0.554609, 'specificity': 0.554609, 'f1': 0.5838635, 'auroc': 0.89551973, 'binary_precision': 0.50153846, 'binary_recall': 0.113037445, 'binary_specificity': 0.99618053, 'binary_f1_score': 0.18449348}
confusion matrix:
       0    1
0  42252  162
1   1279  163
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7604965, 'recall': 0.5367554, 'specificity': 0.5367554, 'f1': 0.5576377, 'auroc': 0.89406985, 'binary_precision': 0.5543478, 'binary_recall': 0.075780086, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.13333333}
confusion matrix:
       0   1
0  18026  41
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.8654826, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-15 04:27:59.246407,epoch time: 0:17:34.479451,used: 5:37:30.782551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.7227613, 'recall': 0.56973386, 'specificity': 0.56973386, 'f1': 0.60245866, 'auroc': 0.8993479, 'binary_precision': 0.4739229, 'binary_recall': 0.14493759, 'binary_specificity': 0.9945301, 'binary_f1_score': 0.22198619}
confusion matrix:
       0    1
0  42182  232
1   1233  209
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.75566554, 'recall': 0.55397713, 'specificity': 0.55397713, 'f1': 0.58346534, 'auroc': 0.8959451, 'binary_precision': 0.54347825, 'binary_recall': 0.11144131, 'binary_specificity': 0.996513, 'binary_f1_score': 0.18495683}
confusion matrix:
       0   1
0  18004  63
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.96978295, 'recall': 0.62867796, 'specificity': 0.62867796, 'f1': 0.6955782, 'auroc': 0.87158847, 'binary_precision': 0.9710145, 'binary_recall': 0.2576923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.40729484}
confusion matrix:
      0   1
0  5944   2
1   193  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-15 04:45:30.665463,epoch time: 0:17:31.419056,used: 5:55:02.201607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.7558044, 'recall': 0.54381084, 'specificity': 0.54381084, 'f1': 0.5690763, 'auroc': 0.8943356, 'binary_precision': 0.5416667, 'binary_recall': 0.09021513, 'binary_specificity': 0.9974066, 'binary_f1_score': 0.15466985}
confusion matrix:
       0    1
0  42305  110
1   1311  130
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7366211, 'recall': 0.52434677, 'specificity': 0.52434677, 'f1': 0.5368006, 'auroc': 0.90276355, 'binary_precision': 0.5074627, 'binary_recall': 0.05052006, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.091891885}
confusion matrix:
       0   1
0  18034  33
1    639  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.9816915, 'recall': 0.5653846, 'specificity': 0.5653846, 'f1': 0.6063213, 'auroc': 0.868489, 'binary_precision': 1.0, 'binary_recall': 0.13076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.23129253}
confusion matrix:
      0   1
0  5946   0
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_21.png
early stop counter: 1
val acc:0.9641408920288086, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.9685788154602051 / 0.9685788154602051
after epoch: 21,now: 2024-06-15 05:03:06.788194,epoch time: 0:17:36.122731,used: 6:12:38.324338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.76010185, 'recall': 0.54820466, 'specificity': 0.54820466, 'f1': 0.57578725, 'auroc': 0.8937253, 'binary_precision': 0.55, 'binary_recall': 0.099167824, 'binary_specificity': 0.9972415, 'binary_f1_score': 0.16803761}
confusion matrix:
       0    1
0  42297  117
1   1299  143
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.73014647, 'recall': 0.53001356, 'specificity': 0.53001356, 'f1': 0.5462319, 'auroc': 0.902587, 'binary_precision': 0.49411765, 'binary_recall': 0.062407132, 'binary_specificity': 0.99762, 'binary_f1_score': 0.11081795}
confusion matrix:
       0   1
0  18024  43
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.8685082, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_22.png
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.9685788154602051 / 0.9685788154602051
after epoch: 22,now: 2024-06-15 05:20:41.484739,epoch time: 0:17:34.696545,used: 6:30:13.020883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.73842454, 'recall': 0.55430937, 'specificity': 0.55430937, 'f1': 0.58357567, 'auroc': 0.9002628, 'binary_precision': 0.50625, 'binary_recall': 0.11234397, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.18388195}
confusion matrix:
       0    1
0  42256  158
1   1280  162
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.72813475, 'recall': 0.53427744, 'specificity': 0.53427744, 'f1': 0.5530629, 'auroc': 0.90616345, 'binary_precision': 0.48979592, 'binary_recall': 0.07132243, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.12451361}
confusion matrix:
       0   1
0  18017  50
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.98278666, 'recall': 0.5923077, 'specificity': 0.5923077, 'f1': 0.64708674, 'auroc': 0.87148166, 'binary_precision': 1.0, 'binary_recall': 0.18461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5946   0
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_23.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.9685788154602051 / 0.9685788154602051
after epoch: 23,now: 2024-06-15 05:38:20.187075,epoch time: 0:17:38.702336,used: 6:47:51.723219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.73432124, 'recall': 0.54989606, 'specificity': 0.54989606, 'f1': 0.5771906, 'auroc': 0.90102756, 'binary_precision': 0.49832776, 'binary_recall': 0.10332871, 'binary_specificity': 0.9964634, 'binary_f1_score': 0.17116599}
confusion matrix:
       0    1
0  42264  150
1   1293  149
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.72399974, 'recall': 0.5285277, 'specificity': 0.5285277, 'f1': 0.5437063, 'auroc': 0.9075402, 'binary_precision': 0.48192772, 'binary_recall': 0.059435364, 'binary_specificity': 0.99762, 'binary_f1_score': 0.10582011}
confusion matrix:
       0   1
0  18024  43
1    633  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.9827082, 'recall': 0.5903846, 'specificity': 0.5903846, 'f1': 0.64429647, 'auroc': 0.8699889, 'binary_precision': 1.0, 'binary_recall': 0.18076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.30618894}
confusion matrix:
      0   1
0  5946   0
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_24.png
early stop counter: 4
val acc:0.9639274477958679, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.9685788154602051 / 0.9685788154602051
after epoch: 24,now: 2024-06-15 05:55:57.581392,epoch time: 0:17:37.394317,used: 7:05:29.117536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664128, 'precision': 0.715884, 'recall': 0.5605958, 'specificity': 0.5605958, 'f1': 0.5904982, 'auroc': 0.89858687, 'binary_precision': 0.4607595, 'binary_recall': 0.1262136, 'binary_specificity': 0.9949781, 'binary_f1_score': 0.19814917}
confusion matrix:
       0    1
0  42201  213
1   1260  182
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.76017416, 'recall': 0.54899794, 'specificity': 0.54899794, 'f1': 0.5764314, 'auroc': 0.90052223, 'binary_precision': 0.55284554, 'binary_recall': 0.10104012, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.17085427}
confusion matrix:
       0   1
0  18012  55
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.9668999, 'recall': 0.61137027, 'specificity': 0.61137027, 'f1': 0.67281467, 'auroc': 0.87431836, 'binary_precision': 0.96666664, 'binary_recall': 0.22307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.3625}
confusion matrix:
      0   1
0  5944   2
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_25.png
better model found
persisted
after epoch: 25,now: 2024-06-15 06:13:35.592493,epoch time: 0:17:38.011101,used: 7:23:07.128637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.7396699, 'recall': 0.5620369, 'specificity': 0.5620369, 'f1': 0.5940783, 'auroc': 0.8993522, 'binary_precision': 0.5082418, 'binary_recall': 0.12829404, 'binary_specificity': 0.9957797, 'binary_f1_score': 0.20487265}
confusion matrix:
       0    1
0  42235  179
1   1257  185
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7706566, 'recall': 0.5361231, 'specificity': 0.5361231, 'f1': 0.5568025, 'auroc': 0.9013271, 'binary_precision': 0.57471263, 'binary_recall': 0.0742942, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.13157894}
confusion matrix:
       0   1
0  18030  37
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.9821602, 'recall': 0.5769231, 'specificity': 0.5769231, 'f1': 0.6242515, 'auroc': 0.86929816, 'binary_precision': 1.0, 'binary_recall': 0.15384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5946   0
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_26.png
early stop counter: 1
val acc:0.9647812247276306, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.967128574848175 / 0.9685788154602051
after epoch: 26,now: 2024-06-15 06:31:13.302023,epoch time: 0:17:37.709530,used: 7:40:44.838167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.7377491, 'recall': 0.58276856, 'specificity': 0.58276856, 'f1': 0.6193929, 'auroc': 0.911924, 'binary_precision': 0.503055, 'binary_recall': 0.17128988, 'binary_specificity': 0.9942472, 'binary_f1_score': 0.2555613}
confusion matrix:
       0    1
0  42170  244
1   1195  247
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7571535, 'recall': 0.54608154, 'specificity': 0.54608154, 'f1': 0.5719911, 'auroc': 0.9021739, 'binary_precision': 0.5470086, 'binary_recall': 0.09509658, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.16202532}
confusion matrix:
       0   1
0  18014  53
1    609  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.9831004, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.65807164, 'auroc': 0.8728772, 'binary_precision': 1.0, 'binary_recall': 0.2, 'binary_specificity': 1.0, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5946   0
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_27.png
early stop counter: 2
val acc:0.9646744728088379, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.967128574848175 / 0.9685788154602051
after epoch: 27,now: 2024-06-15 06:48:56.551357,epoch time: 0:17:43.249334,used: 7:58:28.087501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9675073, 'precision': 0.74444914, 'recall': 0.5933171, 'specificity': 0.5933171, 'f1': 0.63202226, 'auroc': 0.8999269, 'binary_precision': 0.51576996, 'binary_recall': 0.1927878, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.28066635}
confusion matrix:
       0    1
0  42153  261
1   1164  278
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7723308, 'recall': 0.55997604, 'specificity': 0.55997604, 'f1': 0.592713, 'auroc': 0.896441, 'binary_precision': 0.5763889, 'binary_recall': 0.12332838, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.20318237}
confusion matrix:
       0   1
0  18006  61
1    590  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.9589737, 'recall': 0.61128616, 'specificity': 0.61128616, 'f1': 0.67220795, 'auroc': 0.8680163, 'binary_precision': 0.9508197, 'binary_recall': 0.22307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.36137074}
confusion matrix:
      0   1
0  5943   3
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_28.png
better model found
persisted
after epoch: 28,now: 2024-06-15 07:06:38.096473,epoch time: 0:17:41.545116,used: 8:16:09.632617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96689165, 'precision': 0.732475, 'recall': 0.59735316, 'specificity': 0.59735316, 'f1': 0.63459426, 'auroc': 0.90423083, 'binary_precision': 0.49155405, 'binary_recall': 0.20180306, 'binary_specificity': 0.9929033, 'binary_f1_score': 0.2861357}
confusion matrix:
       0    1
0  42113  301
1   1151  291
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.75809133, 'recall': 0.5619281, 'specificity': 0.5619281, 'f1': 0.59463763, 'auroc': 0.91015875, 'binary_precision': 0.5477707, 'binary_recall': 0.12778603, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.2072289}
confusion matrix:
       0   1
0  17996  71
1    587  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.9624551, 'recall': 0.62667084, 'specificity': 0.62667084, 'f1': 0.692456, 'auroc': 0.8760841, 'binary_precision': 0.95652175, 'binary_recall': 0.25384617, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.40121582}
confusion matrix:
      0   1
0  5943   3
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_29.png
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9669674634933472 / 0.9685788154602051
after epoch: 29,now: 2024-06-15 07:24:10.972755,epoch time: 0:17:32.876282,used: 8:33:42.508899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.7272321, 'recall': 0.5975349, 'specificity': 0.5975349, 'f1': 0.6339576, 'auroc': 0.9066598, 'binary_precision': 0.48105437, 'binary_recall': 0.20249653, 'binary_specificity': 0.9925732, 'binary_f1_score': 0.28501707}
confusion matrix:
       0    1
0  42099  315
1   1150  292
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7547306, 'recall': 0.5669073, 'specificity': 0.5669073, 'f1': 0.60106504, 'auroc': 0.9084252, 'binary_precision': 0.5406977, 'binary_recall': 0.13818721, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.22011833}
confusion matrix:
       0   1
0  17988  79
1    580  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.95748043, 'recall': 0.634279, 'specificity': 0.634279, 'f1': 0.7015497, 'auroc': 0.87494, 'binary_precision': 0.9459459, 'binary_recall': 0.26923078, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.4191617}
confusion matrix:
      0   1
0  5942   4
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_30.png
new oracle model saved
early stop counter: 2
val acc:0.9648345708847046, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9669674634933472 / 0.968739926815033
after epoch: 30,now: 2024-06-15 07:41:47.745626,epoch time: 0:17:36.772871,used: 8:51:19.281770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_22_50_28_seed_1_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:51:19.281770 at 2024-06-15 07:41:47.745626
persisted model performance metric: 

scalar performance:
{'acc': 0.96696746, 'precision': 0.9589737, 'recall': 0.61128616, 'specificity': 0.61128616, 'f1': 0.67220795, 'auroc': 0.8680163, 'binary_precision': 0.9508197, 'binary_recall': 0.22307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.36137074}
confusion matrix:
      0   1
0  5943   3
1   202  58
oracle model performance metric: 

scalar performance:
{'acc': 0.9687399, 'precision': 0.95748043, 'recall': 0.634279, 'specificity': 0.634279, 'f1': 0.7015497, 'auroc': 0.87494, 'binary_precision': 0.9459459, 'binary_recall': 0.26923078, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.4191617}
confusion matrix:
      0   1
0  5942   4
1   190  70
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 709645 GiB | 709645 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6231    |  167413 K  |  167410 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99734 K  |   99731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6231    |  167413 K  |  167410 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99734 K  |   99731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2755    |   76345 K  |   76345 K  |
|       from large pool |       5    |      13    |   25322 K  |   25322 K  |
|       from small pool |      32    |    2750    |   51022 K  |   51022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709645 GiB | 709645 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76346 K  |   76346 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2750    |   51024 K  |   51024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709645 GiB | 709645 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 709036 GiB | 709036 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167413 K  |  167413 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99734 K  |   99734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76346 K  |   76346 K  |
|       from large pool |       3    |      13    |   25322 K  |   25322 K  |
|       from small pool |       0    |    2750    |   51024 K  |   51024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356

 Experiment start at: 2024-06-15 07:48:42.856973
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.45729548, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.42765367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3279248, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 08:06:28.834776,epoch time: 0:17:45.977803,used: 0:17:45.977803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.54381347, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.5204059, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.43357888, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-15 08:23:41.056555,epoch time: 0:17:12.221779,used: 0:34:58.199582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.6191928, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.58127105, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.57315433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-15 08:41:06.872665,epoch time: 0:17:25.816110,used: 0:52:24.015692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.70881355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.69878745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.66788626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-15 08:58:42.984346,epoch time: 0:17:36.111681,used: 1:10:00.127373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.7701241, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7901385, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7643728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-15 09:16:20.399763,epoch time: 0:17:37.415417,used: 1:27:37.542790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.8119192, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.82913774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8105285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-15 09:34:13.314009,epoch time: 0:17:52.914246,used: 1:45:30.457036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.81642044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.81970006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.79084647, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-15 09:52:26.535539,epoch time: 0:18:13.221530,used: 2:03:43.678566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.48273697, 'recall': 0.49997637, 'specificity': 0.49997637, 'f1': 0.49120545, 'auroc': 0.82789505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  2
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8372957, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.81603336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-15 10:10:50.094356,epoch time: 0:18:23.558817,used: 2:22:07.237383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.6494249, 'recall': 0.5006137, 'specificity': 0.5006137, 'f1': 0.49252173, 'auroc': 0.8553231, 'binary_precision': 0.33333334, 'binary_recall': 0.0013218771, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.0026333113}
confusion matrix:
       0  1
0  42307  4
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.9839921, 'recall': 0.5008306, 'specificity': 0.5008306, 'f1': 0.49352425, 'auroc': 0.86780226, 'binary_precision': 1.0, 'binary_recall': 0.0016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.0033167494}
confusion matrix:
       0  1
0  18171  0
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.84008193, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-15 10:29:19.889568,epoch time: 0:18:29.795212,used: 2:40:37.032595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.69708645, 'recall': 0.5018883, 'specificity': 0.5018883, 'f1': 0.49513352, 'auroc': 0.86272776, 'binary_precision': 0.42857143, 'binary_recall': 0.003965631, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.0078585455}
confusion matrix:
       0  1
0  42303  8
1   1507  6
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.86513424, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84758973, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_10.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9616925716400146
after epoch: 10,now: 2024-06-15 10:47:58.620992,epoch time: 0:18:38.731424,used: 2:59:15.764019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7686237, 'recall': 0.5051457, 'specificity': 0.5051457, 'f1': 0.50162053, 'auroc': 0.8687935, 'binary_precision': 0.5714286, 'binary_recall': 0.010575017, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.020765739}
confusion matrix:
       0   1
0  42299  12
1   1497  16
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.9839921, 'recall': 0.5008306, 'specificity': 0.5008306, 'f1': 0.49352425, 'auroc': 0.865085, 'binary_precision': 1.0, 'binary_recall': 0.0016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.0033167494}
confusion matrix:
       0  1
0  18171  0
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8477297, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_11.png
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9616925716400146
after epoch: 11,now: 2024-06-15 11:06:13.440208,epoch time: 0:18:14.819216,used: 3:17:30.583235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.73957443, 'recall': 0.5127697, 'specificity': 0.5127697, 'f1': 0.5163623, 'auroc': 0.87628424, 'binary_precision': 0.51282054, 'binary_recall': 0.026437541, 'binary_specificity': 0.9991019, 'binary_f1_score': 0.050282843}
confusion matrix:
       0   1
0  42273  38
1   1473  40
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.6090128, 'recall': 0.501496, 'specificity': 0.501496, 'f1': 0.49507532, 'auroc': 0.8849613, 'binary_precision': 0.25, 'binary_recall': 0.003322259, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.0065573766}
confusion matrix:
       0  1
0  18165  6
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.85791445, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_12.png
new oracle model saved
early stop counter: 3
val acc:0.9677196145057678, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9623336791992188
after epoch: 12,now: 2024-06-15 11:24:29.504090,epoch time: 0:18:16.063882,used: 3:35:46.647117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.965795, 'precision': 0.77593696, 'recall': 0.5154607, 'specificity': 0.5154607, 'f1': 0.5213843, 'auroc': 0.8910306, 'binary_precision': 0.58536583, 'binary_recall': 0.03172505, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.06018809}
confusion matrix:
       0   1
0  42277  34
1   1465  48
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.70638645, 'recall': 0.50636935, 'specificity': 0.50636935, 'f1': 0.5047247, 'auroc': 0.8959447, 'binary_precision': 0.44444445, 'binary_recall': 0.013289036, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.025806451}
confusion matrix:
       0   1
0  18161  10
1    594   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.86278534, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_13.png
early stop counter: 4
val acc:0.9678261280059814, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9623336791992188
after epoch: 13,now: 2024-06-15 11:42:50.854197,epoch time: 0:18:21.350107,used: 3:54:07.997224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96590906, 'precision': 0.77406776, 'recall': 0.52189285, 'specificity': 0.52189285, 'f1': 0.53303355, 'auroc': 0.8832157, 'binary_precision': 0.5811966, 'binary_recall': 0.04494382, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.08343558}
confusion matrix:
       0   1
0  42262  49
1   1445  68
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.6420048, 'recall': 0.5046257, 'specificity': 0.5046257, 'f1': 0.5014154, 'auroc': 0.88057435, 'binary_precision': 0.31578946, 'binary_recall': 0.009966778, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.019323671}
confusion matrix:
       0   1
0  18158  13
1    596   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.98153204, 'recall': 0.5247934, 'specificity': 0.5247934, 'f1': 0.5378364, 'auroc': 0.85148484, 'binary_precision': 1.0, 'binary_recall': 0.049586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.09448819}
confusion matrix:
      0   1
0  5997   0
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_14.png
new oracle model saved
early stop counter: 5
val acc:0.967559814453125, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9631351232528687
after epoch: 14,now: 2024-06-15 12:01:06.773613,epoch time: 0:18:15.919416,used: 4:12:23.916640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9656125, 'precision': 0.74618065, 'recall': 0.5163215, 'specificity': 0.5163215, 'f1': 0.522939, 'auroc': 0.8858379, 'binary_precision': 0.52577317, 'binary_recall': 0.03373016, 'binary_specificity': 0.9989128, 'binary_f1_score': 0.06339342}
confusion matrix:
       0   1
0  42266  46
1   1461  51
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7341909, 'recall': 0.5072274, 'specificity': 0.5072274, 'f1': 0.5063647, 'auroc': 0.87874645, 'binary_precision': 0.5, 'binary_recall': 0.014950166, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.02903226}
confusion matrix:
       0  1
0  18162  9
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9823842, 'recall': 0.54752064, 'specificity': 0.54752064, 'f1': 0.57782656, 'auroc': 0.855281, 'binary_precision': 1.0, 'binary_recall': 0.09504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.17358491}
confusion matrix:
      0   1
0  5997   0
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_15.png
new oracle model saved
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9648982286453247
after epoch: 15,now: 2024-06-15 12:19:37.037709,epoch time: 0:18:30.264096,used: 4:30:54.180736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9657494, 'precision': 0.7472874, 'recall': 0.5380614, 'specificity': 0.5380614, 'f1': 0.5596942, 'auroc': 0.8885342, 'binary_precision': 0.5265487, 'binary_recall': 0.07865169, 'binary_specificity': 0.9974711, 'binary_f1_score': 0.13686028}
confusion matrix:
       0    1
0  42204  107
1   1394  119
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7100271, 'recall': 0.51833254, 'specificity': 0.51833254, 'f1': 0.5269956, 'auroc': 0.89842486, 'binary_precision': 0.4509804, 'binary_recall': 0.03820598, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.07044411}
confusion matrix:
       0   1
0  18143  28
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.9516725, 'recall': 0.56181675, 'specificity': 0.56181675, 'f1': 0.6007214, 'auroc': 0.871264, 'binary_precision': 0.9375, 'binary_recall': 0.12396694, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.2189781}
confusion matrix:
      0   1
0  5995   2
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_16.png
new oracle model saved
early stop counter: 7
val acc:0.9676663279533386, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9656996130943298
after epoch: 16,now: 2024-06-15 12:37:57.408143,epoch time: 0:18:20.370434,used: 4:49:14.551170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.73241353, 'recall': 0.5439503, 'specificity': 0.5439503, 'f1': 0.56822914, 'auroc': 0.89964783, 'binary_precision': 0.4964029, 'binary_recall': 0.091209516, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.15410386}
confusion matrix:
       0    1
0  42171  140
1   1375  138
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.706684, 'recall': 0.5159234, 'specificity': 0.5159234, 'f1': 0.5226868, 'auroc': 0.8930204, 'binary_precision': 0.44444445, 'binary_recall': 0.03322259, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.061823796}
confusion matrix:
       0   1
0  18146  25
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.97150934, 'recall': 0.58256125, 'specificity': 0.58256125, 'f1': 0.6330197, 'auroc': 0.86852586, 'binary_precision': 0.9756098, 'binary_recall': 0.16528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28268552}
confusion matrix:
      0   1
0  5996   1
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_17.png
new oracle model saved
early stop counter: 8
val acc:0.9676663279533386, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9674627184867859
after epoch: 17,now: 2024-06-15 12:56:25.906337,epoch time: 0:18:28.498194,used: 5:07:43.049364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9660232, 'precision': 0.75472856, 'recall': 0.5512679, 'specificity': 0.5512679, 'f1': 0.5797734, 'auroc': 0.9036156, 'binary_precision': 0.5405405, 'binary_recall': 0.105750166, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.17689331}
confusion matrix:
       0    1
0  42175  136
1   1353  160
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.70594704, 'recall': 0.5214897, 'specificity': 0.5214897, 'f1': 0.5324682, 'auroc': 0.8971919, 'binary_precision': 0.44262296, 'binary_recall': 0.0448505, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.08144796}
confusion matrix:
       0   1
0  18137  34
1    575  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.9694256, 'recall': 0.57223064, 'specificity': 0.57223064, 'f1': 0.61737466, 'auroc': 0.86857545, 'binary_precision': 0.9722222, 'binary_recall': 0.1446281, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25179857}
confusion matrix:
      0   1
0  5996   1
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_18.png
early stop counter: 9
val acc:0.967559814453125, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9674627184867859
after epoch: 18,now: 2024-06-15 13:14:45.675921,epoch time: 0:18:19.769584,used: 5:26:02.818948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9650648, 'precision': 0.7231152, 'recall': 0.55873793, 'specificity': 0.55873793, 'f1': 0.58838975, 'auroc': 0.8931951, 'binary_precision': 0.47680414, 'binary_recall': 0.12227363, 'binary_specificity': 0.9952022, 'binary_f1_score': 0.19463441}
confusion matrix:
       0    1
0  42108  203
1   1328  185
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7350682, 'recall': 0.5353341, 'specificity': 0.5353341, 'f1': 0.5556012, 'auroc': 0.9021056, 'binary_precision': 0.5, 'binary_recall': 0.073089704, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.12753624}
confusion matrix:
       0   1
0  18127  44
1    558  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.9598923, 'recall': 0.58247787, 'specificity': 0.58247787, 'f1': 0.6324803, 'auroc': 0.86837894, 'binary_precision': 0.95238096, 'binary_recall': 0.16528925, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28169015}
confusion matrix:
      0   1
0  5995   2
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_19.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9674627184867859
after epoch: 19,now: 2024-06-15 13:33:01.909524,epoch time: 0:18:16.233603,used: 5:44:19.052551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96590906, 'precision': 0.7536918, 'recall': 0.5419679, 'specificity': 0.5419679, 'f1': 0.5659044, 'auroc': 0.897248, 'binary_precision': 0.5390946, 'binary_recall': 0.08658295, 'binary_specificity': 0.99735296, 'binary_f1_score': 0.14920273}
confusion matrix:
       0    1
0  42199  112
1   1382  131
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7111014, 'recall': 0.53029567, 'specificity': 0.53029567, 'f1': 0.547119, 'auroc': 0.9042581, 'binary_precision': 0.45238096, 'binary_recall': 0.06312292, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.11078717}
confusion matrix:
       0   1
0  18125  46
1    564  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.95555663, 'recall': 0.6009895, 'specificity': 0.6009895, 'f1': 0.65862334, 'auroc': 0.8721639, 'binary_precision': 0.9423077, 'binary_recall': 0.20247933, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5994   3
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_20.png
new oracle model saved
early stop counter: 11
val acc:0.9675065279006958, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9685847163200378
after epoch: 20,now: 2024-06-15 13:51:17.520624,epoch time: 0:18:15.611100,used: 6:02:34.663651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96558964, 'precision': 0.7382364, 'recall': 0.5558232, 'specificity': 0.5558232, 'f1': 0.5853984, 'auroc': 0.90108633, 'binary_precision': 0.5072464, 'binary_recall': 0.11566424, 'binary_specificity': 0.9959821, 'binary_f1_score': 0.1883746}
confusion matrix:
       0    1
0  42141  170
1   1338  175
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.7194636, 'recall': 0.53597206, 'specificity': 0.53597206, 'f1': 0.5562198, 'auroc': 0.90270084, 'binary_precision': 0.46875, 'binary_recall': 0.07475083, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.12893984}
confusion matrix:
       0   1
0  18120  51
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.9844886, 'recall': 0.6033058, 'specificity': 0.6033058, 'f1': 0.663355, 'auroc': 0.87212807, 'binary_precision': 1.0, 'binary_recall': 0.20661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.34246573}
confusion matrix:
      0   1
0  5997   0
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_21.png
new oracle model saved
early stop counter: 12
val acc:0.9676130414009094, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9613720178604126 / 0.9692258238792419
after epoch: 21,now: 2024-06-15 14:09:31.612752,epoch time: 0:18:14.092128,used: 6:20:48.755779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9653158, 'precision': 0.7307367, 'recall': 0.5652409, 'specificity': 0.5652409, 'f1': 0.5973513, 'auroc': 0.9008308, 'binary_precision': 0.4916067, 'binary_recall': 0.1354924, 'binary_specificity': 0.99498945, 'binary_f1_score': 0.21243523}
confusion matrix:
       0    1
0  42099  212
1   1308  205
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.73950565, 'recall': 0.5522532, 'specificity': 0.5522532, 'f1': 0.58089244, 'auroc': 0.9031005, 'binary_precision': 0.5078125, 'binary_recall': 0.10797342, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.1780822}
confusion matrix:
       0   1
0  18108  63
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.96051824, 'recall': 0.61958456, 'specificity': 0.61958456, 'f1': 0.6837395, 'auroc': 0.8748305, 'binary_precision': 0.9508197, 'binary_recall': 0.23966943, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3828383}
confusion matrix:
      0   1
0  5994   3
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-15 14:27:43.740928,epoch time: 0:18:12.128176,used: 6:39:00.883955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96527016, 'precision': 0.72882164, 'recall': 0.5591629, 'specificity': 0.5591629, 'f1': 0.5893307, 'auroc': 0.90140593, 'binary_precision': 0.48818898, 'binary_recall': 0.122934565, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.1964097}
confusion matrix:
       0    1
0  42116  195
1   1327  186
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7378013, 'recall': 0.53857386, 'specificity': 0.53857386, 'f1': 0.5607116, 'auroc': 0.89939, 'binary_precision': 0.50526315, 'binary_recall': 0.07973422, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.13773315}
confusion matrix:
       0   1
0  18124  47
1    554  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9622751, 'recall': 0.59074235, 'specificity': 0.59074235, 'f1': 0.64457434, 'auroc': 0.8738241, 'binary_precision': 0.95652175, 'binary_recall': 0.18181819, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.30555555}
confusion matrix:
      0   1
0  5995   2
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_23.png
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9700272679328918 / 0.9700272679328918
after epoch: 23,now: 2024-06-15 14:45:57.880097,epoch time: 0:18:14.139169,used: 6:57:15.023124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96577215, 'precision': 0.74278986, 'recall': 0.5693011, 'specificity': 0.5693011, 'f1': 0.6034527, 'auroc': 0.90318954, 'binary_precision': 0.51543945, 'binary_recall': 0.14342366, 'binary_specificity': 0.9951786, 'binary_f1_score': 0.22440536}
confusion matrix:
       0    1
0  42107  204
1   1296  217
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7376089, 'recall': 0.5458013, 'specificity': 0.5458013, 'f1': 0.5715614, 'auroc': 0.8974835, 'binary_precision': 0.50442475, 'binary_recall': 0.094684385, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.15944056}
confusion matrix:
       0   1
0  18115  56
1    545  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.9673316, 'recall': 0.6134696, 'specificity': 0.6134696, 'f1': 0.6761873, 'auroc': 0.87287855, 'binary_precision': 0.9649123, 'binary_recall': 0.22727273, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.36789298}
confusion matrix:
      0   1
0  5995   2
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_24.png
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9700272679328918 / 0.9700272679328918
after epoch: 24,now: 2024-06-15 15:04:08.847125,epoch time: 0:18:10.967028,used: 7:15:25.990152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.965795, 'precision': 0.7436472, 'recall': 0.5667637, 'specificity': 0.5667637, 'f1': 0.6002821, 'auroc': 0.90452087, 'binary_precision': 0.5173267, 'binary_recall': 0.13813615, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.21804903}
confusion matrix:
       0    1
0  42116  195
1   1304  209
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7408838, 'recall': 0.5353892, 'specificity': 0.5353892, 'f1': 0.55581415, 'auroc': 0.906618, 'binary_precision': 0.5116279, 'binary_recall': 0.073089704, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.12790698}
confusion matrix:
       0   1
0  18129  42
1    558  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.9843321, 'recall': 0.59917355, 'specificity': 0.59917355, 'f1': 0.65755856, 'auroc': 0.8702444, 'binary_precision': 1.0, 'binary_recall': 0.1983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.33103448}
confusion matrix:
      0   1
0  5997   0
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_25.png
early stop counter: 3
val acc:0.9680392146110535, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9700272679328918 / 0.9700272679328918
after epoch: 25,now: 2024-06-15 15:22:14.410013,epoch time: 0:18:05.562888,used: 7:33:31.553040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7373935, 'recall': 0.5704694, 'specificity': 0.5704694, 'f1': 0.60447097, 'auroc': 0.9085795, 'binary_precision': 0.5045662, 'binary_recall': 0.14606741, 'binary_specificity': 0.9948713, 'binary_f1_score': 0.22655047}
confusion matrix:
       0    1
0  42094  217
1   1292  221
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7180725, 'recall': 0.54314446, 'specificity': 0.54314446, 'f1': 0.5669272, 'auroc': 0.91007584, 'binary_precision': 0.46551725, 'binary_recall': 0.089701, 'binary_specificity': 0.996588, 'binary_f1_score': 0.15041783}
confusion matrix:
       0   1
0  18109  62
1    548  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.9680832, 'recall': 0.6176019, 'specificity': 0.6176019, 'f1': 0.68169034, 'auroc': 0.8754556, 'binary_precision': 0.9661017, 'binary_recall': 0.23553719, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3787375}
confusion matrix:
      0   1
0  5995   2
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_26.png
early stop counter: 4
val acc:0.9675065279006958, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9700272679328918 / 0.9700272679328918
after epoch: 26,now: 2024-06-15 15:40:25.286011,epoch time: 0:18:10.875998,used: 7:51:42.429038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96572655, 'precision': 0.7406726, 'recall': 0.59381366, 'specificity': 0.59381366, 'f1': 0.6318922, 'auroc': 0.909251, 'binary_precision': 0.50953203, 'binary_recall': 0.19431593, 'binary_specificity': 0.9933114, 'binary_f1_score': 0.28133973}
confusion matrix:
       0    1
0  42028  283
1   1219  294
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73753625, 'recall': 0.56186223, 'specificity': 0.56186223, 'f1': 0.59381896, 'auroc': 0.91102505, 'binary_precision': 0.503268, 'binary_recall': 0.12790698, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.20397352}
confusion matrix:
       0   1
0  18095  76
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729123, 'precision': 0.9565592, 'recall': 0.66074014, 'specificity': 0.66074014, 'f1': 0.733047, 'auroc': 0.88075083, 'binary_precision': 0.939759, 'binary_recall': 0.32231405, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.48000002}
confusion matrix:
      0   1
0  5992   5
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_27.png
new oracle model saved
early stop counter: 5
val acc:0.9679859280586243, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9700272679328918 / 0.9729123115539551
after epoch: 27,now: 2024-06-15 15:59:18.103816,epoch time: 0:18:52.817805,used: 8:10:35.246843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9656125, 'precision': 0.73848975, 'recall': 0.57559144, 'specificity': 0.57559144, 'f1': 0.61084086, 'auroc': 0.90628123, 'binary_precision': 0.50641024, 'binary_recall': 0.15664244, 'binary_specificity': 0.99454045, 'binary_f1_score': 0.2392731}
confusion matrix:
       0    1
0  42080  231
1   1276  237
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7418841, 'recall': 0.54826546, 'specificity': 0.54826546, 'f1': 0.5753166, 'auroc': 0.9025781, 'binary_precision': 0.51282054, 'binary_recall': 0.09966777, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.16689846}
confusion matrix:
       0   1
0  18114  57
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.9619067, 'recall': 0.6257829, 'specificity': 0.6257829, 'f1': 0.6917881, 'auroc': 0.87768763, 'binary_precision': 0.953125, 'binary_recall': 0.2520661, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3986928}
confusion matrix:
      0   1
0  5994   3
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_28.png
better model found
persisted
after epoch: 28,now: 2024-06-15 16:17:49.063579,epoch time: 0:18:30.959763,used: 8:29:06.206606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9664567, 'precision': 0.7623173, 'recall': 0.57029295, 'specificity': 0.57029295, 'f1': 0.60620743, 'auroc': 0.90884334, 'binary_precision': 0.55443037, 'binary_recall': 0.14474554, 'binary_specificity': 0.9958403, 'binary_f1_score': 0.22955975}
confusion matrix:
       0    1
0  42135  176
1   1294  219
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74048966, 'recall': 0.53860134, 'specificity': 0.53860134, 'f1': 0.5608244, 'auroc': 0.91030014, 'binary_precision': 0.5106383, 'binary_recall': 0.07973422, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.13793105}
confusion matrix:
       0   1
0  18125  46
1    554  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.9841757, 'recall': 0.59504133, 'specificity': 0.59504133, 'f1': 0.65168285, 'auroc': 0.87484825, 'binary_precision': 1.0, 'binary_recall': 0.19008264, 'binary_specificity': 1.0, 'binary_f1_score': 0.31944442}
confusion matrix:
      0   1
0  5997   0
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_29.png
early stop counter: 1
val acc:0.9680392146110535, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9705080986022949 / 0.9729123115539551
after epoch: 29,now: 2024-06-15 16:36:02.277228,epoch time: 0:18:13.213649,used: 8:47:19.420255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.74311924, 'recall': 0.58047754, 'specificity': 0.58047754, 'f1': 0.61712885, 'auroc': 0.9063858, 'binary_precision': 0.5153374, 'binary_recall': 0.1665565, 'binary_specificity': 0.9943986, 'binary_f1_score': 0.25174823}
confusion matrix:
       0    1
0  42074  237
1   1261  252
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7375245, 'recall': 0.55543786, 'specificity': 0.55543786, 'f1': 0.5852052, 'auroc': 0.9071821, 'binary_precision': 0.50364965, 'binary_recall': 0.114617944, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.18673885}
confusion matrix:
       0   1
0  18103  68
1    533  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.96234584, 'recall': 0.62784904, 'specificity': 0.62784904, 'f1': 0.69443655, 'auroc': 0.87828743, 'binary_precision': 0.95384616, 'binary_recall': 0.25619835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.4039088}
confusion matrix:
      0   1
0  5994   3
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21324356_30.png
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9705080986022949 / 0.9729123115539551
after epoch: 30,now: 2024-06-15 16:54:16.986688,epoch time: 0:18:14.709460,used: 9:05:34.129715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_07_48_42_seed_2_21324356
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:05:34.129715 at 2024-06-15 16:54:16.986688
persisted model performance metric: 

scalar performance:
{'acc': 0.9705081, 'precision': 0.9619067, 'recall': 0.6257829, 'specificity': 0.6257829, 'f1': 0.6917881, 'auroc': 0.87768763, 'binary_precision': 0.953125, 'binary_recall': 0.2520661, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.3986928}
confusion matrix:
      0   1
0  5994   3
1   181  61
oracle model performance metric: 

scalar performance:
{'acc': 0.9729123, 'precision': 0.9565592, 'recall': 0.66074014, 'specificity': 0.66074014, 'f1': 0.733047, 'auroc': 0.88075083, 'binary_precision': 0.939759, 'binary_recall': 0.32231405, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.48000002}
confusion matrix:
      0   1
0  5992   5
1   164  78
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_learningrates/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80594 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |  12114 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6231    |  251124 K  |  251121 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149602 K  |  149599 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6231    |  251124 K  |  251121 K  |
|       from large pool |      36    |      76    |  101521 K  |  101521 K  |
|       from small pool |    3204    |    6194    |  149602 K  |  149599 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2755    |  115105 K  |  115105 K  |
|       from large pool |       5    |      13    |   38544 K  |   38544 K  |
|       from small pool |      34    |    2750    |   76560 K  |   76560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2834 TiB |   2834 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2833 TiB |   2833 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2820 TiB |   2820 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2820 TiB |   2820 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1502 MiB |   1224 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    126 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1014 TiB |   1014 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1013 TiB |   1013 TiB |
|       from small pool |      0 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  251124 K  |  251124 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149602 K  |  149602 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  251124 K  |  251124 K  |
|       from large pool |       2    |      76    |  101521 K  |  101521 K  |
|       from small pool |       0    |    6194    |  149602 K  |  149602 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      85    |      51    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      24    |      37    |      63    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |  115106 K  |  115106 K  |
|       from large pool |       3    |      13    |   38544 K  |   38544 K  |
|       from small pool |       0    |    2750    |   76561 K  |   76561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 15 16:55:19 2024]
Finished job 0.
1 of 1 steps (100%) done
