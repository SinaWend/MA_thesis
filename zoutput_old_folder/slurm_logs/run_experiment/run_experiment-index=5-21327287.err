Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 15 22:12:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287

 Experiment start at: 2024-06-15 22:21:01.183446
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.48800218, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41705722, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4352585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:37:38.078247,epoch time: 0:16:36.894801,used: 0:16:36.894801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5039141, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4180283, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41806346, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:52:52.911300,epoch time: 0:15:14.833053,used: 0:31:51.727854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.5218543, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43590778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.44768393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:08:05.620025,epoch time: 0:15:12.708725,used: 0:47:04.436579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.53243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.47207206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49307543, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:23:25.162792,epoch time: 0:15:19.542767,used: 1:02:23.979346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.5856072, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5066705, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5065186, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:38:32.589289,epoch time: 0:15:07.426497,used: 1:17:31.405843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6489942, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.58971137, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.57929474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-15 23:53:58.650041,epoch time: 0:15:26.060752,used: 1:32:57.466595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6782881, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6159722, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.61985946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:09:26.321932,epoch time: 0:15:27.671891,used: 1:48:25.138486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.72774625, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6759353, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70610255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:24:55.783849,epoch time: 0:15:29.461917,used: 2:03:54.600403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7520648, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7003716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.72014296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:40:14.381358,epoch time: 0:15:18.597509,used: 2:19:13.197912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.77896667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7526734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7664522, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 00:55:24.016583,epoch time: 0:15:09.635225,used: 2:34:22.833137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.8192581, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.78921187, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.79079103, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:10:44.452133,epoch time: 0:15:20.435550,used: 2:49:43.268687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.827978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.80254495, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.805292, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:26:04.866106,epoch time: 0:15:20.413973,used: 3:05:03.682660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.8370862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8195431, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82151806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 01:41:29.481518,epoch time: 0:15:24.615412,used: 3:20:28.298072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.85822904, 'recall': 0.5010072, 'specificity': 0.5010072, 'f1': 0.49349833, 'auroc': 0.8472272, 'binary_precision': 0.75, 'binary_recall': 0.0020380435, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0040650405}
confusion matrix:
       0  1
0  42327  1
1   1469  3
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8359565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8329344, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 01:57:01.093785,epoch time: 0:15:31.612267,used: 3:35:59.910339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9662557, 'precision': 0.63031715, 'recall': 0.50155777, 'specificity': 0.50155777, 'f1': 0.49477834, 'auroc': 0.86593115, 'binary_precision': 0.29411766, 'binary_recall': 0.0033990482, 'binary_specificity': 0.9997165, 'binary_f1_score': 0.0067204298}
confusion matrix:
       0   1
0  42317  12
1   1466   5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8544681, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8472282, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:12:34.980983,epoch time: 0:15:33.887198,used: 3:51:33.797537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.7750137, 'recall': 0.5046373, 'specificity': 0.5046373, 'f1': 0.5008337, 'auroc': 0.865994, 'binary_precision': 0.5833333, 'binary_recall': 0.009510869, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.018716577}
confusion matrix:
       0   1
0  42318  10
1   1458  14
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8547492, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8495723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_16.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:28:09.897274,epoch time: 0:15:34.916291,used: 4:07:08.713828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.76584214, 'recall': 0.5115777, 'specificity': 0.5115777, 'f1': 0.5143318, 'auroc': 0.8720249, 'binary_precision': 0.5645161, 'binary_recall': 0.023793338, 'binary_specificity': 0.9993621, 'binary_f1_score': 0.0456621}
confusion matrix:
       0   1
0  42302  27
1   1436  35
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.8619976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.85540533, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_17.png
new oracle model saved
early stop counter: 16
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9586129784584045
after epoch: 17,now: 2024-06-16 02:43:46.141722,epoch time: 0:15:36.244448,used: 4:22:44.958276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96678084, 'precision': 0.783747, 'recall': 0.51692176, 'specificity': 0.51692176, 'f1': 0.5243002, 'auroc': 0.8814304, 'binary_precision': 0.6, 'binary_recall': 0.03464674, 'binary_specificity': 0.99919677, 'binary_f1_score': 0.06551059}
confusion matrix:
       0   1
0  42294  34
1   1421  51
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.8726002, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8609089, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_18.png
new oracle model saved
early stop counter: 17
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 18,now: 2024-06-16 02:59:05.718223,epoch time: 0:15:19.576501,used: 4:38:04.534777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9658904, 'precision': 0.6827944, 'recall': 0.5144925, 'specificity': 0.5144925, 'f1': 0.51972467, 'auroc': 0.8856828, 'binary_precision': 0.39823008, 'binary_recall': 0.030591434, 'binary_specificity': 0.99839354, 'binary_f1_score': 0.056818184}
confusion matrix:
       0   1
0  42261  68
1   1426  45
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6704642, 'recall': 0.50219506, 'specificity': 0.50219506, 'f1': 0.49587625, 'auroc': 0.87823856, 'binary_precision': 0.375, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.00921659}
confusion matrix:
       0  1
0  18144  5
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8658616, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_19.png
new oracle model saved
early stop counter: 18
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9592521786689758
after epoch: 19,now: 2024-06-16 03:14:13.384098,epoch time: 0:15:07.665875,used: 4:53:12.200652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.7508754, 'recall': 0.5233845, 'specificity': 0.5233845, 'f1': 0.5357304, 'auroc': 0.88699734, 'binary_precision': 0.5338346, 'binary_recall': 0.048233695, 'binary_specificity': 0.9985353, 'binary_f1_score': 0.08847352}
confusion matrix:
       0   1
0  42266  62
1   1401  71
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.61932516, 'recall': 0.50211245, 'specificity': 0.50211245, 'f1': 0.4958138, 'auroc': 0.87994087, 'binary_precision': 0.27272728, 'binary_recall': 0.00466563, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0091743115}
confusion matrix:
       0  1
0  18141  8
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8645855, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_20.png
new oracle model saved
early stop counter: 19
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9594119787216187
after epoch: 20,now: 2024-06-16 03:29:35.911892,epoch time: 0:15:22.527794,used: 5:08:34.728446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668493, 'precision': 0.7651799, 'recall': 0.52844036, 'specificity': 0.52844036, 'f1': 0.54451144, 'auroc': 0.8897866, 'binary_precision': 0.5620915, 'binary_recall': 0.05846363, 'binary_specificity': 0.99841714, 'binary_f1_score': 0.10591133}
confusion matrix:
       0   1
0  42262  67
1   1385  86
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.6258426, 'recall': 0.5028349, 'specificity': 0.5028349, 'f1': 0.4973007, 'auroc': 0.8856571, 'binary_precision': 0.2857143, 'binary_recall': 0.00622084, 'binary_specificity': 0.999449, 'binary_f1_score': 0.01217656}
confusion matrix:
       0   1
0  18139  10
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8705758, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_21.png
new oracle model saved
early stop counter: 20
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 21,now: 2024-06-16 03:45:08.116557,epoch time: 0:15:32.204665,used: 5:24:06.933111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:24:06.933111 at 2024-06-16 03:45:08.116557
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4352585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8705758, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9364 K  |    9363 K  |
|       from large pool |      36    |      76    |    3727 K  |    3727 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5636 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9364 K  |    9363 K  |
|       from large pool |      36    |      76    |    3727 K  |    3727 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5636 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4944 K  |    4944 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287

 Experiment start at: 2024-06-16 03:51:46.578051
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.48355302, 'recall': 0.49972853, 'specificity': 0.49972853, 'f1': 0.49150774, 'auroc': 0.44779223, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99945706, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42337  23
1   1440   0
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.4820063, 'recall': 0.49892068, 'specificity': 0.49892068, 'f1': 0.49031764, 'auroc': 0.38241965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18028  39
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32150218, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 04:07:15.512969,epoch time: 0:15:28.934918,used: 0:15:28.934918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.46363753, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.39376116, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.34611243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 04:22:35.662906,epoch time: 0:15:20.149937,used: 0:30:49.084855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.48870015, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.40346774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.37995437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 04:38:04.389678,epoch time: 0:15:28.726772,used: 0:46:17.811627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.5087788, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4273976, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.40610963, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 04:53:33.419543,epoch time: 0:15:29.029865,used: 1:01:46.841492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.5472742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.47846818, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45302516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 05:09:11.481521,epoch time: 0:15:38.061978,used: 1:17:24.903470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.5778539, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.50747734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4890023, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 05:24:52.571032,epoch time: 0:15:41.089511,used: 1:33:05.992981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.6395204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.55739295, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.57212216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 05:40:25.699159,epoch time: 0:15:33.128127,used: 1:48:39.121108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.671055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6084907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6102271, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 05:55:45.418838,epoch time: 0:15:19.719679,used: 2:03:58.840787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.7147897, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6572118, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.67639875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 06:11:03.021242,epoch time: 0:15:17.602404,used: 2:19:16.443191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.4836073, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166703, 'auroc': 0.7511117, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42364  0
1   1436  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6918719, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7054969, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 06:26:39.277203,epoch time: 0:15:36.255961,used: 2:34:52.699152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.7848791, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7366108, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7489805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 06:42:22.064220,epoch time: 0:15:42.787017,used: 2:50:35.486169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.8130574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.77744055, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7889032, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 06:58:18.758230,epoch time: 0:15:56.694010,used: 3:06:32.180179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.9835727, 'recall': 0.5003472, 'specificity': 0.5003472, 'f1': 0.49234313, 'auroc': 0.83287346, 'binary_precision': 1.0, 'binary_recall': 0.00069444446, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013879251}
confusion matrix:
       0  1
0  42360  0
1   1439  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.797886, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7971521, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 07:14:04.303519,epoch time: 0:15:45.545289,used: 3:22:17.725468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.88359404, 'recall': 0.50137615, 'specificity': 0.50137615, 'f1': 0.49442074, 'auroc': 0.8346735, 'binary_precision': 0.8, 'binary_recall': 0.00277585, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.005532503}
confusion matrix:
       0  1
0  42358  1
1   1437  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.80129683, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.80631256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 07:29:42.789120,epoch time: 0:15:38.485601,used: 3:37:56.211069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.68359214, 'recall': 0.50131714, 'specificity': 0.50131714, 'f1': 0.4943817, 'auroc': 0.8442011, 'binary_precision': 0.4, 'binary_recall': 0.00277585, 'binary_specificity': 0.9998584, 'binary_f1_score': 0.005513439}
confusion matrix:
       0  1
0  42353  6
1   1437  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8295604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.81991386, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 07:45:07.245388,epoch time: 0:15:24.456268,used: 3:53:20.667337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.7337232, 'recall': 0.5043667, 'specificity': 0.5043667, 'f1': 0.50053257, 'auroc': 0.8613984, 'binary_precision': 0.5, 'binary_recall': 0.009040334, 'binary_specificity': 0.9996931, 'binary_f1_score': 0.017759563}
confusion matrix:
       0   1
0  42349  13
1   1425  13
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.84014785, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8369806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 08:00:23.546539,epoch time: 0:15:16.301151,used: 4:08:36.968488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9672603, 'precision': 0.79625523, 'recall': 0.50679314, 'specificity': 0.50679314, 'f1': 0.50524354, 'auroc': 0.86660135, 'binary_precision': 0.625, 'binary_recall': 0.0138696255, 'binary_specificity': 0.9997167, 'binary_f1_score': 0.027137041}
confusion matrix:
       0   1
0  42346  12
1   1422  20
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8464327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8349362, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_17.png
early stop counter: 15
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 08:15:38.693182,epoch time: 0:15:15.146643,used: 4:23:52.115131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7427778, 'recall': 0.5097368, 'specificity': 0.5097368, 'f1': 0.510997, 'auroc': 0.8746687, 'binary_precision': 0.51785713, 'binary_recall': 0.020110957, 'binary_specificity': 0.9993626, 'binary_f1_score': 0.038718294}
confusion matrix:
       0   1
0  42331  27
1   1413  29
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.8560762, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83962506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_18.png
early stop counter: 16
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 08:30:56.882519,epoch time: 0:15:18.189337,used: 4:39:10.304468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96730596, 'precision': 0.7603291, 'recall': 0.51418203, 'specificity': 0.51418203, 'f1': 0.519387, 'auroc': 0.8796825, 'binary_precision': 0.55263156, 'binary_recall': 0.029166667, 'binary_specificity': 0.99919736, 'binary_f1_score': 0.055408973}
confusion matrix:
       0   1
0  42326  34
1   1398  42
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7321676, 'recall': 0.50357634, 'specificity': 0.50357634, 'f1': 0.4981759, 'auroc': 0.86654633, 'binary_precision': 0.5, 'binary_recall': 0.0074294205, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.014641289}
confusion matrix:
       0  1
0  18062  5
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.84852743, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_19.png
early stop counter: 17
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-16 08:46:13.041275,epoch time: 0:15:16.158756,used: 4:54:26.463224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.72967327, 'recall': 0.51841116, 'specificity': 0.51841116, 'f1': 0.5270304, 'auroc': 0.87920713, 'binary_precision': 0.49107143, 'binary_recall': 0.03816794, 'binary_specificity': 0.99865437, 'binary_f1_score': 0.07083065}
confusion matrix:
       0   1
0  42302  57
1   1386  55
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7321924, 'recall': 0.5042916, 'specificity': 0.5042916, 'f1': 0.49961385, 'auroc': 0.86869514, 'binary_precision': 0.5, 'binary_recall': 0.008915304, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.017518247}
confusion matrix:
       0  1
0  18061  6
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.8497393, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_20.png
new oracle model saved
early stop counter: 18
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9584273099899292
after epoch: 20,now: 2024-06-16 09:01:18.474457,epoch time: 0:15:05.433182,used: 5:09:31.896406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.7377434, 'recall': 0.52518, 'specificity': 0.52518, 'f1': 0.5388699, 'auroc': 0.8899368, 'binary_precision': 0.5067568, 'binary_recall': 0.052083332, 'binary_specificity': 0.99827665, 'binary_f1_score': 0.09445844}
confusion matrix:
       0   1
0  42287  73
1   1365  75
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7708811, 'recall': 0.5108397, 'specificity': 0.5108397, 'f1': 0.51236486, 'auroc': 0.8758216, 'binary_precision': 0.5769231, 'binary_recall': 0.022288261, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.042918455}
confusion matrix:
       0   1
0  18056  11
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8537404, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-16 09:16:25.090079,epoch time: 0:15:06.615622,used: 5:24:38.512028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9674886, 'precision': 0.75887024, 'recall': 0.53237766, 'specificity': 0.53237766, 'f1': 0.55112535, 'auroc': 0.88619614, 'binary_precision': 0.5485714, 'binary_recall': 0.0666204, 'binary_specificity': 0.998135, 'binary_f1_score': 0.118811876}
confusion matrix:
       0   1
0  42280  79
1   1345  96
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7619307, 'recall': 0.5137008, 'specificity': 0.5137008, 'f1': 0.5177778, 'auroc': 0.8771267, 'binary_precision': 0.5588235, 'binary_recall': 0.028231798, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.05374823}
confusion matrix:
       0   1
0  18052  15
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8552332, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_22.png
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9595552682876587 / 0.9595552682876587
after epoch: 22,now: 2024-06-16 09:31:28.308145,epoch time: 0:15:03.218066,used: 5:39:41.730094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96696347, 'precision': 0.7261463, 'recall': 0.5290896, 'specificity': 0.5290896, 'f1': 0.5452557, 'auroc': 0.8937338, 'binary_precision': 0.48333332, 'binary_recall': 0.06037474, 'binary_specificity': 0.99780446, 'binary_f1_score': 0.10734115}
confusion matrix:
       0   1
0  42266  93
1   1354  87
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.76825905, 'recall': 0.5144437, 'specificity': 0.5144437, 'f1': 0.5191656, 'auroc': 0.8786943, 'binary_precision': 0.5714286, 'binary_recall': 0.029717682, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.05649717}
confusion matrix:
       0   1
0  18052  15
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.85381347, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-16 09:46:44.743528,epoch time: 0:15:16.435383,used: 5:54:58.165477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9673288, 'precision': 0.74616766, 'recall': 0.53030384, 'specificity': 0.53030384, 'f1': 0.5475451, 'auroc': 0.89723957, 'binary_precision': 0.5232558, 'binary_recall': 0.06254343, 'binary_specificity': 0.9980643, 'binary_f1_score': 0.111731835}
confusion matrix:
       0   1
0  42279  82
1   1349  90
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7781514, 'recall': 0.5188183, 'specificity': 0.5188183, 'f1': 0.52721775, 'auroc': 0.8875218, 'binary_precision': 0.59090906, 'binary_recall': 0.038632985, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.072524406}
confusion matrix:
       0   1
0  18049  18
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8610766, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 10:03:16.430961,epoch time: 0:16:31.687433,used: 6:11:29.852910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9677169, 'precision': 0.76010567, 'recall': 0.5482718, 'specificity': 0.5482718, 'f1': 0.57588714, 'auroc': 0.89534116, 'binary_precision': 0.55, 'binary_recall': 0.099305555, 'binary_specificity': 0.997238, 'binary_f1_score': 0.16823529}
confusion matrix:
       0    1
0  42243  117
1   1297  143
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.771258, 'recall': 0.5216794, 'specificity': 0.5216794, 'f1': 0.53233296, 'auroc': 0.88678557, 'binary_precision': 0.5769231, 'binary_recall': 0.044576522, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.08275862}
confusion matrix:
       0   1
0  18045  22
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8612026, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_25.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9601998329162598
after epoch: 25,now: 2024-06-16 10:19:24.687855,epoch time: 0:16:08.256894,used: 6:27:38.109804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9675114, 'precision': 0.7501013, 'recall': 0.5508489, 'specificity': 0.5508489, 'f1': 0.57925093, 'auroc': 0.89805096, 'binary_precision': 0.52982455, 'binary_recall': 0.10486111, 'binary_specificity': 0.99683666, 'binary_f1_score': 0.17507248}
confusion matrix:
       0    1
0  42226  134
1   1289  151
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.75908947, 'recall': 0.5266586, 'specificity': 0.5266586, 'f1': 0.5409363, 'auroc': 0.889308, 'binary_precision': 0.5522388, 'binary_recall': 0.05497771, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.1}
confusion matrix:
       0   1
0  18037  30
1    636  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8617041, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_26.png
new oracle model saved
early stop counter: 2
val acc:0.9644610285758972, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9605220556259155
after epoch: 26,now: 2024-06-16 10:35:50.734892,epoch time: 0:16:26.047037,used: 6:44:04.156841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96680367, 'precision': 0.72306246, 'recall': 0.54645795, 'specificity': 0.54645795, 'f1': 0.57178754, 'auroc': 0.90244246, 'binary_precision': 0.4760274, 'binary_recall': 0.09652778, 'binary_specificity': 0.9963881, 'binary_f1_score': 0.16050808}
confusion matrix:
       0    1
0  42207  153
1   1301  139
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7587065, 'recall': 0.5230546, 'specificity': 0.5230546, 'f1': 0.5347005, 'auroc': 0.8906949, 'binary_precision': 0.55172414, 'binary_recall': 0.04754829, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.087551296}
confusion matrix:
       0   1
0  18041  26
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.86139905, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_27.png
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9601998329162598 / 0.9605220556259155
after epoch: 27,now: 2024-06-16 10:52:32.093252,epoch time: 0:16:41.358360,used: 7:00:45.515201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.73688006, 'recall': 0.5600203, 'specificity': 0.5600203, 'f1': 0.5912249, 'auroc': 0.9013625, 'binary_precision': 0.502809, 'binary_recall': 0.12421929, 'binary_specificity': 0.9958214, 'binary_f1_score': 0.19922091}
confusion matrix:
       0    1
0  42182  177
1   1262  179
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7635433, 'recall': 0.53678304, 'specificity': 0.53678304, 'f1': 0.5577388, 'auroc': 0.89729214, 'binary_precision': 0.5604396, 'binary_recall': 0.075780086, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.13350785}
confusion matrix:
       0   1
0  18027  40
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86866605, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_28.png
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-06-16 11:08:18.511394,epoch time: 0:15:46.418142,used: 7:16:31.933343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9683333, 'precision': 0.7702973, 'recall': 0.5727807, 'specificity': 0.5727807, 'f1': 0.61024255, 'auroc': 0.9038409, 'binary_precision': 0.56878304, 'binary_recall': 0.14940931, 'binary_specificity': 0.9961521, 'binary_f1_score': 0.23665382}
confusion matrix:
       0    1
0  42198  163
1   1224  215
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7482033, 'recall': 0.53161013, 'specificity': 0.53161013, 'f1': 0.5491062, 'auroc': 0.89456606, 'binary_precision': 0.5301205, 'binary_recall': 0.0653789, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.11640211}
confusion matrix:
       0   1
0  18028  39
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8653718, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_29.png
new oracle model saved
early stop counter: 1
val acc:0.9643543362617493, best validation acc: 0.9646744728088379, corresponding to test acc:                         0.961005449295044 / 0.9611666202545166
after epoch: 29,now: 2024-06-16 11:24:11.732755,epoch time: 0:15:53.221361,used: 7:32:25.154704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7194177, 'recall': 0.56279725, 'specificity': 0.56279725, 'f1': 0.593577, 'auroc': 0.9060775, 'binary_precision': 0.46766168, 'binary_recall': 0.13064629, 'binary_specificity': 0.9949482, 'binary_f1_score': 0.20423684}
confusion matrix:
       0    1
0  42147  214
1   1251  188
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7706353, 'recall': 0.5390119, 'specificity': 0.5390119, 'f1': 0.56142914, 'auroc': 0.8980962, 'binary_precision': 0.5744681, 'binary_recall': 0.08023774, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.14080834}
confusion matrix:
       0   1
0  18027  40
1    619  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8683417, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_30.png
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-06-16 11:39:50.616543,epoch time: 0:15:38.883788,used: 7:48:04.038492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_51_46_seed_1_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:48:04.038492 at 2024-06-16 11:39:50.616543
persisted model performance metric: 

scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8683417, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
oracle model performance metric: 

scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8683417, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688376 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22716 K  |   22715 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13678 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22716 K  |   22715 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13678 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22716 K  |   22716 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13678 K  |   13678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287

 Experiment start at: 2024-06-16 11:47:35.431300
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.4303547, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3638956, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.33998471, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 12:04:21.915440,epoch time: 0:16:46.484140,used: 0:16:46.484140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.45208892, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3812814, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3349526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 12:19:53.606727,epoch time: 0:15:31.691287,used: 0:32:18.175427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.49686974, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.43450063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4192902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 12:35:41.811922,epoch time: 0:15:48.205195,used: 0:48:06.380622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5142424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.43245703, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.43066043, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 12:51:07.693846,epoch time: 0:15:25.881924,used: 1:03:32.262546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.5597597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4958923, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.48468035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 13:06:22.309438,epoch time: 0:15:14.615592,used: 1:18:46.878138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.6208881, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.5508871, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.52016586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 13:21:43.983716,epoch time: 0:15:21.674278,used: 1:34:08.552416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.67364335, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.63198626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.60330164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 13:37:08.125617,epoch time: 0:15:24.141901,used: 1:49:32.694317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.68862563, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.63690424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.63529545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 13:52:27.508324,epoch time: 0:15:19.382707,used: 2:04:52.077024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.74437606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.71173894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7034708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 14:07:45.768745,epoch time: 0:15:18.260421,used: 2:20:10.337445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.76670766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7437946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.73411345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 14:23:11.178447,epoch time: 0:15:25.409702,used: 2:35:35.747147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.7892028, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7625968, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.75489074, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 14:38:35.825405,epoch time: 0:15:24.646958,used: 2:51:00.394105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.8158392, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.79614925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.77852887, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 14:53:59.300038,epoch time: 0:15:23.474633,used: 3:06:23.868738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.9827508, 'recall': 0.5003307, 'specificity': 0.5003307, 'f1': 0.49188492, 'auroc': 0.83480686, 'binary_precision': 1.0, 'binary_recall': 0.00066137564, 'binary_specificity': 1.0, 'binary_f1_score': 0.001321877}
confusion matrix:
       0  1
0  42288  0
1   1511  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.81954086, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8003416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 15:09:40.388805,epoch time: 0:15:41.088767,used: 3:22:04.957505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.682772, 'recall': 0.5006263, 'specificity': 0.5006263, 'f1': 0.49253714, 'auroc': 0.84220207, 'binary_precision': 0.4, 'binary_recall': 0.0013236267, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.0026385223}
confusion matrix:
       0  1
0  42286  3
1   1509  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8323852, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80557775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 15:28:40.846994,epoch time: 0:19:00.458189,used: 3:41:05.415694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.7827929, 'recall': 0.50193554, 'specificity': 0.50193554, 'f1': 0.49516258, 'auroc': 0.85633206, 'binary_precision': 0.6, 'binary_recall': 0.003965631, 'binary_specificity': 0.9999054, 'binary_f1_score': 0.0078791855}
confusion matrix:
       0  1
0  42283  4
1   1507  6
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.84303415, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8226215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 15:44:03.849907,epoch time: 0:15:23.002913,used: 3:56:28.418607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.7248343, 'recall': 0.5047711, 'specificity': 0.5047711, 'f1': 0.50093067, 'auroc': 0.87321556, 'binary_precision': 0.48387095, 'binary_recall': 0.009920635, 'binary_specificity': 0.9996216, 'binary_f1_score': 0.019442644}
confusion matrix:
       0   1
0  42272  16
1   1497  15
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.86039466, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83524734, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 15:59:26.050855,epoch time: 0:15:22.200948,used: 4:11:50.619555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.74895287, 'recall': 0.5080016, 'specificity': 0.5080016, 'f1': 0.50725067, 'auroc': 0.8704746, 'binary_precision': 0.5319149, 'binary_recall': 0.016523464, 'binary_specificity': 0.9994798, 'binary_f1_score': 0.032051284}
confusion matrix:
       0   1
0  42265  22
1   1488  25
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.9839921, 'recall': 0.5008306, 'specificity': 0.5008306, 'f1': 0.49352425, 'auroc': 0.8621634, 'binary_precision': 1.0, 'binary_recall': 0.0016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.0033167494}
confusion matrix:
       0  1
0  18171  0
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83523643, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_17.png
better model found
persisted
after epoch: 17,now: 2024-06-16 16:14:35.381034,epoch time: 0:15:09.330179,used: 4:26:59.949734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96534246, 'precision': 0.71495104, 'recall': 0.5101375, 'specificity': 0.5101375, 'f1': 0.51140386, 'auroc': 0.8779797, 'binary_precision': 0.46376812, 'binary_recall': 0.021150034, 'binary_specificity': 0.999125, 'binary_f1_score': 0.04045512}
confusion matrix:
       0   1
0  42250  37
1   1481  32
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.65065706, 'recall': 0.5007755, 'specificity': 0.5007755, 'f1': 0.49349123, 'auroc': 0.87263554, 'binary_precision': 0.33333334, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0033057851}
confusion matrix:
       0  1
0  18169  2
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.84357417, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_18.png
new oracle model saved
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 18,now: 2024-06-16 16:29:44.396082,epoch time: 0:15:09.015048,used: 4:42:08.964782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9658219, 'precision': 0.7617459, 'recall': 0.52536213, 'specificity': 0.52536213, 'f1': 0.53902507, 'auroc': 0.8790785, 'binary_precision': 0.556338, 'binary_recall': 0.052214146, 'binary_specificity': 0.9985102, 'binary_f1_score': 0.09546828}
confusion matrix:
       0   1
0  42224  63
1   1434  79
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6715394, 'recall': 0.50235415, 'specificity': 0.50235415, 'f1': 0.4967417, 'auroc': 0.87424266, 'binary_precision': 0.375, 'binary_recall': 0.004983389, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.009836066}
confusion matrix:
       0  1
0  18166  5
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84796596, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_19.png
new oracle model saved
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 19,now: 2024-06-16 16:44:47.752464,epoch time: 0:15:03.356382,used: 4:57:12.321164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9657306, 'precision': 0.75816876, 'recall': 0.5195808, 'specificity': 0.5195808, 'f1': 0.5288556, 'auroc': 0.8830291, 'binary_precision': 0.5495495, 'binary_recall': 0.040343914, 'binary_specificity': 0.9988176, 'binary_f1_score': 0.07516944}
confusion matrix:
       0   1
0  42238  50
1   1451  61
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7568441, 'recall': 0.5048458, 'specificity': 0.5048458, 'f1': 0.5016516, 'auroc': 0.8737997, 'binary_precision': 0.54545456, 'binary_recall': 0.009966778, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.019575857}
confusion matrix:
       0  1
0  18166  5
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.8458189, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_20.png
new oracle model saved
early stop counter: 3
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9620131254196167
after epoch: 20,now: 2024-06-16 16:59:43.641623,epoch time: 0:14:55.889159,used: 5:12:08.210323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9650457, 'precision': 0.7054964, 'recall': 0.5249711, 'specificity': 0.5249711, 'f1': 0.53786284, 'auroc': 0.88850546, 'binary_precision': 0.44382024, 'binary_recall': 0.052283257, 'binary_specificity': 0.99765897, 'binary_f1_score': 0.09354648}
confusion matrix:
       0   1
0  42190  99
1   1432  79
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74513626, 'recall': 0.5096641, 'specificity': 0.5096641, 'f1': 0.5110611, 'auroc': 0.8829505, 'binary_precision': 0.5217391, 'binary_recall': 0.019933555, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.038399998}
confusion matrix:
       0   1
0  18160  11
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.85449123, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_21.png
new oracle model saved
early stop counter: 4
val acc:0.9679859280586243, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9612117409706116 / 0.9623336791992188
after epoch: 21,now: 2024-06-16 17:14:40.047132,epoch time: 0:14:56.405509,used: 5:27:04.615832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9656393, 'precision': 0.74431443, 'recall': 0.53164047, 'specificity': 0.53164047, 'f1': 0.5493722, 'auroc': 0.8958218, 'binary_precision': 0.52105266, 'binary_recall': 0.06543291, 'binary_specificity': 0.99784803, 'binary_f1_score': 0.116265416}
confusion matrix:
       0   1
0  42196  91
1   1414  99
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7747426, 'recall': 0.51459247, 'specificity': 0.51459247, 'f1': 0.52034944, 'auroc': 0.88364637, 'binary_precision': 0.58064514, 'binary_recall': 0.029900333, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.05687204}
confusion matrix:
       0   1
0  18158  13
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.8586144, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-16 17:29:48.249442,epoch time: 0:15:08.202310,used: 5:42:12.818142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9662329, 'precision': 0.76578856, 'recall': 0.5460073, 'specificity': 0.5460073, 'f1': 0.57240444, 'auroc': 0.8935156, 'binary_precision': 0.56299216, 'binary_recall': 0.09463931, 'binary_specificity': 0.9973752, 'binary_f1_score': 0.16203965}
confusion matrix:
       0    1
0  42178  111
1   1368  143
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7280298, 'recall': 0.5152304, 'specificity': 0.5152304, 'f1': 0.5214716, 'auroc': 0.8853862, 'binary_precision': 0.4871795, 'binary_recall': 0.03156146, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.059282366}
confusion matrix:
       0   1
0  18151  20
1    583  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.981919, 'recall': 0.53512394, 'specificity': 0.53512394, 'f1': 0.5564301, 'auroc': 0.85946965, 'binary_precision': 1.0, 'binary_recall': 0.07024793, 'binary_specificity': 1.0, 'binary_f1_score': 0.13127413}
confusion matrix:
      0   1
0  5997   0
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_23.png
new oracle model saved
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9629748463630676 / 0.9639365077018738
after epoch: 23,now: 2024-06-16 17:45:03.199161,epoch time: 0:15:14.949719,used: 5:57:27.767861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9660502, 'precision': 0.75384414, 'recall': 0.55136037, 'specificity': 0.55136037, 'f1': 0.5798784, 'auroc': 0.89693975, 'binary_precision': 0.53872055, 'binary_recall': 0.105960265, 'binary_specificity': 0.9967605, 'binary_f1_score': 0.17708911}
confusion matrix:
       0    1
0  42153  137
1   1350  160
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74543726, 'recall': 0.5193282, 'specificity': 0.5193282, 'f1': 0.5289065, 'auroc': 0.8896122, 'binary_precision': 0.5217391, 'binary_recall': 0.03986711, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.074074075}
confusion matrix:
       0   1
0  18149  22
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.98176414, 'recall': 0.53099173, 'specificity': 0.53099173, 'f1': 0.54907846, 'auroc': 0.86105055, 'binary_precision': 1.0, 'binary_recall': 0.06198347, 'binary_specificity': 1.0, 'binary_f1_score': 0.11673152}
confusion matrix:
      0   1
0  5997   0
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_24.png
early stop counter: 2
val acc:0.9680392146110535, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9629748463630676 / 0.9639365077018738
after epoch: 24,now: 2024-06-16 18:00:16.555914,epoch time: 0:15:13.356753,used: 6:12:41.124614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.7691526, 'recall': 0.5514444, 'specificity': 0.5514444, 'f1': 0.58059704, 'auroc': 0.8975886, 'binary_precision': 0.569395, 'binary_recall': 0.105750166, 'binary_specificity': 0.9971386, 'binary_f1_score': 0.17837237}
confusion matrix:
       0    1
0  42166  121
1   1353  160
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74590635, 'recall': 0.5185251, 'specificity': 0.5185251, 'f1': 0.5274736, 'auroc': 0.88987005, 'binary_precision': 0.52272725, 'binary_recall': 0.03820598, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.071207434}
confusion matrix:
       0   1
0  18150  21
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.86049485, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_25.png
new oracle model saved
early stop counter: 3
val acc:0.9680392146110535, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9629748463630676 / 0.9642571210861206
after epoch: 25,now: 2024-06-16 18:15:42.627069,epoch time: 0:15:26.071155,used: 6:28:07.195769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7691176, 'recall': 0.5502605, 'specificity': 0.5502605, 'f1': 0.57886744, 'auroc': 0.9007927, 'binary_precision': 0.5693431, 'binary_recall': 0.103311256, 'binary_specificity': 0.9972097, 'binary_f1_score': 0.1748879}
confusion matrix:
       0    1
0  42172  118
1   1354  156
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.77038634, 'recall': 0.52267796, 'specificity': 0.52267796, 'f1': 0.5349473, 'auroc': 0.89088327, 'binary_precision': 0.5714286, 'binary_recall': 0.046511628, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.086021505}
confusion matrix:
       0   1
0  18150  21
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.8595863, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_26.png
better model found
persisted
after epoch: 26,now: 2024-06-16 18:31:06.262926,epoch time: 0:15:23.635857,used: 6:43:30.831626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96636987, 'precision': 0.7617024, 'recall': 0.5629896, 'specificity': 0.5629896, 'f1': 0.5965034, 'auroc': 0.903341, 'binary_precision': 0.5536723, 'binary_recall': 0.12971541, 'binary_specificity': 0.9962638, 'binary_f1_score': 0.21018766}
confusion matrix:
       0    1
0  42131  158
1   1315  196
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7309197, 'recall': 0.52567005, 'specificity': 0.52567005, 'f1': 0.5398006, 'auroc': 0.8938546, 'binary_precision': 0.4923077, 'binary_recall': 0.053156145, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.09595202}
confusion matrix:
       0   1
0  18138  33
1    570  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.98269475, 'recall': 0.5557851, 'specificity': 0.5557851, 'f1': 0.5915668, 'auroc': 0.865607, 'binary_precision': 1.0, 'binary_recall': 0.11157025, 'binary_specificity': 1.0, 'binary_f1_score': 0.2007435}
confusion matrix:
      0   1
0  5997   0
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_27.png
new oracle model saved
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9642571210861206 / 0.9655393362045288
after epoch: 27,now: 2024-06-16 18:46:27.884011,epoch time: 0:15:21.621085,used: 6:58:52.452711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96600455, 'precision': 0.74965644, 'recall': 0.56311953, 'specificity': 0.56311953, 'f1': 0.59593475, 'auroc': 0.90510106, 'binary_precision': 0.52956986, 'binary_recall': 0.13037723, 'binary_specificity': 0.9958618, 'binary_f1_score': 0.20924057}
confusion matrix:
       0    1
0  42114  175
1   1314  197
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7535279, 'recall': 0.5290473, 'specificity': 0.5290473, 'f1': 0.5457172, 'auroc': 0.8960726, 'binary_precision': 0.53731346, 'binary_recall': 0.059800666, 'binary_specificity': 0.998294, 'binary_f1_score': 0.10762332}
confusion matrix:
       0   1
0  18140  31
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.9826171, 'recall': 0.553719, 'specificity': 0.553719, 'f1': 0.5881697, 'auroc': 0.8671216, 'binary_precision': 1.0, 'binary_recall': 0.10743801, 'binary_specificity': 1.0, 'binary_f1_score': 0.19402985}
confusion matrix:
      0   1
0  5997   0
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_28.png
early stop counter: 2
val acc:0.9681990146636963, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9642571210861206 / 0.9655393362045288
after epoch: 28,now: 2024-06-16 19:02:54.300579,epoch time: 0:16:26.416568,used: 7:15:18.869279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7468224, 'recall': 0.571613, 'specificity': 0.571613, 'f1': 0.60668963, 'auroc': 0.90459067, 'binary_precision': 0.5233645, 'binary_recall': 0.14805023, 'binary_specificity': 0.99517584, 'binary_f1_score': 0.23080887}
confusion matrix:
       0    1
0  42083  204
1   1289  224
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74183834, 'recall': 0.5297678, 'specificity': 0.5297678, 'f1': 0.54675984, 'auroc': 0.8980767, 'binary_precision': 0.5138889, 'binary_recall': 0.061461795, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.109792285}
confusion matrix:
       0   1
0  18136  35
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8670224, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_29.png
new oracle model saved
early stop counter: 3
val acc:0.9680392146110535, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9642571210861206 / 0.9661805033683777
after epoch: 29,now: 2024-06-16 19:18:12.053489,epoch time: 0:15:17.752910,used: 7:30:36.622189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96627855, 'precision': 0.75758064, 'recall': 0.5698903, 'specificity': 0.5698903, 'f1': 0.6053386, 'auroc': 0.90573514, 'binary_precision': 0.545, 'binary_recall': 0.1440846, 'binary_specificity': 0.99569607, 'binary_f1_score': 0.22791426}
confusion matrix:
       0    1
0  42105  182
1   1295  218
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.75047916, 'recall': 0.5346687, 'specificity': 0.5346687, 'f1': 0.55486, 'auroc': 0.8976371, 'binary_precision': 0.5308642, 'binary_recall': 0.071428575, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.12591508}
confusion matrix:
       0   1
0  18133  38
1    559  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86948895, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327287_30.png
early stop counter: 4
val acc:0.9681990146636963, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9642571210861206 / 0.9661805033683777
after epoch: 30,now: 2024-06-16 19:33:34.458207,epoch time: 0:15:22.404718,used: 7:45:59.026907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_47_35_seed_2_21327287
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:45:59.026907 at 2024-06-16 19:33:34.458207
persisted model performance metric: 

scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.8595863, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
oracle model performance metric: 

scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8670224, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36067 K  |   36066 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36067 K  |   36066 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36067 K  |   36067 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36067 K  |   36067 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun 16 19:34:20 2024]
Finished job 0.
1 of 1 steps (100%) done
