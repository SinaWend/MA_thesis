Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 02:30:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943

 Experiment start at: 2024-06-19 02:48:01.953497
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.5386181, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.32290208, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.28504544, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 03:25:34.274304,epoch time: 0:37:32.320807,used: 0:37:32.320807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.77409244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.373672, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.417295, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 2,now: 2024-06-19 03:54:18.594053,epoch time: 0:28:44.319749,used: 1:06:16.640556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9088827, 'precision': 0.9283571, 'recall': 0.5184793, 'specificity': 0.5184793, 'f1': 0.51181406, 'auroc': 0.8675754, 'binary_precision': 0.9479769, 'binary_recall': 0.037171353, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.07153763}
confusion matrix:
       0    1
0  42299    9
1   4248  164
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.42362475, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.5935506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 3,now: 2024-06-19 04:22:53.026811,epoch time: 0:28:34.432758,used: 1:34:51.073314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92410105, 'precision': 0.9415148, 'recall': 0.6019988, 'specificity': 0.6019988, 'f1': 0.64871764, 'auroc': 0.9118959, 'binary_precision': 0.9596603, 'binary_recall': 0.20489573, 'binary_specificity': 0.9991018, 'binary_f1_score': 0.33769143}
confusion matrix:
       0    1
0  42270   38
1   3508  904
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.4828862, 'recall': 0.49983472, 'specificity': 0.49983472, 'f1': 0.4912143, 'auroc': 0.4844646, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18143  6
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8853982, 'precision': 0.94264835, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4771841, 'auroc': 0.6585245, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   777  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_4.png
new oracle model saved
early stop counter: 3
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8853982090950012
after epoch: 4,now: 2024-06-19 04:51:44.713890,epoch time: 0:28:51.687079,used: 2:03:42.760393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.941417, 'precision': 0.94434977, 'recall': 0.6995677, 'specificity': 0.6995677, 'f1': 0.76628137, 'auroc': 0.92114866, 'binary_precision': 0.9475375, 'binary_recall': 0.4014516, 'binary_specificity': 0.9976838, 'binary_f1_score': 0.5639637}
confusion matrix:
       0     1
0  42213    98
1   2639  1770
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.49955764, 'recall': 0.49997866, 'specificity': 0.49997866, 'f1': 0.49239644, 'auroc': 0.5194216, 'binary_precision': 0.033333335, 'binary_recall': 0.00155521, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.0029717684}
confusion matrix:
       0   1
0  18120  29
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89174044, 'precision': 0.85538363, 'recall': 0.5390626, 'specificity': 0.5390626, 'f1': 0.5443582, 'auroc': 0.710842, 'binary_precision': 0.8181818, 'binary_recall': 0.08045977, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14651163}
confusion matrix:
      0   1
0  5983  14
1   720  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_5.png
new oracle model saved
early stop counter: 4
val acc:0.9642933011054993, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8917404413223267
after epoch: 5,now: 2024-06-19 05:20:17.880294,epoch time: 0:28:33.166404,used: 2:32:15.926797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9467038, 'precision': 0.9410813, 'recall': 0.73249257, 'specificity': 0.73249257, 'f1': 0.7977064, 'auroc': 0.9240256, 'binary_precision': 0.9348711, 'binary_recall': 0.46838886, 'binary_specificity': 0.99659634, 'binary_f1_score': 0.6240942}
confusion matrix:
       0     1
0  42163   144
1   2346  2067
---- Validation: 
scalar performance:
{'acc': 0.9636015, 'precision': 0.5148437, 'recall': 0.5011206, 'specificity': 0.5011206, 'f1': 0.49507803, 'auroc': 0.5215849, 'binary_precision': 0.06382979, 'binary_recall': 0.00466563, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.008695653}
confusion matrix:
       0   1
0  18105  44
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8936578, 'precision': 0.83620334, 'recall': 0.5534712, 'specificity': 0.5534712, 'f1': 0.56874245, 'auroc': 0.713305, 'binary_precision': 0.77678573, 'binary_recall': 0.11111111, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.19441342}
confusion matrix:
      0   1
0  5972  25
1   696  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_6.png
new oracle model saved
early stop counter: 5
val acc:0.9636015295982361, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8936578035354614
after epoch: 6,now: 2024-06-19 05:48:55.671460,epoch time: 0:28:37.791166,used: 3:00:53.717963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95181936, 'precision': 0.94716674, 'recall': 0.7594228, 'specificity': 0.7594228, 'f1': 0.82295716, 'auroc': 0.93445754, 'binary_precision': 0.94196975, 'binary_recall': 0.5222021, 'binary_specificity': 0.9966435, 'binary_f1_score': 0.6719137}
confusion matrix:
       0     1
0  42164   142
1   2109  2305
---- Validation: 
scalar performance:
{'acc': 0.9630694, 'precision': 0.53686535, 'recall': 0.50384533, 'specificity': 0.50384533, 'f1': 0.5004771, 'auroc': 0.569228, 'binary_precision': 0.10769231, 'binary_recall': 0.01088647, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.01977401}
confusion matrix:
       0   1
0  18091  58
1    636   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90250736, 'precision': 0.8537873, 'recall': 0.6001133, 'specificity': 0.6001133, 'f1': 0.63818467, 'auroc': 0.761534, 'binary_precision': 0.8019802, 'binary_recall': 0.20689656, 'binary_specificity': 0.99333, 'binary_f1_score': 0.328934}
confusion matrix:
      0    1
0  5957   40
1   621  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_7.png
new oracle model saved
early stop counter: 6
val acc:0.9630693793296814, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9025073647499084
after epoch: 7,now: 2024-06-19 06:18:57.726340,epoch time: 0:30:02.054880,used: 3:30:55.772843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95684934, 'precision': 0.9497707, 'recall': 0.7876183, 'specificity': 0.7876183, 'f1': 0.8468679, 'auroc': 0.94605684, 'binary_precision': 0.9417619, 'binary_recall': 0.5789712, 'binary_specificity': 0.9962654, 'binary_f1_score': 0.71709234}
confusion matrix:
       0     1
0  42149   158
1   1858  2555
---- Validation: 
scalar performance:
{'acc': 0.96179223, 'precision': 0.5511331, 'recall': 0.50843453, 'specificity': 0.50843453, 'f1': 0.50902134, 'auroc': 0.5996195, 'binary_precision': 0.13592233, 'binary_recall': 0.02177294, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.037533514}
confusion matrix:
       0   1
0  18060  89
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123894, 'precision': 0.8737571, 'recall': 0.647339, 'specificity': 0.647339, 'f1': 0.6981349, 'auroc': 0.77735484, 'binary_precision': 0.83157897, 'binary_recall': 0.30268198, 'binary_specificity': 0.991996, 'binary_f1_score': 0.44382024}
confusion matrix:
      0    1
0  5949   48
1   546  237
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_8.png
new oracle model saved
early stop counter: 7
val acc:0.9617922306060791, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9123893976211548
after epoch: 8,now: 2024-06-19 06:48:38.671212,epoch time: 0:29:40.944872,used: 4:00:36.717715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9595462, 'precision': 0.94089735, 'recall': 0.81037664, 'specificity': 0.81037664, 'f1': 0.8616216, 'auroc': 0.9513019, 'binary_precision': 0.91949433, 'binary_recall': 0.62647325, 'binary_specificity': 0.99428004, 'binary_f1_score': 0.74521434}
confusion matrix:
       0     1
0  42066   242
1   1648  2764
---- Validation: 
scalar performance:
{'acc': 0.9604087, 'precision': 0.56160486, 'recall': 0.5144687, 'specificity': 0.5144687, 'f1': 0.5190036, 'auroc': 0.6248061, 'binary_precision': 0.15646258, 'binary_recall': 0.035769828, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.05822785}
confusion matrix:
       0    1
0  18025  124
1    620   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91474926, 'precision': 0.85828835, 'recall': 0.6703256, 'specificity': 0.6703256, 'f1': 0.7209976, 'auroc': 0.7991839, 'binary_precision': 0.79538906, 'binary_recall': 0.35249043, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.48849556}
confusion matrix:
      0    1
0  5926   71
1   507  276
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_9.png
new oracle model saved
early stop counter: 8
val acc:0.9604086875915527, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.914749264717102
after epoch: 9,now: 2024-06-19 07:17:31.357888,epoch time: 0:28:52.686676,used: 4:29:29.404391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9606164, 'precision': 0.9341418, 'recall': 0.82286036, 'specificity': 0.82286036, 'f1': 0.8683245, 'auroc': 0.9553491, 'binary_precision': 0.90347856, 'binary_recall': 0.6530011, 'binary_specificity': 0.99271953, 'binary_f1_score': 0.75808567}
confusion matrix:
       0     1
0  41997   308
1   1532  2883
---- Validation: 
scalar performance:
{'acc': 0.96024907, 'precision': 0.590915, 'recall': 0.526387, 'specificity': 0.526387, 'f1': 0.53711194, 'auroc': 0.64624816, 'binary_precision': 0.21428572, 'binary_recall': 0.060653187, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.09454545}
confusion matrix:
       0    1
0  18006  143
1    604   39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919469, 'precision': 0.8684747, 'recall': 0.691315, 'specificity': 0.691315, 'f1': 0.7434407, 'auroc': 0.81276083, 'binary_precision': 0.8110236, 'binary_recall': 0.394636, 'binary_specificity': 0.987994, 'binary_f1_score': 0.53092784}
confusion matrix:
      0    1
0  5925   72
1   474  309
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_10.png
new oracle model saved
early stop counter: 9
val acc:0.9602490663528442, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9194689989089966
after epoch: 10,now: 2024-06-19 07:46:35.387286,epoch time: 0:29:04.029398,used: 4:58:33.433789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9631207, 'precision': 0.9349052, 'recall': 0.8380678, 'specificity': 0.8380678, 'f1': 0.8789129, 'auroc': 0.9599706, 'binary_precision': 0.90197253, 'binary_recall': 0.6838885, 'binary_specificity': 0.99224716, 'binary_f1_score': 0.7779353}
confusion matrix:
       0     1
0  41979   328
1   1395  3018
---- Validation: 
scalar performance:
{'acc': 0.9593444, 'precision': 0.60203904, 'recall': 0.53716946, 'specificity': 0.53716946, 'f1': 0.5515213, 'auroc': 0.66219133, 'binary_precision': 0.23580787, 'binary_recall': 0.083981335, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.12385321}
confusion matrix:
       0    1
0  17974  175
1    589   54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9202065, 'precision': 0.8572891, 'recall': 0.70505655, 'specificity': 0.70505655, 'f1': 0.75399315, 'auroc': 0.81615776, 'binary_precision': 0.7853774, 'binary_recall': 0.42528737, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.5517813}
confusion matrix:
      0    1
0  5906   91
1   450  333
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_11.png
new oracle model saved
early stop counter: 10
val acc:0.9593443870544434, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9202064871788025
after epoch: 11,now: 2024-06-19 08:17:04.196834,epoch time: 0:30:28.809548,used: 5:29:02.243337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96421236, 'precision': 0.94319594, 'recall': 0.8375903, 'specificity': 0.8375903, 'f1': 0.8815101, 'auroc': 0.9588767, 'binary_precision': 0.9187538, 'binary_recall': 0.68146807, 'binary_specificity': 0.9937125, 'binary_f1_score': 0.7825182}
confusion matrix:
       0     1
0  42040   266
1   1406  3008
---- Validation: 
scalar performance:
{'acc': 0.9604087, 'precision': 0.615658, 'recall': 0.5392206, 'specificity': 0.5392206, 'f1': 0.555292, 'auroc': 0.65169275, 'binary_precision': 0.26291078, 'binary_recall': 0.08709176, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.13084112}
confusion matrix:
       0    1
0  17992  157
1    587   56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91932154, 'precision': 0.8652189, 'recall': 0.6928972, 'specificity': 0.6928972, 'f1': 0.7443629, 'auroc': 0.8018607, 'binary_precision': 0.8041237, 'binary_recall': 0.39846742, 'binary_specificity': 0.987327, 'binary_f1_score': 0.53287786}
confusion matrix:
      0    1
0  5921   76
1   471  312
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_12.png
early stop counter: 11
val acc:0.9604086875915527, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9202064871788025
after epoch: 12,now: 2024-06-19 08:46:21.861531,epoch time: 0:29:17.664697,used: 5:58:19.908034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96468323, 'precision': 0.93086815, 'recall': 0.8521234, 'specificity': 0.8521234, 'f1': 0.88652444, 'auroc': 0.96125484, 'binary_precision': 0.89102745, 'binary_recall': 0.71334696, 'binary_specificity': 0.99089986, 'binary_f1_score': 0.7923484}
confusion matrix:
       0     1
0  41922   385
1   1265  3148
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.6173811, 'recall': 0.55470246, 'specificity': 0.55470246, 'f1': 0.5725887, 'auroc': 0.68201554, 'binary_precision': 0.26530612, 'binary_recall': 0.121306375, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.1664888}
confusion matrix:
       0    1
0  17933  216
1    565   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9261062, 'precision': 0.8588102, 'recall': 0.7417032, 'specificity': 0.7417032, 'f1': 0.7849506, 'auroc': 0.8287209, 'binary_precision': 0.7797619, 'binary_recall': 0.5019157, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.6107226}
confusion matrix:
      0    1
0  5886  111
1   390  393
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_13.png
new oracle model saved
early stop counter: 12
val acc:0.9584397673606873, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9261062145233154
after epoch: 13,now: 2024-06-19 09:18:56.065111,epoch time: 0:32:34.203580,used: 6:30:54.111614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9666952, 'precision': 0.9321762, 'recall': 0.8639915, 'specificity': 0.8639915, 'f1': 0.8944092, 'auroc': 0.9641412, 'binary_precision': 0.89126265, 'binary_recall': 0.73736686, 'binary_specificity': 0.9906162, 'binary_f1_score': 0.8070437}
confusion matrix:
       0     1
0  41910   397
1   1159  3254
---- Validation: 
scalar performance:
{'acc': 0.95870584, 'precision': 0.6196803, 'recall': 0.5548402, 'specificity': 0.5548402, 'f1': 0.5731049, 'auroc': 0.6805847, 'binary_precision': 0.26989618, 'binary_recall': 0.121306375, 'binary_specificity': 0.988374, 'binary_f1_score': 0.16738197}
confusion matrix:
       0    1
0  17938  211
1    565   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92684364, 'precision': 0.86124253, 'recall': 0.7437857, 'specificity': 0.7437857, 'f1': 0.7872448, 'auroc': 0.82515526, 'binary_precision': 0.7841584, 'binary_recall': 0.50574714, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.61490685}
confusion matrix:
      0    1
0  5888  109
1   387  396
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_14.png
new oracle model saved
early stop counter: 13
val acc:0.9587058424949646, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9268436431884766
after epoch: 14,now: 2024-06-19 09:50:31.949375,epoch time: 0:31:35.884264,used: 7:02:29.995878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.965518, 'precision': 0.92077136, 'recall': 0.86879337, 'specificity': 0.86879337, 'f1': 0.89261436, 'auroc': 0.9612999, 'binary_precision': 0.8672961, 'binary_recall': 0.7495467, 'binary_specificity': 0.9880401, 'binary_f1_score': 0.8041338}
confusion matrix:
       0     1
0  41802   506
1   1105  3307
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.62395656, 'recall': 0.55931294, 'specificity': 0.55931294, 'f1': 0.57828546, 'auroc': 0.6739869, 'binary_precision': 0.2781457, 'binary_recall': 0.13063763, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.17777778}
confusion matrix:
       0    1
0  17931  218
1    559   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9240413, 'precision': 0.85085225, 'recall': 0.7372048, 'specificity': 0.7372048, 'f1': 0.7792483, 'auroc': 0.8192903, 'binary_precision': 0.7648221, 'binary_recall': 0.49425286, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.6004655}
confusion matrix:
      0    1
0  5878  119
1   396  387
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_15.png
early stop counter: 14
val acc:0.9586526155471802, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9268436431884766
after epoch: 15,now: 2024-06-19 10:24:09.510140,epoch time: 0:33:37.560765,used: 7:36:07.556643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96579623, 'precision': 0.9180194, 'recall': 0.8741778, 'specificity': 0.8741778, 'f1': 0.8945567, 'auroc': 0.96765375, 'binary_precision': 0.8606557, 'binary_recall': 0.7612143, 'binary_specificity': 0.9871413, 'binary_f1_score': 0.8078865}
confusion matrix:
       0     1
0  41762   544
1   1054  3360
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.6151757, 'recall': 0.56851894, 'specificity': 0.56851894, 'f1': 0.5848105, 'auroc': 0.70149434, 'binary_precision': 0.25994694, 'binary_recall': 0.15241058, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.19215687}
confusion matrix:
       0    1
0  17870  279
1    545   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9261062, 'precision': 0.8495251, 'recall': 0.7533623, 'specificity': 0.7533623, 'f1': 0.79103166, 'auroc': 0.8397532, 'binary_precision': 0.7582418, 'binary_recall': 0.52873564, 'binary_specificity': 0.977989, 'binary_f1_score': 0.6230248}
confusion matrix:
      0    1
0  5865  132
1   369  414
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_16.png
early stop counter: 15
val acc:0.95615154504776, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9268436431884766
after epoch: 16,now: 2024-06-19 10:58:26.121268,epoch time: 0:34:16.611128,used: 8:10:24.167771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9671875, 'precision': 0.91934216, 'recall': 0.88225096, 'specificity': 0.88225096, 'f1': 0.89970434, 'auroc': 0.9716109, 'binary_precision': 0.8616621, 'binary_recall': 0.7775261, 'binary_specificity': 0.98697585, 'binary_f1_score': 0.8174348}
confusion matrix:
       0     1
0  41755   551
1    982  3432
---- Validation: 
scalar performance:
{'acc': 0.9556726, 'precision': 0.61662406, 'recall': 0.5735213, 'specificity': 0.5735213, 'f1': 0.589273, 'auroc': 0.7107641, 'binary_precision': 0.2625, 'binary_recall': 0.16329704, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.20134225}
confusion matrix:
       0    1
0  17854  295
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92861354, 'precision': 0.85526896, 'recall': 0.76310766, 'specificity': 0.76310766, 'f1': 0.79986537, 'auroc': 0.8469324, 'binary_precision': 0.76744187, 'binary_recall': 0.54789275, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.63934433}
confusion matrix:
      0    1
0  5867  130
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_17.png
new oracle model saved
early stop counter: 16
val acc:0.9556726217269897, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.928613543510437
after epoch: 17,now: 2024-06-19 11:38:12.548028,epoch time: 0:39:46.426760,used: 8:50:10.594531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9687286, 'precision': 0.91815495, 'recall': 0.8946459, 'specificity': 0.8946459, 'f1': 0.90596604, 'auroc': 0.97196877, 'binary_precision': 0.85669404, 'binary_recall': 0.8033084, 'binary_specificity': 0.98598343, 'binary_f1_score': 0.8291428}
confusion matrix:
       0     1
0  41714   593
1    868  3545
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.62624514, 'recall': 0.58696723, 'specificity': 0.58696723, 'f1': 0.6023461, 'auroc': 0.72316897, 'binary_precision': 0.28082192, 'binary_recall': 0.19129083, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.22756706}
confusion matrix:
       0    1
0  17834  315
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9261062, 'precision': 0.8417972, 'recall': 0.76502144, 'specificity': 0.76502144, 'f1': 0.79673535, 'auroc': 0.8504752, 'binary_precision': 0.7397959, 'binary_recall': 0.5555556, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.63457334}
confusion matrix:
      0    1
0  5844  153
1   348  435
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_18.png
early stop counter: 17
val acc:0.9555662274360657, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.928613543510437
after epoch: 18,now: 2024-06-19 12:16:53.841773,epoch time: 0:38:41.293745,used: 9:28:51.888276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9683005, 'precision': 0.9158696, 'recall': 0.894714, 'specificity': 0.894714, 'f1': 0.90493864, 'auroc': 0.97260284, 'binary_precision': 0.8520653, 'binary_recall': 0.8039882, 'binary_specificity': 0.9854398, 'binary_f1_score': 0.8273289}
confusion matrix:
       0     1
0  41691   616
1    865  3548
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.6259471, 'recall': 0.5848273, 'specificity': 0.5848273, 'f1': 0.60066533, 'auroc': 0.71678805, 'binary_precision': 0.28037384, 'binary_recall': 0.1866252, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.22408964}
confusion matrix:
       0    1
0  17841  308
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92699116, 'precision': 0.84781337, 'recall': 0.76219046, 'specificity': 0.76219046, 'f1': 0.79679793, 'auroc': 0.8480077, 'binary_precision': 0.7526316, 'binary_recall': 0.54789275, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.6341464}
confusion matrix:
      0    1
0  5856  141
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_19.png
early stop counter: 18
val acc:0.9557790756225586, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.928613543510437
after epoch: 19,now: 2024-06-19 12:50:30.635013,epoch time: 0:33:36.793240,used: 10:02:28.681516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9680223, 'precision': 0.9214946, 'recall': 0.88534975, 'specificity': 0.88534975, 'f1': 0.902392, 'auroc': 0.9716488, 'binary_precision': 0.8653654, 'binary_recall': 0.7834164, 'binary_specificity': 0.9872831, 'binary_f1_score': 0.8223544}
confusion matrix:
       0     1
0  41768   538
1    956  3458
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.6270625, 'recall': 0.5736253, 'specificity': 0.5736253, 'f1': 0.5920062, 'auroc': 0.7029265, 'binary_precision': 0.28337875, 'binary_recall': 0.16174184, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.2059406}
confusion matrix:
       0    1
0  17886  263
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9292035, 'precision': 0.85805273, 'recall': 0.7634411, 'specificity': 0.7634411, 'f1': 0.80099106, 'auroc': 0.8443288, 'binary_precision': 0.772973, 'binary_recall': 0.54789275, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.6412556}
confusion matrix:
      0    1
0  5871  126
1   354  429
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_20.png
new oracle model saved
early stop counter: 19
val acc:0.9573222398757935, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9292035102844238
after epoch: 20,now: 2024-06-19 13:25:53.974048,epoch time: 0:35:23.339035,used: 10:37:52.020551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9665882, 'precision': 0.91496444, 'recall': 0.8837708, 'specificity': 0.8837708, 'f1': 0.8985902, 'auroc': 0.9697124, 'binary_precision': 0.85251975, 'binary_recall': 0.78165346, 'binary_specificity': 0.9858882, 'binary_f1_score': 0.8155501}
confusion matrix:
       0     1
0  41708   597
1    964  3451
---- Validation: 
scalar performance:
{'acc': 0.9568433, 'precision': 0.6230409, 'recall': 0.5726273, 'specificity': 0.5726273, 'f1': 0.59018904, 'auroc': 0.70923984, 'binary_precision': 0.27540106, 'binary_recall': 0.16018662, 'binary_specificity': 0.985068, 'binary_f1_score': 0.20255654}
confusion matrix:
       0    1
0  17878  271
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92831856, 'precision': 0.85635805, 'recall': 0.7596097, 'specificity': 0.7596097, 'f1': 0.79769516, 'auroc': 0.84465027, 'binary_precision': 0.7704918, 'binary_recall': 0.54022986, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.6351351}
confusion matrix:
      0    1
0  5871  126
1   360  423
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_21.png
early stop counter: 20
val acc:0.9568433165550232, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9292035102844238
after epoch: 21,now: 2024-06-19 14:20:29.125353,epoch time: 0:54:35.151305,used: 11:32:27.171856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97009844, 'precision': 0.93148136, 'recall': 0.88738513, 'specificity': 0.88738513, 'f1': 0.9079294, 'auroc': 0.97101927, 'binary_precision': 0.88508683, 'binary_recall': 0.78540677, 'binary_specificity': 0.9893635, 'binary_f1_score': 0.83227277}
confusion matrix:
       0     1
0  41857   450
1    947  3466
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.63324857, 'recall': 0.57617855, 'specificity': 0.57617855, 'f1': 0.59565544, 'auroc': 0.7097078, 'binary_precision': 0.29558012, 'binary_recall': 0.16640747, 'binary_specificity': 0.98594964, 'binary_f1_score': 0.21293533}
confusion matrix:
       0    1
0  17894  255
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9300885, 'precision': 0.8650224, 'recall': 0.76061016, 'specificity': 0.76061016, 'f1': 0.8010918, 'auroc': 0.83961904, 'binary_precision': 0.7877095, 'binary_recall': 0.54022986, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.6409091}
confusion matrix:
      0    1
0  5883  114
1   360  423
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_22.png
new oracle model saved
early stop counter: 21
val acc:0.9579076170921326, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9300885200500488
after epoch: 22,now: 2024-06-19 15:15:55.856010,epoch time: 0:55:26.730657,used: 12:27:53.902513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96793664, 'precision': 0.9078654, 'recall': 0.9038888, 'specificity': 0.9038888, 'f1': 0.90586454, 'auroc': 0.9714354, 'binary_precision': 0.8339821, 'binary_recall': 0.82491505, 'binary_specificity': 0.98286253, 'binary_f1_score': 0.8294238}
confusion matrix:
       0     1
0  41580   725
1    773  3642
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.62704504, 'recall': 0.5898573, 'specificity': 0.5898573, 'f1': 0.604698, 'auroc': 0.7233392, 'binary_precision': 0.2822222, 'binary_recall': 0.19751166, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.23238792}
confusion matrix:
       0    1
0  17826  323
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9289085, 'precision': 0.8530694, 'recall': 0.7682711, 'specificity': 0.7682711, 'f1': 0.8027823, 'auroc': 0.85011536, 'binary_precision': 0.76173913, 'binary_recall': 0.55938697, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.6450663}
confusion matrix:
      0    1
0  5860  137
1   345  438
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_23.png
early stop counter: 22
val acc:0.955353319644928, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9300885200500488
after epoch: 23,now: 2024-06-19 16:14:35.452758,epoch time: 0:58:39.596748,used: 13:26:33.499261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9677868, 'precision': 0.90794015, 'recall': 0.902549, 'specificity': 0.902549, 'f1': 0.9052215, 'auroc': 0.974231, 'binary_precision': 0.8344066, 'binary_recall': 0.8221165, 'binary_specificity': 0.98298156, 'binary_f1_score': 0.82821596}
confusion matrix:
       0     1
0  41587   720
1    785  3628
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.62653214, 'recall': 0.59897435, 'specificity': 0.59897435, 'f1': 0.6107649, 'auroc': 0.73266584, 'binary_precision': 0.28056112, 'binary_recall': 0.21772939, 'binary_specificity': 0.9802193, 'binary_f1_score': 0.24518389}
confusion matrix:
       0    1
0  17790  359
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930236, 'precision': 0.85335183, 'recall': 0.7773494, 'specificity': 0.7773494, 'f1': 0.80908346, 'auroc': 0.85808486, 'binary_precision': 0.7600671, 'binary_recall': 0.5785441, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.65699786}
confusion matrix:
      0    1
0  5854  143
1   330  453
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_24.png
new oracle model saved
early stop counter: 23
val acc:0.9541293978691101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9302359819412231
after epoch: 24,now: 2024-06-19 17:02:54.686962,epoch time: 0:48:19.234204,used: 14:14:52.733465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96748716, 'precision': 0.90573776, 'recall': 0.90384346, 'specificity': 0.90384346, 'f1': 0.9047878, 'auroc': 0.9717127, 'binary_precision': 0.82969034, 'binary_recall': 0.82536805, 'binary_specificity': 0.9823189, 'binary_f1_score': 0.8275236}
confusion matrix:
       0     1
0  41557   748
1    771  3644
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.6236953, 'recall': 0.5993938, 'specificity': 0.5993938, 'f1': 0.60997605, 'auroc': 0.72580147, 'binary_precision': 0.2748538, 'binary_recall': 0.21928461, 'binary_specificity': 0.979503, 'binary_f1_score': 0.24394463}
confusion matrix:
       0    1
0  17777  372
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92831856, 'precision': 0.8388473, 'recall': 0.78792465, 'specificity': 0.78792465, 'f1': 0.8105044, 'auroc': 0.8592227, 'binary_precision': 0.7281106, 'binary_recall': 0.60536397, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.6610879}
confusion matrix:
      0    1
0  5820  177
1   309  474
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_25.png
early stop counter: 24
val acc:0.9534908533096313, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9302359819412231
after epoch: 25,now: 2024-06-19 17:49:57.274246,epoch time: 0:47:02.587284,used: 15:01:55.320749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9677654, 'precision': 0.90349114, 'recall': 0.9095395, 'specificity': 0.9095395, 'f1': 0.9064863, 'auroc': 0.9755696, 'binary_precision': 0.8239358, 'binary_recall': 0.8377521, 'binary_specificity': 0.98132694, 'binary_f1_score': 0.8307866}
confusion matrix:
       0     1
0  41517   790
1    716  3697
---- Validation: 
scalar performance:
{'acc': 0.9529587, 'precision': 0.6259953, 'recall': 0.60736895, 'specificity': 0.60736895, 'f1': 0.61580193, 'auroc': 0.74515533, 'binary_precision': 0.27889907, 'binary_recall': 0.23639192, 'binary_specificity': 0.97834593, 'binary_f1_score': 0.25589228}
confusion matrix:
       0    1
0  17756  393
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306785, 'precision': 0.84808594, 'recall': 0.7892586, 'specificity': 0.7892586, 'f1': 0.81491923, 'auroc': 0.8690653, 'binary_precision': 0.7464567, 'binary_recall': 0.60536397, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.6685472}
confusion matrix:
      0    1
0  5836  161
1   309  474
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_26.png
new oracle model saved
early stop counter: 25
val acc:0.9529587030410767, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9306784868240356
after epoch: 26,now: 2024-06-19 18:28:33.246367,epoch time: 0:38:35.972121,used: 15:40:31.292870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9662885, 'precision': 0.89790857, 'recall': 0.90764457, 'specificity': 0.90764457, 'f1': 0.90270025, 'auroc': 0.97662425, 'binary_precision': 0.81305116, 'binary_recall': 0.83533406, 'binary_specificity': 0.9799551, 'binary_f1_score': 0.824042}
confusion matrix:
       0     1
0  41457   848
1    727  3688
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.6303982, 'recall': 0.59722006, 'specificity': 0.59722006, 'f1': 0.6109678, 'auroc': 0.72290766, 'binary_precision': 0.28842106, 'binary_recall': 0.21306376, 'binary_specificity': 0.9813764, 'binary_f1_score': 0.2450805}
confusion matrix:
       0    1
0  17811  338
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93082595, 'precision': 0.85267556, 'recall': 0.7826797, 'specificity': 0.7826797, 'f1': 0.81238484, 'auroc': 0.8596471, 'binary_precision': 0.757377, 'binary_recall': 0.5900383, 'binary_specificity': 0.975321, 'binary_f1_score': 0.66331655}
confusion matrix:
      0    1
0  5849  148
1   321  462
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_27.png
new oracle model saved
early stop counter: 26
val acc:0.9550872445106506, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.93082594871521
after epoch: 27,now: 2024-06-19 18:57:49.303234,epoch time: 0:29:16.056867,used: 16:09:47.349737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9676798, 'precision': 0.90083134, 'recall': 0.9134673, 'specificity': 0.9134673, 'f1': 0.90702224, 'auroc': 0.97811085, 'binary_precision': 0.8177243, 'binary_recall': 0.8466244, 'binary_specificity': 0.98031014, 'binary_f1_score': 0.8319235}
confusion matrix:
       0     1
0  41473   833
1    677  3737
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6268548, 'recall': 0.61520624, 'specificity': 0.61520624, 'f1': 0.62069845, 'auroc': 0.7528254, 'binary_precision': 0.28006873, 'binary_recall': 0.2534992, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.26612246}
confusion matrix:
       0    1
0  17730  419
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93554574, 'precision': 0.8608487, 'recall': 0.8036691, 'specificity': 0.8036691, 'f1': 0.8288728, 'auroc': 0.8707361, 'binary_precision': 0.76863354, 'binary_recall': 0.6321839, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.69376314}
confusion matrix:
      0    1
0  5848  149
1   288  495
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_28.png
new oracle model saved
early stop counter: 27
val acc:0.9521604776382446, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9355457425117493
after epoch: 28,now: 2024-06-19 19:26:59.572108,epoch time: 0:29:10.268874,used: 16:38:57.618611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9677012, 'precision': 0.90084314, 'recall': 0.9135634, 'specificity': 0.9135634, 'f1': 0.90707445, 'auroc': 0.9761982, 'binary_precision': 0.8177243, 'binary_recall': 0.84681624, 'binary_specificity': 0.98031056, 'binary_f1_score': 0.83201605}
confusion matrix:
       0     1
0  41474   833
1    676  3737
---- Validation: 
scalar performance:
{'acc': 0.9519476, 'precision': 0.6262993, 'recall': 0.61584616, 'specificity': 0.61584616, 'f1': 0.6208051, 'auroc': 0.7342397, 'binary_precision': 0.27891156, 'binary_recall': 0.25505444, 'binary_specificity': 0.97663784, 'binary_f1_score': 0.26645002}
confusion matrix:
       0    1
0  17725  424
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93112093, 'precision': 0.8453079, 'recall': 0.79783666, 'specificity': 0.79783666, 'f1': 0.81913465, 'auroc': 0.8635243, 'binary_precision': 0.7386707, 'binary_recall': 0.6245211, 'binary_specificity': 0.97115225, 'binary_f1_score': 0.6768166}
confusion matrix:
      0    1
0  5824  173
1   294  489
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_29.png
early stop counter: 28
val acc:0.9519476294517517, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9355457425117493
after epoch: 29,now: 2024-06-19 19:55:58.919478,epoch time: 0:28:59.347370,used: 17:07:56.965981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9715967, 'precision': 0.9134877, 'recall': 0.9222798, 'specificity': 0.9222798, 'f1': 0.91782403, 'auroc': 0.97918034, 'binary_precision': 0.8414526, 'binary_recall': 0.8614827, 'binary_specificity': 0.9830769, 'binary_f1_score': 0.8513499}
confusion matrix:
       0     1
0  41593   716
1    611  3800
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.63010967, 'recall': 0.60355735, 'specificity': 0.60355735, 'f1': 0.61505747, 'auroc': 0.73381746, 'binary_precision': 0.2874016, 'binary_recall': 0.22706065, 'binary_specificity': 0.980054, 'binary_f1_score': 0.25369242}
confusion matrix:
       0    1
0  17787  362
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318584, 'precision': 0.8528807, 'recall': 0.7899256, 'specificity': 0.7899256, 'f1': 0.81715786, 'auroc': 0.861356, 'binary_precision': 0.75598085, 'binary_recall': 0.60536397, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.6723404}
confusion matrix:
      0    1
0  5844  153
1   309  474
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_30.png
early stop counter: 29
val acc:0.9542890787124634, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9355457425117493
after epoch: 30,now: 2024-06-19 20:25:36.288088,epoch time: 0:29:37.368610,used: 17:37:34.334591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_02_48_01_seed_0_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:37:34.334591 at 2024-06-19 20:25:36.288088
persisted model performance metric: 

scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.28504544, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
oracle model performance metric: 

scalar performance:
{'acc': 0.93554574, 'precision': 0.8608487, 'recall': 0.8036691, 'specificity': 0.8036691, 'f1': 0.8288728, 'auroc': 0.8707361, 'binary_precision': 0.76863354, 'binary_recall': 0.6321839, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.69376314}
confusion matrix:
      0    1
0  5848  149
1   288  495
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204121 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |  36185 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204121 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |  36185 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |  35992 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404134 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 303206 GiB | 303205 GiB |
|       from small pool |   6822 KiB |  12667 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1218    |    1875    |   12699 K  |   12698 K  |
|       from large pool |      36    |      76    |    4061 K  |    4061 K  |
|       from small pool |    1182    |    1804    |    8638 K  |    8637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1218    |    1875    |   12699 K  |   12698 K  |
|       from large pool |      36    |      76    |    4061 K  |    4061 K  |
|       from small pool |    1182    |    1804    |    8638 K  |    8637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |     382    |    7340 K  |    7340 K  |
|       from large pool |       5    |      10    |    1608 K  |    1608 K  |
|       from small pool |      36    |     377    |    5731 K  |    5731 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 303206 GiB | 303206 GiB |
|       from small pool |      0 KiB |  14417 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7340 K  |    7340 K  |
|       from large pool |       1    |      11    |    1608 K  |    1608 K  |
|       from small pool |       0    |     377    |    5732 K  |    5732 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 427741 GiB | 427741 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 427621 GiB | 427621 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 427735 GiB | 427735 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 427617 GiB | 427617 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 303332 GiB | 303331 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 303206 GiB | 303206 GiB |
|       from small pool |      0 KiB |  14417 KiB |    125 GiB |    125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1875    |   12699 K  |   12699 K  |
|       from large pool |       2    |      76    |    4061 K  |    4061 K  |
|       from small pool |       0    |    1804    |    8638 K  |    8638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7340 K  |    7340 K  |
|       from large pool |       1    |      11    |    1608 K  |    1608 K  |
|       from small pool |       0    |     377    |    5732 K  |    5732 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_20_44_11_seed_1_21504943

 Experiment start at: 2024-06-19 20:44:11.722865
before training, model accuracy: 0.20428188145160675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9072988, 'precision': 0.45371738, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.47569826, 'auroc': 0.4729247, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42389  7
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.32278642, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.22138542, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 21:22:39.657330,epoch time: 0:38:27.934465,used: 0:38:27.934465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_20_44_11_seed_1_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9072988, 'precision': 0.45370767, 'recall': 0.49992925, 'specificity': 0.49992925, 'f1': 0.47569832, 'auroc': 0.71896064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998585, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42389  6
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.3568615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.30292183, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_2.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.884032130241394 / 0.884032130241394
after epoch: 2,now: 2024-06-19 21:57:25.248202,epoch time: 0:34:45.590872,used: 1:13:13.525337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_20_44_11_seed_1_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9051798, 'precision': 0.53823024, 'recall': 0.50155354, 'specificity': 0.50155354, 'f1': 0.48112142, 'auroc': 0.8197708, 'binary_precision': 0.16875, 'binary_recall': 0.0062442184, 'binary_specificity': 0.9968629, 'binary_f1_score': 0.0120428195}
confusion matrix:
       0    1
0  42263  133
1   4297   27
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.4820217, 'recall': 0.49936348, 'specificity': 0.49936348, 'f1': 0.49053937, 'auroc': 0.38033926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18044  23
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.36838794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504943_3.png
early stop counter: 2
val acc:0.9628601670265198, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.884032130241394 / 0.884032130241394
after epoch: 3,now: 2024-06-19 22:35:10.298838,epoch time: 0:37:45.050636,used: 1:50:58.575973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_20_44_11_seed_1_21504943
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
slurmstepd: error: *** JOB 21504943 ON supergpu03 CANCELLED AT 2024-06-19T22:52:11 ***
