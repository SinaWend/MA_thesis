Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:13:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732

 Experiment start at: 2024-06-08 12:19:42.821167
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96533614, 'precision': 0.7412821, 'recall': 0.88002956, 'specificity': 0.88002956, 'f1': 0.7931776, 'auroc': 0.96297836, 'binary_precision': 0.49007183, 'binary_recall': 0.7885792, 'binary_specificity': 0.9714799, 'binary_f1_score': 0.6044815}
confusion matrix:
       0     1
0  41114  1207
1    311  1160
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.74175644, 'recall': 0.8633635, 'specificity': 0.8633635, 'f1': 0.7887615, 'auroc': 0.960337, 'binary_precision': 0.49238577, 'binary_recall': 0.7542768, 'binary_specificity': 0.97245026, 'binary_f1_score': 0.59582305}
confusion matrix:
       0    1
0  17649  500
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98146373, 'precision': 0.8947643, 'recall': 0.8657298, 'specificity': 0.8657298, 'f1': 0.87963444, 'auroc': 0.9545298, 'binary_precision': 0.8008299, 'binary_recall': 0.7394636, 'binary_specificity': 0.991996, 'binary_f1_score': 0.7689243}
confusion matrix:
      0    1
0  5949   48
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 12:36:48.060209,epoch time: 0:17:05.239042,used: 0:17:05.239042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97926563, 'precision': 0.84866476, 'recall': 0.819769, 'specificity': 0.819769, 'f1': 0.83353686, 'auroc': 0.9732765, 'binary_precision': 0.7095097, 'binary_recall': 0.6487772, 'binary_specificity': 0.99076086, 'binary_f1_score': 0.67778563}
confusion matrix:
       0    1
0  41929  391
1    517  955
---- Validation: 
scalar performance:
{'acc': 0.9755215, 'precision': 0.8133019, 'recall': 0.82081485, 'specificity': 0.82081485, 'f1': 0.8170095, 'auroc': 0.970387, 'binary_precision': 0.63884676, 'binary_recall': 0.6547434, 'binary_specificity': 0.9868863, 'binary_f1_score': 0.64669746}
confusion matrix:
       0    1
0  17911  238
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.86626005, 'recall': 0.65683603, 'specificity': 0.65683603, 'f1': 0.7159265, 'auroc': 0.95818174, 'binary_precision': 0.7614679, 'binary_recall': 0.31800765, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.44864863}
confusion matrix:
      0   1
0  5971  26
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_2.png
better model found
persisted
after epoch: 2,now: 2024-06-08 12:53:03.562893,epoch time: 0:16:15.502684,used: 0:33:20.741726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.977964, 'precision': 0.82154477, 'recall': 0.86204517, 'specificity': 0.86204517, 'f1': 0.840477, 'auroc': 0.97790754, 'binary_precision': 0.65225226, 'binary_recall': 0.73777175, 'binary_specificity': 0.9863185, 'binary_f1_score': 0.6923813}
confusion matrix:
       0     1
0  41741   579
1    386  1086
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.83527523, 'recall': 0.8151113, 'specificity': 0.8151113, 'f1': 0.8248515, 'auroc': 0.9725804, 'binary_precision': 0.6832504, 'binary_recall': 0.6407465, 'binary_specificity': 0.989476, 'binary_f1_score': 0.6613162}
confusion matrix:
       0    1
0  17958  191
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8900444, 'recall': 0.8106745, 'specificity': 0.8106745, 'f1': 0.84540963, 'auroc': 0.9636255, 'binary_precision': 0.79611653, 'binary_recall': 0.62835246, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.70235544}
confusion matrix:
      0    1
0  5955   42
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_3.png
better model found
persisted
after epoch: 3,now: 2024-06-08 13:09:12.854381,epoch time: 0:16:09.291488,used: 0:49:30.033214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9803845, 'precision': 0.8796191, 'recall': 0.79149634, 'specificity': 0.79149634, 'f1': 0.8293083, 'auroc': 0.9784627, 'binary_precision': 0.7734166, 'binary_recall': 0.58899456, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.66872346}
confusion matrix:
       0    1
0  42066  254
1    605  867
---- Validation: 
scalar performance:
{'acc': 0.9781822, 'precision': 0.88501656, 'recall': 0.7456867, 'specificity': 0.7456867, 'f1': 0.7987784, 'auroc': 0.9693651, 'binary_precision': 0.78765434, 'binary_recall': 0.496112, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.6087787}
confusion matrix:
       0    1
0  18063   86
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9370171, 'recall': 0.6277689, 'specificity': 0.6277689, 'f1': 0.69174945, 'auroc': 0.9537406, 'binary_precision': 0.9054054, 'binary_recall': 0.256705, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.40000004}
confusion matrix:
      0   1
0  5990   7
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 13:25:24.234884,epoch time: 0:16:11.380503,used: 1:05:41.413717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98129797, 'precision': 0.9436615, 'recall': 0.7470522, 'specificity': 0.7470522, 'f1': 0.8155155, 'auroc': 0.983863, 'binary_precision': 0.9045849, 'binary_recall': 0.4959239, 'binary_specificity': 0.9981805, 'binary_f1_score': 0.64063185}
confusion matrix:
       0    1
0  42243   77
1    742  730
---- Validation: 
scalar performance:
{'acc': 0.9793529, 'precision': 0.9308712, 'recall': 0.72829145, 'specificity': 0.72829145, 'f1': 0.7963363, 'auroc': 0.97738695, 'binary_precision': 0.880597, 'binary_recall': 0.45878693, 'binary_specificity': 0.997796, 'binary_f1_score': 0.60327196}
confusion matrix:
       0    1
0  18109   40
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.96313626, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 13:41:36.132971,epoch time: 0:16:11.898087,used: 1:21:53.311804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98506576, 'precision': 0.88722634, 'recall': 0.8811289, 'specificity': 0.8811289, 'f1': 0.88415134, 'auroc': 0.9857366, 'binary_precision': 0.78245854, 'binary_recall': 0.76970106, 'binary_specificity': 0.9925567, 'binary_f1_score': 0.7760274}
confusion matrix:
       0     1
0  42005   315
1    339  1133
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.8654576, 'recall': 0.89006436, 'specificity': 0.89006436, 'f1': 0.87732345, 'auroc': 0.98029196, 'binary_precision': 0.7383721, 'binary_recall': 0.79004663, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.7633358}
confusion matrix:
       0    1
0  17969  180
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8928306, 'recall': 0.6271019, 'specificity': 0.6271019, 'f1': 0.6867507, 'auroc': 0.96659774, 'binary_precision': 0.81707317, 'binary_recall': 0.256705, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.39067057}
confusion matrix:
      0   1
0  5982  15
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_6.png
better model found
persisted
after epoch: 6,now: 2024-06-08 13:57:45.246728,epoch time: 0:16:09.113757,used: 1:38:02.425561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98543113, 'precision': 0.8782842, 'recall': 0.9065027, 'specificity': 0.9065027, 'f1': 0.8918413, 'auroc': 0.9879749, 'binary_precision': 0.762776, 'binary_recall': 0.8218899, 'binary_specificity': 0.9911155, 'binary_f1_score': 0.7912304}
confusion matrix:
       0     1
0  41945   376
1    262  1209
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.8704842, 'recall': 0.8788135, 'specificity': 0.8788135, 'f1': 0.8745984, 'auroc': 0.97912514, 'binary_precision': 0.7492401, 'binary_recall': 0.7667185, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.7578786}
confusion matrix:
       0    1
0  17984  165
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8856168, 'recall': 0.65916866, 'specificity': 0.65916866, 'f1': 0.7213601, 'auroc': 0.96436536, 'binary_precision': 0.8, 'binary_recall': 0.3218391, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.45901647}
confusion matrix:
      0   1
0  5976  21
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_7.png
early stop counter: 1
val acc:0.9832375645637512, best validation acc: 0.9832375645637512, corresponding to test acc:                         0.9666027426719666 / 0.9814637303352356
after epoch: 7,now: 2024-06-08 14:13:55.732017,epoch time: 0:16:10.485289,used: 1:54:12.910850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98668706, 'precision': 0.95520246, 'recall': 0.82885456, 'specificity': 0.82885456, 'f1': 0.8811274, 'auroc': 0.9901345, 'binary_precision': 0.92212725, 'binary_recall': 0.65964675, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.7691089}
confusion matrix:
       0    1
0  42238   82
1    501  971
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.96280813, 'recall': 0.78319216, 'specificity': 0.78319216, 'f1': 0.8499079, 'auroc': 0.98266864, 'binary_precision': 0.94072163, 'binary_recall': 0.5676516, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.70805043}
confusion matrix:
       0    1
0  18126   23
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.959237, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_8.png
better model found
persisted
after epoch: 8,now: 2024-06-08 14:30:06.754171,epoch time: 0:16:11.022154,used: 2:10:23.933004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9871666, 'precision': 0.916418, 'recall': 0.8786094, 'specificity': 0.8786094, 'f1': 0.8965429, 'auroc': 0.9910829, 'binary_precision': 0.8410795, 'binary_recall': 0.76222825, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.7997149}
confusion matrix:
       0     1
0  42108   212
1    350  1122
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.8871193, 'recall': 0.8626705, 'specificity': 0.8626705, 'f1': 0.8744622, 'auroc': 0.9830041, 'binary_precision': 0.78369385, 'binary_recall': 0.7325039, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.75723475}
confusion matrix:
       0    1
0  18019  130
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8695172, 'recall': 0.68523824, 'specificity': 0.68523824, 'f1': 0.7439706, 'auroc': 0.95973134, 'binary_precision': 0.765625, 'binary_recall': 0.37547892, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.503856}
confusion matrix:
      0   1
0  5967  30
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_9.png
early stop counter: 1
val acc:0.9839293360710144, best validation acc: 0.9839825630187988, corresponding to test acc:                         0.9616490602493286 / 0.9814637303352356
after epoch: 9,now: 2024-06-08 14:46:18.659164,epoch time: 0:16:11.904993,used: 2:26:35.837997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9863445, 'precision': 0.9395236, 'recall': 0.8372017, 'specificity': 0.8372017, 'f1': 0.88112706, 'auroc': 0.9912319, 'binary_precision': 0.89017856, 'binary_recall': 0.6773098, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.7692901}
confusion matrix:
       0    1
0  42197  123
1    475  997
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.92253375, 'recall': 0.77678466, 'specificity': 0.77678466, 'f1': 0.83335936, 'auroc': 0.98164654, 'binary_precision': 0.8605769, 'binary_recall': 0.55676514, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.67610955}
confusion matrix:
       0    1
0  18091   58
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8635541, 'recall': 0.63034964, 'specificity': 0.63034964, 'f1': 0.6872263, 'auroc': 0.9576623, 'binary_precision': 0.7582418, 'binary_recall': 0.26436782, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.39204547}
confusion matrix:
      0   1
0  5975  22
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_10.png
early stop counter: 2
val acc:0.981747567653656, best validation acc: 0.9839825630187988, corresponding to test acc:                         0.9616490602493286 / 0.9814637303352356
after epoch: 10,now: 2024-06-08 15:02:29.544348,epoch time: 0:16:10.885184,used: 2:42:46.723181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885367, 'precision': 0.95889014, 'recall': 0.85627115, 'specificity': 0.85627115, 'f1': 0.9006562, 'auroc': 0.9936048, 'binary_precision': 0.9276258, 'binary_recall': 0.7144799, 'binary_specificity': 0.99806243, 'binary_f1_score': 0.8072196}
confusion matrix:
       0     1
0  42239    82
1    420  1051
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.9381199, 'recall': 0.8112197, 'specificity': 0.8112197, 'f1': 0.86313576, 'auroc': 0.98327744, 'binary_precision': 0.8893805, 'binary_recall': 0.62519443, 'binary_specificity': 0.997245, 'binary_f1_score': 0.73424655}
confusion matrix:
       0    1
0  18099   50
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9051653, 'recall': 0.6026145, 'specificity': 0.6026145, 'f1': 0.65725386, 'auroc': 0.95398694, 'binary_precision': 0.84375, 'binary_recall': 0.20689656, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.3323077}
confusion matrix:
      0   1
0  5987  10
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_11.png
better model found
persisted
after epoch: 11,now: 2024-06-08 15:21:53.717065,epoch time: 0:19:24.172717,used: 3:02:10.895898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9883312, 'precision': 0.89202136, 'recall': 0.94245267, 'specificity': 0.94245267, 'f1': 0.915579, 'auroc': 0.99268365, 'binary_precision': 0.7877698, 'binary_recall': 0.8932699, 'binary_specificity': 0.9916354, 'binary_f1_score': 0.83720934}
confusion matrix:
       0     1
0  41967   354
1    157  1314
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.88702065, 'recall': 0.8957218, 'specificity': 0.8957218, 'f1': 0.89131856, 'auroc': 0.9851549, 'binary_precision': 0.781155, 'binary_recall': 0.7993779, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.7901614}
confusion matrix:
       0    1
0  18005  144
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.87225246, 'recall': 0.7306316, 'specificity': 0.7306316, 'f1': 0.78320104, 'auroc': 0.96410894, 'binary_precision': 0.7672956, 'binary_recall': 0.46743295, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.58095235}
confusion matrix:
      0    1
0  5960   37
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_12.png
better model found
persisted
after epoch: 12,now: 2024-06-08 15:37:53.208703,epoch time: 0:15:59.491638,used: 3:18:10.387536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.9405075, 'recall': 0.91155183, 'specificity': 0.91155183, 'f1': 0.9254992, 'auroc': 0.99432707, 'binary_precision': 0.88702625, 'binary_recall': 0.8267663, 'binary_specificity': 0.9963374, 'binary_f1_score': 0.85583687}
confusion matrix:
       0     1
0  42165   155
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.92497617, 'recall': 0.8401902, 'specificity': 0.8401902, 'f1': 0.8775219, 'auroc': 0.9834496, 'binary_precision': 0.86105675, 'binary_recall': 0.6842924, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.76256496}
confusion matrix:
       0    1
0  18078   71
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.86895823, 'recall': 0.6380125, 'specificity': 0.6380125, 'f1': 0.69642127, 'auroc': 0.94689524, 'binary_precision': 0.76842105, 'binary_recall': 0.27969348, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.41011238}
confusion matrix:
      0   1
0  5975  22
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_13.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9718760251998901 / 0.9814637303352356
after epoch: 13,now: 2024-06-08 15:54:24.787779,epoch time: 0:16:31.579076,used: 3:34:41.966612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989884, 'precision': 0.9480015, 'recall': 0.8898511, 'specificity': 0.8898511, 'f1': 0.9167557, 'auroc': 0.9934799, 'binary_precision': 0.9035294, 'binary_recall': 0.7826087, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.83873314}
confusion matrix:
       0     1
0  42197   123
1    320  1152
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.9248701, 'recall': 0.8672135, 'specificity': 0.8672135, 'f1': 0.893777, 'auroc': 0.978089, 'binary_precision': 0.85895115, 'binary_recall': 0.7387247, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7943144}
confusion matrix:
       0    1
0  18071   78
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.9317586, 'recall': 0.6296012, 'specificity': 0.6296012, 'f1': 0.69352853, 'auroc': 0.9492067, 'binary_precision': 0.8947368, 'binary_recall': 0.2605364, 'binary_specificity': 0.998666, 'binary_f1_score': 0.40356085}
confusion matrix:
      0   1
0  5989   8
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_14.png
better model found
persisted
after epoch: 14,now: 2024-06-08 16:10:37.040020,epoch time: 0:16:12.252241,used: 3:50:54.218853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9889706, 'precision': 0.9491147, 'recall': 0.8729002, 'specificity': 0.8729002, 'f1': 0.9072113, 'auroc': 0.995311, 'binary_precision': 0.9069193, 'binary_recall': 0.7484704, 'binary_specificity': 0.99732995, 'binary_f1_score': 0.8201117}
confusion matrix:
       0     1
0  42208   113
1    370  1101
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.92626786, 'recall': 0.7923368, 'specificity': 0.7923368, 'f1': 0.8459003, 'auroc': 0.98168796, 'binary_precision': 0.8669725, 'binary_recall': 0.58786935, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7006487}
confusion matrix:
       0    1
0  18091   58
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8722373, 'recall': 0.72496784, 'specificity': 0.72496784, 'f1': 0.77870226, 'auroc': 0.95835304, 'binary_precision': 0.7677419, 'binary_recall': 0.4559387, 'binary_specificity': 0.993997, 'binary_f1_score': 0.57211536}
confusion matrix:
      0    1
0  5961   36
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_15.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9678810834884644 / 0.9814637303352356
after epoch: 15,now: 2024-06-08 16:26:44.868019,epoch time: 0:16:07.827999,used: 4:07:02.046852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.95198756, 'recall': 0.90587485, 'specificity': 0.90587485, 'f1': 0.92759764, 'auroc': 0.99685776, 'binary_precision': 0.9104024, 'binary_recall': 0.81453806, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.85980636}
confusion matrix:
       0     1
0  42202   118
1    273  1199
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9363901, 'recall': 0.8366878, 'specificity': 0.8366878, 'f1': 0.8796247, 'auroc': 0.9838915, 'binary_precision': 0.88414633, 'binary_recall': 0.67651635, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.76651984}
confusion matrix:
       0    1
0  18092   57
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9462472, 'recall': 0.6374308, 'specificity': 0.6374308, 'f1': 0.7043825, 'auroc': 0.96199787, 'binary_precision': 0.9230769, 'binary_recall': 0.27586207, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.4247788}
confusion matrix:
      0   1
0  5991   6
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_16.png
early stop counter: 2
val acc:0.9858982563018799, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9678810834884644 / 0.9814637303352356
after epoch: 16,now: 2024-06-08 16:42:57.373935,epoch time: 0:16:12.505916,used: 4:23:14.552768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9916651, 'precision': 0.9267406, 'recall': 0.9488038, 'specificity': 0.9488038, 'f1': 0.9374713, 'auroc': 0.99661064, 'binary_precision': 0.85686654, 'binary_recall': 0.90285325, 'binary_specificity': 0.99475425, 'binary_f1_score': 0.87925893}
confusion matrix:
       0     1
0  42098   222
1    143  1329
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9091208, 'recall': 0.8851322, 'specificity': 0.8851322, 'f1': 0.8967341, 'auroc': 0.9836706, 'binary_precision': 0.82615894, 'binary_recall': 0.7760498, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.80032074}
confusion matrix:
       0    1
0  18044  105
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8914374, 'recall': 0.66308343, 'specificity': 0.66308343, 'f1': 0.7263071, 'auroc': 0.95698166, 'binary_precision': 0.8113208, 'binary_recall': 0.32950193, 'binary_specificity': 0.996665, 'binary_f1_score': 0.46866488}
confusion matrix:
      0   1
0  5977  20
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_17.png
early stop counter: 3
val acc:0.9867497086524963, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9678810834884644 / 0.9814637303352356
after epoch: 17,now: 2024-06-08 16:59:04.276252,epoch time: 0:16:06.902317,used: 4:39:21.455085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9935605, 'precision': 0.9609978, 'recall': 0.9379815, 'specificity': 0.9379815, 'f1': 0.94917244, 'auroc': 0.997001, 'binary_precision': 0.9262178, 'binary_recall': 0.87839675, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.9016737}
confusion matrix:
       0     1
0  42217   103
1    179  1293
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9237727, 'recall': 0.8540493, 'specificity': 0.8540493, 'f1': 0.8855404, 'auroc': 0.98536193, 'binary_precision': 0.8576779, 'binary_recall': 0.7122862, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7782498}
confusion matrix:
       0    1
0  18073   76
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8934717, 'recall': 0.6517559, 'specificity': 0.6517559, 'f1': 0.71465665, 'auroc': 0.95741904, 'binary_precision': 0.81632656, 'binary_recall': 0.3065134, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.44568244}
confusion matrix:
      0   1
0  5979  18
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_18.png
early stop counter: 4
val acc:0.9861111044883728, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9678810834884644 / 0.9814637303352356
after epoch: 18,now: 2024-06-08 17:15:13.919431,epoch time: 0:16:09.643179,used: 4:55:31.098264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.976157, 'recall': 0.89446187, 'specificity': 0.89446187, 'f1': 0.93120015, 'auroc': 0.99768174, 'binary_precision': 0.95957094, 'binary_recall': 0.7900815, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.866617}
confusion matrix:
       0     1
0  42271    49
1    309  1163
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.950158, 'recall': 0.7914152, 'specificity': 0.7914152, 'f1': 0.85260266, 'auroc': 0.982869, 'binary_precision': 0.91484183, 'binary_recall': 0.58475894, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.7134725}
confusion matrix:
       0    1
0  18114   35
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.87118036, 'recall': 0.59836626, 'specificity': 0.59836626, 'f1': 0.6493472, 'auroc': 0.9301092, 'binary_precision': 0.7761194, 'binary_recall': 0.19923371, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.31707317}
confusion matrix:
      0   1
0  5982  15
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_19.png
early stop counter: 5
val acc:0.9839293360710144, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9678810834884644 / 0.9814637303352356
after epoch: 19,now: 2024-06-08 17:31:16.833569,epoch time: 0:16:02.914138,used: 5:11:34.012402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99340063, 'precision': 0.95062554, 'recall': 0.9473721, 'specificity': 0.9473721, 'f1': 0.94899243, 'auroc': 0.9979695, 'binary_precision': 0.9047945, 'binary_recall': 0.89802855, 'binary_specificity': 0.9967156, 'binary_f1_score': 0.90139884}
confusion matrix:
       0     1
0  42182   139
1    150  1321
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.92015016, 'recall': 0.88093483, 'specificity': 0.88093483, 'f1': 0.8995049, 'auroc': 0.98537326, 'binary_precision': 0.848537, 'binary_recall': 0.7667185, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.8055555}
confusion matrix:
       0    1
0  18061   88
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8839588, 'recall': 0.7291328, 'specificity': 0.7291328, 'f1': 0.7851643, 'auroc': 0.95243156, 'binary_precision': 0.7908497, 'binary_recall': 0.46360153, 'binary_specificity': 0.994664, 'binary_f1_score': 0.5845411}
confusion matrix:
      0    1
0  5965   32
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_20.png
better model found
persisted
after epoch: 20,now: 2024-06-08 17:47:25.125402,epoch time: 0:16:08.291833,used: 5:27:42.304235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9924872, 'precision': 0.98062336, 'recall': 0.90103376, 'specificity': 0.90103376, 'f1': 0.936978, 'auroc': 0.99764264, 'binary_precision': 0.96805894, 'binary_recall': 0.8029891, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.87783146}
confusion matrix:
       0     1
0  42281    39
1    290  1182
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.9426955, 'recall': 0.7865843, 'specificity': 0.7865843, 'f1': 0.8467458, 'auroc': 0.98010683, 'binary_precision': 0.9002433, 'binary_recall': 0.5754277, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.7020873}
confusion matrix:
       0    1
0  18108   41
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8965626, 'recall': 0.6081949, 'specificity': 0.6081949, 'f1': 0.6638646, 'auroc': 0.9511584, 'binary_precision': 0.82608694, 'binary_recall': 0.21839081, 'binary_specificity': 0.997999, 'binary_f1_score': 0.34545454}
confusion matrix:
      0   1
0  5985  12
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_21.png
early stop counter: 1
val acc:0.9832907915115356, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9725151658058167 / 0.9814637303352356
after epoch: 21,now: 2024-06-08 18:03:32.201198,epoch time: 0:16:07.075796,used: 5:43:49.380031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9942455, 'precision': 0.97340035, 'recall': 0.9360409, 'specificity': 0.9360409, 'f1': 0.9538959, 'auroc': 0.9983952, 'binary_precision': 0.95118344, 'binary_recall': 0.8736413, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.9107649}
confusion matrix:
       0     1
0  42254    66
1    186  1286
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.9274619, 'recall': 0.81477714, 'specificity': 0.81477714, 'f1': 0.86192185, 'auroc': 0.98510945, 'binary_precision': 0.8678038, 'binary_recall': 0.63297045, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.73201436}
confusion matrix:
       0    1
0  18087   62
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.8669596, 'recall': 0.70780987, 'specificity': 0.70780987, 'f1': 0.7632563, 'auroc': 0.95657474, 'binary_precision': 0.7586207, 'binary_recall': 0.42145595, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5418719}
confusion matrix:
      0    1
0  5962   35
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_22.png
early stop counter: 2
val acc:0.9841421842575073, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9725151658058167 / 0.9814637303352356
after epoch: 22,now: 2024-06-08 18:19:42.568861,epoch time: 0:16:10.367663,used: 5:59:59.747694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9949762, 'precision': 0.9679254, 'recall': 0.9537955, 'specificity': 0.9537955, 'f1': 0.9607439, 'auroc': 0.99874985, 'binary_precision': 0.9389902, 'binary_recall': 0.90964675, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.92408556}
confusion matrix:
       0     1
0  42233    87
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.93011063, 'recall': 0.8743497, 'specificity': 0.8743497, 'f1': 0.9001451, 'auroc': 0.9808347, 'binary_precision': 0.8689408, 'binary_recall': 0.7527216, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.8066667}
confusion matrix:
       0    1
0  18076   73
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.852403, 'recall': 0.6263515, 'specificity': 0.6263515, 'f1': 0.68138003, 'auroc': 0.931674, 'binary_precision': 0.73626375, 'binary_recall': 0.256705, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3806818}
confusion matrix:
      0   1
0  5973  24
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_23.png
better model found
persisted
after epoch: 23,now: 2024-06-08 18:35:40.251270,epoch time: 0:15:57.682409,used: 6:15:57.430103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9916423, 'precision': 0.9726508, 'recall': 0.89469516, 'specificity': 0.89469516, 'f1': 0.92991555, 'auroc': 0.9977446, 'binary_precision': 0.9525368, 'binary_recall': 0.7907609, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.86414254}
confusion matrix:
       0     1
0  42262    58
1    308  1164
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.94504046, 'recall': 0.78741705, 'specificity': 0.78741705, 'f1': 0.84807, 'auroc': 0.9822979, 'binary_precision': 0.904878, 'binary_recall': 0.5769829, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.7046534}
confusion matrix:
       0    1
0  18110   39
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.87435436, 'recall': 0.5757112, 'specificity': 0.5757112, 'f1': 0.6187, 'auroc': 0.9276743, 'binary_precision': 0.78431374, 'binary_recall': 0.1532567, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.25641024}
confusion matrix:
      0   1
0  5986  11
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_24.png
early stop counter: 1
val acc:0.9834504127502441, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 24,now: 2024-06-08 18:51:31.299191,epoch time: 0:15:51.047921,used: 6:31:48.478024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.94836015, 'recall': 0.95776737, 'specificity': 0.95776737, 'f1': 0.95301104, 'auroc': 0.9982611, 'binary_precision': 0.8995343, 'binary_recall': 0.91910267, 'binary_specificity': 0.996432, 'binary_f1_score': 0.9092132}
confusion matrix:
       0     1
0  42170   151
1    119  1352
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9027496, 'recall': 0.8864119, 'specificity': 0.8864119, 'f1': 0.8943974, 'auroc': 0.985064, 'binary_precision': 0.8133117, 'binary_recall': 0.7791602, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7958698}
confusion matrix:
       0    1
0  18034  115
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.85239094, 'recall': 0.71297336, 'specificity': 0.71297336, 'f1': 0.76378334, 'auroc': 0.95821935, 'binary_precision': 0.7290323, 'binary_recall': 0.4329502, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.5432692}
confusion matrix:
      0    1
0  5955   42
1   148  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_25.png
early stop counter: 2
val acc:0.9863239526748657, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 25,now: 2024-06-08 19:07:24.465956,epoch time: 0:15:53.166765,used: 6:47:41.644789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9952731, 'precision': 0.9583051, 'recall': 0.9700142, 'specificity': 0.9700142, 'f1': 0.96408004, 'auroc': 0.99912274, 'binary_precision': 0.918597, 'binary_recall': 0.9429348, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.93060684}
confusion matrix:
       0     1
0  42197   123
1     84  1388
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.90795547, 'recall': 0.8920204, 'specificity': 0.8920204, 'f1': 0.8998159, 'auroc': 0.98377144, 'binary_precision': 0.82333875, 'binary_recall': 0.79004663, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.80634916}
confusion matrix:
       0    1
0  18040  109
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8641707, 'recall': 0.7020627, 'specificity': 0.7020627, 'f1': 0.7577071, 'auroc': 0.95034635, 'binary_precision': 0.75352114, 'binary_recall': 0.4099617, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.53101736}
confusion matrix:
      0    1
0  5962   35
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_26.png
early stop counter: 3
val acc:0.9870157241821289, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 26,now: 2024-06-08 19:23:28.817959,epoch time: 0:16:04.352003,used: 7:03:45.996792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99511325, 'precision': 0.96181023, 'recall': 0.96302223, 'specificity': 0.96302223, 'f1': 0.96241534, 'auroc': 0.9989967, 'binary_precision': 0.9261017, 'binary_recall': 0.92862, 'binary_specificity': 0.9974244, 'binary_f1_score': 0.92735916}
confusion matrix:
       0     1
0  42212   109
1    105  1366
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9113796, 'recall': 0.84744275, 'specificity': 0.84744275, 'f1': 0.87650156, 'auroc': 0.98050547, 'binary_precision': 0.8333333, 'binary_recall': 0.6998445, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.76077765}
confusion matrix:
       0    1
0  18059   90
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.8999951, 'recall': 0.75237143, 'specificity': 0.75237143, 'f1': 0.80792946, 'auroc': 0.9574372, 'binary_precision': 0.82098764, 'binary_recall': 0.5095785, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.6288416}
confusion matrix:
      0    1
0  5968   29
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_27.png
early stop counter: 4
val acc:0.9849404096603394, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 27,now: 2024-06-08 19:39:38.516224,epoch time: 0:16:09.698265,used: 7:19:55.695057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947707, 'precision': 0.9721748, 'recall': 0.94578433, 'specificity': 0.94578433, 'f1': 0.95857155, 'auroc': 0.9985403, 'binary_precision': 0.9480519, 'binary_recall': 0.8932699, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.919846}
confusion matrix:
       0     1
0  42249    72
1    157  1314
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.9148315, 'recall': 0.8282782, 'specificity': 0.8282782, 'f1': 0.86611974, 'auroc': 0.9767971, 'binary_precision': 0.84158415, 'binary_recall': 0.66096425, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7404181}
confusion matrix:
       0    1
0  18069   80
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.83488715, 'recall': 0.66916215, 'specificity': 0.66916215, 'f1': 0.72211015, 'auroc': 0.9205324, 'binary_precision': 0.6976744, 'binary_recall': 0.3448276, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4615385}
confusion matrix:
      0   1
0  5958  39
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_28.png
early stop counter: 5
val acc:0.9841421842575073, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 28,now: 2024-06-08 19:55:45.800429,epoch time: 0:16:07.284205,used: 7:36:02.979262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99568415, 'precision': 0.9571487, 'recall': 0.97840977, 'specificity': 0.97840977, 'f1': 0.9675185, 'auroc': 0.9994769, 'binary_precision': 0.9156939, 'binary_recall': 0.95989126, 'binary_specificity': 0.9969282, 'binary_f1_score': 0.9372719}
confusion matrix:
       0     1
0  42191   130
1     59  1412
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9014331, 'recall': 0.8863568, 'specificity': 0.8863568, 'f1': 0.8937385, 'auroc': 0.9817697, 'binary_precision': 0.8106796, 'binary_recall': 0.7791602, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.7946075}
confusion matrix:
       0    1
0  18032  117
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8595913, 'recall': 0.71322346, 'specificity': 0.71322346, 'f1': 0.7658824, 'auroc': 0.9477328, 'binary_precision': 0.7434211, 'binary_recall': 0.4329502, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.54721546}
confusion matrix:
      0    1
0  5958   39
1   148  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_29.png
early stop counter: 6
val acc:0.9862175583839417, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 29,now: 2024-06-08 20:11:58.972293,epoch time: 0:16:13.171864,used: 7:52:16.151126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9949762, 'precision': 0.96105945, 'recall': 0.9616641, 'specificity': 0.9616641, 'f1': 0.9613615, 'auroc': 0.9987204, 'binary_precision': 0.9246947, 'binary_recall': 0.92595106, 'binary_specificity': 0.9973771, 'binary_f1_score': 0.9253224}
confusion matrix:
       0     1
0  42209   111
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.91922617, 'recall': 0.85852206, 'specificity': 0.85852206, 'f1': 0.8863164, 'auroc': 0.9829766, 'binary_precision': 0.84826326, 'binary_recall': 0.7216174, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7798319}
confusion matrix:
       0    1
0  18066   83
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.75310963, 'recall': 0.6161874, 'specificity': 0.6161874, 'f1': 0.65628606, 'auroc': 0.89453137, 'binary_precision': 0.53846157, 'binary_recall': 0.2413793, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.33333334}
confusion matrix:
      0   1
0  5943  54
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_30.png
early stop counter: 7
val acc:0.9860578775405884, best validation acc: 0.9876543283462524, corresponding to test acc:                         0.9651646018028259 / 0.9814637303352356
after epoch: 30,now: 2024-06-08 20:28:11.386495,epoch time: 0:16:12.414202,used: 8:08:28.565328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:08:28.565328 at 2024-06-08 20:28:11.386495
persisted model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.86202884, 'recall': 0.6227702, 'specificity': 0.6227702, 'f1': 0.6784038, 'auroc': 0.93900514, 'binary_precision': 0.75581396, 'binary_recall': 0.24904214, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.37463978}
confusion matrix:
      0   1
0  5976  21
1   196  65
oracle model performance metric: 

scalar performance:
{'acc': 0.98130393, 'precision': 0.8942672, 'recall': 0.8638141, 'specificity': 0.8638141, 'f1': 0.8783647, 'auroc': 0.952563, 'binary_precision': 0.8, 'binary_recall': 0.7356322, 'binary_specificity': 0.991996, 'binary_f1_score': 0.7664671}
confusion matrix:
      0    1
0  5949   48
1    69  192
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504642 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool | 462955 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 504642 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool | 462955 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |   2046 MiB |    938 TiB |    938 TiB |
|       from large pool | 455971 KiB |   2014 MiB |    925 TiB |    925 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2324 MiB |   2324 MiB |   2324 MiB |      0 B   |
|       from large pool |   2254 MiB |   2254 MiB |   2254 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 353469 KiB | 387189 KiB | 771793 GiB | 771793 GiB |
|       from large pool | 343957 KiB | 381636 KiB | 758802 GiB | 758802 GiB |
|       from small pool |   9512 KiB |  14571 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180479 K  |  180475 K  |
|       from large pool |     187    |     311    |   88163 K  |   88163 K  |
|       from small pool |    3301    |    6271    |   92315 K  |   92312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180479 K  |  180475 K  |
|       from large pool |     187    |     311    |   88163 K  |   88163 K  |
|       from small pool |    3301    |    6271    |   92315 K  |   92312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    2787    |   94637 K  |   94637 K  |
|       from large pool |      32    |      86    |   58712 K  |   58712 K  |
|       from small pool |      30    |    2755    |   35924 K  |   35924 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2014 MiB |    925 TiB |    925 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    838 MiB |   2324 MiB |   2324 MiB |   1486 MiB |
|       from large pool |    788 MiB |   2254 MiB |   2254 MiB |   1466 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB | 771794 GiB | 771794 GiB |
|       from large pool |      0 B   | 430097 KiB | 758802 GiB | 758802 GiB |
|       from small pool |      0 B   |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     128    |     128    |      68    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2787    |   94638 K  |   94638 K  |
|       from large pool |       0    |      86    |   58712 K  |   58712 K  |
|       from small pool |       0    |    2755    |   35926 K  |   35926 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2014 MiB |    925 TiB |    925 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    838 MiB |   2324 MiB |   2324 MiB |   1486 MiB |
|       from large pool |    788 MiB |   2254 MiB |   2254 MiB |   1466 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB | 771794 GiB | 771794 GiB |
|       from large pool |      0 B   | 430097 KiB | 758802 GiB | 758802 GiB |
|       from small pool |      0 B   |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     128    |     128    |      68    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2787    |   94638 K  |   94638 K  |
|       from large pool |       0    |      86    |   58712 K  |   58712 K  |
|       from small pool |       0    |    2755    |   35926 K  |   35926 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732

 Experiment start at: 2024-06-08 20:36:06.719182
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96944547, 'precision': 0.8522835, 'recall': 0.5547948, 'specificity': 0.5547948, 'f1': 0.58859956, 'auroc': 0.9636962, 'binary_precision': 0.73394495, 'binary_recall': 0.110957004, 'binary_specificity': 0.99863255, 'binary_f1_score': 0.19277109}
confusion matrix:
       0    1
0  42356   58
1   1282  160
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.8313645, 'recall': 0.58402693, 'specificity': 0.58402693, 'f1': 0.6287576, 'auroc': 0.9608526, 'binary_precision': 0.6927711, 'binary_recall': 0.17087667, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.27413586}
confusion matrix:
       0    1
0  18016   51
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.8373369, 'recall': 0.5283416, 'specificity': 0.5283416, 'f1': 0.5430354, 'auroc': 0.94877744, 'binary_precision': 0.71428573, 'binary_recall': 0.057692308, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5940   6
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 20:52:52.428640,epoch time: 0:16:45.709458,used: 0:16:45.709458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97763133, 'precision': 0.8379186, 'recall': 0.7857894, 'specificity': 0.7857894, 'f1': 0.8094875, 'auroc': 0.9699769, 'binary_precision': 0.69002473, 'binary_recall': 0.5804438, 'binary_specificity': 0.991135, 'binary_f1_score': 0.6305085}
confusion matrix:
       0    1
0  42038  376
1    605  837
---- Validation: 
scalar performance:
{'acc': 0.9734792, 'precision': 0.8413311, 'recall': 0.7230273, 'specificity': 0.7230273, 'f1': 0.7686874, 'auroc': 0.96479833, 'binary_precision': 0.702765, 'binary_recall': 0.45319465, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.55103886}
confusion matrix:
       0    1
0  17938  129
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8439081, 'recall': 0.5302647, 'specificity': 0.5302647, 'f1': 0.54643255, 'auroc': 0.9547891, 'binary_precision': 0.72727275, 'binary_recall': 0.06153846, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.11347518}
confusion matrix:
      0   1
0  5940   6
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-08 21:08:49.146120,epoch time: 0:15:56.717480,used: 0:32:42.426938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9756704, 'precision': 0.90645075, 'recall': 0.6608434, 'specificity': 0.6608434, 'f1': 0.7271589, 'auroc': 0.9755441, 'binary_precision': 0.83542037, 'binary_recall': 0.32385576, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.46676663}
confusion matrix:
       0    1
0  42322   92
1    975  467
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.9249004, 'recall': 0.6359818, 'specificity': 0.6359818, 'f1': 0.7013444, 'auroc': 0.97434735, 'binary_precision': 0.8761905, 'binary_recall': 0.27340266, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.41676104}
confusion matrix:
       0    1
0  18041   26
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7300162, 'recall': 0.5239068, 'specificity': 0.5239068, 'f1': 0.5347338, 'auroc': 0.95723706, 'binary_precision': 0.5, 'binary_recall': 0.05, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.09090909}
confusion matrix:
      0   1
0  5933  13
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_3.png
early stop counter: 1
val acc:0.9725186824798584, best validation acc: 0.9734792113304138, corresponding to test acc:                         0.9597163796424866 / 0.9597163796424866
after epoch: 3,now: 2024-06-08 21:24:47.706102,epoch time: 0:15:58.559982,used: 0:48:40.986920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9810288, 'precision': 0.8946775, 'recall': 0.77700937, 'specificity': 0.77700937, 'f1': 0.82476926, 'auroc': 0.9799216, 'binary_precision': 0.8041958, 'binary_recall': 0.5586398, 'binary_specificity': 0.995379, 'binary_f1_score': 0.6592957}
confusion matrix:
       0    1
0  42219  196
1    636  805
---- Validation: 
scalar performance:
{'acc': 0.98127, 'precision': 0.9056936, 'recall': 0.8007403, 'specificity': 0.8007403, 'f1': 0.8447814, 'auroc': 0.978619, 'binary_precision': 0.8259109, 'binary_recall': 0.6062407, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.6992288}
confusion matrix:
       0    1
0  17981   86
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9053589, 'recall': 0.53244, 'specificity': 0.53244, 'f1': 0.5505758, 'auroc': 0.9595896, 'binary_precision': 0.85, 'binary_recall': 0.06538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12142858}
confusion matrix:
      0   1
0  5943   3
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-08 21:40:53.814640,epoch time: 0:16:06.108538,used: 1:04:47.095458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9839703, 'precision': 0.8848132, 'recall': 0.8540473, 'specificity': 0.8540473, 'f1': 0.86873734, 'auroc': 0.9839207, 'binary_precision': 0.7792895, 'binary_recall': 0.7149792, 'binary_specificity': 0.9931155, 'binary_f1_score': 0.7457504}
confusion matrix:
       0     1
0  42122   292
1    411  1031
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.88219154, 'recall': 0.845419, 'specificity': 0.845419, 'f1': 0.8627924, 'auroc': 0.98090756, 'binary_precision': 0.77557755, 'binary_recall': 0.6983655, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.7349492}
confusion matrix:
       0    1
0  17931  136
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8387153, 'recall': 0.5887869, 'specificity': 0.5887869, 'f1': 0.6345739, 'auroc': 0.9640696, 'binary_precision': 0.7121212, 'binary_recall': 0.18076923, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.28834355}
confusion matrix:
      0   1
0  5927  19
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-08 21:56:50.701444,epoch time: 0:15:56.886804,used: 1:20:43.982262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98360544, 'precision': 0.86563873, 'recall': 0.88299954, 'specificity': 0.88299954, 'f1': 0.87410027, 'auroc': 0.9855907, 'binary_precision': 0.7389293, 'binary_recall': 0.77531207, 'binary_specificity': 0.990687, 'binary_f1_score': 0.7566836}
confusion matrix:
       0     1
0  42019   395
1    324  1118
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.86534345, 'recall': 0.89295876, 'specificity': 0.89295876, 'f1': 0.87859935, 'auroc': 0.98028445, 'binary_precision': 0.73829204, 'binary_recall': 0.79643387, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.76626164}
confusion matrix:
       0    1
0  17877  190
1    137  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8265243, 'recall': 0.57917154, 'specificity': 0.57917154, 'f1': 0.62104046, 'auroc': 0.9577673, 'binary_precision': 0.6885246, 'binary_recall': 0.16153847, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5927  19
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_6.png
better model found
persisted
after epoch: 6,now: 2024-06-08 22:13:08.901950,epoch time: 0:16:18.200506,used: 1:37:02.182768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_36_06_seed_1_21256732
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9855208, 'precision': 0.873491, 'recall': 0.91212577, 'specificity': 0.91212577, 'f1': 0.89177513, 'auroc': 0.98733217, 'binary_precision': 0.7526612, 'binary_recall': 0.8335645, 'binary_specificity': 0.990687, 'binary_f1_score': 0.7910497}
confusion matrix:
       0     1
0  42019   395
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.8697243, 'recall': 0.8734251, 'specificity': 0.8734251, 'f1': 0.8715646, 'auroc': 0.9825347, 'binary_precision': 0.74852943, 'binary_recall': 0.756315, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.75240207}
confusion matrix:
       0    1
0  17896  171
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.80168104, 'recall': 0.65181696, 'specificity': 0.65181696, 'f1': 0.699365, 'auroc': 0.9571501, 'binary_precision': 0.6328125, 'binary_recall': 0.31153846, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.41752577}
confusion matrix:
      0   1
0  5899  47
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256732_7.png
[Sat Jun  8 22:29:38 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/0.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 128 vs 0
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
