Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 03:42:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768

 Experiment start at: 2024-06-18 03:52:21.225880
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7205087, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6681833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.68765354, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 04:14:00.418203,epoch time: 0:21:39.192323,used: 0:21:39.192323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.83119637, 'recall': 0.5053521, 'specificity': 0.5053521, 'f1': 0.50220686, 'auroc': 0.85577416, 'binary_precision': 0.6956522, 'binary_recall': 0.010869565, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.021404682}
confusion matrix:
       0   1
0  42321   7
1   1456  16
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84181845, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8395713, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:32:02.742903,epoch time: 0:18:02.324700,used: 0:39:41.517023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662329, 'precision': 0.7288052, 'recall': 0.54712933, 'specificity': 0.54712933, 'f1': 0.5728785, 'auroc': 0.89120245, 'binary_precision': 0.4881356, 'binary_recall': 0.097826086, 'binary_specificity': 0.9964326, 'binary_f1_score': 0.16298811}
confusion matrix:
       0    1
0  42177  151
1   1328  144
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.76129514, 'recall': 0.5188891, 'specificity': 0.5188891, 'f1': 0.52769125, 'auroc': 0.8866155, 'binary_precision': 0.5555556, 'binary_recall': 0.038880248, 'binary_specificity': 0.998898, 'binary_f1_score': 0.072674416}
confusion matrix:
       0   1
0  18129  20
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.98060584, 'recall': 0.5363985, 'specificity': 0.5363985, 'f1': 0.5579683, 'auroc': 0.8706262, 'binary_precision': 1.0, 'binary_recall': 0.07279693, 'binary_specificity': 1.0, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5997   0
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 04:52:18.013082,epoch time: 0:20:15.270179,used: 0:59:56.787202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9669178, 'precision': 0.7480313, 'recall': 0.58158135, 'specificity': 0.58158135, 'f1': 0.6190481, 'auroc': 0.9036238, 'binary_precision': 0.5243129, 'binary_recall': 0.16847827, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.25501287}
confusion matrix:
       0    1
0  42103  225
1   1224  248
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7802589, 'recall': 0.5515823, 'specificity': 0.5515823, 'f1': 0.5812647, 'auroc': 0.8970746, 'binary_precision': 0.59130436, 'binary_recall': 0.10575428, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.17941955}
confusion matrix:
       0   1
0  18102  47
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.97039896, 'recall': 0.5784607, 'specificity': 0.5784607, 'f1': 0.62626576, 'auroc': 0.88134027, 'binary_precision': 0.97619045, 'binary_recall': 0.15708812, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27062705}
confusion matrix:
      0   1
0  5996   1
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 05:08:51.109214,epoch time: 0:16:33.096132,used: 1:16:29.883334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96666664, 'precision': 0.7417824, 'recall': 0.5889922, 'specificity': 0.5889922, 'f1': 0.62683636, 'auroc': 0.9095441, 'binary_precision': 0.51132077, 'binary_recall': 0.18410327, 'binary_specificity': 0.9938811, 'binary_f1_score': 0.27072927}
confusion matrix:
       0    1
0  42069  259
1   1201  271
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7907207, 'recall': 0.5539702, 'specificity': 0.5539702, 'f1': 0.5851667, 'auroc': 0.9065431, 'binary_precision': 0.61206895, 'binary_recall': 0.11041991, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.18708827}
confusion matrix:
       0   1
0  18104  45
1    572  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8831849, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_5.png
better model found
persisted
after epoch: 5,now: 2024-06-18 05:29:32.127215,epoch time: 0:20:41.018001,used: 1:37:10.901335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.7484783, 'recall': 0.6282558, 'specificity': 0.6282558, 'f1': 0.6673279, 'auroc': 0.9176259, 'binary_precision': 0.52208835, 'binary_recall': 0.26494566, 'binary_specificity': 0.9915659, 'binary_f1_score': 0.35150966}
confusion matrix:
       0    1
0  41971  357
1   1082  390
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.77598834, 'recall': 0.56744367, 'specificity': 0.56744367, 'f1': 0.6034095, 'auroc': 0.91434026, 'binary_precision': 0.5816994, 'binary_recall': 0.13841368, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.22361809}
confusion matrix:
       0   1
0  18085  64
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9717448, 'recall': 0.5861235, 'specificity': 0.5861235, 'f1': 0.6376929, 'auroc': 0.8879523, 'binary_precision': 0.9782609, 'binary_recall': 0.1724138, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2931596}
confusion matrix:
      0   1
0  5996   1
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_6.png
new oracle model saved
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9637264013290405 / 0.9653244018554688
after epoch: 6,now: 2024-06-18 05:50:45.745281,epoch time: 0:21:13.618066,used: 1:58:24.519401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.75737494, 'recall': 0.6005529, 'specificity': 0.6005529, 'f1': 0.6415502, 'auroc': 0.9206008, 'binary_precision': 0.54174066, 'binary_recall': 0.2072011, 'binary_specificity': 0.99390477, 'binary_f1_score': 0.2997543}
confusion matrix:
       0    1
0  42070  258
1   1167  305
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.78718865, 'recall': 0.55924815, 'specificity': 0.55924815, 'f1': 0.5926694, 'auroc': 0.91482085, 'binary_precision': 0.60465115, 'binary_recall': 0.121306375, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.20207253}
confusion matrix:
       0   1
0  18098  51
1    565  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.88894606, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_7.png
better model found
persisted
after epoch: 7,now: 2024-06-18 06:14:18.672186,epoch time: 0:23:32.926905,used: 2:21:57.446306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9680137, 'precision': 0.760113, 'recall': 0.64378625, 'specificity': 0.64378625, 'f1': 0.68360746, 'auroc': 0.9244435, 'binary_precision': 0.5443196, 'binary_recall': 0.29619566, 'binary_specificity': 0.9913769, 'binary_f1_score': 0.383634}
confusion matrix:
       0    1
0  41963  365
1   1036  436
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7852444, 'recall': 0.57060915, 'specificity': 0.57060915, 'f1': 0.60822296, 'auroc': 0.9196162, 'binary_precision': 0.6, 'binary_recall': 0.14463453, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.2330827}
confusion matrix:
       0   1
0  18087  62
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.88769597, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_8.png
better model found
persisted
after epoch: 8,now: 2024-06-18 06:37:59.457400,epoch time: 0:23:40.785214,used: 2:45:38.231520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9675799, 'precision': 0.7532618, 'recall': 0.6504469, 'specificity': 0.6504469, 'f1': 0.68747437, 'auroc': 0.92666507, 'binary_precision': 0.5301624, 'binary_recall': 0.31046197, 'binary_specificity': 0.99043185, 'binary_f1_score': 0.39160243}
confusion matrix:
       0    1
0  41923  405
1   1015  457
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7647961, 'recall': 0.5793619, 'specificity': 0.5793619, 'f1': 0.6179055, 'auroc': 0.9262303, 'binary_precision': 0.55851066, 'binary_recall': 0.16329704, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.25270757}
confusion matrix:
       0    1
0  18066   83
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.89345264, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_9.png
new oracle model saved
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.9659635424613953
after epoch: 9,now: 2024-06-18 06:56:57.440199,epoch time: 0:18:57.982799,used: 3:04:36.214319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9670091, 'precision': 0.74634635, 'recall': 0.62949634, 'specificity': 0.62949634, 'f1': 0.66798073, 'auroc': 0.9242418, 'binary_precision': 0.51773983, 'binary_recall': 0.26766303, 'binary_specificity': 0.9913296, 'binary_f1_score': 0.35288846}
confusion matrix:
       0    1
0  41961  367
1   1078  394
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.775189, 'recall': 0.5803048, 'specificity': 0.5803048, 'f1': 0.61997736, 'auroc': 0.92891586, 'binary_precision': 0.57923496, 'binary_recall': 0.16485226, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.25665858}
confusion matrix:
       0    1
0  18072   77
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.8957159, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_10.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9638862013816833 / 0.9659635424613953
after epoch: 10,now: 2024-06-18 07:20:49.702041,epoch time: 0:23:52.261842,used: 3:28:28.476161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9679452, 'precision': 0.7580651, 'recall': 0.6526031, 'specificity': 0.6526031, 'f1': 0.69047976, 'auroc': 0.92645454, 'binary_precision': 0.539627, 'binary_recall': 0.31453803, 'binary_specificity': 0.9906681, 'binary_f1_score': 0.39742488}
confusion matrix:
       0    1
0  41933  395
1   1009  463
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7750735, 'recall': 0.59544367, 'specificity': 0.59544367, 'f1': 0.63804966, 'auroc': 0.9324509, 'binary_precision': 0.57798165, 'binary_recall': 0.19595645, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.29268292}
confusion matrix:
       0    1
0  18057   92
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.96794975, 'recall': 0.5669664, 'specificity': 0.5669664, 'f1': 0.6085563, 'auroc': 0.8968265, 'binary_precision': 0.9722222, 'binary_recall': 0.13409962, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.23569024}
confusion matrix:
      0   1
0  5996   1
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_11.png
better model found
persisted
after epoch: 11,now: 2024-06-18 07:44:09.745577,epoch time: 0:23:20.043536,used: 3:51:48.519697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9687443, 'precision': 0.7671181, 'recall': 0.6667867, 'specificity': 0.6667867, 'f1': 0.704242, 'auroc': 0.9316862, 'binary_precision': 0.5567806, 'binary_recall': 0.34307066, 'binary_specificity': 0.9905027, 'binary_f1_score': 0.42454815}
confusion matrix:
       0    1
0  41926  402
1    967  505
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.77450716, 'recall': 0.60602707, 'specificity': 0.60602707, 'f1': 0.6497569, 'auroc': 0.9336591, 'binary_precision': 0.5761317, 'binary_recall': 0.21772939, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.3160271}
confusion matrix:
       0    1
0  18046  103
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.98269475, 'recall': 0.5881226, 'specificity': 0.5881226, 'f1': 0.64103216, 'auroc': 0.8951392, 'binary_precision': 1.0, 'binary_recall': 0.17624521, 'binary_specificity': 1.0, 'binary_f1_score': 0.29967427}
confusion matrix:
      0   1
0  5997   0
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_12.png
better model found
persisted
after epoch: 12,now: 2024-06-18 08:03:03.338501,epoch time: 0:18:53.592924,used: 4:10:42.112621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96892697, 'precision': 0.7723124, 'recall': 0.65311104, 'specificity': 0.65311104, 'f1': 0.69447213, 'auroc': 0.93372166, 'binary_precision': 0.5680982, 'binary_recall': 0.31453803, 'binary_specificity': 0.991684, 'binary_f1_score': 0.40489724}
confusion matrix:
       0    1
0  41976  352
1   1009  463
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7803592, 'recall': 0.6038871, 'specificity': 0.6038871, 'f1': 0.6481929, 'auroc': 0.9363912, 'binary_precision': 0.58798283, 'binary_recall': 0.21306376, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.3127854}
confusion matrix:
       0    1
0  18053   96
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.8969303, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_13.png
better model found
persisted
after epoch: 13,now: 2024-06-18 08:26:22.545314,epoch time: 0:23:19.206813,used: 4:34:01.319434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96888125, 'precision': 0.7733155, 'recall': 0.64432406, 'specificity': 0.64432406, 'f1': 0.6870949, 'auroc': 0.93494964, 'binary_precision': 0.5706806, 'binary_recall': 0.296397, 'binary_specificity': 0.99225116, 'binary_f1_score': 0.39015663}
confusion matrix:
       0    1
0  42001  328
1   1035  436
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.8007051, 'recall': 0.5868011, 'specificity': 0.5868011, 'f1': 0.6302429, 'auroc': 0.9356708, 'binary_precision': 0.62983423, 'binary_recall': 0.17729394, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.27669904}
confusion matrix:
       0    1
0  18082   67
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.8948649, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_14.png
better model found
persisted
after epoch: 14,now: 2024-06-18 08:49:25.657740,epoch time: 0:23:03.112426,used: 4:57:04.431860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96840185, 'precision': 0.76566255, 'recall': 0.64595425, 'specificity': 0.64595425, 'f1': 0.6867759, 'auroc': 0.935378, 'binary_precision': 0.5552764, 'binary_recall': 0.30027175, 'binary_specificity': 0.99163675, 'binary_f1_score': 0.38977075}
confusion matrix:
       0    1
0  41974  354
1   1030  442
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.7879673, 'recall': 0.5926638, 'specificity': 0.5926638, 'f1': 0.63619936, 'auroc': 0.9375568, 'binary_precision': 0.6039604, 'binary_recall': 0.18973562, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.28875738}
confusion matrix:
       0    1
0  18069   80
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8967633, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_15.png
early stop counter: 1
val acc:0.9680182933807373, best validation acc: 0.9682843685150146, corresponding to test acc:                         0.9626078605651855 / 0.9659635424613953
after epoch: 15,now: 2024-06-18 09:11:54.710398,epoch time: 0:22:29.052658,used: 5:19:33.484518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9699315, 'precision': 0.78425384, 'recall': 0.66674525, 'specificity': 0.66674525, 'f1': 0.7088084, 'auroc': 0.9392756, 'binary_precision': 0.59106934, 'binary_recall': 0.34171197, 'binary_specificity': 0.9917785, 'binary_f1_score': 0.43306068}
confusion matrix:
       0    1
0  41980  348
1    969  503
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7973946, 'recall': 0.5966345, 'specificity': 0.5966345, 'f1': 0.6418701, 'auroc': 0.9380125, 'binary_precision': 0.622549, 'binary_recall': 0.19751166, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.29988194}
confusion matrix:
       0    1
0  18072   77
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8943347, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_16.png
better model found
persisted
after epoch: 16,now: 2024-06-18 09:39:54.836390,epoch time: 0:28:00.125992,used: 5:47:33.610510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97, 'precision': 0.7828982, 'recall': 0.67530507, 'specificity': 0.67530507, 'f1': 0.71530986, 'auroc': 0.9385848, 'binary_precision': 0.5877778, 'binary_recall': 0.359375, 'binary_specificity': 0.99123514, 'binary_f1_score': 0.4460371}
confusion matrix:
       0    1
0  41957  371
1    943  529
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.8002807, 'recall': 0.6027727, 'specificity': 0.6027727, 'f1': 0.6493374, 'auroc': 0.93864775, 'binary_precision': 0.627907, 'binary_recall': 0.20995334, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.3146853}
confusion matrix:
       0    1
0  18069   80
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89436054, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 10:01:24.705891,epoch time: 0:21:29.869501,used: 6:09:03.480011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96908677, 'precision': 0.77292496, 'recall': 0.66139024, 'specificity': 0.66139024, 'f1': 0.70150256, 'auroc': 0.9349649, 'binary_precision': 0.56876457, 'binary_recall': 0.33152175, 'binary_specificity': 0.99125874, 'binary_f1_score': 0.41888413}
confusion matrix:
       0    1
0  41958  370
1    984  488
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.8138684, 'recall': 0.601493, 'specificity': 0.601493, 'f1': 0.64931667, 'auroc': 0.93941045, 'binary_precision': 0.6551724, 'binary_recall': 0.20684293, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.3144208}
confusion matrix:
       0    1
0  18079   70
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.892836, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_18.png
better model found
persisted
after epoch: 18,now: 2024-06-18 10:23:27.274137,epoch time: 0:22:02.568246,used: 6:31:06.048257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.7895501, 'recall': 0.670355, 'specificity': 0.670355, 'f1': 0.7131295, 'auroc': 0.938359, 'binary_precision': 0.6014068, 'binary_recall': 0.34874237, 'binary_specificity': 0.9919677, 'binary_f1_score': 0.44148022}
confusion matrix:
       0    1
0  41989  340
1    958  513
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.8205745, 'recall': 0.60618615, 'specificity': 0.60618615, 'f1': 0.6555377, 'auroc': 0.94271123, 'binary_precision': 0.6682692, 'binary_recall': 0.21617419, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.3266745}
confusion matrix:
       0    1
0  18080   69
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.98060584, 'recall': 0.5363985, 'specificity': 0.5363985, 'f1': 0.5579683, 'auroc': 0.89600754, 'binary_precision': 1.0, 'binary_recall': 0.07279693, 'binary_specificity': 1.0, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5997   0
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_19.png
better model found
persisted
after epoch: 19,now: 2024-06-18 10:43:40.313299,epoch time: 0:20:13.039162,used: 6:51:19.087419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9701142, 'precision': 0.7816292, 'recall': 0.6868393, 'specificity': 0.6868393, 'f1': 0.72374684, 'auroc': 0.9391776, 'binary_precision': 0.58445597, 'binary_recall': 0.3831522, 'binary_specificity': 0.9905264, 'binary_f1_score': 0.4628642}
confusion matrix:
       0    1
0  41927  401
1    908  564
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.80234945, 'recall': 0.6096609, 'specificity': 0.6096609, 'f1': 0.65738726, 'auroc': 0.9414762, 'binary_precision': 0.6315789, 'binary_recall': 0.22395024, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.3306544}
confusion matrix:
       0    1
0  18065   84
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8928932, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_20.png
early stop counter: 1
val acc:0.9689761400222778, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 20,now: 2024-06-18 11:07:13.010769,epoch time: 0:23:32.697470,used: 7:14:51.784889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9708676, 'precision': 0.79198444, 'recall': 0.6872291, 'specificity': 0.6872291, 'f1': 0.7271204, 'auroc': 0.9351231, 'binary_precision': 0.6051502, 'binary_recall': 0.3831522, 'binary_specificity': 0.991306, 'binary_f1_score': 0.469218}
confusion matrix:
       0    1
0  41960  368
1    908  564
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8016619, 'recall': 0.62029946, 'specificity': 0.62029946, 'f1': 0.668857, 'auroc': 0.9430587, 'binary_precision': 0.6294821, 'binary_recall': 0.24572317, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.35346755}
confusion matrix:
       0    1
0  18056   93
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8952941, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_21.png
early stop counter: 2
val acc:0.9692422151565552, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 21,now: 2024-06-18 11:40:07.339243,epoch time: 0:32:54.328474,used: 7:47:46.113363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97077626, 'precision': 0.79481053, 'recall': 0.67384857, 'specificity': 0.67384857, 'f1': 0.7173443, 'auroc': 0.9376606, 'binary_precision': 0.6116959, 'binary_recall': 0.35554045, 'binary_specificity': 0.9921567, 'binary_f1_score': 0.44969904}
confusion matrix:
       0    1
0  41997  332
1    948  523
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.80494857, 'recall': 0.62113214, 'specificity': 0.62113214, 'f1': 0.6702158, 'auroc': 0.94415677, 'binary_precision': 0.636, 'binary_recall': 0.24727838, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.356103}
confusion matrix:
       0    1
0  18058   91
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.8962481, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_22.png
early stop counter: 3
val acc:0.9694018959999084, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 22,now: 2024-06-18 12:14:17.058413,epoch time: 0:34:09.719170,used: 8:21:55.832533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97034246, 'precision': 0.7868204, 'recall': 0.6790887, 'specificity': 0.6790887, 'f1': 0.71936476, 'auroc': 0.9427972, 'binary_precision': 0.59536934, 'binary_recall': 0.3668478, 'binary_specificity': 0.9913296, 'binary_f1_score': 0.45397225}
confusion matrix:
       0    1
0  41961  367
1    932  540
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.8090227, 'recall': 0.6280755, 'specificity': 0.6280755, 'f1': 0.6780981, 'auroc': 0.9426378, 'binary_precision': 0.6436782, 'binary_recall': 0.26127526, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.3716814}
confusion matrix:
       0    1
0  18056   93
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.89730847, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_23.png
better model found
persisted
after epoch: 23,now: 2024-06-18 12:43:07.068480,epoch time: 0:28:50.010067,used: 8:50:45.842600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.79086256, 'recall': 0.6855307, 'specificity': 0.6855307, 'f1': 0.7254963, 'auroc': 0.9405014, 'binary_precision': 0.6030205, 'binary_recall': 0.37975544, 'binary_specificity': 0.991306, 'binary_f1_score': 0.46602753}
confusion matrix:
       0    1
0  41960  368
1    913  559
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.81181717, 'recall': 0.6311859, 'specificity': 0.6311859, 'f1': 0.6817384, 'auroc': 0.94580555, 'binary_precision': 0.6490566, 'binary_recall': 0.2674961, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.37885463}
confusion matrix:
       0    1
0  18056   93
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.96532273, 'recall': 0.5573879, 'specificity': 0.5573879, 'f1': 0.5932502, 'auroc': 0.8981209, 'binary_precision': 0.9677419, 'binary_recall': 0.11494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5996   1
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_24.png
better model found
persisted
after epoch: 24,now: 2024-06-18 13:08:27.267491,epoch time: 0:25:20.199011,used: 9:16:06.041611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.7823373, 'recall': 0.6623767, 'specificity': 0.6623767, 'f1': 0.704716, 'auroc': 0.94321495, 'binary_precision': 0.58752996, 'binary_recall': 0.33288044, 'binary_specificity': 0.99187297, 'binary_f1_score': 0.42497832}
confusion matrix:
       0    1
0  41984  344
1    982  490
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.81850994, 'recall': 0.6130193, 'specificity': 0.6130193, 'f1': 0.6631388, 'auroc': 0.943169, 'binary_precision': 0.66367716, 'binary_recall': 0.23017107, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.34180138}
confusion matrix:
       0    1
0  18074   75
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8950494, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_25.png
early stop counter: 1
val acc:0.9696679711341858, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9629274606704712 / 0.9659635424613953
after epoch: 25,now: 2024-06-18 13:31:46.536694,epoch time: 0:23:19.269203,used: 9:39:25.310814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97091323, 'precision': 0.7926357, 'recall': 0.6872527, 'specificity': 0.6872527, 'f1': 0.72732764, 'auroc': 0.9413854, 'binary_precision': 0.60645163, 'binary_recall': 0.3831522, 'binary_specificity': 0.9913532, 'binary_f1_score': 0.46960866}
confusion matrix:
       0    1
0  41962  366
1    908  564
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.81277245, 'recall': 0.6212975, 'specificity': 0.6212975, 'f1': 0.67150325, 'auroc': 0.9440638, 'binary_precision': 0.65163934, 'binary_recall': 0.24727838, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.3585118}
confusion matrix:
       0    1
0  18064   85
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8984323, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_26.png
early stop counter: 2
val acc:0.9697211384773254, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9629274606704712 / 0.9659635424613953
after epoch: 26,now: 2024-06-18 13:56:46.132568,epoch time: 0:24:59.595874,used: 10:04:24.906688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9704338, 'precision': 0.78537863, 'recall': 0.68810743, 'specificity': 0.68810743, 'f1': 0.7258271, 'auroc': 0.944082, 'binary_precision': 0.591858, 'binary_recall': 0.38545206, 'binary_specificity': 0.9907628, 'binary_f1_score': 0.4668588}
confusion matrix:
       0    1
0  41938  391
1    904  567
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.80765414, 'recall': 0.6173819, 'specificity': 0.6173819, 'f1': 0.66657186, 'auroc': 0.94550717, 'binary_precision': 0.64166665, 'binary_recall': 0.23950233, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.34881085}
confusion matrix:
       0    1
0  18063   86
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8950505, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_27.png
early stop counter: 3
val acc:0.9694018959999084, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9629274606704712 / 0.9659635424613953
after epoch: 27,now: 2024-06-18 14:24:17.100934,epoch time: 0:27:30.968366,used: 10:31:55.875054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7835963, 'recall': 0.69518936, 'specificity': 0.69518936, 'f1': 0.73046374, 'auroc': 0.9440788, 'binary_precision': 0.58782434, 'binary_recall': 0.40013587, 'binary_specificity': 0.99024284, 'binary_f1_score': 0.476152}
confusion matrix:
       0    1
0  41915  413
1    883  589
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.81403464, 'recall': 0.6281857, 'specificity': 0.6281857, 'f1': 0.6789794, 'auroc': 0.9457912, 'binary_precision': 0.6536965, 'binary_recall': 0.26127526, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.37333333}
confusion matrix:
       0    1
0  18060   89
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8982628, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_28.png
early stop counter: 4
val acc:0.9699872136116028, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9629274606704712 / 0.9659635424613953
after epoch: 28,now: 2024-06-18 14:45:40.403402,epoch time: 0:21:23.302468,used: 10:53:19.177522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9711416, 'precision': 0.7892531, 'recall': 0.7103211, 'specificity': 0.7103211, 'f1': 0.7429656, 'auroc': 0.94317544, 'binary_precision': 0.5981132, 'binary_recall': 0.43070653, 'binary_specificity': 0.98993576, 'binary_f1_score': 0.5007899}
confusion matrix:
       0    1
0  41902  426
1    838  634
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.8089231, 'recall': 0.63721395, 'specificity': 0.63721395, 'f1': 0.68733776, 'auroc': 0.9477337, 'binary_precision': 0.64285713, 'binary_recall': 0.2799378, 'binary_specificity': 0.99449, 'binary_f1_score': 0.3900325}
confusion matrix:
       0    1
0  18049  100
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.96925056, 'recall': 0.57271355, 'specificity': 0.57271355, 'f1': 0.61749834, 'auroc': 0.89831984, 'binary_precision': 0.974359, 'binary_recall': 0.14559387, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25333333}
confusion matrix:
      0   1
0  5996   1
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_29.png
better model found
persisted
after epoch: 29,now: 2024-06-18 15:26:12.264525,epoch time: 0:40:31.861123,used: 11:33:51.038645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9715525, 'precision': 0.8003258, 'recall': 0.69217354, 'specificity': 0.69217354, 'f1': 0.7333204, 'auroc': 0.9448332, 'binary_precision': 0.6215054, 'binary_recall': 0.39266303, 'binary_specificity': 0.991684, 'binary_f1_score': 0.48126563}
confusion matrix:
       0    1
0  41976  352
1    894  578
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.82031584, 'recall': 0.6222128, 'specificity': 0.6222128, 'f1': 0.6735304, 'auroc': 0.9451669, 'binary_precision': 0.6666667, 'binary_recall': 0.2488336, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.36240092}
confusion matrix:
       0    1
0  18069   80
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.89404887, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21403768_30.png
early stop counter: 1
val acc:0.9700404405593872, best validation acc: 0.9700404405593872, corresponding to test acc:                         0.964205801486969 / 0.9659635424613953
after epoch: 30,now: 2024-06-18 16:04:48.042674,epoch time: 0:38:35.778149,used: 12:12:26.816794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_52_21_seed_0_21403768
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:12:26.816794 at 2024-06-18 16:04:48.042674
persisted model performance metric: 

scalar performance:
{'acc': 0.9642058, 'precision': 0.96925056, 'recall': 0.57271355, 'specificity': 0.57271355, 'f1': 0.61749834, 'auroc': 0.89831984, 'binary_precision': 0.974359, 'binary_recall': 0.14559387, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25333333}
confusion matrix:
      0   1
0  5996   1
1   223  38
oracle model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.89345264, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404885 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404885 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404936 GiB | 404936 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404864 GiB | 404864 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302188 GiB | 302188 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302106 GiB | 302106 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13356 K  |   13354 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8043 K  |    8042 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13356 K  |   13354 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8043 K  |    8042 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7142 K  |    7142 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      30    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404885 GiB | 404885 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404959 GiB | 404959 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404885 GiB | 404885 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404936 GiB | 404936 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404864 GiB | 404864 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302188 GiB | 302188 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302106 GiB | 302106 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13356 K  |   13356 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8043 K  |    8043 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13356 K  |   13356 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8043 K  |    8043 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 18 16:05:32 2024]
Finished job 0.
1 of 1 steps (100%) done
