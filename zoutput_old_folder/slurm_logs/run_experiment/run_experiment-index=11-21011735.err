Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 09:50:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735

 Experiment start at: 2024-05-31 10:01:40.490781
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.75211513, 'recall': 0.52439684, 'specificity': 0.52439684, 'f1': 0.53749466, 'auroc': 0.8896965, 'binary_precision': 0.5362319, 'binary_recall': 0.050305914, 'binary_specificity': 0.9984878, 'binary_f1_score': 0.0919826}
confusion matrix:
       0   1
0  42257  64
1   1397  74
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.70450884, 'recall': 0.52525395, 'specificity': 0.52525395, 'f1': 0.5383789, 'auroc': 0.885705, 'binary_precision': 0.44155845, 'binary_recall': 0.05287714, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.09444445}
confusion matrix:
       0   1
0  18106  43
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88809395, 'recall': 0.5815417, 'specificity': 0.5815417, 'f1': 0.62759995, 'auroc': 0.88611114, 'binary_precision': 0.8113208, 'binary_recall': 0.16475096, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.27388537}
confusion matrix:
      0   1
0  5987  10
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 10:29:08.109653,epoch time: 0:27:27.618872,used: 0:27:27.618872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.72923857, 'recall': 0.6027233, 'specificity': 0.6027233, 'f1': 0.6394602, 'auroc': 0.9206432, 'binary_precision': 0.48531684, 'binary_recall': 0.21331522, 'binary_specificity': 0.99213135, 'binary_f1_score': 0.2963662}
confusion matrix:
       0    1
0  41987  333
1   1158  314
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.72814375, 'recall': 0.61520547, 'specificity': 0.61520547, 'f1': 0.6511541, 'auroc': 0.9220662, 'binary_precision': 0.4827586, 'binary_recall': 0.23950233, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.32016632}
confusion matrix:
       0    1
0  17984  165
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.89446497, 'recall': 0.77869105, 'specificity': 0.77869105, 'f1': 0.82565767, 'auroc': 0.90015566, 'binary_precision': 0.8076923, 'binary_recall': 0.5632184, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.66365695}
confusion matrix:
      0    1
0  5962   35
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
early stop counter: 1
val acc:0.9651979804039001, best validation acc: 0.9653043746948242, corresponding to test acc:                         0.9635666608810425 / 0.976190447807312
after epoch: 2,now: 2024-05-31 10:54:35.866361,epoch time: 0:25:27.756708,used: 0:52:55.375580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.738358, 'recall': 0.6817148, 'specificity': 0.6817148, 'f1': 0.7058029, 'auroc': 0.92744315, 'binary_precision': 0.49820143, 'binary_recall': 0.37661454, 'binary_specificity': 0.98681504, 'binary_f1_score': 0.4289586}
confusion matrix:
       0    1
0  41763  558
1    917  554
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74325836, 'recall': 0.7124585, 'specificity': 0.7124585, 'f1': 0.72670037, 'auroc': 0.92686975, 'binary_precision': 0.50626117, 'binary_recall': 0.44012442, 'binary_specificity': 0.98479253, 'binary_f1_score': 0.47088182}
confusion matrix:
       0    1
0  17873  276
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.896064, 'recall': 0.79768145, 'specificity': 0.79768145, 'f1': 0.8392097, 'auroc': 0.9200858, 'binary_precision': 0.80927837, 'binary_recall': 0.6015326, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6901099}
confusion matrix:
      0    1
0  5960   37
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-31 11:20:03.997175,epoch time: 0:25:28.130814,used: 1:18:23.506394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96723145, 'precision': 0.7478112, 'recall': 0.74829865, 'specificity': 0.74829865, 'f1': 0.74805474, 'auroc': 0.9339205, 'binary_precision': 0.51254237, 'binary_recall': 0.51358694, 'binary_specificity': 0.9830104, 'binary_f1_score': 0.51306415}
confusion matrix:
       0    1
0  41601  719
1    716  756
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.73893845, 'recall': 0.7667717, 'specificity': 0.7667717, 'f1': 0.7519965, 'auroc': 0.9289448, 'binary_precision': 0.49375868, 'binary_recall': 0.55365473, 'binary_specificity': 0.9798887, 'binary_f1_score': 0.5219941}
confusion matrix:
       0    1
0  17784  365
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.87286973, 'recall': 0.8136722, 'specificity': 0.8136722, 'f1': 0.84044915, 'auroc': 0.91241467, 'binary_precision': 0.7614679, 'binary_recall': 0.6360153, 'binary_specificity': 0.991329, 'binary_f1_score': 0.69311064}
confusion matrix:
      0    1
0  5945   52
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 1
val acc:0.9653043746948242, best validation acc: 0.9661558270454407, corresponding to test acc:                         0.9774688482284546 / 0.9774688482284546
after epoch: 4,now: 2024-05-31 11:45:41.423047,epoch time: 0:25:37.425872,used: 1:44:00.932266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9682362, 'precision': 0.7555108, 'recall': 0.74963766, 'specificity': 0.74963766, 'f1': 0.7525363, 'auroc': 0.93745965, 'binary_precision': 0.52785516, 'binary_recall': 0.51529574, 'binary_specificity': 0.9839796, 'binary_f1_score': 0.5214998}
confusion matrix:
       0    1
0  41643  678
1    713  758
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7454026, 'recall': 0.7567944, 'specificity': 0.7567944, 'f1': 0.75095415, 'auroc': 0.9314195, 'binary_precision': 0.5074184, 'binary_recall': 0.5318818, 'binary_specificity': 0.981707, 'binary_f1_score': 0.5193622}
confusion matrix:
       0    1
0  17817  332
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8866739, 'recall': 0.8180872, 'specificity': 0.8180872, 'f1': 0.84870046, 'auroc': 0.9116014, 'binary_precision': 0.7887324, 'binary_recall': 0.6436782, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.70886075}
confusion matrix:
      0    1
0  5952   45
1    93  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-31 12:11:30.774080,epoch time: 0:25:49.351033,used: 2:09:50.283299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.7587668, 'recall': 0.75689983, 'specificity': 0.75689983, 'f1': 0.7578295, 'auroc': 0.9412709, 'binary_precision': 0.5338809, 'binary_recall': 0.5298913, 'binary_specificity': 0.9839083, 'binary_f1_score': 0.5318786}
confusion matrix:
       0    1
0  41639  681
1    692  780
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7453251, 'recall': 0.7530441, 'specificity': 0.7530441, 'f1': 0.74911785, 'auroc': 0.9367379, 'binary_precision': 0.5075301, 'binary_recall': 0.5241057, 'binary_specificity': 0.98198247, 'binary_f1_score': 0.5156848}
confusion matrix:
       0    1
0  17822  327
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.8837278, 'recall': 0.80850863, 'specificity': 0.80850863, 'f1': 0.8416129, 'auroc': 0.9280389, 'binary_precision': 0.78365386, 'binary_recall': 0.6245211, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6950959}
confusion matrix:
      0    1
0  5952   45
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 6,now: 2024-05-31 12:38:20.413040,epoch time: 0:26:49.638960,used: 2:36:39.922259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96729994, 'precision': 0.7489453, 'recall': 0.799808, 'specificity': 0.799808, 'f1': 0.77174246, 'auroc': 0.94910324, 'binary_precision': 0.5111982, 'binary_recall': 0.62024456, 'binary_specificity': 0.9793714, 'binary_f1_score': 0.5604665}
confusion matrix:
       0    1
0  41447  873
1    559  913
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7427658, 'recall': 0.80371726, 'specificity': 0.80371726, 'f1': 0.7694242, 'auroc': 0.9402932, 'binary_precision': 0.49876848, 'binary_recall': 0.62986004, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.55670106}
confusion matrix:
       0    1
0  17742  407
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.8652011, 'recall': 0.83024657, 'specificity': 0.83024657, 'f1': 0.8467494, 'auroc': 0.931062, 'binary_precision': 0.7446808, 'binary_recall': 0.6704981, 'binary_specificity': 0.989995, 'binary_f1_score': 0.70564514}
confusion matrix:
      0    1
0  5937   60
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 7,now: 2024-05-31 13:03:52.699461,epoch time: 0:25:32.286421,used: 3:02:12.208680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96951497, 'precision': 0.76386, 'recall': 0.7953804, 'specificity': 0.7953804, 'f1': 0.7786332, 'auroc': 0.9498356, 'binary_precision': 0.5413897, 'binary_recall': 0.6086956, 'binary_specificity': 0.9820652, 'binary_f1_score': 0.5730732}
confusion matrix:
       0    1
0  41561  759
1    576  896
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7485968, 'recall': 0.77126586, 'specificity': 0.77126586, 'f1': 0.75937915, 'auroc': 0.9438608, 'binary_precision': 0.51278406, 'binary_recall': 0.5614308, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.53600585}
confusion matrix:
       0    1
0  17806  343
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.88232887, 'recall': 0.83865976, 'specificity': 0.83865976, 'f1': 0.859032, 'auroc': 0.9352077, 'binary_precision': 0.7782609, 'binary_recall': 0.68582374, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.72912425}
confusion matrix:
      0    1
0  5946   51
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-31 13:29:04.134494,epoch time: 0:25:11.435033,used: 3:27:23.643713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.745638, 'recall': 0.8073813, 'specificity': 0.8073813, 'f1': 0.77265036, 'auroc': 0.9540818, 'binary_precision': 0.5040344, 'binary_recall': 0.63654894, 'binary_specificity': 0.9782136, 'binary_f1_score': 0.5625938}
confusion matrix:
       0    1
0  41398  922
1    535  937
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.74378896, 'recall': 0.8150232, 'specificity': 0.8150232, 'f1': 0.7743041, 'auroc': 0.94527805, 'binary_precision': 0.5, 'binary_recall': 0.65318817, 'binary_specificity': 0.97685826, 'binary_f1_score': 0.56641936}
confusion matrix:
       0    1
0  17729  420
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.85232675, 'recall': 0.8445717, 'specificity': 0.8445717, 'f1': 0.8484012, 'auroc': 0.941226, 'binary_precision': 0.7176471, 'binary_recall': 0.7011494, 'binary_specificity': 0.987994, 'binary_f1_score': 0.7093023}
confusion matrix:
      0    1
0  5925   72
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 9,now: 2024-05-31 13:54:04.842878,epoch time: 0:25:00.708384,used: 3:52:24.352097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9686016, 'precision': 0.75735784, 'recall': 0.80212075, 'specificity': 0.80212075, 'f1': 0.77774394, 'auroc': 0.95302117, 'binary_precision': 0.5278896, 'binary_recall': 0.6236413, 'binary_specificity': 0.9806002, 'binary_f1_score': 0.5717845}
confusion matrix:
       0    1
0  41499  821
1    554  918
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.74221593, 'recall': 0.8126353, 'specificity': 0.8126353, 'f1': 0.7724019, 'auroc': 0.9485412, 'binary_precision': 0.49702027, 'binary_recall': 0.64852256, 'binary_specificity': 0.97674805, 'binary_f1_score': 0.562753}
confusion matrix:
       0    1
0  17727  422
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.86546326, 'recall': 0.8547339, 'specificity': 0.8547339, 'f1': 0.8600097, 'auroc': 0.94037247, 'binary_precision': 0.743083, 'binary_recall': 0.7203065, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.7315175}
confusion matrix:
      0    1
0  5932   65
1    73  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.9655172228813171, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 10,now: 2024-05-31 14:19:02.009383,epoch time: 0:24:57.166505,used: 4:17:21.518602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96876144, 'precision': 0.75975084, 'recall': 0.7553196, 'specificity': 0.7553196, 'f1': 0.757514, 'auroc': 0.95158803, 'binary_precision': 0.5359613, 'binary_recall': 0.52649456, 'binary_specificity': 0.9841446, 'binary_f1_score': 0.5311857}
confusion matrix:
       0    1
0  41649  671
1    697  775
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.74150664, 'recall': 0.79538405, 'specificity': 0.79538405, 'f1': 0.7654101, 'auroc': 0.9477183, 'binary_precision': 0.49684742, 'binary_recall': 0.61275274, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.5487465}
confusion matrix:
       0    1
0  17750  399
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9745925, 'precision': 0.8672383, 'recall': 0.787019, 'specificity': 0.787019, 'f1': 0.82169783, 'auroc': 0.9395336, 'binary_precision': 0.75247526, 'binary_recall': 0.58237547, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6565874}
confusion matrix:
      0    1
0  5947   50
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 3
val acc:0.9655172228813171, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 11,now: 2024-05-31 14:43:48.132742,epoch time: 0:24:46.123359,used: 4:42:07.641961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.75346637, 'recall': 0.8027972, 'specificity': 0.8027972, 'f1': 0.77569073, 'auroc': 0.95699126, 'binary_precision': 0.52004516, 'binary_recall': 0.6256794, 'binary_specificity': 0.97991496, 'binary_f1_score': 0.56799257}
confusion matrix:
       0    1
0  41470  850
1    551  921
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7442727, 'recall': 0.8203012, 'specificity': 0.8203012, 'f1': 0.7765329, 'auroc': 0.9509237, 'binary_precision': 0.50058615, 'binary_recall': 0.66407466, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.5708556}
confusion matrix:
       0    1
0  17723  426
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97299457, 'precision': 0.8417054, 'recall': 0.8026762, 'specificity': 0.8026762, 'f1': 0.82087517, 'auroc': 0.94435847, 'binary_precision': 0.7, 'binary_recall': 0.61685824, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.65580446}
confusion matrix:
      0    1
0  5928   69
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 4
val acc:0.9658365249633789, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 12,now: 2024-05-31 15:08:46.781160,epoch time: 0:24:58.648418,used: 5:07:06.290379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.74589264, 'recall': 0.79104733, 'specificity': 0.79104733, 'f1': 0.7663473, 'auroc': 0.95855176, 'binary_precision': 0.50570124, 'binary_recall': 0.6025815, 'binary_specificity': 0.9795132, 'binary_f1_score': 0.54990697}
confusion matrix:
       0    1
0  41453  867
1    585  887
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7486551, 'recall': 0.79899037, 'specificity': 0.79899037, 'f1': 0.77123195, 'auroc': 0.95428264, 'binary_precision': 0.5109114, 'binary_recall': 0.61897355, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.55977494}
confusion matrix:
       0    1
0  17768  381
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.83886546, 'recall': 0.78002125, 'specificity': 0.78002125, 'f1': 0.8063343, 'auroc': 0.93032265, 'binary_precision': 0.6962617, 'binary_recall': 0.57088125, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.6273684}
confusion matrix:
      0    1
0  5932   65
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 5
val acc:0.9666879773139954, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 13,now: 2024-05-31 15:33:30.813038,epoch time: 0:24:44.031878,used: 5:31:50.322257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7413441, 'recall': 0.81528103, 'specificity': 0.81528103, 'f1': 0.7728021, 'auroc': 0.9582517, 'binary_precision': 0.49485067, 'binary_recall': 0.6537415, 'binary_specificity': 0.9768206, 'binary_f1_score': 0.56330603}
confusion matrix:
       0    1
0  41341  981
1    509  961
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7403338, 'recall': 0.8221656, 'specificity': 0.8221656, 'f1': 0.7745472, 'auroc': 0.9533896, 'binary_precision': 0.4925544, 'binary_recall': 0.6687403, 'binary_specificity': 0.97559094, 'binary_f1_score': 0.5672823}
confusion matrix:
       0    1
0  17706  443
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7457954, 'recall': 0.7186314, 'specificity': 0.7186314, 'f1': 0.7313077, 'auroc': 0.92542636, 'binary_precision': 0.5151515, 'binary_recall': 0.4559387, 'binary_specificity': 0.981324, 'binary_f1_score': 0.48373982}
confusion matrix:
      0    1
0  5885  112
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 6
val acc:0.9650915265083313, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 14,now: 2024-05-31 15:58:28.070626,epoch time: 0:24:57.257588,used: 5:56:47.579845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.7463889, 'recall': 0.81934154, 'specificity': 0.81934154, 'f1': 0.7775955, 'auroc': 0.961873, 'binary_precision': 0.5046729, 'binary_recall': 0.6612245, 'binary_specificity': 0.97745854, 'binary_f1_score': 0.5724381}
confusion matrix:
       0    1
0  41368  954
1    498  972
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74568117, 'recall': 0.8181887, 'specificity': 0.8181887, 'f1': 0.77669895, 'auroc': 0.95534, 'binary_precision': 0.5035629, 'binary_recall': 0.65940905, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.5710438}
confusion matrix:
       0    1
0  17731  418
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8154089, 'recall': 0.74886966, 'specificity': 0.74886966, 'f1': 0.7777649, 'auroc': 0.936113, 'binary_precision': 0.6519608, 'binary_recall': 0.5095785, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.572043}
confusion matrix:
      0    1
0  5926   71
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 7
val acc:0.9661026000976562, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 15,now: 2024-05-31 16:23:56.464149,epoch time: 0:25:28.393523,used: 6:22:15.973368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96882993, 'precision': 0.7585988, 'recall': 0.82027113, 'specificity': 0.82027113, 'f1': 0.7857702, 'auroc': 0.96101415, 'binary_precision': 0.5290919, 'binary_recall': 0.66100544, 'binary_specificity': 0.9795369, 'binary_f1_score': 0.5877378}
confusion matrix:
       0    1
0  41454  866
1    499  973
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7494113, 'recall': 0.8230196, 'specificity': 0.8230196, 'f1': 0.7809056, 'auroc': 0.95386285, 'binary_precision': 0.51068884, 'binary_recall': 0.6687403, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.5791246}
confusion matrix:
       0    1
0  17737  412
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.7978409, 'recall': 0.6958134, 'specificity': 0.6958134, 'f1': 0.7350846, 'auroc': 0.92955434, 'binary_precision': 0.6213018, 'binary_recall': 0.40229884, 'binary_specificity': 0.989328, 'binary_f1_score': 0.4883721}
confusion matrix:
      0    1
0  5933   64
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 8
val acc:0.966741144657135, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 16,now: 2024-05-31 16:49:16.862457,epoch time: 0:25:20.398308,used: 6:47:36.371676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9686244, 'precision': 0.75739086, 'recall': 0.8116405, 'specificity': 0.8116405, 'f1': 0.78163177, 'auroc': 0.96060896, 'binary_precision': 0.52728283, 'binary_recall': 0.6433424, 'binary_specificity': 0.97993857, 'binary_f1_score': 0.5795593}
confusion matrix:
       0    1
0  41471  849
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.745544, 'recall': 0.8136884, 'specificity': 0.8136884, 'f1': 0.77495456, 'auroc': 0.9538007, 'binary_precision': 0.5036145, 'binary_recall': 0.65007776, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.5675492}
confusion matrix:
       0    1
0  17737  412
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8077648, 'recall': 0.6813215, 'specificity': 0.6813215, 'f1': 0.7264316, 'auroc': 0.9367142, 'binary_precision': 0.6423841, 'binary_recall': 0.3716475, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.47087377}
confusion matrix:
      0   1
0  5943  54
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 9
val acc:0.9661026000976562, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 17,now: 2024-05-31 17:14:47.801089,epoch time: 0:25:30.938632,used: 7:13:07.310308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7432598, 'recall': 0.85739404, 'specificity': 0.85739404, 'f1': 0.78812456, 'auroc': 0.96450394, 'binary_precision': 0.49567986, 'binary_recall': 0.74099255, 'binary_specificity': 0.97379553, 'binary_f1_score': 0.59400547}
confusion matrix:
       0     1
0  41212  1109
1    381  1090
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.73740065, 'recall': 0.859895, 'specificity': 0.859895, 'f1': 0.78444135, 'auroc': 0.9553957, 'binary_precision': 0.4839034, 'binary_recall': 0.748056, 'binary_specificity': 0.971734, 'binary_f1_score': 0.5876604}
confusion matrix:
       0    1
0  17636  513
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.79168427, 'recall': 0.76052874, 'specificity': 0.76052874, 'f1': 0.77511764, 'auroc': 0.9391763, 'binary_precision': 0.6034483, 'binary_recall': 0.5363985, 'binary_specificity': 0.984659, 'binary_f1_score': 0.56795126}
confusion matrix:
      0    1
0  5905   92
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 10
val acc:0.9640804529190063, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 18,now: 2024-05-31 17:40:26.591831,epoch time: 0:25:38.790742,used: 7:38:46.101050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9683047, 'precision': 0.75520325, 'recall': 0.81725967, 'specificity': 0.81725967, 'f1': 0.78247607, 'auroc': 0.96025616, 'binary_precision': 0.52249324, 'binary_recall': 0.6553365, 'binary_specificity': 0.9791829, 'binary_f1_score': 0.5814234}
confusion matrix:
       0    1
0  41440  881
1    507  964
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7454269, 'recall': 0.8286344, 'specificity': 0.8286344, 'f1': 0.7802509, 'auroc': 0.953339, 'binary_precision': 0.5022936, 'binary_recall': 0.68118197, 'binary_specificity': 0.97608685, 'binary_f1_score': 0.57821786}
confusion matrix:
       0    1
0  17715  434
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.82617426, 'recall': 0.71197283, 'specificity': 0.71197283, 'f1': 0.7556633, 'auroc': 0.93973315, 'binary_precision': 0.6766467, 'binary_recall': 0.4329502, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.52803737}
confusion matrix:
      0    1
0  5943   54
1   148  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 11
val acc:0.9659961462020874, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 19,now: 2024-05-31 18:05:41.252014,epoch time: 0:25:14.660183,used: 8:04:00.761233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.7501316, 'recall': 0.84818906, 'specificity': 0.84818906, 'f1': 0.79015017, 'auroc': 0.9623908, 'binary_precision': 0.5101156, 'binary_recall': 0.72040814, 'binary_specificity': 0.97597, 'binary_f1_score': 0.5972927}
confusion matrix:
       0     1
0  41305  1017
1    411  1059
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.74038506, 'recall': 0.8557528, 'specificity': 0.8557528, 'f1': 0.7854634, 'auroc': 0.95851445, 'binary_precision': 0.49019608, 'binary_recall': 0.7387247, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.58932996}
confusion matrix:
       0    1
0  17655  494
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.8371986, 'recall': 0.791182, 'specificity': 0.791182, 'f1': 0.81231475, 'auroc': 0.94193166, 'binary_precision': 0.69196427, 'binary_recall': 0.59386975, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.63917524}
confusion matrix:
      0    1
0  5928   69
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 12
val acc:0.9647722244262695, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 20,now: 2024-05-31 18:31:15.066769,epoch time: 0:25:33.814755,used: 8:29:34.575988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96825904, 'precision': 0.75509644, 'recall': 0.8429259, 'specificity': 0.8429259, 'f1': 0.7917943, 'auroc': 0.9667662, 'binary_precision': 0.52045906, 'binary_recall': 0.7085598, 'binary_specificity': 0.97729206, 'binary_f1_score': 0.60011506}
confusion matrix:
       0     1
0  41359   961
1    429  1043
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.745291, 'recall': 0.8331072, 'specificity': 0.8331072, 'f1': 0.78170085, 'auroc': 0.9550415, 'binary_precision': 0.5016949, 'binary_recall': 0.6905132, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.58115184}
confusion matrix:
       0    1
0  17708  441
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.84059083, 'recall': 0.7200526, 'specificity': 0.7200526, 'f1': 0.7660222, 'auroc': 0.9489176, 'binary_precision': 0.70481926, 'binary_recall': 0.44827586, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.54800934}
confusion matrix:
      0    1
0  5948   49
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 13
val acc:0.9659429788589478, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 21,now: 2024-05-31 18:56:48.485824,epoch time: 0:25:33.419055,used: 8:55:07.995043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9683275, 'precision': 0.7555134, 'recall': 0.84951854, 'specificity': 0.84951854, 'f1': 0.79434144, 'auroc': 0.96616685, 'binary_precision': 0.5208231, 'binary_recall': 0.72214675, 'binary_specificity': 0.9768904, 'binary_f1_score': 0.6051808}
confusion matrix:
       0     1
0  41342   978
1    409  1063
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.74321055, 'recall': 0.850083, 'specificity': 0.850083, 'f1': 0.78579545, 'auroc': 0.95994204, 'binary_precision': 0.49628055, 'binary_recall': 0.7262831, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.58964646}
confusion matrix:
       0    1
0  17675  474
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.82642514, 'recall': 0.7587817, 'specificity': 0.7587817, 'f1': 0.78825355, 'auroc': 0.9403391, 'binary_precision': 0.67317075, 'binary_recall': 0.52873564, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.59227467}
confusion matrix:
      0    1
0  5930   67
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 14
val acc:0.9654108285903931, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 22,now: 2024-05-31 19:22:33.059565,epoch time: 0:25:44.573741,used: 9:20:52.568784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.963966, 'precision': 0.73326135, 'recall': 0.8528932, 'specificity': 0.8528932, 'f1': 0.77928877, 'auroc': 0.96451426, 'binary_precision': 0.4759382, 'binary_recall': 0.73383254, 'binary_specificity': 0.9719538, 'binary_f1_score': 0.5773969}
confusion matrix:
       0     1
0  41136  1187
1    391  1078
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.7260601, 'recall': 0.86151767, 'specificity': 0.86151767, 'f1': 0.7760351, 'auroc': 0.95823723, 'binary_precision': 0.4610266, 'binary_recall': 0.7542768, 'binary_specificity': 0.9687586, 'binary_f1_score': 0.5722714}
confusion matrix:
       0    1
0  17582  567
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8126085, 'recall': 0.7711078, 'specificity': 0.7711078, 'f1': 0.7902076, 'auroc': 0.94326204, 'binary_precision': 0.64444447, 'binary_recall': 0.5555556, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5967078}
confusion matrix:
      0    1
0  5917   80
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 15
val acc:0.9614197611808777, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 23,now: 2024-05-31 19:47:50.464488,epoch time: 0:25:17.404923,used: 9:46:09.973707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.74702066, 'recall': 0.8457644, 'specificity': 0.8457644, 'f1': 0.7871596, 'auroc': 0.9659163, 'binary_precision': 0.50406504, 'binary_recall': 0.7160326, 'binary_specificity': 0.97549623, 'binary_f1_score': 0.5916363}
confusion matrix:
       0     1
0  41283  1037
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.7374444, 'recall': 0.86064506, 'specificity': 0.86064506, 'f1': 0.7846924, 'auroc': 0.9631873, 'binary_precision': 0.48393574, 'binary_recall': 0.7496112, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.5881635}
confusion matrix:
       0    1
0  17635  514
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8186399, 'recall': 0.7490364, 'specificity': 0.7490364, 'f1': 0.7790848, 'auroc': 0.9488096, 'binary_precision': 0.65841585, 'binary_recall': 0.5095785, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.57451403}
confusion matrix:
      0    1
0  5928   69
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 16
val acc:0.9640804529190063, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 24,now: 2024-05-31 20:13:52.246737,epoch time: 0:26:01.782249,used: 10:12:11.755956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.7451608, 'recall': 0.8828095, 'specificity': 0.8828095, 'f1': 0.79698706, 'auroc': 0.96907103, 'binary_precision': 0.49765658, 'binary_recall': 0.79347825, 'binary_specificity': 0.97214085, 'binary_f1_score': 0.6116784}
confusion matrix:
       0     1
0  41141  1179
1    304  1168
---- Validation: 
scalar performance:
{'acc': 0.96333545, 'precision': 0.73531604, 'recall': 0.8790107, 'specificity': 0.8790107, 'f1': 0.78810877, 'auroc': 0.9633286, 'binary_precision': 0.47830188, 'binary_recall': 0.7884914, 'binary_specificity': 0.96953, 'binary_f1_score': 0.5954199}
confusion matrix:
       0    1
0  17596  553
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.83796024, 'recall': 0.81933403, 'specificity': 0.81933403, 'f1': 0.8283526, 'auroc': 0.94501096, 'binary_precision': 0.6910569, 'binary_recall': 0.651341, 'binary_specificity': 0.987327, 'binary_f1_score': 0.67061144}
confusion matrix:
      0    1
0  5921   76
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 17
val acc:0.9633354544639587, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 25,now: 2024-05-31 20:40:02.446752,epoch time: 0:26:10.200015,used: 10:38:21.955971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96577, 'precision': 0.7418065, 'recall': 0.8449167, 'specificity': 0.8449167, 'f1': 0.78316945, 'auroc': 0.96524405, 'binary_precision': 0.49367088, 'binary_recall': 0.71535325, 'binary_specificity': 0.97448015, 'binary_f1_score': 0.5841886}
confusion matrix:
       0     1
0  41240  1080
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.9625372, 'precision': 0.7307606, 'recall': 0.86209625, 'specificity': 0.86209625, 'f1': 0.77992296, 'auroc': 0.9632024, 'binary_precision': 0.47041708, 'binary_recall': 0.7542768, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.5794504}
confusion matrix:
       0    1
0  17603  546
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7777933, 'recall': 0.6763228, 'specificity': 0.6763228, 'f1': 0.71438074, 'auroc': 0.9155352, 'binary_precision': 0.5828221, 'binary_recall': 0.36398467, 'binary_specificity': 0.988661, 'binary_f1_score': 0.4481132}
confusion matrix:
      0   1
0  5929  68
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 18
val acc:0.9625372290611267, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 26,now: 2024-05-31 21:06:39.107270,epoch time: 0:26:36.660518,used: 11:04:58.616489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.965633, 'precision': 0.7408668, 'recall': 0.8396001, 'specificity': 0.8396001, 'f1': 0.78078794, 'auroc': 0.96569633, 'binary_precision': 0.49216896, 'binary_recall': 0.7044837, 'binary_specificity': 0.9747164, 'binary_f1_score': 0.5794915}
confusion matrix:
       0     1
0  41250  1070
1    435  1037
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.7342527, 'recall': 0.8662323, 'specificity': 0.8662323, 'f1': 0.7838069, 'auroc': 0.9632753, 'binary_precision': 0.4771178, 'binary_recall': 0.7620529, 'binary_specificity': 0.9704116, 'binary_f1_score': 0.5868264}
confusion matrix:
       0    1
0  17612  537
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74068975, 'recall': 0.6908128, 'specificity': 0.6908128, 'f1': 0.7124706, 'auroc': 0.9123829, 'binary_precision': 0.50731707, 'binary_recall': 0.39846742, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.44635192}
confusion matrix:
      0    1
0  5896  101
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 19
val acc:0.9632822275161743, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 27,now: 2024-05-31 21:32:42.543813,epoch time: 0:26:03.436543,used: 11:31:02.053032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9596958, 'precision': 0.71877515, 'recall': 0.88275635, 'specificity': 0.88275635, 'f1': 0.7752794, 'auroc': 0.96945834, 'binary_precision': 0.4446961, 'binary_recall': 0.80027175, 'binary_specificity': 0.965241, 'binary_f1_score': 0.5717059}
confusion matrix:
       0     1
0  40849  1471
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.9578544, 'precision': 0.71589696, 'recall': 0.8926743, 'specificity': 0.8926743, 'f1': 0.7748641, 'auroc': 0.96502626, 'binary_precision': 0.4382767, 'binary_recall': 0.82270604, 'binary_specificity': 0.96264255, 'binary_f1_score': 0.5718919}
confusion matrix:
       0    1
0  17471  678
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.77105796, 'recall': 0.78493077, 'specificity': 0.78493077, 'f1': 0.7777976, 'auroc': 0.9406439, 'binary_precision': 0.56, 'binary_recall': 0.5900383, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.57462686}
confusion matrix:
      0    1
0  5876  121
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 20
val acc:0.9578543901443481, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 28,now: 2024-05-31 21:58:43.864175,epoch time: 0:26:01.320362,used: 11:57:03.373394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9640574, 'precision': 0.7360859, 'recall': 0.886914, 'specificity': 0.886914, 'f1': 0.7908449, 'auroc': 0.96914613, 'binary_precision': 0.47914135, 'binary_recall': 0.80421484, 'binary_specificity': 0.9696132, 'binary_f1_score': 0.6005076}
confusion matrix:
       0     1
0  41035  1286
1    288  1183
---- Validation: 
scalar performance:
{'acc': 0.96062154, 'precision': 0.72492576, 'recall': 0.88435614, 'specificity': 0.88435614, 'f1': 0.7808646, 'auroc': 0.9631427, 'binary_precision': 0.45704162, 'binary_recall': 0.8024883, 'binary_specificity': 0.966224, 'binary_f1_score': 0.58239275}
confusion matrix:
       0    1
0  17536  613
1    127  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.76740336, 'recall': 0.7219644, 'specificity': 0.7219644, 'f1': 0.7423002, 'auroc': 0.9251003, 'binary_precision': 0.55813956, 'binary_recall': 0.4597701, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.5042017}
confusion matrix:
      0    1
0  5902   95
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 21
val acc:0.9606215357780457, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 29,now: 2024-05-31 22:24:43.034141,epoch time: 0:25:59.169966,used: 12:23:02.543360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9644684, 'precision': 0.7372527, 'recall': 0.87695587, 'specificity': 0.87695587, 'f1': 0.78915316, 'auroc': 0.9696689, 'binary_precision': 0.48221013, 'binary_recall': 0.7831407, 'binary_specificity': 0.970771, 'binary_f1_score': 0.5968912}
confusion matrix:
       0     1
0  41084  1237
1    319  1152
---- Validation: 
scalar performance:
{'acc': 0.9619519, 'precision': 0.72940946, 'recall': 0.8760443, 'specificity': 0.8760443, 'f1': 0.782544, 'auroc': 0.9646046, 'binary_precision': 0.46666667, 'binary_recall': 0.7838258, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.58502614}
confusion matrix:
       0    1
0  17573  576
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8129271, 'recall': 0.73754215, 'specificity': 0.73754215, 'f1': 0.7694824, 'auroc': 0.9365938, 'binary_precision': 0.6479592, 'binary_recall': 0.48659003, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5557987}
confusion matrix:
      0    1
0  5928   69
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 22
val acc:0.9619519114494324, best validation acc: 0.966741144657135, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 30,now: 2024-05-31 22:50:46.522193,epoch time: 0:26:03.488052,used: 12:49:06.031412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_10_01_40_seed_0_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:49:06.031412 at 2024-05-31 22:50:46.522193
persisted model performance metric: 

scalar performance:
{'acc': 0.978907, 'precision': 0.88518935, 'recall': 0.83691084, 'specificity': 0.83691084, 'f1': 0.8592669, 'auroc': 0.93929386, 'binary_precision': 0.78414094, 'binary_recall': 0.68199235, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.72950816}
confusion matrix:
      0    1
0  5948   49
1    83  178
oracle model performance metric: 

scalar performance:
{'acc': 0.97810805, 'precision': 0.8767339, 'recall': 0.83649397, 'specificity': 0.83649397, 'f1': 0.85535735, 'auroc': 0.9286394, 'binary_precision': 0.76724136, 'binary_recall': 0.68199235, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.7221095}
confusion matrix:
      0    1
0  5943   54
1    83  178
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 749988 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381642 GiB | 381641 GiB |
|       from small pool |   8484 KiB |      9 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2767    |   74972 K  |   74972 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      52    |    2747    |   40162 K  |   40162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  11482 MiB |  11482 MiB |  10268 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384644 GiB | 384644 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     404    |     404    |     326    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74974 K  |   74974 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40163 K  |   40163 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1214 MiB |  11482 MiB |  11482 MiB |  10268 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384644 GiB | 384644 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     404    |     404    |     326    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74974 K  |   74974 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40163 K  |   40163 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735

 Experiment start at: 2024-05-31 23:03:05.415967
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9669601, 'precision': 0.72099376, 'recall': 0.5237044, 'specificity': 0.5237044, 'f1': 0.53621346, 'auroc': 0.8955982, 'binary_precision': 0.47333333, 'binary_recall': 0.049271338, 'binary_specificity': 0.9981375, 'binary_f1_score': 0.08925205}
confusion matrix:
       0   1
0  42336  79
1   1370  71
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7356013, 'recall': 0.55510324, 'specificity': 0.55510324, 'f1': 0.5840536, 'auroc': 0.8971576, 'binary_precision': 0.503268, 'binary_recall': 0.114413075, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.18644068}
confusion matrix:
       0   1
0  17991  76
1    596  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.88642967, 'recall': 0.56471187, 'specificity': 0.56471187, 'f1': 0.60292137, 'auroc': 0.8783927, 'binary_precision': 0.8095238, 'binary_recall': 0.13076924, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.22516558}
confusion matrix:
      0   1
0  5938   8
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 23:30:29.895472,epoch time: 0:27:24.479505,used: 0:27:24.479505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9669145, 'precision': 0.73293865, 'recall': 0.59803486, 'specificity': 0.59803486, 'f1': 0.6353709, 'auroc': 0.9144347, 'binary_precision': 0.49243698, 'binary_recall': 0.20319001, 'binary_specificity': 0.9928797, 'binary_f1_score': 0.28767794}
confusion matrix:
       0    1
0  42112  302
1   1149  293
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.745144, 'recall': 0.66701704, 'specificity': 0.66701704, 'f1': 0.69784975, 'auroc': 0.90535975, 'binary_precision': 0.5143488, 'binary_recall': 0.346211, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.41385436}
confusion matrix:
       0    1
0  17847  220
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.91271925, 'recall': 0.6965633, 'specificity': 0.6965633, 'f1': 0.7630683, 'auroc': 0.8921222, 'binary_precision': 0.8512397, 'binary_recall': 0.39615384, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.54068244}
confusion matrix:
      0    1
0  5928   18
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 23:57:00.482960,epoch time: 0:26:30.587488,used: 0:53:55.066993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.7393215, 'recall': 0.69591165, 'specificity': 0.69591165, 'f1': 0.715219, 'auroc': 0.9287889, 'binary_precision': 0.49872124, 'binary_recall': 0.40568656, 'binary_specificity': 0.9861367, 'binary_f1_score': 0.44741875}
confusion matrix:
       0    1
0  41826  588
1    857  585
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7439133, 'recall': 0.7626968, 'specificity': 0.7626968, 'f1': 0.75291336, 'auroc': 0.92878413, 'binary_precision': 0.5048143, 'binary_recall': 0.54531944, 'binary_specificity': 0.98007417, 'binary_f1_score': 0.52428573}
confusion matrix:
       0    1
0  17707  360
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.8768898, 'recall': 0.7487277, 'specificity': 0.7487277, 'f1': 0.79839313, 'auroc': 0.9155289, 'binary_precision': 0.7751479, 'binary_recall': 0.50384617, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6107226}
confusion matrix:
      0    1
0  5908   38
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9718014597892761 / 0.9730905294418335
after epoch: 3,now: 2024-06-01 00:23:47.062915,epoch time: 0:26:46.579955,used: 1:20:41.646948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9676441, 'precision': 0.74509704, 'recall': 0.6449704, 'specificity': 0.6449704, 'f1': 0.6809196, 'auroc': 0.93007207, 'binary_precision': 0.5136742, 'binary_recall': 0.2995839, 'binary_specificity': 0.990357, 'binary_f1_score': 0.3784494}
confusion matrix:
       0    1
0  42005  409
1   1010  432
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7609625, 'recall': 0.69002056, 'specificity': 0.69002056, 'f1': 0.7193068, 'auroc': 0.9243185, 'binary_precision': 0.5443299, 'binary_recall': 0.3922734, 'binary_specificity': 0.98776776, 'binary_f1_score': 0.45595852}
confusion matrix:
       0    1
0  17846  221
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.8799313, 'recall': 0.7507348, 'specificity': 0.7507348, 'f1': 0.8008076, 'auroc': 0.9193361, 'binary_precision': 0.7810651, 'binary_recall': 0.50769234, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.61538464}
confusion matrix:
      0    1
0  5909   37
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-01 00:50:32.342159,epoch time: 0:26:45.279244,used: 1:47:26.926192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96787214, 'precision': 0.74723387, 'recall': 0.7234671, 'specificity': 0.7234671, 'f1': 0.734686, 'auroc': 0.9399679, 'binary_precision': 0.5127021, 'binary_recall': 0.46185854, 'binary_specificity': 0.9850757, 'binary_f1_score': 0.48595405}
confusion matrix:
       0    1
0  41781  633
1    776  666
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.75421786, 'recall': 0.7820963, 'specificity': 0.7820963, 'f1': 0.7673439, 'auroc': 0.9387083, 'binary_precision': 0.524, 'binary_recall': 0.5839524, 'binary_specificity': 0.9802402, 'binary_f1_score': 0.55235416}
confusion matrix:
       0    1
0  17710  357
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.8787577, 'recall': 0.799978, 'specificity': 0.799978, 'f1': 0.83432376, 'auroc': 0.93002665, 'binary_precision': 0.7745098, 'binary_recall': 0.6076923, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.68103445}
confusion matrix:
      0    1
0  5900   46
1   102  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
early stop counter: 1
val acc:0.9660085439682007, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 5,now: 2024-06-01 01:17:21.723145,epoch time: 0:26:49.380986,used: 2:14:16.307178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.7415358, 'recall': 0.7132417, 'specificity': 0.7132417, 'f1': 0.726413, 'auroc': 0.9479871, 'binary_precision': 0.50197315, 'binary_recall': 0.44136018, 'binary_specificity': 0.9851232, 'binary_f1_score': 0.46971935}
confusion matrix:
       0    1
0  41784  631
1    805  636
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.75445855, 'recall': 0.81144994, 'specificity': 0.81144994, 'f1': 0.7797246, 'auroc': 0.941412, 'binary_precision': 0.52226233, 'binary_recall': 0.6448737, 'binary_specificity': 0.9780262, 'binary_f1_score': 0.5771277}
confusion matrix:
       0    1
0  17670  397
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.8626685, 'recall': 0.7708796, 'specificity': 0.7708796, 'f1': 0.8094319, 'auroc': 0.93771183, 'binary_precision': 0.7447917, 'binary_recall': 0.55, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.63274336}
confusion matrix:
      0    1
0  5897   49
1   117  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.9660618901252747, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 6,now: 2024-06-01 01:43:04.272589,epoch time: 0:25:42.549444,used: 2:39:58.856622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96933144, 'precision': 0.7591342, 'recall': 0.75235754, 'specificity': 0.75235754, 'f1': 0.7556962, 'auroc': 0.9521768, 'binary_precision': 0.5345688, 'binary_recall': 0.52011096, 'binary_specificity': 0.9846041, 'binary_f1_score': 0.52724075}
confusion matrix:
       0    1
0  41761  653
1    692  750
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7541585, 'recall': 0.7935406, 'specificity': 0.7935406, 'f1': 0.7722585, 'auroc': 0.94332194, 'binary_precision': 0.5230179, 'binary_recall': 0.6077266, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.5621993}
confusion matrix:
       0    1
0  17694  373
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.86654615, 'recall': 0.78618014, 'specificity': 0.78618014, 'f1': 0.8208966, 'auroc': 0.9335921, 'binary_precision': 0.75124377, 'binary_recall': 0.58076924, 'binary_specificity': 0.991591, 'binary_f1_score': 0.6550976}
confusion matrix:
      0    1
0  5896   50
1   109  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 3
val acc:0.9660085439682007, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 7,now: 2024-06-01 02:08:46.861548,epoch time: 0:25:42.588959,used: 3:05:41.445581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96830535, 'precision': 0.750808, 'recall': 0.76689994, 'specificity': 0.76689994, 'f1': 0.75857615, 'auroc': 0.94820833, 'binary_precision': 0.51690507, 'binary_recall': 0.55131763, 'binary_specificity': 0.9824822, 'binary_f1_score': 0.533557}
confusion matrix:
       0    1
0  41671  743
1    647  795
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74759847, 'recall': 0.80583423, 'specificity': 0.80583423, 'f1': 0.77326035, 'auroc': 0.94662666, 'binary_precision': 0.5089392, 'binary_recall': 0.6344725, 'binary_specificity': 0.977196, 'binary_f1_score': 0.5648148}
confusion matrix:
       0    1
0  17655  412
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.85491097, 'recall': 0.7837525, 'specificity': 0.7837525, 'f1': 0.8149405, 'auroc': 0.93157697, 'binary_precision': 0.7281553, 'binary_recall': 0.5769231, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.64377683}
confusion matrix:
      0    1
0  5890   56
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 4
val acc:0.9648879170417786, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 8,now: 2024-06-01 02:34:25.457194,epoch time: 0:25:38.595646,used: 3:31:20.041227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9693543, 'precision': 0.7580102, 'recall': 0.79993254, 'specificity': 0.79993254, 'f1': 0.77722144, 'auroc': 0.9579158, 'binary_precision': 0.52906287, 'binary_recall': 0.6185853, 'binary_specificity': 0.9812798, 'binary_f1_score': 0.5703325}
confusion matrix:
       0    1
0  41620  794
1    550  892
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.75061154, 'recall': 0.8011041, 'specificity': 0.8011041, 'f1': 0.77325606, 'auroc': 0.95020247, 'binary_precision': 0.5153374, 'binary_recall': 0.6240713, 'binary_specificity': 0.97813696, 'binary_f1_score': 0.5645161}
confusion matrix:
       0    1
0  17672  395
1    253  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9751853, 'precision': 0.86036307, 'recall': 0.81234634, 'specificity': 0.81234634, 'f1': 0.8344537, 'auroc': 0.92911136, 'binary_precision': 0.73660713, 'binary_recall': 0.63461536, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.6818182}
confusion matrix:
      0    1
0  5887   59
1    95  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 5
val acc:0.9654215574264526, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 9,now: 2024-06-01 02:59:58.589928,epoch time: 0:25:33.132734,used: 3:56:53.173961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.74499476, 'recall': 0.8318764, 'specificity': 0.8318764, 'f1': 0.7811134, 'auroc': 0.9595902, 'binary_precision': 0.5007587, 'binary_recall': 0.6870229, 'binary_specificity': 0.9767299, 'binary_f1_score': 0.57928616}
confusion matrix:
       0    1
0  41428  987
1    451  990
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.74166596, 'recall': 0.80528075, 'specificity': 0.80528075, 'f1': 0.7692903, 'auroc': 0.9523381, 'binary_precision': 0.49708962, 'binary_recall': 0.6344725, 'binary_specificity': 0.976089, 'binary_f1_score': 0.55744123}
confusion matrix:
       0    1
0  17635  432
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.83665025, 'recall': 0.8279723, 'specificity': 0.8279723, 'f1': 0.832248, 'auroc': 0.94806063, 'binary_precision': 0.68774706, 'binary_recall': 0.66923076, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.6783626}
confusion matrix:
      0    1
0  5867   79
1    86  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 6
val acc:0.9638206958770752, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 10,now: 2024-06-01 03:25:38.589160,epoch time: 0:25:39.999232,used: 4:22:33.173193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9687614, 'precision': 0.7539815, 'recall': 0.8043153, 'specificity': 0.8043153, 'f1': 0.77662295, 'auroc': 0.9597312, 'binary_precision': 0.52068967, 'binary_recall': 0.62829405, 'binary_specificity': 0.98033667, 'binary_f1_score': 0.5694532}
confusion matrix:
       0    1
0  41580  834
1    536  906
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74741757, 'recall': 0.7822581, 'specificity': 0.7822581, 'f1': 0.76354814, 'auroc': 0.94935954, 'binary_precision': 0.5103627, 'binary_recall': 0.5854383, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.5453287}
confusion matrix:
       0    1
0  17689  378
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.83643305, 'recall': 0.7903516, 'specificity': 0.7903516, 'f1': 0.81150556, 'auroc': 0.95088744, 'binary_precision': 0.69058293, 'binary_recall': 0.5923077, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.6376812}
confusion matrix:
      0    1
0  5877   69
1   106  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 7
val acc:0.9649413228034973, best validation acc: 0.9663820862770081, corresponding to test acc:                         0.973412811756134 / 0.9761521220207214
after epoch: 11,now: 2024-06-01 03:51:20.557557,epoch time: 0:25:41.968397,used: 4:48:15.141590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9697419, 'precision': 0.76191896, 'recall': 0.76630276, 'specificity': 0.76630276, 'f1': 0.7640908, 'auroc': 0.9614678, 'binary_precision': 0.53919566, 'binary_recall': 0.5485437, 'binary_specificity': 0.98406184, 'binary_f1_score': 0.5438295}
confusion matrix:
       0    1
0  41738  676
1    651  791
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.75852334, 'recall': 0.73439485, 'specificity': 0.73439485, 'f1': 0.74580055, 'auroc': 0.94690794, 'binary_precision': 0.5361842, 'binary_recall': 0.48439822, 'binary_specificity': 0.98439145, 'binary_f1_score': 0.50897735}
confusion matrix:
       0    1
0  17785  282
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.84230816, 'recall': 0.7492212, 'specificity': 0.7492212, 'f1': 0.78765476, 'auroc': 0.9395849, 'binary_precision': 0.7058824, 'binary_recall': 0.50769234, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.59060407}
confusion matrix:
      0    1
0  5891   55
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
better model found
persisted
after epoch: 12,now: 2024-06-01 04:16:55.992915,epoch time: 0:25:35.435358,used: 5:13:50.576948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.7452766, 'recall': 0.8289937, 'specificity': 0.8289937, 'f1': 0.7803076, 'auroc': 0.9601704, 'binary_precision': 0.5015322, 'binary_recall': 0.6809986, 'binary_specificity': 0.97698873, 'binary_f1_score': 0.5776471}
confusion matrix:
       0    1
0  41438  976
1    460  982
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74555516, 'recall': 0.80778635, 'specificity': 0.80778635, 'f1': 0.7727195, 'auroc': 0.9488399, 'binary_precision': 0.5046948, 'binary_recall': 0.63893014, 'binary_specificity': 0.9766425, 'binary_f1_score': 0.5639344}
confusion matrix:
       0    1
0  17645  422
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.81529486, 'recall': 0.75916195, 'specificity': 0.75916195, 'f1': 0.7841652, 'auroc': 0.9424467, 'binary_precision': 0.6509434, 'binary_recall': 0.5307692, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.58474576}
confusion matrix:
      0    1
0  5872   74
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9705123901367188 / 0.9761521220207214
after epoch: 13,now: 2024-06-01 04:42:37.916556,epoch time: 0:25:41.923641,used: 5:39:32.500589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96860176, 'precision': 0.75296503, 'recall': 0.81193674, 'specificity': 0.81193674, 'f1': 0.7790214, 'auroc': 0.96075535, 'binary_precision': 0.5181261, 'binary_recall': 0.64424413, 'binary_specificity': 0.9796294, 'binary_f1_score': 0.57434314}
confusion matrix:
       0    1
0  41550  864
1    513  929
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7464515, 'recall': 0.79645276, 'specificity': 0.79645276, 'f1': 0.7688561, 'auroc': 0.94894993, 'binary_precision': 0.50735295, 'binary_recall': 0.615156, 'binary_specificity': 0.97774947, 'binary_f1_score': 0.5560779}
confusion matrix:
       0    1
0  17665  402
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.84050447, 'recall': 0.78115666, 'specificity': 0.78115666, 'f1': 0.8076817, 'auroc': 0.93817043, 'binary_precision': 0.69953054, 'binary_recall': 0.5730769, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.63002115}
confusion matrix:
      0    1
0  5882   64
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.9647278785705566, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9705123901367188 / 0.9761521220207214
after epoch: 14,now: 2024-06-01 05:08:15.821852,epoch time: 0:25:37.905296,used: 6:05:10.405885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9685334, 'precision': 0.7525167, 'recall': 0.80922174, 'specificity': 0.80922174, 'f1': 0.77768064, 'auroc': 0.9602524, 'binary_precision': 0.5174157, 'binary_recall': 0.63869625, 'binary_specificity': 0.97974724, 'binary_f1_score': 0.57169455}
confusion matrix:
       0    1
0  41555  859
1    521  921
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7458305, 'recall': 0.7963974, 'specificity': 0.7963974, 'f1': 0.76845485, 'auroc': 0.9479493, 'binary_precision': 0.50611246, 'binary_recall': 0.615156, 'binary_specificity': 0.9776388, 'binary_f1_score': 0.55533195}
confusion matrix:
       0    1
0  17663  404
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.8283502, 'recall': 0.7711209, 'specificity': 0.7711209, 'f1': 0.796692, 'auroc': 0.9490816, 'binary_precision': 0.6760563, 'binary_recall': 0.5538462, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.6088795}
confusion matrix:
      0    1
0  5877   69
1   116  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 3
val acc:0.9646211266517639, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9705123901367188 / 0.9761521220207214
after epoch: 15,now: 2024-06-01 05:34:01.400657,epoch time: 0:25:45.578805,used: 6:30:55.984690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.76476926, 'recall': 0.7967314, 'specificity': 0.7967314, 'f1': 0.7797422, 'auroc': 0.9622605, 'binary_precision': 0.54282194, 'binary_recall': 0.610957, 'binary_specificity': 0.9825058, 'binary_f1_score': 0.5748776}
confusion matrix:
       0    1
0  41672  742
1    561  881
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7603935, 'recall': 0.77970576, 'specificity': 0.77970576, 'f1': 0.7696631, 'auroc': 0.9483099, 'binary_precision': 0.5365517, 'binary_recall': 0.5780089, 'binary_specificity': 0.9814026, 'binary_f1_score': 0.5565093}
confusion matrix:
       0    1
0  17731  336
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8069376, 'recall': 0.7025628, 'specificity': 0.7025628, 'f1': 0.7428607, 'auroc': 0.948956, 'binary_precision': 0.6390532, 'binary_recall': 0.41538462, 'binary_specificity': 0.989741, 'binary_f1_score': 0.5034965}
confusion matrix:
      0    1
0  5885   61
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
better model found
persisted
after epoch: 16,now: 2024-06-01 05:59:56.026486,epoch time: 0:25:54.625829,used: 6:56:50.610519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96962786, 'precision': 0.7594214, 'recall': 0.82553035, 'specificity': 0.82553035, 'f1': 0.78831875, 'auroc': 0.9646043, 'binary_precision': 0.5301205, 'binary_recall': 0.67128986, 'binary_specificity': 0.97977084, 'binary_f1_score': 0.59241134}
confusion matrix:
       0    1
0  41556  858
1    474  968
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7544767, 'recall': 0.8214637, 'specificity': 0.8214637, 'f1': 0.7835821, 'auroc': 0.9537699, 'binary_precision': 0.52153665, 'binary_recall': 0.66567606, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.5848564}
confusion matrix:
       0    1
0  17656  411
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.8467556, 'recall': 0.7550745, 'specificity': 0.7550745, 'f1': 0.7931868, 'auroc': 0.9476977, 'binary_precision': 0.71428573, 'binary_recall': 0.5192308, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.60133636}
confusion matrix:
      0    1
0  5892   54
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 1
val acc:0.9660618901252747, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 17,now: 2024-06-01 06:25:53.018702,epoch time: 0:25:56.992216,used: 7:22:47.602735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96563756, 'precision': 0.738841, 'recall': 0.87002563, 'specificity': 0.87002563, 'f1': 0.78852946, 'auroc': 0.9631422, 'binary_precision': 0.48573935, 'binary_recall': 0.76768374, 'binary_specificity': 0.9723676, 'binary_f1_score': 0.59500134}
confusion matrix:
       0     1
0  41242  1172
1    335  1107
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.73466265, 'recall': 0.8542978, 'specificity': 0.8542978, 'f1': 0.7806349, 'auroc': 0.9506612, 'binary_precision': 0.47926712, 'binary_recall': 0.7384844, 'binary_specificity': 0.97011125, 'binary_f1_score': 0.58128655}
confusion matrix:
       0    1
0  17527  540
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.80896795, 'recall': 0.8055571, 'specificity': 0.8055571, 'f1': 0.80725193, 'auroc': 0.9510194, 'binary_precision': 0.6342412, 'binary_recall': 0.6269231, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.63056093}
confusion matrix:
      0    1
0  5852   94
1    97  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.9617929458618164, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 18,now: 2024-06-01 06:52:08.774081,epoch time: 0:26:15.755379,used: 7:49:03.358114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9687158, 'precision': 0.75372076, 'recall': 0.82204425, 'specificity': 0.82204425, 'f1': 0.7833635, 'auroc': 0.96228313, 'binary_precision': 0.5189394, 'binary_recall': 0.66504854, 'binary_specificity': 0.97903997, 'binary_f1_score': 0.5829787}
confusion matrix:
       0    1
0  41525  889
1    483  959
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7447683, 'recall': 0.81911993, 'specificity': 0.81911993, 'f1': 0.7764017, 'auroc': 0.9486811, 'binary_precision': 0.5022523, 'binary_recall': 0.6627043, 'binary_specificity': 0.9755355, 'binary_f1_score': 0.5714286}
confusion matrix:
       0    1
0  17625  442
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8221446, 'recall': 0.7125987, 'specificity': 0.7125987, 'f1': 0.7549329, 'auroc': 0.93684864, 'binary_precision': 0.66863906, 'binary_recall': 0.43461537, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.52680653}
confusion matrix:
      0    1
0  5890   56
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 3
val acc:0.9643009901046753, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 19,now: 2024-06-01 07:18:31.720182,epoch time: 0:26:22.946101,used: 8:15:26.304215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97069955, 'precision': 0.767264, 'recall': 0.8073271, 'specificity': 0.8073271, 'f1': 0.78574765, 'auroc': 0.9656482, 'binary_precision': 0.5470906, 'binary_recall': 0.63245493, 'binary_specificity': 0.98219925, 'binary_f1_score': 0.58668387}
confusion matrix:
       0    1
0  41659  755
1    530  912
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7516875, 'recall': 0.81406194, 'specificity': 0.81406194, 'f1': 0.7789998, 'auroc': 0.9518603, 'binary_precision': 0.5165094, 'binary_recall': 0.6508172, 'binary_specificity': 0.97730666, 'binary_f1_score': 0.5759368}
confusion matrix:
       0    1
0  17657  410
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.85233176, 'recall': 0.68543434, 'specificity': 0.68543434, 'f1': 0.7404933, 'auroc': 0.9416853, 'binary_precision': 0.73134327, 'binary_recall': 0.37692308, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.49746192}
confusion matrix:
      0   1
0  5910  36
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 4
val acc:0.9655816555023193, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 20,now: 2024-06-01 07:44:35.579093,epoch time: 0:26:03.858911,used: 8:41:30.163126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9708136, 'precision': 0.76666635, 'recall': 0.8398764, 'specificity': 0.8398764, 'f1': 0.7983613, 'auroc': 0.9695951, 'binary_precision': 0.5436422, 'binary_recall': 0.6997226, 'binary_specificity': 0.9800302, 'binary_f1_score': 0.61188596}
confusion matrix:
       0     1
0  41567   847
1    433  1009
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.74988484, 'recall': 0.8303194, 'specificity': 0.8303194, 'f1': 0.78380513, 'auroc': 0.95400804, 'binary_precision': 0.5116537, 'binary_recall': 0.68499255, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.58576876}
confusion matrix:
       0    1
0  17627  440
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.83148897, 'recall': 0.6960478, 'specificity': 0.6960478, 'f1': 0.7445837, 'auroc': 0.94431424, 'binary_precision': 0.68874174, 'binary_recall': 0.4, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.5060827}
confusion matrix:
      0    1
0  5899   47
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 5
val acc:0.965208113193512, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 21,now: 2024-06-01 08:10:26.875668,epoch time: 0:25:51.296575,used: 9:07:21.459701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97035754, 'precision': 0.7641641, 'recall': 0.8255726, 'specificity': 0.8255726, 'f1': 0.79131615, 'auroc': 0.96724033, 'binary_precision': 0.5396205, 'binary_recall': 0.6705964, 'binary_specificity': 0.98054886, 'binary_f1_score': 0.598021}
confusion matrix:
       0    1
0  41589  825
1    475  967
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.75648975, 'recall': 0.7965954, 'specificity': 0.7965954, 'f1': 0.77490973, 'auroc': 0.9501526, 'binary_precision': 0.5274585, 'binary_recall': 0.6136701, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.5673077}
confusion matrix:
       0    1
0  17697  370
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8350149, 'recall': 0.69429284, 'specificity': 0.69429284, 'f1': 0.7440371, 'auroc': 0.93750095, 'binary_precision': 0.6959459, 'binary_recall': 0.39615384, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.50490195}
confusion matrix:
      0    1
0  5901   45
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 6
val acc:0.9663820862770081, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 22,now: 2024-06-01 08:36:12.502120,epoch time: 0:25:45.626452,used: 9:33:07.086153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.966732, 'precision': 0.74408454, 'recall': 0.8709265, 'specificity': 0.8709265, 'f1': 0.7928159, 'auroc': 0.96782625, 'binary_precision': 0.49619347, 'binary_recall': 0.76837724, 'binary_specificity': 0.97347575, 'binary_f1_score': 0.6029932}
confusion matrix:
       0     1
0  41289  1125
1    334  1108
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.7373712, 'recall': 0.8489355, 'specificity': 0.8489355, 'f1': 0.78107953, 'auroc': 0.95378524, 'binary_precision': 0.48511904, 'binary_recall': 0.7265973, 'binary_specificity': 0.9712736, 'binary_f1_score': 0.5817965}
confusion matrix:
       0    1
0  17548  519
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.77667475, 'recall': 0.70665026, 'specificity': 0.70665026, 'f1': 0.7359598, 'auroc': 0.93478227, 'binary_precision': 0.578125, 'binary_recall': 0.42692307, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.49115044}
confusion matrix:
      0    1
0  5865   81
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 7
val acc:0.9624866843223572, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 23,now: 2024-06-01 09:01:54.741973,epoch time: 0:25:42.239853,used: 9:58:49.326006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9651587, 'precision': 0.73587346, 'recall': 0.8573849, 'specificity': 0.8573849, 'f1': 0.7826216, 'auroc': 0.9682193, 'binary_precision': 0.48068285, 'binary_recall': 0.74202496, 'binary_specificity': 0.9727448, 'binary_f1_score': 0.5834242}
confusion matrix:
       0     1
0  41258  1156
1    372  1070
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74749815, 'recall': 0.86858404, 'specificity': 0.86858404, 'f1': 0.79454315, 'auroc': 0.9598899, 'binary_precision': 0.5039139, 'binary_recall': 0.7652303, 'binary_specificity': 0.9719378, 'binary_f1_score': 0.6076696}
confusion matrix:
       0    1
0  17560  507
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.77384675, 'recall': 0.678645, 'specificity': 0.678645, 'f1': 0.7150204, 'auroc': 0.94006443, 'binary_precision': 0.5748503, 'binary_recall': 0.36923078, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.44964877}
confusion matrix:
      0   1
0  5875  71
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 8
val acc:0.964514434337616, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 24,now: 2024-06-01 09:27:38.668282,epoch time: 0:25:43.926309,used: 10:24:33.252315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9697647, 'precision': 0.7600213, 'recall': 0.8446933, 'specificity': 0.8446933, 'f1': 0.7957523, 'auroc': 0.9706112, 'binary_precision': 0.52998966, 'binary_recall': 0.7108183, 'binary_specificity': 0.9785684, 'binary_f1_score': 0.60722744}
confusion matrix:
       0     1
0  41505   909
1    417  1025
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7585833, 'recall': 0.8533229, 'specificity': 0.8533229, 'f1': 0.7976819, 'auroc': 0.96056485, 'binary_precision': 0.5273312, 'binary_recall': 0.73105496, 'binary_specificity': 0.9755909, 'binary_f1_score': 0.6127023}
confusion matrix:
       0    1
0  17626  441
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7964544, 'recall': 0.6628509, 'specificity': 0.6628509, 'f1': 0.7080927, 'auroc': 0.93131953, 'binary_precision': 0.62142855, 'binary_recall': 0.33461538, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.43499997}
confusion matrix:
      0   1
0  5893  53
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 9
val acc:0.9668089747428894, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 25,now: 2024-06-01 09:53:08.058949,epoch time: 0:25:29.390667,used: 10:50:02.642982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.74970627, 'recall': 0.9055749, 'specificity': 0.9055749, 'f1': 0.8068152, 'auroc': 0.9735852, 'binary_precision': 0.50500834, 'binary_recall': 0.83911234, 'binary_specificity': 0.97203755, 'binary_f1_score': 0.63053674}
confusion matrix:
       0     1
0  41228  1186
1    232  1210
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.74583304, 'recall': 0.893314, 'specificity': 0.893314, 'f1': 0.800218, 'auroc': 0.9605489, 'binary_precision': 0.49864006, 'binary_recall': 0.81723624, 'binary_specificity': 0.9693917, 'binary_f1_score': 0.6193694}
confusion matrix:
       0    1
0  17514  553
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.80185485, 'recall': 0.8162546, 'specificity': 0.8162546, 'f1': 0.8088654, 'auroc': 0.93716604, 'binary_precision': 0.61904764, 'binary_recall': 0.65, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.63414633}
confusion matrix:
      0    1
0  5842  104
1    91  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 10
val acc:0.9639274477958679, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 26,now: 2024-06-01 10:18:51.040016,epoch time: 0:25:42.981067,used: 11:15:45.624049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96479386, 'precision': 0.7354445, 'recall': 0.8772934, 'specificity': 0.8772934, 'f1': 0.7878552, 'auroc': 0.967757, 'binary_precision': 0.47840813, 'binary_recall': 0.7836338, 'binary_specificity': 0.970953, 'binary_f1_score': 0.5941115}
confusion matrix:
       0     1
0  41182  1232
1    312  1130
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.73637295, 'recall': 0.8594707, 'specificity': 0.8594707, 'f1': 0.7834376, 'auroc': 0.9574815, 'binary_precision': 0.48229665, 'binary_recall': 0.7488856, 'binary_specificity': 0.9700559, 'binary_f1_score': 0.5867287}
confusion matrix:
       0    1
0  17526  541
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7936095, 'recall': 0.75229955, 'specificity': 0.75229955, 'f1': 0.77119786, 'auroc': 0.9326231, 'binary_precision': 0.6081081, 'binary_recall': 0.5192308, 'binary_specificity': 0.9853683, 'binary_f1_score': 0.560166}
confusion matrix:
      0    1
0  5859   87
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 11
val acc:0.9621131420135498, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 27,now: 2024-06-01 10:44:45.679530,epoch time: 0:25:54.639514,used: 11:41:40.263563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9679861, 'precision': 0.75026965, 'recall': 0.8678904, 'specificity': 0.8678904, 'f1': 0.79654586, 'auroc': 0.97139245, 'binary_precision': 0.5088126, 'binary_recall': 0.760749, 'binary_specificity': 0.97503185, 'binary_f1_score': 0.60978323}
confusion matrix:
       0     1
0  41355  1059
1    345  1097
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.74043965, 'recall': 0.86137176, 'specificity': 0.86137176, 'f1': 0.78708863, 'auroc': 0.9604012, 'binary_precision': 0.49031007, 'binary_recall': 0.75185734, 'binary_specificity': 0.9708862, 'binary_f1_score': 0.59354836}
confusion matrix:
       0    1
0  17541  526
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7816571, 'recall': 0.7050635, 'specificity': 0.7050635, 'f1': 0.73659897, 'auroc': 0.9419209, 'binary_precision': 0.5882353, 'binary_recall': 0.42307693, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.49217004}
confusion matrix:
      0    1
0  5869   77
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 12
val acc:0.9630202651023865, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 28,now: 2024-06-01 11:10:26.700770,epoch time: 0:25:41.021240,used: 12:07:21.284803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9652727, 'precision': 0.7394833, 'recall': 0.9113711, 'specificity': 0.9113711, 'f1': 0.7998134, 'auroc': 0.97373724, 'binary_precision': 0.48407394, 'binary_recall': 0.8536754, 'binary_specificity': 0.9690668, 'binary_f1_score': 0.6178168}
confusion matrix:
       0     1
0  41102  1312
1    211  1231
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7375862, 'recall': 0.90007496, 'specificity': 0.90007496, 'f1': 0.79517865, 'auroc': 0.95984036, 'binary_precision': 0.48154506, 'binary_recall': 0.833581, 'binary_specificity': 0.9665689, 'binary_f1_score': 0.6104461}
confusion matrix:
       0    1
0  17463  604
1    112  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.80111396, 'recall': 0.77888626, 'specificity': 0.77888626, 'f1': 0.78952116, 'auroc': 0.94960153, 'binary_precision': 0.62083334, 'binary_recall': 0.5730769, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.596}
confusion matrix:
      0    1
0  5855   91
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 13
val acc:0.9617929458618164, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 29,now: 2024-06-01 11:35:46.513918,epoch time: 0:25:19.813148,used: 12:32:41.097951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9652955, 'precision': 0.7372903, 'recall': 0.8705188, 'specificity': 0.8705188, 'f1': 0.7874615, 'auroc': 0.97105265, 'binary_precision': 0.48259357, 'binary_recall': 0.76907074, 'binary_specificity': 0.9719668, 'binary_f1_score': 0.59304816}
confusion matrix:
       0     1
0  41225  1189
1    333  1109
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.7354388, 'recall': 0.87283945, 'specificity': 0.87283945, 'f1': 0.78643376, 'auroc': 0.95741117, 'binary_precision': 0.47937673, 'binary_recall': 0.7771174, 'binary_specificity': 0.9685615, 'binary_f1_score': 0.59297055}
confusion matrix:
       0    1
0  17499  568
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.7670429, 'recall': 0.71350163, 'specificity': 0.71350163, 'f1': 0.7369033, 'auroc': 0.93754685, 'binary_precision': 0.55825245, 'binary_recall': 0.44230768, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.49356222}
confusion matrix:
      0    1
0  5855   91
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 14
val acc:0.9616862535476685, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9656783938407898 / 0.9761521220207214
after epoch: 30,now: 2024-06-01 12:01:39.780346,epoch time: 0:25:53.266428,used: 12:58:34.364379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_03_05_seed_1_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:58:34.364379 at 2024-06-01 12:01:39.780346
persisted model performance metric: 

scalar performance:
{'acc': 0.96648407, 'precision': 0.81758976, 'recall': 0.7011443, 'specificity': 0.7011443, 'f1': 0.74488056, 'auroc': 0.94546497, 'binary_precision': 0.66049385, 'binary_recall': 0.41153845, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.507109}
confusion matrix:
      0    1
0  5891   55
1   153  107
oracle model performance metric: 

scalar performance:
{'acc': 0.97631323, 'precision': 0.8819711, 'recall': 0.79822314, 'specificity': 0.79822314, 'f1': 0.8344139, 'auroc': 0.9233654, 'binary_precision': 0.78109455, 'binary_recall': 0.60384613, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.68112797}
confusion matrix:
      0    1
0  5902   44
1   103  157
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21728 MiB |  10268 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    154 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |  10544 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279925 K  |  279921 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166137 K  |  166133 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279925 K  |  279921 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166137 K  |  166133 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     725    |     326    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      77    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    2772    |  150387 K  |  150387 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      52    |    2751    |   80450 K  |   80449 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21728 MiB |  20736 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    154 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279925 K  |  279925 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166137 K  |  166137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279925 K  |  279925 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166137 K  |  166137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     725    |     643    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      77    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150388 K  |  150388 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80451 K  |   80451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21728 MiB |  20736 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    154 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279925 K  |  279925 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166137 K  |  166137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279925 K  |  279925 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166137 K  |  166137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     725    |     643    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      77    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150388 K  |  150388 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80451 K  |   80451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735

 Experiment start at: 2024-06-01 12:14:14.031002
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96520174, 'precision': 0.6913855, 'recall': 0.5094178, 'specificity': 0.5094178, 'f1': 0.51006764, 'auroc': 0.8971684, 'binary_precision': 0.41666666, 'binary_recall': 0.019828156, 'binary_specificity': 0.99900734, 'binary_f1_score': 0.037854888}
confusion matrix:
       0   1
0  42269  42
1   1483  30
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.6686891, 'recall': 0.51645124, 'specificity': 0.51645124, 'f1': 0.52350307, 'auroc': 0.89636123, 'binary_precision': 0.36842105, 'binary_recall': 0.034883723, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.06373294}
confusion matrix:
       0   1
0  18135  36
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.92628014, 'recall': 0.5328911, 'specificity': 0.5328911, 'f1': 0.552208, 'auroc': 0.8850741, 'binary_precision': 0.8888889, 'binary_recall': 0.0661157, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12307692}
confusion matrix:
      0   1
0  5995   2
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 12:41:36.876626,epoch time: 0:27:22.845624,used: 0:27:22.845624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.7369292, 'recall': 0.600399, 'specificity': 0.600399, 'f1': 0.638292, 'auroc': 0.9223968, 'binary_precision': 0.50159234, 'binary_recall': 0.20819564, 'binary_specificity': 0.9926024, 'binary_f1_score': 0.29425505}
confusion matrix:
       0    1
0  41998  313
1   1198  315
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7362467, 'recall': 0.6396479, 'specificity': 0.6396479, 'f1': 0.67431474, 'auroc': 0.91670847, 'binary_precision': 0.4957265, 'binary_recall': 0.28903654, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.36516264}
confusion matrix:
       0    1
0  17994  177
1    428  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.90913427, 'recall': 0.69684637, 'specificity': 0.69684637, 'f1': 0.7628983, 'auroc': 0.906518, 'binary_precision': 0.84210527, 'binary_recall': 0.3966942, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.53932583}
confusion matrix:
      0   1
0  5979  18
1   146  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 13:07:58.357142,epoch time: 0:26:21.480516,used: 0:53:44.326140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7410428, 'recall': 0.7202358, 'specificity': 0.7202358, 'f1': 0.7301157, 'auroc': 0.9352561, 'binary_precision': 0.5014514, 'binary_recall': 0.45670852, 'binary_specificity': 0.9837631, 'binary_f1_score': 0.47803524}
confusion matrix:
       0    1
0  41624  687
1    822  691
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.7317262, 'recall': 0.7609958, 'specificity': 0.7609958, 'f1': 0.74539167, 'auroc': 0.9316793, 'binary_precision': 0.4787078, 'binary_recall': 0.5415282, 'binary_specificity': 0.9804634, 'binary_f1_score': 0.50818396}
confusion matrix:
       0    1
0  17816  355
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.89027154, 'recall': 0.7822058, 'specificity': 0.7822058, 'f1': 0.8267687, 'auroc': 0.91887146, 'binary_precision': 0.7976879, 'binary_recall': 0.57024795, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6650602}
confusion matrix:
      0    1
0  5962   35
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
early stop counter: 1
val acc:0.9663878679275513, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9777207970619202
after epoch: 3,now: 2024-06-01 13:34:19.165951,epoch time: 0:26:20.808809,used: 1:20:05.134949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74659145, 'recall': 0.7839312, 'specificity': 0.7839312, 'f1': 0.7637889, 'auroc': 0.93996334, 'binary_precision': 0.5079909, 'binary_recall': 0.5882353, 'binary_specificity': 0.9796271, 'binary_f1_score': 0.54517615}
confusion matrix:
       0    1
0  41449  862
1    623  890
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7391184, 'recall': 0.7799612, 'specificity': 0.7799612, 'f1': 0.7577503, 'auroc': 0.9390839, 'binary_precision': 0.4922426, 'binary_recall': 0.5797342, 'binary_specificity': 0.9801882, 'binary_f1_score': 0.532418}
confusion matrix:
       0    1
0  17811  360
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.8694749, 'recall': 0.811947, 'specificity': 0.811947, 'f1': 0.8380444, 'auroc': 0.9217002, 'binary_precision': 0.7536946, 'binary_recall': 0.6322314, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6876404}
confusion matrix:
      0    1
0  5947   50
1    89  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 2
val acc:0.967346727848053, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9777207970619202
after epoch: 4,now: 2024-06-01 14:00:11.751425,epoch time: 0:25:52.585474,used: 1:45:57.720423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9659319, 'precision': 0.74378467, 'recall': 0.70863473, 'specificity': 0.70863473, 'f1': 0.72468984, 'auroc': 0.9435899, 'binary_precision': 0.507764, 'binary_recall': 0.4322538, 'binary_specificity': 0.9850157, 'binary_f1_score': 0.46697608}
confusion matrix:
       0    1
0  41677  634
1    859  654
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.73890734, 'recall': 0.767943, 'specificity': 0.767943, 'f1': 0.7524998, 'auroc': 0.9403838, 'binary_precision': 0.49262536, 'binary_recall': 0.55481726, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.52187496}
confusion matrix:
       0    1
0  17827  344
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.87761194, 'recall': 0.7898867, 'specificity': 0.7898867, 'f1': 0.8274422, 'auroc': 0.91390806, 'binary_precision': 0.7717391, 'binary_recall': 0.58677685, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5955   42
1   100  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 3
val acc:0.9674000144004822, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9777207970619202
after epoch: 5,now: 2024-06-01 14:25:54.848584,epoch time: 0:25:43.097159,used: 2:11:40.817582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.966799, 'precision': 0.75091887, 'recall': 0.7356814, 'specificity': 0.7356814, 'f1': 0.7430345, 'auroc': 0.94889104, 'binary_precision': 0.52011293, 'binary_recall': 0.48743385, 'binary_specificity': 0.9839289, 'binary_f1_score': 0.5032434}
confusion matrix:
       0    1
0  41632  680
1    775  737
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7372151, 'recall': 0.794999, 'specificity': 0.794999, 'f1': 0.7626065, 'auroc': 0.9449667, 'binary_precision': 0.48741722, 'binary_recall': 0.6112957, 'binary_specificity': 0.9787023, 'binary_f1_score': 0.5423729}
confusion matrix:
       0    1
0  17784  387
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.9004085, 'recall': 0.79278654, 'specificity': 0.79278654, 'f1': 0.8374949, 'auroc': 0.93432945, 'binary_precision': 0.81714284, 'binary_recall': 0.59090906, 'binary_specificity': 0.994664, 'binary_f1_score': 0.6858513}
confusion matrix:
      0    1
0  5965   32
1    99  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
new oracle model saved
early stop counter: 4
val acc:0.9669205546379089, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 6,now: 2024-06-01 14:51:58.490801,epoch time: 0:26:03.642217,used: 2:37:44.459799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96778023, 'precision': 0.75779927, 'recall': 0.7777835, 'specificity': 0.7777835, 'f1': 0.7673756, 'auroc': 0.95543766, 'binary_precision': 0.5308868, 'binary_recall': 0.57369465, 'binary_specificity': 0.9818723, 'binary_f1_score': 0.5514612}
confusion matrix:
       0    1
0  41544  767
1    645  868
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.740136, 'recall': 0.76243174, 'specificity': 0.76243174, 'f1': 0.7507342, 'auroc': 0.9464762, 'binary_precision': 0.49545455, 'binary_recall': 0.54318935, 'binary_specificity': 0.9816741, 'binary_f1_score': 0.5182251}
confusion matrix:
       0    1
0  17838  333
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.86834824, 'recall': 0.7976509, 'specificity': 0.7976509, 'f1': 0.8288833, 'auroc': 0.9241887, 'binary_precision': 0.7525773, 'binary_recall': 0.60330576, 'binary_specificity': 0.991996, 'binary_f1_score': 0.6697247}
confusion matrix:
      0    1
0  5949   48
1    96  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 5
val acc:0.9676130414009094, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 7,now: 2024-06-01 15:17:27.255691,epoch time: 0:25:28.764890,used: 3:03:13.224689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668447, 'precision': 0.75152814, 'recall': 0.81203204, 'specificity': 0.81203204, 'f1': 0.77813846, 'auroc': 0.95388854, 'binary_precision': 0.5158395, 'binary_recall': 0.64573693, 'binary_specificity': 0.97832716, 'binary_f1_score': 0.5735251}
confusion matrix:
       0    1
0  41394  917
1    536  977
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.73013043, 'recall': 0.8151078, 'specificity': 0.8151078, 'f1': 0.76519567, 'auroc': 0.94803214, 'binary_precision': 0.4718563, 'binary_recall': 0.65448505, 'binary_specificity': 0.97573054, 'binary_f1_score': 0.5483647}
confusion matrix:
       0    1
0  17730  441
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.857491, 'recall': 0.8032656, 'specificity': 0.8032656, 'f1': 0.82793045, 'auroc': 0.933249, 'binary_precision': 0.73039216, 'binary_recall': 0.61570245, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.6681614}
confusion matrix:
      0    1
0  5942   55
1    93  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 6
val acc:0.9654290676116943, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 8,now: 2024-06-01 15:41:20.868980,epoch time: 0:23:53.613289,used: 3:27:06.837978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9676433, 'precision': 0.7563852, 'recall': 0.81308293, 'specificity': 0.81308293, 'f1': 0.78157496, 'auroc': 0.9594486, 'binary_precision': 0.5254965, 'binary_recall': 0.64705884, 'binary_specificity': 0.9791071, 'binary_f1_score': 0.5799763}
confusion matrix:
       0    1
0  41427  884
1    534  979
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.7385264, 'recall': 0.8079028, 'specificity': 0.8079028, 'f1': 0.76829714, 'auroc': 0.95146346, 'binary_precision': 0.48917198, 'binary_recall': 0.63787377, 'binary_specificity': 0.97793186, 'binary_f1_score': 0.5537131}
confusion matrix:
       0    1
0  17770  401
1    218  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.86579585, 'recall': 0.8117802, 'specificity': 0.8117802, 'f1': 0.836422, 'auroc': 0.9340992, 'binary_precision': 0.74634147, 'binary_recall': 0.6322314, 'binary_specificity': 0.991329, 'binary_f1_score': 0.68456376}
confusion matrix:
      0    1
0  5945   52
1    89  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 7
val acc:0.9670271277427673, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 9,now: 2024-06-01 16:05:16.558337,epoch time: 0:23:55.689357,used: 3:51:02.527335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96732384, 'precision': 0.7544365, 'recall': 0.82183975, 'specificity': 0.82183975, 'f1': 0.78371954, 'auroc': 0.9584861, 'binary_precision': 0.52095187, 'binary_recall': 0.6655651, 'binary_specificity': 0.9781144, 'binary_f1_score': 0.5844457}
confusion matrix:
       0     1
0  41385   926
1    506  1007
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.72950184, 'recall': 0.83177924, 'specificity': 0.83177924, 'f1': 0.77017725, 'auroc': 0.94895947, 'binary_precision': 0.469457, 'binary_recall': 0.6893688, 'binary_specificity': 0.97418964, 'binary_f1_score': 0.5585464}
confusion matrix:
       0    1
0  17702  469
1    187  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97547686, 'precision': 0.845145, 'recall': 0.8107797, 'specificity': 0.8107797, 'f1': 0.82696843, 'auroc': 0.9226471, 'binary_precision': 0.7050691, 'binary_recall': 0.6322314, 'binary_specificity': 0.989328, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5933   64
1    89  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 8
val acc:0.9650561809539795, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 10,now: 2024-06-01 16:29:05.439056,epoch time: 0:23:48.880719,used: 4:14:51.408054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9681225, 'precision': 0.7591512, 'recall': 0.82958233, 'specificity': 0.82958233, 'f1': 0.7896496, 'auroc': 0.9603132, 'binary_precision': 0.5298354, 'binary_recall': 0.6807667, 'binary_specificity': 0.978398, 'binary_f1_score': 0.5958924}
confusion matrix:
       0     1
0  41397   914
1    483  1030
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.7312613, 'recall': 0.8303658, 'specificity': 0.8303658, 'f1': 0.77100384, 'auroc': 0.95385, 'binary_precision': 0.47308132, 'binary_recall': 0.68604654, 'binary_specificity': 0.97468495, 'binary_f1_score': 0.56000006}
confusion matrix:
       0    1
0  17711  460
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.88358057, 'recall': 0.81459665, 'specificity': 0.81459665, 'f1': 0.8453566, 'auroc': 0.934286, 'binary_precision': 0.7817259, 'binary_recall': 0.6363636, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.70159453}
confusion matrix:
      0    1
0  5954   43
1    88  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 9
val acc:0.9654290676116943, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 11,now: 2024-06-01 16:52:38.691761,epoch time: 0:23:33.252705,used: 4:38:24.660759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9674836, 'precision': 0.7553853, 'recall': 0.8206479, 'specificity': 0.8206479, 'f1': 0.78387433, 'auroc': 0.95983064, 'binary_precision': 0.5229406, 'binary_recall': 0.66292137, 'binary_specificity': 0.9783744, 'binary_f1_score': 0.58466923}
confusion matrix:
       0     1
0  41396   915
1    510  1003
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.72800773, 'recall': 0.8196784, 'specificity': 0.8196784, 'f1': 0.76523185, 'auroc': 0.95365673, 'binary_precision': 0.46728972, 'binary_recall': 0.66445184, 'binary_specificity': 0.9749051, 'binary_f1_score': 0.5486969}
confusion matrix:
       0    1
0  17715  456
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.8651477, 'recall': 0.78327143, 'specificity': 0.78327143, 'f1': 0.8185423, 'auroc': 0.9343136, 'binary_precision': 0.74731183, 'binary_recall': 0.57438016, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.64953274}
confusion matrix:
      0    1
0  5950   47
1   103  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 10
val acc:0.9649496674537659, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 12,now: 2024-06-01 17:16:22.122669,epoch time: 0:23:43.430908,used: 5:02:08.091667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671413, 'precision': 0.75329304, 'recall': 0.8064499, 'specificity': 0.8064499, 'f1': 0.7770447, 'auroc': 0.96233237, 'binary_precision': 0.5197832, 'binary_recall': 0.63384, 'binary_specificity': 0.9790598, 'binary_f1_score': 0.5711733}
confusion matrix:
       0    1
0  41425  886
1    554  959
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.7271413, 'recall': 0.8092388, 'specificity': 0.8092388, 'f1': 0.76114136, 'auroc': 0.9559691, 'binary_precision': 0.46626505, 'binary_recall': 0.64285713, 'binary_specificity': 0.9756205, 'binary_f1_score': 0.5405028}
confusion matrix:
       0    1
0  17728  443
1    215  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.8504354, 'recall': 0.75624526, 'specificity': 0.75624526, 'f1': 0.79531807, 'auroc': 0.93293804, 'binary_precision': 0.72, 'binary_recall': 0.5206612, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.6043166}
confusion matrix:
      0    1
0  5948   49
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 11
val acc:0.9649496674537659, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 13,now: 2024-06-01 17:39:56.996982,epoch time: 0:23:34.874313,used: 5:25:42.965980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9668903, 'precision': 0.75225186, 'recall': 0.848382, 'specificity': 0.848382, 'f1': 0.79166746, 'auroc': 0.96036214, 'binary_precision': 0.5146226, 'binary_recall': 0.72108394, 'binary_specificity': 0.9756801, 'binary_f1_score': 0.60060555}
confusion matrix:
       0     1
0  41282  1029
1    422  1091
---- Validation: 
scalar performance:
{'acc': 0.9648964, 'precision': 0.7308439, 'recall': 0.8598033, 'specificity': 0.8598033, 'f1': 0.7794905, 'auroc': 0.9580519, 'binary_precision': 0.47021943, 'binary_recall': 0.7475083, 'binary_specificity': 0.9720984, 'binary_f1_score': 0.57729316}
confusion matrix:
       0    1
0  17664  507
1    152  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.8597685, 'recall': 0.81962776, 'specificity': 0.81962776, 'f1': 0.8383924, 'auroc': 0.9474219, 'binary_precision': 0.73364484, 'binary_recall': 0.6487603, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.6885965}
confusion matrix:
      0    1
0  5940   57
1    85  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 12
val acc:0.9648963809013367, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 14,now: 2024-06-01 18:03:39.511602,epoch time: 0:23:42.514620,used: 5:49:25.480600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9660688, 'precision': 0.7472979, 'recall': 0.8240577, 'specificity': 0.8240577, 'f1': 0.77988076, 'auroc': 0.9622592, 'binary_precision': 0.5064806, 'binary_recall': 0.67151356, 'binary_specificity': 0.97660184, 'binary_f1_score': 0.5774368}
confusion matrix:
       0     1
0  41321   990
1    497  1016
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.7286198, 'recall': 0.8205365, 'specificity': 0.8205365, 'f1': 0.76594543, 'auroc': 0.9560778, 'binary_precision': 0.46845794, 'binary_recall': 0.66611296, 'binary_specificity': 0.9749601, 'binary_f1_score': 0.5500686}
confusion matrix:
       0    1
0  17716  455
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.8489373, 'recall': 0.7480641, 'specificity': 0.7480641, 'f1': 0.78915477, 'auroc': 0.94128793, 'binary_precision': 0.7176471, 'binary_recall': 0.5041322, 'binary_specificity': 0.991996, 'binary_f1_score': 0.592233}
confusion matrix:
      0    1
0  5949   48
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 13
val acc:0.9650561809539795, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 15,now: 2024-06-01 18:27:18.510708,epoch time: 0:23:38.999106,used: 6:13:04.479706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9673923, 'precision': 0.75512755, 'recall': 0.8687171, 'specificity': 0.8687171, 'f1': 0.80028886, 'auroc': 0.9642087, 'binary_precision': 0.5188849, 'binary_recall': 0.7627231, 'binary_specificity': 0.97471106, 'binary_f1_score': 0.6176077}
confusion matrix:
       0     1
0  41241  1070
1    359  1154
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.73127896, 'recall': 0.85905534, 'specificity': 0.85905534, 'f1': 0.7796187, 'auroc': 0.95892704, 'binary_precision': 0.47114375, 'binary_recall': 0.74584717, 'binary_specificity': 0.9722635, 'binary_f1_score': 0.57749194}
confusion matrix:
       0    1
0  17667  504
1    153  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.8454894, 'recall': 0.7986331, 'specificity': 0.7986331, 'f1': 0.82018185, 'auroc': 0.94131756, 'binary_precision': 0.7067308, 'binary_recall': 0.607438, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.65333337}
confusion matrix:
      0    1
0  5936   61
1    95  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 14
val acc:0.9650029540061951, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 16,now: 2024-06-01 18:50:51.936433,epoch time: 0:23:33.425725,used: 6:36:37.905431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9627373, 'precision': 0.7344555, 'recall': 0.8831949, 'specificity': 0.8831949, 'f1': 0.78847903, 'auroc': 0.9618024, 'binary_precision': 0.47632203, 'binary_recall': 0.7977528, 'binary_specificity': 0.968637, 'binary_f1_score': 0.5964913}
confusion matrix:
       0     1
0  40984  1327
1    306  1207
---- Validation: 
scalar performance:
{'acc': 0.9625526, 'precision': 0.72034234, 'recall': 0.8569865, 'specificity': 0.8569865, 'f1': 0.77039677, 'auroc': 0.95680904, 'binary_precision': 0.44934803, 'binary_recall': 0.74418604, 'binary_specificity': 0.969787, 'binary_f1_score': 0.5603502}
confusion matrix:
       0    1
0  17622  549
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.81944275, 'recall': 0.81944275, 'specificity': 0.81944275, 'f1': 0.81944275, 'auroc': 0.9442536, 'binary_precision': 0.6528926, 'binary_recall': 0.6528926, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.6528926}
confusion matrix:
      0    1
0  5913   84
1    84  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 15
val acc:0.9625526070594788, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 17,now: 2024-06-01 19:14:33.246369,epoch time: 0:23:41.309936,used: 7:00:19.215367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9665252, 'precision': 0.7509662, 'recall': 0.8768716, 'specificity': 0.8768716, 'f1': 0.79968464, 'auroc': 0.96701765, 'binary_precision': 0.5099309, 'binary_recall': 0.7805684, 'binary_specificity': 0.9731748, 'binary_f1_score': 0.61687124}
confusion matrix:
       0     1
0  41176  1135
1    332  1181
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7289577, 'recall': 0.87550664, 'specificity': 0.87550664, 'f1': 0.7822128, 'auroc': 0.95975065, 'binary_precision': 0.46534654, 'binary_recall': 0.7807309, 'binary_specificity': 0.9702823, 'binary_f1_score': 0.58312654}
confusion matrix:
       0    1
0  17631  540
1    132  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.85343516, 'recall': 0.79698384, 'specificity': 0.79698384, 'f1': 0.82251334, 'auroc': 0.94292736, 'binary_precision': 0.7227723, 'binary_recall': 0.60330576, 'binary_specificity': 0.990662, 'binary_f1_score': 0.6576576}
confusion matrix:
      0    1
0  5941   56
1    96  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 16
val acc:0.9642038941383362, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 18,now: 2024-06-01 19:38:15.518570,epoch time: 0:23:42.272201,used: 7:24:01.487568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9669131, 'precision': 0.75273776, 'recall': 0.8706995, 'specificity': 0.8706995, 'f1': 0.7991506, 'auroc': 0.9659091, 'binary_precision': 0.5139442, 'binary_recall': 0.76734966, 'binary_specificity': 0.9740493, 'binary_f1_score': 0.61558855}
confusion matrix:
       0     1
0  41213  1098
1    352  1161
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.7308295, 'recall': 0.8494463, 'specificity': 0.8494463, 'f1': 0.7765139, 'auroc': 0.96088016, 'binary_precision': 0.47090518, 'binary_recall': 0.72591364, 'binary_specificity': 0.97297895, 'binary_f1_score': 0.57124186}
confusion matrix:
       0    1
0  17680  491
1    165  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.84488654, 'recall': 0.76615894, 'specificity': 0.76615894, 'f1': 0.79994565, 'auroc': 0.9389734, 'binary_precision': 0.7081081, 'binary_recall': 0.5413223, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.6135831}
confusion matrix:
      0    1
0  5943   54
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 17
val acc:0.9650561809539795, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 19,now: 2024-06-01 20:01:55.121089,epoch time: 0:23:39.602519,used: 7:47:41.090087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9659547, 'precision': 0.74836063, 'recall': 0.8804, 'specificity': 0.8804, 'f1': 0.79872745, 'auroc': 0.96688795, 'binary_precision': 0.5044398, 'binary_recall': 0.78849965, 'binary_specificity': 0.97230035, 'binary_f1_score': 0.6152656}
confusion matrix:
       0     1
0  41139  1172
1    320  1193
---- Validation: 
scalar performance:
{'acc': 0.9623395, 'precision': 0.72115743, 'recall': 0.87454355, 'specificity': 0.87454355, 'f1': 0.77552027, 'auroc': 0.95999193, 'binary_precision': 0.44976076, 'binary_recall': 0.7807309, 'binary_specificity': 0.9683562, 'binary_f1_score': 0.5707347}
confusion matrix:
       0    1
0  17596  575
1    132  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.8499193, 'recall': 0.81507874, 'specificity': 0.81507874, 'f1': 0.8314921, 'auroc': 0.94116235, 'binary_precision': 0.71428573, 'binary_recall': 0.6404959, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.6753813}
confusion matrix:
      0    1
0  5935   62
1    87  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 18
val acc:0.9623395204544067, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 20,now: 2024-06-01 20:25:24.210746,epoch time: 0:23:29.089657,used: 8:11:10.179744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96700436, 'precision': 0.75305736, 'recall': 0.86214316, 'specificity': 0.86214316, 'f1': 0.7967173, 'auroc': 0.9672686, 'binary_precision': 0.51522034, 'binary_recall': 0.74950427, 'binary_specificity': 0.974782, 'binary_f1_score': 0.61066234}
confusion matrix:
       0     1
0  41244  1067
1    379  1134
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7263647, 'recall': 0.85770196, 'specificity': 0.85770196, 'f1': 0.7753963, 'auroc': 0.9606725, 'binary_precision': 0.46138003, 'binary_recall': 0.74418604, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.56961226}
confusion matrix:
       0    1
0  17648  523
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.8285433, 'recall': 0.7694574, 'specificity': 0.7694574, 'f1': 0.7957763, 'auroc': 0.94504344, 'binary_precision': 0.6751269, 'binary_recall': 0.5495868, 'binary_specificity': 0.989328, 'binary_f1_score': 0.6059226}
confusion matrix:
      0    1
0  5933   64
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 19
val acc:0.9639375805854797, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 21,now: 2024-06-01 20:49:02.923869,epoch time: 0:23:38.713123,used: 8:34:48.892867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96686745, 'precision': 0.7525338, 'recall': 0.8719504, 'specificity': 0.8719504, 'f1': 0.7993814, 'auroc': 0.96859705, 'binary_precision': 0.51344204, 'binary_recall': 0.76999336, 'binary_specificity': 0.9739075, 'binary_f1_score': 0.6160762}
confusion matrix:
       0     1
0  41207  1104
1    348  1165
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7281399, 'recall': 0.865067, 'specificity': 0.865067, 'f1': 0.7788025, 'auroc': 0.9611665, 'binary_precision': 0.4644309, 'binary_recall': 0.7591362, 'binary_specificity': 0.97099775, 'binary_f1_score': 0.5762925}
confusion matrix:
       0    1
0  17644  527
1    145  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.81330776, 'recall': 0.73036796, 'specificity': 0.73036796, 'f1': 0.76485, 'auroc': 0.9371292, 'binary_precision': 0.64772725, 'binary_recall': 0.47107437, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5935   62
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 20
val acc:0.9642038941383362, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 22,now: 2024-06-01 21:12:44.597774,epoch time: 0:23:41.673905,used: 8:58:30.566772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9631252, 'precision': 0.73664236, 'recall': 0.8926367, 'specificity': 0.8926367, 'f1': 0.7926786, 'auroc': 0.9668598, 'binary_precision': 0.48, 'binary_recall': 0.81692004, 'binary_specificity': 0.9683534, 'binary_f1_score': 0.60469663}
confusion matrix:
       0     1
0  40972  1339
1    277  1236
---- Validation: 
scalar performance:
{'acc': 0.9627124, 'precision': 0.7243175, 'recall': 0.89320624, 'specificity': 0.89320624, 'f1': 0.78264785, 'auroc': 0.96146303, 'binary_precision': 0.45479706, 'binary_recall': 0.8189369, 'binary_specificity': 0.96747565, 'binary_f1_score': 0.5848161}
confusion matrix:
       0    1
0  17580  591
1    109  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.8047259, 'recall': 0.7621752, 'specificity': 0.7621752, 'f1': 0.7816763, 'auroc': 0.9375323, 'binary_precision': 0.62801933, 'binary_recall': 0.5371901, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.57906455}
confusion matrix:
      0    1
0  5920   77
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 21
val acc:0.9627124071121216, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 23,now: 2024-06-01 21:39:05.382545,epoch time: 0:26:20.784771,used: 9:24:51.351543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96752924, 'precision': 0.7557287, 'recall': 0.8544487, 'specificity': 0.8544487, 'f1': 0.79611707, 'auroc': 0.96788645, 'binary_precision': 0.5211466, 'binary_recall': 0.73298085, 'binary_specificity': 0.97591645, 'binary_f1_score': 0.60917324}
confusion matrix:
       0     1
0  41292  1019
1    404  1109
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7320759, 'recall': 0.85276854, 'specificity': 0.85276854, 'f1': 0.7784312, 'auroc': 0.96174574, 'binary_precision': 0.47317597, 'binary_recall': 0.73255813, 'binary_specificity': 0.97297895, 'binary_f1_score': 0.5749674}
confusion matrix:
       0    1
0  17680  491
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.81636, 'recall': 0.66790247, 'specificity': 0.66790247, 'f1': 0.71720326, 'auroc': 0.9266791, 'binary_precision': 0.65873015, 'binary_recall': 0.3429752, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.4510869}
confusion matrix:
      0   1
0  5954  43
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 22
val acc:0.9652692675590515, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 24,now: 2024-06-01 22:04:11.791371,epoch time: 0:25:06.408826,used: 9:49:57.760369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9684648, 'precision': 0.76066136, 'recall': 0.8864797, 'specificity': 0.8864797, 'f1': 0.80982125, 'auroc': 0.9714705, 'binary_precision': 0.5286652, 'binary_recall': 0.79841375, 'binary_specificity': 0.9745456, 'binary_f1_score': 0.63612425}
confusion matrix:
       0     1
0  41234  1077
1    305  1208
---- Validation: 
scalar performance:
{'acc': 0.96478987, 'precision': 0.73203295, 'recall': 0.88303673, 'specificity': 0.88303673, 'f1': 0.7866624, 'auroc': 0.96249354, 'binary_precision': 0.47099313, 'binary_recall': 0.79568106, 'binary_specificity': 0.9703924, 'binary_f1_score': 0.59172326}
confusion matrix:
       0    1
0  17633  538
1    123  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.81800467, 'recall': 0.71442264, 'specificity': 0.71442264, 'f1': 0.7551184, 'auroc': 0.9455141, 'binary_precision': 0.6583851, 'binary_recall': 0.43801653, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5260546}
confusion matrix:
      0    1
0  5942   55
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 23
val acc:0.964789867401123, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 25,now: 2024-06-01 22:27:54.994055,epoch time: 0:23:43.202684,used: 10:13:40.963053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9676889, 'precision': 0.7568062, 'recall': 0.8886272, 'specificity': 0.8886272, 'f1': 0.80755967, 'auroc': 0.97067195, 'binary_precision': 0.5207709, 'binary_recall': 0.8037013, 'binary_specificity': 0.973553, 'binary_f1_score': 0.63201666}
confusion matrix:
       0     1
0  41192  1119
1    297  1216
---- Validation: 
scalar performance:
{'acc': 0.963618, 'precision': 0.7265815, 'recall': 0.87681, 'specificity': 0.87681, 'f1': 0.780597, 'auroc': 0.96038127, 'binary_precision': 0.4604878, 'binary_recall': 0.78405315, 'binary_specificity': 0.9695669, 'binary_f1_score': 0.58020896}
confusion matrix:
       0    1
0  17618  553
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.8159708, 'recall': 0.71433926, 'specificity': 0.71433926, 'f1': 0.7544253, 'auroc': 0.9332635, 'binary_precision': 0.654321, 'binary_recall': 0.43801653, 'binary_specificity': 0.990662, 'binary_f1_score': 0.52475244}
confusion matrix:
      0    1
0  5941   56
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 24
val acc:0.9636179804801941, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 26,now: 2024-06-01 22:51:41.847344,epoch time: 0:23:46.853289,used: 10:37:27.816342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9685789, 'precision': 0.76148725, 'recall': 0.85531086, 'specificity': 0.85531086, 'f1': 0.800399, 'auroc': 0.9711261, 'binary_precision': 0.53262955, 'binary_recall': 0.73364174, 'binary_specificity': 0.97698, 'binary_f1_score': 0.61718094}
confusion matrix:
       0     1
0  41337   974
1    403  1110
---- Validation: 
scalar performance:
{'acc': 0.96510947, 'precision': 0.73256, 'recall': 0.87035304, 'specificity': 0.87035304, 'f1': 0.7837466, 'auroc': 0.96071666, 'binary_precision': 0.47293156, 'binary_recall': 0.769103, 'binary_specificity': 0.9716031, 'binary_f1_score': 0.5857053}
confusion matrix:
       0    1
0  17655  516
1    139  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.7889231, 'recall': 0.68301404, 'specificity': 0.68301404, 'f1': 0.72282237, 'auroc': 0.9350431, 'binary_precision': 0.60264903, 'binary_recall': 0.37603307, 'binary_specificity': 0.989995, 'binary_f1_score': 0.46310434}
confusion matrix:
      0   1
0  5937  60
1   151  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 25
val acc:0.9651094675064087, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 27,now: 2024-06-01 23:15:21.207267,epoch time: 0:23:39.359923,used: 11:01:07.176265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9597709, 'precision': 0.725935, 'recall': 0.9167104, 'specificity': 0.9167104, 'f1': 0.78893393, 'auroc': 0.97029215, 'binary_precision': 0.4566574, 'binary_recall': 0.87045604, 'binary_specificity': 0.9629647, 'binary_f1_score': 0.5990448}
confusion matrix:
       0     1
0  40744  1567
1    196  1317
---- Validation: 
scalar performance:
{'acc': 0.957652, 'precision': 0.7079764, 'recall': 0.9074563, 'specificity': 0.9074563, 'f1': 0.7708255, 'auroc': 0.9607015, 'binary_precision': 0.42096642, 'binary_recall': 0.8538206, 'binary_specificity': 0.9610919, 'binary_f1_score': 0.56390566}
confusion matrix:
       0    1
0  17464  707
1     88  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.8022275, 'recall': 0.7600257, 'specificity': 0.7600257, 'f1': 0.77936596, 'auroc': 0.94447255, 'binary_precision': 0.6231884, 'binary_recall': 0.53305787, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.57461023}
confusion matrix:
      0    1
0  5919   78
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 26
val acc:0.9576519727706909, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 28,now: 2024-06-01 23:38:55.142152,epoch time: 0:23:33.934885,used: 11:24:41.111150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.95899504, 'precision': 0.7221923, 'recall': 0.9045185, 'specificity': 0.9045185, 'f1': 0.78299266, 'auroc': 0.9690942, 'binary_precision': 0.45007032, 'binary_recall': 0.8460013, 'binary_specificity': 0.96303564, 'binary_f1_score': 0.5875603}
confusion matrix:
       0     1
0  40747  1564
1    233  1280
---- Validation: 
scalar performance:
{'acc': 0.9570127, 'precision': 0.7054453, 'recall': 0.90311074, 'specificity': 0.90311074, 'f1': 0.7676082, 'auroc': 0.9608017, 'binary_precision': 0.4161897, 'binary_recall': 0.84551495, 'binary_specificity': 0.9607066, 'binary_f1_score': 0.5578082}
confusion matrix:
       0    1
0  17457  714
1     93  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.7621137, 'recall': 0.72761655, 'specificity': 0.72761655, 'f1': 0.7435008, 'auroc': 0.93150985, 'binary_precision': 0.54545456, 'binary_recall': 0.47107437, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.50554323}
confusion matrix:
      0    1
0  5902   95
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 27
val acc:0.9570127129554749, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 29,now: 2024-06-02 00:02:52.797584,epoch time: 0:23:57.655432,used: 11:48:38.766582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9665936, 'precision': 0.75156474, 'recall': 0.8883785, 'specificity': 0.8883785, 'f1': 0.8034711, 'auroc': 0.97496593, 'binary_precision': 0.51027256, 'binary_recall': 0.8043622, 'binary_specificity': 0.9723949, 'binary_f1_score': 0.6244228}
confusion matrix:
       0     1
0  41143  1168
1    296  1217
---- Validation: 
scalar performance:
{'acc': 0.9621797, 'precision': 0.72238296, 'recall': 0.8945372, 'specificity': 0.8945372, 'f1': 0.78127295, 'auroc': 0.96387243, 'binary_precision': 0.45081967, 'binary_recall': 0.8222591, 'binary_specificity': 0.96681523, 'binary_f1_score': 0.58235294}
confusion matrix:
       0    1
0  17568  603
1    107  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8015332, 'recall': 0.6996263, 'specificity': 0.6996263, 'f1': 0.7391377, 'auroc': 0.93184865, 'binary_precision': 0.62658226, 'binary_recall': 0.4090909, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.49500003}
confusion matrix:
      0   1
0  5938  59
1   143  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011735.png
early stop counter: 28
val acc:0.9621797204017639, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.973713755607605 / 0.9790030717849731
after epoch: 30,now: 2024-06-02 00:26:41.303096,epoch time: 0:23:48.505512,used: 12:12:27.272094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_14_13_seed_2_21011735
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:12:27.272094 at 2024-06-02 00:26:41.303096
persisted model performance metric: 

scalar performance:
{'acc': 0.9748357, 'precision': 0.92318887, 'recall': 0.70536095, 'specificity': 0.70536095, 'f1': 0.7736357, 'auroc': 0.9203769, 'binary_precision': 0.8695652, 'binary_recall': 0.41322315, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.5602241}
confusion matrix:
      0    1
0  5982   15
1   142  100
oracle model performance metric: 

scalar performance:
{'acc': 0.9794839, 'precision': 0.9075388, 'recall': 0.7930367, 'specificity': 0.7930367, 'f1': 0.84010553, 'auroc': 0.9292456, 'binary_precision': 0.8313953, 'binary_recall': 0.59090906, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.69082123}
confusion matrix:
      0    1
0  5968   29
1    99  143
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |  88732 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32240 MiB |  20736 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    124 MiB |    126 MiB |    180 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 633130 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |   6442 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  419454 K  |  419450 K  |
|       from large pool |      87    |     908    |  170470 K  |  170470 K  |
|       from small pool |    3630    |    6639    |  248984 K  |  248980 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  419454 K  |  419450 K  |
|       from large pool |      87    |     908    |  170470 K  |  170470 K  |
|       from small pool |    3630    |    6639    |  248984 K  |  248980 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1053    |     643    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      62    |      63    |      90    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  223234 K  |  223234 K  |
|       from large pool |      24    |     203    |  102914 K  |  102914 K  |
|       from small pool |      50    |    2751    |  120319 K  |  120319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1098 MiB |  11504 MiB |  32240 MiB |  31142 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     94 MiB |    126 MiB |    180 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |      0 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  419454 K  |  419454 K  |
|       from large pool |       2    |     908    |  170470 K  |  170470 K  |
|       from small pool |       0    |    6639    |  248984 K  |  248984 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  419454 K  |  419454 K  |
|       from large pool |       2    |     908    |  170470 K  |  170470 K  |
|       from small pool |       0    |    6639    |  248984 K  |  248984 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      81    |     410    |    1053    |     972    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      47    |      63    |      90    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  223235 K  |  223235 K  |
|       from large pool |       4    |     203    |  102914 K  |  102914 K  |
|       from small pool |       0    |    2751    |  120321 K  |  120321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  2 00:29:13 2024]
Finished job 0.
1 of 1 steps (100%) done
