Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 13 00:41:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476

 Experiment start at: 2024-06-13 00:49:36.696222
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7466489, 'recall': 0.66429585, 'specificity': 0.66429585, 'f1': 0.69637185, 'auroc': 0.9283871, 'binary_precision': 0.51599586, 'binary_recall': 0.3396739, 'binary_specificity': 0.98891777, 'binary_f1_score': 0.40966818}
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7368076, 'recall': 0.6522061, 'specificity': 0.6522061, 'f1': 0.68432176, 'auroc': 0.9203563, 'binary_precision': 0.49754903, 'binary_recall': 0.31570762, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.38629878}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.90674657, 'recall': 0.56463385, 'specificity': 0.56463385, 'f1': 0.60341936, 'auroc': 0.90586615, 'binary_precision': 0.85, 'binary_recall': 0.1302682, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.22591361}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 01:16:23.178784,epoch time: 0:26:46.482562,used: 0:26:46.482562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.967848, 'precision': 0.7634888, 'recall': 0.6077018, 'specificity': 0.6077018, 'f1': 0.65002084, 'auroc': 0.9335293, 'binary_precision': 0.55348045, 'binary_recall': 0.22161795, 'binary_specificity': 0.9937856, 'binary_f1_score': 0.31650487}
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7379267, 'recall': 0.5728105, 'specificity': 0.5728105, 'f1': 0.6074464, 'auroc': 0.92927766, 'binary_precision': 0.5052083, 'binary_recall': 0.15085536, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.23233531}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.91384995, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_2.png
better model found
persisted
after epoch: 2,now: 2024-06-13 01:42:22.575284,epoch time: 0:25:59.396500,used: 0:52:45.879062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9679165, 'precision': 0.75768036, 'recall': 0.6532461, 'specificity': 0.6532461, 'f1': 0.69090295, 'auroc': 0.9376661, 'binary_precision': 0.53881806, 'binary_recall': 0.31589675, 'binary_specificity': 0.99059546, 'binary_f1_score': 0.39828694}
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.73933864, 'recall': 0.6230917, 'specificity': 0.6230917, 'f1': 0.66068214, 'auroc': 0.93274474, 'binary_precision': 0.50461537, 'binary_recall': 0.25505444, 'binary_specificity': 0.991129, 'binary_f1_score': 0.33884302}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9243773, 'recall': 0.5590535, 'specificity': 0.5590535, 'f1': 0.5951553, 'auroc': 0.91640633, 'binary_precision': 0.8857143, 'binary_recall': 0.118773945, 'binary_specificity': 0.999333, 'binary_f1_score': 0.20945947}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_3.png
better model found
persisted
after epoch: 3,now: 2024-06-13 02:08:24.919087,epoch time: 0:26:02.343803,used: 1:18:48.222865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9678252, 'precision': 0.75455654, 'recall': 0.6742923, 'specificity': 0.6742923, 'f1': 0.70615363, 'auroc': 0.93748534, 'binary_precision': 0.5311245, 'binary_recall': 0.35961932, 'binary_specificity': 0.9889653, 'binary_f1_score': 0.42886096}
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74743986, 'recall': 0.63839585, 'specificity': 0.63839585, 'f1': 0.6759577, 'auroc': 0.93821025, 'binary_precision': 0.519774, 'binary_recall': 0.28615862, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.3691073}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8718176, 'recall': 0.5340659, 'specificity': 0.5340659, 'f1': 0.553243, 'auroc': 0.920236, 'binary_precision': 0.7826087, 'binary_recall': 0.06896552, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.12676056}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_4.png
better model found
persisted
after epoch: 4,now: 2024-06-13 02:34:21.382259,epoch time: 0:25:56.463172,used: 1:44:44.686037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96896696, 'precision': 0.7654654, 'recall': 0.6988336, 'specificity': 0.6988336, 'f1': 0.72688884, 'auroc': 0.9410712, 'binary_precision': 0.55128205, 'binary_recall': 0.4092454, 'binary_specificity': 0.9884218, 'binary_f1_score': 0.469762}
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.74779975, 'recall': 0.6707033, 'specificity': 0.6707033, 'f1': 0.7014024, 'auroc': 0.9385334, 'binary_precision': 0.51826483, 'binary_recall': 0.35303265, 'binary_specificity': 0.988374, 'binary_f1_score': 0.41998148}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.92531896, 'recall': 0.57429576, 'specificity': 0.57429576, 'f1': 0.618574, 'auroc': 0.9193724, 'binary_precision': 0.8863636, 'binary_recall': 0.14942528, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.25573772}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-13 03:00:10.686299,epoch time: 0:25:49.304040,used: 2:10:33.990077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96910393, 'precision': 0.7752685, 'recall': 0.6513314, 'specificity': 0.6513314, 'f1': 0.6936587, 'auroc': 0.94365716, 'binary_precision': 0.5741206, 'binary_recall': 0.310673, 'binary_specificity': 0.9919898, 'binary_f1_score': 0.40317598}
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76179254, 'recall': 0.5974183, 'specificity': 0.5974183, 'f1': 0.6386607, 'auroc': 0.9420624, 'binary_precision': 0.55128205, 'binary_recall': 0.20062208, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.2941847}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.922198, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_6.png
better model found
persisted
after epoch: 6,now: 2024-06-13 03:26:00.950069,epoch time: 0:25:50.263770,used: 2:36:24.253847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96807635, 'precision': 0.7713834, 'recall': 0.5998877, 'specificity': 0.5998877, 'f1': 0.64268154, 'auroc': 0.9417081, 'binary_precision': 0.56981134, 'binary_recall': 0.20516305, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.3016983}
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7623173, 'recall': 0.569501, 'specificity': 0.569501, 'f1': 0.605223, 'auroc': 0.94262934, 'binary_precision': 0.55421686, 'binary_recall': 0.14307931, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.2274413}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.920668, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_7.png
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9598913192749023 / 0.9637264013290405
after epoch: 7,now: 2024-06-13 03:51:47.053092,epoch time: 0:25:46.103023,used: 3:02:10.356870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9695378, 'precision': 0.7697808, 'recall': 0.71520543, 'specificity': 0.71520543, 'f1': 0.7391132, 'auroc': 0.94718516, 'binary_precision': 0.55879825, 'binary_recall': 0.44255608, 'binary_specificity': 0.9878547, 'binary_f1_score': 0.4939302}
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7579577, 'recall': 0.68245006, 'specificity': 0.68245006, 'f1': 0.7130645, 'auroc': 0.9430222, 'binary_precision': 0.5377778, 'binary_recall': 0.3763608, 'binary_specificity': 0.98853934, 'binary_f1_score': 0.44281796}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.91402704, 'recall': 0.5608858, 'specificity': 0.5608858, 'f1': 0.5978065, 'auroc': 0.92127305, 'binary_precision': 0.8648649, 'binary_recall': 0.12260536, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2147651}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_8.png
better model found
persisted
after epoch: 8,now: 2024-06-13 04:17:42.282133,epoch time: 0:25:55.229041,used: 3:28:05.585911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9699032, 'precision': 0.78274333, 'recall': 0.66978985, 'specificity': 0.66978985, 'f1': 0.71088564, 'auroc': 0.9486797, 'binary_precision': 0.58783007, 'binary_recall': 0.34806255, 'binary_specificity': 0.9915172, 'binary_f1_score': 0.43723315}
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7584933, 'recall': 0.6184474, 'specificity': 0.6184474, 'f1': 0.6600243, 'auroc': 0.9450327, 'binary_precision': 0.5432526, 'binary_recall': 0.24416797, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.33690986}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.92284775, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_9.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9626078605651855 / 0.9637264013290405
after epoch: 9,now: 2024-06-13 04:43:32.823400,epoch time: 0:25:50.541267,used: 3:53:56.127178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9702457, 'precision': 0.78274596, 'recall': 0.68986, 'specificity': 0.68986, 'f1': 0.7263205, 'auroc': 0.95005524, 'binary_precision': 0.58648926, 'binary_recall': 0.3892663, 'binary_specificity': 0.99045366, 'binary_f1_score': 0.4679461}
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7624984, 'recall': 0.647225, 'specificity': 0.647225, 'f1': 0.68708163, 'auroc': 0.9455289, 'binary_precision': 0.5492958, 'binary_recall': 0.30326593, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.39078155}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.9234501, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_10.png
better model found
persisted
after epoch: 10,now: 2024-06-13 05:09:26.265389,epoch time: 0:25:53.441989,used: 4:19:49.569167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9701772, 'precision': 0.77532744, 'recall': 0.7243947, 'specificity': 0.7243947, 'f1': 0.74700636, 'auroc': 0.9472009, 'binary_precision': 0.56926954, 'binary_recall': 0.46091095, 'binary_specificity': 0.9878784, 'binary_f1_score': 0.5093915}
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.76789117, 'recall': 0.6738351, 'specificity': 0.6738351, 'f1': 0.7098652, 'auroc': 0.946311, 'binary_precision': 0.55825245, 'binary_recall': 0.3576983, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.43601894}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.9246994, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_11.png
better model found
persisted
after epoch: 11,now: 2024-06-13 05:35:19.486738,epoch time: 0:25:53.221349,used: 4:45:42.790516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97033703, 'precision': 0.7918087, 'recall': 0.6636785, 'specificity': 0.6636785, 'f1': 0.7081405, 'auroc': 0.9490267, 'binary_precision': 0.6063961, 'binary_recall': 0.33491847, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.43150982}
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.76577854, 'recall': 0.6420573, 'specificity': 0.6420573, 'f1': 0.68337685, 'auroc': 0.94663423, 'binary_precision': 0.556213, 'binary_recall': 0.29237947, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.38328236}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.9239021, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_12.png
early stop counter: 1
val acc:0.9678054451942444, best validation acc: 0.9683375954627991, corresponding to test acc:                         0.960210919380188 / 0.9637264013290405
after epoch: 12,now: 2024-06-13 06:01:07.317417,epoch time: 0:25:47.830679,used: 5:11:30.621195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97015435, 'precision': 0.8043369, 'recall': 0.63014233, 'specificity': 0.63014233, 'f1': 0.67952716, 'auroc': 0.95159507, 'binary_precision': 0.6337115, 'binary_recall': 0.265625, 'binary_specificity': 0.9946597, 'binary_f1_score': 0.37434182}
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.77545655, 'recall': 0.58863807, 'specificity': 0.58863807, 'f1': 0.63014615, 'auroc': 0.9475307, 'binary_precision': 0.5792079, 'binary_recall': 0.18195957, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.2769231}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.92387205, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_13.png
early stop counter: 2
val acc:0.9674861431121826, best validation acc: 0.9683375954627991, corresponding to test acc:                         0.960210919380188 / 0.9637264013290405
after epoch: 13,now: 2024-06-13 06:27:05.277471,epoch time: 0:25:57.960054,used: 5:37:28.581249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9705654, 'precision': 0.79370975, 'recall': 0.6678359, 'specificity': 0.6678359, 'f1': 0.7121037, 'auroc': 0.9497175, 'binary_precision': 0.6099034, 'binary_recall': 0.3433039, 'binary_specificity': 0.99236786, 'binary_f1_score': 0.43932146}
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7763102, 'recall': 0.62574893, 'specificity': 0.62574893, 'f1': 0.67033726, 'auroc': 0.9478965, 'binary_precision': 0.5783972, 'binary_recall': 0.25816485, 'binary_specificity': 0.993333, 'binary_f1_score': 0.35698923}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.92370725, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_14.png
early stop counter: 3
val acc:0.9681779742240906, best validation acc: 0.9683375954627991, corresponding to test acc:                         0.960210919380188 / 0.9637264013290405
after epoch: 14,now: 2024-06-13 06:53:11.943043,epoch time: 0:26:06.665572,used: 6:03:35.246821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9710678, 'precision': 0.7869922, 'recall': 0.7153408, 'specificity': 0.7153408, 'f1': 0.7455702, 'auroc': 0.9518738, 'binary_precision': 0.59323585, 'binary_recall': 0.44119647, 'binary_specificity': 0.98948514, 'binary_f1_score': 0.5060429}
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7863796, 'recall': 0.6783292, 'specificity': 0.6783292, 'f1': 0.7186259, 'auroc': 0.94915944, 'binary_precision': 0.5949367, 'binary_recall': 0.36547434, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.45279384}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8132309, 'recall': 0.51874024, 'specificity': 0.51874024, 'f1': 0.52577436, 'auroc': 0.9256588, 'binary_precision': 0.6666667, 'binary_recall': 0.038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.072463766}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_15.png
better model found
persisted
after epoch: 15,now: 2024-06-13 07:19:05.186453,epoch time: 0:25:53.243410,used: 6:29:28.490231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9708851, 'precision': 0.78187597, 'recall': 0.7318289, 'specificity': 0.7318289, 'f1': 0.75417423, 'auroc': 0.9497824, 'binary_precision': 0.58187866, 'binary_recall': 0.47554347, 'binary_specificity': 0.98811436, 'binary_f1_score': 0.5233645}
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.7756698, 'recall': 0.6945549, 'specificity': 0.6945549, 'f1': 0.72742844, 'auroc': 0.94841814, 'binary_precision': 0.57238305, 'binary_recall': 0.39968896, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.47069597}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.83299243, 'recall': 0.5225716, 'specificity': 0.5225716, 'f1': 0.5327879, 'auroc': 0.92421436, 'binary_precision': 0.7058824, 'binary_recall': 0.04597701, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.086330935}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_16.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 16,now: 2024-06-13 07:44:53.920839,epoch time: 0:25:48.734386,used: 6:55:17.224617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9712505, 'precision': 0.80744165, 'recall': 0.66359705, 'specificity': 0.66359705, 'f1': 0.7117225, 'auroc': 0.9481889, 'binary_precision': 0.63766235, 'binary_recall': 0.33378655, 'binary_specificity': 0.99340755, 'binary_f1_score': 0.43819726}
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.77906036, 'recall': 0.6152206, 'specificity': 0.6152206, 'f1': 0.6601628, 'auroc': 0.94797194, 'binary_precision': 0.5846154, 'binary_recall': 0.23639192, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.33665562}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.92259604, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_17.png
early stop counter: 2
val acc:0.9681247472763062, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 17,now: 2024-06-13 08:10:43.295441,epoch time: 0:25:49.374602,used: 7:21:06.599219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9710906, 'precision': 0.78587705, 'recall': 0.7227552, 'specificity': 0.7227552, 'f1': 0.75002193, 'auroc': 0.95314556, 'binary_precision': 0.59050965, 'binary_recall': 0.45652175, 'binary_specificity': 0.98898864, 'binary_f1_score': 0.5149425}
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.7810117, 'recall': 0.6879697, 'specificity': 0.6879697, 'f1': 0.7243776, 'auroc': 0.949529, 'binary_precision': 0.5835294, 'binary_recall': 0.38569206, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.46441948}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.88066745, 'recall': 0.5378973, 'specificity': 0.5378973, 'f1': 0.5598728, 'auroc': 0.9247204, 'binary_precision': 0.8, 'binary_recall': 0.07662835, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13986014}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_18.png
early stop counter: 3
val acc:0.9695615172386169, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 18,now: 2024-06-13 08:36:34.839667,epoch time: 0:25:51.544226,used: 7:46:58.143445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9701087, 'precision': 0.80882275, 'recall': 0.62192225, 'specificity': 0.62192225, 'f1': 0.6716727, 'auroc': 0.9531093, 'binary_precision': 0.6432337, 'binary_recall': 0.2486413, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.3586477}
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.80507696, 'recall': 0.5769678, 'specificity': 0.5769678, 'f1': 0.6179501, 'auroc': 0.94946444, 'binary_precision': 0.6392405, 'binary_recall': 0.15707621, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.25218478}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.92332995, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_19.png
early stop counter: 4
val acc:0.9681247472763062, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 19,now: 2024-06-13 09:02:19.690451,epoch time: 0:25:44.850784,used: 8:12:42.994229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97131896, 'precision': 0.78899026, 'recall': 0.7197359, 'specificity': 0.7197359, 'f1': 0.7492013, 'auroc': 0.9528121, 'binary_precision': 0.5969342, 'binary_recall': 0.450034, 'binary_specificity': 0.9894379, 'binary_f1_score': 0.5131783}
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.77813387, 'recall': 0.6886096, 'specificity': 0.6886096, 'f1': 0.72395533, 'auroc': 0.9490881, 'binary_precision': 0.57772624, 'binary_recall': 0.38724726, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.46368715}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.9239061, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_20.png
early stop counter: 5
val acc:0.969348669052124, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 20,now: 2024-06-13 09:28:02.841305,epoch time: 0:25:43.150854,used: 8:38:26.145083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97157013, 'precision': 0.7940692, 'recall': 0.71283966, 'specificity': 0.71283966, 'f1': 0.7463418, 'auroc': 0.9507812, 'binary_precision': 0.6075829, 'binary_recall': 0.43546197, 'binary_specificity': 0.9902174, 'binary_f1_score': 0.50732094}
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.781615, 'recall': 0.67058074, 'specificity': 0.67058074, 'f1': 0.71119297, 'auroc': 0.9498564, 'binary_precision': 0.5859375, 'binary_recall': 0.34992224, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.43816942}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.9249494, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_21.png
early stop counter: 6
val acc:0.9692954421043396, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 21,now: 2024-06-13 09:53:50.436182,epoch time: 0:25:47.594877,used: 9:04:13.739960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.972141, 'precision': 0.8004991, 'recall': 0.7160858, 'specificity': 0.7160858, 'f1': 0.75076544, 'auroc': 0.954558, 'binary_precision': 0.620229, 'binary_recall': 0.4415761, 'binary_specificity': 0.99059546, 'binary_f1_score': 0.515873}
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.7822648, 'recall': 0.66530275, 'specificity': 0.66530275, 'f1': 0.7070875, 'auroc': 0.9505683, 'binary_precision': 0.58760107, 'binary_recall': 0.33903578, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.42998028}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.9252677, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_22.png
early stop counter: 7
val acc:0.9692422151565552, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 22,now: 2024-06-13 10:19:56.883579,epoch time: 0:26:06.447397,used: 9:30:20.187357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97241503, 'precision': 0.80940455, 'recall': 0.7007451, 'specificity': 0.7007451, 'f1': 0.74249387, 'auroc': 0.95243275, 'binary_precision': 0.6390658, 'binary_recall': 0.40952381, 'binary_specificity': 0.99196637, 'binary_f1_score': 0.49917084}
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.7951113, 'recall': 0.649022, 'specificity': 0.649022, 'f1': 0.69596, 'auroc': 0.9511268, 'binary_precision': 0.61442006, 'binary_recall': 0.30482116, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.40748444}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.9249268, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_23.png
early stop counter: 8
val acc:0.9696679711341858, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 23,now: 2024-06-13 10:45:58.349046,epoch time: 0:26:01.465467,used: 9:56:21.652824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97234654, 'precision': 0.80632704, 'recall': 0.7073399, 'specificity': 0.7073399, 'f1': 0.74644834, 'auroc': 0.9539087, 'binary_precision': 0.6324873, 'binary_recall': 0.4232337, 'binary_specificity': 0.99144614, 'binary_f1_score': 0.5071225}
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.79085606, 'recall': 0.6595227, 'specificity': 0.6595227, 'f1': 0.704333, 'auroc': 0.9501459, 'binary_precision': 0.6051873, 'binary_recall': 0.32659408, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.4242424}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.92502075, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_24.png
early stop counter: 9
val acc:0.9696679711341858, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.959092378616333 / 0.9637264013290405
after epoch: 24,now: 2024-06-13 11:11:56.185854,epoch time: 0:25:57.836808,used: 10:22:19.489632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97225523, 'precision': 0.799741, 'recall': 0.7233578, 'specificity': 0.7233578, 'f1': 0.75545764, 'auroc': 0.9548446, 'binary_precision': 0.61821526, 'binary_recall': 0.45652175, 'binary_specificity': 0.9901938, 'binary_f1_score': 0.52520514}
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.7890438, 'recall': 0.67463404, 'specificity': 0.67463404, 'f1': 0.7164304, 'auroc': 0.95057815, 'binary_precision': 0.6005222, 'binary_recall': 0.3576983, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.4483431}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8012492, 'recall': 0.5168245, 'specificity': 0.5168245, 'f1': 0.5222298, 'auroc': 0.92552674, 'binary_precision': 0.64285713, 'binary_recall': 0.03448276, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.06545454}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_25.png
better model found
persisted
after epoch: 25,now: 2024-06-13 11:37:48.197336,epoch time: 0:25:52.011482,used: 10:48:11.501114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97195834, 'precision': 0.82553977, 'recall': 0.65763235, 'specificity': 0.65763235, 'f1': 0.7101226, 'auroc': 0.9548359, 'binary_precision': 0.6742857, 'binary_recall': 0.3206522, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.43462247}
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.80716455, 'recall': 0.60899353, 'specificity': 0.60899353, 'f1': 0.657229, 'auroc': 0.9503839, 'binary_precision': 0.6412556, 'binary_recall': 0.22239502, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.33025405}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9242126, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_26.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9589325785636902 / 0.9637264013290405
after epoch: 26,now: 2024-06-13 12:03:42.831432,epoch time: 0:25:54.634096,used: 11:14:06.135210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97207254, 'precision': 0.8120936, 'recall': 0.68392015, 'specificity': 0.68392015, 'f1': 0.7300429, 'auroc': 0.9552872, 'binary_precision': 0.645614, 'binary_recall': 0.375, 'binary_specificity': 0.9928403, 'binary_f1_score': 0.4744306}
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8044025, 'recall': 0.64090914, 'specificity': 0.64090914, 'f1': 0.69015276, 'auroc': 0.95095414, 'binary_precision': 0.6335617, 'binary_recall': 0.28771386, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.39572197}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.92480516, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_27.png
better model found
persisted
after epoch: 27,now: 2024-06-13 12:29:40.555485,epoch time: 0:25:57.724053,used: 11:40:03.859263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9720268, 'precision': 0.79354686, 'recall': 0.736354, 'specificity': 0.736354, 'f1': 0.76156926, 'auroc': 0.9543958, 'binary_precision': 0.6049278, 'binary_recall': 0.48369566, 'binary_specificity': 0.9890123, 'binary_f1_score': 0.53756136}
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.7973845, 'recall': 0.6984643, 'specificity': 0.6984643, 'f1': 0.7371488, 'auroc': 0.95128477, 'binary_precision': 0.615566, 'binary_recall': 0.4059098, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.48922214}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.86679983, 'recall': 0.53215015, 'specificity': 0.53215015, 'f1': 0.54989326, 'auroc': 0.9258081, 'binary_precision': 0.77272725, 'binary_recall': 0.0651341, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.12014135}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_28.png
better model found
persisted
after epoch: 28,now: 2024-06-13 12:56:06.736829,epoch time: 0:26:26.181344,used: 12:06:30.040607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9714788, 'precision': 0.78477204, 'recall': 0.7508241, 'specificity': 0.7508241, 'f1': 0.76661503, 'auroc': 0.9543197, 'binary_precision': 0.58636713, 'binary_recall': 0.5142663, 'binary_specificity': 0.9873819, 'binary_f1_score': 0.54795516}
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.7859911, 'recall': 0.71846783, 'specificity': 0.71846783, 'f1': 0.7472687, 'auroc': 0.9505973, 'binary_precision': 0.59137577, 'binary_recall': 0.44790047, 'binary_specificity': 0.9890352, 'binary_f1_score': 0.5097345}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.83073217, 'recall': 0.5394795, 'specificity': 0.5394795, 'f1': 0.5619809, 'auroc': 0.9244827, 'binary_precision': 0.7, 'binary_recall': 0.08045977, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1443299}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_29.png
early stop counter: 1
val acc:0.9705193638801575, best validation acc: 0.9709982872009277, corresponding to test acc:                         0.960210919380188 / 0.9637264013290405
after epoch: 29,now: 2024-06-13 13:22:44.081396,epoch time: 0:26:37.344567,used: 12:33:07.385174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97188985, 'precision': 0.793384, 'recall': 0.72870904, 'specificity': 0.72870904, 'f1': 0.7566618, 'auroc': 0.95331764, 'binary_precision': 0.60510117, 'binary_recall': 0.4680272, 'binary_specificity': 0.98939085, 'binary_f1_score': 0.52780974}
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.79067314, 'recall': 0.6868278, 'specificity': 0.6868278, 'f1': 0.7264122, 'auroc': 0.95114625, 'binary_precision': 0.60294116, 'binary_recall': 0.38258165, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.46812558}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.9250734, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_30.png
early stop counter: 2
val acc:0.9702532887458801, best validation acc: 0.9709982872009277, corresponding to test acc:                         0.960210919380188 / 0.9637264013290405
after epoch: 30,now: 2024-06-13 13:49:07.694237,epoch time: 0:26:23.612841,used: 12:59:30.998015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_00_49_36_seed_0_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:59:30.998015 at 2024-06-13 13:49:07.694237
persisted model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.86679983, 'recall': 0.53215015, 'specificity': 0.53215015, 'f1': 0.54989326, 'auroc': 0.9258081, 'binary_precision': 0.77272725, 'binary_recall': 0.0651341, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.12014135}
oracle model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.92531896, 'recall': 0.57429576, 'specificity': 0.57429576, 'f1': 0.618574, 'auroc': 0.9193724, 'binary_precision': 0.8863636, 'binary_recall': 0.14942528, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.25573772}
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 688276 KiB |   1449 MiB | 458276 GiB | 458275 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 447395 GiB | 447394 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 688276 KiB |   1449 MiB | 458276 GiB | 458275 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 447395 GiB | 447394 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 687268 KiB |   1445 MiB | 457473 GiB | 457472 GiB |
|       from large pool | 684800 KiB |   1441 MiB | 446610 GiB | 446609 GiB |
|       from small pool |   2468 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1622 MiB |   1622 MiB |   1622 MiB |      0 B   |
|       from large pool |   1612 MiB |   1612 MiB |   1612 MiB |      0 B   |
|       from small pool |     10 MiB |     10 MiB |     10 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116587 KiB | 224696 KiB | 200773 GiB | 200773 GiB |
|       from large pool | 113920 KiB | 223488 KiB | 189855 GiB | 189855 GiB |
|       from small pool |   2667 KiB |   3932 KiB |  10918 GiB |  10918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2916    |    5887    |   90914 K  |   90911 K  |
|       from large pool |     100    |     205    |   28023 K  |   28023 K  |
|       from small pool |    2816    |    5786    |   62891 K  |   62888 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2916    |    5887    |   90914 K  |   90911 K  |
|       from large pool |     100    |     205    |   28023 K  |   28023 K  |
|       from small pool |    2816    |    5786    |   62891 K  |   62888 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |      79    |       0    |
|       from large pool |      74    |      74    |      74    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2784    |   38925 K  |   38925 K  |
|       from large pool |      39    |      69    |   11003 K  |   11003 K  |
|       from small pool |      14    |    2745    |   27921 K  |   27921 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 458276 GiB | 458276 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 447395 GiB | 447395 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 458276 GiB | 458276 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 447395 GiB | 447395 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 457473 GiB | 457473 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 446610 GiB | 446610 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1622 MiB |   1622 MiB |    836 MiB |
|       from large pool |    780 MiB |   1612 MiB |   1612 MiB |    832 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 224696 KiB | 200773 GiB | 200773 GiB |
|       from large pool |  24320 KiB | 223488 KiB | 189855 GiB | 189855 GiB |
|       from small pool |      0 KiB |   5055 KiB |  10918 GiB |  10918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90914 K  |   90914 K  |
|       from large pool |       2    |     205    |   28023 K  |   28023 K  |
|       from small pool |       0    |    5786    |   62891 K  |   62891 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90914 K  |   90914 K  |
|       from large pool |       2    |     205    |   28023 K  |   28023 K  |
|       from small pool |       0    |    5786    |   62891 K  |   62891 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2784    |   38926 K  |   38926 K  |
|       from large pool |       2    |      69    |   11003 K  |   11003 K  |
|       from small pool |       0    |    2745    |   27922 K  |   27922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 458276 GiB | 458276 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 447395 GiB | 447395 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 458276 GiB | 458276 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 447395 GiB | 447395 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 457473 GiB | 457473 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 446610 GiB | 446610 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1622 MiB |   1622 MiB |    836 MiB |
|       from large pool |    780 MiB |   1612 MiB |   1612 MiB |    832 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 224696 KiB | 200773 GiB | 200773 GiB |
|       from large pool |  24320 KiB | 223488 KiB | 189855 GiB | 189855 GiB |
|       from small pool |      0 KiB |   5055 KiB |  10918 GiB |  10918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90914 K  |   90914 K  |
|       from large pool |       2    |     205    |   28023 K  |   28023 K  |
|       from small pool |       0    |    5786    |   62891 K  |   62891 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90914 K  |   90914 K  |
|       from large pool |       2    |     205    |   28023 K  |   28023 K  |
|       from small pool |       0    |    5786    |   62891 K  |   62891 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2784    |   38926 K  |   38926 K  |
|       from large pool |       2    |      69    |   11003 K  |   11003 K  |
|       from small pool |       0    |    2745    |   27922 K  |   27922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_13_58_48_seed_1_21308476

 Experiment start at: 2024-06-13 13:58:48.613001
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9675757, 'precision': 0.7507613, 'recall': 0.5581825, 'specificity': 0.5581825, 'f1': 0.58957785, 'auroc': 0.91416705, 'binary_precision': 0.5306749, 'binary_recall': 0.11997226, 'binary_specificity': 0.9963927, 'binary_f1_score': 0.19570135}
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7310167, 'recall': 0.5578813, 'specificity': 0.5578813, 'f1': 0.58756363, 'auroc': 0.92724955, 'binary_precision': 0.49390244, 'binary_recall': 0.12035661, 'binary_specificity': 0.995406, 'binary_f1_score': 0.19354838}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.66115636, 'recall': 0.5071037, 'specificity': 0.5071037, 'f1': 0.5039291, 'auroc': 0.91183937, 'binary_precision': 0.36363637, 'binary_recall': 0.015384615, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.029520296}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 14:26:00.430276,epoch time: 0:27:11.817275,used: 0:27:11.817275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_13_58_48_seed_1_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9677353, 'precision': 0.746572, 'recall': 0.6363088, 'specificity': 0.6363088, 'f1': 0.6740317, 'auroc': 0.9261247, 'binary_precision': 0.51719743, 'binary_recall': 0.2815534, 'binary_specificity': 0.99106425, 'binary_f1_score': 0.36461607}
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75006545, 'recall': 0.6357113, 'specificity': 0.6357113, 'f1': 0.6741678, 'auroc': 0.9375305, 'binary_precision': 0.5264624, 'binary_recall': 0.28083208, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.36627904}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.85681224, 'recall': 0.5682217, 'specificity': 0.5682217, 'f1': 0.6071343, 'auroc': 0.92152625, 'binary_precision': 0.75, 'binary_recall': 0.13846155, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23376626}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-13 14:51:59.841928,epoch time: 0:25:59.411652,used: 0:53:11.228927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_13_58_48_seed_1_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9674845, 'precision': 0.74499106, 'recall': 0.5778975, 'specificity': 0.5778975, 'f1': 0.6144434, 'auroc': 0.9323028, 'binary_precision': 0.51785713, 'binary_recall': 0.16088766, 'binary_specificity': 0.9949073, 'binary_f1_score': 0.24550265}
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74728274, 'recall': 0.57466453, 'specificity': 0.57466453, 'f1': 0.61034787, 'auroc': 0.9415394, 'binary_precision': 0.5252525, 'binary_recall': 0.15453194, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.23880596}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8050356, 'recall': 0.5244114, 'specificity': 0.5244114, 'f1': 0.53596044, 'auroc': 0.92393386, 'binary_precision': 0.65, 'binary_recall': 0.05, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.09285714}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_3.png
early stop counter: 1
val acc:0.9646211266517639, best validation acc: 0.9651013612747192, corresponding to test acc:                         0.9619722962379456 / 0.9619722962379456
after epoch: 3,now: 2024-06-13 15:17:52.134581,epoch time: 0:25:52.292653,used: 1:19:03.521580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_13_58_48_seed_1_21308476
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96800894, 'precision': 0.748639, 'recall': 0.69272226, 'specificity': 0.69272226, 'f1': 0.7167725, 'auroc': 0.93524307, 'binary_precision': 0.51758343, 'binary_recall': 0.39805827, 'binary_specificity': 0.9873862, 'binary_f1_score': 0.45001963}
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7545276, 'recall': 0.709056, 'specificity': 0.709056, 'f1': 0.72930855, 'auroc': 0.9441391, 'binary_precision': 0.5300546, 'binary_recall': 0.43239227, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.47626838}
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8570442, 'recall': 0.57390684, 'specificity': 0.57390684, 'f1': 0.6153306, 'auroc': 0.9257554, 'binary_precision': 0.75, 'binary_recall': 0.15, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.25000003}
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21308476_4.png
[Thu Jun 13 15:43:46 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/9.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing central directory for archive dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_13_58_48_seed_1_21308476: file write failed
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
