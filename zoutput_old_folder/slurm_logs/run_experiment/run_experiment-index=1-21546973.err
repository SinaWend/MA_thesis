Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 10:05:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973

 Experiment start at: 2024-06-22 10:15:48.460490
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.45276013, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.4752036, 'auroc': 0.48541912, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  1
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.32700723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.3229993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:33:31.265181,epoch time: 0:17:42.804691,used: 0:17:42.804691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.49242887, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3162819, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.28228593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 10:50:43.054311,epoch time: 0:17:11.789130,used: 0:34:54.593821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.62371075, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.36626935, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.38389248, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 11:07:39.287836,epoch time: 0:16:56.233525,used: 0:51:50.827346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.70305896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3528071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.36963037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 11:24:09.721919,epoch time: 0:16:30.434083,used: 1:08:21.261429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.9527708, 'recall': 0.50011325, 'specificity': 0.50011325, 'f1': 0.47544134, 'auroc': 0.7660155, 'binary_precision': 1.0, 'binary_recall': 0.00022655189, 'binary_specificity': 1.0, 'binary_f1_score': 0.00045300118}
confusion matrix:
       0  1
0  42306  0
1   4413  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39316946, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.47158986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_5.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:40:11.162538,epoch time: 0:16:01.440619,used: 1:24:22.702048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9056293, 'precision': 0.9528116, 'recall': 0.50034, 'specificity': 0.50034, 'f1': 0.47591677, 'auroc': 0.77720106, 'binary_precision': 1.0, 'binary_recall': 0.00067996373, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013590034}
confusion matrix:
       0  1
0  42308  0
1   4409  3
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.38944286, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4779318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_6.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:56:06.595784,epoch time: 0:15:55.433246,used: 1:40:18.135294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.7131139, 'recall': 0.50399333, 'specificity': 0.50399333, 'f1': 0.48390123, 'auroc': 0.84289575, 'binary_precision': 0.52, 'binary_recall': 0.008837526, 'binary_specificity': 0.9991491, 'binary_f1_score': 0.017379679}
confusion matrix:
       0   1
0  42271  36
1   4374  39
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.48288438, 'recall': 0.4997796, 'specificity': 0.4997796, 'f1': 0.49118674, 'auroc': 0.4316855, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18141  8
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.60088044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_7.png
early stop counter: 5
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 12:12:03.300406,epoch time: 0:15:56.704622,used: 1:56:14.839916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9097603, 'precision': 0.94739646, 'recall': 0.5228411, 'specificity': 0.5228411, 'f1': 0.51998955, 'auroc': 0.87475514, 'binary_precision': 0.98536587, 'binary_recall': 0.045753114, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.087445885}
confusion matrix:
       0    1
0  42302    3
1   4213  202
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4447903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.58827496, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 12:28:03.653795,epoch time: 0:16:00.353389,used: 2:12:15.193305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9116224, 'precision': 0.94374144, 'recall': 0.5325703, 'specificity': 0.5325703, 'f1': 0.53794557, 'auroc': 0.8650929, 'binary_precision': 0.9762712, 'binary_recall': 0.06530612, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.122422956}
confusion matrix:
       0    1
0  42303    7
1   4122  288
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43106487, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.61469334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_9.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 12:44:17.510088,epoch time: 0:16:13.856293,used: 2:28:29.049598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9179366, 'precision': 0.9470479, 'recall': 0.5670224, 'specificity': 0.5670224, 'f1': 0.5964469, 'auroc': 0.8863331, 'binary_precision': 0.97693574, 'binary_recall': 0.1343757, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.23625498}
confusion matrix:
       0    1
0  42293   14
1   3820  593
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.44065922, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5829883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_10.png
early stop counter: 8
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-22 13:00:17.582260,epoch time: 0:16:00.072172,used: 2:44:29.121770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9307577, 'precision': 0.9493374, 'recall': 0.63750917, 'specificity': 0.63750917, 'f1': 0.6963479, 'auroc': 0.9160336, 'binary_precision': 0.96897376, 'binary_recall': 0.27594018, 'binary_specificity': 0.99907815, 'binary_f1_score': 0.4295539}
confusion matrix:
       0     1
0  42267    39
1   3196  1218
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.48288527, 'recall': 0.49980715, 'specificity': 0.49980715, 'f1': 0.4912005, 'auroc': 0.5258861, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18142  7
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72958696, 'recall': 0.510994, 'specificity': 0.510994, 'f1': 0.51131886, 'auroc': 0.69497633, 'binary_precision': 0.5, 'binary_recall': 0.022988506, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5991  6
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_11.png
early stop counter: 9
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-22 13:16:40.305940,epoch time: 0:16:22.723680,used: 3:00:51.845450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9368365, 'precision': 0.94843763, 'recall': 0.67186475, 'specificity': 0.67186475, 'f1': 0.7370865, 'auroc': 0.9231704, 'binary_precision': 0.96088326, 'binary_recall': 0.34519494, 'binary_specificity': 0.99853456, 'binary_f1_score': 0.5079206}
confusion matrix:
       0     1
0  42246    62
1   2889  1523
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.52457404, 'recall': 0.5004746, 'specificity': 0.5004746, 'f1': 0.49268544, 'auroc': 0.5379329, 'binary_precision': 0.083333336, 'binary_recall': 0.00155521, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.0030534351}
confusion matrix:
       0   1
0  18138  11
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.81368303, 'recall': 0.52998435, 'specificity': 0.52998435, 'f1': 0.54579777, 'auroc': 0.71864545, 'binary_precision': 0.6666667, 'binary_recall': 0.06130268, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1122807}
confusion matrix:
      0   1
0  5989   8
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_12.png
new oracle model saved
early stop counter: 10
val acc:0.9652511477470398, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 12,now: 2024-06-22 13:32:41.124022,epoch time: 0:16:00.818082,used: 3:16:52.663532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9389983, 'precision': 0.938195, 'recall': 0.68845654, 'specificity': 0.68845654, 'f1': 0.75382704, 'auroc': 0.9234073, 'binary_precision': 0.9373251, 'binary_recall': 0.37956038, 'binary_specificity': 0.99735266, 'binary_f1_score': 0.5403226}
confusion matrix:
       0     1
0  42195   112
1   2738  1675
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.49851412, 'recall': 0.49992356, 'specificity': 0.49992356, 'f1': 0.49236447, 'auroc': 0.5536639, 'binary_precision': 0.03125, 'binary_recall': 0.00155521, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.002962963}
confusion matrix:
       0   1
0  18118  31
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8559669, 'recall': 0.54531, 'specificity': 0.54531, 'f1': 0.57188916, 'auroc': 0.738143, 'binary_precision': 0.75, 'binary_recall': 0.09195402, 'binary_specificity': 0.998666, 'binary_f1_score': 0.16382253}
confusion matrix:
      0   1
0  5989   8
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_13.png
new oracle model saved
early stop counter: 11
val acc:0.9641869068145752, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9608501195907593
after epoch: 13,now: 2024-06-22 13:48:42.130652,epoch time: 0:16:01.006630,used: 3:32:53.670162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9464469, 'precision': 0.947534, 'recall': 0.7273967, 'specificity': 0.7273967, 'f1': 0.79420334, 'auroc': 0.93659914, 'binary_precision': 0.94873, 'binary_recall': 0.45736963, 'binary_specificity': 0.99742377, 'binary_f1_score': 0.6171971}
confusion matrix:
       0     1
0  42201   109
1   2393  2017
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.538521, 'recall': 0.50222886, 'specificity': 0.50222886, 'f1': 0.49680012, 'auroc': 0.5591984, 'binary_precision': 0.11111111, 'binary_recall': 0.00622084, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.011782032}
confusion matrix:
       0   1
0  18117  32
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.7360845, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_14.png
new oracle model saved
early stop counter: 12
val acc:0.9642933011054993, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9610099196434021
after epoch: 14,now: 2024-06-22 14:04:57.828761,epoch time: 0:16:15.698109,used: 3:49:09.368271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94621146, 'precision': 0.93519616, 'recall': 0.73288965, 'specificity': 0.73288965, 'f1': 0.7968854, 'auroc': 0.929469, 'binary_precision': 0.92300844, 'binary_recall': 0.4698686, 'binary_specificity': 0.99591076, 'binary_f1_score': 0.6227293}
confusion matrix:
       0     1
0  42133   173
1   2340  2074
---- Validation: 
scalar performance:
{'acc': 0.96365476, 'precision': 0.54069656, 'recall': 0.50339836, 'specificity': 0.50339836, 'f1': 0.49937558, 'auroc': 0.56004715, 'binary_precision': 0.115384616, 'binary_recall': 0.00933126, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.017266188}
confusion matrix:
       0   1
0  18103  46
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8153524, 'recall': 0.5712128, 'specificity': 0.5712128, 'f1': 0.60957724, 'auroc': 0.7610911, 'binary_precision': 0.6666667, 'binary_recall': 0.14559387, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2389937}
confusion matrix:
      0   1
0  5978  19
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_15.png
new oracle model saved
early stop counter: 13
val acc:0.9636547565460205, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9613295197486877
after epoch: 15,now: 2024-06-22 14:20:58.342058,epoch time: 0:16:00.513297,used: 4:05:09.881568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94901544, 'precision': 0.94321537, 'recall': 0.7450336, 'specificity': 0.7450336, 'f1': 0.8095046, 'auroc': 0.93777496, 'binary_precision': 0.9367742, 'binary_recall': 0.4935418, 'binary_specificity': 0.9965254, 'binary_f1_score': 0.64648265}
confusion matrix:
       0     1
0  42160   147
1   2235  2178
---- Validation: 
scalar performance:
{'acc': 0.962963, 'precision': 0.5226501, 'recall': 0.5022901, 'specificity': 0.5022901, 'f1': 0.49764562, 'auroc': 0.5948286, 'binary_precision': 0.07936508, 'binary_recall': 0.00777605, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.014164306}
confusion matrix:
       0   1
0  18091  58
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8452725, 'recall': 0.5942013, 'specificity': 0.5942013, 'f1': 0.6420781, 'auroc': 0.7595867, 'binary_precision': 0.7246377, 'binary_recall': 0.19157088, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30303028}
confusion matrix:
      0   1
0  5978  19
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_16.png
new oracle model saved
early stop counter: 14
val acc:0.9629629850387573, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 16,now: 2024-06-22 14:36:51.680008,epoch time: 0:15:53.337950,used: 4:21:03.219518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9545377, 'precision': 0.9338833, 'recall': 0.78481424, 'specificity': 0.78481424, 'f1': 0.8403075, 'auroc': 0.94479907, 'binary_precision': 0.9104264, 'binary_recall': 0.5755379, 'binary_specificity': 0.99409056, 'binary_f1_score': 0.7052456}
confusion matrix:
       0     1
0  42055   250
1   1874  2541
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.57328165, 'recall': 0.5117378, 'specificity': 0.5117378, 'f1': 0.51463085, 'auroc': 0.62833667, 'binary_precision': 0.18, 'binary_recall': 0.02799378, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.048452225}
confusion matrix:
       0   1
0  18067  82
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.79731435, 'recall': 0.6250175, 'specificity': 0.6250175, 'f1': 0.672434, 'auroc': 0.79483545, 'binary_precision': 0.62616825, 'binary_recall': 0.256705, 'binary_specificity': 0.99333, 'binary_f1_score': 0.36413044}
confusion matrix:
      0   1
0  5957  40
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_17.png
early stop counter: 15
val acc:0.9623776078224182, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 17,now: 2024-06-22 14:53:02.578414,epoch time: 0:16:10.898406,used: 4:37:14.117924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9526541, 'precision': 0.9287041, 'recall': 0.7768768, 'specificity': 0.7768768, 'f1': 0.83266914, 'auroc': 0.94365823, 'binary_precision': 0.90156764, 'binary_recall': 0.5601359, 'binary_specificity': 0.9936178, 'binary_f1_score': 0.6909751}
confusion matrix:
       0     1
0  42035   270
1   1942  2473
---- Validation: 
scalar performance:
{'acc': 0.9613133, 'precision': 0.55527264, 'recall': 0.5104368, 'specificity': 0.5104368, 'f1': 0.51246744, 'auroc': 0.6444019, 'binary_precision': 0.1440678, 'binary_recall': 0.02643857, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.044678055}
confusion matrix:
       0    1
0  18048  101
1    626   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.80571216, 'recall': 0.65325284, 'specificity': 0.65325284, 'f1': 0.7015201, 'auroc': 0.7991991, 'binary_precision': 0.640625, 'binary_recall': 0.31417623, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.42159384}
confusion matrix:
      0   1
0  5951  46
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_18.png
new oracle model saved
early stop counter: 16
val acc:0.9613133072853088, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 18,now: 2024-06-22 15:09:44.696544,epoch time: 0:16:42.118130,used: 4:53:56.236054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95747006, 'precision': 0.9249376, 'recall': 0.81077695, 'specificity': 0.81077695, 'f1': 0.8568262, 'auroc': 0.9499605, 'binary_precision': 0.8873644, 'binary_recall': 0.6298981, 'binary_specificity': 0.9916558, 'binary_f1_score': 0.7367863}
confusion matrix:
       0     1
0  41952   353
1   1634  2781
---- Validation: 
scalar performance:
{'acc': 0.9598233, 'precision': 0.59098345, 'recall': 0.52841675, 'specificity': 0.52841675, 'f1': 0.5397861, 'auroc': 0.64480495, 'binary_precision': 0.21428572, 'binary_recall': 0.065318815, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.10011919}
confusion matrix:
       0    1
0  17995  154
1    601   42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7868125, 'recall': 0.6711593, 'specificity': 0.6711593, 'f1': 0.7127197, 'auroc': 0.7993543, 'binary_precision': 0.6013072, 'binary_recall': 0.35249043, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.44444448}
confusion matrix:
      0   1
0  5936  61
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_19.png
early stop counter: 17
val acc:0.9598233103752136, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 19,now: 2024-06-22 15:26:00.365957,epoch time: 0:16:15.669413,used: 5:10:11.905467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95547944, 'precision': 0.90967214, 'recall': 0.8120297, 'specificity': 0.8120297, 'f1': 0.85256135, 'auroc': 0.9543421, 'binary_precision': 0.85640085, 'binary_recall': 0.6351688, 'binary_specificity': 0.9888907, 'binary_f1_score': 0.72937804}
confusion matrix:
       0     1
0  41837   470
1   1610  2803
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.5702354, 'recall': 0.51616174, 'specificity': 0.51616174, 'f1': 0.5217518, 'auroc': 0.6538068, 'binary_precision': 0.1736111, 'binary_recall': 0.038880248, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.0635324}
confusion matrix:
       0    1
0  18030  119
1    618   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.79836965, 'recall': 0.65300274, 'specificity': 0.65300274, 'f1': 0.6997808, 'auroc': 0.7929923, 'binary_precision': 0.6259542, 'binary_recall': 0.31417623, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.41836733}
confusion matrix:
      0   1
0  5948  49
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_20.png
early stop counter: 18
val acc:0.9607811570167542, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 20,now: 2024-06-22 15:41:52.228549,epoch time: 0:15:51.862592,used: 5:26:03.768059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9558861, 'precision': 0.9155705, 'recall': 0.80890536, 'specificity': 0.80890536, 'f1': 0.8524207, 'auroc': 0.9574805, 'binary_precision': 0.8688833, 'binary_recall': 0.6276909, 'binary_specificity': 0.9901198, 'binary_f1_score': 0.72885144}
confusion matrix:
       0     1
0  41889   418
1   1643  2770
---- Validation: 
scalar performance:
{'acc': 0.95875907, 'precision': 0.5781125, 'recall': 0.52636564, 'specificity': 0.52636564, 'f1': 0.5362334, 'auroc': 0.7213279, 'binary_precision': 0.18867925, 'binary_recall': 0.0622084, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.09356726}
confusion matrix:
       0    1
0  17977  172
1    603   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.7867061, 'recall': 0.6841524, 'specificity': 0.6841524, 'f1': 0.72296506, 'auroc': 0.82290053, 'binary_precision': 0.6, 'binary_recall': 0.37931034, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4647887}
confusion matrix:
      0   1
0  5931  66
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_21.png
early stop counter: 19
val acc:0.958759069442749, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 21,now: 2024-06-22 15:58:11.918669,epoch time: 0:16:19.690120,used: 5:42:23.458179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9577911, 'precision': 0.90791285, 'recall': 0.83008784, 'specificity': 0.83008784, 'f1': 0.8638196, 'auroc': 0.9544382, 'binary_precision': 0.8492563, 'binary_recall': 0.6726325, 'binary_specificity': 0.98754317, 'binary_f1_score': 0.75069535}
confusion matrix:
       0     1
0  41779   527
1   1445  2969
---- Validation: 
scalar performance:
{'acc': 0.95689654, 'precision': 0.58773094, 'recall': 0.53965247, 'specificity': 0.53965247, 'f1': 0.5525289, 'auroc': 0.6731093, 'binary_precision': 0.20701754, 'binary_recall': 0.09175739, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.12715517}
confusion matrix:
       0    1
0  17923  226
1    584   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7722453, 'recall': 0.7056402, 'specificity': 0.7056402, 'f1': 0.7337196, 'auroc': 0.81969845, 'binary_precision': 0.5692308, 'binary_recall': 0.42528737, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.48684213}
confusion matrix:
      0    1
0  5913   84
1   150  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_22.png
early stop counter: 20
val acc:0.9568965435028076, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 22,now: 2024-06-22 16:13:47.392637,epoch time: 0:15:35.473968,used: 5:57:58.932147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95828336, 'precision': 0.9206071, 'recall': 0.82011247, 'specificity': 0.82011247, 'f1': 0.8618308, 'auroc': 0.95464945, 'binary_precision': 0.87679607, 'binary_recall': 0.64975077, 'binary_specificity': 0.99047416, 'binary_f1_score': 0.74638903}
confusion matrix:
       0     1
0  41903   403
1   1546  2868
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.5857289, 'recall': 0.5294761, 'specificity': 0.5294761, 'f1': 0.5407254, 'auroc': 0.6611428, 'binary_precision': 0.2037037, 'binary_recall': 0.06842924, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.10244471}
confusion matrix:
       0    1
0  17977  172
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7813424, 'recall': 0.68390226, 'specificity': 0.68390226, 'f1': 0.7212135, 'auroc': 0.8103814, 'binary_precision': 0.58928573, 'binary_recall': 0.37931034, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.46153846}
confusion matrix:
      0   1
0  5928  69
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_23.png
early stop counter: 21
val acc:0.9589719176292419, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9640460014343262
after epoch: 23,now: 2024-06-22 16:29:32.268390,epoch time: 0:15:44.875753,used: 6:13:43.807900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95976025, 'precision': 0.9166198, 'recall': 0.8341174, 'specificity': 0.8341174, 'f1': 0.86966413, 'auroc': 0.9575228, 'binary_precision': 0.8659734, 'binary_recall': 0.67920256, 'binary_specificity': 0.98903227, 'binary_f1_score': 0.76130015}
confusion matrix:
       0     1
0  41842   464
1   1416  2998
---- Validation: 
scalar performance:
{'acc': 0.96019584, 'precision': 0.5919045, 'recall': 0.5271095, 'specificity': 0.5271095, 'f1': 0.538134, 'auroc': 0.66345584, 'binary_precision': 0.21621622, 'binary_recall': 0.0622084, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.09661836}
confusion matrix:
       0    1
0  18004  145
1    603   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.79745924, 'recall': 0.6809046, 'specificity': 0.6809046, 'f1': 0.72339827, 'auroc': 0.807957, 'binary_precision': 0.6217949, 'binary_recall': 0.3716475, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.4652278}
confusion matrix:
      0   1
0  5938  59
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_24.png
new oracle model saved
early stop counter: 22
val acc:0.9601958394050598, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9643656015396118
after epoch: 24,now: 2024-06-22 16:44:59.702655,epoch time: 0:15:27.434265,used: 6:29:11.242165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9577483, 'precision': 0.9081154, 'recall': 0.82955694, 'specificity': 0.82955694, 'f1': 0.86355615, 'auroc': 0.95608115, 'binary_precision': 0.84977067, 'binary_recall': 0.6714998, 'binary_specificity': 0.98761404, 'binary_f1_score': 0.75018984}
confusion matrix:
       0     1
0  41782   524
1   1450  2964
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.5895808, 'recall': 0.5364256, 'specificity': 0.5364256, 'f1': 0.54928577, 'auroc': 0.6725292, 'binary_precision': 0.2109375, 'binary_recall': 0.083981335, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.12013348}
confusion matrix:
       0    1
0  17947  202
1    589   54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.76355815, 'recall': 0.70697224, 'specificity': 0.70697224, 'f1': 0.7314224, 'auroc': 0.8203783, 'binary_precision': 0.55172414, 'binary_recall': 0.42911878, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.4827586}
confusion matrix:
      0    1
0  5906   91
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_25.png
early stop counter: 23
val acc:0.9579076170921326, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9643656015396118
after epoch: 25,now: 2024-06-22 17:00:44.714500,epoch time: 0:15:45.011845,used: 6:44:56.254010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95721316, 'precision': 0.8929757, 'recall': 0.8445835, 'specificity': 0.8445835, 'f1': 0.8667511, 'auroc': 0.95673704, 'binary_precision': 0.8162035, 'binary_recall': 0.7057357, 'binary_specificity': 0.9834314, 'binary_f1_score': 0.7569605}
confusion matrix:
       0     1
0  41608   701
1   1298  3113
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.58914346, 'recall': 0.54043007, 'specificity': 0.54043007, 'f1': 0.55355024, 'auroc': 0.66980994, 'binary_precision': 0.20979021, 'binary_recall': 0.0933126, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.12917116}
confusion matrix:
       0    1
0  17923  226
1    583   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7611808, 'recall': 0.71971524, 'specificity': 0.71971524, 'f1': 0.7384234, 'auroc': 0.82062745, 'binary_precision': 0.54587156, 'binary_recall': 0.4559387, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.49686843}
confusion matrix:
      0    1
0  5898   99
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_26.png
early stop counter: 24
val acc:0.956949770450592, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9643656015396118
after epoch: 26,now: 2024-06-22 17:16:24.789722,epoch time: 0:15:40.075222,used: 7:00:36.329232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9623288, 'precision': 0.9290186, 'recall': 0.8385439, 'specificity': 0.8385439, 'f1': 0.8771044, 'auroc': 0.96009046, 'binary_precision': 0.89003235, 'binary_recall': 0.6859279, 'binary_specificity': 0.99115986, 'binary_f1_score': 0.7747633}
confusion matrix:
       0     1
0  41933   374
1   1386  3027
---- Validation: 
scalar performance:
{'acc': 0.9581737, 'precision': 0.58564985, 'recall': 0.5328131, 'specificity': 0.5328131, 'f1': 0.5447214, 'auroc': 0.67822766, 'binary_precision': 0.2033195, 'binary_recall': 0.07620529, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.11085973}
confusion matrix:
       0    1
0  17957  192
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.81583786, 'recall': 0.7040599, 'specificity': 0.7040599, 'f1': 0.7466252, 'auroc': 0.8120892, 'binary_precision': 0.6566265, 'binary_recall': 0.41762453, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.5105387}
confusion matrix:
      0    1
0  5940   57
1   152  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_27.png
new oracle model saved
early stop counter: 25
val acc:0.9581736922264099, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9666027426719666
after epoch: 27,now: 2024-06-22 17:32:39.501155,epoch time: 0:16:14.711433,used: 7:16:51.040665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96181506, 'precision': 0.9283438, 'recall': 0.83578855, 'specificity': 0.83578855, 'f1': 0.8750506, 'auroc': 0.95653224, 'binary_precision': 0.88921803, 'binary_recall': 0.68041706, 'binary_specificity': 0.99116004, 'binary_f1_score': 0.77092963}
confusion matrix:
       0     1
0  41934   374
1   1410  3002
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.60131377, 'recall': 0.5405616, 'specificity': 0.5405616, 'f1': 0.5553328, 'auroc': 0.68446845, 'binary_precision': 0.23412699, 'binary_recall': 0.09175739, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.13184358}
confusion matrix:
       0    1
0  17956  193
1    584   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.7824725, 'recall': 0.72288156, 'specificity': 0.72288156, 'f1': 0.74872917, 'auroc': 0.82256293, 'binary_precision': 0.5882353, 'binary_recall': 0.4597701, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.516129}
confusion matrix:
      0    1
0  5913   84
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_28.png
early stop counter: 26
val acc:0.9586526155471802, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9666027426719666
after epoch: 28,now: 2024-06-22 17:49:09.509540,epoch time: 0:16:30.008385,used: 7:33:21.049050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96331334, 'precision': 0.9123422, 'recall': 0.86374795, 'specificity': 0.86374795, 'f1': 0.88611126, 'auroc': 0.96620166, 'binary_precision': 0.8513408, 'binary_recall': 0.74099255, 'binary_specificity': 0.9865034, 'binary_f1_score': 0.7923431}
confusion matrix:
       0     1
0  41736   571
1   1143  3270
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.6151306, 'recall': 0.5489775, 'specificity': 0.5489775, 'f1': 0.5663268, 'auroc': 0.7051467, 'binary_precision': 0.26119402, 'binary_recall': 0.108864695, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.15367727}
confusion matrix:
       0    1
0  17951  198
1    573   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.79148185, 'recall': 0.7549484, 'specificity': 0.7549484, 'f1': 0.7718418, 'auroc': 0.83452755, 'binary_precision': 0.6035242, 'binary_recall': 0.5249042, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5614754}
confusion matrix:
      0    1
0  5907   90
1   124  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_29.png
early stop counter: 27
val acc:0.9589719176292419, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9666027426719666
after epoch: 29,now: 2024-06-22 18:05:22.713005,epoch time: 0:16:13.203465,used: 7:49:34.252515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9570848, 'precision': 0.8887543, 'recall': 0.8498243, 'specificity': 0.8498243, 'f1': 0.8679731, 'auroc': 0.9572742, 'binary_precision': 0.8066242, 'binary_recall': 0.7175884, 'binary_specificity': 0.98206013, 'binary_f1_score': 0.7595058}
confusion matrix:
       0     1
0  41549   759
1   1246  3166
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.59293896, 'recall': 0.5603083, 'specificity': 0.5603083, 'f1': 0.57235605, 'auroc': 0.677331, 'binary_precision': 0.21601942, 'binary_recall': 0.13841368, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.16872038}
confusion matrix:
       0    1
0  17826  323
1    554   89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.74493146, 'recall': 0.735039, 'specificity': 0.735039, 'f1': 0.7398687, 'auroc': 0.83342695, 'binary_precision': 0.512, 'binary_recall': 0.49042144, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.50097847}
confusion matrix:
      0    1
0  5875  122
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_30.png
early stop counter: 28
val acc:0.9533312320709229, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9666027426719666
after epoch: 30,now: 2024-06-22 18:21:21.709616,epoch time: 0:15:58.996611,used: 8:05:33.249126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:05:33.249126 at 2024-06-22 18:21:21.709616
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.28228593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96660274, 'precision': 0.81583786, 'recall': 0.7040599, 'specificity': 0.7040599, 'f1': 0.7466252, 'auroc': 0.8120892, 'binary_precision': 0.6566265, 'binary_recall': 0.41762453, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.5105387}
confusion matrix:
      0    1
0  5940   57
1   152  109
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3689    |   49207 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32559 K  |   32557 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3689    |   49207 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32559 K  |   32557 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1476    |   22384 K  |   22384 K  |
|       from large pool |       5    |      10    |    6195 K  |    6195 K  |
|       from small pool |      46    |    1470    |   16188 K  |   16188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973

 Experiment start at: 2024-06-22 18:28:35.333418
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90541524, 'precision': 0.45361057, 'recall': 0.49890316, 'specificity': 0.49890316, 'f1': 0.47518003, 'auroc': 0.4139729, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9978063, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42301  93
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.48906407, 'recall': 0.49650016, 'specificity': 0.49650016, 'f1': 0.49141562, 'auroc': 0.31214884, 'binary_precision': 0.014285714, 'binary_recall': 0.004457652, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.006795017}
confusion matrix:
       0    1
0  17860  207
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479536, 'precision': 0.4788377, 'recall': 0.4947023, 'specificity': 0.4947023, 'f1': 0.48664075, 'auroc': 0.21198285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5883  63
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 18:45:28.966366,epoch time: 0:16:53.632948,used: 0:16:53.632948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9068493, 'precision': 0.45367712, 'recall': 0.49969336, 'specificity': 0.49969336, 'f1': 0.47557473, 'auroc': 0.5090981, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993867, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42368  26
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.4820265, 'recall': 0.49950185, 'specificity': 0.49950185, 'f1': 0.4906086, 'auroc': 0.33379996, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18049  18
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.22116938, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 19:01:19.966101,epoch time: 0:15:50.999735,used: 0:32:44.632683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9074058, 'precision': 0.45373204, 'recall': 0.49996462, 'specificity': 0.49996462, 'f1': 0.47572774, 'auroc': 0.5789802, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42394  3
1   4323  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.33514386, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.23664731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_3.png
better model found
persisted
after epoch: 3,now: 2024-06-22 19:17:14.292501,epoch time: 0:15:54.326400,used: 0:48:38.959083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9069135, 'precision': 0.45370924, 'recall': 0.49969336, 'specificity': 0.49969336, 'f1': 0.47559234, 'auroc': 0.643139, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993867, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42371  26
1   4323   0
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.3505878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.24813579, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_4.png
early stop counter: 1
val acc:0.9634471535682678, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-22 19:33:11.023752,epoch time: 0:15:56.731251,used: 1:04:35.690334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9073844, 'precision': 0.45372134, 'recall': 0.49996462, 'specificity': 0.49996462, 'f1': 0.47572184, 'auroc': 0.71592, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42393  3
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.35663012, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.30963153, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_5.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-22 19:48:58.176588,epoch time: 0:15:47.152836,used: 1:20:22.843170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90650684, 'precision': 0.45366126, 'recall': 0.49950466, 'specificity': 0.49950466, 'f1': 0.47548053, 'auroc': 0.7778826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990093, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42352  42
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.36786243, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3262206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_6.png
early stop counter: 3
val acc:0.9637140035629272, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 20:05:13.857024,epoch time: 0:16:15.680436,used: 1:36:38.523606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9069992, 'precision': 0.62782615, 'recall': 0.5022445, 'specificity': 0.5022445, 'f1': 0.481066, 'auroc': 0.8306, 'binary_precision': 0.3478261, 'binary_recall': 0.005550416, 'binary_specificity': 0.99893856, 'binary_f1_score': 0.010926474}
confusion matrix:
       0   1
0  42351  45
1   4300  24
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.39145282, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36458123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_7.png
early stop counter: 4
val acc:0.9637140035629272, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 20:21:18.110945,epoch time: 0:16:04.253921,used: 1:52:42.777527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.57757646, 'recall': 0.50342727, 'specificity': 0.50342727, 'f1': 0.48475713, 'auroc': 0.84274065, 'binary_precision': 0.24712643, 'binary_recall': 0.009944496, 'binary_specificity': 0.9969101, 'binary_f1_score': 0.019119607}
confusion matrix:
       0    1
0  42265  131
1   4281   43
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.4820217, 'recall': 0.49936348, 'specificity': 0.49936348, 'f1': 0.49053937, 'auroc': 0.4071289, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18044  23
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4212218, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_8.png
early stop counter: 5
val acc:0.9628601670265198, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-22 20:37:19.208068,epoch time: 0:16:01.097123,used: 2:08:43.874650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91104454, 'precision': 0.78130937, 'recall': 0.53893733, 'specificity': 0.53893733, 'f1': 0.5496695, 'auroc': 0.8724029, 'binary_precision': 0.64845175, 'binary_recall': 0.08242649, 'binary_specificity': 0.99544823, 'binary_f1_score': 0.1462613}
confusion matrix:
       0    1
0  42208  193
1   3963  356
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.48202938, 'recall': 0.49958488, 'specificity': 0.49958488, 'f1': 0.49065018, 'auroc': 0.4142925, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18052  15
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.50410163, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_9.png
early stop counter: 6
val acc:0.9632871150970459, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 20:53:52.303485,epoch time: 0:16:33.095417,used: 2:25:16.970067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9147688, 'precision': 0.839993, 'recall': 0.55553806, 'specificity': 0.55553806, 'f1': 0.5772127, 'auroc': 0.8730622, 'binary_precision': 0.7630769, 'binary_recall': 0.1147086, 'binary_specificity': 0.9963676, 'binary_f1_score': 0.19943707}
confusion matrix:
       0    1
0  42242  154
1   3828  496
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.482038, 'recall': 0.49983394, 'specificity': 0.49983394, 'f1': 0.49077466, 'auroc': 0.40878677, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18061  6
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.462054, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_10.png
early stop counter: 7
val acc:0.9637673497200012, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 21:10:06.742692,epoch time: 0:16:14.439207,used: 2:41:31.409274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92669094, 'precision': 0.8884071, 'recall': 0.6245836, 'specificity': 0.6245836, 'f1': 0.6758386, 'auroc': 0.89106643, 'binary_precision': 0.8478764, 'binary_recall': 0.25381416, 'binary_specificity': 0.9953531, 'binary_f1_score': 0.39067787}
confusion matrix:
       0     1
0  42197   197
1   3228  1098
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.48202458, 'recall': 0.4994465, 'specificity': 0.4994465, 'f1': 0.49058095, 'auroc': 0.45247433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998893, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18047  20
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5524862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_11.png
early stop counter: 8
val acc:0.9630202651023865, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 21:25:50.447230,epoch time: 0:15:43.704538,used: 2:57:15.113812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9339041, 'precision': 0.8950949, 'recall': 0.66961014, 'specificity': 0.66961014, 'f1': 0.72812897, 'auroc': 0.9162954, 'binary_precision': 0.85314286, 'binary_recall': 0.34528214, 'binary_specificity': 0.9939381, 'binary_f1_score': 0.4916035}
confusion matrix:
       0     1
0  42139   257
1   2831  1493
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.48200727, 'recall': 0.49894837, 'specificity': 0.49894837, 'f1': 0.49033156, 'auroc': 0.49791312, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18029  38
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.6599291, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_12.png
early stop counter: 9
val acc:0.962059736251831, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 21:41:44.997595,epoch time: 0:15:54.550365,used: 3:13:09.664177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93379706, 'precision': 0.8854191, 'recall': 0.6744317, 'specificity': 0.6744317, 'f1': 0.73175204, 'auroc': 0.9230443, 'binary_precision': 0.83288264, 'binary_recall': 0.3561517, 'binary_specificity': 0.9927116, 'binary_f1_score': 0.498947}
confusion matrix:
       0     1
0  42087   309
1   2784  1540
---- Validation: 
scalar performance:
{'acc': 0.9600854, 'precision': 0.48849, 'recall': 0.49863967, 'specificity': 0.49863967, 'f1': 0.49115092, 'auroc': 0.5600909, 'binary_precision': 0.012987013, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.0026666666}
confusion matrix:
       0   1
0  17991  76
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.7580856, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_13.png
new oracle model saved
early stop counter: 10
val acc:0.960085391998291, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 13,now: 2024-06-22 21:57:20.026024,epoch time: 0:15:35.028429,used: 3:28:44.692606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94186646, 'precision': 0.8952152, 'recall': 0.72411096, 'specificity': 0.72411096, 'f1': 0.78069055, 'auroc': 0.9343379, 'binary_precision': 0.8433632, 'binary_recall': 0.4568786, 'binary_specificity': 0.9913433, 'binary_f1_score': 0.59268147}
confusion matrix:
       0     1
0  42028   367
1   2349  1976
---- Validation: 
scalar performance:
{'acc': 0.9610459, 'precision': 0.4904884, 'recall': 0.49913782, 'specificity': 0.49913782, 'f1': 0.49143362, 'auroc': 0.5725148, 'binary_precision': 0.016949153, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.0027322404}
confusion matrix:
       0   1
0  18009  58
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7294222, 'recall': 0.5091949, 'specificity': 0.5091949, 'f1': 0.5078119, 'auroc': 0.73591554, 'binary_precision': 0.5, 'binary_recall': 0.01923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.037037037}
confusion matrix:
      0  1
0  5941  5
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_14.png
early stop counter: 11
val acc:0.9610459208488464, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 14,now: 2024-06-22 22:13:09.214346,epoch time: 0:15:49.188322,used: 3:44:33.880928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94659674, 'precision': 0.8969741, 'recall': 0.7555641, 'specificity': 0.7555641, 'f1': 0.80732846, 'auroc': 0.937338, 'binary_precision': 0.84092605, 'binary_recall': 0.5211757, 'binary_specificity': 0.98995256, 'binary_f1_score': 0.6435205}
confusion matrix:
       0     1
0  41973   426
1   2069  2252
---- Validation: 
scalar performance:
{'acc': 0.95955175, 'precision': 0.50840217, 'recall': 0.501224, 'specificity': 0.501224, 'f1': 0.4961868, 'auroc': 0.5945278, 'binary_precision': 0.05263158, 'binary_recall': 0.0074294205, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.013020833}
confusion matrix:
       0   1
0  17977  90
1    668   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7226608, 'recall': 0.52933973, 'specificity': 0.52933973, 'f1': 0.54383934, 'auroc': 0.7616153, 'binary_precision': 0.4848485, 'binary_recall': 0.06153846, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.10921502}
confusion matrix:
      0   1
0  5929  17
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_15.png
early stop counter: 12
val acc:0.9595517516136169, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 15,now: 2024-06-22 22:30:01.610143,epoch time: 0:16:52.395797,used: 4:01:26.276725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94544095, 'precision': 0.9050913, 'recall': 0.7410158, 'specificity': 0.7410158, 'f1': 0.79750645, 'auroc': 0.9276433, 'binary_precision': 0.85998374, 'binary_recall': 0.49016887, 'binary_specificity': 0.99186265, 'binary_f1_score': 0.62442905}
confusion matrix:
       0     1
0  42052   345
1   2204  2119
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.4819774, 'recall': 0.49809045, 'specificity': 0.49809045, 'f1': 0.48990148, 'auroc': 0.56433177, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  17998  69
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.8131428, 'recall': 0.51881033, 'specificity': 0.51881033, 'f1': 0.5258586, 'auroc': 0.7365087, 'binary_precision': 0.6666667, 'binary_recall': 0.03846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5941   5
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_16.png
early stop counter: 13
val acc:0.9604055285453796, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 16,now: 2024-06-22 22:45:59.948825,epoch time: 0:15:58.338682,used: 4:17:24.615407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9491438, 'precision': 0.90618825, 'recall': 0.76554435, 'specificity': 0.76554435, 'f1': 0.81769025, 'auroc': 0.9344498, 'binary_precision': 0.8575624, 'binary_recall': 0.5402405, 'binary_specificity': 0.9908482, 'binary_f1_score': 0.6628831}
confusion matrix:
       0     1
0  42008   388
1   1988  2336
---- Validation: 
scalar performance:
{'acc': 0.958698, 'precision': 0.49603984, 'recall': 0.49935064, 'specificity': 0.49935064, 'f1': 0.4933012, 'auroc': 0.5805247, 'binary_precision': 0.028037382, 'binary_recall': 0.004457652, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.0076923077}
confusion matrix:
       0    1
0  17963  104
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7544862, 'recall': 0.5667081, 'specificity': 0.5667081, 'f1': 0.5999214, 'auroc': 0.76133937, 'binary_precision': 0.54545456, 'binary_recall': 0.13846155, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.2208589}
confusion matrix:
      0   1
0  5916  30
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_17.png
early stop counter: 14
val acc:0.9586979746818542, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 17,now: 2024-06-22 23:02:03.382610,epoch time: 0:16:03.433785,used: 4:33:28.049192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9503639, 'precision': 0.92233, 'recall': 0.76092076, 'specificity': 0.76092076, 'f1': 0.81829154, 'auroc': 0.9411489, 'binary_precision': 0.8908382, 'binary_recall': 0.5284459, 'binary_specificity': 0.9933956, 'binary_f1_score': 0.66337645}
confusion matrix:
       0     1
0  42116   280
1   2039  2285
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.510655, 'recall': 0.50114524, 'specificity': 0.50114524, 'f1': 0.49538004, 'auroc': 0.5960007, 'binary_precision': 0.057142857, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.01076716}
confusion matrix:
       0   1
0  18001  66
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.82485944, 'recall': 0.56596226, 'specificity': 0.56596226, 'f1': 0.60258234, 'auroc': 0.7661398, 'binary_precision': 0.6862745, 'binary_recall': 0.13461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2250804}
confusion matrix:
      0   1
0  5930  16
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_18.png
new oracle model saved
early stop counter: 15
val acc:0.960779070854187, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9611666202545166
after epoch: 18,now: 2024-06-22 23:18:18.956476,epoch time: 0:16:15.573866,used: 4:49:43.623058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9516481, 'precision': 0.90517485, 'recall': 0.78385013, 'specificity': 0.78385013, 'f1': 0.8312514, 'auroc': 0.9373841, 'binary_precision': 0.85202867, 'binary_recall': 0.57793707, 'binary_specificity': 0.9897632, 'binary_f1_score': 0.6887143}
confusion matrix:
       0     1
0  41962   434
1   1825  2499
---- Validation: 
scalar performance:
{'acc': 0.95848453, 'precision': 0.52219176, 'recall': 0.50424683, 'specificity': 0.50424683, 'f1': 0.50192666, 'auroc': 0.60890996, 'binary_precision': 0.08, 'binary_recall': 0.014858841, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.025062658}
confusion matrix:
       0    1
0  17952  115
1    663   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.79318136, 'recall': 0.6066722, 'specificity': 0.6066722, 'f1': 0.65206444, 'auroc': 0.7824787, 'binary_precision': 0.6195652, 'binary_recall': 0.21923077, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.32386363}
confusion matrix:
      0   1
0  5911  35
1   203  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_19.png
new oracle model saved
early stop counter: 16
val acc:0.9584845304489136, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.961650013923645
after epoch: 19,now: 2024-06-22 23:34:21.583991,epoch time: 0:16:02.627515,used: 5:05:46.250573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_28_35_seed_1_21546973
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9532106, 'precision': 0.89019084, 'recall': 0.81164736, 'specificity': 0.81164736, 'f1': 0.8453772, 'auroc': 0.9417461, 'binary_precision': 0.8165138, 'binary_recall': 0.63791907, 'binary_specificity': 0.98537564, 'binary_f1_score': 0.7162513}
confusion matrix:
       0     1
0  41775   620
1   1566  2759
---- Validation: 
scalar performance:
{'acc': 0.9536286, 'precision': 0.51734245, 'recall': 0.50602, 'specificity': 0.50602, 'f1': 0.50587964, 'auroc': 0.59086496, 'binary_precision': 0.07017544, 'binary_recall': 0.023774145, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.035516094}
confusion matrix:
       0    1
0  17855  212
1    657   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7341074, 'recall': 0.6232121, 'specificity': 0.6232121, 'f1': 0.6592337, 'auroc': 0.75798595, 'binary_precision': 0.5, 'binary_recall': 0.2576923, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.3401015}
confusion matrix:
      0   1
0  5879  67
1   193  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546973_20.png
[Sat Jun 22 23:50:20 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/1.csv

--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 862, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing file data/306: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
    self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
Shutting down, this might take some time.
