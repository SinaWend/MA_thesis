Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983

 Experiment start at: 2024-06-05 22:52:07.424052
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.77057916, 'recall': 0.7579602, 'specificity': 0.7579602, 'f1': 0.7641032, 'auroc': 0.9482348, 'binary_precision': 0.55745894, 'binary_recall': 0.5305706, 'binary_specificity': 0.9853497, 'binary_f1_score': 0.5436825}
confusion matrix:
       0    1
0  41700  620
1    691  781
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7531966, 'recall': 0.75509524, 'specificity': 0.75509524, 'f1': 0.754142, 'auroc': 0.94573057, 'binary_precision': 0.5231481, 'binary_recall': 0.5272162, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.52517426}
confusion matrix:
       0    1
0  17840  309
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.91210926, 'recall': 0.75845206, 'specificity': 0.75845206, 'f1': 0.8160734, 'auroc': 0.9307211, 'binary_precision': 0.8447205, 'binary_recall': 0.5210728, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6445498}
confusion matrix:
      0    1
0  5972   25
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:33:24.329046,epoch time: 0:41:16.904994,used: 0:41:16.904994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9730316, 'precision': 0.7946063, 'recall': 0.7804791, 'specificity': 0.7804791, 'f1': 0.78735197, 'auroc': 0.962534, 'binary_precision': 0.60400283, 'binary_recall': 0.57404894, 'binary_specificity': 0.9869093, 'binary_f1_score': 0.5886451}
confusion matrix:
       0    1
0  41766  554
1    627  845
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.7792, 'recall': 0.76955426, 'specificity': 0.76955426, 'f1': 0.7742834, 'auroc': 0.9575846, 'binary_precision': 0.57419354, 'binary_recall': 0.55365473, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.56373715}
confusion matrix:
       0    1
0  17885  264
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8500357, 'recall': 0.5735454, 'specificity': 0.5735454, 'f1': 0.6145333, 'auroc': 0.9369781, 'binary_precision': 0.7358491, 'binary_recall': 0.14942528, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.24840763}
confusion matrix:
      0   1
0  5983  14
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_2.png
better model found
persisted
after epoch: 2,now: 2024-06-06 00:13:03.441668,epoch time: 0:39:39.112622,used: 1:20:56.017616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9776443, 'precision': 0.85384643, 'recall': 0.7674563, 'specificity': 0.7674563, 'f1': 0.80414474, 'auroc': 0.9716815, 'binary_precision': 0.7234814, 'binary_recall': 0.54211956, 'binary_specificity': 0.992793, 'binary_f1_score': 0.6198059}
confusion matrix:
       0    1
0  42015  305
1    674  798
---- Validation: 
scalar performance:
{'acc': 0.97647935, 'precision': 0.8597846, 'recall': 0.73955476, 'specificity': 0.73955476, 'f1': 0.7866311, 'auroc': 0.9656024, 'binary_precision': 0.73758864, 'binary_recall': 0.4852255, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.58536583}
confusion matrix:
       0    1
0  18038  111
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8460576, 'recall': 0.5508904, 'specificity': 0.5508904, 'f1': 0.58061874, 'auroc': 0.93765855, 'binary_precision': 0.7297297, 'binary_recall': 0.10344828, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18120806}
confusion matrix:
      0   1
0  5987  10
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 00:52:43.563979,epoch time: 0:39:40.122311,used: 2:00:36.139927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98049873, 'precision': 0.8822069, 'recall': 0.79010344, 'specificity': 0.79010344, 'f1': 0.82934463, 'auroc': 0.97777903, 'binary_precision': 0.7786811, 'binary_recall': 0.5859959, 'binary_specificity': 0.9942109, 'binary_f1_score': 0.6687355}
confusion matrix:
       0    1
0  42076  245
1    609  862
---- Validation: 
scalar performance:
{'acc': 0.9789804, 'precision': 0.87310433, 'recall': 0.7776023, 'specificity': 0.7776023, 'f1': 0.81777126, 'auroc': 0.97030026, 'binary_precision': 0.76160336, 'binary_recall': 0.5614308, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.6463742}
confusion matrix:
       0    1
0  18036  113
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.94669574, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 01:32:21.291960,epoch time: 0:39:37.727981,used: 2:40:13.867908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98143494, 'precision': 0.8646866, 'recall': 0.84045756, 'specificity': 0.84045756, 'f1': 0.8521197, 'auroc': 0.9775179, 'binary_precision': 0.740146, 'binary_recall': 0.689327, 'binary_specificity': 0.9915881, 'binary_f1_score': 0.71383315}
confusion matrix:
       0     1
0  41965   356
1    457  1014
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.86791015, 'recall': 0.8319031, 'specificity': 0.8319031, 'f1': 0.8488995, 'auroc': 0.9723214, 'binary_precision': 0.7474049, 'binary_recall': 0.6718507, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.7076167}
confusion matrix:
       0    1
0  18003  146
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9568703, 'recall': 0.5382308, 'specificity': 0.5382308, 'f1': 0.5610315, 'auroc': 0.94387805, 'binary_precision': 0.95238096, 'binary_recall': 0.07662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.14184396}
confusion matrix:
      0   1
0  5996   1
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 02:12:00.495342,epoch time: 0:39:39.203382,used: 3:19:53.071290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98310196, 'precision': 0.9026393, 'recall': 0.8174917, 'specificity': 0.8174917, 'f1': 0.8546389, 'auroc': 0.9827559, 'binary_precision': 0.8177083, 'binary_recall': 0.6399456, 'binary_specificity': 0.9950378, 'binary_f1_score': 0.7179877}
confusion matrix:
       0    1
0  42110  210
1    530  942
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.915141, 'recall': 0.7866181, 'specificity': 0.7866181, 'f1': 0.8382263, 'auroc': 0.9756194, 'binary_precision': 0.8451025, 'binary_recall': 0.5769829, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.6857671}
confusion matrix:
       0    1
0  18081   68
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8552821, 'recall': 0.52831876, 'specificity': 0.52831876, 'f1': 0.5431233, 'auroc': 0.9379394, 'binary_precision': 0.75, 'binary_recall': 0.057471264, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5992   5
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 02:51:36.560129,epoch time: 0:39:36.064787,used: 3:59:29.136077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9839697, 'precision': 0.89101624, 'recall': 0.8513823, 'specificity': 0.8513823, 'f1': 0.8700541, 'auroc': 0.9837197, 'binary_precision': 0.79210925, 'binary_recall': 0.7092391, 'binary_specificity': 0.9935255, 'binary_f1_score': 0.7483871}
confusion matrix:
       0     1
0  42046   274
1    428  1044
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.8917086, 'recall': 0.83439493, 'specificity': 0.83439493, 'f1': 0.8606027, 'auroc': 0.9763732, 'binary_precision': 0.7948718, 'binary_recall': 0.6749611, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.73002523}
confusion matrix:
       0    1
0  18037  112
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.94902945, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 03:31:10.772928,epoch time: 0:39:34.212799,used: 4:39:03.348876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.8629574, 'recall': 0.89097977, 'specificity': 0.89097977, 'f1': 0.8764007, 'auroc': 0.98510647, 'binary_precision': 0.7331655, 'binary_recall': 0.79197824, 'binary_specificity': 0.98998135, 'binary_f1_score': 0.7614379}
confusion matrix:
       0     1
0  41897   424
1    306  1165
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.86894464, 'recall': 0.88717437, 'specificity': 0.88717437, 'f1': 0.8778198, 'auroc': 0.97732866, 'binary_precision': 0.74556214, 'binary_recall': 0.7838258, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.7642153}
confusion matrix:
       0    1
0  17977  172
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.88471925, 'recall': 0.60044867, 'specificity': 0.60044867, 'f1': 0.65301394, 'auroc': 0.9444385, 'binary_precision': 0.8030303, 'binary_recall': 0.20306513, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.324159}
confusion matrix:
      0   1
0  5984  13
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 04:10:43.038696,epoch time: 0:39:32.265768,used: 5:18:35.614644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.986002, 'precision': 0.91937405, 'recall': 0.85266316, 'specificity': 0.85266316, 'f1': 0.88291264, 'auroc': 0.98651004, 'binary_precision': 0.8487805, 'binary_recall': 0.70972127, 'binary_specificity': 0.995605, 'binary_f1_score': 0.77304703}
confusion matrix:
       0     1
0  42135   186
1    427  1044
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9146474, 'recall': 0.8275006, 'specificity': 0.8275006, 'f1': 0.865557, 'auroc': 0.9781015, 'binary_precision': 0.84126985, 'binary_recall': 0.65940905, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.73932}
confusion matrix:
       0    1
0  18069   80
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.93480045, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 04:50:20.516473,epoch time: 0:39:37.477777,used: 5:58:13.092421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9854083, 'precision': 0.9062477, 'recall': 0.858356, 'specificity': 0.858356, 'f1': 0.88068163, 'auroc': 0.9881918, 'binary_precision': 0.8221191, 'binary_recall': 0.72214675, 'binary_specificity': 0.9945652, 'binary_f1_score': 0.76889694}
confusion matrix:
       0     1
0  42090   230
1    409  1063
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.90104705, 'recall': 0.8362808, 'specificity': 0.8362808, 'f1': 0.8655884, 'auroc': 0.9765532, 'binary_precision': 0.8134328, 'binary_recall': 0.67807156, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7396098}
confusion matrix:
       0    1
0  18049  100
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.93507993, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_10.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9840889573097229, corresponding to test acc:                         0.9589325785636902 / 0.976030707359314
after epoch: 10,now: 2024-06-06 05:29:50.049221,epoch time: 0:39:29.532748,used: 6:37:42.625169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9866186, 'precision': 0.94754386, 'recall': 0.83439267, 'specificity': 0.83439267, 'f1': 0.88219005, 'auroc': 0.9891051, 'binary_precision': 0.906422, 'binary_recall': 0.6711956, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.7712725}
confusion matrix:
       0    1
0  42218  102
1    484  988
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9391063, 'recall': 0.8112473, 'specificity': 0.8112473, 'f1': 0.86348516, 'auroc': 0.9782724, 'binary_precision': 0.89135253, 'binary_recall': 0.62519443, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.7349177}
confusion matrix:
       0    1
0  18100   49
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.92420125, 'recall': 0.5152423, 'specificity': 0.5152423, 'f1': 0.5192589, 'auroc': 0.9071673, 'binary_precision': 0.8888889, 'binary_recall': 0.03065134, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5996  1
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_11.png
better model found
persisted
after epoch: 11,now: 2024-06-06 06:09:19.495896,epoch time: 0:39:29.446675,used: 7:17:12.071844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9208416, 'recall': 0.8898282, 'specificity': 0.8898282, 'f1': 0.9046944, 'auroc': 0.990099, 'binary_precision': 0.8491538, 'binary_recall': 0.78450036, 'binary_specificity': 0.99515605, 'binary_f1_score': 0.81554776}
confusion matrix:
       0     1
0  42116   205
1    317  1154
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9161054, 'recall': 0.87538147, 'specificity': 0.87538147, 'f1': 0.8946106, 'auroc': 0.9788183, 'binary_precision': 0.84083045, 'binary_recall': 0.755832, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7960688}
confusion matrix:
       0    1
0  18057   92
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.9326675, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_12.png
better model found
persisted
after epoch: 12,now: 2024-06-06 06:48:57.446652,epoch time: 0:39:37.950756,used: 7:56:50.022600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98830837, 'precision': 0.9220538, 'recall': 0.8926424, 'specificity': 0.8926424, 'f1': 0.9067749, 'auroc': 0.9923113, 'binary_precision': 0.8513909, 'binary_recall': 0.7900815, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.8195913}
confusion matrix:
       0     1
0  42117   203
1    309  1163
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.91160893, 'recall': 0.85824656, 'specificity': 0.85824656, 'f1': 0.8829287, 'auroc': 0.97884583, 'binary_precision': 0.8330341, 'binary_recall': 0.7216174, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7733333}
confusion matrix:
       0    1
0  18056   93
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8812791, 'recall': 0.55305624, 'specificity': 0.55305624, 'f1': 0.5847746, 'auroc': 0.9275557, 'binary_precision': 0.8, 'binary_recall': 0.107279696, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5990   7
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_13.png
early stop counter: 1
val acc:0.9855257272720337, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.959092378616333 / 0.976030707359314
after epoch: 13,now: 2024-06-06 07:28:23.383938,epoch time: 0:39:25.937286,used: 8:36:15.959886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98819417, 'precision': 0.90459174, 'recall': 0.916517, 'specificity': 0.916517, 'f1': 0.9104605, 'auroc': 0.99292195, 'binary_precision': 0.814766, 'binary_recall': 0.83967394, 'binary_specificity': 0.9933601, 'binary_f1_score': 0.82703245}
confusion matrix:
       0     1
0  42039   281
1    236  1236
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9001783, 'recall': 0.89477265, 'specificity': 0.89477265, 'f1': 0.8974556, 'auroc': 0.98082554, 'binary_precision': 0.807571, 'binary_recall': 0.7962675, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.80187947}
confusion matrix:
       0    1
0  18027  122
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.93144065, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_14.png
early stop counter: 2
val acc:0.9865368008613586, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.959092378616333 / 0.976030707359314
after epoch: 14,now: 2024-06-06 08:07:50.226308,epoch time: 0:39:26.842370,used: 9:15:42.802256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.87265754, 'recall': 0.9300334, 'specificity': 0.9300334, 'f1': 0.8991082, 'auroc': 0.9931861, 'binary_precision': 0.74985355, 'binary_recall': 0.87015635, 'binary_specificity': 0.9899104, 'binary_f1_score': 0.8055381}
confusion matrix:
       0     1
0  41894   427
1    191  1280
---- Validation: 
scalar performance:
{'acc': 0.98201364, 'precision': 0.8455287, 'recall': 0.9134325, 'specificity': 0.9134325, 'f1': 0.8761452, 'auroc': 0.9808453, 'binary_precision': 0.6967742, 'binary_recall': 0.83981335, 'binary_specificity': 0.9870516, 'binary_f1_score': 0.76163614}
confusion matrix:
       0    1
0  17914  235
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.879213, 'recall': 0.5871221, 'specificity': 0.5871221, 'f1': 0.6348951, 'auroc': 0.9432154, 'binary_precision': 0.79310346, 'binary_recall': 0.17624521, 'binary_specificity': 0.997999, 'binary_f1_score': 0.28840125}
confusion matrix:
      0   1
0  5985  12
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_15.png
early stop counter: 3
val acc:0.9820136427879333, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.959092378616333 / 0.976030707359314
after epoch: 15,now: 2024-06-06 08:47:25.499375,epoch time: 0:39:35.273067,used: 9:55:18.075323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98999816, 'precision': 0.96124923, 'recall': 0.87843513, 'specificity': 0.87843513, 'f1': 0.91545975, 'auroc': 0.9938919, 'binary_precision': 0.93083334, 'binary_recall': 0.7588315, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.83607787}
confusion matrix:
       0     1
0  42237    83
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.940972, 'recall': 0.8422413, 'specificity': 0.8422413, 'f1': 0.88491607, 'auroc': 0.982602, 'binary_precision': 0.8929293, 'binary_recall': 0.6874028, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7768014}
confusion matrix:
       0    1
0  18096   53
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.90788513, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_16.png
early stop counter: 4
val acc:0.986483633518219, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.959092378616333 / 0.976030707359314
after epoch: 16,now: 2024-06-06 09:26:55.385180,epoch time: 0:39:29.885805,used: 10:34:47.961128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9899297, 'precision': 0.94659007, 'recall': 0.8921698, 'specificity': 0.8921698, 'f1': 0.91748023, 'auroc': 0.99432313, 'binary_precision': 0.9005439, 'binary_recall': 0.7873641, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.8401595}
confusion matrix:
       0     1
0  42192   128
1    313  1159
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.924726, 'recall': 0.85871494, 'specificity': 0.85871494, 'f1': 0.8887205, 'auroc': 0.9806043, 'binary_precision': 0.85925925, 'binary_recall': 0.7216174, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.78444636}
confusion matrix:
       0    1
0  18073   76
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.89039123, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_17.png
early stop counter: 5
val acc:0.9864304065704346, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.959092378616333 / 0.976030707359314
after epoch: 17,now: 2024-06-06 10:06:29.431705,epoch time: 0:39:34.046525,used: 11:14:22.007653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98933595, 'precision': 0.9241803, 'recall': 0.908851, 'specificity': 0.908851, 'f1': 0.9163633, 'auroc': 0.9947288, 'binary_precision': 0.8545198, 'binary_recall': 0.82256967, 'binary_specificity': 0.99513245, 'binary_f1_score': 0.8382404}
confusion matrix:
       0     1
0  42115   206
1    261  1210
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9206208, 'recall': 0.88326764, 'specificity': 0.88326764, 'f1': 0.9010061, 'auroc': 0.9803884, 'binary_precision': 0.84931505, 'binary_recall': 0.7713841, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.808476}
confusion matrix:
       0    1
0  18061   88
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.8739556, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 10:45:59.517152,epoch time: 0:39:30.085447,used: 11:53:52.093100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99047774, 'precision': 0.9526287, 'recall': 0.8950762, 'specificity': 0.8950762, 'f1': 0.9217516, 'auroc': 0.9935298, 'binary_precision': 0.9124316, 'binary_recall': 0.79279894, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.8484188}
confusion matrix:
       0     1
0  42208   112
1    305  1167
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.93263924, 'recall': 0.8667114, 'specificity': 0.8667114, 'f1': 0.8967445, 'auroc': 0.979269, 'binary_precision': 0.8745387, 'binary_recall': 0.7371695, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.8000001}
confusion matrix:
       0    1
0  18081   68
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.87648594, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_19.png
early stop counter: 1
val acc:0.9873882532119751, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9597315192222595 / 0.976030707359314
after epoch: 19,now: 2024-06-06 11:25:39.912397,epoch time: 0:39:40.395245,used: 12:33:32.488345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.990158, 'precision': 0.930056, 'recall': 0.9162216, 'specificity': 0.9162216, 'f1': 0.92301667, 'auroc': 0.99576974, 'binary_precision': 0.86577654, 'binary_recall': 0.8369565, 'binary_specificity': 0.9954868, 'binary_f1_score': 0.8511226}
confusion matrix:
       0     1
0  42129   191
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9165608, 'recall': 0.8877405, 'specificity': 0.8877405, 'f1': 0.901592, 'auroc': 0.98101014, 'binary_precision': 0.84087104, 'binary_recall': 0.7807154, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.8096774}
confusion matrix:
       0    1
0  18054   95
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9294125, 'recall': 0.5495583, 'specificity': 0.5495583, 'f1': 0.57992184, 'auroc': 0.9286377, 'binary_precision': 0.8965517, 'binary_recall': 0.099616855, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5994   3
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_20.png
early stop counter: 2
val acc:0.9874414801597595, best validation acc: 0.987494707107544, corresponding to test acc:                         0.9597315192222595 / 0.976030707359314
after epoch: 20,now: 2024-06-06 12:05:53.122711,epoch time: 0:40:13.210314,used: 13:13:45.698659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991551, 'precision': 0.94831336, 'recall': 0.9182538, 'specificity': 0.9182538, 'f1': 0.93272185, 'auroc': 0.9966363, 'binary_precision': 0.9021898, 'binary_recall': 0.83967394, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.86981}
confusion matrix:
       0     1
0  42186   134
1    236  1236
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9359005, 'recall': 0.87145966, 'specificity': 0.87145966, 'f1': 0.90090823, 'auroc': 0.9822649, 'binary_precision': 0.88073397, 'binary_recall': 0.7465008, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.80808085}
confusion matrix:
       0    1
0  18084   65
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.8892096, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_21.png
better model found
persisted
after epoch: 21,now: 2024-06-06 12:45:21.038893,epoch time: 0:39:27.916182,used: 13:53:13.614841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99132264, 'precision': 0.92117393, 'recall': 0.95092154, 'specificity': 0.95092154, 'f1': 0.93549806, 'auroc': 0.9968863, 'binary_precision': 0.8455696, 'binary_recall': 0.9076087, 'binary_specificity': 0.9942344, 'binary_f1_score': 0.87549144}
confusion matrix:
       0     1
0  42076   244
1    136  1336
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.90033793, 'recall': 0.9009384, 'specificity': 0.9009384, 'f1': 0.9006379, 'auroc': 0.9815675, 'binary_precision': 0.8074534, 'binary_recall': 0.8087092, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.80808085}
confusion matrix:
       0    1
0  18025  124
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9090909, 'recall': 0.5342326, 'specificity': 0.5342326, 'f1': 0.55377585, 'auroc': 0.8801141, 'binary_precision': 0.85714287, 'binary_recall': 0.06896552, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5994   3
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_22.png
early stop counter: 1
val acc:0.9868561029434204, best validation acc: 0.9878671765327454, corresponding to test acc:                         0.9600511193275452 / 0.976030707359314
after epoch: 22,now: 2024-06-06 13:24:48.499945,epoch time: 0:39:27.461052,used: 14:32:41.075893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.94888234, 'recall': 0.9270617, 'specificity': 0.9270617, 'f1': 0.93767905, 'auroc': 0.99633265, 'binary_precision': 0.9027182, 'binary_recall': 0.85733694, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.8794425}
confusion matrix:
       0     1
0  42184   136
1    210  1262
---- Validation: 
scalar performance:
{'acc': 0.9892507, 'precision': 0.9426296, 'recall': 0.8879271, 'specificity': 0.8879271, 'f1': 0.9133367, 'auroc': 0.9825632, 'binary_precision': 0.8930481, 'binary_recall': 0.7791602, 'binary_specificity': 0.996694, 'binary_f1_score': 0.8322259}
confusion matrix:
       0    1
0  18089   60
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.93052256, 'recall': 0.534316, 'specificity': 0.534316, 'f1': 0.55404466, 'auroc': 0.87355983, 'binary_precision': 0.9, 'binary_recall': 0.06896552, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12811388}
confusion matrix:
      0   1
0  5995   2
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_23.png
better model found
persisted
after epoch: 23,now: 2024-06-06 14:04:26.181209,epoch time: 0:39:37.681264,used: 15:12:18.757157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99075174, 'precision': 0.96778095, 'recall': 0.8847265, 'specificity': 0.8847265, 'f1': 0.9219141, 'auroc': 0.99688303, 'binary_precision': 0.94347465, 'binary_recall': 0.7710598, 'binary_specificity': 0.9983932, 'binary_f1_score': 0.8485981}
confusion matrix:
       0     1
0  42252    68
1    337  1135
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9569096, 'recall': 0.82876784, 'specificity': 0.82876784, 'f1': 0.8816371, 'auroc': 0.981362, 'binary_precision': 0.9257642, 'binary_recall': 0.65940905, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.77020895}
confusion matrix:
       0    1
0  18115   34
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.91963947, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_24.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 24,now: 2024-06-06 14:44:05.944123,epoch time: 0:39:39.762914,used: 15:51:58.520071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9926927, 'precision': 0.96733534, 'recall': 0.9168774, 'specificity': 0.9168774, 'f1': 0.9405593, 'auroc': 0.9976864, 'binary_precision': 0.940367, 'binary_recall': 0.8355978, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.8848921}
confusion matrix:
       0     1
0  42242    78
1    242  1230
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9520287, 'recall': 0.8549584, 'specificity': 0.8549584, 'f1': 0.89722127, 'auroc': 0.9818275, 'binary_precision': 0.91417164, 'binary_recall': 0.7122862, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.80069935}
confusion matrix:
       0    1
0  18106   43
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.84296954, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_25.png
early stop counter: 2
val acc:0.9878671765327454, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 25,now: 2024-06-06 15:23:36.249942,epoch time: 0:39:30.305819,used: 16:31:28.825890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921219, 'precision': 0.97050893, 'recall': 0.9044512, 'specificity': 0.9044512, 'f1': 0.93480337, 'auroc': 0.9980426, 'binary_precision': 0.9475774, 'binary_recall': 0.81046194, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.87367266}
confusion matrix:
       0     1
0  42254    66
1    279  1193
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9535897, 'recall': 0.83332324, 'specificity': 0.83332324, 'f1': 0.8835978, 'auroc': 0.98115146, 'binary_precision': 0.9188034, 'binary_recall': 0.6687403, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7740774}
confusion matrix:
       0    1
0  18111   38
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.8076042, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_26.png
early stop counter: 3
val acc:0.9866432547569275, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 26,now: 2024-06-06 16:02:41.093304,epoch time: 0:39:04.843362,used: 17:10:33.669252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99264705, 'precision': 0.95188105, 'recall': 0.9328743, 'specificity': 0.9328743, 'f1': 0.94215775, 'auroc': 0.9976107, 'binary_precision': 0.90831554, 'binary_recall': 0.86879677, 'binary_specificity': 0.9969519, 'binary_f1_score': 0.8881168}
confusion matrix:
       0     1
0  42192   129
1    193  1278
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.92186606, 'recall': 0.85629946, 'specificity': 0.85629946, 'f1': 0.88610214, 'auroc': 0.97971135, 'binary_precision': 0.8537037, 'binary_recall': 0.7169518, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7793744}
confusion matrix:
       0    1
0  18070   79
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8135321, 'recall': 0.5262363, 'specificity': 0.5262363, 'f1': 0.53926444, 'auroc': 0.8715328, 'binary_precision': 0.6666667, 'binary_recall': 0.053639848, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09929079}
confusion matrix:
      0   1
0  5990   7
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_27.png
early stop counter: 4
val acc:0.9861111044883728, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 27,now: 2024-06-06 16:42:24.442964,epoch time: 0:39:43.349660,used: 17:50:17.018912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991551, 'precision': 0.9325829, 'recall': 0.93825316, 'specificity': 0.93825316, 'f1': 0.9353981, 'auroc': 0.997132, 'binary_precision': 0.8693029, 'binary_recall': 0.8811141, 'binary_specificity': 0.99539226, 'binary_f1_score': 0.8751687}
confusion matrix:
       0     1
0  42125   195
1    175  1297
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9196931, 'recall': 0.8963492, 'specificity': 0.8963492, 'f1': 0.9076599, 'auroc': 0.9822207, 'binary_precision': 0.84653467, 'binary_recall': 0.7978227, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.82145715}
confusion matrix:
       0    1
0  18056   93
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74451685, 'recall': 0.5165744, 'specificity': 0.5165744, 'f1': 0.52175146, 'auroc': 0.8292837, 'binary_precision': 0.5294118, 'binary_recall': 0.03448276, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0647482}
confusion matrix:
      0  1
0  5989  8
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_28.png
early stop counter: 5
val acc:0.9881332516670227, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 28,now: 2024-06-06 17:22:09.190617,epoch time: 0:39:44.747653,used: 18:30:01.766565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99187064, 'precision': 0.96053004, 'recall': 0.91016245, 'specificity': 0.91016245, 'f1': 0.9337801, 'auroc': 0.9974864, 'binary_precision': 0.92720306, 'binary_recall': 0.82256967, 'binary_specificity': 0.9977552, 'binary_f1_score': 0.87175786}
confusion matrix:
       0     1
0  42226    95
1    261  1210
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.94459033, 'recall': 0.8585985, 'specificity': 0.8585985, 'f1': 0.89664274, 'auroc': 0.9813746, 'binary_precision': 0.89902914, 'binary_recall': 0.7200622, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.79965454}
confusion matrix:
       0    1
0  18097   52
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8370436, 'recall': 0.5188236, 'specificity': 0.5188236, 'f1': 0.52594787, 'auroc': 0.87131476, 'binary_precision': 0.71428573, 'binary_recall': 0.038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5993   4
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_29.png
early stop counter: 6
val acc:0.9876543283462524, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 29,now: 2024-06-06 18:02:24.331444,epoch time: 0:40:15.140827,used: 19:10:16.907392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.994314, 'precision': 0.9657519, 'recall': 0.94525635, 'specificity': 0.94525635, 'f1': 0.955256, 'auroc': 0.99836797, 'binary_precision': 0.9352313, 'binary_recall': 0.89266306, 'binary_specificity': 0.9978497, 'binary_f1_score': 0.9134515}
confusion matrix:
       0     1
0  42229    91
1    158  1314
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.92725444, 'recall': 0.8873761, 'specificity': 0.8873761, 'f1': 0.90626097, 'auroc': 0.98306954, 'binary_precision': 0.86230636, 'binary_recall': 0.7791602, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.8186275}
confusion matrix:
       0    1
0  18069   80
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8486262, 'recall': 0.52640307, 'specificity': 0.52640307, 'f1': 0.5397025, 'auroc': 0.8489313, 'binary_precision': 0.7368421, 'binary_recall': 0.053639848, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5992   5
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_30.png
early stop counter: 7
val acc:0.9881864786148071, best validation acc: 0.9892507195472717, corresponding to test acc:                         0.9608501195907593 / 0.976030707359314
after epoch: 30,now: 2024-06-06 18:42:17.094672,epoch time: 0:39:52.763228,used: 19:50:09.670620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:50:09.670620 at 2024-06-06 18:42:17.094672
persisted model performance metric: 

scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.8880826, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
oracle model performance metric: 

scalar performance:
{'acc': 0.9742729, 'precision': 0.9146109, 'recall': 0.73004985, 'specificity': 0.73004985, 'f1': 0.79360235, 'auroc': 0.93552697, 'binary_precision': 0.85211265, 'binary_recall': 0.46360153, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6004963}
confusion matrix:
      0    1
0  5976   21
1   140  121
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413552 GiB | 413552 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400662 GiB | 400661 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152225 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152225 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89894 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |    2873    |   89945 K  |   89945 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      31    |    2761    |   42670 K  |   42670 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413553 GiB | 413553 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89947 K  |   89947 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42671 K  |   42671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413553 GiB | 413553 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89947 K  |   89947 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42671 K  |   42671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983

 Experiment start at: 2024-06-06 18:52:48.923940
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9712468, 'precision': 0.78551495, 'recall': 0.6990856, 'specificity': 0.6990856, 'f1': 0.73388654, 'auroc': 0.94467217, 'binary_precision': 0.5909548, 'binary_recall': 0.407767, 'binary_specificity': 0.9904041, 'binary_f1_score': 0.48256055}
confusion matrix:
       0    1
0  42007  407
1    854  588
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.7827344, 'recall': 0.7054606, 'specificity': 0.7054606, 'f1': 0.7373546, 'auroc': 0.9470901, 'binary_precision': 0.58677685, 'binary_recall': 0.42199108, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.49092478}
confusion matrix:
       0    1
0  17867  200
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.6982471, 'recall': 0.5308423, 'specificity': 0.5308423, 'f1': 0.5459176, 'auroc': 0.9265528, 'binary_precision': 0.43589744, 'binary_recall': 0.06538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.113712385}
confusion matrix:
      0   1
0  5924  22
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 19:34:03.610887,epoch time: 0:41:14.686947,used: 0:41:14.686947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9719537, 'precision': 0.77696383, 'recall': 0.80395603, 'specificity': 0.80395603, 'f1': 0.78976727, 'auroc': 0.9613377, 'binary_precision': 0.56675065, 'binary_recall': 0.62413317, 'binary_specificity': 0.98377895, 'binary_f1_score': 0.5940594}
confusion matrix:
       0    1
0  41726  688
1    542  900
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.77669466, 'recall': 0.7995757, 'specificity': 0.7995757, 'f1': 0.7876286, 'auroc': 0.9620378, 'binary_precision': 0.56771547, 'binary_recall': 0.6166419, 'binary_specificity': 0.98250955, 'binary_f1_score': 0.59116805}
confusion matrix:
       0    1
0  17751  316
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.81556106, 'recall': 0.64663637, 'specificity': 0.64663637, 'f1': 0.6971253, 'auroc': 0.9389231, 'binary_precision': 0.66101694, 'binary_recall': 0.3, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.41269842}
confusion matrix:
      0   1
0  5906  40
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 20:14:02.262285,epoch time: 0:39:58.651398,used: 1:21:13.338345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9771753, 'precision': 0.82400197, 'recall': 0.80900025, 'specificity': 0.80900025, 'f1': 0.81630707, 'auroc': 0.96715283, 'binary_precision': 0.6605972, 'binary_recall': 0.6289875, 'binary_specificity': 0.9890131, 'binary_f1_score': 0.64440495}
confusion matrix:
       0    1
0  41948  466
1    535  907
---- Validation: 
scalar performance:
{'acc': 0.97427964, 'precision': 0.83461213, 'recall': 0.7563447, 'specificity': 0.7563447, 'f1': 0.78981286, 'auroc': 0.96801317, 'binary_precision': 0.68688846, 'binary_recall': 0.5215453, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.5929054}
confusion matrix:
       0    1
0  17907  160
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8136265, 'recall': 0.58836645, 'specificity': 0.58836645, 'f1': 0.6321852, 'auroc': 0.9445136, 'binary_precision': 0.6619718, 'binary_recall': 0.18076923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.28398794}
confusion matrix:
      0   1
0  5922  24
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 20:53:41.316490,epoch time: 0:39:39.054205,used: 2:00:52.392550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9781558, 'precision': 0.92326295, 'recall': 0.6972983, 'specificity': 0.6972983, 'f1': 0.7665267, 'auroc': 0.9721021, 'binary_precision': 0.8666667, 'binary_recall': 0.3966713, 'binary_specificity': 0.9979252, 'binary_f1_score': 0.5442436}
confusion matrix:
       0    1
0  42326   88
1    870  572
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.93417746, 'recall': 0.63240546, 'specificity': 0.63240546, 'f1': 0.6980059, 'auroc': 0.97087395, 'binary_precision': 0.895, 'binary_recall': 0.26597324, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.4100802}
confusion matrix:
       0    1
0  18046   21
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.9496654, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_4.png
early stop counter: 1
val acc:0.9725186824798584, best validation acc: 0.9742796421051025, corresponding to test acc:                         0.9618111252784729 / 0.9642281532287598
after epoch: 4,now: 2024-06-06 21:33:27.176504,epoch time: 0:39:45.860014,used: 2:40:38.252564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9808236, 'precision': 0.89864266, 'recall': 0.7686825, 'specificity': 0.7686825, 'f1': 0.82008123, 'auroc': 0.9762194, 'binary_precision': 0.8126951, 'binary_recall': 0.54160887, 'binary_specificity': 0.9957561, 'binary_f1_score': 0.6500208}
confusion matrix:
       0    1
0  42234  180
1    661  781
---- Validation: 
scalar performance:
{'acc': 0.9767876, 'precision': 0.9125824, 'recall': 0.71472937, 'specificity': 0.71472937, 'f1': 0.78017074, 'auroc': 0.97333324, 'binary_precision': 0.8459302, 'binary_recall': 0.43239227, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.5722714}
confusion matrix:
       0    1
0  18014   53
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.95073354, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 22:13:05.855938,epoch time: 0:39:38.679434,used: 3:20:16.931998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98278457, 'precision': 0.91973245, 'recall': 0.785774, 'specificity': 0.785774, 'f1': 0.83913016, 'auroc': 0.9798241, 'binary_precision': 0.853759, 'binary_recall': 0.574896, 'binary_specificity': 0.99665207, 'binary_f1_score': 0.6871115}
confusion matrix:
       0    1
0  42272  142
1    613  829
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.9309435, 'recall': 0.7166027, 'specificity': 0.7166027, 'f1': 0.78579867, 'auroc': 0.9769163, 'binary_precision': 0.8825301, 'binary_recall': 0.43536404, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.5830846}
confusion matrix:
       0    1
0  18028   39
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9099359, 'recall': 0.55727184, 'specificity': 0.55727184, 'f1': 0.5919978, 'auroc': 0.95083374, 'binary_precision': 0.85714287, 'binary_recall': 0.115384616, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5941   5
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 22:52:45.848526,epoch time: 0:39:39.992588,used: 3:59:56.924586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98351425, 'precision': 0.93155247, 'recall': 0.7884959, 'specificity': 0.7884959, 'f1': 0.8448234, 'auroc': 0.98402166, 'binary_precision': 0.8772298, 'binary_recall': 0.57975036, 'binary_specificity': 0.9972415, 'binary_f1_score': 0.6981211}
confusion matrix:
       0    1
0  42297  117
1    606  836
---- Validation: 
scalar performance:
{'acc': 0.97652084, 'precision': 0.9133128, 'recall': 0.7095841, 'specificity': 0.7095841, 'f1': 0.77571404, 'auroc': 0.976468, 'binary_precision': 0.8477612, 'binary_recall': 0.42199108, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.56349206}
confusion matrix:
       0    1
0  18016   51
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9304397, 'recall': 0.5344472, 'specificity': 0.5344472, 'f1': 0.5542297, 'auroc': 0.9474419, 'binary_precision': 0.9, 'binary_recall': 0.06923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5944   2
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_7.png
early stop counter: 1
val acc:0.976520836353302, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9621334075927734 / 0.9642281532287598
after epoch: 7,now: 2024-06-06 23:32:30.523718,epoch time: 0:39:44.675192,used: 4:39:41.599778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9857716, 'precision': 0.9065932, 'recall': 0.85899806, 'specificity': 0.85899806, 'f1': 0.8812003, 'auroc': 0.9834007, 'binary_precision': 0.8225552, 'binary_recall': 0.723301, 'binary_specificity': 0.9946951, 'binary_f1_score': 0.76974165}
confusion matrix:
       0     1
0  42189   225
1    399  1043
---- Validation: 
scalar performance:
{'acc': 0.98159015, 'precision': 0.89801735, 'recall': 0.81592697, 'specificity': 0.81592697, 'f1': 0.8518534, 'auroc': 0.9784473, 'binary_precision': 0.80943394, 'binary_recall': 0.63744426, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.71321696}
confusion matrix:
       0    1
0  17966  101
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.942287, 'recall': 0.5670554, 'specificity': 0.5670554, 'f1': 0.6080391, 'auroc': 0.9508171, 'binary_precision': 0.92105263, 'binary_recall': 0.13461539, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.23489934}
confusion matrix:
      0   1
0  5943   3
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 00:12:12.030231,epoch time: 0:39:41.506513,used: 5:19:23.106291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9830582, 'precision': 0.8477377, 'recall': 0.91688174, 'specificity': 0.91688174, 'f1': 0.8788912, 'auroc': 0.9854211, 'binary_precision': 0.7007467, 'binary_recall': 0.84604716, 'binary_specificity': 0.9877163, 'binary_f1_score': 0.76657236}
confusion matrix:
       0     1
0  41893   521
1    222  1220
---- Validation: 
scalar performance:
{'acc': 0.9803095, 'precision': 0.8492659, 'recall': 0.8796369, 'specificity': 0.8796369, 'f1': 0.86375535, 'auroc': 0.9797373, 'binary_precision': 0.7070845, 'binary_recall': 0.77117383, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.73773986}
confusion matrix:
       0    1
0  17852  215
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8063009, 'recall': 0.6257348, 'specificity': 0.6257348, 'f1': 0.67452073, 'auroc': 0.9466254, 'binary_precision': 0.6442308, 'binary_recall': 0.2576923, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.36813188}
confusion matrix:
      0   1
0  5909  37
1   193  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127983_9.png
early stop counter: 1
val acc:0.9803094863891602, best validation acc: 0.9815901517868042, corresponding to test acc:                         0.9632613658905029 / 0.9642281532287598
after epoch: 9,now: 2024-06-07 00:51:57.139039,epoch time: 0:39:45.108808,used: 5:59:08.215099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_18_52_48_seed_1_21127983
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
slurmstepd: error: *** JOB 21127983 ON gpusrv52 CANCELLED AT 2024-06-07T01:15:59 ***
