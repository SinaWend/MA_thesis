Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 13 16:39:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514

 Experiment start at: 2024-06-13 16:52:51.680674
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.4832161, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914648, 'auroc': 0.5358318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42322  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5388277, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4040288, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:14:20.229196,epoch time: 0:21:28.548522,used: 0:21:28.548522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.56725895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.57367903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49396265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-13 17:31:43.264070,epoch time: 0:17:23.034874,used: 0:38:51.583396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.63083005, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.60700995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5937265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-13 17:48:21.125707,epoch time: 0:16:37.861637,used: 0:55:29.445033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.70607626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.689683, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70242864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-13 18:04:59.600886,epoch time: 0:16:38.475179,used: 1:12:07.920212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.4832161, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914648, 'auroc': 0.77619064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42322  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.75862956, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7692155, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-13 18:21:38.278857,epoch time: 0:16:38.677971,used: 1:28:46.598183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.4832047, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914589, 'auroc': 0.80327415, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42321  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.81085736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8019668, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-13 18:38:13.885884,epoch time: 0:16:35.607027,used: 1:45:22.205210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.8217056, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.821569, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.83380383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-13 18:54:47.307968,epoch time: 0:16:33.422084,used: 2:01:55.627294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.4832043, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.491453, 'auroc': 0.84669137, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  1
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83382964, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8343257, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-13 19:11:19.291254,epoch time: 0:16:31.983286,used: 2:18:27.610580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.78325796, 'recall': 0.5019908, 'specificity': 0.5019908, 'f1': 0.4955122, 'auroc': 0.8592541, 'binary_precision': 0.6, 'binary_recall': 0.004076087, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.008097166}
confusion matrix:
       0  1
0  42316  4
1   1466  6
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8591886, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85016906, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-13 19:27:52.206949,epoch time: 0:16:32.915695,used: 2:35:00.526275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.7333318, 'recall': 0.50426215, 'specificity': 0.50426215, 'f1': 0.5001286, 'auroc': 0.86704314, 'binary_precision': 0.5, 'binary_recall': 0.0088315215, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.017356476}
confusion matrix:
       0   1
0  42307  13
1   1459  13
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.98291737, 'recall': 0.5007776, 'specificity': 0.5007776, 'f1': 0.49286303, 'auroc': 0.8634763, 'binary_precision': 1.0, 'binary_recall': 0.00155521, 'binary_specificity': 1.0, 'binary_f1_score': 0.0031055901}
confusion matrix:
       0  1
0  18149  0
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.85998535, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-13 19:44:30.603802,epoch time: 0:16:38.396853,used: 2:51:38.923128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.75617796, 'recall': 0.50791585, 'specificity': 0.50791585, 'f1': 0.507303, 'auroc': 0.8731352, 'binary_precision': 0.54545456, 'binary_recall': 0.016304348, 'binary_specificity': 0.9995274, 'binary_f1_score': 0.03166227}
confusion matrix:
       0   1
0  42300  20
1   1448  24
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.782967, 'recall': 0.50227773, 'specificity': 0.50227773, 'f1': 0.49593896, 'auroc': 0.86804914, 'binary_precision': 0.6, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.009259259}
confusion matrix:
       0  1
0  18147  2
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8621181, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_11.png
new oracle model saved
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9658365249633789, corresponding to test acc:                         0.9589325785636902 / 0.9598913192749023
after epoch: 11,now: 2024-06-13 20:01:01.910293,epoch time: 0:16:31.306491,used: 3:08:10.229619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7226746, 'recall': 0.5107839, 'specificity': 0.5107839, 'f1': 0.5128434, 'auroc': 0.876596, 'binary_precision': 0.47826087, 'binary_recall': 0.022418479, 'binary_specificity': 0.9991493, 'binary_f1_score': 0.04282933}
confusion matrix:
       0   1
0  42284  36
1   1439  33
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.8580441, 'recall': 0.50461054, 'specificity': 0.50461054, 'f1': 0.5005658, 'auroc': 0.8784652, 'binary_precision': 0.75, 'binary_recall': 0.00933126, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.01843318}
confusion matrix:
       0  1
0  18147  2
1    637  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.86317056, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_12.png
better model found
persisted
after epoch: 12,now: 2024-06-13 20:17:39.169321,epoch time: 0:16:37.259028,used: 3:24:47.488647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.76579785, 'recall': 0.5294158, 'specificity': 0.5294158, 'f1': 0.54615486, 'auroc': 0.8753985, 'binary_precision': 0.56329113, 'binary_recall': 0.060461957, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.10920246}
confusion matrix:
       0   1
0  42251  69
1   1383  89
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7418856, 'recall': 0.5112784, 'specificity': 0.5112784, 'f1': 0.513625, 'auroc': 0.8781055, 'binary_precision': 0.51724136, 'binary_recall': 0.02332815, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.044642862}
confusion matrix:
       0   1
0  18135  14
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8696598, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_13.png
new oracle model saved
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9597315192222595 / 0.9627676606178284
after epoch: 13,now: 2024-06-13 20:34:13.680186,epoch time: 0:16:34.510865,used: 3:41:21.999512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7670263, 'recall': 0.52845204, 'specificity': 0.52845204, 'f1': 0.5445484, 'auroc': 0.8910795, 'binary_precision': 0.56578946, 'binary_recall': 0.05846363, 'binary_specificity': 0.9984405, 'binary_f1_score': 0.10597658}
confusion matrix:
       0   1
0  42255  66
1   1385  86
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.71410525, 'recall': 0.5134183, 'specificity': 0.5134183, 'f1': 0.51764005, 'auroc': 0.8922528, 'binary_precision': 0.46153846, 'binary_recall': 0.02799378, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.052785926}
confusion matrix:
       0   1
0  18128  21
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.878061, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_14.png
new oracle model saved
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9597315192222595 / 0.9637264013290405
after epoch: 14,now: 2024-06-13 20:50:46.018628,epoch time: 0:16:32.338442,used: 3:57:54.337954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7525296, 'recall': 0.5339349, 'specificity': 0.5339349, 'f1': 0.5534144, 'auroc': 0.8901608, 'binary_precision': 0.5364583, 'binary_recall': 0.06997283, 'binary_specificity': 0.99789697, 'binary_f1_score': 0.12379808}
confusion matrix:
       0    1
0  42231   89
1   1369  103
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.75915366, 'recall': 0.51208353, 'specificity': 0.51208353, 'f1': 0.5151403, 'auroc': 0.8878031, 'binary_precision': 0.55172414, 'binary_recall': 0.02488336, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.04761905}
confusion matrix:
       0   1
0  18136  13
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9640558, 'recall': 0.55355644, 'specificity': 0.55355644, 'f1': 0.58698195, 'auroc': 0.8782755, 'binary_precision': 0.9655172, 'binary_recall': 0.107279696, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19310345}
confusion matrix:
      0   1
0  5996   1
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_15.png
early stop counter: 3
val acc:0.9659429788589478, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9597315192222595 / 0.9637264013290405
after epoch: 15,now: 2024-06-13 21:07:15.191762,epoch time: 0:16:29.173134,used: 4:14:23.511088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7499292, 'recall': 0.5276777, 'specificity': 0.5276777, 'f1': 0.54306674, 'auroc': 0.8862293, 'binary_precision': 0.5316456, 'binary_recall': 0.05710401, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.10313076}
confusion matrix:
       0   1
0  42247  74
1   1387  84
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.71657073, 'recall': 0.51044565, 'specificity': 0.51044565, 'f1': 0.5120651, 'auroc': 0.8801532, 'binary_precision': 0.46666667, 'binary_recall': 0.02177294, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.041604754}
confusion matrix:
       0   1
0  18133  16
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.87214893, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_16.png
early stop counter: 4
val acc:0.9656769037246704, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9597315192222595 / 0.9637264013290405
after epoch: 16,now: 2024-06-13 21:23:46.654020,epoch time: 0:16:31.462258,used: 4:30:54.973346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.74706745, 'recall': 0.5494137, 'specificity': 0.5494137, 'f1': 0.57693934, 'auroc': 0.888911, 'binary_precision': 0.5244755, 'binary_recall': 0.10204082, 'binary_specificity': 0.99678653, 'binary_f1_score': 0.17084283}
confusion matrix:
       0    1
0  42186  136
1   1320  150
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74810153, 'recall': 0.52786225, 'specificity': 0.52786225, 'f1': 0.54322803, 'auroc': 0.8880483, 'binary_precision': 0.5285714, 'binary_recall': 0.057542767, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.10378682}
confusion matrix:
       0   1
0  18116  33
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.98269475, 'recall': 0.5881226, 'specificity': 0.5881226, 'f1': 0.64103216, 'auroc': 0.8816016, 'binary_precision': 1.0, 'binary_recall': 0.17624521, 'binary_specificity': 1.0, 'binary_f1_score': 0.29967427}
confusion matrix:
      0   1
0  5997   0
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_17.png
new oracle model saved
early stop counter: 5
val acc:0.9659961462020874, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9597315192222595 / 0.9656440019607544
after epoch: 17,now: 2024-06-13 21:40:24.425688,epoch time: 0:16:37.771668,used: 4:47:32.745014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.75723565, 'recall': 0.5396349, 'specificity': 0.5396349, 'f1': 0.56256527, 'auroc': 0.89850616, 'binary_precision': 0.54545456, 'binary_recall': 0.08163265, 'binary_specificity': 0.99763715, 'binary_f1_score': 0.14201182}
confusion matrix:
       0    1
0  42222  100
1   1350  120
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7548783, 'recall': 0.5241395, 'specificity': 0.5241395, 'f1': 0.5369348, 'auroc': 0.8872444, 'binary_precision': 0.5423729, 'binary_recall': 0.04976672, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.0911681}
confusion matrix:
       0   1
0  18122  27
1    611  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9723531, 'recall': 0.5899549, 'specificity': 0.5899549, 'f1': 0.64329714, 'auroc': 0.87285167, 'binary_precision': 0.9791667, 'binary_recall': 0.18007663, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30420712}
confusion matrix:
      0   1
0  5996   1
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_18.png
better model found
persisted
after epoch: 18,now: 2024-06-13 21:57:21.655897,epoch time: 0:16:57.230209,used: 5:04:29.975223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9660897, 'precision': 0.7212835, 'recall': 0.5382059, 'specificity': 0.5382059, 'f1': 0.5594155, 'auroc': 0.9008635, 'binary_precision': 0.47368422, 'binary_recall': 0.079483695, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.13612564}
confusion matrix:
       0    1
0  42190  130
1   1355  117
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.76504433, 'recall': 0.5272224, 'specificity': 0.5272224, 'f1': 0.54230964, 'auroc': 0.89391387, 'binary_precision': 0.5625, 'binary_recall': 0.05598756, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.10183875}
confusion matrix:
       0   1
0  18121  28
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.9744639, 'recall': 0.6052806, 'specificity': 0.6052806, 'f1': 0.66501725, 'auroc': 0.87879765, 'binary_precision': 0.98214287, 'binary_recall': 0.21072797, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34700313}
confusion matrix:
      0   1
0  5996   1
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-13 22:13:52.727655,epoch time: 0:16:31.071758,used: 5:21:01.046981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.7431482, 'recall': 0.55126417, 'specificity': 0.55126417, 'f1': 0.579418, 'auroc': 0.90204656, 'binary_precision': 0.51655626, 'binary_recall': 0.10597826, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.17587373}
confusion matrix:
       0    1
0  42174  146
1   1316  156
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.75527114, 'recall': 0.5286674, 'specificity': 0.5286674, 'f1': 0.5446577, 'auroc': 0.89823955, 'binary_precision': 0.54285717, 'binary_recall': 0.05909798, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.10659186}
confusion matrix:
       0   1
0  18117  32
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.983551, 'recall': 0.6091954, 'specificity': 0.6091954, 'f1': 0.67088324, 'auroc': 0.87446404, 'binary_precision': 1.0, 'binary_recall': 0.21839081, 'binary_specificity': 1.0, 'binary_f1_score': 0.35849056}
confusion matrix:
      0   1
0  5997   0
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_20.png
new oracle model saved
early stop counter: 1
val acc:0.9661026000976562, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9669223427772522 / 0.9674017429351807
after epoch: 20,now: 2024-06-13 22:30:19.875892,epoch time: 0:16:27.148237,used: 5:37:28.195218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.7344245, 'recall': 0.5377038, 'specificity': 0.5377038, 'f1': 0.55899763, 'auroc': 0.8961066, 'binary_precision': 0.5, 'binary_recall': 0.078125, 'binary_specificity': 0.9972826, 'binary_f1_score': 0.13513513}
confusion matrix:
       0    1
0  42205  115
1   1357  115
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.73755956, 'recall': 0.5247794, 'specificity': 0.5247794, 'f1': 0.53790534, 'auroc': 0.89758444, 'binary_precision': 0.50769234, 'binary_recall': 0.051321927, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.09322034}
confusion matrix:
       0   1
0  18117  32
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9832393, 'recall': 0.6015326, 'specificity': 0.6015326, 'f1': 0.66026664, 'auroc': 0.8750707, 'binary_precision': 1.0, 'binary_recall': 0.20306513, 'binary_specificity': 1.0, 'binary_f1_score': 0.3375796}
confusion matrix:
      0   1
0  5997   0
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_21.png
early stop counter: 2
val acc:0.9658365249633789, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9669223427772522 / 0.9674017429351807
after epoch: 21,now: 2024-06-13 22:46:54.131203,epoch time: 0:16:34.255311,used: 5:54:02.450529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.7401035, 'recall': 0.5587695, 'specificity': 0.5587695, 'f1': 0.5896486, 'auroc': 0.89577436, 'binary_precision': 0.5099715, 'binary_recall': 0.12160326, 'binary_specificity': 0.99593574, 'binary_f1_score': 0.19637959}
confusion matrix:
       0    1
0  42148  172
1   1293  179
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.75365436, 'recall': 0.5309175, 'specificity': 0.5309175, 'f1': 0.548384, 'auroc': 0.8956269, 'binary_precision': 0.5394737, 'binary_recall': 0.06376361, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.11404729}
confusion matrix:
       0   1
0  18114  35
1    602  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.9751518, 'recall': 0.6110277, 'specificity': 0.6110277, 'f1': 0.6728866, 'auroc': 0.87866586, 'binary_precision': 0.9830508, 'binary_recall': 0.22222222, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3625}
confusion matrix:
      0   1
0  5996   1
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_22.png
early stop counter: 3
val acc:0.9661026000976562, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9669223427772522 / 0.9674017429351807
after epoch: 22,now: 2024-06-13 23:03:37.935891,epoch time: 0:16:43.804688,used: 6:10:46.255217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.73795784, 'recall': 0.55775046, 'specificity': 0.55775046, 'f1': 0.5881449, 'auroc': 0.9006802, 'binary_precision': 0.50574714, 'binary_recall': 0.11956522, 'binary_specificity': 0.99593574, 'binary_f1_score': 0.19340661}
confusion matrix:
       0    1
0  42148  172
1   1296  176
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7668657, 'recall': 0.53252786, 'specificity': 0.53252786, 'f1': 0.5512199, 'auroc': 0.8990648, 'binary_precision': 0.56578946, 'binary_recall': 0.06687403, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.11961056}
confusion matrix:
       0   1
0  18116  33
1    600  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.96376956, 'recall': 0.5956187, 'specificity': 0.5956187, 'f1': 0.65101707, 'auroc': 0.88053036, 'binary_precision': 0.96153843, 'binary_recall': 0.19157088, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5995   2
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_23.png
better model found
persisted
after epoch: 23,now: 2024-06-13 23:20:11.076478,epoch time: 0:16:33.140587,used: 6:27:19.395804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7507448, 'recall': 0.5860346, 'specificity': 0.5860346, 'f1': 0.62454474, 'auroc': 0.9088446, 'binary_precision': 0.5294118, 'binary_recall': 0.17755102, 'binary_specificity': 0.9945182, 'binary_f1_score': 0.2659195}
confusion matrix:
       0    1
0  42090  232
1   1209  261
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.76477313, 'recall': 0.54536146, 'specificity': 0.54536146, 'f1': 0.57144815, 'auroc': 0.9023098, 'binary_precision': 0.5607477, 'binary_recall': 0.0933126, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.16}
confusion matrix:
       0   1
0  18102  47
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.9686296, 'recall': 0.6205229, 'specificity': 0.6205229, 'f1': 0.6850481, 'auroc': 0.88174134, 'binary_precision': 0.9692308, 'binary_recall': 0.2413793, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.38650307}
confusion matrix:
      0   1
0  5995   2
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-13 23:36:51.063152,epoch time: 0:16:39.986674,used: 6:43:59.382478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.74948, 'recall': 0.57179546, 'specificity': 0.57179546, 'f1': 0.6072632, 'auroc': 0.9063428, 'binary_precision': 0.527845, 'binary_recall': 0.1481985, 'binary_specificity': 0.9953924, 'binary_f1_score': 0.23142251}
confusion matrix:
       0    1
0  42126  195
1   1253  218
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7626752, 'recall': 0.54458386, 'specificity': 0.54458386, 'f1': 0.57020646, 'auroc': 0.90053415, 'binary_precision': 0.5566038, 'binary_recall': 0.09175739, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.15754338}
confusion matrix:
       0   1
0  18102  47
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.9842539, 'recall': 0.62643677, 'specificity': 0.62643677, 'f1': 0.69383585, 'auroc': 0.88505554, 'binary_precision': 1.0, 'binary_recall': 0.25287357, 'binary_specificity': 1.0, 'binary_f1_score': 0.40366974}
confusion matrix:
      0   1
0  5997   0
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_25.png
new oracle model saved
early stop counter: 1
val acc:0.966421902179718, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9680408835411072 / 0.9688398838043213
after epoch: 25,now: 2024-06-13 23:53:51.090951,epoch time: 0:17:00.027799,used: 7:00:59.410277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9660897, 'precision': 0.7298945, 'recall': 0.5894033, 'specificity': 0.5894033, 'f1': 0.6257377, 'auroc': 0.90097606, 'binary_precision': 0.4875, 'binary_recall': 0.18558803, 'binary_specificity': 0.9932185, 'binary_f1_score': 0.26883307}
confusion matrix:
       0    1
0  42034  287
1   1198  273
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7507906, 'recall': 0.57080823, 'specificity': 0.57080823, 'f1': 0.6060388, 'auroc': 0.90565515, 'binary_precision': 0.53107345, 'binary_recall': 0.14618973, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.22926828}
confusion matrix:
       0   1
0  18066  83
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.954052, 'recall': 0.6680821, 'specificity': 0.6680821, 'f1': 0.74052775, 'auroc': 0.8869339, 'binary_precision': 0.9361702, 'binary_recall': 0.33716476, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.49577466}
confusion matrix:
      0   1
0  5991   6
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_26.png
new oracle model saved
early stop counter: 2
val acc:0.9663686752319336, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9680408835411072 / 0.9713966250419617
after epoch: 26,now: 2024-06-14 00:10:44.975143,epoch time: 0:16:53.884192,used: 7:17:53.294469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.74326307, 'recall': 0.5713492, 'specificity': 0.5713492, 'f1': 0.6061862, 'auroc': 0.9076734, 'binary_precision': 0.51543945, 'binary_recall': 0.1475187, 'binary_specificity': 0.9951797, 'binary_f1_score': 0.22938688}
confusion matrix:
       0    1
0  42117  204
1   1254  217
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.76613784, 'recall': 0.5400835, 'specificity': 0.5400835, 'f1': 0.56335074, 'auroc': 0.8967364, 'binary_precision': 0.5638298, 'binary_recall': 0.08242613, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.14382634}
confusion matrix:
       0   1
0  18108  41
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.98300576, 'recall': 0.59578544, 'specificity': 0.59578544, 'f1': 0.65212774, 'auroc': 0.8764453, 'binary_precision': 1.0, 'binary_recall': 0.19157088, 'binary_specificity': 1.0, 'binary_f1_score': 0.3215434}
confusion matrix:
      0   1
0  5997   0
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_27.png
early stop counter: 3
val acc:0.966421902179718, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9680408835411072 / 0.9713966250419617
after epoch: 27,now: 2024-06-14 00:27:34.732655,epoch time: 0:16:49.757512,used: 7:34:43.051981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7432717, 'recall': 0.57917947, 'specificity': 0.57917947, 'f1': 0.6157148, 'auroc': 0.9146824, 'binary_precision': 0.51495725, 'binary_recall': 0.16372283, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.24845362}
confusion matrix:
       0    1
0  42093  227
1   1231  241
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.75196403, 'recall': 0.5459738, 'specificity': 0.5459738, 'f1': 0.57195985, 'auroc': 0.9083475, 'binary_precision': 0.5350877, 'binary_recall': 0.09486781, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.16116248}
confusion matrix:
       0   1
0  18096  53
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.9841757, 'recall': 0.6245211, 'specificity': 0.6245211, 'f1': 0.6913471, 'auroc': 0.8844138, 'binary_precision': 1.0, 'binary_recall': 0.24904214, 'binary_specificity': 1.0, 'binary_f1_score': 0.39877298}
confusion matrix:
      0   1
0  5997   0
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_28.png
early stop counter: 4
val acc:0.9662090539932251, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9680408835411072 / 0.9713966250419617
after epoch: 28,now: 2024-06-14 00:44:15.210262,epoch time: 0:16:40.477607,used: 7:51:23.529588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.75019014, 'recall': 0.5613591, 'specificity': 0.5613591, 'f1': 0.5937561, 'auroc': 0.9101177, 'binary_precision': 0.52991456, 'binary_recall': 0.12661675, 'binary_specificity': 0.99610144, 'binary_f1_score': 0.20439559}
confusion matrix:
       0    1
0  42158  165
1   1283  186
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7341627, 'recall': 0.53825283, 'specificity': 0.53825283, 'f1': 0.5597292, 'auroc': 0.90760314, 'binary_precision': 0.5, 'binary_recall': 0.07931571, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.13691275}
confusion matrix:
       0   1
0  18098  51
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.98316145, 'recall': 0.5996169, 'specificity': 0.5996169, 'f1': 0.6575707, 'auroc': 0.885889, 'binary_precision': 1.0, 'binary_recall': 0.19923371, 'binary_specificity': 1.0, 'binary_f1_score': 0.33226836}
confusion matrix:
      0   1
0  5997   0
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_29.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9680408835411072 / 0.9713966250419617
after epoch: 29,now: 2024-06-14 01:00:54.571557,epoch time: 0:16:39.361295,used: 8:08:02.890883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.7527131, 'recall': 0.5688416, 'specificity': 0.5688416, 'f1': 0.6037561, 'auroc': 0.90986484, 'binary_precision': 0.5345268, 'binary_recall': 0.1419837, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.2243693}
confusion matrix:
       0    1
0  42138  182
1   1263  209
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.76802886, 'recall': 0.54463893, 'specificity': 0.54463893, 'f1': 0.570445, 'auroc': 0.90553844, 'binary_precision': 0.5673077, 'binary_recall': 0.09175739, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.15796518}
confusion matrix:
       0   1
0  18104  45
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.887622, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_30.png
better model found
persisted
after epoch: 30,now: 2024-06-14 01:17:39.321259,epoch time: 0:16:44.749702,used: 8:24:47.640585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:24:47.640585 at 2024-06-14 01:17:39.321259
persisted model performance metric: 

scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.887622, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
oracle model performance metric: 

scalar performance:
{'acc': 0.9713966, 'precision': 0.954052, 'recall': 0.6680821, 'specificity': 0.6680821, 'f1': 0.74052775, 'auroc': 0.8869339, 'binary_precision': 0.9361702, 'binary_recall': 0.33716476, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.49577466}
confusion matrix:
      0   1
0  5991   6
1   173  88
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/13.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 217798 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 380202 GiB | 380202 GiB |
|       from small pool |  12108 KiB |  14040 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6223    |   83720 K  |   83717 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49875 K  |   49871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6223    |   83720 K  |   83717 K  |
|       from large pool |      36    |      76    |   33845 K  |   33845 K  |
|       from small pool |    3216    |    6186    |   49875 K  |   49871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2754    |   37618 K  |   37618 K  |
|       from large pool |       7    |      11    |   12101 K  |   12101 K  |
|       from small pool |      32    |    2747    |   25516 K  |   25516 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380203 GiB | 380203 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2754    |   37619 K  |   37619 K  |
|       from large pool |       3    |      13    |   12101 K  |   12101 K  |
|       from small pool |       0    |    2747    |   25517 K  |   25517 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    942 TiB |    942 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    942 TiB |    942 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    940 TiB |    940 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    940 TiB |    940 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 380507 GiB | 380507 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 380203 GiB | 380203 GiB |
|       from small pool |      0 KiB |  19703 KiB |    304 GiB |    304 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6223    |   83720 K  |   83720 K  |
|       from large pool |       2    |      76    |   33845 K  |   33845 K  |
|       from small pool |       0    |    6186    |   49875 K  |   49875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2754    |   37619 K  |   37619 K  |
|       from large pool |       3    |      13    |   12101 K  |   12101 K  |
|       from small pool |       0    |    2747    |   25517 K  |   25517 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514

 Experiment start at: 2024-06-14 01:25:13.567700
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.44931766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.3987276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.33519998, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 01:42:17.842996,epoch time: 0:17:04.275296,used: 0:17:04.275296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.5428196, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.50970715, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4287029, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-14 01:59:12.183223,epoch time: 0:16:54.340227,used: 0:33:58.615523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.6260805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.580945, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.55282474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_3.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-14 02:16:04.825450,epoch time: 0:16:52.642227,used: 0:50:51.257750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.69395053, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.66055083, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.66546583, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_4.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-14 02:33:06.040541,epoch time: 0:17:01.215091,used: 1:07:52.472841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.7510891, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7441461, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.74502504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_5.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-14 02:49:58.251806,epoch time: 0:16:52.211265,used: 1:24:44.684106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.80693567, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8009125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.78941125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_6.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-14 03:06:49.624611,epoch time: 0:16:51.372805,used: 1:41:36.056911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.823014, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8340627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.81552434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_7.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-14 03:23:46.767652,epoch time: 0:16:57.143041,used: 1:58:33.199952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.48355985, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164253, 'auroc': 0.8367454, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42414  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8281876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.82704616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_8.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-14 03:40:46.133109,epoch time: 0:16:59.365457,used: 2:15:32.565409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.68358076, 'recall': 0.5006581, 'specificity': 0.5006581, 'f1': 0.4930184, 'auroc': 0.8469584, 'binary_precision': 0.4, 'binary_recall': 0.0013869626, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.0027643403}
confusion matrix:
       0  1
0  42411  3
1   1440  2
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.84557843, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8387798, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_9.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-14 03:57:47.189805,epoch time: 0:17:01.056696,used: 2:32:33.622105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7932241, 'recall': 0.5044133, 'specificity': 0.5044133, 'f1': 0.5005553, 'auroc': 0.8597851, 'binary_precision': 0.61904764, 'binary_recall': 0.009015257, 'binary_specificity': 0.9998114, 'binary_f1_score': 0.017771702}
confusion matrix:
       0   1
0  42406   8
1   1429  13
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.98209524, 'recall': 0.5014859, 'specificity': 0.5014859, 'f1': 0.49384734, 'auroc': 0.8779079, 'binary_precision': 1.0, 'binary_recall': 0.0029717681, 'binary_specificity': 1.0, 'binary_f1_score': 0.005925926}
confusion matrix:
       0  1
0  18067  0
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8483326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_10.png
better model found
persisted
after epoch: 10,now: 2024-06-14 04:14:39.347831,epoch time: 0:16:52.158026,used: 2:49:25.780131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.72871333, 'recall': 0.5080271, 'specificity': 0.5080271, 'f1': 0.5077286, 'auroc': 0.872332, 'binary_precision': 0.48979592, 'binary_recall': 0.01664355, 'binary_specificity': 0.99941057, 'binary_f1_score': 0.032193158}
confusion matrix:
       0   1
0  42389  25
1   1418  24
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.75492066, 'recall': 0.50431925, 'specificity': 0.50431925, 'f1': 0.4996405, 'auroc': 0.8728127, 'binary_precision': 0.54545456, 'binary_recall': 0.008915304, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.01754386}
confusion matrix:
       0  1
0  18062  5
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.8541384, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_11.png
new oracle model saved
early stop counter: 1
val acc:0.9641408920288086, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 11,now: 2024-06-14 04:31:35.346074,epoch time: 0:16:55.998243,used: 3:06:21.778374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.7244705, 'recall': 0.5126928, 'specificity': 0.5126928, 'f1': 0.516601, 'auroc': 0.87701786, 'binary_precision': 0.48101267, 'binary_recall': 0.026352288, 'binary_specificity': 0.99903333, 'binary_f1_score': 0.049967125}
confusion matrix:
       0   1
0  42373  41
1   1404  38
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.721446, 'recall': 0.5078403, 'specificity': 0.5078403, 'f1': 0.506643, 'auroc': 0.88491493, 'binary_precision': 0.47826087, 'binary_recall': 0.016344724, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.031609192}
confusion matrix:
       0   1
0  18055  12
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.857211, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_12.png
new oracle model saved
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9581050872802734 / 0.9595552682876587
after epoch: 12,now: 2024-06-14 04:48:35.045867,epoch time: 0:16:59.699793,used: 3:23:21.478167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7580794, 'recall': 0.5272962, 'specificity': 0.5272962, 'f1': 0.54265285, 'auroc': 0.88108814, 'binary_precision': 0.5472973, 'binary_recall': 0.056171983, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.1018868}
confusion matrix:
       0   1
0  42347  67
1   1361  81
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74930906, 'recall': 0.5172494, 'specificity': 0.5172494, 'f1': 0.5243135, 'auroc': 0.89079666, 'binary_precision': 0.53333336, 'binary_recall': 0.035661217, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.06685237}
confusion matrix:
       0   1
0  18046  21
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8655741, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-14 05:05:35.108944,epoch time: 0:17:00.063077,used: 3:40:21.541244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7476584, 'recall': 0.5231942, 'specificity': 0.5231942, 'f1': 0.5355357, 'auroc': 0.88251215, 'binary_precision': 0.52671754, 'binary_recall': 0.047850206, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.08773045}
confusion matrix:
       0   1
0  42352  62
1   1373  69
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.73927295, 'recall': 0.51361775, 'specificity': 0.51361775, 'f1': 0.51762265, 'auroc': 0.88005394, 'binary_precision': 0.5135135, 'binary_recall': 0.028231798, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.053521127}
confusion matrix:
       0   1
0  18049  18
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.85909903, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_14.png
early stop counter: 1
val acc:0.9641408920288086, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9606832265853882 / 0.9606832265853882
after epoch: 14,now: 2024-06-14 05:22:27.360433,epoch time: 0:16:52.251489,used: 3:57:13.792733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.69443595, 'recall': 0.5175167, 'specificity': 0.5175167, 'f1': 0.5253152, 'auroc': 0.88744074, 'binary_precision': 0.42063493, 'binary_recall': 0.036754508, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.06760204}
confusion matrix:
       0   1
0  42341  73
1   1389  53
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.73776746, 'recall': 0.51790935, 'specificity': 0.51790935, 'f1': 0.52548516, 'auroc': 0.9008014, 'binary_precision': 0.5102041, 'binary_recall': 0.0371471, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.069252074}
confusion matrix:
       0   1
0  18043  24
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.86600816, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_15.png
early stop counter: 2
val acc:0.9641408920288086, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9606832265853882 / 0.9606832265853882
after epoch: 15,now: 2024-06-14 05:39:28.529829,epoch time: 0:17:01.169396,used: 4:14:14.962129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.7151228, 'recall': 0.53529274, 'specificity': 0.53529274, 'f1': 0.5549127, 'auroc': 0.8880769, 'binary_precision': 0.46086955, 'binary_recall': 0.073509015, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.12679425}
confusion matrix:
       0    1
0  42290  124
1   1336  106
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.76517916, 'recall': 0.52525574, 'specificity': 0.52525574, 'f1': 0.53857017, 'auroc': 0.8886908, 'binary_precision': 0.5645161, 'binary_recall': 0.052005943, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.09523809}
confusion matrix:
       0   1
0  18040  27
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8649273, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-06-14 05:56:31.660053,epoch time: 0:17:03.130224,used: 4:31:18.092353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.73529816, 'recall': 0.5542623, 'specificity': 0.5542623, 'f1': 0.58334374, 'auroc': 0.8913467, 'binary_precision': 0.5, 'binary_recall': 0.11234397, 'binary_specificity': 0.99618053, 'binary_f1_score': 0.18346547}
confusion matrix:
       0    1
0  42252  162
1   1280  162
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.73626125, 'recall': 0.5279231, 'specificity': 0.5279231, 'f1': 0.54285216, 'auroc': 0.8958831, 'binary_precision': 0.5064935, 'binary_recall': 0.05794948, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.103999995}
confusion matrix:
       0   1
0  18029  38
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.98153543, 'recall': 0.56153846, 'specificity': 0.56153846, 'f1': 0.6001831, 'auroc': 0.86847913, 'binary_precision': 1.0, 'binary_recall': 0.12307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.21917808}
confusion matrix:
      0   1
0  5946   0
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_17.png
new oracle model saved
early stop counter: 1
val acc:0.9641408920288086, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9632613658905029
after epoch: 17,now: 2024-06-14 06:13:37.970635,epoch time: 0:17:06.310582,used: 4:48:24.402935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.7137112, 'recall': 0.536274, 'specificity': 0.536274, 'f1': 0.5563841, 'auroc': 0.89352095, 'binary_precision': 0.4579832, 'binary_recall': 0.075589456, 'binary_specificity': 0.99695855, 'binary_f1_score': 0.1297619}
confusion matrix:
       0    1
0  42285  129
1   1333  109
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7329637, 'recall': 0.5264649, 'specificity': 0.5264649, 'f1': 0.5403708, 'auroc': 0.89868534, 'binary_precision': 0.5, 'binary_recall': 0.05497771, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.09906292}
confusion matrix:
       0   1
0  18030  37
1    636  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.9816915, 'recall': 0.5653846, 'specificity': 0.5653846, 'f1': 0.6063213, 'auroc': 0.8662139, 'binary_precision': 1.0, 'binary_recall': 0.13076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.23129253}
confusion matrix:
      0   1
0  5946   0
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_18.png
new oracle model saved
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9635836482048035
after epoch: 18,now: 2024-06-14 06:30:39.638946,epoch time: 0:17:01.668311,used: 5:05:26.071246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.73880327, 'recall': 0.5445958, 'specificity': 0.5445958, 'f1': 0.56969196, 'auroc': 0.8988161, 'binary_precision': 0.50763357, 'binary_recall': 0.09223301, 'binary_specificity': 0.99695855, 'binary_f1_score': 0.1561033}
confusion matrix:
       0    1
0  42285  129
1   1309  133
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7328639, 'recall': 0.5236038, 'specificity': 0.5236038, 'f1': 0.53549623, 'auroc': 0.8911476, 'binary_precision': 0.5, 'binary_recall': 0.049034175, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.08930988}
confusion matrix:
       0   1
0  18034  33
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9814575, 'recall': 0.5596154, 'specificity': 0.5596154, 'f1': 0.59708285, 'auroc': 0.8641834, 'binary_precision': 1.0, 'binary_recall': 0.11923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5946   0
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_19.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9635836482048035
after epoch: 19,now: 2024-06-14 06:47:36.810217,epoch time: 0:16:57.171271,used: 5:22:23.242517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.72427016, 'recall': 0.5511195, 'specificity': 0.5511195, 'f1': 0.5784183, 'auroc': 0.899639, 'binary_precision': 0.478125, 'binary_recall': 0.106176265, 'binary_specificity': 0.9960627, 'binary_f1_score': 0.1737649}
confusion matrix:
       0    1
0  42248  167
1   1288  153
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.75211215, 'recall': 0.5359571, 'specificity': 0.5359571, 'f1': 0.5562041, 'auroc': 0.9024396, 'binary_precision': 0.53763443, 'binary_recall': 0.0742942, 'binary_specificity': 0.99762, 'binary_f1_score': 0.1305483}
confusion matrix:
       0   1
0  18024  43
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.98184764, 'recall': 0.5692308, 'specificity': 0.5692308, 'f1': 0.61237764, 'auroc': 0.8662378, 'binary_precision': 1.0, 'binary_recall': 0.13846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.24324325}
confusion matrix:
      0   1
0  5946   0
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_20.png
new oracle model saved
early stop counter: 4
val acc:0.9644610285758972, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9639058709144592
after epoch: 20,now: 2024-06-14 07:04:33.396156,epoch time: 0:16:56.585939,used: 5:39:19.828456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.7247489, 'recall': 0.56577337, 'specificity': 0.56577337, 'f1': 0.59775436, 'auroc': 0.89510125, 'binary_precision': 0.47815534, 'binary_recall': 0.13661581, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.2125135}
confusion matrix:
       0    1
0  42199  215
1   1245  197
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.72583514, 'recall': 0.53496504, 'specificity': 0.53496504, 'f1': 0.5540992, 'auroc': 0.9050112, 'binary_precision': 0.48514852, 'binary_recall': 0.07280832, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.12661499}
confusion matrix:
       0   1
0  18015  52
1    624  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.9617909, 'recall': 0.5882934, 'specificity': 0.5882934, 'f1': 0.64042795, 'auroc': 0.8718445, 'binary_precision': 0.9583333, 'binary_recall': 0.17692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.2987013}
confusion matrix:
      0   1
0  5944   2
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_21.png
new oracle model saved
early stop counter: 5
val acc:0.9639274477958679, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 21,now: 2024-06-14 07:21:31.731094,epoch time: 0:16:58.334938,used: 5:56:18.163394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9662304, 'precision': 0.70575464, 'recall': 0.5498074, 'specificity': 0.5498074, 'f1': 0.575605, 'auroc': 0.8989339, 'binary_precision': 0.44117647, 'binary_recall': 0.10409438, 'binary_specificity': 0.9955205, 'binary_f1_score': 0.16844468}
confusion matrix:
       0    1
0  42225  190
1   1291  150
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73313856, 'recall': 0.5314717, 'specificity': 0.5314717, 'f1': 0.5486545, 'auroc': 0.90307796, 'binary_precision': 0.5, 'binary_recall': 0.0653789, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.11563731}
confusion matrix:
       0   1
0  18023  44
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.87078583, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_22.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.964514434337616, corresponding to test acc:                         0.9611666202545166 / 0.9651950001716614
after epoch: 22,now: 2024-06-14 07:38:24.109473,epoch time: 0:16:52.378379,used: 6:13:10.541773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9666864, 'precision': 0.72528726, 'recall': 0.5717907, 'specificity': 0.5717907, 'f1': 0.60518456, 'auroc': 0.9000963, 'binary_precision': 0.47884187, 'binary_recall': 0.14909847, 'binary_specificity': 0.99448293, 'binary_f1_score': 0.22739291}
confusion matrix:
       0    1
0  42180  234
1   1227  215
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.768358, 'recall': 0.5505392, 'specificity': 0.5505392, 'f1': 0.57899845, 'auroc': 0.90132034, 'binary_precision': 0.5691057, 'binary_recall': 0.104011886, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.17587939}
confusion matrix:
       0   1
0  18014  53
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.9750947, 'recall': 0.61145437, 'specificity': 0.61145437, 'f1': 0.6734249, 'auroc': 0.8741325, 'binary_precision': 0.9830508, 'binary_recall': 0.22307692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.36363634}
confusion matrix:
      0   1
0  5945   1
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_23.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-06-14 07:55:34.577988,epoch time: 0:17:10.468515,used: 6:30:21.010288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.73409253, 'recall': 0.5599328, 'specificity': 0.5599328, 'f1': 0.5909299, 'auroc': 0.90172094, 'binary_precision': 0.49722221, 'binary_recall': 0.12413315, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.19866814}
confusion matrix:
       0    1
0  42233  181
1   1263  179
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74991065, 'recall': 0.5344989, 'specificity': 0.5344989, 'f1': 0.5538266, 'auroc': 0.9046227, 'binary_precision': 0.53333336, 'binary_recall': 0.07132243, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.12581913}
confusion matrix:
       0   1
0  18025  42
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.97135925, 'recall': 0.5845313, 'specificity': 0.5845313, 'f1': 0.6353005, 'auroc': 0.87482166, 'binary_precision': 0.9777778, 'binary_recall': 0.16923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2885246}
confusion matrix:
      0   1
0  5945   1
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_24.png
early stop counter: 1
val acc:0.9644076824188232, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9672897458076477 / 0.9672897458076477
after epoch: 24,now: 2024-06-14 08:12:30.202807,epoch time: 0:16:55.624819,used: 6:47:16.635107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96698284, 'precision': 0.73213345, 'recall': 0.5750007, 'specificity': 0.5750007, 'f1': 0.6097068, 'auroc': 0.8977531, 'binary_precision': 0.4923077, 'binary_recall': 0.1554476, 'binary_specificity': 0.9945538, 'binary_f1_score': 0.23628692}
confusion matrix:
       0    1
0  42184  231
1   1217  224
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73391604, 'recall': 0.553645, 'specificity': 0.553645, 'f1': 0.58195025, 'auroc': 0.90982485, 'binary_precision': 0.5, 'binary_recall': 0.11144131, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.18226002}
confusion matrix:
       0   1
0  17992  75
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.96781284, 'recall': 0.65744007, 'specificity': 0.65744007, 'f1': 0.73018134, 'auroc': 0.87600666, 'binary_precision': 0.9647059, 'binary_recall': 0.31538463, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4753623}
confusion matrix:
      0   1
0  5943   3
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_25.png
new oracle model saved
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9672897458076477 / 0.9708346724510193
after epoch: 25,now: 2024-06-14 08:29:14.726668,epoch time: 0:16:44.523861,used: 7:04:01.158968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7436596, 'recall': 0.58055353, 'specificity': 0.58055353, 'f1': 0.6174649, 'auroc': 0.9059841, 'binary_precision': 0.51502144, 'binary_recall': 0.16643551, 'binary_specificity': 0.9946716, 'binary_f1_score': 0.25157234}
confusion matrix:
       0    1
0  42188  226
1   1202  240
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.762387, 'recall': 0.5454216, 'specificity': 0.5454216, 'f1': 0.57115936, 'auroc': 0.90603757, 'binary_precision': 0.5575221, 'binary_recall': 0.0936107, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.16030535}
confusion matrix:
       0   1
0  18017  50
1    610  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.96370715, 'recall': 0.59598565, 'specificity': 0.59598565, 'f1': 0.6514961, 'auroc': 0.87413585, 'binary_precision': 0.96153843, 'binary_recall': 0.1923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.3205128}
confusion matrix:
      0   1
0  5944   2
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_26.png
early stop counter: 3
val acc:0.9647812247276306, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9672897458076477 / 0.9708346724510193
after epoch: 26,now: 2024-06-14 08:45:45.644254,epoch time: 0:16:30.917586,used: 7:20:32.076554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9674617, 'precision': 0.7437032, 'recall': 0.58893913, 'specificity': 0.58893913, 'f1': 0.6270911, 'auroc': 0.90899813, 'binary_precision': 0.5145631, 'binary_recall': 0.18377253, 'binary_specificity': 0.9941057, 'binary_f1_score': 0.27082267}
confusion matrix:
       0    1
0  42164  250
1   1177  265
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7629657, 'recall': 0.5555184, 'specificity': 0.5555184, 'f1': 0.585986, 'auroc': 0.9043127, 'binary_precision': 0.557971, 'binary_recall': 0.114413075, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.18988901}
confusion matrix:
       0   1
0  18006  61
1    596  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.9755299, 'recall': 0.61530054, 'specificity': 0.61530054, 'f1': 0.67860395, 'auroc': 0.86975133, 'binary_precision': 0.9836066, 'binary_recall': 0.23076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.37383178}
confusion matrix:
      0   1
0  5945   1
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_27.png
early stop counter: 4
val acc:0.9649413228034973, best validation acc: 0.9649946689605713, corresponding to test acc:                         0.9672897458076477 / 0.9708346724510193
after epoch: 27,now: 2024-06-14 09:02:32.416067,epoch time: 0:16:46.771813,used: 7:37:18.848367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.7409736, 'recall': 0.5788199, 'specificity': 0.5788199, 'f1': 0.61513925, 'auroc': 0.89351594, 'binary_precision': 0.5097614, 'binary_recall': 0.1629681, 'binary_specificity': 0.9946716, 'binary_f1_score': 0.24697846}
confusion matrix:
       0    1
0  42188  226
1   1207  235
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7751398, 'recall': 0.56435066, 'specificity': 0.56435066, 'f1': 0.5989088, 'auroc': 0.8994818, 'binary_precision': 0.5816994, 'binary_recall': 0.13224368, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.21549636}
confusion matrix:
       0   1
0  18003  64
1    584  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.9668999, 'recall': 0.61137027, 'specificity': 0.61137027, 'f1': 0.67281467, 'auroc': 0.8746836, 'binary_precision': 0.96666664, 'binary_recall': 0.22307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.3625}
confusion matrix:
      0   1
0  5944   2
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_28.png
better model found
persisted
after epoch: 28,now: 2024-06-14 09:19:04.119173,epoch time: 0:16:31.703106,used: 7:53:50.551473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9668232, 'precision': 0.73093545, 'recall': 0.5939683, 'specificity': 0.5939683, 'f1': 0.6308264, 'auroc': 0.9037515, 'binary_precision': 0.48869565, 'binary_recall': 0.19486824, 'binary_specificity': 0.99306834, 'binary_f1_score': 0.27863163}
confusion matrix:
       0    1
0  42120  294
1   1161  281
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.73897743, 'recall': 0.5544433, 'specificity': 0.5544433, 'f1': 0.5833189, 'auroc': 0.90711385, 'binary_precision': 0.5100671, 'binary_recall': 0.11292719, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.18491484}
confusion matrix:
       0   1
0  17994  73
1    597  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.9672518, 'recall': 0.61329335, 'specificity': 0.61329335, 'f1': 0.675406, 'auroc': 0.87563664, 'binary_precision': 0.9672131, 'binary_recall': 0.22692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.36760125}
confusion matrix:
      0   1
0  5944   2
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_29.png
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.967128574848175 / 0.9708346724510193
after epoch: 29,now: 2024-06-14 09:35:38.584698,epoch time: 0:16:34.465525,used: 8:10:25.016998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.73792815, 'recall': 0.59382194, 'specificity': 0.59382194, 'f1': 0.6316757, 'auroc': 0.89980656, 'binary_precision': 0.502693, 'binary_recall': 0.19417475, 'binary_specificity': 0.9934691, 'binary_f1_score': 0.28014004}
confusion matrix:
       0    1
0  42137  277
1   1162  280
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7634766, 'recall': 0.5656151, 'specificity': 0.5656151, 'f1': 0.59992796, 'auroc': 0.91244256, 'binary_precision': 0.5582822, 'binary_recall': 0.13521545, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.21770333}
confusion matrix:
       0   1
0  17995  72
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.9645764, 'recall': 0.5998318, 'specificity': 0.5998318, 'f1': 0.65692604, 'auroc': 0.8785975, 'binary_precision': 0.962963, 'binary_recall': 0.2, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.3312102}
confusion matrix:
      0   1
0  5944   2
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_30.png
early stop counter: 2
val acc:0.9651013612747192, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.967128574848175 / 0.9708346724510193
after epoch: 30,now: 2024-06-14 09:52:11.820233,epoch time: 0:16:33.235535,used: 8:26:58.252533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_01_25_13_seed_1_21316514
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:26:58.252533 at 2024-06-14 09:52:11.820233
persisted model performance metric: 

scalar performance:
{'acc': 0.9671286, 'precision': 0.9668999, 'recall': 0.61137027, 'specificity': 0.61137027, 'f1': 0.67281467, 'auroc': 0.8746836, 'binary_precision': 0.96666664, 'binary_recall': 0.22307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.3625}
confusion matrix:
      0   1
0  5944   2
1   202  58
oracle model performance metric: 

scalar performance:
{'acc': 0.9708347, 'precision': 0.96781284, 'recall': 0.65744007, 'specificity': 0.65744007, 'f1': 0.73018134, 'auroc': 0.87600666, 'binary_precision': 0.9647059, 'binary_recall': 0.31538463, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.4753623}
confusion matrix:
      0   1
0  5943   3
1   178  82
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 709582 GiB | 709582 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 708973 GiB | 708973 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6231    |  167411 K  |  167408 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99732 K  |   99729 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6231    |  167411 K  |  167408 K  |
|       from large pool |      36    |      76    |   67679 K  |   67679 K  |
|       from small pool |    3192    |    6194    |   99732 K  |   99729 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    2755    |   76310 K  |   76310 K  |
|       from large pool |       5    |      13    |   25320 K  |   25320 K  |
|       from small pool |      31    |    2750    |   50990 K  |   50990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709582 GiB | 709582 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 708974 GiB | 708973 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167411 K  |  167411 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99732 K  |   99732 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167411 K  |  167411 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99732 K  |   99732 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76312 K  |   76312 K  |
|       from large pool |       3    |      13    |   25320 K  |   25320 K  |
|       from small pool |       0    |    2750    |   50991 K  |   50991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1888 TiB |   1888 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1888 TiB |   1888 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1880 TiB |   1880 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 709582 GiB | 709582 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 708974 GiB | 708973 GiB |
|       from small pool |      0 KiB |  19715 KiB |    608 GiB |    608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6231    |  167411 K  |  167411 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99732 K  |   99732 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6231    |  167411 K  |  167411 K  |
|       from large pool |       2    |      76    |   67679 K  |   67679 K  |
|       from small pool |       0    |    6194    |   99732 K  |   99732 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2755    |   76312 K  |   76312 K  |
|       from large pool |       3    |      13    |   25320 K  |   25320 K  |
|       from small pool |       0    |    2750    |   50991 K  |   50991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_10_00_03_seed_2_21316514

 Experiment start at: 2024-06-14 10:00:03.741429
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.45899338, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4189192, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.38874722, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316514_1.png
new oracle model saved
better model found
[Fri Jun 14 10:17:40 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/13.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 12338880 vs 12338704
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 62, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
