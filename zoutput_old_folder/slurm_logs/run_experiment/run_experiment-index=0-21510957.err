Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 18:29:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing_test/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_different_bs128_lre4_classbalancing_test/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957

 Experiment start at: 2024-06-19 18:37:49.592546
before training, model accuracy: 0.31622418761253357
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.45277184, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47521538, 'auroc': 0.56770694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  0
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.34326175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.33094773, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 18:53:42.766355,epoch time: 0:15:53.173809,used: 0:15:53.173809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.777585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39571473, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.48868048, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 2,now: 2024-06-19 19:10:02.290682,epoch time: 0:16:19.524327,used: 0:32:12.698136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9094606, 'precision': 0.94411623, 'recall': 0.52114016, 'specificity': 0.52114016, 'f1': 0.5168089, 'auroc': 0.877939, 'binary_precision': 0.9790576, 'binary_recall': 0.0423748, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.0812337}
confusion matrix:
       0    1
0  42303    4
1   4226  187
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.45056292, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88451326, 'precision': 0.44225663, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.469359, 'auroc': 0.6198545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.884513258934021
after epoch: 3,now: 2024-06-19 19:25:05.586296,epoch time: 0:15:03.295614,used: 0:47:15.993750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9265839, 'precision': 0.94754654, 'recall': 0.61479735, 'specificity': 0.61479735, 'f1': 0.6666335, 'auroc': 0.9066787, 'binary_precision': 0.96949476, 'binary_recall': 0.23035108, 'binary_specificity': 0.9992436, 'binary_f1_score': 0.3722548}
confusion matrix:
       0     1
0  42273    32
1   3398  1017
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.4828871, 'recall': 0.49986225, 'specificity': 0.49986225, 'f1': 0.49122804, 'auroc': 0.5033915, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18144  5
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8864307, 'precision': 0.8843969, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.4885776, 'auroc': 0.7033038, 'binary_precision': 0.88235295, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037499998}
confusion matrix:
      0   1
0  5995   2
1   768  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_4.png
new oracle model saved
early stop counter: 3
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8864306807518005
after epoch: 4,now: 2024-06-19 19:40:40.894297,epoch time: 0:15:35.308001,used: 1:02:51.301751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94188786, 'precision': 0.95199436, 'recall': 0.69942284, 'specificity': 0.69942284, 'f1': 0.76726514, 'auroc': 0.925987, 'binary_precision': 0.962963, 'binary_recall': 0.400453, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.56566954}
confusion matrix:
       0     1
0  42237    68
1   2647  1768
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.5429488, 'recall': 0.50172675, 'specificity': 0.50172675, 'f1': 0.49552473, 'auroc': 0.56476474, 'binary_precision': 0.12, 'binary_recall': 0.00466563, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.008982036}
confusion matrix:
       0   1
0  18127  22
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8954277, 'precision': 0.8829042, 'recall': 0.5544717, 'specificity': 0.5544717, 'f1': 0.57056373, 'auroc': 0.75851905, 'binary_precision': 0.87, 'binary_recall': 0.11111111, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.1970555}
confusion matrix:
      0   1
0  5984  13
1   696  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_5.png
new oracle model saved
early stop counter: 4
val acc:0.9647722244262695, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.8954277038574219
after epoch: 5,now: 2024-06-19 19:55:29.241712,epoch time: 0:14:48.347415,used: 1:17:39.649166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95235443, 'precision': 0.948886, 'recall': 0.76138353, 'specificity': 0.76138353, 'f1': 0.8250408, 'auroc': 0.9381844, 'binary_precision': 0.9450102, 'binary_recall': 0.5259578, 'binary_specificity': 0.9968092, 'binary_f1_score': 0.67579377}
confusion matrix:
       0     1
0  42174   135
1   2091  2320
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.53384537, 'recall': 0.5032055, 'specificity': 0.5032055, 'f1': 0.49919283, 'auroc': 0.5995749, 'binary_precision': 0.10169491, 'binary_recall': 0.00933126, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.017094018}
confusion matrix:
       0   1
0  18096  53
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9051622, 'precision': 0.88732135, 'recall': 0.6032796, 'specificity': 0.6032796, 'f1': 0.6440364, 'auroc': 0.77605784, 'binary_precision': 0.8684211, 'binary_recall': 0.21072797, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33915725}
confusion matrix:
      0    1
0  5972   25
1   618  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_6.png
new oracle model saved
early stop counter: 5
val acc:0.9632822275161743, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9051622152328491
after epoch: 6,now: 2024-06-19 20:09:54.489280,epoch time: 0:14:25.247568,used: 1:32:04.896734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.953125, 'precision': 0.9387231, 'recall': 0.77262294, 'specificity': 0.77262294, 'f1': 0.83191824, 'auroc': 0.93775725, 'binary_precision': 0.9224924, 'binary_recall': 0.55006796, 'binary_specificity': 0.995178, 'binary_f1_score': 0.6891854}
confusion matrix:
       0     1
0  42102   204
1   1986  2428
---- Validation: 
scalar performance:
{'acc': 0.9613133, 'precision': 0.54566383, 'recall': 0.5081866, 'specificity': 0.5081866, 'f1': 0.5086731, 'auroc': 0.61831903, 'binary_precision': 0.125, 'binary_recall': 0.02177294, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.037086096}
confusion matrix:
       0   1
0  18051  98
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91150445, 'precision': 0.88225925, 'recall': 0.6385108, 'specificity': 0.6385108, 'f1': 0.68867433, 'auroc': 0.7996928, 'binary_precision': 0.85057473, 'binary_recall': 0.2835249, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.42528737}
confusion matrix:
      0    1
0  5958   39
1   561  222
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_7.png
new oracle model saved
early stop counter: 6
val acc:0.9613133072853088, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9115044474601746
after epoch: 7,now: 2024-06-19 20:24:19.212169,epoch time: 0:14:24.722889,used: 1:46:29.619623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9583262, 'precision': 0.92983454, 'recall': 0.8118764, 'specificity': 0.8118764, 'f1': 0.8591978, 'auroc': 0.94872594, 'binary_precision': 0.8969736, 'binary_recall': 0.63131654, 'binary_specificity': 0.99243623, 'binary_f1_score': 0.74105597}
confusion matrix:
       0     1
0  41987   320
1   1627  2786
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.5740831, 'recall': 0.5176343, 'specificity': 0.5176343, 'f1': 0.52406156, 'auroc': 0.65307873, 'binary_precision': 0.18120806, 'binary_recall': 0.041990668, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.06818182}
confusion matrix:
       0    1
0  18027  122
1    616   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91755164, 'precision': 0.8875339, 'recall': 0.6685785, 'specificity': 0.6685785, 'f1': 0.7232479, 'auroc': 0.8072561, 'binary_precision': 0.8544304, 'binary_recall': 0.3448276, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.4913558}
confusion matrix:
      0    1
0  5951   46
1   513  270
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_8.png
new oracle model saved
early stop counter: 7
val acc:0.9607279896736145, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9175516366958618
after epoch: 8,now: 2024-06-19 20:38:48.984031,epoch time: 0:14:29.771862,used: 2:00:59.391485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95896834, 'precision': 0.9431302, 'recall': 0.80504006, 'specificity': 0.80504006, 'f1': 0.85837007, 'auroc': 0.9510938, 'binary_precision': 0.92501706, 'binary_recall': 0.61528, 'binary_specificity': 0.99480015, 'binary_f1_score': 0.73900616}
confusion matrix:
       0     1
0  42089   220
1   1697  2714
---- Validation: 
scalar performance:
{'acc': 0.96094084, 'precision': 0.56483895, 'recall': 0.5139942, 'specificity': 0.5139942, 'f1': 0.51830643, 'auroc': 0.6474755, 'binary_precision': 0.16296296, 'binary_recall': 0.03421462, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.05655527}
confusion matrix:
       0    1
0  18036  113
1    621   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9196165, 'precision': 0.8969282, 'recall': 0.6747425, 'specificity': 0.6747425, 'f1': 0.7310713, 'auroc': 0.81546783, 'binary_precision': 0.871875, 'binary_recall': 0.35632184, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.50589305}
confusion matrix:
      0    1
0  5956   41
1   504  279
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_9.png
new oracle model saved
early stop counter: 8
val acc:0.9609408378601074, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9196165204048157
after epoch: 9,now: 2024-06-19 20:52:46.770289,epoch time: 0:13:57.786258,used: 2:14:57.177743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96292806, 'precision': 0.9325864, 'recall': 0.83890533, 'specificity': 0.83890533, 'f1': 0.8786359, 'auroc': 0.95823216, 'binary_precision': 0.89712423, 'binary_recall': 0.68601227, 'binary_specificity': 0.99179846, 'binary_f1_score': 0.7774923}
confusion matrix:
       0     1
0  41962   347
1   1385  3026
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.59671575, 'recall': 0.5300546, 'specificity': 0.5300546, 'f1': 0.54230076, 'auroc': 0.66832244, 'binary_precision': 0.22564103, 'binary_recall': 0.06842924, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.10501193}
confusion matrix:
       0    1
0  17998  151
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234513, 'precision': 0.8938452, 'recall': 0.69689727, 'specificity': 0.69689727, 'f1': 0.75324255, 'auroc': 0.8141713, 'binary_precision': 0.8606557, 'binary_recall': 0.40229884, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5483028}
confusion matrix:
      0    1
0  5946   51
1   468  315
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_10.png
new oracle model saved
early stop counter: 9
val acc:0.960089385509491, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.92345130443573
after epoch: 10,now: 2024-06-19 21:09:00.334090,epoch time: 0:16:13.563801,used: 2:31:10.741544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9630351, 'precision': 0.918733, 'recall': 0.85418797, 'specificity': 0.85418797, 'f1': 0.8830545, 'auroc': 0.9600562, 'binary_precision': 0.86617607, 'binary_recall': 0.71998185, 'binary_specificity': 0.9883941, 'binary_f1_score': 0.7863417}
confusion matrix:
       0     1
0  41815   491
1   1236  3178
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.59692305, 'recall': 0.5539097, 'specificity': 0.5539097, 'f1': 0.56795913, 'auroc': 0.7113054, 'binary_precision': 0.22443181, 'binary_recall': 0.12286159, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.15879397}
confusion matrix:
       0    1
0  17876  273
1    564   79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.929941, 'precision': 0.8701215, 'recall': 0.75386447, 'specificity': 0.75386447, 'f1': 0.7975179, 'auroc': 0.844018, 'binary_precision': 0.7996109, 'binary_recall': 0.5249042, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.6337702}
confusion matrix:
      0    1
0  5894  103
1   372  411
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_11.png
new oracle model saved
early stop counter: 10
val acc:0.9554597735404968, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9299409985542297
after epoch: 11,now: 2024-06-19 21:24:34.371264,epoch time: 0:15:34.037174,used: 2:46:44.778718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9633776, 'precision': 0.92322606, 'recall': 0.8515686, 'specificity': 0.8515686, 'f1': 0.8832216, 'auroc': 0.961429, 'binary_precision': 0.8757643, 'binary_recall': 0.7137033, 'binary_specificity': 0.9894339, 'binary_f1_score': 0.786472}
confusion matrix:
       0     1
0  41858   447
1   1264  3151
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.60220295, 'recall': 0.54954094, 'specificity': 0.54954094, 'f1': 0.5648826, 'auroc': 0.70064414, 'binary_precision': 0.23529412, 'binary_recall': 0.11197512, 'binary_specificity': 0.98710674, 'binary_f1_score': 0.15173867}
confusion matrix:
       0    1
0  17915  234
1    571   72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306785, 'precision': 0.88265175, 'recall': 0.74595344, 'specificity': 0.74595344, 'f1': 0.79467887, 'auroc': 0.83755994, 'binary_precision': 0.8267223, 'binary_recall': 0.50574714, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.6275753}
confusion matrix:
      0    1
0  5914   83
1   387  396
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_12.png
new oracle model saved
early stop counter: 11
val acc:0.957162618637085, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9306784868240356
after epoch: 12,now: 2024-06-19 21:40:05.021908,epoch time: 0:15:30.650644,used: 3:02:15.429362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9627355, 'precision': 0.9130186, 'recall': 0.85892284, 'specificity': 0.85892284, 'f1': 0.88356495, 'auroc': 0.9641342, 'binary_precision': 0.8537037, 'binary_recall': 0.73091733, 'binary_specificity': 0.9869283, 'binary_f1_score': 0.7875534}
confusion matrix:
       0     1
0  41752   553
1   1188  3227
---- Validation: 
scalar performance:
{'acc': 0.95657724, 'precision': 0.6131991, 'recall': 0.5634889, 'specificity': 0.5634889, 'f1': 0.58003056, 'auroc': 0.71882915, 'binary_precision': 0.25633803, 'binary_recall': 0.1415241, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.18236472}
confusion matrix:
       0    1
0  17885  264
1    552   91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93259585, 'precision': 0.8779768, 'recall': 0.76202756, 'specificity': 0.76202756, 'f1': 0.8059931, 'auroc': 0.8432211, 'binary_precision': 0.81346154, 'binary_recall': 0.54022986, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.64927095}
confusion matrix:
      0    1
0  5900   97
1   360  423
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_13.png
new oracle model saved
early stop counter: 12
val acc:0.9565772414207458, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9325958490371704
after epoch: 13,now: 2024-06-19 21:54:58.229207,epoch time: 0:14:53.207299,used: 3:17:08.636661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9641053, 'precision': 0.9057095, 'recall': 0.8785709, 'specificity': 0.8785709, 'f1': 0.8915387, 'auroc': 0.96562016, 'binary_precision': 0.83492297, 'binary_recall': 0.7730978, 'binary_specificity': 0.9840441, 'binary_f1_score': 0.8028219}
confusion matrix:
       0     1
0  41629   675
1   1002  3414
---- Validation: 
scalar performance:
{'acc': 0.95381016, 'precision': 0.6035107, 'recall': 0.5695569, 'specificity': 0.5695569, 'f1': 0.5825067, 'auroc': 0.71314436, 'binary_precision': 0.23653395, 'binary_recall': 0.15707621, 'binary_specificity': 0.9820376, 'binary_f1_score': 0.18878505}
confusion matrix:
       0    1
0  17823  326
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9306785, 'precision': 0.862524, 'recall': 0.767606, 'specificity': 0.767606, 'f1': 0.8053961, 'auroc': 0.84583545, 'binary_precision': 0.7809695, 'binary_recall': 0.5555556, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.6492537}
confusion matrix:
      0    1
0  5875  122
1   348  435
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_14.png
early stop counter: 13
val acc:0.9538101553916931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9325958490371704
after epoch: 14,now: 2024-06-19 22:13:09.559306,epoch time: 0:18:11.330099,used: 3:35:19.966760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9630993, 'precision': 0.8989409, 'recall': 0.8810329, 'specificity': 0.8810329, 'f1': 0.88972235, 'auroc': 0.9694135, 'binary_precision': 0.820739, 'binary_recall': 0.7798414, 'binary_specificity': 0.98222435, 'binary_f1_score': 0.7997677}
confusion matrix:
       0     1
0  41553   752
1    972  3443
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.60470885, 'recall': 0.57036203, 'specificity': 0.57036203, 'f1': 0.5834686, 'auroc': 0.72231483, 'binary_precision': 0.23887588, 'binary_recall': 0.15863141, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.19065419}
confusion matrix:
       0    1
0  17824  325
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9284661, 'precision': 0.8510791, 'recall': 0.768021, 'specificity': 0.768021, 'f1': 0.80194354, 'auroc': 0.8494541, 'binary_precision': 0.75778544, 'binary_recall': 0.55938697, 'binary_specificity': 0.976655, 'binary_f1_score': 0.6436444}
confusion matrix:
      0    1
0  5857  140
1   345  438
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_15.png
early stop counter: 14
val acc:0.9539165496826172, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.9325958490371704
after epoch: 15,now: 2024-06-19 22:30:33.063817,epoch time: 0:17:23.504511,used: 3:52:43.471271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96436214, 'precision': 0.9047707, 'recall': 0.8816807, 'specificity': 0.8816807, 'f1': 0.8927909, 'auroc': 0.9697423, 'binary_precision': 0.83236575, 'binary_recall': 0.77974164, 'binary_specificity': 0.98361975, 'binary_f1_score': 0.80519485}
confusion matrix:
       0     1
0  41614   693
1    972  3441
---- Validation: 
scalar performance:
{'acc': 0.9535441, 'precision': 0.6076927, 'recall': 0.57616967, 'specificity': 0.57616967, 'f1': 0.5886786, 'auroc': 0.72477716, 'binary_precision': 0.24444444, 'binary_recall': 0.1710731, 'binary_specificity': 0.9812662, 'binary_f1_score': 0.20128088}
confusion matrix:
       0    1
0  17809  340
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9337758, 'precision': 0.86810124, 'recall': 0.781016, 'specificity': 0.781016, 'f1': 0.81664455, 'auroc': 0.8497287, 'binary_precision': 0.7889273, 'binary_recall': 0.58237547, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.67009544}
confusion matrix:
      0    1
0  5875  122
1   327  456
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21510957_16.png
new oracle model saved
early stop counter: 15
val acc:0.9535440802574158, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.884513258934021 / 0.933775782585144
after epoch: 16,now: 2024-06-19 22:51:10.717899,epoch time: 0:20:37.654082,used: 4:13:21.125353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_18_37_49_seed_0_21510957
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21510957 ON supergpu02 CANCELLED AT 2024-06-19T22:52:11 ***
