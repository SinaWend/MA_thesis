Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 03:05:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444

 Experiment start at: 2024-06-18 03:17:28.979921
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7360437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7009655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7261205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 03:40:43.085368,epoch time: 0:23:14.105447,used: 0:23:14.105447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.83327246, 'recall': 0.5023423, 'specificity': 0.5023423, 'f1': 0.49620014, 'auroc': 0.8596922, 'binary_precision': 0.7, 'binary_recall': 0.0047554346, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.009446694}
confusion matrix:
       0  1
0  42325  3
1   1465  7
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8456229, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.83987665, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:03:06.074654,epoch time: 0:22:22.989286,used: 0:45:37.094733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.966484, 'precision': 0.73826236, 'recall': 0.5472593, 'specificity': 0.5472593, 'f1': 0.57345414, 'auroc': 0.88806856, 'binary_precision': 0.5070422, 'binary_recall': 0.097826086, 'binary_specificity': 0.9966925, 'binary_f1_score': 0.16400912}
confusion matrix:
       0    1
0  42188  140
1   1328  144
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.77096844, 'recall': 0.5174166, 'specificity': 0.5174166, 'f1': 0.5250438, 'auroc': 0.88934815, 'binary_precision': 0.575, 'binary_recall': 0.035769828, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.067349926}
confusion matrix:
       0   1
0  18132  17
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9803749, 'recall': 0.53065133, 'specificity': 0.53065133, 'f1': 0.54775274, 'auroc': 0.87300307, 'binary_precision': 1.0, 'binary_recall': 0.06130268, 'binary_specificity': 1.0, 'binary_f1_score': 0.115523465}
confusion matrix:
      0   1
0  5997   0
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 04:23:47.812998,epoch time: 0:20:41.738344,used: 1:06:18.833077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96696347, 'precision': 0.74807465, 'recall': 0.5904572, 'specificity': 0.5904572, 'f1': 0.62925476, 'auroc': 0.90566313, 'binary_precision': 0.52380955, 'binary_recall': 0.18682066, 'binary_specificity': 0.9940937, 'binary_f1_score': 0.27541313}
confusion matrix:
       0    1
0  42078  250
1   1197  275
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.77220446, 'recall': 0.5431664, 'specificity': 0.5431664, 'f1': 0.56829655, 'auroc': 0.899237, 'binary_precision': 0.57575756, 'binary_recall': 0.08864697, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.15363882}
confusion matrix:
       0   1
0  18107  42
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.8775109, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 04:45:52.174304,epoch time: 0:22:04.361306,used: 1:28:23.194383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7489387, 'recall': 0.63263476, 'specificity': 0.63263476, 'f1': 0.67133856, 'auroc': 0.9117389, 'binary_precision': 0.5226978, 'binary_recall': 0.2739633, 'binary_specificity': 0.9913062, 'binary_f1_score': 0.35950044}
confusion matrix:
       0    1
0  41961  368
1   1068  403
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7672955, 'recall': 0.562778, 'specificity': 0.562778, 'f1': 0.5965836, 'auroc': 0.907351, 'binary_precision': 0.56462586, 'binary_recall': 0.12908243, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.21012658}
confusion matrix:
       0   1
0  18085  64
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.88197935, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-18 05:08:57.624446,epoch time: 0:23:05.450142,used: 1:51:28.644525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9675799, 'precision': 0.7567624, 'recall': 0.61733294, 'specificity': 0.61733294, 'f1': 0.6586722, 'auroc': 0.9139352, 'binary_precision': 0.53939396, 'binary_recall': 0.24184783, 'binary_specificity': 0.992818, 'binary_f1_score': 0.33395875}
confusion matrix:
       0    1
0  42024  304
1   1116  356
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7718495, 'recall': 0.5711664, 'specificity': 0.5711664, 'f1': 0.6080652, 'auroc': 0.9133128, 'binary_precision': 0.5731707, 'binary_recall': 0.14618973, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.23296157}
confusion matrix:
       0   1
0  18079  70
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9830836, 'recall': 0.59770113, 'specificity': 0.59770113, 'f1': 0.65485775, 'auroc': 0.88552433, 'binary_precision': 1.0, 'binary_recall': 0.1954023, 'binary_specificity': 1.0, 'binary_f1_score': 0.32692307}
confusion matrix:
      0   1
0  5997   0
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-18 05:29:50.385958,epoch time: 0:20:52.761512,used: 2:12:21.406037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9668265, 'precision': 0.7434981, 'recall': 0.64481133, 'specificity': 0.64481133, 'f1': 0.6803446, 'auroc': 0.9220425, 'binary_precision': 0.5110081, 'binary_recall': 0.2995924, 'binary_specificity': 0.9900302, 'binary_f1_score': 0.3777302}
confusion matrix:
       0    1
0  41906  422
1   1031  441
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7597261, 'recall': 0.5815294, 'specificity': 0.5815294, 'f1': 0.62008023, 'auroc': 0.9178723, 'binary_precision': 0.5482234, 'binary_recall': 0.16796267, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.25714284}
confusion matrix:
       0    1
0  18060   89
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.98347306, 'recall': 0.6072797, 'specificity': 0.6072797, 'f1': 0.6682538, 'auroc': 0.8866376, 'binary_precision': 1.0, 'binary_recall': 0.21455939, 'binary_specificity': 1.0, 'binary_f1_score': 0.35331228}
confusion matrix:
      0   1
0  5997   0
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_7.png
new oracle model saved
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9664429426193237 / 0.9672419428825378
after epoch: 7,now: 2024-06-18 05:51:03.937429,epoch time: 0:21:13.551471,used: 2:33:34.957508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.7516097, 'recall': 0.6290178, 'specificity': 0.6290178, 'f1': 0.6686814, 'auroc': 0.92011034, 'binary_precision': 0.5283019, 'binary_recall': 0.26630434, 'binary_specificity': 0.9917312, 'binary_f1_score': 0.3541102}
confusion matrix:
       0    1
0  41978  350
1   1080  392
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77857447, 'recall': 0.57733214, 'specificity': 0.57733214, 'f1': 0.6165107, 'auroc': 0.9215688, 'binary_precision': 0.5862069, 'binary_recall': 0.15863141, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.24969399}
confusion matrix:
       0    1
0  18077   72
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.98277247, 'recall': 0.5900383, 'specificity': 0.5900383, 'f1': 0.6438327, 'auroc': 0.8916067, 'binary_precision': 1.0, 'binary_recall': 0.18007663, 'binary_specificity': 1.0, 'binary_f1_score': 0.30519482}
confusion matrix:
      0   1
0  5997   0
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_8.png
better model found
persisted
after epoch: 8,now: 2024-06-18 06:14:36.448636,epoch time: 0:23:32.511207,used: 2:57:07.468715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9677169, 'precision': 0.76522404, 'recall': 0.59215844, 'specificity': 0.59215844, 'f1': 0.63322407, 'auroc': 0.9237609, 'binary_precision': 0.558, 'binary_recall': 0.18953805, 'binary_specificity': 0.9947789, 'binary_f1_score': 0.28296146}
confusion matrix:
       0    1
0  42107  221
1   1193  279
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7825322, 'recall': 0.5470544, 'specificity': 0.5470544, 'f1': 0.57454246, 'auroc': 0.92144406, 'binary_precision': 0.59615386, 'binary_recall': 0.096423015, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.16599731}
confusion matrix:
       0   1
0  18107  42
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.88878363, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_9.png
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9658037424087524 / 0.9672419428825378
after epoch: 9,now: 2024-06-18 06:38:16.086610,epoch time: 0:23:39.637974,used: 3:20:47.106689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96819633, 'precision': 0.7661186, 'recall': 0.6265041, 'specificity': 0.6265041, 'f1': 0.6692451, 'auroc': 0.92691714, 'binary_precision': 0.55749637, 'binary_recall': 0.26019022, 'binary_specificity': 0.992818, 'binary_f1_score': 0.3547939}
confusion matrix:
       0    1
0  42024  304
1   1089  383
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7791027, 'recall': 0.58188754, 'specificity': 0.58188754, 'f1': 0.6222812, 'auroc': 0.9270305, 'binary_precision': 0.5869565, 'binary_recall': 0.16796267, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.261185}
confusion matrix:
       0    1
0  18073   76
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.98269475, 'recall': 0.5881226, 'specificity': 0.5881226, 'f1': 0.64103216, 'auroc': 0.89287746, 'binary_precision': 1.0, 'binary_recall': 0.17624521, 'binary_specificity': 1.0, 'binary_f1_score': 0.29967427}
confusion matrix:
      0   1
0  5997   0
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 06:58:17.475042,epoch time: 0:20:01.388432,used: 3:40:48.495121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96872145, 'precision': 0.7682282, 'recall': 0.65825045, 'specificity': 0.65825045, 'f1': 0.6977229, 'auroc': 0.9284283, 'binary_precision': 0.55957943, 'binary_recall': 0.3254076, 'binary_specificity': 0.99109334, 'binary_f1_score': 0.41151205}
confusion matrix:
       0    1
0  41951  377
1    993  479
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7852022, 'recall': 0.6070251, 'specificity': 0.6070251, 'f1': 0.6522772, 'auroc': 0.929878, 'binary_precision': 0.59745765, 'binary_recall': 0.21928461, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.3208191}
confusion matrix:
       0    1
0  18054   95
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.98292804, 'recall': 0.59386975, 'specificity': 0.59386975, 'f1': 0.6493802, 'auroc': 0.89490277, 'binary_precision': 1.0, 'binary_recall': 0.18773946, 'binary_specificity': 1.0, 'binary_f1_score': 0.31612903}
confusion matrix:
      0   1
0  5997   0
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_11.png
better model found
persisted
after epoch: 11,now: 2024-06-18 07:21:04.321217,epoch time: 0:22:46.846175,used: 4:03:35.341296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9692694, 'precision': 0.7743673, 'recall': 0.6670584, 'specificity': 0.6670584, 'f1': 0.70645136, 'auroc': 0.9306005, 'binary_precision': 0.57126695, 'binary_recall': 0.34307066, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.4286927}
confusion matrix:
       0    1
0  41949  379
1    967  505
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.77955425, 'recall': 0.608415, 'specificity': 0.608415, 'f1': 0.65302896, 'auroc': 0.931906, 'binary_precision': 0.5860656, 'binary_recall': 0.22239502, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.3224352}
confusion matrix:
       0    1
0  18048  101
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.8972758, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_12.png
early stop counter: 1
val acc:0.9680182933807373, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 12,now: 2024-06-18 07:44:26.197976,epoch time: 0:23:21.876759,used: 4:26:57.218055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9676484, 'precision': 0.7549945, 'recall': 0.6413022, 'specificity': 0.6413022, 'f1': 0.68026793, 'auroc': 0.9321162, 'binary_precision': 0.53424656, 'binary_recall': 0.29144022, 'binary_specificity': 0.99116427, 'binary_f1_score': 0.37714285}
confusion matrix:
       0    1
0  41954  374
1   1043  429
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7757011, 'recall': 0.60302687, 'specificity': 0.60302687, 'f1': 0.64664274, 'auroc': 0.93509835, 'binary_precision': 0.57872343, 'binary_recall': 0.21150856, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.309795}
confusion matrix:
       0    1
0  18050   99
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.97039896, 'recall': 0.5784607, 'specificity': 0.5784607, 'f1': 0.62626576, 'auroc': 0.89817756, 'binary_precision': 0.97619045, 'binary_recall': 0.15708812, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27062705}
confusion matrix:
      0   1
0  5996   1
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_13.png
early stop counter: 2
val acc:0.96775221824646, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 13,now: 2024-06-18 08:03:37.356178,epoch time: 0:19:11.158202,used: 4:46:08.376257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9687671, 'precision': 0.783092, 'recall': 0.61040634, 'specificity': 0.61040634, 'f1': 0.655723, 'auroc': 0.93076766, 'binary_precision': 0.5925267, 'binary_recall': 0.22622283, 'binary_specificity': 0.99458987, 'binary_f1_score': 0.32743362}
confusion matrix:
       0    1
0  42099  229
1   1139  333
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.78493863, 'recall': 0.56149834, 'specificity': 0.56149834, 'f1': 0.5957449, 'auroc': 0.9335089, 'binary_precision': 0.6, 'binary_recall': 0.125972, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.2082262}
confusion matrix:
       0   1
0  18095  54
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.8950714, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_14.png
early stop counter: 3
val acc:0.9672200679779053, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 14,now: 2024-06-18 08:26:37.192997,epoch time: 0:22:59.836819,used: 5:09:08.213076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.968516, 'precision': 0.76927686, 'recall': 0.6356047, 'specificity': 0.6356047, 'f1': 0.6783747, 'auroc': 0.9345069, 'binary_precision': 0.5631868, 'binary_recall': 0.27872196, 'binary_specificity': 0.99248743, 'binary_f1_score': 0.37289673}
confusion matrix:
       0    1
0  42011  318
1   1061  410
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7838132, 'recall': 0.5971366, 'specificity': 0.5971366, 'f1': 0.64098835, 'auroc': 0.93664634, 'binary_precision': 0.59534883, 'binary_recall': 0.19906688, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.2983683}
confusion matrix:
       0    1
0  18062   87
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.96883565, 'recall': 0.57079786, 'specificity': 0.57079786, 'f1': 0.61453736, 'auroc': 0.8989787, 'binary_precision': 0.9736842, 'binary_recall': 0.14176245, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24749163}
confusion matrix:
      0   1
0  5996   1
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_15.png
early stop counter: 4
val acc:0.9679650664329529, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 15,now: 2024-06-18 08:49:43.604229,epoch time: 0:23:06.411232,used: 5:32:14.624308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.7878677, 'recall': 0.6565933, 'specificity': 0.6565933, 'f1': 0.7011392, 'auroc': 0.9357935, 'binary_precision': 0.5989848, 'binary_recall': 0.3206522, 'binary_specificity': 0.9925345, 'binary_f1_score': 0.41769913}
confusion matrix:
       0    1
0  42012  316
1   1000  472
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.7865441, 'recall': 0.594914, 'specificity': 0.594914, 'f1': 0.6387054, 'auroc': 0.9366085, 'binary_precision': 0.60096157, 'binary_recall': 0.19440125, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.29377204}
confusion matrix:
       0    1
0  18066   83
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8965466, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_16.png
early stop counter: 5
val acc:0.9680182933807373, best validation acc: 0.9682311415672302, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 16,now: 2024-06-18 09:12:09.980303,epoch time: 0:22:26.376074,used: 5:54:41.000382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9695434, 'precision': 0.778381, 'recall': 0.66687226, 'specificity': 0.66687226, 'f1': 0.70737743, 'auroc': 0.93386745, 'binary_precision': 0.57931036, 'binary_recall': 0.3423913, 'binary_specificity': 0.9913532, 'binary_f1_score': 0.43040138}
confusion matrix:
       0    1
0  41962  366
1    968  504
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.7872889, 'recall': 0.60555255, 'specificity': 0.60555255, 'f1': 0.6509212, 'auroc': 0.9384514, 'binary_precision': 0.6017316, 'binary_recall': 0.21617419, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.3180778}
confusion matrix:
       0    1
0  18057   92
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.98207396, 'recall': 0.57279694, 'specificity': 0.57279694, 'f1': 0.6179637, 'auroc': 0.896388, 'binary_precision': 1.0, 'binary_recall': 0.14559387, 'binary_specificity': 1.0, 'binary_f1_score': 0.25418058}
confusion matrix:
      0   1
0  5997   0
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 09:37:47.237186,epoch time: 0:25:37.256883,used: 6:20:18.257265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9702968, 'precision': 0.7874049, 'recall': 0.6748029, 'specificity': 0.6748029, 'f1': 0.71614826, 'auroc': 0.9339833, 'binary_precision': 0.596829, 'binary_recall': 0.3580163, 'binary_specificity': 0.9915895, 'binary_f1_score': 0.4475584}
confusion matrix:
       0    1
0  41972  356
1    945  527
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7934698, 'recall': 0.6064403, 'specificity': 0.6064403, 'f1': 0.6526859, 'auroc': 0.9404124, 'binary_precision': 0.61403507, 'binary_recall': 0.21772939, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.32146958}
confusion matrix:
       0    1
0  18061   88
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8976463, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_18.png
better model found
persisted
after epoch: 18,now: 2024-06-18 10:01:41.413808,epoch time: 0:23:54.176622,used: 6:44:12.433887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9703881, 'precision': 0.78340185, 'recall': 0.6936614, 'specificity': 0.6936614, 'f1': 0.72929955, 'auroc': 0.9391059, 'binary_precision': 0.5875251, 'binary_recall': 0.39700884, 'binary_specificity': 0.99031395, 'binary_f1_score': 0.47383368}
confusion matrix:
       0    1
0  41919  410
1    887  584
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.7907959, 'recall': 0.6291624, 'specificity': 0.6291624, 'f1': 0.6762308, 'auroc': 0.9416698, 'binary_precision': 0.60714287, 'binary_recall': 0.2643857, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.36836407}
confusion matrix:
       0    1
0  18039  110
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.8953608, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_19.png
better model found
persisted
after epoch: 19,now: 2024-06-18 10:23:43.702242,epoch time: 0:22:02.288434,used: 7:06:14.722321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96990865, 'precision': 0.78791064, 'recall': 0.6542747, 'specificity': 0.6542747, 'f1': 0.6991295, 'auroc': 0.93733597, 'binary_precision': 0.59922683, 'binary_recall': 0.31589675, 'binary_specificity': 0.9926526, 'binary_f1_score': 0.41370106}
confusion matrix:
       0    1
0  42017  311
1   1007  465
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.7942034, 'recall': 0.5904963, 'specificity': 0.5904963, 'f1': 0.63420796, 'auroc': 0.94102323, 'binary_precision': 0.6165803, 'binary_recall': 0.18506998, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.284689}
confusion matrix:
       0    1
0  18075   74
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.893386, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_20.png
early stop counter: 1
val acc:0.9681779742240906, best validation acc: 0.9689761400222778, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 20,now: 2024-06-18 10:44:52.250481,epoch time: 0:21:08.548239,used: 7:27:23.270560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.7712105, 'recall': 0.7039088, 'specificity': 0.7039088, 'f1': 0.7323212, 'auroc': 0.9386027, 'binary_precision': 0.562443, 'binary_recall': 0.4191576, 'binary_specificity': 0.98866, 'binary_f1_score': 0.48034254}
confusion matrix:
       0    1
0  41848  480
1    855  617
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.79445434, 'recall': 0.65052205, 'specificity': 0.65052205, 'f1': 0.6971859, 'auroc': 0.9436875, 'binary_precision': 0.6130031, 'binary_recall': 0.30793157, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.4099379}
confusion matrix:
       0    1
0  18024  125
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9731991, 'recall': 0.59570205, 'specificity': 0.59570205, 'f1': 0.6515707, 'auroc': 0.8988801, 'binary_precision': 0.98039216, 'binary_recall': 0.19157088, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32051283}
confusion matrix:
      0   1
0  5996   1
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_21.png
better model found
persisted
after epoch: 21,now: 2024-06-18 11:07:30.243003,epoch time: 0:22:37.992522,used: 7:50:01.263082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9695434, 'precision': 0.7786244, 'recall': 0.6646803, 'specificity': 0.6646803, 'f1': 0.70566595, 'auroc': 0.9380617, 'binary_precision': 0.57993, 'binary_recall': 0.3378654, 'binary_specificity': 0.9914952, 'binary_f1_score': 0.42697597}
confusion matrix:
       0    1
0  41969  360
1    974  497
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.79973006, 'recall': 0.6293828, 'specificity': 0.6293828, 'f1': 0.67795193, 'auroc': 0.94267416, 'binary_precision': 0.625, 'binary_recall': 0.2643857, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.3715847}
confusion matrix:
       0    1
0  18047  102
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.89907295, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_22.png
early stop counter: 1
val acc:0.9694018959999084, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 22,now: 2024-06-18 11:32:25.707798,epoch time: 0:24:55.464795,used: 8:14:56.727877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9709589, 'precision': 0.7961979, 'recall': 0.67875195, 'specificity': 0.67875195, 'f1': 0.7216709, 'auroc': 0.9418621, 'binary_precision': 0.61415523, 'binary_recall': 0.36548913, 'binary_specificity': 0.99201477, 'binary_f1_score': 0.45826232}
confusion matrix:
       0    1
0  41990  338
1    934  538
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.80178624, 'recall': 0.6279102, 'specificity': 0.6279102, 'f1': 0.6767897, 'auroc': 0.94269717, 'binary_precision': 0.6292135, 'binary_recall': 0.26127526, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.36923078}
confusion matrix:
       0    1
0  18050   99
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.89710677, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_23.png
early stop counter: 2
val acc:0.9694550633430481, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 23,now: 2024-06-18 11:58:24.025742,epoch time: 0:25:58.317944,used: 8:40:55.045821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9712557, 'precision': 0.7918905, 'recall': 0.70579016, 'specificity': 0.70579016, 'f1': 0.74070215, 'auroc': 0.9412317, 'binary_precision': 0.6037001, 'binary_recall': 0.42119566, 'binary_specificity': 0.99038464, 'binary_f1_score': 0.49619848}
confusion matrix:
       0    1
0  41921  407
1    852  620
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.794572, 'recall': 0.6414112, 'specificity': 0.6414112, 'f1': 0.68878394, 'auroc': 0.9445976, 'binary_precision': 0.6138614, 'binary_recall': 0.28926906, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.3932347}
confusion matrix:
       0    1
0  18032  117
1    457  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8987064, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_24.png
early stop counter: 3
val acc:0.9694550633430481, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 24,now: 2024-06-18 12:22:55.397351,epoch time: 0:24:31.371609,used: 9:05:26.417430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97111875, 'precision': 0.79249984, 'recall': 0.6971949, 'specificity': 0.6971949, 'f1': 0.73472416, 'auroc': 0.9446099, 'binary_precision': 0.6055046, 'binary_recall': 0.4035326, 'binary_specificity': 0.9908571, 'binary_f1_score': 0.48430493}
confusion matrix:
       0    1
0  41941  387
1    878  594
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.80028355, 'recall': 0.63243806, 'specificity': 0.63243806, 'f1': 0.6811107, 'auroc': 0.94558406, 'binary_precision': 0.62589926, 'binary_recall': 0.27060652, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.37785015}
confusion matrix:
       0    1
0  18045  104
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8983012, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_25.png
early stop counter: 4
val acc:0.9695082902908325, best validation acc: 0.9696679711341858, corresponding to test acc:                         0.9661233425140381 / 0.9672419428825378
after epoch: 25,now: 2024-06-18 12:44:50.173729,epoch time: 0:21:54.776378,used: 9:27:21.193808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9702968, 'precision': 0.7823566, 'recall': 0.69414675, 'specificity': 0.69414675, 'f1': 0.72931767, 'auroc': 0.94323564, 'binary_precision': 0.5854146, 'binary_recall': 0.3980978, 'binary_specificity': 0.99019563, 'binary_f1_score': 0.47391832}
confusion matrix:
       0    1
0  41913  415
1    886  586
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.8032807, 'recall': 0.63707614, 'specificity': 0.63707614, 'f1': 0.6862178, 'auroc': 0.94451654, 'binary_precision': 0.6315789, 'binary_recall': 0.2799378, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.38793105}
confusion matrix:
       0    1
0  18044  105
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.982229, 'recall': 0.5766283, 'specificity': 0.5766283, 'f1': 0.62384415, 'auroc': 0.8997787, 'binary_precision': 1.0, 'binary_recall': 0.1532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.26578075}
confusion matrix:
      0   1
0  5997   0
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_26.png
better model found
persisted
after epoch: 26,now: 2024-06-18 13:08:46.610158,epoch time: 0:23:56.436429,used: 9:51:17.630237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96958905, 'precision': 0.7731811, 'recall': 0.69607556, 'specificity': 0.69607556, 'f1': 0.72767663, 'auroc': 0.9415643, 'binary_precision': 0.5669216, 'binary_recall': 0.40285325, 'binary_specificity': 0.98929787, 'binary_f1_score': 0.47100872}
confusion matrix:
       0    1
0  41875  453
1    879  593
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.80636114, 'recall': 0.62649274, 'specificity': 0.62649274, 'f1': 0.6760484, 'auroc': 0.94500464, 'binary_precision': 0.63846153, 'binary_recall': 0.25816485, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.36766335}
confusion matrix:
       0    1
0  18055   94
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8937984, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_27.png
early stop counter: 1
val acc:0.9696147441864014, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9646852016448975 / 0.9672419428825378
after epoch: 27,now: 2024-06-18 13:32:04.235674,epoch time: 0:23:17.625516,used: 10:14:35.255753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96949774, 'precision': 0.7772536, 'recall': 0.66881585, 'specificity': 0.66881585, 'f1': 0.7086323, 'auroc': 0.9423499, 'binary_precision': 0.5769231, 'binary_recall': 0.3464674, 'binary_specificity': 0.99116427, 'binary_f1_score': 0.43293718}
confusion matrix:
       0    1
0  41954  374
1    962  510
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8008839, 'recall': 0.6294103, 'specificity': 0.6294103, 'f1': 0.6781691, 'auroc': 0.94579756, 'binary_precision': 0.6273063, 'binary_recall': 0.2643857, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.37199128}
confusion matrix:
       0    1
0  18048  101
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.8975477, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_28.png
early stop counter: 2
val acc:0.9694550633430481, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9646852016448975 / 0.9672419428825378
after epoch: 28,now: 2024-06-18 13:55:18.712346,epoch time: 0:23:14.476672,used: 10:37:49.732425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.970137, 'precision': 0.78731084, 'recall': 0.6671794, 'specificity': 0.6671794, 'f1': 0.70994806, 'auroc': 0.9428562, 'binary_precision': 0.5971564, 'binary_recall': 0.3423913, 'binary_specificity': 0.9919675, 'binary_f1_score': 0.43523318}
confusion matrix:
       0    1
0  41988  340
1    968  504
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.82380396, 'recall': 0.6123519, 'specificity': 0.6123519, 'f1': 0.6630118, 'auroc': 0.9459487, 'binary_precision': 0.67431194, 'binary_recall': 0.22861587, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.34146342}
confusion matrix:
       0    1
0  18078   71
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.8956051, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_29.png
better model found
persisted
after epoch: 29,now: 2024-06-18 14:21:22.416746,epoch time: 0:26:03.704400,used: 11:03:53.436825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.78166294, 'recall': 0.7162788, 'specificity': 0.7162788, 'f1': 0.7442619, 'auroc': 0.9453206, 'binary_precision': 0.5825156, 'binary_recall': 0.44361413, 'binary_specificity': 0.9889435, 'binary_f1_score': 0.5036637}
confusion matrix:
       0    1
0  41860  468
1    819  653
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.79719305, 'recall': 0.6445216, 'specificity': 0.6445216, 'f1': 0.69222033, 'auroc': 0.94743717, 'binary_precision': 0.6188925, 'binary_recall': 0.29548988, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  18032  117
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8971031, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395444_30.png
early stop counter: 1
val acc:0.9696679711341858, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9611697196960449 / 0.9672419428825378
after epoch: 30,now: 2024-06-18 14:45:57.717348,epoch time: 0:24:35.300602,used: 11:28:28.737427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_28_seed_0_21395444
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:28.737427 at 2024-06-18 14:45:57.717348
persisted model performance metric: 

scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.8956051, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.98347306, 'recall': 0.6072797, 'specificity': 0.6072797, 'f1': 0.6682538, 'auroc': 0.8866376, 'binary_precision': 1.0, 'binary_recall': 0.21455939, 'binary_specificity': 1.0, 'binary_f1_score': 0.35331228}
confusion matrix:
      0   1
0  5997   0
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13821 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13821 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5448 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13821 K  |   13821 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13821 K  |   13821 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 18 14:47:00 2024]
Finished job 0.
1 of 1 steps (100%) done
