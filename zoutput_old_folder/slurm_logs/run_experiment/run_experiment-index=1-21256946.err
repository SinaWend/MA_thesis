Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:25:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946

 Experiment start at: 2024-06-08 12:32:49.098039
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96912676, 'precision': 0.7771157, 'recall': 0.6469872, 'specificity': 0.6469872, 'f1': 0.6902934, 'auroc': 0.9561251, 'binary_precision': 0.578125, 'binary_recall': 0.30163044, 'binary_specificity': 0.992344, 'binary_f1_score': 0.39642856}
confusion matrix:
       0    1
0  41996  324
1   1028  444
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.80685234, 'recall': 0.5579409, 'specificity': 0.5579409, 'f1': 0.59159935, 'auroc': 0.95383465, 'binary_precision': 0.6440678, 'binary_recall': 0.11819596, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.19973719}
confusion matrix:
       0   1
0  18107  42
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.9408906, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 13:01:44.807593,epoch time: 0:28:55.709554,used: 0:28:55.709554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9720954, 'precision': 0.7970478, 'recall': 0.7233776, 'specificity': 0.7233776, 'f1': 0.7545139, 'auroc': 0.9655338, 'binary_precision': 0.6127854, 'binary_recall': 0.4567733, 'binary_specificity': 0.98998183, 'binary_f1_score': 0.5234009}
confusion matrix:
       0    1
0  41899  424
1    798  671
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7496699, 'recall': 0.7675982, 'specificity': 0.7675982, 'f1': 0.75828725, 'auroc': 0.9638679, 'binary_precision': 0.51519537, 'binary_recall': 0.55365473, 'binary_specificity': 0.9815417, 'binary_f1_score': 0.5337331}
confusion matrix:
       0    1
0  17814  335
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.95839787, 'recall': 0.63759756, 'specificity': 0.63759756, 'f1': 0.7057264, 'auroc': 0.95295966, 'binary_precision': 0.94736844, 'binary_recall': 0.27586207, 'binary_specificity': 0.999333, 'binary_f1_score': 0.42729974}
confusion matrix:
      0   1
0  5993   4
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_2.png
new oracle model saved
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9616490602493286 / 0.9691594839096069
after epoch: 2,now: 2024-06-08 13:29:30.654995,epoch time: 0:27:45.847402,used: 0:56:41.556956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.92091143, 'recall': 0.56623346, 'specificity': 0.56623346, 'f1': 0.60790074, 'auroc': 0.96256614, 'binary_precision': 0.8711111, 'binary_recall': 0.13315217, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.23099586}
confusion matrix:
       0    1
0  42291   29
1   1276  196
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.9464148, 'recall': 0.5379924, 'specificity': 0.5379924, 'f1': 0.5622967, 'auroc': 0.9663081, 'binary_precision': 0.9245283, 'binary_recall': 0.07620529, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.1408046}
confusion matrix:
       0   1
0  18145   4
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.93517673, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_3.png
better model found
persisted
after epoch: 3,now: 2024-06-08 13:57:33.636469,epoch time: 0:28:02.981474,used: 1:24:44.538430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.969652, 'precision': 0.9439913, 'recall': 0.5531634, 'specificity': 0.5531634, 'f1': 0.5878248, 'auroc': 0.9640951, 'binary_precision': 0.91812867, 'binary_recall': 0.10665761, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.19111383}
confusion matrix:
       0    1
0  42306   14
1   1315  157
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.9257263, 'recall': 0.52941126, 'specificity': 0.52941126, 'f1': 0.54712754, 'auroc': 0.9669138, 'binary_precision': 0.88372093, 'binary_recall': 0.05909798, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.110787176}
confusion matrix:
       0   1
0  18144   5
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.9461139, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_4.png
early stop counter: 1
val acc:0.967539370059967, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9616490602493286 / 0.9691594839096069
after epoch: 4,now: 2024-06-08 14:25:21.206338,epoch time: 0:27:47.569869,used: 1:52:32.108299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97510964, 'precision': 0.8013309, 'recall': 0.84417534, 'specificity': 0.84417534, 'f1': 0.8211851, 'auroc': 0.9723975, 'binary_precision': 0.61301774, 'binary_recall': 0.7038044, 'binary_specificity': 0.9845463, 'binary_f1_score': 0.6552815}
confusion matrix:
       0     1
0  41666   654
1    436  1036
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.7961854, 'recall': 0.8099346, 'specificity': 0.8099346, 'f1': 0.80288786, 'auroc': 0.9714314, 'binary_precision': 0.60534126, 'binary_recall': 0.63452566, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.6195899}
confusion matrix:
       0    1
0  17883  266
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.94760644, 'recall': 0.76711535, 'specificity': 0.76711535, 'f1': 0.832628, 'auroc': 0.9494369, 'binary_precision': 0.9150327, 'binary_recall': 0.5363985, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.67632854}
confusion matrix:
      0    1
0  5984   13
1   121  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-08 14:53:17.872168,epoch time: 0:27:56.665830,used: 2:20:28.774129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9706796, 'precision': 0.7683004, 'recall': 0.88253784, 'specificity': 0.88253784, 'f1': 0.8142199, 'auroc': 0.96978563, 'binary_precision': 0.54409003, 'binary_recall': 0.7880435, 'binary_specificity': 0.9770321, 'binary_f1_score': 0.64372915}
confusion matrix:
       0     1
0  41348   972
1    312  1160
---- Validation: 
scalar performance:
{'acc': 0.9757876, 'precision': 0.8078446, 'recall': 0.8569553, 'specificity': 0.8569553, 'f1': 0.83039737, 'auroc': 0.96925217, 'binary_precision': 0.6253333, 'binary_recall': 0.7293935, 'binary_specificity': 0.98451704, 'binary_f1_score': 0.67336684}
confusion matrix:
       0    1
0  17868  281
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7382223, 'recall': 0.64125645, 'specificity': 0.64125645, 'f1': 0.67574084, 'auroc': 0.9415228, 'binary_precision': 0.5065789, 'binary_recall': 0.29501915, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.37288135}
confusion matrix:
      0   1
0  5922  75
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_6.png
better model found
persisted
after epoch: 6,now: 2024-06-08 15:24:30.528064,epoch time: 0:31:12.655896,used: 2:51:41.430025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97739315, 'precision': 0.8145503, 'recall': 0.87076473, 'specificity': 0.87076473, 'f1': 0.84011924, 'auroc': 0.9762596, 'binary_precision': 0.63761467, 'binary_recall': 0.7564626, 'binary_specificity': 0.9850669, 'binary_f1_score': 0.69197255}
confusion matrix:
       0     1
0  41690   632
1    358  1112
---- Validation: 
scalar performance:
{'acc': 0.97988504, 'precision': 0.8396039, 'recall': 0.8710775, 'specificity': 0.8710775, 'f1': 0.85457647, 'auroc': 0.9761127, 'binary_precision': 0.6879433, 'binary_recall': 0.7542768, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.7195846}
confusion matrix:
       0    1
0  17929  220
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7953117, 'recall': 0.64917135, 'specificity': 0.64917135, 'f1': 0.69564444, 'auroc': 0.95611745, 'binary_precision': 0.62015504, 'binary_recall': 0.3065134, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.41025642}
confusion matrix:
      0   1
0  5948  49
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_7.png
better model found
persisted
after epoch: 7,now: 2024-06-08 15:53:17.984470,epoch time: 0:28:47.456406,used: 3:20:28.886431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98241687, 'precision': 0.8974881, 'recall': 0.81025225, 'specificity': 0.81025225, 'f1': 0.84807247, 'auroc': 0.98191595, 'binary_precision': 0.80789477, 'binary_recall': 0.6256794, 'binary_specificity': 0.9948251, 'binary_f1_score': 0.70520675}
confusion matrix:
       0    1
0  42101  219
1    551  921
---- Validation: 
scalar performance:
{'acc': 0.9798318, 'precision': 0.9081594, 'recall': 0.7547914, 'specificity': 0.7547914, 'f1': 0.8124277, 'auroc': 0.9778957, 'binary_precision': 0.8333333, 'binary_recall': 0.5132193, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.6352262}
confusion matrix:
       0    1
0  18083   66
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.86130583, 'recall': 0.67557627, 'specificity': 0.67557627, 'f1': 0.73335636, 'auroc': 0.9548689, 'binary_precision': 0.75, 'binary_recall': 0.35632184, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.48311692}
confusion matrix:
      0   1
0  5966  31
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_8.png
early stop counter: 1
val acc:0.9798318147659302, best validation acc: 0.9798850417137146, corresponding to test acc:                         0.9632470607757568 / 0.9785873889923096
after epoch: 8,now: 2024-06-08 16:21:41.861082,epoch time: 0:28:23.876612,used: 3:48:52.763043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9787632, 'precision': 0.8197515, 'recall': 0.89950675, 'specificity': 0.89950675, 'f1': 0.85475755, 'auroc': 0.9820532, 'binary_precision': 0.6460129, 'binary_recall': 0.81453806, 'binary_specificity': 0.98447543, 'binary_f1_score': 0.7205528}
confusion matrix:
       0     1
0  41663   657
1    273  1199
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.81351876, 'recall': 0.88392353, 'specificity': 0.88392353, 'f1': 0.84479654, 'auroc': 0.97995025, 'binary_precision': 0.6347607, 'binary_recall': 0.7838258, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.7014614}
confusion matrix:
       0    1
0  17859  290
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8313085, 'recall': 0.7140553, 'specificity': 0.7140553, 'f1': 0.7587483, 'auroc': 0.958354, 'binary_precision': 0.686747, 'binary_recall': 0.43678162, 'binary_specificity': 0.991329, 'binary_f1_score': 0.53395784}
confusion matrix:
      0    1
0  5945   52
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_9.png
early stop counter: 2
val acc:0.9771711230278015, best validation acc: 0.9798850417137146, corresponding to test acc:                         0.9632470607757568 / 0.9785873889923096
after epoch: 9,now: 2024-06-08 16:50:03.264086,epoch time: 0:28:21.403004,used: 4:17:14.166047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.8772396, 'recall': 0.8608873, 'specificity': 0.8608873, 'f1': 0.8688668, 'auroc': 0.9822031, 'binary_precision': 0.7638691, 'binary_recall': 0.72961956, 'binary_specificity': 0.992155, 'binary_f1_score': 0.7463516}
confusion matrix:
       0     1
0  41988   332
1    398  1074
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.8860581, 'recall': 0.81726015, 'specificity': 0.81726015, 'f1': 0.8480165, 'auroc': 0.9759171, 'binary_precision': 0.7847619, 'binary_recall': 0.6407465, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.70547944}
confusion matrix:
       0    1
0  18036  113
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8193544, 'recall': 0.6293492, 'specificity': 0.6293492, 'f1': 0.68026155, 'auroc': 0.9658557, 'binary_precision': 0.6699029, 'binary_recall': 0.26436782, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.3791209}
confusion matrix:
      0   1
0  5963  34
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_10.png
better model found
persisted
after epoch: 10,now: 2024-06-08 17:18:02.745765,epoch time: 0:27:59.481679,used: 4:45:13.647726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9810011, 'precision': 0.83571476, 'recall': 0.9082054, 'specificity': 0.9082054, 'f1': 0.8680816, 'auroc': 0.98114693, 'binary_precision': 0.6773836, 'binary_recall': 0.83016306, 'binary_specificity': 0.98624766, 'binary_f1_score': 0.74603176}
confusion matrix:
       0     1
0  41738   582
1    250  1222
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.87300366, 'recall': 0.8735632, 'specificity': 0.8735632, 'f1': 0.8732832, 'auroc': 0.9783193, 'binary_precision': 0.7546584, 'binary_recall': 0.755832, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.7552448}
confusion matrix:
       0    1
0  17991  158
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8385252, 'recall': 0.6580014, 'specificity': 0.6580014, 'f1': 0.7123183, 'auroc': 0.95304084, 'binary_precision': 0.7058824, 'binary_recall': 0.3218391, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4421053}
confusion matrix:
      0   1
0  5962  35
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_11.png
better model found
persisted
after epoch: 11,now: 2024-06-08 17:46:06.312495,epoch time: 0:28:03.566730,used: 5:13:17.214456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9838555, 'precision': 0.89734656, 'recall': 0.8394133, 'specificity': 0.8394133, 'f1': 0.865919, 'auroc': 0.98480844, 'binary_precision': 0.8056, 'binary_recall': 0.68456835, 'binary_specificity': 0.99425817, 'binary_f1_score': 0.7401691}
confusion matrix:
       0     1
0  42078   243
1    464  1007
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.8975351, 'recall': 0.8145905, 'specificity': 0.8145905, 'f1': 0.85084474, 'auroc': 0.97803146, 'binary_precision': 0.8079208, 'binary_recall': 0.63452566, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7108014}
confusion matrix:
       0    1
0  18052   97
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8252014, 'recall': 0.59761584, 'specificity': 0.59761584, 'f1': 0.64473706, 'auroc': 0.9534453, 'binary_precision': 0.68421054, 'binary_recall': 0.19923371, 'binary_specificity': 0.995998, 'binary_f1_score': 0.30860534}
confusion matrix:
      0   1
0  5973  24
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_12.png
early stop counter: 1
val acc:0.9823328852653503, best validation acc: 0.9832375645637512, corresponding to test acc:                         0.9661233425140381 / 0.9785873889923096
after epoch: 12,now: 2024-06-08 18:14:26.384731,epoch time: 0:28:20.072236,used: 5:41:37.286692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9808184, 'precision': 0.86996865, 'recall': 0.8163103, 'specificity': 0.8163103, 'f1': 0.8408656, 'auroc': 0.9823538, 'binary_precision': 0.75239617, 'binary_recall': 0.6399456, 'binary_specificity': 0.9926749, 'binary_f1_score': 0.6916299}
confusion matrix:
       0    1
0  42010  310
1    530  942
---- Validation: 
scalar performance:
{'acc': 0.98052365, 'precision': 0.8818077, 'recall': 0.7986527, 'specificity': 0.7986527, 'f1': 0.8347331, 'auroc': 0.9798703, 'binary_precision': 0.7775551, 'binary_recall': 0.60342145, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.67950964}
confusion matrix:
       0    1
0  18038  111
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9124147, 'recall': 0.5361483, 'specificity': 0.5361483, 'f1': 0.5571239, 'auroc': 0.9666275, 'binary_precision': 0.8636364, 'binary_recall': 0.07279693, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.13427562}
confusion matrix:
      0   1
0  5994   3
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_13.png
early stop counter: 2
val acc:0.9805236458778381, best validation acc: 0.9832375645637512, corresponding to test acc:                         0.9661233425140381 / 0.9785873889923096
after epoch: 13,now: 2024-06-08 18:42:40.750640,epoch time: 0:28:14.365909,used: 6:09:51.652601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9808184, 'precision': 0.8304728, 'recall': 0.9235202, 'specificity': 0.9235202, 'f1': 0.8706783, 'auroc': 0.986433, 'binary_precision': 0.6657922, 'binary_recall': 0.8620924, 'binary_specificity': 0.98494804, 'binary_f1_score': 0.75133216}
confusion matrix:
       0     1
0  41683   637
1    203  1269
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.8352164, 'recall': 0.9104936, 'specificity': 0.9104936, 'f1': 0.86867404, 'auroc': 0.98348916, 'binary_precision': 0.6763224, 'binary_recall': 0.83514774, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.7473904}
confusion matrix:
       0    1
0  17892  257
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7960278, 'recall': 0.5877038, 'specificity': 0.5877038, 'f1': 0.6299466, 'auroc': 0.9568213, 'binary_precision': 0.62666667, 'binary_recall': 0.18007663, 'binary_specificity': 0.995331, 'binary_f1_score': 0.2797619}
confusion matrix:
      0   1
0  5969  28
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_14.png
early stop counter: 3
val acc:0.9806832671165466, best validation acc: 0.9832375645637512, corresponding to test acc:                         0.9661233425140381 / 0.9785873889923096
after epoch: 14,now: 2024-06-08 19:11:21.353143,epoch time: 0:28:40.602503,used: 6:38:32.255104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9849516, 'precision': 0.8888439, 'recall': 0.8758241, 'specificity': 0.8758241, 'f1': 0.8822138, 'auroc': 0.98774123, 'binary_precision': 0.7860662, 'binary_recall': 0.7588315, 'binary_specificity': 0.9928166, 'binary_f1_score': 0.77220875}
confusion matrix:
       0     1
0  42016   304
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9015838, 'recall': 0.8586385, 'specificity': 0.8586385, 'f1': 0.8787979, 'auroc': 0.98036337, 'binary_precision': 0.8129371, 'binary_recall': 0.7231726, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7654321}
confusion matrix:
       0    1
0  18042  107
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8256758, 'recall': 0.6520041, 'specificity': 0.6520041, 'f1': 0.7041763, 'auroc': 0.9564035, 'binary_precision': 0.6806723, 'binary_recall': 0.31034482, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.42631578}
confusion matrix:
      0   1
0  5959  38
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_15.png
better model found
persisted
after epoch: 15,now: 2024-06-08 19:39:09.010051,epoch time: 0:27:47.656908,used: 7:06:19.912012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9839925, 'precision': 0.9209653, 'recall': 0.8136903, 'specificity': 0.8136903, 'f1': 0.8589101, 'auroc': 0.98731244, 'binary_precision': 0.8546458, 'binary_recall': 0.6311141, 'binary_specificity': 0.99626654, 'binary_f1_score': 0.7260648}
confusion matrix:
       0    1
0  42162  158
1    543  929
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.905587, 'recall': 0.7793992, 'specificity': 0.7793992, 'f1': 0.82998514, 'auroc': 0.98188937, 'binary_precision': 0.826484, 'binary_recall': 0.562986, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.6697502}
confusion matrix:
       0    1
0  18073   76
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.79744434, 'recall': 0.6101087, 'specificity': 0.6101087, 'f1': 0.6564529, 'auroc': 0.95524967, 'binary_precision': 0.62765956, 'binary_recall': 0.22605364, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.33239436}
confusion matrix:
      0   1
0  5962  35
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_16.png
early stop counter: 1
val acc:0.9810025691986084, best validation acc: 0.9848339557647705, corresponding to test acc:                         0.9651646018028259 / 0.9785873889923096
after epoch: 16,now: 2024-06-08 20:06:53.884464,epoch time: 0:27:44.874413,used: 7:34:04.786425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98232555, 'precision': 0.8585067, 'recall': 0.8763521, 'specificity': 0.8763521, 'f1': 0.8671931, 'auroc': 0.98560405, 'binary_precision': 0.72527474, 'binary_recall': 0.76274645, 'binary_specificity': 0.9899577, 'binary_f1_score': 0.7435388}
confusion matrix:
       0     1
0  41896   425
1    349  1122
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.8701678, 'recall': 0.8412068, 'specificity': 0.8412068, 'f1': 0.8550462, 'auroc': 0.9775116, 'binary_precision': 0.75126904, 'binary_recall': 0.6905132, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.719611}
confusion matrix:
       0    1
0  18002  147
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.9440739, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_17.png
early stop counter: 2
val acc:0.9815878868103027, best validation acc: 0.9848339557647705, corresponding to test acc:                         0.9651646018028259 / 0.9785873889923096
after epoch: 17,now: 2024-06-08 20:35:42.095546,epoch time: 0:28:48.211082,used: 8:02:52.997507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9827366, 'precision': 0.9501735, 'recall': 0.7668124, 'specificity': 0.7668124, 'f1': 0.83347344, 'auroc': 0.98423827, 'binary_precision': 0.9162791, 'binary_recall': 0.53532606, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.67581475}
confusion matrix:
       0    1
0  42248   72
1    684  788
---- Validation: 
scalar performance:
{'acc': 0.9794061, 'precision': 0.9493591, 'recall': 0.71781826, 'specificity': 0.71781826, 'f1': 0.79081935, 'auroc': 0.9701966, 'binary_precision': 0.9183006, 'binary_recall': 0.43701398, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.5922023}
confusion matrix:
       0    1
0  18124   25
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.9459565, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_18.png
early stop counter: 3
val acc:0.9794061183929443, best validation acc: 0.9848339557647705, corresponding to test acc:                         0.9651646018028259 / 0.9785873889923096
after epoch: 18,now: 2024-06-08 21:04:12.475720,epoch time: 0:28:30.380174,used: 8:31:23.377681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98543113, 'precision': 0.8876946, 'recall': 0.88820297, 'specificity': 0.88820297, 'f1': 0.8879486, 'auroc': 0.9878544, 'binary_precision': 0.7829037, 'binary_recall': 0.7839674, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.78343517}
confusion matrix:
       0     1
0  42000   320
1    318  1154
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.88855517, 'recall': 0.86811376, 'specificity': 0.86811376, 'f1': 0.8780346, 'auroc': 0.98003256, 'binary_precision': 0.7861842, 'binary_recall': 0.7433904, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.76418865}
confusion matrix:
       0    1
0  18019  130
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.79817337, 'recall': 0.5485578, 'specificity': 0.5485578, 'f1': 0.57585853, 'auroc': 0.95780855, 'binary_precision': 0.63414633, 'binary_recall': 0.099616855, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.17218542}
confusion matrix:
      0   1
0  5982  15
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_19.png
early stop counter: 4
val acc:0.9843018054962158, best validation acc: 0.9848339557647705, corresponding to test acc:                         0.9651646018028259 / 0.9785873889923096
after epoch: 19,now: 2024-06-08 21:31:46.749151,epoch time: 0:27:34.273431,used: 8:58:57.651112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9869839, 'precision': 0.8982718, 'recall': 0.9024486, 'specificity': 0.9024486, 'f1': 0.9003484, 'auroc': 0.98996496, 'binary_precision': 0.8030914, 'binary_recall': 0.8118206, 'binary_specificity': 0.99307656, 'binary_f1_score': 0.8074324}
confusion matrix:
       0     1
0  42027   293
1    277  1195
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.89910626, 'recall': 0.8654716, 'specificity': 0.8654716, 'f1': 0.8814873, 'auroc': 0.9813226, 'binary_precision': 0.8074957, 'binary_recall': 0.7371695, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.7707317}
confusion matrix:
       0    1
0  18036  113
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.80627894, 'recall': 0.61219114, 'specificity': 0.61219114, 'f1': 0.65987146, 'auroc': 0.9504147, 'binary_precision': 0.6451613, 'binary_recall': 0.22988506, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.33898306}
confusion matrix:
      0   1
0  5964  33
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_20.png
better model found
persisted
after epoch: 20,now: 2024-06-08 21:59:13.912861,epoch time: 0:27:27.163710,used: 9:26:24.814822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_49_seed_0_21256946
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9876918, 'precision': 0.92692375, 'recall': 0.87486327, 'specificity': 0.87486327, 'f1': 0.89907175, 'auroc': 0.990338, 'binary_precision': 0.86236393, 'binary_recall': 0.75390893, 'binary_specificity': 0.99581766, 'binary_f1_score': 0.8044976}
confusion matrix:
       0     1
0  42144   177
1    362  1109
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9159237, 'recall': 0.8329438, 'specificity': 0.8329438, 'f1': 0.86947584, 'auroc': 0.98301166, 'binary_precision': 0.8434442, 'binary_recall': 0.6702955, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7469671}
confusion matrix:
       0    1
0  18069   80
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7762663, 'recall': 0.57429385, 'specificity': 0.57429385, 'f1': 0.6113647, 'auroc': 0.96179956, 'binary_precision': 0.5882353, 'binary_recall': 0.1532567, 'binary_specificity': 0.995331, 'binary_f1_score': 0.24316108}
confusion matrix:
      0   1
0  5969  28
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256946_21.png
[Sat Jun  8 22:27:36 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/1.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 85942848 vs 85942672
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
