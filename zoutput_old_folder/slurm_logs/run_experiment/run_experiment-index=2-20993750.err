Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750

 Experiment start at: 2024-05-29 13:38:03.310253
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97008586, 'precision': 0.8455725, 'recall': 0.58912456, 'specificity': 0.58912456, 'f1': 0.63676906, 'auroc': 0.9459232, 'binary_precision': 0.7189189, 'binary_recall': 0.18070652, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.28881648}
confusion matrix:
       0    1
0  42216  104
1   1206  266
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.86276186, 'recall': 0.5169145, 'specificity': 0.5169145, 'f1': 0.5242314, 'auroc': 0.9405313, 'binary_precision': 0.7586207, 'binary_recall': 0.03421462, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.06547619}
confusion matrix:
       0   1
0  18142   7
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9423591, 'recall': 0.5667997, 'specificity': 0.5667997, 'f1': 0.6076847, 'auroc': 0.9317986, 'binary_precision': 0.92105263, 'binary_recall': 0.13409962, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2341137}
confusion matrix:
      0   1
0  5994   3
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:09:08.924364,epoch time: 0:31:05.614111,used: 0:31:05.614111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97501826, 'precision': 0.8674342, 'recall': 0.68741137, 'specificity': 0.68741137, 'f1': 0.7460816, 'auroc': 0.96180415, 'binary_precision': 0.75609756, 'binary_recall': 0.3790761, 'binary_specificity': 0.9957467, 'binary_f1_score': 0.50497735}
confusion matrix:
       0    1
0  42140  180
1    914  558
---- Validation: 
scalar performance:
{'acc': 0.97318006, 'precision': 0.88938344, 'recall': 0.64183956, 'specificity': 0.64183956, 'f1': 0.70414495, 'auroc': 0.96097875, 'binary_precision': 0.80349344, 'binary_recall': 0.28615862, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.42201832}
confusion matrix:
       0    1
0  18104   45
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.93987775, 'recall': 0.6525897, 'specificity': 0.6525897, 'f1': 0.72145945, 'auroc': 0.9458989, 'binary_precision': 0.90909094, 'binary_recall': 0.3065134, 'binary_specificity': 0.998666, 'binary_f1_score': 0.45845273}
confusion matrix:
      0   1
0  5989   8
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:43:40.251654,epoch time: 0:34:31.327290,used: 1:05:36.941401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9775301, 'precision': 0.8581772, 'recall': 0.75756145, 'specificity': 0.75756145, 'f1': 0.798978, 'auroc': 0.966322, 'binary_precision': 0.73282444, 'binary_recall': 0.5217391, 'binary_specificity': 0.99338377, 'binary_f1_score': 0.6095238}
confusion matrix:
       0    1
0  42040  280
1    704  768
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.9128685, 'recall': 0.68080246, 'specificity': 0.68080246, 'f1': 0.7484743, 'auroc': 0.96674895, 'binary_precision': 0.84782606, 'binary_recall': 0.36391914, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.50924915}
confusion matrix:
       0    1
0  18107   42
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.91093576, 'recall': 0.5798762, 'specificity': 0.5798762, 'f1': 0.6262262, 'auroc': 0.9481195, 'binary_precision': 0.85714287, 'binary_recall': 0.16091955, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.27096778}
confusion matrix:
      0   1
0  5990   7
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 3,now: 2024-05-29 15:13:54.097089,epoch time: 0:30:13.845435,used: 1:35:50.786836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9771191, 'precision': 0.81309927, 'recall': 0.86816514, 'specificity': 0.86816514, 'f1': 0.8381814, 'auroc': 0.96920955, 'binary_precision': 0.6349024, 'binary_recall': 0.7513587, 'binary_specificity': 0.98497164, 'binary_f1_score': 0.688239}
confusion matrix:
       0     1
0  41684   636
1    366  1106
---- Validation: 
scalar performance:
{'acc': 0.9766922, 'precision': 0.82153594, 'recall': 0.83117163, 'specificity': 0.83117163, 'f1': 0.82627565, 'auroc': 0.9693392, 'binary_precision': 0.6546003, 'binary_recall': 0.6749611, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.66462475}
confusion matrix:
       0    1
0  17920  229
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.87792903, 'recall': 0.73271406, 'specificity': 0.73271406, 'f1': 0.78640556, 'auroc': 0.95554864, 'binary_precision': 0.778481, 'binary_recall': 0.47126436, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5871121}
confusion matrix:
      0    1
0  5962   35
1   138  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-29 15:44:05.616410,epoch time: 0:30:11.519321,used: 2:06:02.306157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98024756, 'precision': 0.881071, 'recall': 0.7865076, 'specificity': 0.7865076, 'f1': 0.8265592, 'auroc': 0.97468054, 'binary_precision': 0.7766636, 'binary_recall': 0.5788044, 'binary_specificity': 0.9942108, 'binary_f1_score': 0.6632931}
confusion matrix:
       0    1
0  42075  245
1    620  852
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.8787048, 'recall': 0.7608807, 'specificity': 0.7608807, 'f1': 0.8080784, 'auroc': 0.9692775, 'binary_precision': 0.77397263, 'binary_recall': 0.5272162, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.627197}
confusion matrix:
       0    1
0  18050   99
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.91139954, 'recall': 0.591287, 'specificity': 0.591287, 'f1': 0.6423614, 'auroc': 0.9526962, 'binary_precision': 0.85714287, 'binary_recall': 0.18390805, 'binary_specificity': 0.998666, 'binary_f1_score': 0.3028391}
confusion matrix:
      0   1
0  5989   8
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 5,now: 2024-05-29 16:14:21.467778,epoch time: 0:30:15.851368,used: 2:36:18.157525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98202866, 'precision': 0.8752346, 'recall': 0.8349687, 'specificity': 0.8349687, 'f1': 0.85386395, 'auroc': 0.9770849, 'binary_precision': 0.7616501, 'binary_recall': 0.6773098, 'binary_specificity': 0.9926276, 'binary_f1_score': 0.7170083}
confusion matrix:
       0    1
0  42008  312
1    475  997
---- Validation: 
scalar performance:
{'acc': 0.9807897, 'precision': 0.88685644, 'recall': 0.7972903, 'specificity': 0.7972903, 'f1': 0.8357366, 'auroc': 0.9722042, 'binary_precision': 0.78775513, 'binary_recall': 0.60031104, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.6813769}
confusion matrix:
       0    1
0  18045  104
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.86725396, 'recall': 0.60019857, 'specificity': 0.60019857, 'f1': 0.65141517, 'auroc': 0.95320404, 'binary_precision': 0.76811594, 'binary_recall': 0.20306513, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3212121}
confusion matrix:
      0   1
0  5981  16
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 6,now: 2024-05-29 16:47:27.061595,epoch time: 0:33:05.593817,used: 3:09:23.751342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98116094, 'precision': 0.84919614, 'recall': 0.8691025, 'specificity': 0.8691025, 'f1': 0.8588481, 'auroc': 0.97770226, 'binary_precision': 0.7071291, 'binary_recall': 0.74897957, 'binary_specificity': 0.98922545, 'binary_f1_score': 0.7274529}
confusion matrix:
       0     1
0  41866   456
1    369  1101
---- Validation: 
scalar performance:
{'acc': 0.9796722, 'precision': 0.87209904, 'recall': 0.7944616, 'specificity': 0.7944616, 'f1': 0.82838154, 'auroc': 0.97457945, 'binary_precision': 0.7584158, 'binary_recall': 0.5956454, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.66724735}
confusion matrix:
       0    1
0  18027  122
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.85848415, 'recall': 0.6604174, 'specificity': 0.6604174, 'f1': 0.7182242, 'auroc': 0.95330966, 'binary_precision': 0.74561405, 'binary_recall': 0.3256705, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.45333335}
confusion matrix:
      0   1
0  5968  29
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9796721935272217, best validation acc: 0.9807897210121155, corresponding to test acc:                         0.964205801486969 / 0.9723553657531738
after epoch: 7,now: 2024-05-29 17:16:44.064895,epoch time: 0:29:17.003300,used: 3:38:40.754642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9828279, 'precision': 0.86091185, 'recall': 0.8835775, 'specificity': 0.8835775, 'f1': 0.8718684, 'auroc': 0.98062927, 'binary_precision': 0.72959185, 'binary_recall': 0.77717394, 'binary_specificity': 0.9899811, 'binary_f1_score': 0.75263155}
confusion matrix:
       0     1
0  41896   424
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.87504077, 'recall': 0.8490931, 'specificity': 0.8490931, 'f1': 0.86156154, 'auroc': 0.97395915, 'binary_precision': 0.760469, 'binary_recall': 0.7060653, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.7322581}
confusion matrix:
       0    1
0  18006  143
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.86060035, 'recall': 0.6585851, 'specificity': 0.6585851, 'f1': 0.71676, 'auroc': 0.95431644, 'binary_precision': 0.75, 'binary_recall': 0.3218391, 'binary_specificity': 0.995331, 'binary_f1_score': 0.45040217}
confusion matrix:
      0   1
0  5969  28
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 8,now: 2024-05-29 17:52:06.343636,epoch time: 0:35:22.278741,used: 4:14:03.033383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98428935, 'precision': 0.8863889, 'recall': 0.86555684, 'specificity': 0.86555684, 'f1': 0.87566006, 'auroc': 0.98196536, 'binary_precision': 0.78185743, 'binary_recall': 0.73827326, 'binary_specificity': 0.9928404, 'binary_f1_score': 0.75944054}
confusion matrix:
       0     1
0  42018   303
1    385  1086
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.8904251, 'recall': 0.82203597, 'specificity': 0.82203597, 'f1': 0.85267884, 'auroc': 0.97757417, 'binary_precision': 0.7931689, 'binary_recall': 0.65007776, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.71453}
confusion matrix:
       0    1
0  18040  109
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.826233, 'recall': 0.5826237, 'specificity': 0.5826237, 'f1': 0.62566435, 'auroc': 0.95390576, 'binary_precision': 0.6875, 'binary_recall': 0.16858238, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27076924}
confusion matrix:
      0   1
0  5977  20
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9822264909744263, best validation acc: 0.9823328852653503, corresponding to test acc:                         0.9672419428825378 / 0.9723553657531738
after epoch: 9,now: 2024-05-29 18:22:05.243182,epoch time: 0:29:58.899546,used: 4:44:01.932929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.91549927, 'recall': 0.8071184, 'specificity': 0.8071184, 'f1': 0.85257035, 'auroc': 0.98161376, 'binary_precision': 0.84415585, 'binary_recall': 0.6182065, 'binary_specificity': 0.9960303, 'binary_f1_score': 0.7137255}
confusion matrix:
       0    1
0  42152  168
1    562  910
---- Validation: 
scalar performance:
{'acc': 0.9803108, 'precision': 0.9102518, 'recall': 0.7617898, 'specificity': 0.7617898, 'f1': 0.8184098, 'auroc': 0.97349966, 'binary_precision': 0.837037, 'binary_recall': 0.5272162, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.64694655}
confusion matrix:
       0    1
0  18083   66
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9440254, 'recall': 0.547726, 'specificity': 0.547726, 'f1': 0.5770738, 'auroc': 0.95512414, 'binary_precision': 0.9259259, 'binary_recall': 0.09578544, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1736111}
confusion matrix:
      0   1
0  5995   2
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9803107976913452, best validation acc: 0.9823328852653503, corresponding to test acc:                         0.9672419428825378 / 0.9723553657531738
after epoch: 10,now: 2024-05-29 18:51:15.019379,epoch time: 0:29:09.776197,used: 5:13:11.709126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98675555, 'precision': 0.9276134, 'recall': 0.8570859, 'specificity': 0.8570859, 'f1': 0.88893723, 'auroc': 0.9850942, 'binary_precision': 0.86497545, 'binary_recall': 0.7180706, 'binary_specificity': 0.99610114, 'binary_f1_score': 0.7847068}
confusion matrix:
       0     1
0  42155   165
1    415  1057
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9080538, 'recall': 0.8110882, 'specificity': 0.8110882, 'f1': 0.85252297, 'auroc': 0.9788418, 'binary_precision': 0.8292181, 'binary_recall': 0.62674963, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.71390617}
confusion matrix:
       0    1
0  18066   83
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8735924, 'recall': 0.5946182, 'specificity': 0.5946182, 'f1': 0.64461803, 'auroc': 0.96633214, 'binary_precision': 0.78125, 'binary_recall': 0.19157088, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3076923}
confusion matrix:
      0   1
0  5983  14
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 11,now: 2024-05-29 19:20:33.942377,epoch time: 0:29:18.922998,used: 5:42:30.632124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98581934, 'precision': 0.9094589, 'recall': 0.861663, 'specificity': 0.861663, 'f1': 0.8839615, 'auroc': 0.985249, 'binary_precision': 0.82830626, 'binary_recall': 0.7285714, 'binary_specificity': 0.9947545, 'binary_f1_score': 0.77524436}
confusion matrix:
       0     1
0  42100   222
1    399  1071
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.8909569, 'recall': 0.8212859, 'specificity': 0.8212859, 'f1': 0.85243464, 'auroc': 0.9758607, 'binary_precision': 0.7942857, 'binary_recall': 0.64852256, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7140411}
confusion matrix:
       0    1
0  18041  108
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.865294, 'recall': 0.6039466, 'specificity': 0.6039466, 'f1': 0.6560131, 'auroc': 0.9598273, 'binary_precision': 0.7638889, 'binary_recall': 0.21072797, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.33033034}
confusion matrix:
      0   1
0  5980  17
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9822264909744263, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9640460014343262 / 0.9723553657531738
after epoch: 12,now: 2024-05-29 19:49:35.297408,epoch time: 0:29:01.355031,used: 6:11:31.987155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98705244, 'precision': 0.912011, 'recall': 0.8824847, 'specificity': 0.8824847, 'f1': 0.89665484, 'auroc': 0.98786867, 'binary_precision': 0.8319883, 'binary_recall': 0.77038044, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.8000001}
confusion matrix:
       0     1
0  42091   229
1    338  1134
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.92017263, 'recall': 0.7991148, 'specificity': 0.7991148, 'f1': 0.8486898, 'auroc': 0.97609013, 'binary_precision': 0.8543046, 'binary_recall': 0.60186625, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.70620435}
confusion matrix:
       0    1
0  18083   66
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.94535244, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 13,now: 2024-05-29 20:18:31.419216,epoch time: 0:28:56.121808,used: 6:40:28.108963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9871894, 'precision': 0.9097224, 'recall': 0.888457, 'specificity': 0.888457, 'f1': 0.8987833, 'auroc': 0.9866595, 'binary_precision': 0.8269921, 'binary_recall': 0.7826087, 'binary_specificity': 0.9943053, 'binary_f1_score': 0.8041885}
confusion matrix:
       0     1
0  42079   241
1    320  1152
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.90291476, 'recall': 0.83172536, 'specificity': 0.83172536, 'f1': 0.863593, 'auroc': 0.9792615, 'binary_precision': 0.8174905, 'binary_recall': 0.6687403, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7356715}
confusion matrix:
       0    1
0  18053   96
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8431473, 'recall': 0.5828738, 'specificity': 0.5828738, 'f1': 0.6270511, 'auroc': 0.94971925, 'binary_precision': 0.72131145, 'binary_recall': 0.16858238, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.27329195}
confusion matrix:
      0   1
0  5980  17
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 14,now: 2024-05-29 20:47:37.499422,epoch time: 0:29:06.080206,used: 7:09:34.189169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98705244, 'precision': 0.912011, 'recall': 0.8824847, 'specificity': 0.8824847, 'f1': 0.89665484, 'auroc': 0.9892938, 'binary_precision': 0.8319883, 'binary_recall': 0.77038044, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.8000001}
confusion matrix:
       0     1
0  42091   229
1    338  1134
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.90307176, 'recall': 0.8263372, 'specificity': 0.8263372, 'f1': 0.8603448, 'auroc': 0.9769977, 'binary_precision': 0.8181818, 'binary_recall': 0.6578538, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.72931033}
confusion matrix:
       0    1
0  18055   94
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8327093, 'recall': 0.5620512, 'specificity': 0.5620512, 'f1': 0.5972314, 'auroc': 0.954947, 'binary_precision': 0.70212764, 'binary_recall': 0.12643678, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.21428573}
confusion matrix:
      0   1
0  5983  14
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9832907915115356, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9626078605651855 / 0.9723553657531738
after epoch: 15,now: 2024-05-29 21:16:37.584573,epoch time: 0:29:00.085151,used: 7:38:34.274320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9871209, 'precision': 0.94286287, 'recall': 0.84743917, 'specificity': 0.84743917, 'f1': 0.8889652, 'auroc': 0.9895473, 'binary_precision': 0.89616054, 'binary_recall': 0.6976902, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.78456837}
confusion matrix:
       0     1
0  42201   119
1    445  1027
---- Validation: 
scalar performance:
{'acc': 0.9811622, 'precision': 0.9393709, 'recall': 0.75323, 'specificity': 0.75323, 'f1': 0.81956553, 'auroc': 0.97163177, 'binary_precision': 0.8958904, 'binary_recall': 0.5085537, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.64880955}
confusion matrix:
       0    1
0  18111   38
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9294125, 'recall': 0.5495583, 'specificity': 0.5495583, 'f1': 0.57992184, 'auroc': 0.9476823, 'binary_precision': 0.8965517, 'binary_recall': 0.099616855, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5994   3
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9811621904373169, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9626078605651855 / 0.9723553657531738
after epoch: 16,now: 2024-05-29 21:45:31.135986,epoch time: 0:28:53.551413,used: 8:07:27.825733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9876918, 'precision': 0.9400846, 'recall': 0.86019313, 'specificity': 0.86019313, 'f1': 0.8958521, 'auroc': 0.9905085, 'binary_precision': 0.8897243, 'binary_recall': 0.72350544, 'binary_specificity': 0.9968809, 'binary_f1_score': 0.7980517}
confusion matrix:
       0     1
0  42188   132
1    407  1065
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9254565, 'recall': 0.7930868, 'specificity': 0.7930868, 'f1': 0.846177, 'auroc': 0.9747919, 'binary_precision': 0.8652968, 'binary_recall': 0.58942455, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.7012026}
confusion matrix:
       0    1
0  18090   59
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.85254705, 'recall': 0.5490581, 'specificity': 0.5490581, 'f1': 0.5778542, 'auroc': 0.9574869, 'binary_precision': 0.74285716, 'binary_recall': 0.099616855, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.17567569}
confusion matrix:
      0   1
0  5988   9
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9828118085861206, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9626078605651855 / 0.9723553657531738
after epoch: 17,now: 2024-05-29 22:14:25.529952,epoch time: 0:28:54.393966,used: 8:36:22.219699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98780596, 'precision': 0.92284447, 'recall': 0.88221884, 'specificity': 0.88221884, 'f1': 0.9014256, 'auroc': 0.99002683, 'binary_precision': 0.85369533, 'binary_recall': 0.76902175, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.8091494}
confusion matrix:
       0     1
0  42126   194
1    340  1132
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.9334754, 'recall': 0.7979453, 'specificity': 0.7979453, 'f1': 0.8522354, 'auroc': 0.9704944, 'binary_precision': 0.88100684, 'binary_recall': 0.59875584, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7129629}
confusion matrix:
       0    1
0  18097   52
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8916132, 'recall': 0.5436444, 'specificity': 0.5436444, 'f1': 0.5696478, 'auroc': 0.95501536, 'binary_precision': 0.8214286, 'binary_recall': 0.08812261, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5992   5
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 4
val acc:0.9835036396980286, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9626078605651855 / 0.9723553657531738
after epoch: 18,now: 2024-05-29 22:43:18.265888,epoch time: 0:28:52.735936,used: 9:05:14.955635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9890391, 'precision': 0.9296382, 'recall': 0.896299, 'specificity': 0.896299, 'f1': 0.91224277, 'auroc': 0.99119365, 'binary_precision': 0.866322, 'binary_recall': 0.796875, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.83014864}
confusion matrix:
       0     1
0  42139   181
1    299  1173
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.91675615, 'recall': 0.8507185, 'specificity': 0.8507185, 'f1': 0.8806702, 'auroc': 0.97997046, 'binary_precision': 0.84386617, 'binary_recall': 0.7060653, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7688399}
confusion matrix:
       0    1
0  18065   84
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.790621, 'recall': 0.54847443, 'specificity': 0.54847443, 'f1': 0.5755326, 'auroc': 0.9525634, 'binary_precision': 0.61904764, 'binary_recall': 0.099616855, 'binary_specificity': 0.997332, 'binary_f1_score': 0.17161715}
confusion matrix:
      0   1
0  5981  16
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 19,now: 2024-05-29 23:12:13.970291,epoch time: 0:28:55.704403,used: 9:34:10.660038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98705244, 'precision': 0.9703773, 'recall': 0.8226942, 'specificity': 0.8226942, 'f1': 0.88184536, 'auroc': 0.9931327, 'binary_precision': 0.95290583, 'binary_recall': 0.646499, 'binary_specificity': 0.99888945, 'binary_f1_score': 0.77035236}
confusion matrix:
       0    1
0  42274   47
1    520  951
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.9385146, 'recall': 0.7493419, 'specificity': 0.7493419, 'f1': 0.81613, 'auroc': 0.97616076, 'binary_precision': 0.89444447, 'binary_recall': 0.5007776, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.6420738}
confusion matrix:
       0    1
0  18111   38
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.84999824, 'recall': 0.53206676, 'specificity': 0.53206676, 'f1': 0.54964006, 'auroc': 0.94693595, 'binary_precision': 0.73913044, 'binary_recall': 0.0651341, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11971831}
confusion matrix:
      0   1
0  5991   6
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9808961153030396, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9598913192749023 / 0.9723553657531738
after epoch: 20,now: 2024-05-29 23:41:06.039345,epoch time: 0:28:52.069054,used: 10:03:02.729092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98951864, 'precision': 0.943578, 'recall': 0.88835067, 'specificity': 0.88835067, 'f1': 0.91399145, 'auroc': 0.9926004, 'binary_precision': 0.8947779, 'binary_recall': 0.7798913, 'binary_specificity': 0.99681, 'binary_f1_score': 0.8333938}
confusion matrix:
       0     1
0  42185   135
1    324  1148
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.90960217, 'recall': 0.8527758, 'specificity': 0.8527758, 'f1': 0.8788999, 'auroc': 0.978337, 'binary_precision': 0.8294011, 'binary_recall': 0.71073097, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.76549417}
confusion matrix:
       0    1
0  18055   94
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8254826, 'recall': 0.5375638, 'specificity': 0.5375638, 'f1': 0.5587414, 'auroc': 0.9459324, 'binary_precision': 0.6896552, 'binary_recall': 0.07662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5988   9
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9851000308990479, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9598913192749023 / 0.9723553657531738
after epoch: 21,now: 2024-05-30 00:09:55.031067,epoch time: 0:28:48.991722,used: 10:31:51.720814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9893816, 'precision': 0.91995203, 'recall': 0.91581994, 'specificity': 0.91581994, 'f1': 0.91787493, 'auroc': 0.9927335, 'binary_precision': 0.84557307, 'binary_recall': 0.8369565, 'binary_specificity': 0.9946834, 'binary_f1_score': 0.84124273}
confusion matrix:
       0     1
0  42095   225
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.88596565, 'recall': 0.87030876, 'specificity': 0.87030876, 'f1': 0.87796116, 'auroc': 0.98064935, 'binary_precision': 0.78084415, 'binary_recall': 0.748056, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.76409847}
confusion matrix:
       0    1
0  18014  135
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.94989544, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9841954112052917, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9598913192749023 / 0.9723553657531738
after epoch: 22,now: 2024-05-30 00:38:45.129651,epoch time: 0:28:50.098584,used: 11:00:41.819398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98979264, 'precision': 0.94102776, 'recall': 0.89603317, 'specificity': 0.89603317, 'f1': 0.917228, 'auroc': 0.9926343, 'binary_precision': 0.889142, 'binary_recall': 0.7955163, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.8397275}
confusion matrix:
       0     1
0  42174   146
1    301  1171
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.9148247, 'recall': 0.83522147, 'specificity': 0.83522147, 'f1': 0.87046623, 'auroc': 0.9792341, 'binary_precision': 0.84108526, 'binary_recall': 0.6749611, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.7489215}
confusion matrix:
       0    1
0  18067   82
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7923601, 'recall': 0.5522225, 'specificity': 0.5522225, 'f1': 0.5812658, 'auroc': 0.94239867, 'binary_precision': 0.62222224, 'binary_recall': 0.107279696, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.18300654}
confusion matrix:
      0   1
0  5980  17
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 4
val acc:0.9845147132873535, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9598913192749023 / 0.9723553657531738
after epoch: 23,now: 2024-05-30 01:07:34.580382,epoch time: 0:28:49.450731,used: 11:29:31.270129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.990158, 'precision': 0.9309499, 'recall': 0.91479754, 'specificity': 0.91479754, 'f1': 0.9227072, 'auroc': 0.99420536, 'binary_precision': 0.8676575, 'binary_recall': 0.8340136, 'binary_specificity': 0.9955815, 'binary_f1_score': 0.8505029}
confusion matrix:
       0     1
0  42135   187
1    244  1226
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.912534, 'recall': 0.8590517, 'specificity': 0.8590517, 'f1': 0.8837896, 'auroc': 0.979946, 'binary_precision': 0.83482945, 'binary_recall': 0.7231726, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.77500004}
confusion matrix:
       0    1
0  18057   92
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8595511, 'recall': 0.5585532, 'specificity': 0.5585532, 'f1': 0.5928242, 'auroc': 0.9482398, 'binary_precision': 0.75609756, 'binary_recall': 0.118773945, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.205298}
confusion matrix:
      0   1
0  5987  10
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 24,now: 2024-05-30 01:36:28.143172,epoch time: 0:28:53.562790,used: 11:58:24.832919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98792017, 'precision': 0.97605824, 'recall': 0.8324433, 'specificity': 0.8324433, 'f1': 0.89062417, 'auroc': 0.99415565, 'binary_precision': 0.96361846, 'binary_recall': 0.6657609, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.78746486}
confusion matrix:
       0    1
0  42283   37
1    492  980
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.955583, 'recall': 0.7435068, 'specificity': 0.7435068, 'f1': 0.8152596, 'auroc': 0.9746512, 'binary_precision': 0.92899406, 'binary_recall': 0.48833594, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.64016306}
confusion matrix:
       0    1
0  18125   24
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.8706938, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5995  2
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9812154173851013, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9616490602493286 / 0.9723553657531738
after epoch: 25,now: 2024-05-30 02:05:19.967183,epoch time: 0:28:51.824011,used: 12:27:16.656930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99180216, 'precision': 0.9534248, 'recall': 0.9167445, 'specificity': 0.9167445, 'f1': 0.9342524, 'auroc': 0.9933549, 'binary_precision': 0.9125278, 'binary_recall': 0.8362772, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.87274015}
confusion matrix:
       0     1
0  42202   118
1    241  1231
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.92168117, 'recall': 0.8516614, 'specificity': 0.8516614, 'f1': 0.8832518, 'auroc': 0.97274244, 'binary_precision': 0.85365856, 'binary_recall': 0.7076205, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.77380955}
confusion matrix:
       0    1
0  18071   78
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.9314927, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 26,now: 2024-05-30 02:34:17.178487,epoch time: 0:28:57.211304,used: 12:56:13.868234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98876506, 'precision': 0.90223765, 'recall': 0.9322218, 'specificity': 0.9322218, 'f1': 0.91664493, 'auroc': 0.9933068, 'binary_precision': 0.80895334, 'binary_recall': 0.87160325, 'binary_specificity': 0.9928403, 'binary_f1_score': 0.83911055}
confusion matrix:
       0     1
0  42017   303
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.8802885, 'recall': 0.8854201, 'specificity': 0.8854201, 'f1': 0.88283557, 'auroc': 0.978156, 'binary_precision': 0.7684049, 'binary_recall': 0.7791602, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.7737452}
confusion matrix:
       0    1
0  17998  151
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.756196, 'recall': 0.5295675, 'specificity': 0.5295675, 'f1': 0.5446211, 'auroc': 0.8866036, 'binary_precision': 0.55172414, 'binary_recall': 0.06130268, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.11034483}
confusion matrix:
      0   1
0  5984  13
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 27,now: 2024-05-30 03:03:25.091975,epoch time: 0:29:07.913488,used: 13:25:21.781722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9591061, 'recall': 0.8979944, 'specificity': 0.8979944, 'f1': 0.92620915, 'auroc': 0.99546814, 'binary_precision': 0.9251968, 'binary_recall': 0.7982337, 'binary_specificity': 0.99775517, 'binary_f1_score': 0.8570387}
confusion matrix:
       0     1
0  42225    95
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.9267856, 'recall': 0.8116667, 'specificity': 0.8116667, 'f1': 0.8595787, 'auroc': 0.97499514, 'binary_precision': 0.8666667, 'binary_recall': 0.62674963, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.72743684}
confusion matrix:
       0    1
0  18087   62
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7019498, 'recall': 0.5144919, 'specificity': 0.5144919, 'f1': 0.51792777, 'auroc': 0.866089, 'binary_precision': 0.44444445, 'binary_recall': 0.03065134, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.05734767}
confusion matrix:
      0   1
0  5987  10
1   253   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9839293360710144, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 28,now: 2024-05-30 03:32:29.208034,epoch time: 0:29:04.116059,used: 13:54:25.897781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9923045, 'precision': 0.9455278, 'recall': 0.9347087, 'specificity': 0.9347087, 'f1': 0.94004655, 'auroc': 0.99572676, 'binary_precision': 0.8954704, 'binary_recall': 0.87296194, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.8840729}
confusion matrix:
       0     1
0  42170   150
1    187  1285
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.92409086, 'recall': 0.8633255, 'specificity': 0.8633255, 'f1': 0.89117795, 'auroc': 0.97942126, 'binary_precision': 0.8576642, 'binary_recall': 0.7309487, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.78925276}
confusion matrix:
       0    1
0  18071   78
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.77557003, 'recall': 0.5241538, 'specificity': 0.5241538, 'f1': 0.53543204, 'auroc': 0.89340633, 'binary_precision': 0.59090906, 'binary_recall': 0.049808428, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.09187279}
confusion matrix:
      0   1
0  5988   9
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 29,now: 2024-05-30 04:01:29.833017,epoch time: 0:29:00.624983,used: 14:23:26.522764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9740037, 'recall': 0.8967687, 'specificity': 0.8967687, 'f1': 0.93171257, 'auroc': 0.9966661, 'binary_precision': 0.955102, 'binary_recall': 0.79483694, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.8676307}
confusion matrix:
       0     1
0  42265    55
1    302  1170
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9313566, 'recall': 0.81566495, 'specificity': 0.81566495, 'f1': 0.8638826, 'auroc': 0.9744343, 'binary_precision': 0.8755365, 'binary_recall': 0.63452566, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.735798}
confusion matrix:
       0    1
0  18091   58
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.82042676, 'recall': 0.53190005, 'specificity': 0.53190005, 'f1': 0.549138, 'auroc': 0.9200461, 'binary_precision': 0.68, 'binary_recall': 0.0651341, 'binary_specificity': 0.998666, 'binary_f1_score': 0.118881114}
confusion matrix:
      0   1
0  5989   8
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 30,now: 2024-05-30 04:30:32.015130,epoch time: 0:29:02.182113,used: 14:52:28.704877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:52:28.704877 at 2024-05-30 04:30:32.015130
persisted model performance metric: 

scalar performance:
{'acc': 0.9600511, 'precision': 0.81943876, 'recall': 0.53939617, 'specificity': 0.53939617, 'f1': 0.561692, 'auroc': 0.89356893, 'binary_precision': 0.67741936, 'binary_recall': 0.08045977, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.14383562}
confusion matrix:
      0   1
0  5987  10
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.971876, 'precision': 0.87067056, 'recall': 0.73246396, 'specificity': 0.73246396, 'f1': 0.7841928, 'auroc': 0.9491432, 'binary_precision': 0.76397514, 'binary_recall': 0.47126436, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.5829384}
confusion matrix:
      0    1
0  5959   38
1   138  123
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14476 MiB |  14476 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473243 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197547 K  |  197543 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94916 K  |   94913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197547 K  |  197543 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94916 K  |   94913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2806    |  132588 K  |  132588 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      43    |    2766    |   48761 K  |   48761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     45 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94916 K  |   94916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94916 K  |   94916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  132589 K  |  132589 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2766    |   48763 K  |   48763 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     45 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94916 K  |   94916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94916 K  |   94916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  132589 K  |  132589 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2766    |   48763 K  |   48763 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750

 Experiment start at: 2024-05-30 04:40:43.150769
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97079074, 'precision': 0.7998386, 'recall': 0.6378885, 'specificity': 0.6378885, 'f1': 0.6864991, 'auroc': 0.9476451, 'binary_precision': 0.6236559, 'binary_recall': 0.2815534, 'binary_specificity': 0.9942236, 'binary_f1_score': 0.38795987}
confusion matrix:
       0    1
0  42169  245
1   1036  406
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.8032026, 'recall': 0.5400039, 'specificity': 0.5400039, 'f1': 0.5636269, 'auroc': 0.94634473, 'binary_precision': 0.6395349, 'binary_recall': 0.08172362, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.14492753}
confusion matrix:
       0   1
0  18036  31
1    618  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.9152032, 'recall': 0.5974042, 'specificity': 0.5974042, 'f1': 0.65090245, 'auroc': 0.9471849, 'binary_precision': 0.86440676, 'binary_recall': 0.19615385, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.3197492}
confusion matrix:
      0   1
0  5938   8
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 05:12:13.223787,epoch time: 0:31:30.073018,used: 0:31:30.073018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9747583, 'precision': 0.8285803, 'recall': 0.71965826, 'specificity': 0.71965826, 'f1': 0.762406, 'auroc': 0.9626008, 'binary_precision': 0.67576075, 'binary_recall': 0.44660193, 'binary_specificity': 0.99271464, 'binary_f1_score': 0.5377871}
confusion matrix:
       0    1
0  42105  309
1    798  644
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.8450601, 'recall': 0.6083503, 'specificity': 0.6083503, 'f1': 0.66040885, 'auroc': 0.95848, 'binary_precision': 0.7184466, 'binary_recall': 0.21991085, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.33674628}
confusion matrix:
       0    1
0  18009   58
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.803909, 'recall': 0.5844362, 'specificity': 0.5844362, 'f1': 0.6264315, 'auroc': 0.9499638, 'binary_precision': 0.64285713, 'binary_recall': 0.17307693, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5921  25
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 2,now: 2024-05-30 05:42:18.899180,epoch time: 0:30:05.675393,used: 1:01:35.748411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9728885, 'precision': 0.83959955, 'recall': 0.65002644, 'specificity': 0.65002644, 'f1': 0.7054436, 'auroc': 0.96766865, 'binary_precision': 0.7024, 'binary_recall': 0.3044383, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.4247702}
confusion matrix:
       0    1
0  42228  186
1   1003  439
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.8502544, 'recall': 0.6120927, 'specificity': 0.6120927, 'f1': 0.6653898, 'auroc': 0.96040505, 'binary_precision': 0.7285714, 'binary_recall': 0.22734027, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.34654585}
confusion matrix:
       0    1
0  18010   57
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.9293554, 'recall': 0.5956493, 'specificity': 0.5956493, 'f1': 0.64929926, 'auroc': 0.959879, 'binary_precision': 0.89285713, 'binary_recall': 0.1923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.3164557}
confusion matrix:
      0   1
0  5940   6
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 06:12:43.422850,epoch time: 0:30:24.523670,used: 1:32:00.272081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9800711, 'precision': 0.8497932, 'recall': 0.82724506, 'specificity': 0.82724506, 'f1': 0.83811104, 'auroc': 0.97217107, 'binary_precision': 0.71099555, 'binary_recall': 0.6636616, 'binary_specificity': 0.9908285, 'binary_f1_score': 0.68651366}
confusion matrix:
       0    1
0  42025  389
1    485  957
---- Validation: 
scalar performance:
{'acc': 0.9770011, 'precision': 0.8535192, 'recall': 0.78779733, 'specificity': 0.78779733, 'f1': 0.81698257, 'auroc': 0.96629137, 'binary_precision': 0.7224265, 'binary_recall': 0.5839524, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.6458505}
confusion matrix:
       0    1
0  17916  151
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.81556106, 'recall': 0.64663637, 'specificity': 0.64663637, 'f1': 0.6971253, 'auroc': 0.96069056, 'binary_precision': 0.66101694, 'binary_recall': 0.3, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.41269842}
confusion matrix:
      0   1
0  5906  40
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 4,now: 2024-05-30 06:42:57.690599,epoch time: 0:30:14.267749,used: 2:02:14.539830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9779962, 'precision': 0.9102311, 'recall': 0.7029099, 'specificity': 0.7029099, 'f1': 0.7692096, 'auroc': 0.9748924, 'binary_precision': 0.84022826, 'binary_recall': 0.40846047, 'binary_specificity': 0.99735934, 'binary_f1_score': 0.5496967}
confusion matrix:
       0    1
0  42302  112
1    853  589
---- Validation: 
scalar performance:
{'acc': 0.9735859, 'precision': 0.9184308, 'recall': 0.65656275, 'specificity': 0.65656275, 'f1': 0.723916, 'auroc': 0.9701021, 'binary_precision': 0.86178863, 'binary_recall': 0.31500742, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.461371}
confusion matrix:
       0    1
0  18033   34
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8222463, 'recall': 0.55651504, 'specificity': 0.55651504, 'f1': 0.5886082, 'auroc': 0.9538487, 'binary_precision': 0.6818182, 'binary_recall': 0.115384616, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.19736841}
confusion matrix:
      0   1
0  5932  14
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9735859036445618, best validation acc: 0.9770010709762573, corresponding to test acc:                         0.9642281532287598 / 0.9651950001716614
after epoch: 5,now: 2024-05-30 07:13:24.918769,epoch time: 0:30:27.228170,used: 2:32:41.768000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9792275, 'precision': 0.8330947, 'recall': 0.8475759, 'specificity': 0.8475759, 'f1': 0.84016705, 'auroc': 0.97886086, 'binary_precision': 0.67617786, 'binary_recall': 0.7066574, 'binary_specificity': 0.98849434, 'binary_f1_score': 0.6910817}
confusion matrix:
       0     1
0  41926   488
1    423  1019
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.84762466, 'recall': 0.76124513, 'specificity': 0.76124513, 'f1': 0.7977535, 'auroc': 0.9698762, 'binary_precision': 0.71257484, 'binary_recall': 0.5304606, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.6081771}
confusion matrix:
       0    1
0  17923  144
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7840879, 'recall': 0.6232231, 'specificity': 0.6232231, 'f1': 0.6684963, 'auroc': 0.95424294, 'binary_precision': 0.6, 'binary_recall': 0.25384617, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.35675678}
confusion matrix:
      0   1
0  5902  44
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9754535555839539, best validation acc: 0.9770010709762573, corresponding to test acc:                         0.9642281532287598 / 0.9651950001716614
after epoch: 6,now: 2024-05-30 07:42:54.254920,epoch time: 0:29:29.336151,used: 3:02:11.104151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9822145, 'precision': 0.89841056, 'recall': 0.7970636, 'specificity': 0.7970636, 'f1': 0.83979636, 'auroc': 0.9799534, 'binary_precision': 0.81032866, 'binary_recall': 0.59888965, 'binary_specificity': 0.9952375, 'binary_f1_score': 0.688747}
confusion matrix:
       0    1
0  42213  202
1    578  863
---- Validation: 
scalar performance:
{'acc': 0.97982925, 'precision': 0.9354412, 'recall': 0.7492091, 'specificity': 0.7492091, 'f1': 0.8151539, 'auroc': 0.976086, 'binary_precision': 0.88918203, 'binary_recall': 0.5007429, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.64068437}
confusion matrix:
       0    1
0  18025   42
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84153485, 'recall': 0.60960436, 'specificity': 0.60960436, 'f1': 0.6607681, 'auroc': 0.95771754, 'binary_precision': 0.7160494, 'binary_recall': 0.22307692, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.34017593}
confusion matrix:
      0   1
0  5923  23
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 7,now: 2024-05-30 08:12:11.593206,epoch time: 0:29:17.338286,used: 3:31:28.442437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9832178, 'precision': 0.9203143, 'recall': 0.7933669, 'specificity': 0.7933669, 'f1': 0.8447411, 'auroc': 0.9820015, 'binary_precision': 0.8544177, 'binary_recall': 0.59015256, 'binary_specificity': 0.9965813, 'binary_f1_score': 0.69811314}
confusion matrix:
       0    1
0  42269  145
1    591  851
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.91115767, 'recall': 0.7626054, 'specificity': 0.7626054, 'f1': 0.8192305, 'auroc': 0.9762083, 'binary_precision': 0.8396226, 'binary_recall': 0.5289747, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.64904284}
confusion matrix:
       0    1
0  17999   68
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79989207, 'recall': 0.5656259, 'specificity': 0.5656259, 'f1': 0.60098463, 'auroc': 0.9508562, 'binary_precision': 0.6363636, 'binary_recall': 0.13461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5926  20
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9794557094573975, best validation acc: 0.9798292517662048, corresponding to test acc:                         0.9637447595596313 / 0.9651950001716614
after epoch: 8,now: 2024-05-30 08:41:19.763328,epoch time: 0:29:08.170122,used: 4:00:36.612559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9826478, 'precision': 0.92063844, 'recall': 0.78235376, 'specificity': 0.78235376, 'f1': 0.8369322, 'auroc': 0.98263395, 'binary_precision': 0.8557994, 'binary_recall': 0.56796116, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.6827845}
confusion matrix:
       0    1
0  42276  138
1    623  819
---- Validation: 
scalar performance:
{'acc': 0.9807898, 'precision': 0.9301231, 'recall': 0.7690195, 'specificity': 0.7690195, 'f1': 0.8296127, 'auroc': 0.97760546, 'binary_precision': 0.87710845, 'binary_recall': 0.5408618, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.6691176}
confusion matrix:
       0    1
0  18016   51
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7746682, 'recall': 0.5838476, 'specificity': 0.5838476, 'f1': 0.6233034, 'auroc': 0.95520806, 'binary_precision': 0.58441556, 'binary_recall': 0.17307693, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.26706234}
confusion matrix:
      0   1
0  5914  32
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 9,now: 2024-05-30 09:10:31.032850,epoch time: 0:29:11.269522,used: 4:29:47.882081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98476833, 'precision': 0.90388674, 'recall': 0.8424017, 'specificity': 0.8424017, 'f1': 0.87041473, 'auroc': 0.9843663, 'binary_precision': 0.81825656, 'binary_recall': 0.6900139, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.7486832}
confusion matrix:
       0    1
0  42193  221
1    447  995
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.8857484, 'recall': 0.8235458, 'specificity': 0.8235458, 'f1': 0.85168076, 'auroc': 0.98040915, 'binary_precision': 0.78431374, 'binary_recall': 0.653789, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.71312803}
confusion matrix:
       0    1
0  17946  121
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7728294, 'recall': 0.5521644, 'specificity': 0.5521644, 'f1': 0.5804993, 'auroc': 0.9538876, 'binary_precision': 0.5833333, 'binary_recall': 0.10769231, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5926  20
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 10,now: 2024-05-30 09:39:37.763754,epoch time: 0:29:06.730904,used: 4:58:54.612985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9843351, 'precision': 0.88895965, 'recall': 0.8552408, 'specificity': 0.8552408, 'f1': 0.87127435, 'auroc': 0.98452044, 'binary_precision': 0.7875095, 'binary_recall': 0.7170596, 'binary_specificity': 0.993422, 'binary_f1_score': 0.7506352}
confusion matrix:
       0     1
0  42135   279
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.9828709, 'precision': 0.91026974, 'recall': 0.8244591, 'specificity': 0.8244591, 'f1': 0.8619373, 'auroc': 0.97830987, 'binary_precision': 0.8333333, 'binary_recall': 0.653789, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7327227}
confusion matrix:
       0    1
0  17979   88
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81841445, 'recall': 0.5922126, 'specificity': 0.5922126, 'f1': 0.6374195, 'auroc': 0.9643096, 'binary_precision': 0.6712329, 'binary_recall': 0.18846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.29429433}
confusion matrix:
      0   1
0  5922  24
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 11,now: 2024-05-30 10:08:41.474578,epoch time: 0:29:03.710824,used: 5:27:58.323809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.983081, 'precision': 0.85493034, 'recall': 0.8961265, 'specificity': 0.8961265, 'f1': 0.8742963, 'auroc': 0.98470074, 'binary_precision': 0.71658415, 'binary_recall': 0.8030513, 'binary_specificity': 0.98920166, 'binary_f1_score': 0.7573577}
confusion matrix:
       0     1
0  41956   458
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.9802028, 'precision': 0.85751224, 'recall': 0.85597765, 'specificity': 0.85597765, 'f1': 0.8567431, 'auroc': 0.9790491, 'binary_precision': 0.72537315, 'binary_recall': 0.72213966, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.72375274}
confusion matrix:
       0    1
0  17883  184
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7512697, 'recall': 0.73272145, 'specificity': 0.73272145, 'f1': 0.74159026, 'auroc': 0.94384927, 'binary_precision': 0.525, 'binary_recall': 0.4846154, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.50399995}
confusion matrix:
      0    1
0  5832  114
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9802027940750122, best validation acc: 0.982870876789093, corresponding to test acc:                         0.9621334075927734 / 0.9651950001716614
after epoch: 12,now: 2024-05-30 10:37:41.293477,epoch time: 0:28:59.818899,used: 5:56:58.142708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9847455, 'precision': 0.87234104, 'recall': 0.8959822, 'specificity': 0.8959822, 'f1': 0.88376635, 'auroc': 0.9885316, 'binary_precision': 0.7514639, 'binary_recall': 0.80097085, 'binary_specificity': 0.99099356, 'binary_f1_score': 0.77542806}
confusion matrix:
       0     1
0  42032   382
1    287  1155
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.89845204, 'recall': 0.86815006, 'specificity': 0.86815006, 'f1': 0.8826492, 'auroc': 0.98124164, 'binary_precision': 0.8064516, 'binary_recall': 0.74294204, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.7733952}
confusion matrix:
       0    1
0  17947  120
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8168719, 'recall': 0.64479744, 'specificity': 0.64479744, 'f1': 0.6955649, 'auroc': 0.9580935, 'binary_precision': 0.6637931, 'binary_recall': 0.29615384, 'binary_specificity': 0.993441, 'binary_f1_score': 0.40957448}
confusion matrix:
      0   1
0  5907  39
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 13,now: 2024-05-30 11:06:45.232518,epoch time: 0:29:03.939041,used: 6:26:02.081749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98638725, 'precision': 0.93205315, 'recall': 0.8401144, 'specificity': 0.8401144, 'f1': 0.88021064, 'auroc': 0.98870647, 'binary_precision': 0.874778, 'binary_recall': 0.6835531, 'binary_specificity': 0.9966757, 'binary_f1_score': 0.7674328}
confusion matrix:
       0    1
0  42274  141
1    456  985
---- Validation: 
scalar performance:
{'acc': 0.9804696, 'precision': 0.90584683, 'recall': 0.78601986, 'specificity': 0.78601986, 'f1': 0.83471876, 'auroc': 0.9798792, 'binary_precision': 0.8272921, 'binary_recall': 0.576523, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.67950964}
confusion matrix:
       0    1
0  17986   81
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7887046, 'recall': 0.6140282, 'specificity': 0.6140282, 'f1': 0.6595706, 'auroc': 0.96418476, 'binary_precision': 0.61, 'binary_recall': 0.23461539, 'binary_specificity': 0.993441, 'binary_f1_score': 0.33888888}
confusion matrix:
      0   1
0  5907  39
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9804695844650269, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9642281532287598 / 0.9651950001716614
after epoch: 14,now: 2024-05-30 11:35:46.278996,epoch time: 0:29:01.046478,used: 6:55:03.128227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98248816, 'precision': 0.9747552, 'recall': 0.741742, 'specificity': 0.741742, 'f1': 0.81806207, 'auroc': 0.9872, 'binary_precision': 0.966759, 'binary_recall': 0.48404992, 'binary_specificity': 0.9994342, 'binary_f1_score': 0.6451016}
confusion matrix:
       0    1
0  42390   24
1    744  698
---- Validation: 
scalar performance:
{'acc': 0.9763074, 'precision': 0.9529162, 'recall': 0.6837238, 'specificity': 0.6837238, 'f1': 0.7577542, 'auroc': 0.978836, 'binary_precision': 0.92883897, 'binary_recall': 0.36849925, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.52765954}
confusion matrix:
       0    1
0  18048   19
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.9568488, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9763073921203613, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9642281532287598 / 0.9651950001716614
after epoch: 15,now: 2024-05-30 12:04:00.913064,epoch time: 0:28:14.634068,used: 7:23:17.762295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98757297, 'precision': 0.89901364, 'recall': 0.9078275, 'specificity': 0.9078275, 'f1': 0.9033685, 'auroc': 0.990547, 'binary_precision': 0.8040678, 'binary_recall': 0.8224688, 'binary_specificity': 0.99318624, 'binary_f1_score': 0.81316423}
confusion matrix:
       0     1
0  42125   289
1    256  1186
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.88792497, 'recall': 0.8823724, 'specificity': 0.8823724, 'f1': 0.8851268, 'auroc': 0.9833231, 'binary_precision': 0.78431374, 'binary_recall': 0.7726597, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.7784431}
confusion matrix:
       0    1
0  17924  143
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8312217, 'recall': 0.62824655, 'specificity': 0.62824655, 'f1': 0.6807356, 'auroc': 0.9640042, 'binary_precision': 0.6938776, 'binary_recall': 0.26153848, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.37988827}
confusion matrix:
      0   1
0  5916  30
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.984204888343811, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9642281532287598 / 0.9651950001716614
after epoch: 16,now: 2024-05-30 12:32:36.488111,epoch time: 0:28:35.575047,used: 7:51:53.337342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9870485, 'precision': 0.90506244, 'recall': 0.8871243, 'specificity': 0.8871243, 'f1': 0.89587396, 'auroc': 0.98840237, 'binary_precision': 0.8175872, 'binary_recall': 0.78016645, 'binary_specificity': 0.99408215, 'binary_f1_score': 0.7984386}
confusion matrix:
       0     1
0  42163   251
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.9836179, 'precision': 0.9007175, 'recall': 0.8505962, 'specificity': 0.8505962, 'f1': 0.87384, 'auroc': 0.9794105, 'binary_precision': 0.8122867, 'binary_recall': 0.7072808, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.75615567}
confusion matrix:
       0    1
0  17957  110
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8212372, 'recall': 0.7144376, 'specificity': 0.7144376, 'f1': 0.75602937, 'auroc': 0.9610983, 'binary_precision': 0.6666667, 'binary_recall': 0.43846154, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.5290023}
confusion matrix:
      0    1
0  5889   57
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
early stop counter: 4
val acc:0.983617901802063, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9642281532287598 / 0.9672897458076477
after epoch: 17,now: 2024-05-30 13:01:11.401728,epoch time: 0:28:34.913617,used: 8:20:28.250959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878238, 'precision': 0.8934046, 'recall': 0.923365, 'specificity': 0.923365, 'f1': 0.9077889, 'auroc': 0.989691, 'binary_precision': 0.7917738, 'binary_recall': 0.8543689, 'binary_specificity': 0.992361, 'binary_f1_score': 0.8218813}
confusion matrix:
       0     1
0  42090   324
1    210  1232
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.88689685, 'recall': 0.88966346, 'specificity': 0.88966346, 'f1': 0.8882748, 'auroc': 0.98383987, 'binary_precision': 0.7817109, 'binary_recall': 0.78751856, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.78460395}
confusion matrix:
       0    1
0  17919  148
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8025978, 'recall': 0.6312518, 'specificity': 0.6312518, 'f1': 0.6796393, 'auroc': 0.9574701, 'binary_precision': 0.6363636, 'binary_recall': 0.26923078, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.3783784}
confusion matrix:
      0   1
0  5906  40
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 18,now: 2024-05-30 13:29:41.722278,epoch time: 0:28:30.320550,used: 8:48:58.571509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9892147, 'precision': 0.90956146, 'recall': 0.92408407, 'specificity': 0.92408407, 'f1': 0.91668594, 'auroc': 0.99071926, 'binary_precision': 0.8240803, 'binary_recall': 0.8543689, 'binary_specificity': 0.9937992, 'binary_f1_score': 0.83895135}
confusion matrix:
       0     1
0  42151   263
1    210  1232
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.8792915, 'recall': 0.89662236, 'specificity': 0.89662236, 'f1': 0.8877451, 'auroc': 0.9830875, 'binary_precision': 0.7659575, 'binary_recall': 0.8023774, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.7837446}
confusion matrix:
       0    1
0  17902  165
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8073592, 'recall': 0.6463841, 'specificity': 0.6463841, 'f1': 0.69537354, 'auroc': 0.95919573, 'binary_precision': 0.6446281, 'binary_recall': 0.3, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.40944883}
confusion matrix:
      0   1
0  5903  43
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9840981960296631, best validation acc: 0.9844717383384705, corresponding to test acc:                         0.9629390835762024 / 0.9672897458076477
after epoch: 19,now: 2024-05-30 13:58:31.283096,epoch time: 0:28:49.560818,used: 9:17:48.132327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9881886, 'precision': 0.96306753, 'recall': 0.8428302, 'specificity': 0.8428302, 'f1': 0.8933605, 'auroc': 0.99181557, 'binary_precision': 0.936673, 'binary_recall': 0.68723994, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.7928}
confusion matrix:
       0    1
0  42347   67
1    451  991
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.9517108, 'recall': 0.79249346, 'specificity': 0.79249346, 'f1': 0.853812, 'auroc': 0.98253703, 'binary_precision': 0.9186047, 'binary_recall': 0.5869242, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.7162284}
confusion matrix:
       0    1
0  18032   35
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.82588905, 'recall': 0.51697135, 'specificity': 0.51697135, 'f1': 0.5224637, 'auroc': 0.9574285, 'binary_precision': 0.6923077, 'binary_recall': 0.034615386, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.06593407}
confusion matrix:
      0  1
0  5942  4
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9832977652549744, best validation acc: 0.9844717383384705, corresponding to test acc:                         0.9629390835762024 / 0.9672897458076477
after epoch: 20,now: 2024-05-30 14:27:07.539069,epoch time: 0:28:36.255973,used: 9:46:24.388300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98882705, 'precision': 0.91303456, 'recall': 0.9108205, 'specificity': 0.9108205, 'f1': 0.9119243, 'auroc': 0.9916916, 'binary_precision': 0.8319386, 'binary_recall': 0.82732314, 'binary_specificity': 0.9943179, 'binary_f1_score': 0.8296245}
confusion matrix:
       0     1
0  42173   241
1    249  1193
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.91148984, 'recall': 0.8576424, 'specificity': 0.8576424, 'f1': 0.88252044, 'auroc': 0.982496, 'binary_precision': 0.8333333, 'binary_recall': 0.7206538, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.7729084}
confusion matrix:
       0    1
0  17970   97
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7866966, 'recall': 0.57289773, 'specificity': 0.57289773, 'f1': 0.610195, 'auroc': 0.94903684, 'binary_precision': 0.609375, 'binary_recall': 0.15, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.24074076}
confusion matrix:
      0   1
0  5921  25
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 21,now: 2024-05-30 14:56:05.734633,epoch time: 0:28:58.195564,used: 10:15:22.583864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98887265, 'precision': 0.9631198, 'recall': 0.8542372, 'specificity': 0.8542372, 'f1': 0.90092087, 'auroc': 0.9917792, 'binary_precision': 0.93601465, 'binary_recall': 0.71012485, 'binary_specificity': 0.9983496, 'binary_f1_score': 0.807571}
confusion matrix:
       0     1
0  42344    70
1    418  1024
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9409758, 'recall': 0.8114225, 'specificity': 0.8114225, 'f1': 0.8641872, 'auroc': 0.98145664, 'binary_precision': 0.8957447, 'binary_recall': 0.6255572, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.7366579}
confusion matrix:
       0    1
0  18018   49
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8693441, 'recall': 0.5968156, 'specificity': 0.5968156, 'f1': 0.6471748, 'auroc': 0.9604125, 'binary_precision': 0.77272725, 'binary_recall': 0.19615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.3128834}
confusion matrix:
      0   1
0  5931  15
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9839380979537964, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9603609442710876 / 0.9672897458076477
after epoch: 22,now: 2024-05-30 15:24:38.636080,epoch time: 0:28:32.901447,used: 10:43:55.485311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9887131, 'precision': 0.9366428, 'recall': 0.87751764, 'specificity': 0.87751764, 'f1': 0.904773, 'auroc': 0.9923564, 'binary_precision': 0.8814516, 'binary_recall': 0.75850105, 'binary_specificity': 0.9965342, 'binary_f1_score': 0.8153674}
confusion matrix:
       0     1
0  42268   147
1    348  1093
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.9293202, 'recall': 0.8295256, 'specificity': 0.8295256, 'f1': 0.8723349, 'auroc': 0.9811803, 'binary_precision': 0.87109375, 'binary_recall': 0.6627043, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.7527426}
confusion matrix:
       0    1
0  18001   66
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.84371805, 'recall': 0.6530783, 'specificity': 0.6530783, 'f1': 0.708395, 'auroc': 0.95718944, 'binary_precision': 0.71681416, 'binary_recall': 0.31153846, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.43431637}
confusion matrix:
      0   1
0  5914  32
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9843649864196777, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9603609442710876 / 0.9672897458076477
after epoch: 23,now: 2024-05-30 15:53:10.160908,epoch time: 0:28:31.524828,used: 11:12:27.010139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9889183, 'precision': 0.9708159, 'recall': 0.84856665, 'specificity': 0.84856665, 'f1': 0.8999483, 'auroc': 0.9938961, 'binary_precision': 0.9517958, 'binary_recall': 0.69833565, 'binary_specificity': 0.9987976, 'binary_f1_score': 0.80560005}
confusion matrix:
       0     1
0  42363    51
1    435  1007
---- Validation: 
scalar performance:
{'acc': 0.9828709, 'precision': 0.9433185, 'recall': 0.7922721, 'specificity': 0.7922721, 'f1': 0.85112244, 'auroc': 0.981479, 'binary_precision': 0.9018265, 'binary_recall': 0.5869242, 'binary_specificity': 0.99762, 'binary_f1_score': 0.7110711}
confusion matrix:
       0    1
0  18024   43
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8431494, 'recall': 0.57373863, 'specificity': 0.57373863, 'f1': 0.6144501, 'auroc': 0.9617151, 'binary_precision': 0.7222222, 'binary_recall': 0.15, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.24840766}
confusion matrix:
      0   1
0  5931  15
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.982870876789093, best validation acc: 0.9847918748855591, corresponding to test acc:                         0.9603609442710876 / 0.9672897458076477
after epoch: 24,now: 2024-05-30 16:21:48.656869,epoch time: 0:28:38.495961,used: 11:41:05.506100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9908108, 'precision': 0.9407351, 'recall': 0.9108413, 'specificity': 0.9108413, 'f1': 0.9252235, 'auroc': 0.9930923, 'binary_precision': 0.88739747, 'binary_recall': 0.8252427, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.85519224}
confusion matrix:
       0     1
0  42263   151
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.98521876, 'precision': 0.9251325, 'recall': 0.84856534, 'specificity': 0.84856534, 'f1': 0.88274866, 'auroc': 0.9836392, 'binary_precision': 0.8613139, 'binary_recall': 0.7013373, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7731368}
confusion matrix:
       0    1
0  17991   76
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.85762924, 'recall': 0.62315, 'specificity': 0.62315, 'f1': 0.67832696, 'auroc': 0.9545279, 'binary_precision': 0.74712646, 'binary_recall': 0.25, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.37463978}
confusion matrix:
      0   1
0  5924  22
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 25,now: 2024-05-30 16:50:41.821494,epoch time: 0:28:53.164625,used: 12:09:58.670725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9916089, 'precision': 0.94312227, 'recall': 0.9223073, 'specificity': 0.9223073, 'f1': 0.9324454, 'auroc': 0.99439204, 'binary_precision': 0.89139944, 'binary_recall': 0.8481276, 'binary_specificity': 0.996487, 'binary_f1_score': 0.8692254}
confusion matrix:
       0     1
0  42265   149
1    219  1223
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9226716, 'recall': 0.85880053, 'specificity': 0.85880053, 'f1': 0.8879082, 'auroc': 0.9850049, 'binary_precision': 0.8556338, 'binary_recall': 0.72213966, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7832393}
confusion matrix:
       0    1
0  17985   82
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8634312, 'recall': 0.619472, 'specificity': 0.619472, 'f1': 0.6746835, 'auroc': 0.9469272, 'binary_precision': 0.7590361, 'binary_recall': 0.2423077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.36734694}
confusion matrix:
      0   1
0  5926  20
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 26,now: 2024-05-30 17:19:30.202862,epoch time: 0:28:48.381368,used: 12:38:47.052093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.9463556, 'recall': 0.915179, 'specificity': 0.915179, 'f1': 0.93016064, 'auroc': 0.9947107, 'binary_precision': 0.8983558, 'binary_recall': 0.8335645, 'binary_specificity': 0.9967935, 'binary_f1_score': 0.8647483}
confusion matrix:
       0     1
0  42278   136
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.93628204, 'recall': 0.85263985, 'specificity': 0.85263985, 'f1': 0.8896692, 'auroc': 0.98685575, 'binary_precision': 0.8833333, 'binary_recall': 0.7087667, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7864798}
confusion matrix:
       0    1
0  18004   63
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8348024, 'recall': 0.58117867, 'specificity': 0.58117867, 'f1': 0.62423843, 'auroc': 0.95072544, 'binary_precision': 0.704918, 'binary_recall': 0.16538462, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.26791278}
confusion matrix:
      0   1
0  5928  18
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 27,now: 2024-05-30 17:48:06.721224,epoch time: 0:28:36.518362,used: 13:07:23.570455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9913353, 'precision': 0.9341017, 'recall': 0.9288649, 'specificity': 0.9288649, 'f1': 0.93146616, 'auroc': 0.9950068, 'binary_precision': 0.8728933, 'binary_recall': 0.86199725, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.867411}
confusion matrix:
       0     1
0  42233   181
1    199  1243
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.91153795, 'recall': 0.8701618, 'specificity': 0.8701618, 'f1': 0.88966036, 'auroc': 0.98414814, 'binary_precision': 0.83250415, 'binary_recall': 0.7459138, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.7868338}
confusion matrix:
       0    1
0  17966  101
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8042145, 'recall': 0.61068654, 'specificity': 0.61068654, 'f1': 0.65791214, 'auroc': 0.9518142, 'binary_precision': 0.6413044, 'binary_recall': 0.22692308, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.33522728}
confusion matrix:
      0   1
0  5913  33
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9854856133460999, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9672897458076477
after epoch: 28,now: 2024-05-30 18:16:47.913939,epoch time: 0:28:41.192715,used: 13:36:04.763170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9904004, 'precision': 0.96037805, 'recall': 0.88249314, 'specificity': 0.88249314, 'f1': 0.91757905, 'auroc': 0.99515224, 'binary_precision': 0.9286314, 'binary_recall': 0.7669903, 'binary_specificity': 0.997996, 'binary_f1_score': 0.84010637}
confusion matrix:
       0     1
0  42329    85
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9226238, 'recall': 0.8256172, 'specificity': 0.8256172, 'f1': 0.8673229, 'auroc': 0.9848529, 'binary_precision': 0.8579767, 'binary_recall': 0.65527487, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.7430497}
confusion matrix:
       0    1
0  17994   73
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8908384, 'recall': 0.600914, 'specificity': 0.600914, 'f1': 0.65401757, 'auroc': 0.9559418, 'binary_precision': 0.8153846, 'binary_recall': 0.20384616, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.3261538}
confusion matrix:
      0   1
0  5934  12
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9837246537208557, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9672897458076477
after epoch: 29,now: 2024-05-30 18:45:26.443039,epoch time: 0:28:38.529100,used: 14:04:43.292270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918369, 'precision': 0.9235755, 'recall': 0.95357573, 'specificity': 0.95357573, 'f1': 0.93802094, 'auroc': 0.9961163, 'binary_precision': 0.8501292, 'binary_recall': 0.9126214, 'binary_specificity': 0.9945301, 'binary_f1_score': 0.8802675}
confusion matrix:
       0     1
0  42182   232
1    126  1316
---- Validation: 
scalar performance:
{'acc': 0.9859125, 'precision': 0.89537346, 'recall': 0.90328544, 'specificity': 0.90328544, 'f1': 0.89928675, 'auroc': 0.9863208, 'binary_precision': 0.797671, 'binary_recall': 0.8142645, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.80588233}
confusion matrix:
       0    1
0  17928  139
1    125  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.84692055, 'recall': 0.6531624, 'specificity': 0.6531624, 'f1': 0.709021, 'auroc': 0.9503758, 'binary_precision': 0.72321427, 'binary_recall': 0.31153846, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.43548387}
confusion matrix:
      0   1
0  5915  31
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9859125018119812, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9621334075927734 / 0.9672897458076477
after epoch: 30,now: 2024-05-30 19:14:14.643211,epoch time: 0:28:48.200172,used: 14:33:31.492442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_04_40_43_seed_1_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:33:31.492442 at 2024-05-30 19:14:14.643211
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.8452095, 'recall': 0.59455615, 'specificity': 0.59455615, 'f1': 0.64249957, 'auroc': 0.94778955, 'binary_precision': 0.7246377, 'binary_recall': 0.1923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.30395138}
confusion matrix:
      0   1
0  5927  19
1   210  50
oracle model performance metric: 

scalar performance:
{'acc': 0.9663229, 'precision': 0.8138452, 'recall': 0.70473814, 'specificity': 0.70473814, 'f1': 0.74655, 'auroc': 0.9627032, 'binary_precision': 0.6526946, 'binary_recall': 0.41923076, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5105386}
confusion matrix:
      0    1
0  5888   58
1   151  109
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28046 MiB |  13568 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446689 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |  11572 KiB |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395728 K  |  395724 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190048 K  |  190044 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395728 K  |  395724 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190048 K  |  190044 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1208    |     573    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2807    |  260324 K  |  260324 K  |
|       from large pool |      38    |     605    |  162402 K  |  162402 K  |
|       from small pool |      44    |    2769    |   97921 K  |   97921 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  260325 K  |  260325 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2769    |   97922 K  |   97922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  260325 K  |  260325 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2769    |   97922 K  |   97922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750

 Experiment start at: 2024-05-30 19:24:23.534418
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96914935, 'precision': 0.77007246, 'recall': 0.75108844, 'specificity': 0.75108844, 'f1': 0.7601975, 'auroc': 0.9499682, 'binary_precision': 0.55737704, 'binary_recall': 0.5168539, 'binary_specificity': 0.98532295, 'binary_f1_score': 0.5363512}
confusion matrix:
       0    1
0  41690  621
1    731  782
---- Validation: 
scalar performance:
{'acc': 0.97048956, 'precision': 0.7653098, 'recall': 0.7181438, 'specificity': 0.7181438, 'f1': 0.73920166, 'auroc': 0.93853474, 'binary_precision': 0.5487805, 'binary_recall': 0.44850498, 'binary_specificity': 0.9877827, 'binary_f1_score': 0.49360147}
confusion matrix:
       0    1
0  17949  222
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.8492805, 'recall': 0.6810496, 'specificity': 0.6810496, 'f1': 0.73611665, 'auroc': 0.9344526, 'binary_precision': 0.72357726, 'binary_recall': 0.3677686, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.48767126}
confusion matrix:
      0   1
0  5963  34
1   153  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 19:54:07.921575,epoch time: 0:29:44.387157,used: 0:29:44.387157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9729828, 'precision': 0.8276972, 'recall': 0.70527595, 'specificity': 0.70527595, 'f1': 0.7512216, 'auroc': 0.9612638, 'binary_precision': 0.6759358, 'binary_recall': 0.41771317, 'binary_specificity': 0.99283874, 'binary_f1_score': 0.5163399}
confusion matrix:
       0    1
0  42008  303
1    881  632
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.7999556, 'recall': 0.63348854, 'specificity': 0.63348854, 'f1': 0.68227553, 'auroc': 0.9442148, 'binary_precision': 0.62357414, 'binary_recall': 0.27242523, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.37919074}
confusion matrix:
       0    1
0  18072   99
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.861293, 'recall': 0.59990567, 'specificity': 0.59990567, 'f1': 0.65102315, 'auroc': 0.94057375, 'binary_precision': 0.75384617, 'binary_recall': 0.20247933, 'binary_specificity': 0.997332, 'binary_f1_score': 0.31921822}
confusion matrix:
      0   1
0  5981  16
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 2,now: 2024-05-30 20:23:02.007278,epoch time: 0:28:54.085703,used: 0:58:38.472860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9755157, 'precision': 0.814602, 'recall': 0.8232143, 'specificity': 0.8232143, 'f1': 0.8188442, 'auroc': 0.9691437, 'binary_precision': 0.6413882, 'binary_recall': 0.65961665, 'binary_specificity': 0.98681194, 'binary_f1_score': 0.65037465}
confusion matrix:
       0    1
0  41753  558
1    515  998
---- Validation: 
scalar performance:
{'acc': 0.974964, 'precision': 0.8091414, 'recall': 0.7541833, 'specificity': 0.7541833, 'f1': 0.7787451, 'auroc': 0.95728296, 'binary_precision': 0.63414633, 'binary_recall': 0.5182724, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.5703839}
confusion matrix:
       0    1
0  17991  180
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.83078766, 'recall': 0.7068252, 'specificity': 0.7068252, 'f1': 0.753134, 'auroc': 0.9445451, 'binary_precision': 0.68456376, 'binary_recall': 0.4214876, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.5217392}
confusion matrix:
      0    1
0  5950   47
1   140  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 3,now: 2024-05-30 20:51:49.598128,epoch time: 0:28:47.590850,used: 1:27:26.063710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9790754, 'precision': 0.8846207, 'recall': 0.7683377, 'specificity': 0.7683377, 'f1': 0.8153, 'auroc': 0.97412485, 'binary_precision': 0.7854406, 'binary_recall': 0.5419696, 'binary_specificity': 0.99470586, 'binary_f1_score': 0.6413766}
confusion matrix:
       0    1
0  42087  224
1    693  820
---- Validation: 
scalar performance:
{'acc': 0.9765621, 'precision': 0.8940458, 'recall': 0.6747039, 'specificity': 0.6747039, 'f1': 0.73937285, 'auroc': 0.9595175, 'binary_precision': 0.8091603, 'binary_recall': 0.35215947, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.49074072}
confusion matrix:
       0    1
0  18121   50
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.9284116, 'recall': 0.6130527, 'specificity': 0.6130527, 'f1': 0.67295325, 'auroc': 0.9496172, 'binary_precision': 0.88709676, 'binary_recall': 0.22727273, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.3618421}
confusion matrix:
      0   1
0  5990   7
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 4,now: 2024-05-30 21:20:38.574828,epoch time: 0:28:48.976700,used: 1:56:15.040410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97766066, 'precision': 0.8302608, 'recall': 0.83930176, 'specificity': 0.83930176, 'f1': 0.8347143, 'auroc': 0.9758351, 'binary_precision': 0.67159384, 'binary_recall': 0.69068074, 'binary_specificity': 0.9879228, 'binary_f1_score': 0.6810036}
confusion matrix:
       0     1
0  41800   511
1    468  1045
---- Validation: 
scalar performance:
{'acc': 0.97784054, 'precision': 0.84515274, 'recall': 0.7612905, 'specificity': 0.7612905, 'f1': 0.79695666, 'auroc': 0.9587957, 'binary_precision': 0.7057522, 'binary_recall': 0.5299003, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.6053131}
confusion matrix:
       0    1
0  18038  133
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.93644094, 'recall': 0.68098444, 'specificity': 0.68098444, 'f1': 0.7520679, 'auroc': 0.95253277, 'binary_precision': 0.8979592, 'binary_recall': 0.36363637, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5176471}
confusion matrix:
      0   1
0  5987  10
1   154  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-30 21:49:34.964982,epoch time: 0:28:56.390154,used: 2:25:11.430564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820418, 'precision': 0.87382066, 'recall': 0.84826237, 'specificity': 0.84826237, 'f1': 0.8605494, 'auroc': 0.97942233, 'binary_precision': 0.75817925, 'binary_recall': 0.70456046, 'binary_specificity': 0.9919643, 'binary_f1_score': 0.73038715}
confusion matrix:
       0     1
0  41971   340
1    447  1066
---- Validation: 
scalar performance:
{'acc': 0.982315, 'precision': 0.8987138, 'recall': 0.7901025, 'specificity': 0.7901025, 'f1': 0.83522165, 'auroc': 0.971132, 'binary_precision': 0.8110599, 'binary_recall': 0.58471763, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.6795367}
confusion matrix:
       0    1
0  18089   82
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.8564281, 'recall': 0.68328243, 'specificity': 0.68328243, 'f1': 0.73965824, 'auroc': 0.94880086, 'binary_precision': 0.73770493, 'binary_recall': 0.37190083, 'binary_specificity': 0.994664, 'binary_f1_score': 0.4945055}
confusion matrix:
      0   1
0  5965  32
1   152  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 6,now: 2024-05-30 22:18:35.384539,epoch time: 0:29:00.419557,used: 2:54:11.850121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98163104, 'precision': 0.8628776, 'recall': 0.86079574, 'specificity': 0.86079574, 'f1': 0.8618334, 'auroc': 0.9805503, 'binary_precision': 0.73537236, 'binary_recall': 0.73099804, 'binary_specificity': 0.99059343, 'binary_f1_score': 0.7331787}
confusion matrix:
       0     1
0  41913   398
1    407  1106
---- Validation: 
scalar performance:
{'acc': 0.97645557, 'precision': 0.80094206, 'recall': 0.858547, 'specificity': 0.858547, 'f1': 0.8269803, 'auroc': 0.9700084, 'binary_precision': 0.6108033, 'binary_recall': 0.73255813, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.66616315}
confusion matrix:
       0    1
0  17890  281
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.85235536, 'recall': 0.63436264, 'specificity': 0.63436264, 'f1': 0.690562, 'auroc': 0.9550126, 'binary_precision': 0.73333335, 'binary_recall': 0.27272728, 'binary_specificity': 0.995998, 'binary_f1_score': 0.39759037}
confusion matrix:
      0   1
0  5973  24
1   176  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.976455569267273, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 7,now: 2024-05-30 22:47:33.419971,epoch time: 0:28:58.035432,used: 3:23:09.885553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97900695, 'precision': 0.8237103, 'recall': 0.90946513, 'specificity': 0.90946513, 'f1': 0.8610488, 'auroc': 0.9810523, 'binary_precision': 0.6533885, 'binary_recall': 0.8347654, 'binary_specificity': 0.9841649, 'binary_f1_score': 0.7330237}
confusion matrix:
       0     1
0  41641   670
1    250  1263
---- Validation: 
scalar performance:
{'acc': 0.9790124, 'precision': 0.8165592, 'recall': 0.8871714, 'specificity': 0.8871714, 'f1': 0.8479809, 'auroc': 0.9745387, 'binary_precision': 0.64016175, 'binary_recall': 0.7890366, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.7068453}
confusion matrix:
       0    1
0  17904  267
1    127  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7590482, 'recall': 0.76520526, 'specificity': 0.76520526, 'f1': 0.76208586, 'auroc': 0.9425136, 'binary_precision': 0.53629035, 'binary_recall': 0.5495868, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.5428571}
confusion matrix:
      0    1
0  5882  115
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9790124297142029, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 8,now: 2024-05-30 23:16:41.018742,epoch time: 0:29:07.598771,used: 3:52:17.484324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9844606, 'precision': 0.93746877, 'recall': 0.8131887, 'specificity': 0.8131887, 'f1': 0.8642756, 'auroc': 0.9831388, 'binary_precision': 0.8880597, 'binary_recall': 0.6292135, 'binary_specificity': 0.99716383, 'binary_f1_score': 0.736557}
confusion matrix:
       0    1
0  42191  120
1    561  952
---- Validation: 
scalar performance:
{'acc': 0.9817291, 'precision': 0.91228116, 'recall': 0.7641022, 'specificity': 0.7641022, 'f1': 0.8208436, 'auroc': 0.9683086, 'binary_precision': 0.839895, 'binary_recall': 0.53156143, 'binary_specificity': 0.996643, 'binary_f1_score': 0.65106815}
confusion matrix:
       0    1
0  18110   61
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.89909047, 'recall': 0.5901587, 'specificity': 0.5901587, 'f1': 0.6406571, 'auroc': 0.9458326, 'binary_precision': 0.8301887, 'binary_recall': 0.18181819, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2983051}
confusion matrix:
      0   1
0  5988   9
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9817290902137756, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 9,now: 2024-05-30 23:45:30.270400,epoch time: 0:28:49.251658,used: 4:21:06.735982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.982019, 'precision': 0.8470684, 'recall': 0.9129369, 'specificity': 0.9129369, 'f1': 0.8768668, 'auroc': 0.9843275, 'binary_precision': 0.69994485, 'binary_recall': 0.838731, 'binary_specificity': 0.9871428, 'binary_f1_score': 0.7630788}
confusion matrix:
       0     1
0  41767   544
1    244  1269
---- Validation: 
scalar performance:
{'acc': 0.97725457, 'precision': 0.80531484, 'recall': 0.8710054, 'specificity': 0.8710054, 'f1': 0.834656, 'auroc': 0.9699702, 'binary_precision': 0.6187246, 'binary_recall': 0.7574751, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.6811053}
confusion matrix:
       0    1
0  17890  281
1    146  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.86473536, 'recall': 0.71609014, 'specificity': 0.71609014, 'f1': 0.7696934, 'auroc': 0.9433813, 'binary_precision': 0.75177306, 'binary_recall': 0.43801653, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5535248}
confusion matrix:
      0    1
0  5962   35
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 4
val acc:0.9772545695304871, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 10,now: 2024-05-31 00:14:21.913224,epoch time: 0:28:51.642824,used: 4:49:58.378806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98306865, 'precision': 0.8713136, 'recall': 0.8765169, 'specificity': 0.8765169, 'f1': 0.87389547, 'auroc': 0.9845873, 'binary_precision': 0.75114006, 'binary_recall': 0.76206213, 'binary_specificity': 0.9909716, 'binary_f1_score': 0.7565617}
confusion matrix:
       0     1
0  41929   382
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.9801843, 'precision': 0.8437238, 'recall': 0.83156335, 'specificity': 0.83156335, 'f1': 0.83752465, 'auroc': 0.97152966, 'binary_precision': 0.69827586, 'binary_recall': 0.67275745, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.6852792}
confusion matrix:
       0    1
0  17996  175
1    197  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.84983456, 'recall': 0.6770007, 'specificity': 0.6770007, 'f1': 0.73257315, 'auroc': 0.93438506, 'binary_precision': 0.725, 'binary_recall': 0.35950413, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.480663}
confusion matrix:
      0   1
0  5964  33
1   155  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 5
val acc:0.9801843166351318, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 11,now: 2024-05-31 00:43:22.213911,epoch time: 0:29:00.300687,used: 5:18:58.679493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9808324, 'precision': 0.8702178, 'recall': 0.827561, 'specificity': 0.827561, 'f1': 0.8474718, 'auroc': 0.98358583, 'binary_precision': 0.7524381, 'binary_recall': 0.66292137, 'binary_specificity': 0.9922006, 'binary_f1_score': 0.70484895}
confusion matrix:
       0     1
0  41981   330
1    510  1003
---- Validation: 
scalar performance:
{'acc': 0.98061043, 'precision': 0.8683049, 'recall': 0.7932372, 'specificity': 0.7932372, 'f1': 0.82617813, 'auroc': 0.973371, 'binary_precision': 0.75, 'binary_recall': 0.59302324, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.6623376}
confusion matrix:
       0    1
0  18052  119
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.87056386, 'recall': 0.5285921, 'specificity': 0.5285921, 'f1': 0.54435194, 'auroc': 0.93215513, 'binary_precision': 0.7777778, 'binary_recall': 0.05785124, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1076923}
confusion matrix:
      0   1
0  5993   4
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 6
val acc:0.9806104302406311, best validation acc: 0.9823150038719177, corresponding to test acc:                         0.9705080986022949 / 0.973713755607605
after epoch: 12,now: 2024-05-31 01:12:39.558100,epoch time: 0:29:17.344189,used: 5:48:16.023682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98614913, 'precision': 0.9510356, 'recall': 0.82935846, 'specificity': 0.82935846, 'f1': 0.8800138, 'auroc': 0.9874151, 'binary_precision': 0.9140768, 'binary_recall': 0.66093856, 'binary_specificity': 0.99777836, 'binary_f1_score': 0.7671654}
confusion matrix:
       0     1
0  42217    94
1    513  1000
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.9185449, 'recall': 0.799734, 'specificity': 0.799734, 'f1': 0.8486209, 'auroc': 0.9716538, 'binary_precision': 0.8501171, 'binary_recall': 0.60299003, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.70553935}
confusion matrix:
       0    1
0  18107   64
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.9252586, 'recall': 0.59247494, 'specificity': 0.59247494, 'f1': 0.6452537, 'auroc': 0.94692576, 'binary_precision': 0.88235295, 'binary_recall': 0.18595041, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.30716726}
confusion matrix:
      0   1
0  5991   6
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 13,now: 2024-05-31 01:41:59.635525,epoch time: 0:29:20.077425,used: 6:17:36.101107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9854874, 'precision': 0.87485546, 'recall': 0.9242927, 'specificity': 0.9242927, 'f1': 0.8979026, 'auroc': 0.9882794, 'binary_precision': 0.7547937, 'binary_recall': 0.85855913, 'binary_specificity': 0.99002624, 'binary_f1_score': 0.80333954}
confusion matrix:
       0     1
0  41889   422
1    214  1299
---- Validation: 
scalar performance:
{'acc': 0.9822085, 'precision': 0.8503076, 'recall': 0.8727614, 'specificity': 0.8727614, 'f1': 0.86115533, 'auroc': 0.97297156, 'binary_precision': 0.7087228, 'binary_recall': 0.75581396, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.73151124}
confusion matrix:
       0    1
0  17984  187
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.8823397, 'recall': 0.6185841, 'specificity': 0.6185841, 'f1': 0.6759464, 'auroc': 0.9462004, 'binary_precision': 0.79452056, 'binary_recall': 0.23966943, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.36825398}
confusion matrix:
      0   1
0  5982  15
1   184  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9822084903717041, best validation acc: 0.9838597774505615, corresponding to test acc:                         0.9674627184867859 / 0.973713755607605
after epoch: 14,now: 2024-05-31 02:11:11.805322,epoch time: 0:29:12.169797,used: 6:46:48.270904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9873357, 'precision': 0.90835273, 'recall': 0.89975774, 'specificity': 0.89975774, 'f1': 0.90400565, 'auroc': 0.99014866, 'binary_precision': 0.82364863, 'binary_recall': 0.8056841, 'binary_specificity': 0.9938314, 'binary_f1_score': 0.8145673}
confusion matrix:
       0     1
0  42050   261
1    294  1219
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.8806337, 'recall': 0.86594164, 'specificity': 0.86594164, 'f1': 0.8731314, 'auroc': 0.97872293, 'binary_precision': 0.7698962, 'binary_recall': 0.7392027, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.7542373}
confusion matrix:
       0    1
0  18038  133
1    157  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84695697, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.6392371, 'auroc': 0.9340409, 'binary_precision': 0.7258065, 'binary_recall': 0.18595041, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29605266}
confusion matrix:
      0   1
0  5980  17
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 15,now: 2024-05-31 02:40:14.131201,epoch time: 0:29:02.325879,used: 7:15:50.596783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9863089, 'precision': 0.9429591, 'recall': 0.8392141, 'specificity': 0.8392141, 'f1': 0.8836881, 'auroc': 0.9894501, 'binary_precision': 0.89721256, 'binary_recall': 0.68121696, 'binary_specificity': 0.9972112, 'binary_f1_score': 0.7744361}
confusion matrix:
       0     1
0  42194   118
1    482  1030
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.90598166, 'recall': 0.79937625, 'specificity': 0.79937625, 'f1': 0.8440403, 'auroc': 0.97545034, 'binary_precision': 0.825, 'binary_recall': 0.60299003, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.69673705}
confusion matrix:
       0    1
0  18094   77
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.88620657, 'recall': 0.60842025, 'specificity': 0.60842025, 'f1': 0.66377884, 'auroc': 0.9309822, 'binary_precision': 0.8030303, 'binary_recall': 0.21900827, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.34415585}
confusion matrix:
      0   1
0  5984  13
1   189  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.983167290687561, best validation acc: 0.984552264213562, corresponding to test acc:                         0.9656996130943298 / 0.973713755607605
after epoch: 16,now: 2024-05-31 03:09:23.899892,epoch time: 0:29:09.768691,used: 7:45:00.365474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9884538, 'precision': 0.94428015, 'recall': 0.8742073, 'specificity': 0.8742073, 'f1': 0.9060117, 'auroc': 0.9899961, 'binary_precision': 0.89739543, 'binary_recall': 0.75148714, 'binary_specificity': 0.9969275, 'binary_f1_score': 0.8179856}
confusion matrix:
       0     1
0  42181   130
1    376  1137
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.9106816, 'recall': 0.83165824, 'specificity': 0.83165824, 'f1': 0.86665344, 'auroc': 0.9801041, 'binary_precision': 0.83229816, 'binary_recall': 0.6677741, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.7410138}
confusion matrix:
       0    1
0  18090   81
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.80175245, 'recall': 0.5948563, 'specificity': 0.5948563, 'f1': 0.63960737, 'auroc': 0.9432757, 'binary_precision': 0.6351351, 'binary_recall': 0.19421488, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5970  27
1   195  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 17,now: 2024-05-31 03:38:34.666534,epoch time: 0:29:10.766642,used: 8:14:11.132116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98138005, 'precision': 0.8327323, 'recall': 0.9486137, 'specificity': 0.9486137, 'f1': 0.8811803, 'auroc': 0.99017334, 'binary_precision': 0.6686018, 'binary_recall': 0.91341704, 'binary_specificity': 0.98381037, 'binary_f1_score': 0.772067}
confusion matrix:
       0     1
0  41626   685
1    131  1382
---- Validation: 
scalar performance:
{'acc': 0.97794706, 'precision': 0.8063518, 'recall': 0.89786375, 'specificity': 0.89786375, 'f1': 0.8455676, 'auroc': 0.97733194, 'binary_precision': 0.6189873, 'binary_recall': 0.81229234, 'binary_specificity': 0.98343515, 'binary_f1_score': 0.70258623}
confusion matrix:
       0    1
0  17870  301
1    113  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.7882285, 'recall': 0.6990427, 'specificity': 0.6990427, 'f1': 0.7345861, 'auroc': 0.945348, 'binary_precision': 0.6, 'binary_recall': 0.4090909, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4864865}
confusion matrix:
      0   1
0  5931  66
1   143  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9779470562934875, best validation acc: 0.9850317239761353, corresponding to test acc:                         0.9644173979759216 / 0.973713755607605
after epoch: 18,now: 2024-05-31 04:06:57.174593,epoch time: 0:28:22.508059,used: 8:42:33.640175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98676527, 'precision': 0.9634043, 'recall': 0.82904017, 'specificity': 0.82904017, 'f1': 0.8840134, 'auroc': 0.9914738, 'binary_precision': 0.9388523, 'binary_recall': 0.65961665, 'binary_specificity': 0.99846375, 'binary_f1_score': 0.77484465}
confusion matrix:
       0    1
0  42246   65
1    515  998
---- Validation: 
scalar performance:
{'acc': 0.9832206, 'precision': 0.93597853, 'recall': 0.77210015, 'specificity': 0.77210015, 'f1': 0.8338231, 'auroc': 0.9695748, 'binary_precision': 0.8867925, 'binary_recall': 0.54651165, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.67625904}
confusion matrix:
       0    1
0  18129   42
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.88244486, 'recall': 0.5490865, 'specificity': 0.5490865, 'f1': 0.5790595, 'auroc': 0.9182541, 'binary_precision': 0.8, 'binary_recall': 0.09917355, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.17647058}
confusion matrix:
      0   1
0  5991   6
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9832205772399902, best validation acc: 0.9850317239761353, corresponding to test acc:                         0.9644173979759216 / 0.973713755607605
after epoch: 19,now: 2024-05-31 04:36:35.293451,epoch time: 0:29:38.118858,used: 9:12:11.759033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902793, 'precision': 0.9410638, 'recall': 0.9089298, 'specificity': 0.9089298, 'f1': 0.9243407, 'auroc': 0.9932575, 'binary_precision': 0.8884918, 'binary_recall': 0.8215466, 'binary_specificity': 0.99631304, 'binary_f1_score': 0.8537088}
confusion matrix:
       0     1
0  42155   156
1    270  1243
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.90577376, 'recall': 0.8389132, 'specificity': 0.8389132, 'f1': 0.8691168, 'auroc': 0.97667754, 'binary_precision': 0.822, 'binary_recall': 0.68272424, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.74591655}
confusion matrix:
       0    1
0  18082   89
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.87953883, 'recall': 0.6001558, 'specificity': 0.6001558, 'f1': 0.65272355, 'auroc': 0.9310849, 'binary_precision': 0.7903226, 'binary_recall': 0.20247933, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3223684}
confusion matrix:
      0   1
0  5984  13
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 20,now: 2024-05-31 05:05:01.231612,epoch time: 0:28:25.938161,used: 9:40:37.697194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9863089, 'precision': 0.93531287, 'recall': 0.846967, 'specificity': 0.846967, 'f1': 0.88576686, 'auroc': 0.99269134, 'binary_precision': 0.88137007, 'binary_recall': 0.6972901, 'binary_specificity': 0.9966439, 'binary_f1_score': 0.7785977}
confusion matrix:
       0     1
0  42169   142
1    458  1055
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.91956514, 'recall': 0.81213737, 'specificity': 0.81213737, 'f1': 0.8574041, 'auroc': 0.9717649, 'binary_precision': 0.8513514, 'binary_recall': 0.627907, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.7227534}
confusion matrix:
       0    1
0  18105   66
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.9064968, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.984552264213562, best validation acc: 0.9850849509239197, corresponding to test acc:                         0.9669818878173828 / 0.973713755607605
after epoch: 21,now: 2024-05-31 05:33:31.095935,epoch time: 0:28:29.864323,used: 10:09:07.561517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99016523, 'precision': 0.9606651, 'recall': 0.8859278, 'specificity': 0.8859278, 'f1': 0.91974735, 'auroc': 0.99486315, 'binary_precision': 0.9293651, 'binary_recall': 0.77395904, 'binary_specificity': 0.99789655, 'binary_f1_score': 0.84457266}
confusion matrix:
       0     1
0  42222    89
1    342  1171
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.8979525, 'recall': 0.84852225, 'specificity': 0.84852225, 'f1': 0.87147486, 'auroc': 0.97507846, 'binary_precision': 0.8057143, 'binary_recall': 0.7026578, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.75066555}
confusion matrix:
       0    1
0  18069  102
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.92240614, 'recall': 0.5739633, 'specificity': 0.5739633, 'f1': 0.6185574, 'auroc': 0.9466245, 'binary_precision': 0.8780488, 'binary_recall': 0.14876033, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.25441697}
confusion matrix:
      0   1
0  5992   5
1   206  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9850317239761353, best validation acc: 0.9850849509239197, corresponding to test acc:                         0.9669818878173828 / 0.973713755607605
after epoch: 22,now: 2024-05-31 06:01:56.934561,epoch time: 0:28:25.838626,used: 10:37:33.400143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9907585, 'precision': 0.933141, 'recall': 0.9273411, 'specificity': 0.9273411, 'f1': 0.9302199, 'auroc': 0.9951464, 'binary_precision': 0.8713137, 'binary_recall': 0.8592201, 'binary_specificity': 0.9954622, 'binary_f1_score': 0.86522466}
confusion matrix:
       0     1
0  42119   192
1    213  1300
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.88113356, 'recall': 0.87745947, 'specificity': 0.87745947, 'f1': 0.8792869, 'auroc': 0.9757317, 'binary_precision': 0.7701342, 'binary_recall': 0.76245844, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.76627713}
confusion matrix:
       0    1
0  18034  137
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.87326664, 'recall': 0.64700943, 'specificity': 0.64700943, 'f1': 0.70706075, 'auroc': 0.9347242, 'binary_precision': 0.7741935, 'binary_recall': 0.29752067, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.42985076}
confusion matrix:
      0   1
0  5976  21
1   170  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9850849509239197, best validation acc: 0.9850849509239197, corresponding to test acc:                         0.9669818878173828 / 0.973713755607605
after epoch: 23,now: 2024-05-31 06:30:11.785315,epoch time: 0:28:14.850754,used: 11:05:48.250897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98802024, 'precision': 0.9509183, 'recall': 0.86028075, 'specificity': 0.86028075, 'f1': 0.90015304, 'auroc': 0.99437785, 'binary_precision': 0.9116667, 'binary_recall': 0.72306675, 'binary_specificity': 0.99749476, 'binary_f1_score': 0.80648726}
confusion matrix:
       0     1
0  42205   106
1    419  1094
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.89368093, 'recall': 0.8352057, 'specificity': 0.8352057, 'f1': 0.8619176, 'auroc': 0.96248543, 'binary_precision': 0.7980392, 'binary_recall': 0.67607975, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.7320144}
confusion matrix:
       0    1
0  18068  103
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.77547413, 'recall': 0.5200775, 'specificity': 0.5200775, 'f1': 0.5288302, 'auroc': 0.7833425, 'binary_precision': 0.5882353, 'binary_recall': 0.041322313, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.077220075}
confusion matrix:
      0   1
0  5990   7
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 4
val acc:0.9841261506080627, best validation acc: 0.9850849509239197, corresponding to test acc:                         0.9669818878173828 / 0.973713755607605
after epoch: 24,now: 2024-05-31 06:58:09.027252,epoch time: 0:27:57.241937,used: 11:33:45.492834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99146587, 'precision': 0.9362298, 'recall': 0.9356738, 'specificity': 0.9356738, 'f1': 0.9359516, 'auroc': 0.9947723, 'binary_precision': 0.8769027, 'binary_recall': 0.87574357, 'binary_specificity': 0.995604, 'binary_f1_score': 0.87632275}
confusion matrix:
       0     1
0  42125   186
1    188  1325
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.88308346, 'recall': 0.8800062, 'specificity': 0.8800062, 'f1': 0.88153815, 'auroc': 0.97745216, 'binary_precision': 0.77386934, 'binary_recall': 0.76744187, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.77064216}
confusion matrix:
       0    1
0  18036  135
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8540411, 'recall': 0.6527076, 'specificity': 0.6527076, 'f1': 0.7100292, 'auroc': 0.9356903, 'binary_precision': 0.7352941, 'binary_recall': 0.30991736, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4360465}
confusion matrix:
      0   1
0  5970  27
1   167  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 25,now: 2024-05-31 07:26:06.607277,epoch time: 0:27:57.580025,used: 12:01:43.072859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9895263, 'precision': 0.9565603, 'recall': 0.87954247, 'specificity': 0.87954247, 'f1': 0.9142344, 'auroc': 0.9945167, 'binary_precision': 0.9216, 'binary_recall': 0.7614012, 'binary_specificity': 0.9976838, 'binary_f1_score': 0.8338762}
confusion matrix:
       0     1
0  42213    98
1    361  1152
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.9053644, 'recall': 0.8405468, 'specificity': 0.8405468, 'f1': 0.8699275, 'auroc': 0.970266, 'binary_precision': 0.82107353, 'binary_recall': 0.68604654, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.74751127}
confusion matrix:
       0    1
0  18081   90
1    189  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.84895045, 'recall': 0.5447875, 'specificity': 0.5447875, 'f1': 0.5715427, 'auroc': 0.9095667, 'binary_precision': 0.73333335, 'binary_recall': 0.09090909, 'binary_specificity': 0.998666, 'binary_f1_score': 0.16176471}
confusion matrix:
      0   1
0  5989   8
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9851382374763489, best validation acc: 0.9853513240814209, corresponding to test acc:                         0.9689052700996399 / 0.973713755607605
after epoch: 26,now: 2024-05-31 07:54:07.085831,epoch time: 0:28:00.478554,used: 12:29:43.551413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99178535, 'precision': 0.9430742, 'recall': 0.93233407, 'specificity': 0.93233407, 'f1': 0.93763286, 'auroc': 0.995976, 'binary_precision': 0.89084744, 'binary_recall': 0.86847323, 'binary_specificity': 0.99619484, 'binary_f1_score': 0.87951803}
confusion matrix:
       0     1
0  42150   161
1    199  1314
---- Validation: 
scalar performance:
{'acc': 0.98641664, 'precision': 0.9021621, 'recall': 0.871723, 'specificity': 0.871723, 'f1': 0.88629735, 'auroc': 0.97548777, 'binary_precision': 0.8126126, 'binary_recall': 0.7491694, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.7796024}
confusion matrix:
       0    1
0  18067  104
1    151  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8893193, 'recall': 0.62891465, 'specificity': 0.62891465, 'f1': 0.68889666, 'auroc': 0.9181386, 'binary_precision': 0.8076923, 'binary_recall': 0.2603306, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.39375}
confusion matrix:
      0   1
0  5982  15
1   179  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
better model found
persisted
after epoch: 27,now: 2024-05-31 08:22:00.481222,epoch time: 0:27:53.395391,used: 12:57:36.946804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98824847, 'precision': 0.97058904, 'recall': 0.84669685, 'specificity': 0.84669685, 'f1': 0.8985766, 'auroc': 0.9951646, 'binary_precision': 0.95199275, 'binary_recall': 0.6946464, 'binary_specificity': 0.99874735, 'binary_f1_score': 0.8032098}
confusion matrix:
       0     1
0  42258    53
1    462  1051
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.94725573, 'recall': 0.8070939, 'specificity': 0.8070939, 'f1': 0.86328197, 'auroc': 0.975623, 'binary_precision': 0.9070905, 'binary_recall': 0.61627907, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.73392683}
confusion matrix:
       0    1
0  18133   38
1    231  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9069103, 'recall': 0.53487384, 'specificity': 0.53487384, 'f1': 0.5555535, 'auroc': 0.88147926, 'binary_precision': 0.85, 'binary_recall': 0.07024793, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.129771}
confusion matrix:
      0   1
0  5994   3
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 1
val acc:0.9856709241867065, best validation acc: 0.9864166378974915, corresponding to test acc:                         0.9689052700996399 / 0.973713755607605
after epoch: 28,now: 2024-05-31 08:50:05.473998,epoch time: 0:28:04.992776,used: 13:25:41.939580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9898914, 'precision': 0.96812314, 'recall': 0.8746332, 'specificity': 0.8746332, 'f1': 0.9158083, 'auroc': 0.99521863, 'binary_precision': 0.9450915, 'binary_recall': 0.7508262, 'binary_specificity': 0.99844015, 'binary_f1_score': 0.83683246}
confusion matrix:
       0     1
0  42245    66
1    377  1136
---- Validation: 
scalar performance:
{'acc': 0.98396635, 'precision': 0.9173808, 'recall': 0.80300117, 'specificity': 0.80300117, 'f1': 0.8504673, 'auroc': 0.9754706, 'binary_precision': 0.84757507, 'binary_recall': 0.6096346, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.7091788}
confusion matrix:
       0    1
0  18105   66
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.88985527, 'recall': 0.57982814, 'specificity': 0.57982814, 'f1': 0.6257857, 'auroc': 0.91640323, 'binary_precision': 0.8125, 'binary_recall': 0.16115703, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2689655}
confusion matrix:
      0   1
0  5988   9
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 2
val acc:0.9839663505554199, best validation acc: 0.9864166378974915, corresponding to test acc:                         0.9689052700996399 / 0.973713755607605
after epoch: 29,now: 2024-05-31 09:18:19.921426,epoch time: 0:28:14.447428,used: 13:53:56.387008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9904162, 'precision': 0.94599754, 'recall': 0.9054955, 'specificity': 0.9054955, 'f1': 0.92470706, 'auroc': 0.9955505, 'binary_precision': 0.89861417, 'binary_recall': 0.8142763, 'binary_specificity': 0.99671483, 'binary_f1_score': 0.854369}
confusion matrix:
       0     1
0  42172   139
1    281  1232
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.8939327, 'recall': 0.8475541, 'specificity': 0.8475541, 'f1': 0.86918044, 'auroc': 0.9750487, 'binary_precision': 0.7977316, 'binary_recall': 0.7009967, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.7462423}
confusion matrix:
       0    1
0  18064  107
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.9173584, 'recall': 0.56776494, 'specificity': 0.56776494, 'f1': 0.6090852, 'auroc': 0.89162886, 'binary_precision': 0.8684211, 'binary_recall': 0.13636364, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2357143}
confusion matrix:
      0   1
0  5992   5
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993750.png
early stop counter: 3
val acc:0.9847120642662048, best validation acc: 0.9864166378974915, corresponding to test acc:                         0.9689052700996399 / 0.973713755607605
after epoch: 30,now: 2024-05-31 09:46:14.326925,epoch time: 0:27:54.405499,used: 14:21:50.792507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_24_23_seed_2_20993750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:21:50.792507 at 2024-05-31 09:46:14.326925
persisted model performance metric: 

scalar performance:
{'acc': 0.96842444, 'precision': 0.8497927, 'recall': 0.64650923, 'specificity': 0.64650923, 'f1': 0.703028, 'auroc': 0.9154148, 'binary_precision': 0.72727275, 'binary_recall': 0.29752067, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4222874}
confusion matrix:
      0   1
0  5970  27
1   170  72
oracle model performance metric: 

scalar performance:
{'acc': 0.97002727, 'precision': 0.89414805, 'recall': 0.64536023, 'specificity': 0.64536023, 'f1': 0.7081094, 'auroc': 0.95060354, 'binary_precision': 0.81609195, 'binary_recall': 0.29338843, 'binary_specificity': 0.997332, 'binary_f1_score': 0.43161094}
confusion matrix:
      0   1
0  5981  16
1   171  71
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41642 MiB |  27164 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     72 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444635 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |   9518 KiB |     45 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  592986 K  |  592982 K  |
|       from large pool |     187    |    1413    |  308145 K  |  308145 K  |
|       from small pool |    3289    |    6298    |  284840 K  |  284837 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  592986 K  |  592982 K  |
|       from large pool |     187    |    1413    |  308145 K  |  308145 K  |
|       from small pool |    3289    |    6298    |  284840 K  |  284837 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      36    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |    2807    |  387705 K  |  387705 K  |
|       from large pool |      38    |     605    |  240391 K  |  240391 K  |
|       from small pool |      41    |    2769    |  147314 K  |  147314 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14478 MiB |  41642 MiB |  40762 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     50 MiB |     72 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |      0 KiB |     45 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  592986 K  |  592986 K  |
|       from large pool |       2    |    1413    |  308145 K  |  308145 K  |
|       from small pool |       0    |    6298    |  284840 K  |  284840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  592986 K  |  592986 K  |
|       from large pool |       2    |    1413    |  308145 K  |  308145 K  |
|       from small pool |       0    |    6298    |  284840 K  |  284840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1780    |    1718    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      25    |      36    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  387706 K  |  387706 K  |
|       from large pool |       4    |     605    |  240391 K  |  240391 K  |
|       from small pool |       0    |    2769    |  147315 K  |  147315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 31 09:48:41 2024]
Finished job 0.
1 of 1 steps (100%) done
