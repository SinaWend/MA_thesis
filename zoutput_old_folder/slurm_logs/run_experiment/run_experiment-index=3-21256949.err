Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:25:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949

 Experiment start at: 2024-06-08 12:32:05.738932
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.92077017, 'recall': 0.5023659, 'specificity': 0.5023659, 'f1': 0.49621674, 'auroc': 0.956246, 'binary_precision': 0.875, 'binary_recall': 0.0047554346, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.009459459}
confusion matrix:
       0  1
0  42319  1
1   1465  7
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.98299444, 'recall': 0.5031104, 'specificity': 0.5031104, 'f1': 0.49753252, 'auroc': 0.95525527, 'binary_precision': 1.0, 'binary_recall': 0.00622084, 'binary_specificity': 1.0, 'binary_f1_score': 0.012364761}
confusion matrix:
       0  1
0  18149  0
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.9330145, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 12:53:40.342910,epoch time: 0:21:34.603978,used: 0:21:34.603978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97035986, 'precision': 0.77488863, 'recall': 0.74154985, 'specificity': 0.74154985, 'f1': 0.75703365, 'auroc': 0.9624521, 'binary_precision': 0.56721056, 'binary_recall': 0.49626106, 'binary_specificity': 0.9868387, 'binary_f1_score': 0.5293692}
confusion matrix:
       0    1
0  41764  557
1    741  730
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.7944542, 'recall': 0.6155788, 'specificity': 0.6155788, 'f1': 0.6628016, 'auroc': 0.9625494, 'binary_precision': 0.61538464, 'binary_recall': 0.23639192, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.34157306}
confusion matrix:
       0    1
0  18054   95
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.9583391, 'recall': 0.66433406, 'specificity': 0.66433406, 'f1': 0.7369193, 'auroc': 0.9509035, 'binary_precision': 0.94505495, 'binary_recall': 0.32950193, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.48863637}
confusion matrix:
      0   1
0  5992   5
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-08 13:14:21.562401,epoch time: 0:20:41.219491,used: 0:42:15.823469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96969765, 'precision': 0.7635356, 'recall': 0.844326, 'specificity': 0.844326, 'f1': 0.79794073, 'auroc': 0.9670469, 'binary_precision': 0.5372751, 'binary_recall': 0.7099185, 'binary_specificity': 0.9787335, 'binary_f1_score': 0.61164767}
confusion matrix:
       0     1
0  41420   900
1    427  1045
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.76253307, 'recall': 0.8226491, 'specificity': 0.8226491, 'f1': 0.78914344, 'auroc': 0.9674907, 'binary_precision': 0.5370138, 'binary_recall': 0.66562986, 'binary_specificity': 0.9796683, 'binary_f1_score': 0.5944445}
confusion matrix:
       0    1
0  17780  369
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9801854, 'precision': 0.8968766, 'recall': 0.84124243, 'specificity': 0.84124243, 'f1': 0.866748, 'auroc': 0.9527564, 'binary_precision': 0.80717486, 'binary_recall': 0.6896552, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.7438017}
confusion matrix:
      0    1
0  5954   43
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-08 13:35:02.413502,epoch time: 0:20:40.851101,used: 1:02:56.674570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97472143, 'precision': 0.82436347, 'recall': 0.7443053, 'specificity': 0.7443053, 'f1': 0.77820337, 'auroc': 0.96640354, 'binary_precision': 0.66606003, 'binary_recall': 0.4972826, 'binary_specificity': 0.991328, 'binary_f1_score': 0.56942827}
confusion matrix:
       0    1
0  41953  367
1    740  732
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.8213651, 'recall': 0.7199004, 'specificity': 0.7199004, 'f1': 0.76028585, 'auroc': 0.96468705, 'binary_precision': 0.66206896, 'binary_recall': 0.44790047, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.53432286}
confusion matrix:
       0    1
0  18002  147
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.9460329, 'recall': 0.70989424, 'specificity': 0.70989424, 'f1': 0.7820802, 'auroc': 0.9545021, 'binary_precision': 0.9166667, 'binary_recall': 0.42145595, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.57742786}
confusion matrix:
      0    1
0  5987   10
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 13:55:41.253771,epoch time: 0:20:38.840269,used: 1:23:35.514839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9703142, 'precision': 0.96885896, 'recall': 0.56039107, 'specificity': 0.56039107, 'f1': 0.59992343, 'auroc': 0.97126555, 'binary_precision': 0.9673913, 'binary_recall': 0.120923914, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.21497585}
confusion matrix:
       0    1
0  42314    6
1   1294  178
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.9747968, 'recall': 0.5404079, 'specificity': 0.5404079, 'f1': 0.56668836, 'auroc': 0.9695218, 'binary_precision': 0.9811321, 'binary_recall': 0.08087092, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.1494253}
confusion matrix:
       0   1
0  18148   1
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.94259775, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_5.png
early stop counter: 1
val acc:0.9684972167015076, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9742729067802429 / 0.9801853895187378
after epoch: 5,now: 2024-06-08 14:16:21.515200,epoch time: 0:20:40.261429,used: 1:44:15.776268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9720268, 'precision': 0.77542955, 'recall': 0.89602137, 'specificity': 0.89602137, 'f1': 0.8236461, 'auroc': 0.97552997, 'binary_precision': 0.5574151, 'binary_recall': 0.81453806, 'binary_specificity': 0.97750473, 'binary_f1_score': 0.6618824}
confusion matrix:
       0     1
0  41368   952
1    273  1199
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.7619722, 'recall': 0.8744304, 'specificity': 0.8744304, 'f1': 0.80705976, 'auroc': 0.9732536, 'binary_precision': 0.5321199, 'binary_recall': 0.7729393, 'binary_specificity': 0.9759215, 'binary_f1_score': 0.6303108}
confusion matrix:
       0    1
0  17712  437
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.8544226, 'recall': 0.8296629, 'specificity': 0.8296629, 'f1': 0.8415444, 'auroc': 0.954011, 'binary_precision': 0.7231405, 'binary_recall': 0.6704981, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.695825}
confusion matrix:
      0    1
0  5930   67
1    86  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_6.png
early stop counter: 2
val acc:0.9689761400222778, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9742729067802429 / 0.9801853895187378
after epoch: 6,now: 2024-06-08 14:37:01.658720,epoch time: 0:20:40.143520,used: 2:04:55.919788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9810011, 'precision': 0.88994, 'recall': 0.79083174, 'specificity': 0.79083174, 'f1': 0.83260727, 'auroc': 0.9763166, 'binary_precision': 0.7941176, 'binary_recall': 0.5869565, 'binary_specificity': 0.994707, 'binary_f1_score': 0.67499995}
confusion matrix:
       0    1
0  42096  224
1    608  864
---- Validation: 
scalar performance:
{'acc': 0.97914004, 'precision': 0.89563733, 'recall': 0.7536832, 'specificity': 0.7536832, 'f1': 0.8079685, 'auroc': 0.97592676, 'binary_precision': 0.8083538, 'binary_recall': 0.5116641, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.6266667}
confusion matrix:
       0    1
0  18071   78
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.859807, 'recall': 0.59253573, 'specificity': 0.59253573, 'f1': 0.6409548, 'auroc': 0.95801574, 'binary_precision': 0.75384617, 'binary_recall': 0.18773946, 'binary_specificity': 0.997332, 'binary_f1_score': 0.30061346}
confusion matrix:
      0   1
0  5981  16
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_7.png
better model found
persisted
after epoch: 7,now: 2024-06-08 14:57:43.900251,epoch time: 0:20:42.241531,used: 2:25:38.161319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9753608, 'precision': 0.8513099, 'recall': 0.7141452, 'specificity': 0.7141452, 'f1': 0.7647772, 'auroc': 0.97452366, 'binary_precision': 0.7220339, 'binary_recall': 0.43410325, 'binary_specificity': 0.9941871, 'binary_f1_score': 0.5422147}
confusion matrix:
       0    1
0  42074  246
1    833  639
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.8597246, 'recall': 0.7011979, 'specificity': 0.7011979, 'f1': 0.7563243, 'auroc': 0.97296965, 'binary_precision': 0.740113, 'binary_recall': 0.407465, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.5255767}
confusion matrix:
       0    1
0  18057   92
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8813036, 'recall': 0.664749, 'specificity': 0.664749, 'f1': 0.726391, 'auroc': 0.958788, 'binary_precision': 0.7909091, 'binary_recall': 0.33333334, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.46900272}
confusion matrix:
      0   1
0  5974  23
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_8.png
early stop counter: 1
val acc:0.9748297333717346, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9635666608810425 / 0.9801853895187378
after epoch: 8,now: 2024-06-08 15:22:18.155901,epoch time: 0:24:34.255650,used: 2:50:12.416969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9787404, 'precision': 0.84219456, 'recall': 0.8203623, 'specificity': 0.8203623, 'f1': 0.83088624, 'auroc': 0.97685885, 'binary_precision': 0.69650656, 'binary_recall': 0.65057784, 'binary_specificity': 0.99014676, 'binary_f1_score': 0.67275923}
confusion matrix:
       0    1
0  41904  417
1    514  957
---- Validation: 
scalar performance:
{'acc': 0.97557473, 'precision': 0.83377236, 'recall': 0.76158804, 'specificity': 0.76158804, 'f1': 0.79291475, 'auroc': 0.97138786, 'binary_precision': 0.684, 'binary_recall': 0.5318818, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.5984252}
confusion matrix:
       0    1
0  17991  158
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8317977, 'recall': 0.5657992, 'specificity': 0.5657992, 'f1': 0.6026672, 'auroc': 0.9526751, 'binary_precision': 0.7, 'binary_recall': 0.13409962, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.22508039}
confusion matrix:
      0   1
0  5982  15
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_9.png
early stop counter: 2
val acc:0.9755747318267822, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9635666608810425 / 0.9801853895187378
after epoch: 9,now: 2024-06-08 15:43:08.120423,epoch time: 0:20:49.964522,used: 3:11:02.381491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788546, 'precision': 0.9219551, 'recall': 0.7192315, 'specificity': 0.7192315, 'f1': 0.78639245, 'auroc': 0.98081136, 'binary_precision': 0.8630319, 'binary_recall': 0.44089675, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.5836331}
confusion matrix:
       0    1
0  42217  103
1    823  649
---- Validation: 
scalar performance:
{'acc': 0.9772776, 'precision': 0.939202, 'recall': 0.6882142, 'specificity': 0.6882142, 'f1': 0.76033354, 'auroc': 0.9811615, 'binary_precision': 0.9, 'binary_recall': 0.377916, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.5323111}
confusion matrix:
       0    1
0  18122   27
1    400  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.9556988, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_10.png
early stop counter: 3
val acc:0.9772775769233704, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9635666608810425 / 0.9801853895187378
after epoch: 10,now: 2024-06-08 16:04:05.197834,epoch time: 0:20:57.077411,used: 3:31:59.458902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9805444, 'precision': 0.88680804, 'recall': 0.7847332, 'specificity': 0.7847332, 'f1': 0.82740617, 'auroc': 0.98031664, 'binary_precision': 0.7882463, 'binary_recall': 0.57482994, 'binary_specificity': 0.99463636, 'binary_f1_score': 0.66483086}
confusion matrix:
       0    1
0  42095  227
1    625  845
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.87382066, 'recall': 0.7684088, 'specificity': 0.7684088, 'f1': 0.8117635, 'auroc': 0.9778092, 'binary_precision': 0.76367617, 'binary_recall': 0.5427683, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.6345455}
confusion matrix:
       0    1
0  18041  108
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73924565, 'recall': 0.5624661, 'specificity': 0.5624661, 'f1': 0.5933512, 'auroc': 0.9598436, 'binary_precision': 0.5151515, 'binary_recall': 0.1302682, 'binary_specificity': 0.994664, 'binary_f1_score': 0.20795105}
confusion matrix:
      0   1
0  5965  32
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_11.png
early stop counter: 4
val acc:0.9786078929901123, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9635666608810425 / 0.9801853895187378
after epoch: 11,now: 2024-06-08 16:24:48.249282,epoch time: 0:20:43.051448,used: 3:52:42.510350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9801105, 'precision': 0.9289919, 'recall': 0.73642385, 'specificity': 0.73642385, 'f1': 0.80296063, 'auroc': 0.9785224, 'binary_precision': 0.87593985, 'binary_recall': 0.47518694, 'binary_specificity': 0.99766076, 'binary_f1_score': 0.6161305}
confusion matrix:
       0    1
0  42222   99
1    772  699
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.9197159, 'recall': 0.70410305, 'specificity': 0.70410305, 'f1': 0.7721351, 'auroc': 0.976123, 'binary_precision': 0.85993487, 'binary_recall': 0.41057542, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.5557895}
confusion matrix:
       0    1
0  18106   43
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8330575, 'recall': 0.575211, 'specificity': 0.575211, 'f1': 0.61603045, 'auroc': 0.94376516, 'binary_precision': 0.7017544, 'binary_recall': 0.1532567, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2515723}
confusion matrix:
      0   1
0  5980  17
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_12.png
early stop counter: 5
val acc:0.9775436520576477, best validation acc: 0.979140043258667, corresponding to test acc:                         0.9635666608810425 / 0.9801853895187378
after epoch: 12,now: 2024-06-08 16:45:27.661129,epoch time: 0:20:39.411847,used: 4:13:21.922197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98305625, 'precision': 0.87503517, 'recall': 0.85877836, 'specificity': 0.85877836, 'f1': 0.8667112, 'auroc': 0.98333913, 'binary_precision': 0.7596017, 'binary_recall': 0.7255435, 'binary_specificity': 0.9920132, 'binary_f1_score': 0.7421821}
confusion matrix:
       0     1
0  41982   338
1    404  1068
---- Validation: 
scalar performance:
{'acc': 0.9820668, 'precision': 0.8851439, 'recall': 0.8264537, 'specificity': 0.8264537, 'f1': 0.85317665, 'auroc': 0.97993755, 'binary_precision': 0.78228784, 'binary_recall': 0.65940905, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.7156118}
confusion matrix:
       0    1
0  18031  118
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.69643384, 'recall': 0.53972775, 'specificity': 0.53972775, 'f1': 0.5595328, 'auroc': 0.9443996, 'binary_precision': 0.43137255, 'binary_recall': 0.08429119, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.14102563}
confusion matrix:
      0   1
0  5968  29
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_13.png
better model found
persisted
after epoch: 13,now: 2024-06-08 17:06:05.710974,epoch time: 0:20:38.049845,used: 4:33:59.972042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97985935, 'precision': 0.94154775, 'recall': 0.72401345, 'specificity': 0.72401345, 'f1': 0.7949254, 'auroc': 0.98425025, 'binary_precision': 0.9019074, 'binary_recall': 0.44972825, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.60018134}
confusion matrix:
       0    1
0  42248   72
1    810  662
---- Validation: 
scalar performance:
{'acc': 0.9762665, 'precision': 0.95725536, 'recall': 0.66368896, 'specificity': 0.66368896, 'f1': 0.73701394, 'auroc': 0.97771674, 'binary_precision': 0.93777776, 'binary_recall': 0.3281493, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.48617506}
confusion matrix:
       0    1
0  18135   14
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9467068, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_14.png
early stop counter: 1
val acc:0.9762665033340454, best validation acc: 0.982066810131073, corresponding to test acc:                         0.9571748375892639 / 0.9801853895187378
after epoch: 14,now: 2024-06-08 17:26:44.299794,epoch time: 0:20:38.588820,used: 4:54:38.560862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.8843665, 'recall': 0.83600247, 'specificity': 0.83600247, 'f1': 0.85842687, 'auroc': 0.98277736, 'binary_precision': 0.7798595, 'binary_recall': 0.6786685, 'binary_specificity': 0.9933365, 'binary_f1_score': 0.7257537}
confusion matrix:
       0    1
0  42038  282
1    473  999
---- Validation: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.9034039, 'recall': 0.80322945, 'specificity': 0.80322945, 'f1': 0.84565985, 'auroc': 0.9789944, 'binary_precision': 0.8204593, 'binary_recall': 0.61119753, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.70053476}
confusion matrix:
       0    1
0  18063   86
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83143187, 'recall': 0.603363, 'specificity': 0.603363, 'f1': 0.6523199, 'auroc': 0.9639858, 'binary_precision': 0.6962025, 'binary_recall': 0.21072797, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32352942}
confusion matrix:
      0   1
0  5973  24
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_15.png
better model found
persisted
after epoch: 15,now: 2024-06-08 17:47:23.078812,epoch time: 0:20:38.779018,used: 5:15:17.339880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.8949855, 'recall': 0.86481375, 'specificity': 0.86481375, 'f1': 0.8792511, 'auroc': 0.9852253, 'binary_precision': 0.79911375, 'binary_recall': 0.7360544, 'binary_specificity': 0.99357307, 'binary_f1_score': 0.76628894}
confusion matrix:
       0     1
0  42050   272
1    388  1082
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9118357, 'recall': 0.832806, 'specificity': 0.832806, 'f1': 0.86779535, 'auroc': 0.9781395, 'binary_precision': 0.8352713, 'binary_recall': 0.6702955, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.74374455}
confusion matrix:
       0    1
0  18064   85
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.87182015, 'recall': 0.61160946, 'specificity': 0.61160946, 'f1': 0.66608334, 'auroc': 0.9530605, 'binary_precision': 0.7763158, 'binary_recall': 0.22605364, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.35014838}
confusion matrix:
      0   1
0  5980  17
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_16.png
better model found
persisted
after epoch: 16,now: 2024-06-08 18:07:57.515824,epoch time: 0:20:34.437012,used: 5:35:51.776892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98232555, 'precision': 0.85292655, 'recall': 0.89118624, 'specificity': 0.89118624, 'f1': 0.87098145, 'auroc': 0.983863, 'binary_precision': 0.71306473, 'binary_recall': 0.79347825, 'binary_specificity': 0.98889416, 'binary_f1_score': 0.75112545}
confusion matrix:
       0     1
0  41850   470
1    304  1168
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.87956965, 'recall': 0.85159117, 'specificity': 0.85159117, 'f1': 0.8649989, 'auroc': 0.98234695, 'binary_precision': 0.76936024, 'binary_recall': 0.71073097, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.7388843}
confusion matrix:
       0    1
0  18012  137
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.84223676, 'recall': 0.62801707, 'specificity': 0.62801707, 'f1': 0.6819652, 'auroc': 0.9518955, 'binary_precision': 0.7157895, 'binary_recall': 0.2605364, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3820225}
confusion matrix:
      0   1
0  5970  27
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_17.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 17,now: 2024-06-08 18:28:29.328962,epoch time: 0:20:31.813138,used: 5:56:23.590030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98675555, 'precision': 0.9176204, 'recall': 0.8692167, 'specificity': 0.8692167, 'f1': 0.8918121, 'auroc': 0.9894688, 'binary_precision': 0.8441358, 'binary_recall': 0.7432065, 'binary_specificity': 0.99522686, 'binary_f1_score': 0.7904625}
confusion matrix:
       0     1
0  42118   202
1    378  1094
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9234085, 'recall': 0.8169722, 'specificity': 0.8169722, 'f1': 0.8619578, 'auroc': 0.9836729, 'binary_precision': 0.8595388, 'binary_recall': 0.63763607, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.73214287}
confusion matrix:
       0    1
0  18082   67
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7438184, 'recall': 0.5588848, 'specificity': 0.5588848, 'f1': 0.5887999, 'auroc': 0.95735127, 'binary_precision': 0.52459013, 'binary_recall': 0.12260536, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.19875775}
confusion matrix:
      0   1
0  5968  29
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_18.png
early stop counter: 2
val acc:0.9840357303619385, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 18,now: 2024-06-08 18:49:01.481261,epoch time: 0:20:32.152299,used: 6:16:55.742329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9836043, 'precision': 0.9523362, 'recall': 0.7795708, 'specificity': 0.7795708, 'f1': 0.8441825, 'auroc': 0.986179, 'binary_precision': 0.91973245, 'binary_recall': 0.560843, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.6967906}
confusion matrix:
       0    1
0  42249   72
1    646  825
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.9503853, 'recall': 0.73023236, 'specificity': 0.73023236, 'f1': 0.8023739, 'auroc': 0.9783522, 'binary_precision': 0.91950464, 'binary_recall': 0.46189734, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.6149068}
confusion matrix:
       0    1
0  18123   26
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.82871485, 'recall': 0.5845394, 'specificity': 0.5845394, 'f1': 0.6283567, 'auroc': 0.94918966, 'binary_precision': 0.6923077, 'binary_recall': 0.1724138, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2760736}
confusion matrix:
      0   1
0  5977  20
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_19.png
early stop counter: 3
val acc:0.9802043437957764, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 19,now: 2024-06-08 19:09:38.127752,epoch time: 0:20:36.646491,used: 6:37:32.388820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.8502823, 'recall': 0.9107544, 'specificity': 0.9107544, 'f1': 0.8778881, 'auroc': 0.98718333, 'binary_precision': 0.7063903, 'binary_recall': 0.8335598, 'binary_specificity': 0.98794895, 'binary_f1_score': 0.76472425}
confusion matrix:
       0     1
0  41810   510
1    245  1227
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.86968064, 'recall': 0.89181244, 'specificity': 0.89181244, 'f1': 0.88039565, 'auroc': 0.9818503, 'binary_precision': 0.7467057, 'binary_recall': 0.7931571, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.7692307}
confusion matrix:
       0    1
0  17976  173
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7944931, 'recall': 0.604445, 'specificity': 0.604445, 'f1': 0.6497209, 'auroc': 0.94338787, 'binary_precision': 0.62222224, 'binary_recall': 0.21455939, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.31908834}
confusion matrix:
      0   1
0  5963  34
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_20.png
early stop counter: 4
val acc:0.9837164878845215, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 20,now: 2024-06-08 19:30:10.490146,epoch time: 0:20:32.362394,used: 6:58:04.751214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9834216, 'precision': 0.8502409, 'recall': 0.9290855, 'specificity': 0.9290855, 'f1': 0.8852923, 'auroc': 0.9887688, 'binary_precision': 0.70500827, 'binary_recall': 0.87083614, 'binary_specificity': 0.9873349, 'binary_f1_score': 0.7791971}
confusion matrix:
       0     1
0  41785   536
1    190  1281
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.8527595, 'recall': 0.9085127, 'specificity': 0.9085127, 'f1': 0.87839854, 'auroc': 0.9798713, 'binary_precision': 0.7116155, 'binary_recall': 0.8289269, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.76580465}
confusion matrix:
       0    1
0  17933  216
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.815377, 'recall': 0.64234227, 'specificity': 0.64234227, 'f1': 0.69290197, 'auroc': 0.9579967, 'binary_precision': 0.66086954, 'binary_recall': 0.29118773, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4042553}
confusion matrix:
      0   1
0  5958  39
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_21.png
early stop counter: 5
val acc:0.9826521873474121, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 21,now: 2024-06-08 19:50:44.839041,epoch time: 0:20:34.348895,used: 7:18:39.100109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98408383, 'precision': 0.93372, 'recall': 0.8027853, 'specificity': 0.8027853, 'f1': 0.855776, 'auroc': 0.9854721, 'binary_precision': 0.8809055, 'binary_recall': 0.6084296, 'binary_specificity': 0.9971409, 'binary_f1_score': 0.7197427}
confusion matrix:
       0    1
0  42200  121
1    576  895
---- Validation: 
scalar performance:
{'acc': 0.9792997, 'precision': 0.9153882, 'recall': 0.7387647, 'specificity': 0.7387647, 'f1': 0.80153453, 'auroc': 0.97890764, 'binary_precision': 0.8489011, 'binary_recall': 0.4805599, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.6137041}
confusion matrix:
       0    1
0  18094   55
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81489533, 'recall': 0.55996865, 'specificity': 0.55996865, 'f1': 0.59352463, 'auroc': 0.94940233, 'binary_precision': 0.6666667, 'binary_recall': 0.12260536, 'binary_specificity': 0.997332, 'binary_f1_score': 0.20711973}
confusion matrix:
      0   1
0  5981  16
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_22.png
early stop counter: 6
val acc:0.9792997241020203, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9650048017501831 / 0.9801853895187378
after epoch: 22,now: 2024-06-08 20:11:20.709549,epoch time: 0:20:35.870508,used: 7:39:14.970617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98725796, 'precision': 0.90074944, 'recall': 0.9039018, 'specificity': 0.9039018, 'f1': 0.90231895, 'auroc': 0.98881614, 'binary_precision': 0.8079515, 'binary_recall': 0.81453806, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.81123143}
confusion matrix:
       0     1
0  42035   285
1    273  1199
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.8964727, 'recall': 0.8684443, 'specificity': 0.8684443, 'f1': 0.88190174, 'auroc': 0.97903955, 'binary_precision': 0.8020134, 'binary_recall': 0.7433904, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.77159005}
confusion matrix:
       0    1
0  18031  118
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.77608824, 'recall': 0.6373436, 'specificity': 0.6373436, 'f1': 0.6808272, 'auroc': 0.93913865, 'binary_precision': 0.5826772, 'binary_recall': 0.2835249, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.3814433}
confusion matrix:
      0   1
0  5944  53
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_23.png
better model found
persisted
after epoch: 23,now: 2024-06-08 20:31:55.565714,epoch time: 0:20:34.856165,used: 7:59:49.826782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9871209, 'precision': 0.9516127, 'recall': 0.8392427, 'specificity': 0.8392427, 'f1': 0.88686985, 'auroc': 0.9909022, 'binary_precision': 0.91423357, 'binary_recall': 0.6807065, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.78037375}
confusion matrix:
       0     1
0  42226    94
1    470  1002
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9273319, 'recall': 0.79700243, 'specificity': 0.79700243, 'f1': 0.84957445, 'auroc': 0.98271954, 'binary_precision': 0.8687783, 'binary_recall': 0.59720063, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7078341}
confusion matrix:
       0    1
0  18091   58
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73010266, 'recall': 0.52382034, 'specificity': 0.52382034, 'f1': 0.5346248, 'auroc': 0.9422375, 'binary_precision': 0.5, 'binary_recall': 0.049808428, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.09059233}
confusion matrix:
      0   1
0  5984  13
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_24.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9616490602493286 / 0.9801853895187378
after epoch: 24,now: 2024-06-08 20:52:25.765359,epoch time: 0:20:30.199645,used: 8:20:20.026427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9840382, 'precision': 0.8670279, 'recall': 0.8984985, 'specificity': 0.8984985, 'f1': 0.88205796, 'auroc': 0.98861694, 'binary_precision': 0.740787, 'binary_recall': 0.80680275, 'binary_specificity': 0.9901942, 'binary_f1_score': 0.77238685}
confusion matrix:
       0     1
0  41907   415
1    284  1186
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.89104426, 'recall': 0.83975554, 'specificity': 0.83975554, 'f1': 0.8634503, 'auroc': 0.9779637, 'binary_precision': 0.79316545, 'binary_recall': 0.6858476, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.73561305}
confusion matrix:
       0    1
0  18034  115
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7162028, 'recall': 0.5437259, 'specificity': 0.5437259, 'f1': 0.5661069, 'auroc': 0.92392147, 'binary_precision': 0.47058824, 'binary_recall': 0.09195402, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.15384614}
confusion matrix:
      0   1
0  5970  27
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_25.png
early stop counter: 2
val acc:0.9831311106681824, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9616490602493286 / 0.9801853895187378
after epoch: 25,now: 2024-06-08 21:13:02.534071,epoch time: 0:20:36.768712,used: 8:40:56.795139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_32_05_seed_0_21256949
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.8914062, 'recall': 0.9121684, 'specificity': 0.9121684, 'f1': 0.9014959, 'auroc': 0.9914169, 'binary_precision': 0.7886598, 'binary_recall': 0.83208704, 'binary_specificity': 0.9922497, 'binary_f1_score': 0.8097916}
confusion matrix:
       0     1
0  41993   328
1    247  1224
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.8898381, 'recall': 0.8804728, 'specificity': 0.8804728, 'f1': 0.88509357, 'auroc': 0.98181343, 'binary_precision': 0.7878788, 'binary_recall': 0.7682737, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.77795273}
confusion matrix:
       0    1
0  18016  133
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8188578, 'recall': 0.61060894, 'specificity': 0.61060894, 'f1': 0.6595616, 'auroc': 0.9486722, 'binary_precision': 0.67045456, 'binary_recall': 0.22605364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5968  29
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256949_26.png
[Sat Jun  8 21:33:34 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/3.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 64631616 vs 64631440
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
