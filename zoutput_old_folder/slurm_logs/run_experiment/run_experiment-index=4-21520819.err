Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:06:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819

 Experiment start at: 2024-06-21 11:23:15.177725
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90852505, 'precision': 0.9506593, 'recall': 0.5162234, 'specificity': 0.5162234, 'f1': 0.5074002, 'auroc': 0.8911009, 'binary_precision': 0.9930556, 'binary_recall': 0.03247048, 'binary_specificity': 0.9999763, 'binary_f1_score': 0.062884785}
confusion matrix:
       0    1
0  42187    1
1   4261  143
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4348408, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42725003, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:44.889012,epoch time: 0:16:29.711287,used: 0:16:29.711287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9507426, 'precision': 0.97262526, 'recall': 0.7400352, 'specificity': 0.7400352, 'f1': 0.81084275, 'auroc': 0.9522188, 'binary_precision': 0.9966997, 'binary_recall': 0.48023626, 'binary_specificity': 0.99983406, 'binary_f1_score': 0.648168}
confusion matrix:
       0     1
0  42183     7
1   2288  2114
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.54131716, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.57042825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_2.png
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-21 11:54:12.965957,epoch time: 0:14:28.076945,used: 0:30:57.788232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9657452, 'precision': 0.9794538, 'recall': 0.8201839, 'specificity': 0.8201839, 'f1': 0.8804636, 'auroc': 0.96987617, 'binary_precision': 0.99506176, 'binary_recall': 0.6406995, 'binary_specificity': 0.9996682, 'binary_f1_score': 0.7794971}
confusion matrix:
       0     1
0  42175    14
1   1582  2821
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.75816643, 'recall': 0.5083057, 'specificity': 0.5083057, 'f1': 0.50791055, 'auroc': 0.61486065, 'binary_precision': 0.55, 'binary_recall': 0.01710731, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.033182506}
confusion matrix:
       0   1
0  18140   9
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6460935, 'recall': 0.50699586, 'specificity': 0.50699586, 'f1': 0.5038295, 'auroc': 0.6525953, 'binary_precision': 0.33333334, 'binary_recall': 0.01532567, 'binary_specificity': 0.998666, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5989  8
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_3.png
better model found
persisted
after epoch: 3,now: 2024-06-21 12:09:24.136592,epoch time: 0:15:11.170635,used: 0:46:08.958867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.972227, 'precision': 0.98084724, 'recall': 0.8557428, 'specificity': 0.8557428, 'f1': 0.90679425, 'auroc': 0.97644186, 'binary_precision': 0.9908199, 'binary_recall': 0.7121729, 'binary_specificity': 0.99931276, 'binary_f1_score': 0.8287}
confusion matrix:
       0     1
0  42168    29
1   1265  3130
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.77361965, 'recall': 0.521972, 'specificity': 0.521972, 'f1': 0.5332406, 'auroc': 0.65695953, 'binary_precision': 0.58, 'binary_recall': 0.045101088, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.083694085}
confusion matrix:
       0   1
0  18128  21
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74090165, 'recall': 0.52207136, 'specificity': 0.52207136, 'f1': 0.5316256, 'auroc': 0.68685615, 'binary_precision': 0.5217391, 'binary_recall': 0.04597701, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.08450704}
confusion matrix:
      0   1
0  5986  11
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-21 12:23:02.851914,epoch time: 0:13:38.715322,used: 0:59:47.674189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9764552, 'precision': 0.9814577, 'recall': 0.8797177, 'specificity': 0.8797177, 'f1': 0.92315704, 'auroc': 0.98289347, 'binary_precision': 0.9873119, 'binary_recall': 0.76045454, 'binary_specificity': 0.9989808, 'binary_f1_score': 0.8591603}
confusion matrix:
       0     1
0  42149    43
1   1054  3346
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.77148366, 'recall': 0.54088867, 'specificity': 0.54088867, 'f1': 0.56473476, 'auroc': 0.6843143, 'binary_precision': 0.5744681, 'binary_recall': 0.083981335, 'binary_specificity': 0.997796, 'binary_f1_score': 0.14654002}
confusion matrix:
       0   1
0  18109  40
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.790621, 'recall': 0.54847443, 'specificity': 0.54847443, 'f1': 0.5755326, 'auroc': 0.714129, 'binary_precision': 0.61904764, 'binary_recall': 0.099616855, 'binary_specificity': 0.997332, 'binary_f1_score': 0.17161715}
confusion matrix:
      0   1
0  5981  16
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-21 12:36:46.103648,epoch time: 0:13:43.251734,used: 1:13:30.925923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97864443, 'precision': 0.9833159, 'recall': 0.8909508, 'specificity': 0.8909508, 'f1': 0.9310889, 'auroc': 0.9835961, 'binary_precision': 0.98880917, 'binary_recall': 0.782826, 'binary_specificity': 0.9990756, 'binary_f1_score': 0.8738431}
confusion matrix:
       0     1
0  42151    39
1    956  3446
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.77673244, 'recall': 0.55533254, 'specificity': 0.55533254, 'f1': 0.58660465, 'auroc': 0.70366526, 'binary_precision': 0.584, 'binary_recall': 0.11353032, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.19010417}
confusion matrix:
       0   1
0  18097  52
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.80997634, 'recall': 0.54680884, 'specificity': 0.54680884, 'f1': 0.5734213, 'auroc': 0.72945476, 'binary_precision': 0.65789473, 'binary_recall': 0.09578544, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.16722408}
confusion matrix:
      0   1
0  5984  13
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-21 12:51:47.603978,epoch time: 0:15:01.500330,used: 1:28:32.426253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98033994, 'precision': 0.9828253, 'recall': 0.90101075, 'specificity': 0.90101075, 'f1': 0.9372169, 'auroc': 0.98735344, 'binary_precision': 0.9857621, 'binary_recall': 0.8032302, 'binary_specificity': 0.99879134, 'binary_f1_score': 0.8851842}
confusion matrix:
       0     1
0  42145    51
1    865  3531
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7744141, 'recall': 0.555305, 'specificity': 0.555305, 'f1': 0.58646727, 'auroc': 0.71297526, 'binary_precision': 0.5793651, 'binary_recall': 0.11353032, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.18985696}
confusion matrix:
       0   1
0  18096  53
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8035517, 'recall': 0.5542216, 'specificity': 0.5542216, 'f1': 0.5846156, 'auroc': 0.73192537, 'binary_precision': 0.64444447, 'binary_recall': 0.11111111, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1895425}
confusion matrix:
      0   1
0  5981  16
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_7.png
new oracle model saved
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.960210919380188 / 0.9603707194328308
after epoch: 7,now: 2024-06-21 13:08:23.661523,epoch time: 0:16:36.057545,used: 1:45:08.483798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9818538, 'recall': 0.91401815, 'specificity': 0.91401815, 'f1': 0.9447365, 'auroc': 0.98996615, 'binary_precision': 0.98117775, 'binary_recall': 0.82969534, 'binary_specificity': 0.998341, 'binary_f1_score': 0.8991007}
confusion matrix:
       0     1
0  42124    70
1    749  3649
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.77667844, 'recall': 0.5636658, 'specificity': 0.5636658, 'f1': 0.5983234, 'auroc': 0.73036957, 'binary_precision': 0.5833333, 'binary_recall': 0.13063763, 'binary_specificity': 0.996694, 'binary_f1_score': 0.21346886}
confusion matrix:
       0   1
0  18089  60
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.80913633, 'recall': 0.5673814, 'specificity': 0.5673814, 'f1': 0.60392404, 'auroc': 0.74324906, 'binary_precision': 0.6545454, 'binary_recall': 0.13793103, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2278481}
confusion matrix:
      0   1
0  5978  19
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-21 13:26:27.516424,epoch time: 0:18:03.854901,used: 2:03:12.338699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98377407, 'precision': 0.9822633, 'recall': 0.921535, 'specificity': 0.921535, 'f1': 0.94935405, 'auroc': 0.9894841, 'binary_precision': 0.98045945, 'binary_recall': 0.84482366, 'binary_specificity': 0.9982463, 'binary_f1_score': 0.9076021}
confusion matrix:
       0     1
0  42123    74
1    682  3713
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76444423, 'recall': 0.5763341, 'specificity': 0.5763341, 'f1': 0.61411256, 'auroc': 0.75311744, 'binary_precision': 0.55801105, 'binary_recall': 0.15707621, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.24514563}
confusion matrix:
       0    1
0  18069   80
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.83016753, 'recall': 0.5939512, 'specificity': 0.5939512, 'f1': 0.6405876, 'auroc': 0.7592054, 'binary_precision': 0.6944444, 'binary_recall': 0.19157088, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3003003}
confusion matrix:
      0   1
0  5975  22
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_9.png
new oracle model saved
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9610099196434021 / 0.9627676606178284
after epoch: 9,now: 2024-06-21 13:44:29.288044,epoch time: 0:18:01.771620,used: 2:21:14.110319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98295844, 'precision': 0.98222387, 'recall': 0.9170283, 'specificity': 0.9170283, 'f1': 0.94667876, 'auroc': 0.990056, 'binary_precision': 0.9813483, 'binary_recall': 0.8357159, 'binary_specificity': 0.99834067, 'binary_f1_score': 0.9026961}
confusion matrix:
       0     1
0  42115    70
1    724  3683
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7701118, 'recall': 0.57113886, 'specificity': 0.57113886, 'f1': 0.60790724, 'auroc': 0.7500144, 'binary_precision': 0.56969696, 'binary_recall': 0.14618973, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.23267326}
confusion matrix:
       0   1
0  18078  71
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8420195, 'recall': 0.5866219, 'specificity': 0.5866219, 'f1': 0.63198227, 'auroc': 0.75533795, 'binary_precision': 0.71875, 'binary_recall': 0.17624521, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.2830769}
confusion matrix:
      0   1
0  5979  18
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_10.png
early stop counter: 2
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9610099196434021 / 0.9627676606178284
after epoch: 10,now: 2024-06-21 14:02:25.981234,epoch time: 0:17:56.693190,used: 2:39:10.803509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847828, 'precision': 0.9818088, 'recall': 0.92801404, 'specificity': 0.92801404, 'f1': 0.9529234, 'auroc': 0.99226063, 'binary_precision': 0.978244, 'binary_recall': 0.85801905, 'binary_specificity': 0.998009, 'binary_f1_score': 0.91419584}
confusion matrix:
       0     1
0  42106    84
1    625  3777
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.774409, 'recall': 0.57877713, 'specificity': 0.57877713, 'f1': 0.6180021, 'auroc': 0.7578726, 'binary_precision': 0.5777778, 'binary_recall': 0.16174184, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.25273392}
confusion matrix:
       0    1
0  18073   76
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8318612, 'recall': 0.5996149, 'specificity': 0.5996149, 'f1': 0.6477865, 'auroc': 0.76404357, 'binary_precision': 0.69736844, 'binary_recall': 0.20306513, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3145401}
confusion matrix:
      0   1
0  5974  23
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-21 14:21:01.109227,epoch time: 0:18:35.127993,used: 2:57:45.931502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98613495, 'precision': 0.9857318, 'recall': 0.93233186, 'specificity': 0.93233186, 'f1': 0.95709246, 'auroc': 0.9904287, 'binary_precision': 0.98524845, 'binary_recall': 0.86601454, 'binary_specificity': 0.9986492, 'binary_f1_score': 0.92179173}
confusion matrix:
       0     1
0  42139    57
1    589  3807
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7767811, 'recall': 0.58033234, 'specificity': 0.58033234, 'f1': 0.62014675, 'auroc': 0.76478446, 'binary_precision': 0.5824176, 'binary_recall': 0.16485226, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.25696972}
confusion matrix:
       0    1
0  18073   76
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8512434, 'recall': 0.59994847, 'specificity': 0.59994847, 'f1': 0.64984286, 'auroc': 0.764541, 'binary_precision': 0.7361111, 'binary_recall': 0.20306513, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3183183}
confusion matrix:
      0   1
0  5978  19
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-21 14:39:14.848895,epoch time: 0:18:13.739668,used: 3:15:59.671170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9859633, 'precision': 0.983254, 'recall': 0.93359137, 'specificity': 0.93359137, 'f1': 0.9567407, 'auroc': 0.9927864, 'binary_precision': 0.98, 'binary_recall': 0.86903137, 'binary_specificity': 0.9981514, 'binary_f1_score': 0.9211858}
confusion matrix:
       0     1
0  42116    78
1    576  3822
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.778085, 'recall': 0.5864154, 'specificity': 0.5864154, 'f1': 0.62773794, 'auroc': 0.7687917, 'binary_precision': 0.5846154, 'binary_recall': 0.17729394, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.27207637}
confusion matrix:
       0    1
0  18068   81
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.83573604, 'recall': 0.5902865, 'specificity': 0.5902865, 'f1': 0.6363373, 'auroc': 0.76700807, 'binary_precision': 0.7058824, 'binary_recall': 0.18390805, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2917933}
confusion matrix:
      0   1
0  5977  20
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_13.png
better model found
persisted
after epoch: 13,now: 2024-06-21 14:58:10.169572,epoch time: 0:18:55.320677,used: 3:34:54.991847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9863496, 'precision': 0.98350084, 'recall': 0.93559456, 'specificity': 0.93559456, 'f1': 0.9579861, 'auroc': 0.99296343, 'binary_precision': 0.9800766, 'binary_recall': 0.8730375, 'binary_specificity': 0.99815154, 'binary_f1_score': 0.92346567}
confusion matrix:
       0     1
0  42119    78
1    558  3837
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77365375, 'recall': 0.5863328, 'specificity': 0.5863328, 'f1': 0.6272112, 'auroc': 0.7787365, 'binary_precision': 0.57575756, 'binary_recall': 0.17729394, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.27110583}
confusion matrix:
       0    1
0  18065   84
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.7719134, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_14.png
early stop counter: 1
val acc:0.9673797488212585, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 14,now: 2024-06-21 15:13:48.898667,epoch time: 0:15:38.729095,used: 3:50:33.720942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98692906, 'precision': 0.98313487, 'recall': 0.9395012, 'specificity': 0.9395012, 'f1': 0.96002555, 'auroc': 0.9924487, 'binary_precision': 0.9785624, 'binary_recall': 0.88101727, 'binary_specificity': 0.9979852, 'binary_f1_score': 0.9272315}
confusion matrix:
       0     1
0  42103    85
1    524  3880
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77334225, 'recall': 0.5901106, 'specificity': 0.5901106, 'f1': 0.6316699, 'auroc': 0.7866856, 'binary_precision': 0.5748792, 'binary_recall': 0.18506998, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.27999997}
confusion matrix:
       0    1
0  18061   88
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.80952287, 'recall': 0.591702, 'specificity': 0.591702, 'f1': 0.6360632, 'auroc': 0.78054166, 'binary_precision': 0.6533333, 'binary_recall': 0.18773946, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.29166666}
confusion matrix:
      0   1
0  5971  26
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_15.png
early stop counter: 2
val acc:0.967432975769043, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 15,now: 2024-06-21 15:26:35.683491,epoch time: 0:12:46.784824,used: 4:03:20.505766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9873798, 'precision': 0.98518443, 'recall': 0.9402318, 'specificity': 0.9402318, 'f1': 0.9613415, 'auroc': 0.99437034, 'binary_precision': 0.9825405, 'binary_recall': 0.88209903, 'binary_specificity': 0.99836457, 'binary_f1_score': 0.92961454}
confusion matrix:
       0     1
0  42121    69
1    519  3883
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76604223, 'recall': 0.591473, 'specificity': 0.591473, 'f1': 0.6324612, 'auroc': 0.78763884, 'binary_precision': 0.5601852, 'binary_recall': 0.1881804, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.28172293}
confusion matrix:
       0    1
0  18054   95
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8207557, 'recall': 0.5975325, 'specificity': 0.5975325, 'f1': 0.64423865, 'auroc': 0.7816218, 'binary_precision': 0.6753247, 'binary_recall': 0.19923371, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3076923}
confusion matrix:
      0   1
0  5972  25
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_16.png
early stop counter: 3
val acc:0.9671669006347656, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 16,now: 2024-06-21 15:38:01.493144,epoch time: 0:11:25.809653,used: 4:14:46.315419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98763734, 'precision': 0.9842437, 'recall': 0.9425609, 'specificity': 0.9425609, 'f1': 0.9622283, 'auroc': 0.9936998, 'binary_precision': 0.98015076, 'binary_recall': 0.88699406, 'binary_specificity': 0.9981277, 'binary_f1_score': 0.93124855}
confusion matrix:
       0     1
0  42115    79
1    497  3901
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.76998943, 'recall': 0.59155566, 'specificity': 0.59155566, 'f1': 0.6329964, 'auroc': 0.7889981, 'binary_precision': 0.5680751, 'binary_recall': 0.1881804, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.28271028}
confusion matrix:
       0    1
0  18057   92
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8231423, 'recall': 0.5919521, 'specificity': 0.5919521, 'f1': 0.63750255, 'auroc': 0.77915585, 'binary_precision': 0.6805556, 'binary_recall': 0.18773946, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2942943}
confusion matrix:
      0   1
0  5974  23
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_17.png
early stop counter: 4
val acc:0.9673265218734741, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 17,now: 2024-06-21 15:53:16.165466,epoch time: 0:15:14.672322,used: 4:30:00.987741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9884959, 'precision': 0.9850275, 'recall': 0.9469284, 'specificity': 0.9469284, 'f1': 0.9650018, 'auroc': 0.9941937, 'binary_precision': 0.9808362, 'binary_recall': 0.8956818, 'binary_specificity': 0.998175, 'binary_f1_score': 0.9363269}
confusion matrix:
       0     1
0  42115    77
1    459  3941
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.772753, 'recall': 0.59463847, 'specificity': 0.59463847, 'f1': 0.63686097, 'auroc': 0.79147017, 'binary_precision': 0.5733945, 'binary_recall': 0.19440125, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.29036006}
confusion matrix:
       0    1
0  18056   93
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7986313, 'recall': 0.59894794, 'specificity': 0.59894794, 'f1': 0.6438047, 'auroc': 0.7875898, 'binary_precision': 0.63095236, 'binary_recall': 0.20306513, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.30724636}
confusion matrix:
      0   1
0  5966  31
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_18.png
early stop counter: 5
val acc:0.9674861431121826, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 18,now: 2024-06-21 16:06:53.099497,epoch time: 0:13:36.934031,used: 4:43:37.921772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9884959, 'precision': 0.9856808, 'recall': 0.9463297, 'specificity': 0.9463297, 'f1': 0.96496433, 'auroc': 0.99500203, 'binary_precision': 0.982281, 'binary_recall': 0.8943422, 'binary_specificity': 0.9983172, 'binary_f1_score': 0.9362512}
confusion matrix:
       0     1
0  42120    71
1    465  3936
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7736821, 'recall': 0.5893606, 'specificity': 0.5893606, 'f1': 0.6308212, 'auroc': 0.7937023, 'binary_precision': 0.57560974, 'binary_recall': 0.18351477, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.2783019}
confusion matrix:
       0    1
0  18062   87
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8020665, 'recall': 0.58595484, 'specificity': 0.58595484, 'f1': 0.62824726, 'auroc': 0.781268, 'binary_precision': 0.6388889, 'binary_recall': 0.17624521, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.2762763}
confusion matrix:
      0   1
0  5971  26
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_19.png
early stop counter: 6
val acc:0.967432975769043, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 19,now: 2024-06-21 16:17:36.606585,epoch time: 0:10:43.507088,used: 4:54:21.428860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9890968, 'precision': 0.98466825, 'recall': 0.9508118, 'specificity': 0.9508118, 'f1': 0.9669713, 'auroc': 0.9945666, 'binary_precision': 0.97930527, 'binary_recall': 0.90361446, 'binary_specificity': 0.99800915, 'binary_f1_score': 0.9399385}
confusion matrix:
       0     1
0  42109    84
1    424  3975
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77057576, 'recall': 0.5968611, 'specificity': 0.5968611, 'f1': 0.6391312, 'auroc': 0.8006544, 'binary_precision': 0.5688889, 'binary_recall': 0.19906688, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.29493088}
confusion matrix:
       0    1
0  18052   97
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7838274, 'recall': 0.5818733, 'specificity': 0.5818733, 'f1': 0.62163967, 'auroc': 0.78510326, 'binary_precision': 0.60273975, 'binary_recall': 0.16858238, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.26347306}
confusion matrix:
      0   1
0  5968  29
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_20.png
early stop counter: 7
val acc:0.967432975769043, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 20,now: 2024-06-21 16:28:45.023120,epoch time: 0:11:08.416535,used: 5:05:29.845395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9888822, 'precision': 0.9876865, 'recall': 0.94680613, 'specificity': 0.94680613, 'f1': 0.96612644, 'auroc': 0.99513733, 'binary_precision': 0.9862431, 'binary_recall': 0.894916, 'binary_specificity': 0.99869627, 'binary_f1_score': 0.9383627}
confusion matrix:
       0     1
0  42131    55
1    463  3943
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76854944, 'recall': 0.58472246, 'specificity': 0.58472246, 'f1': 0.6247786, 'auroc': 0.79449725, 'binary_precision': 0.56565654, 'binary_recall': 0.17418352, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.2663496}
confusion matrix:
       0    1
0  18063   86
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.7784072, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_21.png
early stop counter: 8
val acc:0.9671669006347656, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 21,now: 2024-06-21 16:40:25.644051,epoch time: 0:11:40.620931,used: 5:17:10.466326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98920417, 'precision': 0.9853685, 'recall': 0.9507144, 'specificity': 0.9507144, 'f1': 0.96723723, 'auroc': 0.994666, 'binary_precision': 0.9807265, 'binary_recall': 0.9032772, 'binary_specificity': 0.9981516, 'binary_f1_score': 0.94040996}
confusion matrix:
       0     1
0  42120    78
1    425  3969
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7660152, 'recall': 0.5876951, 'specificity': 0.5876951, 'f1': 0.6280588, 'auroc': 0.80241925, 'binary_precision': 0.5603865, 'binary_recall': 0.18040435, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.27294117}
confusion matrix:
       0    1
0  18058   91
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8096023, 'recall': 0.57112944, 'specificity': 0.57112944, 'f1': 0.6091608, 'auroc': 0.7864287, 'binary_precision': 0.6551724, 'binary_recall': 0.14559387, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2382445}
confusion matrix:
      0   1
0  5977  20
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_22.png
early stop counter: 9
val acc:0.9671136736869812, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 22,now: 2024-06-21 16:51:28.386615,epoch time: 0:11:02.742564,used: 5:28:13.208890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98986953, 'precision': 0.9865604, 'recall': 0.9535801, 'specificity': 0.9535801, 'f1': 0.9693446, 'auroc': 0.99622655, 'binary_precision': 0.982551, 'binary_recall': 0.9088429, 'binary_specificity': 0.99831724, 'binary_f1_score': 0.9442608}
confusion matrix:
       0     1
0  42122    71
1    401  3998
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7682469, 'recall': 0.5748891, 'specificity': 0.5748891, 'f1': 0.6125952, 'auroc': 0.79832137, 'binary_precision': 0.5657143, 'binary_recall': 0.15396579, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.24205379}
confusion matrix:
       0   1
0  18073  76
1    544  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7834339, 'recall': 0.5595518, 'specificity': 0.5595518, 'f1': 0.5916666, 'auroc': 0.77657557, 'binary_precision': 0.6037736, 'binary_recall': 0.12260536, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.20382164}
confusion matrix:
      0   1
0  5976  21
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_23.png
early stop counter: 10
val acc:0.9670072197914124, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 23,now: 2024-06-21 17:02:14.002935,epoch time: 0:10:45.616320,used: 5:38:58.825210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9900841, 'precision': 0.987671, 'recall': 0.9538417, 'specificity': 0.9538417, 'f1': 0.96999407, 'auroc': 0.9945457, 'binary_precision': 0.9847478, 'binary_recall': 0.90915287, 'binary_specificity': 0.99853045, 'binary_f1_score': 0.9454417}
confusion matrix:
       0     1
0  42127    62
1    400  4003
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7750937, 'recall': 0.58938813, 'specificity': 0.58938813, 'f1': 0.6309993, 'auroc': 0.7999671, 'binary_precision': 0.57843137, 'binary_recall': 0.18351477, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.27863047}
confusion matrix:
       0    1
0  18063   86
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.77479696, 'recall': 0.5631331, 'specificity': 0.5631331, 'f1': 0.5962936, 'auroc': 0.77950823, 'binary_precision': 0.5862069, 'binary_recall': 0.1302682, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21316615}
confusion matrix:
      0   1
0  5973  24
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_24.png
early stop counter: 11
val acc:0.9674861431121826, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 24,now: 2024-06-21 17:12:51.522790,epoch time: 0:10:37.519855,used: 5:49:36.345065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99006265, 'precision': 0.985306, 'recall': 0.9559266, 'specificity': 0.9559266, 'f1': 0.9700405, 'auroc': 0.9954871, 'binary_precision': 0.9795322, 'binary_recall': 0.91384405, 'binary_specificity': 0.99800915, 'binary_f1_score': 0.9455486}
confusion matrix:
       0     1
0  42109    84
1    379  4020
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76220304, 'recall': 0.5913903, 'specificity': 0.5913903, 'f1': 0.6319294, 'auroc': 0.8052554, 'binary_precision': 0.5525114, 'binary_recall': 0.1881804, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.28074247}
confusion matrix:
       0    1
0  18051   98
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7755717, 'recall': 0.5687135, 'specificity': 0.5687135, 'f1': 0.6039449, 'auroc': 0.7797657, 'binary_precision': 0.5873016, 'binary_recall': 0.14176245, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.22839507}
confusion matrix:
      0   1
0  5971  26
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_25.png
early stop counter: 12
val acc:0.9670072197914124, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 25,now: 2024-06-21 17:23:30.960528,epoch time: 0:10:39.437738,used: 6:00:15.782803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.98819166, 'recall': 0.9591943, 'specificity': 0.9591943, 'f1': 0.9731358, 'auroc': 0.99536574, 'binary_precision': 0.9846939, 'binary_recall': 0.919882, 'binary_specificity': 0.9985066, 'binary_f1_score': 0.9511852}
confusion matrix:
       0     1
0  42123    63
1    353  4053
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76817083, 'recall': 0.5892503, 'specificity': 0.5892503, 'f1': 0.6301126, 'auroc': 0.8074912, 'binary_precision': 0.5645933, 'binary_recall': 0.18351477, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.2769953}
confusion matrix:
       0    1
0  18058   91
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7686506, 'recall': 0.56488204, 'specificity': 0.56488204, 'f1': 0.5983627, 'auroc': 0.7850824, 'binary_precision': 0.57377046, 'binary_recall': 0.13409962, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.21739131}
confusion matrix:
      0   1
0  5971  26
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_26.png
early stop counter: 13
val acc:0.9672200679779053, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 26,now: 2024-06-21 17:34:37.246945,epoch time: 0:11:06.286417,used: 6:11:22.069220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99053484, 'precision': 0.9869957, 'recall': 0.95714176, 'specificity': 0.95714176, 'f1': 0.9714762, 'auroc': 0.9960003, 'binary_precision': 0.9826998, 'binary_recall': 0.9159664, 'binary_specificity': 0.9983171, 'binary_f1_score': 0.9481604}
confusion matrix:
       0     1
0  42118    71
1    370  4033
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76628435, 'recall': 0.5869451, 'specificity': 0.5869451, 'f1': 0.6272018, 'auroc': 0.8135284, 'binary_precision': 0.5609756, 'binary_recall': 0.17884915, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.2712264}
confusion matrix:
       0    1
0  18059   90
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7672525, 'recall': 0.5593017, 'specificity': 0.5593017, 'f1': 0.59057665, 'auroc': 0.78818446, 'binary_precision': 0.5714286, 'binary_recall': 0.12260536, 'binary_specificity': 0.995998, 'binary_f1_score': 0.20189273}
confusion matrix:
      0   1
0  5973  24
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_27.png
early stop counter: 14
val acc:0.9671136736869812, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 27,now: 2024-06-21 17:45:38.149770,epoch time: 0:11:00.902825,used: 6:22:22.972045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911144, 'precision': 0.9880965, 'recall': 0.9594418, 'specificity': 0.9594418, 'f1': 0.97322536, 'auroc': 0.99639916, 'binary_precision': 0.984432, 'binary_recall': 0.92040026, 'binary_specificity': 0.99848324, 'binary_f1_score': 0.95133984}
confusion matrix:
       0     1
0  42131    64
1    350  4047
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77401495, 'recall': 0.58558273, 'specificity': 0.58558273, 'f1': 0.6263429, 'auroc': 0.8076646, 'binary_precision': 0.57653064, 'binary_recall': 0.17573872, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.2693683}
confusion matrix:
       0    1
0  18066   83
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7698505, 'recall': 0.555637, 'specificity': 0.555637, 'f1': 0.58548033, 'auroc': 0.77472425, 'binary_precision': 0.5769231, 'binary_recall': 0.11494253, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.19169329}
confusion matrix:
      0   1
0  5975  22
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_28.png
early stop counter: 15
val acc:0.9673797488212585, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 28,now: 2024-06-21 17:58:53.927145,epoch time: 0:13:15.777375,used: 6:35:38.749420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99066365, 'precision': 0.9862238, 'recall': 0.95859087, 'specificity': 0.95859087, 'f1': 0.97189987, 'auroc': 0.99536836, 'binary_precision': 0.9808299, 'binary_recall': 0.9190541, 'binary_specificity': 0.9981277, 'binary_f1_score': 0.94893765}
confusion matrix:
       0     1
0  42115    79
1    356  4042
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77667964, 'recall': 0.58336014, 'specificity': 0.58336014, 'f1': 0.62388545, 'auroc': 0.80967605, 'binary_precision': 0.58201057, 'binary_recall': 0.1710731, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.26442307}
confusion matrix:
       0    1
0  18070   79
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7811685, 'recall': 0.5502234, 'specificity': 0.5502234, 'f1': 0.5779159, 'auroc': 0.779727, 'binary_precision': 0.6, 'binary_recall': 0.10344828, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5979  18
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_29.png
early stop counter: 16
val acc:0.967432975769043, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 29,now: 2024-06-21 18:09:59.497354,epoch time: 0:11:05.570209,used: 6:46:44.319629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9911144, 'precision': 0.9895984, 'recall': 0.9580344, 'specificity': 0.9580344, 'f1': 0.97315717, 'auroc': 0.9958525, 'binary_precision': 0.9877601, 'binary_recall': 0.9172539, 'binary_specificity': 0.99881494, 'binary_f1_score': 0.9512023}
confusion matrix:
       0     1
0  42143    50
1    364  4035
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7693548, 'recall': 0.5862501, 'specificity': 0.5862501, 'f1': 0.6266878, 'auroc': 0.8139708, 'binary_precision': 0.5671642, 'binary_recall': 0.17729394, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.27014217}
confusion matrix:
       0    1
0  18062   87
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7685006, 'recall': 0.55746937, 'specificity': 0.55746937, 'f1': 0.5880447, 'auroc': 0.7881427, 'binary_precision': 0.5740741, 'binary_recall': 0.118773945, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.1968254}
confusion matrix:
      0   1
0  5974  23
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_30.png
early stop counter: 17
val acc:0.9672200679779053, best validation acc: 0.967539370059967, corresponding to test acc:                         0.9627676606178284 / 0.9637264013290405
after epoch: 30,now: 2024-06-21 18:20:56.731959,epoch time: 0:10:57.234605,used: 6:57:41.554234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:57:41.554234 at 2024-06-21 18:20:56.731959
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.83573604, 'recall': 0.5902865, 'specificity': 0.5902865, 'f1': 0.6363373, 'auroc': 0.76700807, 'binary_precision': 0.7058824, 'binary_recall': 0.18390805, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2917933}
confusion matrix:
      0   1
0  5977  20
1   213  48
oracle model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.8512434, 'recall': 0.59994847, 'specificity': 0.59994847, 'f1': 0.64984286, 'auroc': 0.764541, 'binary_precision': 0.7361111, 'binary_recall': 0.20306513, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3183183}
confusion matrix:
      0   1
0  5978  19
1   208  53
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   3077 MiB | 403338 GiB | 403337 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |  36161 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   3077 MiB | 403338 GiB | 403337 GiB |
|       from large pool | 167936 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |  36161 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   3071 MiB | 403308 GiB | 403308 GiB |
|       from large pool | 165120 KiB |   3001 MiB | 403287 GiB | 403287 GiB |
|       from small pool |  35968 KiB |     71 MiB |     20 GiB |     20 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4304 MiB |   4304 MiB |   4304 MiB |      0 B   |
|       from large pool |   4230 MiB |   4230 MiB |   4230 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB | 294979 GiB | 294978 GiB |
|       from large pool |    780 MiB |   1612 MiB | 294957 GiB | 294956 GiB |
|       from small pool |      6 MiB |     12 MiB |     22 GiB |     22 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |    5585 K  |    5584 K  |
|       from large pool |      36    |      76    |    2266 K  |    2266 K  |
|       from small pool |    1014    |    1636    |    3319 K  |    3318 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |    5585 K  |    5584 K  |
|       from large pool |      36    |      76    |    2266 K  |    2266 K  |
|       from small pool |    1014    |    1636    |    3319 K  |    3318 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     198    |    2976 K  |    2976 K  |
|       from large pool |       5    |      10    |     705 K  |     705 K  |
|       from small pool |      27    |     193    |    2270 K  |    2270 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 403338 GiB | 403338 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |      0 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 403338 GiB | 403338 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |      0 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 403308 GiB | 403308 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 403287 GiB | 403287 GiB |
|       from small pool |      0 KiB |     71 MiB |     20 GiB |     20 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   4304 MiB |   4304 MiB |   3318 MiB |
|       from large pool |    944 MiB |   4230 MiB |   4230 MiB |   3286 MiB |
|       from small pool |     42 MiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 294979 GiB | 294979 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 294957 GiB | 294957 GiB |
|       from small pool |      0 KiB |     14 MiB |     22 GiB |     22 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    5585 K  |    5585 K  |
|       from large pool |       2    |      76    |    2266 K  |    2266 K  |
|       from small pool |       0    |    1636    |    3319 K  |    3319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    5585 K  |    5585 K  |
|       from large pool |       2    |      76    |    2266 K  |    2266 K  |
|       from small pool |       0    |    1636    |    3319 K  |    3319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    2976 K  |    2976 K  |
|       from large pool |       1    |      11    |     705 K  |     705 K  |
|       from small pool |       0    |     193    |    2270 K  |    2270 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB | 403338 GiB | 403338 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |      0 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB | 403338 GiB | 403338 GiB |
|       from large pool |  16640 KiB |   3007 MiB | 403316 GiB | 403316 GiB |
|       from small pool |      0 KiB |     72 MiB |     21 GiB |     21 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB | 403308 GiB | 403308 GiB |
|       from large pool |  16640 KiB |   3001 MiB | 403287 GiB | 403287 GiB |
|       from small pool |      0 KiB |     71 MiB |     20 GiB |     20 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   4304 MiB |   4304 MiB |   3318 MiB |
|       from large pool |    944 MiB |   4230 MiB |   4230 MiB |   3286 MiB |
|       from small pool |     42 MiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 294979 GiB | 294979 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 294957 GiB | 294957 GiB |
|       from small pool |      0 KiB |     14 MiB |     22 GiB |     22 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |    5585 K  |    5585 K  |
|       from large pool |       2    |      76    |    2266 K  |    2266 K  |
|       from small pool |       0    |    1636    |    3319 K  |    3319 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |    5585 K  |    5585 K  |
|       from large pool |       2    |      76    |    2266 K  |    2266 K  |
|       from small pool |       0    |    1636    |    3319 K  |    3319 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    2976 K  |    2976 K  |
|       from large pool |       1    |      11    |     705 K  |     705 K  |
|       from small pool |       0    |     193    |    2270 K  |    2270 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819

 Experiment start at: 2024-06-21 18:27:14.769255
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90579927, 'precision': 0.59340775, 'recall': 0.50392157, 'specificity': 0.50392157, 'f1': 0.48552567, 'auroc': 0.86222506, 'binary_precision': 0.27878788, 'binary_recall': 0.010658016, 'binary_specificity': 0.9971852, 'binary_f1_score': 0.02053113}
confusion matrix:
       0    1
0  42157  119
1   4270   46
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.48202842, 'recall': 0.4995572, 'specificity': 0.4995572, 'f1': 0.4906363, 'auroc': 0.39296186, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18051  16
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.30444902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 18:38:16.058592,epoch time: 0:11:01.289337,used: 0:11:01.289337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94112724, 'precision': 0.93865144, 'recall': 0.693697, 'specificity': 0.693697, 'f1': 0.759598, 'auroc': 0.939029, 'binary_precision': 0.9359688, 'binary_recall': 0.3901137, 'binary_specificity': 0.99728024, 'binary_f1_score': 0.5506962}
confusion matrix:
       0     1
0  42168   115
1   2628  1681
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.6487342, 'recall': 0.5006876, 'specificity': 0.5006876, 'f1': 0.49232268, 'auroc': 0.5014168, 'binary_precision': 0.33333334, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0029585797}
confusion matrix:
       0  1
0  18065  2
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.49228716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 18:50:13.050234,epoch time: 0:11:56.991642,used: 0:22:58.280979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96246135, 'precision': 0.97473174, 'recall': 0.8002715, 'specificity': 0.8002715, 'f1': 0.86372507, 'auroc': 0.96489847, 'binary_precision': 0.98855835, 'binary_recall': 0.6012526, 'binary_specificity': 0.99929047, 'binary_f1_score': 0.7477282}
confusion matrix:
       0     1
0  42251    30
1   1719  2592
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8989659, 'recall': 0.50737405, 'specificity': 0.50737405, 'f1': 0.505562, 'auroc': 0.6012672, 'binary_precision': 0.8333333, 'binary_recall': 0.014858841, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.029197082}
confusion matrix:
       0   1
0  18065   2
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.64933693, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_3.png
better model found
persisted
after epoch: 3,now: 2024-06-21 19:01:30.490958,epoch time: 0:11:17.440724,used: 0:34:15.721703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9701022, 'precision': 0.98088855, 'recall': 0.8406304, 'specificity': 0.8406304, 'f1': 0.89615375, 'auroc': 0.97318554, 'binary_precision': 0.99324554, 'binary_recall': 0.6817339, 'binary_specificity': 0.9995269, 'binary_f1_score': 0.80852234}
confusion matrix:
       0     1
0  42258    20
1   1373  2941
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.82911086, 'recall': 0.5263031, 'specificity': 0.5263031, 'f1': 0.540772, 'auroc': 0.6407398, 'binary_precision': 0.6923077, 'binary_recall': 0.053491827, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.099310346}
confusion matrix:
       0   1
0  18051  16
1    637  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.68135643, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 19:13:33.657715,epoch time: 0:12:03.166757,used: 0:46:18.888460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97514594, 'precision': 0.9810661, 'recall': 0.8698448, 'specificity': 0.8698448, 'f1': 0.9165298, 'auroc': 0.9793987, 'binary_precision': 0.9879406, 'binary_recall': 0.740612, 'binary_specificity': 0.99907756, 'binary_f1_score': 0.8465819}
confusion matrix:
       0     1
0  42239    39
1   1119  3195
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.81875646, 'recall': 0.5444892, 'specificity': 0.5444892, 'f1': 0.5711002, 'auroc': 0.6697016, 'binary_precision': 0.6703297, 'binary_recall': 0.09063893, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.15968587}
confusion matrix:
       0   1
0  18037  30
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.74295425, 'recall': 0.518474, 'specificity': 0.518474, 'f1': 0.5251689, 'auroc': 0.7078451, 'binary_precision': 0.5263158, 'binary_recall': 0.03846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5937   9
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-21 19:24:33.211052,epoch time: 0:10:59.553337,used: 0:57:18.441797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.978859, 'precision': 0.9812154, 'recall': 0.89141095, 'specificity': 0.89141095, 'f1': 0.93061364, 'auroc': 0.9851339, 'binary_precision': 0.98397905, 'binary_recall': 0.7841226, 'binary_specificity': 0.99869925, 'binary_f1_score': 0.87275547}
confusion matrix:
       0     1
0  42229    55
1    930  3378
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.8052969, 'recall': 0.55238485, 'specificity': 0.55238485, 'f1': 0.5829856, 'auroc': 0.6903298, 'binary_precision': 0.64285713, 'binary_recall': 0.106983654, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.1834395}
confusion matrix:
       0   1
0  18027  40
1    601  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7951515, 'recall': 0.5318514, 'specificity': 0.5318514, 'f1': 0.54880047, 'auroc': 0.71248865, 'binary_precision': 0.6296296, 'binary_recall': 0.06538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.118466906}
confusion matrix:
      0   1
0  5936  10
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-21 19:36:22.954640,epoch time: 0:11:49.743588,used: 1:09:08.185385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97954583, 'precision': 0.98333967, 'recall': 0.89379436, 'specificity': 0.89379436, 'f1': 0.9329308, 'auroc': 0.9836811, 'binary_precision': 0.9877907, 'binary_recall': 0.788582, 'binary_specificity': 0.9990067, 'binary_f1_score': 0.87701637}
confusion matrix:
       0     1
0  42241    42
1    911  3398
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.80153143, 'recall': 0.55816233, 'specificity': 0.55816233, 'f1': 0.5914149, 'auroc': 0.7106053, 'binary_precision': 0.63492066, 'binary_recall': 0.11887073, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.20025031}
confusion matrix:
       0   1
0  18021  46
1    593  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.84016454, 'recall': 0.5529212, 'specificity': 0.5529212, 'f1': 0.58361495, 'auroc': 0.7337897, 'binary_precision': 0.71794873, 'binary_recall': 0.10769231, 'binary_specificity': 0.99815, 'binary_f1_score': 0.18729098}
confusion matrix:
      0   1
0  5935  11
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-21 19:48:55.322665,epoch time: 0:12:32.368025,used: 1:21:40.553410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98036146, 'precision': 0.9817939, 'recall': 0.8998942, 'specificity': 0.8998942, 'f1': 0.93614423, 'auroc': 0.9840785, 'binary_precision': 0.9834805, 'binary_recall': 0.8011601, 'binary_specificity': 0.99862826, 'binary_f1_score': 0.88300735}
confusion matrix:
       0     1
0  42224    58
1    857  3453
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.80512106, 'recall': 0.5625646, 'specificity': 0.5625646, 'f1': 0.5979099, 'auroc': 0.7182406, 'binary_precision': 0.64179105, 'binary_recall': 0.12778603, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.21313505}
confusion matrix:
       0   1
0  18019  48
1    587  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8535955, 'recall': 0.56061345, 'specificity': 0.56061345, 'f1': 0.59574187, 'auroc': 0.73744583, 'binary_precision': 0.74418604, 'binary_recall': 0.12307692, 'binary_specificity': 0.99815, 'binary_f1_score': 0.21122111}
confusion matrix:
      0   1
0  5935  11
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-21 20:01:29.487139,epoch time: 0:12:34.164474,used: 1:34:14.717884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98313016, 'precision': 0.9825937, 'recall': 0.91573155, 'specificity': 0.91573155, 'f1': 0.9460782, 'auroc': 0.98840463, 'binary_precision': 0.9819574, 'binary_recall': 0.83302414, 'binary_specificity': 0.99843895, 'binary_f1_score': 0.9013802}
confusion matrix:
       0     1
0  42214    66
1    720  3592
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7985599, 'recall': 0.5639398, 'specificity': 0.5639398, 'f1': 0.5995548, 'auroc': 0.73836493, 'binary_precision': 0.62857145, 'binary_recall': 0.1307578, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.21648216}
confusion matrix:
       0   1
0  18015  52
1    585  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8512211, 'recall': 0.5643755, 'specificity': 0.5643755, 'f1': 0.6012813, 'auroc': 0.7512361, 'binary_precision': 0.73913044, 'binary_recall': 0.13076924, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5934  12
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_9.png
new oracle model saved
early stop counter: 1
val acc:0.9660085439682007, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9614889025688171 / 0.961650013923645
after epoch: 9,now: 2024-06-21 20:12:46.003242,epoch time: 0:11:16.516103,used: 1:45:31.233987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9838599, 'precision': 0.98366475, 'recall': 0.91915333, 'specificity': 0.91915333, 'f1': 0.94855106, 'auroc': 0.9897446, 'binary_precision': 0.9834329, 'binary_recall': 0.8397495, 'binary_specificity': 0.9985572, 'binary_f1_score': 0.9059295}
confusion matrix:
       0     1
0  42219    61
1    691  3621
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7946546, 'recall': 0.5711478, 'specificity': 0.5711478, 'f1': 0.60926694, 'auroc': 0.7430042, 'binary_precision': 0.62025315, 'binary_recall': 0.14561664, 'binary_specificity': 0.996679, 'binary_f1_score': 0.2358604}
confusion matrix:
       0   1
0  18007  60
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8618306, 'recall': 0.57775295, 'specificity': 0.57775295, 'f1': 0.6209849, 'auroc': 0.7585798, 'binary_precision': 0.7592593, 'binary_recall': 0.15769231, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.26114652}
confusion matrix:
      0   1
0  5933  13
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_10.png
new oracle model saved
early stop counter: 2
val acc:0.9661152362823486, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9614889025688171 / 0.9626168012619019
after epoch: 10,now: 2024-06-21 20:24:21.207657,epoch time: 0:11:35.204415,used: 1:57:06.438402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98411745, 'precision': 0.9820564, 'recall': 0.92214245, 'specificity': 0.92214245, 'f1': 0.94963455, 'auroc': 0.990262, 'binary_precision': 0.9796028, 'binary_recall': 0.8460825, 'binary_specificity': 0.9982024, 'binary_f1_score': 0.90796024}
confusion matrix:
       0     1
0  42202    76
1    664  3650
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7960593, 'recall': 0.5755225, 'specificity': 0.5755225, 'f1': 0.6151851, 'auroc': 0.7555942, 'binary_precision': 0.6227545, 'binary_recall': 0.15453194, 'binary_specificity': 0.996513, 'binary_f1_score': 0.24761903}
confusion matrix:
       0    1
0  18004   63
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.86169827, 'recall': 0.58912325, 'specificity': 0.58912325, 'f1': 0.6365335, 'auroc': 0.7680302, 'binary_precision': 0.7580645, 'binary_recall': 0.18076923, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.2919255}
confusion matrix:
      0   1
0  5931  15
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-21 20:34:47.675421,epoch time: 0:10:26.467764,used: 2:07:32.906166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98594177, 'precision': 0.98500574, 'recall': 0.93051255, 'specificity': 0.93051255, 'f1': 0.95574355, 'auroc': 0.9908531, 'binary_precision': 0.98388803, 'binary_recall': 0.8624682, 'binary_specificity': 0.998557, 'binary_f1_score': 0.91918576}
confusion matrix:
       0     1
0  42212    61
1    594  3725
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.8078411, 'recall': 0.5705986, 'specificity': 0.5705986, 'f1': 0.60928196, 'auroc': 0.75982964, 'binary_precision': 0.64666665, 'binary_recall': 0.14413075, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.23572296}
confusion matrix:
       0   1
0  18014  53
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.85954785, 'recall': 0.5815151, 'specificity': 0.5815151, 'f1': 0.6260973, 'auroc': 0.7719197, 'binary_precision': 0.75438595, 'binary_recall': 0.16538462, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.27129337}
confusion matrix:
      0   1
0  5932  14
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_12.png
better model found
persisted
after epoch: 12,now: 2024-06-21 20:47:06.529156,epoch time: 0:12:18.853735,used: 2:19:51.759901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9866286, 'precision': 0.985548, 'recall': 0.93403774, 'specificity': 0.93403774, 'f1': 0.9579994, 'auroc': 0.9920938, 'binary_precision': 0.9842561, 'binary_recall': 0.8694947, 'binary_specificity': 0.9985808, 'binary_f1_score': 0.92332315}
confusion matrix:
       0     1
0  42218    60
1    563  3751
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79489696, 'recall': 0.5747795, 'specificity': 0.5747795, 'f1': 0.6141273, 'auroc': 0.76609635, 'binary_precision': 0.6204819, 'binary_recall': 0.15304606, 'binary_specificity': 0.996513, 'binary_f1_score': 0.24553037}
confusion matrix:
       0    1
0  18004   63
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.86592364, 'recall': 0.58728427, 'specificity': 0.58728427, 'f1': 0.6343223, 'auroc': 0.7790252, 'binary_precision': 0.76666665, 'binary_recall': 0.17692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.2875}
confusion matrix:
      0   1
0  5932  14
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_13.png
early stop counter: 1
val acc:0.9662219882011414, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9627779722213745 / 0.9632613658905029
after epoch: 13,now: 2024-06-21 20:57:55.514599,epoch time: 0:10:48.985443,used: 2:30:40.745344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98630667, 'precision': 0.98419106, 'recall': 0.9333552, 'specificity': 0.9333552, 'f1': 0.9570216, 'auroc': 0.9926411, 'binary_precision': 0.98166096, 'binary_recall': 0.8683662, 'binary_specificity': 0.99834424, 'binary_f1_score': 0.92154455}
confusion matrix:
       0     1
0  42207    70
1    568  3747
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.8135342, 'recall': 0.5728551, 'specificity': 0.5728551, 'f1': 0.6126867, 'auroc': 0.76439756, 'binary_precision': 0.65789473, 'binary_recall': 0.1485884, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.24242423}
confusion matrix:
       0    1
0  18015   52
1    573  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8618306, 'recall': 0.57775295, 'specificity': 0.57775295, 'f1': 0.6209849, 'auroc': 0.7664113, 'binary_precision': 0.7592593, 'binary_recall': 0.15769231, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.26114652}
confusion matrix:
      0   1
0  5933  13
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_14.png
better model found
persisted
after epoch: 14,now: 2024-06-21 21:08:37.373456,epoch time: 0:10:41.858857,used: 2:41:22.604201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98641396, 'precision': 0.9820807, 'recall': 0.93578, 'specificity': 0.93578, 'f1': 0.9574767, 'auroc': 0.9927457, 'binary_precision': 0.97688913, 'binary_recall': 0.8736647, 'binary_specificity': 0.9978953, 'binary_f1_score': 0.92239803}
confusion matrix:
       0     1
0  42197    89
1    544  3762
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8041253, 'recall': 0.5821813, 'specificity': 0.5821813, 'f1': 0.62442356, 'auroc': 0.77018166, 'binary_precision': 0.6384181, 'binary_recall': 0.1679049, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.26588234}
confusion matrix:
       0    1
0  18003   64
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8540297, 'recall': 0.5928012, 'specificity': 0.5928012, 'f1': 0.6408743, 'auroc': 0.7730142, 'binary_precision': 0.74242425, 'binary_recall': 0.18846154, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3006135}
confusion matrix:
      0   1
0  5929  17
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_15.png
better model found
persisted
after epoch: 15,now: 2024-06-21 21:19:02.005739,epoch time: 0:10:24.632283,used: 2:51:47.236484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9874442, 'precision': 0.98246, 'recall': 0.94173276, 'specificity': 0.94173276, 'f1': 0.9609777, 'auroc': 0.99262834, 'binary_precision': 0.9764706, 'binary_recall': 0.8856414, 'binary_specificity': 0.9978241, 'binary_f1_score': 0.92884076}
confusion matrix:
       0     1
0  42189    92
1    493  3818
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8064433, 'recall': 0.59021527, 'specificity': 0.59021527, 'f1': 0.6347477, 'auroc': 0.78561306, 'binary_precision': 0.64248705, 'binary_recall': 0.18424962, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.28637412}
confusion matrix:
       0    1
0  17998   69
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.87061656, 'recall': 0.60442376, 'specificity': 0.60442376, 'f1': 0.6570165, 'auroc': 0.79174316, 'binary_precision': 0.7746479, 'binary_recall': 0.21153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.3323263}
confusion matrix:
      0   1
0  5930  16
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-06-21 21:29:27.119943,epoch time: 0:10:25.114204,used: 3:02:12.350688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9880881, 'precision': 0.9864752, 'recall': 0.9419456, 'specificity': 0.9419456, 'f1': 0.96288097, 'auroc': 0.99430454, 'binary_precision': 0.98454005, 'binary_recall': 0.8853105, 'binary_specificity': 0.99858075, 'binary_f1_score': 0.93229234}
confusion matrix:
       0     1
0  42216    60
1    495  3821
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.799883, 'recall': 0.58647287, 'specificity': 0.58647287, 'f1': 0.62953067, 'auroc': 0.7869274, 'binary_precision': 0.6296296, 'binary_recall': 0.1768202, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.2761021}
confusion matrix:
       0    1
0  17997   70
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.85135853, 'recall': 0.58519304, 'specificity': 0.58519304, 'f1': 0.63063437, 'auroc': 0.7963002, 'binary_precision': 0.73770493, 'binary_recall': 0.17307693, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.28037384}
confusion matrix:
      0   1
0  5930  16
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_17.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9643893241882324 / 0.9643893241882324
after epoch: 17,now: 2024-06-21 21:39:53.381798,epoch time: 0:10:26.261855,used: 3:12:38.612543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98907536, 'precision': 0.9847678, 'recall': 0.9494246, 'specificity': 0.9494246, 'f1': 0.9662621, 'auroc': 0.9945573, 'binary_precision': 0.9795764, 'binary_recall': 0.9007651, 'binary_specificity': 0.9980841, 'binary_f1_score': 0.9385191}
confusion matrix:
       0     1
0  42198    81
1    428  3885
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.80912983, 'recall': 0.59753394, 'specificity': 0.59753394, 'f1': 0.6439121, 'auroc': 0.7954092, 'binary_precision': 0.647343, 'binary_recall': 0.19910847, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.30454543}
confusion matrix:
       0    1
0  17994   73
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8452095, 'recall': 0.59455615, 'specificity': 0.59455615, 'f1': 0.64249957, 'auroc': 0.7950697, 'binary_precision': 0.7246377, 'binary_recall': 0.1923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.30395138}
confusion matrix:
      0   1
0  5927  19
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_18.png
better model found
persisted
after epoch: 18,now: 2024-06-21 21:50:25.370077,epoch time: 0:10:31.988279,used: 3:23:10.600822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9823899, 'recall': 0.946941, 'specificity': 0.946941, 'f1': 0.9638215, 'auroc': 0.99395025, 'binary_precision': 0.97528994, 'binary_recall': 0.8962002, 'binary_specificity': 0.9976819, 'binary_f1_score': 0.93407387}
confusion matrix:
       0     1
0  42178    98
1    448  3868
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.8031469, 'recall': 0.5901599, 'specificity': 0.5901599, 'f1': 0.63439, 'auroc': 0.80072194, 'binary_precision': 0.63589746, 'binary_recall': 0.18424962, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  17996   71
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.83162534, 'recall': 0.5830177, 'specificity': 0.5830177, 'f1': 0.62650335, 'auroc': 0.79681873, 'binary_precision': 0.6984127, 'binary_recall': 0.16923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.27244583}
confusion matrix:
      0   1
0  5927  19
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_19.png
early stop counter: 1
val acc:0.9669156670570374, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 19,now: 2024-06-21 22:00:54.939443,epoch time: 0:10:29.569366,used: 3:33:40.170188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98875344, 'precision': 0.98666894, 'recall': 0.9457326, 'specificity': 0.9457326, 'f1': 0.9650812, 'auroc': 0.99521995, 'binary_precision': 0.98416346, 'binary_recall': 0.89293164, 'binary_specificity': 0.9985335, 'binary_f1_score': 0.9363305}
confusion matrix:
       0     1
0  42215    62
1    462  3853
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.81009173, 'recall': 0.5786326, 'specificity': 0.5786326, 'f1': 0.6202233, 'auroc': 0.79586273, 'binary_precision': 0.6506024, 'binary_recall': 0.16047548, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.25744933}
confusion matrix:
       0    1
0  18009   58
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.84184134, 'recall': 0.5775007, 'specificity': 0.5775007, 'f1': 0.6196228, 'auroc': 0.78816855, 'binary_precision': 0.71929824, 'binary_recall': 0.15769231, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2586751}
confusion matrix:
      0   1
0  5930  16
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_20.png
early stop counter: 2
val acc:0.9667556285858154, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 20,now: 2024-06-21 22:11:16.403462,epoch time: 0:10:21.464019,used: 3:44:01.634207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9889037, 'precision': 0.9851903, 'recall': 0.9479056, 'specificity': 0.9479056, 'f1': 0.9656193, 'auroc': 0.9947299, 'binary_precision': 0.98072046, 'binary_recall': 0.8976085, 'binary_specificity': 0.9982027, 'binary_f1_score': 0.93732566}
confusion matrix:
       0     1
0  42209    76
1    441  3866
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.79365456, 'recall': 0.5820152, 'specificity': 0.5820152, 'f1': 0.62340844, 'auroc': 0.8030666, 'binary_precision': 0.61748636, 'binary_recall': 0.1679049, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.26401868}
confusion matrix:
       0    1
0  17997   70
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8553118, 'recall': 0.58335406, 'specificity': 0.58335406, 'f1': 0.62838006, 'auroc': 0.80571455, 'binary_precision': 0.7457627, 'binary_recall': 0.16923077, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5931  15
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_21.png
early stop counter: 3
val acc:0.9663820862770081, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 21,now: 2024-06-21 22:21:44.780067,epoch time: 0:10:28.376605,used: 3:54:30.010812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9900841, 'precision': 0.98795587, 'recall': 0.9525114, 'specificity': 0.9525114, 'f1': 0.96940076, 'auroc': 0.99553096, 'binary_precision': 0.9853904, 'binary_recall': 0.90639484, 'binary_specificity': 0.9986281, 'binary_f1_score': 0.9442433}
confusion matrix:
       0     1
0  42218    58
1    404  3912
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.79303837, 'recall': 0.57475185, 'specificity': 0.57475185, 'f1': 0.6139673, 'auroc': 0.801728, 'binary_precision': 0.61676645, 'binary_recall': 0.15304606, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.24523808}
confusion matrix:
       0    1
0  18003   64
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.84826654, 'recall': 0.5775848, 'specificity': 0.5775848, 'f1': 0.6200742, 'auroc': 0.7997123, 'binary_precision': 0.73214287, 'binary_recall': 0.15769231, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.25949368}
confusion matrix:
      0   1
0  5931  15
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_22.png
early stop counter: 4
val acc:0.9661686420440674, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 22,now: 2024-06-21 22:32:08.551076,epoch time: 0:10:23.771009,used: 4:04:53.781821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9893758, 'precision': 0.98541033, 'recall': 0.9506649, 'specificity': 0.9506649, 'f1': 0.96723294, 'auroc': 0.99568355, 'binary_precision': 0.9806289, 'binary_recall': 0.9031511, 'binary_specificity': 0.99817866, 'binary_f1_score': 0.9402967}
confusion matrix:
       0     1
0  42199    77
1    418  3898
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.80790913, 'recall': 0.5771467, 'specificity': 0.5771467, 'f1': 0.61811453, 'auroc': 0.80121523, 'binary_precision': 0.64634144, 'binary_recall': 0.15750371, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.25328553}
confusion matrix:
       0    1
0  18009   58
1    567  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8241348, 'recall': 0.5734864, 'specificity': 0.5734864, 'f1': 0.6131483, 'auroc': 0.78560054, 'binary_precision': 0.68421054, 'binary_recall': 0.15, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.2460568}
confusion matrix:
      0   1
0  5928  18
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_23.png
early stop counter: 5
val acc:0.9666488766670227, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 23,now: 2024-06-21 22:42:31.399116,epoch time: 0:10:22.848040,used: 4:15:16.629861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98967636, 'precision': 0.9851696, 'recall': 0.9526921, 'specificity': 0.9526921, 'f1': 0.9682288, 'auroc': 0.99474967, 'binary_precision': 0.9797297, 'binary_recall': 0.9073001, 'binary_specificity': 0.99808407, 'binary_f1_score': 0.94212484}
confusion matrix:
       0     1
0  42196    81
1    400  3915
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.78919315, 'recall': 0.5833904, 'specificity': 0.5833904, 'f1': 0.624781, 'auroc': 0.80742943, 'binary_precision': 0.6084656, 'binary_recall': 0.17087667, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.26682132}
confusion matrix:
       0    1
0  17993   74
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8322649, 'recall': 0.5792556, 'specificity': 0.5792556, 'f1': 0.62149143, 'auroc': 0.80325997, 'binary_precision': 0.7, 'binary_recall': 0.16153847, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.2625}
confusion matrix:
      0   1
0  5928  18
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_24.png
early stop counter: 6
val acc:0.9662753343582153, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 24,now: 2024-06-21 22:52:49.912459,epoch time: 0:10:18.513343,used: 4:25:35.143204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9904061, 'precision': 0.987604, 'recall': 0.9547487, 'specificity': 0.9547487, 'f1': 0.9704618, 'auroc': 0.99489164, 'binary_precision': 0.9842224, 'binary_recall': 0.9109875, 'binary_specificity': 0.9985099, 'binary_f1_score': 0.94619}
confusion matrix:
       0     1
0  42215    63
1    384  3930
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.80020404, 'recall': 0.5806677, 'specificity': 0.5806677, 'f1': 0.6221837, 'auroc': 0.8101542, 'binary_precision': 0.6306818, 'binary_recall': 0.16493313, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.2614841}
confusion matrix:
       0    1
0  18002   65
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8279543, 'recall': 0.56788534, 'specificity': 0.56788534, 'f1': 0.60546726, 'auroc': 0.79987586, 'binary_precision': 0.6923077, 'binary_recall': 0.13846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23076923}
confusion matrix:
      0   1
0  5930  16
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_25.png
early stop counter: 7
val acc:0.9665421843528748, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 25,now: 2024-06-21 23:03:02.793383,epoch time: 0:10:12.880924,used: 4:35:48.024128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99094266, 'precision': 0.98717797, 'recall': 0.9583464, 'specificity': 0.9583464, 'f1': 0.9722133, 'auroc': 0.9950013, 'binary_precision': 0.98262596, 'binary_recall': 0.91834843, 'binary_specificity': 0.9983444, 'binary_f1_score': 0.9494005}
confusion matrix:
       0     1
0  42211    70
1    352  3959
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7970677, 'recall': 0.5820705, 'specificity': 0.5820705, 'f1': 0.6237453, 'auroc': 0.81105465, 'binary_precision': 0.6243094, 'binary_recall': 0.1679049, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.264637}
confusion matrix:
       0    1
0  17999   68
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.83093536, 'recall': 0.56980836, 'specificity': 0.56980836, 'f1': 0.608334, 'auroc': 0.798421, 'binary_precision': 0.6981132, 'binary_recall': 0.1423077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23642173}
confusion matrix:
      0   1
0  5930  16
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_26.png
early stop counter: 8
val acc:0.966488778591156, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 26,now: 2024-06-21 23:13:15.574291,epoch time: 0:10:12.780908,used: 4:46:00.805036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99077094, 'precision': 0.9887098, 'recall': 0.9558662, 'specificity': 0.9558662, 'f1': 0.97157586, 'auroc': 0.99590194, 'binary_precision': 0.98622245, 'binary_recall': 0.91303337, 'binary_specificity': 0.9986991, 'binary_f1_score': 0.94821775}
confusion matrix:
       0     1
0  42225    55
1    375  3937
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.80132926, 'recall': 0.57777894, 'specificity': 0.57777894, 'f1': 0.61850804, 'auroc': 0.80694973, 'binary_precision': 0.6331361, 'binary_recall': 0.1589896, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.25415677}
confusion matrix:
       0    1
0  18005   62
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8317251, 'recall': 0.56604636, 'specificity': 0.56604636, 'f1': 0.6029875, 'auroc': 0.793847, 'binary_precision': 0.7, 'binary_recall': 0.13461539, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.22580646}
confusion matrix:
      0   1
0  5931  15
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_27.png
early stop counter: 9
val acc:0.966488778591156, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 27,now: 2024-06-21 23:23:32.772916,epoch time: 0:10:17.198625,used: 4:56:18.003661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99053484, 'precision': 0.9871253, 'recall': 0.95589435, 'specificity': 0.95589435, 'f1': 0.97086453, 'auroc': 0.99580675, 'binary_precision': 0.9830085, 'binary_recall': 0.9133968, 'binary_specificity': 0.99839187, 'binary_f1_score': 0.94692504}
confusion matrix:
       0     1
0  42217    68
1    373  3934
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.78913414, 'recall': 0.5877373, 'specificity': 0.5877373, 'f1': 0.63015676, 'auroc': 0.82034713, 'binary_precision': 0.6080402, 'binary_recall': 0.17979197, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.27752292}
confusion matrix:
       0    1
0  17989   78
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8274087, 'recall': 0.5716474, 'specificity': 0.5716474, 'f1': 0.61075646, 'auroc': 0.80827254, 'binary_precision': 0.6909091, 'binary_recall': 0.14615385, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.24126984}
confusion matrix:
      0   1
0  5929  17
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_28.png
early stop counter: 10
val acc:0.9663820862770081, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 28,now: 2024-06-21 23:33:52.656963,epoch time: 0:10:19.884047,used: 5:06:37.887708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9916724, 'precision': 0.98785186, 'recall': 0.9620385, 'specificity': 0.9620385, 'f1': 0.9745072, 'auroc': 0.9959533, 'binary_precision': 0.9832264, 'binary_recall': 0.9256851, 'binary_specificity': 0.9983919, 'binary_f1_score': 0.95358855}
confusion matrix:
       0     1
0  42218    68
1    320  3986
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7886144, 'recall': 0.5906261, 'specificity': 0.5906261, 'f1': 0.6336144, 'auroc': 0.8207331, 'binary_precision': 0.60679615, 'binary_recall': 0.18573551, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.2844141}
confusion matrix:
       0    1
0  17986   81
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79341197, 'recall': 0.57114285, 'specificity': 0.57114285, 'f1': 0.6082486, 'auroc': 0.8077203, 'binary_precision': 0.6229508, 'binary_recall': 0.14615385, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.23676014}
confusion matrix:
      0   1
0  5923  23
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_29.png
early stop counter: 11
val acc:0.966435432434082, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 29,now: 2024-06-21 23:44:08.696465,epoch time: 0:10:16.039502,used: 5:16:53.927210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99152213, 'precision': 0.9881973, 'recall': 0.960853, 'specificity': 0.960853, 'f1': 0.97403324, 'auroc': 0.99621475, 'binary_precision': 0.9841741, 'binary_recall': 0.9232197, 'binary_specificity': 0.99848634, 'binary_f1_score': 0.9527229}
confusion matrix:
       0     1
0  42217    64
1    331  3980
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7901403, 'recall': 0.5884803, 'specificity': 0.5884803, 'f1': 0.63115674, 'auroc': 0.8203995, 'binary_precision': 0.61, 'binary_recall': 0.18127786, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.27949598}
confusion matrix:
       0    1
0  17989   78
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8210882, 'recall': 0.57532537, 'specificity': 0.57532537, 'f1': 0.61551017, 'auroc': 0.80216676, 'binary_precision': 0.6779661, 'binary_recall': 0.15384616, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.2507837}
confusion matrix:
      0   1
0  5927  19
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_30.png
early stop counter: 12
val acc:0.966435432434082, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.963100254535675 / 0.9643893241882324
after epoch: 30,now: 2024-06-21 23:54:19.266806,epoch time: 0:10:10.570341,used: 5:27:04.497551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_27_14_seed_1_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:27:04.497551 at 2024-06-21 23:54:19.266806
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.8452095, 'recall': 0.59455615, 'specificity': 0.59455615, 'f1': 0.64249957, 'auroc': 0.7950697, 'binary_precision': 0.7246377, 'binary_recall': 0.1923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.30395138}
confusion matrix:
      0   1
0  5927  19
1   210  50
oracle model performance metric: 

scalar performance:
{'acc': 0.9643893, 'precision': 0.87061656, 'recall': 0.60442376, 'specificity': 0.60442376, 'f1': 0.6570165, 'auroc': 0.79174316, 'binary_precision': 0.7746479, 'binary_recall': 0.21153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.3323263}
confusion matrix:
      0   1
0  5930  16
1   205  55
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool | 167936 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool | 167936 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   3071 MiB |    787 TiB |    787 TiB |
|       from large pool | 165120 KiB |   3001 MiB |    787 TiB |    787 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4154 MiB |   4304 MiB |   7472 MiB |   3318 MiB |
|       from large pool |   4082 MiB |   4230 MiB |   7368 MiB |   3286 MiB |
|       from small pool |     72 MiB |     74 MiB |    104 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB | 596897 GiB | 596896 GiB |
|       from large pool |    780 MiB |   1612 MiB | 596853 GiB | 596852 GiB |
|       from small pool |      6 MiB |     14 MiB |     44 GiB |     44 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |   11173 K  |   11172 K  |
|       from large pool |      36    |      76    |    4532 K  |    4532 K  |
|       from small pool |    1014    |    1636    |    6641 K  |    6640 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |   11173 K  |   11172 K  |
|       from large pool |      36    |      76    |    4532 K  |    4532 K  |
|       from small pool |    1014    |    1636    |    6641 K  |    6640 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      70    |      21    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      36    |      37    |      52    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     198    |    5892 K  |    5892 K  |
|       from large pool |       5    |      11    |    1426 K  |    1426 K  |
|       from small pool |      29    |     193    |    4466 K  |    4466 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3001 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   4304 MiB |   7472 MiB |   6486 MiB |
|       from large pool |    944 MiB |   4230 MiB |   7368 MiB |   6424 MiB |
|       from small pool |     42 MiB |     74 MiB |    104 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 596897 GiB | 596896 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 596853 GiB | 596852 GiB |
|       from small pool |      0 KiB |     14 MiB |     44 GiB |     44 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |   11173 K  |   11173 K  |
|       from large pool |       2    |      76    |    4532 K  |    4532 K  |
|       from small pool |       0    |    1636    |    6641 K  |    6641 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |   11173 K  |   11173 K  |
|       from large pool |       2    |      76    |    4532 K  |    4532 K  |
|       from small pool |       0    |    1636    |    6641 K  |    6641 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      70    |      40    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      52    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    5893 K  |    5893 K  |
|       from large pool |       1    |      11    |    1426 K  |    1426 K  |
|       from small pool |       0    |     193    |    4466 K  |    4466 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3007 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB |    787 TiB |    787 TiB |
|       from large pool |  16640 KiB |   3001 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   4304 MiB |   7472 MiB |   6486 MiB |
|       from large pool |    944 MiB |   4230 MiB |   7368 MiB |   6424 MiB |
|       from small pool |     42 MiB |     74 MiB |    104 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB | 596897 GiB | 596896 GiB |
|       from large pool | 786176 KiB |   1612 MiB | 596853 GiB | 596852 GiB |
|       from small pool |      0 KiB |     14 MiB |     44 GiB |     44 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |   11173 K  |   11173 K  |
|       from large pool |       2    |      76    |    4532 K  |    4532 K  |
|       from small pool |       0    |    1636    |    6641 K  |    6641 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |   11173 K  |   11173 K  |
|       from large pool |       2    |      76    |    4532 K  |    4532 K  |
|       from small pool |       0    |    1636    |    6641 K  |    6641 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      70    |      40    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      52    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     198    |    5893 K  |    5893 K  |
|       from large pool |       1    |      11    |    1426 K  |    1426 K  |
|       from small pool |       0    |     193    |    4466 K  |    4466 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819

 Experiment start at: 2024-06-21 23:58:36.764894
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9071252, 'precision': 0.95337546, 'recall': 0.5207094, 'specificity': 0.5207094, 'f1': 0.51531917, 'auroc': 0.8774742, 'binary_precision': 1.0, 'binary_recall': 0.041418813, 'binary_specificity': 1.0, 'binary_f1_score': 0.07954305}
confusion matrix:
       0    1
0  42309    0
1   4351  188
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.43860155, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.417471, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 00:08:51.585469,epoch time: 0:10:14.820575,used: 0:10:14.820575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94787395, 'precision': 0.9680161, 'recall': 0.7330631, 'specificity': 0.7330631, 'f1': 0.80312926, 'auroc': 0.9474385, 'binary_precision': 0.99018234, 'binary_recall': 0.4666226, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.63432163}
confusion matrix:
       0     1
0  42288    21
1   2421  2118
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.51522934, 'recall': 0.5004178, 'specificity': 0.5004178, 'f1': 0.49327758, 'auroc': 0.5443145, 'binary_precision': 0.0625, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.0032362458}
confusion matrix:
       0   1
0  18156  15
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.5818881, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_2.png
early stop counter: 1
val acc:0.9671869277954102, best validation acc: 0.9678794145584106, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-22 00:19:09.586449,epoch time: 0:10:18.000980,used: 0:20:32.821555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96185535, 'precision': 0.9770301, 'recall': 0.80468094, 'specificity': 0.80468094, 'f1': 0.86760944, 'auroc': 0.966704, 'binary_precision': 0.99425083, 'binary_recall': 0.60973996, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.7559077}
confusion matrix:
       0     1
0  42294    16
1   1771  2767
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7256943, 'recall': 0.51121515, 'specificity': 0.51121515, 'f1': 0.5140196, 'auroc': 0.60696757, 'binary_precision': 0.4827586, 'binary_recall': 0.023255814, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.04437401}
confusion matrix:
       0   1
0  18156  15
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7308278, 'recall': 0.50594825, 'specificity': 0.50594825, 'f1': 0.50220305, 'auroc': 0.6426471, 'binary_precision': 0.5, 'binary_recall': 0.012396694, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.024193548}
confusion matrix:
      0  1
0  5994  3
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_3.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9678794145584106, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 00:29:29.752523,epoch time: 0:10:20.166074,used: 0:30:52.987629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9694544, 'precision': 0.98009634, 'recall': 0.8447263, 'specificity': 0.8447263, 'f1': 0.89869785, 'auroc': 0.9747275, 'binary_precision': 0.99239546, 'binary_recall': 0.69001985, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.8140351}
confusion matrix:
       0     1
0  42285    24
1   1407  3132
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7681567, 'recall': 0.52752376, 'specificity': 0.52752376, 'f1': 0.54330724, 'auroc': 0.67680204, 'binary_precision': 0.56666666, 'binary_recall': 0.056478404, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.10271903}
confusion matrix:
       0   1
0  18145  26
1    568  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7591313, 'recall': 0.51999414, 'specificity': 0.51999414, 'f1': 0.52864, 'auroc': 0.70278203, 'binary_precision': 0.5555556, 'binary_recall': 0.041322313, 'binary_specificity': 0.998666, 'binary_f1_score': 0.07692308}
confusion matrix:
      0   1
0  5989   8
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-22 00:39:47.827127,epoch time: 0:10:18.074604,used: 0:41:11.062233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97532445, 'precision': 0.98045623, 'recall': 0.87728107, 'specificity': 0.87728107, 'f1': 0.9211482, 'auroc': 0.98214614, 'binary_precision': 0.9864826, 'binary_recall': 0.75567305, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.8557884}
confusion matrix:
       0     1
0  42262    47
1   1109  3430
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7855635, 'recall': 0.55116993, 'specificity': 0.55116993, 'f1': 0.58122325, 'auroc': 0.70320415, 'binary_precision': 0.6, 'binary_recall': 0.10465116, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.17821783}
confusion matrix:
       0   1
0  18129  42
1    539  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7992829, 'recall': 0.5625488, 'specificity': 0.5625488, 'f1': 0.597134, 'auroc': 0.71753144, 'binary_precision': 0.63265306, 'binary_recall': 0.12809917, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5979  18
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-22 00:50:05.234230,epoch time: 0:10:17.407103,used: 0:51:28.469336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9783342, 'precision': 0.98132324, 'recall': 0.89357656, 'specificity': 0.89357656, 'f1': 0.9319562, 'auroc': 0.985657, 'binary_precision': 0.984861, 'binary_recall': 0.78845304, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.8757802}
confusion matrix:
       0     1
0  42255    55
1    960  3578
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7791773, 'recall': 0.5632707, 'specificity': 0.5632707, 'f1': 0.59825796, 'auroc': 0.7206206, 'binary_precision': 0.5864662, 'binary_recall': 0.1295681, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.21224488}
confusion matrix:
       0   1
0  18116  55
1    524  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.86995065, 'recall': 0.5898252, 'specificity': 0.5898252, 'f1': 0.63849473, 'auroc': 0.73312896, 'binary_precision': 0.7719298, 'binary_recall': 0.18181819, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29431438}
confusion matrix:
      0   1
0  5984  13
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-22 01:00:26.512301,epoch time: 0:10:21.278071,used: 1:01:49.747407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9806822, 'precision': 0.98185164, 'recall': 0.9065038, 'specificity': 0.9065038, 'f1': 0.94017655, 'auroc': 0.98717844, 'binary_precision': 0.98324466, 'binary_recall': 0.8144966, 'binary_specificity': 0.99851096, 'binary_f1_score': 0.8909507}
confusion matrix:
       0     1
0  42246    63
1    842  3697
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.765364, 'recall': 0.5695575, 'specificity': 0.5695575, 'f1': 0.6058197, 'auroc': 0.7331959, 'binary_precision': 0.5584416, 'binary_recall': 0.14285715, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.22751325}
confusion matrix:
       0   1
0  18103  68
1    516  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.87774175, 'recall': 0.5980897, 'specificity': 0.5980897, 'f1': 0.6499148, 'auroc': 0.74427, 'binary_precision': 0.78688526, 'binary_recall': 0.1983471, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.31683168}
confusion matrix:
      0   1
0  5984  13
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_7.png
new oracle model saved
early stop counter: 1
val acc:0.9688915014266968, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9661805033683777 / 0.9668216109275818
after epoch: 7,now: 2024-06-22 01:10:45.516198,epoch time: 0:10:19.003897,used: 1:12:08.751304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98149335, 'precision': 0.98283184, 'recall': 0.9102768, 'specificity': 0.9102768, 'f1': 0.9428625, 'auroc': 0.9879552, 'binary_precision': 0.9844286, 'binary_recall': 0.821948, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.8958808}
confusion matrix:
       0     1
0  42251    59
1    808  3730
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7575612, 'recall': 0.5662077, 'specificity': 0.5662077, 'f1': 0.6008935, 'auroc': 0.7445477, 'binary_precision': 0.54304636, 'binary_recall': 0.13621262, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.21779549}
confusion matrix:
       0   1
0  18102  69
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.840266, 'recall': 0.59552336, 'specificity': 0.59552336, 'f1': 0.64380527, 'auroc': 0.7445219, 'binary_precision': 0.7121212, 'binary_recall': 0.19421488, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3051948}
confusion matrix:
      0   1
0  5978  19
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_8.png
early stop counter: 2
val acc:0.9686251282691956, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9661805033683777 / 0.9668216109275818
after epoch: 8,now: 2024-06-22 01:21:02.490778,epoch time: 0:10:16.974580,used: 1:22:25.725884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9825393, 'precision': 0.9818945, 'recall': 0.91707075, 'specificity': 0.91707075, 'f1': 0.94654894, 'auroc': 0.98835766, 'binary_precision': 0.9811223, 'binary_recall': 0.8358669, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.90268856}
confusion matrix:
       0     1
0  42236    73
1    745  3794
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7638545, 'recall': 0.57761544, 'specificity': 0.57761544, 'f1': 0.61594355, 'auroc': 0.75649345, 'binary_precision': 0.5549133, 'binary_recall': 0.15946844, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.24774195}
confusion matrix:
       0   1
0  18094  77
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.8651239, 'recall': 0.6040379, 'specificity': 0.6040379, 'f1': 0.6565433, 'auroc': 0.75871754, 'binary_precision': 0.76119405, 'binary_recall': 0.2107438, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3300971}
confusion matrix:
      0   1
0  5981  16
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_9.png
early stop counter: 3
val acc:0.968944787979126, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9661805033683777 / 0.9668216109275818
after epoch: 9,now: 2024-06-22 01:31:23.473431,epoch time: 0:10:20.982653,used: 1:32:46.708537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98281676, 'precision': 0.98309505, 'recall': 0.91761774, 'specificity': 0.91761774, 'f1': 0.94737005, 'auroc': 0.9894706, 'binary_precision': 0.9834283, 'binary_recall': 0.8367482, 'binary_specificity': 0.9984873, 'binary_f1_score': 0.9041781}
confusion matrix:
       0     1
0  42245    64
1    741  3798
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.76273227, 'recall': 0.56709325, 'specificity': 0.56709325, 'f1': 0.60240906, 'auroc': 0.7543959, 'binary_precision': 0.55333334, 'binary_recall': 0.13787375, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.22074468}
confusion matrix:
       0   1
0  18104  67
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.8758874, 'recall': 0.59602356, 'specificity': 0.59602356, 'f1': 0.64708775, 'auroc': 0.745453, 'binary_precision': 0.78333336, 'binary_recall': 0.19421488, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3112583}
confusion matrix:
      0   1
0  5984  13
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_10.png
early stop counter: 4
val acc:0.9687849283218384, best validation acc: 0.9691578149795532, corresponding to test acc:                         0.9661805033683777 / 0.9668216109275818
after epoch: 10,now: 2024-06-22 01:41:45.103710,epoch time: 0:10:21.630279,used: 1:43:08.338816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.984439, 'precision': 0.9834582, 'recall': 0.92657965, 'specificity': 0.92657965, 'f1': 0.95278424, 'auroc': 0.9893265, 'binary_precision': 0.98227847, 'binary_recall': 0.8548138, 'binary_specificity': 0.9983455, 'binary_f1_score': 0.91412413}
confusion matrix:
       0     1
0  42239    70
1    659  3880
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7812627, 'recall': 0.56897455, 'specificity': 0.56897455, 'f1': 0.606115, 'auroc': 0.76107377, 'binary_precision': 0.5902778, 'binary_recall': 0.14119601, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.22788203}
confusion matrix:
       0   1
0  18112  59
1    517  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8592915, 'recall': 0.59783953, 'specificity': 0.59783953, 'f1': 0.6482364, 'auroc': 0.7546775, 'binary_precision': 0.75, 'binary_recall': 0.1983471, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3137255}
confusion matrix:
      0   1
0  5981  16
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_11.png
better model found
persisted
after epoch: 11,now: 2024-06-22 01:52:09.498564,epoch time: 0:10:24.394854,used: 1:53:32.733670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.986168, 'precision': 0.98295546, 'recall': 0.9369774, 'specificity': 0.9369774, 'f1': 0.95851815, 'auroc': 0.99188364, 'binary_precision': 0.9790692, 'binary_recall': 0.87596387, 'binary_specificity': 0.99799097, 'binary_f1_score': 0.92465115}
confusion matrix:
       0     1
0  42224    85
1    563  3976
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76445353, 'recall': 0.5760094, 'specificity': 0.5760094, 'f1': 0.613993, 'auroc': 0.7725319, 'binary_precision': 0.556213, 'binary_recall': 0.15614618, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.24383917}
confusion matrix:
       0   1
0  18096  75
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8632529, 'recall': 0.60808676, 'specificity': 0.60808676, 'f1': 0.66140556, 'auroc': 0.76679456, 'binary_precision': 0.75714284, 'binary_recall': 0.21900827, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.33974358}
confusion matrix:
      0   1
0  5980  17
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_12.png
new oracle model saved
early stop counter: 1
val acc:0.968944787979126, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9669818878173828
after epoch: 12,now: 2024-06-22 02:02:32.376205,epoch time: 0:10:22.877641,used: 2:03:55.611311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98655224, 'precision': 0.9849216, 'recall': 0.9373869, 'specificity': 0.9373869, 'f1': 0.9596113, 'auroc': 0.9910159, 'binary_precision': 0.9829503, 'binary_recall': 0.8764045, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.9266248}
confusion matrix:
       0     1
0  42240    69
1    561  3978
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7680601, 'recall': 0.5793041, 'specificity': 0.5793041, 'f1': 0.61840177, 'auroc': 0.78747654, 'binary_precision': 0.5632184, 'binary_recall': 0.1627907, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.2525773}
confusion matrix:
       0   1
0  18095  76
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8738086, 'recall': 0.61436844, 'specificity': 0.61436844, 'f1': 0.6700407, 'auroc': 0.777756, 'binary_precision': 0.7777778, 'binary_recall': 0.23140496, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3566879}
confusion matrix:
      0   1
0  5981  16
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_13.png
new oracle model saved
early stop counter: 2
val acc:0.9691045880317688, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9676229953765869
after epoch: 13,now: 2024-06-22 02:12:48.456455,epoch time: 0:10:16.080250,used: 2:14:11.691561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98655224, 'precision': 0.9829974, 'recall': 0.9391569, 'specificity': 0.9391569, 'f1': 0.95976293, 'auroc': 0.9936728, 'binary_precision': 0.9786921, 'binary_recall': 0.88037014, 'binary_specificity': 0.9979437, 'binary_f1_score': 0.92693114}
confusion matrix:
       0     1
0  42222    87
1    543  3996
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76832134, 'recall': 0.58254385, 'specificity': 0.58254385, 'f1': 0.6223935, 'auroc': 0.7822945, 'binary_precision': 0.5635359, 'binary_recall': 0.16943522, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.2605364}
confusion matrix:
       0    1
0  18092   79
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8701311, 'recall': 0.61635125, 'specificity': 0.61635125, 'f1': 0.67207515, 'auroc': 0.7771268, 'binary_precision': 0.7702703, 'binary_recall': 0.23553719, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3607595}
confusion matrix:
      0   1
0  5980  17
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_14.png
early stop counter: 3
val acc:0.9691578149795532, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9676229953765869
after epoch: 14,now: 2024-06-22 02:23:02.383013,epoch time: 0:10:13.926558,used: 2:24:25.618119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9862961, 'precision': 0.98282504, 'recall': 0.9378216, 'specificity': 0.9378216, 'f1': 0.9589366, 'auroc': 0.99263996, 'binary_precision': 0.9786241, 'binary_recall': 0.87769943, 'binary_specificity': 0.99794376, 'binary_f1_score': 0.92541826}
confusion matrix:
       0     1
0  42223    87
1    555  3983
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.76846564, 'recall': 0.59386903, 'specificity': 0.59386903, 'f1': 0.635725, 'auroc': 0.7966056, 'binary_precision': 0.5631068, 'binary_recall': 0.19269103, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.28712872}
confusion matrix:
       0    1
0  18081   90
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.8551185, 'recall': 0.6161011, 'specificity': 0.6161011, 'f1': 0.6702534, 'auroc': 0.7823664, 'binary_precision': 0.74025977, 'binary_recall': 0.23553719, 'binary_specificity': 0.996665, 'binary_f1_score': 0.35736677}
confusion matrix:
      0   1
0  5977  20
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_15.png
early stop counter: 4
val acc:0.969317615032196, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9676229953765869
after epoch: 15,now: 2024-06-22 02:33:21.006509,epoch time: 0:10:18.623496,used: 2:34:44.241615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98738474, 'precision': 0.9842849, 'recall': 0.94276464, 'specificity': 0.94276464, 'f1': 0.9623518, 'auroc': 0.993594, 'binary_precision': 0.9805258, 'binary_recall': 0.8874201, 'binary_specificity': 0.99810916, 'binary_f1_score': 0.93165255}
confusion matrix:
       0     1
0  42229    80
1    511  4028
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77041495, 'recall': 0.58500797, 'specificity': 0.58500797, 'f1': 0.62556964, 'auroc': 0.7917619, 'binary_precision': 0.5675676, 'binary_recall': 0.1744186, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2668361}
confusion matrix:
       0    1
0  18091   80
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8520904, 'recall': 0.60180503, 'specificity': 0.60180503, 'f1': 0.65266114, 'auroc': 0.77779245, 'binary_precision': 0.7352941, 'binary_recall': 0.20661157, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32258067}
confusion matrix:
      0   1
0  5979  18
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_16.png
early stop counter: 5
val acc:0.9692643880844116, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9676229953765869
after epoch: 16,now: 2024-06-22 02:43:39.462266,epoch time: 0:10:18.455757,used: 2:45:02.697372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98847336, 'precision': 0.98562133, 'recall': 0.9477926, 'specificity': 0.9477926, 'f1': 0.9657394, 'auroc': 0.99397814, 'binary_precision': 0.9821558, 'binary_recall': 0.8973342, 'binary_specificity': 0.99825096, 'binary_f1_score': 0.93783104}
confusion matrix:
       0     1
0  42235    74
1    466  4073
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76173365, 'recall': 0.58403987, 'specificity': 0.58403987, 'f1': 0.62354827, 'auroc': 0.79753244, 'binary_precision': 0.55026454, 'binary_recall': 0.17275748, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.2629583}
confusion matrix:
       0    1
0  18086   85
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.83654845, 'recall': 0.6015549, 'specificity': 0.6015549, 'f1': 0.6509898, 'auroc': 0.78276896, 'binary_precision': 0.70422536, 'binary_recall': 0.20661157, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5976  21
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_17.png
early stop counter: 6
val acc:0.968944787979126, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9663407802581787 / 0.9676229953765869
after epoch: 17,now: 2024-06-22 02:53:57.095783,epoch time: 0:10:17.633517,used: 2:55:20.330889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98734206, 'precision': 0.9838332, 'recall': 0.94292533, 'specificity': 0.94292533, 'f1': 0.9622401, 'auroc': 0.9938817, 'binary_precision': 0.97957695, 'binary_recall': 0.88783604, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.931453}
confusion matrix:
       0     1
0  42226    84
1    509  4029
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.77438956, 'recall': 0.59317607, 'specificity': 0.59317607, 'f1': 0.63560796, 'auroc': 0.7994068, 'binary_precision': 0.575, 'binary_recall': 0.1910299, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.28678304}
confusion matrix:
       0    1
0  18086   85
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.85273206, 'recall': 0.60792005, 'specificity': 0.60792005, 'f1': 0.66023993, 'auroc': 0.7735195, 'binary_precision': 0.7361111, 'binary_recall': 0.21900827, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3375796}
confusion matrix:
      0   1
0  5978  19
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_18.png
better model found
persisted
after epoch: 18,now: 2024-06-22 03:04:22.373059,epoch time: 0:10:25.277276,used: 3:05:45.608165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9881318, 'precision': 0.98352265, 'recall': 0.94778895, 'specificity': 0.94778895, 'f1': 0.96478975, 'auroc': 0.9944857, 'binary_precision': 0.9779165, 'binary_recall': 0.8977523, 'binary_specificity': 0.99782556, 'binary_f1_score': 0.93612134}
confusion matrix:
       0     1
0  42218    92
1    464  4074
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7629006, 'recall': 0.5897162, 'specificity': 0.5897162, 'f1': 0.6303254, 'auroc': 0.8032335, 'binary_precision': 0.5522388, 'binary_recall': 0.18438539, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.27646327}
confusion matrix:
       0    1
0  18081   90
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8507951, 'recall': 0.6058539, 'specificity': 0.6058539, 'f1': 0.65754396, 'auroc': 0.7788276, 'binary_precision': 0.73239434, 'binary_recall': 0.21487603, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.33226833}
confusion matrix:
      0   1
0  5978  19
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_19.png
early stop counter: 1
val acc:0.9690513014793396, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9666613340377808 / 0.9676229953765869
after epoch: 19,now: 2024-06-22 03:14:41.547434,epoch time: 0:10:19.174375,used: 3:16:04.782540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9888362, 'precision': 0.98616636, 'recall': 0.9493593, 'specificity': 0.9493593, 'f1': 0.9668488, 'auroc': 0.99454176, 'binary_precision': 0.98292035, 'binary_recall': 0.90039665, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.93985045}
confusion matrix:
       0     1
0  42239    71
1    452  4086
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76799953, 'recall': 0.58334684, 'specificity': 0.58334684, 'f1': 0.623335, 'auroc': 0.8068054, 'binary_precision': 0.56284153, 'binary_recall': 0.17109634, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2624204}
confusion matrix:
       0    1
0  18091   80
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.82978857, 'recall': 0.5953566, 'specificity': 0.5953566, 'f1': 0.64273715, 'auroc': 0.7826174, 'binary_precision': 0.6911765, 'binary_recall': 0.19421488, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.30322582}
confusion matrix:
      0   1
0  5976  21
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_20.png
early stop counter: 2
val acc:0.9691578149795532, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9666613340377808 / 0.9676229953765869
after epoch: 20,now: 2024-06-22 03:24:57.429639,epoch time: 0:10:15.882205,used: 3:26:20.664745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9894553, 'precision': 0.9840011, 'recall': 0.9550232, 'specificity': 0.9550232, 'f1': 0.96894646, 'auroc': 0.99503875, 'binary_precision': 0.9773425, 'binary_recall': 0.9123155, 'binary_specificity': 0.997731, 'binary_f1_score': 0.94371015}
confusion matrix:
       0     1
0  42213    96
1    398  4141
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75977767, 'recall': 0.5912673, 'specificity': 0.5912673, 'f1': 0.63174385, 'auroc': 0.8093781, 'binary_precision': 0.5458937, 'binary_recall': 0.18770765, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.27935725}
confusion matrix:
       0    1
0  18077   94
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.81268555, 'recall': 0.59304035, 'specificity': 0.59304035, 'f1': 0.6383943, 'auroc': 0.7824774, 'binary_precision': 0.6571429, 'binary_recall': 0.19008264, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29487178}
confusion matrix:
      0   1
0  5973  24
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_21.png
early stop counter: 3
val acc:0.968944787979126, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9666613340377808 / 0.9676229953765869
after epoch: 21,now: 2024-06-22 03:35:19.149668,epoch time: 0:10:21.720029,used: 3:36:42.384774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9888789, 'precision': 0.98494816, 'recall': 0.9507706, 'specificity': 0.9507706, 'f1': 0.9670707, 'auroc': 0.99546885, 'binary_precision': 0.9801625, 'binary_recall': 0.903503, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.9402728}
confusion matrix:
       0     1
0  42226    83
1    438  4101
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77041495, 'recall': 0.58500797, 'specificity': 0.58500797, 'f1': 0.62556964, 'auroc': 0.8108454, 'binary_precision': 0.5675676, 'binary_recall': 0.1744186, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2668361}
confusion matrix:
       0    1
0  18091   80
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8091242, 'recall': 0.5828765, 'specificity': 0.5828765, 'f1': 0.6252667, 'auroc': 0.7817595, 'binary_precision': 0.6507937, 'binary_recall': 0.1694215, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.26885247}
confusion matrix:
      0   1
0  5975  22
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_22.png
early stop counter: 4
val acc:0.9692643880844116, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9666613340377808 / 0.9676229953765869
after epoch: 22,now: 2024-06-22 03:45:43.199963,epoch time: 0:10:24.050295,used: 3:47:06.435069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9886228, 'precision': 0.9845735, 'recall': 0.9496454, 'specificity': 0.9496454, 'f1': 0.9662845, 'auroc': 0.994872, 'binary_precision': 0.9796456, 'binary_recall': 0.90129983, 'binary_specificity': 0.99799097, 'binary_f1_score': 0.93884104}
confusion matrix:
       0     1
0  42224    85
1    448  4091
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7811061, 'recall': 0.58600366, 'specificity': 0.58600366, 'f1': 0.6277977, 'auroc': 0.81697094, 'binary_precision': 0.5888889, 'binary_recall': 0.17607974, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.27109975}
confusion matrix:
       0    1
0  18097   74
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.81061685, 'recall': 0.57279605, 'specificity': 0.57279605, 'f1': 0.6119764, 'auroc': 0.78703785, 'binary_precision': 0.6545454, 'binary_recall': 0.14876033, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5978  19
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_23.png
better model found
persisted
after epoch: 23,now: 2024-06-22 03:55:58.847366,epoch time: 0:10:15.647403,used: 3:57:22.082472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99067193, 'precision': 0.98652464, 'recall': 0.95963037, 'specificity': 0.95963037, 'f1': 0.9725939, 'auroc': 0.99548113, 'binary_precision': 0.9814554, 'binary_recall': 0.921128, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9503352}
confusion matrix:
       0     1
0  42230    79
1    358  4181
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76524043, 'recall': 0.5824888, 'specificity': 0.5824888, 'f1': 0.6220339, 'auroc': 0.8172301, 'binary_precision': 0.55737704, 'binary_recall': 0.16943522, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.25987262}
confusion matrix:
       0    1
0  18090   81
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.8011067, 'recall': 0.580727, 'specificity': 0.580727, 'f1': 0.6219058, 'auroc': 0.7815896, 'binary_precision': 0.63492066, 'binary_recall': 0.16528925, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2622951}
confusion matrix:
      0   1
0  5974  23
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_24.png
early stop counter: 1
val acc:0.9690513014793396, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 24,now: 2024-06-22 04:06:16.767149,epoch time: 0:10:17.919783,used: 4:07:40.002255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9903945, 'precision': 0.98726386, 'recall': 0.9573041, 'specificity': 0.9573041, 'f1': 0.97168344, 'auroc': 0.9950352, 'binary_precision': 0.98344374, 'binary_recall': 0.9162627, 'binary_specificity': 0.99834555, 'binary_f1_score': 0.9486654}
confusion matrix:
       0     1
0  42240    70
1    380  4158
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77075875, 'recall': 0.584205, 'specificity': 0.584205, 'f1': 0.62463605, 'auroc': 0.8164762, 'binary_precision': 0.568306, 'binary_recall': 0.17275748, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.26496816}
confusion matrix:
       0    1
0  18092   79
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8040372, 'recall': 0.5827931, 'specificity': 0.5827931, 'f1': 0.6247855, 'auroc': 0.77853596, 'binary_precision': 0.640625, 'binary_recall': 0.1694215, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.26797387}
confusion matrix:
      0   1
0  5974  23
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_25.png
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 25,now: 2024-06-22 04:16:40.748947,epoch time: 0:10:23.981798,used: 4:18:03.984053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99020237, 'precision': 0.9857116, 'recall': 0.95769864, 'specificity': 0.95769864, 'f1': 0.971179, 'auroc': 0.9957191, 'binary_precision': 0.980226, 'binary_recall': 0.91738266, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.94776374}
confusion matrix:
       0     1
0  42225    84
1    375  4164
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75810754, 'recall': 0.59284586, 'specificity': 0.59284586, 'f1': 0.6333282, 'auroc': 0.8218909, 'binary_precision': 0.5424528, 'binary_recall': 0.1910299, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.28255528}
confusion matrix:
       0    1
0  18074   97
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.79652786, 'recall': 0.5907241, 'specificity': 0.5907241, 'f1': 0.6341046, 'auroc': 0.78504956, 'binary_precision': 0.625, 'binary_recall': 0.18595041, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5970  27
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_26.png
early stop counter: 3
val acc:0.9688915014266968, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 26,now: 2024-06-22 04:27:15.281601,epoch time: 0:10:34.532654,used: 4:28:38.516707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99033046, 'precision': 0.9845867, 'recall': 0.95953965, 'specificity': 0.95953965, 'f1': 0.9716425, 'auroc': 0.9960122, 'binary_precision': 0.9775596, 'binary_recall': 0.92134833, 'binary_specificity': 0.997731, 'binary_f1_score': 0.948622}
confusion matrix:
       0     1
0  42213    96
1    357  4182
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7654151, 'recall': 0.5905743, 'specificity': 0.5905743, 'f1': 0.6315979, 'auroc': 0.8251289, 'binary_precision': 0.5572139, 'binary_recall': 0.18604651, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.2789539}
confusion matrix:
       0    1
0  18082   89
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7817933, 'recall': 0.5743619, 'specificity': 0.5743619, 'f1': 0.61226416, 'auroc': 0.7872194, 'binary_precision': 0.5967742, 'binary_recall': 0.15289256, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.24342103}
confusion matrix:
      0   1
0  5972  25
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_27.png
early stop counter: 4
val acc:0.9691578149795532, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 27,now: 2024-06-22 04:37:42.325641,epoch time: 0:10:27.044040,used: 4:39:05.560747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99137634, 'precision': 0.9872827, 'recall': 0.96297055, 'specificity': 0.96297055, 'f1': 0.974733, 'auroc': 0.9964154, 'binary_precision': 0.98227197, 'binary_recall': 0.9277374, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.9542262}
confusion matrix:
       0     1
0  42233    76
1    328  4211
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76768535, 'recall': 0.5841499, 'specificity': 0.5841499, 'f1': 0.62427175, 'auroc': 0.8216666, 'binary_precision': 0.56216216, 'binary_recall': 0.17275748, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.26429477}
confusion matrix:
       0    1
0  18090   81
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.78102505, 'recall': 0.5622987, 'specificity': 0.5622987, 'f1': 0.5959215, 'auroc': 0.77423406, 'binary_precision': 0.59615386, 'binary_recall': 0.12809917, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5976  21
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_28.png
early stop counter: 5
val acc:0.9691578149795532, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 28,now: 2024-06-22 04:48:03.157379,epoch time: 0:10:20.831738,used: 4:49:26.392485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9913123, 'precision': 0.987545, 'recall': 0.96234506, 'specificity': 0.96234506, 'f1': 0.9745221, 'auroc': 0.99544525, 'binary_precision': 0.98293597, 'binary_recall': 0.9264155, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.9538392}
confusion matrix:
       0     1
0  42236    73
1    334  4205
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75864613, 'recall': 0.58478785, 'specificity': 0.58478785, 'f1': 0.62411654, 'auroc': 0.8260057, 'binary_precision': 0.54404145, 'binary_recall': 0.1744186, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.26415092}
confusion matrix:
       0    1
0  18083   88
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.78841805, 'recall': 0.57246256, 'specificity': 0.57246256, 'f1': 0.6101983, 'auroc': 0.77804327, 'binary_precision': 0.6101695, 'binary_recall': 0.14876033, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.23920266}
confusion matrix:
      0   1
0  5974  23
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_29.png
early stop counter: 6
val acc:0.9688382148742676, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 29,now: 2024-06-22 04:58:17.848123,epoch time: 0:10:14.690744,used: 4:59:41.083229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99158984, 'precision': 0.9888381, 'recall': 0.9626873, 'specificity': 0.9626873, 'f1': 0.97530824, 'auroc': 0.9963304, 'binary_precision': 0.9854733, 'binary_recall': 0.92684, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.9552578}
confusion matrix:
       0     1
0  42248    62
1    332  4206
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7742492, 'recall': 0.5737378, 'specificity': 0.5737378, 'f1': 0.6118806, 'auroc': 0.824412, 'binary_precision': 0.5759494, 'binary_recall': 0.15116279, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.23947367}
confusion matrix:
       0   1
0  18104  67
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7616326, 'recall': 0.55799973, 'specificity': 0.55799973, 'f1': 0.5889546, 'auroc': 0.7729037, 'binary_precision': 0.5576923, 'binary_recall': 0.11983471, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.19727892}
confusion matrix:
      0   1
0  5974  23
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520819_30.png
early stop counter: 7
val acc:0.9692111015319824, best validation acc: 0.9696372747421265, corresponding to test acc:                         0.9639365077018738 / 0.9676229953765869
after epoch: 30,now: 2024-06-22 05:08:32.415549,epoch time: 0:10:14.567426,used: 5:09:55.650655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_58_36_seed_2_21520819
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:09:55.650655 at 2024-06-22 05:08:32.415549
persisted model performance metric: 

scalar performance:
{'acc': 0.9639365, 'precision': 0.81061685, 'recall': 0.57279605, 'specificity': 0.57279605, 'f1': 0.6119764, 'auroc': 0.78703785, 'binary_precision': 0.6545454, 'binary_recall': 0.14876033, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5978  19
1   206  36
oracle model performance metric: 

scalar performance:
{'acc': 0.967623, 'precision': 0.8738086, 'recall': 0.61436844, 'specificity': 0.61436844, 'f1': 0.6700407, 'auroc': 0.777756, 'binary_precision': 0.7777778, 'binary_recall': 0.23140496, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3566879}
confusion matrix:
      0   1
0  5981  16
1   186  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   3077 MiB |   1182 TiB |   1182 TiB |
|       from large pool | 167936 KiB |   3007 MiB |   1182 TiB |   1182 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   3077 MiB |   1182 TiB |   1182 TiB |
|       from large pool | 167936 KiB |   3007 MiB |   1182 TiB |   1182 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   3071 MiB |   1182 TiB |   1182 TiB |
|       from large pool | 165120 KiB |   3001 MiB |   1182 TiB |   1182 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4154 MiB |   4304 MiB |  10640 MiB |   6486 MiB |
|       from large pool |   4082 MiB |   4230 MiB |  10506 MiB |   6424 MiB |
|       from small pool |     72 MiB |     74 MiB |    134 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1614 MiB |    879 TiB |    879 TiB |
|       from large pool |    780 MiB |   1612 MiB |    879 TiB |    879 TiB |
|       from small pool |      6 MiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1050    |    1707    |   16778 K  |   16777 K  |
|       from large pool |      36    |      76    |    6808 K  |    6807 K  |
|       from small pool |    1014    |    1636    |    9970 K  |    9969 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1050    |    1707    |   16778 K  |   16777 K  |
|       from large pool |      36    |      76    |    6808 K  |    6807 K  |
|       from small pool |    1014    |    1636    |    9970 K  |    9969 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      89    |      40    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      36    |      37    |      67    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     199    |    8925 K  |    8925 K  |
|       from large pool |       5    |      11    |    2150 K  |    2150 K  |
|       from small pool |      25    |     194    |    6775 K  |    6775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3077 MiB |   1182 TiB |   1182 TiB |
|       from large pool |  16640 KiB |   3007 MiB |   1182 TiB |   1182 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3077 MiB |   1182 TiB |   1182 TiB |
|       from large pool |  16640 KiB |   3007 MiB |   1182 TiB |   1182 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3071 MiB |   1182 TiB |   1182 TiB |
|       from large pool |  16640 KiB |   3001 MiB |   1182 TiB |   1182 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    986 MiB |   4304 MiB |  10640 MiB |   9654 MiB |
|       from large pool |    944 MiB |   4230 MiB |  10506 MiB |   9562 MiB |
|       from small pool |     42 MiB |     74 MiB |    134 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 786176 KiB |   1614 MiB |    879 TiB |    879 TiB |
|       from large pool | 786176 KiB |   1612 MiB |    879 TiB |    879 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1707    |   16778 K  |   16778 K  |
|       from large pool |       2    |      76    |    6808 K  |    6808 K  |
|       from small pool |       0    |    1636    |    9970 K  |    9970 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1707    |   16778 K  |   16778 K  |
|       from large pool |       2    |      76    |    6808 K  |    6808 K  |
|       from small pool |       0    |    1636    |    9970 K  |    9970 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      89    |      59    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      37    |      67    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     199    |    8926 K  |    8926 K  |
|       from large pool |       1    |      11    |    2150 K  |    2150 K  |
|       from small pool |       0    |     194    |    6775 K  |    6775 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 05:09:18 2024]
Finished job 0.
1 of 1 steps (100%) done
