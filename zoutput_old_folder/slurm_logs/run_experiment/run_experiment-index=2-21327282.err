Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 15 22:12:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282

 Experiment start at: 2024-06-15 22:21:01.150069
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.47630358, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41138858, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42049378, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:37:36.659739,epoch time: 0:16:35.509670,used: 0:16:35.509670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5080751, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41717792, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4235817, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:52:24.393469,epoch time: 0:14:47.733730,used: 0:31:23.243400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.5234232, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44049615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.44565323, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:07:16.565904,epoch time: 0:14:52.172435,used: 0:46:15.415835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.53327966, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4657023, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4846157, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:22:09.034455,epoch time: 0:14:52.468551,used: 1:01:07.884386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5996616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.51151264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.52032197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:36:56.383343,epoch time: 0:14:47.348888,used: 1:15:55.233274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.636788, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5805148, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.57216364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-15 23:51:45.325184,epoch time: 0:14:48.941841,used: 1:30:44.175115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6765967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.61622965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6338378, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:06:34.237483,epoch time: 0:14:48.912299,used: 1:45:33.087414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7161355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.66578555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.68582153, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:21:28.331810,epoch time: 0:14:54.094327,used: 2:00:27.181741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7483549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7111056, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.73391277, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:36:29.817045,epoch time: 0:15:01.485235,used: 2:15:28.666976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.76792014, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.75092393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7656432, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 00:51:25.832330,epoch time: 0:14:56.015285,used: 2:30:24.682261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.8179811, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.79356813, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.79823244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:06:24.687184,epoch time: 0:14:58.854854,used: 2:45:23.537115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.8240788, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8086773, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8142034, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:21:10.718729,epoch time: 0:14:46.031545,used: 3:00:09.568660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.8362199, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8139736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8198359, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 01:35:58.570392,epoch time: 0:14:47.851663,used: 3:14:57.420323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96636987, 'precision': 0.6832173, 'recall': 0.5006439, 'specificity': 0.5006439, 'f1': 0.49280238, 'auroc': 0.8586825, 'binary_precision': 0.4, 'binary_recall': 0.0013586957, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.0027081924}
confusion matrix:
       0  1
0  42325  3
1   1470  2
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83897126, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8320341, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 01:50:51.789819,epoch time: 0:14:53.219427,used: 3:29:50.639750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.67772526, 'recall': 0.5022494, 'specificity': 0.5022494, 'f1': 0.49613664, 'auroc': 0.8701083, 'binary_precision': 0.3888889, 'binary_recall': 0.0047586677, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.0094022835}
confusion matrix:
       0   1
0  42318  11
1   1464   7
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8548365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8490256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:05:42.953971,epoch time: 0:14:51.164152,used: 3:44:41.803902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.76108146, 'recall': 0.5033022, 'specificity': 0.5033022, 'f1': 0.49817583, 'auroc': 0.8668105, 'binary_precision': 0.5555556, 'binary_recall': 0.006793478, 'binary_specificity': 0.999811, 'binary_f1_score': 0.013422818}
confusion matrix:
       0   1
0  42320   8
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.85430825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8501631, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_16.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:20:32.287854,epoch time: 0:14:49.333883,used: 3:59:31.137785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9668493, 'precision': 0.81997323, 'recall': 0.51236385, 'specificity': 0.51236385, 'f1': 0.5158118, 'auroc': 0.8702097, 'binary_precision': 0.6727273, 'binary_recall': 0.025152957, 'binary_specificity': 0.9995748, 'binary_f1_score': 0.04849279}
confusion matrix:
       0   1
0  42311  18
1   1434  37
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.86151576, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.85549575, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_17.png
early stop counter: 16
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-16 02:35:23.104864,epoch time: 0:14:50.817010,used: 4:14:21.954795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96680367, 'precision': 0.8235657, 'recall': 0.51135993, 'specificity': 0.51135993, 'f1': 0.5138932, 'auroc': 0.8787608, 'binary_precision': 0.68, 'binary_recall': 0.023097826, 'binary_specificity': 0.999622, 'binary_f1_score': 0.04467806}
confusion matrix:
       0   1
0  42312  16
1   1438  34
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.8662262, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.85451293, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_18.png
new oracle model saved
early stop counter: 17
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 18,now: 2024-06-16 02:50:10.635401,epoch time: 0:14:47.530537,used: 4:29:09.485332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9659817, 'precision': 0.6875323, 'recall': 0.51355547, 'specificity': 0.51355547, 'f1': 0.51802343, 'auroc': 0.8844032, 'binary_precision': 0.407767, 'binary_recall': 0.028552005, 'binary_specificity': 0.9985589, 'binary_f1_score': 0.053367216}
confusion matrix:
       0   1
0  42268  61
1   1429  42
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6079376, 'recall': 0.5013899, 'specificity': 0.5013899, 'f1': 0.4943131, 'auroc': 0.87720954, 'binary_precision': 0.25, 'binary_recall': 0.00311042, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0061443937}
confusion matrix:
       0  1
0  18143  6
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8627572, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_19.png
new oracle model saved
early stop counter: 18
val acc:0.9655704498291016, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 19,now: 2024-06-16 03:04:48.553829,epoch time: 0:14:37.918428,used: 4:43:47.403760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.7357586, 'recall': 0.52263427, 'specificity': 0.52263427, 'f1': 0.53433055, 'auroc': 0.8859846, 'binary_precision': 0.50364965, 'binary_recall': 0.046875, 'binary_specificity': 0.9983935, 'binary_f1_score': 0.08576755}
confusion matrix:
       0   1
0  42260  68
1   1403  69
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.61932516, 'recall': 0.50211245, 'specificity': 0.50211245, 'f1': 0.4958138, 'auroc': 0.87818336, 'binary_precision': 0.27272728, 'binary_recall': 0.00466563, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0091743115}
confusion matrix:
       0  1
0  18141  8
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.864948, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_20.png
new oracle model saved
early stop counter: 19
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9589325785636902
after epoch: 20,now: 2024-06-16 03:19:35.985571,epoch time: 0:14:47.431742,used: 4:58:34.835502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96696347, 'precision': 0.77037704, 'recall': 0.5314523, 'specificity': 0.5314523, 'f1': 0.5496166, 'auroc': 0.8879132, 'binary_precision': 0.57228917, 'binary_recall': 0.064581916, 'binary_specificity': 0.99832267, 'binary_f1_score': 0.11606598}
confusion matrix:
       0   1
0  42258  71
1   1376  95
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.69361377, 'recall': 0.5059178, 'specificity': 0.5059178, 'f1': 0.5033364, 'auroc': 0.8868294, 'binary_precision': 0.42105263, 'binary_recall': 0.01244168, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.024169182}
confusion matrix:
       0   1
0  18138  11
1    635   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.87143624, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_21.png
new oracle model saved
early stop counter: 20
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 21,now: 2024-06-16 03:34:22.058188,epoch time: 0:14:46.072617,used: 5:13:20.908119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:13:20.908119 at 2024-06-16 03:34:22.058188
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.42049378, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.87143624, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9364 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9364 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4943 K  |    4943 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282

 Experiment start at: 2024-06-16 03:41:02.949584
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.48353782, 'recall': 0.49961048, 'specificity': 0.49961048, 'f1': 0.49144274, 'auroc': 0.43790948, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99922097, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42326  33
1   1441   0
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.48201016, 'recall': 0.4990314, 'specificity': 0.4990314, 'f1': 0.4903731, 'auroc': 0.38012862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18032  35
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32233804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 03:55:56.589986,epoch time: 0:14:53.640402,used: 0:14:53.640402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.48358446, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49165526, 'auroc': 0.45041907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42362  0
1   1438  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.3884235, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32999754, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 04:10:56.708298,epoch time: 0:15:00.118312,used: 0:29:53.758714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.4836073, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166703, 'auroc': 0.47645807, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42364  0
1   1436  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.40096045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36951536, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 04:25:54.352542,epoch time: 0:14:57.644244,used: 0:44:51.402958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.5179692, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.4412322, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.41771632, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 04:40:56.673178,epoch time: 0:15:02.320636,used: 0:59:53.723594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.54844123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.46991807, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45509648, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 04:55:56.411433,epoch time: 0:14:59.738255,used: 1:14:53.461849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.4835388, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163166, 'auroc': 0.58550704, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42358  0
1   1442  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.52508056, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5249549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 05:10:45.557452,epoch time: 0:14:49.146019,used: 1:29:42.607868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.626071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.55900156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5726992, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 05:25:35.732863,epoch time: 0:14:50.175411,used: 1:44:32.783279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.679656, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.61401916, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.62158144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 05:40:16.454855,epoch time: 0:14:40.721992,used: 1:59:13.505271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.70498455, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6526462, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6680417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 05:54:55.683725,epoch time: 0:14:39.228870,used: 2:13:52.734141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.74951804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.70616066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.72173774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 06:10:59.665944,epoch time: 0:16:03.982219,used: 2:29:56.716360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.7783166, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.74123216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7486395, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 06:25:51.672344,epoch time: 0:14:52.006400,used: 2:44:48.722760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.48358446, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49165526, 'auroc': 0.80793196, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42362  0
1   1438  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.76634926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.777583, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 06:40:41.431870,epoch time: 0:14:49.759526,used: 2:59:38.482286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.9835841, 'recall': 0.50034744, 'specificity': 0.50034744, 'f1': 0.4923495, 'auroc': 0.82403004, 'binary_precision': 1.0, 'binary_recall': 0.00069492706, 'binary_specificity': 1.0, 'binary_f1_score': 0.001388889}
confusion matrix:
       0  1
0  42361  0
1   1438  1
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.79076874, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.79094607, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 06:55:43.853463,epoch time: 0:15:02.421593,used: 3:14:40.903879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9671689, 'precision': 0.8169384, 'recall': 0.5013653, 'specificity': 0.5013653, 'f1': 0.49442074, 'auroc': 0.83825445, 'binary_precision': 0.6666667, 'binary_recall': 0.0027777778, 'binary_specificity': 0.9999528, 'binary_f1_score': 0.0055325036}
confusion matrix:
       0  1
0  42358  2
1   1436  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8113864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.80895686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 07:10:39.582494,epoch time: 0:14:55.729031,used: 3:29:36.632910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.6979106, 'recall': 0.5019889, 'specificity': 0.5019889, 'f1': 0.49575704, 'auroc': 0.8465969, 'binary_precision': 0.42857143, 'binary_recall': 0.004166667, 'binary_specificity': 0.9998111, 'binary_f1_score': 0.008253096}
confusion matrix:
       0  1
0  42352  8
1   1434  6
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8310416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8256168, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 07:25:26.521749,epoch time: 0:14:46.939255,used: 3:44:23.572165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7545573, 'recall': 0.50439036, 'specificity': 0.50439036, 'f1': 0.50055647, 'auroc': 0.85326254, 'binary_precision': 0.5416667, 'binary_recall': 0.009040334, 'binary_specificity': 0.99974036, 'binary_f1_score': 0.017783858}
confusion matrix:
       0   1
0  42351  11
1   1425  13
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8378458, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83160436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 07:41:02.903601,epoch time: 0:15:36.381852,used: 3:59:59.954017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.7800077, 'recall': 0.505418, 'specificity': 0.505418, 'f1': 0.5025498, 'auroc': 0.8660166, 'binary_precision': 0.5925926, 'binary_recall': 0.011095701, 'binary_specificity': 0.9997403, 'binary_f1_score': 0.021783527}
confusion matrix:
       0   1
0  42347  11
1   1426  16
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.84407437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83533204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_17.png
early stop counter: 15
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 07:55:36.550507,epoch time: 0:14:33.646906,used: 4:14:33.600923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.73384845, 'recall': 0.5097132, 'specificity': 0.5097132, 'f1': 0.5109593, 'auroc': 0.8767261, 'binary_precision': 0.5, 'binary_recall': 0.020110957, 'binary_specificity': 0.9993154, 'binary_f1_score': 0.038666666}
confusion matrix:
       0   1
0  42329  29
1   1413  29
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.68209237, 'recall': 0.50140285, 'specificity': 0.50140285, 'f1': 0.49379277, 'auroc': 0.8574747, 'binary_precision': 0.4, 'binary_recall': 0.0029717681, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.005899705}
confusion matrix:
       0  1
0  18064  3
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.841514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_18.png
early stop counter: 16
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 08:10:09.001636,epoch time: 0:14:32.451129,used: 4:29:06.052052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9673973, 'precision': 0.7738595, 'recall': 0.51355624, 'specificity': 0.51355624, 'f1': 0.51823175, 'auroc': 0.8771614, 'binary_precision': 0.5797101, 'binary_recall': 0.02779708, 'binary_specificity': 0.9993154, 'binary_f1_score': 0.0530504}
confusion matrix:
       0   1
0  42332  29
1   1399  40
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7043641, 'recall': 0.50283337, 'specificity': 0.50283337, 'f1': 0.496707, 'auroc': 0.864262, 'binary_precision': 0.44444445, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.011730205}
confusion matrix:
       0  1
0  18062  5
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8477863, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_19.png
early stop counter: 17
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-16 08:24:45.116013,epoch time: 0:14:36.114377,used: 4:43:42.166429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9674201, 'precision': 0.7644229, 'recall': 0.5219518, 'specificity': 0.5219518, 'f1': 0.53345454, 'auroc': 0.8775576, 'binary_precision': 0.5603448, 'binary_recall': 0.045107566, 'binary_specificity': 0.998796, 'binary_f1_score': 0.0834939}
confusion matrix:
       0   1
0  42308  51
1   1376  65
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73221725, 'recall': 0.50500685, 'specificity': 0.50500685, 'f1': 0.50104344, 'auroc': 0.86474586, 'binary_precision': 0.5, 'binary_recall': 0.010401188, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.020378456}
confusion matrix:
       0  1
0  18060  7
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.849016, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_20.png
new oracle model saved
early stop counter: 18
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 20,now: 2024-06-16 08:39:39.140403,epoch time: 0:14:54.024390,used: 4:58:36.190819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.7322666, 'recall': 0.5211196, 'specificity': 0.5211196, 'f1': 0.53182954, 'auroc': 0.8880233, 'binary_precision': 0.496063, 'binary_recall': 0.04375, 'binary_specificity': 0.99848914, 'binary_f1_score': 0.080408424}
confusion matrix:
       0   1
0  42296  64
1   1377  63
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.78234506, 'recall': 0.5086939, 'specificity': 0.5086939, 'f1': 0.5082231, 'auroc': 0.8734482, 'binary_precision': 0.6, 'binary_recall': 0.017830608, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.03463203}
confusion matrix:
       0   1
0  18059   8
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8528851, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-16 08:54:18.868200,epoch time: 0:14:39.727797,used: 5:13:15.918616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9672603, 'precision': 0.7463887, 'recall': 0.52956885, 'specificity': 0.52956885, 'f1': 0.5463202, 'auroc': 0.8909457, 'binary_precision': 0.52380955, 'binary_recall': 0.061026353, 'binary_specificity': 0.9981113, 'binary_f1_score': 0.10931677}
confusion matrix:
       0   1
0  42278  80
1   1354  88
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.75394666, 'recall': 0.51367307, 'specificity': 0.51367307, 'f1': 0.517726, 'auroc': 0.8790412, 'binary_precision': 0.54285717, 'binary_recall': 0.028231798, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.053672317}
confusion matrix:
       0   1
0  18051  16
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.85782003, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_22.png
new oracle model saved
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9592329859733582 / 0.9595552682876587
after epoch: 22,now: 2024-06-16 09:08:52.713072,epoch time: 0:14:33.844872,used: 5:27:49.763488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.7505717, 'recall': 0.5336353, 'specificity': 0.5336353, 'f1': 0.5530328, 'auroc': 0.8966023, 'binary_precision': 0.5319149, 'binary_recall': 0.06934813, 'binary_specificity': 0.9979225, 'binary_f1_score': 0.12269939}
confusion matrix:
       0    1
0  42270   88
1   1342  100
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.75179857, 'recall': 0.51510364, 'specificity': 0.51510364, 'f1': 0.52038324, 'auroc': 0.87781405, 'binary_precision': 0.53846157, 'binary_recall': 0.031203566, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.058988765}
confusion matrix:
       0   1
0  18049  18
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.8543172, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_23.png
new oracle model saved
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9592329859733582 / 0.9598775506019592
after epoch: 23,now: 2024-06-16 09:23:29.208247,epoch time: 0:14:36.495175,used: 5:42:26.258663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.7640439, 'recall': 0.5321928, 'specificity': 0.5321928, 'f1': 0.55092007, 'auroc': 0.89334106, 'binary_precision': 0.5588235, 'binary_recall': 0.06615599, 'binary_specificity': 0.9982296, 'binary_f1_score': 0.11830636}
confusion matrix:
       0   1
0  42289  75
1   1341  95
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.76835954, 'recall': 0.51733243, 'specificity': 0.51733243, 'f1': 0.5244953, 'auroc': 0.8813301, 'binary_precision': 0.5714286, 'binary_recall': 0.035661217, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.06713286}
confusion matrix:
       0   1
0  18049  18
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.85790366, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-16 09:38:43.777382,epoch time: 0:15:14.569135,used: 5:57:40.827798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9676027, 'precision': 0.7575942, 'recall': 0.5405153, 'specificity': 0.5405153, 'f1': 0.5640771, 'auroc': 0.8938879, 'binary_precision': 0.54545456, 'binary_recall': 0.08339124, 'binary_specificity': 0.99763936, 'binary_f1_score': 0.14466546}
confusion matrix:
       0    1
0  42261  100
1   1319  120
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.76846004, 'recall': 0.5202212, 'specificity': 0.5202212, 'f1': 0.5297219, 'auroc': 0.88326013, 'binary_precision': 0.5714286, 'binary_recall': 0.041604754, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.077562325}
confusion matrix:
       0   1
0  18046  21
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8598785, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_25.png
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-06-16 09:53:46.560290,epoch time: 0:15:02.782908,used: 6:12:43.610706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96730596, 'precision': 0.7418438, 'recall': 0.5440541, 'specificity': 0.5440541, 'f1': 0.5689971, 'auroc': 0.89897025, 'binary_precision': 0.5137255, 'binary_recall': 0.09103544, 'binary_specificity': 0.99707276, 'binary_f1_score': 0.15466352}
confusion matrix:
       0    1
0  42237  124
1   1308  131
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7592898, 'recall': 0.5187353, 'specificity': 0.5187353, 'f1': 0.52702516, 'auroc': 0.88654584, 'binary_precision': 0.5531915, 'binary_recall': 0.038632985, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.072222225}
confusion matrix:
       0   1
0  18046  21
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8612548, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_26.png
early stop counter: 1
val acc:0.9643543362617493, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9603609442710876 / 0.9603609442710876
after epoch: 26,now: 2024-06-16 10:08:32.966359,epoch time: 0:14:46.406069,used: 6:27:30.016775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9666438, 'precision': 0.7173587, 'recall': 0.5460399, 'specificity': 0.5460399, 'f1': 0.5709396, 'auroc': 0.9047171, 'binary_precision': 0.46464646, 'binary_recall': 0.09583333, 'binary_specificity': 0.99624646, 'binary_f1_score': 0.15889466}
confusion matrix:
       0    1
0  42201  159
1   1302  138
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74594975, 'recall': 0.52154106, 'specificity': 0.52154106, 'f1': 0.5319803, 'auroc': 0.89140236, 'binary_precision': 0.5263158, 'binary_recall': 0.044576522, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.08219178}
confusion matrix:
       0   1
0  18040  27
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8633579, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_27.png
new oracle model saved
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9603609442710876 / 0.9606832265853882
after epoch: 27,now: 2024-06-16 10:23:20.870242,epoch time: 0:14:47.903883,used: 6:42:17.920658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.73467755, 'recall': 0.5579322, 'specificity': 0.5579322, 'f1': 0.5882941, 'auroc': 0.9014523, 'binary_precision': 0.4985591, 'binary_recall': 0.11997226, 'binary_specificity': 0.99589217, 'binary_f1_score': 0.19340414}
confusion matrix:
       0    1
0  42184  174
1   1269  173
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7656305, 'recall': 0.5281445, 'specificity': 0.5281445, 'f1': 0.54352367, 'auroc': 0.89320755, 'binary_precision': 0.5652174, 'binary_recall': 0.05794948, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.10512129}
confusion matrix:
       0   1
0  18037  30
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8669423, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_28.png
better model found
persisted
after epoch: 28,now: 2024-06-16 10:37:57.470033,epoch time: 0:14:36.599791,used: 6:56:54.520449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96780825, 'precision': 0.75376856, 'recall': 0.5678837, 'specificity': 0.5678837, 'f1': 0.6027092, 'auroc': 0.9020829, 'binary_precision': 0.536, 'binary_recall': 0.13987474, 'binary_specificity': 0.99589264, 'binary_f1_score': 0.2218543}
confusion matrix:
       0    1
0  42189  174
1   1236  201
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7558222, 'recall': 0.53023493, 'specificity': 0.53023493, 'f1': 0.5469339, 'auroc': 0.89243186, 'binary_precision': 0.54545456, 'binary_recall': 0.062407132, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.111999996}
confusion matrix:
       0   1
0  18032  35
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.86392343, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_29.png
new oracle model saved
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9605220556259155 / 0.9608443379402161
after epoch: 29,now: 2024-06-16 10:52:38.440099,epoch time: 0:14:40.970066,used: 7:11:35.490515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96703196, 'precision': 0.7333739, 'recall': 0.55962616, 'specificity': 0.55962616, 'f1': 0.59047395, 'auroc': 0.90731144, 'binary_precision': 0.4958217, 'binary_recall': 0.12352533, 'binary_specificity': 0.995727, 'binary_f1_score': 0.19777778}
confusion matrix:
       0    1
0  42178  181
1   1263  178
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.76419735, 'recall': 0.5360678, 'specificity': 0.5360678, 'f1': 0.5566022, 'auroc': 0.89690244, 'binary_precision': 0.56179774, 'binary_recall': 0.0742942, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.13123359}
confusion matrix:
       0   1
0  18028  39
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.87039024, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_30.png
better model found
persisted
after epoch: 30,now: 2024-06-16 11:08:12.831832,epoch time: 0:15:34.391733,used: 7:27:09.882248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_03_41_02_seed_1_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:27:09.882248 at 2024-06-16 11:08:12.831832
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.87039024, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
oracle model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.86392343, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688376 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688376 GiB | 688376 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282

 Experiment start at: 2024-06-16 11:16:40.528150
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.43671888, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.36034507, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3645578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 11:33:31.930146,epoch time: 0:16:51.401996,used: 0:16:51.401996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.4534909, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.37917674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3771333, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 11:48:54.736054,epoch time: 0:15:22.805908,used: 0:32:14.207904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.4915901, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.42739147, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.40709388, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 12:04:20.808449,epoch time: 0:15:26.072395,used: 0:47:40.280299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.52085114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.43247408, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.42239285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 12:19:48.935725,epoch time: 0:15:28.127276,used: 1:03:08.407575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.55965376, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49771753, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4935686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 12:35:38.692889,epoch time: 0:15:49.757164,used: 1:18:58.164739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.62006074, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.561259, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5347798, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 12:50:31.299729,epoch time: 0:14:52.606840,used: 1:33:50.771579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.65258443, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.61444294, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5846287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 13:05:21.863550,epoch time: 0:14:50.563821,used: 1:48:41.335400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.70086926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6505343, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6556177, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 13:20:31.477162,epoch time: 0:15:09.613612,used: 2:03:50.949012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7295983, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.70949644, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.70145285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 13:35:10.381294,epoch time: 0:14:38.904132,used: 2:18:29.853144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.771322, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.73977107, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.73495805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 13:49:50.595766,epoch time: 0:14:40.214472,used: 2:33:10.067616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.791394, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.78152156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.77271605, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 14:04:34.182656,epoch time: 0:14:43.586890,used: 2:47:53.654506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.8173512, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7977356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7845474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 14:19:20.618445,epoch time: 0:14:46.435789,used: 3:02:40.090295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.98276174, 'recall': 0.5006614, 'specificity': 0.5006614, 'f1': 0.49255073, 'auroc': 0.8338649, 'binary_precision': 1.0, 'binary_recall': 0.0013227513, 'binary_specificity': 1.0, 'binary_f1_score': 0.0026420078}
confusion matrix:
       0  1
0  42288  0
1   1510  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.82093835, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80784607, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 14:34:17.928639,epoch time: 0:14:57.310194,used: 3:17:37.400489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9655479, 'precision': 0.78279483, 'recall': 0.50096977, 'specificity': 0.50096977, 'f1': 0.4932156, 'auroc': 0.85000074, 'binary_precision': 0.6, 'binary_recall': 0.001986755, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.003960396}
confusion matrix:
       0  1
0  42288  2
1   1507  3
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83727205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8074784, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 14:49:09.830410,epoch time: 0:14:51.901771,used: 3:32:29.302260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.81610495, 'recall': 0.50129825, 'specificity': 0.50129825, 'f1': 0.49385667, 'auroc': 0.8511857, 'binary_precision': 0.6666667, 'binary_recall': 0.0026437542, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0052666226}
confusion matrix:
       0  1
0  42285  2
1   1509  4
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8448552, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.82718825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 15:03:59.493430,epoch time: 0:14:49.663020,used: 3:47:18.965280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96561646, 'precision': 0.79772663, 'recall': 0.5054998, 'specificity': 0.5054998, 'f1': 0.5022893, 'auroc': 0.8716831, 'binary_precision': 0.6296296, 'binary_recall': 0.011235955, 'binary_specificity': 0.99976355, 'binary_f1_score': 0.022077922}
confusion matrix:
       0   1
0  42277  10
1   1496  17
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8562175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83164585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 15:19:47.099112,epoch time: 0:15:47.605682,used: 4:03:06.570962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9656621, 'precision': 0.77650833, 'recall': 0.50870395, 'specificity': 0.50870395, 'f1': 0.50859, 'auroc': 0.87344784, 'binary_precision': 0.5869565, 'binary_recall': 0.017857144, 'binary_specificity': 0.9995507, 'binary_f1_score': 0.03465982}
confusion matrix:
       0   1
0  42269  19
1   1485  27
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.86432594, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83782494, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_17.png
early stop counter: 16
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-16 15:34:32.282942,epoch time: 0:14:45.183830,used: 4:17:51.754792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.73601687, 'recall': 0.51435083, 'specificity': 0.51435083, 'f1': 0.519299, 'auroc': 0.88222075, 'binary_precision': 0.505618, 'binary_recall': 0.029742233, 'binary_specificity': 0.9989595, 'binary_f1_score': 0.056179773}
confusion matrix:
       0   1
0  42243  44
1   1468  45
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.68401533, 'recall': 0.50157857, 'specificity': 0.50157857, 'f1': 0.4951328, 'auroc': 0.8751625, 'binary_precision': 0.4, 'binary_recall': 0.003322259, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.006589785}
confusion matrix:
       0  1
0  18168  3
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.84650445, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_18.png
new oracle model saved
early stop counter: 17
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9618528485298157
after epoch: 18,now: 2024-06-16 15:49:08.697978,epoch time: 0:14:36.415036,used: 4:32:28.169828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9657078, 'precision': 0.7514688, 'recall': 0.521485, 'specificity': 0.521485, 'f1': 0.5322173, 'auroc': 0.88169646, 'binary_precision': 0.536, 'binary_recall': 0.044341497, 'binary_specificity': 0.9986285, 'binary_f1_score': 0.08190709}
confusion matrix:
       0   1
0  42231  58
1   1444  67
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.83414435, 'recall': 0.5057314, 'specificity': 0.5057314, 'f1': 0.5033424, 'auroc': 0.87839496, 'binary_precision': 0.7, 'binary_recall': 0.011627907, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.022875817}
confusion matrix:
       0  1
0  18168  3
1    595  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.8544214, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-16 16:03:52.408641,epoch time: 0:14:43.710663,used: 4:47:11.880491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7736294, 'recall': 0.52095324, 'specificity': 0.52095324, 'f1': 0.53136677, 'auroc': 0.881835, 'binary_precision': 0.58035713, 'binary_recall': 0.043017868, 'binary_specificity': 0.9988886, 'binary_f1_score': 0.08009858}
confusion matrix:
       0   1
0  42242  47
1   1446  65
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6840644, 'recall': 0.50315714, 'specificity': 0.50315714, 'f1': 0.49835923, 'auroc': 0.87032044, 'binary_precision': 0.4, 'binary_recall': 0.006644518, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.013071895}
confusion matrix:
       0  1
0  18165  6
1    598  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.8444662, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_20.png
new oracle model saved
early stop counter: 1
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9623336791992188
after epoch: 20,now: 2024-06-16 16:18:42.098732,epoch time: 0:14:49.690091,used: 5:02:01.570582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9652968, 'precision': 0.7197653, 'recall': 0.524463, 'specificity': 0.524463, 'f1': 0.53715277, 'auroc': 0.8917283, 'binary_precision': 0.47239265, 'binary_recall': 0.050959628, 'binary_specificity': 0.99796635, 'binary_f1_score': 0.091995224}
confusion matrix:
       0   1
0  42203  86
1   1434  77
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74513626, 'recall': 0.5096641, 'specificity': 0.5096641, 'f1': 0.5110611, 'auroc': 0.88060063, 'binary_precision': 0.5217391, 'binary_recall': 0.019933555, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.038399998}
confusion matrix:
       0   1
0  18160  11
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.85371923, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_21.png
new oracle model saved
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9629748463630676
after epoch: 21,now: 2024-06-16 16:33:25.302939,epoch time: 0:14:43.204207,used: 5:16:44.774789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9658676, 'precision': 0.75597936, 'recall': 0.5355825, 'specificity': 0.5355825, 'f1': 0.55594397, 'auroc': 0.89457405, 'binary_precision': 0.5441176, 'binary_recall': 0.073364176, 'binary_specificity': 0.99780077, 'binary_f1_score': 0.12929527}
confusion matrix:
       0    1
0  42194   93
1   1402  111
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73439085, 'recall': 0.51365185, 'specificity': 0.51365185, 'f1': 0.5185746, 'auroc': 0.8839404, 'binary_precision': 0.5, 'binary_recall': 0.028239202, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.05345912}
confusion matrix:
       0   1
0  18154  17
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.98160934, 'recall': 0.5268595, 'specificity': 0.5268595, 'f1': 0.5416128, 'auroc': 0.8558449, 'binary_precision': 1.0, 'binary_recall': 0.053719006, 'binary_specificity': 1.0, 'binary_f1_score': 0.10196078}
confusion matrix:
      0   1
0  5997   0
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_22.png
new oracle model saved
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9632954001426697
after epoch: 22,now: 2024-06-16 16:48:00.730366,epoch time: 0:14:35.427427,used: 5:31:20.202216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9661187, 'precision': 0.76402855, 'recall': 0.54367864, 'specificity': 0.54367864, 'f1': 0.5688052, 'auroc': 0.8967279, 'binary_precision': 0.5596708, 'binary_recall': 0.08988764, 'binary_specificity': 0.99746966, 'binary_f1_score': 0.15489751}
confusion matrix:
       0    1
0  42180  107
1   1377  136
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7537242, 'recall': 0.51694655, 'specificity': 0.51694655, 'f1': 0.52464586, 'auroc': 0.8848263, 'binary_precision': 0.53846157, 'binary_recall': 0.034883723, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.06552262}
confusion matrix:
       0   1
0  18153  18
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.98184156, 'recall': 0.53305787, 'specificity': 0.53305787, 'f1': 0.55276835, 'auroc': 0.85929793, 'binary_precision': 1.0, 'binary_recall': 0.0661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.124031}
confusion matrix:
      0   1
0  5997   0
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_23.png
new oracle model saved
early stop counter: 4
val acc:0.9680925011634827, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9637762308120728
after epoch: 23,now: 2024-06-16 17:02:38.084614,epoch time: 0:14:37.354248,used: 5:45:57.556464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9658219, 'precision': 0.74793273, 'recall': 0.54641265, 'specificity': 0.54641265, 'f1': 0.5724191, 'auroc': 0.897452, 'binary_precision': 0.5272727, 'binary_recall': 0.09589947, 'binary_specificity': 0.99692583, 'binary_f1_score': 0.16228315}
confusion matrix:
       0    1
0  42158  130
1   1367  145
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.734491, 'recall': 0.516864, 'specificity': 0.516864, 'f1': 0.524452, 'auroc': 0.88769585, 'binary_precision': 0.5, 'binary_recall': 0.034883723, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.06521739}
confusion matrix:
       0   1
0  18150  21
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.98207396, 'recall': 0.5392562, 'specificity': 0.5392562, 'f1': 0.5636703, 'auroc': 0.86120623, 'binary_precision': 1.0, 'binary_recall': 0.0785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.14559387}
confusion matrix:
      0   1
0  5997   0
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_24.png
new oracle model saved
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9642571210861206
after epoch: 24,now: 2024-06-16 17:17:14.523450,epoch time: 0:14:36.438836,used: 6:00:33.995300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9660274, 'precision': 0.7546328, 'recall': 0.553828, 'specificity': 0.553828, 'f1': 0.5834315, 'auroc': 0.8979714, 'binary_precision': 0.5401929, 'binary_recall': 0.11103767, 'binary_specificity': 0.99661833, 'binary_f1_score': 0.18421052}
confusion matrix:
       0    1
0  42144  143
1   1345  168
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7499248, 'recall': 0.5209618, 'specificity': 0.5209618, 'f1': 0.5318209, 'auroc': 0.88828754, 'binary_precision': 0.53061223, 'binary_recall': 0.04318937, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.079877116}
confusion matrix:
       0   1
0  18148  23
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.98269475, 'recall': 0.5557851, 'specificity': 0.5557851, 'f1': 0.5915668, 'auroc': 0.8579488, 'binary_precision': 1.0, 'binary_recall': 0.11157025, 'binary_specificity': 1.0, 'binary_f1_score': 0.2007435}
confusion matrix:
      0   1
0  5997   0
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_25.png
new oracle model saved
early stop counter: 6
val acc:0.9680925011634827, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9655393362045288
after epoch: 25,now: 2024-06-16 17:31:55.600928,epoch time: 0:14:41.077478,used: 6:15:15.072778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96618724, 'precision': 0.7573498, 'recall': 0.5599941, 'specificity': 0.5599941, 'f1': 0.59217256, 'auroc': 0.9054006, 'binary_precision': 0.5451895, 'binary_recall': 0.123677246, 'binary_specificity': 0.996311, 'binary_f1_score': 0.20161726}
confusion matrix:
       0    1
0  42132  156
1   1325  187
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74283284, 'recall': 0.5257526, 'specificity': 0.5257526, 'f1': 0.54005873, 'auroc': 0.8935962, 'binary_precision': 0.516129, 'binary_recall': 0.053156145, 'binary_specificity': 0.998349, 'binary_f1_score': 0.096385546}
confusion matrix:
       0   1
0  18141  30
1    570  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.8631084, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_26.png
new oracle model saved
early stop counter: 7
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9660201668739319
after epoch: 26,now: 2024-06-16 17:46:40.220761,epoch time: 0:14:44.619833,used: 6:29:59.692611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7607687, 'recall': 0.5652677, 'specificity': 0.5652677, 'f1': 0.5995078, 'auroc': 0.90173495, 'binary_precision': 0.55163044, 'binary_recall': 0.13443708, 'binary_specificity': 0.99609834, 'binary_f1_score': 0.21618742}
confusion matrix:
       0    1
0  42125  165
1   1307  203
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7382515, 'recall': 0.5305433, 'specificity': 0.5305433, 'f1': 0.5479795, 'auroc': 0.89295816, 'binary_precision': 0.50666666, 'binary_recall': 0.06312292, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.11225997}
confusion matrix:
       0   1
0  18134  37
1    564  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.86655724, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_27.png
early stop counter: 8
val acc:0.9679859280586243, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9660201668739319
after epoch: 27,now: 2024-06-16 18:01:26.119541,epoch time: 0:14:45.898780,used: 6:44:45.591391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96621007, 'precision': 0.75798583, 'recall': 0.5584397, 'specificity': 0.5584397, 'f1': 0.59006935, 'auroc': 0.9048584, 'binary_precision': 0.5465465, 'binary_recall': 0.120450035, 'binary_specificity': 0.9964293, 'binary_f1_score': 0.19739698}
confusion matrix:
       0    1
0  42138  151
1   1329  182
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7509241, 'recall': 0.5266107, 'specificity': 0.5266107, 'f1': 0.5415918, 'auroc': 0.8928621, 'binary_precision': 0.5322581, 'binary_recall': 0.054817274, 'binary_specificity': 0.998404, 'binary_f1_score': 0.09939759}
confusion matrix:
       0   1
0  18142  29
1    569  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86486477, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_28.png
new oracle model saved
early stop counter: 9
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9661805033683777
after epoch: 28,now: 2024-06-16 18:16:04.072871,epoch time: 0:14:37.953330,used: 6:59:23.544721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9653653, 'precision': 0.7318226, 'recall': 0.56403255, 'specificity': 0.56403255, 'f1': 0.59588945, 'auroc': 0.90687656, 'binary_precision': 0.4938575, 'binary_recall': 0.13293651, 'binary_specificity': 0.99512863, 'binary_f1_score': 0.20948412}
confusion matrix:
       0    1
0  42082  206
1   1311  201
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74183834, 'recall': 0.5297678, 'specificity': 0.5297678, 'f1': 0.54675984, 'auroc': 0.8979636, 'binary_precision': 0.5138889, 'binary_recall': 0.061461795, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.109792285}
confusion matrix:
       0   1
0  18136  35
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.98316145, 'recall': 0.5681818, 'specificity': 0.5681818, 'f1': 0.61143655, 'auroc': 0.866868, 'binary_precision': 1.0, 'binary_recall': 0.13636364, 'binary_specificity': 1.0, 'binary_f1_score': 0.24000001}
confusion matrix:
      0   1
0  5997   0
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_29.png
new oracle model saved
early stop counter: 10
val acc:0.9680392146110535, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 29,now: 2024-06-16 18:30:41.182936,epoch time: 0:14:37.110065,used: 7:14:00.654786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96607304, 'precision': 0.75098306, 'recall': 0.57265174, 'specificity': 0.57265174, 'f1': 0.6083365, 'auroc': 0.9058058, 'binary_precision': 0.5316159, 'binary_recall': 0.15003304, 'binary_specificity': 0.99527043, 'binary_f1_score': 0.23402062}
confusion matrix:
       0    1
0  42087  200
1   1286  227
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7376977, 'recall': 0.541786, 'specificity': 0.541786, 'f1': 0.5656022, 'auroc': 0.8989079, 'binary_precision': 0.5048544, 'binary_recall': 0.08637874, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.14751773}
confusion matrix:
       0   1
0  18120  51
1    550  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.98316145, 'recall': 0.5681818, 'specificity': 0.5681818, 'f1': 0.61143655, 'auroc': 0.87341315, 'binary_precision': 1.0, 'binary_recall': 0.13636364, 'binary_specificity': 1.0, 'binary_f1_score': 0.24000001}
confusion matrix:
      0   1
0  5997   0
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327282_30.png
early stop counter: 11
val acc:0.9679859280586243, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 30,now: 2024-06-16 18:45:30.137553,epoch time: 0:14:48.954617,used: 7:28:49.609403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_11_16_40_seed_2_21327282
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:28:49.609403 at 2024-06-16 18:45:30.137553
persisted model performance metric: 

scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.8544214, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
oracle model performance metric: 

scalar performance:
{'acc': 0.96650106, 'precision': 0.98316145, 'recall': 0.5681818, 'specificity': 0.5681818, 'f1': 0.61143655, 'auroc': 0.866868, 'binary_precision': 1.0, 'binary_recall': 0.13636364, 'binary_specificity': 1.0, 'binary_f1_score': 0.24000001}
confusion matrix:
      0   1
0  5997   0
1   209  33
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36066 K  |   36065 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21716 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36066 K  |   36066 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21716 K  |   21716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun 16 18:46:09 2024]
Finished job 0.
1 of 1 steps (100%) done
