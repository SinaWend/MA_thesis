Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 16 13:35:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387

 Experiment start at: 2024-06-16 13:46:55.149601
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.73417246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6987246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.716907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 14:11:25.321921,epoch time: 0:24:30.172320,used: 0:24:30.172320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.73353755, 'recall': 0.51049155, 'specificity': 0.51049155, 'f1': 0.5122816, 'auroc': 0.8680949, 'binary_precision': 0.5, 'binary_recall': 0.02173913, 'binary_specificity': 0.999244, 'binary_f1_score': 0.041666668}
confusion matrix:
       0   1
0  42296  32
1   1440  32
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8520836, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8458241, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_2.png
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-16 14:35:48.073688,epoch time: 0:24:22.751767,used: 0:48:52.924087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664612, 'precision': 0.73664117, 'recall': 0.5374262, 'specificity': 0.5374262, 'f1': 0.558627, 'auroc': 0.8917531, 'binary_precision': 0.50442475, 'binary_recall': 0.0774983, 'binary_specificity': 0.99735403, 'binary_f1_score': 0.13435474}
confusion matrix:
       0    1
0  42217  112
1   1357  114
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72229415, 'recall': 0.50822306, 'specificity': 0.50822306, 'f1': 0.5077945, 'auroc': 0.882476, 'binary_precision': 0.47826087, 'binary_recall': 0.01710731, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.033033036}
confusion matrix:
       0   1
0  18137  12
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8697612, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_3.png
new oracle model saved
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 3,now: 2024-06-16 15:00:02.142093,epoch time: 0:24:14.068405,used: 1:13:06.992492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96650684, 'precision': 0.7384244, 'recall': 0.57448363, 'specificity': 0.57448363, 'f1': 0.6096066, 'auroc': 0.90161633, 'binary_precision': 0.5055679, 'binary_recall': 0.15421195, 'binary_specificity': 0.99475527, 'binary_f1_score': 0.23633523}
confusion matrix:
       0    1
0  42106  222
1   1245  227
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7831911, 'recall': 0.54174894, 'specificity': 0.54174894, 'f1': 0.5663494, 'auroc': 0.8958561, 'binary_precision': 0.59782606, 'binary_recall': 0.08553655, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.14965986}
confusion matrix:
       0   1
0  18112  37
1    588  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.87725234, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-16 15:24:29.194538,epoch time: 0:24:27.052445,used: 1:37:34.044937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.759312, 'recall': 0.6075207, 'specificity': 0.6075207, 'f1': 0.6491984, 'auroc': 0.91081786, 'binary_precision': 0.5451505, 'binary_recall': 0.22146739, 'binary_specificity': 0.993574, 'binary_f1_score': 0.31497586}
confusion matrix:
       0    1
0  42056  272
1   1146  326
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7944586, 'recall': 0.5471646, 'specificity': 0.5471646, 'f1': 0.5750445, 'auroc': 0.9008416, 'binary_precision': 0.62, 'binary_recall': 0.096423015, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.16689098}
confusion matrix:
       0   1
0  18111  38
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.98153204, 'recall': 0.55938697, 'specificity': 0.55938697, 'f1': 0.59675664, 'auroc': 0.87808084, 'binary_precision': 1.0, 'binary_recall': 0.118773945, 'binary_specificity': 1.0, 'binary_f1_score': 0.21232876}
confusion matrix:
      0   1
0  5997   0
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_5.png
better model found
persisted
after epoch: 5,now: 2024-06-16 15:48:13.682332,epoch time: 0:23:44.487794,used: 2:01:18.532731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670091, 'precision': 0.7463838, 'recall': 0.62851274, 'specificity': 0.62851274, 'f1': 0.6671096, 'auroc': 0.91620445, 'binary_precision': 0.5178808, 'binary_recall': 0.265625, 'binary_specificity': 0.9914005, 'binary_f1_score': 0.35114503}
confusion matrix:
       0    1
0  41964  364
1   1081  391
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7567367, 'recall': 0.57694644, 'specificity': 0.57694644, 'f1': 0.61421376, 'auroc': 0.913845, 'binary_precision': 0.5425532, 'binary_recall': 0.15863141, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.24548735}
confusion matrix:
       0    1
0  18063   86
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.9837071, 'recall': 0.6130268, 'specificity': 0.6130268, 'f1': 0.6760936, 'auroc': 0.88592094, 'binary_precision': 1.0, 'binary_recall': 0.22605364, 'binary_specificity': 1.0, 'binary_f1_score': 0.36875}
confusion matrix:
      0   1
0  5997   0
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_6.png
new oracle model saved
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9632470607757568 / 0.9677213430404663
after epoch: 6,now: 2024-06-16 16:12:17.431743,epoch time: 0:24:03.749411,used: 2:25:22.282142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96753424, 'precision': 0.75517106, 'recall': 0.6232108, 'specificity': 0.6232108, 'f1': 0.66402763, 'auroc': 0.9215431, 'binary_precision': 0.5358166, 'binary_recall': 0.2540761, 'binary_specificity': 0.9923455, 'binary_f1_score': 0.34470046}
confusion matrix:
       0    1
0  42004  324
1   1098  374
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.77113086, 'recall': 0.57569426, 'specificity': 0.57569426, 'f1': 0.6138449, 'auroc': 0.91558003, 'binary_precision': 0.5714286, 'binary_recall': 0.15552099, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.24449877}
confusion matrix:
       0    1
0  18074   75
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.98316145, 'recall': 0.5996169, 'specificity': 0.5996169, 'f1': 0.6575707, 'auroc': 0.88900644, 'binary_precision': 1.0, 'binary_recall': 0.19923371, 'binary_specificity': 1.0, 'binary_f1_score': 0.33226836}
confusion matrix:
      0   1
0  5997   0
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_7.png
better model found
persisted
after epoch: 7,now: 2024-06-16 16:37:21.154733,epoch time: 0:25:03.722990,used: 2:50:26.005132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96680367, 'precision': 0.74329096, 'recall': 0.631685, 'specificity': 0.631685, 'f1': 0.66922975, 'auroc': 0.9246187, 'binary_precision': 0.5114796, 'binary_recall': 0.27241847, 'binary_specificity': 0.9909516, 'binary_f1_score': 0.35549644}
confusion matrix:
       0    1
0  41945  383
1   1071  401
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7709862, 'recall': 0.58249986, 'specificity': 0.58249986, 'f1': 0.62231445, 'auroc': 0.9214977, 'binary_precision': 0.5706806, 'binary_recall': 0.16951789, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.2613909}
confusion matrix:
       0    1
0  18067   82
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.98292804, 'recall': 0.59386975, 'specificity': 0.59386975, 'f1': 0.6493802, 'auroc': 0.8894079, 'binary_precision': 1.0, 'binary_recall': 0.18773946, 'binary_specificity': 1.0, 'binary_f1_score': 0.31612903}
confusion matrix:
      0   1
0  5997   0
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_8.png
better model found
persisted
after epoch: 8,now: 2024-06-16 17:02:24.942383,epoch time: 0:25:03.787650,used: 3:15:29.792782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9676484, 'precision': 0.75895023, 'recall': 0.6117947, 'specificity': 0.6117947, 'f1': 0.65352774, 'auroc': 0.9238116, 'binary_precision': 0.54414123, 'binary_recall': 0.2302989, 'binary_specificity': 0.9932905, 'binary_f1_score': 0.32362765}
confusion matrix:
       0    1
0  42044  284
1   1133  339
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.78493863, 'recall': 0.56149834, 'specificity': 0.56149834, 'f1': 0.5957449, 'auroc': 0.92497194, 'binary_precision': 0.6, 'binary_recall': 0.125972, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.2082262}
confusion matrix:
       0   1
0  18095  54
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.89008844, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_9.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9661233425140381 / 0.9677213430404663
after epoch: 9,now: 2024-06-16 17:27:46.000117,epoch time: 0:25:21.057734,used: 3:40:50.850516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.7632871, 'recall': 0.63697207, 'specificity': 0.63697207, 'f1': 0.67834705, 'auroc': 0.92539775, 'binary_precision': 0.5511288, 'binary_recall': 0.28192934, 'binary_specificity': 0.99201477, 'binary_f1_score': 0.37303373}
confusion matrix:
       0    1
0  41990  338
1   1057  415
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7750937, 'recall': 0.58938813, 'specificity': 0.58938813, 'f1': 0.6309993, 'auroc': 0.92815006, 'binary_precision': 0.57843137, 'binary_recall': 0.18351477, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.27863047}
confusion matrix:
       0    1
0  18063   86
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9826171, 'recall': 0.5862069, 'specificity': 0.5862069, 'f1': 0.63821363, 'auroc': 0.8935089, 'binary_precision': 1.0, 'binary_recall': 0.1724138, 'binary_specificity': 1.0, 'binary_f1_score': 0.29411763}
confusion matrix:
      0   1
0  5997   0
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_10.png
better model found
persisted
after epoch: 10,now: 2024-06-16 17:52:26.301212,epoch time: 0:24:40.301095,used: 4:05:31.151611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96789956, 'precision': 0.7568363, 'recall': 0.6588088, 'specificity': 0.6588088, 'f1': 0.6951273, 'auroc': 0.93059015, 'binary_precision': 0.53674835, 'binary_recall': 0.32744566, 'binary_specificity': 0.99017197, 'binary_f1_score': 0.40675107}
confusion matrix:
       0    1
0  41912  416
1    990  482
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.763609, 'recall': 0.5951957, 'specificity': 0.5951957, 'f1': 0.6364112, 'auroc': 0.9309168, 'binary_precision': 0.5550661, 'binary_recall': 0.19595645, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.28965515}
confusion matrix:
       0    1
0  18048  101
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9833951, 'recall': 0.60536397, 'specificity': 0.60536397, 'f1': 0.66560805, 'auroc': 0.8949855, 'binary_precision': 1.0, 'binary_recall': 0.21072797, 'binary_specificity': 1.0, 'binary_f1_score': 0.3481013}
confusion matrix:
      0   1
0  5997   0
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_11.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9654842019081116 / 0.9677213430404663
after epoch: 11,now: 2024-06-16 18:17:55.984184,epoch time: 0:25:29.682972,used: 4:31:00.834583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96881276, 'precision': 0.77149326, 'recall': 0.64878976, 'specificity': 0.64878976, 'f1': 0.69058394, 'auroc': 0.9318779, 'binary_precision': 0.56675065, 'binary_recall': 0.30570653, 'binary_specificity': 0.99187297, 'binary_f1_score': 0.39717567}
confusion matrix:
       0    1
0  41984  344
1   1022  450
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7813756, 'recall': 0.58344275, 'specificity': 0.58344275, 'f1': 0.6244054, 'auroc': 0.93135655, 'binary_precision': 0.5913978, 'binary_recall': 0.1710731, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.26537997}
confusion matrix:
       0    1
0  18073   76
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.98277247, 'recall': 0.5900383, 'specificity': 0.5900383, 'f1': 0.6438327, 'auroc': 0.89653766, 'binary_precision': 1.0, 'binary_recall': 0.18007663, 'binary_specificity': 1.0, 'binary_f1_score': 0.30519482}
confusion matrix:
      0   1
0  5997   0
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_12.png
better model found
persisted
after epoch: 12,now: 2024-06-16 18:42:49.086290,epoch time: 0:24:53.102106,used: 4:55:53.936689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.7649778, 'recall': 0.64603275, 'specificity': 0.64603275, 'f1': 0.686684, 'auroc': 0.93301594, 'binary_precision': 0.5538847, 'binary_recall': 0.30047587, 'binary_specificity': 0.99158967, 'binary_f1_score': 0.38959894}
confusion matrix:
       0    1
0  41973  356
1   1029  442
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.79067457, 'recall': 0.5668865, 'specificity': 0.5668865, 'f1': 0.60351473, 'auroc': 0.9324585, 'binary_precision': 0.6111111, 'binary_recall': 0.13685848, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.22363405}
confusion matrix:
       0   1
0  18093  56
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8932156, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_13.png
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9658037424087524 / 0.9677213430404663
after epoch: 13,now: 2024-06-16 19:07:18.909644,epoch time: 0:24:29.823354,used: 5:20:23.760043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9686758, 'precision': 0.77575004, 'recall': 0.6241293, 'specificity': 0.6241293, 'f1': 0.6686946, 'auroc': 0.93286896, 'binary_precision': 0.5769231, 'binary_recall': 0.25475544, 'binary_specificity': 0.9935031, 'binary_f1_score': 0.35344017}
confusion matrix:
       0    1
0  42053  275
1   1097  375
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.78581834, 'recall': 0.5675814, 'specificity': 0.5675814, 'f1': 0.6041854, 'auroc': 0.93511015, 'binary_precision': 0.6013514, 'binary_recall': 0.13841368, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.2250316}
confusion matrix:
       0   1
0  18090  59
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8950104, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_14.png
early stop counter: 2
val acc:0.9673797488212585, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9658037424087524 / 0.9677213430404663
after epoch: 14,now: 2024-06-16 19:32:11.167434,epoch time: 0:24:52.257790,used: 5:45:16.017833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9686758, 'precision': 0.7676034, 'recall': 0.65635717, 'specificity': 0.65635717, 'f1': 0.6960113, 'auroc': 0.93588865, 'binary_precision': 0.5584416, 'binary_recall': 0.32154995, 'binary_specificity': 0.99116445, 'binary_f1_score': 0.40811044}
confusion matrix:
       0    1
0  41955  374
1    998  473
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.78578115, 'recall': 0.58655316, 'specificity': 0.58655316, 'f1': 0.6286237, 'auroc': 0.93625164, 'binary_precision': 0.6, 'binary_recall': 0.17729394, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.2737095}
confusion matrix:
       0    1
0  18073   76
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.89795935, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_15.png
better model found
persisted
after epoch: 15,now: 2024-06-16 19:56:59.567480,epoch time: 0:24:48.400046,used: 6:10:04.417879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9697945, 'precision': 0.7800653, 'recall': 0.6748709, 'specificity': 0.6748709, 'f1': 0.7141798, 'auroc': 0.93538105, 'binary_precision': 0.5821389, 'binary_recall': 0.35869566, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.443884}
confusion matrix:
       0    1
0  41949  379
1    944  528
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7779304, 'recall': 0.60080427, 'specificity': 0.60080427, 'f1': 0.6444585, 'auroc': 0.9379718, 'binary_precision': 0.5833333, 'binary_recall': 0.20684293, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.30539608}
confusion matrix:
       0    1
0  18054   95
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9823066, 'recall': 0.5785441, 'specificity': 0.5785441, 'f1': 0.6267555, 'auroc': 0.897802, 'binary_precision': 1.0, 'binary_recall': 0.15708812, 'binary_specificity': 1.0, 'binary_f1_score': 0.27152315}
confusion matrix:
      0   1
0  5997   0
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_16.png
early stop counter: 1
val acc:0.9678054451942444, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9637264013290405 / 0.9677213430404663
after epoch: 16,now: 2024-06-16 20:21:51.370198,epoch time: 0:24:51.802718,used: 6:34:56.220597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9693607, 'precision': 0.7741814, 'recall': 0.6727881, 'specificity': 0.6727881, 'f1': 0.71090186, 'auroc': 0.93592244, 'binary_precision': 0.5704918, 'binary_recall': 0.35486063, 'binary_specificity': 0.99071556, 'binary_f1_score': 0.43755236}
confusion matrix:
       0    1
0  41936  393
1    949  522
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7912016, 'recall': 0.6101906, 'specificity': 0.6101906, 'f1': 0.65653455, 'auroc': 0.93913287, 'binary_precision': 0.6092437, 'binary_recall': 0.22550544, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.32917142}
confusion matrix:
       0    1
0  18056   93
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.8975107, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_17.png
better model found
persisted
after epoch: 17,now: 2024-06-16 20:46:48.077751,epoch time: 0:24:56.707553,used: 6:59:52.928150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9696119, 'precision': 0.7832796, 'recall': 0.65313756, 'specificity': 0.65313756, 'f1': 0.69708025, 'auroc': 0.9357059, 'binary_precision': 0.5900383, 'binary_recall': 0.3138587, 'binary_specificity': 0.9924164, 'binary_f1_score': 0.4097561}
confusion matrix:
       0    1
0  42007  321
1   1010  462
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.78736913, 'recall': 0.58658075, 'specificity': 0.58658075, 'f1': 0.628802, 'auroc': 0.93990266, 'binary_precision': 0.6031746, 'binary_recall': 0.17729394, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.27403846}
confusion matrix:
       0    1
0  18074   75
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.89563185, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_18.png
early stop counter: 1
val acc:0.9678586721420288, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9645254015922546 / 0.9677213430404663
after epoch: 18,now: 2024-06-16 21:12:10.686074,epoch time: 0:25:22.608323,used: 7:25:15.536473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96856165, 'precision': 0.76342165, 'recall': 0.6743432, 'specificity': 0.6743432, 'f1': 0.7089319, 'auroc': 0.9385971, 'binary_precision': 0.54885656, 'binary_recall': 0.3589395, 'binary_specificity': 0.989747, 'binary_f1_score': 0.43403208}
confusion matrix:
       0    1
0  41895  434
1    943  528
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.7962822, 'recall': 0.6209393, 'specificity': 0.6209393, 'f1': 0.6687341, 'auroc': 0.9412682, 'binary_precision': 0.618677, 'binary_recall': 0.24727838, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.35333332}
confusion matrix:
       0    1
0  18051   98
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.89493704, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_19.png
better model found
persisted
after epoch: 19,now: 2024-06-16 21:37:06.855872,epoch time: 0:24:56.169798,used: 7:50:11.706271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.7840172, 'recall': 0.70480365, 'specificity': 0.70480365, 'f1': 0.73738277, 'auroc': 0.9409461, 'binary_precision': 0.58801144, 'binary_recall': 0.41983697, 'binary_specificity': 0.98977035, 'binary_f1_score': 0.48989302}
confusion matrix:
       0    1
0  41895  433
1    854  618
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7933277, 'recall': 0.6307452, 'specificity': 0.6307452, 'f1': 0.67823666, 'auroc': 0.9415813, 'binary_precision': 0.61209965, 'binary_recall': 0.2674961, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.37229437}
confusion matrix:
       0    1
0  18040  109
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.8965576, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_20.png
better model found
persisted
after epoch: 20,now: 2024-06-16 22:02:21.463966,epoch time: 0:25:14.608094,used: 8:15:26.314365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9704338, 'precision': 0.7828607, 'recall': 0.69860643, 'specificity': 0.69860643, 'f1': 0.7326647, 'auroc': 0.9397422, 'binary_precision': 0.5861057, 'binary_recall': 0.40720597, 'binary_specificity': 0.99000686, 'binary_f1_score': 0.48054555}
confusion matrix:
       0    1
0  41906  423
1    872  599
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7905134, 'recall': 0.6367456, 'specificity': 0.6367456, 'f1': 0.6835754, 'auroc': 0.9430927, 'binary_precision': 0.6060606, 'binary_recall': 0.2799378, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.38297877}
confusion matrix:
       0    1
0  18032  117
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9720537, 'recall': 0.5880392, 'specificity': 0.5880392, 'f1': 0.640504, 'auroc': 0.89855576, 'binary_precision': 0.9787234, 'binary_recall': 0.17624521, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.29870132}
confusion matrix:
      0   1
0  5996   1
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_21.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9650048017501831 / 0.9677213430404663
after epoch: 21,now: 2024-06-16 22:27:26.349117,epoch time: 0:25:04.885151,used: 8:40:31.199516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97002286, 'precision': 0.78720725, 'recall': 0.66187453, 'specificity': 0.66187453, 'f1': 0.70549816, 'auroc': 0.9407475, 'binary_precision': 0.5973072, 'binary_recall': 0.33152175, 'binary_specificity': 0.9922274, 'binary_f1_score': 0.42638707}
confusion matrix:
       0    1
0  41999  329
1    984  488
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.8040037, 'recall': 0.6112161, 'specificity': 0.6112161, 'f1': 0.65932626, 'auroc': 0.9417746, 'binary_precision': 0.6347826, 'binary_recall': 0.22706065, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.33447883}
confusion matrix:
       0    1
0  18065   84
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.8969862, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_22.png
early stop counter: 2
val acc:0.9690825939178467, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9650048017501831 / 0.9677213430404663
after epoch: 22,now: 2024-06-16 22:52:31.601711,epoch time: 0:25:05.252594,used: 9:05:36.452110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9701142, 'precision': 0.78695726, 'recall': 0.6671676, 'specificity': 0.6671676, 'f1': 0.7098482, 'auroc': 0.9405061, 'binary_precision': 0.59644973, 'binary_recall': 0.3423913, 'binary_specificity': 0.9919439, 'binary_f1_score': 0.43504533}
confusion matrix:
       0    1
0  41987  341
1    968  504
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.8031801, 'recall': 0.6104385, 'specificity': 0.6104385, 'f1': 0.65835786, 'auroc': 0.9417591, 'binary_precision': 0.6331878, 'binary_recall': 0.22550544, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.3325688}
confusion matrix:
       0    1
0  18065   84
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.895468, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_23.png
early stop counter: 3
val acc:0.9690293669700623, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9650048017501831 / 0.9677213430404663
after epoch: 23,now: 2024-06-16 23:17:47.126229,epoch time: 0:25:15.524518,used: 9:30:51.976628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9704566, 'precision': 0.7905384, 'recall': 0.67259055, 'specificity': 0.67259055, 'f1': 0.71520543, 'auroc': 0.93911403, 'binary_precision': 0.60324824, 'binary_recall': 0.35326087, 'binary_specificity': 0.99192023, 'binary_f1_score': 0.44558695}
confusion matrix:
       0    1
0  41986  342
1    952  520
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8016619, 'recall': 0.62029946, 'specificity': 0.62029946, 'f1': 0.668857, 'auroc': 0.9421871, 'binary_precision': 0.6294821, 'binary_recall': 0.24572317, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.35346755}
confusion matrix:
       0    1
0  18056   93
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8949015, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_24.png
better model found
persisted
after epoch: 24,now: 2024-06-16 23:44:19.636878,epoch time: 0:26:32.510649,used: 9:57:24.487277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.79460394, 'recall': 0.65746164, 'specificity': 0.65746164, 'f1': 0.7034382, 'auroc': 0.94124305, 'binary_precision': 0.6124031, 'binary_recall': 0.32201087, 'binary_specificity': 0.9929125, 'binary_f1_score': 0.4220837}
confusion matrix:
       0    1
0  42028  300
1    998  474
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.8122015, 'recall': 0.60832614, 'specificity': 0.60832614, 'f1': 0.6570684, 'auroc': 0.94318426, 'binary_precision': 0.6513761, 'binary_recall': 0.22083981, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.329849}
confusion matrix:
       0    1
0  18073   76
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.893835, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_25.png
better model found
persisted
after epoch: 25,now: 2024-06-17 00:09:14.548887,epoch time: 0:24:54.912009,used: 10:22:19.399286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9710274, 'precision': 0.78451264, 'recall': 0.7256715, 'specificity': 0.7256715, 'f1': 0.7513695, 'auroc': 0.9468527, 'binary_precision': 0.5875755, 'binary_recall': 0.46263587, 'binary_specificity': 0.98870724, 'binary_f1_score': 0.51767385}
confusion matrix:
       0    1
0  41850  478
1    791  681
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.794081, 'recall': 0.66493845, 'specificity': 0.66493845, 'f1': 0.70972705, 'auroc': 0.9443884, 'binary_precision': 0.6112676, 'binary_recall': 0.33748055, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.43486974}
confusion matrix:
       0    1
0  18011  138
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.8986794, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_26.png
better model found
persisted
after epoch: 26,now: 2024-06-17 00:34:13.548319,epoch time: 0:24:58.999432,used: 10:47:18.398718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9710274, 'precision': 0.7952643, 'recall': 0.68436104, 'specificity': 0.68436104, 'f1': 0.725846, 'auroc': 0.9411758, 'binary_precision': 0.61190736, 'binary_recall': 0.37703803, 'binary_specificity': 0.991684, 'binary_f1_score': 0.4665826}
confusion matrix:
       0    1
0  41976  352
1    917  555
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.81439567, 'recall': 0.6076036, 'specificity': 0.6076036, 'f1': 0.6564938, 'auroc': 0.9440333, 'binary_precision': 0.65581393, 'binary_recall': 0.21928461, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.32867134}
confusion matrix:
       0    1
0  18075   74
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.8910274, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_27.png
early stop counter: 1
val acc:0.969348669052124, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9667625427246094 / 0.9677213430404663
after epoch: 27,now: 2024-06-17 00:58:41.264299,epoch time: 0:24:27.715980,used: 11:11:46.114698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96990865, 'precision': 0.78528666, 'recall': 0.66214335, 'specificity': 0.66214335, 'f1': 0.7052538, 'auroc': 0.9449945, 'binary_precision': 0.5934466, 'binary_recall': 0.3322011, 'binary_specificity': 0.99208564, 'binary_f1_score': 0.4259582}
confusion matrix:
       0    1
0  41993  335
1    983  489
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8155588, 'recall': 0.6129642, 'specificity': 0.6129642, 'f1': 0.6627174, 'auroc': 0.9450503, 'binary_precision': 0.6577778, 'binary_recall': 0.23017107, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.34101382}
confusion matrix:
       0    1
0  18072   77
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.98060584, 'recall': 0.5363985, 'specificity': 0.5363985, 'f1': 0.5579683, 'auroc': 0.89580166, 'binary_precision': 1.0, 'binary_recall': 0.07279693, 'binary_specificity': 1.0, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5997   0
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_28.png
early stop counter: 2
val acc:0.9695615172386169, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9667625427246094 / 0.9677213430404663
after epoch: 28,now: 2024-06-17 01:23:14.673070,epoch time: 0:24:33.408771,used: 11:36:19.523469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97127855, 'precision': 0.7954, 'recall': 0.6949825, 'specificity': 0.6949825, 'f1': 0.7339797, 'auroc': 0.94466865, 'binary_precision': 0.61145836, 'binary_recall': 0.3987772, 'binary_specificity': 0.9911879, 'binary_f1_score': 0.48273027}
confusion matrix:
       0    1
0  41955  373
1    885  587
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.80649984, 'recall': 0.6318258, 'specificity': 0.6318258, 'f1': 0.68153316, 'auroc': 0.94582725, 'binary_precision': 0.63837636, 'binary_recall': 0.2690513, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.3785558}
confusion matrix:
       0    1
0  18051   98
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.89504254, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_29.png
early stop counter: 3
val acc:0.9697743654251099, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9667625427246094 / 0.9677213430404663
after epoch: 29,now: 2024-06-17 01:48:06.750901,epoch time: 0:24:52.077831,used: 12:01:11.601300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97050226, 'precision': 0.7824856, 'recall': 0.70540035, 'specificity': 0.70540035, 'f1': 0.7372718, 'auroc': 0.94412327, 'binary_precision': 0.5849057, 'binary_recall': 0.42119566, 'binary_specificity': 0.989605, 'binary_f1_score': 0.48973143}
confusion matrix:
       0    1
0  41888  440
1    852  620
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.80570155, 'recall': 0.64246434, 'specificity': 0.64246434, 'f1': 0.6918917, 'auroc': 0.947867, 'binary_precision': 0.6360544, 'binary_recall': 0.29082426, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.3991462}
confusion matrix:
       0    1
0  18042  107
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8959285, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_30.png
better model found
persisted
after epoch: 30,now: 2024-06-17 02:12:58.156365,epoch time: 0:24:51.405464,used: 12:26:03.006764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:26:03.006764 at 2024-06-17 02:12:58.156365
persisted model performance metric: 

scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8959285, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
oracle model performance metric: 

scalar performance:
{'acc': 0.96772134, 'precision': 0.9837071, 'recall': 0.6130268, 'specificity': 0.6130268, 'f1': 0.6760936, 'auroc': 0.88592094, 'binary_precision': 1.0, 'binary_recall': 0.22605364, 'binary_specificity': 1.0, 'binary_f1_score': 0.36875}
confusion matrix:
      0   1
0  5997   0
1   202  59
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13820 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13820 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5447 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387

 Experiment start at: 2024-06-17 02:25:23.324263
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.68092257, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.62214947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6262117, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:50:48.690204,epoch time: 0:25:25.365941,used: 0:25:25.365941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.7836378, 'recall': 0.5020376, 'specificity': 0.5020376, 'f1': 0.4958008, 'auroc': 0.84311825, 'binary_precision': 0.6, 'binary_recall': 0.0041695624, 'binary_specificity': 0.9999056, 'binary_f1_score': 0.008281574}
confusion matrix:
       0  1
0  42357  4
1   1433  6
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.81912565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8107965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-17 03:15:26.325941,epoch time: 0:24:37.635737,used: 0:50:03.001678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96730596, 'precision': 0.7430377, 'recall': 0.5366696, 'specificity': 0.5366696, 'f1': 0.5577302, 'auroc': 0.8890263, 'binary_precision': 0.5165877, 'binary_recall': 0.07574704, 'binary_specificity': 0.99759215, 'binary_f1_score': 0.13212119}
confusion matrix:
       0    1
0  42259  102
1   1330  109
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.76835954, 'recall': 0.51733243, 'specificity': 0.51733243, 'f1': 0.5244953, 'auroc': 0.8741597, 'binary_precision': 0.5714286, 'binary_recall': 0.035661217, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.06713286}
confusion matrix:
       0   1
0  18049  18
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.849859, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 03:40:17.197181,epoch time: 0:24:50.871240,used: 1:14:53.872918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9674886, 'precision': 0.74640465, 'recall': 0.5702527, 'specificity': 0.5702527, 'f1': 0.6051612, 'auroc': 0.89491403, 'binary_precision': 0.521197, 'binary_recall': 0.14503817, 'binary_specificity': 0.9954673, 'binary_f1_score': 0.22692725}
confusion matrix:
       0    1
0  42167  192
1   1232  209
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7581458, 'recall': 0.53169316, 'specificity': 0.53169316, 'f1': 0.54937965, 'auroc': 0.88867074, 'binary_precision': 0.55, 'binary_recall': 0.0653789, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.116865866}
confusion matrix:
       0   1
0  18031  36
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8588495, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 04:05:06.837515,epoch time: 0:24:49.640334,used: 1:39:43.513252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.742334, 'recall': 0.5738689, 'specificity': 0.5738689, 'f1': 0.60930693, 'auroc': 0.90753126, 'binary_precision': 0.51282054, 'binary_recall': 0.15267175, 'binary_specificity': 0.995066, 'binary_f1_score': 0.23529412}
confusion matrix:
       0    1
0  42150  209
1   1221  220
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.77309895, 'recall': 0.53686607, 'specificity': 0.53686607, 'f1': 0.55804354, 'auroc': 0.8955848, 'binary_precision': 0.57954544, 'binary_recall': 0.075780086, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.13403416}
confusion matrix:
       0   1
0  18030  37
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.8603349, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-17 04:30:25.716146,epoch time: 0:25:18.878631,used: 2:05:02.391883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9675114, 'precision': 0.7450055, 'recall': 0.5920511, 'specificity': 0.5920511, 'f1': 0.63070667, 'auroc': 0.90893644, 'binary_precision': 0.5169811, 'binary_recall': 0.19014573, 'binary_specificity': 0.99395645, 'binary_f1_score': 0.27803144}
confusion matrix:
       0    1
0  42103  256
1   1167  274
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.77235603, 'recall': 0.5570873, 'specificity': 0.5570873, 'f1': 0.58864075, 'auroc': 0.9061326, 'binary_precision': 0.57664233, 'binary_recall': 0.11738484, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.19506173}
confusion matrix:
       0   1
0  18009  58
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9809902, 'recall': 0.5480769, 'specificity': 0.5480769, 'f1': 0.57803017, 'auroc': 0.8719553, 'binary_precision': 1.0, 'binary_recall': 0.09615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.1754386}
confusion matrix:
      0   1
0  5946   0
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-17 04:55:14.325268,epoch time: 0:24:48.609122,used: 2:29:51.001005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.74438584, 'recall': 0.6322456, 'specificity': 0.6322456, 'f1': 0.6700097, 'auroc': 0.9181476, 'binary_precision': 0.51305485, 'binary_recall': 0.27329624, 'binary_specificity': 0.99119496, 'binary_f1_score': 0.35662434}
confusion matrix:
       0    1
0  41989  373
1   1045  393
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7843464, 'recall': 0.5811339, 'specificity': 0.5811339, 'f1': 0.6215488, 'auroc': 0.9140029, 'binary_precision': 0.5989305, 'binary_recall': 0.16641901, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.26046512}
confusion matrix:
       0    1
0  17992   75
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.8758142, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 05:19:56.045140,epoch time: 0:24:41.719872,used: 2:54:32.720877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9674429, 'precision': 0.74236405, 'recall': 0.63768685, 'specificity': 0.63768685, 'f1': 0.67419326, 'auroc': 0.92534864, 'binary_precision': 0.5086849, 'binary_recall': 0.2847222, 'binary_specificity': 0.99065155, 'binary_f1_score': 0.36509347}
confusion matrix:
       0    1
0  41964  396
1   1030  410
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.77643657, 'recall': 0.58388424, 'specificity': 0.58388424, 'f1': 0.62428623, 'auroc': 0.9185699, 'binary_precision': 0.5829146, 'binary_recall': 0.17236255, 'binary_specificity': 0.995406, 'binary_f1_score': 0.26605502}
confusion matrix:
       0    1
0  17984   83
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.87750864, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_8.png
new oracle model saved
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9660618901252747, corresponding to test acc:                         0.9619722962379456 / 0.9634224772453308
after epoch: 8,now: 2024-06-17 05:44:25.988032,epoch time: 0:24:29.942892,used: 3:19:02.663769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96828765, 'precision': 0.75384974, 'recall': 0.6468445, 'specificity': 0.6468445, 'f1': 0.6846969, 'auroc': 0.9228669, 'binary_precision': 0.5310597, 'binary_recall': 0.30277777, 'binary_specificity': 0.99091125, 'binary_f1_score': 0.38567007}
confusion matrix:
       0    1
0  41975  385
1   1004  436
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79079056, 'recall': 0.6044376, 'specificity': 0.6044376, 'f1': 0.6499255, 'auroc': 0.92137325, 'binary_precision': 0.6101695, 'binary_recall': 0.21396731, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.31683165}
confusion matrix:
       0    1
0  17975   92
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9814575, 'recall': 0.5596154, 'specificity': 0.5596154, 'f1': 0.59708285, 'auroc': 0.8789589, 'binary_precision': 1.0, 'binary_recall': 0.11923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5946   0
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 06:09:01.311113,epoch time: 0:24:35.323081,used: 3:43:37.986850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96821916, 'precision': 0.752282, 'recall': 0.6512662, 'specificity': 0.6512662, 'f1': 0.6879114, 'auroc': 0.92677987, 'binary_precision': 0.5276146, 'binary_recall': 0.31202224, 'binary_specificity': 0.99051017, 'binary_f1_score': 0.39213976}
confusion matrix:
       0    1
0  41959  402
1    990  449
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.7919383, 'recall': 0.6109857, 'specificity': 0.6109857, 'f1': 0.6573249, 'auroc': 0.9239732, 'binary_precision': 0.612, 'binary_recall': 0.22734027, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.33152762}
confusion matrix:
       0    1
0  17970   97
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.98184764, 'recall': 0.5692308, 'specificity': 0.5692308, 'f1': 0.61237764, 'auroc': 0.8814308, 'binary_precision': 1.0, 'binary_recall': 0.13846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.24324325}
confusion matrix:
      0   1
0  5946   0
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-17 06:33:44.530330,epoch time: 0:24:43.219217,used: 4:08:21.206067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96906394, 'precision': 0.7685565, 'recall': 0.63273984, 'specificity': 0.63273984, 'f1': 0.6756313, 'auroc': 0.92854166, 'binary_precision': 0.56142855, 'binary_recall': 0.27272728, 'binary_specificity': 0.99275243, 'binary_f1_score': 0.36711818}
confusion matrix:
       0    1
0  42052  307
1   1048  393
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.8035424, 'recall': 0.5879864, 'specificity': 0.5879864, 'f1': 0.6317289, 'auroc': 0.9245784, 'binary_precision': 0.63684213, 'binary_recall': 0.17979197, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.28041714}
confusion matrix:
       0    1
0  17998   69
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8818205, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_11.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9639058709144592 / 0.9639058709144592
after epoch: 11,now: 2024-06-17 06:59:00.387110,epoch time: 0:25:15.856780,used: 4:33:37.062847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9688356, 'precision': 0.7591901, 'recall': 0.66702527, 'specificity': 0.66702527, 'f1': 0.70218474, 'auroc': 0.9337696, 'binary_precision': 0.540393, 'binary_recall': 0.3439889, 'binary_specificity': 0.99006164, 'binary_f1_score': 0.42038217}
confusion matrix:
       0    1
0  41940  421
1    944  495
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.7946628, 'recall': 0.6146727, 'specificity': 0.6146727, 'f1': 0.6616898, 'auroc': 0.9280014, 'binary_precision': 0.6171875, 'binary_recall': 0.23476969, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.34015068}
confusion matrix:
       0    1
0  17969   98
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.98153543, 'recall': 0.56153846, 'specificity': 0.56153846, 'f1': 0.6001831, 'auroc': 0.88717383, 'binary_precision': 1.0, 'binary_recall': 0.12307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.21917808}
confusion matrix:
      0   1
0  5946   0
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_12.png
better model found
persisted
after epoch: 12,now: 2024-06-17 07:23:57.593518,epoch time: 0:24:57.206408,used: 4:58:34.269255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96821916, 'precision': 0.7525964, 'recall': 0.6465669, 'specificity': 0.6465669, 'f1': 0.6841519, 'auroc': 0.93328637, 'binary_precision': 0.5285541, 'binary_recall': 0.30229327, 'binary_specificity': 0.9908406, 'binary_f1_score': 0.3846154}
confusion matrix:
       0    1
0  41973  388
1   1004  435
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.80586195, 'recall': 0.6011103, 'specificity': 0.6011103, 'f1': 0.64781684, 'auroc': 0.92882717, 'binary_precision': 0.640553, 'binary_recall': 0.20653789, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.31235957}
confusion matrix:
       0    1
0  17989   78
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.88900423, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_13.png
better model found
persisted
after epoch: 13,now: 2024-06-17 07:49:07.153741,epoch time: 0:25:09.560223,used: 5:23:43.829478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9689726, 'precision': 0.76181304, 'recall': 0.6622925, 'specificity': 0.6622925, 'f1': 0.6992703, 'auroc': 0.938298, 'binary_precision': 0.5459705, 'binary_recall': 0.33402777, 'binary_specificity': 0.99055713, 'binary_f1_score': 0.4144765}
confusion matrix:
       0    1
0  41960  400
1    959  481
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.8035631, 'recall': 0.6199563, 'specificity': 0.6199563, 'f1': 0.66859925, 'auroc': 0.9304737, 'binary_precision': 0.63461536, 'binary_recall': 0.24517088, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.35369775}
confusion matrix:
       0    1
0  17972   95
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.98153543, 'recall': 0.56153846, 'specificity': 0.56153846, 'f1': 0.6001831, 'auroc': 0.8896158, 'binary_precision': 1.0, 'binary_recall': 0.12307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.21917808}
confusion matrix:
      0   1
0  5946   0
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 08:13:47.228170,epoch time: 0:24:40.074429,used: 5:48:23.903907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.76985043, 'recall': 0.6358155, 'specificity': 0.6358155, 'f1': 0.6787298, 'auroc': 0.9344239, 'binary_precision': 0.5638149, 'binary_recall': 0.27897292, 'binary_specificity': 0.992658, 'binary_f1_score': 0.37325904}
confusion matrix:
       0    1
0  42048  311
1   1039  402
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.80320317, 'recall': 0.6025132, 'specificity': 0.6025132, 'f1': 0.64916414, 'auroc': 0.93222255, 'binary_precision': 0.6351351, 'binary_recall': 0.20950966, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.31508377}
confusion matrix:
       0    1
0  17986   81
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8898997, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_15.png
early stop counter: 1
val acc:0.9672892093658447, best validation acc: 0.9678228497505188, corresponding to test acc:                         0.9632613658905029 / 0.9639058709144592
after epoch: 15,now: 2024-06-17 08:38:40.435918,epoch time: 0:24:53.207748,used: 6:13:17.111655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.76331365, 'recall': 0.667982, 'specificity': 0.667982, 'f1': 0.7041134, 'auroc': 0.9366201, 'binary_precision': 0.54856515, 'binary_recall': 0.3456189, 'binary_specificity': 0.9903451, 'binary_f1_score': 0.42406145}
confusion matrix:
       0    1
0  41953  409
1    941  497
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.80665386, 'recall': 0.6331079, 'specificity': 0.6331079, 'f1': 0.68270516, 'auroc': 0.9333335, 'binary_precision': 0.63986015, 'binary_recall': 0.27191678, 'binary_specificity': 0.994299, 'binary_f1_score': 0.38164756}
confusion matrix:
       0    1
0  17964  103
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9809902, 'recall': 0.5480769, 'specificity': 0.5480769, 'f1': 0.57803017, 'auroc': 0.8934492, 'binary_precision': 1.0, 'binary_recall': 0.09615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.1754386}
confusion matrix:
      0   1
0  5946   0
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 09:03:30.025701,epoch time: 0:24:49.589783,used: 6:38:06.701438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9704794, 'precision': 0.78829944, 'recall': 0.65090096, 'specificity': 0.65090096, 'f1': 0.69627917, 'auroc': 0.9392351, 'binary_precision': 0.59973043, 'binary_recall': 0.30881333, 'binary_specificity': 0.9929885, 'binary_f1_score': 0.40769586}
confusion matrix:
       0    1
0  42062  297
1    996  445
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.8253108, 'recall': 0.60656, 'specificity': 0.60656, 'f1': 0.6562705, 'auroc': 0.932523, 'binary_precision': 0.67906976, 'binary_recall': 0.21693908, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.3288288}
confusion matrix:
       0    1
0  17998   69
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8907517, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_17.png
early stop counter: 1
val acc:0.9681963920593262, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9621334075927734 / 0.9639058709144592
after epoch: 17,now: 2024-06-17 09:28:38.399954,epoch time: 0:25:08.374253,used: 7:03:15.075691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.7704749, 'recall': 0.6587846, 'specificity': 0.6587846, 'f1': 0.6987704, 'auroc': 0.9401858, 'binary_precision': 0.56354916, 'binary_recall': 0.3261624, 'binary_specificity': 0.9914068, 'binary_f1_score': 0.41318682}
confusion matrix:
       0    1
0  41995  364
1    971  470
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.8256773, 'recall': 0.5948943, 'specificity': 0.5948943, 'f1': 0.6422152, 'auroc': 0.9327761, 'binary_precision': 0.6806283, 'binary_recall': 0.19316493, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.3009259}
confusion matrix:
       0    1
0  18006   61
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8924778, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_18.png
early stop counter: 2
val acc:0.9677695035934448, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9621334075927734 / 0.9639058709144592
after epoch: 18,now: 2024-06-17 09:53:55.235184,epoch time: 0:25:16.835230,used: 7:28:31.910921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.7781725, 'recall': 0.65216327, 'specificity': 0.65216327, 'f1': 0.69509417, 'auroc': 0.9408783, 'binary_precision': 0.5793548, 'binary_recall': 0.31202224, 'binary_specificity': 0.99230427, 'binary_f1_score': 0.4056007}
confusion matrix:
       0    1
0  42035  326
1    990  449
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.8180008, 'recall': 0.59841526, 'specificity': 0.59841526, 'f1': 0.6458318, 'auroc': 0.93287516, 'binary_precision': 0.66502464, 'binary_recall': 0.20059435, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.30821916}
confusion matrix:
       0    1
0  17999   68
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8919857, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_19.png
early stop counter: 3
val acc:0.9676627516746521, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9621334075927734 / 0.9639058709144592
after epoch: 19,now: 2024-06-17 10:20:20.417684,epoch time: 0:26:25.182500,used: 7:54:57.093421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.778175, 'recall': 0.6772973, 'specificity': 0.6772973, 'f1': 0.7155442, 'auroc': 0.93825233, 'binary_precision': 0.57772875, 'binary_recall': 0.36363637, 'binary_specificity': 0.9909582, 'binary_f1_score': 0.4463373}
confusion matrix:
       0    1
0  41976  383
1    917  524
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.8208639, 'recall': 0.61668444, 'specificity': 0.61668444, 'f1': 0.6673441, 'auroc': 0.9347207, 'binary_precision': 0.66945606, 'binary_recall': 0.23774146, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.35087717}
confusion matrix:
       0    1
0  17988   79
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.89151657, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_20.png
better model found
persisted
after epoch: 20,now: 2024-06-17 10:46:22.040517,epoch time: 0:26:01.622833,used: 8:20:58.716254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9702283, 'precision': 0.7728864, 'recall': 0.6993718, 'specificity': 0.6993718, 'f1': 0.72985995, 'auroc': 0.9402164, 'binary_precision': 0.5656759, 'binary_recall': 0.4094379, 'binary_specificity': 0.9893057, 'binary_f1_score': 0.47504026}
confusion matrix:
       0    1
0  41906  453
1    851  590
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.8152498, 'recall': 0.64859897, 'specificity': 0.64859897, 'f1': 0.6994258, 'auroc': 0.93748075, 'binary_precision': 0.6559486, 'binary_recall': 0.30312034, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.41463417}
confusion matrix:
       0    1
0  17960  107
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.89399433, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_21.png
better model found
persisted
after epoch: 21,now: 2024-06-17 11:10:54.705397,epoch time: 0:24:32.664880,used: 8:45:31.381134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97091323, 'precision': 0.7890829, 'recall': 0.6707911, 'specificity': 0.6707911, 'f1': 0.7133927, 'auroc': 0.94090915, 'binary_precision': 0.6, 'binary_recall': 0.34951457, 'binary_specificity': 0.99206764, 'binary_f1_score': 0.44171777}
confusion matrix:
       0    1
0  42022  336
1    938  504
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.83072305, 'recall': 0.6336614, 'specificity': 0.6336614, 'f1': 0.68704766, 'auroc': 0.93590635, 'binary_precision': 0.6879699, 'binary_recall': 0.27191678, 'binary_specificity': 0.995406, 'binary_f1_score': 0.38977635}
confusion matrix:
       0    1
0  17984   83
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8935789, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_22.png
better model found
persisted
after epoch: 22,now: 2024-06-17 11:36:00.831392,epoch time: 0:25:06.125995,used: 9:10:37.507129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9703881, 'precision': 0.78033406, 'recall': 0.67230505, 'specificity': 0.67230505, 'f1': 0.7122665, 'auroc': 0.9447384, 'binary_precision': 0.5823799, 'binary_recall': 0.35322693, 'binary_specificity': 0.9913832, 'binary_f1_score': 0.4397408}
confusion matrix:
       0    1
0  41994  365
1    932  509
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.8207631, 'recall': 0.6123098, 'specificity': 0.6123098, 'f1': 0.66240907, 'auroc': 0.93578315, 'binary_precision': 0.6695652, 'binary_recall': 0.22882615, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.34108526}
confusion matrix:
       0    1
0  17991   76
1    519  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.8913925, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_23.png
early stop counter: 1
val acc:0.9682497382164001, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 23,now: 2024-06-17 12:00:20.164754,epoch time: 0:24:19.333362,used: 9:34:56.840491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97100455, 'precision': 0.79466677, 'recall': 0.65434253, 'specificity': 0.65434253, 'f1': 0.70074666, 'auroc': 0.9428246, 'binary_precision': 0.6121622, 'binary_recall': 0.3154596, 'binary_specificity': 0.9932254, 'binary_f1_score': 0.4163603}
confusion matrix:
       0    1
0  42077  287
1    983  453
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.8321588, 'recall': 0.60229605, 'specificity': 0.60229605, 'f1': 0.6518727, 'auroc': 0.9363071, 'binary_precision': 0.6930693, 'binary_recall': 0.20802377, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.32}
confusion matrix:
       0    1
0  18005   62
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8906659, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_24.png
early stop counter: 2
val acc:0.9682497382164001, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 24,now: 2024-06-17 12:25:15.093583,epoch time: 0:24:54.928829,used: 9:59:51.769320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9710959, 'precision': 0.7886948, 'recall': 0.6791549, 'specificity': 0.6791549, 'f1': 0.71996737, 'auroc': 0.9420663, 'binary_precision': 0.5986394, 'binary_recall': 0.36666667, 'binary_specificity': 0.9916431, 'binary_f1_score': 0.45478034}
confusion matrix:
       0    1
0  42006  354
1    912  528
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.8197277, 'recall': 0.6239478, 'specificity': 0.6239478, 'f1': 0.67514634, 'auroc': 0.9371406, 'binary_precision': 0.6666667, 'binary_recall': 0.25260028, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.36637932}
confusion matrix:
       0    1
0  17982   85
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.89146733, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_25.png
early stop counter: 3
val acc:0.9686232805252075, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 25,now: 2024-06-17 12:50:32.476192,epoch time: 0:25:17.382609,used: 10:25:09.151929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9704794, 'precision': 0.7779548, 'recall': 0.6860007, 'specificity': 0.6860007, 'f1': 0.72202384, 'auroc': 0.9432727, 'binary_precision': 0.57668066, 'binary_recall': 0.38151494, 'binary_specificity': 0.9904865, 'binary_f1_score': 0.4592221}
confusion matrix:
       0    1
0  41958  403
1    890  549
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.82142186, 'recall': 0.63855755, 'specificity': 0.63855755, 'f1': 0.69063795, 'auroc': 0.9377698, 'binary_precision': 0.6690141, 'binary_recall': 0.28231797, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.39707416}
confusion matrix:
       0    1
0  17973   94
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.89349806, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_26.png
early stop counter: 4
val acc:0.9692102670669556, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 26,now: 2024-06-17 13:15:31.250192,epoch time: 0:24:58.774000,used: 10:50:07.925929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9708676, 'precision': 0.7845672, 'recall': 0.68083084, 'specificity': 0.68083084, 'f1': 0.7201001, 'auroc': 0.94582534, 'binary_precision': 0.5902547, 'binary_recall': 0.3703961, 'binary_specificity': 0.99126554, 'binary_f1_score': 0.45516655}
confusion matrix:
       0    1
0  41991  370
1    906  533
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.832237, 'recall': 0.6198222, 'specificity': 0.6198222, 'f1': 0.67226243, 'auroc': 0.93739605, 'binary_precision': 0.6919831, 'binary_recall': 0.24368499, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.36043954}
confusion matrix:
       0    1
0  17994   73
1    509  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.8914155, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_27.png
early stop counter: 5
val acc:0.9689434170722961, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 27,now: 2024-06-17 13:40:37.838081,epoch time: 0:25:06.587889,used: 11:15:14.513818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.7841455, 'recall': 0.6758221, 'specificity': 0.6758221, 'f1': 0.7160882, 'auroc': 0.9453239, 'binary_precision': 0.5897727, 'binary_recall': 0.36016655, 'binary_specificity': 0.9914776, 'binary_f1_score': 0.447221}
confusion matrix:
       0    1
0  41998  361
1    922  519
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.82252586, 'recall': 0.6342106, 'specificity': 0.6342106, 'f1': 0.6863734, 'auroc': 0.93862987, 'binary_precision': 0.67153287, 'binary_recall': 0.27340266, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.38859555}
confusion matrix:
       0    1
0  17977   90
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8963922, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_28.png
early stop counter: 6
val acc:0.9691035151481628, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 28,now: 2024-06-17 14:06:04.272612,epoch time: 0:25:26.434531,used: 11:40:40.948349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97171235, 'precision': 0.79718566, 'recall': 0.68126756, 'specificity': 0.68126756, 'f1': 0.7239734, 'auroc': 0.9444674, 'binary_precision': 0.61547345, 'binary_recall': 0.3703961, 'binary_specificity': 0.992139, 'binary_f1_score': 0.46247292}
confusion matrix:
       0    1
0  42028  333
1    906  533
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.82371706, 'recall': 0.62840545, 'specificity': 0.62840545, 'f1': 0.6804743, 'auroc': 0.93790936, 'binary_precision': 0.6743295, 'binary_recall': 0.2615156, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.37687364}
confusion matrix:
       0    1
0  17982   85
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.89299935, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_29.png
early stop counter: 7
val acc:0.9689434170722961, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.961005449295044 / 0.9639058709144592
after epoch: 29,now: 2024-06-17 14:29:22.948121,epoch time: 0:23:18.675509,used: 12:03:59.623858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97152966, 'precision': 0.7917868, 'recall': 0.69011253, 'specificity': 0.69011253, 'f1': 0.7292712, 'auroc': 0.9479809, 'binary_precision': 0.6040993, 'binary_recall': 0.3888889, 'binary_specificity': 0.99133617, 'binary_f1_score': 0.4731728}
confusion matrix:
       0    1
0  41993  367
1    880  560
---- Validation: 
scalar performance:
{'acc': 0.96963716, 'precision': 0.8207167, 'recall': 0.65165377, 'specificity': 0.65165377, 'f1': 0.7033719, 'auroc': 0.93878317, 'binary_precision': 0.6666667, 'binary_recall': 0.30906388, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.42233503}
confusion matrix:
       0    1
0  17963  104
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.8967808, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_30.png
better model found
persisted
after epoch: 30,now: 2024-06-17 14:55:28.706598,epoch time: 0:26:05.758477,used: 12:30:05.382335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:30:05.382335 at 2024-06-17 14:55:28.706598
persisted model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.8967808, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
oracle model performance metric: 

scalar performance:
{'acc': 0.9639059, 'precision': 0.98184764, 'recall': 0.5692308, 'specificity': 0.5692308, 'f1': 0.61237764, 'auroc': 0.8814308, 'binary_precision': 1.0, 'binary_recall': 0.13846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.24324325}
confusion matrix:
      0   1
0  5946   0
1   224  36
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 568414 GiB | 568413 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   27643 K  |   27642 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18382 K  |   18381 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   27643 K  |   27642 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18382 K  |   18381 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   15748 K  |   15748 K  |
|       from large pool |       5    |      11    |    4128 K  |    4128 K  |
|       from small pool |      30    |     448    |   11620 K  |   11620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568414 GiB | 568414 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27643 K  |   27643 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18382 K  |   18382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27643 K  |   27643 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18382 K  |   18382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15749 K  |   15749 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11620 K  |   11620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568414 GiB | 568414 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27643 K  |   27643 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18382 K  |   18382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27643 K  |   27643 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18382 K  |   18382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15749 K  |   15749 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11620 K  |   11620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387

 Experiment start at: 2024-06-17 15:07:14.416077
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.70747614, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.66573095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6610619, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 15:32:17.389671,epoch time: 0:25:02.973594,used: 0:25:02.973594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96561646, 'precision': 0.7986702, 'recall': 0.50388813, 'specificity': 0.50388813, 'f1': 0.49909443, 'auroc': 0.8466563, 'binary_precision': 0.6315789, 'binary_recall': 0.00794176, 'binary_specificity': 0.9998345, 'binary_f1_score': 0.015686274}
confusion matrix:
       0   1
0  42282   7
1   1499  12
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.839502, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.81458825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-17 15:57:02.781151,epoch time: 0:24:45.391480,used: 0:49:48.365074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654338, 'precision': 0.72857225, 'recall': 0.5235767, 'specificity': 0.5235767, 'f1': 0.535716, 'auroc': 0.8865225, 'binary_precision': 0.49006623, 'binary_recall': 0.04897419, 'binary_specificity': 0.9981792, 'binary_f1_score': 0.08904933}
confusion matrix:
       0   1
0  42212  77
1   1437  74
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74513626, 'recall': 0.5096641, 'specificity': 0.5096641, 'f1': 0.5110611, 'auroc': 0.87607306, 'binary_precision': 0.5217391, 'binary_recall': 0.019933555, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.038399998}
confusion matrix:
       0   1
0  18160  11
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.84997594, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 16:20:35.661676,epoch time: 0:23:32.880525,used: 1:13:21.245599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.75965476, 'recall': 0.5942848, 'specificity': 0.5942848, 'f1': 0.63486993, 'auroc': 0.9030535, 'binary_precision': 0.547486, 'binary_recall': 0.19431593, 'binary_specificity': 0.9942536, 'binary_f1_score': 0.28682926}
confusion matrix:
       0    1
0  42044  243
1   1219  294
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.76251787, 'recall': 0.55416197, 'specificity': 0.55416197, 'f1': 0.58467174, 'auroc': 0.89502764, 'binary_precision': 0.553719, 'binary_recall': 0.11129568, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.18533885}
confusion matrix:
       0   1
0  18117  54
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.8671781, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 16:44:54.372559,epoch time: 0:24:18.710883,used: 1:37:39.956482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663014, 'precision': 0.7545525, 'recall': 0.58392256, 'specificity': 0.58392256, 'f1': 0.62237847, 'auroc': 0.9115281, 'binary_precision': 0.5379877, 'binary_recall': 0.1731659, 'binary_specificity': 0.9946792, 'binary_f1_score': 0.26200002}
confusion matrix:
       0    1
0  42062  225
1   1251  262
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7557124, 'recall': 0.53713286, 'specificity': 0.53713286, 'f1': 0.55888647, 'auroc': 0.89724135, 'binary_precision': 0.5411765, 'binary_recall': 0.07641196, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.13391557}
confusion matrix:
       0   1
0  18132  39
1    556  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.8670632, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_5.png
early stop counter: 1
val acc:0.9683055281639099, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9671421647071838 / 0.9671421647071838
after epoch: 5,now: 2024-06-17 17:08:49.899860,epoch time: 0:23:55.527301,used: 2:01:35.483783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9659817, 'precision': 0.74457836, 'recall': 0.62358767, 'specificity': 0.62358767, 'f1': 0.6622062, 'auroc': 0.913442, 'binary_precision': 0.5153129, 'binary_recall': 0.2557832, 'binary_specificity': 0.99139214, 'binary_f1_score': 0.34187278}
confusion matrix:
       0    1
0  41923  364
1   1126  387
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7522695, 'recall': 0.56612515, 'specificity': 0.56612515, 'f1': 0.60041994, 'auroc': 0.90887475, 'binary_precision': 0.53246754, 'binary_recall': 0.13621262, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.2169312}
confusion matrix:
       0   1
0  18099  72
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9838631, 'recall': 0.58677685, 'specificity': 0.58677685, 'f1': 0.6396866, 'auroc': 0.8761007, 'binary_precision': 1.0, 'binary_recall': 0.17355372, 'binary_specificity': 1.0, 'binary_f1_score': 0.29577464}
confusion matrix:
      0   1
0  5997   0
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_6.png
new oracle model saved
early stop counter: 2
val acc:0.9684653282165527, best validation acc: 0.9686251282691956, corresponding to test acc:                         0.9671421647071838 / 0.9679436087608337
after epoch: 6,now: 2024-06-17 17:33:14.105299,epoch time: 0:24:24.205439,used: 2:25:59.689222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.7739526, 'recall': 0.60045516, 'specificity': 0.60045516, 'f1': 0.6435406, 'auroc': 0.92130244, 'binary_precision': 0.57564574, 'binary_recall': 0.20634921, 'binary_specificity': 0.9945611, 'binary_f1_score': 0.30379748}
confusion matrix:
       0    1
0  42058  230
1   1200  312
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.77069783, 'recall': 0.5526384, 'specificity': 0.5526384, 'f1': 0.5828266, 'auroc': 0.9100811, 'binary_precision': 0.5701754, 'binary_recall': 0.10797342, 'binary_specificity': 0.99730337, 'binary_f1_score': 0.18156426}
confusion matrix:
       0   1
0  18122  49
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.87490463, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 17:57:09.477398,epoch time: 0:23:55.372099,used: 2:49:55.061321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9665753, 'precision': 0.75340146, 'recall': 0.6246057, 'specificity': 0.6246057, 'f1': 0.6649301, 'auroc': 0.92114764, 'binary_precision': 0.53287673, 'binary_recall': 0.25727513, 'binary_specificity': 0.99193627, 'binary_f1_score': 0.3470116}
confusion matrix:
       0    1
0  41947  341
1   1123  389
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7690034, 'recall': 0.56233, 'specificity': 0.56233, 'f1': 0.596403, 'auroc': 0.91478467, 'binary_precision': 0.5661765, 'binary_recall': 0.12790698, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.20867209}
confusion matrix:
       0   1
0  18112  59
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.9698789, 'recall': 0.5742968, 'specificity': 0.5742968, 'f1': 0.62054795, 'auroc': 0.8842093, 'binary_precision': 0.972973, 'binary_recall': 0.14876033, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  5996   1
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_8.png
better model found
persisted
after epoch: 8,now: 2024-06-17 18:20:16.759961,epoch time: 0:23:07.282563,used: 3:13:02.343884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672375, 'precision': 0.76219153, 'recall': 0.6388957, 'specificity': 0.6388957, 'f1': 0.6797675, 'auroc': 0.9264293, 'binary_precision': 0.54949236, 'binary_recall': 0.2861864, 'binary_specificity': 0.991605, 'binary_f1_score': 0.37635812}
confusion matrix:
       0    1
0  41932  355
1   1080  433
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7589698, 'recall': 0.5726871, 'specificity': 0.5726871, 'f1': 0.60936016, 'auroc': 0.918393, 'binary_precision': 0.54545456, 'binary_recall': 0.14950167, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.23468058}
confusion matrix:
       0   1
0  18096  75
1    512  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.983629, 'recall': 0.5805785, 'specificity': 0.5805785, 'f1': 0.63046837, 'auroc': 0.88166845, 'binary_precision': 1.0, 'binary_recall': 0.16115703, 'binary_specificity': 1.0, 'binary_f1_score': 0.27758008}
confusion matrix:
      0   1
0  5997   0
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_9.png
early stop counter: 1
val acc:0.968731701374054, best validation acc: 0.9688915014266968, corresponding to test acc:                         0.9668216109275818 / 0.9679436087608337
after epoch: 9,now: 2024-06-17 18:48:05.741987,epoch time: 0:27:48.982026,used: 3:40:51.325910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.76236767, 'recall': 0.6557722, 'specificity': 0.6557722, 'f1': 0.694143, 'auroc': 0.9293244, 'binary_precision': 0.5486425, 'binary_recall': 0.32097948, 'binary_specificity': 0.99056494, 'binary_f1_score': 0.4050104}
confusion matrix:
       0    1
0  41890  399
1   1026  485
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.759976, 'recall': 0.59046423, 'specificity': 0.59046423, 'f1': 0.63085127, 'auroc': 0.9199059, 'binary_precision': 0.5463415, 'binary_recall': 0.18604651, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.27757123}
confusion matrix:
       0    1
0  18078   93
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.97322536, 'recall': 0.5928918, 'specificity': 0.5928918, 'f1': 0.6481286, 'auroc': 0.88479125, 'binary_precision': 0.9782609, 'binary_recall': 0.18595041, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3125}
confusion matrix:
      0   1
0  5996   1
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-17 19:15:54.161530,epoch time: 0:27:48.419543,used: 4:08:39.745453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9674429, 'precision': 0.7642257, 'recall': 0.645375, 'specificity': 0.645375, 'f1': 0.685892, 'auroc': 0.9318264, 'binary_precision': 0.5531136, 'binary_recall': 0.29940516, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.38850772}
confusion matrix:
       0    1
0  41921  366
1   1060  453
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76594496, 'recall': 0.5889682, 'specificity': 0.5889682, 'f1': 0.6297939, 'auroc': 0.9236702, 'binary_precision': 0.55837566, 'binary_recall': 0.18272425, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.2753442}
confusion matrix:
       0    1
0  18084   87
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.957074, 'recall': 0.57421345, 'specificity': 0.57421345, 'f1': 0.6200454, 'auroc': 0.8867371, 'binary_precision': 0.94736844, 'binary_recall': 0.14876033, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.25714284}
confusion matrix:
      0   1
0  5995   2
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_11.png
better model found
persisted
after epoch: 11,now: 2024-06-17 19:43:02.428589,epoch time: 0:27:08.267059,used: 4:35:48.012512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96778536, 'precision': 0.77130985, 'recall': 0.63304245, 'specificity': 0.63304245, 'f1': 0.67635757, 'auroc': 0.9335313, 'binary_precision': 0.56808805, 'binary_recall': 0.27350992, 'binary_specificity': 0.99257505, 'binary_f1_score': 0.36924452}
confusion matrix:
       0    1
0  41976  314
1   1097  413
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.78229266, 'recall': 0.5649318, 'specificity': 0.5649318, 'f1': 0.6007104, 'auroc': 0.9219147, 'binary_precision': 0.5925926, 'binary_recall': 0.13289036, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.21709633}
confusion matrix:
       0   1
0  18116  55
1    522  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9825394, 'recall': 0.5516529, 'specificity': 0.5516529, 'f1': 0.5847475, 'auroc': 0.8845325, 'binary_precision': 1.0, 'binary_recall': 0.10330579, 'binary_specificity': 1.0, 'binary_f1_score': 0.18726592}
confusion matrix:
      0   1
0  5997   0
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_12.png
better model found
persisted
after epoch: 12,now: 2024-06-17 20:09:31.186856,epoch time: 0:26:28.758267,used: 5:02:16.770779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96780825, 'precision': 0.7665501, 'recall': 0.660957, 'specificity': 0.660957, 'f1': 0.69943565, 'auroc': 0.9365337, 'binary_precision': 0.5566667, 'binary_recall': 0.3313492, 'binary_specificity': 0.9905647, 'binary_f1_score': 0.4154229}
confusion matrix:
       0    1
0  41889  399
1   1011  501
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7729373, 'recall': 0.6036707, 'specificity': 0.6036707, 'f1': 0.64720225, 'auroc': 0.9268955, 'binary_precision': 0.5714286, 'binary_recall': 0.21262458, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.30992734}
confusion matrix:
       0    1
0  18075   96
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.9598923, 'recall': 0.58247787, 'specificity': 0.58247787, 'f1': 0.6324803, 'auroc': 0.89015615, 'binary_precision': 0.95238096, 'binary_recall': 0.16528925, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28169015}
confusion matrix:
      0   1
0  5995   2
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_13.png
better model found
persisted
after epoch: 13,now: 2024-06-17 20:36:24.070702,epoch time: 0:26:52.883846,used: 5:29:09.654625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96828765, 'precision': 0.77005965, 'recall': 0.67481196, 'specificity': 0.67481196, 'f1': 0.7112353, 'auroc': 0.937284, 'binary_precision': 0.5626943, 'binary_recall': 0.35960266, 'binary_specificity': 0.9900213, 'binary_f1_score': 0.43878788}
confusion matrix:
       0    1
0  41868  422
1    967  543
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.77361846, 'recall': 0.6053043, 'specificity': 0.6053043, 'f1': 0.649067, 'auroc': 0.92780983, 'binary_precision': 0.5726872, 'binary_recall': 0.21594684, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.31363085}
confusion matrix:
       0    1
0  18074   97
1    472  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.97150934, 'recall': 0.58256125, 'specificity': 0.58256125, 'f1': 0.6330197, 'auroc': 0.88738656, 'binary_precision': 0.9756098, 'binary_recall': 0.16528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28268552}
confusion matrix:
      0   1
0  5996   1
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 20:59:55.833346,epoch time: 0:23:31.762644,used: 5:52:41.417269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9680137, 'precision': 0.7705996, 'recall': 0.6561859, 'specificity': 0.6561859, 'f1': 0.6965848, 'auroc': 0.9373168, 'binary_precision': 0.5651163, 'binary_recall': 0.32121614, 'binary_specificity': 0.9911557, 'binary_f1_score': 0.40960813}
confusion matrix:
       0    1
0  41913  374
1   1027  486
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.77876985, 'recall': 0.5932586, 'specificity': 0.5932586, 'f1': 0.6361878, 'auroc': 0.927889, 'binary_precision': 0.5837563, 'binary_recall': 0.1910299, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.28785983}
confusion matrix:
       0    1
0  18089   82
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8882389, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_15.png
early stop counter: 1
val acc:0.9696905016899109, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9674627184867859 / 0.9682641625404358
after epoch: 15,now: 2024-06-17 21:21:46.372093,epoch time: 0:21:50.538747,used: 6:14:31.956016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.7799058, 'recall': 0.68590003, 'specificity': 0.68590003, 'f1': 0.7224991, 'auroc': 0.9412824, 'binary_precision': 0.58165324, 'binary_recall': 0.38161376, 'binary_specificity': 0.99018633, 'binary_f1_score': 0.46086264}
confusion matrix:
       0    1
0  41873  415
1    935  577
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.78200316, 'recall': 0.59007394, 'specificity': 0.59007394, 'f1': 0.6327797, 'auroc': 0.9281588, 'binary_precision': 0.59042555, 'binary_recall': 0.18438539, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.28101268}
confusion matrix:
       0    1
0  18094   77
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.98269475, 'recall': 0.5557851, 'specificity': 0.5557851, 'f1': 0.5915668, 'auroc': 0.88704646, 'binary_precision': 1.0, 'binary_recall': 0.11157025, 'binary_specificity': 1.0, 'binary_f1_score': 0.2007435}
confusion matrix:
      0   1
0  5997   0
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 21:45:28.314375,epoch time: 0:23:41.942282,used: 6:38:13.898298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96821916, 'precision': 0.76892745, 'recall': 0.6796639, 'specificity': 0.6796639, 'f1': 0.7145296, 'auroc': 0.9412371, 'binary_precision': 0.5601202, 'binary_recall': 0.36970899, 'binary_specificity': 0.9896188, 'binary_f1_score': 0.4454183}
confusion matrix:
       0    1
0  41849  439
1    953  559
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7674439, 'recall': 0.60516673, 'specificity': 0.60516673, 'f1': 0.6480577, 'auroc': 0.9297662, 'binary_precision': 0.5603448, 'binary_recall': 0.21594684, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.3117506}
confusion matrix:
       0    1
0  18069  102
1    472  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.97150934, 'recall': 0.58256125, 'specificity': 0.58256125, 'f1': 0.6330197, 'auroc': 0.8871166, 'binary_precision': 0.9756098, 'binary_recall': 0.16528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28268552}
confusion matrix:
      0   1
0  5996   1
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_17.png
early stop counter: 1
val acc:0.9694241881370544, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9655393362045288 / 0.9682641625404358
after epoch: 17,now: 2024-06-17 22:08:53.207824,epoch time: 0:23:24.893449,used: 7:01:38.791747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.7882008, 'recall': 0.65742624, 'specificity': 0.65742624, 'f1': 0.7018866, 'auroc': 0.94039285, 'binary_precision': 0.600246, 'binary_recall': 0.32253802, 'binary_specificity': 0.9923144, 'binary_f1_score': 0.41960448}
confusion matrix:
       0    1
0  41962  325
1   1025  488
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7718626, 'recall': 0.592318, 'specificity': 0.592318, 'f1': 0.63433385, 'auroc': 0.92948335, 'binary_precision': 0.57, 'binary_recall': 0.18936877, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.28428927}
confusion matrix:
       0    1
0  18085   86
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.8859618, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_18.png
early stop counter: 2
val acc:0.9694241881370544, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9655393362045288 / 0.9682641625404358
after epoch: 18,now: 2024-06-17 22:33:57.627787,epoch time: 0:25:04.419963,used: 7:26:43.211710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96924657, 'precision': 0.7800765, 'recall': 0.68796456, 'specificity': 0.68796456, 'f1': 0.7240782, 'auroc': 0.941947, 'binary_precision': 0.58183634, 'binary_recall': 0.3858372, 'binary_specificity': 0.990092, 'binary_f1_score': 0.46398726}
confusion matrix:
       0    1
0  41870  419
1    928  583
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7718315, 'recall': 0.61416537, 'specificity': 0.61416537, 'f1': 0.6581431, 'auroc': 0.93186104, 'binary_precision': 0.5685484, 'binary_recall': 0.23421927, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.33176473}
confusion matrix:
       0    1
0  18064  107
1    461  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.8907069, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_19.png
early stop counter: 3
val acc:0.9697437882423401, best validation acc: 0.9697437882423401, corresponding to test acc:                         0.9655393362045288 / 0.9682641625404358
after epoch: 19,now: 2024-06-17 22:57:58.772582,epoch time: 0:24:01.144795,used: 7:50:44.356505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9697945, 'precision': 0.7926973, 'recall': 0.6715515, 'specificity': 0.6715515, 'f1': 0.7148788, 'auroc': 0.9429304, 'binary_precision': 0.6082474, 'binary_recall': 0.35119048, 'binary_specificity': 0.9919126, 'binary_f1_score': 0.44528303}
confusion matrix:
       0    1
0  41946  342
1    981  531
---- Validation: 
scalar performance:
--- Logging error ---
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_20.png
better model found
persisted
after epoch: 20,now: 2024-06-17 23:23:47.717198,epoch time: 0:25:48.944616,used: 8:16:33.301121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9683333, 'precision': 0.7700672, 'recall': 0.67983365, 'specificity': 0.67983365, 'f1': 0.71500397, 'auroc': 0.94295824, 'binary_precision': 0.56237423, 'binary_recall': 0.36995366, 'binary_specificity': 0.9897136, 'binary_f1_score': 0.4463074}
confusion matrix:
       0    1
0  41854  435
1    952  559
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.7651766, 'recall': 0.60915446, 'specificity': 0.60915446, 'f1': 0.65192974, 'auroc': 0.9332466, 'binary_precision': 0.5555556, 'binary_recall': 0.22425249, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.31952664}
confusion matrix:
       0    1
0  18063  108
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9833951, 'recall': 0.57438016, 'specificity': 0.57438016, 'f1': 0.6210538, 'auroc': 0.88984543, 'binary_precision': 1.0, 'binary_recall': 0.14876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.25899282}
confusion matrix:
      0   1
0  5997   0
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_21.png
early stop counter: 1
val acc:0.9693709015846252, best validation acc: 0.9698503017425537, corresponding to test acc:                         0.9656996130943298 / 0.9682641625404358
after epoch: 21,now: 2024-06-17 23:47:54.941986,epoch time: 0:24:07.224788,used: 8:40:40.525909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.7913251, 'recall': 0.68363845, 'specificity': 0.68363845, 'f1': 0.72413844, 'auroc': 0.94265056, 'binary_precision': 0.6046759, 'binary_recall': 0.37607402, 'binary_specificity': 0.99120295, 'binary_f1_score': 0.4637327}
confusion matrix:
       0    1
0  41915  372
1    944  569
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.7919946, 'recall': 0.60405594, 'specificity': 0.60405594, 'f1': 0.65006757, 'auroc': 0.93048024, 'binary_precision': 0.60952383, 'binary_recall': 0.21262458, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.31527093}
confusion matrix:
       0    1
0  18089   82
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.885689, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_22.png
better model found
persisted
after epoch: 22,now: 2024-06-18 00:13:02.970858,epoch time: 0:25:08.028872,used: 9:05:48.554781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9704794, 'precision': 0.7935792, 'recall': 0.6998427, 'specificity': 0.6998427, 'f1': 0.7369677, 'auroc': 0.944172, 'binary_precision': 0.608055, 'binary_recall': 0.40912095, 'binary_specificity': 0.99056447, 'binary_f1_score': 0.48913473}
confusion matrix:
       0    1
0  41888  399
1    894  619
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.77791464, 'recall': 0.6361779, 'specificity': 0.6361779, 'f1': 0.6807564, 'auroc': 0.9341538, 'binary_precision': 0.57931036, 'binary_recall': 0.27906978, 'binary_specificity': 0.993286, 'binary_f1_score': 0.37668163}
confusion matrix:
       0    1
0  18049  122
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.97257507, 'recall': 0.5887596, 'specificity': 0.5887596, 'f1': 0.64214754, 'auroc': 0.8912189, 'binary_precision': 0.97727275, 'binary_recall': 0.17768595, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30069926}
confusion matrix:
      0   1
0  5996   1
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328387_23.png
[Tue Jun 18 00:38:33 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/2.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing central directory for archive dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328387: file write failed
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
