Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 16:22:09 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200

 Experiment start at: 2024-06-10 16:28:57.321592
before training, model accuracy: 0.444837749004364
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.995742, 'precision': 0.9937793, 'recall': 0.9812163, 'specificity': 0.9812163, 'f1': 0.987396, 'auroc': 0.9985312, 'binary_precision': 0.99137527, 'binary_recall': 0.9633069, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.9771396}
confusion matrix:
       0     1
0  42284    37
1    162  4253
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7204731, 'recall': 0.55003333, 'specificity': 0.55003333, 'f1': 0.57650495, 'auroc': 0.87156, 'binary_precision': 0.471831, 'binary_recall': 0.10419907, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.17070064}
confusion matrix:
       0   1
0  18074  75
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949852, 'precision': 0.9954406, 'recall': 0.97995424, 'specificity': 0.97995424, 'f1': 0.9875326, 'auroc': 0.99761945, 'binary_precision': 0.9960265, 'binary_recall': 0.9604087, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.97789335}
confusion matrix:
      0    1
0  5994    3
1    31  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 16:57:28.198710,epoch time: 0:28:30.877118,used: 0:28:30.877118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9972398, 'precision': 0.9941677, 'recall': 0.989651, 'specificity': 0.989651, 'f1': 0.9918963, 'auroc': 0.99894005, 'binary_precision': 0.990389, 'binary_recall': 0.98029447, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.98531586}
confusion matrix:
       0     1
0  42279    42
1     87  4328
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7240211, 'recall': 0.5508385, 'specificity': 0.5508385, 'f1': 0.57780606, 'auroc': 0.8402126, 'binary_precision': 0.47887325, 'binary_recall': 0.10575428, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.17324843}
confusion matrix:
       0   1
0  18075  74
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.992416, 'recall': 0.98583966, 'specificity': 0.98583966, 'f1': 0.9890981, 'auroc': 0.9982512, 'binary_precision': 0.98832685, 'binary_recall': 0.97318006, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.98069495}
confusion matrix:
      0    1
0  5988    9
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 17:26:14.757089,epoch time: 0:28:46.558379,used: 0:57:17.435497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99711144, 'precision': 0.98795485, 'recall': 0.9953627, 'specificity': 0.9953627, 'f1': 0.9916235, 'auroc': 0.99968636, 'binary_precision': 0.9766199, 'binary_recall': 0.9932065, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.9848434}
confusion matrix:
       0     1
0  42215   105
1     30  4386
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.76037574, 'recall': 0.6961164, 'specificity': 0.6961164, 'f1': 0.7232536, 'auroc': 0.8849376, 'binary_precision': 0.5416667, 'binary_recall': 0.4043546, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.46304542}
confusion matrix:
       0    1
0  17929  220
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954277, 'precision': 0.9880179, 'recall': 0.9896426, 'specificity': 0.9896426, 'f1': 0.9888284, 'auroc': 0.99887764, 'binary_precision': 0.9783715, 'binary_recall': 0.98212004, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.9802422}
confusion matrix:
      0    1
0  5980   17
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_3.png
better model found
persisted
after epoch: 3,now: 2024-06-10 17:58:45.247799,epoch time: 0:32:30.490710,used: 1:29:47.926207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.99710405, 'recall': 0.99387336, 'specificity': 0.99387336, 'f1': 0.9954821, 'auroc': 0.99958354, 'binary_precision': 0.9954359, 'binary_recall': 0.9882193, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.9918145}
confusion matrix:
       0     1
0  42302    20
1     52  4362
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74628794, 'recall': 0.55041903, 'specificity': 0.55041903, 'f1': 0.57824826, 'auroc': 0.8941997, 'binary_precision': 0.5234375, 'binary_recall': 0.10419907, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.17380026}
confusion matrix:
       0   1
0  18088  61
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9967661, 'recall': 0.994558, 'specificity': 0.994558, 'f1': 0.9956587, 'auroc': 0.9998814, 'binary_precision': 0.99486524, 'binary_recall': 0.98978287, 'binary_specificity': 0.999333, 'binary_f1_score': 0.99231756}
confusion matrix:
      0    1
0  5993    4
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_4.png
new oracle model saved
early stop counter: 1
val acc:0.9661026000976562, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9954277276992798 / 0.9982300996780396
after epoch: 4,now: 2024-06-10 18:25:17.453522,epoch time: 0:26:32.205723,used: 1:56:20.131930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.99789524, 'recall': 0.9949615, 'specificity': 0.9949615, 'f1': 0.9964229, 'auroc': 0.999756, 'binary_precision': 0.99680585, 'binary_recall': 0.99025387, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.993519}
confusion matrix:
       0     1
0  42310    14
1     43  4369
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.81289214, 'recall': 0.572495, 'specificity': 0.572495, 'f1': 0.6124325, 'auroc': 0.90689135, 'binary_precision': 0.6551724, 'binary_recall': 0.14774494, 'binary_specificity': 0.997245, 'binary_f1_score': 0.24111673}
confusion matrix:
       0   1
0  18099  50
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9984376, 'recall': 0.9928924, 'specificity': 0.9928924, 'f1': 0.9956441, 'auroc': 0.9993855, 'binary_precision': 0.99870634, 'binary_recall': 0.9859515, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99228793}
confusion matrix:
      0    1
0  5996    1
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_5.png
better model found
persisted
after epoch: 5,now: 2024-06-10 18:50:18.981022,epoch time: 0:25:01.527500,used: 2:21:21.659430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.99916154, 'recall': 0.9952091, 'specificity': 0.9952091, 'f1': 0.9971754, 'auroc': 0.9998391, 'binary_precision': 0.9993146, 'binary_recall': 0.9904891, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9948822}
confusion matrix:
       0     1
0  42317     3
1     42  4374
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7440599, 'recall': 0.5090282, 'specificity': 0.5090282, 'f1': 0.50932306, 'auroc': 0.91449594, 'binary_precision': 0.5217391, 'binary_recall': 0.01866252, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.036036037}
confusion matrix:
       0   1
0  18138  11
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.99987817, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_6.png
new oracle model saved
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9982300996780396 / 0.9992625117301941
after epoch: 6,now: 2024-06-10 19:15:06.368719,epoch time: 0:24:47.387697,used: 2:46:09.047127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.99803865, 'recall': 0.99733126, 'specificity': 0.99733126, 'f1': 0.99768466, 'auroc': 0.9998312, 'binary_precision': 0.9965971, 'binary_recall': 0.995017, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9958064}
confusion matrix:
       0     1
0  42306    15
1     22  4393
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.8095601, 'recall': 0.5411917, 'specificity': 0.5411917, 'f1': 0.56599665, 'auroc': 0.9128852, 'binary_precision': 0.6506024, 'binary_recall': 0.083981335, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.14876032}
confusion matrix:
       0   1
0  18120  29
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.9966525, 'recall': 0.998306, 'specificity': 0.998306, 'f1': 0.9974774, 'auroc': 0.9999838, 'binary_precision': 0.9936387, 'binary_recall': 0.9974457, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.9955386}
confusion matrix:
      0    1
0  5992    5
1     2  781
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_7.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9982300996780396 / 0.9992625117301941
after epoch: 7,now: 2024-06-10 19:39:02.213362,epoch time: 0:23:55.844643,used: 3:10:04.891770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.9993039, 'recall': 0.9965663, 'specificity': 0.9965663, 'f1': 0.99793035, 'auroc': 0.9997548, 'binary_precision': 0.99931616, 'binary_recall': 0.99320346, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99625045}
confusion matrix:
       0     1
0  42319     3
1     30  4384
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.86425114, 'recall': 0.51230395, 'specificity': 0.51230395, 'f1': 0.5155373, 'auroc': 0.8977398, 'binary_precision': 0.7619048, 'binary_recall': 0.02488336, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.048192777}
confusion matrix:
       0   1
0  18144   5
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.99910045, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_8.png
early stop counter: 3
val acc:0.9663686752319336, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9982300996780396 / 0.9992625117301941
after epoch: 8,now: 2024-06-10 20:04:00.862882,epoch time: 0:24:58.649520,used: 3:35:03.541290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9977002, 'recall': 0.9972964, 'specificity': 0.9972964, 'f1': 0.99749815, 'auroc': 0.9998529, 'binary_precision': 0.99592024, 'binary_recall': 0.9950181, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.995469}
confusion matrix:
       0     1
0  42302    18
1     22  4394
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.88696, 'recall': 0.5570469, 'specificity': 0.5570469, 'f1': 0.5927153, 'auroc': 0.9315027, 'binary_precision': 0.8043478, 'binary_recall': 0.115085535, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.20136054}
confusion matrix:
       0   1
0  18131  18
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.9982164, 'recall': 0.99600184, 'specificity': 0.99600184, 'f1': 0.99710584, 'auroc': 0.99959964, 'binary_precision': 0.9974326, 'binary_recall': 0.99233717, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99487835}
confusion matrix:
      0    1
0  5995    2
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_9.png
better model found
persisted
after epoch: 9,now: 2024-06-10 20:28:37.872081,epoch time: 0:24:37.009199,used: 3:59:40.550489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.999634, 'recall': 0.99648845, 'specificity': 0.99648845, 'f1': 0.998055, 'auroc': 0.9997746, 'binary_precision': 1.0, 'binary_recall': 0.9929769, 'binary_specificity': 1.0, 'binary_f1_score': 0.99647605}
confusion matrix:
       0     1
0  42322     0
1     31  4383
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.84983754, 'recall': 0.5084435, 'specificity': 0.5084435, 'f1': 0.50810546, 'auroc': 0.8734618, 'binary_precision': 0.73333335, 'binary_recall': 0.01710731, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.03343465}
confusion matrix:
       0   1
0  18145   4
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9997365, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_10.png
early stop counter: 1
val acc:0.9661558270454407, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9992625117301941
after epoch: 10,now: 2024-06-10 20:53:13.717568,epoch time: 0:24:35.845487,used: 4:24:16.395976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.9992256, 'recall': 0.9968936, 'specificity': 0.9968936, 'f1': 0.9980562, 'auroc': 0.9999225, 'binary_precision': 0.9990888, 'binary_recall': 0.9938817, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9964785}
confusion matrix:
       0     1
0  42319     4
1     27  4386
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.8143872, 'recall': 0.5297756, 'specificity': 0.5297756, 'f1': 0.54709613, 'auroc': 0.91523206, 'binary_precision': 0.66101694, 'binary_recall': 0.060653187, 'binary_specificity': 0.998898, 'binary_f1_score': 0.111111104}
confusion matrix:
       0   1
0  18129  20
1    604  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.99693906, 'recall': 0.99583507, 'specificity': 0.99583507, 'f1': 0.99638623, 'auroc': 0.99945885, 'binary_precision': 0.99487835, 'binary_recall': 0.99233717, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9936061}
confusion matrix:
      0    1
0  5993    4
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_11.png
early stop counter: 2
val acc:0.9667943716049194, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9992625117301941
after epoch: 11,now: 2024-06-10 21:17:41.114956,epoch time: 0:24:27.397388,used: 4:48:43.793364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.99907005, 'recall': 0.9975503, 'specificity': 0.9975503, 'f1': 0.99830866, 'auroc': 0.9997754, 'binary_precision': 0.99863607, 'binary_recall': 0.9952424, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9969364}
confusion matrix:
       0     1
0  42316     6
1     21  4393
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.6885437, 'recall': 0.52508867, 'specificity': 0.52508867, 'f1': 0.5379058, 'auroc': 0.8944001, 'binary_precision': 0.40963855, 'binary_recall': 0.05287714, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.093663916}
confusion matrix:
       0   1
0  18100  49
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9967661, 'recall': 0.994558, 'specificity': 0.994558, 'f1': 0.9956587, 'auroc': 0.9995992, 'binary_precision': 0.99486524, 'binary_recall': 0.98978287, 'binary_specificity': 0.999333, 'binary_f1_score': 0.99231756}
confusion matrix:
      0    1
0  5993    4
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_12.png
early stop counter: 3
val acc:0.9649850726127625, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9992625117301941
after epoch: 12,now: 2024-06-10 21:42:07.915210,epoch time: 0:24:26.800254,used: 5:13:10.593618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99959344, 'precision': 0.9988626, 'recall': 0.9987614, 'specificity': 0.9987614, 'f1': 0.99881196, 'auroc': 0.9996593, 'binary_precision': 0.9979615, 'binary_recall': 0.9977355, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99784845}
confusion matrix:
       0     1
0  42311     9
1     10  4406
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7762313, 'recall': 0.53411067, 'specificity': 0.53411067, 'f1': 0.5539551, 'auroc': 0.90654534, 'binary_precision': 0.58441556, 'binary_recall': 0.06998445, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.12500001}
confusion matrix:
       0   1
0  18117  32
1    598  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999705, 'precision': 0.9987261, 'recall': 0.9998332, 'specificity': 0.9998332, 'f1': 0.9992789, 'auroc': 0.99999976, 'binary_precision': 0.99745226, 'binary_recall': 1.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9987245}
confusion matrix:
      0    1
0  5995    2
1     0  783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_13.png
new oracle model saved
early stop counter: 4
val acc:0.9664750695228577, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 13,now: 2024-06-10 22:06:33.233319,epoch time: 0:24:25.318109,used: 5:37:35.911727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.99587774, 'recall': 0.9978881, 'specificity': 0.9978881, 'f1': 0.99688035, 'auroc': 0.9998752, 'binary_precision': 0.99211, 'binary_recall': 0.99660325, 'binary_specificity': 0.999173, 'binary_f1_score': 0.99435157}
confusion matrix:
       0     1
0  42285    35
1     15  4401
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.69126403, 'recall': 0.54431456, 'specificity': 0.54431456, 'f1': 0.56706506, 'auroc': 0.9079446, 'binary_precision': 0.41379312, 'binary_recall': 0.0933126, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.15228428}
confusion matrix:
       0   1
0  18064  85
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9920807, 'recall': 0.99644524, 'specificity': 0.99644524, 'f1': 0.99424994, 'auroc': 0.999941, 'binary_precision': 0.9848293, 'binary_recall': 0.99489146, 'binary_specificity': 0.997999, 'binary_f1_score': 0.9898348}
confusion matrix:
      0    1
0  5985   12
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_14.png
early stop counter: 5
val acc:0.9644529819488525, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 14,now: 2024-06-10 22:31:10.936620,epoch time: 0:24:37.703301,used: 6:02:13.615028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9997646, 'precision': 0.9997684, 'recall': 0.99885595, 'specificity': 0.99885595, 'f1': 0.9993117, 'auroc': 0.9999764, 'binary_precision': 0.9997731, 'binary_recall': 0.9977355, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9987533}
confusion matrix:
       0     1
0  42319     1
1     10  4406
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.77508533, 'recall': 0.51591647, 'specificity': 0.51591647, 'f1': 0.52229756, 'auroc': 0.93042624, 'binary_precision': 0.5833333, 'binary_recall': 0.032659408, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.06185567}
confusion matrix:
       0   1
0  18134  15
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99494636, 'recall': 0.99494636, 'specificity': 0.99494636, 'f1': 0.99494636, 'auroc': 0.9995382, 'binary_precision': 0.99106, 'binary_recall': 0.99106, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.99106}
confusion matrix:
      0    1
0  5990    7
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_15.png
early stop counter: 6
val acc:0.9661026000976562, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 15,now: 2024-06-10 22:56:11.155262,epoch time: 0:25:00.218642,used: 6:27:13.833670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9998074, 'precision': 0.999792, 'recall': 0.9990818, 'specificity': 0.9990818, 'f1': 0.9994366, 'auroc': 0.99999166, 'binary_precision': 0.999773, 'binary_recall': 0.9981872, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9989795}
confusion matrix:
       0     1
0  42322     1
1      8  4405
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.83324635, 'recall': 0.5107212, 'specificity': 0.5107212, 'f1': 0.51251674, 'auroc': 0.90573347, 'binary_precision': 0.7, 'binary_recall': 0.02177294, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.04223228}
confusion matrix:
       0   1
0  18143   6
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9995003, 'recall': 0.9961686, 'specificity': 0.9961686, 'f1': 0.99782693, 'auroc': 0.999488, 'binary_precision': 1.0, 'binary_recall': 0.99233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.99615383}
confusion matrix:
      0    1
0  5997    0
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_16.png
early stop counter: 7
val acc:0.9662090539932251, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 16,now: 2024-06-10 23:20:51.680237,epoch time: 0:24:40.524975,used: 6:51:54.358645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99965763, 'precision': 0.99950594, 'recall': 0.9984923, 'specificity': 0.9984923, 'f1': 0.99899846, 'auroc': 0.99996984, 'binary_precision': 0.99931896, 'binary_recall': 0.9970555, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.998186}
confusion matrix:
       0     1
0  42318     3
1     13  4402
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.8679166, 'recall': 0.5330789, 'specificity': 0.5330789, 'f1': 0.55320686, 'auroc': 0.9337771, 'binary_precision': 0.76785713, 'binary_recall': 0.06687403, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.123032905}
confusion matrix:
       0   1
0  18136  13
1    600  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99941003, 'precision': 0.99855614, 'recall': 0.99855614, 'specificity': 0.99855614, 'f1': 0.99855614, 'auroc': 0.99999, 'binary_precision': 0.9974457, 'binary_recall': 0.9974457, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9974457}
confusion matrix:
      0    1
0  5995    2
1     2  781
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_17.png
early stop counter: 8
val acc:0.9673797488212585, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 17,now: 2024-06-10 23:45:40.196674,epoch time: 0:24:48.516437,used: 7:16:42.875082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.999679, 'precision': 0.99941635, 'recall': 0.99870694, 'specificity': 0.99870694, 'f1': 0.99906135, 'auroc': 0.9999914, 'binary_precision': 0.9990926, 'binary_recall': 0.99750847, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9982999}
confusion matrix:
       0     1
0  42317     4
1     11  4404
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.78570473, 'recall': 0.5220271, 'specificity': 0.5220271, 'f1': 0.5333893, 'auroc': 0.92499864, 'binary_precision': 0.6041667, 'binary_recall': 0.045101088, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.08393632}
confusion matrix:
       0   1
0  18130  19
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9983862, 'recall': 0.997279, 'specificity': 0.997279, 'f1': 0.99783176, 'auroc': 0.9999504, 'binary_precision': 0.9974392, 'binary_recall': 0.99489146, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99616367}
confusion matrix:
      0    1
0  5995    2
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_18.png
early stop counter: 9
val acc:0.9663154482841492, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9997050166130066
after epoch: 18,now: 2024-06-11 00:10:16.020305,epoch time: 0:24:35.823631,used: 7:41:18.698713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.99968123, 'recall': 0.99694157, 'specificity': 0.99694157, 'f1': 0.99830663, 'auroc': 0.9999192, 'binary_precision': 1.0, 'binary_recall': 0.9938831, 'binary_specificity': 1.0, 'binary_f1_score': 0.99693215}
confusion matrix:
       0     1
0  42322     0
1     27  4387
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.9207499, 'recall': 0.51083136, 'specificity': 0.51083136, 'f1': 0.51269996, 'auroc': 0.9402423, 'binary_precision': 0.875, 'binary_recall': 0.02177294, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.042488623}
confusion matrix:
       0   1
0  18147   2
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9998525, 'precision': 0.9999167, 'recall': 0.9993614, 'specificity': 0.9993614, 'f1': 0.9996388, 'auroc': 0.99999994, 'binary_precision': 1.0, 'binary_recall': 0.99872285, 'binary_specificity': 1.0, 'binary_f1_score': 0.99936104}
confusion matrix:
      0    1
0  5997    0
1     1  782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_19.png
new oracle model saved
early stop counter: 10
val acc:0.966421902179718, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 19,now: 2024-06-11 00:28:35.551717,epoch time: 0:18:19.531412,used: 7:59:38.230125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9997646, 'precision': 0.99956536, 'recall': 0.9990586, 'specificity': 0.9990586, 'f1': 0.9993118, 'auroc': 0.9999931, 'binary_precision': 0.99931973, 'binary_recall': 0.998188, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99875355}
confusion matrix:
       0     1
0  42318     3
1      8  4407
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.8380636, 'recall': 0.558994, 'specificity': 0.558994, 'f1': 0.59427565, 'auroc': 0.92882234, 'binary_precision': 0.70642203, 'binary_recall': 0.11975116, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.20478724}
confusion matrix:
       0   1
0  18117  32
1    566  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999705, 'precision': 0.99983335, 'recall': 0.99872285, 'specificity': 0.99872285, 'f1': 0.99927723, 'auroc': 0.9999461, 'binary_precision': 1.0, 'binary_recall': 0.9974457, 'binary_specificity': 1.0, 'binary_f1_score': 0.99872124}
confusion matrix:
      0    1
0  5997    0
1     2  781
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_20.png
early stop counter: 11
val acc:0.9681779742240906, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 20,now: 2024-06-11 00:47:00.632254,epoch time: 0:18:25.080537,used: 8:18:03.310662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99957204, 'precision': 0.9988494, 'recall': 0.9986468, 'specificity': 0.9986468, 'f1': 0.99874806, 'auroc': 0.9999726, 'binary_precision': 0.9979587, 'binary_recall': 0.99750626, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9977324}
confusion matrix:
       0     1
0  42316     9
1     11  4400
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.8226581, 'recall': 0.51452655, 'specificity': 0.51452655, 'f1': 0.5197417, 'auroc': 0.88713527, 'binary_precision': 0.6785714, 'binary_recall': 0.02954899, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.056631893}
confusion matrix:
       0   1
0  18140   9
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99830127, 'recall': 0.99664044, 'specificity': 0.99664044, 'f1': 0.99746895, 'auroc': 0.99988294, 'binary_precision': 0.99743587, 'binary_recall': 0.9936143, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9955214}
confusion matrix:
      0    1
0  5995    2
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_21.png
early stop counter: 12
val acc:0.9663154482841492, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 21,now: 2024-06-11 01:05:37.322284,epoch time: 0:18:36.690030,used: 8:36:40.000692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9994651, 'precision': 0.9992974, 'recall': 0.99757504, 'specificity': 0.99757504, 'f1': 0.9984343, 'auroc': 0.9999759, 'binary_precision': 0.99909073, 'binary_recall': 0.99524456, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99716395}
confusion matrix:
       0     1
0  42316     4
1     21  4395
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7958955, 'recall': 0.5152215, 'specificity': 0.5152215, 'f1': 0.5210274, 'auroc': 0.90475506, 'binary_precision': 0.625, 'binary_recall': 0.0311042, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.059259262}
confusion matrix:
       0   1
0  18137  12
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.9920807, 'recall': 0.99644524, 'specificity': 0.99644524, 'f1': 0.99424994, 'auroc': 0.9997829, 'binary_precision': 0.9848293, 'binary_recall': 0.99489146, 'binary_specificity': 0.997999, 'binary_f1_score': 0.9898348}
confusion matrix:
      0    1
0  5985   12
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_22.png
early stop counter: 13
val acc:0.9662090539932251, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 22,now: 2024-06-11 01:24:05.022534,epoch time: 0:18:27.700250,used: 8:55:07.700942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9997218, 'precision': 0.9997448, 'recall': 0.9986295, 'specificity': 0.9986295, 'f1': 0.9991864, 'auroc': 0.9999782, 'binary_precision': 0.99977297, 'binary_recall': 0.9972826, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9985263}
confusion matrix:
       0     1
0  42319     1
1     12  4404
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.90653104, 'recall': 0.5169971, 'specificity': 0.5169971, 'f1': 0.5244195, 'auroc': 0.8125781, 'binary_precision': 0.84615386, 'binary_recall': 0.03421462, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.06576981}
confusion matrix:
       0   1
0  18145   4
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9995003, 'recall': 0.9961686, 'specificity': 0.9961686, 'f1': 0.99782693, 'auroc': 0.9999255, 'binary_precision': 1.0, 'binary_recall': 0.99233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.99615383}
confusion matrix:
      0    1
0  5997    0
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_23.png
early stop counter: 14
val acc:0.966741144657135, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 23,now: 2024-06-11 01:42:27.324464,epoch time: 0:18:22.301930,used: 9:13:30.002872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99959344, 'precision': 0.99977565, 'recall': 0.9978483, 'specificity': 0.9978483, 'f1': 0.9988096, 'auroc': 0.9999716, 'binary_precision': 1.0, 'binary_recall': 0.9956965, 'binary_specificity': 1.0, 'binary_f1_score': 0.99784356}
confusion matrix:
       0     1
0  42321     0
1     19  4396
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.75973266, 'recall': 0.51586133, 'specificity': 0.51586133, 'f1': 0.5221792, 'auroc': 0.84878564, 'binary_precision': 0.55263156, 'binary_recall': 0.032659408, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.061674006}
confusion matrix:
       0   1
0  18132  17
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9958447, 'recall': 0.9969455, 'specificity': 0.9969455, 'f1': 0.9963943, 'auroc': 0.99947214, 'binary_precision': 0.9923567, 'binary_recall': 0.99489146, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.9936225}
confusion matrix:
      0    1
0  5991    6
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_24.png
early stop counter: 15
val acc:0.9659961462020874, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 24,now: 2024-06-11 02:00:56.270258,epoch time: 0:18:28.945794,used: 9:31:58.948666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9997218, 'precision': 0.99964297, 'recall': 0.99873006, 'specificity': 0.99873006, 'f1': 0.99918604, 'auroc': 0.99990785, 'binary_precision': 0.9995459, 'binary_recall': 0.9975074, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9985256}
confusion matrix:
       0     1
0  42321     2
1     11  4402
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.9212884, 'recall': 0.52707845, 'specificity': 0.52707845, 'f1': 0.5429385, 'auroc': 0.9460226, 'binary_precision': 0.875, 'binary_recall': 0.054432347, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.102489024}
confusion matrix:
       0   1
0  18144   5
1    608  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995575, 'precision': 0.99975, 'recall': 0.9980843, 'specificity': 0.9980843, 'f1': 0.9989152, 'auroc': 0.9993743, 'binary_precision': 1.0, 'binary_recall': 0.99616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.99808055}
confusion matrix:
      0    1
0  5997    0
1     3  780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_25.png
early stop counter: 16
val acc:0.9673797488212585, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 25,now: 2024-06-11 02:19:28.215358,epoch time: 0:18:31.945100,used: 9:50:30.893766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9997004, 'precision': 0.99983466, 'recall': 0.9984149, 'specificity': 0.9984149, 'f1': 0.99912345, 'auroc': 0.9999863, 'binary_precision': 1.0, 'binary_recall': 0.9968297, 'binary_specificity': 1.0, 'binary_f1_score': 0.9984123}
confusion matrix:
       0     1
0  42320     0
1     14  4402
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.872137, 'recall': 0.5107763, 'specificity': 0.5107763, 'f1': 0.5126081, 'auroc': 0.93445003, 'binary_precision': 0.7777778, 'binary_recall': 0.02177294, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.04236006}
confusion matrix:
       0   1
0  18145   4
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995575, 'precision': 0.99975, 'recall': 0.9980843, 'specificity': 0.9980843, 'f1': 0.9989152, 'auroc': 0.99999106, 'binary_precision': 1.0, 'binary_recall': 0.99616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.99808055}
confusion matrix:
      0    1
0  5997    0
1     3  780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_26.png
early stop counter: 17
val acc:0.9663154482841492, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 26,now: 2024-06-11 02:37:50.267454,epoch time: 0:18:22.052096,used: 10:08:52.945862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9997004, 'precision': 0.99983466, 'recall': 0.9984145, 'specificity': 0.9984145, 'f1': 0.99912333, 'auroc': 0.99998415, 'binary_precision': 1.0, 'binary_recall': 0.996829, 'binary_specificity': 1.0, 'binary_f1_score': 0.99841195}
confusion matrix:
       0     1
0  42321     0
1     14  4401
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.9650413, 'recall': 0.5201902, 'specificity': 0.5201902, 'f1': 0.53043514, 'auroc': 0.91324747, 'binary_precision': 0.962963, 'binary_recall': 0.04043546, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.077611946}
confusion matrix:
       0   1
0  18148   1
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.9996153, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_27.png
early stop counter: 18
val acc:0.9671136736869812, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 27,now: 2024-06-11 02:56:16.029758,epoch time: 0:18:25.762304,used: 10:27:18.708166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9997646, 'precision': 0.9996667, 'recall': 0.9989567, 'specificity': 0.9989567, 'f1': 0.9993114, 'auroc': 0.99997306, 'binary_precision': 0.99954605, 'binary_recall': 0.99796057, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9987527}
confusion matrix:
       0     1
0  42321     2
1      9  4404
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.9201126, 'recall': 0.5317165, 'specificity': 0.5317165, 'f1': 0.5511805, 'auroc': 0.94303787, 'binary_precision': 0.87234044, 'binary_recall': 0.06376361, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.11884058}
confusion matrix:
       0   1
0  18143   6
1    602  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.9982164, 'recall': 0.99600184, 'specificity': 0.99600184, 'f1': 0.99710584, 'auroc': 0.99953085, 'binary_precision': 0.9974326, 'binary_recall': 0.99233717, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99487835}
confusion matrix:
      0    1
0  5995    2
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_28.png
early stop counter: 19
val acc:0.9676458239555359, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 28,now: 2024-06-11 03:14:44.009501,epoch time: 0:18:27.979743,used: 10:45:46.687909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9997218, 'precision': 0.9997447, 'recall': 0.9986292, 'specificity': 0.9986292, 'f1': 0.99918616, 'auroc': 0.99992186, 'binary_precision': 0.9997729, 'binary_recall': 0.99728197, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9985259}
confusion matrix:
       0     1
0  42320     1
1     12  4403
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.92431617, 'recall': 0.52863365, 'specificity': 0.52863365, 'f1': 0.54573524, 'auroc': 0.91496, 'binary_precision': 0.88095236, 'binary_recall': 0.057542767, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.108029194}
confusion matrix:
       0   1
0  18144   5
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9983862, 'recall': 0.997279, 'specificity': 0.997279, 'f1': 0.99783176, 'auroc': 0.9999757, 'binary_precision': 0.9974392, 'binary_recall': 0.99489146, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99616367}
confusion matrix:
      0    1
0  5995    2
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_29.png
early stop counter: 20
val acc:0.9674861431121826, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.9988200664520264 / 0.9998524785041809
after epoch: 29,now: 2024-06-11 03:33:04.558386,epoch time: 0:18:20.548885,used: 11:04:07.236794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_28_57_seed_0_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 11:04:07.236794 at 2024-06-11 03:33:04.558386
persisted model performance metric: 

scalar performance:
{'acc': 0.9992625, 'precision': 0.99847114, 'recall': 0.99791753, 'specificity': 0.99791753, 'f1': 0.9981941, 'auroc': 0.99983406, 'binary_precision': 0.9974425, 'binary_recall': 0.99616855, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9968051}
confusion matrix:
      0    1
0  5995    2
1     3  780
oracle model performance metric: 

scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.99975044, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488315 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |  89915 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488315 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |  89915 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476597 KiB |   1821 MiB |   1437 TiB |   1437 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1434 TiB |   1434 TiB |
|       from small pool |  88757 KiB |    122 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2106 MiB |   2106 MiB |   2106 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    851 MiB |    866 MiB | 707289 GiB | 707288 GiB |
|       from large pool |    842 MiB |    863 MiB | 703613 GiB | 703612 GiB |
|       from small pool |      8 MiB |     18 MiB |   3675 GiB |   3675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3921    |    7068    |  132299 K  |  132295 K  |
|       from large pool |      87    |     178    |   56996 K  |   56996 K  |
|       from small pool |    3834    |    6980    |   75302 K  |   75299 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3921    |    7068    |  132299 K  |  132295 K  |
|       from large pool |      87    |     178    |   56996 K  |   56996 K  |
|       from small pool |    3834    |    6980    |   75302 K  |   75299 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |      95    |      95    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2949    |   54392 K  |   54392 K  |
|       from large pool |      18    |      22    |   19764 K  |   19764 K  |
|       from small pool |      36    |    2931    |   34627 K  |   34627 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1437 TiB |   1437 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1434 TiB |   1434 TiB |
|       from small pool |      0 KiB |    122 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1328 MiB |   2106 MiB |   2106 MiB |    778 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    958 MiB | 707289 GiB | 707289 GiB |
|       from large pool | 134912 KiB |    938 MiB | 703613 GiB | 703613 GiB |
|       from small pool |      0 KiB |     28 MiB |   3675 GiB |   3675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7068    |  132299 K  |  132299 K  |
|       from large pool |       2    |     178    |   56996 K  |   56996 K  |
|       from small pool |       0    |    6980    |   75302 K  |   75302 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7068    |  132299 K  |  132299 K  |
|       from large pool |       2    |     178    |   56996 K  |   56996 K  |
|       from small pool |       0    |    6980    |   75302 K  |   75302 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      95    |      95    |      24    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2949    |   54393 K  |   54393 K  |
|       from large pool |       4    |      25    |   19764 K  |   19764 K  |
|       from small pool |       0    |    2931    |   34628 K  |   34628 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1445 TiB |   1445 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1437 TiB |   1437 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1434 TiB |   1434 TiB |
|       from small pool |      0 KiB |    122 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1328 MiB |   2106 MiB |   2106 MiB |    778 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    958 MiB | 707289 GiB | 707289 GiB |
|       from large pool | 134912 KiB |    938 MiB | 703613 GiB | 703613 GiB |
|       from small pool |      0 KiB |     28 MiB |   3675 GiB |   3675 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7068    |  132299 K  |  132299 K  |
|       from large pool |       2    |     178    |   56996 K  |   56996 K  |
|       from small pool |       0    |    6980    |   75302 K  |   75302 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7068    |  132299 K  |  132299 K  |
|       from large pool |       2    |     178    |   56996 K  |   56996 K  |
|       from small pool |       0    |    6980    |   75302 K  |   75302 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      95    |      95    |      24    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2949    |   54393 K  |   54393 K  |
|       from large pool |       4    |      25    |   19764 K  |   19764 K  |
|       from small pool |       0    |    2931    |   34628 K  |   34628 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200

 Experiment start at: 2024-06-11 03:39:38.971167
before training, model accuracy: 0.12592922151088715
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9961272, 'precision': 0.98911875, 'recall': 0.9877984, 'specificity': 0.9877984, 'f1': 0.98845744, 'auroc': 0.9993303, 'binary_precision': 0.980524, 'binary_recall': 0.97757745, 'binary_specificity': 0.99801934, 'binary_f1_score': 0.9790485}
confusion matrix:
       0     1
0  42326    84
1     97  4229
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.772946, 'recall': 0.59392565, 'specificity': 0.59392565, 'f1': 0.63587105, 'auroc': 0.8689265, 'binary_precision': 0.57522124, 'binary_recall': 0.19316493, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.28921023}
confusion matrix:
       0    1
0  17971   96
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942016, 'precision': 0.9893439, 'recall': 0.98224014, 'specificity': 0.98224014, 'f1': 0.985757, 'auroc': 0.99946785, 'binary_precision': 0.9830508, 'binary_recall': 0.96666664, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.97478986}
confusion matrix:
      0    1
0  5933   13
1    26  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 03:58:52.219023,epoch time: 0:19:13.247856,used: 0:19:13.247856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9976891, 'precision': 0.9948523, 'recall': 0.99135566, 'specificity': 0.99135566, 'f1': 0.99309623, 'auroc': 0.9997139, 'binary_precision': 0.9913773, 'binary_recall': 0.9835838, 'binary_specificity': 0.99912757, 'binary_f1_score': 0.9874652}
confusion matrix:
       0     1
0  42374    37
1     71  4254
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.78058565, 'recall': 0.54344183, 'specificity': 0.54344183, 'f1': 0.5686107, 'auroc': 0.87633985, 'binary_precision': 0.5940594, 'binary_recall': 0.089153044, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.15503876}
confusion matrix:
       0   1
0  18026  41
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.9960531, 'recall': 0.98940724, 'specificity': 0.98940724, 'f1': 0.9927, 'auroc': 0.9984809, 'binary_precision': 0.9947917, 'binary_recall': 0.9794872, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.98708004}
confusion matrix:
      0    1
0  5942    4
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_2.png
new oracle model saved
early stop counter: 1
val acc:0.9651013612747192, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9970264434814453
after epoch: 2,now: 2024-06-11 04:17:18.671006,epoch time: 0:18:26.451983,used: 0:37:39.699839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9973468, 'precision': 0.99100184, 'recall': 0.99324346, 'specificity': 0.99324346, 'f1': 0.99211943, 'auroc': 0.9997318, 'binary_precision': 0.9832068, 'binary_recall': 0.9882081, 'binary_specificity': 0.99827874, 'binary_f1_score': 0.9857011}
confusion matrix:
       0     1
0  42338    73
1     51  4274
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.61612064, 'recall': 0.52133876, 'specificity': 0.52133876, 'f1': 0.5304177, 'auroc': 0.88920236, 'binary_precision': 0.26666668, 'binary_recall': 0.04754829, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.08070618}
confusion matrix:
       0   1
0  17979  88
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956884, 'precision': 0.99757326, 'recall': 0.98141026, 'specificity': 0.98141026, 'f1': 0.9893127, 'auroc': 0.99920654, 'binary_precision': 1.0, 'binary_recall': 0.96282053, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810581}
confusion matrix:
      0    1
0  5946    0
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_3.png
early stop counter: 2
val acc:0.9610992670059204, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9970264434814453
after epoch: 3,now: 2024-06-11 04:35:49.610465,epoch time: 0:18:30.939459,used: 0:56:10.639298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.99920106, 'recall': 0.9944286, 'specificity': 0.9944286, 'f1': 0.9968005, 'auroc': 0.99968195, 'binary_precision': 0.9995327, 'binary_recall': 0.9889043, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9941901}
confusion matrix:
       0     1
0  42408     2
1     48  4278
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.78029096, 'recall': 0.51810306, 'specificity': 0.51810306, 'f1': 0.5259211, 'auroc': 0.8942165, 'binary_precision': 0.5952381, 'binary_recall': 0.0371471, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.06993007}
confusion matrix:
       0   1
0  18050  17
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.9988525, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_4.png
new oracle model saved
early stop counter: 3
val acc:0.964514434337616, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9980672001838684
after epoch: 4,now: 2024-06-11 04:54:12.618087,epoch time: 0:18:23.007622,used: 1:14:33.646920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99837387, 'precision': 0.99628603, 'recall': 0.99401826, 'specificity': 0.99401826, 'f1': 0.9951489, 'auroc': 0.99985206, 'binary_precision': 0.9937268, 'binary_recall': 0.98867315, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.99119353}
confusion matrix:
       0     1
0  42383    27
1     49  4277
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.69917375, 'recall': 0.5204937, 'specificity': 0.5204937, 'f1': 0.5299077, 'auroc': 0.8653561, 'binary_precision': 0.43283582, 'binary_recall': 0.043090638, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.07837837}
confusion matrix:
       0   1
0  18029  38
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99611014, 'recall': 0.99445134, 'specificity': 0.99445134, 'f1': 0.99527884, 'auroc': 0.9999506, 'binary_precision': 0.993565, 'binary_recall': 0.9897436, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.99165064}
confusion matrix:
      0    1
0  5941    5
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_5.png
early stop counter: 4
val acc:0.9636072516441345, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9980672001838684
after epoch: 5,now: 2024-06-11 05:12:36.582455,epoch time: 0:18:23.964368,used: 1:32:57.611288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.9992857, 'recall': 0.9963808, 'specificity': 0.9963808, 'f1': 0.99782795, 'auroc': 0.999967, 'binary_precision': 0.99930185, 'binary_recall': 0.99283236, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9960566}
confusion matrix:
       0     1
0  42408     3
1     31  4294
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.8347347, 'recall': 0.5431417, 'specificity': 0.5431417, 'f1': 0.56923896, 'auroc': 0.9068561, 'binary_precision': 0.70238096, 'binary_recall': 0.08766716, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.15587847}
confusion matrix:
       0   1
0  18042  25
1    614  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9998286, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_6.png
new oracle model saved
early stop counter: 5
val acc:0.965901792049408, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9982158541679382
after epoch: 6,now: 2024-06-11 05:31:01.925362,epoch time: 0:18:25.342907,used: 1:51:22.954195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.99936503, 'recall': 0.9949027, 'specificity': 0.9949027, 'f1': 0.99712133, 'auroc': 0.9998975, 'binary_precision': 0.9997665, 'binary_recall': 0.98982894, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.994773}
confusion matrix:
       0     1
0  42409     1
1     44  4282
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.57736856, 'recall': 0.5025013, 'specificity': 0.5025013, 'f1': 0.4964395, 'auroc': 0.8780385, 'binary_precision': 0.1904762, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.011527378}
confusion matrix:
       0   1
0  18050  17
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.9975652, 'recall': 0.9959016, 'specificity': 0.9959016, 'f1': 0.9967315, 'auroc': 0.99998236, 'binary_precision': 0.996139, 'binary_recall': 0.99230766, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.9942196}
confusion matrix:
      0    1
0  5943    3
1     6  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_7.png
new oracle model saved
early stop counter: 6
val acc:0.9633938074111938, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9986619353294373
after epoch: 7,now: 2024-06-11 05:49:33.424492,epoch time: 0:18:31.499130,used: 2:09:54.453325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9994009, 'precision': 0.9991485, 'recall': 0.9972821, 'specificity': 0.9972821, 'f1': 0.99821305, 'auroc': 0.9999486, 'binary_precision': 0.9988391, 'binary_recall': 0.9946821, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99675626}
confusion matrix:
       0     1
0  42406     5
1     23  4302
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.82294583, 'recall': 0.54014224, 'specificity': 0.54014224, 'f1': 0.5641767, 'auroc': 0.92601943, 'binary_precision': 0.67901236, 'binary_recall': 0.08172362, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.1458886}
confusion matrix:
       0   1
0  18041  26
1    618  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.9999461, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_8.png
early stop counter: 7
val acc:0.9656350016593933, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9986619353294373
after epoch: 8,now: 2024-06-11 06:07:46.886131,epoch time: 0:18:13.461639,used: 2:28:07.914964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.999576, 'recall': 0.9958391, 'specificity': 0.9958391, 'f1': 0.9976987, 'auroc': 0.99969804, 'binary_precision': 1.0, 'binary_recall': 0.99167824, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958217}
confusion matrix:
       0     1
0  42410     0
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.91733855, 'recall': 0.5147758, 'specificity': 0.5147758, 'f1': 0.5198187, 'auroc': 0.913941, 'binary_precision': 0.8695652, 'binary_recall': 0.029717682, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.057471264}
confusion matrix:
       0   1
0  18064   3
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99962354, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_9.png
early stop counter: 8
val acc:0.9649946689605713, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9986619353294373
after epoch: 9,now: 2024-06-11 06:26:04.836758,epoch time: 0:18:17.950627,used: 2:46:25.865591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99952924, 'precision': 0.998909, 'recall': 0.99828756, 'specificity': 0.99828756, 'f1': 0.9985981, 'auroc': 0.9999702, 'binary_precision': 0.99814814, 'binary_recall': 0.99676377, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9974555}
confusion matrix:
       0     1
0  42402     8
1     14  4312
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.8028518, 'recall': 0.523276, 'specificity': 0.523276, 'f1': 0.5352957, 'auroc': 0.89517343, 'binary_precision': 0.64, 'binary_recall': 0.04754829, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.08852006}
confusion matrix:
       0   1
0  18049  18
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.99258167, 'recall': 0.9958699, 'specificity': 0.9958699, 'f1': 0.99421835, 'auroc': 0.9999443, 'binary_precision': 0.98600507, 'binary_recall': 0.99358976, 'binary_specificity': 0.99815, 'binary_f1_score': 0.98978287}
confusion matrix:
      0    1
0  5935   11
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_10.png
early stop counter: 9
val acc:0.9648345708847046, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9986619353294373
after epoch: 10,now: 2024-06-11 06:44:20.399199,epoch time: 0:18:15.562441,used: 3:04:41.428032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99957204, 'precision': 0.99966, 'recall': 0.9977922, 'specificity': 0.9977922, 'f1': 0.99872386, 'auroc': 0.99980843, 'binary_precision': 0.9997679, 'binary_recall': 0.995608, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9976836}
confusion matrix:
       0     1
0  42409     1
1     19  4307
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.8380007, 'recall': 0.5321913, 'specificity': 0.5321913, 'f1': 0.55106, 'auroc': 0.9020971, 'binary_precision': 0.7096774, 'binary_recall': 0.0653789, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.11972788}
confusion matrix:
       0   1
0  18049  18
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.99999416, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_11.png
new oracle model saved
early stop counter: 10
val acc:0.9654749035835266, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9995539784431458
after epoch: 11,now: 2024-06-11 07:02:38.629416,epoch time: 0:18:18.230217,used: 3:22:59.658249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9994009, 'precision': 0.99770296, 'recall': 0.9987358, 'specificity': 0.9987358, 'f1': 0.99821866, 'auroc': 0.9999506, 'binary_precision': 0.9956181, 'binary_recall': 0.99791956, 'binary_specificity': 0.999552, 'binary_f1_score': 0.9967675}
confusion matrix:
       0     1
0  42391    19
1      9  4317
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73258984, 'recall': 0.51573586, 'specificity': 0.51573586, 'f1': 0.5215302, 'auroc': 0.8976153, 'binary_precision': 0.5, 'binary_recall': 0.03268945, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.061366804}
confusion matrix:
       0   1
0  18045  22
1    651  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9922366, 'recall': 0.99770886, 'specificity': 0.99770886, 'f1': 0.99495226, 'auroc': 0.99946016, 'binary_precision': 0.9848101, 'binary_recall': 0.99743587, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.9910828}
confusion matrix:
      0    1
0  5934   12
1     2  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_12.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9942016005516052 / 0.9995539784431458
after epoch: 12,now: 2024-06-11 07:20:46.625046,epoch time: 0:18:07.995630,used: 3:41:07.653879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.999786, 'precision': 0.99977803, 'recall': 0.9989475, 'specificity': 0.9989475, 'f1': 0.99936235, 'auroc': 0.9999956, 'binary_precision': 0.9997683, 'binary_recall': 0.9979186, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99884266}
confusion matrix:
       0     1
0  42411     1
1      9  4315
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.87266386, 'recall': 0.5639441, 'specificity': 0.5639441, 'f1': 0.60250264, 'auroc': 0.92807025, 'binary_precision': 0.77678573, 'binary_recall': 0.12927191, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.22165604}
confusion matrix:
       0   1
0  18042  25
1    586  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.99820715, 'recall': 0.9959856, 'specificity': 0.9959856, 'f1': 0.9970931, 'auroc': 0.99990684, 'binary_precision': 0.9974227, 'binary_recall': 0.99230766, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9948586}
confusion matrix:
      0    1
0  5944    2
1     6  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_13.png
better model found
persisted
after epoch: 13,now: 2024-06-11 07:38:50.390326,epoch time: 0:18:03.765280,used: 3:59:11.419159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.9975753, 'recall': 0.9986081, 'specificity': 0.9986081, 'f1': 0.99809104, 'auroc': 0.99988246, 'binary_precision': 0.99538636, 'binary_recall': 0.9976879, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.99653584}
confusion matrix:
       0     1
0  42391    20
1     10  4315
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.8119947, 'recall': 0.519672, 'specificity': 0.519672, 'f1': 0.5288394, 'auroc': 0.90339065, 'binary_precision': 0.6585366, 'binary_recall': 0.04011887, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.07563025}
confusion matrix:
       0   1
0  18053  14
1    646  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.9999982, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_14.png
early stop counter: 1
val acc:0.9647812247276306, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 14,now: 2024-06-11 07:57:05.325275,epoch time: 0:18:14.934949,used: 4:17:26.354108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99952924, 'precision': 0.9993241, 'recall': 0.9978724, 'specificity': 0.9978724, 'f1': 0.9985969, 'auroc': 0.9999924, 'binary_precision': 0.9990724, 'binary_recall': 0.9958391, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.99745315}
confusion matrix:
       0     1
0  42406     4
1     18  4308
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7950476, 'recall': 0.5145267, 'specificity': 0.5145267, 'f1': 0.51932734, 'auroc': 0.88880986, 'binary_precision': 0.625, 'binary_recall': 0.029717682, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.056737587}
confusion matrix:
       0   1
0  18055  12
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.99876595, 'recall': 0.9954287, 'specificity': 0.9954287, 'f1': 0.99708974, 'auroc': 0.9999565, 'binary_precision': 0.998708, 'binary_recall': 0.9910256, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.994852}
confusion matrix:
      0    1
0  5945    1
1     7  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_15.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 15,now: 2024-06-11 08:15:11.473349,epoch time: 0:18:06.148074,used: 4:35:32.502182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9997004, 'precision': 0.9997309, 'recall': 0.9984857, 'specificity': 0.9984857, 'f1': 0.9991073, 'auroc': 0.9998535, 'binary_precision': 0.9997682, 'binary_recall': 0.9969949, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99837965}
confusion matrix:
       0     1
0  42409     1
1     13  4313
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.8552752, 'recall': 0.5256709, 'specificity': 0.5256709, 'f1': 0.53977, 'auroc': 0.85172045, 'binary_precision': 0.7446808, 'binary_recall': 0.052005943, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.09722222}
confusion matrix:
       0   1
0  18055  12
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.9964626, 'recall': 0.9970155, 'specificity': 0.9970155, 'f1': 0.9967388, 'auroc': 0.9999541, 'binary_precision': 0.9935979, 'binary_recall': 0.9948718, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.99423444}
confusion matrix:
      0    1
0  5941    5
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_16.png
early stop counter: 3
val acc:0.9653148055076599, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 16,now: 2024-06-11 08:33:26.496628,epoch time: 0:18:15.023279,used: 4:53:47.525461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9997004, 'precision': 0.9996269, 'recall': 0.99858946, 'specificity': 0.99858946, 'f1': 0.9991075, 'auroc': 0.9998789, 'binary_precision': 0.99953663, 'binary_recall': 0.99722606, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99838}
confusion matrix:
       0     1
0  42408     2
1     12  4314
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.8367247, 'recall': 0.5387671, 'specificity': 0.5387671, 'f1': 0.5621166, 'auroc': 0.8762778, 'binary_precision': 0.70666665, 'binary_recall': 0.078751855, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.14171124}
confusion matrix:
       0   1
0  18045  22
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.99820715, 'recall': 0.9959856, 'specificity': 0.9959856, 'f1': 0.9970931, 'auroc': 0.9999038, 'binary_precision': 0.9974227, 'binary_recall': 0.99230766, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9948586}
confusion matrix:
      0    1
0  5944    2
1     6  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_17.png
early stop counter: 4
val acc:0.965741753578186, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 17,now: 2024-06-11 08:51:28.443134,epoch time: 0:18:01.946506,used: 5:11:49.471967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99957204, 'precision': 0.9994517, 'recall': 0.9979993, 'specificity': 0.9979993, 'f1': 0.99872416, 'auroc': 0.9999906, 'binary_precision': 0.9993041, 'binary_recall': 0.9960694, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9976841}
confusion matrix:
       0     1
0  42408     3
1     17  4308
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.87093437, 'recall': 0.560257, 'specificity': 0.560257, 'f1': 0.5968846, 'auroc': 0.90229046, 'binary_precision': 0.7735849, 'binary_recall': 0.121842496, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.21052632}
confusion matrix:
       0   1
0  18043  24
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.99998295, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_18.png
early stop counter: 5
val acc:0.9671825170516968, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 18,now: 2024-06-11 09:09:27.980571,epoch time: 0:17:59.537437,used: 5:29:49.009404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.999679, 'precision': 0.9996151, 'recall': 0.9984739, 'specificity': 0.9984739, 'f1': 0.9990436, 'auroc': 0.99986124, 'binary_precision': 0.9995365, 'binary_recall': 0.9969949, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.998264}
confusion matrix:
       0     1
0  42408     2
1     13  4313
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.82371294, 'recall': 0.5219008, 'specificity': 0.5219008, 'f1': 0.53290534, 'auroc': 0.834566, 'binary_precision': 0.6818182, 'binary_recall': 0.044576522, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.083682}
confusion matrix:
       0   1
0  18053  14
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.99919, 'recall': 0.99863386, 'specificity': 0.99863386, 'f1': 0.99891174, 'auroc': 0.9995488, 'binary_precision': 0.9987163, 'binary_recall': 0.99743587, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99807566}
confusion matrix:
      0    1
0  5945    1
1     2  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_19.png
early stop counter: 6
val acc:0.9649413228034973, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 19,now: 2024-06-11 09:27:58.204604,epoch time: 0:18:30.224033,used: 5:48:19.233437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9966843, 'recall': 0.9987452, 'specificity': 0.9987452, 'f1': 0.9977121, 'auroc': 0.99994457, 'binary_precision': 0.9935573, 'binary_recall': 0.9981507, 'binary_specificity': 0.99933976, 'binary_f1_score': 0.99584866}
confusion matrix:
       0     1
0  42382    28
1      8  4318
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.83589375, 'recall': 0.54534286, 'specificity': 0.54534286, 'f1': 0.5727978, 'auroc': 0.9279511, 'binary_precision': 0.70454544, 'binary_recall': 0.09212481, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.16294348}
confusion matrix:
       0   1
0  18041  26
1    611  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.99998856, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_20.png
early stop counter: 7
val acc:0.9660085439682007, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 20,now: 2024-06-11 09:45:58.702148,epoch time: 0:18:00.497544,used: 6:06:19.730981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99959344, 'precision': 0.9997761, 'recall': 0.99780345, 'specificity': 0.99780345, 'f1': 0.99878734, 'auroc': 0.9999976, 'binary_precision': 1.0, 'binary_recall': 0.99560696, 'binary_specificity': 1.0, 'binary_f1_score': 0.9977987}
confusion matrix:
       0     1
0  42411     0
1     19  4306
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.83664155, 'recall': 0.5124363, 'specificity': 0.5124363, 'f1': 0.51537794, 'auroc': 0.9061717, 'binary_precision': 0.7083333, 'binary_recall': 0.02526003, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.04878049}
confusion matrix:
       0   1
0  18060   7
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99895924, 'precision': 0.99941206, 'recall': 0.99551284, 'specificity': 0.99551284, 'f1': 0.99745214, 'auroc': 0.99987733, 'binary_precision': 1.0, 'binary_recall': 0.9910256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954926}
confusion matrix:
      0    1
0  5946    0
1     7  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_21.png
early stop counter: 8
val acc:0.9646211266517639, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9995539784431458
after epoch: 21,now: 2024-06-11 10:05:10.600496,epoch time: 0:19:11.898348,used: 6:25:31.629329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.999786, 'precision': 0.9996742, 'recall': 0.9990518, 'specificity': 0.9990518, 'f1': 0.99936277, 'auroc': 0.99997103, 'binary_precision': 0.99953705, 'binary_recall': 0.9981507, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9988434}
confusion matrix:
       0     1
0  42408     2
1      8  4318
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.90011954, 'recall': 0.5405574, 'specificity': 0.5405574, 'f1': 0.565865, 'auroc': 0.93291163, 'binary_precision': 0.8333333, 'binary_recall': 0.08172362, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.14884979}
confusion matrix:
       0   1
0  18056  11
1    618  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99970263, 'precision': 0.9998319, 'recall': 0.9987179, 'specificity': 0.9987179, 'f1': 0.9992741, 'auroc': 0.9999931, 'binary_precision': 1.0, 'binary_recall': 0.99743587, 'binary_specificity': 1.0, 'binary_f1_score': 0.9987163}
confusion matrix:
      0    1
0  5946    0
1     2  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_22.png
new oracle model saved
early stop counter: 9
val acc:0.966435432434082, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9997026324272156
after epoch: 22,now: 2024-06-11 10:23:23.263110,epoch time: 0:18:12.662614,used: 6:43:44.291943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99952924, 'precision': 0.9996364, 'recall': 0.997561, 'specificity': 0.997561, 'f1': 0.998596, 'auroc': 0.99999106, 'binary_precision': 0.9997678, 'binary_recall': 0.9951456, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99745136}
confusion matrix:
       0     1
0  42409     1
1     21  4305
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.86370337, 'recall': 0.5396484, 'specificity': 0.5396484, 'f1': 0.56392425, 'auroc': 0.87383986, 'binary_precision': 0.7605634, 'binary_recall': 0.08023774, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.14516129}
confusion matrix:
       0   1
0  18050  17
1    619  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9997755, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_23.png
early stop counter: 10
val acc:0.9660618901252747, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9988105893135071 / 0.9997026324272156
after epoch: 23,now: 2024-06-11 10:41:48.206410,epoch time: 0:18:24.943300,used: 7:02:09.235243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.9960628, 'recall': 0.99925244, 'specificity': 0.99925244, 'f1': 0.9976512, 'auroc': 0.9999927, 'binary_precision': 0.99219644, 'binary_recall': 0.9993065, 'binary_specificity': 0.9991983, 'binary_f1_score': 0.99573874}
confusion matrix:
       0     1
0  42376    34
1      3  4323
---- Validation: 
scalar performance:
{'acc': 0.9719317, 'precision': 0.8933595, 'recall': 0.64068425, 'specificity': 0.64068425, 'f1': 0.7031611, 'auroc': 0.91630334, 'binary_precision': 0.81276596, 'binary_recall': 0.28380385, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.42070484}
confusion matrix:
       0    1
0  18023   44
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99940526, 'precision': 0.99966383, 'recall': 0.9974359, 'specificity': 0.9974359, 'f1': 0.9985465, 'auroc': 0.9999981, 'binary_precision': 1.0, 'binary_recall': 0.9948718, 'binary_specificity': 1.0, 'binary_f1_score': 0.99742925}
confusion matrix:
      0    1
0  5946    0
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_24.png
better model found
persisted
after epoch: 24,now: 2024-06-11 11:00:10.828158,epoch time: 0:18:22.621748,used: 7:20:31.856991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9997218, 'precision': 0.999431, 'recall': 0.99891263, 'specificity': 0.99891263, 'f1': 0.9991717, 'auroc': 0.9999926, 'binary_precision': 0.9990743, 'binary_recall': 0.99791956, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9984966}
confusion matrix:
       0     1
0  42406     4
1      9  4317
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.8711281, 'recall': 0.54556423, 'specificity': 0.54556423, 'f1': 0.5737741, 'auroc': 0.83345294, 'binary_precision': 0.775, 'binary_recall': 0.09212481, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.16467464}
confusion matrix:
       0   1
0  18049  18
1    611  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99940526, 'precision': 0.99966383, 'recall': 0.9974359, 'specificity': 0.9974359, 'f1': 0.9985465, 'auroc': 0.9997883, 'binary_precision': 1.0, 'binary_recall': 0.9948718, 'binary_specificity': 1.0, 'binary_f1_score': 0.99742925}
confusion matrix:
      0    1
0  5946    0
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_25.png
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9997026324272156
after epoch: 25,now: 2024-06-11 11:18:32.943886,epoch time: 0:18:22.115728,used: 7:38:53.972719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9997646, 'precision': 0.99987036, 'recall': 0.99872863, 'specificity': 0.99872863, 'f1': 0.9992987, 'auroc': 0.99983525, 'binary_precision': 1.0, 'binary_recall': 0.9974572, 'binary_specificity': 1.0, 'binary_f1_score': 0.99872696}
confusion matrix:
       0     1
0  42410     0
1     11  4315
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.9132509, 'recall': 0.5494727, 'specificity': 0.5494727, 'f1': 0.580815, 'auroc': 0.87848896, 'binary_precision': 0.85897434, 'binary_recall': 0.09955423, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.17842875}
confusion matrix:
       0   1
0  18056  11
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.9999819, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_26.png
early stop counter: 2
val acc:0.967075765132904, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9997026324272156
after epoch: 26,now: 2024-06-11 11:36:47.677822,epoch time: 0:18:14.733936,used: 7:57:08.706655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.999679, 'precision': 0.99919975, 'recall': 0.9988888, 'specificity': 0.9988888, 'f1': 0.99904424, 'auroc': 0.9999583, 'binary_precision': 0.99861175, 'binary_recall': 0.9979191, 'binary_specificity': 0.9998585, 'binary_f1_score': 0.9982653}
confusion matrix:
       0     1
0  42405     6
1      9  4316
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.8532829, 'recall': 0.53959304, 'specificity': 0.53959304, 'f1': 0.563702, 'auroc': 0.9201852, 'binary_precision': 0.739726, 'binary_recall': 0.08023774, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.14477211}
confusion matrix:
       0   1
0  18048  19
1    619  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.9997536, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_27.png
early stop counter: 3
val acc:0.9659551978111267, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9997026324272156
after epoch: 27,now: 2024-06-11 11:54:42.286936,epoch time: 0:17:54.609114,used: 8:15:03.315769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99965763, 'precision': 0.9998114, 'recall': 0.9981503, 'specificity': 0.9981503, 'f1': 0.9989791, 'auroc': 0.9999572, 'binary_precision': 1.0, 'binary_recall': 0.9963006, 'binary_specificity': 1.0, 'binary_f1_score': 0.99814683}
confusion matrix:
       0     1
0  42411     0
1     16  4309
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.8156803, 'recall': 0.50874925, 'specificity': 0.50874925, 'f1': 0.5083009, 'auroc': 0.8643038, 'binary_precision': 0.6666667, 'binary_recall': 0.017830608, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.03473227}
confusion matrix:
       0   1
0  18061   6
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.99999696, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_28.png
early stop counter: 4
val acc:0.9644076824188232, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9997026324272156
after epoch: 28,now: 2024-06-11 12:12:37.527786,epoch time: 0:17:55.240850,used: 8:32:58.556619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99963623, 'precision': 0.99979967, 'recall': 0.9980347, 'specificity': 0.9980347, 'f1': 0.9989152, 'auroc': 0.99997675, 'binary_precision': 1.0, 'binary_recall': 0.9960694, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980308}
confusion matrix:
       0     1
0  42411     0
1     17  4308
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.88505244, 'recall': 0.53018385, 'specificity': 0.53018385, 'f1': 0.54789656, 'auroc': 0.90210104, 'binary_precision': 0.8039216, 'binary_recall': 0.060921248, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.11325967}
confusion matrix:
       0   1
0  18057  10
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99985135, 'precision': 0.99991596, 'recall': 0.999359, 'specificity': 0.999359, 'f1': 0.99963725, 'auroc': 0.99999976, 'binary_precision': 1.0, 'binary_recall': 0.99871796, 'binary_specificity': 1.0, 'binary_f1_score': 0.99935853}
confusion matrix:
      0    1
0  5946    0
1     1  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_29.png
new oracle model saved
early stop counter: 5
val acc:0.965741753578186, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9998513460159302
after epoch: 29,now: 2024-06-11 12:30:39.531551,epoch time: 0:18:02.003765,used: 8:51:00.560384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.999893, 'precision': 0.99994105, 'recall': 0.9994221, 'specificity': 0.9994221, 'f1': 0.9996814, 'auroc': 0.9999821, 'binary_precision': 1.0, 'binary_recall': 0.9988442, 'binary_specificity': 1.0, 'binary_f1_score': 0.9994218}
confusion matrix:
       0     1
0  42410     0
1      5  4321
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.8707683, 'recall': 0.52792734, 'specificity': 0.52792734, 'f1': 0.54384434, 'auroc': 0.9068155, 'binary_precision': 0.7755102, 'binary_recall': 0.056463595, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.10526316}
confusion matrix:
       0   1
0  18056  11
1    635  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99970263, 'precision': 0.99927485, 'recall': 0.99927485, 'specificity': 0.99927485, 'f1': 0.99927485, 'auroc': 0.9999982, 'binary_precision': 0.99871796, 'binary_recall': 0.99871796, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99871796}
confusion matrix:
      0    1
0  5945    1
1     1  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_30.png
early stop counter: 6
val acc:0.9655283093452454, best validation acc: 0.9719316959381104, corresponding to test acc:                         0.9994052648544312 / 0.9998513460159302
after epoch: 30,now: 2024-06-11 12:48:47.881273,epoch time: 0:18:08.349722,used: 9:09:08.910106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_03_39_38_seed_1_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:09:08.910106 at 2024-06-11 12:48:47.881273
persisted model performance metric: 

scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.9999913, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
oracle model performance metric: 

scalar performance:
{'acc': 0.999554, 'precision': 0.99919, 'recall': 0.99863386, 'specificity': 0.99863386, 'f1': 0.99891174, 'auroc': 0.99999934, 'binary_precision': 0.9987163, 'binary_recall': 0.99743587, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99807566}
confusion matrix:
      0    1
0  5945    1
1     2  778
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486962 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |  89906 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486962 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |  89906 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |   1821 MiB |   2923 TiB |   2923 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   2917 TiB |   2917 TiB |
|       from small pool |  88755 KiB |    122 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2030 MiB |   2106 MiB |   2808 MiB |    778 MiB |
|       from large pool |   1904 MiB |   1982 MiB |   2654 MiB |    750 MiB |
|       from small pool |    126 MiB |    126 MiB |    154 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1124 MiB |   1127 MiB |   1525 TiB |   1525 TiB |
|       from large pool |   1116 MiB |   1118 MiB |   1517 TiB |   1517 TiB |
|       from small pool |      8 MiB |     28 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7068    |  269046 K  |  269042 K  |
|       from large pool |      87    |     178    |  115907 K  |  115907 K  |
|       from small pool |    3816    |    6980    |  153139 K  |  153135 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7068    |  269046 K  |  269042 K  |
|       from large pool |      87    |     178    |  115907 K  |  115907 K  |
|       from small pool |    3816    |    6980    |  153139 K  |  153135 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      95    |     115    |      24    |
|       from large pool |      28    |      33    |      38    |      10    |
|       from small pool |      63    |      63    |      77    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    2951    |  112658 K  |  112658 K  |
|       from large pool |      21    |      25    |   41852 K  |   41852 K  |
|       from small pool |      34    |    2931    |   70806 K  |   70806 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2923 TiB |   2923 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2917 TiB |   2917 TiB |
|       from small pool |      0 KiB |    122 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1600 MiB |   2106 MiB |   2808 MiB |   1208 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     96 MiB |    126 MiB |    154 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1199 MiB |   1525 TiB |   1525 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1517 TiB |   1517 TiB |
|       from small pool |      0 KiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7068    |  269046 K  |  269046 K  |
|       from large pool |       2    |     178    |  115907 K  |  115907 K  |
|       from small pool |       0    |    6980    |  153139 K  |  153139 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7068    |  269046 K  |  269046 K  |
|       from large pool |       2    |     178    |  115907 K  |  115907 K  |
|       from small pool |       0    |    6980    |  153139 K  |  153139 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |      95    |     115    |      42    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      48    |      63    |      77    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2951    |  112659 K  |  112659 K  |
|       from large pool |       4    |      27    |   41852 K  |   41852 K  |
|       from small pool |       0    |    2931    |   70807 K  |   70807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2935 TiB |   2935 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2928 TiB |   2928 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2923 TiB |   2923 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2917 TiB |   2917 TiB |
|       from small pool |      0 KiB |    122 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1600 MiB |   2106 MiB |   2808 MiB |   1208 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     96 MiB |    126 MiB |    154 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1199 MiB |   1525 TiB |   1525 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1517 TiB |   1517 TiB |
|       from small pool |      0 KiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7068    |  269046 K  |  269046 K  |
|       from large pool |       2    |     178    |  115907 K  |  115907 K  |
|       from small pool |       0    |    6980    |  153139 K  |  153139 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7068    |  269046 K  |  269046 K  |
|       from large pool |       2    |     178    |  115907 K  |  115907 K  |
|       from small pool |       0    |    6980    |  153139 K  |  153139 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |      95    |     115    |      42    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      48    |      63    |      77    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2951    |  112659 K  |  112659 K  |
|       from large pool |       4    |      27    |   41852 K  |   41852 K  |
|       from small pool |       0    |    2931    |   70807 K  |   70807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200

 Experiment start at: 2024-06-11 12:55:04.917757
before training, model accuracy: 0.17283949255943298
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9957309, 'precision': 0.9917181, 'recall': 0.9837707, 'specificity': 0.9837707, 'f1': 0.9877033, 'auroc': 0.99903667, 'binary_precision': 0.9867624, 'binary_recall': 0.9689359, 'binary_specificity': 0.9986055, 'binary_f1_score': 0.97776794}
confusion matrix:
       0     1
0  42250    59
1    141  4398
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96612155, 'precision': 0.70693296, 'recall': 0.59864247, 'specificity': 0.59864247, 'f1': 0.63159764, 'auroc': 0.8684236, 'binary_precision': 0.4397163, 'binary_recall': 0.20598006, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.28054297}
confusion matrix:
       0    1
0  18013  158
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934553, 'precision': 0.99190176, 'recall': 0.9739343, 'specificity': 0.9739343, 'f1': 0.98269916, 'auroc': 0.9971808, 'binary_precision': 0.98994255, 'binary_recall': 0.9490358, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.9690576}
confusion matrix:
      0    1
0  5990    7
1    37  689
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 13:14:19.262314,epoch time: 0:19:14.344557,used: 0:19:14.344557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9979081, 'precision': 0.9953766, 'recall': 0.9926465, 'specificity': 0.9926465, 'f1': 0.99400675, 'auroc': 0.9996146, 'binary_precision': 0.9922412, 'binary_recall': 0.9861203, 'binary_specificity': 0.99917275, 'binary_f1_score': 0.98917127}
confusion matrix:
       0     1
0  42274    35
1     63  4476
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74741066, 'recall': 0.588583, 'specificity': 0.588583, 'f1': 0.62722963, 'auroc': 0.9051631, 'binary_precision': 0.521327, 'binary_recall': 0.18272425, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.27060273}
confusion matrix:
       0    1
0  18070  101
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.9966706, 'recall': 0.98399305, 'specificity': 0.98399305, 'f1': 0.9902245, 'auroc': 0.998876, 'binary_precision': 0.9971631, 'binary_recall': 0.96831954, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.98252964}
confusion matrix:
      0    1
0  5995    2
1    23  703
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 13:33:24.388073,epoch time: 0:19:05.125759,used: 0:38:19.470316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9978014, 'precision': 0.9982821, 'recall': 0.9891456, 'specificity': 0.9891456, 'f1': 0.99366033, 'auroc': 0.9993256, 'binary_precision': 0.9988754, 'binary_recall': 0.97840935, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9885365}
confusion matrix:
       0     1
0  42304     5
1     98  4441
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73988605, 'recall': 0.5193007, 'specificity': 0.5193007, 'f1': 0.52883565, 'auroc': 0.90902823, 'binary_precision': 0.5106383, 'binary_recall': 0.03986711, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.07395995}
confusion matrix:
       0   1
0  18148  23
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99796605, 'recall': 0.9888973, 'specificity': 0.9888973, 'f1': 0.9933771, 'auroc': 0.9996165, 'binary_precision': 0.9985935, 'binary_recall': 0.9779614, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9881698}
confusion matrix:
      0    1
0  5996    1
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_3.png
new oracle model saved
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9962814450263977 / 0.9974713921546936
after epoch: 3,now: 2024-06-11 13:52:49.083364,epoch time: 0:19:24.695291,used: 0:57:44.165607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9986125, 'precision': 0.99569595, 'recall': 0.99637866, 'specificity': 0.99637866, 'f1': 0.996037, 'auroc': 0.9998087, 'binary_precision': 0.99207747, 'binary_recall': 0.9936081, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.99284226}
confusion matrix:
       0     1
0  42275    36
1     29  4508
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.76270866, 'recall': 0.5582047, 'specificity': 0.5582047, 'f1': 0.5903745, 'auroc': 0.89226675, 'binary_precision': 0.5538462, 'binary_recall': 0.11960133, 'binary_specificity': 0.9968081, 'binary_f1_score': 0.19672133}
confusion matrix:
       0   1
0  18113  58
1    530  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.9917881, 'recall': 0.9935732, 'specificity': 0.9935732, 'f1': 0.9926785, 'auroc': 0.99948, 'binary_precision': 0.98491085, 'binary_recall': 0.9889807, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.98694164}
confusion matrix:
      0    1
0  5986   11
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_4.png
better model found
persisted
after epoch: 4,now: 2024-06-11 14:11:21.952165,epoch time: 0:18:32.868801,used: 1:16:17.034408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99812156, 'precision': 0.9929165, 'recall': 0.9964032, 'specificity': 0.9964032, 'f1': 0.99465203, 'auroc': 0.99987435, 'binary_precision': 0.9864481, 'binary_recall': 0.9942719, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.99034446}
confusion matrix:
       0     1
0  42247    62
1     26  4513
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.73127896, 'recall': 0.57698256, 'specificity': 0.57698256, 'f1': 0.6120554, 'auroc': 0.9134294, 'binary_precision': 0.48979592, 'binary_recall': 0.15946844, 'binary_specificity': 0.9944967, 'binary_f1_score': 0.24060151}
confusion matrix:
       0    1
0  18071  100
1    506   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.99733925, 'recall': 0.99492896, 'specificity': 0.99492896, 'f1': 0.9961302, 'auroc': 0.9998413, 'binary_precision': 0.9958449, 'binary_recall': 0.9903581, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.99309397}
confusion matrix:
      0    1
0  5994    3
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_5.png
new oracle model saved
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9971739053726196 / 0.9985125660896301
after epoch: 5,now: 2024-06-11 14:29:54.574710,epoch time: 0:18:32.622545,used: 1:34:49.656953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.9965879, 'recall': 0.9975643, 'specificity': 0.9975643, 'f1': 0.99707556, 'auroc': 0.9997864, 'binary_precision': 0.993625, 'binary_recall': 0.9958141, 'binary_specificity': 0.99931455, 'binary_f1_score': 0.9947184}
confusion matrix:
       0     1
0  42280    29
1     19  4520
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.8477448, 'recall': 0.5852781, 'specificity': 0.5852781, 'f1': 0.6321004, 'auroc': 0.9092668, 'binary_precision': 0.7222222, 'binary_recall': 0.17275748, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.27882037}
confusion matrix:
       0    1
0  18131   40
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.99894863, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_6.png
better model found
persisted
after epoch: 6,now: 2024-06-11 14:48:48.258590,epoch time: 0:18:53.683880,used: 1:53:43.340833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99908215, 'precision': 0.9989964, 'recall': 0.995754, 'specificity': 0.995754, 'f1': 0.9973685, 'auroc': 0.9999387, 'binary_precision': 0.9988901, 'binary_recall': 0.99162626, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9952449}
confusion matrix:
       0     1
0  42305     5
1     38  4500
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.76351106, 'recall': 0.5274963, 'specificity': 0.5274963, 'f1': 0.54321605, 'auroc': 0.8560449, 'binary_precision': 0.55737704, 'binary_recall': 0.056478404, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.102564104}
confusion matrix:
       0   1
0  18144  27
1    568  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9977746, 'recall': 0.9929462, 'specificity': 0.9929462, 'f1': 0.995345, 'auroc': 0.9987875, 'binary_precision': 0.9972145, 'binary_recall': 0.9862259, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9916898}
confusion matrix:
      0    1
0  5995    2
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_7.png
early stop counter: 1
val acc:0.9683055281639099, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9985125660896301
after epoch: 7,now: 2024-06-11 15:08:50.441247,epoch time: 0:20:02.182657,used: 2:13:45.523490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9985485, 'precision': 0.99479496, 'recall': 0.99693465, 'specificity': 0.99693465, 'f1': 0.9958618, 'auroc': 0.99996567, 'binary_precision': 0.99013376, 'binary_recall': 0.99493283, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.9925275}
confusion matrix:
       0     1
0  42264    45
1     23  4516
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7365056, 'recall': 0.6588935, 'specificity': 0.6588935, 'f1': 0.6893134, 'auroc': 0.9153777, 'binary_precision': 0.495, 'binary_recall': 0.32890365, 'binary_specificity': 0.9888834, 'binary_f1_score': 0.39520955}
confusion matrix:
       0    1
0  17969  202
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99120796, 'recall': 0.99417853, 'specificity': 0.99417853, 'f1': 0.99268734, 'auroc': 0.99969816, 'binary_precision': 0.9835841, 'binary_recall': 0.9903581, 'binary_specificity': 0.997999, 'binary_f1_score': 0.9869595}
confusion matrix:
      0    1
0  5985   12
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_8.png
early stop counter: 2
val acc:0.9677196145057678, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9985125660896301
after epoch: 8,now: 2024-06-11 15:28:16.084826,epoch time: 0:19:25.643579,used: 2:33:11.167069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.9969033, 'recall': 0.9974896, 'specificity': 0.9974896, 'f1': 0.99719626, 'auroc': 0.99957126, 'binary_precision': 0.99427944, 'binary_recall': 0.9955937, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.99493617}
confusion matrix:
       0     1
0  42283    26
1     20  4519
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.81141144, 'recall': 0.5832042, 'specificity': 0.5832042, 'f1': 0.6268439, 'auroc': 0.9139458, 'binary_precision': 0.6496815, 'binary_recall': 0.16943522, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.26877472}
confusion matrix:
       0    1
0  18116   55
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999405, 'precision': 0.9984559, 'recall': 0.9984559, 'specificity': 0.9984559, 'f1': 0.9984559, 'auroc': 0.99999726, 'binary_precision': 0.9972452, 'binary_recall': 0.9972452, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9972452}
confusion matrix:
      0    1
0  5995    2
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_9.png
new oracle model saved
early stop counter: 3
val acc:0.9704362750053406, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.999405026435852
after epoch: 9,now: 2024-06-11 15:48:09.336724,epoch time: 0:19:53.251898,used: 2:53:04.418967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9994237, 'precision': 0.9996811, 'recall': 0.9970258, 'specificity': 0.9970258, 'f1': 0.99834895, 'auroc': 0.9999547, 'binary_precision': 1.0, 'binary_recall': 0.9940516, 'binary_specificity': 1.0, 'binary_f1_score': 0.9970169}
confusion matrix:
       0     1
0  42309     0
1     27  4512
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.62040055, 'recall': 0.5022716, 'specificity': 0.5022716, 'f1': 0.49667642, 'auroc': 0.8657001, 'binary_precision': 0.27272728, 'binary_recall': 0.004983389, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.009787928}
confusion matrix:
       0  1
0  18163  8
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.9986384, 'recall': 0.99440694, 'specificity': 0.99440694, 'f1': 0.99651086, 'auroc': 0.9998826, 'binary_precision': 0.9986092, 'binary_recall': 0.9889807, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9937717}
confusion matrix:
      0    1
0  5996    1
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_10.png
early stop counter: 4
val acc:0.9676663279533386, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.999405026435852
after epoch: 10,now: 2024-06-11 16:09:11.150790,epoch time: 0:21:01.814066,used: 3:14:06.233033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9996371, 'precision': 0.99960184, 'recall': 0.99832404, 'specificity': 0.99832404, 'f1': 0.9989619, 'auroc': 0.999863, 'binary_precision': 0.9995581, 'binary_recall': 0.9966953, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99812466}
confusion matrix:
       0     1
0  42307     2
1     15  4524
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.65075344, 'recall': 0.50387764, 'specificity': 0.50387764, 'f1': 0.49988526, 'auroc': 0.8676571, 'binary_precision': 0.33333334, 'binary_recall': 0.008305647, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.016207455}
confusion matrix:
       0   1
0  18161  10
1    597   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.99976206, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_11.png
early stop counter: 5
val acc:0.9676663279533386, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.999405026435852
after epoch: 11,now: 2024-06-11 16:32:45.656515,epoch time: 0:23:34.505725,used: 3:37:40.738758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99965847, 'precision': 0.9989263, 'recall': 0.9991225, 'specificity': 0.9991225, 'f1': 0.9990244, 'auroc': 0.9999871, 'binary_precision': 0.9980181, 'binary_recall': 0.9984578, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.99823785}
confusion matrix:
       0     1
0  42300     9
1      7  4532
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7127485, 'recall': 0.516754, 'specificity': 0.516754, 'f1': 0.5241956, 'auroc': 0.9161309, 'binary_precision': 0.45652175, 'binary_recall': 0.034883723, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.06481481}
confusion matrix:
       0   1
0  18146  25
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99225634, 'recall': 0.9970168, 'specificity': 0.9970168, 'f1': 0.9946214, 'auroc': 0.99978507, 'binary_precision': 0.9850136, 'binary_recall': 0.9958678, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.9904109}
confusion matrix:
      0    1
0  5986   11
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_12.png
early stop counter: 6
val acc:0.9677196145057678, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.999405026435852
after epoch: 12,now: 2024-06-11 16:51:33.695553,epoch time: 0:18:48.039038,used: 3:56:28.777796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9997652, 'precision': 0.9997715, 'recall': 0.9988866, 'specificity': 0.9988866, 'f1': 0.9993285, 'auroc': 0.9997176, 'binary_precision': 0.9997792, 'binary_recall': 0.9977969, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99878705}
confusion matrix:
       0     1
0  42308     1
1     10  4529
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.8121536, 'recall': 0.5293775, 'specificity': 0.5293775, 'f1': 0.5468653, 'auroc': 0.9258022, 'binary_precision': 0.6545454, 'binary_recall': 0.059800666, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.10958903}
confusion matrix:
       0   1
0  18152  19
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.9988067, 'recall': 0.9957844, 'specificity': 0.9957844, 'f1': 0.9972895, 'auroc': 0.9999757, 'binary_precision': 0.99861306, 'binary_recall': 0.9917355, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99516237}
confusion matrix:
      0    1
0  5996    1
1     6  720
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_13.png
early stop counter: 7
val acc:0.9688382148742676, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.999405026435852
after epoch: 13,now: 2024-06-11 17:10:05.930908,epoch time: 0:18:32.235355,used: 4:15:01.013151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9996798, 'precision': 0.9998228, 'recall': 0.99834764, 'specificity': 0.99834764, 'f1': 0.9990838, 'auroc': 0.99995685, 'binary_precision': 1.0, 'binary_recall': 0.9966953, 'binary_specificity': 1.0, 'binary_f1_score': 0.9983449}
confusion matrix:
       0     1
0  42309     0
1     15  4524
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7250307, 'recall': 0.5104121, 'specificity': 0.5104121, 'f1': 0.51250076, 'auroc': 0.9217802, 'binary_precision': 0.4814815, 'binary_recall': 0.021594685, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.041335452}
confusion matrix:
       0   1
0  18157  14
1    589  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.9991436, 'recall': 0.9985392, 'specificity': 0.9985392, 'f1': 0.99884117, 'auroc': 0.99999106, 'binary_precision': 0.9986207, 'binary_recall': 0.9972452, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9979325}
confusion matrix:
      0    1
0  5996    1
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_14.png
new oracle model saved
early stop counter: 8
val acc:0.9678794145584106, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9995537996292114
after epoch: 14,now: 2024-06-11 17:28:43.700393,epoch time: 0:18:37.769485,used: 4:33:38.782636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9996371, 'precision': 0.9997005, 'recall': 0.9982257, 'specificity': 0.9982257, 'f1': 0.9989617, 'auroc': 0.99972105, 'binary_precision': 0.999779, 'binary_recall': 0.996475, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99812424}
confusion matrix:
       0     1
0  42308     1
1     16  4523
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.7030625, 'recall': 0.5111326, 'specificity': 0.5111326, 'f1': 0.5138733, 'auroc': 0.91642284, 'binary_precision': 0.4375, 'binary_recall': 0.023255814, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.04416404}
confusion matrix:
       0   1
0  18153  18
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.9992998, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_15.png
early stop counter: 9
val acc:0.9677196145057678, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9995537996292114
after epoch: 15,now: 2024-06-11 17:49:20.674475,epoch time: 0:20:36.974082,used: 4:54:15.756718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9997439, 'precision': 0.9997596, 'recall': 0.9987762, 'specificity': 0.9987762, 'f1': 0.9992673, 'auroc': 0.9999981, 'binary_precision': 0.99977916, 'binary_recall': 0.997576, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99867636}
confusion matrix:
       0     1
0  42309     1
1     11  4527
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.724265, 'recall': 0.50960904, 'specificity': 0.50960904, 'f1': 0.51097226, 'auroc': 0.885738, 'binary_precision': 0.48, 'binary_recall': 0.019933555, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.038277514}
confusion matrix:
       0   1
0  18158  13
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.9999895, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_16.png
early stop counter: 10
val acc:0.9678794145584106, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9995537996292114
after epoch: 16,now: 2024-06-11 18:08:32.004327,epoch time: 0:19:11.329852,used: 5:13:27.086570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9995304, 'precision': 0.9997401, 'recall': 0.9975766, 'specificity': 0.9975766, 'f1': 0.9986554, 'auroc': 0.99990857, 'binary_precision': 1.0, 'binary_recall': 0.9951531, 'binary_specificity': 1.0, 'binary_f1_score': 0.99757063}
confusion matrix:
       0     1
0  42309     0
1     22  4517
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.85919595, 'recall': 0.5073925, 'specificity': 0.5073925, 'f1': 0.5065891, 'auroc': 0.88902277, 'binary_precision': 0.75, 'binary_recall': 0.014950166, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.029315962}
confusion matrix:
       0  1
0  18168  3
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.99999964, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_17.png
early stop counter: 11
val acc:0.9682523012161255, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9995537996292114
after epoch: 17,now: 2024-06-11 18:27:18.818617,epoch time: 0:18:46.814290,used: 5:32:13.900860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9997225, 'precision': 0.99984646, 'recall': 0.99856794, 'specificity': 0.99856794, 'f1': 0.9992062, 'auroc': 0.9999292, 'binary_precision': 1.0, 'binary_recall': 0.99713594, 'binary_specificity': 1.0, 'binary_f1_score': 0.998566}
confusion matrix:
       0     1
0  42309     0
1     13  4526
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.9290278, 'recall': 0.519851, 'specificity': 0.519851, 'f1': 0.5302868, 'auroc': 0.90503764, 'binary_precision': 0.8888889, 'binary_recall': 0.03986711, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0763116}
confusion matrix:
       0   1
0  18168   3
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9998513, 'precision': 0.9999167, 'recall': 0.9993113, 'specificity': 0.9993113, 'f1': 0.9996137, 'auroc': 0.99999106, 'binary_precision': 1.0, 'binary_recall': 0.9986226, 'binary_specificity': 1.0, 'binary_f1_score': 0.9993108}
confusion matrix:
      0    1
0  5997    0
1     1  725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_18.png
new oracle model saved
early stop counter: 12
val acc:0.9690513014793396, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 18,now: 2024-06-11 18:46:12.149470,epoch time: 0:18:53.330853,used: 5:51:07.231713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9995517, 'precision': 0.9987682, 'recall': 0.9986701, 'specificity': 0.9986701, 'f1': 0.99871916, 'auroc': 0.9999656, 'binary_precision': 0.99779636, 'binary_recall': 0.99757653, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.99768645}
confusion matrix:
       0     1
0  42299    10
1     11  4528
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.8257013, 'recall': 0.5555979, 'specificity': 0.5555979, 'f1': 0.58918506, 'auroc': 0.92392707, 'binary_precision': 0.68, 'binary_recall': 0.11295681, 'binary_specificity': 0.998239, 'binary_f1_score': 0.19373219}
confusion matrix:
       0   1
0  18139  32
1    534  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.9991436, 'recall': 0.9985392, 'specificity': 0.9985392, 'f1': 0.99884117, 'auroc': 0.99999815, 'binary_precision': 0.9986207, 'binary_recall': 0.9972452, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9979325}
confusion matrix:
      0    1
0  5996    1
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_19.png
early stop counter: 13
val acc:0.9698503017425537, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 19,now: 2024-06-11 19:04:40.836315,epoch time: 0:18:28.686845,used: 6:09:35.918558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99933827, 'precision': 0.99953485, 'recall': 0.9966835, 'specificity': 0.9966835, 'f1': 0.998104, 'auroc': 0.99979806, 'binary_precision': 0.9997783, 'binary_recall': 0.9933906, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9965743}
confusion matrix:
       0     1
0  42308     1
1     30  4509
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.59512305, 'recall': 0.50146854, 'specificity': 0.50146854, 'f1': 0.49505618, 'auroc': 0.8644426, 'binary_precision': 0.22222222, 'binary_recall': 0.003322259, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.0065466445}
confusion matrix:
       0  1
0  18164  7
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9997025, 'precision': 0.99983335, 'recall': 0.9986226, 'specificity': 0.9986226, 'f1': 0.999227, 'auroc': 0.99986655, 'binary_precision': 1.0, 'binary_recall': 0.9972452, 'binary_specificity': 1.0, 'binary_f1_score': 0.9986207}
confusion matrix:
      0    1
0  5997    0
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_20.png
early stop counter: 14
val acc:0.9676663279533386, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 20,now: 2024-06-11 19:23:33.798732,epoch time: 0:18:52.962417,used: 6:28:28.880975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9995731, 'precision': 0.9997637, 'recall': 0.9977969, 'specificity': 0.9977969, 'f1': 0.99877787, 'auroc': 0.99997556, 'binary_precision': 1.0, 'binary_recall': 0.9955937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99779195}
confusion matrix:
       0     1
0  42309     0
1     20  4519
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7841934, 'recall': 0.50731, 'specificity': 0.50731, 'f1': 0.5064765, 'auroc': 0.92864764, 'binary_precision': 0.6, 'binary_recall': 0.014950166, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.02917342}
confusion matrix:
       0  1
0  18165  6
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.99997056, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_21.png
early stop counter: 15
val acc:0.9680925011634827, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 21,now: 2024-06-11 19:42:08.914572,epoch time: 0:18:35.115840,used: 6:47:03.996815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9995517, 'precision': 0.99818265, 'recall': 0.9992601, 'specificity': 0.9992601, 'f1': 0.99872065, 'auroc': 0.9999992, 'binary_precision': 0.9964835, 'binary_recall': 0.99889845, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.9976895}
confusion matrix:
       0     1
0  42293    16
1      5  4534
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7089445, 'recall': 0.5374406, 'specificity': 0.5374406, 'f1': 0.5581581, 'auroc': 0.90977645, 'binary_precision': 0.44761905, 'binary_recall': 0.07807309, 'binary_specificity': 0.9968081, 'binary_f1_score': 0.13295615}
confusion matrix:
       0   1
0  18113  58
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.9884609, 'recall': 0.9978939, 'specificity': 0.9978939, 'f1': 0.9931178, 'auroc': 0.99998534, 'binary_precision': 0.9770889, 'binary_recall': 0.9986226, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.9877384}
confusion matrix:
      0    1
0  5980   17
1     1  725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_22.png
early stop counter: 16
val acc:0.967346727848053, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 22,now: 2024-06-11 20:00:38.110381,epoch time: 0:18:29.195809,used: 7:05:33.192624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9995517, 'precision': 0.9996531, 'recall': 0.99778503, 'specificity': 0.99778503, 'f1': 0.99871683, 'auroc': 0.99998844, 'binary_precision': 0.99977875, 'binary_recall': 0.9955937, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9976818}
confusion matrix:
       0     1
0  42308     1
1     20  4519
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.86791813, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.99870676, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_23.png
early stop counter: 17
val acc:0.9677196145057678, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 23,now: 2024-06-11 20:19:04.802739,epoch time: 0:18:26.692358,used: 7:23:59.884982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9997225, 'precision': 0.99984646, 'recall': 0.99856794, 'specificity': 0.99856794, 'f1': 0.9992062, 'auroc': 0.9999668, 'binary_precision': 1.0, 'binary_recall': 0.99713594, 'binary_specificity': 1.0, 'binary_f1_score': 0.998566}
confusion matrix:
       0     1
0  42309     0
1     13  4526
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.8733922, 'recall': 0.51727676, 'specificity': 0.51727676, 'f1': 0.52543604, 'auroc': 0.9170222, 'binary_precision': 0.7777778, 'binary_recall': 0.034883723, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.066772655}
confusion matrix:
       0   1
0  18165   6
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9997025, 'precision': 0.99983335, 'recall': 0.9986226, 'specificity': 0.9986226, 'f1': 0.999227, 'auroc': 0.99996674, 'binary_precision': 1.0, 'binary_recall': 0.9972452, 'binary_specificity': 1.0, 'binary_f1_score': 0.9986207}
confusion matrix:
      0    1
0  5997    0
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_24.png
early stop counter: 18
val acc:0.968731701374054, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 24,now: 2024-06-11 20:37:38.413138,epoch time: 0:18:33.610399,used: 7:42:33.495381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99965847, 'precision': 0.999811, 'recall': 0.9982375, 'specificity': 0.9982375, 'f1': 0.99902266, 'auroc': 0.9999907, 'binary_precision': 1.0, 'binary_recall': 0.996475, 'binary_specificity': 1.0, 'binary_f1_score': 0.9982344}
confusion matrix:
       0     1
0  42309     0
1     16  4523
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.6507053, 'recall': 0.5023266, 'specificity': 0.5023266, 'f1': 0.49671993, 'auroc': 0.8128989, 'binary_precision': 0.33333334, 'binary_recall': 0.004983389, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.009819968}
confusion matrix:
       0  1
0  18165  6
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99910754, 'precision': 0.9995003, 'recall': 0.9958677, 'specificity': 0.9958677, 'f1': 0.9976753, 'auroc': 0.99966717, 'binary_precision': 1.0, 'binary_recall': 0.9917355, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958506}
confusion matrix:
      0    1
0  5997    0
1     6  720
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_25.png
early stop counter: 19
val acc:0.9677728414535522, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 25,now: 2024-06-11 20:56:06.961044,epoch time: 0:18:28.547906,used: 8:01:02.043287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9994877, 'precision': 0.9989282, 'recall': 0.99814296, 'specificity': 0.99814296, 'f1': 0.99853516, 'auroc': 0.9999969, 'binary_precision': 0.9982344, 'binary_recall': 0.996475, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9973539}
confusion matrix:
       0     1
0  42301     8
1     16  4523
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7728057, 'recall': 0.5121558, 'specificity': 0.5121558, 'f1': 0.51578635, 'auroc': 0.89710814, 'binary_precision': 0.5769231, 'binary_recall': 0.024916943, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0477707}
confusion matrix:
       0   1
0  18160  11
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9998513, 'precision': 0.9999167, 'recall': 0.9993113, 'specificity': 0.9993113, 'f1': 0.9996137, 'auroc': 0.9999871, 'binary_precision': 1.0, 'binary_recall': 0.9986226, 'binary_specificity': 1.0, 'binary_f1_score': 0.9993108}
confusion matrix:
      0    1
0  5997    0
1     1  725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277200_26.png
early stop counter: 20
val acc:0.9681457281112671, best validation acc: 0.9713418483734131, corresponding to test acc:                         0.9979175925254822 / 0.9998512864112854
after epoch: 26,now: 2024-06-11 21:14:41.403246,epoch time: 0:18:34.442202,used: 8:19:36.485489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_12_55_04_seed_2_21277200
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 26 with time: 8:19:36.485489 at 2024-06-11 21:14:41.403246
persisted model performance metric: 

scalar performance:
{'acc': 0.99910754, 'precision': 0.9970859, 'recall': 0.9982891, 'specificity': 0.9982891, 'f1': 0.99768656, 'auroc': 0.9999467, 'binary_precision': 0.99450547, 'binary_recall': 0.9972452, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9958734}
confusion matrix:
      0    1
0  5993    4
1     2  724
oracle model performance metric: 

scalar performance:
{'acc': 0.9995538, 'precision': 0.99975, 'recall': 0.99793386, 'specificity': 0.99793386, 'f1': 0.99883974, 'auroc': 0.9999888, 'binary_precision': 1.0, 'binary_recall': 0.9958678, 'binary_specificity': 1.0, 'binary_f1_score': 0.99792963}
confusion matrix:
      0    1
0  5997    0
1     3  723
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486194 KiB |   1837 MiB |   4229 TiB |   4229 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4219 TiB |   4219 TiB |
|       from small pool |  89906 KiB |    123 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486194 KiB |   1837 MiB |   4229 TiB |   4229 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4219 TiB |   4219 TiB |
|       from small pool |  89906 KiB |    123 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |   1821 MiB |   4215 TiB |   4215 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   4205 TiB |   4205 TiB |
|       from small pool |  88755 KiB |    122 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2046 MiB |   2106 MiB |   3254 MiB |   1208 MiB |
|       from large pool |   1920 MiB |   1982 MiB |   3070 MiB |   1150 MiB |
|       from small pool |    126 MiB |    126 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1013 MiB |   1199 MiB |   2223 TiB |   2223 TiB |
|       from large pool |   1005 MiB |   1178 MiB |   2212 TiB |   2212 TiB |
|       from small pool |      8 MiB |     30 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7082    |  387879 K  |  387875 K  |
|       from large pool |      87    |     178    |  167099 K  |  167099 K  |
|       from small pool |    3816    |    6994    |  220780 K  |  220776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7082    |  387879 K  |  387875 K  |
|       from large pool |      87    |     178    |  167099 K  |  167099 K  |
|       from small pool |    3816    |    6994    |  220780 K  |  220776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      91    |      95    |     133    |      42    |
|       from large pool |      28    |      33    |      41    |      13    |
|       from small pool |      63    |      63    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    2956    |  162358 K  |  162358 K  |
|       from large pool |      18    |      27    |   60643 K  |   60643 K  |
|       from small pool |      34    |    2938    |  101714 K  |  101714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   4229 TiB |   4229 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4219 TiB |   4219 TiB |
|       from small pool |      0 KiB |    123 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   4229 TiB |   4229 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4219 TiB |   4219 TiB |
|       from small pool |      0 KiB |    123 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   4215 TiB |   4215 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   4205 TiB |   4205 TiB |
|       from small pool |      0 KiB |    122 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1488 MiB |   2106 MiB |   3254 MiB |   1766 MiB |
|       from large pool |   1392 MiB |   1982 MiB |   3070 MiB |   1678 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1199 MiB |   2223 TiB |   2223 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   2212 TiB |   2212 TiB |
|       from small pool |      0 KiB |     30 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7082    |  387879 K  |  387879 K  |
|       from large pool |       2    |     178    |  167099 K  |  167099 K  |
|       from small pool |       0    |    6994    |  220780 K  |  220780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7082    |  387879 K  |  387879 K  |
|       from large pool |       2    |     178    |  167099 K  |  167099 K  |
|       from small pool |       0    |    6994    |  220780 K  |  220780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      95    |     133    |      61    |
|       from large pool |      24    |      33    |      41    |      17    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2956    |  162359 K  |  162359 K  |
|       from large pool |       4    |      27    |   60643 K  |   60643 K  |
|       from small pool |       0    |    2938    |  101716 K  |  101716 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 11 21:16:18 2024]
Finished job 0.
1 of 1 steps (100%) done
