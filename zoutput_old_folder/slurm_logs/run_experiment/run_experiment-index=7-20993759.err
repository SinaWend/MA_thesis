Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 01:58:46 2024]
rule parameter_sampling:
    input: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/conf/CAMELYON_benchmark.yaml
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    jobid: 1
    reason: Missing output files: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal




!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
[Fri May 31 02:00:29 2024]
Finished job 1.
1 of 2 steps (50%) done
Select jobs to execute...

[Fri May 31 02:00:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759

 Experiment start at: 2024-05-31 02:11:49.440828
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9691496, 'precision': 0.94591826, 'recall': 0.5443976, 'specificity': 0.5443976, 'f1': 0.5733578, 'auroc': 0.96656156, 'binary_precision': 0.92253524, 'binary_recall': 0.08905506, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.16243026}
confusion matrix:
       0    1
0  42310   11
1   1340  131
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9672733, 'precision': 0.9395693, 'recall': 0.5240231, 'specificity': 0.5240231, 'f1': 0.5374585, 'auroc': 0.96613586, 'binary_precision': 0.9117647, 'binary_recall': 0.048211507, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0915805}
confusion matrix:
       0   1
0  18146   3
1    612  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.94779193, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 02:47:43.522816,epoch time: 0:35:54.081988,used: 0:35:54.081988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.978101, 'precision': 0.93376476, 'recall': 0.69851434, 'specificity': 0.69851434, 'f1': 0.7695879, 'auroc': 0.978679, 'binary_precision': 0.8880484, 'binary_recall': 0.3987772, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.5503985}
confusion matrix:
       0    1
0  42246   74
1    885  587
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.92903614, 'recall': 0.6663861, 'specificity': 0.6663861, 'f1': 0.7361634, 'auroc': 0.979026, 'binary_precision': 0.88114756, 'binary_recall': 0.33437014, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.48478013}
confusion matrix:
       0    1
0  18120   29
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.96133494, 'recall': 0.58604014, 'specificity': 0.58604014, 'f1': 0.6371754, 'auroc': 0.95782954, 'binary_precision': 0.9574468, 'binary_recall': 0.1724138, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.2922078}
confusion matrix:
      0   1
0  5995   2
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 03:22:11.034473,epoch time: 0:34:27.511657,used: 1:10:21.593645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98166335, 'precision': 0.90256, 'recall': 0.7892072, 'specificity': 0.7892072, 'f1': 0.8358914, 'auroc': 0.9805106, 'binary_precision': 0.81948423, 'binary_recall': 0.58288044, 'binary_specificity': 0.995534, 'binary_f1_score': 0.6812227}
confusion matrix:
       0    1
0  42131  189
1    614  858
---- Validation: 
scalar performance:
{'acc': 0.9822797, 'precision': 0.93405485, 'recall': 0.7763101, 'specificity': 0.7763101, 'f1': 0.8364172, 'auroc': 0.976372, 'binary_precision': 0.88366336, 'binary_recall': 0.55520993, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.6819484}
confusion matrix:
       0    1
0  18102   47
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.9481032, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 3,now: 2024-05-31 03:56:31.152079,epoch time: 0:34:20.117606,used: 1:44:41.711251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97981364, 'precision': 0.8874028, 'recall': 0.7692344, 'specificity': 0.7692344, 'f1': 0.81686735, 'auroc': 0.9845254, 'binary_precision': 0.7905138, 'binary_recall': 0.54347825, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.6441224}
confusion matrix:
       0    1
0  42108  212
1    672  800
---- Validation: 
scalar performance:
{'acc': 0.9759472, 'precision': 0.8656328, 'recall': 0.7197778, 'specificity': 0.7197778, 'f1': 0.7731153, 'auroc': 0.9772492, 'binary_precision': 0.7506562, 'binary_recall': 0.44479004, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.55859375}
confusion matrix:
       0    1
0  18054   95
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.90248907, 'recall': 0.59878314, 'specificity': 0.59878314, 'f1': 0.65201014, 'auroc': 0.9535588, 'binary_precision': 0.83870965, 'binary_recall': 0.19923371, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.32198143}
confusion matrix:
      0   1
0  5987  10
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9759472012519836, best validation acc: 0.9822797179222107, corresponding to test acc:                         0.9624480605125427 / 0.9651646018028259
after epoch: 4,now: 2024-05-31 04:29:44.346857,epoch time: 0:33:13.194778,used: 2:17:54.906029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.8829634, 'recall': 0.8859759, 'specificity': 0.8859759, 'f1': 0.8844632, 'auroc': 0.9891385, 'binary_precision': 0.7735849, 'binary_recall': 0.7798913, 'binary_specificity': 0.9920605, 'binary_f1_score': 0.7767253}
confusion matrix:
       0     1
0  41984   336
1    324  1148
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.9019153, 'recall': 0.85711086, 'specificity': 0.85711086, 'f1': 0.8780816, 'auroc': 0.9811003, 'binary_precision': 0.81370825, 'binary_recall': 0.7200622, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.7640264}
confusion matrix:
       0    1
0  18043  106
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.9090214, 'recall': 0.6577532, 'specificity': 0.6577532, 'f1': 0.72326, 'auroc': 0.9493842, 'binary_precision': 0.8469388, 'binary_recall': 0.31800765, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.46239552}
confusion matrix:
      0   1
0  5982  15
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-31 05:04:01.841829,epoch time: 0:34:17.494972,used: 2:52:12.401001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98789734, 'precision': 0.93692887, 'recall': 0.8671845, 'specificity': 0.8671845, 'f1': 0.8988025, 'auroc': 0.99102837, 'binary_precision': 0.8829268, 'binary_recall': 0.73777175, 'binary_specificity': 0.99659735, 'binary_f1_score': 0.80384904}
confusion matrix:
       0     1
0  42176   144
1    386  1086
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.94237375, 'recall': 0.81288517, 'specificity': 0.81288517, 'f1': 0.8657198, 'auroc': 0.98457855, 'binary_precision': 0.8977778, 'binary_recall': 0.62830484, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7392498}
confusion matrix:
       0    1
0  18103   46
1    239  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88250846, 'recall': 0.583374, 'specificity': 0.583374, 'f1': 0.6298962, 'auroc': 0.9623337, 'binary_precision': 0.8, 'binary_recall': 0.16858238, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.27848104}
confusion matrix:
      0   1
0  5986  11
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 6,now: 2024-05-31 05:37:55.949857,epoch time: 0:33:54.108028,used: 3:26:06.509029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.9234897, 'recall': 0.8657166, 'specificity': 0.8657166, 'f1': 0.89232385, 'auroc': 0.9911767, 'binary_precision': 0.8561265, 'binary_recall': 0.7357337, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.7913774}
confusion matrix:
       0     1
0  42138   182
1    389  1083
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.92756724, 'recall': 0.84877133, 'specificity': 0.84877133, 'f1': 0.8838601, 'auroc': 0.97960323, 'binary_precision': 0.86564296, 'binary_recall': 0.7013997, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7749141}
confusion matrix:
       0    1
0  18079   70
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.80400455, 'recall': 0.6196039, 'specificity': 0.6196039, 'f1': 0.66770077, 'auroc': 0.9386866, 'binary_precision': 0.64, 'binary_recall': 0.24521072, 'binary_specificity': 0.993997, 'binary_f1_score': 0.35457063}
confusion matrix:
      0   1
0  5961  36
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 7,now: 2024-05-31 06:12:12.248859,epoch time: 0:34:16.299002,used: 4:00:22.808031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98278224, 'precision': 0.84623516, 'recall': 0.9237861, 'specificity': 0.9237861, 'f1': 0.88072884, 'auroc': 0.987566, 'binary_precision': 0.6973539, 'binary_recall': 0.8605442, 'binary_specificity': 0.987028, 'binary_f1_score': 0.77040195}
confusion matrix:
       0     1
0  41773   549
1    205  1265
---- Validation: 
scalar performance:
{'acc': 0.9793529, 'precision': 0.8306116, 'recall': 0.8858031, 'specificity': 0.8858031, 'f1': 0.8558692, 'auroc': 0.97857547, 'binary_precision': 0.66887414, 'binary_recall': 0.785381, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.7224607}
confusion matrix:
       0    1
0  17899  250
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7281302, 'recall': 0.5932823, 'specificity': 0.5932823, 'f1': 0.62890387, 'auroc': 0.9252453, 'binary_precision': 0.4903846, 'binary_recall': 0.1954023, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.27945203}
confusion matrix:
      0   1
0  5944  53
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9793528914451599, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9627676606178284 / 0.9691594839096069
after epoch: 8,now: 2024-05-31 06:45:49.931968,epoch time: 0:33:37.683109,used: 4:34:00.491140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880115, 'precision': 0.9228816, 'recall': 0.8858557, 'specificity': 0.8858557, 'f1': 0.90345395, 'auroc': 0.99331075, 'binary_precision': 0.8535127, 'binary_recall': 0.77634263, 'binary_specificity': 0.9953687, 'binary_f1_score': 0.8131007}
confusion matrix:
       0     1
0  42125   196
1    329  1142
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9249282, 'recall': 0.8479111, 'specificity': 0.8479111, 'f1': 0.8822828, 'auroc': 0.98253345, 'binary_precision': 0.86042064, 'binary_recall': 0.6998445, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.77186966}
confusion matrix:
       0    1
0  18076   73
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.87536275, 'recall': 0.5832907, 'specificity': 0.5832907, 'f1': 0.6294153, 'auroc': 0.95260644, 'binary_precision': 0.78571427, 'binary_recall': 0.16858238, 'binary_specificity': 0.997999, 'binary_f1_score': 0.27760252}
confusion matrix:
      0   1
0  5985  12
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9858450293540955, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9627676606178284 / 0.9691594839096069
after epoch: 9,now: 2024-05-31 07:19:30.247093,epoch time: 0:33:40.315125,used: 5:07:40.806265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9893131, 'precision': 0.9585714, 'recall': 0.86946845, 'specificity': 0.86946845, 'f1': 0.9088764, 'auroc': 0.9941225, 'binary_precision': 0.92608327, 'binary_recall': 0.74099255, 'binary_specificity': 0.9979443, 'binary_f1_score': 0.8232629}
confusion matrix:
       0     1
0  42234    87
1    381  1090
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9419445, 'recall': 0.8213837, 'specificity': 0.8213837, 'f1': 0.8714429, 'auroc': 0.98227817, 'binary_precision': 0.8963283, 'binary_recall': 0.64541215, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7504521}
confusion matrix:
       0    1
0  18101   48
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7499351, 'recall': 0.53872913, 'specificity': 0.53872913, 'f1': 0.5594401, 'auroc': 0.94147074, 'binary_precision': 0.53846157, 'binary_recall': 0.08045977, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.14000002}
confusion matrix:
      0   1
0  5979  18
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9853128790855408, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9627676606178284 / 0.9691594839096069
after epoch: 10,now: 2024-05-31 07:52:59.929633,epoch time: 0:33:29.682540,used: 5:41:10.488805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9907746, 'precision': 0.95048594, 'recall': 0.9024427, 'specificity': 0.9024427, 'f1': 0.92500836, 'auroc': 0.9946742, 'binary_precision': 0.9076336, 'binary_recall': 0.80774456, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.85478073}
confusion matrix:
       0     1
0  42199   121
1    283  1189
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9358895, 'recall': 0.85290736, 'specificity': 0.85290736, 'f1': 0.88969916, 'auroc': 0.9818518, 'binary_precision': 0.8820116, 'binary_recall': 0.70917577, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.78620696}
confusion matrix:
       0    1
0  18088   61
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.87103176, 'recall': 0.62293696, 'specificity': 0.62293696, 'f1': 0.6795733, 'auroc': 0.9532453, 'binary_precision': 0.77380955, 'binary_recall': 0.24904214, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3768116}
confusion matrix:
      0   1
0  5978  19
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 11,now: 2024-05-31 08:25:46.187956,epoch time: 0:32:46.258323,used: 6:13:56.747128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902265, 'precision': 0.9198928, 'recall': 0.9319943, 'specificity': 0.9319943, 'f1': 0.9258505, 'auroc': 0.9958179, 'binary_precision': 0.84432715, 'binary_recall': 0.8695652, 'binary_specificity': 0.99442345, 'binary_f1_score': 0.8567603}
confusion matrix:
       0     1
0  42084   236
1    192  1280
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.89667356, 'recall': 0.87461007, 'specificity': 0.87461007, 'f1': 0.88529956, 'auroc': 0.98317504, 'binary_precision': 0.8019802, 'binary_recall': 0.755832, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.77822256}
confusion matrix:
       0    1
0  18029  120
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8674984, 'recall': 0.6814068, 'specificity': 0.6814068, 'f1': 0.7400234, 'auroc': 0.95772696, 'binary_precision': 0.7619048, 'binary_recall': 0.3678161, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.496124}
confusion matrix:
      0   1
0  5967  30
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9656440019607544 / 0.9691594839096069
after epoch: 12,now: 2024-05-31 08:59:32.660541,epoch time: 0:33:46.472585,used: 6:47:43.219713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9905919, 'precision': 0.9392834, 'recall': 0.9121256, 'specificity': 0.9121256, 'f1': 0.9252374, 'auroc': 0.99398977, 'binary_precision': 0.8845316, 'binary_recall': 0.8280082, 'binary_specificity': 0.996243, 'binary_f1_score': 0.8553371}
confusion matrix:
       0     1
0  42162   159
1    253  1218
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.9282871, 'recall': 0.8565199, 'specificity': 0.8565199, 'f1': 0.88886595, 'auroc': 0.97716284, 'binary_precision': 0.8665413, 'binary_recall': 0.7169518, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7846808}
confusion matrix:
       0    1
0  18078   71
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8984796, 'recall': 0.6366804, 'specificity': 0.6366804, 'f1': 0.6985139, 'auroc': 0.94146895, 'binary_precision': 0.82758623, 'binary_recall': 0.27586207, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.41379312}
confusion matrix:
      0   1
0  5982  15
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9865368008613586, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9656440019607544 / 0.9691594839096069
after epoch: 13,now: 2024-05-31 09:33:09.835463,epoch time: 0:33:37.174922,used: 7:21:20.394635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.9284617, 'recall': 0.94921434, 'specificity': 0.94921434, 'f1': 0.9385725, 'auroc': 0.99719095, 'binary_precision': 0.8602846, 'binary_recall': 0.9035326, 'binary_specificity': 0.99489605, 'binary_f1_score': 0.8813784}
confusion matrix:
       0     1
0  42104   216
1    142  1330
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.8929031, 'recall': 0.9029131, 'specificity': 0.9029131, 'f1': 0.89783967, 'auroc': 0.9807552, 'binary_precision': 0.79242426, 'binary_recall': 0.8133748, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.80276287}
confusion matrix:
       0    1
0  18012  137
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.84839904, 'recall': 0.62626815, 'specificity': 0.62626815, 'f1': 0.680799, 'auroc': 0.94415534, 'binary_precision': 0.7282609, 'binary_recall': 0.256705, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3796034}
confusion matrix:
      0   1
0  5972  25
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9863239526748657, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9656440019607544 / 0.9691594839096069
after epoch: 14,now: 2024-05-31 10:06:54.574851,epoch time: 0:33:44.739388,used: 7:55:05.134023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921219, 'precision': 0.96190774, 'recall': 0.91291714, 'specificity': 0.91291714, 'f1': 0.9359379, 'auroc': 0.9969947, 'binary_precision': 0.929771, 'binary_recall': 0.8280082, 'binary_specificity': 0.99782616, 'binary_f1_score': 0.87594396}
confusion matrix:
       0     1
0  42229    92
1    253  1218
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9293145, 'recall': 0.83646744, 'specificity': 0.83646744, 'f1': 0.87683165, 'auroc': 0.98241174, 'binary_precision': 0.87, 'binary_recall': 0.67651635, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.76115483}
confusion matrix:
       0    1
0  18084   65
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.84831804, 'recall': 0.5622179, 'specificity': 0.5622179, 'f1': 0.5980151, 'auroc': 0.9503021, 'binary_precision': 0.73333335, 'binary_recall': 0.12643678, 'binary_specificity': 0.997999, 'binary_f1_score': 0.21568628}
confusion matrix:
      0   1
0  5985  12
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.985472559928894, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9656440019607544 / 0.9691594839096069
after epoch: 15,now: 2024-05-31 10:39:29.593124,epoch time: 0:32:35.018273,used: 8:27:40.152296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9918935, 'precision': 0.9684421, 'recall': 0.9026282, 'specificity': 0.9026282, 'f1': 0.9328661, 'auroc': 0.9973291, 'binary_precision': 0.9435612, 'binary_recall': 0.80693406, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.8699157}
confusion matrix:
       0     1
0  42250    71
1    284  1187
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.93825525, 'recall': 0.83210486, 'specificity': 0.83210486, 'f1': 0.8773192, 'auroc': 0.9778935, 'binary_precision': 0.88819873, 'binary_recall': 0.66718507, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.76198936}
confusion matrix:
       0    1
0  18095   54
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8459687, 'recall': 0.5358148, 'specificity': 0.5358148, 'f1': 0.55602133, 'auroc': 0.9459592, 'binary_precision': 0.7307692, 'binary_recall': 0.07279693, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13240418}
confusion matrix:
      0   1
0  5990   7
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 5
val acc:0.9857386350631714, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9656440019607544 / 0.9691594839096069
after epoch: 16,now: 2024-05-31 11:13:19.838385,epoch time: 0:33:50.245261,used: 9:01:30.397557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9944282, 'precision': 0.967121, 'recall': 0.9456433, 'specificity': 0.9456433, 'f1': 0.95611024, 'auroc': 0.99812376, 'binary_precision': 0.9379458, 'binary_recall': 0.8933424, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.91510093}
confusion matrix:
       0     1
0  42233    87
1    157  1315
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.93711436, 'recall': 0.87382, 'specificity': 0.87382, 'f1': 0.902805, 'auroc': 0.9791366, 'binary_precision': 0.88299817, 'binary_recall': 0.7511664, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.8117647}
confusion matrix:
       0    1
0  18085   64
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.83645284, 'recall': 0.550807, 'specificity': 0.550807, 'f1': 0.580274, 'auroc': 0.94485664, 'binary_precision': 0.7105263, 'binary_recall': 0.10344828, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.18060201}
confusion matrix:
      0   1
0  5986  11
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 17,now: 2024-05-31 11:45:36.700506,epoch time: 0:32:16.862121,used: 9:33:47.259678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.921341, 'recall': 0.97249526, 'specificity': 0.97249526, 'f1': 0.9453306, 'auroc': 0.9980489, 'binary_precision': 0.8443908, 'binary_recall': 0.95108694, 'binary_specificity': 0.9939036, 'binary_f1_score': 0.8945687}
confusion matrix:
       0     1
0  42062   258
1     72  1400
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.8911059, 'recall': 0.91743964, 'specificity': 0.91743964, 'f1': 0.903806, 'auroc': 0.9832017, 'binary_precision': 0.7877907, 'binary_recall': 0.8429238, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.81442523}
confusion matrix:
       0    1
0  18003  146
1    101  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.82609, 'recall': 0.6257678, 'specificity': 0.6257678, 'f1': 0.6773756, 'auroc': 0.95731616, 'binary_precision': 0.68367344, 'binary_recall': 0.256705, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.37325904}
confusion matrix:
      0   1
0  5966  31
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9868561029434204, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 18,now: 2024-05-31 12:17:30.124410,epoch time: 0:31:53.423904,used: 10:05:40.683582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.95105624, 'recall': 0.95519555, 'specificity': 0.95519555, 'f1': 0.9531157, 'auroc': 0.9986794, 'binary_precision': 0.9051144, 'binary_recall': 0.9137228, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.90939826}
confusion matrix:
       0     1
0  42179   141
1    127  1345
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9204644, 'recall': 0.88249004, 'specificity': 0.88249004, 'f1': 0.9005065, 'auroc': 0.98084855, 'binary_precision': 0.8490566, 'binary_recall': 0.7698289, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.8075041}
confusion matrix:
       0    1
0  18061   88
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.82329094, 'recall': 0.5882041, 'specificity': 0.5882041, 'f1': 0.632741, 'auroc': 0.9564008, 'binary_precision': 0.68115944, 'binary_recall': 0.18007663, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.28484848}
confusion matrix:
      0   1
0  5975  22
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9874414801597595, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 19,now: 2024-05-31 12:49:54.148640,epoch time: 0:32:24.024230,used: 10:38:04.707812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9942912, 'precision': 0.96418875, 'recall': 0.9464849, 'specificity': 0.9464849, 'f1': 0.95515156, 'auroc': 0.9981624, 'binary_precision': 0.9320113, 'binary_recall': 0.8952381, 'binary_specificity': 0.9977317, 'binary_f1_score': 0.9132547}
confusion matrix:
       0     1
0  42226    96
1    154  1316
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9189708, 'recall': 0.87163115, 'specificity': 0.87163115, 'f1': 0.8937695, 'auroc': 0.98060536, 'binary_precision': 0.84683096, 'binary_recall': 0.748056, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7943848}
confusion matrix:
       0    1
0  18062   87
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.80427206, 'recall': 0.61027545, 'specificity': 0.61027545, 'f1': 0.65747833, 'auroc': 0.9319358, 'binary_precision': 0.6413044, 'binary_recall': 0.22605364, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.33427763}
confusion matrix:
      0   1
0  5964  33
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9867497086524963, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 20,now: 2024-05-31 13:21:55.756948,epoch time: 0:32:01.608308,used: 11:10:06.316120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9930581, 'precision': 0.9849427, 'recall': 0.906247, 'specificity': 0.906247, 'f1': 0.9418713, 'auroc': 0.9981186, 'binary_precision': 0.97634584, 'binary_recall': 0.8131794, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.8873239}
confusion matrix:
       0     1
0  42291    29
1    275  1197
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.95228213, 'recall': 0.7976636, 'specificity': 0.7976636, 'f1': 0.8579116, 'auroc': 0.9775563, 'binary_precision': 0.9186603, 'binary_recall': 0.59720063, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.7238455}
confusion matrix:
       0    1
0  18115   34
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8371265, 'recall': 0.5602188, 'specificity': 0.5602188, 'f1': 0.5946653, 'auroc': 0.93268234, 'binary_precision': 0.7111111, 'binary_recall': 0.12260536, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20915033}
confusion matrix:
      0   1
0  5984  13
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9844082593917847, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 21,now: 2024-05-31 13:53:58.899606,epoch time: 0:32:03.142658,used: 11:42:09.458778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99518174, 'precision': 0.976178, 'recall': 0.9483282, 'specificity': 0.9483282, 'f1': 0.9618021, 'auroc': 0.99912107, 'binary_precision': 0.955893, 'binary_recall': 0.8980978, 'binary_specificity': 0.9985586, 'binary_f1_score': 0.9260946}
confusion matrix:
       0     1
0  42259    61
1    150  1322
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9285543, 'recall': 0.8495765, 'specificity': 0.8495765, 'f1': 0.8847467, 'auroc': 0.97989976, 'binary_precision': 0.86756235, 'binary_recall': 0.7029549, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.77663225}
confusion matrix:
       0    1
0  18080   69
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.84521025, 'recall': 0.5603022, 'specificity': 0.5603022, 'f1': 0.59504986, 'auroc': 0.947491, 'binary_precision': 0.72727275, 'binary_recall': 0.12260536, 'binary_specificity': 0.997999, 'binary_f1_score': 0.20983605}
confusion matrix:
      0   1
0  5985  12
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 5
val acc:0.9861643314361572, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 22,now: 2024-05-31 14:26:12.764724,epoch time: 0:32:13.865118,used: 12:14:23.323896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99472505, 'precision': 0.9521351, 'recall': 0.9684192, 'specificity': 0.9684192, 'f1': 0.96012163, 'auroc': 0.99880916, 'binary_precision': 0.90635234, 'binary_recall': 0.9402174, 'binary_specificity': 0.996621, 'binary_f1_score': 0.9229743}
confusion matrix:
       0     1
0  42177   143
1     88  1384
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.90748, 'recall': 0.89585334, 'specificity': 0.89585334, 'f1': 0.90157545, 'auroc': 0.98071396, 'binary_precision': 0.82211536, 'binary_recall': 0.7978227, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.80978686}
confusion matrix:
       0    1
0  18038  111
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.83612925, 'recall': 0.6710779, 'specificity': 0.6710779, 'f1': 0.72411805, 'auroc': 0.9486988, 'binary_precision': 0.7, 'binary_recall': 0.348659, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.46547318}
confusion matrix:
      0   1
0  5958  39
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 6
val acc:0.9871754050254822, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9691594839096069
after epoch: 23,now: 2024-05-31 15:00:03.139124,epoch time: 0:33:50.374400,used: 12:48:13.698296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.995707, 'precision': 0.97869, 'recall': 0.9541428, 'specificity': 0.9541428, 'f1': 0.9660692, 'auroc': 0.9991282, 'binary_precision': 0.96051687, 'binary_recall': 0.9095853, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.9343575}
confusion matrix:
       0     1
0  42266    55
1    133  1338
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9317176, 'recall': 0.8574077, 'specificity': 0.8574077, 'f1': 0.8907925, 'auroc': 0.9818821, 'binary_precision': 0.8733459, 'binary_recall': 0.718507, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7883959}
confusion matrix:
       0    1
0  18082   67
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8841772, 'recall': 0.68373936, 'specificity': 0.68373936, 'f1': 0.74547505, 'auroc': 0.9532945, 'binary_precision': 0.795082, 'binary_recall': 0.3716475, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.5065274}
confusion matrix:
      0   1
0  5972  25
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
early stop counter: 7
val acc:0.986802875995636, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 24,now: 2024-05-31 15:32:19.810433,epoch time: 0:32:16.671309,used: 13:20:30.369605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9948849, 'precision': 0.9444312, 'recall': 0.98161626, 'specificity': 0.98161626, 'f1': 0.9622164, 'auroc': 0.99933636, 'binary_precision': 0.89, 'binary_recall': 0.9673913, 'binary_specificity': 0.9958412, 'binary_f1_score': 0.9270833}
confusion matrix:
       0     1
0  42144   176
1     48  1424
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.88338566, 'recall': 0.91091573, 'specificity': 0.91091573, 'f1': 0.8966309, 'auroc': 0.9817311, 'binary_precision': 0.77279305, 'binary_recall': 0.8304821, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.8005997}
confusion matrix:
       0    1
0  17992  157
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8287982, 'recall': 0.60894334, 'specificity': 0.60894334, 'f1': 0.65870833, 'auroc': 0.94323707, 'binary_precision': 0.6904762, 'binary_recall': 0.22222222, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3362319}
confusion matrix:
      0   1
0  5971  26
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 8
val acc:0.9858450293540955, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9608501195907593 / 0.9697986841201782
after epoch: 25,now: 2024-05-31 16:04:45.774388,epoch time: 0:32:25.963955,used: 13:52:56.333560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9959125, 'precision': 0.9844594, 'recall': 0.951657, 'specificity': 0.951657, 'f1': 0.96744084, 'auroc': 0.99960786, 'binary_precision': 0.97224253, 'binary_recall': 0.90421194, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.936994}
confusion matrix:
       0     1
0  42282    38
1    141  1331
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.95850754, 'recall': 0.8551513, 'specificity': 0.8551513, 'f1': 0.89978266, 'auroc': 0.9833115, 'binary_precision': 0.9271255, 'binary_recall': 0.7122862, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.8056289}
confusion matrix:
       0    1
0  18113   36
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9459578, 'recall': 0.59545195, 'specificity': 0.59545195, 'f1': 0.64991945, 'auroc': 0.9540174, 'binary_precision': 0.9259259, 'binary_recall': 0.19157088, 'binary_specificity': 0.999333, 'binary_f1_score': 0.31746033}
confusion matrix:
      0   1
0  5993   4
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 26,now: 2024-05-31 16:36:52.293572,epoch time: 0:32:06.519184,used: 14:25:02.852744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9962094, 'precision': 0.9595544, 'recall': 0.98424935, 'specificity': 0.98424935, 'f1': 0.9715532, 'auroc': 0.9989909, 'binary_precision': 0.9201031, 'binary_recall': 0.9714286, 'binary_specificity': 0.9970701, 'binary_f1_score': 0.9450695}
confusion matrix:
       0     1
0  42198   124
1     42  1428
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9146217, 'recall': 0.9015446, 'specificity': 0.9015446, 'f1': 0.9079696, 'auroc': 0.9766542, 'binary_precision': 0.83601284, 'binary_recall': 0.8087092, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.8221344}
confusion matrix:
       0    1
0  18047  102
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.89553225, 'recall': 0.62335384, 'specificity': 0.62335384, 'f1': 0.68255293, 'auroc': 0.9319104, 'binary_precision': 0.8227848, 'binary_recall': 0.24904214, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.38235295}
confusion matrix:
      0   1
0  5983  14
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9880267977714539, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9656440019607544 / 0.9697986841201782
after epoch: 27,now: 2024-05-31 17:09:25.982282,epoch time: 0:32:33.688710,used: 14:57:36.541454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9960495, 'precision': 0.98195565, 'recall': 0.9562886, 'specificity': 0.9562886, 'f1': 0.9687449, 'auroc': 0.9993485, 'binary_precision': 0.9669065, 'binary_recall': 0.91366416, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.9395316}
confusion matrix:
       0     1
0  42275    46
1    127  1344
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9439714, 'recall': 0.86012614, 'specificity': 0.86012614, 'f1': 0.89734566, 'auroc': 0.98413855, 'binary_precision': 0.8976834, 'binary_recall': 0.7231726, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.80103356}
confusion matrix:
       0    1
0  18096   53
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8639338, 'recall': 0.5850397, 'specificity': 0.5850397, 'f1': 0.63119566, 'auroc': 0.95296085, 'binary_precision': 0.7627119, 'binary_recall': 0.1724138, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.28125}
confusion matrix:
      0   1
0  5983  14
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9877075552940369, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9656440019607544 / 0.9697986841201782
after epoch: 28,now: 2024-05-31 17:43:13.409201,epoch time: 0:33:47.426919,used: 15:31:23.968373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9968944, 'precision': 0.9806428, 'recall': 0.9711809, 'specificity': 0.9711809, 'f1': 0.9758613, 'auroc': 0.9994215, 'binary_precision': 0.9632455, 'binary_recall': 0.9436141, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9533288}
confusion matrix:
       0     1
0  42267    53
1     83  1389
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9310311, 'recall': 0.8666563, 'specificity': 0.8666563, 'f1': 0.8960427, 'auroc': 0.98619676, 'binary_precision': 0.8713235, 'binary_recall': 0.7371695, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.798652}
confusion matrix:
       0    1
0  18079   70
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.84829295, 'recall': 0.6356799, 'specificity': 0.6356799, 'f1': 0.6911155, 'auroc': 0.94826484, 'binary_precision': 0.72727275, 'binary_recall': 0.27586207, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5970  27
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9872817993164062, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9656440019607544 / 0.9697986841201782
after epoch: 29,now: 2024-05-31 18:16:49.146242,epoch time: 0:33:35.737041,used: 16:04:59.705414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9944967, 'precision': 0.96963155, 'recall': 0.94400203, 'specificity': 0.94400203, 'f1': 0.95643014, 'auroc': 0.9978349, 'binary_precision': 0.9430836, 'binary_recall': 0.8898708, 'binary_specificity': 0.9981333, 'binary_f1_score': 0.9157048}
confusion matrix:
       0     1
0  42242    79
1    162  1309
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.92565876, 'recall': 0.8394401, 'specificity': 0.8394401, 'f1': 0.877316, 'auroc': 0.97743684, 'binary_precision': 0.86247545, 'binary_recall': 0.6827372, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7621528}
confusion matrix:
       0    1
0  18079   70
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.748114, 'recall': 0.5276517, 'specificity': 0.5276517, 'f1': 0.5413118, 'auroc': 0.9439132, 'binary_precision': 0.53571427, 'binary_recall': 0.057471264, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.10380623}
confusion matrix:
      0   1
0  5984  13
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9854193329811096, best validation acc: 0.9882397055625916, corresponding to test acc:                         0.9656440019607544 / 0.9697986841201782
after epoch: 30,now: 2024-05-31 18:50:35.681883,epoch time: 0:33:46.535641,used: 16:38:46.241055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_02_11_49_seed_0_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:38:46.241055 at 2024-05-31 18:50:35.681883
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.9272781, 'recall': 0.5914538, 'specificity': 0.5914538, 'f1': 0.6434063, 'auroc': 0.94966114, 'binary_precision': 0.8888889, 'binary_recall': 0.18390805, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.3047619}
confusion matrix:
      0   1
0  5991   6
1   213  48
oracle model performance metric: 

scalar performance:
{'acc': 0.9709172, 'precision': 0.8950373, 'recall': 0.69348466, 'specificity': 0.69348466, 'f1': 0.75674665, 'auroc': 0.95435715, 'binary_precision': 0.816, 'binary_recall': 0.3908046, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.5284974}
confusion matrix:
      0    1
0  5974   23
1   159  102
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 463464 GiB | 463464 GiB |
|       from large pool | 417040 KiB |    849 MiB | 450564 GiB | 450564 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12899 GiB |  12899 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152221 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    2874    |   87380 K  |   87380 K  |
|       from large pool |     112    |     508    |   45005 K  |   45005 K  |
|       from small pool |      34    |    2761    |   42375 K  |   42375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463465 GiB | 463465 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12899 GiB |  12899 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   87382 K  |   87382 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463465 GiB | 463465 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12899 GiB |  12899 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   87382 K  |   87382 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759

 Experiment start at: 2024-05-31 19:03:50.909357
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9677581, 'precision': 0.7485195, 'recall': 0.8453307, 'specificity': 0.8453307, 'f1': 0.78809536, 'auroc': 0.96128786, 'binary_precision': 0.50688976, 'binary_recall': 0.71428573, 'binary_specificity': 0.9763757, 'binary_f1_score': 0.59297645}
confusion matrix:
       0     1
0  41412  1002
1    412  1030
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7508426, 'recall': 0.83612454, 'specificity': 0.83612454, 'f1': 0.7864854, 'auroc': 0.9610437, 'binary_precision': 0.5131291, 'binary_recall': 0.6968796, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.5910523}
confusion matrix:
       0    1
0  17622  445
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.9422201, 'recall': 0.7106135, 'specificity': 0.7106135, 'f1': 0.78202283, 'auroc': 0.9452567, 'binary_precision': 0.90909094, 'binary_recall': 0.42307693, 'binary_specificity': 0.99815, 'binary_f1_score': 0.5774278}
confusion matrix:
      0    1
0  5935   11
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 19:39:01.149011,epoch time: 0:35:10.239654,used: 0:35:10.239654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97510034, 'precision': 0.90111995, 'recall': 0.6528447, 'specificity': 0.6528447, 'f1': 0.7178738, 'auroc': 0.972715, 'binary_precision': 0.8252788, 'binary_recall': 0.30790567, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.44848487}
confusion matrix:
       0    1
0  42320   94
1    998  444
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.942115, 'recall': 0.6221426, 'specificity': 0.6221426, 'f1': 0.68605506, 'auroc': 0.9709449, 'binary_precision': 0.9116022, 'binary_recall': 0.24517088, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.38641685}
confusion matrix:
       0    1
0  18051   16
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.95649934, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 2,now: 2024-05-31 20:12:46.158502,epoch time: 0:33:45.009491,used: 1:08:55.249145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97877145, 'precision': 0.9338496, 'recall': 0.7017647, 'specificity': 0.7017647, 'f1': 0.77279043, 'auroc': 0.9784391, 'binary_precision': 0.887538, 'binary_recall': 0.40527412, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.55645543}
confusion matrix:
       0    1
0  42341   74
1    857  584
---- Validation: 
scalar performance:
{'acc': 0.97604054, 'precision': 0.9570372, 'recall': 0.6778633, 'specificity': 0.6778633, 'f1': 0.75220025, 'auroc': 0.9772289, 'binary_precision': 0.9375, 'binary_recall': 0.35661218, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.5166846}
confusion matrix:
       0    1
0  18051   16
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.95417506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 3,now: 2024-05-31 20:46:42.209965,epoch time: 0:33:56.051463,used: 1:42:51.300608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97984314, 'precision': 0.8746841, 'recall': 0.7768843, 'specificity': 0.7768843, 'f1': 0.8178715, 'auroc': 0.98041975, 'binary_precision': 0.76420456, 'binary_recall': 0.5596394, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.6461169}
confusion matrix:
       0    1
0  42165  249
1    635  807
---- Validation: 
scalar performance:
{'acc': 0.9792956, 'precision': 0.92219543, 'recall': 0.7503629, 'specificity': 0.7503629, 'f1': 0.81268364, 'auroc': 0.97680014, 'binary_precision': 0.86259544, 'binary_recall': 0.5037147, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.6360225}
confusion matrix:
       0    1
0  18013   54
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.880792, 'recall': 0.6102771, 'specificity': 0.6102771, 'f1': 0.66519165, 'auroc': 0.9511491, 'binary_precision': 0.79452056, 'binary_recall': 0.22307692, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.34834838}
confusion matrix:
      0   1
0  5931  15
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 4,now: 2024-05-31 21:19:59.466695,epoch time: 0:33:17.256730,used: 2:16:08.557338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97660524, 'precision': 0.796666, 'recall': 0.9326378, 'specificity': 0.9326378, 'f1': 0.8506063, 'auroc': 0.98676777, 'binary_precision': 0.5972872, 'binary_recall': 0.8855756, 'binary_specificity': 0.9797001, 'binary_f1_score': 0.7134078}
confusion matrix:
       0     1
0  41553   861
1    165  1277
---- Validation: 
scalar performance:
{'acc': 0.97492, 'precision': 0.80254984, 'recall': 0.9033066, 'specificity': 0.9033066, 'f1': 0.8449075, 'auroc': 0.97793114, 'binary_precision': 0.6116612, 'binary_recall': 0.82615155, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.7029077}
confusion matrix:
       0    1
0  17714  353
1    117  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.86461157, 'recall': 0.6876937, 'specificity': 0.6876937, 'f1': 0.7451693, 'auroc': 0.9673368, 'binary_precision': 0.7557252, 'binary_recall': 0.38076922, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.50639385}
confusion matrix:
      0   1
0  5914  32
1   161  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9749199748039246, best validation acc: 0.9792956113815308, corresponding to test acc:                         0.9650338292121887 / 0.9740573763847351
after epoch: 5,now: 2024-05-31 21:53:51.303722,epoch time: 0:33:51.837027,used: 2:50:00.394365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9854296, 'precision': 0.87112045, 'recall': 0.91542816, 'specificity': 0.91542816, 'f1': 0.89191616, 'auroc': 0.989123, 'binary_precision': 0.7476866, 'binary_recall': 0.8404993, 'binary_specificity': 0.990357, 'binary_f1_score': 0.791381}
confusion matrix:
       0     1
0  42005   409
1    230  1212
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.8908013, 'recall': 0.87736547, 'specificity': 0.87736547, 'f1': 0.88395524, 'auroc': 0.9783487, 'binary_precision': 0.7904468, 'binary_recall': 0.7622585, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.7760968}
confusion matrix:
       0    1
0  17931  136
1    160  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8545149, 'recall': 0.57198375, 'specificity': 0.57198375, 'f1': 0.6124765, 'auroc': 0.9538654, 'binary_precision': 0.74509805, 'binary_recall': 0.14615385, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.244373}
confusion matrix:
      0   1
0  5933  13
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 6,now: 2024-05-31 22:27:42.143932,epoch time: 0:33:50.840210,used: 3:23:51.234575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98625046, 'precision': 0.8813479, 'recall': 0.912168, 'specificity': 0.912168, 'f1': 0.8961079, 'auroc': 0.9907095, 'binary_precision': 0.7683941, 'binary_recall': 0.832871, 'binary_specificity': 0.9914651, 'binary_f1_score': 0.7993344}
confusion matrix:
       0     1
0  42052   362
1    241  1201
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.89413714, 'recall': 0.86869925, 'specificity': 0.86869925, 'f1': 0.8809561, 'auroc': 0.98046476, 'binary_precision': 0.7977707, 'binary_recall': 0.7444279, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.7701767}
confusion matrix:
       0    1
0  17940  127
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.88610756, 'recall': 0.5875365, 'specificity': 0.5875365, 'f1': 0.635809, 'auroc': 0.95409775, 'binary_precision': 0.80701756, 'binary_recall': 0.17692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.29022083}
confusion matrix:
      0   1
0  5935  11
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.984204888343811, corresponding to test acc:                         0.9621334075927734 / 0.9740573763847351
after epoch: 7,now: 2024-05-31 23:01:30.467612,epoch time: 0:33:48.323680,used: 3:57:39.558255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98638725, 'precision': 0.92988884, 'recall': 0.84256876, 'specificity': 0.84256876, 'f1': 0.8809302, 'auroc': 0.99248254, 'binary_precision': 0.8702892, 'binary_recall': 0.6886269, 'binary_specificity': 0.99651057, 'binary_f1_score': 0.7688734}
confusion matrix:
       0    1
0  42266  148
1    449  993
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.91334486, 'recall': 0.81425166, 'specificity': 0.81425166, 'f1': 0.8564991, 'auroc': 0.97705495, 'binary_precision': 0.84023666, 'binary_recall': 0.6329866, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7220339}
confusion matrix:
       0    1
0  17986   81
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.90040743, 'recall': 0.54957956, 'specificity': 0.54957956, 'f1': 0.57948816, 'auroc': 0.9534616, 'binary_precision': 0.83870965, 'binary_recall': 0.1, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.17869416}
confusion matrix:
      0   1
0  5941   5
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9824973344802856, best validation acc: 0.984204888343811, corresponding to test acc:                         0.9621334075927734 / 0.9740573763847351
after epoch: 8,now: 2024-05-31 23:35:13.292280,epoch time: 0:33:42.824668,used: 4:31:22.382923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98698014, 'precision': 0.8804904, 'recall': 0.9309677, 'specificity': 0.9309677, 'f1': 0.90402186, 'auroc': 0.9938582, 'binary_precision': 0.76538694, 'binary_recall': 0.8710125, 'binary_specificity': 0.9909228, 'binary_f1_score': 0.8147908}
confusion matrix:
       0     1
0  42029   385
1    186  1256
---- Validation: 
scalar performance:
{'acc': 0.97966915, 'precision': 0.84599894, 'recall': 0.8721521, 'specificity': 0.8721521, 'f1': 0.8585515, 'auroc': 0.9781024, 'binary_precision': 0.7011019, 'binary_recall': 0.756315, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.7276626}
confusion matrix:
       0    1
0  17850  217
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.78342557, 'recall': 0.6697864, 'specificity': 0.6697864, 'f1': 0.71071315, 'auroc': 0.96632075, 'binary_precision': 0.59477127, 'binary_recall': 0.35, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.44067794}
confusion matrix:
      0   1
0  5884  62
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9796691536903381, best validation acc: 0.984204888343811, corresponding to test acc:                         0.9621334075927734 / 0.9740573763847351
after epoch: 9,now: 2024-06-01 00:09:22.681078,epoch time: 0:34:09.388798,used: 5:05:31.771721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9891691, 'precision': 0.8993069, 'recall': 0.94114304, 'specificity': 0.94114304, 'f1': 0.91909575, 'auroc': 0.9942302, 'binary_precision': 0.8023765, 'binary_recall': 0.8897365, 'binary_specificity': 0.99254966, 'binary_f1_score': 0.84380144}
confusion matrix:
       0     1
0  42098   316
1    159  1283
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.89173937, 'recall': 0.8810802, 'specificity': 0.8810802, 'f1': 0.88632965, 'auroc': 0.9792886, 'binary_precision': 0.79204893, 'binary_recall': 0.76968795, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.7807084}
confusion matrix:
       0    1
0  17931  136
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.77989125, 'recall': 0.626817, 'specificity': 0.626817, 'f1': 0.6714056, 'auroc': 0.95283157, 'binary_precision': 0.59130436, 'binary_recall': 0.26153848, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.3626667}
confusion matrix:
      0   1
0  5899  47
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 10,now: 2024-06-01 00:43:22.492140,epoch time: 0:33:59.811062,used: 5:39:31.582783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98859906, 'precision': 0.95365584, 'recall': 0.8581152, 'specificity': 0.8581152, 'f1': 0.899863, 'auroc': 0.99289304, 'binary_precision': 0.91681415, 'binary_recall': 0.7184466, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.80559874}
confusion matrix:
       0     1
0  42320    94
1    406  1036
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.94315815, 'recall': 0.8129637, 'specificity': 0.8129637, 'f1': 0.86599195, 'auroc': 0.97670865, 'binary_precision': 0.9, 'binary_recall': 0.62852895, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.7401574}
confusion matrix:
       0    1
0  18020   47
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.89297014, 'recall': 0.5533416, 'specificity': 0.5533416, 'f1': 0.585418, 'auroc': 0.9508606, 'binary_precision': 0.8235294, 'binary_recall': 0.10769231, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1904762}
confusion matrix:
      0   1
0  5940   6
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9841515421867371, best validation acc: 0.9844717383384705, corresponding to test acc:                         0.9614889025688171 / 0.9740573763847351
after epoch: 11,now: 2024-06-01 01:16:52.093127,epoch time: 0:33:29.600987,used: 6:13:01.183770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9870941, 'precision': 0.875345, 'recall': 0.9457645, 'specificity': 0.9457645, 'f1': 0.9072654, 'auroc': 0.9946493, 'binary_precision': 0.7540603, 'binary_recall': 0.9015257, 'binary_specificity': 0.9900033, 'binary_f1_score': 0.8212255}
confusion matrix:
       0     1
0  41990   424
1    142  1300
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.890236, 'recall': 0.8868854, 'specificity': 0.8868854, 'f1': 0.88855284, 'auroc': 0.97771466, 'binary_precision': 0.7886057, 'binary_recall': 0.781575, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.78507465}
confusion matrix:
       0    1
0  17926  141
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.85790265, 'recall': 0.7253144, 'specificity': 0.7253144, 'f1': 0.77502954, 'auroc': 0.9628936, 'binary_precision': 0.73913044, 'binary_recall': 0.4576923, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.5653206}
confusion matrix:
      0    1
0  5904   42
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 12,now: 2024-06-01 01:50:26.366752,epoch time: 0:33:34.273625,used: 6:46:35.457395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9915633, 'precision': 0.9339186, 'recall': 0.93333715, 'specificity': 0.93333715, 'f1': 0.9336276, 'auroc': 0.9953395, 'binary_precision': 0.87222224, 'binary_recall': 0.8710125, 'binary_specificity': 0.9956618, 'binary_f1_score': 0.87161696}
confusion matrix:
       0     1
0  42230   184
1    186  1256
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9031042, 'recall': 0.8712878, 'specificity': 0.8712878, 'f1': 0.886485, 'auroc': 0.97680014, 'binary_precision': 0.815534, 'binary_recall': 0.7488856, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.7807901}
confusion matrix:
       0    1
0  17953  114
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.86188287, 'recall': 0.61754894, 'specificity': 0.61754894, 'f1': 0.67225593, 'auroc': 0.94376886, 'binary_precision': 0.75609756, 'binary_recall': 0.23846154, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.36257312}
confusion matrix:
      0   1
0  5926  20
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 13,now: 2024-06-01 02:24:47.648743,epoch time: 0:34:21.281991,used: 7:20:56.739386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9898304, 'precision': 0.9482628, 'recall': 0.88487804, 'specificity': 0.88487804, 'f1': 0.913982, 'auroc': 0.99630237, 'binary_precision': 0.90422076, 'binary_recall': 0.7725381, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.8332087}
confusion matrix:
       0     1
0  42296   118
1    328  1114
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.92910004, 'recall': 0.8243527, 'specificity': 0.8243527, 'f1': 0.86886406, 'auroc': 0.9783453, 'binary_precision': 0.87103176, 'binary_recall': 0.6523031, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.74596435}
confusion matrix:
       0    1
0  18002   65
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8788693, 'recall': 0.5589427, 'specificity': 0.5589427, 'f1': 0.59389603, 'auroc': 0.95131147, 'binary_precision': 0.7948718, 'binary_recall': 0.11923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.20735787}
confusion matrix:
      0   1
0  5938   8
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9648727178573608 / 0.9740573763847351
after epoch: 14,now: 2024-06-01 02:58:29.600752,epoch time: 0:33:41.952009,used: 7:54:38.691395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9832406, 'precision': 0.85312235, 'recall': 0.9055877, 'specificity': 0.9055877, 'f1': 0.877375, 'auroc': 0.9935138, 'binary_precision': 0.71231234, 'binary_recall': 0.8224688, 'binary_specificity': 0.9887066, 'binary_f1_score': 0.76343745}
confusion matrix:
       0     1
0  41935   479
1    256  1186
---- Validation: 
scalar performance:
{'acc': 0.98159015, 'precision': 0.8692922, 'recall': 0.86241937, 'specificity': 0.86241937, 'f1': 0.8658205, 'auroc': 0.97465616, 'binary_precision': 0.74848485, 'binary_recall': 0.73402673, 'binary_specificity': 0.990812, 'binary_f1_score': 0.7411853}
confusion matrix:
       0    1
0  17901  166
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9099359, 'recall': 0.55727184, 'specificity': 0.55727184, 'f1': 0.5919978, 'auroc': 0.94120383, 'binary_precision': 0.85714287, 'binary_recall': 0.115384616, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5941   5
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9815901517868042, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9648727178573608 / 0.9740573763847351
after epoch: 15,now: 2024-06-01 03:32:37.788504,epoch time: 0:34:08.187752,used: 8:28:46.879147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99126685, 'precision': 0.9572871, 'recall': 0.90035856, 'specificity': 0.90035856, 'f1': 0.92679524, 'auroc': 0.9967102, 'binary_precision': 0.92124104, 'binary_recall': 0.8030513, 'binary_specificity': 0.9976659, 'binary_f1_score': 0.8580956}
confusion matrix:
       0     1
0  42315    99
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.91945195, 'recall': 0.84025466, 'specificity': 0.84025466, 'f1': 0.87538415, 'auroc': 0.97564507, 'binary_precision': 0.8505535, 'binary_recall': 0.68499255, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7588477}
confusion matrix:
       0    1
0  17986   81
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.9093052, 'recall': 0.5992432, 'specificity': 0.5992432, 'f1': 0.65302014, 'auroc': 0.9452976, 'binary_precision': 0.852459, 'binary_recall': 0.2, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.32398754}
confusion matrix:
      0   1
0  5937   9
1   208  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9843649864196777, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9648727178573608 / 0.9740573763847351
after epoch: 16,now: 2024-06-01 04:06:44.830616,epoch time: 0:34:07.042112,used: 9:02:53.921259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9913809, 'precision': 0.94975877, 'recall': 0.9104661, 'specificity': 0.9104661, 'f1': 0.9291479, 'auroc': 0.9950149, 'binary_precision': 0.9054878, 'binary_recall': 0.82385576, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.86274505}
confusion matrix:
       0     1
0  42290   124
1    254  1188
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.92245084, 'recall': 0.83593535, 'specificity': 0.83593535, 'f1': 0.87385464, 'auroc': 0.9590177, 'binary_precision': 0.8568738, 'binary_recall': 0.67607725, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7558139}
confusion matrix:
       0    1
0  17991   76
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.6463559, 'recall': 0.51579404, 'specificity': 0.51579404, 'f1': 0.5202661, 'auroc': 0.84260964, 'binary_precision': 0.33333334, 'binary_recall': 0.034615386, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.06271777}
confusion matrix:
      0   1
0  5928  18
1   251   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9843116402626038, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9648727178573608 / 0.9740573763847351
after epoch: 17,now: 2024-06-01 04:40:55.310643,epoch time: 0:34:10.480027,used: 9:37:04.401286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9929314, 'precision': 0.97847974, 'recall': 0.90758324, 'specificity': 0.90758324, 'f1': 0.93999434, 'auroc': 0.9972919, 'binary_precision': 0.9631751, 'binary_recall': 0.81622744, 'binary_specificity': 0.99893904, 'binary_f1_score': 0.8836336}
confusion matrix:
       0     1
0  42369    45
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.9517716, 'recall': 0.8368763, 'specificity': 0.8368763, 'f1': 0.8853086, 'auroc': 0.9705194, 'binary_precision': 0.91549295, 'binary_recall': 0.67607725, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.77777773}
confusion matrix:
       0    1
0  18025   42
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8861341, 'recall': 0.57992834, 'specificity': 0.57992834, 'f1': 0.62519395, 'auroc': 0.928867, 'binary_precision': 0.8076923, 'binary_recall': 0.16153847, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5936  10
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 18,now: 2024-06-01 05:15:04.575803,epoch time: 0:34:09.265160,used: 10:11:13.666446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99336463, 'precision': 0.9433104, 'recall': 0.95369565, 'specificity': 0.95369565, 'f1': 0.94843817, 'auroc': 0.99731815, 'binary_precision': 0.88964117, 'binary_recall': 0.9112344, 'binary_specificity': 0.99615693, 'binary_f1_score': 0.9003083}
confusion matrix:
       0     1
0  42251   163
1    128  1314
---- Validation: 
scalar performance:
{'acc': 0.9875667, 'precision': 0.9234735, 'recall': 0.89126855, 'specificity': 0.89126855, 'f1': 0.9066801, 'auroc': 0.9724721, 'binary_precision': 0.8548387, 'binary_recall': 0.78751856, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.8197989}
confusion matrix:
       0    1
0  17977   90
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74611425, 'recall': 0.56837887, 'specificity': 0.56837887, 'f1': 0.6015269, 'auroc': 0.9170344, 'binary_precision': 0.5285714, 'binary_recall': 0.1423077, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.22424242}
confusion matrix:
      0   1
0  5913  33
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 19,now: 2024-06-01 05:48:55.714259,epoch time: 0:33:51.138456,used: 10:45:04.804902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9946188, 'precision': 0.9579722, 'recall': 0.9573586, 'specificity': 0.9573586, 'f1': 0.9576652, 'auroc': 0.9986012, 'binary_precision': 0.91875, 'binary_recall': 0.9174757, 'binary_specificity': 0.9972415, 'binary_f1_score': 0.9181124}
confusion matrix:
       0     1
0  42297   117
1    119  1323
---- Validation: 
scalar performance:
{'acc': 0.9878335, 'precision': 0.9309734, 'recall': 0.88640004, 'specificity': 0.88640004, 'f1': 0.90736943, 'auroc': 0.97280943, 'binary_precision': 0.8702163, 'binary_recall': 0.7771174, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.82103616}
confusion matrix:
       0    1
0  17989   78
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.79886436, 'recall': 0.56186384, 'specificity': 0.56186384, 'f1': 0.59560394, 'auroc': 0.91077936, 'binary_precision': 0.63461536, 'binary_recall': 0.12692308, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.21153848}
confusion matrix:
      0   1
0  5927  19
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 20,now: 2024-06-01 06:22:50.687213,epoch time: 0:33:54.972954,used: 11:18:59.777856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9929998, 'precision': 0.92762506, 'recall': 0.9695847, 'specificity': 0.9695847, 'f1': 0.947544, 'auroc': 0.99825174, 'binary_precision': 0.85714287, 'binary_recall': 0.9445215, 'binary_specificity': 0.994648, 'binary_f1_score': 0.8987133}
confusion matrix:
       0     1
0  42187   227
1     80  1362
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.8823532, 'recall': 0.9107106, 'specificity': 0.9107106, 'f1': 0.8959769, 'auroc': 0.97304946, 'binary_precision': 0.7710345, 'binary_recall': 0.8306092, 'binary_specificity': 0.990812, 'binary_f1_score': 0.79971385}
confusion matrix:
       0    1
0  17901  166
1    114  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.927986, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9850587248802185, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 21,now: 2024-06-01 06:57:12.626041,epoch time: 0:34:21.938828,used: 11:53:21.716684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99450475, 'precision': 0.9544708, 'recall': 0.9596443, 'specificity': 0.9596443, 'f1': 0.95704186, 'auroc': 0.99864733, 'binary_precision': 0.9115833, 'binary_recall': 0.9223301, 'binary_specificity': 0.99695855, 'binary_f1_score': 0.9169252}
confusion matrix:
       0     1
0  42285   129
1    112  1330
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.89622366, 'recall': 0.86438, 'specificity': 0.86438, 'f1': 0.8795761, 'auroc': 0.96758723, 'binary_precision': 0.80226904, 'binary_recall': 0.7355126, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.7674418}
confusion matrix:
       0    1
0  17945  122
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7113568, 'recall': 0.55291015, 'specificity': 0.55291015, 'f1': 0.5788229, 'auroc': 0.8968241, 'binary_precision': 0.46031746, 'binary_recall': 0.11153846, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.17956658}
confusion matrix:
      0   1
0  5912  34
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9839914441108704, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 22,now: 2024-06-01 07:31:24.153809,epoch time: 0:34:11.527768,used: 12:27:33.244452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99587286, 'precision': 0.96976316, 'recall': 0.965041, 'specificity': 0.965041, 'f1': 0.9673892, 'auroc': 0.9990512, 'binary_precision': 0.941836, 'binary_recall': 0.93203884, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.9369118}
confusion matrix:
       0     1
0  42331    83
1     98  1344
---- Validation: 
scalar performance:
{'acc': 0.98735327, 'precision': 0.9327693, 'recall': 0.87613726, 'specificity': 0.87613726, 'f1': 0.9023065, 'auroc': 0.9780533, 'binary_precision': 0.8745704, 'binary_recall': 0.756315, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.81115544}
confusion matrix:
       0    1
0  17994   73
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.77550006, 'recall': 0.56896746, 'specificity': 0.56896746, 'f1': 0.60425246, 'auroc': 0.93717086, 'binary_precision': 0.5873016, 'binary_recall': 0.1423077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.22910218}
confusion matrix:
      0   1
0  5920  26
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9873532652854919, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 23,now: 2024-06-01 08:05:32.034933,epoch time: 0:34:07.881124,used: 13:01:41.125576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9931594, 'precision': 0.9794774, 'recall': 0.9103807, 'specificity': 0.9103807, 'f1': 0.9420564, 'auroc': 0.99840885, 'binary_precision': 0.9649837, 'binary_recall': 0.8217753, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.8876405}
confusion matrix:
       0     1
0  42371    43
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.9294468, 'recall': 0.8177216, 'specificity': 0.8177216, 'f1': 0.86456895, 'auroc': 0.97106516, 'binary_precision': 0.872211, 'binary_recall': 0.63893014, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7375644}
confusion matrix:
       0    1
0  18004   63
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.84613776, 'recall': 0.6002413, 'specificity': 0.6002413, 'f1': 0.6497627, 'auroc': 0.9128082, 'binary_precision': 0.72602737, 'binary_recall': 0.20384616, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.3183183}
confusion matrix:
      0   1
0  5926  20
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9836713075637817, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 24,now: 2024-06-01 08:39:29.904003,epoch time: 0:33:57.869070,used: 13:35:38.994646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9945275, 'precision': 0.9474889, 'recall': 0.9690348, 'specificity': 0.9690348, 'f1': 0.95798874, 'auroc': 0.998593, 'binary_precision': 0.8969617, 'binary_recall': 0.94174755, 'binary_specificity': 0.996322, 'binary_f1_score': 0.9188092}
confusion matrix:
       0     1
0  42258   156
1     84  1358
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.9153999, 'recall': 0.8879924, 'specificity': 0.8879924, 'f1': 0.901188, 'auroc': 0.96458066, 'binary_precision': 0.83891547, 'binary_recall': 0.781575, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.8092307}
confusion matrix:
       0    1
0  17966  101
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.83339816, 'recall': 0.5887028, 'specificity': 0.5887028, 'f1': 0.63409084, 'auroc': 0.9034456, 'binary_precision': 0.70149255, 'binary_recall': 0.18076923, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2874618}
confusion matrix:
      0   1
0  5926  20
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 5
val acc:0.9867662787437439, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 25,now: 2024-06-01 09:13:18.710816,epoch time: 0:33:48.806813,used: 14:09:27.801459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99621487, 'precision': 0.97507495, 'recall': 0.96488285, 'specificity': 0.96488285, 'f1': 0.96991956, 'auroc': 0.99929357, 'binary_precision': 0.9524823, 'binary_recall': 0.93134534, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.94179523}
confusion matrix:
       0     1
0  42347    67
1     99  1343
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.9406764, 'recall': 0.863867, 'specificity': 0.863867, 'f1': 0.898309, 'auroc': 0.9773146, 'binary_precision': 0.8913044, 'binary_recall': 0.73105496, 'binary_specificity': 0.996679, 'binary_f1_score': 0.80326533}
confusion matrix:
       0    1
0  18007   60
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7716323, 'recall': 0.54656327, 'specificity': 0.54656327, 'f1': 0.5720615, 'auroc': 0.9208542, 'binary_precision': 0.5813953, 'binary_recall': 0.09615385, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.1650165}
confusion matrix:
      0   1
0  5928  18
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 6
val acc:0.9871398210525513, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 26,now: 2024-06-01 09:47:08.046532,epoch time: 0:33:49.335716,used: 14:43:17.137175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954168, 'precision': 0.95249104, 'recall': 0.9782033, 'specificity': 0.9782033, 'f1': 0.96496433, 'auroc': 0.9987922, 'binary_precision': 0.90635234, 'binary_recall': 0.9597781, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.9323005}
confusion matrix:
       0     1
0  42271   143
1     58  1384
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.8972705, 'recall': 0.9114578, 'specificity': 0.9114578, 'f1': 0.90422827, 'auroc': 0.9682672, 'binary_precision': 0.8008596, 'binary_recall': 0.8306092, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.8154631}
confusion matrix:
       0    1
0  17928  139
1    114  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8171383, 'recall': 0.61662394, 'specificity': 0.61662394, 'f1': 0.6661424, 'auroc': 0.8724923, 'binary_precision': 0.6666667, 'binary_recall': 0.23846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3512748}
confusion matrix:
      0   1
0  5915  31
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 7
val acc:0.9864994883537292, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 27,now: 2024-06-01 10:21:05.229410,epoch time: 0:33:57.182878,used: 15:17:14.320053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99455035, 'precision': 0.94653904, 'recall': 0.97072136, 'specificity': 0.97072136, 'f1': 0.9582864, 'auroc': 0.9990521, 'binary_precision': 0.8949442, 'binary_recall': 0.945215, 'binary_specificity': 0.9962277, 'binary_f1_score': 0.91939294}
confusion matrix:
       0     1
0  42254   160
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.89743227, 'recall': 0.8717817, 'specificity': 0.8717817, 'f1': 0.8841413, 'auroc': 0.97090197, 'binary_precision': 0.80414015, 'binary_recall': 0.75037146, 'binary_specificity': 0.993192, 'binary_f1_score': 0.77632594}
confusion matrix:
       0    1
0  17944  123
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8726929, 'recall': 0.64430386, 'specificity': 0.64430386, 'f1': 0.70374566, 'auroc': 0.91254056, 'binary_precision': 0.7755102, 'binary_recall': 0.2923077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.42458102}
confusion matrix:
      0   1
0  5924  22
1   184  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 8
val acc:0.9844717383384705, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 28,now: 2024-06-01 10:54:59.315680,epoch time: 0:33:54.086270,used: 15:51:08.406323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9965797, 'precision': 0.9767606, 'recall': 0.9690909, 'specificity': 0.9690909, 'f1': 0.97289234, 'auroc': 0.99954295, 'binary_precision': 0.95557123, 'binary_recall': 0.9396671, 'binary_specificity': 0.99851465, 'binary_f1_score': 0.94755244}
confusion matrix:
       0     1
0  42351    63
1     87  1355
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.9360256, 'recall': 0.86887383, 'specificity': 0.86887383, 'f1': 0.8994192, 'auroc': 0.9722045, 'binary_precision': 0.8816254, 'binary_recall': 0.74145615, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.8054883}
confusion matrix:
       0    1
0  18000   67
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.95897686, 'recall': 0.578678, 'specificity': 0.578678, 'f1': 0.62618816, 'auroc': 0.9258917, 'binary_precision': 0.95348835, 'binary_recall': 0.15769231, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.27062708}
confusion matrix:
      0   1
0  5944   2
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 9
val acc:0.9871398210525513, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 29,now: 2024-06-01 11:28:52.595284,epoch time: 0:33:53.279604,used: 16:25:01.685927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9963973, 'precision': 0.9768522, 'recall': 0.96598196, 'specificity': 0.96598196, 'f1': 0.9713498, 'auroc': 0.99953544, 'binary_precision': 0.95596594, 'binary_recall': 0.9334258, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.9445614}
confusion matrix:
       0     1
0  42352    62
1     96  1346
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.93334866, 'recall': 0.858445, 'specificity': 0.858445, 'f1': 0.89206475, 'auroc': 0.97296405, 'binary_precision': 0.87703437, 'binary_recall': 0.7206538, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.7911908}
confusion matrix:
       0    1
0  17999   68
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.9123749, 'recall': 0.58210367, 'specificity': 0.58210367, 'f1': 0.62945503, 'auroc': 0.92928743, 'binary_precision': 0.86, 'binary_recall': 0.16538462, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.27741936}
confusion matrix:
      0   1
0  5939   7
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 10
val acc:0.9863393902778625, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9603609442710876 / 0.9740573763847351
after epoch: 30,now: 2024-06-01 12:02:44.981441,epoch time: 0:33:52.386157,used: 16:58:54.072084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_19_03_50_seed_1_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:58:54.072084 at 2024-06-01 12:02:44.981441
persisted model performance metric: 

scalar performance:
{'acc': 0.96019983, 'precision': 0.8103713, 'recall': 0.55074584, 'specificity': 0.55074584, 'f1': 0.57950366, 'auroc': 0.9232742, 'binary_precision': 0.6585366, 'binary_recall': 0.103846155, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.179402}
confusion matrix:
      0   1
0  5932  14
1   233  27
oracle model performance metric: 

scalar performance:
{'acc': 0.9738962, 'precision': 0.9486453, 'recall': 0.70501244, 'specificity': 0.70501244, 'f1': 0.77784467, 'auroc': 0.9390264, 'binary_precision': 0.92241377, 'binary_recall': 0.41153845, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.5691489}
confusion matrix:
      0    1
0  5937    9
1   153  107
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16636 MiB |  16636 MiB |  31178 MiB |  14542 MiB |
|       from large pool |  16608 MiB |  16608 MiB |  31148 MiB |  14540 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436746 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool | 416800 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304912 K  |  304909 K  |
|       from large pool |     247    |     989    |  124200 K  |  124200 K  |
|       from small pool |    3095    |    6116    |  180712 K  |  180709 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304912 K  |  304909 K  |
|       from large pool |     247    |     989    |  124200 K  |  124200 K  |
|       from small pool |    3095    |    6116    |  180712 K  |  180709 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |    1118    |     501    |
|       from large pool |     603    |     603    |    1103    |     500    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2874    |  167440 K  |  167440 K  |
|       from large pool |     109    |     508    |   81846 K  |   81846 K  |
|       from small pool |      35    |    2764    |   85593 K  |   85593 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180712 K  |  180712 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180712 K  |  180712 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |  167441 K  |  167441 K  |
|       from large pool |       2    |     508    |   81846 K  |   81846 K  |
|       from small pool |       0    |    2764    |   85594 K  |   85594 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180712 K  |  180712 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304912 K  |  304912 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180712 K  |  180712 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |  167441 K  |  167441 K  |
|       from large pool |       2    |     508    |   81846 K  |   81846 K  |
|       from small pool |       0    |    2764    |   85594 K  |   85594 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759

 Experiment start at: 2024-06-01 12:15:32.247439
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97416943, 'precision': 0.8066272, 'recall': 0.8046726, 'specificity': 0.8046726, 'f1': 0.8056464, 'auroc': 0.9687847, 'binary_precision': 0.62674654, 'binary_recall': 0.6226041, 'binary_specificity': 0.98674107, 'binary_f1_score': 0.6246685}
confusion matrix:
       0    1
0  41750  561
1    571  942
---- Validation: 
scalar performance:
{'acc': 0.97235394, 'precision': 0.7789887, 'recall': 0.76327455, 'specificity': 0.76327455, 'f1': 0.77088183, 'auroc': 0.9641169, 'binary_precision': 0.57319224, 'binary_recall': 0.5398671, 'binary_specificity': 0.98668206, 'binary_f1_score': 0.55603087}
confusion matrix:
       0    1
0  17929  242
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.871047, 'recall': 0.71220803, 'specificity': 0.71220803, 'f1': 0.7681075, 'auroc': 0.94678605, 'binary_precision': 0.7647059, 'binary_recall': 0.42975205, 'binary_specificity': 0.994664, 'binary_f1_score': 0.55026454}
confusion matrix:
      0    1
0  5965   32
1   138  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 12:51:01.473835,epoch time: 0:35:29.226396,used: 0:35:29.226396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97512776, 'precision': 0.96509206, 'recall': 0.6464802, 'specificity': 0.6464802, 'f1': 0.7181076, 'auroc': 0.9743973, 'binary_precision': 0.9548387, 'binary_recall': 0.2934567, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.4489383}
confusion matrix:
       0    1
0  42290   21
1   1069  444
---- Validation: 
scalar performance:
{'acc': 0.9753902, 'precision': 0.95660794, 'recall': 0.62430954, 'specificity': 0.62430954, 'f1': 0.6905705, 'auroc': 0.9633199, 'binary_precision': 0.9375, 'binary_recall': 0.24916944, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.39370078}
confusion matrix:
       0    1
0  18161   10
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.91864264, 'recall': 0.51437944, 'specificity': 0.51437944, 'f1': 0.51835, 'auroc': 0.9568815, 'binary_precision': 0.875, 'binary_recall': 0.02892562, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.055999998}
confusion matrix:
      0  1
0  5996  1
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 2,now: 2024-06-01 13:24:56.960324,epoch time: 0:33:55.486489,used: 1:09:24.712885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9819962, 'precision': 0.8604177, 'recall': 0.87532413, 'specificity': 0.87532413, 'f1': 0.8677059, 'auroc': 0.9823152, 'binary_precision': 0.72940433, 'binary_recall': 0.7607403, 'binary_specificity': 0.98990804, 'binary_f1_score': 0.7447428}
confusion matrix:
       0     1
0  41884   427
1    362  1151
---- Validation: 
scalar performance:
{'acc': 0.98077023, 'precision': 0.8428857, 'recall': 0.8511392, 'specificity': 0.8511392, 'f1': 0.84695905, 'auroc': 0.9743565, 'binary_precision': 0.69529986, 'binary_recall': 0.7126246, 'binary_specificity': 0.9896538, 'binary_f1_score': 0.70385563}
confusion matrix:
       0    1
0  17983  188
1    173  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.8645227, 'recall': 0.7099752, 'specificity': 0.7099752, 'f1': 0.76461846, 'auroc': 0.95597863, 'binary_precision': 0.7518248, 'binary_recall': 0.42561984, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.5435356}
confusion matrix:
      0    1
0  5963   34
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 3,now: 2024-06-01 13:58:37.095947,epoch time: 0:33:40.135623,used: 1:43:04.848508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98211026, 'precision': 0.9237999, 'recall': 0.78488606, 'specificity': 0.78488606, 'f1': 0.8397162, 'auroc': 0.9851421, 'binary_precision': 0.8626866, 'binary_recall': 0.5730337, 'binary_specificity': 0.99673843, 'binary_f1_score': 0.6886418}
confusion matrix:
       0    1
0  42173  138
1    646  867
---- Validation: 
scalar performance:
{'acc': 0.9772013, 'precision': 0.85680413, 'recall': 0.7256262, 'specificity': 0.7256262, 'f1': 0.775334, 'auroc': 0.9740829, 'binary_precision': 0.73138297, 'binary_recall': 0.45681062, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.56237215}
confusion matrix:
       0    1
0  18070  101
1    327  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.8263587, 'recall': 0.6135347, 'specificity': 0.6135347, 'f1': 0.66411805, 'auroc': 0.95436406, 'binary_precision': 0.68292683, 'binary_recall': 0.23140496, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.34567901}
confusion matrix:
      0   1
0  5971  26
1   186  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9772012829780579, best validation acc: 0.9807702302932739, corresponding to test acc:                         0.972271203994751 / 0.972752034664154
after epoch: 4,now: 2024-06-01 14:31:56.648867,epoch time: 0:33:19.552920,used: 2:16:24.401428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9831143, 'precision': 0.8624517, 'recall': 0.8978902, 'specificity': 0.8978902, 'f1': 0.87926745, 'auroc': 0.9857773, 'binary_precision': 0.7318536, 'binary_recall': 0.806345, 'binary_specificity': 0.9894354, 'binary_f1_score': 0.76729554}
confusion matrix:
       0     1
0  41864   447
1    293  1220
---- Validation: 
scalar performance:
{'acc': 0.98045063, 'precision': 0.83117807, 'recall': 0.8782778, 'specificity': 0.8782778, 'f1': 0.8530203, 'auroc': 0.9814001, 'binary_precision': 0.6700434, 'binary_recall': 0.769103, 'binary_specificity': 0.9874525, 'binary_f1_score': 0.716164}
confusion matrix:
       0    1
0  17943  228
1    139  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8325602, 'recall': 0.67650044, 'specificity': 0.67650044, 'f1': 0.72840315, 'auroc': 0.9625779, 'binary_precision': 0.6904762, 'binary_recall': 0.35950413, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4728261}
confusion matrix:
      0   1
0  5958  39
1   155  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9804506301879883, best validation acc: 0.9807702302932739, corresponding to test acc:                         0.972271203994751 / 0.972752034664154
after epoch: 5,now: 2024-06-01 15:05:22.251200,epoch time: 0:33:25.602333,used: 2:49:50.003761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984278, 'precision': 0.90946233, 'recall': 0.8398609, 'specificity': 0.8398609, 'f1': 0.871168, 'auroc': 0.9886315, 'binary_precision': 0.8301282, 'binary_recall': 0.6847323, 'binary_specificity': 0.99498945, 'binary_f1_score': 0.7504527}
confusion matrix:
       0     1
0  42099   212
1    477  1036
---- Validation: 
scalar performance:
{'acc': 0.97890586, 'precision': 0.8506348, 'recall': 0.7803109, 'specificity': 0.7803109, 'f1': 0.811237, 'auroc': 0.9762753, 'binary_precision': 0.71548116, 'binary_recall': 0.5681063, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.6333333}
confusion matrix:
       0    1
0  18035  136
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8507951, 'recall': 0.6058539, 'specificity': 0.6058539, 'f1': 0.65754396, 'auroc': 0.95685303, 'binary_precision': 0.73239434, 'binary_recall': 0.21487603, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.33226833}
confusion matrix:
      0   1
0  5978  19
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9789058566093445, best validation acc: 0.9807702302932739, corresponding to test acc:                         0.972271203994751 / 0.972752034664154
after epoch: 6,now: 2024-06-01 15:38:43.610477,epoch time: 0:33:21.359277,used: 3:23:11.363038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.987678, 'precision': 0.9394361, 'recall': 0.8661579, 'specificity': 0.8661579, 'f1': 0.8992052, 'auroc': 0.99049556, 'binary_precision': 0.8882682, 'binary_recall': 0.7356246, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.80477226}
confusion matrix:
       0     1
0  42171   140
1    400  1113
---- Validation: 
scalar performance:
{'acc': 0.98311406, 'precision': 0.92687476, 'recall': 0.77766645, 'specificity': 0.77766645, 'f1': 0.8354014, 'auroc': 0.9732849, 'binary_precision': 0.86821705, 'binary_recall': 0.55813956, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.6794743}
confusion matrix:
       0    1
0  18120   51
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.83965415, 'recall': 0.55081916, 'specificity': 0.55081916, 'f1': 0.5809502, 'auroc': 0.94706225, 'binary_precision': 0.71428573, 'binary_recall': 0.10330579, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18050541}
confusion matrix:
      0   1
0  5987  10
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 7,now: 2024-06-01 16:11:52.177910,epoch time: 0:33:08.567433,used: 3:56:19.930471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9862176, 'precision': 0.96160495, 'recall': 0.82174623, 'specificity': 0.82174623, 'f1': 0.87829757, 'auroc': 0.99270946, 'binary_precision': 0.9357622, 'binary_recall': 0.64507604, 'binary_specificity': 0.9984165, 'binary_f1_score': 0.76369333}
confusion matrix:
       0    1
0  42244   67
1    537  976
---- Validation: 
scalar performance:
{'acc': 0.9809833, 'precision': 0.92123663, 'recall': 0.7420347, 'specificity': 0.7420347, 'f1': 0.8058338, 'auroc': 0.9799501, 'binary_precision': 0.85923755, 'binary_recall': 0.48671097, 'binary_specificity': 0.99735844, 'binary_f1_score': 0.62142104}
confusion matrix:
       0    1
0  18123   48
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.92240614, 'recall': 0.5739633, 'specificity': 0.5739633, 'f1': 0.6185574, 'auroc': 0.9563725, 'binary_precision': 0.8780488, 'binary_recall': 0.14876033, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.25441697}
confusion matrix:
      0   1
0  5992   5
1   206  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.980983316898346, best validation acc: 0.9831140637397766, corresponding to test acc:                         0.9636159539222717 / 0.972752034664154
after epoch: 8,now: 2024-06-01 16:45:22.104139,epoch time: 0:33:29.926229,used: 4:29:49.856700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9865142, 'precision': 0.9380244, 'recall': 0.8477107, 'specificity': 0.8477107, 'f1': 0.8872791, 'auroc': 0.992127, 'binary_precision': 0.886745, 'binary_recall': 0.69861203, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.7815157}
confusion matrix:
       0     1
0  42176   135
1    456  1057
---- Validation: 
scalar performance:
{'acc': 0.98428595, 'precision': 0.9007617, 'recall': 0.82886386, 'specificity': 0.82886386, 'f1': 0.861004, 'auroc': 0.9827827, 'binary_precision': 0.8126273, 'binary_recall': 0.6627907, 'binary_specificity': 0.994937, 'binary_f1_score': 0.7301006}
confusion matrix:
       0    1
0  18079   92
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8583629, 'recall': 0.5733797, 'specificity': 0.5733797, 'f1': 0.6151947, 'auroc': 0.9410578, 'binary_precision': 0.75, 'binary_recall': 0.14876033, 'binary_specificity': 0.997999, 'binary_f1_score': 0.24827588}
confusion matrix:
      0   1
0  5985  12
1   206  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 9,now: 2024-06-01 17:18:52.934842,epoch time: 0:33:30.830703,used: 5:03:20.687403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99009675, 'precision': 0.91968834, 'recall': 0.93464607, 'specificity': 0.93464607, 'f1': 0.9270252, 'auroc': 0.9946648, 'binary_precision': 0.8438496, 'binary_recall': 0.8750826, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.8591824}
confusion matrix:
       0     1
0  42066   245
1    189  1324
---- Validation: 
scalar performance:
{'acc': 0.98577744, 'precision': 0.8930681, 'recall': 0.87219584, 'specificity': 0.87219584, 'f1': 0.88232476, 'auroc': 0.9823183, 'binary_precision': 0.7943761, 'binary_recall': 0.7508306, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.77198976}
confusion matrix:
       0    1
0  18054  117
1    150  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.79652786, 'recall': 0.5907241, 'specificity': 0.5907241, 'f1': 0.6341046, 'auroc': 0.95876276, 'binary_precision': 0.625, 'binary_recall': 0.18595041, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5970  27
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 10,now: 2024-06-01 17:52:37.585382,epoch time: 0:33:44.650540,used: 5:37:05.337943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98945785, 'precision': 0.9397142, 'recall': 0.8963956, 'specificity': 0.8963956, 'f1': 0.9168434, 'auroc': 0.99396133, 'binary_precision': 0.8866814, 'binary_recall': 0.79643095, 'binary_specificity': 0.9963603, 'binary_f1_score': 0.8391365}
confusion matrix:
       0     1
0  42157   154
1    308  1205
---- Validation: 
scalar performance:
{'acc': 0.98476535, 'precision': 0.89361715, 'recall': 0.84918773, 'specificity': 0.84918773, 'f1': 0.86997044, 'auroc': 0.97629946, 'binary_precision': 0.7969925, 'binary_recall': 0.70431894, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.7477954}
confusion matrix:
       0    1
0  18063  108
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.91388345, 'recall': 0.53900605, 'specificity': 0.53900605, 'f1': 0.56271803, 'auroc': 0.9494952, 'binary_precision': 0.8636364, 'binary_recall': 0.0785124, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14393939}
confusion matrix:
      0   1
0  5994   3
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.984765350818634, best validation acc: 0.9857774376869202, corresponding to test acc:                         0.9640967845916748 / 0.972752034664154
after epoch: 11,now: 2024-06-01 18:26:22.871209,epoch time: 0:33:45.285827,used: 6:10:50.623770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9912149, 'precision': 0.972496, 'recall': 0.8915698, 'specificity': 0.8915698, 'f1': 0.9279607, 'auroc': 0.9966519, 'binary_precision': 0.95264846, 'binary_recall': 0.78453404, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.8604567}
confusion matrix:
       0     1
0  42252    59
1    326  1187
---- Validation: 
scalar performance:
{'acc': 0.9830608, 'precision': 0.8993689, 'recall': 0.8049426, 'specificity': 0.8049426, 'f1': 0.84535885, 'auroc': 0.9761397, 'binary_precision': 0.8114035, 'binary_recall': 0.61461794, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.6994329}
confusion matrix:
       0    1
0  18085   86
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.8620566, 'recall': 0.53875595, 'specificity': 0.53875595, 'f1': 0.5617842, 'auroc': 0.95513713, 'binary_precision': 0.76, 'binary_recall': 0.0785124, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1423221}
confusion matrix:
      0   1
0  5991   6
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9830607771873474, best validation acc: 0.9857774376869202, corresponding to test acc:                         0.9640967845916748 / 0.972752034664154
after epoch: 12,now: 2024-06-01 19:00:02.675924,epoch time: 0:33:39.804715,used: 6:44:30.428485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99189943, 'precision': 0.94536155, 'recall': 0.93143713, 'specificity': 0.93143713, 'f1': 0.93827987, 'auroc': 0.9975389, 'binary_precision': 0.8954918, 'binary_recall': 0.8664904, 'binary_specificity': 0.9963839, 'binary_f1_score': 0.88075244}
confusion matrix:
       0     1
0  42158   153
1    202  1311
---- Validation: 
scalar performance:
{'acc': 0.98364675, 'precision': 0.8736725, 'recall': 0.8574434, 'specificity': 0.8574434, 'f1': 0.8653631, 'auroc': 0.97610784, 'binary_precision': 0.75652176, 'binary_recall': 0.72259134, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.7391674}
confusion matrix:
       0    1
0  18031  140
1    167  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.77611995, 'recall': 0.554201, 'specificity': 0.554201, 'f1': 0.5841519, 'auroc': 0.9491478, 'binary_precision': 0.5869565, 'binary_recall': 0.11157025, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18749999}
confusion matrix:
      0   1
0  5978  19
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9836467504501343, best validation acc: 0.9857774376869202, corresponding to test acc:                         0.9640967845916748 / 0.972752034664154
after epoch: 13,now: 2024-06-01 19:33:48.635391,epoch time: 0:33:45.959467,used: 7:18:16.387952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9927893, 'precision': 0.94492537, 'recall': 0.9471934, 'specificity': 0.9471934, 'f1': 0.94605625, 'auroc': 0.99749964, 'binary_precision': 0.89349115, 'binary_recall': 0.8982155, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.8958471}
confusion matrix:
       0     1
0  42149   162
1    154  1359
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.883953, 'recall': 0.87840015, 'specificity': 0.87840015, 'f1': 0.88115466, 'auroc': 0.9801624, 'binary_precision': 0.7757167, 'binary_recall': 0.7641196, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.76987445}
confusion matrix:
       0    1
0  18038  133
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.82026327, 'recall': 0.6154341, 'specificity': 0.6154341, 'f1': 0.6655472, 'auroc': 0.9571967, 'binary_precision': 0.67058825, 'binary_recall': 0.23553719, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34862384}
confusion matrix:
      0   1
0  5969  28
1   185  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9853513240814209, best validation acc: 0.9857774376869202, corresponding to test acc:                         0.9640967845916748 / 0.972752034664154
after epoch: 14,now: 2024-06-01 20:07:24.962017,epoch time: 0:33:36.326626,used: 7:51:52.714578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99189943, 'precision': 0.9445895, 'recall': 0.93239313, 'specificity': 0.93239313, 'f1': 0.9383997, 'auroc': 0.99756, 'binary_precision': 0.89387757, 'binary_recall': 0.86847323, 'binary_specificity': 0.99631304, 'binary_f1_score': 0.8809923}
confusion matrix:
       0     1
0  42155   156
1    199  1314
---- Validation: 
scalar performance:
{'acc': 0.9868961, 'precision': 0.90829355, 'recall': 0.87277377, 'specificity': 0.87277377, 'f1': 0.88966405, 'auroc': 0.9817585, 'binary_precision': 0.82481754, 'binary_recall': 0.7508306, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.786087}
confusion matrix:
       0    1
0  18075   96
1    150  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7819617, 'recall': 0.5361896, 'specificity': 0.5361896, 'f1': 0.5565091, 'auroc': 0.9397798, 'binary_precision': 0.6, 'binary_recall': 0.07438017, 'binary_specificity': 0.997999, 'binary_f1_score': 0.13235295}
confusion matrix:
      0   1
0  5985  12
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 15,now: 2024-06-01 20:42:02.428151,epoch time: 0:34:37.466134,used: 8:26:30.180712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99178535, 'precision': 0.96398264, 'recall': 0.90869415, 'specificity': 0.90869415, 'f1': 0.93445265, 'auroc': 0.9957677, 'binary_precision': 0.9343891, 'binary_recall': 0.8194444, 'binary_specificity': 0.9979438, 'binary_f1_score': 0.8731501}
confusion matrix:
       0     1
0  42225    87
1    273  1239
---- Validation: 
scalar performance:
{'acc': 0.98396635, 'precision': 0.9045201, 'recall': 0.81745607, 'specificity': 0.81745607, 'f1': 0.855351, 'auroc': 0.96278524, 'binary_precision': 0.8208955, 'binary_recall': 0.6395349, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.71895427}
confusion matrix:
       0    1
0  18087   84
1    217  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8892603, 'recall': 0.61255246, 'specificity': 0.61255246, 'f1': 0.6692011, 'auroc': 0.9157132, 'binary_precision': 0.8088235, 'binary_recall': 0.22727273, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.35483876}
confusion matrix:
      0   1
0  5984  13
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.9839663505554199, best validation acc: 0.9868960976600647, corresponding to test acc:                         0.9621734023094177 / 0.972752034664154
after epoch: 16,now: 2024-06-01 21:16:54.215936,epoch time: 0:34:51.787785,used: 9:01:21.968497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99340546, 'precision': 0.9478942, 'recall': 0.95388544, 'specificity': 0.95388544, 'f1': 0.95086825, 'auroc': 0.99782634, 'binary_precision': 0.89895695, 'binary_recall': 0.91143423, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.9051526}
confusion matrix:
       0     1
0  42156   155
1    134  1379
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.8835223, 'recall': 0.87427485, 'specificity': 0.87427485, 'f1': 0.8788376, 'auroc': 0.9761605, 'binary_precision': 0.77512777, 'binary_recall': 0.75581396, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.76534903}
confusion matrix:
       0    1
0  18039  132
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.877987, 'recall': 0.58379364, 'specificity': 0.58379364, 'f1': 0.6307559, 'auroc': 0.95703346, 'binary_precision': 0.78846157, 'binary_recall': 0.1694215, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2789116}
confusion matrix:
      0   1
0  5986  11
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9851382374763489, best validation acc: 0.9868960976600647, corresponding to test acc:                         0.9621734023094177 / 0.972752034664154
after epoch: 17,now: 2024-06-01 21:51:45.588987,epoch time: 0:34:51.373051,used: 9:36:13.341548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9937477, 'precision': 0.9767083, 'recall': 0.9272959, 'specificity': 0.9272959, 'f1': 0.95054895, 'auroc': 0.99819356, 'binary_precision': 0.9585492, 'binary_recall': 0.8559154, 'binary_specificity': 0.9986765, 'binary_f1_score': 0.90432966}
confusion matrix:
       0     1
0  42255    56
1    218  1295
---- Validation: 
scalar performance:
{'acc': 0.987482, 'precision': 0.92853653, 'recall': 0.8586215, 'specificity': 0.8586215, 'f1': 0.8902481, 'auroc': 0.9768169, 'binary_precision': 0.86626744, 'binary_recall': 0.7209302, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.7869447}
confusion matrix:
       0    1
0  18104   67
1    168  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.89919204, 'recall': 0.55123603, 'specificity': 0.55123603, 'f1': 0.5828179, 'auroc': 0.95223486, 'binary_precision': 0.8333333, 'binary_recall': 0.10330579, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.18382353}
confusion matrix:
      0   1
0  5992   5
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
better model found
persisted
after epoch: 18,now: 2024-06-01 22:27:06.276891,epoch time: 0:35:20.687904,used: 10:11:34.029452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9944779, 'precision': 0.9637708, 'recall': 0.95252895, 'specificity': 0.95252895, 'f1': 0.95807546, 'auroc': 0.99793565, 'binary_precision': 0.93084747, 'binary_recall': 0.9074686, 'binary_specificity': 0.9975893, 'binary_f1_score': 0.9190094}
confusion matrix:
       0     1
0  42209   102
1    140  1373
---- Validation: 
scalar performance:
{'acc': 0.9873222, 'precision': 0.91744995, 'recall': 0.8689786, 'specificity': 0.8689786, 'f1': 0.89160836, 'auroc': 0.9688822, 'binary_precision': 0.84339625, 'binary_recall': 0.7425249, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.7897527}
confusion matrix:
       0    1
0  18088   83
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.901981, 'recall': 0.5737966, 'specificity': 0.5737966, 'f1': 0.6175813, 'auroc': 0.9404263, 'binary_precision': 0.8372093, 'binary_recall': 0.14876033, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.25263157}
confusion matrix:
      0   1
0  5990   7
1   206  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 1
val acc:0.987322211265564, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 19,now: 2024-06-01 23:01:37.803208,epoch time: 0:34:31.526317,used: 10:46:05.555769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9941356, 'precision': 0.9502865, 'recall': 0.96318585, 'specificity': 0.96318585, 'f1': 0.9566376, 'auroc': 0.9983414, 'binary_precision': 0.9030809, 'binary_recall': 0.9299405, 'binary_specificity': 0.9964312, 'binary_f1_score': 0.9163139}
confusion matrix:
       0     1
0  42160   151
1    106  1407
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.88113356, 'recall': 0.87745947, 'specificity': 0.87745947, 'f1': 0.8792869, 'auroc': 0.9750835, 'binary_precision': 0.7701342, 'binary_recall': 0.76245844, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.76627713}
confusion matrix:
       0    1
0  18034  137
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8197856, 'recall': 0.5789944, 'specificity': 0.5789944, 'f1': 0.6208852, 'auroc': 0.94546413, 'binary_precision': 0.67241377, 'binary_recall': 0.16115703, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5978  19
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 2
val acc:0.9850849509239197, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 20,now: 2024-06-01 23:36:08.246303,epoch time: 0:34:30.443095,used: 11:20:35.998864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.993588, 'precision': 0.9723207, 'recall': 0.92912513, 'specificity': 0.92912513, 'f1': 0.94960856, 'auroc': 0.99860096, 'binary_precision': 0.949635, 'binary_recall': 0.85988104, 'binary_specificity': 0.9983692, 'binary_f1_score': 0.90253204}
confusion matrix:
       0     1
0  42242    69
1    212  1301
---- Validation: 
scalar performance:
{'acc': 0.9865232, 'precision': 0.9213387, 'recall': 0.84848964, 'specificity': 0.84848964, 'f1': 0.881215, 'auroc': 0.976208, 'binary_precision': 0.85252523, 'binary_recall': 0.7009967, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.7693711}
confusion matrix:
       0    1
0  18098   73
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8407573, 'recall': 0.60568714, 'specificity': 0.60568714, 'f1': 0.65640545, 'auroc': 0.9510298, 'binary_precision': 0.7123288, 'binary_recall': 0.21487603, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3301587}
confusion matrix:
      0   1
0  5976  21
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 3
val acc:0.9865232110023499, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 21,now: 2024-06-02 00:10:25.466578,epoch time: 0:34:17.220275,used: 11:54:53.219139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9943182, 'precision': 0.9857459, 'recall': 0.9275914, 'specificity': 0.9275914, 'f1': 0.95467854, 'auroc': 0.9987601, 'binary_precision': 0.9766214, 'binary_recall': 0.8559154, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.9122931}
confusion matrix:
       0     1
0  42280    31
1    218  1295
---- Validation: 
scalar performance:
{'acc': 0.9871091, 'precision': 0.93958974, 'recall': 0.8399588, 'specificity': 0.8399588, 'f1': 0.88296145, 'auroc': 0.9647976, 'binary_precision': 0.8896104, 'binary_recall': 0.68272424, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.77255636}
confusion matrix:
       0    1
0  18120   51
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.91102195, 'recall': 0.5492533, 'specificity': 0.5492533, 'f1': 0.5797965, 'auroc': 0.9347068, 'binary_precision': 0.85714287, 'binary_recall': 0.09917355, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17777778}
confusion matrix:
      0   1
0  5993   4
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 4
val acc:0.9871091246604919, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 22,now: 2024-06-02 00:43:48.117916,epoch time: 0:33:22.651338,used: 12:28:15.870477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9953222, 'precision': 0.97883785, 'recall': 0.9497796, 'specificity': 0.9497796, 'f1': 0.96381915, 'auroc': 0.99855614, 'binary_precision': 0.961213, 'binary_recall': 0.90085924, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.93005806}
confusion matrix:
       0     1
0  42256    55
1    150  1363
---- Validation: 
scalar performance:
{'acc': 0.9867363, 'precision': 0.92411005, 'recall': 0.8494028, 'specificity': 0.8494028, 'f1': 0.8828858, 'auroc': 0.97180843, 'binary_precision': 0.8580122, 'binary_recall': 0.7026578, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.7726028}
confusion matrix:
       0    1
0  18101   70
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.885623, 'recall': 0.57569593, 'specificity': 0.57569593, 'f1': 0.61969453, 'auroc': 0.9410856, 'binary_precision': 0.8043478, 'binary_recall': 0.15289256, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.25694445}
confusion matrix:
      0   1
0  5988   9
1   205  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 5
val acc:0.9867362976074219, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 23,now: 2024-06-02 01:17:32.077536,epoch time: 0:33:43.959620,used: 13:01:59.830097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9936336, 'precision': 0.95526356, 'recall': 0.9485865, 'specificity': 0.9485865, 'f1': 0.95189846, 'auroc': 0.9985283, 'binary_precision': 0.914094, 'binary_recall': 0.9001983, 'binary_specificity': 0.99697477, 'binary_f1_score': 0.907093}
confusion matrix:
       0     1
0  42183   128
1    151  1362
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.8884141, 'recall': 0.875298, 'specificity': 0.875298, 'f1': 0.8817344, 'auroc': 0.9775932, 'binary_precision': 0.7848537, 'binary_recall': 0.7574751, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.77092135}
confusion matrix:
       0    1
0  18046  125
1    146  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.7904246, 'recall': 0.65293944, 'specificity': 0.65293944, 'f1': 0.6982082, 'auroc': 0.94769096, 'binary_precision': 0.608, 'binary_recall': 0.3140496, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.41416895}
confusion matrix:
      0   1
0  5948  49
1   166  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993759.png
early stop counter: 6
val acc:0.9855643510818481, best validation acc: 0.9874820113182068, corresponding to test acc:                         0.9644173979759216 / 0.972752034664154
after epoch: 24,now: 2024-06-02 01:50:55.881280,epoch time: 0:33:23.803744,used: 13:35:23.633841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_12_15_32_seed_2_20993759
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 20993759 ON supergpu03 CANCELLED AT 2024-06-02T01:57:51 DUE TO TIME LIMIT ***
