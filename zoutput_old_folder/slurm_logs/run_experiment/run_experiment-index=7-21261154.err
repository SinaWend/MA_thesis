Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:34:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154

 Experiment start at: 2024-06-08 23:41:44.469781
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9718442, 'precision': 0.7842823, 'recall': 0.77625823, 'specificity': 0.77625823, 'f1': 0.780207, 'auroc': 0.96792996, 'binary_precision': 0.5836249, 'binary_recall': 0.56657606, 'binary_specificity': 0.98594046, 'binary_f1_score': 0.5749742}
confusion matrix:
       0    1
0  41725  595
1    638  834
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.7800212, 'recall': 0.74541473, 'specificity': 0.74541473, 'f1': 0.76146144, 'auroc': 0.9687346, 'binary_precision': 0.5775401, 'binary_recall': 0.503888, 'binary_specificity': 0.98694146, 'binary_f1_score': 0.538206}
confusion matrix:
       0    1
0  17912  237
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.8554772, 'recall': 0.81092274, 'specificity': 0.81092274, 'f1': 0.8315468, 'auroc': 0.9447254, 'binary_precision': 0.72687227, 'binary_recall': 0.6321839, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.6762295}
confusion matrix:
      0    1
0  5935   62
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:21:48.191641,epoch time: 0:40:03.721860,used: 0:40:03.721860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9777128, 'precision': 0.936911, 'recall': 0.69011694, 'specificity': 0.69011694, 'f1': 0.7619103, 'auroc': 0.9786228, 'binary_precision': 0.89490443, 'binary_recall': 0.38179347, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.5352381}
confusion matrix:
       0    1
0  42254   66
1    910  562
---- Validation: 
scalar performance:
{'acc': 0.97541505, 'precision': 0.92018616, 'recall': 0.6662484, 'specificity': 0.6662484, 'f1': 0.73473567, 'auroc': 0.97512877, 'binary_precision': 0.8634538, 'binary_recall': 0.33437014, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.48206273}
confusion matrix:
       0    1
0  18115   34
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.951589, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 01:00:26.595237,epoch time: 0:38:38.403596,used: 1:18:42.125456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98077273, 'precision': 0.86203146, 'recall': 0.82961607, 'specificity': 0.82961607, 'f1': 0.8449985, 'auroc': 0.98393166, 'binary_precision': 0.7355805, 'binary_recall': 0.6675731, 'binary_specificity': 0.991659, 'binary_f1_score': 0.6999287}
confusion matrix:
       0    1
0  41968  353
1    489  982
---- Validation: 
scalar performance:
{'acc': 0.9818008, 'precision': 0.9170508, 'recall': 0.7828127, 'specificity': 0.7828127, 'f1': 0.83609843, 'auroc': 0.9761027, 'binary_precision': 0.8491879, 'binary_recall': 0.56920683, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.6815642}
confusion matrix:
       0    1
0  18084   65
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8795425, 'recall': 0.56629944, 'specificity': 0.56629944, 'f1': 0.6051316, 'auroc': 0.95310843, 'binary_precision': 0.79545456, 'binary_recall': 0.13409962, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5988   9
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 01:39:04.261005,epoch time: 0:38:37.665768,used: 1:57:19.791224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9836956, 'precision': 0.89405096, 'recall': 0.84107697, 'specificity': 0.84107697, 'f1': 0.86550033, 'auroc': 0.98524576, 'binary_precision': 0.7988959, 'binary_recall': 0.6881794, 'binary_specificity': 0.9939745, 'binary_f1_score': 0.73941606}
confusion matrix:
       0     1
0  42065   255
1    459  1013
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.90322745, 'recall': 0.8178662, 'specificity': 0.8178662, 'f1': 0.8550929, 'auroc': 0.9810209, 'binary_precision': 0.8190855, 'binary_recall': 0.6407465, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.71902263}
confusion matrix:
       0    1
0  18058   91
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9093665, 'recall': 0.59886646, 'specificity': 0.59886646, 'f1': 0.6525519, 'auroc': 0.9612787, 'binary_precision': 0.852459, 'binary_recall': 0.19923371, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.32298136}
confusion matrix:
      0   1
0  5988   9
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 02:17:43.146263,epoch time: 0:38:38.885258,used: 2:35:58.676482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9852028, 'precision': 0.9143013, 'recall': 0.8437193, 'specificity': 0.8437193, 'f1': 0.8754684, 'auroc': 0.9877182, 'binary_precision': 0.83924156, 'binary_recall': 0.6920462, 'binary_specificity': 0.9953924, 'binary_f1_score': 0.75856936}
confusion matrix:
       0     1
0  42126   195
1    453  1018
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.9165028, 'recall': 0.81752944, 'specificity': 0.81752944, 'f1': 0.85982835, 'auroc': 0.9808185, 'binary_precision': 0.845679, 'binary_recall': 0.63919127, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.728078}
confusion matrix:
       0    1
0  18074   75
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85919774, 'recall': 0.62460256, 'specificity': 0.62460256, 'f1': 0.68019426, 'auroc': 0.9562899, 'binary_precision': 0.75, 'binary_recall': 0.25287357, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.37822354}
confusion matrix:
      0   1
0  5975  22
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 02:56:30.629683,epoch time: 0:38:47.483420,used: 3:14:46.159902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98488307, 'precision': 0.88134426, 'recall': 0.8878461, 'specificity': 0.8878461, 'f1': 0.88456535, 'auroc': 0.98998785, 'binary_precision': 0.7702071, 'binary_recall': 0.7838205, 'binary_specificity': 0.99187165, 'binary_f1_score': 0.77695423}
confusion matrix:
       0     1
0  41977   344
1    318  1153
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.8919374, 'recall': 0.8559475, 'specificity': 0.8559475, 'f1': 0.87300354, 'auroc': 0.9781151, 'binary_precision': 0.7938144, 'binary_recall': 0.718507, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.75428563}
confusion matrix:
       0    1
0  18029  120
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8507173, 'recall': 0.6771585, 'specificity': 0.6771585, 'f1': 0.7326964, 'auroc': 0.9510859, 'binary_precision': 0.72868216, 'binary_recall': 0.36015326, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.48205125}
confusion matrix:
      0   1
0  5962  35
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 03:35:18.342651,epoch time: 0:38:47.712968,used: 3:53:33.872870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.9185578, 'recall': 0.87388813, 'specificity': 0.87388813, 'f1': 0.8948644, 'auroc': 0.99279845, 'binary_precision': 0.84568375, 'binary_recall': 0.7525493, 'binary_specificity': 0.995227, 'binary_f1_score': 0.79640293}
confusion matrix:
       0     1
0  42119   202
1    364  1107
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9056597, 'recall': 0.8426118, 'specificity': 0.8426118, 'f1': 0.8712649, 'auroc': 0.98228353, 'binary_precision': 0.82222223, 'binary_recall': 0.6905132, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.75063396}
confusion matrix:
       0    1
0  18053   96
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.83645284, 'recall': 0.550807, 'specificity': 0.550807, 'f1': 0.580274, 'auroc': 0.95402837, 'binary_precision': 0.7105263, 'binary_recall': 0.10344828, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.18060201}
confusion matrix:
      0   1
0  5986  11
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 04:14:01.542602,epoch time: 0:38:43.199951,used: 4:32:17.072821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9870981, 'precision': 0.9260813, 'recall': 0.86513174, 'specificity': 0.86513174, 'f1': 0.89307714, 'auroc': 0.9934046, 'binary_precision': 0.8613546, 'binary_recall': 0.734375, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.7928126}
confusion matrix:
       0     1
0  42146   174
1    391  1081
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9127614, 'recall': 0.83669406, 'specificity': 0.83669406, 'f1': 0.8705617, 'auroc': 0.9813186, 'binary_precision': 0.8368522, 'binary_recall': 0.67807156, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7491409}
confusion matrix:
       0    1
0  18064   85
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8759304, 'recall': 0.6551705, 'specificity': 0.6551705, 'f1': 0.71573097, 'auroc': 0.9566655, 'binary_precision': 0.7809524, 'binary_recall': 0.31417623, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4480874}
confusion matrix:
      0   1
0  5974  23
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 04:52:42.203051,epoch time: 0:38:40.660449,used: 5:10:57.733270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98837686, 'precision': 0.95640063, 'recall': 0.85586035, 'specificity': 0.85586035, 'f1': 0.89945805, 'auroc': 0.99474156, 'binary_precision': 0.9226714, 'binary_recall': 0.71380013, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.80490613}
confusion matrix:
       0     1
0  42233    88
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.9398992, 'recall': 0.79425013, 'specificity': 0.79425013, 'f1': 0.8515879, 'auroc': 0.9834353, 'binary_precision': 0.89411765, 'binary_recall': 0.59097975, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.71161044}
confusion matrix:
       0    1
0  18104   45
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8266577, 'recall': 0.53381574, 'specificity': 0.53381574, 'f1': 0.5524553, 'auroc': 0.95708424, 'binary_precision': 0.6923077, 'binary_recall': 0.06896552, 'binary_specificity': 0.998666, 'binary_f1_score': 0.12543555}
confusion matrix:
      0   1
0  5989   8
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_9.png
early stop counter: 1
val acc:0.9836100339889526, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9677213430404663 / 0.9747523069381714
after epoch: 9,now: 2024-06-09 05:31:24.860945,epoch time: 0:38:42.657894,used: 5:49:40.391164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9871666, 'precision': 0.89390975, 'recall': 0.91401815, 'specificity': 0.91401815, 'f1': 0.90369225, 'auroc': 0.99409366, 'binary_precision': 0.7935484, 'binary_recall': 0.8355978, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.81403047}
confusion matrix:
       0     1
0  42000   320
1    242  1230
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.8965847, 'recall': 0.87691534, 'specificity': 0.87691534, 'f1': 0.88647866, 'auroc': 0.98191845, 'binary_precision': 0.8016393, 'binary_recall': 0.7604977, 'binary_specificity': 0.993333, 'binary_f1_score': 0.7805267}
confusion matrix:
       0    1
0  18028  121
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.870243, 'recall': 0.6399282, 'specificity': 0.6399282, 'f1': 0.69868845, 'auroc': 0.9605317, 'binary_precision': 0.7708333, 'binary_recall': 0.2835249, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.41456583}
confusion matrix:
      0   1
0  5975  22
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 06:10:07.221342,epoch time: 0:38:42.360397,used: 6:28:22.751561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.87939227, 'recall': 0.93948483, 'specificity': 0.93948483, 'f1': 0.9070345, 'auroc': 0.9945574, 'binary_precision': 0.7626822, 'binary_recall': 0.88858694, 'binary_specificity': 0.9903828, 'binary_f1_score': 0.82083464}
confusion matrix:
       0     1
0  41913   407
1    164  1308
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.85904634, 'recall': 0.9088709, 'specificity': 0.9088709, 'f1': 0.88218933, 'auroc': 0.9840343, 'binary_precision': 0.7241848, 'binary_recall': 0.8289269, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.7730239}
confusion matrix:
       0    1
0  17946  203
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.83533895, 'recall': 0.6071944, 'specificity': 0.6071944, 'f1': 0.65730244, 'auroc': 0.9537283, 'binary_precision': 0.7037037, 'binary_recall': 0.21839081, 'binary_specificity': 0.995998, 'binary_f1_score': 0.33333334}
confusion matrix:
      0   1
0  5973  24
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_11.png
early stop counter: 1
val acc:0.9833439588546753, best validation acc: 0.9853661060333252, corresponding to test acc:                         0.9666027426719666 / 0.9747523069381714
after epoch: 11,now: 2024-06-09 06:48:49.687021,epoch time: 0:38:42.465679,used: 7:07:05.217240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99102575, 'precision': 0.91848046, 'recall': 0.94942427, 'specificity': 0.94942427, 'f1': 0.93335456, 'auroc': 0.99645287, 'binary_precision': 0.8402778, 'binary_recall': 0.90482664, 'binary_specificity': 0.9940219, 'binary_f1_score': 0.8713584}
confusion matrix:
       0     1
0  42068   253
1    140  1331
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.8852463, 'recall': 0.9002497, 'specificity': 0.9002497, 'f1': 0.892592, 'auroc': 0.9820434, 'binary_precision': 0.7772795, 'binary_recall': 0.8087092, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.7926829}
confusion matrix:
       0    1
0  18000  149
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.84767205, 'recall': 0.6206044, 'specificity': 0.6206044, 'f1': 0.6742991, 'auroc': 0.9508232, 'binary_precision': 0.72727275, 'binary_recall': 0.24521072, 'binary_specificity': 0.995998, 'binary_f1_score': 0.36676216}
confusion matrix:
      0   1
0  5973  24
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 07:27:33.869579,epoch time: 0:38:44.182558,used: 7:45:49.399798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9908659, 'precision': 0.9665428, 'recall': 0.8877363, 'specificity': 0.8877363, 'f1': 0.92323935, 'auroc': 0.99672216, 'binary_precision': 0.94078946, 'binary_recall': 0.77717394, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.85119045}
confusion matrix:
       0     1
0  42248    72
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.93595374, 'recall': 0.834355, 'specificity': 0.834355, 'f1': 0.87794936, 'auroc': 0.98025084, 'binary_precision': 0.8834356, 'binary_recall': 0.6718507, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7632508}
confusion matrix:
       0    1
0  18092   57
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.89228094, 'recall': 0.5777937, 'specificity': 0.5777937, 'f1': 0.6224514, 'auroc': 0.9429531, 'binary_precision': 0.82, 'binary_recall': 0.15708812, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2636656}
confusion matrix:
      0   1
0  5988   9
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_13.png
better model found
persisted
after epoch: 13,now: 2024-06-09 08:06:17.455647,epoch time: 0:38:43.586068,used: 8:24:32.985866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9905234, 'precision': 0.9248897, 'recall': 0.9301808, 'specificity': 0.9301808, 'f1': 0.9275175, 'auroc': 0.99611235, 'binary_precision': 0.8544601, 'binary_recall': 0.8654891, 'binary_specificity': 0.9948724, 'binary_f1_score': 0.8599392}
confusion matrix:
       0     1
0  42103   217
1    198  1274
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9126168, 'recall': 0.86599505, 'specificity': 0.86599505, 'f1': 0.88779676, 'auroc': 0.9809519, 'binary_precision': 0.83450705, 'binary_recall': 0.7371695, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.78282416}
confusion matrix:
       0    1
0  18055   94
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.90530056, 'recall': 0.6405952, 'specificity': 0.6405952, 'f1': 0.70377433, 'auroc': 0.9460747, 'binary_precision': 0.84090906, 'binary_recall': 0.2835249, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.42406875}
confusion matrix:
      0   1
0  5983  14
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_14.png
better model found
persisted
after epoch: 14,now: 2024-06-09 08:45:04.775350,epoch time: 0:38:47.319703,used: 9:03:20.305569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99198484, 'precision': 0.95978785, 'recall': 0.91284627, 'specificity': 0.91284627, 'f1': 0.9349594, 'auroc': 0.9973804, 'binary_precision': 0.9255319, 'binary_recall': 0.8280082, 'binary_specificity': 0.99768436, 'binary_f1_score': 0.8740582}
confusion matrix:
       0     1
0  42223    98
1    253  1218
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9321394, 'recall': 0.8149149, 'specificity': 0.8149149, 'f1': 0.8636441, 'auroc': 0.9792424, 'binary_precision': 0.8771552, 'binary_recall': 0.63297045, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7353207}
confusion matrix:
       0    1
0  18092   57
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89065933, 'recall': 0.6081115, 'specificity': 0.6081115, 'f1': 0.66330105, 'auroc': 0.9420581, 'binary_precision': 0.8142857, 'binary_recall': 0.21839081, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3444109}
confusion matrix:
      0   1
0  5984  13
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_15.png
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9678810834884644 / 0.9747523069381714
after epoch: 15,now: 2024-06-09 09:23:53.701467,epoch time: 0:38:48.926117,used: 9:42:09.231686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99205333, 'precision': 0.93460417, 'recall': 0.94430584, 'specificity': 0.94430584, 'f1': 0.9393971, 'auroc': 0.99731404, 'binary_precision': 0.8729208, 'binary_recall': 0.8931246, 'binary_specificity': 0.9954871, 'binary_f1_score': 0.88290715}
confusion matrix:
       0     1
0  42132   191
1    157  1312
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.8917453, 'recall': 0.90055275, 'specificity': 0.90055275, 'f1': 0.8960958, 'auroc': 0.9787284, 'binary_precision': 0.79027355, 'binary_recall': 0.8087092, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.7993851}
confusion matrix:
       0    1
0  18011  138
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89065933, 'recall': 0.6081115, 'specificity': 0.6081115, 'f1': 0.66330105, 'auroc': 0.93395036, 'binary_precision': 0.8142857, 'binary_recall': 0.21839081, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3444109}
confusion matrix:
      0   1
0  5984  13
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 10:02:56.506761,epoch time: 0:39:02.805294,used: 10:21:12.036980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.92278576, 'recall': 0.95099247, 'specificity': 0.95099247, 'f1': 0.936396, 'auroc': 0.9975649, 'binary_precision': 0.8487929, 'binary_recall': 0.9076087, 'binary_specificity': 0.9943762, 'binary_f1_score': 0.87721604}
confusion matrix:
       0     1
0  42082   238
1    136  1336
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.8699085, 'recall': 0.90639406, 'specificity': 0.90639406, 'f1': 0.887215, 'auroc': 0.97869575, 'binary_precision': 0.7461213, 'binary_recall': 0.82270604, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.7825443}
confusion matrix:
       0    1
0  17969  180
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.88649964, 'recall': 0.6175233, 'specificity': 0.6175233, 'f1': 0.6746456, 'auroc': 0.9594673, 'binary_precision': 0.8051948, 'binary_recall': 0.23754789, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.36686388}
confusion matrix:
      0   1
0  5982  15
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_17.png
early stop counter: 1
val acc:0.9843550324440002, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9653244018554688 / 0.9747523069381714
after epoch: 17,now: 2024-06-09 10:42:09.337337,epoch time: 0:39:12.830576,used: 11:00:24.867556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.96351475, 'recall': 0.93976253, 'specificity': 0.93976253, 'f1': 0.9513025, 'auroc': 0.9980859, 'binary_precision': 0.93113345, 'binary_recall': 0.8817935, 'binary_specificity': 0.99773157, 'binary_f1_score': 0.905792}
confusion matrix:
       0     1
0  42224    96
1    174  1298
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9101765, 'recall': 0.8774663, 'specificity': 0.8774663, 'f1': 0.8930862, 'auroc': 0.9833667, 'binary_precision': 0.82881355, 'binary_recall': 0.7604977, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7931873}
confusion matrix:
       0    1
0  18048  101
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8818009, 'recall': 0.62501943, 'specificity': 0.62501943, 'f1': 0.68315196, 'auroc': 0.9536847, 'binary_precision': 0.79518074, 'binary_recall': 0.25287357, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.38372093}
confusion matrix:
      0   1
0  5980  17
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_18.png
better model found
persisted
after epoch: 18,now: 2024-06-09 11:21:21.286104,epoch time: 0:39:11.948767,used: 11:39:36.816323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9893816, 'precision': 0.9884222, 'recall': 0.84631383, 'specificity': 0.84631383, 'f1': 0.9044529, 'auroc': 0.99746644, 'binary_precision': 0.9874153, 'binary_recall': 0.6929348, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.81437135}
confusion matrix:
       0     1
0  42307    13
1    452  1020
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.949986, 'recall': 0.74958986, 'specificity': 0.74958986, 'f1': 0.81916094, 'auroc': 0.9688078, 'binary_precision': 0.9173789, 'binary_recall': 0.5007776, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.6478873}
confusion matrix:
       0    1
0  18120   29
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.92604196, 'recall': 0.5609692, 'specificity': 0.5609692, 'f1': 0.59820974, 'auroc': 0.93699694, 'binary_precision': 0.8888889, 'binary_recall': 0.12260536, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2154882}
confusion matrix:
      0   1
0  5993   4
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_19.png
early stop counter: 1
val acc:0.9813750386238098, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9661233425140381 / 0.9747523069381714
after epoch: 19,now: 2024-06-09 12:00:16.586050,epoch time: 0:38:55.299946,used: 12:18:32.116269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9931266, 'precision': 0.9809451, 'recall': 0.9108725, 'specificity': 0.9108725, 'f1': 0.94295657, 'auroc': 0.9981552, 'binary_precision': 0.96802557, 'binary_recall': 0.8226902, 'binary_specificity': 0.99905485, 'binary_f1_score': 0.88946015}
confusion matrix:
       0     1
0  42280    40
1    261  1211
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.940972, 'recall': 0.8422413, 'specificity': 0.8422413, 'f1': 0.88491607, 'auroc': 0.98109794, 'binary_precision': 0.8929293, 'binary_recall': 0.6874028, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7768014}
confusion matrix:
       0    1
0  18096   53
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.90768886, 'recall': 0.60644597, 'specificity': 0.60644597, 'f1': 0.6624344, 'auroc': 0.9504062, 'binary_precision': 0.8484849, 'binary_recall': 0.21455939, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.34250763}
confusion matrix:
      0   1
0  5987  10
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 12:39:08.933132,epoch time: 0:38:52.347082,used: 12:57:24.463351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.96832556, 'recall': 0.94771683, 'specificity': 0.94771683, 'f1': 0.9577717, 'auroc': 0.99834645, 'binary_precision': 0.9402135, 'binary_recall': 0.8974185, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.9183177}
confusion matrix:
       0     1
0  42236    84
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9216161, 'recall': 0.88098997, 'specificity': 0.88098997, 'f1': 0.9001919, 'auroc': 0.97824085, 'binary_precision': 0.851468, 'binary_recall': 0.7667185, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.80687404}
confusion matrix:
       0    1
0  18063   86
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8877798, 'recall': 0.61185956, 'specificity': 0.61185956, 'f1': 0.6677812, 'auroc': 0.9586607, 'binary_precision': 0.8082192, 'binary_recall': 0.22605364, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.35329342}
confusion matrix:
      0   1
0  5983  14
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_21.png
better model found
persisted
after epoch: 21,now: 2024-06-09 13:17:59.379543,epoch time: 0:38:50.446411,used: 13:36:14.909762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9948621, 'precision': 0.95949626, 'recall': 0.961605, 'specificity': 0.961605, 'f1': 0.96054804, 'auroc': 0.9988313, 'binary_precision': 0.92156863, 'binary_recall': 0.92595106, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.9237547}
confusion matrix:
       0     1
0  42204   116
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.91544193, 'recall': 0.87227106, 'specificity': 0.87227106, 'f1': 0.8925774, 'auroc': 0.97620773, 'binary_precision': 0.83972126, 'binary_recall': 0.7496112, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.79211175}
confusion matrix:
       0    1
0  18057   92
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8601316, 'recall': 0.6472575, 'specificity': 0.6472575, 'f1': 0.7050985, 'auroc': 0.94663894, 'binary_precision': 0.75, 'binary_recall': 0.29885057, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.42739728}
confusion matrix:
      0   1
0  5971  26
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_22.png
early stop counter: 1
val acc:0.9865368008613586, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 22,now: 2024-06-09 13:56:46.504475,epoch time: 0:38:47.124932,used: 14:15:02.034694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.995433, 'precision': 0.98298633, 'recall': 0.9455074, 'specificity': 0.9455074, 'f1': 0.96343446, 'auroc': 0.9992026, 'binary_precision': 0.96971935, 'binary_recall': 0.8919837, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.9292286}
confusion matrix:
       0     1
0  42279    41
1    159  1313
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.93518037, 'recall': 0.8443812, 'specificity': 0.8443812, 'f1': 0.8840902, 'auroc': 0.9815128, 'binary_precision': 0.8811881, 'binary_recall': 0.69206846, 'binary_specificity': 0.996694, 'binary_f1_score': 0.77526134}
confusion matrix:
       0    1
0  18089   60
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8971522, 'recall': 0.66699827, 'specificity': 0.66699827, 'f1': 0.7312279, 'auroc': 0.95270944, 'binary_precision': 0.8224299, 'binary_recall': 0.33716476, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.47826084}
confusion matrix:
      0   1
0  5978  19
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_23.png
early stop counter: 2
val acc:0.9862707257270813, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 23,now: 2024-06-09 14:35:34.900955,epoch time: 0:38:48.396480,used: 14:53:50.431174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99276125, 'precision': 0.9507568, 'recall': 0.9362565, 'specificity': 0.9362565, 'f1': 0.9433789, 'auroc': 0.99800736, 'binary_precision': 0.90583277, 'binary_recall': 0.8756794, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.8905009}
confusion matrix:
       0     1
0  42186   134
1    183  1289
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.93532765, 'recall': 0.85907304, 'specificity': 0.85907304, 'f1': 0.89325833, 'auroc': 0.97972274, 'binary_precision': 0.88045543, 'binary_recall': 0.7216174, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7931624}
confusion matrix:
       0    1
0  18086   63
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.83346313, 'recall': 0.5883708, 'specificity': 0.5883708, 'f1': 0.6336931, 'auroc': 0.94005275, 'binary_precision': 0.70149255, 'binary_recall': 0.18007663, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2865854}
confusion matrix:
      0   1
0  5977  20
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_24.png
early stop counter: 3
val acc:0.9871221780776978, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 24,now: 2024-06-09 15:14:21.802538,epoch time: 0:38:46.901583,used: 15:32:37.332757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.914244, 'recall': 0.98495394, 'specificity': 0.98495394, 'f1': 0.9465785, 'auroc': 0.99913776, 'binary_precision': 0.8292964, 'binary_recall': 0.9769022, 'binary_specificity': 0.9930057, 'binary_f1_score': 0.897068}
confusion matrix:
       0     1
0  42024   296
1     34  1438
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.8722327, 'recall': 0.917253, 'specificity': 0.917253, 'f1': 0.8933408, 'auroc': 0.9829737, 'binary_precision': 0.75, 'binary_recall': 0.844479, 'binary_specificity': 0.990027, 'binary_f1_score': 0.7944403}
confusion matrix:
       0    1
0  17968  181
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82891226, 'recall': 0.6408434, 'specificity': 0.6408434, 'f1': 0.6936462, 'auroc': 0.94460815, 'binary_precision': 0.6880734, 'binary_recall': 0.28735632, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4054054}
confusion matrix:
      0   1
0  5963  34
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_25.png
early stop counter: 4
val acc:0.9850468039512634, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 25,now: 2024-06-09 15:53:09.939524,epoch time: 0:38:48.136986,used: 16:11:25.469743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9942912, 'precision': 0.9901129, 'recall': 0.92092943, 'specificity': 0.92092943, 'f1': 0.95270574, 'auroc': 0.99938834, 'binary_precision': 0.98568016, 'binary_recall': 0.84228414, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.90835774}
confusion matrix:
       0     1
0  42303    18
1    232  1239
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.94726807, 'recall': 0.80605197, 'specificity': 0.80605197, 'f1': 0.86247474, 'auroc': 0.97725016, 'binary_precision': 0.90804595, 'binary_recall': 0.61430794, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7328386}
confusion matrix:
       0    1
0  18109   40
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.904746, 'recall': 0.56271815, 'specificity': 0.56271815, 'f1': 0.6004224, 'auroc': 0.93514925, 'binary_precision': 0.84615386, 'binary_recall': 0.12643678, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.22000001}
confusion matrix:
      0   1
0  5991   6
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_26.png
early stop counter: 5
val acc:0.984674334526062, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 26,now: 2024-06-09 16:31:56.293058,epoch time: 0:38:46.353534,used: 16:50:11.823277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9941999, 'precision': 0.9434972, 'recall': 0.97077036, 'specificity': 0.97077036, 'f1': 0.95669407, 'auroc': 0.99900544, 'binary_precision': 0.8888889, 'binary_recall': 0.9456522, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.9163924}
confusion matrix:
       0     1
0  42146   174
1     80  1392
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.91287255, 'recall': 0.88990796, 'specificity': 0.88990796, 'f1': 0.9010346, 'auroc': 0.981073, 'binary_precision': 0.8333333, 'binary_recall': 0.785381, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.80864686}
confusion matrix:
       0    1
0  18048  101
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.90783304, 'recall': 0.5551387, 'specificity': 0.5551387, 'f1': 0.5886086, 'auroc': 0.952754, 'binary_precision': 0.85294116, 'binary_recall': 0.11111111, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19661018}
confusion matrix:
      0   1
0  5992   5
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_27.png
early stop counter: 6
val acc:0.9872817993164062, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 27,now: 2024-06-09 17:10:44.825619,epoch time: 0:38:48.532561,used: 17:29:00.355838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9953188, 'precision': 0.9866358, 'recall': 0.9402026, 'specificity': 0.9402026, 'f1': 0.96217084, 'auroc': 0.99929917, 'binary_precision': 0.9773926, 'binary_recall': 0.8811141, 'binary_specificity': 0.9992911, 'binary_f1_score': 0.9267596}
confusion matrix:
       0     1
0  42290    30
1    175  1297
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9530164, 'recall': 0.8294352, 'specificity': 0.8294352, 'f1': 0.88075864, 'auroc': 0.9828003, 'binary_precision': 0.91792655, 'binary_recall': 0.66096425, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.76853526}
confusion matrix:
       0    1
0  18111   38
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8970221, 'recall': 0.57404566, 'specificity': 0.57404566, 'f1': 0.6172033, 'auroc': 0.9359865, 'binary_precision': 0.82978725, 'binary_recall': 0.14942528, 'binary_specificity': 0.998666, 'binary_f1_score': 0.25324675}
confusion matrix:
      0   1
0  5989   8
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_28.png
early stop counter: 7
val acc:0.9863771796226501, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 28,now: 2024-06-09 17:49:27.943890,epoch time: 0:38:43.118271,used: 18:07:43.474109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.996392, 'precision': 0.9882414, 'recall': 0.9554815, 'specificity': 0.9554815, 'f1': 0.9712509, 'auroc': 0.999467, 'binary_precision': 0.97954714, 'binary_recall': 0.9116247, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.94436616}
confusion matrix:
       0     1
0  42293    28
1    130  1341
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9380157, 'recall': 0.85529524, 'specificity': 0.85529524, 'f1': 0.8920131, 'auroc': 0.98187745, 'binary_precision': 0.8861004, 'binary_recall': 0.7138414, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.79069775}
confusion matrix:
       0    1
0  18090   59
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.77654564, 'recall': 0.54830766, 'specificity': 0.54830766, 'f1': 0.5748864, 'auroc': 0.9361996, 'binary_precision': 0.59090906, 'binary_recall': 0.099616855, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.17049181}
confusion matrix:
      0   1
0  5979  18
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_29.png
early stop counter: 8
val acc:0.9870689511299133, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 29,now: 2024-06-09 18:28:14.278610,epoch time: 0:38:46.334720,used: 18:46:29.808829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99664325, 'precision': 0.96998864, 'recall': 0.97891957, 'specificity': 0.97891957, 'f1': 0.9744088, 'auroc': 0.9996029, 'binary_precision': 0.9413724, 'binary_recall': 0.9599185, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.95055497}
confusion matrix:
       0     1
0  42232    88
1     59  1413
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.91080934, 'recall': 0.8929082, 'specificity': 0.8929082, 'f1': 0.9016428, 'auroc': 0.979899, 'binary_precision': 0.8289902, 'binary_recall': 0.79160184, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.80986476}
confusion matrix:
       0    1
0  18044  105
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8432605, 'recall': 0.6016974, 'specificity': 0.6016974, 'f1': 0.6513547, 'auroc': 0.9364542, 'binary_precision': 0.72, 'binary_recall': 0.20689656, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.32142857}
confusion matrix:
      0   1
0  5976  21
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261154_30.png
early stop counter: 9
val acc:0.9872817993164062, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9654842019081116 / 0.9747523069381714
after epoch: 30,now: 2024-06-09 19:07:22.226957,epoch time: 0:39:07.948347,used: 19:25:37.757176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_44_seed_0_21261154
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:25:37.757176 at 2024-06-09 19:07:22.226957
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.8834357, 'recall': 0.6061125, 'specificity': 0.6061125, 'f1': 0.66019785, 'auroc': 0.95537484, 'binary_precision': 0.8, 'binary_recall': 0.21455939, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3383686}
confusion matrix:
      0   1
0  5983  14
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1652 MiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430672 KiB |    863 MiB | 413192 GiB | 413191 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400320 GiB | 400320 GiB |
|       from small pool |  20368 KiB |     21 MiB |  12871 GiB |  12871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2498    |    6357    |  152021 K  |  152019 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89743 K  |   89741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2498    |    6357    |  152021 K  |  152019 K  |
|       from large pool |     247    |     989    |   62277 K  |   62277 K  |
|       from small pool |    2251    |    6108    |   89743 K  |   89741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |    2873    |   89795 K  |   89795 K  |
|       from large pool |     112    |     516    |   47248 K  |   47247 K  |
|       from small pool |      33    |    2761    |   42547 K  |   42547 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    976 TiB |    976 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413193 GiB | 413193 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400321 GiB | 400321 GiB |
|       from small pool |      0 KiB |     25 MiB |  12871 GiB |  12871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152021 K  |  152021 K  |
|       from large pool |       2    |     989    |   62277 K  |   62277 K  |
|       from small pool |       0    |    6108    |   89743 K  |   89743 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   89796 K  |   89796 K  |
|       from large pool |       2    |     516    |   47248 K  |   47248 K  |
|       from small pool |       0    |    2761    |   42548 K  |   42548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  9 19:08:55 2024]
Finished job 0.
1 of 1 steps (100%) done
