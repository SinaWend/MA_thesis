Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 16:20:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197

 Experiment start at: 2024-06-10 16:26:07.366598
before training, model accuracy: 0.4373156428337097
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9913557, 'precision': 0.97510743, 'recall': 0.9743364, 'specificity': 0.9743364, 'f1': 0.97472155, 'auroc': 0.99681294, 'binary_precision': 0.95508164, 'binary_recall': 0.95335144, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.95421576}
confusion matrix:
       0     1
0  42122   198
1    206  4210
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.7248257, 'recall': 0.7938137, 'specificity': 0.7938137, 'f1': 0.7541312, 'auroc': 0.93816876, 'binary_precision': 0.4635294, 'binary_recall': 0.61275274, 'binary_specificity': 0.9748747, 'binary_f1_score': 0.5277964}
confusion matrix:
       0    1
0  17693  456
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.991003, 'precision': 0.9949653, 'recall': 0.9610473, 'specificity': 0.9610473, 'f1': 0.9772042, 'auroc': 0.99499786, 'binary_precision': 1.0, 'binary_recall': 0.9220945, 'binary_specificity': 1.0, 'binary_f1_score': 0.9594684}
confusion matrix:
      0    1
0  5997    0
1    61  722
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 16:51:25.905116,epoch time: 0:25:18.538518,used: 0:25:18.538518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9942657, 'precision': 0.97916555, 'recall': 0.98770225, 'specificity': 0.98770225, 'f1': 0.9833861, 'auroc': 0.9985625, 'binary_precision': 0.96046203, 'binary_recall': 0.9796103, 'binary_specificity': 0.9957942, 'binary_f1_score': 0.9699417}
confusion matrix:
       0     1
0  42144   178
1     90  4324
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.731038, 'recall': 0.6310117, 'specificity': 0.6310117, 'f1': 0.6657392, 'auroc': 0.9037875, 'binary_precision': 0.48746517, 'binary_recall': 0.27216175, 'binary_specificity': 0.9898617, 'binary_f1_score': 0.3493014}
confusion matrix:
       0    1
0  17965  184
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99336284, 'precision': 0.99392164, 'recall': 0.9734852, 'specificity': 0.9734852, 'f1': 0.98341435, 'auroc': 0.99832827, 'binary_precision': 0.9946381, 'binary_recall': 0.9476373, 'binary_specificity': 0.999333, 'binary_f1_score': 0.970569}
confusion matrix:
      0    1
0  5993    4
1    41  742
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 17:15:42.331800,epoch time: 0:24:16.426684,used: 0:49:34.965202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99702585, 'precision': 0.9900878, 'recall': 0.992573, 'specificity': 0.992573, 'f1': 0.99132645, 'auroc': 0.99933183, 'binary_precision': 0.9815232, 'binary_recall': 0.9870836, 'binary_specificity': 0.9980625, 'binary_f1_score': 0.98429555}
confusion matrix:
       0     1
0  42241    82
1     57  4356
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7979759, 'recall': 0.59588444, 'specificity': 0.59588444, 'f1': 0.64104193, 'auroc': 0.9260626, 'binary_precision': 0.62376237, 'binary_recall': 0.19595645, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.29822484}
confusion matrix:
       0    1
0  18073   76
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954277, 'precision': 0.9951259, 'recall': 0.9824251, 'specificity': 0.9824251, 'f1': 0.98866475, 'auroc': 0.9985047, 'binary_precision': 0.99473685, 'binary_recall': 0.9655172, 'binary_specificity': 0.999333, 'binary_f1_score': 0.97990924}
confusion matrix:
      0    1
0  5993    4
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-10 17:40:18.295866,epoch time: 0:24:35.964066,used: 1:14:10.929268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99484336, 'precision': 0.9969527, 'recall': 0.97290957, 'specificity': 0.97290957, 'f1': 0.9845573, 'auroc': 0.9989104, 'binary_precision': 0.9995213, 'binary_recall': 0.94586635, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9719539}
confusion matrix:
       0     1
0  42319     2
1    239  4176
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8545932, 'recall': 0.58215684, 'specificity': 0.58215684, 'f1': 0.627987, 'auroc': 0.9200542, 'binary_precision': 0.737931, 'binary_recall': 0.16640747, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.2715736}
confusion matrix:
       0    1
0  18111   38
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9902655, 'precision': 0.99455714, 'recall': 0.9578544, 'specificity': 0.9578544, 'f1': 0.9752637, 'auroc': 0.9996005, 'binary_precision': 1.0, 'binary_recall': 0.91570884, 'binary_specificity': 1.0, 'binary_f1_score': 0.95600003}
confusion matrix:
      0    1
0  5997    0
1    66  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_4.png
better model found
persisted
after epoch: 4,now: 2024-06-10 18:04:39.695705,epoch time: 0:24:21.399839,used: 1:38:32.329107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99445826, 'precision': 0.99695873, 'recall': 0.9706615, 'specificity': 0.9706615, 'f1': 0.9833621, 'auroc': 0.9989772, 'binary_precision': 1.0, 'binary_recall': 0.94132304, 'binary_specificity': 1.0, 'binary_f1_score': 0.9697748}
confusion matrix:
       0     1
0  42322     0
1    259  4155
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.9330204, 'recall': 0.56659853, 'specificity': 0.56659853, 'f1': 0.60867906, 'auroc': 0.92751706, 'binary_precision': 0.8958333, 'binary_recall': 0.13374805, 'binary_specificity': 0.999449, 'binary_f1_score': 0.23274696}
confusion matrix:
       0   1
0  18139  10
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99115044, 'precision': 0.9950471, 'recall': 0.96168584, 'specificity': 0.96168584, 'f1': 0.97759086, 'auroc': 0.9985746, 'binary_precision': 1.0, 'binary_recall': 0.9233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.96015936}
confusion matrix:
      0    1
0  5997    0
1    60  723
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_5.png
better model found
persisted
after epoch: 5,now: 2024-06-10 18:29:16.304889,epoch time: 0:24:36.609184,used: 2:03:08.938291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9972398, 'precision': 0.9968157, 'recall': 0.98701656, 'specificity': 0.98701656, 'f1': 0.9918547, 'auroc': 0.99931806, 'binary_precision': 0.99629545, 'binary_recall': 0.97441125, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9852318}
confusion matrix:
       0     1
0  42304    16
1    113  4303
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.50074995, 'recall': 0.5000338, 'specificity': 0.5000338, 'f1': 0.49242848, 'auroc': 0.91889393, 'binary_precision': 0.035714287, 'binary_recall': 0.00155521, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.0029806262}
confusion matrix:
       0   1
0  18122  27
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99439526, 'precision': 0.9968517, 'recall': 0.97573435, 'specificity': 0.97573435, 'f1': 0.98598635, 'auroc': 0.99981344, 'binary_precision': 1.0, 'binary_recall': 0.9514687, 'binary_specificity': 1.0, 'binary_f1_score': 0.9751309}
confusion matrix:
      0    1
0  5997    0
1    38  745
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_6.png
early stop counter: 1
val acc:0.9643997550010681, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9954277276992798
after epoch: 6,now: 2024-06-10 18:52:48.308858,epoch time: 0:23:32.003969,used: 2:26:40.942260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9966621, 'precision': 0.99795246, 'recall': 0.9825319, 'specificity': 0.9825319, 'f1': 0.99008983, 'auroc': 0.9993851, 'binary_precision': 0.99953073, 'binary_recall': 0.965111, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98201936}
confusion matrix:
       0     1
0  42320     2
1    154  4260
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.601518, 'recall': 0.5061995, 'specificity': 0.5061995, 'f1': 0.5042328, 'auroc': 0.9245623, 'binary_precision': 0.23684211, 'binary_recall': 0.01399689, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.026431719}
confusion matrix:
       0   1
0  18120  29
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9932153, 'precision': 0.9944198, 'recall': 0.97229135, 'specificity': 0.97229135, 'f1': 0.98301667, 'auroc': 0.99915135, 'binary_precision': 0.9959623, 'binary_recall': 0.945083, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.96985584}
confusion matrix:
      0    1
0  5994    3
1    43  740
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_7.png
early stop counter: 2
val acc:0.9647190570831299, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9954277276992798
after epoch: 7,now: 2024-06-10 19:16:09.265376,epoch time: 0:23:20.956518,used: 2:50:01.898778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9982241, 'precision': 0.99819493, 'recall': 0.9914079, 'specificity': 0.9914079, 'f1': 0.9947722, 'auroc': 0.9997354, 'binary_precision': 0.9981592, 'binary_recall': 0.98300475, 'binary_specificity': 0.999811, 'binary_f1_score': 0.99052405}
confusion matrix:
       0     1
0  42315     8
1     75  4338
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7253059, 'recall': 0.54039276, 'specificity': 0.54039276, 'f1': 0.5627394, 'auroc': 0.9337172, 'binary_precision': 0.48214287, 'binary_recall': 0.083981335, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.14304635}
confusion matrix:
       0   1
0  18091  58
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9957227, 'precision': 0.99759376, 'recall': 0.9814815, 'specificity': 0.9814815, 'f1': 0.98936003, 'auroc': 0.9996967, 'binary_precision': 1.0, 'binary_recall': 0.962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811321}
confusion matrix:
      0    1
0  5997    0
1    29  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_8.png
new oracle model saved
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 8,now: 2024-06-10 19:39:28.966461,epoch time: 0:23:19.701085,used: 3:13:21.599863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9978175, 'precision': 0.9986937, 'recall': 0.98854995, 'specificity': 0.98854995, 'f1': 0.99355626, 'auroc': 0.99975777, 'binary_precision': 0.99976826, 'binary_recall': 0.97712344, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9883161}
confusion matrix:
       0     1
0  42320     1
1    101  4314
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.86929375, 'recall': 0.52077496, 'specificity': 0.52077496, 'f1': 0.5313691, 'auroc': 0.95567673, 'binary_precision': 0.7714286, 'binary_recall': 0.041990668, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.07964601}
confusion matrix:
       0   1
0  18141   8
1    616  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9935103, 'precision': 0.9963582, 'recall': 0.97190297, 'specificity': 0.97190297, 'f1': 0.9837178, 'auroc': 0.99957126, 'binary_precision': 1.0, 'binary_recall': 0.9438059, 'binary_specificity': 1.0, 'binary_f1_score': 0.9710906}
confusion matrix:
      0    1
0  5997    0
1    44  739
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_9.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 9,now: 2024-06-10 20:02:55.932248,epoch time: 0:23:26.965787,used: 3:36:48.565650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99646956, 'precision': 0.9866649, 'recall': 0.9928761, 'specificity': 0.9928761, 'f1': 0.9897456, 'auroc': 0.9994471, 'binary_precision': 0.97453654, 'binary_recall': 0.9884459, 'binary_specificity': 0.99730635, 'binary_f1_score': 0.9814419}
confusion matrix:
       0     1
0  42208   114
1     51  4363
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.73173743, 'recall': 0.7721385, 'specificity': 0.7721385, 'f1': 0.75011593, 'auroc': 0.9451816, 'binary_precision': 0.47894737, 'binary_recall': 0.5660964, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.51888806}
confusion matrix:
       0    1
0  17753  396
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9945428, 'precision': 0.9963475, 'recall': 0.9769281, 'specificity': 0.9769281, 'f1': 0.9863785, 'auroc': 0.9985222, 'binary_precision': 0.9986631, 'binary_recall': 0.954023, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9758328}
confusion matrix:
      0    1
0  5996    1
1    36  747
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_10.png
early stop counter: 5
val acc:0.9640804529190063, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 10,now: 2024-06-10 20:26:15.417350,epoch time: 0:23:19.485102,used: 4:00:08.050752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9979031, 'precision': 0.9984293, 'recall': 0.9893048, 'specificity': 0.9893048, 'f1': 0.99381405, 'auroc': 0.9996695, 'binary_precision': 0.99907494, 'binary_recall': 0.9787041, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9887846}
confusion matrix:
       0     1
0  42318     4
1     94  4320
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.80585825, 'recall': 0.6272428, 'specificity': 0.6272428, 'f1': 0.6767466, 'auroc': 0.94562495, 'binary_precision': 0.63740456, 'binary_recall': 0.25972006, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.36906075}
confusion matrix:
       0    1
0  18054   95
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99483776, 'precision': 0.9970988, 'recall': 0.97765005, 'specificity': 0.97765005, 'f1': 0.9871148, 'auroc': 0.9994489, 'binary_precision': 1.0, 'binary_recall': 0.95530015, 'binary_specificity': 1.0, 'binary_f1_score': 0.9771392}
confusion matrix:
      0    1
0  5997    0
1    35  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_11.png
early stop counter: 6
val acc:0.9696147441864014, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 11,now: 2024-06-10 20:49:34.789441,epoch time: 0:23:19.372091,used: 4:23:27.422843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9953783, 'precision': 0.99746096, 'recall': 0.9755435, 'specificity': 0.9755435, 'f1': 0.98619246, 'auroc': 0.99973476, 'binary_precision': 1.0, 'binary_recall': 0.95108694, 'binary_specificity': 1.0, 'binary_f1_score': 0.97493035}
confusion matrix:
       0     1
0  42320     0
1    216  4200
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.5543405, 'recall': 0.5006123, 'specificity': 0.5006123, 'f1': 0.49276605, 'auroc': 0.951301, 'binary_precision': 0.14285715, 'binary_recall': 0.00155521, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0030769233}
confusion matrix:
       0  1
0  18143  6
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.990708, 'precision': 0.994802, 'recall': 0.9597701, 'specificity': 0.9597701, 'f1': 0.97642934, 'auroc': 0.99892306, 'binary_precision': 1.0, 'binary_recall': 0.9195402, 'binary_specificity': 1.0, 'binary_f1_score': 0.95808387}
confusion matrix:
      0    1
0  5997    0
1    63  720
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_12.png
early stop counter: 7
val acc:0.9655172228813171, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 12,now: 2024-06-10 21:12:54.788381,epoch time: 0:23:19.998940,used: 4:46:47.421783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9977533, 'precision': 0.9985542, 'recall': 0.9883116, 'specificity': 0.9883116, 'f1': 0.993366, 'auroc': 0.9996444, 'binary_precision': 0.9995364, 'binary_recall': 0.97667044, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9879711}
confusion matrix:
       0     1
0  42319     2
1    103  4312
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.8117703, 'recall': 0.56332904, 'specificity': 0.56332904, 'f1': 0.5995888, 'auroc': 0.9558331, 'binary_precision': 0.6535433, 'binary_recall': 0.12908243, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.21558441}
confusion matrix:
       0   1
0  18105  44
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9939528, 'precision': 0.9960145, 'recall': 0.9743738, 'specificity': 0.9743738, 'f1': 0.9848714, 'auroc': 0.9996452, 'binary_precision': 0.9986559, 'binary_recall': 0.9489144, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.97314996}
confusion matrix:
      0    1
0  5996    1
1    40  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_13.png
early stop counter: 8
val acc:0.9678586721420288, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.991150438785553 / 0.9957227110862732
after epoch: 13,now: 2024-06-10 21:36:16.401533,epoch time: 0:23:21.613152,used: 5:10:09.034935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979887, 'precision': 0.9988919, 'recall': 0.9893569, 'specificity': 0.9893569, 'f1': 0.9940665, 'auroc': 0.99974895, 'binary_precision': 1.0, 'binary_recall': 0.97871375, 'binary_specificity': 1.0, 'binary_f1_score': 0.9892424}
confusion matrix:
       0     1
0  42320     0
1     94  4322
---- Validation: 
scalar performance:
{'acc': 0.97083867, 'precision': 0.85964227, 'recall': 0.6106252, 'specificity': 0.6106252, 'f1': 0.66479266, 'auroc': 0.94542444, 'binary_precision': 0.746114, 'binary_recall': 0.22395024, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.34449762}
confusion matrix:
       0    1
0  18100   49
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9978416, 'recall': 0.9833972, 'specificity': 0.9833972, 'f1': 0.9904769, 'auroc': 0.99937713, 'binary_precision': 1.0, 'binary_recall': 0.9667944, 'binary_specificity': 1.0, 'binary_f1_score': 0.98311687}
confusion matrix:
      0    1
0  5997    0
1    26  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_14.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-06-10 21:59:33.475277,epoch time: 0:23:17.073744,used: 5:33:26.108679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99882317, 'precision': 0.99802214, 'recall': 0.9950899, 'specificity': 0.9950899, 'f1': 0.99655056, 'auroc': 0.99973714, 'binary_precision': 0.99703604, 'binary_recall': 0.990487, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.9937507}
confusion matrix:
       0     1
0  42308    13
1     42  4373
---- Validation: 
scalar performance:
{'acc': 0.972169, 'precision': 0.8523074, 'recall': 0.6465665, 'specificity': 0.6465665, 'f1': 0.7039203, 'auroc': 0.93545353, 'binary_precision': 0.72900766, 'binary_recall': 0.2970451, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.42209947}
confusion matrix:
       0    1
0  18078   71
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.9994395, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-10 22:22:54.190844,epoch time: 0:23:20.715567,used: 5:56:46.824246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9982241, 'precision': 0.99636173, 'recall': 0.99323756, 'specificity': 0.99323756, 'f1': 0.9947935, 'auroc': 0.9997158, 'binary_precision': 0.99406934, 'binary_recall': 0.98708946, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.99056715}
confusion matrix:
       0     1
0  42295    26
1     57  4358
---- Validation: 
scalar performance:
{'acc': 0.93076843, 'precision': 0.6303475, 'recall': 0.7826444, 'specificity': 0.7826444, 'f1': 0.67234623, 'auroc': 0.91159713, 'binary_precision': 0.27465755, 'binary_recall': 0.62363917, 'binary_specificity': 0.9416497, 'binary_f1_score': 0.38136}
confusion matrix:
       0     1
0  17090  1059
1    242   401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9944352, 'recall': 0.9867283, 'specificity': 0.9867283, 'f1': 0.9905411, 'auroc': 0.99948335, 'binary_precision': 0.99219763, 'binary_recall': 0.9744572, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.98324746}
confusion matrix:
      0    1
0  5991    6
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_16.png
early stop counter: 1
val acc:0.9307684302330017, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9969026446342468
after epoch: 16,now: 2024-06-10 22:46:35.202976,epoch time: 0:23:41.012132,used: 6:20:27.836378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.9988333, 'recall': 0.99315774, 'specificity': 0.99315774, 'f1': 0.995975, 'auroc': 0.9998015, 'binary_precision': 0.9990824, 'binary_recall': 0.98640996, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9927057}
confusion matrix:
       0     1
0  42317     4
1     60  4355
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.96637, 'recall': 0.5217454, 'specificity': 0.5217454, 'f1': 0.5333225, 'auroc': 0.9482006, 'binary_precision': 0.9655172, 'binary_recall': 0.04354588, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.083333336}
confusion matrix:
       0   1
0  18148   1
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99734616, 'recall': 0.97956574, 'specificity': 0.97956574, 'f1': 0.9882393, 'auroc': 0.9994308, 'binary_precision': 1.0, 'binary_recall': 0.95913154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9791395}
confusion matrix:
      0    1
0  5997    0
1    32  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_17.png
early stop counter: 2
val acc:0.9672200679779053, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9969026446342468
after epoch: 17,now: 2024-06-10 23:09:58.835553,epoch time: 0:23:23.632577,used: 6:43:51.468955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.99930394, 'recall': 0.9933167, 'specificity': 0.9933167, 'f1': 0.9962876, 'auroc': 0.99973917, 'binary_precision': 1.0, 'binary_recall': 0.9866334, 'binary_specificity': 1.0, 'binary_f1_score': 0.99327177}
confusion matrix:
       0     1
0  42322     0
1     59  4355
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.8964203, 'recall': 0.5146643, 'specificity': 0.5146643, 'f1': 0.52002317, 'auroc': 0.95469296, 'binary_precision': 0.82608694, 'binary_recall': 0.02954899, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.057057057}
confusion matrix:
       0   1
0  18145   4
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.9995058, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_18.png
new oracle model saved
early stop counter: 3
val acc:0.9665815234184265, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 18,now: 2024-06-10 23:33:17.777444,epoch time: 0:23:18.941891,used: 7:07:10.410846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.99891657, 'recall': 0.9939518, 'specificity': 0.9939518, 'f1': 0.99641854, 'auroc': 0.99973476, 'binary_precision': 0.99908406, 'binary_recall': 0.9879982, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9935102}
confusion matrix:
       0     1
0  42316     4
1     53  4363
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.80379975, 'recall': 0.6614361, 'specificity': 0.6614361, 'f1': 0.70896655, 'auroc': 0.94801396, 'binary_precision': 0.63095236, 'binary_recall': 0.32970452, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.43309498}
confusion matrix:
       0    1
0  18025  124
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.9999039, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_19.png
early stop counter: 4
val acc:0.970466136932373, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 19,now: 2024-06-10 23:56:37.094899,epoch time: 0:23:19.317455,used: 7:30:29.728301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.9970404, 'recall': 0.99431586, 'specificity': 0.99431586, 'f1': 0.9956734, 'auroc': 0.99974155, 'binary_precision': 0.9952142, 'binary_recall': 0.989128, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.99216175}
confusion matrix:
       0     1
0  42300    21
1     48  4367
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7988656, 'recall': 0.5578582, 'specificity': 0.5578582, 'f1': 0.5911657, 'auroc': 0.9459139, 'binary_precision': 0.6280992, 'binary_recall': 0.11819596, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.19895288}
confusion matrix:
       0   1
0  18104  45
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99587023, 'precision': 0.9970981, 'recall': 0.9826752, 'specificity': 0.9826752, 'f1': 0.98974437, 'auroc': 0.99953073, 'binary_precision': 0.998679, 'binary_recall': 0.9655172, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98181814}
confusion matrix:
      0    1
0  5996    1
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_20.png
early stop counter: 5
val acc:0.967432975769043, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 20,now: 2024-06-11 00:19:57.550270,epoch time: 0:23:20.455371,used: 7:53:50.183672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9979673, 'precision': 0.99888015, 'recall': 0.9892436, 'specificity': 0.9892436, 'f1': 0.9940028, 'auroc': 0.99953127, 'binary_precision': 1.0, 'binary_recall': 0.9784873, 'binary_specificity': 1.0, 'binary_f1_score': 0.98912674}
confusion matrix:
       0     1
0  42320     0
1     95  4321
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.9399519, 'recall': 0.5162746, 'specificity': 0.5162746, 'f1': 0.52308035, 'auroc': 0.9456136, 'binary_precision': 0.9130435, 'binary_recall': 0.032659408, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.06306306}
confusion matrix:
       0   1
0  18147   2
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99690264, 'precision': 0.99825525, 'recall': 0.98659, 'specificity': 0.98659, 'f1': 0.99232996, 'auroc': 0.99966633, 'binary_precision': 1.0, 'binary_recall': 0.97318006, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640776}
confusion matrix:
      0    1
0  5997    0
1    21  762
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_21.png
early stop counter: 6
val acc:0.9667943716049194, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 21,now: 2024-06-11 00:43:08.140660,epoch time: 0:23:10.590390,used: 8:17:00.774062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.99897975, 'recall': 0.9923886, 'specificity': 0.9923886, 'f1': 0.99565655, 'auroc': 0.9996786, 'binary_precision': 0.9995402, 'binary_recall': 0.9848245, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9921277}
confusion matrix:
       0     1
0  42319     2
1     67  4348
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.71556723, 'recall': 0.52386403, 'specificity': 0.52386403, 'f1': 0.53615665, 'auroc': 0.9398428, 'binary_precision': 0.46376812, 'binary_recall': 0.04976672, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.08988764}
confusion matrix:
       0   1
0  18112  37
1    611  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.9975112, 'recall': 0.98084295, 'specificity': 0.98084295, 'f1': 0.98898685, 'auroc': 0.99984217, 'binary_precision': 1.0, 'binary_recall': 0.96168584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98046875}
confusion matrix:
      0    1
0  5997    0
1    30  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_22.png
early stop counter: 7
val acc:0.9655172228813171, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 22,now: 2024-06-11 01:06:24.502904,epoch time: 0:23:16.362244,used: 8:40:17.136306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99651235, 'precision': 0.992723, 'recall': 0.9868177, 'specificity': 0.9868177, 'f1': 0.9897479, 'auroc': 0.99925005, 'binary_precision': 0.9880652, 'binary_recall': 0.9748641, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.9814203}
confusion matrix:
       0     1
0  42268    52
1    111  4305
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.8409235, 'recall': 0.5268305, 'specificity': 0.5268305, 'f1': 0.54214805, 'auroc': 0.927172, 'binary_precision': 0.71428573, 'binary_recall': 0.054432347, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.10115606}
confusion matrix:
       0   1
0  18135  14
1    608  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99734616, 'recall': 0.97956574, 'specificity': 0.97956574, 'f1': 0.9882393, 'auroc': 0.9983381, 'binary_precision': 1.0, 'binary_recall': 0.95913154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9791395}
confusion matrix:
      0    1
0  5997    0
1    32  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_23.png
early stop counter: 8
val acc:0.9669008255004883, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 23,now: 2024-06-11 01:29:41.097373,epoch time: 0:23:16.594469,used: 9:03:33.730775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.995956, 'precision': 0.9829707, 'recall': 0.993812, 'specificity': 0.993812, 'f1': 0.9883151, 'auroc': 0.9996569, 'binary_precision': 0.9668655, 'binary_recall': 0.9911685, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.9788661}
confusion matrix:
       0     1
0  42170   150
1     39  4377
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.788227, 'recall': 0.7087171, 'specificity': 0.7087171, 'f1': 0.74150103, 'auroc': 0.95308745, 'binary_precision': 0.5965293, 'binary_recall': 0.42768273, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.49818844}
confusion matrix:
       0    1
0  17963  186
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.9799922, 'recall': 0.9916682, 'specificity': 0.9916682, 'f1': 0.98573494, 'auroc': 0.99973106, 'binary_precision': 0.9614907, 'binary_recall': 0.9885057, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.974811}
confusion matrix:
      0    1
0  5966   31
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_24.png
early stop counter: 9
val acc:0.9705193638801575, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 24,now: 2024-06-11 01:52:59.747861,epoch time: 0:23:18.650488,used: 9:26:52.381263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9779827, 'precision': 0.98813176, 'recall': 0.88343906, 'specificity': 0.88343906, 'f1': 0.9280246, 'auroc': 0.99966204, 'binary_precision': 1.0, 'binary_recall': 0.7668781, 'binary_specificity': 1.0, 'binary_f1_score': 0.86806}
confusion matrix:
       0     1
0  42322     0
1   1029  3385
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.939772, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569321, 'precision': 0.9767848, 'recall': 0.8135377, 'specificity': 0.8135377, 'f1': 0.87351686, 'auroc': 0.9985633, 'binary_precision': 1.0, 'binary_recall': 0.6270754, 'binary_specificity': 1.0, 'binary_f1_score': 0.7708006}
confusion matrix:
      0    1
0  5997    0
1   292  491
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_25.png
early stop counter: 10
val acc:0.9657300710678101, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 25,now: 2024-06-11 02:16:15.465926,epoch time: 0:23:15.718065,used: 9:50:08.099328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9978817, 'precision': 0.9988332, 'recall': 0.9887806, 'specificity': 0.9887806, 'f1': 0.9937425, 'auroc': 0.9997114, 'binary_precision': 1.0, 'binary_recall': 0.9775612, 'binary_specificity': 1.0, 'binary_f1_score': 0.98865324}
confusion matrix:
       0     1
0  42324     0
1     99  4313
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.9161434, 'recall': 0.5247456, 'specificity': 0.5247456, 'f1': 0.53871286, 'auroc': 0.9501435, 'binary_precision': 0.8648649, 'binary_recall': 0.04976672, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.09411764}
confusion matrix:
       0   1
0  18144   5
1    611  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9957227, 'precision': 0.99759376, 'recall': 0.9814815, 'specificity': 0.9814815, 'f1': 0.98936003, 'auroc': 0.9995174, 'binary_precision': 1.0, 'binary_recall': 0.962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811321}
confusion matrix:
      0    1
0  5997    0
1    29  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_26.png
early stop counter: 11
val acc:0.9672200679779053, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9970501661300659
after epoch: 26,now: 2024-06-11 02:39:33.207091,epoch time: 0:23:17.741165,used: 10:13:25.840493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.998652, 'precision': 0.99782336, 'recall': 0.99428535, 'specificity': 0.99428535, 'f1': 0.9960464, 'auroc': 0.9996793, 'binary_precision': 0.99680364, 'binary_recall': 0.9889015, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99283683}
confusion matrix:
       0     1
0  42307    14
1     49  4366
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7208502, 'recall': 0.53361475, 'specificity': 0.53361475, 'f1': 0.55218226, 'auroc': 0.9449979, 'binary_precision': 0.47368422, 'binary_recall': 0.06998445, 'binary_specificity': 0.997245, 'binary_f1_score': 0.12195122}
confusion matrix:
       0   1
0  18099  50
1    598  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.9999684, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_27.png
new oracle model saved
early stop counter: 12
val acc:0.9655172228813171, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9973451495170593
after epoch: 27,now: 2024-06-11 03:02:50.471898,epoch time: 0:23:17.264807,used: 10:36:43.105300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9976891, 'precision': 0.9987273, 'recall': 0.987769, 'specificity': 0.987769, 'f1': 0.9931716, 'auroc': 0.99982005, 'binary_precision': 1.0, 'binary_recall': 0.97553796, 'binary_specificity': 1.0, 'binary_f1_score': 0.9876175}
confusion matrix:
       0     1
0  42321     0
1    108  4307
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.816326, 'recall': 0.50305533, 'specificity': 0.50305533, 'f1': 0.4974859, 'auroc': 0.9530795, 'binary_precision': 0.6666667, 'binary_recall': 0.00622084, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.012326658}
confusion matrix:
       0  1
0  18147  2
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.9994079, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_28.png
early stop counter: 13
val acc:0.9658897519111633, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9973451495170593
after epoch: 28,now: 2024-06-11 03:26:07.798274,epoch time: 0:23:17.326376,used: 11:00:00.431676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.99893606, 'recall': 0.9930563, 'specificity': 0.9930563, 'f1': 0.99597424, 'auroc': 0.99986887, 'binary_precision': 0.99931145, 'binary_recall': 0.98618346, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9927041}
confusion matrix:
       0     1
0  42318     3
1     61  4354
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.88195676, 'recall': 0.6217045, 'specificity': 0.6217045, 'f1': 0.68025404, 'auroc': 0.9574152, 'binary_precision': 0.79, 'binary_recall': 0.24572317, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.37485173}
confusion matrix:
       0    1
0  18107   42
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.99858665, 'recall': 0.9891443, 'specificity': 0.9891443, 'f1': 0.9938049, 'auroc': 0.9998714, 'binary_precision': 1.0, 'binary_recall': 0.97828865, 'binary_specificity': 1.0, 'binary_f1_score': 0.9890252}
confusion matrix:
      0    1
0  5997    0
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_29.png
new oracle model saved
early stop counter: 14
val acc:0.9719561338424683, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9974926114082336
after epoch: 29,now: 2024-06-11 03:49:29.787646,epoch time: 0:23:21.989372,used: 11:23:22.421048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.999245, 'recall': 0.9927536, 'specificity': 0.9927536, 'f1': 0.9959726, 'auroc': 0.9996867, 'binary_precision': 1.0, 'binary_recall': 0.98550725, 'binary_specificity': 1.0, 'binary_f1_score': 0.99270076}
confusion matrix:
       0     1
0  42320     0
1     64  4352
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.9366274, 'recall': 0.5581, 'specificity': 0.5581, 'f1': 0.595492, 'auroc': 0.9504033, 'binary_precision': 0.90361446, 'binary_recall': 0.11664075, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.20661157}
confusion matrix:
       0   1
0  18141   8
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9995644, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_30.png
early stop counter: 15
val acc:0.969348669052124, best validation acc: 0.9721689820289612, corresponding to test acc:                         0.9969026446342468 / 0.9974926114082336
after epoch: 30,now: 2024-06-11 04:12:44.987778,epoch time: 0:23:15.200132,used: 11:46:37.621180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_07_seed_0_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:46:37.621180 at 2024-06-11 04:12:44.987778
persisted model performance metric: 

scalar performance:
{'acc': 0.99705017, 'precision': 0.99776703, 'recall': 0.9877838, 'specificity': 0.9877838, 'f1': 0.9927075, 'auroc': 0.99954855, 'binary_precision': 0.9986928, 'binary_recall': 0.97573435, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98708004}
confusion matrix:
      0    1
0  5996    1
1    19  764
oracle model performance metric: 

scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.99982876, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456645 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456645 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447778 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  40703 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14472 MiB |  14472 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473147 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |  11464 KiB |     17 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3680    |    6847    |  210924 K  |  210920 K  |
|       from large pool |     187    |    1413    |  109923 K  |  109923 K  |
|       from small pool |    3493    |    6658    |  101000 K  |  100997 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3680    |    6847    |  210924 K  |  210920 K  |
|       from large pool |     187    |    1413    |  109923 K  |  109923 K  |
|       from small pool |    3493    |    6658    |  101000 K  |  100997 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |     635    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2988    |  141721 K  |  141721 K  |
|       from large pool |      39    |     600    |   89616 K  |   89616 K  |
|       from small pool |      43    |    2948    |   52105 K  |   52105 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14472 MiB |  14472 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     68 MiB |     68 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210924 K  |  210924 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  101000 K  |  101000 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210924 K  |  210924 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  101000 K  |  101000 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     635    |     635    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      34    |      34    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  141723 K  |  141723 K  |
|       from large pool |       4    |     600    |   89616 K  |   89616 K  |
|       from small pool |       0    |    2948    |   52106 K  |   52106 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1201 TiB |   1201 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1187 TiB |   1187 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1193 TiB |   1193 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14472 MiB |  14472 MiB |  13564 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     68 MiB |     68 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    845 TiB |    845 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    831 TiB |    831 TiB |
|       from small pool |      0 KiB |     42 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210924 K  |  210924 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  101000 K  |  101000 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210924 K  |  210924 K  |
|       from large pool |       2    |    1413    |  109923 K  |  109923 K  |
|       from small pool |       0    |    6658    |  101000 K  |  101000 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     635    |     635    |     571    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      34    |      34    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  141723 K  |  141723 K  |
|       from large pool |       4    |     600    |   89616 K  |   89616 K  |
|       from small pool |       0    |    2948    |   52106 K  |   52106 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197

 Experiment start at: 2024-06-11 04:18:40.341064
before training, model accuracy: 0.18019625544548035
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9942871, 'precision': 0.9895562, 'recall': 0.97619784, 'specificity': 0.97619784, 'f1': 0.9827613, 'auroc': 0.99656206, 'binary_precision': 0.9837902, 'binary_recall': 0.9539991, 'binary_specificity': 0.9983966, 'binary_f1_score': 0.96866566}
confusion matrix:
       0     1
0  42342    68
1    199  4127
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.75409377, 'recall': 0.73769444, 'specificity': 0.73769444, 'f1': 0.74558854, 'auroc': 0.92852974, 'binary_precision': 0.52707005, 'binary_recall': 0.49182764, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.5088393}
confusion matrix:
       0    1
0  17770  297
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9888492, 'precision': 0.9888735, 'recall': 0.9563786, 'specificity': 0.9563786, 'f1': 0.9718789, 'auroc': 0.9923147, 'binary_precision': 0.9889043, 'binary_recall': 0.91410255, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.9500333}
confusion matrix:
      0    1
0  5938    8
1    67  713
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 04:42:39.336361,epoch time: 0:23:58.995297,used: 0:23:58.995297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9914841, 'precision': 0.99454373, 'recall': 0.9547256, 'specificity': 0.9547256, 'f1': 0.9735958, 'auroc': 0.9954219, 'binary_precision': 0.99822426, 'binary_recall': 0.9096163, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9518627}
confusion matrix:
       0     1
0  42403     7
1    391  3935
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.8059956, 'recall': 0.6323649, 'specificity': 0.6323649, 'f1': 0.68184704, 'auroc': 0.87850654, 'binary_precision': 0.6385965, 'binary_recall': 0.2704309, 'binary_specificity': 0.994299, 'binary_f1_score': 0.37995824}
confusion matrix:
       0    1
0  17964  103
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9866191, 'precision': 0.9925448, 'recall': 0.9423077, 'specificity': 0.9423077, 'f1': 0.9656321, 'auroc': 0.9969276, 'binary_precision': 1.0, 'binary_recall': 0.88461536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9387755}
confusion matrix:
      0    1
0  5946    0
1    90  690
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_2.png
better model found
persisted
after epoch: 2,now: 2024-06-11 05:05:55.048245,epoch time: 0:23:15.711884,used: 0:47:14.707181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9927679, 'precision': 0.97145605, 'recall': 0.98646635, 'specificity': 0.98646635, 'f1': 0.97881246, 'auroc': 0.99916613, 'binary_precision': 0.9450893, 'binary_recall': 0.97873324, 'binary_specificity': 0.99419945, 'binary_f1_score': 0.96161705}
confusion matrix:
       0     1
0  42164   246
1     92  4234
---- Validation: 
scalar performance:
{'acc': 0.95341516, 'precision': 0.6982246, 'recall': 0.8163353, 'specificity': 0.8163353, 'f1': 0.74158263, 'auroc': 0.93288374, 'binary_precision': 0.4090909, 'binary_recall': 0.6686478, 'binary_specificity': 0.9640228, 'binary_f1_score': 0.5076142}
confusion matrix:
       0    1
0  17417  650
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390423, 'precision': 0.9897046, 'recall': 0.98040116, 'specificity': 0.98040116, 'f1': 0.9849928, 'auroc': 0.99852467, 'binary_precision': 0.9842726, 'binary_recall': 0.96282053, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.97342837}
confusion matrix:
      0    1
0  5934   12
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_3.png
new oracle model saved
early stop counter: 1
val acc:0.9534151554107666, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9939042329788208
after epoch: 3,now: 2024-06-11 05:29:17.369033,epoch time: 0:23:22.320788,used: 1:10:37.027969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9958276, 'precision': 0.9939535, 'recall': 0.9810945, 'specificity': 0.9810945, 'f1': 0.98741794, 'auroc': 0.99842596, 'binary_precision': 0.99166864, 'binary_recall': 0.9630143, 'binary_specificity': 0.9991747, 'binary_f1_score': 0.9771315}
confusion matrix:
       0     1
0  42375    35
1    160  4166
---- Validation: 
scalar performance:
{'acc': 0.95971185, 'precision': 0.7148857, 'recall': 0.7487894, 'specificity': 0.7487894, 'f1': 0.73042655, 'auroc': 0.9328552, 'binary_precision': 0.44770408, 'binary_recall': 0.5215453, 'binary_specificity': 0.9760336, 'binary_f1_score': 0.4818119}
confusion matrix:
       0    1
0  17634  433
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405295, 'precision': 0.99665886, 'recall': 0.974359, 'specificity': 0.974359, 'f1': 0.98516595, 'auroc': 0.9987055, 'binary_precision': 1.0, 'binary_recall': 0.94871795, 'binary_specificity': 1.0, 'binary_f1_score': 0.9736842}
confusion matrix:
      0    1
0  5946    0
1    40  740
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_4.png
new oracle model saved
early stop counter: 2
val acc:0.9597118496894836, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9940529465675354
after epoch: 4,now: 2024-06-11 05:52:24.453854,epoch time: 0:23:07.084821,used: 1:33:44.112790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99482197, 'precision': 0.9971632, 'recall': 0.9720231, 'specificity': 0.9720231, 'f1': 0.9841865, 'auroc': 0.99948436, 'binary_precision': 1.0, 'binary_recall': 0.94404626, 'binary_specificity': 1.0, 'binary_f1_score': 0.9712179}
confusion matrix:
       0     1
0  42411     0
1    242  4083
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.60706663, 'recall': 0.5006599, 'specificity': 0.5006599, 'f1': 0.49230665, 'auroc': 0.9321003, 'binary_precision': 0.25, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0029542097}
confusion matrix:
       0  1
0  18064  3
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9897413, 'precision': 0.99426436, 'recall': 0.95576924, 'specificity': 0.95576924, 'f1': 0.9739768, 'auroc': 0.9994556, 'binary_precision': 1.0, 'binary_recall': 0.9115385, 'binary_specificity': 1.0, 'binary_f1_score': 0.95372236}
confusion matrix:
      0    1
0  5946    0
1    69  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_5.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9940529465675354
after epoch: 5,now: 2024-06-11 06:15:36.749404,epoch time: 0:23:12.295550,used: 1:56:56.408340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9973254, 'precision': 0.9961961, 'recall': 0.98783314, 'specificity': 0.98783314, 'f1': 0.9919701, 'auroc': 0.99889195, 'binary_precision': 0.9948162, 'binary_recall': 0.97618496, 'binary_specificity': 0.99948126, 'binary_f1_score': 0.9854125}
confusion matrix:
       0     1
0  42389    22
1    103  4222
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.73188657, 'recall': 0.5978809, 'specificity': 0.5978809, 'f1': 0.63479227, 'auroc': 0.9272816, 'binary_precision': 0.49280575, 'binary_recall': 0.20356612, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.28811777}
confusion matrix:
       0    1
0  17926  141
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99509364, 'precision': 0.9954967, 'recall': 0.9805169, 'specificity': 0.9805169, 'f1': 0.98785245, 'auroc': 0.9997676, 'binary_precision': 0.99601597, 'binary_recall': 0.96153843, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.9784736}
confusion matrix:
      0    1
0  5943    3
1    30  750
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_6.png
new oracle model saved
early stop counter: 4
val acc:0.9638740420341492, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9950936436653137
after epoch: 6,now: 2024-06-11 06:39:02.307368,epoch time: 0:23:25.557964,used: 2:20:21.966304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9974966, 'precision': 0.9978775, 'recall': 0.98720366, 'specificity': 0.98720366, 'f1': 0.99246824, 'auroc': 0.9991652, 'binary_precision': 0.9983424, 'binary_recall': 0.97457236, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9863142}
confusion matrix:
       0     1
0  42403     7
1    110  4216
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.8334673, 'recall': 0.5409405, 'specificity': 0.5409405, 'f1': 0.56564265, 'auroc': 0.93981326, 'binary_precision': 0.7, 'binary_recall': 0.08320951, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.14873837}
confusion matrix:
       0   1
0  18043  24
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9936069, 'precision': 0.9964101, 'recall': 0.9724359, 'specificity': 0.9724359, 'f1': 0.98402584, 'auroc': 0.9992993, 'binary_precision': 1.0, 'binary_recall': 0.9448718, 'binary_specificity': 1.0, 'binary_f1_score': 0.9716546}
confusion matrix:
      0    1
0  5946    0
1    43  737
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_7.png
early stop counter: 5
val acc:0.96579509973526, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9950936436653137
after epoch: 7,now: 2024-06-11 07:02:16.529409,epoch time: 0:23:14.222041,used: 2:43:36.188345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9958276, 'precision': 0.99771154, 'recall': 0.9774618, 'specificity': 0.9774618, 'f1': 0.98732424, 'auroc': 0.99957263, 'binary_precision': 1.0, 'binary_recall': 0.9549237, 'binary_specificity': 1.0, 'binary_f1_score': 0.9769422}
confusion matrix:
       0     1
0  42410     0
1    195  4131
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.95085037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9916741, 'precision': 0.99533486, 'recall': 0.96410257, 'specificity': 0.96410257, 'f1': 0.9790395, 'auroc': 0.9983808, 'binary_precision': 1.0, 'binary_recall': 0.92820513, 'binary_specificity': 1.0, 'binary_f1_score': 0.96276593}
confusion matrix:
      0    1
0  5946    0
1    56  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_8.png
early stop counter: 6
val acc:0.9639274477958679, best validation acc: 0.9683030843734741, corresponding to test acc:                         0.9866191148757935 / 0.9950936436653137
after epoch: 8,now: 2024-06-11 07:25:32.672327,epoch time: 0:23:16.142918,used: 3:06:52.331263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9978175, 'precision': 0.9961686, 'recall': 0.99080557, 'specificity': 0.99080557, 'f1': 0.9934689, 'auroc': 0.9996657, 'binary_precision': 0.9941507, 'binary_recall': 0.9822006, 'binary_specificity': 0.9994105, 'binary_f1_score': 0.98813957}
confusion matrix:
       0     1
0  42385    25
1     77  4249
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.80452514, 'recall': 0.66210604, 'specificity': 0.66210604, 'f1': 0.7096197, 'auroc': 0.9309825, 'binary_precision': 0.63352275, 'binary_recall': 0.33135214, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.43512195}
confusion matrix:
       0    1
0  17938  129
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.99624443, 'recall': 0.98124206, 'specificity': 0.98124206, 'f1': 0.9885887, 'auroc': 0.9993273, 'binary_precision': 0.99734396, 'binary_recall': 0.96282053, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.97977823}
confusion matrix:
      0    1
0  5944    2
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-11 07:48:46.415556,epoch time: 0:23:13.743229,used: 3:30:06.074492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99709004, 'precision': 0.9982941, 'recall': 0.9843849, 'specificity': 0.9843849, 'f1': 0.9912164, 'auroc': 0.9993672, 'binary_precision': 0.99976146, 'binary_recall': 0.96879333, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9840338}
confusion matrix:
       0     1
0  42409     1
1    135  4191
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.56541896, 'recall': 0.50120914, 'specificity': 0.50120914, 'f1': 0.49366572, 'auroc': 0.94186187, 'binary_precision': 0.16666667, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.005839416}
confusion matrix:
       0   1
0  18057  10
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961344, 'precision': 0.9978232, 'recall': 0.98333335, 'specificity': 0.98333335, 'f1': 0.99043465, 'auroc': 0.99893034, 'binary_precision': 1.0, 'binary_recall': 0.96666664, 'binary_specificity': 1.0, 'binary_f1_score': 0.9830508}
confusion matrix:
      0    1
0  5946    0
1    26  754
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_10.png
new oracle model saved
early stop counter: 1
val acc:0.9636605978012085, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9953910112380981 / 0.9961344003677368
after epoch: 10,now: 2024-06-11 08:12:00.303877,epoch time: 0:23:13.888321,used: 3:53:19.962813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9978817, 'precision': 0.99883556, 'recall': 0.9885576, 'specificity': 0.9885576, 'f1': 0.9936296, 'auroc': 0.99956226, 'binary_precision': 1.0, 'binary_recall': 0.9771151, 'binary_specificity': 1.0, 'binary_f1_score': 0.9884251}
confusion matrix:
       0     1
0  42410     0
1     99  4227
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.6821896, 'recall': 0.50420856, 'specificity': 0.50420856, 'f1': 0.4995342, 'auroc': 0.95517117, 'binary_precision': 0.4, 'binary_recall': 0.008915304, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.01744186}
confusion matrix:
       0  1
0  18058  9
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.99892986, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_11.png
early stop counter: 2
val acc:0.9639274477958679, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9953910112380981 / 0.9961344003677368
after epoch: 11,now: 2024-06-11 08:35:23.589060,epoch time: 0:23:23.285183,used: 4:16:43.247996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9973254, 'precision': 0.99842334, 'recall': 0.9856529, 'specificity': 0.9856529, 'f1': 0.99193454, 'auroc': 0.9998287, 'binary_precision': 0.999762, 'binary_recall': 0.97132945, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9853406}
confusion matrix:
       0     1
0  42410     1
1    124  4201
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.68214095, 'recall': 0.5028057, 'specificity': 0.5028057, 'f1': 0.49668458, 'auroc': 0.93660486, 'binary_precision': 0.4, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.011713031}
confusion matrix:
       0  1
0  18061  6
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994945, 'precision': 0.9959893, 'recall': 0.979319, 'specificity': 0.979319, 'f1': 0.98746294, 'auroc': 0.9992435, 'binary_precision': 0.99733335, 'binary_recall': 0.95897436, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9777778}
confusion matrix:
      0    1
0  5944    2
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_12.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9953910112380981 / 0.9961344003677368
after epoch: 12,now: 2024-06-11 08:58:41.280674,epoch time: 0:23:17.691614,used: 4:40:00.939610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9986227, 'recall': 0.9899092, 'specificity': 0.9899092, 'f1': 0.9942179, 'auroc': 0.99963176, 'binary_precision': 0.9992928, 'binary_recall': 0.97988904, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9894959}
confusion matrix:
       0     1
0  42407     3
1     87  4239
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.89579445, 'recall': 0.62010324, 'specificity': 0.62010324, 'f1': 0.6794692, 'auroc': 0.9587179, 'binary_precision': 0.8190955, 'binary_recall': 0.24219911, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.37385324}
confusion matrix:
       0    1
0  18031   36
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.9974067, 'recall': 0.98012817, 'specificity': 0.98012817, 'f1': 0.9885627, 'auroc': 0.99875593, 'binary_precision': 1.0, 'binary_recall': 0.9602564, 'binary_specificity': 1.0, 'binary_f1_score': 0.97972536}
confusion matrix:
      0    1
0  5946    0
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_13.png
better model found
persisted
after epoch: 13,now: 2024-06-11 09:22:05.861988,epoch time: 0:23:24.581314,used: 5:03:25.520924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.99516064, 'recall': 0.9920746, 'specificity': 0.9920746, 'f1': 0.9936116, 'auroc': 0.99941266, 'binary_precision': 0.9918529, 'binary_recall': 0.98497456, 'binary_specificity': 0.9991747, 'binary_f1_score': 0.9884018}
confusion matrix:
       0     1
0  42375    35
1     65  4261
---- Validation: 
scalar performance:
{'acc': 0.9588581, 'precision': 0.69391084, 'recall': 0.6617994, 'specificity': 0.6617994, 'f1': 0.67620516, 'auroc': 0.90997374, 'binary_precision': 0.41218638, 'binary_recall': 0.34175333, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.3736799}
confusion matrix:
       0    1
0  17739  328
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.995966, 'recall': 0.9887662, 'specificity': 0.9887662, 'f1': 0.9923307, 'auroc': 0.9994992, 'binary_precision': 0.9947849, 'binary_recall': 0.97820514, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.98642534}
confusion matrix:
      0    1
0  5942    4
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_14.png
new oracle model saved
early stop counter: 1
val acc:0.958858072757721, best validation acc: 0.970864474773407, corresponding to test acc:                         0.9953910112380981 / 0.9968777894973755
after epoch: 14,now: 2024-06-11 09:45:29.152934,epoch time: 0:23:23.290946,used: 5:26:48.811870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99835247, 'precision': 0.9961698, 'recall': 0.9940052, 'specificity': 0.9940052, 'f1': 0.9950845, 'auroc': 0.99982464, 'binary_precision': 0.99349445, 'binary_recall': 0.9886705, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.99107665}
confusion matrix:
       0     1
0  42383    28
1     49  4276
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.8123501, 'recall': 0.63324624, 'specificity': 0.63324624, 'f1': 0.6837748, 'auroc': 0.9380045, 'binary_precision': 0.65124553, 'binary_recall': 0.27191678, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.38364777}
confusion matrix:
       0    1
0  17969   98
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.9998902, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_15.png
early stop counter: 2
val acc:0.9686232805252075, best validation acc: 0.970864474773407, corresponding to test acc:                         0.9953910112380981 / 0.9968777894973755
after epoch: 15,now: 2024-06-11 10:08:50.976346,epoch time: 0:23:21.823412,used: 5:50:10.635282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99683326, 'precision': 0.9982612, 'recall': 0.9828941, 'specificity': 0.9828941, 'f1': 0.99042726, 'auroc': 0.99944425, 'binary_precision': 1.0, 'binary_recall': 0.96578825, 'binary_specificity': 1.0, 'binary_f1_score': 0.9825964}
confusion matrix:
       0     1
0  42410     0
1    148  4178
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73209333, 'recall': 0.5014305, 'specificity': 0.5014305, 'f1': 0.49381095, 'auroc': 0.9236549, 'binary_precision': 0.5, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0059084194}
confusion matrix:
       0  1
0  18065  2
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927148, 'precision': 0.99591327, 'recall': 0.9685898, 'specificity': 0.9685898, 'f1': 0.9817338, 'auroc': 0.9998715, 'binary_precision': 1.0, 'binary_recall': 0.9371795, 'binary_specificity': 1.0, 'binary_f1_score': 0.96757114}
confusion matrix:
      0    1
0  5946    0
1    49  731
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_16.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.970864474773407, corresponding to test acc:                         0.9953910112380981 / 0.9968777894973755
after epoch: 16,now: 2024-06-11 10:32:13.614984,epoch time: 0:23:22.638638,used: 6:13:33.273920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.99869335, 'recall': 0.9894538, 'specificity': 0.9894538, 'f1': 0.9940195, 'auroc': 0.9995804, 'binary_precision': 0.99952775, 'binary_recall': 0.9789547, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.98913425}
confusion matrix:
       0     1
0  42410     2
1     91  4233
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.8334721, 'recall': 0.6943016, 'specificity': 0.6943016, 'f1': 0.74394554, 'auroc': 0.9568393, 'binary_precision': 0.68911916, 'binary_recall': 0.39524516, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.50236076}
confusion matrix:
       0    1
0  17947  120
1    407  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99435025, 'precision': 0.99682486, 'recall': 0.975641, 'specificity': 0.975641, 'f1': 0.98592377, 'auroc': 0.9993638, 'binary_precision': 1.0, 'binary_recall': 0.951282, 'binary_specificity': 1.0, 'binary_f1_score': 0.97503287}
confusion matrix:
      0    1
0  5946    0
1    38  742
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_17.png
better model found
persisted
after epoch: 17,now: 2024-06-11 10:55:39.621826,epoch time: 0:23:26.006842,used: 6:36:59.280762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99713284, 'precision': 0.9984252, 'recall': 0.98450863, 'specificity': 0.98450863, 'f1': 0.9913438, 'auroc': 0.9998447, 'binary_precision': 1.0, 'binary_recall': 0.9690173, 'binary_specificity': 1.0, 'binary_f1_score': 0.9842649}
confusion matrix:
       0     1
0  42411     0
1    134  4191
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.69640285, 'recall': 0.5021181, 'specificity': 0.5021181, 'f1': 0.49525416, 'auroc': 0.9603012, 'binary_precision': 0.42857143, 'binary_recall': 0.004457652, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.008823529}
confusion matrix:
       0  1
0  18063  4
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937556, 'precision': 0.996493, 'recall': 0.97307694, 'specificity': 0.97307694, 'f1': 0.98440635, 'auroc': 0.998778, 'binary_precision': 1.0, 'binary_recall': 0.9461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.972332}
confusion matrix:
      0    1
0  5946    0
1    42  738
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_18.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9968777894973755
after epoch: 18,now: 2024-06-11 11:19:02.710814,epoch time: 0:23:23.088988,used: 7:00:22.369750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9978175, 'precision': 0.99340177, 'recall': 0.9936066, 'specificity': 0.9936066, 'f1': 0.99350417, 'auroc': 0.9997227, 'binary_precision': 0.98798245, 'binary_recall': 0.9884393, 'binary_specificity': 0.99877393, 'binary_f1_score': 0.9882108}
confusion matrix:
       0     1
0  42359    52
1     50  4275
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.79237485, 'recall': 0.5957713, 'specificity': 0.5957713, 'f1': 0.6401222, 'auroc': 0.92673284, 'binary_precision': 0.6139535, 'binary_recall': 0.1961367, 'binary_specificity': 0.995406, 'binary_f1_score': 0.2972973}
confusion matrix:
       0    1
0  17984   83
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.995116, 'recall': 0.99180317, 'specificity': 0.99180317, 'f1': 0.9934521, 'auroc': 0.9994644, 'binary_precision': 0.99224806, 'binary_recall': 0.9846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.988417}
confusion matrix:
      0    1
0  5940    6
1    12  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_19.png
new oracle model saved
early stop counter: 2
val acc:0.9667022228240967, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9973238110542297
after epoch: 19,now: 2024-06-11 11:42:18.522547,epoch time: 0:23:15.811733,used: 7:23:38.181483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9961914, 'precision': 0.9879705, 'recall': 0.98938847, 'specificity': 0.98938847, 'f1': 0.98867816, 'auroc': 0.998684, 'binary_precision': 0.9778751, 'binary_recall': 0.9810405, 'binary_specificity': 0.99773645, 'binary_f1_score': 0.97945523}
confusion matrix:
       0     1
0  42315    96
1     82  4243
---- Validation: 
scalar performance:
{'acc': 0.9607257, 'precision': 0.71398026, 'recall': 0.6992466, 'specificity': 0.6992466, 'f1': 0.7063161, 'auroc': 0.92887866, 'binary_precision': 0.4496, 'binary_recall': 0.41753343, 'binary_specificity': 0.9809598, 'binary_f1_score': 0.43297383}
confusion matrix:
       0    1
0  17723  344
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937556, 'precision': 0.98906004, 'recall': 0.9803171, 'specificity': 0.9803171, 'f1': 0.9846354, 'auroc': 0.996534, 'binary_precision': 0.9829843, 'binary_recall': 0.96282053, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.97279793}
confusion matrix:
      0    1
0  5933   13
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_20.png
early stop counter: 3
val acc:0.960725724697113, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9973238110542297
after epoch: 20,now: 2024-06-11 12:05:30.088982,epoch time: 0:23:11.566435,used: 7:46:49.747918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9991174, 'recall': 0.99132746, 'specificity': 0.99132746, 'f1': 0.99518406, 'auroc': 0.9997376, 'binary_precision': 1.0, 'binary_recall': 0.9826549, 'binary_specificity': 1.0, 'binary_f1_score': 0.9912516}
confusion matrix:
       0     1
0  42412     0
1     75  4249
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.9092905, 'recall': 0.570852, 'specificity': 0.570852, 'f1': 0.6140435, 'auroc': 0.94020504, 'binary_precision': 0.8495575, 'binary_recall': 0.14264487, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.2442748}
confusion matrix:
       0   1
0  18050  17
1    577  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.99919474, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_21.png
early stop counter: 4
val acc:0.9683030843734741, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9973238110542297
after epoch: 21,now: 2024-06-11 12:28:48.337088,epoch time: 0:23:18.248106,used: 8:10:07.996024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99764633, 'precision': 0.99482775, 'recall': 0.9911264, 'specificity': 0.9911264, 'f1': 0.9929684, 'auroc': 0.99967664, 'binary_precision': 0.99137527, 'binary_recall': 0.98312527, 'binary_specificity': 0.99912757, 'binary_f1_score': 0.98723304}
confusion matrix:
       0     1
0  42373    37
1     73  4253
---- Validation: 
scalar performance:
{'acc': 0.95298827, 'precision': 0.602213, 'recall': 0.5607635, 'specificity': 0.5607635, 'f1': 0.57506293, 'auroc': 0.8977132, 'binary_precision': 0.2360406, 'binary_recall': 0.13818721, 'binary_specificity': 0.9833398, 'binary_f1_score': 0.1743205}
confusion matrix:
       0    1
0  17766  301
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99701095, 'recall': 0.9870113, 'specificity': 0.9870113, 'f1': 0.99194276, 'auroc': 0.99939156, 'binary_precision': 0.9973753, 'binary_recall': 0.974359, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9857328}
confusion matrix:
      0    1
0  5944    2
1    20  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_22.png
early stop counter: 5
val acc:0.9529882669448853, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9973238110542297
after epoch: 22,now: 2024-06-11 12:52:06.496668,epoch time: 0:23:18.159580,used: 8:33:26.155604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.99784577, 'recall': 0.99577785, 'specificity': 0.99577785, 'f1': 0.9968091, 'auroc': 0.9998765, 'binary_precision': 0.99651647, 'binary_recall': 0.9919094, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.9942076}
confusion matrix:
       0     1
0  42395    15
1     35  4291
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7347169, 'recall': 0.725637, 'specificity': 0.725637, 'f1': 0.73007625, 'auroc': 0.9410402, 'binary_precision': 0.48916408, 'binary_recall': 0.46953937, 'binary_specificity': 0.98173463, 'binary_f1_score': 0.4791509}
confusion matrix:
       0    1
0  17737  330
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.99897206, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_23.png
new oracle model saved
early stop counter: 6
val acc:0.9633404612541199, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 23,now: 2024-06-11 13:15:31.388013,epoch time: 0:23:24.891345,used: 8:56:51.046949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99304605, 'precision': 0.991108, 'recall': 0.9672034, 'specificity': 0.9672034, 'f1': 0.9787833, 'auroc': 0.9978782, 'binary_precision': 0.98875856, 'binary_recall': 0.9354913, 'binary_specificity': 0.9989154, 'binary_f1_score': 0.96138763}
confusion matrix:
       0     1
0  42365    46
1    279  4046
---- Validation: 
scalar performance:
{'acc': 0.9565635, 'precision': 0.64999837, 'recall': 0.5933742, 'specificity': 0.5933742, 'f1': 0.61404705, 'auroc': 0.88012767, 'binary_precision': 0.3292978, 'binary_recall': 0.20208023, 'binary_specificity': 0.9846682, 'binary_f1_score': 0.25046042}
confusion matrix:
       0    1
0  17790  277
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98736244, 'precision': 0.99105525, 'recall': 0.9471836, 'specificity': 0.9471836, 'f1': 0.96775293, 'auroc': 0.99888563, 'binary_precision': 0.9957204, 'binary_recall': 0.8948718, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.94260633}
confusion matrix:
      0    1
0  5943    3
1    82  698
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_24.png
early stop counter: 7
val acc:0.9565634727478027, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 24,now: 2024-06-11 13:39:10.566313,epoch time: 0:23:39.178300,used: 9:20:30.225249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9966835, 'precision': 0.9981793, 'recall': 0.98207676, 'specificity': 0.98207676, 'f1': 0.9899629, 'auroc': 0.99980843, 'binary_precision': 1.0, 'binary_recall': 0.9641536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817497}
confusion matrix:
       0     1
0  42412     0
1    155  4169
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.6127553, 'recall': 0.5079743, 'specificity': 0.5079743, 'f1': 0.5072369, 'auroc': 0.93819517, 'binary_precision': 0.26086956, 'binary_recall': 0.017830608, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.033379693}
confusion matrix:
       0   1
0  18033  34
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.9990188, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_25.png
early stop counter: 8
val acc:0.9629135727882385, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 25,now: 2024-06-11 14:02:40.920113,epoch time: 0:23:30.353800,used: 9:44:00.579049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9980957, 'precision': 0.998953, 'recall': 0.989711, 'specificity': 0.989711, 'f1': 0.99427795, 'auroc': 0.999918, 'binary_precision': 1.0, 'binary_recall': 0.979422, 'binary_specificity': 1.0, 'binary_f1_score': 0.989604}
confusion matrix:
       0     1
0  42411     0
1     89  4236
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7129607, 'recall': 0.50426394, 'specificity': 0.50426394, 'f1': 0.49958727, 'auroc': 0.94923544, 'binary_precision': 0.46153846, 'binary_recall': 0.008915304, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.017492712}
confusion matrix:
       0  1
0  18060  7
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937556, 'precision': 0.996493, 'recall': 0.97307694, 'specificity': 0.97307694, 'f1': 0.98440635, 'auroc': 0.99985594, 'binary_precision': 1.0, 'binary_recall': 0.9461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.972332}
confusion matrix:
      0    1
0  5946    0
1    42  738
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_26.png
early stop counter: 9
val acc:0.9640341401100159, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 26,now: 2024-06-11 14:26:53.749387,epoch time: 0:24:12.829274,used: 10:08:13.408323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9977319, 'precision': 0.9986467, 'recall': 0.9878523, 'specificity': 0.9878523, 'f1': 0.9931756, 'auroc': 0.99982524, 'binary_precision': 0.99976313, 'binary_recall': 0.97572815, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98759943}
confusion matrix:
       0     1
0  42409     1
1    105  4221
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.8157815, 'recall': 0.51166564, 'specificity': 0.51166564, 'f1': 0.513916, 'auroc': 0.93278635, 'binary_precision': 0.6666667, 'binary_recall': 0.023774145, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.045911044}
confusion matrix:
       0   1
0  18059   8
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.99996614, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_27.png
early stop counter: 10
val acc:0.964514434337616, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 27,now: 2024-06-11 14:50:59.918377,epoch time: 0:24:06.168990,used: 10:32:19.577313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9981599, 'precision': 0.9984585, 'recall': 0.99057907, 'specificity': 0.99057907, 'f1': 0.99447954, 'auroc': 0.99970376, 'binary_precision': 0.9988235, 'binary_recall': 0.98127604, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.98997205}
confusion matrix:
       0     1
0  42405     5
1     81  4245
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.75830555, 'recall': 0.5115273, 'specificity': 0.5115273, 'f1': 0.5136833, 'auroc': 0.9429419, 'binary_precision': 0.55172414, 'binary_recall': 0.023774145, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.045584045}
confusion matrix:
       0   1
0  18054  13
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.9996072, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_28.png
early stop counter: 11
val acc:0.9642475843429565, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 28,now: 2024-06-11 15:15:47.681547,epoch time: 0:24:47.763170,used: 10:57:07.340483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.99849814, 'recall': 0.9932123, 'specificity': 0.9932123, 'f1': 0.99583757, 'auroc': 0.99973464, 'binary_precision': 0.9983622, 'binary_recall': 0.9865896, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.992441}
confusion matrix:
       0     1
0  42404     7
1     58  4267
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.75640327, 'recall': 0.5295197, 'specificity': 0.5295197, 'f1': 0.54574716, 'auroc': 0.93176645, 'binary_precision': 0.5466667, 'binary_recall': 0.060921248, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.10962566}
confusion matrix:
       0   1
0  18033  34
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99758214, 'recall': 0.98645437, 'specificity': 0.98645437, 'f1': 0.9919337, 'auroc': 0.99908566, 'binary_precision': 0.9986842, 'binary_recall': 0.97307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.98571426}
confusion matrix:
      0    1
0  5945    1
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_29.png
early stop counter: 12
val acc:0.9644610285758972, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 29,now: 2024-06-11 15:42:36.494061,epoch time: 0:26:48.812514,used: 11:23:56.152997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9985168, 'recall': 0.99001294, 'specificity': 0.99001294, 'f1': 0.99421906, 'auroc': 0.99938357, 'binary_precision': 0.9990575, 'binary_recall': 0.9801202, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9894982}
confusion matrix:
       0     1
0  42406     4
1     86  4240
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.8165426, 'recall': 0.5335388, 'specificity': 0.5335388, 'f1': 0.55314815, 'auroc': 0.924029, 'binary_precision': 0.6666667, 'binary_recall': 0.068350665, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.12398921}
confusion matrix:
       0   1
0  18044  23
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955397, 'precision': 0.9974899, 'recall': 0.9807692, 'specificity': 0.9807692, 'f1': 0.9889379, 'auroc': 0.9996067, 'binary_precision': 1.0, 'binary_recall': 0.96153843, 'binary_specificity': 1.0, 'binary_f1_score': 0.98039216}
confusion matrix:
      0    1
0  5946    0
1    30  750
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_30.png
early stop counter: 13
val acc:0.9653148055076599, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.994350254535675 / 0.9983645677566528
after epoch: 30,now: 2024-06-11 16:08:30.923110,epoch time: 0:25:54.429049,used: 11:49:50.582046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_04_18_40_seed_1_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:49:50.582046 at 2024-06-11 16:08:30.923110
persisted model performance metric: 

scalar performance:
{'acc': 0.99286354, 'precision': 0.995996, 'recall': 0.9692308, 'specificity': 0.9692308, 'f1': 0.98211694, 'auroc': 0.99945176, 'binary_precision': 1.0, 'binary_recall': 0.93846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.96825397}
confusion matrix:
      0    1
0  5946    0
1    48  732
oracle model performance metric: 

scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.99921244, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456578 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456578 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447776 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |  40701 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28042 MiB |  13564 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     68 MiB |     82 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446590 KiB |   1234 MiB |   1679 TiB |   1679 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |  11473 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6847    |  421945 K  |  421941 K  |
|       from large pool |     187    |    1413    |  219935 K  |  219934 K  |
|       from small pool |    3475    |    6658    |  202009 K  |  202006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6847    |  421945 K  |  421941 K  |
|       from large pool |     187    |    1413    |  219935 K  |  219934 K  |
|       from small pool |    3475    |    6658    |  202009 K  |  202006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1206    |     571    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      34    |      41    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    2988    |  278412 K  |  278412 K  |
|       from large pool |      38    |     605    |  173495 K  |  173495 K  |
|       from small pool |      43    |    2948    |  104916 K  |  104916 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28042 MiB |  27160 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     68 MiB |     82 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1234 MiB |   1679 TiB |   1679 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |      0 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421945 K  |  421945 K  |
|       from large pool |       2    |    1413    |  219935 K  |  219935 K  |
|       from small pool |       0    |    6658    |  202009 K  |  202009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421945 K  |  421945 K  |
|       from large pool |       2    |    1413    |  219935 K  |  219935 K  |
|       from small pool |       0    |    6658    |  202009 K  |  202009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1206    |    1143    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      34    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  278413 K  |  278413 K  |
|       from large pool |       4    |     605    |  173495 K  |  173495 K  |
|       from small pool |       0    |    2948    |  104917 K  |  104917 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2396 TiB |   2396 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2387 TiB |   2387 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2359 TiB |   2359 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28042 MiB |  27160 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     68 MiB |     82 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1234 MiB |   1679 TiB |   1679 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1650 TiB |   1650 TiB |
|       from small pool |      0 KiB |     42 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421945 K  |  421945 K  |
|       from large pool |       2    |    1413    |  219935 K  |  219935 K  |
|       from small pool |       0    |    6658    |  202009 K  |  202009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421945 K  |  421945 K  |
|       from large pool |       2    |    1413    |  219935 K  |  219935 K  |
|       from small pool |       0    |    6658    |  202009 K  |  202009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1206    |    1143    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      34    |      41    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2988    |  278413 K  |  278413 K  |
|       from large pool |       4    |     605    |  173495 K  |  173495 K  |
|       from small pool |       0    |    2948    |  104917 K  |  104917 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197

 Experiment start at: 2024-06-11 16:16:50.310567
before training, model accuracy: 0.7867023348808289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99208075, 'precision': 0.9730494, 'recall': 0.9822383, 'specificity': 0.9822383, 'f1': 0.9775873, 'auroc': 0.99797535, 'binary_precision': 0.9493207, 'binary_recall': 0.97003084, 'binary_specificity': 0.99444574, 'binary_f1_score': 0.95956403}
confusion matrix:
       0     1
0  42075   235
1    136  4402
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7321713, 'recall': 0.72507876, 'specificity': 0.72507876, 'f1': 0.7285639, 'auroc': 0.92979074, 'binary_precision': 0.4819897, 'binary_recall': 0.4667774, 'binary_specificity': 0.98338014, 'binary_f1_score': 0.47426158}
confusion matrix:
       0    1
0  17869  302
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390155, 'precision': 0.99094105, 'recall': 0.97721106, 'specificity': 0.97721106, 'f1': 0.9839484, 'auroc': 0.9982909, 'binary_precision': 0.9871977, 'binary_recall': 0.95592284, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.9713086}
confusion matrix:
      0    1
0  5988    9
1    32  694
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 16:41:53.408924,epoch time: 0:25:03.098357,used: 0:25:03.098357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9942367, 'precision': 0.99672395, 'recall': 0.9703561, 'specificity': 0.9703561, 'f1': 0.98308617, 'auroc': 0.9988307, 'binary_precision': 0.9997659, 'binary_recall': 0.9407358, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.969353}
confusion matrix:
       0     1
0  42308     1
1    269  4270
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.55545694, 'recall': 0.5019964, 'specificity': 0.5019964, 'f1': 0.49646017, 'auroc': 0.91427684, 'binary_precision': 0.14285715, 'binary_recall': 0.004983389, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.009630818}
confusion matrix:
       0   1
0  18153  18
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9931578, 'precision': 0.99619395, 'recall': 0.96831954, 'specificity': 0.96831954, 'f1': 0.9817313, 'auroc': 0.9986205, 'binary_precision': 1.0, 'binary_recall': 0.93663913, 'binary_specificity': 1.0, 'binary_f1_score': 0.9672831}
confusion matrix:
      0    1
0  5997    0
1    46  680
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_2.png
better model found
persisted
after epoch: 2,now: 2024-06-11 17:05:56.034875,epoch time: 0:24:02.625951,used: 0:49:05.724308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99412996, 'precision': 0.9964546, 'recall': 0.9699954, 'specificity': 0.9699954, 'f1': 0.98276764, 'auroc': 0.9990549, 'binary_precision': 0.99929726, 'binary_recall': 0.9400617, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.96877486}
confusion matrix:
       0     1
0  42307     3
1    272  4266
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7579527, 'recall': 0.60574967, 'specificity': 0.60574967, 'f1': 0.6472845, 'auroc': 0.93292594, 'binary_precision': 0.5413223, 'binary_recall': 0.21760798, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.31042653}
confusion matrix:
       0    1
0  18060  111
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9910754, 'precision': 0.9950471, 'recall': 0.95867765, 'specificity': 0.95867765, 'f1': 0.9759595, 'auroc': 0.99844337, 'binary_precision': 1.0, 'binary_recall': 0.91735536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9568966}
confusion matrix:
      0    1
0  5997    0
1    60  666
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_3.png
better model found
persisted
after epoch: 3,now: 2024-06-11 17:29:35.444065,epoch time: 0:23:39.409190,used: 1:12:45.133498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99763066, 'precision': 0.9983885, 'recall': 0.9880676, 'specificity': 0.9880676, 'f1': 0.99315965, 'auroc': 0.998857, 'binary_precision': 0.9993234, 'binary_recall': 0.9762062, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.98762953}
confusion matrix:
       0     1
0  42306     3
1    108  4431
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.75570935, 'recall': 0.5427817, 'specificity': 0.5427817, 'f1': 0.5676537, 'auroc': 0.9244389, 'binary_precision': 0.5408163, 'binary_recall': 0.08803987, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.15142858}
confusion matrix:
       0   1
0  18126  45
1    549  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9995916, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_4.png
new oracle model saved
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9910753965377808 / 0.9964301586151123
after epoch: 4,now: 2024-06-11 17:53:09.622922,epoch time: 0:23:34.178857,used: 1:36:19.312355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9963072, 'precision': 0.99765575, 'recall': 0.98123795, 'specificity': 0.98123795, 'f1': 0.98927265, 'auroc': 0.9991466, 'binary_precision': 0.99931383, 'binary_recall': 0.9625468, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9805858}
confusion matrix:
       0     1
0  42306     3
1    170  4369
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73454106, 'recall': 0.5184701, 'specificity': 0.5184701, 'f1': 0.5273362, 'auroc': 0.94206953, 'binary_precision': 0.5, 'binary_recall': 0.03820598, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.07098766}
confusion matrix:
       0   1
0  18148  23
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9992549, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_5.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9910753965377808 / 0.9964301586151123
after epoch: 5,now: 2024-06-11 18:16:38.057877,epoch time: 0:23:28.434955,used: 1:59:47.747310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9975239, 'precision': 0.99652714, 'recall': 0.98928463, 'specificity': 0.98928463, 'f1': 0.9928722, 'auroc': 0.99952394, 'binary_precision': 0.9952957, 'binary_recall': 0.97906566, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.98711395}
confusion matrix:
       0     1
0  42289    21
1     95  4443
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7664725, 'recall': 0.5671483, 'specificity': 0.5671483, 'f1': 0.602731, 'auroc': 0.9243324, 'binary_precision': 0.5608108, 'binary_recall': 0.13787375, 'binary_specificity': 0.9964229, 'binary_f1_score': 0.22133332}
confusion matrix:
       0   1
0  18106  65
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9992595, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_6.png
early stop counter: 3
val acc:0.9688915014266968, best validation acc: 0.9689980149269104, corresponding to test acc:                         0.9910753965377808 / 0.9964301586151123
after epoch: 6,now: 2024-06-11 18:39:55.813455,epoch time: 0:23:17.755578,used: 2:23:05.502888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9984631, 'precision': 0.99795574, 'recall': 0.9932488, 'specificity': 0.9932488, 'f1': 0.9955882, 'auroc': 0.99969685, 'binary_precision': 0.997328, 'binary_recall': 0.98678124, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9920266}
confusion matrix:
       0     1
0  42297    12
1     60  4479
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.7907915, 'recall': 0.73956835, 'specificity': 0.73956835, 'f1': 0.7624793, 'auroc': 0.9447603, 'binary_precision': 0.5983773, 'binary_recall': 0.4900332, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.5388128}
confusion matrix:
       0    1
0  17973  198
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.99913347, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_7.png
better model found
persisted
after epoch: 7,now: 2024-06-11 19:04:03.943111,epoch time: 0:24:08.129656,used: 2:47:13.632544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99722505, 'precision': 0.9979612, 'recall': 0.98617136, 'specificity': 0.98617136, 'f1': 0.99197686, 'auroc': 0.99969053, 'binary_precision': 0.9988685, 'binary_recall': 0.97246087, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9854878}
confusion matrix:
       0     1
0  42304     5
1    125  4414
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.590804, 'recall': 0.51457506, 'specificity': 0.51457506, 'f1': 0.5198347, 'auroc': 0.918011, 'binary_precision': 0.21276596, 'binary_recall': 0.03322259, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.057471264}
confusion matrix:
       0   1
0  18097  74
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99360406, 'precision': 0.99579215, 'recall': 0.970991, 'specificity': 0.970991, 'f1': 0.9829762, 'auroc': 0.9998466, 'binary_precision': 0.99854016, 'binary_recall': 0.94214875, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9695252}
confusion matrix:
      0    1
0  5996    1
1    42  684
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_8.png
early stop counter: 1
val acc:0.9650561809539795, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9964301586151123
after epoch: 8,now: 2024-06-11 19:27:33.012629,epoch time: 0:23:29.069518,used: 3:10:42.702062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9960084, 'precision': 0.98496044, 'recall': 0.9924798, 'specificity': 0.9924798, 'f1': 0.9886832, 'auroc': 0.9996102, 'binary_precision': 0.97119963, 'binary_recall': 0.9881031, 'binary_specificity': 0.99685645, 'binary_f1_score': 0.97957844}
confusion matrix:
       0     1
0  42176   133
1     54  4485
---- Validation: 
scalar performance:
{'acc': 0.92324084, 'precision': 0.58455694, 'recall': 0.6816911, 'specificity': 0.6816911, 'f1': 0.6104606, 'auroc': 0.85166466, 'binary_precision': 0.1890289, 'binary_recall': 0.42358804, 'binary_specificity': 0.9397942, 'binary_f1_score': 0.2614044}
confusion matrix:
       0     1
0  17077  1094
1    347   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9913729, 'precision': 0.9687306, 'recall': 0.98790026, 'specificity': 0.98790026, 'f1': 0.97805977, 'auroc': 0.9983702, 'binary_precision': 0.9394737, 'binary_recall': 0.9834711, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.96096903}
confusion matrix:
      0    1
0  5951   46
1    12  714
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_9.png
early stop counter: 2
val acc:0.9232408404350281, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9964301586151123
after epoch: 9,now: 2024-06-11 19:51:01.165040,epoch time: 0:23:28.152411,used: 3:34:10.854473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9961151, 'precision': 0.9866719, 'recall': 0.99126047, 'specificity': 0.99126047, 'f1': 0.98895246, 'auroc': 0.99919057, 'binary_precision': 0.97492915, 'binary_recall': 0.985239, 'binary_specificity': 0.9972819, 'binary_f1_score': 0.980057}
confusion matrix:
       0     1
0  42194   115
1     67  4472
---- Validation: 
scalar performance:
{'acc': 0.96463007, 'precision': 0.7106687, 'recall': 0.6862073, 'specificity': 0.6862073, 'f1': 0.69759643, 'auroc': 0.9031958, 'binary_precision': 0.44150943, 'binary_recall': 0.38870433, 'binary_specificity': 0.9837103, 'binary_f1_score': 0.41342756}
confusion matrix:
       0    1
0  17875  296
1    368  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.99805003, 'recall': 0.989586, 'specificity': 0.989586, 'f1': 0.9937705, 'auroc': 0.99972045, 'binary_precision': 0.9985955, 'binary_recall': 0.9793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98887336}
confusion matrix:
      0    1
0  5996    1
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_10.png
new oracle model saved
early stop counter: 3
val acc:0.9646300673484802, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9976201057434082
after epoch: 10,now: 2024-06-11 20:14:31.326463,epoch time: 0:23:30.161423,used: 3:57:41.015896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9984204, 'precision': 0.9961653, 'recall': 0.9947986, 'specificity': 0.9947986, 'f1': 0.9954807, 'auroc': 0.99959177, 'binary_precision': 0.9933702, 'binary_recall': 0.99030626, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.99183583}
confusion matrix:
       0     1
0  42279    30
1     44  4495
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.80960286, 'recall': 0.5848103, 'specificity': 0.5848103, 'f1': 0.6287598, 'auroc': 0.9264925, 'binary_precision': 0.6459627, 'binary_recall': 0.17275748, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.2726081}
confusion matrix:
       0    1
0  18114   57
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.9986384, 'recall': 0.99440694, 'specificity': 0.99440694, 'f1': 0.99651086, 'auroc': 0.9996872, 'binary_precision': 0.9986092, 'binary_recall': 0.9889807, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9937717}
confusion matrix:
      0    1
0  5996    1
1     8  718
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_11.png
new oracle model saved
early stop counter: 4
val acc:0.9704362750053406, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9986613392829895
after epoch: 11,now: 2024-06-11 20:38:06.276891,epoch time: 0:23:34.950428,used: 4:21:15.966324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99848443, 'precision': 0.99777013, 'recall': 0.99355567, 'specificity': 0.99355567, 'f1': 0.9956515, 'auroc': 0.99960613, 'binary_precision': 0.99688613, 'binary_recall': 0.9874422, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.9921417}
confusion matrix:
       0     1
0  42295    14
1     57  4482
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.84340084, 'recall': 0.5393443, 'specificity': 0.5393443, 'f1': 0.5639798, 'auroc': 0.9409618, 'binary_precision': 0.7164179, 'binary_recall': 0.07973422, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.14349777}
confusion matrix:
       0   1
0  18152  19
1    554  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.9992481, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_12.png
early stop counter: 5
val acc:0.9694774150848389, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9986613392829895
after epoch: 12,now: 2024-06-11 21:01:38.991814,epoch time: 0:23:32.714923,used: 4:44:48.681247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9975666, 'precision': 0.994784, 'recall': 0.99127734, 'specificity': 0.99127734, 'f1': 0.99302274, 'auroc': 0.9997941, 'binary_precision': 0.9913391, 'binary_recall': 0.9834765, 'binary_specificity': 0.9990782, 'binary_f1_score': 0.9873921}
confusion matrix:
       0     1
0  42270    39
1     75  4464
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.7329006, 'recall': 0.6595315, 'specificity': 0.6595315, 'f1': 0.6886544, 'auroc': 0.94012594, 'binary_precision': 0.4877451, 'binary_recall': 0.3305648, 'binary_specificity': 0.98849815, 'binary_f1_score': 0.39405942}
confusion matrix:
       0    1
0  17962  209
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956865, 'precision': 0.9932476, 'recall': 0.98426485, 'specificity': 0.98426485, 'f1': 0.98870206, 'auroc': 0.99973774, 'binary_precision': 0.9901547, 'binary_recall': 0.969697, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.979819}
confusion matrix:
      0    1
0  5990    7
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_13.png
early stop counter: 6
val acc:0.9674000144004822, best validation acc: 0.9730996489524841, corresponding to test acc:                         0.9962814450263977 / 0.9986613392829895
after epoch: 13,now: 2024-06-11 21:24:57.175791,epoch time: 0:23:18.183977,used: 5:08:06.865224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99852717, 'precision': 0.9979917, 'recall': 0.9935779, 'specificity': 0.9935779, 'f1': 0.99577236, 'auroc': 0.99987483, 'binary_precision': 0.9973292, 'binary_recall': 0.9874394, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.99235964}
confusion matrix:
       0     1
0  42298    12
1     57  4481
---- Validation: 
scalar performance:
{'acc': 0.9745379, 'precision': 0.821267, 'recall': 0.7073863, 'specificity': 0.7073863, 'f1': 0.7510693, 'auroc': 0.945641, 'binary_precision': 0.6614583, 'binary_recall': 0.42192692, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.51521295}
confusion matrix:
       0    1
0  18041  130
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9999645, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_14.png
better model found
persisted
after epoch: 14,now: 2024-06-11 21:48:18.575384,epoch time: 0:23:21.399593,used: 5:31:28.264817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9985485, 'precision': 0.998103, 'recall': 0.99359107, 'specificity': 0.99359107, 'f1': 0.995834, 'auroc': 0.9998746, 'binary_precision': 0.99755174, 'binary_recall': 0.9874422, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9924712}
confusion matrix:
       0     1
0  42298    11
1     57  4482
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.80492914, 'recall': 0.60917693, 'specificity': 0.60917693, 'f1': 0.65740323, 'auroc': 0.94841677, 'binary_precision': 0.6350711, 'binary_recall': 0.22259136, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.3296433}
confusion matrix:
       0    1
0  18094   77
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.9998262, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_15.png
early stop counter: 1
val acc:0.9709689617156982, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 15,now: 2024-06-11 22:11:40.699591,epoch time: 0:23:22.124207,used: 5:54:50.389024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9976947, 'precision': 0.99398845, 'recall': 0.99282193, 'specificity': 0.99282193, 'f1': 0.9934043, 'auroc': 0.9997301, 'binary_precision': 0.9893946, 'binary_recall': 0.9867783, 'binary_specificity': 0.99886554, 'binary_f1_score': 0.98808473}
confusion matrix:
       0     1
0  42262    48
1     60  4478
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7522978, 'recall': 0.7881792, 'specificity': 0.7881792, 'f1': 0.7689175, 'auroc': 0.9512197, 'binary_precision': 0.5180897, 'binary_recall': 0.59468436, 'binary_specificity': 0.9816741, 'binary_f1_score': 0.5537509}
confusion matrix:
       0    1
0  17838  333
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9987236, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_16.png
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 16,now: 2024-06-11 22:34:52.515147,epoch time: 0:23:11.815556,used: 6:18:02.204580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9983137, 'precision': 0.99816906, 'recall': 0.9921827, 'specificity': 0.9921827, 'f1': 0.99515295, 'auroc': 0.999426, 'binary_precision': 0.9979902, 'binary_recall': 0.9845781, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9912388}
confusion matrix:
       0     1
0  42300     9
1     70  4469
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.8715263, 'recall': 0.61429286, 'specificity': 0.61429286, 'f1': 0.67065406, 'auroc': 0.94759274, 'binary_precision': 0.7679558, 'binary_recall': 0.23089701, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.3550447}
confusion matrix:
       0    1
0  18129   42
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9997327, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_17.png
early stop counter: 3
val acc:0.9730996489524841, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 17,now: 2024-06-11 22:58:10.835147,epoch time: 0:23:18.320000,used: 6:41:20.524580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99767333, 'precision': 0.9986141, 'recall': 0.98809123, 'specificity': 0.98809123, 'f1': 0.9932816, 'auroc': 0.9997252, 'binary_precision': 0.9997744, 'binary_recall': 0.9762062, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9878498}
confusion matrix:
       0     1
0  42308     1
1    108  4431
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.94514513, 'recall': 0.591087, 'specificity': 0.591087, 'f1': 0.6455384, 'auroc': 0.9561924, 'binary_precision': 0.9166667, 'binary_recall': 0.18272425, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.30470914}
confusion matrix:
       0    1
0  18161   10
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.997759, 'recall': 0.98140496, 'specificity': 0.98140496, 'f1': 0.98940325, 'auroc': 0.99984264, 'binary_precision': 1.0, 'binary_recall': 0.9628099, 'binary_specificity': 1.0, 'binary_f1_score': 0.98105264}
confusion matrix:
      0    1
0  5997    0
1    27  699
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_18.png
early stop counter: 4
val acc:0.973259449005127, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 18,now: 2024-06-11 23:21:26.950667,epoch time: 0:23:16.115520,used: 7:04:36.640100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99773735, 'precision': 0.9985485, 'recall': 0.9885176, 'specificity': 0.9885176, 'f1': 0.99346846, 'auroc': 0.999864, 'binary_precision': 0.99954915, 'binary_recall': 0.97708243, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9881881}
confusion matrix:
       0     1
0  42308     2
1    104  4434
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.82257426, 'recall': 0.5490359, 'specificity': 0.5490359, 'f1': 0.5790841, 'auroc': 0.9473521, 'binary_precision': 0.6741573, 'binary_recall': 0.09966777, 'binary_specificity': 0.998404, 'binary_f1_score': 0.17366135}
confusion matrix:
       0   1
0  18142  29
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99726367, 'recall': 0.97727275, 'specificity': 0.97727275, 'f1': 0.98700017, 'auroc': 0.9998349, 'binary_precision': 1.0, 'binary_recall': 0.95454544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9767442}
confusion matrix:
      0    1
0  5997    0
1    33  693
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_19.png
early stop counter: 5
val acc:0.9695839881896973, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 19,now: 2024-06-11 23:44:45.838584,epoch time: 0:23:18.887917,used: 7:27:55.528017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9986766, 'precision': 0.9981754, 'recall': 0.994252, 'specificity': 0.994252, 'f1': 0.9962039, 'auroc': 0.9998124, 'binary_precision': 0.997555, 'binary_recall': 0.98876405, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9931401}
confusion matrix:
       0     1
0  42298    11
1     51  4488
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.80618304, 'recall': 0.6075708, 'specificity': 0.6075708, 'f1': 0.6557468, 'auroc': 0.9394238, 'binary_precision': 0.6376812, 'binary_recall': 0.2192691, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.3263288}
confusion matrix:
       0    1
0  18096   75
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.99999034, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_20.png
early stop counter: 6
val acc:0.9709689617156982, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 20,now: 2024-06-12 00:08:02.434363,epoch time: 0:23:16.595779,used: 7:51:12.123796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99778, 'precision': 0.99877393, 'recall': 0.98854375, 'specificity': 0.98854375, 'f1': 0.9935917, 'auroc': 0.99985325, 'binary_precision': 1.0, 'binary_recall': 0.97708744, 'binary_specificity': 1.0, 'binary_f1_score': 0.98841095}
confusion matrix:
       0     1
0  42309     0
1    104  4435
---- Validation: 
scalar performance:
{'acc': 0.9715549, 'precision': 0.82408464, 'recall': 0.6078735, 'specificity': 0.6078735, 'f1': 0.6581478, 'auroc': 0.9312586, 'binary_precision': 0.67346936, 'binary_recall': 0.2192691, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.33082706}
confusion matrix:
       0    1
0  18107   64
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9995323, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_21.png
early stop counter: 7
val acc:0.9715548753738403, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 21,now: 2024-06-12 00:31:22.512335,epoch time: 0:23:20.077972,used: 8:14:32.201768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9963499, 'precision': 0.98747206, 'recall': 0.9917823, 'specificity': 0.9917823, 'f1': 0.9896151, 'auroc': 0.9994881, 'binary_precision': 0.97643465, 'binary_recall': 0.98611724, 'binary_specificity': 0.99744743, 'binary_f1_score': 0.98125213}
confusion matrix:
       0     1
0  42202   108
1     63  4475
---- Validation: 
scalar performance:
{'acc': 0.97144836, 'precision': 0.7869427, 'recall': 0.6672441, 'specificity': 0.6672441, 'f1': 0.7099768, 'auroc': 0.9465705, 'binary_precision': 0.5953757, 'binary_recall': 0.34219268, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.43459913}
confusion matrix:
       0    1
0  18031  140
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9999063, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_22.png
early stop counter: 8
val acc:0.9714483618736267, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9971739053726196 / 0.9986613392829895
after epoch: 22,now: 2024-06-12 00:54:40.584991,epoch time: 0:23:18.072656,used: 8:37:50.274424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9987833, 'precision': 0.9978417, 'recall': 0.99519616, 'specificity': 0.99519616, 'f1': 0.99651444, 'auroc': 0.99987054, 'binary_precision': 0.99667555, 'binary_recall': 0.99074686, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.99370235}
confusion matrix:
       0     1
0  42294    15
1     42  4497
---- Validation: 
scalar performance:
{'acc': 0.9749108, 'precision': 0.80898833, 'recall': 0.75254965, 'specificity': 0.75254965, 'f1': 0.77768296, 'auroc': 0.95408875, 'binary_precision': 0.63394684, 'binary_recall': 0.51495016, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.568286}
confusion matrix:
       0    1
0  17992  179
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9998113, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_23.png
better model found
persisted
after epoch: 23,now: 2024-06-12 01:18:00.390967,epoch time: 0:23:19.805976,used: 9:01:10.080400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9989114, 'precision': 0.9988019, 'recall': 0.994971, 'specificity': 0.994971, 'f1': 0.9968771, 'auroc': 0.9999497, 'binary_precision': 0.99866635, 'binary_recall': 0.99008375, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9943565}
confusion matrix:
       0     1
0  42304     6
1     45  4493
---- Validation: 
scalar performance:
{'acc': 0.9759229, 'precision': 0.8294709, 'recall': 0.7354054, 'specificity': 0.7354054, 'f1': 0.7739669, 'auroc': 0.9573396, 'binary_precision': 0.6760563, 'binary_recall': 0.47840533, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.5603113}
confusion matrix:
       0    1
0  18033  138
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.9999853, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_24.png
better model found
persisted
after epoch: 24,now: 2024-06-12 01:41:16.780510,epoch time: 0:23:16.389543,used: 9:24:26.469943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9988687, 'precision': 0.9987781, 'recall': 0.99475175, 'specificity': 0.99475175, 'f1': 0.99675465, 'auroc': 0.999823, 'binary_precision': 0.99866605, 'binary_recall': 0.9896453, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99413526}
confusion matrix:
       0     1
0  42303     6
1     47  4492
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7757903, 'recall': 0.5526934, 'specificity': 0.5526934, 'f1': 0.58310854, 'auroc': 0.9335398, 'binary_precision': 0.58035713, 'binary_recall': 0.10797342, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.18207283}
confusion matrix:
       0   1
0  18124  47
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.9990839, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_25.png
early stop counter: 1
val acc:0.9688915014266968, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 25,now: 2024-06-12 02:04:33.698055,epoch time: 0:23:16.917545,used: 9:47:43.387488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9965634, 'precision': 0.9881715, 'recall': 0.9922954, 'specificity': 0.9922954, 'f1': 0.9902224, 'auroc': 0.99938196, 'binary_precision': 0.977739, 'binary_recall': 0.98700154, 'binary_specificity': 0.9975892, 'binary_f1_score': 0.98234844}
confusion matrix:
       0     1
0  42207   102
1     59  4480
---- Validation: 
scalar performance:
{'acc': 0.97256696, 'precision': 0.78399, 'recall': 0.74411154, 'specificity': 0.74411154, 'f1': 0.76240325, 'auroc': 0.9581788, 'binary_precision': 0.58446604, 'binary_recall': 0.5, 'binary_specificity': 0.988223, 'binary_f1_score': 0.53894365}
confusion matrix:
       0    1
0  17957  214
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956865, 'precision': 0.9944693, 'recall': 0.98305416, 'specificity': 0.98305416, 'f1': 0.9886743, 'auroc': 0.99942553, 'binary_precision': 0.99292785, 'binary_recall': 0.96694213, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.9797627}
confusion matrix:
      0    1
0  5992    5
1    24  702
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_26.png
early stop counter: 2
val acc:0.9725669622421265, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 26,now: 2024-06-12 02:27:49.198106,epoch time: 0:23:15.500051,used: 10:10:58.887539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99889004, 'precision': 0.99780405, 'recall': 0.9958444, 'specificity': 0.9958444, 'f1': 0.99682176, 'auroc': 0.9998925, 'binary_precision': 0.9964586, 'binary_recall': 0.992067, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.99425787}
confusion matrix:
       0     1
0  42294    16
1     36  4502
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.72422934, 'recall': 0.654328, 'specificity': 0.654328, 'f1': 0.68214417, 'auroc': 0.92227775, 'binary_precision': 0.4707317, 'binary_recall': 0.320598, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.38142294}
confusion matrix:
       0    1
0  17954  217
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9995799, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_27.png
early stop counter: 3
val acc:0.9666542410850525, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 27,now: 2024-06-12 02:51:05.663498,epoch time: 0:23:16.465392,used: 10:34:15.352931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987193, 'precision': 0.9992919, 'recall': 0.9933906, 'specificity': 0.9933906, 'f1': 0.99631906, 'auroc': 0.9999039, 'binary_precision': 1.0, 'binary_recall': 0.98678124, 'binary_specificity': 1.0, 'binary_f1_score': 0.99334663}
confusion matrix:
       0     1
0  42309     0
1     60  4479
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.58754987, 'recall': 0.5043505, 'specificity': 0.5043505, 'f1': 0.50112456, 'auroc': 0.93762386, 'binary_precision': 0.20689656, 'binary_recall': 0.009966778, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.019017434}
confusion matrix:
       0   1
0  18148  23
1    596   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.999912, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_28.png
early stop counter: 4
val acc:0.9670271277427673, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 28,now: 2024-06-12 03:14:17.347716,epoch time: 0:23:11.684218,used: 10:57:27.037149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99833506, 'precision': 0.99907994, 'recall': 0.9914059, 'specificity': 0.9914059, 'f1': 0.9952053, 'auroc': 0.9999242, 'binary_precision': 1.0, 'binary_recall': 0.9828118, 'binary_specificity': 1.0, 'binary_f1_score': 0.9913314}
confusion matrix:
       0     1
0  42310     0
1     78  4460
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7841934, 'recall': 0.50731, 'specificity': 0.50731, 'f1': 0.5064765, 'auroc': 0.9573165, 'binary_precision': 0.6, 'binary_recall': 0.014950166, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.02917342}
confusion matrix:
       0  1
0  18165  6
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9998065, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_29.png
early stop counter: 5
val acc:0.9680925011634827, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 29,now: 2024-06-12 03:37:26.826300,epoch time: 0:23:09.478584,used: 11:20:36.515733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9986766, 'precision': 0.9968016, 'recall': 0.9956287, 'specificity': 0.9956287, 'f1': 0.99621433, 'auroc': 0.999805, 'binary_precision': 0.99447757, 'binary_recall': 0.9918484, 'binary_specificity': 0.9994091, 'binary_f1_score': 0.99316126}
confusion matrix:
       0     1
0  42284    25
1     37  4502
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.78251064, 'recall': 0.7189418, 'specificity': 0.7189418, 'f1': 0.7463256, 'auroc': 0.950781, 'binary_precision': 0.58315337, 'binary_recall': 0.44850498, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.5070422}
confusion matrix:
       0    1
0  17978  193
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99817246, 'recall': 0.9848485, 'specificity': 0.9848485, 'f1': 0.99139225, 'auroc': 0.99979514, 'binary_precision': 1.0, 'binary_recall': 0.969697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9846154}
confusion matrix:
      0    1
0  5997    0
1    22  704
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277197_30.png
early stop counter: 6
val acc:0.9720342755317688, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9985125660896301 / 0.9986613392829895
after epoch: 30,now: 2024-06-12 04:00:42.839839,epoch time: 0:23:16.013539,used: 11:43:52.529272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_16_16_50_seed_2_21277197
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:43:52.529272 at 2024-06-12 04:00:42.839839
persisted model performance metric: 

scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.9999821, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
oracle model performance metric: 

scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.9999042, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456578 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456578 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3579 TiB |   3579 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3536 TiB |   3536 TiB |
|       from small pool |  40700 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41638 MiB |  27160 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     68 MiB |     96 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446590 KiB |   1234 MiB |   2510 TiB |   2510 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2468 TiB |   2468 TiB |
|       from small pool |  11473 KiB |     42 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  632643 K  |  632639 K  |
|       from large pool |     187    |    1413    |  329702 K  |  329702 K  |
|       from small pool |    3475    |    6672    |  302940 K  |  302936 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  632643 K  |  632639 K  |
|       from large pool |     187    |    1413    |  329702 K  |  329702 K  |
|       from small pool |    3475    |    6672    |  302940 K  |  302936 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1778    |    1143    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      34    |      48    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2993    |  414549 K  |  414549 K  |
|       from large pool |      38    |     605    |  257044 K  |  257044 K  |
|       from small pool |      42    |    2955    |  157504 K  |  157504 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3588 TiB |   3588 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3546 TiB |   3546 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3579 TiB |   3579 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3536 TiB |   3536 TiB |
|       from small pool |      0 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41638 MiB |  40756 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     68 MiB |     96 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1234 MiB |   2510 TiB |   2510 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2468 TiB |   2468 TiB |
|       from small pool |      0 KiB |     42 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  632643 K  |  632643 K  |
|       from large pool |       2    |    1413    |  329702 K  |  329702 K  |
|       from small pool |       0    |    6672    |  302940 K  |  302940 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  632643 K  |  632643 K  |
|       from large pool |       2    |    1413    |  329702 K  |  329702 K  |
|       from small pool |       0    |    6672    |  302940 K  |  302940 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1778    |    1715    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      34    |      48    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2993    |  414550 K  |  414550 K  |
|       from large pool |       4    |     605    |  257044 K  |  257044 K  |
|       from small pool |       0    |    2955    |  157506 K  |  157506 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 12 04:02:26 2024]
Finished job 0.
1 of 1 steps (100%) done
