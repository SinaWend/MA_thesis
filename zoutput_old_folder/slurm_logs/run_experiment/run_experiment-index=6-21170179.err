Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179

 Experiment start at: 2024-06-07 01:25:50.793691
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.7501619, 'recall': 0.80437875, 'specificity': 0.80437875, 'f1': 0.7743089, 'auroc': 0.94800967, 'binary_precision': 0.51330376, 'binary_recall': 0.6295037, 'binary_specificity': 0.97925377, 'binary_f1_score': 0.56549615}
confusion matrix:
       0    1
0  41443  878
1    545  926
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96450615, 'precision': 0.7344799, 'recall': 0.77535915, 'specificity': 0.77535915, 'f1': 0.7530775, 'auroc': 0.94580126, 'binary_precision': 0.48421052, 'binary_recall': 0.57231724, 'binary_specificity': 0.978401, 'binary_f1_score': 0.52459013}
confusion matrix:
       0    1
0  17757  392
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.89170945, 'recall': 0.7634488, 'specificity': 0.7634488, 'f1': 0.8138206, 'auroc': 0.93687695, 'binary_precision': 0.8034682, 'binary_recall': 0.532567, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.64055294}
confusion matrix:
      0    1
0  5963   34
1   122  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:57:43.288148,epoch time: 0:31:52.494457,used: 0:31:52.494457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9751553, 'precision': 0.82338643, 'recall': 0.76059484, 'specificity': 0.76059484, 'f1': 0.78831196, 'auroc': 0.96568, 'binary_precision': 0.6629881, 'binary_recall': 0.5305706, 'binary_specificity': 0.99061906, 'binary_f1_score': 0.58943397}
confusion matrix:
       0    1
0  41923  397
1    691  781
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.82453465, 'recall': 0.723066, 'specificity': 0.723066, 'f1': 0.7635766, 'auroc': 0.9612386, 'binary_precision': 0.6681922, 'binary_recall': 0.4541213, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.5407407}
confusion matrix:
       0    1
0  18004  145
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8232146, 'recall': 0.5488079, 'specificity': 0.5488079, 'f1': 0.5768476, 'auroc': 0.94267774, 'binary_precision': 0.68421054, 'binary_recall': 0.099616855, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17391303}
confusion matrix:
      0   1
0  5985  12
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 02:28:27.631229,epoch time: 0:30:44.343081,used: 1:02:36.837538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9765711, 'precision': 0.8210416, 'recall': 0.81386805, 'specificity': 0.81386805, 'f1': 0.81741047, 'auroc': 0.96845996, 'binary_precision': 0.6545961, 'binary_recall': 0.6394558, 'binary_specificity': 0.98828036, 'binary_f1_score': 0.6469374}
confusion matrix:
       0    1
0  41826  496
1    530  940
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.83766276, 'recall': 0.7563927, 'specificity': 0.7563927, 'f1': 0.79098165, 'auroc': 0.9661509, 'binary_precision': 0.69214875, 'binary_recall': 0.5209953, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.59449863}
confusion matrix:
       0    1
0  18000  149
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8573806, 'recall': 0.61702305, 'specificity': 0.61702305, 'f1': 0.6711954, 'auroc': 0.9533338, 'binary_precision': 0.74698794, 'binary_recall': 0.23754789, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3604651}
confusion matrix:
      0   1
0  5976  21
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 02:59:16.929205,epoch time: 0:30:49.297976,used: 1:33:26.135514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98097825, 'precision': 0.90290034, 'recall': 0.77541053, 'specificity': 0.77541053, 'f1': 0.8262782, 'auroc': 0.97780216, 'binary_precision': 0.82110554, 'binary_recall': 0.5550272, 'binary_specificity': 0.99579394, 'binary_f1_score': 0.6623429}
confusion matrix:
       0    1
0  42142  178
1    655  817
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.91855085, 'recall': 0.71721214, 'specificity': 0.71721214, 'f1': 0.7838069, 'auroc': 0.9740261, 'binary_precision': 0.85670733, 'binary_recall': 0.43701398, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.57878476}
confusion matrix:
       0    1
0  18102   47
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7989047, 'recall': 0.5392294, 'specificity': 0.5392294, 'f1': 0.5611193, 'auroc': 0.93731225, 'binary_precision': 0.6363636, 'binary_recall': 0.08045977, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14285715}
confusion matrix:
      0   1
0  5985  12
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 03:30:02.550000,epoch time: 0:30:45.620795,used: 2:04:11.756309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9819145, 'precision': 0.87781525, 'recall': 0.8280246, 'specificity': 0.8280246, 'f1': 0.85101753, 'auroc': 0.98027134, 'binary_precision': 0.7672956, 'binary_recall': 0.6630435, 'binary_specificity': 0.9930057, 'binary_f1_score': 0.7113703}
confusion matrix:
       0    1
0  42024  296
1    496  976
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.8883853, 'recall': 0.79965067, 'specificity': 0.79965067, 'f1': 0.83783406, 'auroc': 0.97496253, 'binary_precision': 0.7906504, 'binary_recall': 0.60497665, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.6854626}
confusion matrix:
       0    1
0  18046  103
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91663754, 'recall': 0.58753896, 'specificity': 0.58753896, 'f1': 0.6374, 'auroc': 0.94530284, 'binary_precision': 0.8679245, 'binary_recall': 0.17624521, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.29299366}
confusion matrix:
      0   1
0  5990   7
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 04:00:49.400509,epoch time: 0:30:46.850509,used: 2:34:58.606818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9828051, 'precision': 0.8797852, 'recall': 0.84455043, 'specificity': 0.84455043, 'f1': 0.8612387, 'auroc': 0.98356366, 'binary_precision': 0.7700977, 'binary_recall': 0.6963315, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.7313592}
confusion matrix:
       0     1
0  42014   306
1    447  1025
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.8995242, 'recall': 0.7984812, 'specificity': 0.7984812, 'f1': 0.8411139, 'auroc': 0.97644806, 'binary_precision': 0.81302524, 'binary_recall': 0.60186625, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.691689}
confusion matrix:
       0    1
0  18060   89
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.84470093, 'recall': 0.569714, 'specificity': 0.569714, 'f1': 0.60883886, 'auroc': 0.94529986, 'binary_precision': 0.7254902, 'binary_recall': 0.14176245, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23717949}
confusion matrix:
      0   1
0  5983  14
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 04:31:26.518679,epoch time: 0:30:37.118170,used: 3:05:35.724988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.90250635, 'recall': 0.83398217, 'specificity': 0.83398217, 'f1': 0.8648039, 'auroc': 0.9847357, 'binary_precision': 0.8163097, 'binary_recall': 0.6732337, 'binary_specificity': 0.99473065, 'binary_f1_score': 0.73790014}
confusion matrix:
       0    1
0  42097  223
1    481  991
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.9304544, 'recall': 0.7932246, 'specificity': 0.7932246, 'f1': 0.8478753, 'auroc': 0.9773272, 'binary_precision': 0.87528867, 'binary_recall': 0.58942455, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.704461}
confusion matrix:
       0    1
0  18095   54
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.85499394, 'recall': 0.57737684, 'specificity': 0.57737684, 'f1': 0.62015665, 'auroc': 0.9375272, 'binary_precision': 0.74545455, 'binary_recall': 0.15708812, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.25949365}
confusion matrix:
      0   1
0  5983  14
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 05:02:34.712065,epoch time: 0:31:08.193386,used: 3:36:43.918374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98394686, 'precision': 0.90801835, 'recall': 0.8274368, 'specificity': 0.8274368, 'f1': 0.8629695, 'auroc': 0.9867369, 'binary_precision': 0.827792, 'binary_recall': 0.65964675, 'binary_specificity': 0.99522686, 'binary_f1_score': 0.73421556}
confusion matrix:
       0    1
0  42118  202
1    501  971
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.9125998, 'recall': 0.7842301, 'specificity': 0.7842301, 'f1': 0.8356999, 'auroc': 0.97756827, 'binary_precision': 0.84018266, 'binary_recall': 0.57231724, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.68085104}
confusion matrix:
       0    1
0  18079   70
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83818096, 'recall': 0.54705894, 'specificity': 0.54705894, 'f1': 0.574394, 'auroc': 0.94502485, 'binary_precision': 0.71428573, 'binary_recall': 0.09578544, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5987  10
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_8.png
early stop counter: 1
val acc:0.9816411137580872, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9626078605651855 / 0.975071907043457
after epoch: 8,now: 2024-06-07 05:33:35.503949,epoch time: 0:31:00.791884,used: 4:07:44.710258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9855453, 'precision': 0.94526684, 'recall': 0.8181002, 'specificity': 0.8181002, 'f1': 0.8703345, 'auroc': 0.9879763, 'binary_precision': 0.9029779, 'binary_recall': 0.63858694, 'binary_specificity': 0.99761343, 'binary_f1_score': 0.7481098}
confusion matrix:
       0    1
0  42219  101
1    532  940
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.94248694, 'recall': 0.75639546, 'specificity': 0.75639546, 'f1': 0.8229653, 'auroc': 0.97917473, 'binary_precision': 0.9019074, 'binary_recall': 0.5147745, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.6554456}
confusion matrix:
       0    1
0  18113   36
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.9375539, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_9.png
early stop counter: 2
val acc:0.9814814925193787, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9626078605651855 / 0.975071907043457
after epoch: 9,now: 2024-06-07 06:04:24.747488,epoch time: 0:30:49.243539,used: 4:38:33.953797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.9177136, 'recall': 0.85597944, 'specificity': 0.85597944, 'f1': 0.8841912, 'auroc': 0.98982215, 'binary_precision': 0.84522855, 'binary_recall': 0.71651936, 'binary_specificity': 0.9954396, 'binary_f1_score': 0.7755702}
confusion matrix:
       0     1
0  42128   193
1    417  1054
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9318196, 'recall': 0.8133597, 'specificity': 0.8133597, 'f1': 0.8624724, 'auroc': 0.98118603, 'binary_precision': 0.8766234, 'binary_recall': 0.62986004, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7330317}
confusion matrix:
       0    1
0  18092   57
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8750639, 'recall': 0.5492248, 'specificity': 0.5492248, 'f1': 0.5785352, 'auroc': 0.9420465, 'binary_precision': 0.7878788, 'binary_recall': 0.099616855, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17687075}
confusion matrix:
      0   1
0  5990   7
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 06:35:10.382359,epoch time: 0:30:45.634871,used: 5:09:19.588668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98874223, 'precision': 0.94114685, 'recall': 0.8774575, 'specificity': 0.8774575, 'f1': 0.9066365, 'auroc': 0.9917214, 'binary_precision': 0.89066243, 'binary_recall': 0.7581522, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.81908256}
confusion matrix:
       0     1
0  42183   137
1    356  1116
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.92808974, 'recall': 0.8047509, 'specificity': 0.8047509, 'f1': 0.8552685, 'auroc': 0.980438, 'binary_precision': 0.8697572, 'binary_recall': 0.61275274, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.71897817}
confusion matrix:
       0    1
0  18090   59
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.92297125, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_11.png
early stop counter: 1
val acc:0.9836100339889526, best validation acc: 0.9843018054962158, corresponding to test acc:                         0.9613295197486877 / 0.975071907043457
after epoch: 11,now: 2024-06-07 07:05:57.331725,epoch time: 0:30:46.949366,used: 5:40:06.538034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9877375, 'precision': 0.8949002, 'recall': 0.9241005, 'specificity': 0.9241005, 'f1': 0.90893483, 'auroc': 0.99188447, 'binary_precision': 0.7948232, 'binary_recall': 0.8558804, 'binary_specificity': 0.9923206, 'binary_f1_score': 0.82422256}
confusion matrix:
       0     1
0  41996   325
1    212  1259
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9084648, 'recall': 0.8943533, 'specificity': 0.8943533, 'f1': 0.9012746, 'auroc': 0.98227614, 'binary_precision': 0.82419354, 'binary_recall': 0.7947123, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.80918455}
confusion matrix:
       0    1
0  18040  109
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.85619575, 'recall': 0.5509738, 'specificity': 0.5509738, 'f1': 0.5809656, 'auroc': 0.9394587, 'binary_precision': 0.75, 'binary_recall': 0.10344828, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5988   9
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 07:36:26.258708,epoch time: 0:30:28.926983,used: 6:10:35.465017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98335314, 'precision': 0.9341166, 'recall': 0.7897537, 'specificity': 0.7897537, 'f1': 0.8465171, 'auroc': 0.9893207, 'binary_precision': 0.88259524, 'binary_recall': 0.58220106, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.7015964}
confusion matrix:
       0    1
0  42206  114
1    615  857
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9366394, 'recall': 0.78333616, 'specificity': 0.78333616, 'f1': 0.8424983, 'auroc': 0.9776378, 'binary_precision': 0.88834953, 'binary_recall': 0.56920683, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.6938389}
confusion matrix:
       0    1
0  18103   46
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.9128282, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_13.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 13,now: 2024-06-07 08:06:56.247222,epoch time: 0:30:29.988514,used: 6:41:05.453531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98926747, 'precision': 0.9312341, 'recall': 0.89831674, 'specificity': 0.89831674, 'f1': 0.91407096, 'auroc': 0.993948, 'binary_precision': 0.86937267, 'binary_recall': 0.80081576, 'binary_specificity': 0.99581766, 'binary_f1_score': 0.8336872}
confusion matrix:
       0     1
0  42144   177
1    293  1178
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.929044, 'recall': 0.8604079, 'specificity': 0.8604079, 'f1': 0.891509, 'auroc': 0.98235726, 'binary_precision': 0.86778396, 'binary_recall': 0.7247278, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.78983045}
confusion matrix:
       0    1
0  18078   71
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8444077, 'recall': 0.57912576, 'specificity': 0.57912576, 'f1': 0.6220279, 'auroc': 0.9144938, 'binary_precision': 0.7241379, 'binary_recall': 0.16091955, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2633229}
confusion matrix:
      0   1
0  5981  16
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_14.png
early stop counter: 2
val acc:0.986802875995636, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 14,now: 2024-06-07 08:37:51.514174,epoch time: 0:30:55.266952,used: 7:12:00.720483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.958688, 'recall': 0.857715, 'specificity': 0.857715, 'f1': 0.90150654, 'auroc': 0.9937248, 'binary_precision': 0.9271291, 'binary_recall': 0.7173913, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.8088855}
confusion matrix:
       0     1
0  42237    83
1    416  1056
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.95079803, 'recall': 0.80846745, 'specificity': 0.80846745, 'f1': 0.8653399, 'auroc': 0.98140395, 'binary_precision': 0.9149425, 'binary_recall': 0.61897355, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.73840445}
confusion matrix:
       0    1
0  18112   37
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.92152035, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5993   4
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_15.png
early stop counter: 3
val acc:0.9849936366081238, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 15,now: 2024-06-07 09:08:45.580452,epoch time: 0:30:54.066278,used: 7:42:54.786761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9879658, 'precision': 0.90034974, 'recall': 0.91896915, 'specificity': 0.91896915, 'f1': 0.9094299, 'auroc': 0.9937874, 'binary_precision': 0.80609596, 'binary_recall': 0.8450034, 'binary_specificity': 0.99293494, 'binary_f1_score': 0.82509124}
confusion matrix:
       0     1
0  42022   299
1    228  1243
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9055126, 'recall': 0.89577067, 'specificity': 0.89577067, 'f1': 0.9005774, 'auroc': 0.98090494, 'binary_precision': 0.8181818, 'binary_recall': 0.7978227, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.807874}
confusion matrix:
       0    1
0  18035  114
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.90774095, 'recall': 0.57604474, 'specificity': 0.57604474, 'f1': 0.62053204, 'auroc': 0.9448825, 'binary_precision': 0.85106385, 'binary_recall': 0.1532567, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.25974026}
confusion matrix:
      0   1
0  5990   7
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_16.png
early stop counter: 4
val acc:0.9870157241821289, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 16,now: 2024-06-07 09:39:55.640995,epoch time: 0:31:10.060543,used: 8:14:04.847304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9902265, 'precision': 0.93242145, 'recall': 0.9142332, 'specificity': 0.9142332, 'f1': 0.92311645, 'auroc': 0.9952362, 'binary_precision': 0.8706468, 'binary_recall': 0.83276683, 'binary_specificity': 0.9956995, 'binary_f1_score': 0.8512856}
confusion matrix:
       0     1
0  42139   182
1    246  1225
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.91223586, 'recall': 0.8837147, 'specificity': 0.8837147, 'f1': 0.8974221, 'auroc': 0.98160136, 'binary_precision': 0.8324958, 'binary_recall': 0.7729393, 'binary_specificity': 0.99449, 'binary_f1_score': 0.80161285}
confusion matrix:
       0    1
0  18049  100
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88809395, 'recall': 0.5815417, 'specificity': 0.5815417, 'f1': 0.62759995, 'auroc': 0.9276471, 'binary_precision': 0.8113208, 'binary_recall': 0.16475096, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.27388537}
confusion matrix:
      0   1
0  5987  10
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_17.png
early stop counter: 5
val acc:0.9869093298912048, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 17,now: 2024-06-07 10:10:40.456896,epoch time: 0:30:44.815901,used: 8:44:49.663205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98997533, 'precision': 0.96293503, 'recall': 0.8763728, 'specificity': 0.8763728, 'f1': 0.91486555, 'auroc': 0.99490094, 'binary_precision': 0.93434346, 'binary_recall': 0.7545887, 'binary_specificity': 0.99815696, 'binary_f1_score': 0.8349004}
confusion matrix:
       0     1
0  42243    78
1    361  1110
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9575608, 'recall': 0.818714, 'specificity': 0.818714, 'f1': 0.8748364, 'auroc': 0.9818305, 'binary_precision': 0.92776525, 'binary_recall': 0.63919127, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.75690603}
confusion matrix:
       0    1
0  18117   32
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8690053, 'recall': 0.5586366, 'specificity': 0.5586366, 'f1': 0.593207, 'auroc': 0.9195516, 'binary_precision': 0.775, 'binary_recall': 0.118773945, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.20598008}
confusion matrix:
      0   1
0  5988   9
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_18.png
early stop counter: 6
val acc:0.9859514832496643, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 18,now: 2024-06-07 10:41:13.419058,epoch time: 0:30:32.962162,used: 9:15:22.625367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9883997, 'precision': 0.8990834, 'recall': 0.93039346, 'specificity': 0.93039346, 'f1': 0.9140966, 'auroc': 0.99463445, 'binary_precision': 0.8027638, 'binary_recall': 0.8682065, 'binary_specificity': 0.99258035, 'binary_f1_score': 0.8342036}
confusion matrix:
       0     1
0  42006   314
1    194  1278
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.89452994, 'recall': 0.9022181, 'specificity': 0.9022181, 'f1': 0.89833367, 'auroc': 0.98226637, 'binary_precision': 0.7957317, 'binary_recall': 0.8118196, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.80369514}
confusion matrix:
       0    1
0  18015  134
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9004854, 'recall': 0.54939157, 'specificity': 0.54939157, 'f1': 0.57922435, 'auroc': 0.9252971, 'binary_precision': 0.83870965, 'binary_recall': 0.099616855, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1780822}
confusion matrix:
      0   1
0  5992   5
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_19.png
early stop counter: 7
val acc:0.9864304065704346, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.9611697196960449 / 0.975071907043457
after epoch: 19,now: 2024-06-07 11:11:46.579924,epoch time: 0:30:33.160866,used: 9:45:55.786233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9912998, 'precision': 0.93220544, 'recall': 0.9341889, 'specificity': 0.9341889, 'f1': 0.93319476, 'auroc': 0.9958042, 'binary_precision': 0.86883026, 'binary_recall': 0.87296194, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.8708912}
confusion matrix:
       0     1
0  42126   194
1    187  1285
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.91901255, 'recall': 0.88243496, 'specificity': 0.88243496, 'f1': 0.8998213, 'auroc': 0.98390883, 'binary_precision': 0.84615386, 'binary_recall': 0.7698289, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.80618894}
confusion matrix:
       0    1
0  18059   90
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.81986356, 'recall': 0.5356481, 'specificity': 0.5356481, 'f1': 0.55547976, 'auroc': 0.91262555, 'binary_precision': 0.6785714, 'binary_recall': 0.07279693, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13148788}
confusion matrix:
      0   1
0  5988   9
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_20.png
better model found
persisted
after epoch: 20,now: 2024-06-07 11:42:33.528657,epoch time: 0:30:46.948733,used: 10:16:42.734966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98764616, 'precision': 0.9761528, 'recall': 0.82803935, 'specificity': 0.82803935, 'f1': 0.8875288, 'auroc': 0.9961057, 'binary_precision': 0.9641077, 'binary_recall': 0.6569294, 'binary_specificity': 0.9991493, 'binary_f1_score': 0.7814142}
confusion matrix:
       0    1
0  42284   36
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9685956, 'recall': 0.78021955, 'specificity': 0.78021955, 'f1': 0.84912634, 'auroc': 0.9813615, 'binary_precision': 0.9525066, 'binary_recall': 0.5614308, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.7064579}
confusion matrix:
       0    1
0  18131   18
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.9224267, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_21.png
early stop counter: 1
val acc:0.9840357303619385, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 21,now: 2024-06-07 12:13:26.915179,epoch time: 0:30:53.386522,used: 10:47:36.121488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9848374, 'precision': 0.9880972, 'recall': 0.7767515, 'specificity': 0.7767515, 'f1': 0.851382, 'auroc': 0.9955979, 'binary_precision': 0.99148417, 'binary_recall': 0.5536685, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.71054924}
confusion matrix:
       0    1
0  42313    7
1    657  815
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.9723561, 'recall': 0.7267576, 'specificity': 0.7267576, 'f1': 0.80372787, 'auroc': 0.980361, 'binary_precision': 0.96369636, 'binary_recall': 0.4541213, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.61733615}
confusion matrix:
       0    1
0  18138   11
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.87801886, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_22.png
early stop counter: 2
val acc:0.980736494064331, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 22,now: 2024-06-07 12:44:34.752748,epoch time: 0:31:07.837569,used: 11:18:43.959057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99152815, 'precision': 0.972495, 'recall': 0.8929968, 'specificity': 0.8929968, 'f1': 0.9288302, 'auroc': 0.9963005, 'binary_precision': 0.9523418, 'binary_recall': 0.7873641, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.8620305}
confusion matrix:
       0     1
0  42262    58
1    313  1159
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9445595, 'recall': 0.8253268, 'specificity': 0.8253268, 'f1': 0.87503207, 'auroc': 0.9805669, 'binary_precision': 0.90128756, 'binary_recall': 0.65318817, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7574391}
confusion matrix:
       0    1
0  18103   46
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8345965, 'recall': 0.53198344, 'specificity': 0.53198344, 'f1': 0.5493883, 'auroc': 0.9093983, 'binary_precision': 0.7083333, 'binary_recall': 0.0651341, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.11929825}
confusion matrix:
      0   1
0  5990   7
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_23.png
early stop counter: 3
val acc:0.985685408115387, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 23,now: 2024-06-07 13:15:28.120868,epoch time: 0:30:53.368120,used: 11:49:37.327177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9919392, 'precision': 0.9726784, 'recall': 0.8993709, 'specificity': 0.8993709, 'f1': 0.93271923, 'auroc': 0.997282, 'binary_precision': 0.9522654, 'binary_recall': 0.80013597, 'binary_specificity': 0.9986059, 'binary_f1_score': 0.8695974}
confusion matrix:
       0     1
0  42262    59
1    294  1177
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9383713, 'recall': 0.8475743, 'specificity': 0.8475743, 'f1': 0.88733006, 'auroc': 0.9819287, 'binary_precision': 0.88735175, 'binary_recall': 0.6982893, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.78154916}
confusion matrix:
       0    1
0  18092   57
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9425237, 'recall': 0.5458103, 'specificity': 0.5458103, 'f1': 0.5738518, 'auroc': 0.9289105, 'binary_precision': 0.9230769, 'binary_recall': 0.09195402, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.16724738}
confusion matrix:
      0   1
0  5995   2
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_24.png
early stop counter: 4
val acc:0.9866432547569275, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 24,now: 2024-06-07 13:46:02.264959,epoch time: 0:30:34.144091,used: 12:20:11.471268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.9343679, 'recall': 0.94574964, 'specificity': 0.94574964, 'f1': 0.93997926, 'auroc': 0.9970676, 'binary_precision': 0.8723545, 'binary_recall': 0.8960598, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.88404834}
confusion matrix:
       0     1
0  42127   193
1    153  1319
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9078188, 'recall': 0.89740855, 'specificity': 0.89740855, 'f1': 0.9025407, 'auroc': 0.98345673, 'binary_precision': 0.8226837, 'binary_recall': 0.8009331, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.81166273}
confusion matrix:
       0    1
0  18038  111
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8841022, 'recall': 0.5625514, 'specificity': 0.5625514, 'f1': 0.5996105, 'auroc': 0.93864065, 'binary_precision': 0.80487806, 'binary_recall': 0.12643678, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21854305}
confusion matrix:
      0   1
0  5989   8
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_25.png
early stop counter: 5
val acc:0.9872817993164062, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 25,now: 2024-06-07 14:17:21.391278,epoch time: 0:31:19.126319,used: 12:51:30.597587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9923959, 'precision': 0.9754244, 'recall': 0.90426517, 'specificity': 0.90426517, 'f1': 0.9367572, 'auroc': 0.99785733, 'binary_precision': 0.9574297, 'binary_recall': 0.8097826, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.8774383}
confusion matrix:
       0     1
0  42267    53
1    280  1192
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.95567167, 'recall': 0.8341559, 'specificity': 0.8341559, 'f1': 0.8848886, 'auroc': 0.97984076, 'binary_precision': 0.9229122, 'binary_recall': 0.6702955, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.7765766}
confusion matrix:
       0    1
0  18113   36
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9804518, 'recall': 0.532567, 'specificity': 0.532567, 'f1': 0.55118215, 'auroc': 0.9094404, 'binary_precision': 1.0, 'binary_recall': 0.0651341, 'binary_specificity': 1.0, 'binary_f1_score': 0.12230217}
confusion matrix:
      0   1
0  5997   0
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_26.png
early stop counter: 6
val acc:0.986802875995636, best validation acc: 0.9873350262641907, corresponding to test acc:                         0.9598913192749023 / 0.975071907043457
after epoch: 26,now: 2024-06-07 14:48:08.391356,epoch time: 0:30:47.000078,used: 13:22:17.597665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9923274, 'precision': 0.9518521, 'recall': 0.92750764, 'specificity': 0.92750764, 'f1': 0.9393168, 'auroc': 0.99740887, 'binary_precision': 0.9086331, 'binary_recall': 0.8580163, 'binary_specificity': 0.996999, 'binary_f1_score': 0.88259953}
confusion matrix:
       0     1
0  42193   127
1    209  1263
---- Validation: 
scalar performance:
{'acc': 0.9893572, 'precision': 0.955059, 'recall': 0.8767314, 'specificity': 0.8767314, 'f1': 0.91192937, 'auroc': 0.98277307, 'binary_precision': 0.9187146, 'binary_recall': 0.755832, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.8293515}
confusion matrix:
       0    1
0  18106   43
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.86679983, 'recall': 0.53215015, 'specificity': 0.53215015, 'f1': 0.54989326, 'auroc': 0.90074396, 'binary_precision': 0.77272725, 'binary_recall': 0.0651341, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.12014135}
confusion matrix:
      0   1
0  5992   5
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_27.png
better model found
persisted
after epoch: 27,now: 2024-06-07 15:18:57.515731,epoch time: 0:30:49.124375,used: 13:53:06.722040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99406284, 'precision': 0.9699724, 'recall': 0.9366021, 'specificity': 0.9366021, 'f1': 0.9526268, 'auroc': 0.9980191, 'binary_precision': 0.9442815, 'binary_recall': 0.875, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.90832156}
confusion matrix:
       0     1
0  42244    76
1    184  1288
---- Validation: 
scalar performance:
{'acc': 0.9887718, 'precision': 0.950834, 'recall': 0.8711779, 'specificity': 0.8711779, 'f1': 0.90685475, 'auroc': 0.9840641, 'binary_precision': 0.9106464, 'binary_recall': 0.7449456, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.81950384}
confusion matrix:
       0    1
0  18102   47
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.88427603, 'recall': 0.5473925, 'specificity': 0.5473925, 'f1': 0.57571787, 'auroc': 0.9140982, 'binary_precision': 0.8064516, 'binary_recall': 0.09578544, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.17123288}
confusion matrix:
      0   1
0  5991   6
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_28.png
early stop counter: 1
val acc:0.9887717962265015, best validation acc: 0.9893571734428406, corresponding to test acc:                         0.960210919380188 / 0.975071907043457
after epoch: 28,now: 2024-06-07 15:50:02.137715,epoch time: 0:31:04.621984,used: 14:24:11.344024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99360615, 'precision': 0.94915867, 'recall': 0.9526969, 'specificity': 0.9526969, 'f1': 0.9509203, 'auroc': 0.99798274, 'binary_precision': 0.9014845, 'binary_recall': 0.9088435, 'binary_specificity': 0.99655026, 'binary_f1_score': 0.90514904}
confusion matrix:
       0     1
0  42176   146
1    134  1336
---- Validation: 
scalar performance:
{'acc': 0.9886654, 'precision': 0.9291426, 'recall': 0.8936245, 'specificity': 0.8936245, 'f1': 0.91055536, 'auroc': 0.9824258, 'binary_precision': 0.86564624, 'binary_recall': 0.79160184, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.82697}
confusion matrix:
       0    1
0  18070   79
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.89036655, 'recall': 0.57587796, 'specificity': 0.57587796, 'f1': 0.61961067, 'auroc': 0.9290389, 'binary_precision': 0.81632656, 'binary_recall': 0.1532567, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2580645}
confusion matrix:
      0   1
0  5988   9
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_29.png
early stop counter: 2
val acc:0.9886654019355774, best validation acc: 0.9893571734428406, corresponding to test acc:                         0.960210919380188 / 0.975071907043457
after epoch: 29,now: 2024-06-07 16:21:16.469006,epoch time: 0:31:14.331291,used: 14:55:25.675315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.993903, 'precision': 0.95898235, 'recall': 0.9460273, 'specificity': 0.9460273, 'f1': 0.9524049, 'auroc': 0.9983263, 'binary_precision': 0.9216235, 'binary_recall': 0.89470106, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.9079628}
confusion matrix:
       0     1
0  42208   112
1    155  1317
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.92360115, 'recall': 0.89109886, 'specificity': 0.89109886, 'f1': 0.9066491, 'auroc': 0.9837664, 'binary_precision': 0.8547297, 'binary_recall': 0.7869362, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8194332}
confusion matrix:
       0    1
0  18063   86
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7302505, 'recall': 0.527485, 'specificity': 0.527485, 'f1': 0.54087156, 'auroc': 0.8984146, 'binary_precision': 0.5, 'binary_recall': 0.057471264, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.10309278}
confusion matrix:
      0   1
0  5982  15
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_30.png
early stop counter: 3
val acc:0.9881332516670227, best validation acc: 0.9893571734428406, corresponding to test acc:                         0.960210919380188 / 0.975071907043457
after epoch: 30,now: 2024-06-07 16:52:40.381298,epoch time: 0:31:23.912292,used: 15:26:49.587607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:26:49.587607 at 2024-06-07 16:52:40.381298
persisted model performance metric: 

scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.90546006, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
oracle model performance metric: 

scalar performance:
{'acc': 0.97347397, 'precision': 0.8815441, 'recall': 0.74795634, 'specificity': 0.74795634, 'f1': 0.7992084, 'auroc': 0.92657363, 'binary_precision': 0.78443116, 'binary_recall': 0.5019157, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6121495}
confusion matrix:
      0    1
0  5961   36
1   130  131
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 463465 GiB | 463464 GiB |
|       from large pool | 417040 KiB |    849 MiB | 450564 GiB | 450564 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2874    |   87655 K  |   87655 K  |
|       from large pool |     112    |     508    |   45005 K  |   45005 K  |
|       from small pool |      35    |    2761    |   42649 K  |   42649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   87656 K  |   87656 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   42651 K  |   42651 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   87656 K  |   87656 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   42651 K  |   42651 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179

 Experiment start at: 2024-06-07 17:03:56.425172
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97056276, 'precision': 0.78131765, 'recall': 0.6776299, 'specificity': 0.6776299, 'f1': 0.716702, 'auroc': 0.942421, 'binary_precision': 0.5839822, 'binary_recall': 0.36407766, 'binary_specificity': 0.99118215, 'binary_f1_score': 0.44852626}
confusion matrix:
       0    1
0  42040  374
1    917  525
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.7813461, 'recall': 0.6974543, 'specificity': 0.6974543, 'f1': 0.7313009, 'auroc': 0.94388276, 'binary_precision': 0.58458245, 'binary_recall': 0.40564635, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.4789474}
confusion matrix:
       0    1
0  17873  194
1    400  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7372236, 'recall': 0.5350248, 'specificity': 0.5350248, 'f1': 0.5532838, 'auroc': 0.9314054, 'binary_precision': 0.5135135, 'binary_recall': 0.073076926, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.12794614}
confusion matrix:
      0   1
0  5928  18
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 17:36:02.578381,epoch time: 0:32:06.153209,used: 0:32:06.153209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9745759, 'precision': 0.82576585, 'recall': 0.71956396, 'specificity': 0.71956396, 'f1': 0.7614633, 'auroc': 0.9583752, 'binary_precision': 0.67013526, 'binary_recall': 0.44660193, 'binary_specificity': 0.99252605, 'binary_f1_score': 0.53599674}
confusion matrix:
       0    1
0  42097  317
1    798  644
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.8384123, 'recall': 0.70467514, 'specificity': 0.70467514, 'f1': 0.7536484, 'auroc': 0.9600956, 'binary_precision': 0.69825435, 'binary_recall': 0.41604754, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.5214153}
confusion matrix:
       0    1
0  17946  121
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7790381, 'recall': 0.5522485, 'specificity': 0.5522485, 'f1': 0.5808376, 'auroc': 0.9382371, 'binary_precision': 0.59574467, 'binary_recall': 0.10769231, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.18241043}
confusion matrix:
      0   1
0  5927  19
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 18:07:22.737585,epoch time: 0:31:20.159204,used: 1:03:26.312413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976058, 'precision': 0.8308013, 'recall': 0.75483036, 'specificity': 0.75483036, 'f1': 0.7874678, 'auroc': 0.96731895, 'binary_precision': 0.6778584, 'binary_recall': 0.5180305, 'binary_specificity': 0.99163014, 'binary_f1_score': 0.5872641}
confusion matrix:
       0    1
0  42059  355
1    695  747
---- Validation: 
scalar performance:
{'acc': 0.9739061, 'precision': 0.8455887, 'recall': 0.726825, 'specificity': 0.726825, 'f1': 0.7728087, 'auroc': 0.9676007, 'binary_precision': 0.71100914, 'binary_recall': 0.46062407, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.5590622}
confusion matrix:
       0    1
0  17941  126
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8134465, 'recall': 0.52633446, 'specificity': 0.52633446, 'f1': 0.53939426, 'auroc': 0.9383403, 'binary_precision': 0.6666667, 'binary_recall': 0.053846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.099644125}
confusion matrix:
      0   1
0  5939   7
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 18:38:37.609584,epoch time: 0:31:14.871999,used: 1:34:41.184412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9796607, 'precision': 0.83763987, 'recall': 0.84712994, 'specificity': 0.84712994, 'f1': 0.8423132, 'auroc': 0.97410345, 'binary_precision': 0.68530995, 'binary_recall': 0.70527047, 'binary_specificity': 0.9889895, 'binary_f1_score': 0.695147}
confusion matrix:
       0     1
0  41947   467
1    425  1017
---- Validation: 
scalar performance:
{'acc': 0.9769477, 'precision': 0.834028, 'recall': 0.83211625, 'specificity': 0.83211625, 'f1': 0.8330691, 'auroc': 0.9719093, 'binary_precision': 0.6801196, 'binary_recall': 0.67607725, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.67809236}
confusion matrix:
       0    1
0  17853  214
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8119049, 'recall': 0.56579405, 'specificity': 0.56579405, 'f1': 0.6017789, 'auroc': 0.944728, 'binary_precision': 0.6603774, 'binary_recall': 0.13461539, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.22364217}
confusion matrix:
      0   1
0  5928  18
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-07 19:09:49.851716,epoch time: 0:31:12.242132,used: 2:05:53.426544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98032194, 'precision': 0.83437216, 'recall': 0.87828743, 'specificity': 0.87828743, 'f1': 0.85484946, 'auroc': 0.9776108, 'binary_precision': 0.6766321, 'binary_recall': 0.76907074, 'binary_specificity': 0.9875041, 'binary_f1_score': 0.71989614}
confusion matrix:
       0     1
0  41884   530
1    333  1109
---- Validation: 
scalar performance:
{'acc': 0.97908217, 'precision': 0.85533977, 'recall': 0.8339385, 'specificity': 0.8339385, 'f1': 0.84427524, 'auroc': 0.97670555, 'binary_precision': 0.72266245, 'binary_recall': 0.67756313, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.6993865}
confusion matrix:
       0    1
0  17892  175
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7855531, 'recall': 0.608343, 'specificity': 0.608343, 'f1': 0.6529678, 'auroc': 0.9515988, 'binary_precision': 0.6041667, 'binary_recall': 0.22307692, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.3258427}
confusion matrix:
      0   1
0  5908  38
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-07 19:40:54.014602,epoch time: 0:31:04.162886,used: 2:36:57.589430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9832862, 'precision': 0.87839764, 'recall': 0.8496742, 'specificity': 0.8496742, 'f1': 0.8634225, 'auroc': 0.9805416, 'binary_precision': 0.76674193, 'binary_recall': 0.7066574, 'binary_specificity': 0.9926911, 'binary_f1_score': 0.7354745}
confusion matrix:
       0     1
0  42104   310
1    423  1019
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.88832325, 'recall': 0.8155672, 'specificity': 0.8155672, 'f1': 0.84786, 'auroc': 0.9783993, 'binary_precision': 0.7900553, 'binary_recall': 0.63744426, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.7055921}
confusion matrix:
       0    1
0  17953  114
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8653046, 'recall': 0.56262064, 'specificity': 0.56262064, 'f1': 0.5991248, 'auroc': 0.9483448, 'binary_precision': 0.76744187, 'binary_recall': 0.12692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5936  10
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-07 20:11:41.124711,epoch time: 0:30:47.110109,used: 3:07:44.699539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9843123, 'precision': 0.8812551, 'recall': 0.8679572, 'specificity': 0.8679572, 'f1': 0.8744783, 'auroc': 0.98375344, 'binary_precision': 0.771223, 'binary_recall': 0.7434119, 'binary_specificity': 0.99250245, 'binary_f1_score': 0.75706214}
confusion matrix:
       0     1
0  42096   318
1    370  1072
---- Validation: 
scalar performance:
{'acc': 0.9814301, 'precision': 0.8856325, 'recall': 0.8301493, 'specificity': 0.8301493, 'f1': 0.855551, 'auroc': 0.9794761, 'binary_precision': 0.7835951, 'binary_recall': 0.66716194, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.7207062}
confusion matrix:
       0    1
0  17943  124
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.9518877, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-07 20:42:22.506944,epoch time: 0:30:41.382233,used: 3:38:26.081772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98570323, 'precision': 0.8945068, 'recall': 0.8757103, 'specificity': 0.8757103, 'f1': 0.8848605, 'auroc': 0.98690367, 'binary_precision': 0.7972283, 'binary_recall': 0.75797504, 'binary_specificity': 0.9934456, 'binary_f1_score': 0.77710634}
confusion matrix:
       0     1
0  42136   278
1    349  1093
---- Validation: 
scalar performance:
{'acc': 0.9808431, 'precision': 0.87738836, 'recall': 0.8312754, 'specificity': 0.8312754, 'f1': 0.8526968, 'auroc': 0.97893476, 'binary_precision': 0.7670068, 'binary_recall': 0.6701337, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.7153054}
confusion matrix:
       0    1
0  17930  137
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8794702, 'recall': 0.5665509, 'specificity': 0.5665509, 'f1': 0.6054686, 'auroc': 0.94255304, 'binary_precision': 0.79545456, 'binary_recall': 0.13461539, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.23026319}
confusion matrix:
      0   1
0  5937   9
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_8.png
new oracle model saved
early stop counter: 1
val acc:0.9808431267738342, best validation acc: 0.9814301133155823, corresponding to test acc:                         0.9621334075927734 / 0.9622945785522461
after epoch: 8,now: 2024-06-07 21:13:10.508572,epoch time: 0:30:48.001628,used: 4:09:14.083400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9831266, 'precision': 0.9592235, 'recall': 0.76116437, 'specificity': 0.76116437, 'f1': 0.83122617, 'auroc': 0.9889269, 'binary_precision': 0.9344059, 'binary_recall': 0.52357835, 'binary_specificity': 0.9987504, 'binary_f1_score': 0.6711111}
confusion matrix:
       0    1
0  42361   53
1    687  755
---- Validation: 
scalar performance:
{'acc': 0.9765742, 'precision': 0.9568609, 'recall': 0.686008, 'specificity': 0.686008, 'f1': 0.76073027, 'auroc': 0.98100996, 'binary_precision': 0.9365672, 'binary_recall': 0.3729569, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.53347504}
confusion matrix:
       0    1
0  18050   17
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.92974496, 'recall': 0.5172236, 'specificity': 0.5172236, 'f1': 0.52295613, 'auroc': 0.94146806, 'binary_precision': 0.9, 'binary_recall': 0.034615386, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5945  1
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_9.png
early stop counter: 2
val acc:0.976574182510376, best validation acc: 0.9814301133155823, corresponding to test acc:                         0.9621334075927734 / 0.9622945785522461
after epoch: 9,now: 2024-06-07 21:44:01.180061,epoch time: 0:30:50.671489,used: 4:40:04.754889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9857488, 'precision': 0.90798384, 'recall': 0.85664165, 'specificity': 0.85664165, 'f1': 0.8804547, 'auroc': 0.9875089, 'binary_precision': 0.825498, 'binary_recall': 0.7184466, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.768261}
confusion matrix:
       0     1
0  42195   219
1    406  1036
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.9189557, 'recall': 0.78420615, 'specificity': 0.78420615, 'f1': 0.83765817, 'auroc': 0.9808583, 'binary_precision': 0.85365856, 'binary_recall': 0.57206535, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.68505335}
confusion matrix:
       0    1
0  18001   66
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.93991727, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_10.png
early stop counter: 3
val acc:0.9811099171638489, best validation acc: 0.9814301133155823, corresponding to test acc:                         0.9621334075927734 / 0.9622945785522461
after epoch: 10,now: 2024-06-07 22:14:53.347228,epoch time: 0:30:52.167167,used: 5:10:56.922056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9871397, 'precision': 0.9241832, 'recall': 0.8630549, 'specificity': 0.8630549, 'f1': 0.8910661, 'auroc': 0.9892055, 'binary_precision': 0.85749185, 'binary_recall': 0.73023576, 'binary_specificity': 0.995874, 'binary_f1_score': 0.78876406}
confusion matrix:
       0     1
0  42239   175
1    389  1053
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.9465618, 'recall': 0.7930981, 'specificity': 0.7930981, 'f1': 0.8527206, 'auroc': 0.98014313, 'binary_precision': 0.9082569, 'binary_recall': 0.5884101, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.7141569}
confusion matrix:
       0    1
0  18027   40
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.9408283, 'recall': 0.5440626, 'specificity': 0.5440626, 'f1': 0.5708477, 'auroc': 0.9454663, 'binary_precision': 0.92, 'binary_recall': 0.08846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5944   2
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 22:45:45.359866,epoch time: 0:30:52.012638,used: 5:41:48.934694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9878694, 'precision': 0.94037974, 'recall': 0.85840786, 'specificity': 0.85840786, 'f1': 0.89488053, 'auroc': 0.99131346, 'binary_precision': 0.89022297, 'binary_recall': 0.71983355, 'binary_specificity': 0.99698216, 'binary_f1_score': 0.7960122}
confusion matrix:
       0     1
0  42286   128
1    404  1038
---- Validation: 
scalar performance:
{'acc': 0.9820171, 'precision': 0.9266356, 'recall': 0.79254454, 'specificity': 0.79254454, 'f1': 0.8461175, 'auroc': 0.9808035, 'binary_precision': 0.8684211, 'binary_recall': 0.5884101, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7015057}
confusion matrix:
       0    1
0  18007   60
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.89469004, 'recall': 0.5457334, 'specificity': 0.5457334, 'f1': 0.5731052, 'auroc': 0.9418212, 'binary_precision': 0.82758623, 'binary_recall': 0.092307694, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.16608997}
confusion matrix:
      0   1
0  5941   5
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_12.png
early stop counter: 1
val acc:0.9820170998573303, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9614889025688171 / 0.9622945785522461
after epoch: 12,now: 2024-06-07 23:16:26.472738,epoch time: 0:30:41.112872,used: 6:12:30.047566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9893971, 'precision': 0.91498566, 'recall': 0.9191541, 'specificity': 0.9191541, 'f1': 0.9170586, 'auroc': 0.9915607, 'binary_precision': 0.835278, 'binary_recall': 0.8439667, 'binary_specificity': 0.9943415, 'binary_f1_score': 0.83959985}
confusion matrix:
       0     1
0  42174   240
1    225  1217
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9054991, 'recall': 0.8588792, 'specificity': 0.8588792, 'f1': 0.88064456, 'auroc': 0.97993946, 'binary_precision': 0.8212479, 'binary_recall': 0.72362554, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.76935226}
confusion matrix:
       0    1
0  17961  106
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.92596793, 'recall': 0.5612021, 'specificity': 0.5612021, 'f1': 0.598534, 'auroc': 0.9342056, 'binary_precision': 0.8888889, 'binary_recall': 0.12307692, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5942   4
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-07 23:47:13.999338,epoch time: 0:30:47.526600,used: 6:43:17.574166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9865241, 'precision': 0.87910867, 'recall': 0.9233629, 'specificity': 0.9233629, 'f1': 0.89990914, 'auroc': 0.99145657, 'binary_precision': 0.76314163, 'binary_recall': 0.85575587, 'binary_specificity': 0.99096996, 'binary_f1_score': 0.80679965}
confusion matrix:
       0     1
0  42031   383
1    208  1234
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.8865985, 'recall': 0.8749706, 'specificity': 0.8749706, 'f1': 0.8806877, 'auroc': 0.9805056, 'binary_precision': 0.78220856, 'binary_recall': 0.7578009, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.7698113}
confusion matrix:
       0    1
0  17925  142
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.92740947, 'recall': 0.5478246, 'specificity': 0.5478246, 'f1': 0.5769903, 'auroc': 0.9381046, 'binary_precision': 0.89285713, 'binary_recall': 0.09615385, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.1736111}
confusion matrix:
      0   1
0  5943   3
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_14.png
early stop counter: 1
val acc:0.9837246537208557, best validation acc: 0.9844183325767517, corresponding to test acc:                         0.9626168012619019 / 0.9626168012619019
after epoch: 14,now: 2024-06-08 00:18:05.254686,epoch time: 0:30:51.255348,used: 7:14:08.829514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98887265, 'precision': 0.9245158, 'recall': 0.8954363, 'specificity': 0.8954363, 'f1': 0.9094204, 'auroc': 0.992533, 'binary_precision': 0.85597014, 'binary_recall': 0.79542303, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.82458663}
confusion matrix:
       0     1
0  42221   193
1    295  1147
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.93755364, 'recall': 0.8460364, 'specificity': 0.8460364, 'f1': 0.88602304, 'auroc': 0.98297906, 'binary_precision': 0.8863636, 'binary_recall': 0.69539374, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7793505}
confusion matrix:
       0    1
0  18007   60
1    205  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.92773044, 'recall': 0.5325241, 'specificity': 0.5325241, 'f1': 0.5508355, 'auroc': 0.9400534, 'binary_precision': 0.8947368, 'binary_recall': 0.06538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5944   2
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_15.png
better model found
persisted
after epoch: 15,now: 2024-06-08 00:49:00.590085,epoch time: 0:30:55.335399,used: 7:45:04.164913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9900812, 'precision': 0.9520112, 'recall': 0.88534266, 'specificity': 0.88534266, 'f1': 0.9158291, 'auroc': 0.9935063, 'binary_precision': 0.91169256, 'binary_recall': 0.7732316, 'binary_specificity': 0.9974537, 'binary_f1_score': 0.836773}
confusion matrix:
       0     1
0  42306   108
1    327  1115
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.9455974, 'recall': 0.8159909, 'specificity': 0.8159909, 'f1': 0.8689214, 'auroc': 0.9827018, 'binary_precision': 0.904661, 'binary_recall': 0.6344725, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.7458515}
confusion matrix:
       0    1
0  18022   45
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9344175, 'recall': 0.55551696, 'specificity': 0.55551696, 'f1': 0.5896616, 'auroc': 0.9421313, 'binary_precision': 0.90625, 'binary_recall': 0.11153846, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.19863014}
confusion matrix:
      0   1
0  5943   3
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_16.png
early stop counter: 1
val acc:0.9844717383384705, best validation acc: 0.9858590960502625, corresponding to test acc:                         0.9605220556259155 / 0.9626168012619019
after epoch: 16,now: 2024-06-08 01:19:58.697273,epoch time: 0:30:58.107188,used: 8:16:02.272101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98770976, 'precision': 0.8914457, 'recall': 0.92464584, 'specificity': 0.92464584, 'f1': 0.9073131, 'auroc': 0.9922632, 'binary_precision': 0.7877629, 'binary_recall': 0.85714287, 'binary_specificity': 0.9921488, 'binary_f1_score': 0.82098967}
confusion matrix:
       0     1
0  42081   333
1    206  1236
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.8940136, 'recall': 0.89514077, 'specificity': 0.89514077, 'f1': 0.89457625, 'auroc': 0.982732, 'binary_precision': 0.79555553, 'binary_recall': 0.79791975, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.7967358}
confusion matrix:
       0    1
0  17929  138
1    136  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.93143857, 'recall': 0.58419496, 'specificity': 0.58419496, 'f1': 0.63326484, 'auroc': 0.94667506, 'binary_precision': 0.8979592, 'binary_recall': 0.16923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.28478965}
confusion matrix:
      0   1
0  5941   5
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_17.png
new oracle model saved
early stop counter: 2
val acc:0.9853788614273071, best validation acc: 0.9858590960502625, corresponding to test acc:                         0.9605220556259155 / 0.9643893241882324
after epoch: 17,now: 2024-06-08 01:50:46.721159,epoch time: 0:30:48.023886,used: 8:46:50.295987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99092484, 'precision': 0.9335834, 'recall': 0.9219537, 'specificity': 0.9219537, 'f1': 0.92768335, 'auroc': 0.99438405, 'binary_precision': 0.87232524, 'binary_recall': 0.8481276, 'binary_specificity': 0.9957797, 'binary_f1_score': 0.8600563}
confusion matrix:
       0     1
0  42235   179
1    219  1223
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.93038756, 'recall': 0.87531126, 'specificity': 0.87531126, 'f1': 0.9008102, 'auroc': 0.9831907, 'binary_precision': 0.86986303, 'binary_recall': 0.7548291, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.8082736}
confusion matrix:
       0    1
0  17991   76
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.944417, 'recall': 0.5709016, 'specificity': 0.5709016, 'f1': 0.6140038, 'auroc': 0.94339955, 'binary_precision': 0.925, 'binary_recall': 0.1423077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.24666667}
confusion matrix:
      0   1
0  5943   3
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_18.png
better model found
persisted
after epoch: 18,now: 2024-06-08 02:21:38.350432,epoch time: 0:30:51.629273,used: 9:17:41.925260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98937434, 'precision': 0.9521766, 'recall': 0.8729189, 'specificity': 0.8729189, 'f1': 0.9084659, 'auroc': 0.9941435, 'binary_precision': 0.91285956, 'binary_recall': 0.7482663, 'binary_specificity': 0.9975715, 'binary_f1_score': 0.8224085}
confusion matrix:
       0     1
0  42311   103
1    363  1079
---- Validation: 
scalar performance:
{'acc': 0.983778, 'precision': 0.94389653, 'recall': 0.80633265, 'specificity': 0.80633265, 'f1': 0.8615426, 'auroc': 0.98147905, 'binary_precision': 0.9019608, 'binary_recall': 0.615156, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.73144877}
confusion matrix:
       0    1
0  18022   45
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.96638095, 'recall': 0.56145436, 'specificity': 0.56145436, 'f1': 0.599767, 'auroc': 0.9217376, 'binary_precision': 0.969697, 'binary_recall': 0.12307692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5945   1
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_19.png
early stop counter: 1
val acc:0.9837779998779297, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9635836482048035 / 0.9643893241882324
after epoch: 19,now: 2024-06-08 02:52:25.536169,epoch time: 0:30:47.185737,used: 9:48:29.110997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9903776, 'precision': 0.9575858, 'recall': 0.884826, 'specificity': 0.884826, 'f1': 0.9178368, 'auroc': 0.99481076, 'binary_precision': 0.9228856, 'binary_recall': 0.7718447, 'binary_specificity': 0.9978073, 'binary_f1_score': 0.84063447}
confusion matrix:
       0     1
0  42321    93
1    329  1113
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.94103825, 'recall': 0.82694125, 'specificity': 0.82694125, 'f1': 0.8748522, 'auroc': 0.98367876, 'binary_precision': 0.8947368, 'binary_recall': 0.65676075, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.7574978}
confusion matrix:
       0    1
0  18015   52
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.9443947, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_20.png
early stop counter: 2
val acc:0.9848986268043518, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9635836482048035 / 0.9643893241882324
after epoch: 20,now: 2024-06-08 03:23:27.428637,epoch time: 0:31:01.892468,used: 10:19:31.003465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9904688, 'precision': 0.9088392, 'recall': 0.9508587, 'specificity': 0.9508587, 'f1': 0.92873645, 'auroc': 0.99655783, 'binary_precision': 0.82080203, 'binary_recall': 0.9084605, 'binary_specificity': 0.9932569, 'binary_f1_score': 0.8624095}
confusion matrix:
       0     1
0  42128   286
1    132  1310
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9001609, 'recall': 0.9013057, 'specificity': 0.9013057, 'f1': 0.9007324, 'auroc': 0.98331857, 'binary_precision': 0.8074074, 'binary_recall': 0.8098068, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.8086053}
confusion matrix:
       0    1
0  17937  130
1    128  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.88407326, 'recall': 0.570397, 'specificity': 0.570397, 'f1': 0.611333, 'auroc': 0.92043066, 'binary_precision': 0.8043478, 'binary_recall': 0.1423077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.24183008}
confusion matrix:
      0   1
0  5937   9
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_21.png
early stop counter: 3
val acc:0.9862326383590698, best validation acc: 0.9871398210525513, corresponding to test acc:                         0.9635836482048035 / 0.9643893241882324
after epoch: 21,now: 2024-06-08 03:54:28.289567,epoch time: 0:31:00.860930,used: 10:50:31.864395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9919509, 'precision': 0.9393871, 'recall': 0.9332026, 'specificity': 0.9332026, 'f1': 0.9362712, 'auroc': 0.9967849, 'binary_precision': 0.88318086, 'binary_recall': 0.870319, 'binary_specificity': 0.9960862, 'binary_f1_score': 0.8767028}
confusion matrix:
       0     1
0  42248   166
1    187  1255
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.9287286, 'recall': 0.87820005, 'specificity': 0.87820005, 'f1': 0.90174985, 'auroc': 0.98307836, 'binary_precision': 0.86632824, 'binary_recall': 0.76077265, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.81012654}
confusion matrix:
       0    1
0  17988   79
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.84588623, 'recall': 0.5359498, 'specificity': 0.5359498, 'f1': 0.5562076, 'auroc': 0.91706383, 'binary_precision': 0.7307692, 'binary_recall': 0.073076926, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.13286714}
confusion matrix:
      0   1
0  5939   7
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_22.png
better model found
persisted
after epoch: 22,now: 2024-06-08 04:25:45.589058,epoch time: 0:31:17.299491,used: 11:21:49.163886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9917001, 'precision': 0.96101284, 'recall': 0.9039321, 'specificity': 0.9039321, 'f1': 0.93045175, 'auroc': 0.9968432, 'binary_precision': 0.92845786, 'binary_recall': 0.8099861, 'binary_specificity': 0.9978781, 'binary_f1_score': 0.86518514}
confusion matrix:
       0     1
0  42324    90
1    274  1168
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.9500471, 'recall': 0.831648, 'specificity': 0.831648, 'f1': 0.8811898, 'auroc': 0.9827069, 'binary_precision': 0.9124236, 'binary_recall': 0.66567606, 'binary_specificity': 0.99762, 'binary_f1_score': 0.7697594}
confusion matrix:
       0    1
0  18024   43
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9658295, 'recall': 0.5595313, 'specificity': 0.5595313, 'f1': 0.59667593, 'auroc': 0.9423061, 'binary_precision': 0.96875, 'binary_recall': 0.11923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.21232878}
confusion matrix:
      0   1
0  5945   1
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_23.png
early stop counter: 1
val acc:0.9856990575790405, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9600386619567871 / 0.9643893241882324
after epoch: 23,now: 2024-06-08 04:57:16.145121,epoch time: 0:31:30.556063,used: 11:53:19.719949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9915633, 'precision': 0.9737904, 'recall': 0.8894584, 'specificity': 0.8894584, 'f1': 0.9272152, 'auroc': 0.9967288, 'binary_precision': 0.9550085, 'binary_recall': 0.78016645, 'binary_specificity': 0.9987504, 'binary_f1_score': 0.85877866}
confusion matrix:
       0     1
0  42361    53
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9602262, 'recall': 0.8223219, 'specificity': 0.8223219, 'f1': 0.8782129, 'auroc': 0.9795512, 'binary_precision': 0.9334764, 'binary_recall': 0.64635956, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.7638279}
confusion matrix:
       0    1
0  18036   31
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9311366, 'recall': 0.5516708, 'specificity': 0.5516708, 'f1': 0.5833691, 'auroc': 0.9016991, 'binary_precision': 0.9, 'binary_recall': 0.103846155, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.18620689}
confusion matrix:
      0   1
0  5943   3
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_24.png
early stop counter: 2
val acc:0.9856456518173218, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9600386619567871 / 0.9643893241882324
after epoch: 24,now: 2024-06-08 05:28:56.913710,epoch time: 0:31:40.768589,used: 12:25:00.488538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9926122, 'precision': 0.9485884, 'recall': 0.93354446, 'specificity': 0.93354446, 'f1': 0.94092834, 'auroc': 0.9966394, 'binary_precision': 0.90158045, 'binary_recall': 0.870319, 'binary_specificity': 0.9967699, 'binary_f1_score': 0.88567394}
confusion matrix:
       0     1
0  42277   137
1    187  1255
---- Validation: 
scalar performance:
{'acc': 0.9869797, 'precision': 0.9305803, 'recall': 0.87236714, 'specificity': 0.87236714, 'f1': 0.89918834, 'auroc': 0.9832245, 'binary_precision': 0.8704663, 'binary_recall': 0.7488856, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.8051118}
confusion matrix:
       0    1
0  17992   75
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9231329, 'recall': 0.5439785, 'specificity': 0.5439785, 'f1': 0.5705235, 'auroc': 0.93503255, 'binary_precision': 0.88461536, 'binary_recall': 0.08846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16083917}
confusion matrix:
      0   1
0  5943   3
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_25.png
early stop counter: 3
val acc:0.9869797229766846, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9600386619567871 / 0.9643893241882324
after epoch: 25,now: 2024-06-08 06:00:30.940958,epoch time: 0:31:34.027248,used: 12:56:34.515786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9937067, 'precision': 0.9701216, 'recall': 0.92841613, 'specificity': 0.92841613, 'f1': 0.9482304, 'auroc': 0.9978647, 'binary_precision': 0.94503814, 'binary_recall': 0.8585298, 'binary_specificity': 0.99830246, 'binary_f1_score': 0.89970934}
confusion matrix:
       0     1
0  42342    72
1    204  1238
---- Validation: 
scalar performance:
{'acc': 0.98788685, 'precision': 0.9479169, 'recall': 0.868546, 'specificity': 0.868546, 'f1': 0.904065, 'auroc': 0.9838543, 'binary_precision': 0.9054545, 'binary_recall': 0.73997027, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.81439084}
confusion matrix:
       0    1
0  18015   52
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9328275, 'recall': 0.5535939, 'specificity': 0.5535939, 'f1': 0.58652604, 'auroc': 0.9179964, 'binary_precision': 0.9032258, 'binary_recall': 0.10769231, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.19243985}
confusion matrix:
      0   1
0  5943   3
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_26.png
better model found
persisted
after epoch: 26,now: 2024-06-08 06:31:56.074240,epoch time: 0:31:25.133282,used: 13:27:59.649068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9931138, 'precision': 0.96341705, 'recall': 0.92543006, 'specificity': 0.92543006, 'f1': 0.94355196, 'auroc': 0.9971285, 'binary_precision': 0.9318182, 'binary_recall': 0.852982, 'binary_specificity': 0.9978781, 'binary_f1_score': 0.890659}
confusion matrix:
       0     1
0  42324    90
1    212  1230
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9337301, 'recall': 0.85624385, 'specificity': 0.85624385, 'f1': 0.8908775, 'auroc': 0.9817146, 'binary_precision': 0.8779599, 'binary_recall': 0.7161961, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.78887063}
confusion matrix:
       0    1
0  18000   67
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.86596775, 'recall': 0.5569355, 'specificity': 0.5569355, 'f1': 0.590469, 'auroc': 0.9232021, 'binary_precision': 0.7692308, 'binary_recall': 0.115384616, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.20066889}
confusion matrix:
      0   1
0  5937   9
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_27.png
early stop counter: 1
val acc:0.9862326383590698, best validation acc: 0.9878868460655212, corresponding to test acc:                         0.9621334075927734 / 0.9643893241882324
after epoch: 27,now: 2024-06-08 07:03:21.370310,epoch time: 0:31:25.296070,used: 13:59:24.945138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9939347, 'precision': 0.9727529, 'recall': 0.92953885, 'specificity': 0.92953885, 'f1': 0.9500358, 'auroc': 0.9979551, 'binary_precision': 0.9502297, 'binary_recall': 0.86061025, 'binary_specificity': 0.9984675, 'binary_f1_score': 0.9032023}
confusion matrix:
       0     1
0  42349    65
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.9449823, 'recall': 0.8603183, 'specificity': 0.8603183, 'f1': 0.8978443, 'auroc': 0.9802149, 'binary_precision': 0.90018487, 'binary_recall': 0.72362554, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.8023064}
confusion matrix:
       0    1
0  18013   54
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.9424446, 'recall': 0.5459857, 'specificity': 0.5459857, 'f1': 0.57410246, 'auroc': 0.91585004, 'binary_precision': 0.9230769, 'binary_recall': 0.092307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.16783217}
confusion matrix:
      0   1
0  5944   2
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_28.png
early stop counter: 2
val acc:0.9871931672096252, best validation acc: 0.9878868460655212, corresponding to test acc:                         0.9621334075927734 / 0.9643893241882324
after epoch: 28,now: 2024-06-08 07:34:47.886004,epoch time: 0:31:26.515694,used: 14:30:51.460832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9939119, 'precision': 0.9710686, 'recall': 0.9308669, 'specificity': 0.9308669, 'f1': 0.95000637, 'auroc': 0.99769044, 'binary_precision': 0.94676805, 'binary_recall': 0.8633842, 'binary_specificity': 0.9983496, 'binary_f1_score': 0.90315557}
confusion matrix:
       0     1
0  42344    70
1    197  1245
---- Validation: 
scalar performance:
{'acc': 0.98794025, 'precision': 0.95164406, 'recall': 0.86571264, 'specificity': 0.86571264, 'f1': 0.9038034, 'auroc': 0.9829699, 'binary_precision': 0.91312385, 'binary_recall': 0.73402673, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.8138386}
confusion matrix:
       0    1
0  18020   47
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.93908393, 'recall': 0.54213953, 'specificity': 0.54213953, 'f1': 0.5675703, 'auroc': 0.92472667, 'binary_precision': 0.9166667, 'binary_recall': 0.08461539, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5944   2
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_29.png
better model found
persisted
after epoch: 29,now: 2024-06-08 08:06:03.341300,epoch time: 0:31:15.455296,used: 15:02:06.916128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9939575, 'precision': 0.9605595, 'recall': 0.94294876, 'specificity': 0.94294876, 'f1': 0.9515696, 'auroc': 0.9976723, 'binary_precision': 0.9249098, 'binary_recall': 0.88834953, 'binary_specificity': 0.997548, 'binary_f1_score': 0.9062611}
confusion matrix:
       0     1
0  42310   104
1    161  1281
---- Validation: 
scalar performance:
{'acc': 0.98762006, 'precision': 0.94383705, 'recall': 0.86840767, 'specificity': 0.86840767, 'f1': 0.9023377, 'auroc': 0.983596, 'binary_precision': 0.8972973, 'binary_recall': 0.73997027, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.8110749}
confusion matrix:
       0    1
0  18010   57
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8231364, 'recall': 0.5489909, 'specificity': 0.5489909, 'f1': 0.5770948, 'auroc': 0.9352938, 'binary_precision': 0.68421054, 'binary_recall': 0.1, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.17449665}
confusion matrix:
      0   1
0  5934  12
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170179_30.png
early stop counter: 1
val acc:0.9876200556755066, best validation acc: 0.98794025182724, corresponding to test acc:                         0.9613277316093445 / 0.9643893241882324
after epoch: 30,now: 2024-06-08 08:37:11.425856,epoch time: 0:31:08.084556,used: 15:33:15.000684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_03_56_seed_1_21170179
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:33:15.000684 at 2024-06-08 08:37:11.425856
persisted model performance metric: 

scalar performance:
{'acc': 0.9614889, 'precision': 0.9253475, 'recall': 0.5459016, 'specificity': 0.5459016, 'f1': 0.573768, 'auroc': 0.9271896, 'binary_precision': 0.8888889, 'binary_recall': 0.092307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16724738}
confusion matrix:
      0   1
0  5943   3
1   236  24
oracle model performance metric: 

scalar performance:
{'acc': 0.96455044, 'precision': 0.94977766, 'recall': 0.58244, 'specificity': 0.58244, 'f1': 0.63143647, 'auroc': 0.9478539, 'binary_precision': 0.9347826, 'binary_recall': 0.16538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.28104573}
confusion matrix:
      0   1
0  5943   3
1   217  43
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16636 MiB |  16636 MiB |  31178 MiB |  14542 MiB |
|       from large pool |  16608 MiB |  16608 MiB |  31148 MiB |  14540 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436746 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool | 416800 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304915 K  |  304912 K  |
|       from large pool |     247    |     989    |  124200 K  |  124200 K  |
|       from small pool |    3095    |    6116    |  180714 K  |  180711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304915 K  |  304912 K  |
|       from large pool |     247    |     989    |  124200 K  |  124200 K  |
|       from small pool |    3095    |    6116    |  180714 K  |  180711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |    1118    |     501    |
|       from large pool |     603    |     603    |    1103    |     500    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |    2875    |  167865 K  |  167865 K  |
|       from large pool |     109    |     508    |   81874 K  |   81874 K  |
|       from small pool |      33    |    2765    |   85991 K  |   85991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180714 K  |  180714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180714 K  |  180714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2875    |  167867 K  |  167867 K  |
|       from large pool |       2    |     508    |   81874 K  |   81874 K  |
|       from small pool |       0    |    2765    |   85992 K  |   85992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180714 K  |  180714 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180714 K  |  180714 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2875    |  167867 K  |  167867 K  |
|       from large pool |       2    |     508    |   81874 K  |   81874 K  |
|       from small pool |       0    |    2765    |   85992 K  |   85992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 08:40:08 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/6.csv

RuleException:
ValueError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
too many values to unpack (expected 2)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 185, in get_task
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
