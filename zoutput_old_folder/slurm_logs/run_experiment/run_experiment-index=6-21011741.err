Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 13:26:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741

 Experiment start at: 2024-05-31 13:36:54.237748
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.86995035, 'recall': 0.57702297, 'specificity': 0.57702297, 'f1': 0.6218132, 'auroc': 0.96712434, 'binary_precision': 0.7684564, 'binary_recall': 0.15567641, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.25890332}
confusion matrix:
       0    1
0  42252   69
1   1242  229
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9680715, 'precision': 0.8553612, 'recall': 0.55068827, 'specificity': 0.55068827, 'f1': 0.58202326, 'auroc': 0.96631867, 'binary_precision': 0.74157304, 'binary_recall': 0.102643855, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.18032788}
confusion matrix:
       0   1
0  18126  23
1    577  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.95096, 'recall': 0.53056794, 'specificity': 0.53056794, 'f1': 0.5475033, 'auroc': 0.952493, 'binary_precision': 0.9411765, 'binary_recall': 0.06130268, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.11510791}
confusion matrix:
      0   1
0  5996   1
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 14:11:25.507896,epoch time: 0:34:31.270148,used: 0:34:31.270148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9780097, 'precision': 0.93280184, 'recall': 0.6974834, 'specificity': 0.6974834, 'f1': 0.76841503, 'auroc': 0.97864884, 'binary_precision': 0.8861912, 'binary_recall': 0.39673913, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.54809946}
confusion matrix:
       0    1
0  42245   75
1    888  584
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.90591496, 'recall': 0.645948, 'specificity': 0.645948, 'f1': 0.7108047, 'auroc': 0.97854626, 'binary_precision': 0.8362832, 'binary_recall': 0.29393467, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.43498272}
confusion matrix:
       0    1
0  18112   37
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9580413, 'recall': 0.60702956, 'specificity': 0.60702956, 'f1': 0.6664726, 'auroc': 0.9577626, 'binary_precision': 0.9491525, 'binary_recall': 0.21455939, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.35000002}
confusion matrix:
      0   1
0  5994   3
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 14:44:03.878462,epoch time: 0:32:38.370566,used: 1:07:09.640714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98186886, 'precision': 0.87942433, 'recall': 0.82439446, 'specificity': 0.82439446, 'f1': 0.84958017, 'auroc': 0.98077977, 'binary_precision': 0.7707668, 'binary_recall': 0.6555706, 'binary_specificity': 0.99321836, 'binary_f1_score': 0.70851684}
confusion matrix:
       0    1
0  42033  287
1    507  965
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.90362453, 'recall': 0.81325567, 'specificity': 0.81325567, 'f1': 0.85229397, 'auroc': 0.97925615, 'binary_precision': 0.820202, 'binary_recall': 0.63141525, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.71353257}
confusion matrix:
       0    1
0  18060   89
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8668101, 'recall': 0.57562786, 'specificity': 0.57562786, 'f1': 0.6182487, 'auroc': 0.9467337, 'binary_precision': 0.7692308, 'binary_recall': 0.1532567, 'binary_specificity': 0.997999, 'binary_f1_score': 0.25559103}
confusion matrix:
      0   1
0  5985  12
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_3.png
better model found
persisted
after epoch: 3,now: 2024-05-31 15:17:04.923615,epoch time: 0:33:01.045153,used: 1:40:10.685867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97985935, 'precision': 0.8857306, 'recall': 0.77220875, 'specificity': 0.77220875, 'f1': 0.81841683, 'auroc': 0.9845406, 'binary_precision': 0.78696495, 'binary_recall': 0.5495924, 'binary_specificity': 0.9948251, 'binary_f1_score': 0.6471999}
confusion matrix:
       0    1
0  42101  219
1    663  809
---- Validation: 
scalar performance:
{'acc': 0.9760004, 'precision': 0.8583183, 'recall': 0.73030615, 'specificity': 0.73030615, 'f1': 0.77926993, 'auroc': 0.9768895, 'binary_precision': 0.7352941, 'binary_recall': 0.466563, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.5708848}
confusion matrix:
       0    1
0  18041  108
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.85855633, 'recall': 0.63967806, 'specificity': 0.63967806, 'f1': 0.6968356, 'auroc': 0.95634377, 'binary_precision': 0.74747473, 'binary_recall': 0.2835249, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.4111111}
confusion matrix:
      0   1
0  5972  25
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_4.png
early stop counter: 1
val acc:0.9760004281997681, best validation acc: 0.9826521873474121, corresponding to test acc:                         0.9627676606178284 / 0.9667625427246094
after epoch: 4,now: 2024-05-31 15:50:02.597859,epoch time: 0:32:57.674244,used: 2:13:08.360111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98513424, 'precision': 0.87292564, 'recall': 0.91165525, 'specificity': 0.91165525, 'f1': 0.8912486, 'auroc': 0.9903029, 'binary_precision': 0.7516861, 'binary_recall': 0.83288044, 'binary_specificity': 0.99043006, 'binary_f1_score': 0.79020303}
confusion matrix:
       0     1
0  41915   405
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8785981, 'recall': 0.876894, 'specificity': 0.876894, 'f1': 0.87774396, 'auroc': 0.9835783, 'binary_precision': 0.765625, 'binary_recall': 0.7620529, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.7638348}
confusion matrix:
       0    1
0  17999  150
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.8694789, 'recall': 0.7512875, 'specificity': 0.7512875, 'f1': 0.79800946, 'auroc': 0.96533716, 'binary_precision': 0.76, 'binary_recall': 0.5095785, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.6100918}
confusion matrix:
      0    1
0  5955   42
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-31 16:23:36.836173,epoch time: 0:33:34.238314,used: 2:46:42.598425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.985865, 'precision': 0.915007, 'recall': 0.85564154, 'specificity': 0.85564154, 'f1': 0.882858, 'auroc': 0.98901, 'binary_precision': 0.83984065, 'binary_recall': 0.7160326, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.7730106}
confusion matrix:
       0     1
0  42119   201
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.90617275, 'recall': 0.8071726, 'specificity': 0.8071726, 'f1': 0.8492658, 'auroc': 0.98157305, 'binary_precision': 0.82572615, 'binary_recall': 0.61897355, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.70755553}
confusion matrix:
       0    1
0  18065   84
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.85524, 'recall': 0.660334, 'specificity': 0.660334, 'f1': 0.7175795, 'auroc': 0.96168196, 'binary_precision': 0.73913044, 'binary_recall': 0.3256705, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.45212767}
confusion matrix:
      0   1
0  5967  30
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_6.png
early stop counter: 1
val acc:0.9824925661087036, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9728347659111023 / 0.9728347659111023
after epoch: 6,now: 2024-05-31 16:56:36.709609,epoch time: 0:32:59.873436,used: 3:19:42.471861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9861618, 'precision': 0.91344345, 'recall': 0.8633359, 'specificity': 0.8633359, 'f1': 0.8866453, 'auroc': 0.99017674, 'binary_precision': 0.83618015, 'binary_recall': 0.7316576, 'binary_specificity': 0.9950142, 'binary_f1_score': 0.78043485}
confusion matrix:
       0     1
0  42109   211
1    395  1077
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.89485353, 'recall': 0.8352828, 'specificity': 0.8352828, 'f1': 0.8624382, 'auroc': 0.9810364, 'binary_precision': 0.80110496, 'binary_recall': 0.67651635, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7335582}
confusion matrix:
       0    1
0  18041  108
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8281236, 'recall': 0.693316, 'specificity': 0.693316, 'f1': 0.7414904, 'auroc': 0.9471568, 'binary_precision': 0.6821192, 'binary_recall': 0.394636, 'binary_specificity': 0.991996, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5949   48
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_7.png
early stop counter: 2
val acc:0.9831843376159668, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9728347659111023 / 0.9728347659111023
after epoch: 7,now: 2024-05-31 17:29:51.347515,epoch time: 0:33:14.637906,used: 3:52:57.109767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9832846, 'precision': 0.8488006, 'recall': 0.9296275, 'specificity': 0.9296275, 'f1': 0.884614, 'auroc': 0.9898703, 'binary_precision': 0.702081, 'binary_recall': 0.8721088, 'binary_specificity': 0.98714614, 'binary_f1_score': 0.77791256}
confusion matrix:
       0     1
0  41778   544
1    188  1282
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.8815491, 'recall': 0.89469624, 'specificity': 0.89469624, 'f1': 0.88800144, 'auroc': 0.98389375, 'binary_precision': 0.7702703, 'binary_recall': 0.7978227, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7838044}
confusion matrix:
       0    1
0  17996  153
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.87514126, 'recall': 0.64759105, 'specificity': 0.64759105, 'f1': 0.70763373, 'auroc': 0.9493617, 'binary_precision': 0.78, 'binary_recall': 0.29885057, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43213296}
confusion matrix:
      0   1
0  5975  22
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_8.png
better model found
persisted
after epoch: 8,now: 2024-05-31 18:03:14.239532,epoch time: 0:33:22.892017,used: 4:26:20.001784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98810285, 'precision': 0.91754854, 'recall': 0.8947613, 'specificity': 0.8947613, 'f1': 0.9058095, 'auroc': 0.9926727, 'binary_precision': 0.842219, 'binary_recall': 0.79469746, 'binary_specificity': 0.99482524, 'binary_f1_score': 0.81776845}
confusion matrix:
       0     1
0  42102   219
1    302  1169
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.92977, 'recall': 0.8472988, 'specificity': 0.8472988, 'f1': 0.88382024, 'auroc': 0.9834282, 'binary_precision': 0.87015504, 'binary_recall': 0.6982893, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7748059}
confusion matrix:
       0    1
0  18082   67
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.90164006, 'recall': 0.6158577, 'specificity': 0.6158577, 'f1': 0.6739334, 'auroc': 0.94344664, 'binary_precision': 0.8356164, 'binary_recall': 0.23371647, 'binary_specificity': 0.997999, 'binary_f1_score': 0.36526945}
confusion matrix:
      0   1
0  5985  12
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_9.png
better model found
persisted
after epoch: 9,now: 2024-05-31 18:36:28.484482,epoch time: 0:33:14.244950,used: 4:59:34.246734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.95457375, 'recall': 0.8910097, 'specificity': 0.8910097, 'f1': 0.920224, 'auroc': 0.9947907, 'binary_precision': 0.91660047, 'binary_recall': 0.78450036, 'binary_specificity': 0.99751896, 'binary_f1_score': 0.84542125}
confusion matrix:
       0     1
0  42216   105
1    317  1154
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.93556917, 'recall': 0.82274604, 'specificity': 0.82274604, 'f1': 0.87013847, 'auroc': 0.98386705, 'binary_precision': 0.8834746, 'binary_recall': 0.64852256, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.7479821}
confusion matrix:
       0    1
0  18094   55
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.912442, 'recall': 0.5817919, 'specificity': 0.5817919, 'f1': 0.6290462, 'auroc': 0.956105, 'binary_precision': 0.86, 'binary_recall': 0.16475096, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.27652735}
confusion matrix:
      0   1
0  5990   7
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_10.png
early stop counter: 1
val acc:0.9850468039512634, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9661233425140381 / 0.9728347659111023
after epoch: 10,now: 2024-05-31 19:09:55.851332,epoch time: 0:33:27.366850,used: 5:33:01.613584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9896557, 'precision': 0.9631264, 'recall': 0.871045, 'specificity': 0.871045, 'f1': 0.9116354, 'auroc': 0.9953109, 'binary_precision': 0.93509823, 'binary_recall': 0.7438859, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.8286038}
confusion matrix:
       0     1
0  42244    76
1    377  1095
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.94795775, 'recall': 0.8223266, 'specificity': 0.8223266, 'f1': 0.8741517, 'auroc': 0.9838818, 'binary_precision': 0.90829694, 'binary_recall': 0.64696735, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.7556766}
confusion matrix:
       0    1
0  18107   42
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91002303, 'recall': 0.5893713, 'specificity': 0.5893713, 'f1': 0.6396358, 'auroc': 0.9506849, 'binary_precision': 0.8545455, 'binary_recall': 0.18007663, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5989   8
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_11.png
early stop counter: 2
val acc:0.985685408115387, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9661233425140381 / 0.9728347659111023
after epoch: 11,now: 2024-05-31 19:43:33.917545,epoch time: 0:33:38.066213,used: 6:06:39.679797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9907061, 'precision': 0.91888833, 'recall': 0.94273394, 'specificity': 0.94273394, 'f1': 0.93045366, 'auroc': 0.99623, 'binary_precision': 0.84156513, 'binary_recall': 0.8913044, 'binary_specificity': 0.9941635, 'binary_f1_score': 0.86572087}
confusion matrix:
       0     1
0  42073   247
1    160  1312
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.90386266, 'recall': 0.8941604, 'specificity': 0.8941604, 'f1': 0.8989476, 'auroc': 0.9828378, 'binary_precision': 0.814992, 'binary_recall': 0.7947123, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.8047244}
confusion matrix:
       0    1
0  18033  116
1    132  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8565578, 'recall': 0.6471742, 'specificity': 0.6471742, 'f1': 0.7044728, 'auroc': 0.9539185, 'binary_precision': 0.74285716, 'binary_recall': 0.29885057, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.42622948}
confusion matrix:
      0   1
0  5970  27
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_12.png
better model found
persisted
after epoch: 12,now: 2024-05-31 20:16:37.354855,epoch time: 0:33:03.437310,used: 6:39:43.117107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99045485, 'precision': 0.9302833, 'recall': 0.92124116, 'specificity': 0.92124116, 'f1': 0.9257104, 'auroc': 0.9948066, 'binary_precision': 0.86587906, 'binary_recall': 0.8470428, 'binary_specificity': 0.9954396, 'binary_f1_score': 0.8563574}
confusion matrix:
       0     1
0  42128   193
1    225  1246
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9253404, 'recall': 0.8656858, 'specificity': 0.8656858, 'f1': 0.8930858, 'auroc': 0.982152, 'binary_precision': 0.86, 'binary_recall': 0.7356143, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.792959}
confusion matrix:
       0    1
0  18072   77
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8903156, 'recall': 0.6384294, 'specificity': 0.6384294, 'f1': 0.69955146, 'auroc': 0.9399202, 'binary_precision': 0.8111111, 'binary_recall': 0.27969348, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.4159544}
confusion matrix:
      0   1
0  5980  17
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_13.png
better model found
persisted
after epoch: 13,now: 2024-05-31 20:49:47.889509,epoch time: 0:33:10.534654,used: 7:12:53.651761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9259071, 'recall': 0.9534883, 'specificity': 0.9534883, 'f1': 0.93922937, 'auroc': 0.99738765, 'binary_precision': 0.8548695, 'binary_recall': 0.9123641, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.88268155}
confusion matrix:
       0     1
0  42092   228
1    129  1343
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9007896, 'recall': 0.9001883, 'specificity': 0.9001883, 'f1': 0.90048873, 'auroc': 0.9843155, 'binary_precision': 0.80841124, 'binary_recall': 0.80715394, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.8077821}
confusion matrix:
       0    1
0  18026  123
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.87514126, 'recall': 0.64759105, 'specificity': 0.64759105, 'f1': 0.70763373, 'auroc': 0.9487277, 'binary_precision': 0.78, 'binary_recall': 0.29885057, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43213296}
confusion matrix:
      0   1
0  5975  22
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_14.png
early stop counter: 1
val acc:0.9868561029434204, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 14,now: 2024-05-31 21:23:05.380046,epoch time: 0:33:17.490537,used: 7:46:11.142298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9932408, 'precision': 0.9580902, 'recall': 0.9358062, 'specificity': 0.9358062, 'f1': 0.9466491, 'auroc': 0.9974574, 'binary_precision': 0.920544, 'binary_recall': 0.8742352, 'binary_specificity': 0.9973772, 'binary_f1_score': 0.8967922}
confusion matrix:
       0     1
0  42210   111
1    185  1286
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9385605, 'recall': 0.8437138, 'specificity': 0.8437138, 'f1': 0.88495266, 'auroc': 0.9834391, 'binary_precision': 0.888, 'binary_recall': 0.6905132, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7769029}
confusion matrix:
       0    1
0  18093   56
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8474181, 'recall': 0.5716297, 'specificity': 0.5716297, 'f1': 0.611695, 'auroc': 0.95689845, 'binary_precision': 0.7307692, 'binary_recall': 0.14559387, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.24281149}
confusion matrix:
      0   1
0  5983  14
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_15.png
early stop counter: 2
val acc:0.9864304065704346, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 15,now: 2024-05-31 21:56:14.229844,epoch time: 0:33:08.849798,used: 8:19:19.992096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992099, 'precision': 0.93890464, 'recall': 0.93948066, 'specificity': 0.93948066, 'f1': 0.9391925, 'auroc': 0.99685234, 'binary_precision': 0.8818737, 'binary_recall': 0.88307273, 'binary_specificity': 0.9958886, 'binary_f1_score': 0.8824728}
confusion matrix:
       0     1
0  42147   174
1    172  1299
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.90703183, 'recall': 0.87580085, 'specificity': 0.87580085, 'f1': 0.8907417, 'auroc': 0.98238283, 'binary_precision': 0.8226351, 'binary_recall': 0.7573872, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7886639}
confusion matrix:
       0    1
0  18044  105
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8060012, 'recall': 0.5822902, 'specificity': 0.5822902, 'f1': 0.62385106, 'auroc': 0.9442644, 'binary_precision': 0.64705884, 'binary_recall': 0.16858238, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2674772}
confusion matrix:
      0   1
0  5973  24
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_16.png
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 16,now: 2024-05-31 22:29:21.043437,epoch time: 0:33:06.813593,used: 8:52:26.805689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9931266, 'precision': 0.9561925, 'recall': 0.93611765, 'specificity': 0.93611765, 'f1': 0.9459118, 'auroc': 0.9975457, 'binary_precision': 0.916726, 'binary_recall': 0.875, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.8953771}
confusion matrix:
       0     1
0  42203   117
1    184  1288
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.91747534, 'recall': 0.84688556, 'specificity': 0.84688556, 'f1': 0.878663, 'auroc': 0.9821519, 'binary_precision': 0.8455744, 'binary_recall': 0.6982893, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.76490635}
confusion matrix:
       0    1
0  18067   82
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7845403, 'recall': 0.5260696, 'specificity': 0.5260696, 'f1': 0.5388314, 'auroc': 0.9394068, 'binary_precision': 0.6086956, 'binary_recall': 0.053639848, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.09859155}
confusion matrix:
      0   1
0  5988   9
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_17.png
early stop counter: 4
val acc:0.9853128790855408, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 17,now: 2024-05-31 23:02:24.524110,epoch time: 0:33:03.480673,used: 9:25:30.286362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930809, 'precision': 0.93151116, 'recall': 0.9678964, 'specificity': 0.9678964, 'f1': 0.948907, 'auroc': 0.9981917, 'binary_precision': 0.86508435, 'binary_recall': 0.94089675, 'binary_specificity': 0.99489605, 'binary_f1_score': 0.9013993}
confusion matrix:
       0     1
0  42104   216
1     87  1385
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.89304096, 'recall': 0.90599597, 'specificity': 0.90599597, 'f1': 0.8994043, 'auroc': 0.9848166, 'binary_precision': 0.7924812, 'binary_recall': 0.81959563, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.80581045}
confusion matrix:
       0    1
0  18011  138
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.830409, 'recall': 0.64275914, 'specificity': 0.64275914, 'f1': 0.6958357, 'auroc': 0.9450486, 'binary_precision': 0.6909091, 'binary_recall': 0.29118773, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40970352}
confusion matrix:
      0   1
0  5963  34
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_18.png
early stop counter: 5
val acc:0.986483633518219, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 18,now: 2024-05-31 23:35:34.839712,epoch time: 0:33:10.315602,used: 9:58:40.601964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99251, 'precision': 0.9202929, 'recall': 0.97514176, 'specificity': 0.97514176, 'f1': 0.94589496, 'auroc': 0.9982961, 'binary_precision': 0.84210527, 'binary_recall': 0.95652175, 'binary_specificity': 0.99376184, 'binary_f1_score': 0.8956743}
confusion matrix:
       0     1
0  42056   264
1     64  1408
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.87995327, 'recall': 0.9038347, 'specificity': 0.9038347, 'f1': 0.8914975, 'auroc': 0.9823793, 'binary_precision': 0.76642334, 'binary_recall': 0.8164852, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.7906626}
confusion matrix:
       0    1
0  17989  160
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.81441605, 'recall': 0.59928143, 'specificity': 0.59928143, 'f1': 0.6457743, 'auroc': 0.9437099, 'binary_precision': 0.6625, 'binary_recall': 0.20306513, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3108504}
confusion matrix:
      0   1
0  5970  27
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_19.png
early stop counter: 6
val acc:0.9852064847946167, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 19,now: 2024-06-01 00:09:00.993690,epoch time: 0:33:26.153978,used: 10:32:06.755942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99522746, 'precision': 0.96854115, 'recall': 0.95714724, 'specificity': 0.95714724, 'f1': 0.9627687, 'auroc': 0.9985071, 'binary_precision': 0.93998605, 'binary_recall': 0.9163265, 'binary_specificity': 0.99796796, 'binary_f1_score': 0.9280055}
confusion matrix:
       0     1
0  42236    86
1    123  1347
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.91432035, 'recall': 0.87377113, 'specificity': 0.87377113, 'f1': 0.8929176, 'auroc': 0.98397684, 'binary_precision': 0.8373702, 'binary_recall': 0.7527216, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.7927928}
confusion matrix:
       0    1
0  18055   94
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8316922, 'recall': 0.58270705, 'specificity': 0.58270705, 'f1': 0.626124, 'auroc': 0.94033414, 'binary_precision': 0.6984127, 'binary_recall': 0.16858238, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.27160496}
confusion matrix:
      0   1
0  5978  19
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_20.png
early stop counter: 7
val acc:0.9865368008613586, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 20,now: 2024-06-01 00:42:41.203759,epoch time: 0:33:40.210069,used: 11:05:46.966011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9923045, 'precision': 0.98539823, 'recall': 0.89405423, 'specificity': 0.89405423, 'f1': 0.93464625, 'auroc': 0.99836934, 'binary_precision': 0.97809607, 'binary_recall': 0.7887228, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.8732607}
confusion matrix:
       0     1
0  42294    26
1    311  1161
---- Validation: 
scalar performance:
{'acc': 0.9825458, 'precision': 0.94453585, 'recall': 0.7726976, 'specificity': 0.7726976, 'f1': 0.8365985, 'auroc': 0.9765779, 'binary_precision': 0.90488434, 'binary_recall': 0.5474339, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.68217057}
confusion matrix:
       0    1
0  18112   37
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.86963034, 'recall': 0.5397296, 'specificity': 0.5397296, 'f1': 0.5628578, 'auroc': 0.9170772, 'binary_precision': 0.7777778, 'binary_recall': 0.08045977, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.14583334}
confusion matrix:
      0   1
0  5991   6
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_21.png
early stop counter: 8
val acc:0.982545793056488, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 21,now: 2024-06-01 01:16:23.592244,epoch time: 0:33:42.388485,used: 11:39:29.354496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9951361, 'precision': 0.98439205, 'recall': 0.9394524, 'specificity': 0.9394524, 'f1': 0.9607488, 'auroc': 0.99912906, 'binary_precision': 0.97295266, 'binary_recall': 0.87975544, 'binary_specificity': 0.9991493, 'binary_f1_score': 0.92401}
confusion matrix:
       0     1
0  42284    36
1    177  1295
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9492012, 'recall': 0.82390934, 'specificity': 0.82390934, 'f1': 0.8756647, 'auroc': 0.98107016, 'binary_precision': 0.9106754, 'binary_recall': 0.65007776, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.75862074}
confusion matrix:
       0    1
0  18108   41
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.93993497, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_22.png
early stop counter: 9
val acc:0.9858450293540955, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 22,now: 2024-06-01 01:49:53.382365,epoch time: 0:33:29.790121,used: 12:12:59.144617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9953188, 'precision': 0.9547436, 'recall': 0.97528356, 'specificity': 0.97528356, 'f1': 0.96476877, 'auroc': 0.99897194, 'binary_precision': 0.9110967, 'binary_recall': 0.9538044, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.93196154}
confusion matrix:
       0     1
0  42183   137
1     68  1404
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.89965695, 'recall': 0.8870517, 'specificity': 0.8870517, 'f1': 0.8932448, 'auroc': 0.982988, 'binary_precision': 0.80707395, 'binary_recall': 0.7807154, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.7936759}
confusion matrix:
       0    1
0  18029  120
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.848326, 'recall': 0.6639153, 'specificity': 0.6639153, 'f1': 0.7198174, 'auroc': 0.95028883, 'binary_precision': 0.725, 'binary_recall': 0.33333334, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.4566929}
confusion matrix:
      0   1
0  5964  33
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_23.png
early stop counter: 10
val acc:0.9861111044883728, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 23,now: 2024-06-01 02:23:54.636030,epoch time: 0:34:01.253665,used: 12:47:00.398282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.9489238, 'recall': 0.97097635, 'specificity': 0.97097635, 'f1': 0.9596646, 'auroc': 0.9989668, 'binary_precision': 0.8997413, 'binary_recall': 0.94561523, 'binary_specificity': 0.99633753, 'binary_f1_score': 0.9221081}
confusion matrix:
       0     1
0  42166   155
1     80  1391
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.90912116, 'recall': 0.8820493, 'specificity': 0.8820493, 'f1': 0.89508367, 'auroc': 0.9783431, 'binary_precision': 0.8263773, 'binary_recall': 0.7698289, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.79710144}
confusion matrix:
       0    1
0  18045  104
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8390968, 'recall': 0.6373455, 'specificity': 0.6373455, 'f1': 0.69157976, 'auroc': 0.9334014, 'binary_precision': 0.70873785, 'binary_recall': 0.27969348, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.4010989}
confusion matrix:
      0   1
0  5967  30
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_24.png
early stop counter: 11
val acc:0.9865900278091431, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 24,now: 2024-06-01 02:57:38.829108,epoch time: 0:33:44.193078,used: 13:20:44.591360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9933778, 'precision': 0.93617266, 'recall': 0.96641064, 'specificity': 0.96641064, 'f1': 0.95074373, 'auroc': 0.99830186, 'binary_precision': 0.8745247, 'binary_recall': 0.9375, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.904918}
confusion matrix:
       0     1
0  42122   198
1     92  1380
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.88264203, 'recall': 0.88091975, 'specificity': 0.88091975, 'f1': 0.88177884, 'auroc': 0.977914, 'binary_precision': 0.7734375, 'binary_recall': 0.7698289, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.77162904}
confusion matrix:
       0    1
0  18004  145
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75766563, 'recall': 0.5184901, 'specificity': 0.5184901, 'f1': 0.5252596, 'auroc': 0.92579144, 'binary_precision': 0.5555556, 'binary_recall': 0.038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5989   8
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_25.png
early stop counter: 12
val acc:0.9844082593917847, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 25,now: 2024-06-01 03:31:33.171911,epoch time: 0:33:54.342803,used: 13:54:38.934163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9959353, 'precision': 0.9612587, 'recall': 0.9775697, 'specificity': 0.9775697, 'f1': 0.9692613, 'auroc': 0.9994559, 'binary_precision': 0.9239843, 'binary_recall': 0.95788044, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.94062704}
confusion matrix:
       0     1
0  42204   116
1     62  1410
---- Validation: 
scalar performance:
{'acc': 0.9885057, 'precision': 0.9160373, 'recall': 0.908543, 'specificity': 0.908543, 'f1': 0.9122532, 'auroc': 0.9809991, 'binary_precision': 0.83835185, 'binary_recall': 0.82270604, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.8304552}
confusion matrix:
       0    1
0  18047  102
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8995377, 'recall': 0.6385961, 'specificity': 0.6385961, 'f1': 0.7008268, 'auroc': 0.93623126, 'binary_precision': 0.82954544, 'binary_recall': 0.27969348, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.41833812}
confusion matrix:
      0   1
0  5982  15
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_26.png
better model found
persisted
after epoch: 26,now: 2024-06-01 04:05:07.091014,epoch time: 0:33:33.919103,used: 14:28:12.853266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9960952, 'precision': 0.96636117, 'recall': 0.97401226, 'specificity': 0.97401226, 'f1': 0.97015315, 'auroc': 0.9991388, 'binary_precision': 0.9344482, 'binary_recall': 0.95034015, 'binary_specificity': 0.9976844, 'binary_f1_score': 0.9423272}
confusion matrix:
       0     1
0  42224    98
1     73  1397
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.90411913, 'recall': 0.88954985, 'specificity': 0.88954985, 'f1': 0.89668953, 'auroc': 0.97656757, 'binary_precision': 0.81583196, 'binary_recall': 0.785381, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.800317}
confusion matrix:
       0    1
0  18035  114
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.85718924, 'recall': 0.63776237, 'specificity': 0.63776237, 'f1': 0.6945822, 'auroc': 0.9228052, 'binary_precision': 0.74489796, 'binary_recall': 0.27969348, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.40668523}
confusion matrix:
      0   1
0  5972  25
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_27.png
early stop counter: 1
val acc:0.9865900278091431, best validation acc: 0.9885057210922241, corresponding to test acc:                         0.9675615429878235 / 0.9728347659111023
after epoch: 27,now: 2024-06-01 04:38:40.158346,epoch time: 0:33:33.067332,used: 15:01:45.920598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99627787, 'precision': 0.9867941, 'recall': 0.9550944, 'specificity': 0.9550944, 'f1': 0.9703713, 'auroc': 0.99947643, 'binary_precision': 0.9766764, 'binary_recall': 0.91094494, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.9426662}
confusion matrix:
       0     1
0  42289    32
1    131  1340
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.94434726, 'recall': 0.862459, 'specificity': 0.862459, 'f1': 0.89893174, 'auroc': 0.9842205, 'binary_precision': 0.8982726, 'binary_recall': 0.7278383, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.80412376}
confusion matrix:
       0    1
0  18096   53
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8755845, 'recall': 0.5700475, 'specificity': 0.5700475, 'f1': 0.610546, 'auroc': 0.9466529, 'binary_precision': 0.78723407, 'binary_recall': 0.14176245, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.24025974}
confusion matrix:
      0   1
0  5987  10
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_28.png
early stop counter: 2
val acc:0.9878671765327454, best validation acc: 0.9885057210922241, corresponding to test acc:                         0.9675615429878235 / 0.9728347659111023
after epoch: 28,now: 2024-06-01 05:12:00.897375,epoch time: 0:33:20.739029,used: 15:35:06.659627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9947479, 'precision': 0.9606845, 'recall': 0.95826733, 'specificity': 0.95826733, 'f1': 0.9594725, 'auroc': 0.99894655, 'binary_precision': 0.9241803, 'binary_recall': 0.9191576, 'binary_specificity': 0.9973771, 'binary_f1_score': 0.9216621}
confusion matrix:
       0     1
0  42209   111
1    119  1353
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.91175663, 'recall': 0.878299, 'specificity': 0.878299, 'f1': 0.8942611, 'auroc': 0.98121005, 'binary_precision': 0.8319185, 'binary_recall': 0.7620529, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.79545456}
confusion matrix:
       0    1
0  18050   99
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8135368, 'recall': 0.63667846, 'specificity': 0.63667846, 'f1': 0.68693155, 'auroc': 0.9337651, 'binary_precision': 0.6576577, 'binary_recall': 0.27969348, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.39247313}
confusion matrix:
      0   1
0  5959  38
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_29.png
early stop counter: 3
val acc:0.9865900278091431, best validation acc: 0.9885057210922241, corresponding to test acc:                         0.9675615429878235 / 0.9728347659111023
after epoch: 29,now: 2024-06-01 05:45:36.108881,epoch time: 0:33:35.211506,used: 16:08:41.871133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.995707, 'precision': 0.9904635, 'recall': 0.9426597, 'specificity': 0.9426597, 'f1': 0.9652478, 'auroc': 0.9991281, 'binary_precision': 0.98488283, 'binary_recall': 0.88579196, 'binary_specificity': 0.9995274, 'binary_f1_score': 0.9327129}
confusion matrix:
       0     1
0  42301    20
1    168  1303
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.951137, 'recall': 0.83635104, 'specificity': 0.83635104, 'f1': 0.8847654, 'auroc': 0.97641397, 'binary_precision': 0.9136842, 'binary_recall': 0.6749611, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.77638644}
confusion matrix:
       0    1
0  18108   41
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8777254, 'recall': 0.6192723, 'specificity': 0.6192723, 'f1': 0.6759212, 'auroc': 0.93969923, 'binary_precision': 0.7875, 'binary_recall': 0.2413793, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3695015}
confusion matrix:
      0   1
0  5980  17
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_30.png
early stop counter: 4
val acc:0.9866964817047119, best validation acc: 0.9885057210922241, corresponding to test acc:                         0.9675615429878235 / 0.9728347659111023
after epoch: 30,now: 2024-06-01 06:18:31.157018,epoch time: 0:32:55.048137,used: 16:41:36.919270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_36_54_seed_0_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:41:36.919270 at 2024-06-01 06:18:31.157018
persisted model performance metric: 

scalar performance:
{'acc': 0.96596354, 'precision': 0.8596641, 'recall': 0.63593006, 'specificity': 0.63593006, 'f1': 0.69292176, 'auroc': 0.9357126, 'binary_precision': 0.75, 'binary_recall': 0.27586207, 'binary_specificity': 0.995998, 'binary_f1_score': 0.40336132}
confusion matrix:
      0   1
0  5973  24
1   189  72
oracle model performance metric: 

scalar performance:
{'acc': 0.97267497, 'precision': 0.8811755, 'recall': 0.73471314, 'specificity': 0.73471314, 'f1': 0.78887486, 'auroc': 0.96555555, 'binary_precision': 0.7848101, 'binary_recall': 0.47509578, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.59188545}
confusion matrix:
      0    1
0  5963   34
1   137  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 463465 GiB | 463464 GiB |
|       from large pool | 417040 KiB |    849 MiB | 450564 GiB | 450564 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2874    |   88038 K  |   88038 K  |
|       from large pool |     112    |     508    |   45005 K  |   45005 K  |
|       from small pool |      35    |    2761    |   43033 K  |   43033 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   88039 K  |   88039 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   43034 K  |   43034 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2874    |   88039 K  |   88039 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2761    |   43034 K  |   43034 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741

 Experiment start at: 2024-06-01 06:31:00.129738
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96782655, 'precision': 0.7489505, 'recall': 0.8477107, 'specificity': 0.8477107, 'f1': 0.7891848, 'auroc': 0.95954025, 'binary_precision': 0.5075869, 'binary_recall': 0.7191401, 'binary_specificity': 0.9762814, 'binary_f1_score': 0.595122}
confusion matrix:
       0     1
0  41408  1006
1    405  1037
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7502961, 'recall': 0.8367845, 'specificity': 0.8367845, 'f1': 0.786342, 'auroc': 0.9590758, 'binary_precision': 0.51198256, 'binary_recall': 0.6983655, 'binary_specificity': 0.9752034, 'binary_f1_score': 0.5908233}
confusion matrix:
       0    1
0  17619  448
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9772801, 'precision': 0.9419007, 'recall': 0.75459194, 'specificity': 0.75459194, 'f1': 0.8209088, 'auroc': 0.94416237, 'binary_precision': 0.9047619, 'binary_recall': 0.51153845, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.65356266}
confusion matrix:
      0    1
0  5932   14
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 07:05:50.833193,epoch time: 0:34:50.703455,used: 0:34:50.703455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97149765, 'precision': 0.8776642, 'recall': 0.5913607, 'specificity': 0.5913607, 'f1': 0.6419971, 'auroc': 0.9724695, 'binary_precision': 0.7823529, 'binary_recall': 0.18446602, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.29854095}
confusion matrix:
       0    1
0  42340   74
1   1176  266
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.9435856, 'recall': 0.5821898, 'specificity': 0.5821898, 'f1': 0.6320026, 'auroc': 0.9705945, 'binary_precision': 0.91735536, 'binary_recall': 0.16493313, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.27959698}
confusion matrix:
       0    1
0  18057   10
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9545302, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_2.png
better model found
persisted
after epoch: 2,now: 2024-06-01 07:39:24.135461,epoch time: 0:33:33.302268,used: 1:08:24.005723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9784522, 'precision': 0.9214306, 'recall': 0.70361084, 'specificity': 0.70361084, 'f1': 0.7721263, 'auroc': 0.974769, 'binary_precision': 0.8625731, 'binary_recall': 0.4094379, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.5552941}
confusion matrix:
       0    1
0  42321   94
1    851  590
---- Validation: 
scalar performance:
{'acc': 0.97588044, 'precision': 0.9549004, 'recall': 0.67634976, 'specificity': 0.67634976, 'f1': 0.7502825, 'auroc': 0.9728428, 'binary_precision': 0.93333334, 'binary_recall': 0.3536404, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.51293105}
confusion matrix:
       0    1
0  18050   17
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94653296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_3.png
better model found
persisted
after epoch: 3,now: 2024-06-01 08:12:35.011063,epoch time: 0:33:10.875602,used: 1:41:34.881325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97886264, 'precision': 0.83244437, 'recall': 0.83800864, 'specificity': 0.83800864, 'f1': 0.83520126, 'auroc': 0.97963285, 'binary_precision': 0.6755283, 'binary_recall': 0.68723994, 'binary_specificity': 0.9887773, 'binary_f1_score': 0.68133384}
confusion matrix:
       0    1
0  41938  476
1    451  991
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.868366, 'recall': 0.8169658, 'specificity': 0.8169658, 'f1': 0.84056354, 'auroc': 0.9756258, 'binary_precision': 0.75, 'binary_recall': 0.6419019, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.6917533}
confusion matrix:
       0    1
0  17923  144
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8956351, 'recall': 0.6485705, 'specificity': 0.6485705, 'f1': 0.71146584, 'auroc': 0.95649743, 'binary_precision': 0.8210526, 'binary_recall': 0.3, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.4394366}
confusion matrix:
      0   1
0  5929  17
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_4.png
better model found
persisted
after epoch: 4,now: 2024-06-01 08:45:47.095687,epoch time: 0:33:12.084624,used: 2:14:46.965949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9791363, 'precision': 0.81695795, 'recall': 0.91083467, 'specificity': 0.91083467, 'f1': 0.857232, 'auroc': 0.9872103, 'binary_precision': 0.6394918, 'binary_recall': 0.8377254, 'binary_specificity': 0.983944, 'binary_f1_score': 0.7253077}
confusion matrix:
       0     1
0  41733   681
1    234  1208
---- Validation: 
scalar performance:
{'acc': 0.9779082, 'precision': 0.8243445, 'recall': 0.8969884, 'specificity': 0.8969884, 'f1': 0.85661316, 'auroc': 0.97649395, 'binary_precision': 0.65583634, 'binary_recall': 0.8098068, 'binary_specificity': 0.98417, 'binary_f1_score': 0.72473407}
confusion matrix:
       0    1
0  17781  286
1    128  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.82562053, 'recall': 0.6676221, 'specificity': 0.6676221, 'f1': 0.718762, 'auroc': 0.96181077, 'binary_precision': 0.6793893, 'binary_recall': 0.3423077, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.45524293}
confusion matrix:
      0   1
0  5904  42
1   171  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_5.png
early stop counter: 1
val acc:0.977908194065094, best validation acc: 0.9794557094573975, corresponding to test acc:                         0.967934250831604 / 0.9772800803184509
after epoch: 5,now: 2024-06-01 09:19:12.711023,epoch time: 0:33:25.615336,used: 2:48:12.581285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9855436, 'precision': 0.8775281, 'recall': 0.9037638, 'specificity': 0.9037638, 'f1': 0.8901674, 'auroc': 0.98750836, 'binary_precision': 0.7613195, 'binary_recall': 0.81622744, 'binary_specificity': 0.99130005, 'binary_f1_score': 0.78781796}
confusion matrix:
       0     1
0  42045   369
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.8924302, 'recall': 0.8693592, 'specificity': 0.8693592, 'f1': 0.880514, 'auroc': 0.97904587, 'binary_precision': 0.7943038, 'binary_recall': 0.7459138, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.7693486}
confusion matrix:
       0    1
0  17937  130
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8553118, 'recall': 0.58335406, 'specificity': 0.58335406, 'f1': 0.62838006, 'auroc': 0.95411706, 'binary_precision': 0.7457627, 'binary_recall': 0.16923077, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5931  15
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_6.png
better model found
persisted
after epoch: 6,now: 2024-06-01 09:52:22.006232,epoch time: 0:33:09.295209,used: 3:21:21.876494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98750454, 'precision': 0.9092642, 'recall': 0.8900397, 'specificity': 0.8900397, 'f1': 0.89940226, 'auroc': 0.9912901, 'binary_precision': 0.82580173, 'binary_recall': 0.78571427, 'binary_specificity': 0.9943651, 'binary_f1_score': 0.80525935}
confusion matrix:
       0     1
0  42175   239
1    309  1133
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.9224992, 'recall': 0.85437053, 'specificity': 0.85437053, 'f1': 0.8851992, 'auroc': 0.98177487, 'binary_precision': 0.85561496, 'binary_recall': 0.71322435, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7779578}
confusion matrix:
       0    1
0  17986   81
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.82164395, 'recall': 0.5640392, 'specificity': 0.5640392, 'f1': 0.59967905, 'auroc': 0.955255, 'binary_precision': 0.68, 'binary_recall': 0.13076924, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.21935484}
confusion matrix:
      0   1
0  5930  16
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_7.png
better model found
persisted
after epoch: 7,now: 2024-06-01 10:25:42.718921,epoch time: 0:33:20.712689,used: 3:54:42.589183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98584, 'precision': 0.9419364, 'recall': 0.82084894, 'specificity': 0.82084894, 'f1': 0.87110496, 'auroc': 0.99217975, 'binary_precision': 0.8958534, 'binary_recall': 0.64424413, 'binary_specificity': 0.9974537, 'binary_f1_score': 0.7494958}
confusion matrix:
       0    1
0  42306  108
1    513  929
---- Validation: 
scalar performance:
{'acc': 0.97998935, 'precision': 0.9230057, 'recall': 0.7614517, 'specificity': 0.7614517, 'f1': 0.8217183, 'auroc': 0.97680813, 'binary_precision': 0.86341465, 'binary_recall': 0.52600294, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.6537396}
confusion matrix:
       0    1
0  18011   56
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9508759, 'recall': 0.5306851, 'specificity': 0.5306851, 'f1': 0.5476669, 'auroc': 0.94640785, 'binary_precision': 0.9411765, 'binary_recall': 0.06153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.11552346}
confusion matrix:
      0   1
0  5945   1
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_8.png
early stop counter: 1
val acc:0.9799893498420715, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 8,now: 2024-06-01 10:59:02.033605,epoch time: 0:33:19.314684,used: 4:28:01.903867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9878238, 'precision': 0.8838135, 'recall': 0.94312716, 'specificity': 0.94312716, 'f1': 0.911157, 'auroc': 0.99401045, 'binary_precision': 0.7712067, 'binary_recall': 0.89528435, 'binary_specificity': 0.99096996, 'binary_f1_score': 0.82862645}
confusion matrix:
       0     1
0  42031   383
1    151  1291
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.86203897, 'recall': 0.87961346, 'specificity': 0.87961346, 'f1': 0.8705978, 'auroc': 0.97872645, 'binary_precision': 0.7326733, 'binary_recall': 0.76968795, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.7507246}
confusion matrix:
       0    1
0  17878  189
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.75251496, 'recall': 0.603656, 'specificity': 0.603656, 'f1': 0.64338803, 'auroc': 0.9628252, 'binary_precision': 0.53846157, 'binary_recall': 0.21538462, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.30769232}
confusion matrix:
      0   1
0  5898  48
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_9.png
early stop counter: 2
val acc:0.981643557548523, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 9,now: 2024-06-01 11:32:20.911582,epoch time: 0:33:18.877977,used: 5:01:20.781844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98618203, 'precision': 0.8985652, 'recall': 0.8793074, 'specificity': 0.8793074, 'f1': 0.8886786, 'auroc': 0.9914415, 'binary_precision': 0.8051095, 'binary_recall': 0.76490986, 'binary_specificity': 0.9937049, 'binary_f1_score': 0.78449506}
confusion matrix:
       0     1
0  42147   267
1    339  1103
---- Validation: 
scalar performance:
{'acc': 0.980683, 'precision': 0.88301504, 'recall': 0.81903285, 'specificity': 0.81903285, 'f1': 0.8478524, 'auroc': 0.97354114, 'binary_precision': 0.77917415, 'binary_recall': 0.6448737, 'binary_specificity': 0.993192, 'binary_f1_score': 0.70569104}
confusion matrix:
       0    1
0  17944  123
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.80929554, 'recall': 0.6389441, 'specificity': 0.6389441, 'f1': 0.68847406, 'auroc': 0.94983846, 'binary_precision': 0.64912283, 'binary_recall': 0.2846154, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.39572194}
confusion matrix:
      0   1
0  5906  40
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_10.png
early stop counter: 3
val acc:0.9806830286979675, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 10,now: 2024-06-01 12:06:12.368538,epoch time: 0:33:51.456956,used: 5:35:12.238800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9889639, 'precision': 0.9278777, 'recall': 0.89280385, 'specificity': 0.89280385, 'f1': 0.9095336, 'auroc': 0.99320745, 'binary_precision': 0.8628788, 'binary_recall': 0.78987515, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.82476467}
confusion matrix:
       0     1
0  42233   181
1    303  1139
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.92893445, 'recall': 0.83984375, 'specificity': 0.83984375, 'f1': 0.87880886, 'auroc': 0.9762714, 'binary_precision': 0.8695652, 'binary_recall': 0.68350667, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.765391}
confusion matrix:
       0    1
0  17998   69
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.88001215, 'recall': 0.5741591, 'specificity': 0.5741591, 'f1': 0.61667055, 'auroc': 0.95900154, 'binary_precision': 0.79591835, 'binary_recall': 0.15, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2524272}
confusion matrix:
      0   1
0  5936  10
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_11.png
early stop counter: 4
val acc:0.9849519729614258, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 11,now: 2024-06-01 12:45:29.491625,epoch time: 0:39:17.123087,used: 6:14:29.361887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98638725, 'precision': 0.86893535, 'recall': 0.9447291, 'specificity': 0.9447291, 'f1': 0.9029825, 'auroc': 0.9935116, 'binary_precision': 0.7412907, 'binary_recall': 0.9001387, 'binary_specificity': 0.98931956, 'binary_f1_score': 0.81302845}
confusion matrix:
       0     1
0  41961   453
1    144  1298
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.8632364, 'recall': 0.89430624, 'specificity': 0.89430624, 'f1': 0.8780719, 'auroc': 0.97404766, 'binary_precision': 0.73397, 'binary_recall': 0.79940563, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.7652916}
confusion matrix:
       0    1
0  17872  195
1    135  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.9003284, 'recall': 0.68293357, 'specificity': 0.68293357, 'f1': 0.7476754, 'auroc': 0.9585465, 'binary_precision': 0.82758623, 'binary_recall': 0.36923078, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.5106383}
confusion matrix:
      0   1
0  5926  20
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_12.png
early stop counter: 5
val acc:0.9823905825614929, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 12,now: 2024-06-01 13:25:12.433949,epoch time: 0:39:42.942324,used: 6:54:12.304211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9911985, 'precision': 0.9670321, 'recall': 0.88960475, 'specificity': 0.88960475, 'f1': 0.92456985, 'auroc': 0.9963373, 'binary_precision': 0.9414716, 'binary_recall': 0.7808599, 'binary_specificity': 0.9983496, 'binary_f1_score': 0.853677}
confusion matrix:
       0     1
0  42344    70
1    316  1126
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.9242811, 'recall': 0.81018144, 'specificity': 0.81018144, 'f1': 0.85766363, 'auroc': 0.96949404, 'binary_precision': 0.862423, 'binary_recall': 0.6240713, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.7241379}
confusion matrix:
       0    1
0  18000   67
1    253  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8118185, 'recall': 0.5939675, 'specificity': 0.5939675, 'f1': 0.6390381, 'auroc': 0.9446274, 'binary_precision': 0.65789473, 'binary_recall': 0.1923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.29761904}
confusion matrix:
      0   1
0  5920  26
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_13.png
early stop counter: 6
val acc:0.982924222946167, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 13,now: 2024-06-01 14:04:53.432475,epoch time: 0:39:40.998526,used: 7:33:53.302737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9908108, 'precision': 0.95740616, 'recall': 0.8924189, 'specificity': 0.8924189, 'f1': 0.92224705, 'auroc': 0.9961848, 'binary_precision': 0.9220146, 'binary_recall': 0.78710127, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.8492331}
confusion matrix:
       0     1
0  42318    96
1    307  1135
---- Validation: 
scalar performance:
{'acc': 0.9815368, 'precision': 0.9211993, 'recall': 0.78943443, 'specificity': 0.78943443, 'f1': 0.8421433, 'auroc': 0.9727521, 'binary_precision': 0.85776806, 'binary_recall': 0.58246654, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.6938052}
confusion matrix:
       0    1
0  18002   65
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8404506, 'recall': 0.57181555, 'specificity': 0.57181555, 'f1': 0.61161155, 'auroc': 0.94768864, 'binary_precision': 0.7169811, 'binary_recall': 0.14615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.24281152}
confusion matrix:
      0   1
0  5931  15
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_14.png
early stop counter: 7
val acc:0.9815368056297302, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 14,now: 2024-06-01 14:43:31.204680,epoch time: 0:38:37.772205,used: 8:12:31.074942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.985612, 'precision': 0.87639606, 'recall': 0.90781856, 'specificity': 0.90781856, 'f1': 0.8914231, 'auroc': 0.99434793, 'binary_precision': 0.75877476, 'binary_recall': 0.82454926, 'binary_specificity': 0.99108785, 'binary_f1_score': 0.79029584}
confusion matrix:
       0     1
0  42036   378
1    253  1189
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.9046562, 'recall': 0.83529884, 'specificity': 0.83529884, 'f1': 0.866451, 'auroc': 0.9736986, 'binary_precision': 0.8212996, 'binary_recall': 0.67607725, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.74164623}
confusion matrix:
       0    1
0  17968   99
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.89469004, 'recall': 0.5457334, 'specificity': 0.5457334, 'f1': 0.5731052, 'auroc': 0.94303715, 'binary_precision': 0.82758623, 'binary_recall': 0.092307694, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.16608997}
confusion matrix:
      0   1
0  5941   5
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_15.png
early stop counter: 8
val acc:0.9830843210220337, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 15,now: 2024-06-01 15:22:42.302785,epoch time: 0:39:11.098105,used: 8:51:42.173047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9920877, 'precision': 0.93642235, 'recall': 0.9396374, 'specificity': 0.9396374, 'f1': 0.9380235, 'auroc': 0.9966188, 'binary_precision': 0.8768066, 'binary_recall': 0.88349515, 'binary_specificity': 0.9957797, 'binary_f1_score': 0.88013816}
confusion matrix:
       0     1
0  42235   179
1    168  1274
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.89674276, 'recall': 0.8379385, 'specificity': 0.8379385, 'f1': 0.8647835, 'auroc': 0.9741751, 'binary_precision': 0.80526316, 'binary_recall': 0.6820208, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.73853576}
confusion matrix:
       0    1
0  17956  111
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.86592364, 'recall': 0.58728427, 'specificity': 0.58728427, 'f1': 0.6343223, 'auroc': 0.94580597, 'binary_precision': 0.76666665, 'binary_recall': 0.17692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.2875}
confusion matrix:
      0   1
0  5932  14
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_16.png
early stop counter: 9
val acc:0.9826574325561523, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 16,now: 2024-06-01 16:01:57.597686,epoch time: 0:39:15.294901,used: 9:30:57.467948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9907196, 'precision': 0.9372467, 'recall': 0.9134737, 'specificity': 0.9134737, 'f1': 0.9250026, 'auroc': 0.9942003, 'binary_precision': 0.88023514, 'binary_recall': 0.8307906, 'binary_specificity': 0.99615693, 'binary_f1_score': 0.85479844}
confusion matrix:
       0     1
0  42251   163
1    244  1198
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.9240026, 'recall': 0.8204996, 'specificity': 0.8204996, 'f1': 0.86447823, 'auroc': 0.96087176, 'binary_precision': 0.8611111, 'binary_recall': 0.6448737, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.7374681}
confusion matrix:
       0    1
0  17997   70
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.63850415, 'recall': 0.5226455, 'specificity': 0.5226455, 'f1': 0.53183603, 'auroc': 0.89075786, 'binary_precision': 0.31707317, 'binary_recall': 0.05, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.08637874}
confusion matrix:
      0   1
0  5918  28
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_17.png
early stop counter: 10
val acc:0.983511209487915, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 17,now: 2024-06-01 16:40:03.557011,epoch time: 0:38:05.959325,used: 10:09:03.427273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99074244, 'precision': 0.9645025, 'recall': 0.8843447, 'specificity': 0.8843447, 'f1': 0.92036915, 'auroc': 0.9966928, 'binary_precision': 0.9367622, 'binary_recall': 0.7704577, 'binary_specificity': 0.9982317, 'binary_f1_score': 0.84550995}
confusion matrix:
       0     1
0  42339    75
1    331  1111
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.94403005, 'recall': 0.8070756, 'specificity': 0.8070756, 'f1': 0.86211604, 'auroc': 0.97718716, 'binary_precision': 0.90217394, 'binary_recall': 0.6166419, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.7325684}
confusion matrix:
       0    1
0  18022   45
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.87205005, 'recall': 0.574075, 'specificity': 0.574075, 'f1': 0.61622125, 'auroc': 0.9373396, 'binary_precision': 0.78, 'binary_recall': 0.15, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2516129}
confusion matrix:
      0   1
0  5935  11
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_18.png
early stop counter: 11
val acc:0.9838314056396484, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.961005449295044 / 0.9772800803184509
after epoch: 18,now: 2024-06-01 17:12:22.654201,epoch time: 0:32:19.097190,used: 10:41:22.524463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9938891, 'precision': 0.9456817, 'recall': 0.959996, 'specificity': 0.959996, 'f1': 0.9527169, 'auroc': 0.9976955, 'binary_precision': 0.89395976, 'binary_recall': 0.9237171, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.9085949}
confusion matrix:
       0     1
0  42256   158
1    110  1332
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.9058329, 'recall': 0.8942084, 'specificity': 0.8942084, 'f1': 0.8999287, 'auroc': 0.9777371, 'binary_precision': 0.8192956, 'binary_recall': 0.794948, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.80693823}
confusion matrix:
       0    1
0  17949  118
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8081886, 'recall': 0.6145327, 'specificity': 0.6145327, 'f1': 0.6626962, 'auroc': 0.9456978, 'binary_precision': 0.64893615, 'binary_recall': 0.23461539, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.34463277}
confusion matrix:
      0   1
0  5913  33
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_19.png
better model found
persisted
after epoch: 19,now: 2024-06-01 17:44:11.127855,epoch time: 0:31:48.473654,used: 11:13:10.998117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99347866, 'precision': 0.9372504, 'recall': 0.96413815, 'specificity': 0.96413815, 'f1': 0.9502613, 'auroc': 0.9977898, 'binary_precision': 0.87679267, 'binary_recall': 0.93273234, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.9038978}
confusion matrix:
       0     1
0  42225   189
1     97  1345
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.9063284, 'recall': 0.89643717, 'specificity': 0.89643717, 'f1': 0.9013164, 'auroc': 0.97030795, 'binary_precision': 0.82012194, 'binary_recall': 0.79940563, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.8096313}
confusion matrix:
       0    1
0  17949  118
1    135  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.85121965, 'recall': 0.6154577, 'specificity': 0.6154577, 'f1': 0.66868687, 'auroc': 0.95034254, 'binary_precision': 0.73493975, 'binary_recall': 0.23461539, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.35568514}
confusion matrix:
      0   1
0  5924  22
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_20.png
better model found
persisted
after epoch: 20,now: 2024-06-01 18:16:14.357540,epoch time: 0:32:03.229685,used: 11:45:14.227802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99455035, 'precision': 0.94981587, 'recall': 0.96636695, 'specificity': 0.96636695, 'f1': 0.95793027, 'auroc': 0.99787414, 'binary_precision': 0.9018036, 'binary_recall': 0.9361997, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.91867983}
confusion matrix:
       0     1
0  42267   147
1     92  1350
---- Validation: 
scalar performance:
{'acc': 0.98580575, 'precision': 0.8950231, 'recall': 0.90179956, 'specificity': 0.90179956, 'f1': 0.89837986, 'auroc': 0.97332376, 'binary_precision': 0.7970803, 'binary_recall': 0.8112927, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.8041237}
confusion matrix:
       0    1
0  17928  139
1    127  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.82929766, 'recall': 0.6846775, 'specificity': 0.6846775, 'f1': 0.7345577, 'auroc': 0.9408702, 'binary_precision': 0.6853147, 'binary_recall': 0.37692308, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.4863524}
confusion matrix:
      0   1
0  5901  45
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_21.png
early stop counter: 1
val acc:0.9858057498931885, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 21,now: 2024-06-01 18:48:11.946501,epoch time: 0:31:57.588961,used: 12:17:11.816763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.994824, 'precision': 0.9586084, 'recall': 0.9601443, 'specificity': 0.9601443, 'f1': 0.9593749, 'auroc': 0.9987335, 'binary_precision': 0.91983414, 'binary_recall': 0.9230236, 'binary_specificity': 0.99726504, 'binary_f1_score': 0.92142606}
confusion matrix:
       0     1
0  42298   116
1    111  1331
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9126308, 'recall': 0.8812505, 'specificity': 0.8812505, 'f1': 0.8962667, 'auroc': 0.9734203, 'binary_precision': 0.83387095, 'binary_recall': 0.76820207, 'binary_specificity': 0.994299, 'binary_f1_score': 0.79969066}
confusion matrix:
       0    1
0  17964  103
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.80953157, 'recall': 0.5713951, 'specificity': 0.5713951, 'f1': 0.6094919, 'auroc': 0.922299, 'binary_precision': 0.6551724, 'binary_recall': 0.14615385, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.23899372}
confusion matrix:
      0   1
0  5926  20
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_22.png
early stop counter: 2
val acc:0.9861792922019958, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 22,now: 2024-06-01 19:20:15.835522,epoch time: 0:32:03.889021,used: 12:49:15.705784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99464154, 'precision': 0.97175515, 'recall': 0.9422976, 'specificity': 0.9422976, 'f1': 0.9565168, 'auroc': 0.998739, 'binary_precision': 0.94736844, 'binary_recall': 0.8862691, 'binary_specificity': 0.998326, 'binary_f1_score': 0.91580087}
confusion matrix:
       0     1
0  42343    71
1    164  1278
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.9219705, 'recall': 0.8373935, 'specificity': 0.8373935, 'f1': 0.87458587, 'auroc': 0.9714211, 'binary_precision': 0.8558052, 'binary_recall': 0.679049, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.75724936}
confusion matrix:
       0    1
0  17990   77
1    216  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8371304, 'recall': 0.59631103, 'specificity': 0.59631103, 'f1': 0.6440946, 'auroc': 0.9336367, 'binary_precision': 0.7083333, 'binary_recall': 0.19615385, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.30722892}
confusion matrix:
      0   1
0  5925  21
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_23.png
early stop counter: 3
val acc:0.9843649864196777, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 23,now: 2024-06-01 19:52:14.023593,epoch time: 0:31:58.188071,used: 13:21:13.893855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.995052, 'precision': 0.97950655, 'recall': 0.94117, 'specificity': 0.94117, 'f1': 0.95948225, 'auroc': 0.99849045, 'binary_precision': 0.962963, 'binary_recall': 0.88349515, 'binary_specificity': 0.99884474, 'binary_f1_score': 0.921519}
confusion matrix:
       0     1
0  42365    49
1    168  1274
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9384872, 'recall': 0.85123694, 'specificity': 0.85123694, 'f1': 0.8896555, 'auroc': 0.97403, 'binary_precision': 0.88785046, 'binary_recall': 0.70579493, 'binary_specificity': 0.996679, 'binary_f1_score': 0.78642386}
confusion matrix:
       0    1
0  18007   60
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8418064, 'recall': 0.56805354, 'specificity': 0.56805354, 'f1': 0.60629594, 'auroc': 0.9150371, 'binary_precision': 0.72, 'binary_recall': 0.13846155, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.23225808}
confusion matrix:
      0   1
0  5932  14
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_24.png
early stop counter: 4
val acc:0.9862326383590698, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 24,now: 2024-06-01 20:23:57.875013,epoch time: 0:31:43.851420,used: 13:52:57.745275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99489236, 'precision': 0.94796824, 'recall': 0.97491753, 'specificity': 0.97491753, 'f1': 0.96101856, 'auroc': 0.9991654, 'binary_precision': 0.8975196, 'binary_recall': 0.95353675, 'binary_specificity': 0.9962984, 'binary_f1_score': 0.9246806}
confusion matrix:
       0     1
0  42257   157
1     67  1375
---- Validation: 
scalar performance:
{'acc': 0.98580575, 'precision': 0.90369004, 'recall': 0.8874942, 'specificity': 0.8874942, 'f1': 0.8954116, 'auroc': 0.97356296, 'binary_precision': 0.8155039, 'binary_recall': 0.781575, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.7981791}
confusion matrix:
       0    1
0  17948  119
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.83004594, 'recall': 0.6187993, 'specificity': 0.6187993, 'f1': 0.6701596, 'auroc': 0.9156967, 'binary_precision': 0.6923077, 'binary_recall': 0.2423077, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3589744}
confusion matrix:
      0   1
0  5918  28
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_25.png
early stop counter: 5
val acc:0.9858057498931885, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 25,now: 2024-06-01 20:55:41.091319,epoch time: 0:31:43.216306,used: 14:24:40.961581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9949608, 'precision': 0.9518912, 'recall': 0.97093356, 'specificity': 0.97093356, 'f1': 0.96120065, 'auroc': 0.99911135, 'binary_precision': 0.9056478, 'binary_recall': 0.945215, 'binary_specificity': 0.99665207, 'binary_f1_score': 0.92500854}
confusion matrix:
       0     1
0  42272   142
1     79  1363
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.9111, 'recall': 0.88634044, 'specificity': 0.88634044, 'f1': 0.8983022, 'auroc': 0.97541803, 'binary_precision': 0.8304279, 'binary_recall': 0.77860326, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.8036809}
confusion matrix:
       0    1
0  17960  107
1    149  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7951515, 'recall': 0.5318514, 'specificity': 0.5318514, 'f1': 0.54880047, 'auroc': 0.869193, 'binary_precision': 0.6296296, 'binary_recall': 0.06538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.118466906}
confusion matrix:
      0   1
0  5936  10
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_26.png
early stop counter: 6
val acc:0.9863393902778625, best validation acc: 0.9864994883537292, corresponding to test acc:                         0.9643893241882324 / 0.9772800803184509
after epoch: 26,now: 2024-06-01 21:28:05.027282,epoch time: 0:32:23.935963,used: 14:57:04.897544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9939575, 'precision': 0.9399667, 'recall': 0.96907496, 'specificity': 0.96907496, 'f1': 0.9540178, 'auroc': 0.9983357, 'binary_precision': 0.8818949, 'binary_recall': 0.94244105, 'binary_specificity': 0.99570894, 'binary_f1_score': 0.9111633}
confusion matrix:
       0     1
0  42232   182
1     83  1359
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.9102776, 'recall': 0.90029025, 'specificity': 0.90029025, 'f1': 0.90521693, 'auroc': 0.9646424, 'binary_precision': 0.8277439, 'binary_recall': 0.80683506, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.8171557}
confusion matrix:
       0    1
0  17954  113
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.79391456, 'recall': 0.58050597, 'specificity': 0.58050597, 'f1': 0.6206436, 'auroc': 0.8375422, 'binary_precision': 0.6231884, 'binary_recall': 0.16538462, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.26139817}
confusion matrix:
      0   1
0  5920  26
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_27.png
better model found
persisted
after epoch: 27,now: 2024-06-01 22:02:00.995914,epoch time: 0:33:55.968632,used: 15:31:00.866176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99498355, 'precision': 0.97317487, 'recall': 0.9464938, 'specificity': 0.9464938, 'f1': 0.95941883, 'auroc': 0.99882805, 'binary_precision': 0.9499264, 'binary_recall': 0.89459085, 'binary_specificity': 0.99839675, 'binary_f1_score': 0.9214286}
confusion matrix:
       0     1
0  42346    68
1    152  1290
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.940938, 'recall': 0.84614706, 'specificity': 0.84614706, 'f1': 0.8873807, 'auroc': 0.96211636, 'binary_precision': 0.89312977, 'binary_recall': 0.69539374, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7819548}
confusion matrix:
       0    1
0  18011   56
1    205  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8051964, 'recall': 0.5450607, 'specificity': 0.5450607, 'f1': 0.57053155, 'auroc': 0.86609244, 'binary_precision': 0.6486486, 'binary_recall': 0.092307694, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5933  13
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_28.png
early stop counter: 1
val acc:0.9860725998878479, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9608443379402161 / 0.9772800803184509
after epoch: 28,now: 2024-06-01 22:33:45.099445,epoch time: 0:31:44.103531,used: 16:02:44.969707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99578166, 'precision': 0.9813153, 'recall': 0.9512608, 'specificity': 0.9512608, 'f1': 0.96576846, 'auroc': 0.9992782, 'binary_precision': 0.96590066, 'binary_recall': 0.9036061, 'binary_specificity': 0.99891543, 'binary_f1_score': 0.93371546}
confusion matrix:
       0     1
0  42368    46
1    139  1303
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9451197, 'recall': 0.84554255, 'specificity': 0.84554255, 'f1': 0.8885664, 'auroc': 0.9775862, 'binary_precision': 0.9015444, 'binary_recall': 0.69390786, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.78421485}
confusion matrix:
       0    1
0  18016   51
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.90043163, 'recall': 0.56864214, 'specificity': 0.56864214, 'f1': 0.60927355, 'auroc': 0.93731695, 'binary_precision': 0.8372093, 'binary_recall': 0.13846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.23762377}
confusion matrix:
      0   1
0  5939   7
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_29.png
early stop counter: 2
val acc:0.9862860441207886, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9608443379402161 / 0.9772800803184509
after epoch: 29,now: 2024-06-01 23:05:31.855060,epoch time: 0:31:46.755615,used: 16:34:31.725322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99669373, 'precision': 0.98195183, 'recall': 0.96546537, 'specificity': 0.96546537, 'f1': 0.9735546, 'auroc': 0.999493, 'binary_precision': 0.9662114, 'binary_recall': 0.93203884, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.94881755}
confusion matrix:
       0     1
0  42367    47
1     98  1344
---- Validation: 
scalar performance:
{'acc': 0.9860192, 'precision': 0.9280118, 'recall': 0.85899425, 'specificity': 0.85899425, 'f1': 0.89022696, 'auroc': 0.9766784, 'binary_precision': 0.8663102, 'binary_recall': 0.72213966, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.78768235}
confusion matrix:
       0    1
0  17992   75
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7119108, 'recall': 0.56386, 'specificity': 0.56386, 'f1': 0.5931531, 'auroc': 0.93591976, 'binary_precision': 0.46052632, 'binary_recall': 0.13461539, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.20833334}
confusion matrix:
      0   1
0  5905  41
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_30.png
early stop counter: 3
val acc:0.9860191941261292, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9608443379402161 / 0.9772800803184509
after epoch: 30,now: 2024-06-01 23:37:23.236294,epoch time: 0:31:51.381234,used: 17:06:23.106556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_06_31_00_seed_1_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:06:23.106556 at 2024-06-01 23:37:23.236294
persisted model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.86386776, 'recall': 0.58536124, 'specificity': 0.58536124, 'f1': 0.6315975, 'auroc': 0.84996605, 'binary_precision': 0.7627119, 'binary_recall': 0.17307693, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.28213164}
confusion matrix:
      0   1
0  5932  14
1   215  45
oracle model performance metric: 

scalar performance:
{'acc': 0.97824687, 'precision': 0.96116126, 'recall': 0.7550965, 'specificity': 0.7550965, 'f1': 0.826051, 'auroc': 0.9350015, 'binary_precision': 0.9432624, 'binary_recall': 0.51153845, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.66334164}
confusion matrix:
      0    1
0  5938    8
1   127  133
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1652 MiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16636 MiB |  16636 MiB |  31178 MiB |  14542 MiB |
|       from large pool |  16608 MiB |  16608 MiB |  31148 MiB |  14540 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436746 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool | 416800 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304911 K  |  304908 K  |
|       from large pool |     247    |     989    |  124200 K  |  124199 K  |
|       from small pool |    3095    |    6116    |  180711 K  |  180708 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304911 K  |  304908 K  |
|       from large pool |     247    |     989    |  124200 K  |  124199 K  |
|       from small pool |    3095    |    6116    |  180711 K  |  180708 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |    1118    |     501    |
|       from large pool |     603    |     603    |    1103    |     500    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2875    |  168389 K  |  168389 K  |
|       from large pool |     109    |     508    |   81873 K  |   81873 K  |
|       from small pool |      35    |    2765    |   86515 K  |   86515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304911 K  |  304911 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180711 K  |  180711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304911 K  |  304911 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180711 K  |  180711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2875    |  168390 K  |  168390 K  |
|       from large pool |       2    |     508    |   81874 K  |   81874 K  |
|       from small pool |       0    |    2765    |   86516 K  |   86516 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  16640 KiB |  15778 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2078 TiB |   2078 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2053 TiB |   2053 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16636 MiB |  31178 MiB |  29092 MiB |
|       from large pool |   2060 MiB |  16608 MiB |  31148 MiB |  29088 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    873 MiB |    901 TiB |    901 TiB |
|       from large pool |  24320 KiB |    869 MiB |    876 TiB |    876 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304911 K  |  304911 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180711 K  |  180711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304911 K  |  304911 K  |
|       from large pool |       2    |     989    |  124200 K  |  124200 K  |
|       from small pool |       0    |    6116    |  180711 K  |  180711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |    1118    |    1002    |
|       from large pool |     103    |     603    |    1103    |    1000    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2875    |  168390 K  |  168390 K  |
|       from large pool |       2    |     508    |   81874 K  |   81874 K  |
|       from small pool |       0    |    2765    |   86516 K  |   86516 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741

 Experiment start at: 2024-06-01 23:49:07.317695
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9717963, 'precision': 0.79160386, 'recall': 0.7699851, 'specificity': 0.7699851, 'f1': 0.7803358, 'auroc': 0.9677021, 'binary_precision': 0.599141, 'binary_recall': 0.55320555, 'binary_specificity': 0.98676467, 'binary_f1_score': 0.5752577}
confusion matrix:
       0    1
0  41751  560
1    676  837
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.7593508, 'recall': 0.71703815, 'specificity': 0.71703815, 'f1': 0.7361285, 'auroc': 0.96403676, 'binary_precision': 0.53692615, 'binary_recall': 0.44684386, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.48776066}
confusion matrix:
       0    1
0  17939  232
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764385, 'precision': 0.88307524, 'recall': 0.76765966, 'specificity': 0.76765966, 'f1': 0.8142034, 'auroc': 0.94682634, 'binary_precision': 0.78443116, 'binary_recall': 0.5413223, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6405868}
confusion matrix:
      0    1
0  5961   36
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 00:22:25.011411,epoch time: 0:33:17.693716,used: 0:33:17.693716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97204727, 'precision': 0.9713229, 'recall': 0.598043, 'specificity': 0.598043, 'f1': 0.6561402, 'auroc': 0.9744904, 'binary_precision': 0.9705882, 'binary_recall': 0.19629875, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.32655305}
confusion matrix:
       0    1
0  42302    9
1   1216  297
---- Validation: 
scalar performance:
{'acc': 0.97134185, 'precision': 0.97096634, 'recall': 0.55476224, 'specificity': 0.55476224, 'f1': 0.59121275, 'auroc': 0.96507645, 'binary_precision': 0.9705882, 'binary_recall': 0.10963455, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.19701491}
confusion matrix:
       0   1
0  18169   2
1    536  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.9583714, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_2.png
better model found
persisted
after epoch: 2,now: 2024-06-02 00:54:34.141587,epoch time: 0:32:09.130176,used: 1:05:26.823892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98126596, 'precision': 0.85845584, 'recall': 0.86188126, 'specificity': 0.86188126, 'f1': 0.86015964, 'auroc': 0.9810833, 'binary_precision': 0.7264398, 'binary_recall': 0.73364174, 'binary_specificity': 0.99012077, 'binary_f1_score': 0.73002297}
confusion matrix:
       0     1
0  41893   418
1    403  1110
---- Validation: 
scalar performance:
{'acc': 0.9765621, 'precision': 0.8124295, 'recall': 0.8064039, 'specificity': 0.8064039, 'f1': 0.80938464, 'auroc': 0.97323114, 'binary_precision': 0.63728815, 'binary_recall': 0.62458473, 'binary_specificity': 0.988223, 'binary_f1_score': 0.6308725}
confusion matrix:
       0    1
0  17957  214
1    226  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.8820659, 'recall': 0.77782345, 'specificity': 0.77782345, 'f1': 0.8209539, 'auroc': 0.9598847, 'binary_precision': 0.7816092, 'binary_recall': 0.56198347, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.65384614}
confusion matrix:
      0    1
0  5959   38
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-02 01:27:17.991958,epoch time: 0:32:43.850371,used: 1:38:10.674263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98126596, 'precision': 0.8910409, 'recall': 0.8048426, 'specificity': 0.8048426, 'f1': 0.8421682, 'auroc': 0.9852639, 'binary_precision': 0.7957265, 'binary_recall': 0.6153338, 'binary_specificity': 0.9943513, 'binary_f1_score': 0.69399923}
confusion matrix:
       0    1
0  42072  239
1    582  931
---- Validation: 
scalar performance:
{'acc': 0.9760827, 'precision': 0.8262766, 'recall': 0.7475337, 'specificity': 0.7475337, 'f1': 0.7810515, 'auroc': 0.97596765, 'binary_precision': 0.66887414, 'binary_recall': 0.50332224, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.5744075}
confusion matrix:
       0    1
0  18021  150
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.8362536, 'recall': 0.6603884, 'specificity': 0.6603884, 'f1': 0.7144102, 'auroc': 0.9590403, 'binary_precision': 0.69911504, 'binary_recall': 0.3264463, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.44507045}
confusion matrix:
      0   1
0  5963  34
1   163  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_4.png
early stop counter: 1
val acc:0.9760826826095581, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9769193530082703 / 0.9769193530082703
after epoch: 4,now: 2024-06-02 01:59:05.151466,epoch time: 0:31:47.159508,used: 2:09:57.833771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98101497, 'precision': 0.86389315, 'recall': 0.84390676, 'specificity': 0.84390676, 'f1': 0.85359246, 'auroc': 0.98485756, 'binary_precision': 0.7386125, 'binary_recall': 0.6966292, 'binary_specificity': 0.99118435, 'binary_f1_score': 0.71700686}
confusion matrix:
       0     1
0  41938   373
1    459  1054
---- Validation: 
scalar performance:
{'acc': 0.9797049, 'precision': 0.8375211, 'recall': 0.83372486, 'specificity': 0.83372486, 'f1': 0.83561134, 'auroc': 0.97924614, 'binary_precision': 0.6857143, 'binary_recall': 0.6777409, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.6817043}
confusion matrix:
       0    1
0  17984  187
1    194  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.80415016, 'recall': 0.6412931, 'specificity': 0.6412931, 'f1': 0.69012207, 'auroc': 0.9649575, 'binary_precision': 0.6363636, 'binary_recall': 0.2892562, 'binary_specificity': 0.99333, 'binary_f1_score': 0.39772725}
confusion matrix:
      0   1
0  5957  40
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 02:31:02.107794,epoch time: 0:31:56.956328,used: 2:41:54.790099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9852364, 'precision': 0.92335236, 'recall': 0.8409945, 'specificity': 0.8409945, 'f1': 0.87738794, 'auroc': 0.988305, 'binary_precision': 0.85785127, 'binary_recall': 0.68605417, 'binary_specificity': 0.99593484, 'binary_f1_score': 0.76239437}
confusion matrix:
       0     1
0  42139   172
1    475  1038
---- Validation: 
scalar performance:
{'acc': 0.9803441, 'precision': 0.8709797, 'recall': 0.78266, 'specificity': 0.78266, 'f1': 0.820393, 'auroc': 0.9770043, 'binary_precision': 0.756044, 'binary_recall': 0.5714286, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.65089875}
confusion matrix:
       0    1
0  18060  111
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.8363535, 'recall': 0.5873422, 'specificity': 0.5873422, 'f1': 0.63300246, 'auroc': 0.9531429, 'binary_precision': 0.704918, 'binary_recall': 0.17768595, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.28382835}
confusion matrix:
      0   1
0  5979  18
1   199  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 03:02:46.033211,epoch time: 0:31:43.925417,used: 3:13:38.715516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9884538, 'precision': 0.92654246, 'recall': 0.8949197, 'specificity': 0.8949197, 'f1': 0.9100728, 'auroc': 0.9916976, 'binary_precision': 0.86041516, 'binary_recall': 0.79444814, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.82611686}
confusion matrix:
       0     1
0  42116   195
1    311  1202
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.9030664, 'recall': 0.8314105, 'specificity': 0.8314105, 'f1': 0.863481, 'auroc': 0.97960603, 'binary_precision': 0.81707317, 'binary_recall': 0.6677741, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.7349177}
confusion matrix:
       0    1
0  18081   90
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.88244486, 'recall': 0.5490865, 'specificity': 0.5490865, 'f1': 0.5790595, 'auroc': 0.9516618, 'binary_precision': 0.8, 'binary_recall': 0.09917355, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.17647058}
confusion matrix:
      0   1
0  5991   6
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 03:34:28.820320,epoch time: 0:31:42.787109,used: 3:45:21.502625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98391294, 'precision': 0.960613, 'recall': 0.78581965, 'specificity': 0.78581965, 'f1': 0.8513366, 'auroc': 0.99294084, 'binary_precision': 0.9362851, 'binary_recall': 0.5730337, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.71094704}
confusion matrix:
       0    1
0  42252   59
1    646  867
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.93684864, 'recall': 0.71260214, 'specificity': 0.71260214, 'f1': 0.78363526, 'auroc': 0.98119456, 'binary_precision': 0.8923611, 'binary_recall': 0.4269103, 'binary_specificity': 0.998294, 'binary_f1_score': 0.5775281}
confusion matrix:
       0    1
0  18140   31
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9343771, 'recall': 0.5576011, 'specificity': 0.5576011, 'f1': 0.5936743, 'auroc': 0.9526268, 'binary_precision': 0.9032258, 'binary_recall': 0.11570248, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.20512821}
confusion matrix:
      0   1
0  5994   3
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_8.png
early stop counter: 1
val acc:0.9799712300300598, best validation acc: 0.984552264213562, corresponding to test acc:                         0.9640967845916748 / 0.9769193530082703
after epoch: 8,now: 2024-06-02 04:06:25.965381,epoch time: 0:31:57.145061,used: 4:17:18.647686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856015, 'precision': 0.95517266, 'recall': 0.81696606, 'specificity': 0.81696606, 'f1': 0.87280893, 'auroc': 0.9928126, 'binary_precision': 0.92322457, 'binary_recall': 0.6358229, 'binary_specificity': 0.9981092, 'binary_f1_score': 0.75303334}
confusion matrix:
       0    1
0  42231   80
1    551  962
---- Validation: 
scalar performance:
{'acc': 0.9826879, 'precision': 0.9373063, 'recall': 0.7613853, 'specificity': 0.7613853, 'f1': 0.8257573, 'auroc': 0.9819417, 'binary_precision': 0.89014083, 'binary_recall': 0.52491695, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.6603971}
confusion matrix:
       0    1
0  18132   39
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.9208038, 'recall': 0.57189715, 'specificity': 0.57189715, 'f1': 0.61542207, 'auroc': 0.94537973, 'binary_precision': 0.875, 'binary_recall': 0.1446281, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.24822696}
confusion matrix:
      0   1
0  5992   5
1   207  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_9.png
early stop counter: 2
val acc:0.9826878905296326, best validation acc: 0.984552264213562, corresponding to test acc:                         0.9640967845916748 / 0.9769193530082703
after epoch: 9,now: 2024-06-02 04:38:17.724165,epoch time: 0:31:51.758784,used: 4:49:10.406470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98875046, 'precision': 0.9060399, 'recall': 0.931081, 'specificity': 0.931081, 'f1': 0.91815317, 'auroc': 0.9940871, 'binary_precision': 0.8167702, 'binary_recall': 0.8691342, 'binary_specificity': 0.9930278, 'binary_f1_score': 0.842139}
confusion matrix:
       0     1
0  42016   295
1    198  1315
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.87891585, 'recall': 0.8880367, 'specificity': 0.8880367, 'f1': 0.88341755, 'auroc': 0.9726556, 'binary_precision': 0.7649919, 'binary_recall': 0.78405315, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.7744052}
confusion matrix:
       0    1
0  18026  145
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.84169245, 'recall': 0.6260148, 'specificity': 0.6260148, 'f1': 0.6800129, 'auroc': 0.9504866, 'binary_precision': 0.7126437, 'binary_recall': 0.25619835, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3768997}
confusion matrix:
      0   1
0  5972  25
1   180  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 05:10:03.938045,epoch time: 0:31:46.213880,used: 5:20:56.620350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9906444, 'precision': 0.94510436, 'recall': 0.9103935, 'specificity': 0.9103935, 'f1': 0.92698866, 'auroc': 0.9953712, 'binary_precision': 0.89647734, 'binary_recall': 0.8241904, 'binary_specificity': 0.99659663, 'binary_f1_score': 0.85881543}
confusion matrix:
       0     1
0  42167   144
1    266  1247
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.8998496, 'recall': 0.8469437, 'specificity': 0.8469437, 'f1': 0.87137914, 'auroc': 0.9784032, 'binary_precision': 0.8096154, 'binary_recall': 0.6993356, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.7504456}
confusion matrix:
       0    1
0  18072   99
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.90221757, 'recall': 0.54305494, 'specificity': 0.54305494, 'f1': 0.5694387, 'auroc': 0.9560621, 'binary_precision': 0.84, 'binary_recall': 0.08677686, 'binary_specificity': 0.999333, 'binary_f1_score': 0.15730338}
confusion matrix:
      0   1
0  5993   4
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_11.png
early stop counter: 1
val acc:0.9850849509239197, best validation acc: 0.9853513240814209, corresponding to test acc:                         0.9671421647071838 / 0.9769193530082703
after epoch: 11,now: 2024-06-02 05:41:50.814606,epoch time: 0:31:46.876561,used: 5:52:43.496911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9911464, 'precision': 0.93596953, 'recall': 0.9304099, 'specificity': 0.9304099, 'f1': 0.93317044, 'auroc': 0.9955164, 'binary_precision': 0.8767582, 'binary_recall': 0.8651685, 'binary_specificity': 0.99565125, 'binary_f1_score': 0.87092483}
confusion matrix:
       0     1
0  42127   184
1    204  1309
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.8873085, 'recall': 0.8579937, 'specificity': 0.8579937, 'f1': 0.8720288, 'auroc': 0.9803637, 'binary_precision': 0.7837838, 'binary_recall': 0.72259134, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.7519447}
confusion matrix:
       0    1
0  18051  120
1    167  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8410817, 'recall': 0.63006365, 'specificity': 0.63006365, 'f1': 0.68437326, 'auroc': 0.9548576, 'binary_precision': 0.7111111, 'binary_recall': 0.2644628, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.38554218}
confusion matrix:
      0   1
0  5971  26
1   178  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_12.png
early stop counter: 2
val acc:0.9847120642662048, best validation acc: 0.9853513240814209, corresponding to test acc:                         0.9671421647071838 / 0.9769193530082703
after epoch: 12,now: 2024-06-02 06:13:32.103619,epoch time: 0:31:41.289013,used: 6:24:24.785924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99069005, 'precision': 0.9612428, 'recall': 0.8938472, 'specificity': 0.8938472, 'f1': 0.92468655, 'auroc': 0.9970796, 'binary_precision': 0.9299611, 'binary_recall': 0.78982157, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.8541816}
confusion matrix:
       0     1
0  42221    90
1    318  1195
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.909773, 'recall': 0.8349254, 'specificity': 0.8349254, 'f1': 0.868309, 'auroc': 0.97924566, 'binary_precision': 0.8302658, 'binary_recall': 0.6744186, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.7442713}
confusion matrix:
       0    1
0  18088   83
1    196  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.79423773, 'recall': 0.5302414, 'specificity': 0.5302414, 'f1': 0.5467284, 'auroc': 0.9481113, 'binary_precision': 0.625, 'binary_recall': 0.06198347, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11278196}
confusion matrix:
      0   1
0  5988   9
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_13.png
early stop counter: 3
val acc:0.9851382374763489, best validation acc: 0.9853513240814209, corresponding to test acc:                         0.9671421647071838 / 0.9769193530082703
after epoch: 13,now: 2024-06-02 06:45:07.969239,epoch time: 0:31:35.865620,used: 6:56:00.651544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9900511, 'precision': 0.94189286, 'recall': 0.9040319, 'specificity': 0.9040319, 'f1': 0.92204756, 'auroc': 0.99588466, 'binary_precision': 0.89050037, 'binary_recall': 0.8116325, 'binary_specificity': 0.9964312, 'binary_f1_score': 0.8492393}
confusion matrix:
       0     1
0  42160   151
1    285  1228
---- Validation: 
scalar performance:
{'acc': 0.98625684, 'precision': 0.9177386, 'recall': 0.847549, 'specificity': 0.847549, 'f1': 0.87918776, 'auroc': 0.9822617, 'binary_precision': 0.8453815, 'binary_recall': 0.6993356, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.76545453}
confusion matrix:
       0    1
0  18094   77
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.81219006, 'recall': 0.6112185, 'specificity': 0.6112185, 'f1': 0.65982425, 'auroc': 0.9520432, 'binary_precision': 0.6547619, 'binary_recall': 0.22727273, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.3374233}
confusion matrix:
      0   1
0  5968  29
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_14.png
better model found
persisted
after epoch: 14,now: 2024-06-02 07:16:43.273295,epoch time: 0:31:35.304056,used: 7:27:35.955600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99281216, 'precision': 0.96258926, 'recall': 0.92681146, 'specificity': 0.92681146, 'f1': 0.9439246, 'auroc': 0.9976362, 'binary_precision': 0.9303161, 'binary_recall': 0.8559154, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.89156634}
confusion matrix:
       0     1
0  42214    97
1    218  1295
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.91084135, 'recall': 0.86380255, 'specificity': 0.86380255, 'f1': 0.8857855, 'auroc': 0.97923887, 'binary_precision': 0.8305085, 'binary_recall': 0.73255813, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.77846426}
confusion matrix:
       0    1
0  18081   90
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73944813, 'recall': 0.53378993, 'specificity': 0.53378993, 'f1': 0.55194354, 'auroc': 0.9417438, 'binary_precision': 0.5151515, 'binary_recall': 0.07024793, 'binary_specificity': 0.997332, 'binary_f1_score': 0.12363636}
confusion matrix:
      0   1
0  5981  16
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_15.png
better model found
persisted
after epoch: 15,now: 2024-06-02 07:48:03.198352,epoch time: 0:31:19.925057,used: 7:58:55.880657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907585, 'precision': 0.9506458, 'recall': 0.9059303, 'specificity': 0.9059303, 'f1': 0.9270293, 'auroc': 0.99634755, 'binary_precision': 0.907885, 'binary_recall': 0.8148148, 'binary_specificity': 0.99704576, 'binary_f1_score': 0.85883576}
confusion matrix:
       0     1
0  42187   125
1    280  1232
---- Validation: 
scalar performance:
{'acc': 0.9837, 'precision': 0.8912969, 'recall': 0.8293642, 'specificity': 0.8293642, 'f1': 0.85746497, 'auroc': 0.97256356, 'binary_precision': 0.7936508, 'binary_recall': 0.66445184, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.7233273}
confusion matrix:
       0    1
0  18067  104
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.8715613, 'recall': 0.6571733, 'specificity': 0.6571733, 'f1': 0.71740067, 'auroc': 0.9486455, 'binary_precision': 0.77, 'binary_recall': 0.3181818, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4502924}
confusion matrix:
      0   1
0  5974  23
1   165  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_16.png
early stop counter: 1
val acc:0.9836999773979187, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9613720178604126 / 0.9769193530082703
after epoch: 16,now: 2024-06-02 08:19:33.038196,epoch time: 0:31:29.839844,used: 8:30:25.720501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9939303, 'precision': 0.9536972, 'recall': 0.9554318, 'specificity': 0.9554318, 'f1': 0.9545628, 'auroc': 0.99802244, 'binary_precision': 0.9104674, 'binary_recall': 0.914078, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.9122691}
confusion matrix:
       0     1
0  42175   136
1    130  1383
---- Validation: 
scalar performance:
{'acc': 0.985884, 'precision': 0.889217, 'recall': 0.88108444, 'specificity': 0.88108444, 'f1': 0.88510436, 'auroc': 0.98114, 'binary_precision': 0.7860781, 'binary_recall': 0.769103, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.77749795}
confusion matrix:
       0    1
0  18045  126
1    139  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7684283, 'recall': 0.55610037, 'specificity': 0.55610037, 'f1': 0.5865785, 'auroc': 0.95393133, 'binary_precision': 0.5714286, 'binary_recall': 0.11570248, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.19243988}
confusion matrix:
      0   1
0  5976  21
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_17.png
early stop counter: 2
val acc:0.9858840107917786, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9613720178604126 / 0.9769193530082703
after epoch: 17,now: 2024-06-02 08:50:58.832504,epoch time: 0:31:25.794308,used: 9:01:51.514809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99461484, 'precision': 0.9653883, 'recall': 0.9529185, 'specificity': 0.9529185, 'f1': 0.959062, 'auroc': 0.99796724, 'binary_precision': 0.9340585, 'binary_recall': 0.9081296, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.92091155}
confusion matrix:
       0     1
0  42214    97
1    139  1374
---- Validation: 
scalar performance:
{'acc': 0.9855111, 'precision': 0.892514, 'recall': 0.86724, 'specificity': 0.86724, 'f1': 0.8794234, 'auroc': 0.9806075, 'binary_precision': 0.7935943, 'binary_recall': 0.7408638, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.766323}
confusion matrix:
       0    1
0  18055  116
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.7964628, 'recall': 0.64509183, 'specificity': 0.64509183, 'f1': 0.692289, 'auroc': 0.94656956, 'binary_precision': 0.62068963, 'binary_recall': 0.29752067, 'binary_specificity': 0.992663, 'binary_f1_score': 0.40223464}
confusion matrix:
      0   1
0  5953  44
1   170  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_18.png
early stop counter: 3
val acc:0.9855111241340637, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9613720178604126 / 0.9769193530082703
after epoch: 18,now: 2024-06-02 09:22:09.957623,epoch time: 0:31:11.125119,used: 9:33:02.639928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99351954, 'precision': 0.9508833, 'recall': 0.9520326, 'specificity': 0.9520326, 'f1': 0.95145714, 'auroc': 0.99826014, 'binary_precision': 0.9050758, 'binary_recall': 0.9074686, 'binary_specificity': 0.99659663, 'binary_f1_score': 0.9062706}
confusion matrix:
       0     1
0  42167   144
1    140  1373
---- Validation: 
scalar performance:
{'acc': 0.9869493, 'precision': 0.9084803, 'recall': 0.8736043, 'specificity': 0.8736043, 'f1': 0.89020497, 'auroc': 0.96956754, 'binary_precision': 0.8251366, 'binary_recall': 0.7524917, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.78714156}
confusion matrix:
       0    1
0  18075   96
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.91912997, 'recall': 0.6088371, 'specificity': 0.6088371, 'f1': 0.66682714, 'auroc': 0.95038533, 'binary_precision': 0.86885244, 'binary_recall': 0.21900827, 'binary_specificity': 0.998666, 'binary_f1_score': 0.34983498}
confusion matrix:
      0   1
0  5989   8
1   189  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_19.png
better model found
persisted
after epoch: 19,now: 2024-06-02 09:53:25.577119,epoch time: 0:31:15.619496,used: 10:04:18.259424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9938162, 'precision': 0.9635959, 'recall': 0.94198936, 'specificity': 0.94198936, 'f1': 0.9525145, 'auroc': 0.9982413, 'binary_precision': 0.93125, 'binary_recall': 0.88631856, 'binary_specificity': 0.99766016, 'binary_f1_score': 0.9082289}
confusion matrix:
       0     1
0  42212    99
1    172  1341
---- Validation: 
scalar performance:
{'acc': 0.9869493, 'precision': 0.9254885, 'recall': 0.851922, 'specificity': 0.851922, 'f1': 0.8849709, 'auroc': 0.98098326, 'binary_precision': 0.8606061, 'binary_recall': 0.7076412, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.7766636}
confusion matrix:
       0    1
0  18102   69
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7127047, 'recall': 0.5354392, 'specificity': 0.5354392, 'f1': 0.5540135, 'auroc': 0.94799817, 'binary_precision': 0.46153846, 'binary_recall': 0.07438017, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.12811387}
confusion matrix:
      0   1
0  5976  21
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_20.png
early stop counter: 1
val acc:0.9869493246078491, best validation acc: 0.9869493246078491, corresponding to test acc:                         0.9684244394302368 / 0.9769193530082703
after epoch: 20,now: 2024-06-02 10:25:06.713722,epoch time: 0:31:41.136603,used: 10:35:59.396027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99365646, 'precision': 0.9819914, 'recall': 0.9208756, 'specificity': 0.9208756, 'f1': 0.94920987, 'auroc': 0.9987455, 'binary_precision': 0.9695817, 'binary_recall': 0.8426966, 'binary_specificity': 0.9990546, 'binary_f1_score': 0.9016973}
confusion matrix:
       0     1
0  42271    40
1    238  1275
---- Validation: 
scalar performance:
{'acc': 0.9858307, 'precision': 0.9402655, 'recall': 0.81601, 'specificity': 0.81601, 'f1': 0.8672315, 'auroc': 0.97747624, 'binary_precision': 0.89252335, 'binary_recall': 0.63455147, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.74174756}
confusion matrix:
       0    1
0  18125   46
1    220  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.79423773, 'recall': 0.5302414, 'specificity': 0.5302414, 'f1': 0.5467284, 'auroc': 0.94869745, 'binary_precision': 0.625, 'binary_recall': 0.06198347, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11278196}
confusion matrix:
      0   1
0  5988   9
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_21.png
early stop counter: 2
val acc:0.9858307242393494, best validation acc: 0.9869493246078491, corresponding to test acc:                         0.9684244394302368 / 0.9769193530082703
after epoch: 21,now: 2024-06-02 10:56:35.637199,epoch time: 0:31:28.923477,used: 11:07:28.319504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9936108, 'precision': 0.9805697, 'recall': 0.9214893, 'specificity': 0.9214893, 'f1': 0.9489492, 'auroc': 0.99872434, 'binary_precision': 0.9666919, 'binary_recall': 0.8440185, 'binary_specificity': 0.9989601, 'binary_f1_score': 0.9011997}
confusion matrix:
       0     1
0  42267    44
1    236  1277
---- Validation: 
scalar performance:
{'acc': 0.9875353, 'precision': 0.9500638, 'recall': 0.83776975, 'specificity': 0.83776975, 'f1': 0.8853656, 'auroc': 0.9694308, 'binary_precision': 0.91071427, 'binary_recall': 0.6777409, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.7771428}
confusion matrix:
       0    1
0  18131   40
1    194  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.8417163, 'recall': 0.5569341, 'specificity': 0.5569341, 'f1': 0.59042054, 'auroc': 0.92606604, 'binary_precision': 0.71794873, 'binary_recall': 0.11570248, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19928828}
confusion matrix:
      0   1
0  5986  11
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_22.png
better model found
persisted
after epoch: 22,now: 2024-06-02 11:28:09.733772,epoch time: 0:31:34.096573,used: 11:39:02.416077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9952081, 'precision': 0.97530496, 'recall': 0.9516325, 'specificity': 0.9516325, 'f1': 0.96314293, 'auroc': 0.9988954, 'binary_precision': 0.95400697, 'binary_recall': 0.90482485, 'binary_specificity': 0.99844015, 'binary_f1_score': 0.9287652}
confusion matrix:
       0     1
0  42245    66
1    144  1369
---- Validation: 
scalar performance:
{'acc': 0.98657644, 'precision': 0.9215144, 'recall': 0.8493202, 'specificity': 0.8493202, 'f1': 0.88178885, 'auroc': 0.97810423, 'binary_precision': 0.8528226, 'binary_recall': 0.7026578, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.7704918}
confusion matrix:
       0    1
0  18098   73
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.8560655, 'recall': 0.5774285, 'specificity': 0.5774285, 'f1': 0.62078846, 'auroc': 0.93989795, 'binary_precision': 0.74509805, 'binary_recall': 0.1570248, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.25938568}
confusion matrix:
      0   1
0  5984  13
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_23.png
early stop counter: 1
val acc:0.9865764379501343, best validation acc: 0.987535297870636, corresponding to test acc:                         0.9639365077018738 / 0.9769193530082703
after epoch: 23,now: 2024-06-02 11:59:43.493851,epoch time: 0:31:33.760079,used: 12:10:36.176156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9947746, 'precision': 0.9811293, 'recall': 0.9389805, 'specificity': 0.9389805, 'f1': 0.959016, 'auroc': 0.999092, 'binary_precision': 0.9665698, 'binary_recall': 0.8790482, 'binary_specificity': 0.9989128, 'binary_f1_score': 0.9207338}
confusion matrix:
       0     1
0  42265    46
1    183  1330
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.93419987, 'recall': 0.836499, 'specificity': 0.836499, 'f1': 0.87871945, 'auroc': 0.9761211, 'binary_precision': 0.87904966, 'binary_recall': 0.67607975, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.76431924}
confusion matrix:
       0    1
0  18115   56
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.8789189, 'recall': 0.5470204, 'specificity': 0.5470204, 'f1': 0.57565486, 'auroc': 0.9498005, 'binary_precision': 0.79310346, 'binary_recall': 0.09504132, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16974169}
confusion matrix:
      0   1
0  5991   6
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_24.png
early stop counter: 2
val acc:0.9866297245025635, best validation acc: 0.987535297870636, corresponding to test acc:                         0.9639365077018738 / 0.9769193530082703
after epoch: 24,now: 2024-06-02 12:31:12.016115,epoch time: 0:31:28.522264,used: 12:42:04.698420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9944323, 'precision': 0.9637003, 'recall': 0.951868, 'specificity': 0.951868, 'f1': 0.9577017, 'auroc': 0.9987514, 'binary_precision': 0.9307536, 'binary_recall': 0.9061467, 'binary_specificity': 0.9975893, 'binary_f1_score': 0.91828537}
confusion matrix:
       0     1
0  42209   102
1    142  1371
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.8994906, 'recall': 0.8576309, 'specificity': 0.8576309, 'f1': 0.8773142, 'auroc': 0.974112, 'binary_precision': 0.8081937, 'binary_recall': 0.7209302, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.762072}
confusion matrix:
       0    1
0  18068  103
1    168  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.81408453, 'recall': 0.578911, 'specificity': 0.578911, 'f1': 0.6204115, 'auroc': 0.94438475, 'binary_precision': 0.66101694, 'binary_recall': 0.16115703, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5977  20
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011741_25.png
early stop counter: 3
val acc:0.9855643510818481, best validation acc: 0.987535297870636, corresponding to test acc:                         0.9639365077018738 / 0.9769193530082703
after epoch: 25,now: 2024-06-02 13:02:34.259297,epoch time: 0:31:22.243182,used: 13:13:26.941602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_23_49_07_seed_2_21011741
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
slurmstepd: error: *** JOB 21011741 ON supergpu02 CANCELLED AT 2024-06-02T13:26:36 DUE TO TIME LIMIT ***
