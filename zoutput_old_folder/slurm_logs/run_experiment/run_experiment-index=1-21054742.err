Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun  3 11:40:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742

 Experiment start at: 2024-06-03 11:45:48.220423
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4325958788394928
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99084216, 'precision': 0.97913396, 'recall': 0.96684563, 'specificity': 0.96684563, 'f1': 0.97288907, 'auroc': 0.9970026, 'binary_precision': 0.9647937, 'binary_recall': 0.9372593, 'binary_specificity': 0.996432, 'binary_f1_score': 0.95082724}
confusion matrix:
       0     1
0  42170   151
1    277  4138
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94859517, 'precision': 0.6710621, 'recall': 0.79037344, 'specificity': 0.79037344, 'f1': 0.71270645, 'auroc': 0.9144961, 'binary_precision': 0.3559322, 'binary_recall': 0.62052876, 'binary_specificity': 0.9602182, 'binary_f1_score': 0.45238099}
confusion matrix:
       0    1
0  17427  722
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9899705, 'precision': 0.99439406, 'recall': 0.9565773, 'specificity': 0.9565773, 'f1': 0.9744843, 'auroc': 0.9961236, 'binary_precision': 1.0, 'binary_recall': 0.91315454, 'binary_specificity': 1.0, 'binary_f1_score': 0.9546061}
confusion matrix:
      0    1
0  5997    0
1    68  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 12:06:35.057077,epoch time: 0:20:46.836654,used: 0:20:46.836654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9947578, 'precision': 0.99551105, 'recall': 0.9737811, 'specificity': 0.9737811, 'f1': 0.98434025, 'auroc': 0.99747086, 'binary_precision': 0.99642944, 'binary_recall': 0.9479167, 'binary_specificity': 0.99964553, 'binary_f1_score': 0.9715678}
confusion matrix:
       0     1
0  42305    15
1    230  4186
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7452652, 'recall': 0.5676978, 'specificity': 0.5676978, 'f1': 0.60164535, 'auroc': 0.9259678, 'binary_precision': 0.5202312, 'binary_recall': 0.1399689, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.22058822}
confusion matrix:
       0   1
0  18066  83
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9935103, 'precision': 0.9963582, 'recall': 0.97190297, 'specificity': 0.97190297, 'f1': 0.9837178, 'auroc': 0.9960398, 'binary_precision': 1.0, 'binary_recall': 0.9438059, 'binary_specificity': 1.0, 'binary_f1_score': 0.9710906}
confusion matrix:
      0    1
0  5997    0
1    44  739
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-03 12:26:03.228254,epoch time: 0:19:28.171177,used: 0:40:15.007831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9972612, 'precision': 0.9913128, 'recall': 0.9927074, 'specificity': 0.9927074, 'f1': 0.99200886, 'auroc': 0.99958646, 'binary_precision': 0.9839729, 'binary_recall': 0.9870924, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.9855302}
confusion matrix:
       0     1
0  42249    71
1     57  4359
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.8058274, 'recall': 0.69421196, 'specificity': 0.69421196, 'f1': 0.736451, 'auroc': 0.94321465, 'binary_precision': 0.6327543, 'binary_recall': 0.39657855, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.48757172}
confusion matrix:
       0    1
0  18001  148
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.9974534, 'recall': 0.9902547, 'specificity': 0.9902547, 'f1': 0.99381876, 'auroc': 0.99973655, 'binary_precision': 0.9974026, 'binary_recall': 0.9808429, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9890534}
confusion matrix:
      0    1
0  5995    2
1    15  768
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-03 12:45:22.766573,epoch time: 0:19:19.538319,used: 0:59:34.546150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99649096, 'precision': 0.99807, 'recall': 0.98141855, 'specificity': 0.98141855, 'f1': 0.9895665, 'auroc': 0.9997134, 'binary_precision': 1.0, 'binary_recall': 0.9628371, 'binary_specificity': 1.0, 'binary_f1_score': 0.98106676}
confusion matrix:
       0     1
0  42323     0
1    164  4249
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.85280627, 'recall': 0.5598818, 'specificity': 0.5598818, 'f1': 0.5960894, 'auroc': 0.946563, 'binary_precision': 0.7358491, 'binary_recall': 0.121306375, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.2082777}
confusion matrix:
       0   1
0  18121  28
1    565  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99159294, 'precision': 0.99529237, 'recall': 0.9636015, 'specificity': 0.9636015, 'f1': 0.9787483, 'auroc': 0.99840844, 'binary_precision': 1.0, 'binary_recall': 0.92720306, 'binary_specificity': 1.0, 'binary_f1_score': 0.9622266}
confusion matrix:
      0    1
0  5997    0
1    57  726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_4.png
early stop counter: 1
val acc:0.9684439897537231, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 4,now: 2024-06-03 13:04:20.565900,epoch time: 0:18:57.799327,used: 1:18:32.345477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9961486, 'precision': 0.98981583, 'recall': 0.98762834, 'specificity': 0.98762834, 'f1': 0.988719, 'auroc': 0.9991243, 'binary_precision': 0.98201686, 'binary_recall': 0.97712344, 'binary_specificity': 0.9981333, 'binary_f1_score': 0.979564}
confusion matrix:
       0     1
0  42242    79
1    101  4314
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7936897, 'recall': 0.5136938, 'specificity': 0.5136938, 'f1': 0.51817065, 'auroc': 0.92188334, 'binary_precision': 0.62068963, 'binary_recall': 0.02799378, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.05357143}
confusion matrix:
       0   1
0  18138  11
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9957227, 'precision': 0.99759376, 'recall': 0.9814815, 'specificity': 0.9814815, 'f1': 0.98936003, 'auroc': 0.9978276, 'binary_precision': 1.0, 'binary_recall': 0.962963, 'binary_specificity': 1.0, 'binary_f1_score': 0.9811321}
confusion matrix:
      0    1
0  5997    0
1    29  754
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_5.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 5,now: 2024-06-03 13:23:14.061978,epoch time: 0:18:53.496078,used: 1:37:25.841555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99698305, 'precision': 0.9975011, 'recall': 0.9848466, 'specificity': 0.9848466, 'f1': 0.99107134, 'auroc': 0.9986218, 'binary_precision': 0.9981356, 'binary_recall': 0.96988225, 'binary_specificity': 0.999811, 'binary_f1_score': 0.98380613}
confusion matrix:
       0     1
0  42312     8
1    133  4283
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.76064974, 'recall': 0.7142003, 'specificity': 0.7142003, 'f1': 0.7349125, 'auroc': 0.9448205, 'binary_precision': 0.5409524, 'binary_recall': 0.44167963, 'binary_specificity': 0.98672104, 'binary_f1_score': 0.48630136}
confusion matrix:
       0    1
0  17908  241
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.99969506, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_6.png
early stop counter: 3
val acc:0.9680715203285217, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 6,now: 2024-06-03 13:42:16.739263,epoch time: 0:19:02.677285,used: 1:56:28.518840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9965337, 'precision': 0.99809337, 'recall': 0.9816493, 'specificity': 0.9816493, 'f1': 0.98969805, 'auroc': 0.9993974, 'binary_precision': 1.0, 'binary_recall': 0.9632986, 'binary_specificity': 1.0, 'binary_f1_score': 0.9813063}
confusion matrix:
       0     1
0  42322     0
1    162  4252
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.8162755, 'recall': 0.50152767, 'specificity': 0.50152767, 'f1': 0.49440578, 'auroc': 0.95091903, 'binary_precision': 0.6666667, 'binary_recall': 0.00311042, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0061919508}
confusion matrix:
       0  1
0  18148  1
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9936578, 'precision': 0.9964404, 'recall': 0.9725415, 'specificity': 0.9725415, 'f1': 0.984097, 'auroc': 0.99960446, 'binary_precision': 1.0, 'binary_recall': 0.945083, 'binary_specificity': 1.0, 'binary_f1_score': 0.97176623}
confusion matrix:
      0    1
0  5997    0
1    43  740
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_7.png
early stop counter: 4
val acc:0.9658365249633789, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 7,now: 2024-06-03 14:02:01.201325,epoch time: 0:19:44.462062,used: 2:16:12.980902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9952713, 'precision': 0.99740255, 'recall': 0.9749774, 'specificity': 0.9749774, 'f1': 0.9858655, 'auroc': 0.99915, 'binary_precision': 1.0, 'binary_recall': 0.9499547, 'binary_specificity': 1.0, 'binary_f1_score': 0.97433513}
confusion matrix:
       0     1
0  42320     0
1    221  4195
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.8698129, 'recall': 0.5915432, 'specificity': 0.5915432, 'f1': 0.6415112, 'auroc': 0.9350698, 'binary_precision': 0.7677419, 'binary_recall': 0.18506998, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.2982456}
confusion matrix:
       0    1
0  18113   36
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99011797, 'precision': 0.9944756, 'recall': 0.95721585, 'specificity': 0.95721585, 'f1': 0.97487426, 'auroc': 0.99825895, 'binary_precision': 1.0, 'binary_recall': 0.9144317, 'binary_specificity': 1.0, 'binary_f1_score': 0.95530355}
confusion matrix:
      0    1
0  5997    0
1    67  716
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_8.png
early stop counter: 5
val acc:0.9702000617980957, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 8,now: 2024-06-03 14:21:44.058956,epoch time: 0:19:42.857631,used: 2:35:55.838533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.99830186, 'recall': 0.98917973, 'specificity': 0.98917973, 'f1': 0.9936878, 'auroc': 0.9993634, 'binary_precision': 0.99884367, 'binary_recall': 0.9784776, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9885558}
confusion matrix:
       0     1
0  42317     5
1     95  4319
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.70215803, 'recall': 0.51558584, 'specificity': 0.51558584, 'f1': 0.521595, 'auroc': 0.93031454, 'binary_precision': 0.4375, 'binary_recall': 0.032659408, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.06078147}
confusion matrix:
       0   1
0  18122  27
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.99668705, 'recall': 0.9744572, 'specificity': 0.9744572, 'f1': 0.9852319, 'auroc': 0.99876887, 'binary_precision': 1.0, 'binary_recall': 0.9489144, 'binary_specificity': 1.0, 'binary_f1_score': 0.97378767}
confusion matrix:
      0    1
0  5997    0
1    40  743
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_9.png
early stop counter: 6
val acc:0.9654640555381775, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 9,now: 2024-06-03 14:41:58.598619,epoch time: 0:20:14.539663,used: 2:56:10.378196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99617, 'precision': 0.99789417, 'recall': 0.9797236, 'specificity': 0.9797236, 'f1': 0.98859686, 'auroc': 0.9996547, 'binary_precision': 1.0, 'binary_recall': 0.9594472, 'binary_specificity': 1.0, 'binary_f1_score': 0.979304}
confusion matrix:
       0     1
0  42322     0
1    179  4235
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.95068574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9921829, 'precision': 0.99561983, 'recall': 0.96615577, 'specificity': 0.96615577, 'f1': 0.9802854, 'auroc': 0.9987029, 'binary_precision': 1.0, 'binary_recall': 0.9323116, 'binary_specificity': 1.0, 'binary_f1_score': 0.9649703}
confusion matrix:
      0    1
0  5997    0
1    53  730
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_10.png
early stop counter: 7
val acc:0.9657300710678101, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 10,now: 2024-06-03 15:01:41.589734,epoch time: 0:19:42.991115,used: 3:15:53.369311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99753934, 'precision': 0.9927595, 'recall': 0.9928595, 'specificity': 0.9928595, 'f1': 0.99280953, 'auroc': 0.9996743, 'binary_precision': 0.98686594, 'binary_recall': 0.98708946, 'binary_specificity': 0.9986295, 'binary_f1_score': 0.9869777}
confusion matrix:
       0     1
0  42263    58
1     57  4358
---- Validation: 
scalar performance:
{'acc': 0.95301193, 'precision': 0.69056153, 'recall': 0.82266235, 'specificity': 0.82266235, 'f1': 0.7369658, 'auroc': 0.93736947, 'binary_precision': 0.39266548, 'binary_recall': 0.6827372, 'binary_specificity': 0.9625875, 'binary_f1_score': 0.4985804}
confusion matrix:
       0    1
0  17470  679
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.999805, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_11.png
early stop counter: 8
val acc:0.9530119299888611, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 11,now: 2024-06-03 15:21:15.140476,epoch time: 0:19:33.550742,used: 3:35:26.920053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.99459755, 'recall': 0.99047923, 'specificity': 0.99047923, 'f1': 0.99252754, 'auroc': 0.99947387, 'binary_precision': 0.9910837, 'binary_recall': 0.98187995, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.9864604}
confusion matrix:
       0     1
0  42282    39
1     80  4335
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7617681, 'recall': 0.7428677, 'specificity': 0.7428677, 'f1': 0.75192547, 'auroc': 0.9488722, 'binary_precision': 0.5411765, 'binary_recall': 0.5007776, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.5201939}
confusion matrix:
       0    1
0  17876  273
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9963127, 'precision': 0.99564314, 'recall': 0.98625654, 'specificity': 0.98625654, 'f1': 0.99088955, 'auroc': 0.9992291, 'binary_precision': 0.9947781, 'binary_recall': 0.97318006, 'binary_specificity': 0.999333, 'binary_f1_score': 0.98386055}
confusion matrix:
      0    1
0  5993    4
1    21  762
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_12.png
early stop counter: 9
val acc:0.9683908224105835, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 12,now: 2024-06-03 15:40:47.297882,epoch time: 0:19:32.157406,used: 3:54:59.077459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99681187, 'precision': 0.9915181, 'recall': 0.98982257, 'specificity': 0.98982257, 'f1': 0.9906685, 'auroc': 0.9995165, 'binary_precision': 0.9849966, 'binary_recall': 0.9812047, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.983097}
confusion matrix:
       0     1
0  42254    66
1     83  4333
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.78230274, 'recall': 0.740997, 'specificity': 0.740997, 'f1': 0.7598544, 'auroc': 0.94613874, 'binary_precision': 0.5824176, 'binary_recall': 0.49455675, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.5349032}
confusion matrix:
       0    1
0  17921  228
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99469024, 'precision': 0.99412405, 'recall': 0.97978747, 'specificity': 0.97978747, 'f1': 0.9868142, 'auroc': 0.9988661, 'binary_precision': 0.993395, 'binary_recall': 0.9604087, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.97662336}
confusion matrix:
      0    1
0  5992    5
1    31  752
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_13.png
early stop counter: 10
val acc:0.9705725908279419, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 13,now: 2024-06-03 16:00:41.077781,epoch time: 0:19:53.779899,used: 4:14:52.857358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99760354, 'precision': 0.9957979, 'recall': 0.9901583, 'specificity': 0.9901583, 'f1': 0.9929577, 'auroc': 0.9993572, 'binary_precision': 0.99357796, 'binary_recall': 0.98097825, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.9872379}
confusion matrix:
       0     1
0  42292    28
1     84  4332
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.747381, 'recall': 0.639896, 'specificity': 0.639896, 'f1': 0.67721725, 'auroc': 0.94228125, 'binary_precision': 0.51955307, 'binary_recall': 0.28926906, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.37162834}
confusion matrix:
       0    1
0  17977  172
1    457  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.9995481, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_14.png
early stop counter: 11
val acc:0.9665282964706421, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 14,now: 2024-06-03 16:20:47.532366,epoch time: 0:20:06.454585,used: 4:34:59.311943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99850225, 'precision': 0.9990711, 'recall': 0.9921739, 'specificity': 0.9921739, 'f1': 0.99559236, 'auroc': 0.9998404, 'binary_precision': 0.99977, 'binary_recall': 0.9843715, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99201095}
confusion matrix:
       0     1
0  42320     1
1     69  4346
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.8493295, 'recall': 0.6212086, 'specificity': 0.6212086, 'f1': 0.67608714, 'auroc': 0.950324, 'binary_precision': 0.72477067, 'binary_recall': 0.24572317, 'binary_specificity': 0.996694, 'binary_f1_score': 0.3670151}
confusion matrix:
       0    1
0  18089   60
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9993166, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_15.png
early stop counter: 12
val acc:0.9709982872009277, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 15,now: 2024-06-03 16:40:52.576009,epoch time: 0:20:05.043643,used: 4:55:04.355586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.9977702, 'recall': 0.99483865, 'specificity': 0.99483865, 'f1': 0.99629897, 'auroc': 0.99976075, 'binary_precision': 0.99657923, 'binary_recall': 0.9900317, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9932947}
confusion matrix:
       0     1
0  42307    15
1     44  4370
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.9115166, 'recall': 0.55410177, 'specificity': 0.55410177, 'f1': 0.5886161, 'auroc': 0.95635986, 'binary_precision': 0.85365856, 'binary_recall': 0.108864695, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.19310345}
confusion matrix:
       0   1
0  18137  12
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.99995375, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_16.png
early stop counter: 13
val acc:0.9688697457313538, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 16,now: 2024-06-03 17:00:53.759286,epoch time: 0:20:01.183277,used: 5:15:05.538863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.99868774, 'recall': 0.9939268, 'specificity': 0.9939268, 'f1': 0.9962929, 'auroc': 0.9997139, 'binary_precision': 0.99862635, 'binary_recall': 0.98799545, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99328244}
confusion matrix:
       0     1
0  42315     6
1     53  4362
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.8126124, 'recall': 0.64568496, 'specificity': 0.64568496, 'f1': 0.6962698, 'auroc': 0.9501857, 'binary_precision': 0.6496599, 'binary_recall': 0.2970451, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.40768412}
confusion matrix:
       0    1
0  18046  103
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.99944663, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_17.png
early stop counter: 14
val acc:0.970466136932373, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 17,now: 2024-06-03 18:24:01.736770,epoch time: 1:23:07.977484,used: 6:38:13.516347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9967263, 'precision': 0.99819887, 'recall': 0.9826727, 'specificity': 0.9826727, 'f1': 0.99028146, 'auroc': 0.9997768, 'binary_precision': 1.0, 'binary_recall': 0.96534544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823672}
confusion matrix:
       0     1
0  42321     0
1    153  4262
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.8610636, 'recall': 0.53766185, 'specificity': 0.53766185, 'f1': 0.56093806, 'auroc': 0.9477471, 'binary_precision': 0.75384617, 'binary_recall': 0.07620529, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.13841808}
confusion matrix:
       0   1
0  18133  16
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9917404, 'precision': 0.9953742, 'recall': 0.9642401, 'specificity': 0.9642401, 'f1': 0.9791333, 'auroc': 0.9974035, 'binary_precision': 1.0, 'binary_recall': 0.9284802, 'binary_specificity': 1.0, 'binary_f1_score': 0.96291393}
confusion matrix:
      0    1
0  5997    0
1    56  727
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_18.png
early stop counter: 15
val acc:0.967539370059967, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 18,now: 2024-06-03 18:49:14.672664,epoch time: 0:25:12.935894,used: 7:03:26.452241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99646956, 'precision': 0.99805814, 'recall': 0.98131794, 'specificity': 0.98131794, 'f1': 0.98950833, 'auroc': 0.9991232, 'binary_precision': 1.0, 'binary_recall': 0.9626359, 'binary_specificity': 1.0, 'binary_f1_score': 0.9809623}
confusion matrix:
       0     1
0  42320     0
1    165  4251
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.4828707, 'recall': 0.49936634, 'specificity': 0.49936634, 'f1': 0.49098, 'auroc': 0.92873067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18126  23
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.99668705, 'recall': 0.9744572, 'specificity': 0.9744572, 'f1': 0.9852319, 'auroc': 0.99921536, 'binary_precision': 1.0, 'binary_recall': 0.9489144, 'binary_specificity': 1.0, 'binary_f1_score': 0.97378767}
confusion matrix:
      0    1
0  5997    0
1    40  743
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_19.png
early stop counter: 16
val acc:0.9645593762397766, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9974926114082336
after epoch: 19,now: 2024-06-03 19:10:16.573331,epoch time: 0:21:01.900667,used: 7:24:28.352908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99711144, 'precision': 0.98645514, 'recall': 0.99698496, 'specificity': 0.99698496, 'f1': 0.9916487, 'auroc': 0.99980175, 'binary_precision': 0.9732419, 'binary_recall': 0.996829, 'binary_specificity': 0.9971409, 'binary_f1_score': 0.98489434}
confusion matrix:
       0     1
0  42200   121
1     14  4401
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.7847867, 'recall': 0.7736627, 'specificity': 0.7736627, 'f1': 0.77910244, 'auroc': 0.95577127, 'binary_precision': 0.58508915, 'binary_recall': 0.5614308, 'binary_specificity': 0.98589456, 'binary_f1_score': 0.5730159}
confusion matrix:
       0    1
0  17893  256
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995575, 'precision': 0.99975, 'recall': 0.9980843, 'specificity': 0.9980843, 'f1': 0.9989152, 'auroc': 0.9999845, 'binary_precision': 1.0, 'binary_recall': 0.99616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.99808055}
confusion matrix:
      0    1
0  5997    0
1     3  780
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_20.png
new oracle model saved
early stop counter: 17
val acc:0.9713708162307739, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 20,now: 2024-06-03 19:30:26.592072,epoch time: 0:20:10.018741,used: 7:44:38.371649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99758214, 'precision': 0.99845976, 'recall': 0.9874084, 'specificity': 0.9874084, 'f1': 0.99285614, 'auroc': 0.9996333, 'binary_precision': 0.9995356, 'binary_recall': 0.9748641, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9870457}
confusion matrix:
       0     1
0  42318     2
1    111  4305
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7302884, 'recall': 0.5449482, 'specificity': 0.5449482, 'f1': 0.5696723, 'auroc': 0.95285326, 'binary_precision': 0.4918033, 'binary_recall': 0.0933126, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.15686274}
confusion matrix:
       0   1
0  18087  62
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9936578, 'precision': 0.9964404, 'recall': 0.9725415, 'specificity': 0.9725415, 'f1': 0.984097, 'auroc': 0.9996916, 'binary_precision': 1.0, 'binary_recall': 0.945083, 'binary_specificity': 1.0, 'binary_f1_score': 0.97176623}
confusion matrix:
      0    1
0  5997    0
1    43  740
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_21.png
early stop counter: 18
val acc:0.9656769037246704, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 21,now: 2024-06-03 19:50:17.402358,epoch time: 0:19:50.810286,used: 8:04:29.181935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.99710155, 'recall': 0.99488103, 'specificity': 0.99488103, 'f1': 0.99598813, 'auroc': 0.9998359, 'binary_precision': 0.9952186, 'binary_recall': 0.9902583, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.9927322}
confusion matrix:
       0     1
0  42301    21
1     43  4371
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.79349875, 'recall': 0.7089375, 'specificity': 0.7089375, 'f1': 0.7434305, 'auroc': 0.9538702, 'binary_precision': 0.607064, 'binary_recall': 0.42768273, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.5018248}
confusion matrix:
       0    1
0  17971  178
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.99801826, 'recall': 0.9896995, 'specificity': 0.9896995, 'f1': 0.99381185, 'auroc': 0.9997321, 'binary_precision': 0.99869794, 'binary_recall': 0.9795658, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9890393}
confusion matrix:
      0    1
0  5996    1
1    16  767
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_22.png
early stop counter: 19
val acc:0.9709450602531433, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 22,now: 2024-06-03 20:09:45.651850,epoch time: 0:19:28.249492,used: 8:23:57.431427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.99920094, 'recall': 0.9934182, 'specificity': 0.9934182, 'f1': 0.9962884, 'auroc': 0.99983674, 'binary_precision': 0.99977046, 'binary_recall': 0.98686, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9932733}
confusion matrix:
       0     1
0  42321     1
1     58  4356
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.90011555, 'recall': 0.54940856, 'specificity': 0.54940856, 'f1': 0.5808594, 'auroc': 0.9501021, 'binary_precision': 0.83116883, 'binary_recall': 0.09953344, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.17777778}
confusion matrix:
       0   1
0  18136  13
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.99994934, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_23.png
early stop counter: 20
val acc:0.9684972167015076, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 23,now: 2024-06-03 20:30:33.462903,epoch time: 0:20:47.811053,used: 8:44:45.242480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9981813, 'precision': 0.9983771, 'recall': 0.9909783, 'specificity': 0.9909783, 'f1': 0.99464285, 'auroc': 0.9998938, 'binary_precision': 0.99861753, 'binary_recall': 0.98209834, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99028903}
confusion matrix:
       0     1
0  42317     6
1     79  4334
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.6081218, 'recall': 0.50694954, 'specificity': 0.50694954, 'f1': 0.5056578, 'auroc': 0.9449155, 'binary_precision': 0.25, 'binary_recall': 0.0155521, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.029282577}
confusion matrix:
       0   1
0  18119  30
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99513274, 'precision': 0.99668086, 'recall': 0.9794824, 'specificity': 0.9794824, 'f1': 0.9878787, 'auroc': 0.9997468, 'binary_precision': 0.9986702, 'binary_recall': 0.95913154, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9785016}
confusion matrix:
      0    1
0  5996    1
1    32  751
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_24.png
early stop counter: 21
val acc:0.9647190570831299, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 24,now: 2024-06-03 20:53:11.852400,epoch time: 0:22:38.389497,used: 9:07:23.631977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.99911547, 'recall': 0.9915043, 'specificity': 0.9915043, 'f1': 0.9952731, 'auroc': 0.9997313, 'binary_precision': 1.0, 'binary_recall': 0.9830086, 'binary_specificity': 1.0, 'binary_f1_score': 0.99143153}
confusion matrix:
       0     1
0  42322     0
1     75  4339
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7962484, 'recall': 0.57380223, 'specificity': 0.57380223, 'f1': 0.61317825, 'auroc': 0.9533467, 'binary_precision': 0.6217949, 'binary_recall': 0.15085536, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.2428035}
confusion matrix:
       0   1
0  18090  59
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.99970645, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_25.png
early stop counter: 22
val acc:0.9678054451942444, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 25,now: 2024-06-03 21:15:17.022823,epoch time: 0:22:05.170423,used: 9:29:28.802400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.99846554, 'recall': 0.9928942, 'specificity': 0.9928942, 'f1': 0.9956601, 'auroc': 0.9998397, 'binary_precision': 0.99839413, 'binary_recall': 0.9859538, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9921349}
confusion matrix:
       0     1
0  42315     7
1     62  4352
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75716114, 'recall': 0.58072424, 'specificity': 0.58072424, 'f1': 0.61886257, 'auroc': 0.9459072, 'binary_precision': 0.5431472, 'binary_recall': 0.16640747, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.2547619}
confusion matrix:
       0    1
0  18059   90
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.9998746, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_26.png
early stop counter: 23
val acc:0.9666879773139954, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 26,now: 2024-06-03 21:35:00.019648,epoch time: 0:19:42.996825,used: 9:49:11.799225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99848086, 'precision': 0.996914, 'recall': 0.99418956, 'specificity': 0.99418956, 'f1': 0.99554706, 'auroc': 0.999809, 'binary_precision': 0.99498516, 'binary_recall': 0.98889893, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.9919327}
confusion matrix:
       0     1
0  42300    22
1     49  4365
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.76022327, 'recall': 0.73750716, 'specificity': 0.73750716, 'f1': 0.7482904, 'auroc': 0.94779956, 'binary_precision': 0.53846157, 'binary_recall': 0.48989114, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.5130293}
confusion matrix:
       0    1
0  17879  270
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99557525, 'precision': 0.9975112, 'recall': 0.98084295, 'specificity': 0.98084295, 'f1': 0.98898685, 'auroc': 0.9995275, 'binary_precision': 1.0, 'binary_recall': 0.96168584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98046875}
confusion matrix:
      0    1
0  5997    0
1    30  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_27.png
early stop counter: 24
val acc:0.9681779742240906, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 27,now: 2024-06-03 21:54:40.542663,epoch time: 0:19:40.523015,used: 10:08:52.322240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.998759, 'precision': 0.99839306, 'recall': 0.9943444, 'specificity': 0.9943444, 'f1': 0.9963584, 'auroc': 0.99981177, 'binary_precision': 0.99794286, 'binary_recall': 0.9889015, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99340165}
confusion matrix:
       0     1
0  42312     9
1     49  4366
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.8303354, 'recall': 0.6384599, 'specificity': 0.6384599, 'f1': 0.69212925, 'auroc': 0.95759827, 'binary_precision': 0.68560606, 'binary_recall': 0.281493, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.39911798}
confusion matrix:
       0    1
0  18066   83
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.99976397, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_28.png
early stop counter: 25
val acc:0.9709982872009277, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9974926114082336 / 0.9995574951171875
after epoch: 28,now: 2024-06-03 22:14:13.601675,epoch time: 0:19:33.059012,used: 10:28:25.381252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99901575, 'precision': 0.99782836, 'recall': 0.9964142, 'specificity': 0.9964142, 'f1': 0.99712, 'auroc': 0.99992454, 'binary_precision': 0.9963653, 'binary_recall': 0.9932065, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9947834}
confusion matrix:
       0     1
0  42304    16
1     30  4386
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.882287, 'recall': 0.61939925, 'specificity': 0.61939925, 'f1': 0.6775455, 'auroc': 0.9597579, 'binary_precision': 0.7908163, 'binary_recall': 0.24105754, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.3694875}
confusion matrix:
       0    1
0  18108   41
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9984376, 'recall': 0.9928924, 'specificity': 0.9928924, 'f1': 0.9956441, 'auroc': 0.9999267, 'binary_precision': 0.99870634, 'binary_recall': 0.9859515, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99228793}
confusion matrix:
      0    1
0  5996    1
1    11  772
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_29.png
better model found
persisted
after epoch: 29,now: 2024-06-03 22:33:51.653723,epoch time: 0:19:38.052048,used: 10:48:03.433300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99890876, 'precision': 0.9986813, 'recall': 0.9949354, 'specificity': 0.9949354, 'f1': 0.9967995, 'auroc': 0.9998722, 'binary_precision': 0.99840146, 'binary_recall': 0.99003625, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9942013}
confusion matrix:
       0     1
0  42313     7
1     44  4372
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.8125262, 'recall': 0.5961324, 'specificity': 0.5961324, 'f1': 0.6427717, 'auroc': 0.9470237, 'binary_precision': 0.65284973, 'binary_recall': 0.19595645, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.3014354}
confusion matrix:
       0    1
0  18082   67
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952802, 'precision': 0.99503976, 'recall': 0.98178655, 'specificity': 0.98178655, 'f1': 0.9882925, 'auroc': 0.9991114, 'binary_precision': 0.99472994, 'binary_recall': 0.9642401, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9792477}
confusion matrix:
      0    1
0  5993    4
1    28  755
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_30.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9718497395515442, corresponding to test acc:                         0.9982300996780396 / 0.9995574951171875
after epoch: 30,now: 2024-06-03 22:53:38.974634,epoch time: 0:19:47.320911,used: 11:07:50.754211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_45_48_seed_0_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:07:50.754211 at 2024-06-03 22:53:38.974634
persisted model performance metric: 

scalar performance:
{'acc': 0.9982301, 'precision': 0.9990015, 'recall': 0.99233717, 'specificity': 0.99233717, 'f1': 0.9956392, 'auroc': 0.99973035, 'binary_precision': 1.0, 'binary_recall': 0.98467433, 'binary_specificity': 1.0, 'binary_f1_score': 0.992278}
confusion matrix:
      0    1
0  5997    0
1    12  771
oracle model performance metric: 

scalar performance:
{'acc': 0.99941003, 'precision': 0.9996667, 'recall': 0.9974457, 'specificity': 0.9974457, 'f1': 0.9985529, 'auroc': 0.9997966, 'binary_precision': 1.0, 'binary_recall': 0.99489146, 'binary_specificity': 1.0, 'binary_f1_score': 0.9974392}
confusion matrix:
      0    1
0  5997    0
1     4  779
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456645 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456645 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |  41783 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447778 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |  40703 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446523 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |  11464 KiB |     17 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3680    |    6847    |  210921 K  |  210917 K  |
|       from large pool |     187    |    1413    |  109805 K  |  109805 K  |
|       from small pool |    3493    |    6658    |  101115 K  |  101112 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3680    |    6847    |  210921 K  |  210917 K  |
|       from large pool |     187    |    1413    |  109805 K  |  109805 K  |
|       from small pool |    3493    |    6658    |  101115 K  |  101112 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2987    |  134531 K  |  134531 K  |
|       from large pool |      37    |     600    |   82212 K  |   82212 K  |
|       from small pool |      40    |    2949    |   52319 K  |   52319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |     43 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101115 K  |  101115 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101115 K  |  101115 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2987    |  134533 K  |  134533 K  |
|       from large pool |       4    |     600    |   82212 K  |   82212 K  |
|       from small pool |       0    |    2949    |   52320 K  |   52320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1207 TiB |   1207 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1193 TiB |   1193 TiB |
|       from small pool |      0 KiB |     57 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1199 TiB |   1199 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1185 TiB |   1185 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    857 TiB |    857 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |     43 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101115 K  |  101115 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  210921 K  |  210921 K  |
|       from large pool |       2    |    1413    |  109805 K  |  109805 K  |
|       from small pool |       0    |    6658    |  101115 K  |  101115 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2987    |  134533 K  |  134533 K  |
|       from large pool |       4    |     600    |   82212 K  |   82212 K  |
|       from small pool |       0    |    2949    |   52320 K  |   52320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742

 Experiment start at: 2024-06-03 23:00:08.364279
before training, model accuracy: 0.18421052396297455
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9939019, 'precision': 0.9800862, 'recall': 0.9837699, 'specificity': 0.9837699, 'f1': 0.98191917, 'auroc': 0.99815917, 'binary_precision': 0.96309876, 'binary_recall': 0.9713361, 'binary_specificity': 0.9962037, 'binary_f1_score': 0.9671999}
confusion matrix:
       0     1
0  42249   161
1    124  4202
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.72967523, 'recall': 0.7820835, 'specificity': 0.7820835, 'f1': 0.75283575, 'auroc': 0.92448366, 'binary_precision': 0.47482014, 'binary_recall': 0.5884101, 'binary_specificity': 0.9757569, 'binary_f1_score': 0.52554744}
confusion matrix:
       0    1
0  17629  438
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9895926, 'precision': 0.9792508, 'recall': 0.96960855, 'specificity': 0.96960855, 'f1': 0.97436345, 'auroc': 0.99598813, 'binary_precision': 0.96587926, 'binary_recall': 0.94358975, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.9546044}
confusion matrix:
      0    1
0  5920   26
1    44  736
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 23:20:23.539701,epoch time: 0:20:15.175422,used: 0:20:15.175422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9960844, 'precision': 0.9951619, 'recall': 0.9814436, 'specificity': 0.9814436, 'f1': 0.98818225, 'auroc': 0.99827504, 'binary_precision': 0.9940377, 'binary_recall': 0.96347666, 'binary_specificity': 0.9994105, 'binary_f1_score': 0.9785186}
confusion matrix:
       0     1
0  42385    25
1    158  4168
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.8029679, 'recall': 0.6410035, 'specificity': 0.6410035, 'f1': 0.6898496, 'auroc': 0.9111811, 'binary_precision': 0.6319218, 'binary_recall': 0.2882615, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.39591837}
confusion matrix:
       0    1
0  17954  113
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927148, 'precision': 0.9947169, 'recall': 0.9697036, 'specificity': 0.9697036, 'f1': 0.98177594, 'auroc': 0.9985235, 'binary_precision': 0.9972789, 'binary_recall': 0.9397436, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9676568}
confusion matrix:
      0    1
0  5944    2
1    47  733
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-03 23:39:58.091528,epoch time: 0:19:34.551827,used: 0:39:49.727249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99561363, 'precision': 0.9873857, 'recall': 0.98647475, 'specificity': 0.98647475, 'f1': 0.98692966, 'auroc': 0.99865377, 'binary_precision': 0.9772938, 'binary_recall': 0.97526014, 'binary_specificity': 0.9976893, 'binary_f1_score': 0.9762759}
confusion matrix:
       0     1
0  42313    98
1    107  4218
---- Validation: 
scalar performance:
{'acc': 0.94770545, 'precision': 0.6617408, 'recall': 0.7304031, 'specificity': 0.7304031, 'f1': 0.688995, 'auroc': 0.924901, 'binary_precision': 0.3425641, 'binary_recall': 0.4962853, 'binary_specificity': 0.96452093, 'binary_f1_score': 0.40533978}
confusion matrix:
       0    1
0  17426  641
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99330956, 'precision': 0.99564815, 'recall': 0.9717108, 'specificity': 0.9717108, 'f1': 0.98328286, 'auroc': 0.9982277, 'binary_precision': 0.99864316, 'binary_recall': 0.94358975, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9703362}
confusion matrix:
      0    1
0  5945    1
1    44  736
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_3.png
new oracle model saved
early stop counter: 1
val acc:0.9477054476737976, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9933095574378967
after epoch: 3,now: 2024-06-03 23:59:42.088480,epoch time: 0:19:43.996952,used: 0:59:33.724201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.995956, 'precision': 0.9901078, 'recall': 0.9857259, 'specificity': 0.9857259, 'f1': 0.9879045, 'auroc': 0.99874985, 'binary_precision': 0.9829479, 'binary_recall': 0.97317296, 'binary_specificity': 0.9982788, 'binary_f1_score': 0.978036}
confusion matrix:
       0     1
0  42339    73
1    116  4208
---- Validation: 
scalar performance:
{'acc': 0.95773745, 'precision': 0.7043147, 'recall': 0.7449044, 'specificity': 0.7449044, 'f1': 0.72251093, 'auroc': 0.92267513, 'binary_precision': 0.42681426, 'binary_recall': 0.51560175, 'binary_specificity': 0.9742071, 'binary_f1_score': 0.46702555}
confusion matrix:
       0    1
0  17601  466
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927148, 'precision': 0.9935355, 'recall': 0.9708175, 'specificity': 0.9708175, 'f1': 0.98181784, 'auroc': 0.9978141, 'binary_precision': 0.9945873, 'binary_recall': 0.9423077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.96774197}
confusion matrix:
      0    1
0  5942    4
1    45  735
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_4.png
early stop counter: 2
val acc:0.9577374458312988, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9933095574378967
after epoch: 4,now: 2024-06-04 00:19:37.144167,epoch time: 0:19:55.055687,used: 1:19:28.779888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99156964, 'precision': 0.9633823, 'recall': 0.9886068, 'specificity': 0.9886068, 'f1': 0.9755702, 'auroc': 0.99925244, 'binary_precision': 0.9283068, 'binary_recall': 0.9849711, 'binary_specificity': 0.9922426, 'binary_f1_score': 0.9557999}
confusion matrix:
       0     1
0  42082   329
1     65  4260
---- Validation: 
scalar performance:
{'acc': 0.9229989, 'precision': 0.64043635, 'recall': 0.8570668, 'specificity': 0.8570668, 'f1': 0.6908887, 'auroc': 0.9315956, 'binary_precision': 0.28938732, 'binary_recall': 0.7860327, 'binary_specificity': 0.92810094, 'binary_f1_score': 0.42303076}
confusion matrix:
       0     1
0  16768  1299
1    144   529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99122804, 'precision': 0.9788641, 'recall': 0.9783306, 'specificity': 0.9783306, 'f1': 0.97859716, 'auroc': 0.99847066, 'binary_precision': 0.9627728, 'binary_recall': 0.96153843, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.9621552}
confusion matrix:
      0    1
0  5917   29
1    30  750
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_5.png
early stop counter: 3
val acc:0.9229989051818848, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9933095574378967
after epoch: 5,now: 2024-06-04 00:39:26.334902,epoch time: 0:19:49.190735,used: 1:39:17.970623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9953355, 'precision': 0.997223, 'recall': 0.97499955, 'specificity': 0.97499955, 'f1': 0.9857943, 'auroc': 0.99877846, 'binary_precision': 0.9995134, 'binary_recall': 0.95004624, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9741522}
confusion matrix:
       0     1
0  42410     2
1    216  4108
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.76351875, 'recall': 0.50649273, 'specificity': 0.50649273, 'f1': 0.5039433, 'auroc': 0.9318048, 'binary_precision': 0.5625, 'binary_recall': 0.013372957, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.026124818}
confusion matrix:
       0  1
0  18060  7
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9918228, 'precision': 0.9954174, 'recall': 0.9647436, 'specificity': 0.9647436, 'f1': 0.9794257, 'auroc': 0.996918, 'binary_precision': 1.0, 'binary_recall': 0.92948717, 'binary_specificity': 1.0, 'binary_f1_score': 0.96345514}
confusion matrix:
      0    1
0  5946    0
1    55  725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_6.png
early stop counter: 4
val acc:0.9641942381858826, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9933095574378967
after epoch: 6,now: 2024-06-04 00:59:11.932539,epoch time: 0:19:45.597637,used: 1:59:03.568260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99358094, 'precision': 0.97265846, 'recall': 0.9902357, 'specificity': 0.9902357, 'f1': 0.9812441, 'auroc': 0.9990158, 'binary_precision': 0.9467377, 'binary_recall': 0.98613036, 'binary_specificity': 0.99434096, 'binary_f1_score': 0.9660326}
confusion matrix:
       0     1
0  42170   240
1     60  4266
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.72741705, 'recall': 0.73716, 'specificity': 0.73716, 'f1': 0.73217314, 'auroc': 0.9335482, 'binary_precision': 0.47368422, 'binary_recall': 0.4947994, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.48401162}
confusion matrix:
       0    1
0  17697  370
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.995494, 'recall': 0.9899641, 'specificity': 0.9899641, 'f1': 0.9927082, 'auroc': 0.99978304, 'binary_precision': 0.9935065, 'binary_recall': 0.9807692, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.9870968}
confusion matrix:
      0    1
0  5941    5
1    15  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_7.png
new oracle model saved
early stop counter: 5
val acc:0.9621131420135498, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 7,now: 2024-06-04 01:18:47.027668,epoch time: 0:19:35.095129,used: 2:18:38.663389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9973682, 'precision': 0.997487, 'recall': 0.98682153, 'specificity': 0.98682153, 'f1': 0.992082, 'auroc': 0.9994863, 'binary_precision': 0.997632, 'binary_recall': 0.97387886, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9856124}
confusion matrix:
       0     1
0  42400    10
1    113  4213
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.5739781, 'recall': 0.52289486, 'specificity': 0.52289486, 'f1': 0.53128237, 'auroc': 0.92880046, 'binary_precision': 0.18226601, 'binary_recall': 0.05497771, 'binary_specificity': 0.990812, 'binary_f1_score': 0.084474884}
confusion matrix:
       0    1
0  17901  166
1    636   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9936069, 'precision': 0.9946383, 'recall': 0.97410667, 'specificity': 0.97410667, 'f1': 0.98408085, 'auroc': 0.9992349, 'binary_precision': 0.9959623, 'binary_recall': 0.94871795, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.9717663}
confusion matrix:
      0    1
0  5943    3
1    40  740
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_8.png
early stop counter: 6
val acc:0.9572038650512695, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 8,now: 2024-06-04 01:38:40.313844,epoch time: 0:19:53.286176,used: 2:38:31.949565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.99852824, 'recall': 0.98783493, 'specificity': 0.98783493, 'f1': 0.9931091, 'auroc': 0.99976987, 'binary_precision': 0.9995262, 'binary_recall': 0.97571695, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.98747814}
confusion matrix:
       0     1
0  42410     2
1    105  4219
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.78674567, 'recall': 0.5224777, 'specificity': 0.5224777, 'f1': 0.53381234, 'auroc': 0.9282949, 'binary_precision': 0.60784316, 'binary_recall': 0.046062406, 'binary_specificity': 0.998893, 'binary_f1_score': 0.08563536}
confusion matrix:
       0   1
0  18047  20
1    642  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9927148, 'precision': 0.99591327, 'recall': 0.9685898, 'specificity': 0.9685898, 'f1': 0.9817338, 'auroc': 0.9998597, 'binary_precision': 1.0, 'binary_recall': 0.9371795, 'binary_specificity': 1.0, 'binary_f1_score': 0.96757114}
confusion matrix:
      0    1
0  5946    0
1    49  731
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_9.png
early stop counter: 7
val acc:0.9646744728088379, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 9,now: 2024-06-04 01:58:47.387223,epoch time: 0:20:07.073379,used: 2:58:39.022944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9954639, 'precision': 0.99751306, 'recall': 0.975497, 'specificity': 0.975497, 'f1': 0.98619413, 'auroc': 0.99918604, 'binary_precision': 1.0, 'binary_recall': 0.950994, 'binary_specificity': 1.0, 'binary_f1_score': 0.97488153}
confusion matrix:
       0     1
0  42410     0
1    212  4114
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.9485255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99212015, 'precision': 0.9955826, 'recall': 0.96602565, 'specificity': 0.96602565, 'f1': 0.98019695, 'auroc': 0.999125, 'binary_precision': 1.0, 'binary_recall': 0.9320513, 'binary_specificity': 1.0, 'binary_f1_score': 0.9648308}
confusion matrix:
      0    1
0  5946    0
1    53  727
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_10.png
early stop counter: 8
val acc:0.9639807939529419, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 10,now: 2024-06-04 02:18:53.208266,epoch time: 0:20:05.821043,used: 3:18:44.843987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99696165, 'precision': 0.9983314, 'recall': 0.9835876, 'specificity': 0.9835876, 'f1': 0.99082124, 'auroc': 0.999732, 'binary_precision': 1.0, 'binary_recall': 0.96717525, 'binary_specificity': 1.0, 'binary_f1_score': 0.98331374}
confusion matrix:
       0     1
0  42410     0
1    142  4184
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7321676, 'recall': 0.50357634, 'specificity': 0.50357634, 'f1': 0.4981759, 'auroc': 0.9481449, 'binary_precision': 0.5, 'binary_recall': 0.0074294205, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.014641289}
confusion matrix:
       0  1
0  18062  5
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99479634, 'precision': 0.99707407, 'recall': 0.9775641, 'specificity': 0.9775641, 'f1': 0.9870573, 'auroc': 0.9998075, 'binary_precision': 1.0, 'binary_recall': 0.9551282, 'binary_specificity': 1.0, 'binary_f1_score': 0.9770492}
confusion matrix:
      0    1
0  5946    0
1    35  745
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 11,now: 2024-06-04 02:38:54.484584,epoch time: 0:20:01.276318,used: 3:38:46.120305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.9984465, 'recall': 0.9904613, 'specificity': 0.9904613, 'f1': 0.99441355, 'auroc': 0.9992626, 'binary_precision': 0.998823, 'binary_recall': 0.9810405, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9898519}
confusion matrix:
       0     1
0  42406     5
1     82  4243
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.72499967, 'recall': 0.5221179, 'specificity': 0.5221179, 'f1': 0.53287697, 'auroc': 0.9342274, 'binary_precision': 0.484375, 'binary_recall': 0.046062406, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.08412483}
confusion matrix:
       0   1
0  18034  33
1    642  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9967396, 'recall': 0.9800441, 'specificity': 0.9800441, 'f1': 0.9882004, 'auroc': 0.99951077, 'binary_precision': 0.99866664, 'binary_recall': 0.9602564, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9790849}
confusion matrix:
      0    1
0  5945    1
1    31  749
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_12.png
early stop counter: 10
val acc:0.9639807939529419, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 12,now: 2024-06-04 02:58:52.978609,epoch time: 0:19:58.494025,used: 3:58:44.614330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99758214, 'precision': 0.9978188, 'recall': 0.987767, 'specificity': 0.987767, 'f1': 0.9927288, 'auroc': 0.9994643, 'binary_precision': 0.99810785, 'binary_recall': 0.97572255, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9867883}
confusion matrix:
       0     1
0  42403     8
1    105  4220
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.66564226, 'recall': 0.5076465, 'specificity': 0.5076465, 'f1': 0.5063887, 'auroc': 0.9355812, 'binary_precision': 0.36666667, 'binary_recall': 0.016344724, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.03129445}
confusion matrix:
       0   1
0  18048  19
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9967396, 'recall': 0.9800441, 'specificity': 0.9800441, 'f1': 0.9882004, 'auroc': 0.9988737, 'binary_precision': 0.99866664, 'binary_recall': 0.9602564, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9790849}
confusion matrix:
      0    1
0  5945    1
1    31  749
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_13.png
early stop counter: 11
val acc:0.9636605978012085, best validation acc: 0.9684098362922668, corresponding to test acc:                         0.9927148222923279 / 0.9970264434814453
after epoch: 13,now: 2024-06-04 03:18:34.463402,epoch time: 0:19:41.484793,used: 4:18:26.099123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9974752, 'precision': 0.9985056, 'recall': 0.9864622, 'specificity': 0.9864622, 'f1': 0.9923918, 'auroc': 0.9994203, 'binary_precision': 0.9997624, 'binary_recall': 0.97294796, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.986173}
confusion matrix:
       0     1
0  42410     1
1    117  4208
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.943501, 'recall': 0.58959156, 'specificity': 0.58959156, 'f1': 0.64263505, 'auroc': 0.93801725, 'binary_precision': 0.9166667, 'binary_recall': 0.17979197, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.30062112}
confusion matrix:
       0    1
0  18056   11
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99330956, 'precision': 0.9962444, 'recall': 0.97115386, 'specificity': 0.97115386, 'f1': 0.9832636, 'auroc': 0.99990714, 'binary_precision': 1.0, 'binary_recall': 0.9423077, 'binary_specificity': 1.0, 'binary_f1_score': 0.97029704}
confusion matrix:
      0    1
0  5946    0
1    45  735
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_14.png
better model found
persisted
after epoch: 14,now: 2024-06-04 03:38:28.377847,epoch time: 0:19:53.914445,used: 4:38:20.013568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9758002, 'precision': 0.8975079, 'recall': 0.98386353, 'specificity': 0.98386353, 'f1': 0.935122, 'auroc': 0.99931896, 'binary_precision': 0.7956691, 'binary_recall': 0.9937587, 'binary_specificity': 0.9739684, 'binary_f1_score': 0.8837496}
confusion matrix:
       0     1
0  41306  1104
1     27  4299
---- Validation: 
scalar performance:
{'acc': 0.9417823, 'precision': 0.65400827, 'recall': 0.7645251, 'specificity': 0.7645251, 'f1': 0.691877, 'auroc': 0.9066503, 'binary_precision': 0.32436976, 'binary_recall': 0.57355124, 'binary_specificity': 0.955499, 'binary_f1_score': 0.41438544}
confusion matrix:
       0    1
0  17263  804
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937556, 'precision': 0.9801909, 'recall': 0.98978496, 'specificity': 0.98978496, 'f1': 0.98492336, 'auroc': 0.9990653, 'binary_precision': 0.96240604, 'binary_recall': 0.9846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.97338396}
confusion matrix:
      0    1
0  5916   30
1    12  768
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_15.png
early stop counter: 1
val acc:0.9417822957038879, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 15,now: 2024-06-04 03:58:20.888488,epoch time: 0:19:52.510641,used: 4:58:12.524209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.9978713, 'recall': 0.9938365, 'specificity': 0.9938365, 'f1': 0.99584365, 'auroc': 0.9995794, 'binary_precision': 0.99696755, 'binary_recall': 0.98797965, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.9924533}
confusion matrix:
       0     1
0  42397    13
1     52  4274
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.6923121, 'recall': 0.53592515, 'specificity': 0.53592515, 'f1': 0.5547057, 'auroc': 0.9356426, 'binary_precision': 0.4180328, 'binary_recall': 0.075780086, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.12830187}
confusion matrix:
       0   1
0  17996  71
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.9994165, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_16.png
early stop counter: 2
val acc:0.9630202651023865, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 16,now: 2024-06-04 04:18:23.776813,epoch time: 0:20:02.888325,used: 5:18:15.412534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9942015, 'precision': 0.9851395, 'recall': 0.9801985, 'specificity': 0.9801985, 'f1': 0.9826531, 'auroc': 0.9986708, 'binary_precision': 0.97404724, 'binary_recall': 0.9630143, 'binary_specificity': 0.9973827, 'binary_f1_score': 0.96849936}
confusion matrix:
       0     1
0  42299   111
1    160  4166
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.75831556, 'recall': 0.54825497, 'specificity': 0.54825497, 'f1': 0.57526755, 'auroc': 0.9262457, 'binary_precision': 0.5491803, 'binary_recall': 0.09955423, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.16855346}
confusion matrix:
       0   1
0  18012  55
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9904847, 'precision': 0.99104416, 'recall': 0.9623159, 'specificity': 0.9623159, 'f1': 0.9761007, 'auroc': 0.9975948, 'binary_precision': 0.9917582, 'binary_recall': 0.925641, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.9575597}
confusion matrix:
      0    1
0  5940    6
1    58  722
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_17.png
early stop counter: 3
val acc:0.9647278785705566, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 17,now: 2024-06-04 04:38:39.381041,epoch time: 0:20:15.604228,used: 5:38:31.016762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.99828, 'recall': 0.98655736, 'specificity': 0.98655736, 'f1': 0.9923314, 'auroc': 0.99935746, 'binary_precision': 0.9992879, 'binary_recall': 0.9731854, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9860639}
confusion matrix:
       0     1
0  42407     3
1    116  4210
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.6385303, 'recall': 0.50682056, 'specificity': 0.50682056, 'f1': 0.504871, 'auroc': 0.92224824, 'binary_precision': 0.3125, 'binary_recall': 0.014858841, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.028368793}
confusion matrix:
       0   1
0  18045  22
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405295, 'precision': 0.9925952, 'recall': 0.97825754, 'specificity': 0.97825754, 'f1': 0.9852841, 'auroc': 0.9969761, 'binary_precision': 0.99071616, 'binary_recall': 0.9576923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.9739244}
confusion matrix:
      0    1
0  5939    7
1    33  747
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_18.png
early stop counter: 4
val acc:0.9634471535682678, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 18,now: 2024-06-04 04:58:43.286198,epoch time: 0:20:03.905157,used: 5:58:34.921919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9982027, 'precision': 0.99901164, 'recall': 0.99029124, 'specificity': 0.99029124, 'f1': 0.9946034, 'auroc': 0.99972653, 'binary_precision': 1.0, 'binary_recall': 0.98058254, 'binary_specificity': 1.0, 'binary_f1_score': 0.9901961}
confusion matrix:
       0     1
0  42410     0
1     84  4242
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.85712, 'recall': 0.50220114, 'specificity': 0.50220114, 'f1': 0.4953152, 'auroc': 0.9529526, 'binary_precision': 0.75, 'binary_recall': 0.004457652, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.008862629}
confusion matrix:
       0  1
0  18066  1
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.99935114, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_19.png
early stop counter: 5
val acc:0.9641942381858826, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 19,now: 2024-06-04 05:18:31.486957,epoch time: 0:19:48.200759,used: 6:18:23.122678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9977961, 'precision': 0.99688625, 'recall': 0.9899635, 'specificity': 0.9899635, 'f1': 0.9933945, 'auroc': 0.9993931, 'binary_precision': 0.9957737, 'binary_recall': 0.9803514, 'binary_specificity': 0.99957556, 'binary_f1_score': 0.98800236}
confusion matrix:
       0     1
0  42392    18
1     85  4241
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.8205106, 'recall': 0.54669034, 'specificity': 0.54669034, 'f1': 0.5746168, 'auroc': 0.9493148, 'binary_precision': 0.67368424, 'binary_recall': 0.09509658, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.16666667}
confusion matrix:
       0   1
0  18036  31
1    609  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99692565, 'recall': 0.9863703, 'specificity': 0.9863703, 'f1': 0.99157184, 'auroc': 0.9994894, 'binary_precision': 0.99737185, 'binary_recall': 0.97307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.98507464}
confusion matrix:
      0    1
0  5944    2
1    21  759
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_20.png
early stop counter: 6
val acc:0.965848445892334, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 20,now: 2024-06-04 05:37:36.495131,epoch time: 0:19:05.008174,used: 6:37:28.130852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9973896, 'precision': 0.9955023, 'recall': 0.9889066, 'specificity': 0.9889066, 'f1': 0.9921768, 'auroc': 0.99962723, 'binary_precision': 0.9931941, 'binary_recall': 0.9784971, 'binary_specificity': 0.9993162, 'binary_f1_score': 0.98579085}
confusion matrix:
       0     1
0  42382    29
1     93  4232
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.7269493, 'recall': 0.6133954, 'specificity': 0.6133954, 'f1': 0.64913493, 'auroc': 0.92367446, 'binary_precision': 0.48181817, 'binary_recall': 0.23625557, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.31704885}
confusion matrix:
       0    1
0  17896  171
1    514  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.99228704, 'recall': 0.9851406, 'specificity': 0.9851406, 'f1': 0.98867863, 'auroc': 0.99969316, 'binary_precision': 0.988266, 'binary_recall': 0.97179484, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.9799612}
confusion matrix:
      0    1
0  5937    9
1    22  758
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_21.png
early stop counter: 7
val acc:0.9634471535682678, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 21,now: 2024-06-04 05:56:32.617848,epoch time: 0:18:56.122717,used: 6:56:24.253569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.9963509, 'recall': 0.9935663, 'specificity': 0.9935663, 'f1': 0.99495363, 'auroc': 0.9995692, 'binary_precision': 0.99395066, 'binary_recall': 0.98774564, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9908384}
confusion matrix:
       0     1
0  42385    26
1     53  4272
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.75678635, 'recall': 0.7228122, 'specificity': 0.7228122, 'f1': 0.73845834, 'auroc': 0.9450969, 'binary_precision': 0.53356284, 'binary_recall': 0.46062407, 'binary_specificity': 0.98500025, 'binary_f1_score': 0.49441788}
confusion matrix:
       0    1
0  17796  271
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956884, 'precision': 0.99757326, 'recall': 0.98141026, 'specificity': 0.98141026, 'f1': 0.9893127, 'auroc': 0.99949956, 'binary_precision': 1.0, 'binary_recall': 0.96282053, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810581}
confusion matrix:
      0    1
0  5946    0
1    29  751
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_22.png
early stop counter: 8
val acc:0.9661686420440674, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 22,now: 2024-06-04 06:15:21.792671,epoch time: 0:18:49.174823,used: 7:15:13.428392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9977105, 'precision': 0.9987417, 'recall': 0.98763293, 'specificity': 0.98763293, 'f1': 0.9931091, 'auroc': 0.9997407, 'binary_precision': 1.0, 'binary_recall': 0.97526586, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874781}
confusion matrix:
       0     1
0  42410     0
1    107  4219
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.69640285, 'recall': 0.5021181, 'specificity': 0.5021181, 'f1': 0.49525416, 'auroc': 0.954934, 'binary_precision': 0.42857143, 'binary_recall': 0.004457652, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.008823529}
confusion matrix:
       0  1
0  18063  4
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99509364, 'precision': 0.9972403, 'recall': 0.9788462, 'specificity': 0.9788462, 'f1': 0.98781085, 'auroc': 0.9997804, 'binary_precision': 1.0, 'binary_recall': 0.9576923, 'binary_specificity': 1.0, 'binary_f1_score': 0.97838897}
confusion matrix:
      0    1
0  5946    0
1    33  747
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_23.png
early stop counter: 9
val acc:0.9640341401100159, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 23,now: 2024-06-04 06:34:11.169804,epoch time: 0:18:49.377133,used: 7:34:02.805525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99756074, 'precision': 0.9964372, 'recall': 0.9890034, 'specificity': 0.9890034, 'f1': 0.9926852, 'auroc': 0.9995656, 'binary_precision': 0.9950635, 'binary_recall': 0.9785021, 'binary_specificity': 0.9995048, 'binary_f1_score': 0.9867133}
confusion matrix:
       0     1
0  42389    21
1     93  4233
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.7717485, 'recall': 0.71214277, 'specificity': 0.71214277, 'f1': 0.7378808, 'auroc': 0.94674706, 'binary_precision': 0.5642994, 'binary_recall': 0.43684992, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.49246234}
confusion matrix:
       0    1
0  17840  227
1    379  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99316084, 'precision': 0.9961616, 'recall': 0.9705128, 'specificity': 0.9705128, 'f1': 0.9828818, 'auroc': 0.99938464, 'binary_precision': 1.0, 'binary_recall': 0.9410256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9696169}
confusion matrix:
      0    1
0  5946    0
1    46  734
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_24.png
early stop counter: 10
val acc:0.9676627516746521, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 24,now: 2024-06-04 06:53:14.650014,epoch time: 0:19:03.480210,used: 7:53:06.285735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.99931926, 'recall': 0.99558437, 'specificity': 0.99558437, 'f1': 0.9974431, 'auroc': 0.9999052, 'binary_precision': 0.9995338, 'binary_recall': 0.9912159, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9953575}
confusion matrix:
       0     1
0  42408     2
1     38  4288
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.89702404, 'recall': 0.58623236, 'specificity': 0.58623236, 'f1': 0.6356352, 'auroc': 0.9485758, 'binary_precision': 0.8239437, 'binary_recall': 0.17384844, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.28711656}
confusion matrix:
       0    1
0  18042   25
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.99979275, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_25.png
early stop counter: 11
val acc:0.9689968228340149, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9970264434814453
after epoch: 25,now: 2024-06-04 07:12:23.330574,epoch time: 0:19:08.680560,used: 8:12:14.966295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.9986249, 'recall': 0.99219716, 'specificity': 0.99219716, 'f1': 0.995385, 'auroc': 0.9996399, 'binary_precision': 0.9988274, 'binary_recall': 0.98451227, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9916182}
confusion matrix:
       0     1
0  42405     5
1     67  4259
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.8172563, 'recall': 0.5539537, 'specificity': 0.5539537, 'f1': 0.58572197, 'auroc': 0.9351726, 'binary_precision': 0.6666667, 'binary_recall': 0.10995542, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.18877551}
confusion matrix:
       0   1
0  18030  37
1    599  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.9981734, 'recall': 0.9909415, 'specificity': 0.9909415, 'f1': 0.9945219, 'auroc': 0.99966514, 'binary_precision': 0.9986962, 'binary_recall': 0.98205125, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9903038}
confusion matrix:
      0    1
0  5945    1
1    14  766
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_26.png
new oracle model saved
early stop counter: 12
val acc:0.9660618901252747, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.997769832611084
after epoch: 26,now: 2024-06-04 07:31:32.025987,epoch time: 0:19:08.695413,used: 8:31:23.661708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9981385, 'precision': 0.9989764, 'recall': 0.9899445, 'specificity': 0.9899445, 'f1': 0.99440885, 'auroc': 0.9997862, 'binary_precision': 1.0, 'binary_recall': 0.97988904, 'binary_specificity': 1.0, 'binary_f1_score': 0.98984236}
confusion matrix:
       0     1
0  42410     0
1     87  4239
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.85757804, 'recall': 0.51540804, 'specificity': 0.51540804, 'f1': 0.5209983, 'auroc': 0.94066983, 'binary_precision': 0.75, 'binary_recall': 0.031203566, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.059914406}
confusion matrix:
       0   1
0  18060   7
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934582, 'precision': 0.9963272, 'recall': 0.97179484, 'specificity': 0.97179484, 'f1': 0.98364496, 'auroc': 0.9995909, 'binary_precision': 1.0, 'binary_recall': 0.94358975, 'binary_specificity': 1.0, 'binary_f1_score': 0.9709763}
confusion matrix:
      0    1
0  5946    0
1    44  736
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_27.png
early stop counter: 13
val acc:0.9648345708847046, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.997769832611084
after epoch: 27,now: 2024-06-04 07:50:38.293747,epoch time: 0:19:06.267760,used: 8:50:29.929468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.995956, 'precision': 0.9826357, 'recall': 0.9937239, 'specificity': 0.9937239, 'f1': 0.9881004, 'auroc': 0.99944204, 'binary_precision': 0.9661934, 'binary_recall': 0.99098474, 'binary_specificity': 0.9964631, 'binary_f1_score': 0.978432}
confusion matrix:
       0     1
0  42260   150
1     39  4287
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.79491216, 'recall': 0.70092416, 'specificity': 0.70092416, 'f1': 0.7381365, 'auroc': 0.92896014, 'binary_precision': 0.61147904, 'binary_recall': 0.4115899, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.4920071}
confusion matrix:
       0    1
0  17891  176
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9995172, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_28.png
early stop counter: 14
val acc:0.9694770574569702, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.997769832611084
after epoch: 28,now: 2024-06-04 08:09:32.983819,epoch time: 0:18:54.690072,used: 9:09:24.619540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976891, 'precision': 0.9918152, 'recall': 0.99446917, 'specificity': 0.99446917, 'f1': 0.99313766, 'auroc': 0.9998363, 'binary_precision': 0.9845977, 'binary_recall': 0.99051803, 'binary_specificity': 0.99842024, 'binary_f1_score': 0.98754895}
confusion matrix:
       0     1
0  42345    67
1     41  4283
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.79201615, 'recall': 0.6899461, 'specificity': 0.6899461, 'f1': 0.7291179, 'auroc': 0.93941444, 'binary_precision': 0.6064815, 'binary_recall': 0.38930163, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.47420818}
confusion matrix:
       0    1
0  17897  170
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9985119, 'recall': 0.9935056, 'specificity': 0.9935056, 'f1': 0.99599177, 'auroc': 0.9998598, 'binary_precision': 0.998703, 'binary_recall': 0.98717946, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99290776}
confusion matrix:
      0    1
0  5945    1
1    10  770
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_29.png
new oracle model saved
early stop counter: 15
val acc:0.9689968228340149, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9983645677566528
after epoch: 29,now: 2024-06-04 08:28:23.403011,epoch time: 0:18:50.419192,used: 9:28:15.038732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.9981638, 'recall': 0.9899776, 'specificity': 0.9899776, 'f1': 0.99402833, 'auroc': 0.99933815, 'binary_precision': 0.99835175, 'binary_recall': 0.9801202, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.98915195}
confusion matrix:
       0     1
0  42403     7
1     86  4240
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.71857476, 'recall': 0.51210415, 'specificity': 0.51210415, 'f1': 0.514799, 'auroc': 0.88503975, 'binary_precision': 0.4722222, 'binary_recall': 0.02526003, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.047954865}
confusion matrix:
       0   1
0  18048  19
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99330956, 'precision': 0.9938818, 'recall': 0.97338164, 'specificity': 0.97338164, 'f1': 0.9833404, 'auroc': 0.99858534, 'binary_precision': 0.99461645, 'binary_recall': 0.9474359, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.9704531}
confusion matrix:
      0    1
0  5942    4
1    41  739
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_30.png
early stop counter: 16
val acc:0.9639807939529419, best validation acc: 0.9699572920799255, corresponding to test acc:                         0.9933095574378967 / 0.9983645677566528
after epoch: 30,now: 2024-06-04 08:47:10.172643,epoch time: 0:18:46.769632,used: 9:47:01.808364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_23_00_08_seed_1_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:47:01.808364 at 2024-06-04 08:47:10.172643
persisted model performance metric: 

scalar performance:
{'acc': 0.99316084, 'precision': 0.9961616, 'recall': 0.9705128, 'specificity': 0.9705128, 'f1': 0.9828818, 'auroc': 0.99962926, 'binary_precision': 1.0, 'binary_recall': 0.9410256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9696169}
confusion matrix:
      0    1
0  5946    0
1    46  734
oracle model performance metric: 

scalar performance:
{'acc': 0.99702644, 'precision': 0.99775094, 'recall': 0.9877364, 'specificity': 0.9877364, 'f1': 0.9926753, 'auroc': 0.9996897, 'binary_precision': 0.9986877, 'binary_recall': 0.975641, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9870298}
confusion matrix:
      0    1
0  5945    1
1    19  761
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |  41774 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447776 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |  40701 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  28072 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444814 KiB |   1251 MiB |   1714 TiB |   1714 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |   9425 KiB |     43 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6847    |  421940 K  |  421936 K  |
|       from large pool |     187    |    1413    |  219699 K  |  219699 K  |
|       from small pool |    3475    |    6658    |  202240 K  |  202237 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6847    |  421940 K  |  421936 K  |
|       from large pool |     187    |    1413    |  219699 K  |  219699 K  |
|       from small pool |    3475    |    6658    |  202240 K  |  202237 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1205    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2990    |  264567 K  |  264567 K  |
|       from large pool |      40    |     604    |  159470 K  |  159470 K  |
|       from small pool |      40    |    2949    |  105096 K  |  105096 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28072 MiB |  27192 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     66 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |      0 KiB |     43 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421940 K  |  421940 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202240 K  |  202240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421940 K  |  421940 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202240 K  |  202240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |    1205    |    1143    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      33    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2990    |  264568 K  |  264568 K  |
|       from large pool |       4    |     604    |  159470 K  |  159470 K  |
|       from small pool |       0    |    2949    |  105098 K  |  105098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2409 TiB |   2409 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2381 TiB |   2381 TiB |
|       from small pool |      0 KiB |     57 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2400 TiB |   2400 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2372 TiB |   2372 TiB |
|       from small pool |      0 KiB |     56 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28072 MiB |  27192 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     66 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1714 TiB |   1714 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1685 TiB |   1685 TiB |
|       from small pool |      0 KiB |     43 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  421940 K  |  421940 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202240 K  |  202240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  421940 K  |  421940 K  |
|       from large pool |       2    |    1413    |  219699 K  |  219699 K  |
|       from small pool |       0    |    6658    |  202240 K  |  202240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |    1205    |    1143    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      33    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2990    |  264568 K  |  264568 K  |
|       from large pool |       4    |     604    |  159470 K  |  159470 K  |
|       from small pool |       0    |    2949    |  105098 K  |  105098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742

 Experiment start at: 2024-06-04 08:53:16.199639
before training, model accuracy: 0.7871485352516174
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9939165, 'precision': 0.99665445, 'recall': 0.9686054, 'specificity': 0.9686054, 'f1': 0.98211557, 'auroc': 0.9978217, 'binary_precision': 1.0, 'binary_recall': 0.93721086, 'binary_specificity': 1.0, 'binary_f1_score': 0.9675879}
confusion matrix:
       0     1
0  42309     0
1    285  4254
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.762247, 'recall': 0.51617104, 'specificity': 0.51617104, 'f1': 0.52324677, 'auroc': 0.9187251, 'binary_precision': 0.5555556, 'binary_recall': 0.03322259, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.06269592}
confusion matrix:
       0   1
0  18155  16
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99167037, 'precision': 0.9947113, 'recall': 0.9620378, 'specificity': 0.9620378, 'f1': 0.9776473, 'auroc': 0.99827695, 'binary_precision': 0.9985119, 'binary_recall': 0.92424244, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9599428}
confusion matrix:
      0    1
0  5996    1
1    55  671
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-04 09:12:51.187446,epoch time: 0:19:34.987807,used: 0:19:34.987807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99393785, 'precision': 0.9801526, 'recall': 0.9854331, 'specificity': 0.9854331, 'f1': 0.98277444, 'auroc': 0.99840975, 'binary_precision': 0.9630033, 'binary_recall': 0.97488433, 'binary_specificity': 0.99598193, 'binary_f1_score': 0.96890736}
confusion matrix:
       0     1
0  42139   170
1    114  4425
---- Validation: 
scalar performance:
{'acc': 0.95914346, 'precision': 0.702158, 'recall': 0.8206944, 'specificity': 0.8206944, 'f1': 0.7461548, 'auroc': 0.92378926, 'binary_precision': 0.41538462, 'binary_recall': 0.67275745, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.5136335}
confusion matrix:
       0    1
0  17601  570
1    197  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9909267, 'precision': 0.9729608, 'recall': 0.9803862, 'specificity': 0.9803862, 'f1': 0.9766352, 'auroc': 0.9958255, 'binary_precision': 0.94993234, 'binary_recall': 0.96694213, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.95836174}
confusion matrix:
      0    1
0  5960   37
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_2.png
early stop counter: 1
val acc:0.9591434597969055, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9916703701019287 / 0.9916703701019287
after epoch: 2,now: 2024-06-04 09:31:39.117113,epoch time: 0:18:47.929667,used: 0:38:22.917474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99483436, 'precision': 0.9813466, 'recall': 0.98946965, 'specificity': 0.98946965, 'f1': 0.98536474, 'auroc': 0.9990524, 'binary_precision': 0.96454054, 'binary_recall': 0.9828156, 'binary_specificity': 0.99612373, 'binary_f1_score': 0.9735923}
confusion matrix:
       0     1
0  42145   164
1     78  4461
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.72211844, 'recall': 0.6677872, 'specificity': 0.6677872, 'f1': 0.69075733, 'auroc': 0.92453265, 'binary_precision': 0.46563193, 'binary_recall': 0.3488372, 'binary_specificity': 0.98673713, 'binary_f1_score': 0.3988604}
confusion matrix:
       0    1
0  17930  241
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.997971, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_3.png
new oracle model saved
early stop counter: 2
val acc:0.9662813544273376, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9916703701019287 / 0.9965789318084717
after epoch: 3,now: 2024-06-04 09:50:59.057337,epoch time: 0:19:19.940224,used: 0:57:42.857698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9947276, 'precision': 0.99709797, 'recall': 0.9727914, 'specificity': 0.9727914, 'f1': 0.9845599, 'auroc': 0.9993751, 'binary_precision': 1.0, 'binary_recall': 0.94558275, 'binary_specificity': 1.0, 'binary_f1_score': 0.97203034}
confusion matrix:
       0     1
0  42309     0
1    247  4292
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6840644, 'recall': 0.50315714, 'specificity': 0.50315714, 'f1': 0.49835923, 'auroc': 0.896943, 'binary_precision': 0.4, 'binary_recall': 0.006644518, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.013071895}
confusion matrix:
       0  1
0  18165  6
1    598  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405026, 'precision': 0.99668705, 'recall': 0.9724518, 'specificity': 0.9724518, 'f1': 0.9841737, 'auroc': 0.99880147, 'binary_precision': 1.0, 'binary_recall': 0.94490355, 'binary_specificity': 1.0, 'binary_f1_score': 0.97167134}
confusion matrix:
      0    1
0  5997    0
1    40  686
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_4.png
early stop counter: 3
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9916703701019287 / 0.9965789318084717
after epoch: 4,now: 2024-06-04 10:10:42.199319,epoch time: 0:19:43.141982,used: 1:17:25.999680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9952399, 'precision': 0.99737847, 'recall': 0.97543514, 'specificity': 0.97543514, 'f1': 0.986094, 'auroc': 0.99830735, 'binary_precision': 1.0, 'binary_recall': 0.9508702, 'binary_specificity': 1.0, 'binary_f1_score': 0.97481644}
confusion matrix:
       0     1
0  42309     0
1    223  4316
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.6783093, 'recall': 0.5149552, 'specificity': 0.5149552, 'f1': 0.5208785, 'auroc': 0.87025666, 'binary_precision': 0.3877551, 'binary_recall': 0.03156146, 'binary_specificity': 0.998349, 'binary_f1_score': 0.05837173}
confusion matrix:
       0   1
0  18141  30
1    583  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99181914, 'precision': 0.99479425, 'recall': 0.96272653, 'specificity': 0.96272653, 'f1': 0.97806036, 'auroc': 0.99868524, 'binary_precision': 0.9985141, 'binary_recall': 0.92561984, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.96068615}
confusion matrix:
      0    1
0  5996    1
1    54  672
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_5.png
early stop counter: 4
val acc:0.967346727848053, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9916703701019287 / 0.9965789318084717
after epoch: 5,now: 2024-06-04 10:30:28.377800,epoch time: 0:19:46.178481,used: 1:37:12.178161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9943007, 'precision': 0.9777156, 'recall': 0.9903543, 'specificity': 0.9903543, 'f1': 0.9839294, 'auroc': 0.9992423, 'binary_precision': 0.95699614, 'binary_recall': 0.9854593, 'binary_specificity': 0.9952492, 'binary_f1_score': 0.97101915}
confusion matrix:
       0     1
0  42108   201
1     66  4473
---- Validation: 
scalar performance:
{'acc': 0.962233, 'precision': 0.71091175, 'recall': 0.7861532, 'specificity': 0.7861532, 'f1': 0.7421091, 'auroc': 0.93413043, 'binary_precision': 0.43530834, 'binary_recall': 0.59800667, 'binary_specificity': 0.9742997, 'binary_f1_score': 0.5038489}
confusion matrix:
       0    1
0  17704  467
1    242  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.99916506, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_6.png
early stop counter: 5
val acc:0.9622330069541931, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9916703701019287 / 0.9965789318084717
after epoch: 6,now: 2024-06-04 10:50:07.002916,epoch time: 0:19:38.625116,used: 1:56:50.803277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99692625, 'precision': 0.998304, 'recall': 0.9841375, 'specificity': 0.9841375, 'f1': 0.9910915, 'auroc': 0.99928904, 'binary_precision': 1.0, 'binary_recall': 0.96827495, 'binary_specificity': 1.0, 'binary_f1_score': 0.9838818}
confusion matrix:
       0     1
0  42309     0
1    144  4395
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.830578, 'recall': 0.51473004, 'specificity': 0.51473004, 'f1': 0.52064466, 'auroc': 0.94352376, 'binary_precision': 0.6923077, 'binary_recall': 0.029900333, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.057324845}
confusion matrix:
       0   1
0  18163   8
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99211663, 'precision': 0.99561983, 'recall': 0.9634986, 'specificity': 0.9634986, 'f1': 0.97885823, 'auroc': 0.99840665, 'binary_precision': 1.0, 'binary_recall': 0.92699724, 'binary_specificity': 1.0, 'binary_f1_score': 0.9621158}
confusion matrix:
      0    1
0  5997    0
1    53  673
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_7.png
better model found
persisted
after epoch: 7,now: 2024-06-04 11:09:23.434973,epoch time: 0:19:16.432057,used: 2:16:07.235334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9979508, 'precision': 0.99816495, 'recall': 0.9901134, 'specificity': 0.9901134, 'f1': 0.9940976, 'auroc': 0.99966705, 'binary_precision': 0.9984294, 'binary_recall': 0.98039216, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9893286}
confusion matrix:
       0     1
0  42302     7
1     89  4450
---- Validation: 
scalar performance:
{'acc': 0.97262025, 'precision': 0.8379265, 'recall': 0.6260909, 'specificity': 0.6260909, 'f1': 0.68034977, 'auroc': 0.9357623, 'binary_precision': 0.7, 'binary_recall': 0.25581396, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.37469587}
confusion matrix:
       0    1
0  18105   66
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.99734616, 'recall': 0.9779614, 'specificity': 0.9779614, 'f1': 0.98740196, 'auroc': 0.9998263, 'binary_precision': 1.0, 'binary_recall': 0.95592284, 'binary_specificity': 1.0, 'binary_f1_score': 0.9774648}
confusion matrix:
      0    1
0  5997    0
1    32  694
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_8.png
better model found
persisted
after epoch: 8,now: 2024-06-04 11:28:39.800800,epoch time: 0:19:16.365827,used: 2:35:23.601161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99763066, 'precision': 0.9978854, 'recall': 0.98855937, 'specificity': 0.98855937, 'f1': 0.9931665, 'auroc': 0.9991321, 'binary_precision': 0.9981998, 'binary_recall': 0.9773078, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9876433}
confusion matrix:
       0     1
0  42301     8
1    103  4436
---- Validation: 
scalar performance:
{'acc': 0.9745912, 'precision': 0.8027488, 'recall': 0.7612181, 'specificity': 0.7612181, 'f1': 0.7803159, 'auroc': 0.9471014, 'binary_precision': 0.6208897, 'binary_recall': 0.5332226, 'binary_specificity': 0.9892136, 'binary_f1_score': 0.57372653}
confusion matrix:
       0    1
0  17975  196
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9993084, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_9.png
better model found
persisted
after epoch: 9,now: 2024-06-04 11:48:03.196594,epoch time: 0:19:23.395794,used: 2:54:46.996955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99647796, 'precision': 0.9979551, 'recall': 0.9819225, 'specificity': 0.9819225, 'f1': 0.98977286, 'auroc': 0.9996075, 'binary_precision': 0.9997715, 'binary_recall': 0.9638687, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98149186}
confusion matrix:
       0     1
0  42308     1
1    164  4375
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.93358177, 'recall': 0.54302424, 'specificity': 0.54302424, 'f1': 0.57125115, 'auroc': 0.938444, 'binary_precision': 0.8965517, 'binary_recall': 0.08637874, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.15757576}
confusion matrix:
       0   1
0  18165   6
1    550  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99464524, 'precision': 0.99701643, 'recall': 0.9752066, 'specificity': 0.9752066, 'f1': 0.98579186, 'auroc': 0.99982524, 'binary_precision': 1.0, 'binary_recall': 0.9504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.9745763}
confusion matrix:
      0    1
0  5997    0
1    36  690
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_10.png
early stop counter: 1
val acc:0.9703829884529114, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9965789318084717
after epoch: 10,now: 2024-06-04 12:07:46.124240,epoch time: 0:19:42.927646,used: 3:14:29.924601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99716103, 'precision': 0.99376124, 'recall': 0.989969, 'specificity': 0.989969, 'f1': 0.9918559, 'auroc': 0.99946207, 'binary_precision': 0.9895532, 'binary_recall': 0.98104894, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.9852828}
confusion matrix:
       0     1
0  42263    47
1     86  4452
---- Validation: 
scalar performance:
{'acc': 0.9508336, 'precision': 0.68048507, 'recall': 0.8557512, 'specificity': 0.8557512, 'f1': 0.7350302, 'auroc': 0.9394061, 'binary_precision': 0.369406, 'binary_recall': 0.75415283, 'binary_specificity': 0.9573496, 'binary_f1_score': 0.49590385}
confusion matrix:
       0    1
0  17396  775
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.9967098, 'recall': 0.97856677, 'specificity': 0.97856677, 'f1': 0.9874175, 'auroc': 0.99955165, 'binary_precision': 0.99856323, 'binary_recall': 0.95730025, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.97749645}
confusion matrix:
      0    1
0  5996    1
1    31  695
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_11.png
early stop counter: 2
val acc:0.9508336186408997, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9965789318084717
after epoch: 11,now: 2024-06-04 12:27:35.579950,epoch time: 0:19:49.455710,used: 3:34:19.380311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99743855, 'precision': 0.9985859, 'recall': 0.98678124, 'specificity': 0.98678124, 'f1': 0.992594, 'auroc': 0.999785, 'binary_precision': 1.0, 'binary_recall': 0.9735625, 'binary_specificity': 1.0, 'binary_f1_score': 0.98660415}
confusion matrix:
       0     1
0  42309     0
1    120  4419
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.83726597, 'recall': 0.5581446, 'specificity': 0.5581446, 'f1': 0.59338236, 'auroc': 0.9452236, 'binary_precision': 0.7029703, 'binary_recall': 0.1179402, 'binary_specificity': 0.998349, 'binary_f1_score': 0.20199147}
confusion matrix:
       0   1
0  18141  30
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99405026, 'precision': 0.99668705, 'recall': 0.9724518, 'specificity': 0.9724518, 'f1': 0.9841737, 'auroc': 0.9998429, 'binary_precision': 1.0, 'binary_recall': 0.94490355, 'binary_specificity': 1.0, 'binary_f1_score': 0.97167134}
confusion matrix:
      0    1
0  5997    0
1    40  686
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_12.png
early stop counter: 3
val acc:0.9701166749000549, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9965789318084717
after epoch: 12,now: 2024-06-04 12:47:20.090972,epoch time: 0:19:44.511022,used: 3:54:03.891333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99718237, 'precision': 0.99763423, 'recall': 0.9862461, 'specificity': 0.9862461, 'f1': 0.99185663, 'auroc': 0.99948096, 'binary_precision': 0.9981913, 'binary_recall': 0.9726812, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.98527116}
confusion matrix:
       0     1
0  42301     8
1    124  4415
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7177491, 'recall': 0.57028306, 'specificity': 0.57028306, 'f1': 0.60273105, 'auroc': 0.927121, 'binary_precision': 0.4631579, 'binary_recall': 0.14617941, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.22222222}
confusion matrix:
       0    1
0  18069  102
1    514   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.9954497, 'recall': 0.97977746, 'specificity': 0.97977746, 'f1': 0.9874487, 'auroc': 0.99916536, 'binary_precision': 0.9957143, 'binary_recall': 0.9600551, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9775596}
confusion matrix:
      0    1
0  5994    3
1    29  697
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_13.png
early stop counter: 4
val acc:0.9671869277954102, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9965789318084717
after epoch: 13,now: 2024-06-04 13:07:00.554265,epoch time: 0:19:40.463293,used: 4:13:44.354626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.99844223, 'recall': 0.98752594, 'specificity': 0.98752594, 'f1': 0.9929075, 'auroc': 0.9989596, 'binary_precision': 0.99954826, 'binary_recall': 0.97509915, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98717237}
confusion matrix:
       0     1
0  42308     2
1    113  4425
---- Validation: 
scalar performance:
{'acc': 0.9710755, 'precision': 0.82622755, 'recall': 0.5915649, 'specificity': 0.5915649, 'f1': 0.63864154, 'auroc': 0.9221133, 'binary_precision': 0.6787879, 'binary_recall': 0.18604651, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.29204693}
confusion matrix:
       0    1
0  18118   53
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99211663, 'precision': 0.99561983, 'recall': 0.9634986, 'specificity': 0.9634986, 'f1': 0.97885823, 'auroc': 0.9994657, 'binary_precision': 1.0, 'binary_recall': 0.92699724, 'binary_specificity': 1.0, 'binary_f1_score': 0.9621158}
confusion matrix:
      0    1
0  5997    0
1    53  673
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_14.png
early stop counter: 5
val acc:0.9710754752159119, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9965789318084717
after epoch: 14,now: 2024-06-04 13:26:44.237303,epoch time: 0:19:43.683038,used: 4:33:28.037664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99869794, 'precision': 0.9986825, 'recall': 0.9938692, 'specificity': 0.9938692, 'f1': 0.996261, 'auroc': 0.99963355, 'binary_precision': 0.9986634, 'binary_recall': 0.9878801, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9932425}
confusion matrix:
       0     1
0  42304     6
1     55  4483
---- Validation: 
scalar performance:
{'acc': 0.9707559, 'precision': 0.7995719, 'recall': 0.6082638, 'specificity': 0.6082638, 'f1': 0.65571696, 'auroc': 0.9444018, 'binary_precision': 0.62441313, 'binary_recall': 0.22093023, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.3263804}
confusion matrix:
       0    1
0  18091   80
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.99990904, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_15.png
new oracle model saved
early stop counter: 6
val acc:0.9707558751106262, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9974713921546936
after epoch: 15,now: 2024-06-04 13:46:06.624280,epoch time: 0:19:22.386977,used: 4:52:50.424641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9986552, 'precision': 0.9985595, 'recall': 0.99374855, 'specificity': 0.99374855, 'f1': 0.99613917, 'auroc': 0.99980927, 'binary_precision': 0.998441, 'binary_recall': 0.9876625, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9930225}
confusion matrix:
       0     1
0  42302     7
1     56  4483
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.87936974, 'recall': 0.58148295, 'specificity': 0.58148295, 'f1': 0.6287914, 'auroc': 0.94979525, 'binary_precision': 0.78571427, 'binary_recall': 0.16445182, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.271978}
confusion matrix:
       0   1
0  18144  27
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.9998606, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_16.png
new oracle model saved
early stop counter: 7
val acc:0.9717679619789124, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 16,now: 2024-06-04 14:05:51.446654,epoch time: 0:19:44.822374,used: 5:12:35.247015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99660605, 'precision': 0.98555493, 'recall': 0.9953668, 'specificity': 0.9953668, 'f1': 0.9903983, 'auroc': 0.9996644, 'binary_precision': 0.9717733, 'binary_recall': 0.9938299, 'binary_specificity': 0.9969038, 'binary_f1_score': 0.9826779}
confusion matrix:
       0     1
0  42179   131
1     28  4510
---- Validation: 
scalar performance:
{'acc': 0.96447027, 'precision': 0.7087101, 'recall': 0.68210953, 'specificity': 0.68210953, 'f1': 0.69439876, 'auroc': 0.9176795, 'binary_precision': 0.43785852, 'binary_recall': 0.38039866, 'binary_specificity': 0.9838204, 'binary_f1_score': 0.4071111}
confusion matrix:
       0    1
0  17877  294
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.9850874, 'recall': 0.9967884, 'specificity': 0.9967884, 'f1': 0.9908457, 'auroc': 0.9999472, 'binary_precision': 0.9705094, 'binary_recall': 0.9972452, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.9836957}
confusion matrix:
      0    1
0  5975   22
1     2  724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_17.png
early stop counter: 8
val acc:0.9644702672958374, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 17,now: 2024-06-04 14:25:45.563865,epoch time: 0:19:54.117211,used: 5:32:29.364226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99863386, 'precision': 0.9979537, 'recall': 0.99422836, 'specificity': 0.99422836, 'f1': 0.9960821, 'auroc': 0.99965626, 'binary_precision': 0.99711174, 'binary_recall': 0.98876405, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9929203}
confusion matrix:
       0     1
0  42296    13
1     51  4488
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73559785, 'recall': 0.5521982, 'specificity': 0.5521982, 'f1': 0.5806216, 'auroc': 0.9279084, 'binary_precision': 0.5, 'binary_recall': 0.10797342, 'binary_specificity': 0.9964229, 'binary_f1_score': 0.17759563}
confusion matrix:
       0   1
0  18106  65
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.9928677, 'recall': 0.9916739, 'specificity': 0.9916739, 'f1': 0.9922698, 'auroc': 0.99947476, 'binary_precision': 0.98756903, 'binary_recall': 0.9848485, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.9862069}
confusion matrix:
      0    1
0  5988    9
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_18.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 18,now: 2024-06-04 14:46:54.150897,epoch time: 0:21:08.587032,used: 5:53:37.951258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99850583, 'precision': 0.99877435, 'recall': 0.9926808, 'specificity': 0.9926808, 'f1': 0.9957038, 'auroc': 0.9997381, 'binary_precision': 0.99910635, 'binary_recall': 0.98545617, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9922343}
confusion matrix:
       0     1
0  42306     4
1     66  4472
---- Validation: 
scalar performance:
{'acc': 0.97064936, 'precision': 0.8130989, 'recall': 0.5889356, 'specificity': 0.5889356, 'f1': 0.6342514, 'auroc': 0.9368733, 'binary_precision': 0.6526946, 'binary_recall': 0.18106312, 'binary_specificity': 0.9968081, 'binary_f1_score': 0.28348503}
confusion matrix:
       0    1
0  18113   58
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.99805003, 'recall': 0.989586, 'specificity': 0.989586, 'f1': 0.9937705, 'auroc': 0.99881506, 'binary_precision': 0.9985955, 'binary_recall': 0.9793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98887336}
confusion matrix:
      0    1
0  5996    1
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_19.png
early stop counter: 10
val acc:0.9706493616104126, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 19,now: 2024-06-04 15:07:51.545554,epoch time: 0:20:57.394657,used: 6:14:35.345915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99500513, 'precision': 0.9776622, 'recall': 0.99467784, 'specificity': 0.99467784, 'f1': 0.9859793, 'auroc': 0.99965775, 'binary_precision': 0.95594156, 'binary_recall': 0.9942719, 'binary_specificity': 0.9950838, 'binary_f1_score': 0.97473}
confusion matrix:
       0     1
0  42101   208
1     26  4513
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7531094, 'recall': 0.73681164, 'specificity': 0.73681164, 'f1': 0.74466133, 'auroc': 0.9226938, 'binary_precision': 0.52313167, 'binary_recall': 0.4883721, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.50515467}
confusion matrix:
       0    1
0  17903  268
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.98261356, 'recall': 0.9930947, 'specificity': 0.9930947, 'f1': 0.9877796, 'auroc': 0.999389, 'binary_precision': 0.9663978, 'binary_recall': 0.9903581, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.9782313}
confusion matrix:
      0    1
0  5972   25
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_20.png
early stop counter: 11
val acc:0.969317615032196, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 20,now: 2024-06-04 15:27:38.566255,epoch time: 0:19:47.020701,used: 6:34:22.366616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9981643, 'precision': 0.9987849, 'recall': 0.99072325, 'specificity': 0.99072325, 'f1': 0.9947125, 'auroc': 0.9997612, 'binary_precision': 0.9995513, 'binary_recall': 0.9814937, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9904402}
confusion matrix:
       0     1
0  42307     2
1     84  4455
---- Validation: 
scalar performance:
{'acc': 0.9740052, 'precision': 0.84225905, 'recall': 0.6597313, 'specificity': 0.6597313, 'f1': 0.7154414, 'auroc': 0.9404372, 'binary_precision': 0.70652175, 'binary_recall': 0.32392028, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.44419137}
confusion matrix:
       0    1
0  18090   81
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9994558, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_21.png
early stop counter: 12
val acc:0.9740052223205566, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 21,now: 2024-06-04 15:47:23.859819,epoch time: 0:19:45.293564,used: 6:54:07.660180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99895406, 'precision': 0.99912333, 'recall': 0.99489737, 'specificity': 0.99489737, 'f1': 0.9969989, 'auroc': 0.99972653, 'binary_precision': 0.9993327, 'binary_recall': 0.9898656, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99457663}
confusion matrix:
       0     1
0  42306     3
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.97256696, 'precision': 0.8363421, 'recall': 0.62606335, 'specificity': 0.62606335, 'f1': 0.68010837, 'auroc': 0.9273107, 'binary_precision': 0.6968326, 'binary_recall': 0.25581396, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.3742406}
confusion matrix:
       0    1
0  18104   67
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995389, 'precision': 0.99742866, 'recall': 0.9786501, 'specificity': 0.9786501, 'f1': 0.9878032, 'auroc': 0.99987066, 'binary_precision': 1.0, 'binary_recall': 0.95730025, 'binary_specificity': 1.0, 'binary_f1_score': 0.9781844}
confusion matrix:
      0    1
0  5997    0
1    31  695
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_22.png
early stop counter: 13
val acc:0.9725669622421265, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 22,now: 2024-06-04 16:07:08.022618,epoch time: 0:19:44.162799,used: 7:13:51.822979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9986125, 'precision': 0.997646, 'recall': 0.99441326, 'specificity': 0.99441326, 'f1': 0.9960229, 'auroc': 0.9996352, 'binary_precision': 0.9964492, 'binary_recall': 0.98920465, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.99281365}
confusion matrix:
       0     1
0  42293    16
1     49  4490
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.80707824, 'recall': 0.53832114, 'specificity': 0.53832114, 'f1': 0.5617508, 'auroc': 0.9170441, 'binary_precision': 0.6438356, 'binary_recall': 0.07807309, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.13925926}
confusion matrix:
       0   1
0  18145  26
1    555  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937528, 'precision': 0.98550105, 'recall': 0.9819703, 'specificity': 0.9819703, 'f1': 0.9837271, 'auroc': 0.99793565, 'binary_precision': 0.975, 'binary_recall': 0.96694213, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.9709543}
confusion matrix:
      0    1
0  5979   18
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_23.png
early stop counter: 14
val acc:0.9690513014793396, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 23,now: 2024-06-04 16:27:07.590639,epoch time: 0:19:59.568021,used: 7:33:51.391000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99699026, 'precision': 0.98826754, 'recall': 0.9946934, 'specificity': 0.9946934, 'f1': 0.9914537, 'auroc': 0.9998064, 'binary_precision': 0.977411, 'binary_recall': 0.99184483, 'binary_specificity': 0.997542, 'binary_f1_score': 0.98457503}
confusion matrix:
       0     1
0  42207   104
1     37  4500
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.7709852, 'recall': 0.7926847, 'specificity': 0.7926847, 'f1': 0.78137434, 'auroc': 0.9474957, 'binary_precision': 0.5552147, 'binary_recall': 0.6013289, 'binary_specificity': 0.9840405, 'binary_f1_score': 0.57735246}
confusion matrix:
       0    1
0  17881  290
1    240  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99657893, 'precision': 0.9980897, 'recall': 0.98415977, 'specificity': 0.98415977, 'f1': 0.99099547, 'auroc': 0.9994657, 'binary_precision': 1.0, 'binary_recall': 0.96831954, 'binary_specificity': 1.0, 'binary_f1_score': 0.98390484}
confusion matrix:
      0    1
0  5997    0
1    23  703
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_24.png
early stop counter: 15
val acc:0.9717679619789124, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 24,now: 2024-06-04 16:46:25.798643,epoch time: 0:19:18.208004,used: 7:53:09.599004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99869794, 'precision': 0.9989808, 'recall': 0.99357265, 'specificity': 0.99357265, 'f1': 0.9962581, 'auroc': 0.99980986, 'binary_precision': 0.99933064, 'binary_recall': 0.98721623, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99323654}
confusion matrix:
       0     1
0  42308     3
1     58  4479
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.766665, 'recall': 0.5323696, 'specificity': 0.5323696, 'f1': 0.5513942, 'auroc': 0.93265903, 'binary_precision': 0.5633803, 'binary_recall': 0.06644518, 'binary_specificity': 0.998294, 'binary_f1_score': 0.11887072}
confusion matrix:
       0   1
0  18140  31
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672765, 'precision': 0.99692506, 'recall': 0.9860592, 'specificity': 0.9860592, 'f1': 0.9914135, 'auroc': 0.9989033, 'binary_precision': 0.99717516, 'binary_recall': 0.9724518, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.98465836}
confusion matrix:
      0    1
0  5995    2
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_25.png
early stop counter: 16
val acc:0.9684121012687683, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 25,now: 2024-06-04 17:05:40.792102,epoch time: 0:19:14.993459,used: 8:12:24.592463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99844176, 'precision': 0.99903864, 'recall': 0.9920569, 'specificity': 0.9920569, 'f1': 0.99551666, 'auroc': 0.999804, 'binary_precision': 0.9997762, 'binary_recall': 0.9841375, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9918952}
confusion matrix:
       0     1
0  42308     1
1     72  4467
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.70638645, 'recall': 0.50636935, 'specificity': 0.50636935, 'f1': 0.5047247, 'auroc': 0.9290082, 'binary_precision': 0.44444445, 'binary_recall': 0.013289036, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.025806451}
confusion matrix:
       0   1
0  18161  10
1    594   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.9989449, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_26.png
early stop counter: 17
val acc:0.9678261280059814, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 26,now: 2024-06-04 17:25:03.834648,epoch time: 0:19:23.042546,used: 8:31:47.635009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9971397, 'precision': 0.9983196, 'recall': 0.9853374, 'specificity': 0.9853374, 'f1': 0.9917201, 'auroc': 0.9995189, 'binary_precision': 0.9997731, 'binary_recall': 0.9706984, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9850213}
confusion matrix:
       0     1
0  42308     1
1    133  4406
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.77371705, 'recall': 0.5089161, 'specificity': 0.5089161, 'f1': 0.50960237, 'auroc': 0.93026316, 'binary_precision': 0.57894737, 'binary_recall': 0.018272426, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.035426736}
confusion matrix:
       0   1
0  18163   8
1    591  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99726367, 'recall': 0.97727275, 'specificity': 0.97727275, 'f1': 0.98700017, 'auroc': 0.9982588, 'binary_precision': 1.0, 'binary_recall': 0.95454544, 'binary_specificity': 1.0, 'binary_f1_score': 0.9767442}
confusion matrix:
      0    1
0  5997    0
1    33  693
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_27.png
early stop counter: 18
val acc:0.9680925011634827, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 27,now: 2024-06-04 17:44:56.992137,epoch time: 0:19:53.157489,used: 8:51:40.792498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.998541, 'recall': 0.99559563, 'specificity': 0.99559563, 'f1': 0.9970628, 'auroc': 0.9996822, 'binary_precision': 0.9980031, 'binary_recall': 0.991404, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9946926}
confusion matrix:
       0     1
0  42302     9
1     39  4498
---- Validation: 
scalar performance:
{'acc': 0.9718745, 'precision': 0.90451837, 'recall': 0.57591665, 'specificity': 0.57591665, 'f1': 0.62204623, 'auroc': 0.92756414, 'binary_precision': 0.8363636, 'binary_recall': 0.15282393, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.25842696}
confusion matrix:
       0   1
0  18153  18
1    510  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.9947449, 'recall': 0.9905466, 'specificity': 0.9905466, 'f1': 0.992634, 'auroc': 0.9993789, 'binary_precision': 0.99165505, 'binary_recall': 0.9820937, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.9868512}
confusion matrix:
      0    1
0  5991    6
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_28.png
early stop counter: 19
val acc:0.971874475479126, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 28,now: 2024-06-04 18:04:50.223723,epoch time: 0:19:53.231586,used: 9:11:34.024084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99852717, 'precision': 0.99769545, 'recall': 0.993873, 'specificity': 0.993873, 'f1': 0.99577487, 'auroc': 0.9998815, 'binary_precision': 0.99666595, 'binary_recall': 0.98810047, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9923647}
confusion matrix:
       0     1
0  42295    15
1     54  4484
---- Validation: 
scalar performance:
{'acc': 0.96143395, 'precision': 0.69409186, 'recall': 0.7102539, 'specificity': 0.7102539, 'f1': 0.7018082, 'auroc': 0.91661394, 'binary_precision': 0.40672782, 'binary_recall': 0.44186047, 'binary_specificity': 0.9786473, 'binary_f1_score': 0.42356688}
confusion matrix:
       0    1
0  17783  388
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9972117, 'recall': 0.982699, 'specificity': 0.982699, 'f1': 0.9898147, 'auroc': 0.9992876, 'binary_precision': 0.9985755, 'binary_recall': 0.9655647, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98179275}
confusion matrix:
      0    1
0  5996    1
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_29.png
early stop counter: 20
val acc:0.9614339470863342, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 29,now: 2024-06-04 18:24:42.489222,epoch time: 0:19:52.265499,used: 9:31:26.289583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99735314, 'precision': 0.9984374, 'recall': 0.98643893, 'specificity': 0.98643893, 'f1': 0.99234563, 'auroc': 0.9995259, 'binary_precision': 0.9997736, 'binary_recall': 0.9729015, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98615456}
confusion matrix:
       0     1
0  42308     1
1    123  4416
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.48395863, 'recall': 0.49975234, 'specificity': 0.49975234, 'f1': 0.4917287, 'auroc': 0.9214606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18162  9
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99718124, 'recall': 0.976584, 'specificity': 0.976584, 'f1': 0.9865979, 'auroc': 0.99954545, 'binary_precision': 1.0, 'binary_recall': 0.95316803, 'binary_specificity': 1.0, 'binary_f1_score': 0.97602254}
confusion matrix:
      0    1
0  5997    0
1    34  692
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054742_30.png
early stop counter: 21
val acc:0.9674532413482666, best validation acc: 0.9745911955833435, corresponding to test acc:                         0.9955376982688904 / 0.9979175925254822
after epoch: 30,now: 2024-06-04 18:44:31.665207,epoch time: 0:19:49.175985,used: 9:51:15.465568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_08_53_16_seed_2_21054742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:51:15.465568 at 2024-06-04 18:44:31.665207
persisted model performance metric: 

scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99930495, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
oracle model performance metric: 

scalar performance:
{'acc': 0.99806637, 'precision': 0.998302, 'recall': 0.99165213, 'specificity': 0.99165213, 'f1': 0.9949478, 'auroc': 0.9997733, 'binary_precision': 0.9986014, 'binary_recall': 0.9834711, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9909785}
confusion matrix:
      0    1
0  5996    1
1    12  714
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |  41774 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3599 TiB |   3599 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3556 TiB |   3556 TiB |
|       from small pool |  40700 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41666 MiB |  27192 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     66 MiB |     96 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446862 KiB |   1251 MiB |   2569 TiB |   2569 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2526 TiB |   2526 TiB |
|       from small pool |  11473 KiB |     43 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  632637 K  |  632633 K  |
|       from large pool |     187    |    1413    |  329349 K  |  329349 K  |
|       from small pool |    3475    |    6672    |  303287 K  |  303284 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  632637 K  |  632633 K  |
|       from large pool |     187    |    1413    |  329349 K  |  329349 K  |
|       from small pool |    3475    |    6672    |  303287 K  |  303284 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1777    |    1143    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      33    |      48    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2997    |  394565 K  |  394565 K  |
|       from large pool |      40    |     604    |  236564 K  |  236564 K  |
|       from small pool |      43    |    2955    |  158000 K  |  158000 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3608 TiB |   3608 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3566 TiB |   3566 TiB |
|       from small pool |      0 KiB |     57 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3599 TiB |   3599 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3556 TiB |   3556 TiB |
|       from small pool |      0 KiB |     56 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41666 MiB |  40784 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     66 MiB |     96 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2569 TiB |   2569 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2526 TiB |   2526 TiB |
|       from small pool |      0 KiB |     43 MiB |     42 TiB |     42 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  632637 K  |  632637 K  |
|       from large pool |       2    |    1413    |  329349 K  |  329349 K  |
|       from small pool |       0    |    6672    |  303287 K  |  303287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  632637 K  |  632637 K  |
|       from large pool |       2    |    1413    |  329349 K  |  329349 K  |
|       from small pool |       0    |    6672    |  303287 K  |  303287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1777    |    1714    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      33    |      48    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2997    |  394566 K  |  394566 K  |
|       from large pool |       4    |     604    |  236564 K  |  236564 K  |
|       from small pool |       0    |    2955    |  158001 K  |  158001 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun  4 18:46:18 2024]
Finished job 0.
1 of 1 steps (100%) done
