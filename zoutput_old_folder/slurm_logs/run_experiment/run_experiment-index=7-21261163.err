Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:40:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163

 Experiment start at: 2024-06-08 23:46:14.228421
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96951497, 'precision': 0.8089403, 'recall': 0.60161567, 'specificity': 0.60161567, 'f1': 0.649018, 'auroc': 0.9478171, 'binary_precision': 0.6448203, 'binary_recall': 0.2072011, 'binary_specificity': 0.9960303, 'binary_f1_score': 0.31362468}
confusion matrix:
       0    1
0  42152  168
1   1167  305
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.7978219, 'recall': 0.5920791, 'specificity': 0.5920791, 'f1': 0.636468, 'auroc': 0.94563985, 'binary_precision': 0.62371135, 'binary_recall': 0.1881804, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.28912786}
confusion matrix:
       0    1
0  18076   73
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9154562, 'recall': 0.53806406, 'specificity': 0.53806406, 'f1': 0.56044865, 'auroc': 0.9350921, 'binary_precision': 0.8695652, 'binary_recall': 0.07662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14084506}
confusion matrix:
      0   1
0  5994   3
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:04:00.090535,epoch time: 0:17:45.862114,used: 0:17:45.862114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9729859, 'precision': 0.8840687, 'recall': 0.6316074, 'specificity': 0.6316074, 'f1': 0.6920737, 'auroc': 0.962386, 'binary_precision': 0.79310346, 'binary_recall': 0.265625, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.39796436}
confusion matrix:
       0    1
0  42218  102
1   1081  391
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.9134642, 'recall': 0.59120643, 'specificity': 0.59120643, 'f1': 0.643684, 'auroc': 0.9573236, 'binary_precision': 0.85507244, 'binary_recall': 0.18351477, 'binary_specificity': 0.998898, 'binary_f1_score': 0.30217668}
confusion matrix:
       0    1
0  18129   20
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.9304079, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 00:21:01.991887,epoch time: 0:17:01.901352,used: 0:34:47.763466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9775073, 'precision': 0.853021, 'recall': 0.7654183, 'specificity': 0.7654183, 'f1': 0.8024981, 'auroc': 0.9706559, 'binary_precision': 0.721969, 'binary_recall': 0.5380435, 'binary_specificity': 0.992793, 'binary_f1_score': 0.61658233}
confusion matrix:
       0    1
0  42015  305
1    680  792
---- Validation: 
scalar performance:
{'acc': 0.9752554, 'precision': 0.8602551, 'recall': 0.710419, 'specificity': 0.710419, 'f1': 0.76412624, 'auroc': 0.96486187, 'binary_precision': 0.74054056, 'binary_recall': 0.42612752, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.54096746}
confusion matrix:
       0    1
0  18053   96
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.89036655, 'recall': 0.57587796, 'specificity': 0.57587796, 'f1': 0.61961067, 'auroc': 0.9479557, 'binary_precision': 0.81632656, 'binary_recall': 0.1532567, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2580645}
confusion matrix:
      0   1
0  5988   9
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-09 00:38:05.880944,epoch time: 0:17:03.889057,used: 0:51:51.652523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9794483, 'precision': 0.8388164, 'recall': 0.85035443, 'specificity': 0.85035443, 'f1': 0.8444798, 'auroc': 0.9778653, 'binary_precision': 0.68766403, 'binary_recall': 0.7119565, 'binary_specificity': 0.98875237, 'binary_f1_score': 0.69959944}
confusion matrix:
       0     1
0  41844   476
1    424  1048
---- Validation: 
scalar performance:
{'acc': 0.9778629, 'precision': 0.8398948, 'recall': 0.81227636, 'specificity': 0.81227636, 'f1': 0.82544696, 'auroc': 0.96920395, 'binary_precision': 0.6926995, 'binary_recall': 0.63452566, 'binary_specificity': 0.990027, 'binary_f1_score': 0.6623376}
confusion matrix:
       0    1
0  17968  181
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.89815474, 'recall': 0.593036, 'specificity': 0.593036, 'f1': 0.64402366, 'auroc': 0.9499694, 'binary_precision': 0.8305085, 'binary_recall': 0.18773946, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.30624998}
confusion matrix:
      0   1
0  5987  10
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-09 00:55:09.764395,epoch time: 0:17:03.883451,used: 1:08:55.535974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98070425, 'precision': 0.8662728, 'recall': 0.8201855, 'specificity': 0.8201855, 'f1': 0.8415506, 'auroc': 0.97884274, 'binary_precision': 0.74473065, 'binary_recall': 0.6480978, 'binary_specificity': 0.99227315, 'binary_f1_score': 0.69306207}
confusion matrix:
       0    1
0  41993  327
1    518  954
---- Validation: 
scalar performance:
{'acc': 0.9801511, 'precision': 0.88854796, 'recall': 0.78195864, 'specificity': 0.78195864, 'f1': 0.8261092, 'auroc': 0.9710245, 'binary_precision': 0.7922078, 'binary_recall': 0.56920683, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.6624434}
confusion matrix:
       0    1
0  18053   96
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.85103154, 'recall': 0.5377306, 'specificity': 0.5377306, 'f1': 0.55930376, 'auroc': 0.9429728, 'binary_precision': 0.7407407, 'binary_recall': 0.07662835, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13888888}
confusion matrix:
      0   1
0  5990   7
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 01:12:13.290220,epoch time: 0:17:03.525825,used: 1:25:59.061799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9830334, 'precision': 0.871092, 'recall': 0.86597943, 'specificity': 0.86597943, 'f1': 0.86851645, 'auroc': 0.98245466, 'binary_precision': 0.75120604, 'binary_recall': 0.7404891, 'binary_specificity': 0.99146974, 'binary_f1_score': 0.74580914}
confusion matrix:
       0     1
0  41959   361
1    382  1090
---- Validation: 
scalar performance:
{'acc': 0.9818008, 'precision': 0.8703218, 'recall': 0.8458173, 'specificity': 0.8458173, 'f1': 0.85761356, 'auroc': 0.974629, 'binary_precision': 0.7512521, 'binary_recall': 0.6998445, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.7246377}
confusion matrix:
       0    1
0  18000  149
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8371265, 'recall': 0.5602188, 'specificity': 0.5602188, 'f1': 0.5946653, 'auroc': 0.9507158, 'binary_precision': 0.7111111, 'binary_recall': 0.12260536, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20915033}
confusion matrix:
      0   1
0  5984  13
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 01:29:18.705200,epoch time: 0:17:05.414980,used: 1:43:04.476779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98271376, 'precision': 0.8935131, 'recall': 0.82155305, 'specificity': 0.82155305, 'f1': 0.8536229, 'auroc': 0.98223555, 'binary_precision': 0.79916316, 'binary_recall': 0.6487772, 'binary_specificity': 0.9943289, 'binary_f1_score': 0.7161605}
confusion matrix:
       0    1
0  42080  240
1    517  955
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.8867141, 'recall': 0.80190086, 'specificity': 0.80190086, 'f1': 0.83866024, 'auroc': 0.9769188, 'binary_precision': 0.7871486, 'binary_recall': 0.6096423, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.68711656}
confusion matrix:
       0    1
0  18043  106
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8731942, 'recall': 0.56813174, 'specificity': 0.56813174, 'f1': 0.6076398, 'auroc': 0.9507377, 'binary_precision': 0.7826087, 'binary_recall': 0.13793103, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.23452768}
confusion matrix:
      0   1
0  5987  10
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_7.png
early stop counter: 1
val acc:0.9810025691986084, best validation acc: 0.9818007946014404, corresponding to test acc:                         0.9613295197486877 / 0.9645254015922546
after epoch: 7,now: 2024-06-09 01:46:23.012193,epoch time: 0:17:04.306993,used: 2:00:08.783772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9852256, 'precision': 0.9060789, 'recall': 0.85498285, 'specificity': 0.85498285, 'f1': 0.8786783, 'auroc': 0.9865742, 'binary_precision': 0.82201403, 'binary_recall': 0.71535325, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.7649836}
confusion matrix:
       0     1
0  42092   228
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.9123538, 'recall': 0.80428255, 'specificity': 0.80428255, 'f1': 0.8495426, 'auroc': 0.97787184, 'binary_precision': 0.83829784, 'binary_recall': 0.61275274, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7079964}
confusion matrix:
       0    1
0  18073   76
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.904746, 'recall': 0.56271815, 'specificity': 0.56271815, 'f1': 0.6004224, 'auroc': 0.930936, 'binary_precision': 0.84615386, 'binary_recall': 0.12643678, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.22000001}
confusion matrix:
      0   1
0  5991   6
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 02:03:25.769890,epoch time: 0:17:02.757697,used: 2:17:11.541469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9845177, 'precision': 0.87405473, 'recall': 0.8946154, 'specificity': 0.8946154, 'f1': 0.8840357, 'auroc': 0.98751605, 'binary_precision': 0.7551414, 'binary_recall': 0.7982337, 'binary_specificity': 0.99099714, 'binary_f1_score': 0.77608985}
confusion matrix:
       0     1
0  41939   381
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.87100065, 'recall': 0.882674, 'specificity': 0.882674, 'f1': 0.8767387, 'auroc': 0.9783844, 'binary_precision': 0.75, 'binary_recall': 0.7744945, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.76205045}
confusion matrix:
       0    1
0  17983  166
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8879143, 'recall': 0.58912116, 'specificity': 0.58912116, 'f1': 0.6381118, 'auroc': 0.93965405, 'binary_precision': 0.8103448, 'binary_recall': 0.18007663, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.29467085}
confusion matrix:
      0   1
0  5986  11
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_9.png
better model found
persisted
after epoch: 9,now: 2024-06-09 02:20:33.358024,epoch time: 0:17:07.588134,used: 2:34:19.129603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9861847, 'precision': 0.94871867, 'recall': 0.8259717, 'specificity': 0.8259717, 'f1': 0.87692535, 'auroc': 0.99054587, 'binary_precision': 0.9093484, 'binary_recall': 0.65421194, 'binary_specificity': 0.99773157, 'binary_f1_score': 0.760964}
confusion matrix:
       0    1
0  42224   96
1    509  963
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.94851184, 'recall': 0.78827727, 'specificity': 0.78827727, 'f1': 0.84974694, 'auroc': 0.9803276, 'binary_precision': 0.9117647, 'binary_recall': 0.5785381, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.70789725}
confusion matrix:
       0    1
0  18113   36
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.9107946, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 02:37:44.494590,epoch time: 0:17:11.136566,used: 2:51:30.266169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9883997, 'precision': 0.92659706, 'recall': 0.8884275, 'specificity': 0.8884275, 'f1': 0.906548, 'auroc': 0.9899138, 'binary_precision': 0.86077845, 'binary_recall': 0.78125, 'binary_specificity': 0.99560493, 'binary_f1_score': 0.8190883}
confusion matrix:
       0     1
0  42134   186
1    322  1150
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.92442954, 'recall': 0.8494388, 'specificity': 0.8494388, 'f1': 0.88301665, 'auroc': 0.9823879, 'binary_precision': 0.8593156, 'binary_recall': 0.7029549, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7733105}
confusion matrix:
       0    1
0  18075   74
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8557384, 'recall': 0.53964627, 'specificity': 0.53964627, 'f1': 0.5625638, 'auroc': 0.899927, 'binary_precision': 0.75, 'binary_recall': 0.08045977, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14532873}
confusion matrix:
      0   1
0  5990   7
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 02:54:57.922802,epoch time: 0:17:13.428212,used: 3:08:43.694381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9879658, 'precision': 0.9269509, 'recall': 0.8800065, 'specificity': 0.8800065, 'f1': 0.9020064, 'auroc': 0.9925058, 'binary_precision': 0.86206895, 'binary_recall': 0.7642663, 'binary_specificity': 0.9957467, 'binary_f1_score': 0.81022686}
confusion matrix:
       0     1
0  42140   180
1    347  1125
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.92815065, 'recall': 0.8433832, 'specificity': 0.8433832, 'f1': 0.8807509, 'auroc': 0.9804143, 'binary_precision': 0.8671875, 'binary_recall': 0.6905132, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7688312}
confusion matrix:
       0    1
0  18081   68
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8345965, 'recall': 0.53198344, 'specificity': 0.53198344, 'f1': 0.5493883, 'auroc': 0.9175242, 'binary_precision': 0.7083333, 'binary_recall': 0.0651341, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.11929825}
confusion matrix:
      0   1
0  5990   7
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_12.png
early stop counter: 1
val acc:0.985791802406311, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9605305194854736 / 0.9645254015922546
after epoch: 12,now: 2024-06-09 03:12:01.943801,epoch time: 0:17:04.020999,used: 3:25:47.715380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.987943, 'precision': 0.9047134, 'recall': 0.9110832, 'specificity': 0.9110832, 'f1': 0.90787137, 'auroc': 0.9920716, 'binary_precision': 0.8153846, 'binary_recall': 0.82868797, 'binary_specificity': 0.9934784, 'binary_f1_score': 0.8219825}
confusion matrix:
       0     1
0  42045   276
1    252  1219
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.91829956, 'recall': 0.8754641, 'specificity': 0.8754641, 'f1': 0.8956325, 'auroc': 0.98140144, 'binary_precision': 0.8452174, 'binary_recall': 0.755832, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.7980296}
confusion matrix:
       0    1
0  18060   89
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.9188293, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_13.png
better model found
persisted
after epoch: 13,now: 2024-06-09 03:29:05.898596,epoch time: 0:17:03.954795,used: 3:42:51.670175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98780596, 'precision': 0.8887385, 'recall': 0.9379549, 'specificity': 0.9379549, 'f1': 0.91175216, 'auroc': 0.9930171, 'binary_precision': 0.7815126, 'binary_recall': 0.8845109, 'binary_specificity': 0.9913989, 'binary_f1_score': 0.8298279}
confusion matrix:
       0     1
0  41956   364
1    170  1302
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.8902024, 'recall': 0.89663714, 'specificity': 0.89663714, 'f1': 0.8933912, 'auroc': 0.9830675, 'binary_precision': 0.78746176, 'binary_recall': 0.8009331, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.79414034}
confusion matrix:
       0    1
0  18010  139
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8815857, 'recall': 0.5606357, 'specificity': 0.5606357, 'f1': 0.5966111, 'auroc': 0.923282, 'binary_precision': 0.8, 'binary_recall': 0.12260536, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21262458}
confusion matrix:
      0   1
0  5989   8
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_14.png
early stop counter: 1
val acc:0.985791802406311, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9611697196960449 / 0.9645254015922546
after epoch: 14,now: 2024-06-09 03:46:16.192829,epoch time: 0:17:10.294233,used: 4:00:01.964408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9890848, 'precision': 0.92542404, 'recall': 0.9024874, 'specificity': 0.9024874, 'f1': 0.9136126, 'auroc': 0.99290013, 'binary_precision': 0.8574514, 'binary_recall': 0.8096533, 'binary_specificity': 0.99532145, 'binary_f1_score': 0.8328671}
confusion matrix:
       0     1
0  42123   198
1    280  1191
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.90625286, 'recall': 0.8873272, 'specificity': 0.8873272, 'f1': 0.89654547, 'auroc': 0.9821713, 'binary_precision': 0.8202614, 'binary_recall': 0.7807154, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  18039  110
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9039017, 'recall': 0.5418121, 'specificity': 0.5418121, 'f1': 0.56671965, 'auroc': 0.9199177, 'binary_precision': 0.84615386, 'binary_recall': 0.08429119, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1533101}
confusion matrix:
      0   1
0  5993   4
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_15.png
early stop counter: 2
val acc:0.9866432547569275, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9611697196960449 / 0.9645254015922546
after epoch: 15,now: 2024-06-09 04:03:17.938519,epoch time: 0:17:01.745690,used: 4:17:03.710098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.95022655, 'recall': 0.8726814, 'specificity': 0.8726814, 'f1': 0.90752876, 'auroc': 0.99459636, 'binary_precision': 0.909166, 'binary_recall': 0.74796194, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.82072306}
confusion matrix:
       0     1
0  42210   110
1    371  1101
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9362188, 'recall': 0.8405483, 'specificity': 0.8405483, 'f1': 0.8820457, 'auroc': 0.9806694, 'binary_precision': 0.88353413, 'binary_recall': 0.6842924, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7712533}
confusion matrix:
       0    1
0  18091   58
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.9161339, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
confusion matrix:
      0  1
0  5995  2
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_16.png
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9611697196960449 / 0.9645254015922546
after epoch: 16,now: 2024-06-09 04:20:20.566406,epoch time: 0:17:02.627887,used: 4:34:06.337985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989884, 'precision': 0.9596609, 'recall': 0.8780482, 'specificity': 0.8780482, 'f1': 0.9145876, 'auroc': 0.99490273, 'binary_precision': 0.9276808, 'binary_recall': 0.7581522, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.83439255}
confusion matrix:
       0     1
0  42233    87
1    356  1116
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.94833696, 'recall': 0.8246594, 'specificity': 0.8246594, 'f1': 0.8758831, 'auroc': 0.9827585, 'binary_precision': 0.9088937, 'binary_recall': 0.65163296, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.75905794}
confusion matrix:
       0    1
0  18107   42
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.89704317, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_17.png
early stop counter: 4
val acc:0.9858450293540955, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9611697196960449 / 0.9645254015922546
after epoch: 17,now: 2024-06-09 04:37:16.659706,epoch time: 0:16:56.093300,used: 4:51:02.431285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9895415, 'precision': 0.9176973, 'recall': 0.922081, 'specificity': 0.922081, 'f1': 0.9198768, 'auroc': 0.9946282, 'binary_precision': 0.84061867, 'binary_recall': 0.8497621, 'binary_specificity': 0.99439996, 'binary_f1_score': 0.8451656}
confusion matrix:
       0     1
0  42084   237
1    221  1250
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.91517824, 'recall': 0.8977116, 'specificity': 0.8977116, 'f1': 0.9062417, 'auroc': 0.982489, 'binary_precision': 0.83739835, 'binary_recall': 0.8009331, 'binary_specificity': 0.99449, 'binary_f1_score': 0.81876}
confusion matrix:
       0    1
0  18049  100
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8916132, 'recall': 0.5436444, 'specificity': 0.5436444, 'f1': 0.5696478, 'auroc': 0.912204, 'binary_precision': 0.8214286, 'binary_recall': 0.08812261, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5992   5
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_18.png
better model found
persisted
after epoch: 18,now: 2024-06-09 04:54:17.938692,epoch time: 0:17:01.278986,used: 5:08:03.710271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9900667, 'precision': 0.9175296, 'recall': 0.93256736, 'specificity': 0.93256736, 'f1': 0.92490447, 'auroc': 0.9949863, 'binary_precision': 0.83955467, 'binary_recall': 0.87092394, 'binary_specificity': 0.9942108, 'binary_f1_score': 0.8549517}
confusion matrix:
       0     1
0  42075   245
1    190  1282
---- Validation: 
scalar performance:
{'acc': 0.9883461, 'precision': 0.9181646, 'recall': 0.90245986, 'specificity': 0.90245986, 'f1': 0.9101496, 'auroc': 0.9834429, 'binary_precision': 0.8430421, 'binary_recall': 0.8102644, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.82632834}
confusion matrix:
       0    1
0  18052   97
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7989047, 'recall': 0.5392294, 'specificity': 0.5392294, 'f1': 0.5611193, 'auroc': 0.8879539, 'binary_precision': 0.6363636, 'binary_recall': 0.08045977, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14285715}
confusion matrix:
      0   1
0  5985  12
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_19.png
better model found
persisted
after epoch: 19,now: 2024-06-09 05:11:19.447878,epoch time: 0:17:01.509186,used: 5:25:05.219457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9574727, 'recall': 0.8995663, 'specificity': 0.8995663, 'f1': 0.9264168, 'auroc': 0.9940279, 'binary_precision': 0.9218139, 'binary_recall': 0.80149555, 'binary_specificity': 0.9976371, 'binary_f1_score': 0.8574545}
confusion matrix:
       0     1
0  42221   100
1    292  1179
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9441074, 'recall': 0.83382535, 'specificity': 0.83382535, 'f1': 0.88057005, 'auroc': 0.9818269, 'binary_precision': 0.89979124, 'binary_recall': 0.6702955, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7682709}
confusion matrix:
       0    1
0  18101   48
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.9119766, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_20.png
early stop counter: 1
val acc:0.9861643314361572, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9597315192222595 / 0.9645254015922546
after epoch: 20,now: 2024-06-09 05:28:17.608253,epoch time: 0:16:58.160375,used: 5:42:03.379832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99161947, 'precision': 0.9448302, 'recall': 0.9234842, 'specificity': 0.9234842, 'f1': 0.93387437, 'auroc': 0.9959407, 'binary_precision': 0.8948498, 'binary_recall': 0.8504419, 'binary_specificity': 0.99652654, 'binary_f1_score': 0.87208086}
confusion matrix:
       0     1
0  42174   147
1    220  1251
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.9162027, 'recall': 0.87924194, 'specificity': 0.87924194, 'f1': 0.89679366, 'auroc': 0.98332095, 'binary_precision': 0.84075344, 'binary_recall': 0.7636081, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.80032605}
confusion matrix:
       0    1
0  18056   93
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.8836468, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_21.png
early stop counter: 2
val acc:0.9869625568389893, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9597315192222595 / 0.9645254015922546
after epoch: 21,now: 2024-06-09 05:45:16.878374,epoch time: 0:16:59.270121,used: 5:59:02.649953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.95465213, 'recall': 0.9157727, 'specificity': 0.9157727, 'f1': 0.9342779, 'auroc': 0.9963585, 'binary_precision': 0.9150522, 'binary_recall': 0.8342391, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.87277895}
confusion matrix:
       0     1
0  42206   114
1    244  1228
---- Validation: 
scalar performance:
{'acc': 0.9887186, 'precision': 0.9427632, 'recall': 0.87865096, 'specificity': 0.87865096, 'f1': 0.90801185, 'auroc': 0.9836713, 'binary_precision': 0.8939671, 'binary_recall': 0.7604977, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.8218488}
confusion matrix:
       0    1
0  18091   58
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.89582866, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_22.png
better model found
persisted
after epoch: 22,now: 2024-06-09 06:02:15.804032,epoch time: 0:16:58.925658,used: 6:16:01.575611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9924872, 'precision': 0.95733404, 'recall': 0.92393315, 'specificity': 0.92393315, 'f1': 0.9399524, 'auroc': 0.99679685, 'binary_precision': 0.9198529, 'binary_recall': 0.8504419, 'binary_specificity': 0.9974244, 'binary_f1_score': 0.8837867}
confusion matrix:
       0     1
0  42212   109
1    220  1251
---- Validation: 
scalar performance:
{'acc': 0.9887186, 'precision': 0.93354875, 'recall': 0.8891517, 'specificity': 0.8891517, 'f1': 0.9100573, 'auroc': 0.98358774, 'binary_precision': 0.8747826, 'binary_recall': 0.7822706, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.8259442}
confusion matrix:
       0    1
0  18077   72
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.90672874, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_23.png
early stop counter: 1
val acc:0.9887186288833618, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 23,now: 2024-06-09 06:19:14.115588,epoch time: 0:16:58.311556,used: 6:32:59.887167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99148244, 'precision': 0.9309665, 'recall': 0.93916166, 'specificity': 0.93916166, 'f1': 0.93502235, 'auroc': 0.99699247, 'binary_precision': 0.866, 'binary_recall': 0.88307273, 'binary_specificity': 0.9952506, 'binary_f1_score': 0.874453}
confusion matrix:
       0     1
0  42120   201
1    172  1299
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.8952744, 'recall': 0.87686026, 'specificity': 0.87686026, 'f1': 0.8858291, 'auroc': 0.983783, 'binary_precision': 0.79901963, 'binary_recall': 0.7604977, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.77928287}
confusion matrix:
       0    1
0  18026  123
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.85054696, 'recall': 0.55846983, 'specificity': 0.55846983, 'f1': 0.59244365, 'auroc': 0.91476536, 'binary_precision': 0.7380952, 'binary_recall': 0.118773945, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5986  11
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_24.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 24,now: 2024-06-09 06:36:10.119291,epoch time: 0:16:56.003703,used: 6:49:55.890870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9926699, 'precision': 0.93848985, 'recall': 0.95027494, 'specificity': 0.95027494, 'f1': 0.94429797, 'auroc': 0.9973277, 'binary_precision': 0.880291, 'binary_recall': 0.90482664, 'binary_specificity': 0.9957232, 'binary_f1_score': 0.8923902}
confusion matrix:
       0     1
0  42140   181
1    140  1331
---- Validation: 
scalar performance:
{'acc': 0.9885057, 'precision': 0.916548, 'recall': 0.9077929, 'specificity': 0.9077929, 'f1': 0.9121201, 'auroc': 0.98318815, 'binary_precision': 0.83942765, 'binary_recall': 0.82115084, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.8301887}
confusion matrix:
       0    1
0  18048  101
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.82817894, 'recall': 0.53006774, 'specificity': 0.53006774, 'f1': 0.5460372, 'auroc': 0.87471867, 'binary_precision': 0.6956522, 'binary_recall': 0.06130268, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.112676054}
confusion matrix:
      0   1
0  5990   7
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_25.png
early stop counter: 3
val acc:0.9885057210922241, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 25,now: 2024-06-09 06:53:11.305050,epoch time: 0:17:01.185759,used: 7:06:57.076629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9929668, 'precision': 0.9664654, 'recall': 0.9222649, 'specificity': 0.9222649, 'f1': 0.9431836, 'auroc': 0.99780476, 'binary_precision': 0.938253, 'binary_recall': 0.8464674, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.8899999}
confusion matrix:
       0     1
0  42238    82
1    226  1246
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9351977, 'recall': 0.8629335, 'specificity': 0.8629335, 'f1': 0.895541, 'auroc': 0.983644, 'binary_precision': 0.87992495, 'binary_recall': 0.7293935, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.79761904}
confusion matrix:
       0    1
0  18085   64
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8129301, 'recall': 0.5112441, 'specificity': 0.5112441, 'f1': 0.5116882, 'auroc': 0.8479866, 'binary_precision': 0.6666667, 'binary_recall': 0.022988506, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.044444446}
confusion matrix:
      0  1
0  5994  3
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_26.png
early stop counter: 4
val acc:0.9873350262641907, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 26,now: 2024-06-09 07:10:12.022882,epoch time: 0:17:00.717832,used: 7:23:57.794461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9929896, 'precision': 0.9707219, 'recall': 0.91834235, 'specificity': 0.91834235, 'f1': 0.9428747, 'auroc': 0.9979945, 'binary_precision': 0.94704527, 'binary_recall': 0.8383152, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.88936937}
confusion matrix:
       0     1
0  42251    69
1    238  1234
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.9477825, 'recall': 0.8679849, 'specificity': 0.8679849, 'f1': 0.90368485, 'auroc': 0.9840672, 'binary_precision': 0.9047619, 'binary_recall': 0.7387247, 'binary_specificity': 0.997245, 'binary_f1_score': 0.8133561}
confusion matrix:
       0    1
0  18099   50
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.88677657, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_27.png
early stop counter: 5
val acc:0.9883993268013, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 27,now: 2024-06-09 07:27:10.002685,epoch time: 0:16:57.979803,used: 7:40:55.774264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9926699, 'precision': 0.9389314, 'recall': 0.9495859, 'specificity': 0.9495859, 'f1': 0.94418967, 'auroc': 0.9975438, 'binary_precision': 0.881221, 'binary_recall': 0.9034014, 'binary_specificity': 0.9957705, 'binary_f1_score': 0.89217335}
confusion matrix:
       0     1
0  42143   179
1    142  1328
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.9148183, 'recall': 0.89923924, 'specificity': 0.89923924, 'f1': 0.9068673, 'auroc': 0.98371947, 'binary_precision': 0.8365696, 'binary_recall': 0.80404353, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.81998414}
confusion matrix:
       0    1
0  18048  101
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.89387125, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_28.png
early stop counter: 6
val acc:0.9879204034805298, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 28,now: 2024-06-09 07:44:07.696522,epoch time: 0:16:57.693837,used: 7:57:53.468101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9934691, 'precision': 0.958462, 'recall': 0.9391648, 'specificity': 0.9391648, 'f1': 0.94859004, 'auroc': 0.99755245, 'binary_precision': 0.92105263, 'binary_recall': 0.88095236, 'binary_specificity': 0.9973773, 'binary_f1_score': 0.9005563}
confusion matrix:
       0     1
0  42211   111
1    175  1295
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.92360115, 'recall': 0.89109886, 'specificity': 0.89109886, 'f1': 0.9066491, 'auroc': 0.98407334, 'binary_precision': 0.8547297, 'binary_recall': 0.7869362, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8194332}
confusion matrix:
       0    1
0  18063   86
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.87367576, 'recall': 0.54164535, 'specificity': 0.54164535, 'f1': 0.5661058, 'auroc': 0.9090535, 'binary_precision': 0.78571427, 'binary_recall': 0.08429119, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.15224914}
confusion matrix:
      0   1
0  5991   6
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_29.png
early stop counter: 7
val acc:0.9881332516670227, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 29,now: 2024-06-09 08:01:05.496207,epoch time: 0:16:57.799685,used: 8:14:51.267786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9944739, 'precision': 0.96870136, 'recall': 0.9446834, 'specificity': 0.9446834, 'f1': 0.9563526, 'auroc': 0.9987769, 'binary_precision': 0.9411765, 'binary_recall': 0.8913044, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.91556174}
confusion matrix:
       0     1
0  42238    82
1    160  1312
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.92783415, 'recall': 0.89048654, 'specificity': 0.89048654, 'f1': 0.90823966, 'auroc': 0.9832146, 'binary_precision': 0.8632479, 'binary_recall': 0.785381, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.82247555}
confusion matrix:
       0    1
0  18069   80
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.8336622, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_30.png
early stop counter: 8
val acc:0.9883993268013, best validation acc: 0.9887186288833618, corresponding to test acc:                         0.9598913192749023 / 0.9645254015922546
after epoch: 30,now: 2024-06-09 08:18:07.000877,epoch time: 0:17:01.504670,used: 8:31:52.772456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_46_14_seed_0_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:31:52.772456 at 2024-06-09 08:18:07.000877
persisted model performance metric: 

scalar performance:
{'acc': 0.9610099, 'precision': 0.9542099, 'recall': 0.5343994, 'specificity': 0.5343994, 'f1': 0.55431515, 'auroc': 0.8983048, 'binary_precision': 0.94736844, 'binary_recall': 0.06896552, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5996   1
1   243  18
oracle model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.9227197, 'recall': 0.59711754, 'specificity': 0.59711754, 'f1': 0.650979, 'auroc': 0.9588297, 'binary_precision': 0.87931037, 'binary_recall': 0.1954023, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.31974924}
confusion matrix:
      0   1
0  5990   7
1   210  51
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16678 MiB |  16678 MiB |  16678 MiB |      0 B   |
|       from large pool |  16650 MiB |  16650 MiB |  16650 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474654 KiB |    851 MiB | 464776 GiB | 464776 GiB |
|       from large pool | 454720 KiB |    848 MiB | 451886 GiB | 451885 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  151974 K  |  151971 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89895 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  151974 K  |  151971 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89895 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |    2873    |   83621 K  |   83621 K  |
|       from large pool |     110    |     506    |   40711 K  |   40711 K  |
|       from small pool |      34    |    2761    |   42910 K  |   42910 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451887 GiB | 451887 GiB |
|       from small pool |      0 B   |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83623 K  |   83623 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   42911 K  |   42911 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451887 GiB | 451887 GiB |
|       from small pool |      0 B   |     25 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151974 K  |  151974 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83623 K  |   83623 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   42911 K  |   42911 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163

 Experiment start at: 2024-06-09 08:25:45.514894
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97060835, 'precision': 0.776935, 'recall': 0.7014351, 'specificity': 0.7014351, 'f1': 0.73266387, 'auroc': 0.9433364, 'binary_precision': 0.5736285, 'binary_recall': 0.41331485, 'binary_specificity': 0.98955536, 'binary_f1_score': 0.48045143}
confusion matrix:
       0    1
0  41971  443
1    846  596
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.77624756, 'recall': 0.71525294, 'specificity': 0.71525294, 'f1': 0.74156433, 'auroc': 0.94613826, 'binary_precision': 0.5730769, 'binary_recall': 0.44279346, 'binary_specificity': 0.9877124, 'binary_f1_score': 0.4995809}
confusion matrix:
       0    1
0  17845  222
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79989207, 'recall': 0.5656259, 'specificity': 0.5656259, 'f1': 0.60098463, 'auroc': 0.92485416, 'binary_precision': 0.6363636, 'binary_recall': 0.13461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5926  20
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 08:43:32.865642,epoch time: 0:17:47.350748,used: 0:17:47.350748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749407, 'precision': 0.8470286, 'recall': 0.6950916, 'specificity': 0.6950916, 'f1': 0.74814904, 'auroc': 0.9571874, 'binary_precision': 0.71428573, 'binary_recall': 0.39555863, 'binary_specificity': 0.99462456, 'binary_f1_score': 0.50915587}
confusion matrix:
       0    1
0  42187  228
1    871  570
---- Validation: 
scalar performance:
{'acc': 0.9729456, 'precision': 0.8820118, 'recall': 0.6669597, 'specificity': 0.6669597, 'f1': 0.7292707, 'auroc': 0.9613185, 'binary_precision': 0.7881944, 'binary_recall': 0.33729568, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.47242454}
confusion matrix:
       0    1
0  18006   61
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.77655196, 'recall': 0.5298442, 'specificity': 0.5298442, 'f1': 0.54523367, 'auroc': 0.9330071, 'binary_precision': 0.5925926, 'binary_recall': 0.06153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.11149825}
confusion matrix:
      0   1
0  5935  11
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 09:00:37.538132,epoch time: 0:17:04.672490,used: 0:34:52.023238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9769473, 'precision': 0.864781, 'recall': 0.7227997, 'specificity': 0.7227997, 'f1': 0.7753444, 'auroc': 0.96932423, 'binary_precision': 0.7479862, 'binary_recall': 0.45076284, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.562527}
confusion matrix:
       0    1
0  42195  219
1    792  650
---- Validation: 
scalar performance:
{'acc': 0.974333, 'precision': 0.8677248, 'recall': 0.70773417, 'specificity': 0.70773417, 'f1': 0.7636949, 'auroc': 0.96789896, 'binary_precision': 0.7566845, 'binary_recall': 0.4205052, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.5405922}
confusion matrix:
       0    1
0  17976   91
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8253187, 'recall': 0.5622002, 'specificity': 0.5622002, 'f1': 0.59714615, 'auroc': 0.94380724, 'binary_precision': 0.6875, 'binary_recall': 0.12692308, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.21428573}
confusion matrix:
      0   1
0  5931  15
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-09 09:17:46.418518,epoch time: 0:17:08.880386,used: 0:52:00.903624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97788215, 'precision': 0.89688194, 'recall': 0.7108898, 'specificity': 0.7108898, 'f1': 0.7734724, 'auroc': 0.97309405, 'binary_precision': 0.81299734, 'binary_recall': 0.42510402, 'binary_specificity': 0.9966756, 'binary_f1_score': 0.5582878}
confusion matrix:
       0    1
0  42273  141
1    829  613
---- Validation: 
scalar performance:
{'acc': 0.97492, 'precision': 0.9268324, 'recall': 0.6744211, 'specificity': 0.6744211, 'f1': 0.74409914, 'auroc': 0.9722842, 'binary_precision': 0.87732345, 'binary_recall': 0.35066864, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.50106156}
confusion matrix:
       0    1
0  18034   33
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.9392153, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 09:34:55.447411,epoch time: 0:17:09.028893,used: 1:09:09.932517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811884, 'precision': 0.89466435, 'recall': 0.78059447, 'specificity': 0.78059447, 'f1': 0.8272739, 'auroc': 0.9750589, 'binary_precision': 0.8039409, 'binary_recall': 0.5658807, 'binary_specificity': 0.99530816, 'binary_f1_score': 0.6642247}
confusion matrix:
       0    1
0  42215  199
1    626  816
---- Validation: 
scalar performance:
{'acc': 0.9767343, 'precision': 0.90484107, 'recall': 0.71970856, 'specificity': 0.71970856, 'f1': 0.78277856, 'auroc': 0.97173965, 'binary_precision': 0.83008355, 'binary_recall': 0.44279346, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.57751936}
confusion matrix:
       0    1
0  18006   61
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8561183, 'recall': 0.5511663, 'specificity': 0.5511663, 'f1': 0.58122945, 'auroc': 0.95006764, 'binary_precision': 0.75, 'binary_recall': 0.103846155, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.18243243}
confusion matrix:
      0   1
0  5937   9
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 09:52:02.304950,epoch time: 0:17:06.857539,used: 1:26:16.790056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98143923, 'precision': 0.8434743, 'recall': 0.8828845, 'specificity': 0.8828845, 'f1': 0.8620117, 'auroc': 0.98125464, 'binary_precision': 0.6945477, 'binary_recall': 0.7773925, 'binary_specificity': 0.9883765, 'binary_f1_score': 0.7336387}
confusion matrix:
       0     1
0  41921   493
1    321  1121
---- Validation: 
scalar performance:
{'acc': 0.9796158, 'precision': 0.8568045, 'recall': 0.8435137, 'specificity': 0.8435137, 'f1': 0.85002095, 'auroc': 0.9765039, 'binary_precision': 0.7248841, 'binary_recall': 0.6968796, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.71060604}
confusion matrix:
       0    1
0  17889  178
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.816517, 'recall': 0.60157573, 'specificity': 0.60157573, 'f1': 0.64870656, 'auroc': 0.9466294, 'binary_precision': 0.6666667, 'binary_recall': 0.20769231, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.31671554}
confusion matrix:
      0   1
0  5919  27
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-09 10:09:07.974670,epoch time: 0:17:05.669720,used: 1:43:22.459776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98374224, 'precision': 0.92856765, 'recall': 0.7953128, 'specificity': 0.7953128, 'f1': 0.84880966, 'auroc': 0.9824201, 'binary_precision': 0.87080365, 'binary_recall': 0.59361994, 'binary_specificity': 0.9970057, 'binary_f1_score': 0.70597935}
confusion matrix:
       0    1
0  42287  127
1    586  856
---- Validation: 
scalar performance:
{'acc': 0.98025614, 'precision': 0.92311347, 'recall': 0.76588166, 'specificity': 0.76588166, 'f1': 0.8251914, 'auroc': 0.97894645, 'binary_precision': 0.8633093, 'binary_recall': 0.53491825, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.6605504}
confusion matrix:
       0    1
0  18010   57
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.95999813, 'recall': 0.54414666, 'specificity': 0.54414666, 'f1': 0.5711739, 'auroc': 0.9470502, 'binary_precision': 0.9583333, 'binary_recall': 0.08846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16197182}
confusion matrix:
      0   1
0  5945   1
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 10:26:15.180344,epoch time: 0:17:07.205674,used: 2:00:29.665450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9845631, 'precision': 0.8919827, 'recall': 0.8553587, 'specificity': 0.8553587, 'f1': 0.8727009, 'auroc': 0.98632264, 'binary_precision': 0.79355335, 'binary_recall': 0.7170596, 'binary_specificity': 0.99365777, 'binary_f1_score': 0.75336975}
confusion matrix:
       0     1
0  42145   269
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.9813767, 'precision': 0.88635975, 'recall': 0.8279758, 'specificity': 0.8279758, 'f1': 0.8545723, 'auroc': 0.9803275, 'binary_precision': 0.78521127, 'binary_recall': 0.6627043, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.71877515}
confusion matrix:
       0    1
0  17945  122
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8731225, 'recall': 0.5683899, 'specificity': 0.5683899, 'f1': 0.6079824, 'auroc': 0.95063955, 'binary_precision': 0.7826087, 'binary_recall': 0.13846155, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5936  10
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 10:43:39.403412,epoch time: 0:17:24.223068,used: 2:17:53.888518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9850876, 'precision': 0.9151956, 'recall': 0.83452785, 'specificity': 0.83452785, 'f1': 0.87019515, 'auroc': 0.988123, 'binary_precision': 0.8414211, 'binary_recall': 0.6733703, 'binary_specificity': 0.9956854, 'binary_f1_score': 0.7480739}
confusion matrix:
       0    1
0  42231  183
1    471  971
---- Validation: 
scalar performance:
{'acc': 0.97982925, 'precision': 0.91341925, 'recall': 0.7670908, 'specificity': 0.7670908, 'f1': 0.8232982, 'auroc': 0.9791702, 'binary_precision': 0.84382284, 'binary_recall': 0.53789, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.65698725}
confusion matrix:
       0    1
0  18000   67
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8770136, 'recall': 0.5646278, 'specificity': 0.5646278, 'f1': 0.6025077, 'auroc': 0.9497369, 'binary_precision': 0.7906977, 'binary_recall': 0.13076924, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.22442245}
confusion matrix:
      0   1
0  5937   9
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_9.png
early stop counter: 1
val acc:0.9798292517662048, best validation acc: 0.9813767075538635, corresponding to test acc:                         0.9622945785522461 / 0.962455689907074
after epoch: 9,now: 2024-06-09 11:00:44.657880,epoch time: 0:17:05.254468,used: 2:34:59.142986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98584, 'precision': 0.9090537, 'recall': 0.8570237, 'specificity': 0.8570237, 'f1': 0.8811344, 'auroc': 0.9877697, 'binary_precision': 0.8276137, 'binary_recall': 0.7191401, 'binary_specificity': 0.9949073, 'binary_f1_score': 0.7695732}
confusion matrix:
       0     1
0  42198   216
1    405  1037
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.9158704, 'recall': 0.82465285, 'specificity': 0.82465285, 'f1': 0.8641825, 'auroc': 0.9810868, 'binary_precision': 0.84452975, 'binary_recall': 0.653789, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7370184}
confusion matrix:
       0    1
0  17986   81
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9579487, 'recall': 0.5403005, 'specificity': 0.5403005, 'f1': 0.56457525, 'auroc': 0.94932324, 'binary_precision': 0.95454544, 'binary_recall': 0.08076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5945   1
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 11:17:49.124531,epoch time: 0:17:04.466651,used: 2:52:03.609637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98385626, 'precision': 0.8555036, 'recall': 0.91561955, 'specificity': 0.91561955, 'f1': 0.8830036, 'auroc': 0.98973227, 'binary_precision': 0.7163915, 'binary_recall': 0.8425797, 'binary_specificity': 0.9886594, 'binary_f1_score': 0.7743786}
confusion matrix:
       0     1
0  41933   481
1    227  1215
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.87804043, 'recall': 0.8774996, 'specificity': 0.8774996, 'f1': 0.8777698, 'auroc': 0.9793509, 'binary_precision': 0.76488096, 'binary_recall': 0.7637444, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.76431227}
confusion matrix:
       0    1
0  17909  158
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.9283029, 'recall': 0.5937262, 'specificity': 0.5937262, 'f1': 0.64658636, 'auroc': 0.94991803, 'binary_precision': 0.8909091, 'binary_recall': 0.18846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.31111112}
confusion matrix:
      0   1
0  5940   6
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_11.png
new oracle model saved
early stop counter: 1
val acc:0.9830843210220337, best validation acc: 0.9832444190979004, corresponding to test acc:                         0.9613277316093445 / 0.9650338292121887
after epoch: 11,now: 2024-06-09 11:34:55.028743,epoch time: 0:17:05.904212,used: 3:09:09.513849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9865241, 'precision': 0.9361017, 'recall': 0.83862007, 'specificity': 0.83862007, 'f1': 0.88078386, 'auroc': 0.989438, 'binary_precision': 0.8829883, 'binary_recall': 0.6803051, 'binary_specificity': 0.99693495, 'binary_f1_score': 0.7685076}
confusion matrix:
       0    1
0  42284  130
1    461  981
---- Validation: 
scalar performance:
{'acc': 0.9789755, 'precision': 0.9165611, 'recall': 0.74948156, 'specificity': 0.74948156, 'f1': 0.81047726, 'auroc': 0.9765414, 'binary_precision': 0.8513854, 'binary_recall': 0.5022288, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.6317757}
confusion matrix:
       0    1
0  18008   59
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.96397924, 'recall': 0.5537621, 'specificity': 0.5537621, 'f1': 0.587276, 'auroc': 0.94951177, 'binary_precision': 0.9655172, 'binary_recall': 0.10769231, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.19377162}
confusion matrix:
      0   1
0  5945   1
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_12.png
early stop counter: 2
val acc:0.9789754748344421, best validation acc: 0.9832444190979004, corresponding to test acc:                         0.9613277316093445 / 0.9650338292121887
after epoch: 12,now: 2024-06-09 11:51:54.658680,epoch time: 0:16:59.629937,used: 3:26:09.143786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9882114, 'precision': 0.92440736, 'recall': 0.88303614, 'specificity': 0.88303614, 'f1': 0.9025803, 'auroc': 0.9908685, 'binary_precision': 0.8565921, 'binary_recall': 0.7704577, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.81124496}
confusion matrix:
       0     1
0  42228   186
1    331  1111
---- Validation: 
scalar performance:
{'acc': 0.9807898, 'precision': 0.9098152, 'recall': 0.78761643, 'specificity': 0.78761643, 'f1': 0.837152, 'auroc': 0.97816753, 'binary_precision': 0.83511776, 'binary_recall': 0.5794948, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.68421054}
confusion matrix:
       0    1
0  17990   77
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.95114845, 'recall': 0.5594472, 'specificity': 0.5594472, 'f1': 0.5962716, 'auroc': 0.9503344, 'binary_precision': 0.93939394, 'binary_recall': 0.11923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5944   2
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_13.png
early stop counter: 3
val acc:0.9807897806167603, best validation acc: 0.9832444190979004, corresponding to test acc:                         0.9613277316093445 / 0.9650338292121887
after epoch: 13,now: 2024-06-09 12:09:00.133792,epoch time: 0:17:05.475112,used: 3:43:14.618898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9882342, 'precision': 0.9249475, 'recall': 0.8826332, 'specificity': 0.8826332, 'f1': 0.9025967, 'auroc': 0.9922496, 'binary_precision': 0.8576953, 'binary_recall': 0.76960444, 'binary_specificity': 0.9956619, 'binary_f1_score': 0.8112655}
confusion matrix:
       0     1
0  42231   184
1    332  1109
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.9224713, 'recall': 0.8469964, 'specificity': 0.8469964, 'f1': 0.8807266, 'auroc': 0.9821058, 'binary_precision': 0.856102, 'binary_recall': 0.6983655, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.7692307}
confusion matrix:
       0    1
0  17988   79
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9478843, 'recall': 0.553678, 'specificity': 0.553678, 'f1': 0.5868999, 'auroc': 0.94289875, 'binary_precision': 0.93333334, 'binary_recall': 0.10769231, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.19310346}
confusion matrix:
      0   1
0  5944   2
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_14.png
better model found
persisted
after epoch: 14,now: 2024-06-09 12:26:03.697770,epoch time: 0:17:03.563978,used: 4:00:18.182876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9879378, 'precision': 0.9215059, 'recall': 0.8815549, 'specificity': 0.8815549, 'f1': 0.9004599, 'auroc': 0.9922611, 'binary_precision': 0.85088396, 'binary_recall': 0.76768374, 'binary_specificity': 0.99542606, 'binary_f1_score': 0.8071455}
confusion matrix:
       0     1
0  42220   194
1    335  1107
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.90981424, 'recall': 0.8443248, 'specificity': 0.8443248, 'f1': 0.87398535, 'auroc': 0.98080456, 'binary_precision': 0.83096087, 'binary_recall': 0.69390786, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.7562753}
confusion matrix:
       0    1
0  17972   95
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.94937325, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_15.png
early stop counter: 1
val acc:0.9839380979537964, best validation acc: 0.9849519729614258, corresponding to test acc:                         0.9622945785522461 / 0.9650338292121887
after epoch: 15,now: 2024-06-09 12:43:31.431664,epoch time: 0:17:27.733894,used: 4:17:45.916770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9898304, 'precision': 0.92378044, 'recall': 0.9146887, 'specificity': 0.9146887, 'f1': 0.9191814, 'auroc': 0.9938637, 'binary_precision': 0.8531915, 'binary_recall': 0.83425796, 'binary_specificity': 0.9951195, 'binary_f1_score': 0.8436185}
confusion matrix:
       0     1
0  42207   207
1    239  1203
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9096816, 'recall': 0.8619894, 'specificity': 0.8619894, 'f1': 0.8842351, 'auroc': 0.9818028, 'binary_precision': 0.8293919, 'binary_recall': 0.7295691, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.7762846}
confusion matrix:
       0    1
0  17966  101
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.92596793, 'recall': 0.5612021, 'specificity': 0.5612021, 'f1': 0.598534, 'auroc': 0.95550805, 'binary_precision': 0.8888889, 'binary_recall': 0.12307692, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2162162}
confusion matrix:
      0   1
0  5942   4
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_16.png
early stop counter: 2
val acc:0.9848986268043518, best validation acc: 0.9849519729614258, corresponding to test acc:                         0.9622945785522461 / 0.9650338292121887
after epoch: 16,now: 2024-06-09 13:01:10.824914,epoch time: 0:17:39.393250,used: 4:35:25.310020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9865925, 'precision': 0.8793633, 'recall': 0.9244032, 'specificity': 0.9244032, 'f1': 0.9005112, 'auroc': 0.99280196, 'binary_precision': 0.76358026, 'binary_recall': 0.85783637, 'binary_specificity': 0.99096996, 'binary_f1_score': 0.8079687}
confusion matrix:
       0     1
0  42031   383
1    205  1237
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.90559614, 'recall': 0.88757724, 'specificity': 0.88757724, 'f1': 0.8963639, 'auroc': 0.98061705, 'binary_precision': 0.81931466, 'binary_recall': 0.781575, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  17951  116
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9023597, 'recall': 0.5705652, 'specificity': 0.5705652, 'f1': 0.6122127, 'auroc': 0.95128614, 'binary_precision': 0.84090906, 'binary_recall': 0.1423077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.24342106}
confusion matrix:
      0   1
0  5939   7
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_17.png
better model found
persisted
after epoch: 17,now: 2024-06-09 13:18:13.375612,epoch time: 0:17:02.550698,used: 4:52:27.860718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9902408, 'precision': 0.9402209, 'recall': 0.90116787, 'specificity': 0.90116787, 'f1': 0.91971946, 'auroc': 0.9942565, 'binary_precision': 0.8870229, 'binary_recall': 0.80582523, 'binary_specificity': 0.99651057, 'binary_f1_score': 0.8444767}
confusion matrix:
       0     1
0  42266   148
1    280  1162
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.9219811, 'recall': 0.84108055, 'specificity': 0.84108055, 'f1': 0.8768895, 'auroc': 0.98210156, 'binary_precision': 0.85555553, 'binary_recall': 0.68647844, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.7617478}
confusion matrix:
       0    1
0  17989   78
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.93313354, 'recall': 0.5708175, 'specificity': 0.5708175, 'f1': 0.613552, 'auroc': 0.94316167, 'binary_precision': 0.902439, 'binary_recall': 0.1423077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2458472}
confusion matrix:
      0   1
0  5942   4
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_18.png
early stop counter: 1
val acc:0.9845784306526184, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 18,now: 2024-06-09 13:35:17.870209,epoch time: 0:17:04.494597,used: 5:09:32.355315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9906056, 'precision': 0.93303156, 'recall': 0.9167644, 'specificity': 0.9167644, 'f1': 0.9247302, 'auroc': 0.99561596, 'binary_precision': 0.87157285, 'binary_recall': 0.8377254, 'binary_specificity': 0.9958033, 'binary_f1_score': 0.854314}
confusion matrix:
       0     1
0  42236   178
1    234  1208
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.9272746, 'recall': 0.8552795, 'specificity': 0.8552795, 'f1': 0.88769245, 'auroc': 0.9825253, 'binary_precision': 0.8651079, 'binary_recall': 0.71471024, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.7827502}
confusion matrix:
       0    1
0  17992   75
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9501235, 'recall': 0.55752414, 'specificity': 0.55752414, 'f1': 0.59316874, 'auroc': 0.9275015, 'binary_precision': 0.9375, 'binary_recall': 0.115384616, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5944   2
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_19.png
early stop counter: 2
val acc:0.9857524037361145, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 19,now: 2024-06-09 13:52:22.741126,epoch time: 0:17:04.870917,used: 5:26:37.226232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.949854, 'recall': 0.9111596, 'specificity': 0.9111596, 'f1': 0.92957234, 'auroc': 0.994285, 'binary_precision': 0.90563166, 'binary_recall': 0.8252427, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.8635704}
confusion matrix:
       0     1
0  42290   124
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.92452884, 'recall': 0.84190655, 'specificity': 0.84190655, 'f1': 0.8783997, 'auroc': 0.97970885, 'binary_precision': 0.8605948, 'binary_recall': 0.6879643, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.7646573}
confusion matrix:
       0    1
0  17992   75
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.9370407, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_20.png
early stop counter: 3
val acc:0.9847918748855591, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 20,now: 2024-06-09 14:09:27.548829,epoch time: 0:17:04.807703,used: 5:43:42.033935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99197376, 'precision': 0.9570247, 'recall': 0.9127823, 'specificity': 0.9127823, 'f1': 0.9336952, 'auroc': 0.99611294, 'binary_precision': 0.91987675, 'binary_recall': 0.82801664, 'binary_specificity': 0.997548, 'binary_f1_score': 0.8715329}
confusion matrix:
       0     1
0  42310   104
1    248  1194
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.93265176, 'recall': 0.8377533, 'specificity': 0.8377533, 'f1': 0.87888885, 'auroc': 0.98024786, 'binary_precision': 0.8771593, 'binary_recall': 0.679049, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.7654941}
confusion matrix:
       0    1
0  18003   64
1    216  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.90382123, 'recall': 0.5419713, 'specificity': 0.5419713, 'f1': 0.56694454, 'auroc': 0.92933875, 'binary_precision': 0.84615386, 'binary_recall': 0.08461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5942   4
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_21.png
early stop counter: 4
val acc:0.9850587248802185, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 21,now: 2024-06-09 14:26:30.912637,epoch time: 0:17:03.363808,used: 6:00:45.397743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9916773, 'precision': 0.9419203, 'recall': 0.92502224, 'specificity': 0.92502224, 'f1': 0.933294, 'auroc': 0.99645424, 'binary_precision': 0.88880867, 'binary_recall': 0.8536754, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.8708879}
confusion matrix:
       0     1
0  42260   154
1    211  1231
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.91623455, 'recall': 0.84971917, 'specificity': 0.84971917, 'f1': 0.8798465, 'auroc': 0.98006475, 'binary_precision': 0.8434164, 'binary_recall': 0.70430905, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7676113}
confusion matrix:
       0    1
0  17979   88
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.9555205, 'recall': 0.5364544, 'specificity': 0.5364544, 'f1': 0.5578835, 'auroc': 0.89806885, 'binary_precision': 0.95, 'binary_recall': 0.073076926, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.13571429}
confusion matrix:
      0   1
0  5945   1
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_22.png
early stop counter: 5
val acc:0.9846851825714111, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 22,now: 2024-06-09 14:43:37.233973,epoch time: 0:17:06.321336,used: 6:17:51.719079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99220175, 'precision': 0.9438989, 'recall': 0.9319925, 'specificity': 0.9319925, 'f1': 0.9378586, 'auroc': 0.9960203, 'binary_precision': 0.89229673, 'binary_recall': 0.86754507, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.87974685}
confusion matrix:
       0     1
0  42263   151
1    191  1251
---- Validation: 
scalar performance:
{'acc': 0.9855923, 'precision': 0.93004787, 'recall': 0.8494743, 'specificity': 0.8494743, 'f1': 0.88525754, 'auroc': 0.98150927, 'binary_precision': 0.87108654, 'binary_recall': 0.70282316, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.7779605}
confusion matrix:
       0    1
0  17997   70
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.80347526, 'recall': 0.55442375, 'specificity': 0.55442375, 'f1': 0.58488125, 'auroc': 0.9105425, 'binary_precision': 0.64444447, 'binary_recall': 0.11153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.19016394}
confusion matrix:
      0   1
0  5930  16
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_23.png
early stop counter: 6
val acc:0.9855923056602478, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 23,now: 2024-06-09 15:00:41.059921,epoch time: 0:17:03.825948,used: 6:34:55.545027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9911073, 'precision': 0.9371293, 'recall': 0.9207082, 'specificity': 0.9207082, 'f1': 0.92874944, 'auroc': 0.99494827, 'binary_precision': 0.8795094, 'binary_recall': 0.84535366, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.8620933}
confusion matrix:
       0     1
0  42247   167
1    223  1219
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.900398, 'recall': 0.83293164, 'specificity': 0.83293164, 'f1': 0.86329603, 'auroc': 0.9809894, 'binary_precision': 0.81294966, 'binary_recall': 0.6716196, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7355573}
confusion matrix:
       0    1
0  17963  104
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8689304, 'recall': 0.5588586, 'specificity': 0.5588586, 'f1': 0.59350836, 'auroc': 0.9415015, 'binary_precision': 0.775, 'binary_recall': 0.11923077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.20666668}
confusion matrix:
      0   1
0  5937   9
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_24.png
early stop counter: 7
val acc:0.9826574325561523, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9629390835762024 / 0.9650338292121887
after epoch: 24,now: 2024-06-09 15:17:44.499811,epoch time: 0:17:03.439890,used: 6:51:58.984917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927034, 'precision': 0.9614662, 'recall': 0.92052853, 'specificity': 0.92052853, 'f1': 0.9399772, 'auroc': 0.99712956, 'binary_precision': 0.9282443, 'binary_recall': 0.8432732, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.88372093}
confusion matrix:
       0     1
0  42320    94
1    226  1216
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9465908, 'recall': 0.8492849, 'specificity': 0.8492849, 'f1': 0.8915204, 'auroc': 0.98134315, 'binary_precision': 0.90421456, 'binary_recall': 0.7013373, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.7899582}
confusion matrix:
       0    1
0  18017   50
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9371946, 'recall': 0.54021645, 'specificity': 0.54021645, 'f1': 0.5642701, 'auroc': 0.9297464, 'binary_precision': 0.9130435, 'binary_recall': 0.08076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5944   2
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_25.png
better model found
persisted
after epoch: 25,now: 2024-06-09 15:34:50.177014,epoch time: 0:17:05.677203,used: 7:09:04.662120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9935471, 'precision': 0.9532224, 'recall': 0.9444113, 'specificity': 0.9444113, 'f1': 0.9487703, 'auroc': 0.9970726, 'binary_precision': 0.9101203, 'binary_recall': 0.8918169, 'binary_specificity': 0.9970057, 'binary_f1_score': 0.9008757}
confusion matrix:
       0     1
0  42287   127
1    156  1286
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9184671, 'recall': 0.8800137, 'specificity': 0.8800137, 'f1': 0.8982352, 'auroc': 0.9818245, 'binary_precision': 0.8456486, 'binary_recall': 0.7652303, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.8034321}
confusion matrix:
       0    1
0  17973   94
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.91199803, 'recall': 0.5591949, 'specificity': 0.5591949, 'f1': 0.5950731, 'auroc': 0.91683304, 'binary_precision': 0.8611111, 'binary_recall': 0.11923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.20945945}
confusion matrix:
      0   1
0  5941   5
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_26.png
early stop counter: 1
val acc:0.9865528345108032, best validation acc: 0.9866061806678772, corresponding to test acc:                         0.9611666202545166 / 0.9650338292121887
after epoch: 26,now: 2024-06-09 15:51:54.214298,epoch time: 0:17:04.037284,used: 7:26:08.699404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9939347, 'precision': 0.95395625, 'recall': 0.95030594, 'specificity': 0.95030594, 'f1': 0.95212317, 'auroc': 0.99806154, 'binary_precision': 0.91118884, 'binary_recall': 0.9036061, 'binary_specificity': 0.9970057, 'binary_f1_score': 0.9073816}
confusion matrix:
       0     1
0  42287   127
1    139  1303
---- Validation: 
scalar performance:
{'acc': 0.986873, 'precision': 0.92046624, 'recall': 0.88304085, 'specificity': 0.88304085, 'f1': 0.90080744, 'auroc': 0.98303545, 'binary_precision': 0.84942716, 'binary_recall': 0.77117383, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.80841124}
confusion matrix:
       0    1
0  17975   92
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9617562, 'recall': 0.5479928, 'specificity': 0.5479928, 'f1': 0.5776814, 'auroc': 0.9275187, 'binary_precision': 0.96153843, 'binary_recall': 0.09615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5945   1
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_27.png
better model found
persisted
after epoch: 27,now: 2024-06-09 16:09:01.738791,epoch time: 0:17:07.524493,used: 7:43:16.223897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9929086, 'precision': 0.97733945, 'recall': 0.9081781, 'specificity': 0.9081781, 'f1': 0.9398663, 'auroc': 0.99716747, 'binary_precision': 0.9608483, 'binary_recall': 0.81748784, 'binary_specificity': 0.99886835, 'binary_f1_score': 0.88338953}
confusion matrix:
       0     1
0  42367    48
1    263  1178
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.9435145, 'recall': 0.8255384, 'specificity': 0.8255384, 'f1': 0.8747752, 'auroc': 0.981187, 'binary_precision': 0.8997955, 'binary_recall': 0.653789, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.757315}
confusion matrix:
       0    1
0  18018   49
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.94394696, 'recall': 0.5479087, 'specificity': 0.5479087, 'f1': 0.5773349, 'auroc': 0.9360014, 'binary_precision': 0.9259259, 'binary_recall': 0.09615385, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.17421603}
confusion matrix:
      0   1
0  5944   2
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_28.png
early stop counter: 1
val acc:0.9849519729614258, best validation acc: 0.9868729710578918, corresponding to test acc:                         0.9619722962379456 / 0.9650338292121887
after epoch: 28,now: 2024-06-09 16:26:05.670237,epoch time: 0:17:03.931446,used: 8:00:20.155343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9925666, 'precision': 0.97085387, 'recall': 0.90873444, 'specificity': 0.90873444, 'f1': 0.937443, 'auroc': 0.9969784, 'binary_precision': 0.94783306, 'binary_recall': 0.8190014, 'binary_specificity': 0.9984675, 'binary_f1_score': 0.8787202}
confusion matrix:
       0     1
0  42349    65
1    261  1181
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.9374515, 'recall': 0.84086347, 'specificity': 0.84086347, 'f1': 0.8826866, 'auroc': 0.98313826, 'binary_precision': 0.88653845, 'binary_recall': 0.68499255, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.7728415}
confusion matrix:
       0    1
0  18008   59
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.94665694, 'recall': 0.5517549, 'specificity': 0.5517549, 'f1': 0.5837333, 'auroc': 0.9286371, 'binary_precision': 0.9310345, 'binary_recall': 0.103846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18685122}
confusion matrix:
      0   1
0  5944   2
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_29.png
early stop counter: 2
val acc:0.9855389595031738, best validation acc: 0.9868729710578918, corresponding to test acc:                         0.9619722962379456 / 0.9650338292121887
after epoch: 29,now: 2024-06-09 16:43:17.862089,epoch time: 0:17:12.191852,used: 8:17:32.347195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9913125, 'precision': 0.9858465, 'recall': 0.8752608, 'specificity': 0.8752608, 'f1': 0.9229693, 'auroc': 0.9981276, 'binary_precision': 0.9800905, 'binary_recall': 0.7510402, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.85041225}
confusion matrix:
       0     1
0  42392    22
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.9833511, 'precision': 0.95867705, 'recall': 0.7882296, 'specificity': 0.7882296, 'f1': 0.85259384, 'auroc': 0.9805577, 'binary_precision': 0.9328537, 'binary_recall': 0.5780089, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.71376145}
confusion matrix:
       0    1
0  18039   28
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.94534755, 'recall': 0.5498318, 'specificity': 0.5498318, 'f1': 0.580545, 'auroc': 0.91952056, 'binary_precision': 0.9285714, 'binary_recall': 0.1, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18055557}
confusion matrix:
      0   1
0  5944   2
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_30.png
early stop counter: 3
val acc:0.9833511114120483, best validation acc: 0.9868729710578918, corresponding to test acc:                         0.9619722962379456 / 0.9650338292121887
after epoch: 30,now: 2024-06-09 17:00:23.985938,epoch time: 0:17:06.123849,used: 8:34:38.471044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_08_25_45_seed_1_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:34:38.471044 at 2024-06-09 17:00:23.985938
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.90674806, 'recall': 0.5438944, 'specificity': 0.5438944, 'f1': 0.5702013, 'auroc': 0.92881817, 'binary_precision': 0.8518519, 'binary_recall': 0.08846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.16027877}
confusion matrix:
      0   1
0  5942   4
1   237  23
oracle model performance metric: 

scalar performance:
{'acc': 0.96358365, 'precision': 0.8791477, 'recall': 0.5874525, 'specificity': 0.5874525, 'f1': 0.6353106, 'auroc': 0.94973075, 'binary_precision': 0.79310346, 'binary_recall': 0.17692308, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.28930816}
confusion matrix:
      0   1
0  5934  12
1   214  46
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16700 MiB |  16700 MiB |  31208 MiB |  14508 MiB |
|       from large pool |  16672 MiB |  16672 MiB |  31178 MiB |  14506 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474666 KiB |    851 MiB |    880 TiB |    880 TiB |
|       from large pool | 454720 KiB |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |  19946 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304413 K  |  304410 K  |
|       from large pool |     247    |     989    |  124418 K  |  124418 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304413 K  |  304410 K  |
|       from large pool |     247    |     989    |  124418 K  |  124418 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     619    |     619    |    1117    |     498    |
|       from large pool |     605    |     605    |    1102    |     497    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |    2876    |  168440 K  |  168440 K  |
|       from large pool |     110    |     508    |   82250 K  |   82250 K  |
|       from small pool |      33    |    2764    |   86189 K  |   86189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  31208 MiB |  29038 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  31178 MiB |  29034 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |    880 TiB |    880 TiB |
|       from large pool |      0 B   |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |      0 B   |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1117    |     998    |
|       from large pool |     106    |     605    |    1102    |     996    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2876    |  168441 K  |  168441 K  |
|       from large pool |       0    |     508    |   82250 K  |   82250 K  |
|       from small pool |       0    |    2764    |   86191 K  |   86191 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   2092 TiB |   2092 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   2067 TiB |   2067 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   2085 TiB |   2085 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  31208 MiB |  29038 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  31178 MiB |  29034 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |    880 TiB |    880 TiB |
|       from large pool |      0 B   |    848 MiB |    855 TiB |    855 TiB |
|       from small pool |      0 B   |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304413 K  |  304413 K  |
|       from large pool |       2    |     989    |  124418 K  |  124418 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1117    |     998    |
|       from large pool |     106    |     605    |    1102    |     996    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2876    |  168441 K  |  168441 K  |
|       from large pool |       0    |     508    |   82250 K  |   82250 K  |
|       from small pool |       0    |    2764    |   86191 K  |   86191 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163

 Experiment start at: 2024-06-09 17:08:07.814206
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9688299, 'precision': 0.771163, 'recall': 0.71332204, 'specificity': 0.71332204, 'f1': 0.73843396, 'auroc': 0.9440149, 'binary_precision': 0.5622354, 'binary_recall': 0.4388632, 'binary_specificity': 0.9877809, 'binary_f1_score': 0.49294728}
confusion matrix:
       0    1
0  41794  517
1    849  664
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.75642025, 'recall': 0.71125174, 'specificity': 0.71125174, 'f1': 0.73143697, 'auroc': 0.93946064, 'binary_precision': 0.53144014, 'binary_recall': 0.43521595, 'binary_specificity': 0.98728746, 'binary_f1_score': 0.47853878}
confusion matrix:
       0    1
0  17940  231
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.90432036, 'recall': 0.6270987, 'specificity': 0.6270987, 'f1': 0.6883091, 'auroc': 0.92322266, 'binary_precision': 0.8378378, 'binary_recall': 0.25619835, 'binary_specificity': 0.997999, 'binary_f1_score': 0.39240506}
confusion matrix:
      0   1
0  5985  12
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 17:26:00.907076,epoch time: 0:17:53.092870,used: 0:17:53.092870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9730513, 'precision': 0.80357075, 'recall': 0.7719097, 'specificity': 0.7719097, 'f1': 0.7867831, 'auroc': 0.95939696, 'binary_precision': 0.62296295, 'binary_recall': 0.5558493, 'binary_specificity': 0.98797005, 'binary_f1_score': 0.5874956}
confusion matrix:
       0    1
0  41802  509
1    672  841
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.79635906, 'recall': 0.739816, 'specificity': 0.739816, 'f1': 0.764837, 'auroc': 0.95214796, 'binary_precision': 0.6095041, 'binary_recall': 0.4900332, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.54327804}
confusion matrix:
       0    1
0  17982  189
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.89702547, 'recall': 0.6331303, 'specificity': 0.6331303, 'f1': 0.69463664, 'auroc': 0.93373, 'binary_precision': 0.8227848, 'binary_recall': 0.26859504, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4049844}
confusion matrix:
      0   1
0  5983  14
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 17:43:04.139446,epoch time: 0:17:03.232370,used: 0:34:56.325240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9770217, 'precision': 0.829229, 'recall': 0.82271963, 'specificity': 0.82271963, 'f1': 0.8259387, 'auroc': 0.9686347, 'binary_precision': 0.6707153, 'binary_recall': 0.6569729, 'binary_specificity': 0.9884664, 'binary_f1_score': 0.66377294}
confusion matrix:
       0    1
0  41823  488
1    519  994
---- Validation: 
scalar performance:
{'acc': 0.9765621, 'precision': 0.8193987, 'recall': 0.7823124, 'specificity': 0.7823124, 'f1': 0.79961205, 'auroc': 0.96351707, 'binary_precision': 0.6528302, 'binary_recall': 0.57475084, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.61130744}
confusion matrix:
       0    1
0  17987  184
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.8715613, 'recall': 0.6571733, 'specificity': 0.6571733, 'f1': 0.71740067, 'auroc': 0.94239646, 'binary_precision': 0.77, 'binary_recall': 0.3181818, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4502924}
confusion matrix:
      0   1
0  5974  23
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-09 18:00:05.760086,epoch time: 0:17:01.620640,used: 0:51:57.945880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9789841, 'precision': 0.8836395, 'recall': 0.76765317, 'specificity': 0.76765317, 'f1': 0.8144943, 'auroc': 0.97527486, 'binary_precision': 0.78352493, 'binary_recall': 0.54064775, 'binary_specificity': 0.9946586, 'binary_f1_score': 0.6398123}
confusion matrix:
       0    1
0  42085  226
1    695  818
---- Validation: 
scalar performance:
{'acc': 0.97789377, 'precision': 0.8672346, 'recall': 0.7291961, 'specificity': 0.7291961, 'f1': 0.78106844, 'auroc': 0.9665947, 'binary_precision': 0.75202155, 'binary_recall': 0.46345514, 'binary_specificity': 0.994937, 'binary_f1_score': 0.57348406}
confusion matrix:
       0    1
0  18079   92
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.8821371, 'recall': 0.5409054, 'specificity': 0.5409054, 'f1': 0.5656115, 'auroc': 0.943069, 'binary_precision': 0.8, 'binary_recall': 0.08264463, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14981273}
confusion matrix:
      0   1
0  5992   5
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 18:17:05.696572,epoch time: 0:16:59.936486,used: 1:08:57.882366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97887003, 'precision': 0.84543604, 'recall': 0.83132446, 'specificity': 0.83132446, 'f1': 0.83821946, 'auroc': 0.9764004, 'binary_precision': 0.7025535, 'binary_recall': 0.6728354, 'binary_specificity': 0.9898135, 'binary_f1_score': 0.68737346}
confusion matrix:
       0     1
0  41880   431
1    495  1018
---- Validation: 
scalar performance:
{'acc': 0.97927874, 'precision': 0.84540546, 'recall': 0.8013828, 'specificity': 0.8013828, 'f1': 0.8217708, 'auroc': 0.9659344, 'binary_precision': 0.7036329, 'binary_recall': 0.6112957, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.65422225}
confusion matrix:
       0    1
0  18016  155
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9482064, 'recall': 0.5556184, 'specificity': 0.5556184, 'f1': 0.59074265, 'auroc': 0.94071746, 'binary_precision': 0.9310345, 'binary_recall': 0.11157025, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19926198}
confusion matrix:
      0   1
0  5995   2
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 18:34:09.939802,epoch time: 0:17:04.243230,used: 1:26:02.125596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9832284, 'precision': 0.871356, 'recall': 0.8801048, 'specificity': 0.8801048, 'f1': 0.8756749, 'auroc': 0.97925144, 'binary_precision': 0.75096774, 'binary_recall': 0.76933247, 'binary_specificity': 0.9908771, 'binary_f1_score': 0.76003927}
confusion matrix:
       0     1
0  41925   386
1    349  1164
---- Validation: 
scalar performance:
{'acc': 0.980717, 'precision': 0.8426111, 'recall': 0.85030866, 'specificity': 0.85030866, 'f1': 0.8464133, 'auroc': 0.97390527, 'binary_precision': 0.6948052, 'binary_recall': 0.7109634, 'binary_specificity': 0.9896538, 'binary_f1_score': 0.70279145}
confusion matrix:
       0    1
0  17983  188
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.82980794, 'recall': 0.62576467, 'specificity': 0.62576467, 'f1': 0.6781845, 'auroc': 0.95073485, 'binary_precision': 0.6888889, 'binary_recall': 0.25619835, 'binary_specificity': 0.995331, 'binary_f1_score': 0.37349397}
confusion matrix:
      0   1
0  5969  28
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 18:51:14.306008,epoch time: 0:17:04.366206,used: 1:43:06.491802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98377603, 'precision': 0.9186417, 'recall': 0.8198445, 'specificity': 0.8198445, 'f1': 0.8621202, 'auroc': 0.9827232, 'binary_precision': 0.84991276, 'binary_recall': 0.6437541, 'binary_specificity': 0.99593484, 'binary_f1_score': 0.7326063}
confusion matrix:
       0    1
0  42139  172
1    539  974
---- Validation: 
scalar performance:
{'acc': 0.982102, 'precision': 0.90349257, 'recall': 0.7803558, 'specificity': 0.7803558, 'f1': 0.8300467, 'auroc': 0.9727259, 'binary_precision': 0.82125604, 'binary_recall': 0.56478405, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.6692913}
confusion matrix:
       0    1
0  18097   74
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.86674964, 'recall': 0.540822, 'specificity': 0.540822, 'f1': 0.5652903, 'auroc': 0.94273674, 'binary_precision': 0.7692308, 'binary_recall': 0.08264463, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.14925374}
confusion matrix:
      0   1
0  5991   6
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 19:08:17.840825,epoch time: 0:17:03.534817,used: 2:00:10.026619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98147136, 'precision': 0.9071871, 'recall': 0.78965366, 'specificity': 0.78965366, 'f1': 0.837741, 'auroc': 0.98301566, 'binary_precision': 0.829108, 'binary_recall': 0.58360875, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.6850272}
confusion matrix:
       0    1
0  42129  182
1    630  883
---- Validation: 
scalar performance:
{'acc': 0.9773611, 'precision': 0.87912333, 'recall': 0.7040264, 'specificity': 0.7040264, 'f1': 0.7634705, 'auroc': 0.96960455, 'binary_precision': 0.77742946, 'binary_recall': 0.41196012, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.5385451}
confusion matrix:
       0    1
0  18100   71
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8407573, 'recall': 0.60568714, 'specificity': 0.60568714, 'f1': 0.65640545, 'auroc': 0.93833506, 'binary_precision': 0.7123288, 'binary_recall': 0.21487603, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3301587}
confusion matrix:
      0   1
0  5976  21
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_8.png
early stop counter: 1
val acc:0.9773610830307007, best validation acc: 0.9821019768714905, corresponding to test acc:                         0.9634556770324707 / 0.9698669910430908
after epoch: 8,now: 2024-06-09 19:25:36.059793,epoch time: 0:17:18.218968,used: 2:17:28.245587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9829774, 'precision': 0.8668479, 'recall': 0.88411725, 'specificity': 0.88411725, 'f1': 0.8752657, 'auroc': 0.98427296, 'binary_precision': 0.74165094, 'binary_recall': 0.77792466, 'binary_specificity': 0.99030983, 'binary_f1_score': 0.7593548}
confusion matrix:
       0     1
0  41901   410
1    336  1177
---- Validation: 
scalar performance:
{'acc': 0.9820487, 'precision': 0.85074776, 'recall': 0.86705756, 'specificity': 0.86705756, 'f1': 0.85870117, 'auroc': 0.9757656, 'binary_precision': 0.7099841, 'binary_recall': 0.74418604, 'binary_specificity': 0.989929, 'binary_f1_score': 0.7266828}
confusion matrix:
       0    1
0  17988  183
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.89271593, 'recall': 0.60032254, 'specificity': 0.60032254, 'f1': 0.6538745, 'auroc': 0.9557955, 'binary_precision': 0.81666666, 'binary_recall': 0.20247933, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.32450333}
confusion matrix:
      0   1
0  5986  11
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_9.png
early stop counter: 2
val acc:0.9820486903190613, best validation acc: 0.9821019768714905, corresponding to test acc:                         0.9634556770324707 / 0.9698669910430908
after epoch: 9,now: 2024-06-09 19:42:44.928243,epoch time: 0:17:08.868450,used: 2:34:37.114037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98699343, 'precision': 0.91800153, 'recall': 0.8795054, 'specificity': 0.8795054, 'f1': 0.8977482, 'auroc': 0.98906136, 'binary_precision': 0.84441197, 'binary_recall': 0.76404494, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.80222076}
confusion matrix:
       0     1
0  42098   213
1    357  1156
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.90350956, 'recall': 0.8363664, 'specificity': 0.8363664, 'f1': 0.86666226, 'auroc': 0.9752114, 'binary_precision': 0.8176353, 'binary_recall': 0.6777409, 'binary_specificity': 0.994992, 'binary_f1_score': 0.7411445}
confusion matrix:
       0    1
0  18080   91
1    194  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.88778245, 'recall': 0.577762, 'specificity': 0.577762, 'f1': 0.6227505, 'auroc': 0.94467396, 'binary_precision': 0.80851066, 'binary_recall': 0.1570248, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26297578}
confusion matrix:
      0   1
0  5988   9
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 19:59:49.742388,epoch time: 0:17:04.814145,used: 2:51:41.928182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98772365, 'precision': 0.92453223, 'recall': 0.8843447, 'specificity': 0.8843447, 'f1': 0.90335906, 'auroc': 0.9896574, 'binary_precision': 0.85714287, 'binary_recall': 0.7732981, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.81306463}
confusion matrix:
       0     1
0  42116   195
1    343  1170
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.8971112, 'recall': 0.83038735, 'specificity': 0.83038735, 'f1': 0.8604572, 'auroc': 0.97959477, 'binary_precision': 0.8052209, 'binary_recall': 0.66611296, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.7290909}
confusion matrix:
       0    1
0  18074   97
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8735999, 'recall': 0.57966137, 'specificity': 0.57966137, 'f1': 0.624781, 'auroc': 0.94880015, 'binary_precision': 0.78, 'binary_recall': 0.16115703, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.26712328}
confusion matrix:
      0   1
0  5986  11
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_11.png
early stop counter: 1
val acc:0.9841261506080627, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9658598899841309 / 0.9698669910430908
after epoch: 11,now: 2024-06-09 20:16:53.972182,epoch time: 0:17:04.229794,used: 3:08:46.157976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9878833, 'precision': 0.9110757, 'recall': 0.90609574, 'specificity': 0.90609574, 'f1': 0.9085692, 'auroc': 0.9901118, 'binary_precision': 0.8286479, 'binary_recall': 0.8182419, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.823412}
confusion matrix:
       0     1
0  42055   256
1    275  1238
---- Validation: 
scalar performance:
{'acc': 0.9832206, 'precision': 0.86357695, 'recall': 0.8676629, 'specificity': 0.8676629, 'f1': 0.8656075, 'auroc': 0.97614324, 'binary_precision': 0.7356322, 'binary_recall': 0.74418604, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.7398844}
confusion matrix:
       0    1
0  18010  161
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97018754, 'precision': 0.8739748, 'recall': 0.66130555, 'specificity': 0.66130555, 'f1': 0.7219868, 'auroc': 0.94720995, 'binary_precision': 0.7745098, 'binary_recall': 0.3264463, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4593023}
confusion matrix:
      0   1
0  5974  23
1   163  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_12.png
new oracle model saved
early stop counter: 2
val acc:0.9832205772399902, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9658598899841309 / 0.9701875448226929
after epoch: 12,now: 2024-06-09 20:33:58.999225,epoch time: 0:17:05.027043,used: 3:25:51.185019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9872216, 'precision': 0.8999666, 'recall': 0.9111701, 'specificity': 0.9111701, 'f1': 0.90548426, 'auroc': 0.9893328, 'binary_precision': 0.80603725, 'binary_recall': 0.82947785, 'binary_specificity': 0.9928624, 'binary_f1_score': 0.8175896}
confusion matrix:
       0     1
0  42009   302
1    258  1255
---- Validation: 
scalar performance:
{'acc': 0.9817291, 'precision': 0.8445797, 'recall': 0.8749229, 'specificity': 0.8749229, 'f1': 0.85905457, 'auroc': 0.9795162, 'binary_precision': 0.6971081, 'binary_recall': 0.7607973, 'binary_specificity': 0.9890485, 'binary_f1_score': 0.72756153}
confusion matrix:
       0    1
0  17972  199
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.85185564, 'recall': 0.65469027, 'specificity': 0.65469027, 'f1': 0.71165776, 'auroc': 0.94265187, 'binary_precision': 0.7307692, 'binary_recall': 0.3140496, 'binary_specificity': 0.995331, 'binary_f1_score': 0.43930635}
confusion matrix:
      0   1
0  5969  28
1   166  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_13.png
early stop counter: 3
val acc:0.9817290902137756, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9658598899841309 / 0.9701875448226929
after epoch: 13,now: 2024-06-09 20:51:13.435973,epoch time: 0:17:14.436748,used: 3:43:05.621767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98888737, 'precision': 0.94117117, 'recall': 0.88494736, 'specificity': 0.88494736, 'f1': 0.9109955, 'auroc': 0.9920403, 'binary_precision': 0.89041096, 'binary_recall': 0.7732981, 'binary_specificity': 0.99659663, 'binary_f1_score': 0.82773256}
confusion matrix:
       0     1
0  42167   144
1    343  1170
---- Validation: 
scalar performance:
{'acc': 0.985884, 'precision': 0.90756536, 'recall': 0.85297775, 'specificity': 0.85297775, 'f1': 0.8781644, 'auroc': 0.9795452, 'binary_precision': 0.8246628, 'binary_recall': 0.7109634, 'binary_specificity': 0.994992, 'binary_f1_score': 0.7636039}
confusion matrix:
       0    1
0  18080   91
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.92468333, 'recall': 0.54727054, 'specificity': 0.54727054, 'f1': 0.57673, 'auroc': 0.944075, 'binary_precision': 0.88461536, 'binary_recall': 0.09504132, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17164178}
confusion matrix:
      0   1
0  5994   3
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_14.png
better model found
persisted
after epoch: 14,now: 2024-06-09 21:08:25.328937,epoch time: 0:17:11.892964,used: 4:00:17.514731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.989184, 'precision': 0.92514986, 'recall': 0.90995586, 'specificity': 0.90995586, 'f1': 0.9174032, 'auroc': 0.99228835, 'binary_precision': 0.85655457, 'binary_recall': 0.8248513, 'binary_specificity': 0.9950604, 'binary_f1_score': 0.8404041}
confusion matrix:
       0     1
0  42102   209
1    265  1248
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.88719517, 'recall': 0.86538625, 'specificity': 0.86538625, 'f1': 0.8759495, 'auroc': 0.98034364, 'binary_precision': 0.7830688, 'binary_recall': 0.73754156, 'binary_specificity': 0.993231, 'binary_f1_score': 0.75962365}
confusion matrix:
       0    1
0  18048  123
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84350455, 'recall': 0.59354055, 'specificity': 0.59354055, 'f1': 0.6415361, 'auroc': 0.95281386, 'binary_precision': 0.71875, 'binary_recall': 0.19008264, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.30065358}
confusion matrix:
      0   1
0  5979  18
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_15.png
early stop counter: 1
val acc:0.9850317239761353, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9644173979759216 / 0.9701875448226929
after epoch: 15,now: 2024-06-09 21:25:56.985295,epoch time: 0:17:31.656358,used: 4:17:49.171089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9884082, 'precision': 0.9610081, 'recall': 0.85729516, 'specificity': 0.85729516, 'f1': 0.902093, 'auroc': 0.99321765, 'binary_precision': 0.9320722, 'binary_recall': 0.71645737, 'binary_specificity': 0.9981329, 'binary_f1_score': 0.81016445}
confusion matrix:
       0     1
0  42232    79
1    429  1084
---- Validation: 
scalar performance:
{'acc': 0.9863634, 'precision': 0.9295026, 'recall': 0.8363614, 'specificity': 0.8363614, 'f1': 0.8768647, 'auroc': 0.97638047, 'binary_precision': 0.8696581, 'binary_recall': 0.67607975, 'binary_specificity': 0.996643, 'binary_f1_score': 0.7607477}
confusion matrix:
       0    1
0  18110   61
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.91864264, 'recall': 0.51437944, 'specificity': 0.51437944, 'f1': 0.51835, 'auroc': 0.93994087, 'binary_precision': 0.875, 'binary_recall': 0.02892562, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.055999998}
confusion matrix:
      0  1
0  5996  1
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 21:43:36.379663,epoch time: 0:17:39.394368,used: 4:35:28.565457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99016523, 'precision': 0.9477338, 'recall': 0.8993112, 'specificity': 0.8993112, 'f1': 0.92202973, 'auroc': 0.99349844, 'binary_precision': 0.9025298, 'binary_recall': 0.8017184, 'binary_specificity': 0.9969039, 'binary_f1_score': 0.8491425}
confusion matrix:
       0     1
0  42180   131
1    300  1213
---- Validation: 
scalar performance:
{'acc': 0.98572415, 'precision': 0.90757704, 'recall': 0.849683, 'specificity': 0.849683, 'f1': 0.87625, 'auroc': 0.97574174, 'binary_precision': 0.8249027, 'binary_recall': 0.70431894, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.75985664}
confusion matrix:
       0    1
0  18081   90
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8567495, 'recall': 0.53057486, 'specificity': 0.53057486, 'f1': 0.5477562, 'auroc': 0.9202428, 'binary_precision': 0.75, 'binary_recall': 0.06198347, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.114503816}
confusion matrix:
      0   1
0  5992   5
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_17.png
early stop counter: 1
val acc:0.985724151134491, best validation acc: 0.986363410949707, corresponding to test acc:                         0.9621734023094177 / 0.9701875448226929
after epoch: 17,now: 2024-06-09 22:00:55.068464,epoch time: 0:17:18.688801,used: 4:52:47.254258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9897545, 'precision': 0.96577543, 'recall': 0.87456226, 'specificity': 0.87456226, 'f1': 0.9148501, 'auroc': 0.99507046, 'binary_precision': 0.9403973, 'binary_recall': 0.7508262, 'binary_specificity': 0.9982983, 'binary_f1_score': 0.83498716}
confusion matrix:
       0     1
0  42239    72
1    377  1136
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.9105402, 'recall': 0.8275329, 'specificity': 0.8275329, 'f1': 0.8640256, 'auroc': 0.97886777, 'binary_precision': 0.8322851, 'binary_recall': 0.6594684, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.7358665}
confusion matrix:
       0    1
0  18091   80
1    205  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.9319906, 'recall': 0.53702337, 'specificity': 0.53702337, 'f1': 0.5594521, 'auroc': 0.9288089, 'binary_precision': 0.9, 'binary_recall': 0.07438017, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13740458}
confusion matrix:
      0   1
0  5995   2
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_18.png
early stop counter: 2
val acc:0.9848186373710632, best validation acc: 0.986363410949707, corresponding to test acc:                         0.9621734023094177 / 0.9701875448226929
after epoch: 18,now: 2024-06-09 22:18:06.298972,epoch time: 0:17:11.230508,used: 5:09:58.484766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9909639, 'precision': 0.9423244, 'recall': 0.9191625, 'specificity': 0.9191625, 'f1': 0.93040705, 'auroc': 0.99481905, 'binary_precision': 0.8902865, 'binary_recall': 0.8420357, 'binary_specificity': 0.9962894, 'binary_f1_score': 0.8654891}
confusion matrix:
       0     1
0  42154   157
1    239  1274
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.8871608, 'recall': 0.8678504, 'specificity': 0.8678504, 'f1': 0.877239, 'auroc': 0.97884274, 'binary_precision': 0.78283715, 'binary_recall': 0.7425249, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.76214844}
confusion matrix:
       0    1
0  18047  124
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.9019579, 'recall': 0.5533021, 'specificity': 0.5533021, 'f1': 0.58618444, 'auroc': 0.9183588, 'binary_precision': 0.83870965, 'binary_recall': 0.10743801, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19047618}
confusion matrix:
      0   1
0  5992   5
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_19.png
early stop counter: 3
val acc:0.9851382374763489, best validation acc: 0.986363410949707, corresponding to test acc:                         0.9621734023094177 / 0.9701875448226929
after epoch: 19,now: 2024-06-09 22:36:03.434080,epoch time: 0:17:57.135108,used: 5:27:55.619874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9913746, 'precision': 0.95989096, 'recall': 0.90631056, 'specificity': 0.90631056, 'f1': 0.93131566, 'auroc': 0.99474967, 'binary_precision': 0.92637116, 'binary_recall': 0.81493723, 'binary_specificity': 0.9976838, 'binary_f1_score': 0.8670886}
confusion matrix:
       0     1
0  42213    98
1    280  1233
---- Validation: 
scalar performance:
{'acc': 0.98625684, 'precision': 0.9026545, 'recall': 0.86762524, 'specificity': 0.86762524, 'f1': 0.88428175, 'auroc': 0.9820247, 'binary_precision': 0.81386864, 'binary_recall': 0.7408638, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.7756522}
confusion matrix:
       0    1
0  18069  102
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8956424, 'recall': 0.5675982, 'specificity': 0.5675982, 'f1': 0.6081659, 'auroc': 0.93562317, 'binary_precision': 0.825, 'binary_recall': 0.13636364, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.23404257}
confusion matrix:
      0   1
0  5990   7
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_20.png
early stop counter: 4
val acc:0.9862568378448486, best validation acc: 0.986363410949707, corresponding to test acc:                         0.9621734023094177 / 0.9701875448226929
after epoch: 20,now: 2024-06-09 22:53:47.071233,epoch time: 0:17:43.637153,used: 5:45:39.257027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9888189, 'precision': 0.9102384, 'recall': 0.9253807, 'specificity': 0.9253807, 'f1': 0.9176605, 'auroc': 0.99475276, 'binary_precision': 0.8255888, 'binary_recall': 0.8572373, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.8411155}
confusion matrix:
       0     1
0  42037   274
1    216  1297
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.8668047, 'recall': 0.8809244, 'specificity': 0.8809244, 'f1': 0.87371993, 'auroc': 0.97544825, 'binary_precision': 0.74121404, 'binary_recall': 0.7707641, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.7557003}
confusion matrix:
       0    1
0  18009  162
1    138  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.909307, 'recall': 0.55950046, 'specificity': 0.55950046, 'f1': 0.5961395, 'auroc': 0.9300477, 'binary_precision': 0.85294116, 'binary_recall': 0.11983471, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.21014494}
confusion matrix:
      0   1
0  5992   5
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_21.png
early stop counter: 5
val acc:0.9840195775032043, best validation acc: 0.986363410949707, corresponding to test acc:                         0.9621734023094177 / 0.9701875448226929
after epoch: 21,now: 2024-06-09 23:11:06.262581,epoch time: 0:17:19.191348,used: 6:02:58.448375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9924014, 'precision': 0.94768023, 'recall': 0.93711424, 'specificity': 0.93711424, 'f1': 0.94232905, 'auroc': 0.995749, 'binary_precision': 0.899729, 'binary_recall': 0.8777264, 'binary_specificity': 0.9965021, 'binary_f1_score': 0.8885915}
confusion matrix:
       0     1
0  42163   148
1    185  1328
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.90294135, 'recall': 0.8750453, 'specificity': 0.8750453, 'f1': 0.8884543, 'auroc': 0.9791038, 'binary_precision': 0.81395346, 'binary_recall': 0.75581396, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.783807}
confusion matrix:
       0    1
0  18067  104
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.83524287, 'recall': 0.5629657, 'specificity': 0.5629657, 'f1': 0.59920526, 'auroc': 0.917642, 'binary_precision': 0.70454544, 'binary_recall': 0.12809917, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21678323}
confusion matrix:
      0   1
0  5984  13
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_22.png
better model found
persisted
after epoch: 22,now: 2024-06-09 23:30:24.402223,epoch time: 0:19:18.139642,used: 6:22:16.588017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9917625, 'precision': 0.9407735, 'recall': 0.93487144, 'specificity': 0.93487144, 'f1': 0.937801, 'auroc': 0.99618185, 'binary_precision': 0.886059, 'binary_recall': 0.87376076, 'binary_specificity': 0.9959821, 'binary_f1_score': 0.87986696}
confusion matrix:
       0     1
0  42141   170
1    191  1322
---- Validation: 
scalar performance:
{'acc': 0.98439246, 'precision': 0.8717547, 'recall': 0.87951094, 'specificity': 0.87951094, 'f1': 0.87558943, 'auroc': 0.9816586, 'binary_precision': 0.7512195, 'binary_recall': 0.76744187, 'binary_specificity': 0.99158, 'binary_f1_score': 0.759244}
confusion matrix:
       0    1
0  18018  153
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8197886, 'recall': 0.5749455, 'specificity': 0.5749455, 'f1': 0.6154255, 'auroc': 0.9428807, 'binary_precision': 0.6727273, 'binary_recall': 0.15289256, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.24915826}
confusion matrix:
      0   1
0  5979  18
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_23.png
early stop counter: 1
val acc:0.9843924641609192, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 23,now: 2024-06-09 23:50:12.906290,epoch time: 0:19:48.504067,used: 6:42:05.092084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9911692, 'precision': 0.9760165, 'recall': 0.8877224, 'specificity': 0.8877224, 'f1': 0.9270233, 'auroc': 0.9972254, 'binary_precision': 0.9599673, 'binary_recall': 0.7766028, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.8586043}
confusion matrix:
       0     1
0  42262    49
1    338  1175
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.9284312, 'recall': 0.8033039, 'specificity': 0.8033039, 'f1': 0.85442823, 'auroc': 0.9785531, 'binary_precision': 0.86966825, 'binary_recall': 0.6096346, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.7167969}
confusion matrix:
       0    1
0  18116   55
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.87328637, 'recall': 0.5367732, 'specificity': 0.5367732, 'f1': 0.5585493, 'auroc': 0.91259694, 'binary_precision': 0.7826087, 'binary_recall': 0.07438017, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13584906}
confusion matrix:
      0   1
0  5992   5
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_24.png
early stop counter: 2
val acc:0.984552264213562, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 24,now: 2024-06-10 00:09:20.823827,epoch time: 0:19:07.917537,used: 7:01:13.009621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99144304, 'precision': 0.93957317, 'recall': 0.93088216, 'specificity': 0.93088216, 'f1': 0.9351807, 'auroc': 0.9970169, 'binary_precision': 0.88394064, 'binary_recall': 0.86582947, 'binary_specificity': 0.99593484, 'binary_f1_score': 0.8747913}
confusion matrix:
       0     1
0  42139   172
1    203  1310
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.8815613, 'recall': 0.8766564, 'specificity': 0.8766564, 'f1': 0.87909174, 'auroc': 0.9834808, 'binary_precision': 0.7710438, 'binary_recall': 0.7607973, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.7658863}
confusion matrix:
       0    1
0  18035  136
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.86022484, 'recall': 0.62229943, 'specificity': 0.62229943, 'f1': 0.6780268, 'auroc': 0.9235954, 'binary_precision': 0.75, 'binary_recall': 0.24793388, 'binary_specificity': 0.996665, 'binary_f1_score': 0.37267083}
confusion matrix:
      0   1
0  5977  20
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_25.png
early stop counter: 3
val acc:0.9850849509239197, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 25,now: 2024-06-10 00:27:51.165260,epoch time: 0:18:30.341433,used: 7:19:43.351054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9936108, 'precision': 0.9533767, 'recall': 0.95048666, 'specificity': 0.95048666, 'f1': 0.9519267, 'auroc': 0.9976585, 'binary_precision': 0.9101796, 'binary_recall': 0.9041639, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.90716183}
confusion matrix:
       0     1
0  42176   135
1    145  1368
---- Validation: 
scalar performance:
{'acc': 0.98593724, 'precision': 0.88851535, 'recall': 0.8835211, 'specificity': 0.8835211, 'f1': 0.88600075, 'auroc': 0.98286724, 'binary_precision': 0.7845118, 'binary_recall': 0.77408636, 'binary_specificity': 0.9929558, 'binary_f1_score': 0.7792642}
confusion matrix:
       0    1
0  18043  128
1    136  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.90035266, 'recall': 0.5819776, 'specificity': 0.5819776, 'f1': 0.629316, 'auroc': 0.9425367, 'binary_precision': 0.8333333, 'binary_recall': 0.16528925, 'binary_specificity': 0.998666, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5989   8
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_26.png
early stop counter: 4
val acc:0.985937237739563, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 26,now: 2024-06-10 00:49:41.402164,epoch time: 0:21:50.236904,used: 7:41:33.587958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99196786, 'precision': 0.9449891, 'recall': 0.9330659, 'specificity': 0.9330659, 'f1': 0.9389399, 'auroc': 0.9970033, 'binary_precision': 0.8946295, 'binary_recall': 0.8697951, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.88203746}
confusion matrix:
       0     1
0  42156   155
1    197  1316
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.90031767, 'recall': 0.8790605, 'specificity': 0.8790605, 'f1': 0.88937646, 'auroc': 0.98037183, 'binary_precision': 0.80843586, 'binary_recall': 0.7641196, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.7856533}
confusion matrix:
       0    1
0  18062  109
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.938745, 'recall': 0.5432217, 'specificity': 0.5432217, 'f1': 0.5701157, 'auroc': 0.939011, 'binary_precision': 0.9130435, 'binary_recall': 0.08677686, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.15849057}
confusion matrix:
      0   1
0  5995   2
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_27.png
early stop counter: 5
val acc:0.9866297245025635, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 27,now: 2024-06-10 01:08:55.912212,epoch time: 0:19:14.510048,used: 8:00:48.098006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99023366, 'precision': 0.9002458, 'recall': 0.97168064, 'specificity': 0.97168064, 'f1': 0.93277097, 'auroc': 0.99702215, 'binary_precision': 0.8022284, 'binary_recall': 0.9517515, 'binary_specificity': 0.99160975, 'binary_f1_score': 0.8706166}
confusion matrix:
       0     1
0  41956   355
1     73  1440
---- Validation: 
scalar performance:
{'acc': 0.9833804, 'precision': 0.8487719, 'recall': 0.91111004, 'specificity': 0.91111004, 'f1': 0.87715316, 'auroc': 0.98269403, 'binary_precision': 0.70308125, 'binary_recall': 0.83388704, 'binary_specificity': 0.98833305, 'binary_f1_score': 0.762918}
confusion matrix:
       0    1
0  17959  212
1    100  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8043401, 'recall': 0.6211322, 'specificity': 0.6211322, 'f1': 0.66967666, 'auroc': 0.9306604, 'binary_precision': 0.63829786, 'binary_recall': 0.24793388, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.35714287}
confusion matrix:
      0   1
0  5963  34
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_28.png
early stop counter: 6
val acc:0.9833803772926331, best validation acc: 0.9866297245025635, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 28,now: 2024-06-10 01:27:55.927884,epoch time: 0:19:00.015672,used: 8:19:48.113678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99253833, 'precision': 0.9801159, 'recall': 0.9053199, 'specificity': 0.9053199, 'f1': 0.93932384, 'auroc': 0.9981061, 'binary_precision': 0.96692914, 'binary_recall': 0.8116325, 'binary_specificity': 0.99900734, 'binary_f1_score': 0.8825009}
confusion matrix:
       0     1
0  42269    42
1    285  1228
---- Validation: 
scalar performance:
{'acc': 0.987482, 'precision': 0.9517369, 'recall': 0.8353331, 'specificity': 0.8353331, 'f1': 0.8843407, 'auroc': 0.9800539, 'binary_precision': 0.9142212, 'binary_recall': 0.67275745, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.7751196}
confusion matrix:
       0    1
0  18133   38
1    197  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8743029, 'recall': 0.52247715, 'specificity': 0.52247715, 'f1': 0.5333958, 'auroc': 0.9295943, 'binary_precision': 0.78571427, 'binary_recall': 0.045454547, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08593751}
confusion matrix:
      0   1
0  5994   3
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_29.png
better model found
persisted
after epoch: 29,now: 2024-06-10 01:46:34.823120,epoch time: 0:18:38.895236,used: 8:38:27.008914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9941128, 'precision': 0.96724725, 'recall': 0.9427803, 'specificity': 0.9427803, 'f1': 0.9546591, 'auroc': 0.9979353, 'binary_precision': 0.9385045, 'binary_recall': 0.8876405, 'binary_specificity': 0.99792016, 'binary_f1_score': 0.9123642}
confusion matrix:
       0     1
0  42223    88
1    170  1343
---- Validation: 
scalar performance:
{'acc': 0.9878016, 'precision': 0.9177816, 'recall': 0.87805974, 'specificity': 0.87805974, 'f1': 0.8968545, 'auroc': 0.9828713, 'binary_precision': 0.8434622, 'binary_recall': 0.7607973, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  18086   85
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.88041973, 'recall': 0.56338257, 'specificity': 0.56338257, 'f1': 0.6013427, 'auroc': 0.90241593, 'binary_precision': 0.7948718, 'binary_recall': 0.12809917, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22064056}
confusion matrix:
      0   1
0  5989   8
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261163_30.png
better model found
persisted
after epoch: 30,now: 2024-06-10 02:09:09.264675,epoch time: 0:22:34.441555,used: 9:01:01.450469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_17_08_07_seed_2_21261163
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:01:01.450469 at 2024-06-10 02:09:09.264675
persisted model performance metric: 

scalar performance:
{'acc': 0.9648982, 'precision': 0.8971194, 'recall': 0.55941707, 'specificity': 0.55941707, 'f1': 0.59571844, 'auroc': 0.91266865, 'binary_precision': 0.82857144, 'binary_recall': 0.11983471, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.20938629}
confusion matrix:
      0   1
0  5991   6
1   213  29
oracle model performance metric: 

scalar performance:
{'acc': 0.9669819, 'precision': 0.8423581, 'recall': 0.62196594, 'specificity': 0.62196594, 'f1': 0.6755731, 'auroc': 0.9510344, 'binary_precision': 0.71428573, 'binary_recall': 0.24793388, 'binary_specificity': 0.995998, 'binary_f1_score': 0.36809817}
confusion matrix:
      0   1
0  5973  24
1   182  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      6 MiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      6 MiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   3124 TiB |   3124 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   3087 TiB |   3087 TiB |
|       from small pool |      5 MiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16700 MiB |  16700 MiB |  45738 MiB |  29038 MiB |
|       from large pool |  16672 MiB |  16672 MiB |  45706 MiB |  29034 MiB |
|       from small pool |     28 MiB |     28 MiB |     32 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474660 KiB |    851 MiB |   1304 TiB |   1304 TiB |
|       from large pool | 454720 KiB |    848 MiB |   1266 TiB |   1266 TiB |
|       from small pool |  19940 KiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3354    |    6365    |  456175 K  |  456172 K  |
|       from large pool |     247    |     989    |  186385 K  |  186385 K  |
|       from small pool |    3107    |    6116    |  269790 K  |  269787 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3354    |    6365    |  456175 K  |  456172 K  |
|       from large pool |     247    |     989    |  186385 K  |  186385 K  |
|       from small pool |    3107    |    6116    |  269790 K  |  269787 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     619    |     619    |    1617    |     998    |
|       from large pool |     605    |     605    |    1601    |     996    |
|       from small pool |      14    |      14    |      16    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |    2876    |  252576 K  |  252576 K  |
|       from large pool |     110    |     508    |  123539 K  |  123539 K  |
|       from small pool |      32    |    2764    |  129036 K  |  129036 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      0 KiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   3135 TiB |   3135 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   3097 TiB |   3097 TiB |
|       from small pool |      0 KiB |     26 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   3124 TiB |   3124 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   3087 TiB |   3087 TiB |
|       from small pool |      0 KiB |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16700 MiB |  45738 MiB |  43568 MiB |
|       from large pool |   2144 MiB |  16672 MiB |  45706 MiB |  43562 MiB |
|       from small pool |     26 MiB |     28 MiB |     32 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB |   1304 TiB |   1304 TiB |
|       from large pool |      0 B   |    848 MiB |   1266 TiB |   1266 TiB |
|       from small pool |      0 B   |     25 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  456175 K  |  456175 K  |
|       from large pool |       2    |     989    |  186385 K  |  186385 K  |
|       from small pool |       0    |    6116    |  269790 K  |  269790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  456175 K  |  456175 K  |
|       from large pool |       2    |     989    |  186385 K  |  186385 K  |
|       from small pool |       0    |    6116    |  269790 K  |  269790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     619    |    1617    |    1498    |
|       from large pool |     106    |     605    |    1601    |    1495    |
|       from small pool |      13    |      14    |      16    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2876    |  252577 K  |  252577 K  |
|       from large pool |       0    |     508    |  123539 K  |  123539 K  |
|       from small pool |       0    |    2764    |  129038 K  |  129038 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 10 02:10:52 2024]
Finished job 0.
1 of 1 steps (100%) done
