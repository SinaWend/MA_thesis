Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 11:06:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598

 Experiment start at: 2024-06-07 11:13:03.284276
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.971867, 'precision': 0.79354554, 'recall': 0.7287305, 'specificity': 0.7287305, 'f1': 0.75673544, 'auroc': 0.9676152, 'binary_precision': 0.6054481, 'binary_recall': 0.46807066, 'binary_specificity': 0.9893904, 'binary_f1_score': 0.52796936}
confusion matrix:
       0    1
0  41871  449
1    783  689
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.78480244, 'recall': 0.71538496, 'specificity': 0.71538496, 'f1': 0.7448057, 'auroc': 0.96425664, 'binary_precision': 0.58921164, 'binary_recall': 0.44167963, 'binary_specificity': 0.9890903, 'binary_f1_score': 0.5048889}
confusion matrix:
       0    1
0  17951  198
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.96041787, 'recall': 0.6166081, 'specificity': 0.6166081, 'f1': 0.67936647, 'auroc': 0.95457053, 'binary_precision': 0.953125, 'binary_recall': 0.23371647, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.37538463}
confusion matrix:
      0   1
0  5994   3
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 11:31:31.101653,epoch time: 0:18:27.817377,used: 0:18:27.817377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9690811, 'precision': 0.97618765, 'recall': 0.54011244, 'specificity': 0.54011244, 'f1': 0.5663412, 'auroc': 0.9766605, 'binary_precision': 0.98333335, 'binary_recall': 0.08027211, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.14842768}
confusion matrix:
       0    1
0  42320    2
1   1352  118
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.9736849, 'recall': 0.5365199, 'specificity': 0.5365199, 'f1': 0.5599264, 'auroc': 0.9750093, 'binary_precision': 0.9791667, 'binary_recall': 0.07309487, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.13603473}
confusion matrix:
       0   1
0  18148   1
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94537854, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_2.png
early stop counter: 1
val acc:0.9682311415672302, best validation acc: 0.970359742641449, corresponding to test acc:                         0.9675615429878235 / 0.9675615429878235
after epoch: 2,now: 2024-06-07 11:49:23.080461,epoch time: 0:17:51.978808,used: 0:36:19.796185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98118377, 'precision': 0.85303056, 'recall': 0.8604324, 'specificity': 0.8604324, 'f1': 0.8566897, 'auroc': 0.981705, 'binary_precision': 0.71542555, 'binary_recall': 0.73097825, 'binary_specificity': 0.9898866, 'binary_f1_score': 0.72311836}
confusion matrix:
       0     1
0  41892   428
1    396  1076
---- Validation: 
scalar performance:
{'acc': 0.98126864, 'precision': 0.8777858, 'recall': 0.82079005, 'specificity': 0.82079005, 'f1': 0.8467666, 'auroc': 0.9793637, 'binary_precision': 0.7679558, 'binary_recall': 0.64852256, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.70320404}
confusion matrix:
       0    1
0  18023  126
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8642261, 'recall': 0.54347765, 'specificity': 0.54347765, 'f1': 0.56901735, 'auroc': 0.96185046, 'binary_precision': 0.76666665, 'binary_recall': 0.08812261, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5990   7
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 12:07:28.376019,epoch time: 0:18:05.295558,used: 0:54:25.091743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9792428, 'precision': 0.9239555, 'recall': 0.72430515, 'specificity': 0.72430515, 'f1': 0.79131913, 'auroc': 0.9832188, 'binary_precision': 0.8666667, 'binary_recall': 0.45102042, 'binary_specificity': 0.9975899, 'binary_f1_score': 0.59328866}
confusion matrix:
       0    1
0  42220  102
1    807  663
---- Validation: 
scalar performance:
{'acc': 0.97722435, 'precision': 0.96184367, 'recall': 0.6769358, 'specificity': 0.6769358, 'f1': 0.7520875, 'auroc': 0.97637904, 'binary_precision': 0.9460581, 'binary_recall': 0.35458788, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.51583713}
confusion matrix:
       0    1
0  18136   13
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9563669, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_4.png
early stop counter: 1
val acc:0.9772243499755859, best validation acc: 0.9812686443328857, corresponding to test acc:                         0.9608501195907593 / 0.9675615429878235
after epoch: 4,now: 2024-06-07 12:25:47.215525,epoch time: 0:18:18.839506,used: 1:12:43.931249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838783, 'precision': 0.8738954, 'recall': 0.8797802, 'specificity': 0.8797802, 'f1': 0.8768128, 'auroc': 0.9864657, 'binary_precision': 0.7558528, 'binary_recall': 0.7681849, 'binary_specificity': 0.99137545, 'binary_f1_score': 0.761969}
confusion matrix:
       0     1
0  41956   365
1    341  1130
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.871347, 'recall': 0.8450948, 'specificity': 0.8450948, 'f1': 0.85769784, 'auroc': 0.9777656, 'binary_precision': 0.7533557, 'binary_recall': 0.6982893, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.72477806}
confusion matrix:
       0    1
0  18002  147
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8582687, 'recall': 0.60194755, 'specificity': 0.60194755, 'f1': 0.652928, 'auroc': 0.94711834, 'binary_precision': 0.75, 'binary_recall': 0.20689656, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32432434}
confusion matrix:
      0   1
0  5979  18
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 12:43:57.612834,epoch time: 0:18:10.397309,used: 1:30:54.328558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9844264, 'precision': 0.9538991, 'recall': 0.79227614, 'specificity': 0.79227614, 'f1': 0.85438526, 'auroc': 0.9899874, 'binary_precision': 0.9220086, 'binary_recall': 0.5862772, 'binary_specificity': 0.99827504, 'binary_f1_score': 0.71677744}
confusion matrix:
       0    1
0  42247   73
1    609  863
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.94467866, 'recall': 0.74250877, 'specificity': 0.74250877, 'f1': 0.8118557, 'auroc': 0.98197746, 'binary_precision': 0.90724635, 'binary_recall': 0.4867807, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.6336032}
confusion matrix:
       0    1
0  18117   32
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.9598596, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_6.png
early stop counter: 1
val acc:0.980736494064331, best validation acc: 0.9818539619445801, corresponding to test acc:                         0.9640460014343262 / 0.9675615429878235
after epoch: 6,now: 2024-06-07 13:02:10.568827,epoch time: 0:18:12.955993,used: 1:49:07.284551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9838555, 'precision': 0.9493968, 'recall': 0.78593457, 'specificity': 0.78593457, 'f1': 0.8482513, 'auroc': 0.9915063, 'binary_precision': 0.9134199, 'binary_recall': 0.5737594, 'binary_specificity': 0.9981097, 'binary_f1_score': 0.70480174}
confusion matrix:
       0    1
0  42241   80
1    627  844
---- Validation: 
scalar performance:
{'acc': 0.9788208, 'precision': 0.9503465, 'recall': 0.7077645, 'specificity': 0.7077645, 'f1': 0.78150815, 'auroc': 0.9708023, 'binary_precision': 0.9209622, 'binary_recall': 0.41679627, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.5738758}
confusion matrix:
       0    1
0  18126   23
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.9419932, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_7.png
early stop counter: 2
val acc:0.97882080078125, best validation acc: 0.9818539619445801, corresponding to test acc:                         0.9640460014343262 / 0.9675615429878235
after epoch: 7,now: 2024-06-07 13:20:30.641790,epoch time: 0:18:20.072963,used: 2:07:27.357514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98680127, 'precision': 0.88810337, 'recall': 0.9170543, 'specificity': 0.9170543, 'f1': 0.90201294, 'auroc': 0.9924774, 'binary_precision': 0.7817035, 'binary_recall': 0.84228414, 'binary_specificity': 0.9918244, 'binary_f1_score': 0.81086385}
confusion matrix:
       0     1
0  41975   346
1    232  1239
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.886686, 'recall': 0.8849455, 'specificity': 0.8849455, 'f1': 0.8858136, 'auroc': 0.9827126, 'binary_precision': 0.78125, 'binary_recall': 0.777605, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.7794232}
confusion matrix:
       0    1
0  18009  140
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.760003, 'recall': 0.5443929, 'specificity': 0.5443929, 'f1': 0.5684659, 'auroc': 0.95190024, 'binary_precision': 0.55813956, 'binary_recall': 0.09195402, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.15789475}
confusion matrix:
      0   1
0  5978  19
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 13:38:43.468910,epoch time: 0:18:12.827120,used: 2:25:40.184634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9888336, 'precision': 0.9344542, 'recall': 0.8866848, 'specificity': 0.8866848, 'f1': 0.9090724, 'auroc': 0.99359244, 'binary_precision': 0.87662834, 'binary_recall': 0.77717394, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.8239107}
confusion matrix:
       0     1
0  42159   161
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9314443, 'recall': 0.82957923, 'specificity': 0.82957923, 'f1': 0.8731781, 'auroc': 0.9824515, 'binary_precision': 0.87474334, 'binary_recall': 0.66251945, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.7539823}
confusion matrix:
       0    1
0  18088   61
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.84731734, 'recall': 0.596117, 'specificity': 0.596117, 'f1': 0.64468175, 'auroc': 0.95518786, 'binary_precision': 0.7285714, 'binary_recall': 0.1954023, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30815712}
confusion matrix:
      0   1
0  5978  19
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 13:56:39.629857,epoch time: 0:17:56.160947,used: 2:43:36.345581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9887194, 'precision': 0.92470634, 'recall': 0.8967893, 'specificity': 0.8967893, 'f1': 0.91023576, 'auroc': 0.9936843, 'binary_precision': 0.856414, 'binary_recall': 0.7982337, 'binary_specificity': 0.995345, 'binary_f1_score': 0.82630104}
confusion matrix:
       0     1
0  42123   197
1    297  1175
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9138141, 'recall': 0.827473, 'specificity': 0.827473, 'f1': 0.8652212, 'auroc': 0.97992647, 'binary_precision': 0.83960396, 'binary_recall': 0.65940905, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.738676}
confusion matrix:
       0    1
0  18068   81
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.80322945, 'recall': 0.537397, 'specificity': 0.537397, 'f1': 0.5581855, 'auroc': 0.95089734, 'binary_precision': 0.6451613, 'binary_recall': 0.07662835, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1369863}
confusion matrix:
      0   1
0  5986  11
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_10.png
early stop counter: 1
val acc:0.9840357303619385, best validation acc: 0.9852064847946167, corresponding to test acc:                         0.9634068608283997 / 0.9675615429878235
after epoch: 10,now: 2024-06-07 14:14:32.495043,epoch time: 0:17:52.865186,used: 3:01:29.210767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98933595, 'precision': 0.9019845, 'recall': 0.9442848, 'specificity': 0.9442848, 'f1': 0.92198634, 'auroc': 0.99616563, 'binary_precision': 0.80759805, 'binary_recall': 0.8959891, 'binary_specificity': 0.99258053, 'binary_f1_score': 0.8495005}
confusion matrix:
       0     1
0  42007   314
1    153  1318
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.87207174, 'recall': 0.88656205, 'specificity': 0.88656205, 'f1': 0.879166, 'auroc': 0.9812746, 'binary_precision': 0.7518685, 'binary_recall': 0.7822706, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.7667683}
confusion matrix:
       0    1
0  17983  166
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.78589785, 'recall': 0.54655874, 'specificity': 0.54655874, 'f1': 0.5724654, 'auroc': 0.93373656, 'binary_precision': 0.6097561, 'binary_recall': 0.09578544, 'binary_specificity': 0.997332, 'binary_f1_score': 0.16556291}
confusion matrix:
      0   1
0  5981  16
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_11.png
early stop counter: 2
val acc:0.9837164878845215, best validation acc: 0.9852064847946167, corresponding to test acc:                         0.9634068608283997 / 0.9675615429878235
after epoch: 11,now: 2024-06-07 14:32:17.437236,epoch time: 0:17:44.942193,used: 3:19:14.152960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9905234, 'precision': 0.9611473, 'recall': 0.88723123, 'specificity': 0.88723123, 'f1': 0.920732, 'auroc': 0.99639595, 'binary_precision': 0.9300244, 'binary_recall': 0.77649456, 'binary_specificity': 0.99796784, 'binary_f1_score': 0.8463532}
confusion matrix:
       0     1
0  42234    86
1    329  1143
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9319702, 'recall': 0.8094992, 'specificity': 0.8094992, 'f1': 0.85986966, 'auroc': 0.9802669, 'binary_precision': 0.877193, 'binary_recall': 0.62208396, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7279345}
confusion matrix:
       0    1
0  18093   56
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.87051165, 'recall': 0.585123, 'specificity': 0.585123, 'f1': 0.6316783, 'auroc': 0.94985676, 'binary_precision': 0.7758621, 'binary_recall': 0.1724138, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.28213167}
confusion matrix:
      0   1
0  5984  13
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_12.png
early stop counter: 3
val acc:0.9840889573097229, best validation acc: 0.9852064847946167, corresponding to test acc:                         0.9634068608283997 / 0.9675615429878235
after epoch: 12,now: 2024-06-07 14:50:01.964287,epoch time: 0:17:44.527051,used: 3:36:58.680011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9900667, 'precision': 0.9083669, 'recall': 0.94761574, 'specificity': 0.94761574, 'f1': 0.92701477, 'auroc': 0.99632895, 'binary_precision': 0.82014835, 'binary_recall': 0.9021074, 'binary_specificity': 0.993124, 'binary_f1_score': 0.85917777}
confusion matrix:
       0     1
0  42030   291
1    144  1327
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9079108, 'recall': 0.8796889, 'specificity': 0.8796889, 'f1': 0.89325225, 'auroc': 0.97858155, 'binary_precision': 0.8241206, 'binary_recall': 0.7651633, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.79354835}
confusion matrix:
       0    1
0  18044  105
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.86743087, 'recall': 0.6700793, 'specificity': 0.6700793, 'f1': 0.72926897, 'auroc': 0.9589947, 'binary_precision': 0.7627119, 'binary_recall': 0.3448276, 'binary_specificity': 0.995331, 'binary_f1_score': 0.47493407}
confusion matrix:
      0   1
0  5969  28
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-07 15:07:52.174476,epoch time: 0:17:50.210189,used: 3:54:48.890200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99075174, 'precision': 0.923054, 'recall': 0.937184, 'specificity': 0.937184, 'f1': 0.9299934, 'auroc': 0.9968034, 'binary_precision': 0.8502955, 'binary_recall': 0.87975544, 'binary_specificity': 0.99461246, 'binary_f1_score': 0.86477464}
confusion matrix:
       0     1
0  42092   228
1    177  1295
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.90644616, 'recall': 0.8611366, 'specificity': 0.8611366, 'f1': 0.8823445, 'auroc': 0.97926503, 'binary_precision': 0.8224956, 'binary_recall': 0.7278383, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.77227724}
confusion matrix:
       0    1
0  18048  101
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.78444916, 'recall': 0.6041948, 'specificity': 0.6041948, 'f1': 0.64824307, 'auroc': 0.9317168, 'binary_precision': 0.60215056, 'binary_recall': 0.21455939, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.3163842}
confusion matrix:
      0   1
0  5960  37
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_14.png
early stop counter: 1
val acc:0.9853128790855408, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.96820068359375 / 0.96820068359375
after epoch: 14,now: 2024-06-07 15:25:38.559431,epoch time: 0:17:46.384955,used: 4:12:35.275155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9932408, 'precision': 0.95381415, 'recall': 0.94068825, 'specificity': 0.94068825, 'f1': 0.94714737, 'auroc': 0.9975511, 'binary_precision': 0.91164094, 'binary_recall': 0.88435376, 'binary_specificity': 0.9970228, 'binary_f1_score': 0.89779}
confusion matrix:
       0     1
0  42196   126
1    170  1300
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9182847, 'recall': 0.8577169, 'specificity': 0.8577169, 'f1': 0.8854487, 'auroc': 0.98303103, 'binary_precision': 0.8464351, 'binary_recall': 0.7200622, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7781513}
confusion matrix:
       0    1
0  18065   84
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.87440306, 'recall': 0.58895445, 'specificity': 0.58895445, 'f1': 0.63711035, 'auroc': 0.9389933, 'binary_precision': 0.78333336, 'binary_recall': 0.18007663, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29283488}
confusion matrix:
      0   1
0  5984  13
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_15.png
early stop counter: 2
val acc:0.9859514832496643, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.96820068359375 / 0.96820068359375
after epoch: 15,now: 2024-06-07 15:43:20.615814,epoch time: 0:17:42.056383,used: 4:30:17.331538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99018085, 'precision': 0.91779816, 'recall': 0.93422306, 'specificity': 0.93422306, 'f1': 0.9258391, 'auroc': 0.9967387, 'binary_precision': 0.83997387, 'binary_recall': 0.8742352, 'binary_specificity': 0.9942109, 'binary_f1_score': 0.8567621}
confusion matrix:
       0     1
0  42076   245
1    185  1286
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8856101, 'recall': 0.86183774, 'specificity': 0.86183774, 'f1': 0.8733134, 'auroc': 0.97822165, 'binary_precision': 0.7807309, 'binary_recall': 0.7309487, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.7550201}
confusion matrix:
       0    1
0  18017  132
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8245563, 'recall': 0.54131186, 'specificity': 0.54131186, 'f1': 0.5648996, 'auroc': 0.9494696, 'binary_precision': 0.6875, 'binary_recall': 0.08429119, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.15017064}
confusion matrix:
      0   1
0  5987  10
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_16.png
early stop counter: 3
val acc:0.9837697148323059, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.96820068359375 / 0.96820068359375
after epoch: 16,now: 2024-06-07 16:01:00.173724,epoch time: 0:17:39.557910,used: 4:47:56.889448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.86556214, 'recall': 0.9534499, 'specificity': 0.9534499, 'f1': 0.9043469, 'auroc': 0.99505204, 'binary_precision': 0.7339848, 'binary_recall': 0.91847825, 'binary_specificity': 0.98842156, 'binary_f1_score': 0.8159324}
confusion matrix:
       0     1
0  41830   490
1    120  1352
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.8508539, 'recall': 0.88546, 'specificity': 0.88546, 'f1': 0.8672666, 'auroc': 0.9763997, 'binary_precision': 0.70944995, 'binary_recall': 0.7822706, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.7440828}
confusion matrix:
       0    1
0  17943  206
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7866551, 'recall': 0.5782087, 'specificity': 0.5782087, 'f1': 0.61717916, 'auroc': 0.9351504, 'binary_precision': 0.6086956, 'binary_recall': 0.16091955, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.25454545}
confusion matrix:
      0   1
0  5970  27
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_17.png
early stop counter: 4
val acc:0.9815878868103027, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.96820068359375 / 0.96820068359375
after epoch: 17,now: 2024-06-07 16:18:38.172266,epoch time: 0:17:37.998542,used: 5:05:34.887990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9929668, 'precision': 0.937075, 'recall': 0.95767367, 'specificity': 0.95767367, 'f1': 0.947118, 'auroc': 0.99818516, 'binary_precision': 0.876943, 'binary_recall': 0.91983694, 'binary_specificity': 0.9955104, 'binary_f1_score': 0.897878}
confusion matrix:
       0     1
0  42130   190
1    118  1354
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9155895, 'recall': 0.8830749, 'specificity': 0.8830749, 'f1': 0.8986162, 'auroc': 0.9761634, 'binary_precision': 0.8392555, 'binary_recall': 0.7713841, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.8038899}
confusion matrix:
       0    1
0  18054   95
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8500357, 'recall': 0.5735454, 'specificity': 0.5735454, 'f1': 0.6145333, 'auroc': 0.94627994, 'binary_precision': 0.7358491, 'binary_recall': 0.14942528, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.24840763}
confusion matrix:
      0   1
0  5983  14
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 16:36:52.943063,epoch time: 0:18:14.770797,used: 5:23:49.658787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99314946, 'precision': 0.9576682, 'recall': 0.934818, 'specificity': 0.934818, 'f1': 0.9459281, 'auroc': 0.99749184, 'binary_precision': 0.9197708, 'binary_recall': 0.8722826, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.8953975}
confusion matrix:
       0     1
0  42208   112
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9302855, 'recall': 0.8326345, 'specificity': 0.8326345, 'f1': 0.8747349, 'auroc': 0.9782368, 'binary_precision': 0.872211, 'binary_recall': 0.6687403, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7570422}
confusion matrix:
       0    1
0  18086   63
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8446002, 'recall': 0.54522663, 'specificity': 0.54522663, 'f1': 0.57156885, 'auroc': 0.93762064, 'binary_precision': 0.72727275, 'binary_recall': 0.09195402, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1632653}
confusion matrix:
      0   1
0  5988   9
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_19.png
early stop counter: 1
val acc:0.9853128790855408, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 19,now: 2024-06-07 16:54:43.387737,epoch time: 0:17:50.444674,used: 5:41:40.103461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99198484, 'precision': 0.95060986, 'recall': 0.9230683, 'specificity': 0.9230683, 'f1': 0.93637145, 'auroc': 0.9975854, 'binary_precision': 0.90645397, 'binary_recall': 0.8491848, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.8768853}
confusion matrix:
       0     1
0  42191   129
1    222  1250
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9265574, 'recall': 0.8356072, 'specificity': 0.8356072, 'f1': 0.8752384, 'auroc': 0.9815064, 'binary_precision': 0.8645418, 'binary_recall': 0.6749611, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.75807863}
confusion matrix:
       0    1
0  18081   68
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8444077, 'recall': 0.57912576, 'specificity': 0.57912576, 'f1': 0.6220279, 'auroc': 0.94952124, 'binary_precision': 0.7241379, 'binary_recall': 0.16091955, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2633229}
confusion matrix:
      0   1
0  5981  16
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_20.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 20,now: 2024-06-07 17:12:47.418403,epoch time: 0:18:04.030666,used: 5:59:44.134127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99408567, 'precision': 0.941115, 'recall': 0.9720052, 'specificity': 0.9720052, 'f1': 0.9559952, 'auroc': 0.99875987, 'binary_precision': 0.8840304, 'binary_recall': 0.94833446, 'binary_specificity': 0.9956759, 'binary_f1_score': 0.91505414}
confusion matrix:
       0     1
0  42138   183
1     76  1395
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.8988571, 'recall': 0.8754703, 'specificity': 0.8754703, 'f1': 0.88678074, 'auroc': 0.98176444, 'binary_precision': 0.8062914, 'binary_recall': 0.7573872, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.7810746}
confusion matrix:
       0    1
0  18032  117
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8560934, 'recall': 0.5943681, 'specificity': 0.5943681, 'f1': 0.64308554, 'auroc': 0.95703375, 'binary_precision': 0.74626863, 'binary_recall': 0.19157088, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.30487803}
confusion matrix:
      0   1
0  5980  17
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_21.png
early stop counter: 3
val acc:0.985472559928894, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 21,now: 2024-06-07 17:31:03.145743,epoch time: 0:18:15.727340,used: 6:17:59.861467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99237305, 'precision': 0.9195044, 'recall': 0.9737438, 'specificity': 0.9737438, 'f1': 0.94483757, 'auroc': 0.9985987, 'binary_precision': 0.84062314, 'binary_recall': 0.95377296, 'binary_specificity': 0.9937147, 'binary_f1_score': 0.8936305}
confusion matrix:
       0     1
0  42055   266
1     68  1403
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.8854687, 'recall': 0.88489044, 'specificity': 0.88489044, 'f1': 0.88517934, 'auroc': 0.9764477, 'binary_precision': 0.7788162, 'binary_recall': 0.777605, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.7782101}
confusion matrix:
       0    1
0  18007  142
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8561338, 'recall': 0.6207711, 'specificity': 0.6207711, 'f1': 0.6754398, 'auroc': 0.9477172, 'binary_precision': 0.74418604, 'binary_recall': 0.24521072, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.36887607}
confusion matrix:
      0   1
0  5975  22
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_22.png
early stop counter: 4
val acc:0.9848339557647705, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 22,now: 2024-06-07 17:49:20.068499,epoch time: 0:18:16.922756,used: 6:36:16.784223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99292105, 'precision': 0.9297981, 'recall': 0.9674655, 'specificity': 0.9674655, 'f1': 0.9477757, 'auroc': 0.99854916, 'binary_precision': 0.86168224, 'binary_recall': 0.9401767, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.89921975}
confusion matrix:
       0     1
0  42099   222
1     88  1383
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.88226783, 'recall': 0.88628036, 'specificity': 0.88628036, 'f1': 0.8842627, 'auroc': 0.97535264, 'binary_precision': 0.7723077, 'binary_recall': 0.7807154, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.77648884}
confusion matrix:
       0    1
0  18001  148
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7131212, 'recall': 0.5672961, 'specificity': 0.5672961, 'f1': 0.5975393, 'auroc': 0.9059827, 'binary_precision': 0.4625, 'binary_recall': 0.14176245, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.21700878}
confusion matrix:
      0   1
0  5954  43
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_23.png
early stop counter: 5
val acc:0.9846211075782776, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 23,now: 2024-06-07 18:07:26.562973,epoch time: 0:18:06.494474,used: 6:54:23.278697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9879658, 'precision': 0.95815736, 'recall': 0.8474455, 'specificity': 0.8474455, 'f1': 0.89464957, 'auroc': 0.99484605, 'binary_precision': 0.9267631, 'binary_recall': 0.6968049, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.7954986}
confusion matrix:
       0     1
0  42240    81
1    446  1025
---- Validation: 
scalar performance:
{'acc': 0.9789272, 'precision': 0.8910006, 'recall': 0.754323, 'specificity': 0.754323, 'f1': 0.80707955, 'auroc': 0.96969545, 'binary_precision': 0.7990315, 'binary_recall': 0.5132193, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.625}
confusion matrix:
       0    1
0  18066   83
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7834983, 'recall': 0.5651322, 'specificity': 0.5651322, 'f1': 0.59951043, 'auroc': 0.91634905, 'binary_precision': 0.6034483, 'binary_recall': 0.13409962, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.21943574}
confusion matrix:
      0   1
0  5974  23
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_24.png
early stop counter: 6
val acc:0.9789271950721741, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 24,now: 2024-06-07 18:25:37.697589,epoch time: 0:18:11.134616,used: 7:12:34.413313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99625504, 'precision': 0.9793203, 'recall': 0.9623257, 'specificity': 0.9623257, 'f1': 0.97065806, 'auroc': 0.9992006, 'binary_precision': 0.961213, 'binary_recall': 0.92595106, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.9432525}
confusion matrix:
       0     1
0  42265    55
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9274205, 'recall': 0.8356347, 'specificity': 0.8356347, 'f1': 0.8755836, 'auroc': 0.977057, 'binary_precision': 0.86626744, 'binary_recall': 0.6749611, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.75874126}
confusion matrix:
       0    1
0  18082   67
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.82792723, 'recall': 0.6239355, 'specificity': 0.6239355, 'f1': 0.6756215, 'auroc': 0.9420451, 'binary_precision': 0.6875, 'binary_recall': 0.25287357, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3697479}
confusion matrix:
      0   1
0  5967  30
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_25.png
early stop counter: 7
val acc:0.9853128790855408, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 25,now: 2024-06-07 18:43:36.049919,epoch time: 0:17:58.352330,used: 7:30:32.765643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99577546, 'precision': 0.97023386, 'recall': 0.96437263, 'specificity': 0.96437263, 'f1': 0.9672835, 'auroc': 0.9992147, 'binary_precision': 0.9428768, 'binary_recall': 0.9307065, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.93675214}
confusion matrix:
       0     1
0  42237    83
1    102  1370
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.91020775, 'recall': 0.8489429, 'specificity': 0.8489429, 'f1': 0.87690425, 'auroc': 0.9780431, 'binary_precision': 0.8308824, 'binary_recall': 0.7029549, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7615838}
confusion matrix:
       0    1
0  18057   92
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9152652, 'recall': 0.59703416, 'specificity': 0.59703416, 'f1': 0.6504376, 'auroc': 0.93812585, 'binary_precision': 0.86440676, 'binary_recall': 0.1954023, 'binary_specificity': 0.998666, 'binary_f1_score': 0.31874996}
confusion matrix:
      0   1
0  5989   8
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_26.png
early stop counter: 8
val acc:0.9849404096603394, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.9622882604598999 / 0.96820068359375
after epoch: 26,now: 2024-06-07 19:01:35.641043,epoch time: 0:17:59.591124,used: 7:48:32.356767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9962322, 'precision': 0.96118176, 'recall': 0.9826304, 'specificity': 0.9826304, 'f1': 0.9716431, 'auroc': 0.9990014, 'binary_precision': 0.923476, 'binary_recall': 0.96804893, 'binary_specificity': 0.9972118, 'binary_f1_score': 0.9452373}
confusion matrix:
       0     1
0  42203   118
1     47  1424
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9242642, 'recall': 0.8756845, 'specificity': 0.8756845, 'f1': 0.8983813, 'auroc': 0.97910565, 'binary_precision': 0.85714287, 'binary_recall': 0.755832, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.80330575}
confusion matrix:
       0    1
0  18068   81
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8689884, 'recall': 0.60211426, 'specificity': 0.60211426, 'f1': 0.6539914, 'auroc': 0.94132173, 'binary_precision': 0.7714286, 'binary_recall': 0.20689656, 'binary_specificity': 0.997332, 'binary_f1_score': 0.326284}
confusion matrix:
      0   1
0  5981  16
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_27.png
better model found
persisted
after epoch: 27,now: 2024-06-07 19:19:45.738636,epoch time: 0:18:10.097593,used: 8:06:42.454360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9963007, 'precision': 0.9724047, 'recall': 0.9705459, 'specificity': 0.9705459, 'f1': 0.97147334, 'auroc': 0.9992443, 'binary_precision': 0.946794, 'binary_recall': 0.9429348, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.94486046}
confusion matrix:
       0     1
0  42242    78
1     84  1388
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.92442715, 'recall': 0.8803226, 'specificity': 0.8803226, 'f1': 0.9010694, 'auroc': 0.9764401, 'binary_precision': 0.85714287, 'binary_recall': 0.7651633, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.80854565}
confusion matrix:
       0    1
0  18067   82
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79660136, 'recall': 0.57279503, 'specificity': 0.57279503, 'f1': 0.61069626, 'auroc': 0.93209517, 'binary_precision': 0.62903225, 'binary_recall': 0.14942528, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.24148606}
confusion matrix:
      0   1
0  5974  23
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_28.png
better model found
persisted
after epoch: 28,now: 2024-06-07 19:38:05.506632,epoch time: 0:18:19.767996,used: 8:25:02.222356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9968944, 'precision': 0.975213, 'recall': 0.9770824, 'specificity': 0.9770824, 'f1': 0.9761457, 'auroc': 0.9992062, 'binary_precision': 0.9519621, 'binary_recall': 0.9558424, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.95389825}
confusion matrix:
       0     1
0  42249    71
1     65  1407
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.92330945, 'recall': 0.86329794, 'specificity': 0.86329794, 'f1': 0.890833, 'auroc': 0.97518873, 'binary_precision': 0.856102, 'binary_recall': 0.7309487, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7885906}
confusion matrix:
       0    1
0  18070   79
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8126744, 'recall': 0.6254344, 'specificity': 0.6254344, 'f1': 0.67515147, 'auroc': 0.9302314, 'binary_precision': 0.65686274, 'binary_recall': 0.256705, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.36914602}
confusion matrix:
      0   1
0  5962  35
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_29.png
early stop counter: 1
val acc:0.9865900278091431, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9608501195907593 / 0.96820068359375
after epoch: 29,now: 2024-06-07 19:56:15.235092,epoch time: 0:18:09.728460,used: 8:43:11.950816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99556994, 'precision': 0.9757068, 'recall': 0.95508623, 'specificity': 0.95508623, 'f1': 0.96515083, 'auroc': 0.9987575, 'binary_precision': 0.95448077, 'binary_recall': 0.9116848, 'binary_specificity': 0.9984877, 'binary_f1_score': 0.93259203}
confusion matrix:
       0     1
0  42256    64
1    130  1342
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9222951, 'recall': 0.8393299, 'specificity': 0.8393299, 'f1': 0.875942, 'auroc': 0.9779142, 'binary_precision': 0.8557505, 'binary_recall': 0.6827372, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7595155}
confusion matrix:
       0    1
0  18075   74
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8254826, 'recall': 0.5375638, 'specificity': 0.5375638, 'f1': 0.5587414, 'auroc': 0.94076216, 'binary_precision': 0.6896552, 'binary_recall': 0.07662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5988   9
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202598_30.png
early stop counter: 2
val acc:0.9852064847946167, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9608501195907593 / 0.96820068359375
after epoch: 30,now: 2024-06-07 20:14:20.704091,epoch time: 0:18:05.468999,used: 9:01:17.419815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202598
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:01:17.419815 at 2024-06-07 20:14:20.704091
persisted model performance metric: 

scalar performance:
{'acc': 0.96228826, 'precision': 0.82871485, 'recall': 0.5845394, 'specificity': 0.5845394, 'f1': 0.6283567, 'auroc': 0.9292066, 'binary_precision': 0.6923077, 'binary_recall': 0.1724138, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2760736}
confusion matrix:
      0   1
0  5977  20
1   216  45
oracle model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.87964773, 'recall': 0.68740404, 'specificity': 0.68740404, 'f1': 0.7480227, 'auroc': 0.95702076, 'binary_precision': 0.78571427, 'binary_recall': 0.37931034, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.51162785}
confusion matrix:
      0   1
0  5970  27
1   162  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1716 MiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |   1710 MiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1716 MiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |   1710 MiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |   3232 MiB |    874 TiB |    874 TiB |
|       from large pool |   1695 MiB |   3225 MiB |    863 TiB |    863 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3538 MiB |   3538 MiB |   3538 MiB |      0 B   |
|       from large pool |   3526 MiB |   3526 MiB |   3526 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 251358 KiB | 316407 KiB | 444214 GiB | 444214 GiB |
|       from large pool | 247808 KiB | 313088 KiB | 432718 GiB | 432718 GiB |
|       from small pool |   3550 KiB |   4815 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140612 K  |  140608 K  |
|       from large pool |     247    |     352    |   54298 K  |   54298 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140612 K  |  140608 K  |
|       from large pool |     247    |     352    |   54298 K  |   54298 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     138    |       0    |
|       from large pool |     132    |     132    |     132    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |    2824    |   66349 K  |   66349 K  |
|       from large pool |      77    |     116    |   28630 K  |   28630 K  |
|       from small pool |      19    |    2747    |   37719 K  |   37719 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3232 MiB |    874 TiB |    874 TiB |
|       from large pool |  65536 KiB |   3225 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1962 MiB |   3538 MiB |   3538 MiB |   1576 MiB |
|       from large pool |   1952 MiB |   3526 MiB |   3526 MiB |   1574 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 316407 KiB | 444215 GiB | 444215 GiB |
|       from large pool |      0 B   | 313088 KiB | 432720 GiB | 432720 GiB |
|       from small pool |      0 B   |   9339 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140612 K  |  140612 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140612 K  |  140612 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     138    |      45    |
|       from large pool |      88    |     132    |     132    |      44    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2824    |   66351 K  |   66351 K  |
|       from large pool |       0    |     116    |   28630 K  |   28630 K  |
|       from small pool |       0    |    2747    |   37720 K  |   37720 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun  7 20:16:05 2024]
Finished job 0.
1 of 1 steps (100%) done
