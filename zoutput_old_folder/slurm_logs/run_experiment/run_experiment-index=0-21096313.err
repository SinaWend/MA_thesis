Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 01:33:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313

 Experiment start at: 2024-06-05 01:45:07.067531
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97177565, 'precision': 0.779577, 'recall': 0.8109759, 'specificity': 0.8109759, 'f1': 0.7943524, 'auroc': 0.9605484, 'binary_precision': 0.57177615, 'binary_recall': 0.63858694, 'binary_specificity': 0.9833648, 'binary_f1_score': 0.6033376}
confusion matrix:
       0    1
0  41616  704
1    532  940
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96902937, 'precision': 0.76384866, 'recall': 0.80320275, 'specificity': 0.80320275, 'f1': 0.7820041, 'auroc': 0.95971096, 'binary_precision': 0.5410498, 'binary_recall': 0.62519443, 'binary_specificity': 0.98121107, 'binary_f1_score': 0.5800865}
confusion matrix:
       0    1
0  17808  341
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.89067376, 'recall': 0.6763267, 'specificity': 0.6763267, 'f1': 0.73951507, 'auroc': 0.9354135, 'binary_precision': 0.8086957, 'binary_recall': 0.35632184, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.49468088}
confusion matrix:
      0   1
0  5975  22
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 02:13:35.682341,epoch time: 0:28:28.614810,used: 0:28:28.614810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97901446, 'precision': 0.8773987, 'recall': 0.76455873, 'specificity': 0.76455873, 'f1': 0.8102838, 'auroc': 0.97120076, 'binary_precision': 0.7708129, 'binary_recall': 0.53464675, 'binary_specificity': 0.9944707, 'binary_f1_score': 0.6313678}
confusion matrix:
       0    1
0  42086  234
1    685  787
---- Validation: 
scalar performance:
{'acc': 0.9777565, 'precision': 0.8546214, 'recall': 0.7784687, 'specificity': 0.7784687, 'f1': 0.81157225, 'auroc': 0.9707918, 'binary_precision': 0.7245509, 'binary_recall': 0.5645412, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.6346154}
confusion matrix:
       0    1
0  18011  138
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7853941, 'recall': 0.55771947, 'specificity': 0.55771947, 'f1': 0.58911645, 'auroc': 0.95124114, 'binary_precision': 0.60784316, 'binary_recall': 0.118773945, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19871795}
confusion matrix:
      0   1
0  5977  20
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_2.png
better model found
persisted
after epoch: 2,now: 2024-06-05 02:41:00.944234,epoch time: 0:27:25.261893,used: 0:55:53.876703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9795168, 'precision': 0.89216727, 'recall': 0.75744253, 'specificity': 0.75744253, 'f1': 0.8097849, 'auroc': 0.97727215, 'binary_precision': 0.8008386, 'binary_recall': 0.51937455, 'binary_specificity': 0.9955105, 'binary_f1_score': 0.6301031}
confusion matrix:
       0    1
0  42131  190
1    707  764
---- Validation: 
scalar performance:
{'acc': 0.9780758, 'precision': 0.9244664, 'recall': 0.710379, 'specificity': 0.710379, 'f1': 0.77889466, 'auroc': 0.97155386, 'binary_precision': 0.8690096, 'binary_recall': 0.4230171, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.5690376}
confusion matrix:
       0    1
0  18108   41
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9423591, 'recall': 0.5667997, 'specificity': 0.5667997, 'f1': 0.6076847, 'auroc': 0.9607847, 'binary_precision': 0.92105263, 'binary_recall': 0.13409962, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2341137}
confusion matrix:
      0   1
0  5994   3
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_3.png
better model found
persisted
after epoch: 3,now: 2024-06-05 03:08:38.678896,epoch time: 0:27:37.734662,used: 1:23:31.611365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9780782, 'precision': 0.91546136, 'recall': 0.7096497, 'specificity': 0.7096497, 'f1': 0.7763946, 'auroc': 0.97976065, 'binary_precision': 0.85068494, 'binary_recall': 0.421875, 'binary_specificity': 0.99742436, 'binary_f1_score': 0.56403273}
confusion matrix:
       0    1
0  42211  109
1    851  621
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.9108717, 'recall': 0.6985221, 'specificity': 0.6985221, 'f1': 0.76517385, 'auroc': 0.9750351, 'binary_precision': 0.84262294, 'binary_recall': 0.39968896, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.54219407}
confusion matrix:
       0    1
0  18101   48
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83246374, 'recall': 0.5488913, 'specificity': 0.5488913, 'f1': 0.5771812, 'auroc': 0.96264577, 'binary_precision': 0.7027027, 'binary_recall': 0.099616855, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.17449665}
confusion matrix:
      0   1
0  5986  11
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_4.png
early stop counter: 1
val acc:0.9769050478935242, best validation acc: 0.9780758023262024, corresponding to test acc:                         0.9634068608283997 / 0.9696388840675354
after epoch: 4,now: 2024-06-05 03:36:29.710458,epoch time: 0:27:51.031562,used: 1:51:22.642927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9830791, 'precision': 0.8776076, 'recall': 0.85452795, 'specificity': 0.85452795, 'f1': 0.865673, 'auroc': 0.9840766, 'binary_precision': 0.76504713, 'binary_recall': 0.71671194, 'binary_specificity': 0.992344, 'binary_f1_score': 0.74009115}
confusion matrix:
       0     1
0  41996   324
1    417  1055
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.867591, 'recall': 0.8449295, 'specificity': 0.8449295, 'f1': 0.8558681, 'auroc': 0.97879624, 'binary_precision': 0.74584717, 'binary_recall': 0.6982893, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7212852}
confusion matrix:
       0    1
0  17996  153
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8463869, 'recall': 0.56596595, 'specificity': 0.56596595, 'f1': 0.60347915, 'auroc': 0.9608073, 'binary_precision': 0.7291667, 'binary_recall': 0.13409962, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.22653723}
confusion matrix:
      0   1
0  5984  13
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_5.png
better model found
persisted
after epoch: 5,now: 2024-06-05 04:04:12.367648,epoch time: 0:27:42.657190,used: 2:19:05.300117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9836956, 'precision': 0.9028883, 'recall': 0.8289461, 'specificity': 0.8289461, 'f1': 0.8618874, 'auroc': 0.9832966, 'binary_precision': 0.8174204, 'binary_recall': 0.6630435, 'binary_specificity': 0.9948488, 'binary_f1_score': 0.732183}
confusion matrix:
       0    1
0  42102  218
1    496  976
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.88676417, 'recall': 0.85650474, 'specificity': 0.85650474, 'f1': 0.87096596, 'auroc': 0.97844076, 'binary_precision': 0.78341794, 'binary_recall': 0.7200622, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.75040513}
confusion matrix:
       0    1
0  18021  128
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.944777, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_6.png
better model found
persisted
after epoch: 6,now: 2024-06-05 04:32:08.603800,epoch time: 0:27:56.236152,used: 2:47:01.536269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9850201, 'precision': 0.9351007, 'recall': 0.81803375, 'specificity': 0.81803375, 'f1': 0.8668058, 'auroc': 0.9881285, 'binary_precision': 0.8826291, 'binary_recall': 0.6390211, 'binary_specificity': 0.9970464, 'binary_f1_score': 0.7413249}
confusion matrix:
       0    1
0  42196  125
1    531  940
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.93554354, 'recall': 0.8080542, 'specificity': 0.8080542, 'f1': 0.8600658, 'auroc': 0.9802817, 'binary_precision': 0.8844444, 'binary_recall': 0.61897355, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.72827077}
confusion matrix:
       0    1
0  18097   52
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.94970375, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_7.png
better model found
persisted
after epoch: 7,now: 2024-06-05 05:00:45.511241,epoch time: 0:28:36.907441,used: 3:15:38.443710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.9034263, 'recall': 0.89547324, 'specificity': 0.89547324, 'f1': 0.8994069, 'auroc': 0.9893346, 'binary_precision': 0.8138889, 'binary_recall': 0.79727894, 'binary_specificity': 0.9936676, 'binary_f1_score': 0.8054983}
confusion matrix:
       0     1
0  42054   268
1    298  1172
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.88162744, 'recall': 0.87933695, 'specificity': 0.87933695, 'f1': 0.88047844, 'auroc': 0.97831154, 'binary_precision': 0.771518, 'binary_recall': 0.7667185, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.76911074}
confusion matrix:
       0    1
0  18003  146
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8454648, 'recall': 0.64126027, 'specificity': 0.64126027, 'f1': 0.69663244, 'auroc': 0.955898, 'binary_precision': 0.72115386, 'binary_recall': 0.28735632, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.41095892}
confusion matrix:
      0   1
0  5968  29
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_8.png
better model found
persisted
after epoch: 8,now: 2024-06-05 05:29:15.082936,epoch time: 0:28:29.571695,used: 3:44:08.015405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9886966, 'precision': 0.9076305, 'recall': 0.9212645, 'specificity': 0.9212645, 'f1': 0.91432595, 'auroc': 0.99169934, 'binary_precision': 0.82051283, 'binary_recall': 0.8489796, 'binary_specificity': 0.99354947, 'binary_f1_score': 0.8345035}
confusion matrix:
       0     1
0  42049   273
1    222  1248
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.88745594, 'recall': 0.8903612, 'specificity': 0.8903612, 'f1': 0.88890266, 'auroc': 0.9821553, 'binary_precision': 0.7824074, 'binary_recall': 0.7884914, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.7854377}
confusion matrix:
       0    1
0  18008  141
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.77473485, 'recall': 0.5835389, 'specificity': 0.5835389, 'f1': 0.6229538, 'auroc': 0.9485853, 'binary_precision': 0.58441556, 'binary_recall': 0.1724138, 'binary_specificity': 0.994664, 'binary_f1_score': 0.2662722}
confusion matrix:
      0   1
0  5965  32
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_9.png
better model found
persisted
after epoch: 9,now: 2024-06-05 05:57:13.160963,epoch time: 0:27:58.078027,used: 4:12:06.093432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98855954, 'precision': 0.91734505, 'recall': 0.9039196, 'specificity': 0.9039196, 'f1': 0.91051364, 'auroc': 0.9924818, 'binary_precision': 0.8411806, 'binary_recall': 0.8131794, 'binary_specificity': 0.9946597, 'binary_f1_score': 0.826943}
confusion matrix:
       0     1
0  42094   226
1    275  1197
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9089582, 'recall': 0.8720231, 'specificity': 0.8720231, 'f1': 0.88954544, 'auroc': 0.9828368, 'binary_precision': 0.82675815, 'binary_recall': 0.7496112, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7862969}
confusion matrix:
       0    1
0  18048  101
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.865989, 'recall': 0.58695537, 'specificity': 0.58695537, 'f1': 0.6339131, 'auroc': 0.9559925, 'binary_precision': 0.76666665, 'binary_recall': 0.17624521, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.28660437}
confusion matrix:
      0   1
0  5983  14
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_10.png
better model found
persisted
after epoch: 10,now: 2024-06-05 06:24:51.989331,epoch time: 0:27:38.828368,used: 4:39:44.921800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98488307, 'precision': 0.92517495, 'recall': 0.8256262, 'specificity': 0.8256262, 'f1': 0.8683064, 'auroc': 0.991155, 'binary_precision': 0.862254, 'binary_recall': 0.6548913, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.7444015}
confusion matrix:
       0    1
0  42166  154
1    508  964
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.9356443, 'recall': 0.7887243, 'specificity': 0.7887243, 'f1': 0.8462101, 'auroc': 0.9809207, 'binary_precision': 0.88598573, 'binary_recall': 0.5800933, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7011278}
confusion matrix:
       0    1
0  18101   48
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.9232124, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_11.png
early stop counter: 1
val acc:0.983077883720398, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9634068608283997 / 0.9696388840675354
after epoch: 11,now: 2024-06-05 06:52:36.500359,epoch time: 0:27:44.511028,used: 5:07:29.432828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98999816, 'precision': 0.9426052, 'recall': 0.8977105, 'specificity': 0.8977105, 'f1': 0.9188664, 'auroc': 0.99456215, 'binary_precision': 0.8921792, 'binary_recall': 0.7987763, 'binary_specificity': 0.9966447, 'binary_f1_score': 0.84289813}
confusion matrix:
       0     1
0  42179   142
1    296  1175
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.92923576, 'recall': 0.84882647, 'specificity': 0.84882647, 'f1': 0.8845546, 'auroc': 0.98262334, 'binary_precision': 0.8689788, 'binary_recall': 0.7013997, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.77624786}
confusion matrix:
       0    1
0  18081   68
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8595127, 'recall': 0.5698807, 'specificity': 0.5698807, 'f1': 0.60968745, 'auroc': 0.9468542, 'binary_precision': 0.75510204, 'binary_recall': 0.14176245, 'binary_specificity': 0.997999, 'binary_f1_score': 0.23870967}
confusion matrix:
      0   1
0  5985  12
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_12.png
better model found
persisted
after epoch: 12,now: 2024-06-05 07:20:55.709689,epoch time: 0:28:19.209330,used: 5:35:48.642158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9892903, 'precision': 0.9631945, 'recall': 0.8648633, 'specificity': 0.8648633, 'f1': 0.9077703, 'auroc': 0.9941442, 'binary_precision': 0.9356522, 'binary_recall': 0.7314752, 'binary_specificity': 0.99825144, 'binary_f1_score': 0.82106066}
confusion matrix:
       0     1
0  42247    74
1    395  1076
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9438797, 'recall': 0.7811962, 'specificity': 0.7811962, 'f1': 0.8430033, 'auroc': 0.98108125, 'binary_precision': 0.9029851, 'binary_recall': 0.5645412, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.69473684}
confusion matrix:
       0    1
0  18110   39
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.82171714, 'recall': 0.5638001, 'specificity': 0.5638001, 'f1': 0.59936976, 'auroc': 0.95502186, 'binary_precision': 0.68, 'binary_recall': 0.1302682, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2186495}
confusion matrix:
      0   1
0  5981  16
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_13.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9622882604598999 / 0.9696388840675354
after epoch: 13,now: 2024-06-05 07:49:24.450391,epoch time: 0:28:28.740702,used: 6:04:17.382860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99095726, 'precision': 0.94536126, 'recall': 0.9113894, 'specificity': 0.9113894, 'f1': 0.92764974, 'auroc': 0.9956493, 'binary_precision': 0.89675516, 'binary_recall': 0.82608694, 'binary_specificity': 0.9966919, 'binary_f1_score': 0.85997164}
confusion matrix:
       0     1
0  42180   140
1    256  1216
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9404775, 'recall': 0.8290771, 'specificity': 0.8290771, 'f1': 0.87611496, 'auroc': 0.98198426, 'binary_precision': 0.89285713, 'binary_recall': 0.66096425, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.75960684}
confusion matrix:
       0    1
0  18098   51
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7932403, 'recall': 0.6062773, 'specificity': 0.6062773, 'f1': 0.6516482, 'auroc': 0.9468248, 'binary_precision': 0.6195652, 'binary_recall': 0.21839081, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.32294616}
confusion matrix:
      0   1
0  5962  35
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_14.png
early stop counter: 2
val acc:0.985685408115387, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9622882604598999 / 0.9696388840675354
after epoch: 14,now: 2024-06-05 08:17:36.208012,epoch time: 0:28:11.757621,used: 6:32:29.140481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9896785, 'precision': 0.96752775, 'recall': 0.86727107, 'specificity': 0.86727107, 'f1': 0.91094875, 'auroc': 0.9958066, 'binary_precision': 0.9441536, 'binary_recall': 0.7360544, 'binary_specificity': 0.9984878, 'binary_f1_score': 0.82721716}
confusion matrix:
       0     1
0  42258    64
1    388  1082
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.9408177, 'recall': 0.81516284, 'specificity': 0.81516284, 'f1': 0.86678207, 'auroc': 0.98306155, 'binary_precision': 0.8945055, 'binary_recall': 0.63297045, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7413479}
confusion matrix:
       0    1
0  18101   48
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78340375, 'recall': 0.55397147, 'specificity': 0.55397147, 'f1': 0.5835702, 'auroc': 0.94365954, 'binary_precision': 0.6041667, 'binary_recall': 0.11111111, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.18770227}
confusion matrix:
      0   1
0  5978  19
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_15.png
early stop counter: 3
val acc:0.9848871827125549, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9622882604598999 / 0.9696388840675354
after epoch: 15,now: 2024-06-05 08:45:18.588348,epoch time: 0:27:42.380336,used: 7:00:11.520817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.96231115, 'recall': 0.9004667, 'specificity': 0.9004667, 'f1': 0.9290077, 'auroc': 0.9956218, 'binary_precision': 0.9314421, 'binary_recall': 0.8029891, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.86245894}
confusion matrix:
       0     1
0  42233    87
1    290  1182
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.92971754, 'recall': 0.8341621, 'specificity': 0.8341621, 'f1': 0.87550724, 'auroc': 0.9826908, 'binary_precision': 0.87096775, 'binary_recall': 0.6718507, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7585601}
confusion matrix:
       0    1
0  18085   64
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.84999824, 'recall': 0.53206676, 'specificity': 0.53206676, 'f1': 0.54964006, 'auroc': 0.921746, 'binary_precision': 0.73913044, 'binary_recall': 0.0651341, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11971831}
confusion matrix:
      0   1
0  5991   6
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_16.png
early stop counter: 4
val acc:0.9853661060333252, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9622882604598999 / 0.9696388840675354
after epoch: 16,now: 2024-06-05 09:13:00.450227,epoch time: 0:27:41.861879,used: 7:27:53.382696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9908888, 'precision': 0.95943946, 'recall': 0.89489037, 'specificity': 0.89489037, 'f1': 0.9245453, 'auroc': 0.9953824, 'binary_precision': 0.92607313, 'binary_recall': 0.79197824, 'binary_specificity': 0.9978025, 'binary_f1_score': 0.8537926}
confusion matrix:
       0     1
0  42228    93
1    306  1165
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9357575, 'recall': 0.81888556, 'specificity': 0.81888556, 'f1': 0.8675991, 'auroc': 0.9795873, 'binary_precision': 0.88412017, 'binary_recall': 0.6407465, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.7430118}
confusion matrix:
       0    1
0  18095   54
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73032445, 'recall': 0.5293173, 'specificity': 0.5293173, 'f1': 0.5439309, 'auroc': 0.87096995, 'binary_precision': 0.5, 'binary_recall': 0.06130268, 'binary_specificity': 0.997332, 'binary_f1_score': 0.10921502}
confusion matrix:
      0   1
0  5981  16
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_17.png
early stop counter: 5
val acc:0.9848339557647705, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9622882604598999 / 0.9696388840675354
after epoch: 17,now: 2024-06-05 09:41:19.543227,epoch time: 0:28:19.093000,used: 7:56:12.475696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99282974, 'precision': 0.93401325, 'recall': 0.95956993, 'specificity': 0.95956993, 'f1': 0.94639623, 'auroc': 0.9973536, 'binary_precision': 0.8706786, 'binary_recall': 0.92391306, 'binary_specificity': 0.99522686, 'binary_f1_score': 0.89650625}
confusion matrix:
       0     1
0  42118   202
1    112  1360
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.912421, 'recall': 0.90685, 'specificity': 0.90685, 'f1': 0.9096149, 'auroc': 0.9839923, 'binary_precision': 0.8312303, 'binary_recall': 0.81959563, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.8253719}
confusion matrix:
       0    1
0  18042  107
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8004977, 'recall': 0.5784588, 'specificity': 0.5784588, 'f1': 0.6184724, 'auroc': 0.93333817, 'binary_precision': 0.6363636, 'binary_recall': 0.16091955, 'binary_specificity': 0.995998, 'binary_f1_score': 0.25688073}
confusion matrix:
      0   1
0  5973  24
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_18.png
better model found
persisted
after epoch: 18,now: 2024-06-05 10:09:44.056859,epoch time: 0:28:24.513632,used: 8:24:36.989328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.9064848, 'recall': 0.96269786, 'specificity': 0.96269786, 'f1': 0.93261623, 'auroc': 0.9975605, 'binary_precision': 0.8153207, 'binary_recall': 0.93274456, 'binary_specificity': 0.9926512, 'binary_f1_score': 0.87008876}
confusion matrix:
       0     1
0  42009   311
1     99  1373
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.88848627, 'recall': 0.9111637, 'specificity': 0.9111637, 'f1': 0.8994749, 'auroc': 0.9824499, 'binary_precision': 0.78299123, 'binary_recall': 0.8304821, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.8060377}
confusion matrix:
       0    1
0  18001  148
1    109  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73788166, 'recall': 0.6009451, 'specificity': 0.6009451, 'f1': 0.6383904, 'auroc': 0.8955586, 'binary_precision': 0.5092593, 'binary_recall': 0.21072797, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.29810297}
confusion matrix:
      0   1
0  5944  53
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_19.png
early stop counter: 1
val acc:0.9863239526748657, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9611697196960449 / 0.9696388840675354
after epoch: 19,now: 2024-06-05 10:37:27.630303,epoch time: 0:27:43.573444,used: 8:52:20.562772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.993766, 'precision': 0.96490717, 'recall': 0.9371042, 'specificity': 0.9371042, 'f1': 0.9505446, 'auroc': 0.99820644, 'binary_precision': 0.9341057, 'binary_recall': 0.8763587, 'binary_specificity': 0.9978497, 'binary_f1_score': 0.90431124}
confusion matrix:
       0     1
0  42229    91
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9315219, 'recall': 0.8388554, 'specificity': 0.8388554, 'f1': 0.87918985, 'auroc': 0.97800565, 'binary_precision': 0.8742515, 'binary_recall': 0.68118197, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.76573426}
confusion matrix:
       0    1
0  18086   63
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79390097, 'recall': 0.5559705, 'specificity': 0.5559705, 'f1': 0.58688825, 'auroc': 0.9079393, 'binary_precision': 0.625, 'binary_recall': 0.11494253, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.19417475}
confusion matrix:
      0   1
0  5979  18
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096313_20.png
early stop counter: 2
val acc:0.9857386350631714, best validation acc: 0.9881332516670227, corresponding to test acc:                         0.9611697196960449 / 0.9696388840675354
after epoch: 20,now: 2024-06-05 11:04:14.271608,epoch time: 0:26:46.641305,used: 9:19:07.204077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_01_45_07_seed_0_21096313
--- Logging error ---
Traceback (most recent call last):
