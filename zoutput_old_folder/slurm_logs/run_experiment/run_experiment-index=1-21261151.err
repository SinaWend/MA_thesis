Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:34:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151

 Experiment start at: 2024-06-08 23:41:18.021622
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.95312834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.95607615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9307352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:11:08.404342,epoch time: 0:29:50.382720,used: 0:29:50.382720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9707709, 'precision': 0.7902022, 'recall': 0.6888203, 'specificity': 0.6888203, 'f1': 0.7278037, 'auroc': 0.9640862, 'binary_precision': 0.6014799, 'binary_recall': 0.3865489, 'binary_specificity': 0.99109167, 'binary_f1_score': 0.47063687}
confusion matrix:
       0    1
0  41943  377
1    903  569
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.8260422, 'recall': 0.5543008, 'specificity': 0.5543008, 'f1': 0.586835, 'auroc': 0.9639833, 'binary_precision': 0.6826923, 'binary_recall': 0.11041991, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.19009371}
confusion matrix:
       0   1
0  18116  33
1    572  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.91401833, 'recall': 0.5951184, 'specificity': 0.5951184, 'f1': 0.6477622, 'auroc': 0.949036, 'binary_precision': 0.86206895, 'binary_recall': 0.19157088, 'binary_specificity': 0.998666, 'binary_f1_score': 0.3134796}
confusion matrix:
      0   1
0  5989   8
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 00:39:58.664352,epoch time: 0:28:50.260010,used: 0:58:40.642730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.9539724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9507381, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9138434, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 3,now: 2024-06-09 01:08:40.128721,epoch time: 0:28:41.464369,used: 1:27:22.107099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9701087, 'precision': 0.7654929, 'recall': 0.8601886, 'specificity': 0.8601886, 'f1': 0.804842, 'auroc': 0.96778536, 'binary_precision': 0.5400593, 'binary_recall': 0.7423521, 'binary_specificity': 0.9780251, 'binary_f1_score': 0.62525046}
confusion matrix:
       0     1
0  41391   930
1    379  1092
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.772782, 'recall': 0.85208786, 'specificity': 0.85208786, 'f1': 0.80682266, 'auroc': 0.9667835, 'binary_precision': 0.55542314, 'binary_recall': 0.7247278, 'binary_specificity': 0.9794479, 'binary_f1_score': 0.62887996}
confusion matrix:
       0    1
0  17776  373
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98066473, 'precision': 0.9010308, 'recall': 0.8433249, 'specificity': 0.8433249, 'f1': 0.8697133, 'auroc': 0.9542711, 'binary_precision': 0.8153153, 'binary_recall': 0.6934866, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.74948233}
confusion matrix:
      0    1
0  5956   41
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-09 01:37:24.336539,epoch time: 0:28:44.207818,used: 1:56:06.314917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.968122, 'precision': 0.9776337, 'recall': 0.5261431, 'specificity': 0.5261431, 'f1': 0.54156435, 'auroc': 0.96866333, 'binary_precision': 0.98717946, 'binary_recall': 0.05230978, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.09935483}
confusion matrix:
       0   1
0  42319   1
1   1395  77
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.9432238, 'recall': 0.5263559, 'specificity': 0.5263559, 'f1': 0.54170823, 'auroc': 0.9692091, 'binary_precision': 0.9189189, 'binary_recall': 0.05287714, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.1}
confusion matrix:
       0   1
0  18146   3
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9475803, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_5.png
early stop counter: 1
val acc:0.967432975769043, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9806647300720215 / 0.9806647300720215
after epoch: 5,now: 2024-06-09 02:05:50.158208,epoch time: 0:28:25.821669,used: 2:24:32.136586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97266626, 'precision': 0.94935596, 'recall': 0.60127896, 'specificity': 0.60127896, 'f1': 0.6595974, 'auroc': 0.9754389, 'binary_precision': 0.9256966, 'binary_recall': 0.203125, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.33314762}
confusion matrix:
       0    1
0  42296   24
1   1173  299
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.92377394, 'recall': 0.5448807, 'specificity': 0.5448807, 'f1': 0.5737647, 'auroc': 0.9738285, 'binary_precision': 0.8787879, 'binary_recall': 0.090202175, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.16361071}
confusion matrix:
       0   1
0  18141   8
1    585  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9090909, 'recall': 0.5342326, 'specificity': 0.5342326, 'f1': 0.55377585, 'auroc': 0.9543923, 'binary_precision': 0.85714287, 'binary_recall': 0.06896552, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12765957}
confusion matrix:
      0   1
0  5994   3
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_6.png
early stop counter: 2
val acc:0.9684439897537231, best validation acc: 0.9707322120666504, corresponding to test acc:                         0.9806647300720215 / 0.9806647300720215
after epoch: 6,now: 2024-06-09 02:34:47.991060,epoch time: 0:28:57.832852,used: 2:53:29.969438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97883177, 'precision': 0.8614485, 'recall': 0.7838079, 'specificity': 0.7838079, 'f1': 0.8175689, 'auroc': 0.9763219, 'binary_precision': 0.7375763, 'binary_recall': 0.57472825, 'binary_specificity': 0.9928875, 'binary_f1_score': 0.6460481}
confusion matrix:
       0    1
0  42019  301
1    626  846
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.8838095, 'recall': 0.7218014, 'specificity': 0.7218014, 'f1': 0.7795118, 'auroc': 0.9730618, 'binary_precision': 0.78688526, 'binary_recall': 0.44790047, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.57086223}
confusion matrix:
       0    1
0  18071   78
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.85410035, 'recall': 0.61319166, 'specificity': 0.61319166, 'f1': 0.6663208, 'auroc': 0.95995367, 'binary_precision': 0.7407407, 'binary_recall': 0.22988506, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.3508772}
confusion matrix:
      0   1
0  5976  21
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 03:03:38.426066,epoch time: 0:28:50.435006,used: 3:22:20.404444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9812523, 'precision': 0.8693447, 'recall': 0.8272394, 'specificity': 0.8272394, 'f1': 0.84691155, 'auroc': 0.97754943, 'binary_precision': 0.7503852, 'binary_recall': 0.6621346, 'binary_specificity': 0.9923442, 'binary_f1_score': 0.7035031}
confusion matrix:
       0    1
0  41997  324
1    497  974
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.91558063, 'recall': 0.77350897, 'specificity': 0.77350897, 'f1': 0.828815, 'auroc': 0.9788718, 'binary_precision': 0.84689, 'binary_recall': 0.5505443, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.66729504}
confusion matrix:
       0    1
0  18085   64
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.76139885, 'recall': 0.5702957, 'specificity': 0.5702957, 'f1': 0.6051216, 'auroc': 0.95653844, 'binary_precision': 0.5588235, 'binary_recall': 0.14559387, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.23100303}
confusion matrix:
      0   1
0  5967  30
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 03:32:09.847925,epoch time: 0:28:31.421859,used: 3:50:51.826303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97305447, 'precision': 0.7794908, 'recall': 0.9269613, 'specificity': 0.9269613, 'f1': 0.8360466, 'auroc': 0.97974753, 'binary_precision': 0.5633188, 'binary_recall': 0.877551, 'binary_specificity': 0.97637165, 'binary_f1_score': 0.6861702}
confusion matrix:
       0     1
0  41322  1000
1    180  1290
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.80182576, 'recall': 0.91340226, 'specificity': 0.91340226, 'f1': 0.8479527, 'auroc': 0.98120284, 'binary_precision': 0.60918254, 'binary_recall': 0.8460342, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.7083333}
confusion matrix:
       0    1
0  17800  349
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8010017, 'recall': 0.66241455, 'specificity': 0.66241455, 'f1': 0.7087606, 'auroc': 0.95442355, 'binary_precision': 0.6304348, 'binary_recall': 0.33333334, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.43609023}
confusion matrix:
      0   1
0  5946  51
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_9.png
early stop counter: 1
val acc:0.9761600494384766, best validation acc: 0.9812154173851013, corresponding to test acc:                         0.9595717191696167 / 0.9806647300720215
after epoch: 9,now: 2024-06-09 04:00:19.261595,epoch time: 0:28:09.413670,used: 4:19:01.239973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97851205, 'precision': 0.91529226, 'recall': 0.7177428, 'specificity': 0.7177428, 'f1': 0.7835957, 'auroc': 0.97782123, 'binary_precision': 0.8498024, 'binary_recall': 0.43817934, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.578216}
confusion matrix:
       0    1
0  42206  114
1    827  645
---- Validation: 
scalar performance:
{'acc': 0.9775969, 'precision': 0.9246712, 'recall': 0.70188046, 'specificity': 0.70188046, 'f1': 0.7710313, 'auroc': 0.97989583, 'binary_precision': 0.87, 'binary_recall': 0.4059098, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.5535525}
confusion matrix:
       0    1
0  18110   39
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.90074766, 'recall': 0.53989637, 'specificity': 0.53989637, 'f1': 0.5634511, 'auroc': 0.95212597, 'binary_precision': 0.84, 'binary_recall': 0.08045977, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5993   4
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_10.png
early stop counter: 2
val acc:0.9775968790054321, best validation acc: 0.9812154173851013, corresponding to test acc:                         0.9595717191696167 / 0.9806647300720215
after epoch: 10,now: 2024-06-09 04:28:38.334460,epoch time: 0:28:19.072865,used: 4:47:20.312838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98289645, 'precision': 0.89645284, 'recall': 0.8213197, 'specificity': 0.8213197, 'f1': 0.8546419, 'auroc': 0.9842731, 'binary_precision': 0.8050633, 'binary_recall': 0.6480978, 'binary_specificity': 0.9945416, 'binary_f1_score': 0.7181031}
confusion matrix:
       0    1
0  42089  231
1    518  954
---- Validation: 
scalar performance:
{'acc': 0.98243934, 'precision': 0.9249947, 'recall': 0.7868936, 'specificity': 0.7868936, 'f1': 0.84156305, 'auroc': 0.9824503, 'binary_precision': 0.8648019, 'binary_recall': 0.5769829, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.6921642}
confusion matrix:
       0    1
0  18091   58
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7871803, 'recall': 0.5614675, 'specificity': 0.5614675, 'f1': 0.5945578, 'auroc': 0.9488933, 'binary_precision': 0.6111111, 'binary_recall': 0.12643678, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.20952383}
confusion matrix:
      0   1
0  5976  21
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 04:57:03.461349,epoch time: 0:28:25.126889,used: 5:15:45.439727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9807271, 'precision': 0.9287486, 'recall': 0.74774045, 'specificity': 0.74774045, 'f1': 0.81236726, 'auroc': 0.97593534, 'binary_precision': 0.8747017, 'binary_recall': 0.49796197, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.63463205}
confusion matrix:
       0    1
0  42215  105
1    739  733
---- Validation: 
scalar performance:
{'acc': 0.9775969, 'precision': 0.91883314, 'recall': 0.7056308, 'specificity': 0.7056308, 'f1': 0.7733721, 'auroc': 0.9762664, 'binary_precision': 0.85806453, 'binary_recall': 0.41368586, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.55823714}
confusion matrix:
       0    1
0  18105   44
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.86959076, 'recall': 0.6210213, 'specificity': 0.6210213, 'f1': 0.6771737, 'auroc': 0.95770234, 'binary_precision': 0.7710843, 'binary_recall': 0.24521072, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.372093}
confusion matrix:
      0   1
0  5978  19
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_12.png
early stop counter: 1
val acc:0.9775968790054321, best validation acc: 0.9824393391609192, corresponding to test acc:                         0.960210919380188 / 0.9806647300720215
after epoch: 12,now: 2024-06-09 05:25:22.940492,epoch time: 0:28:19.479143,used: 5:44:04.918870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98200583, 'precision': 0.8527211, 'recall': 0.8831522, 'specificity': 0.8831522, 'f1': 0.86724937, 'auroc': 0.9844425, 'binary_precision': 0.71321696, 'binary_recall': 0.77717394, 'binary_specificity': 0.98913044, 'binary_f1_score': 0.7438232}
confusion matrix:
       0     1
0  41860   460
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.85931075, 'recall': 0.8652361, 'specificity': 0.8652361, 'f1': 0.862247, 'auroc': 0.9788699, 'binary_precision': 0.72782874, 'binary_recall': 0.7402799, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.7340016}
confusion matrix:
       0    1
0  17971  178
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.82323104, 'recall': 0.67440903, 'specificity': 0.67440903, 'f1': 0.7242935, 'auroc': 0.954954, 'binary_precision': 0.67391306, 'binary_recall': 0.35632184, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.46616542}
confusion matrix:
      0   1
0  5952  45
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_13.png
early stop counter: 2
val acc:0.9816411137580872, best validation acc: 0.9824393391609192, corresponding to test acc:                         0.960210919380188 / 0.9806647300720215
after epoch: 13,now: 2024-06-09 05:54:18.938511,epoch time: 0:28:55.998019,used: 6:13:00.916889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9815263, 'precision': 0.9059017, 'recall': 0.782907, 'specificity': 0.782907, 'f1': 0.83260083, 'auroc': 0.98568153, 'binary_precision': 0.82660097, 'binary_recall': 0.5699728, 'binary_specificity': 0.9958412, 'binary_f1_score': 0.6747085}
confusion matrix:
       0    1
0  42144  176
1    633  839
---- Validation: 
scalar performance:
{'acc': 0.9792465, 'precision': 0.9054847, 'recall': 0.74623775, 'specificity': 0.74623775, 'f1': 0.804977, 'auroc': 0.97590464, 'binary_precision': 0.82857144, 'binary_recall': 0.496112, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.6206226}
confusion matrix:
       0    1
0  18083   66
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.832554, 'recall': 0.6127748, 'specificity': 0.6127748, 'f1': 0.6635837, 'auroc': 0.94533765, 'binary_precision': 0.6976744, 'binary_recall': 0.22988506, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.34582135}
confusion matrix:
      0   1
0  5971  26
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_14.png
early stop counter: 3
val acc:0.9792464971542358, best validation acc: 0.9824393391609192, corresponding to test acc:                         0.960210919380188 / 0.9806647300720215
after epoch: 14,now: 2024-06-09 06:22:30.735995,epoch time: 0:28:11.797484,used: 6:41:12.714373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9811381, 'precision': 0.93929553, 'recall': 0.7472974, 'specificity': 0.7472974, 'f1': 0.814651, 'auroc': 0.983685, 'binary_precision': 0.8958333, 'binary_recall': 0.49660325, 'binary_specificity': 0.9979915, 'binary_f1_score': 0.63898605}
confusion matrix:
       0    1
0  42235   85
1    741  731
---- Validation: 
scalar performance:
{'acc': 0.9786611, 'precision': 0.9456461, 'recall': 0.70768183, 'specificity': 0.70768183, 'f1': 0.7805481, 'auroc': 0.9809556, 'binary_precision': 0.91156465, 'binary_recall': 0.41679627, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.5720385}
confusion matrix:
       0    1
0  18123   26
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.96002406, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_15.png
early stop counter: 4
val acc:0.9786611199378967, best validation acc: 0.9824393391609192, corresponding to test acc:                         0.960210919380188 / 0.9806647300720215
after epoch: 15,now: 2024-06-09 06:50:46.499747,epoch time: 0:28:15.763752,used: 7:09:28.478125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98408383, 'precision': 0.8735509, 'recall': 0.88553876, 'specificity': 0.88553876, 'f1': 0.8794418, 'auroc': 0.9872214, 'binary_precision': 0.7547666, 'binary_recall': 0.7798913, 'binary_specificity': 0.9911862, 'binary_f1_score': 0.7671233}
confusion matrix:
       0     1
0  41947   373
1    324  1148
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.8742722, 'recall': 0.8613419, 'specificity': 0.8613419, 'f1': 0.8676834, 'auroc': 0.9820397, 'binary_precision': 0.7580645, 'binary_recall': 0.7309487, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.74425966}
confusion matrix:
       0    1
0  17999  150
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8144188, 'recall': 0.6273501, 'specificity': 0.6273501, 'f1': 0.67743194, 'auroc': 0.95603293, 'binary_precision': 0.66019416, 'binary_recall': 0.2605364, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.37362635}
confusion matrix:
      0   1
0  5962  35
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 07:19:03.877336,epoch time: 0:28:17.377589,used: 7:37:45.855714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98497444, 'precision': 0.9402976, 'recall': 0.81230587, 'specificity': 0.81230587, 'f1': 0.8646383, 'auroc': 0.9867308, 'binary_precision': 0.89341086, 'binary_recall': 0.62721086, 'binary_specificity': 0.9974009, 'binary_f1_score': 0.7370103}
confusion matrix:
       0    1
0  42212  110
1    548  922
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.94094497, 'recall': 0.79969335, 'specificity': 0.79969335, 'f1': 0.8558777, 'auroc': 0.9809213, 'binary_precision': 0.8958333, 'binary_recall': 0.60186625, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.71999997}
confusion matrix:
       0    1
0  18104   45
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.762836, 'recall': 0.5407282, 'specificity': 0.5407282, 'f1': 0.5628553, 'auroc': 0.9304863, 'binary_precision': 0.5641026, 'binary_recall': 0.08429119, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.14666668}
confusion matrix:
      0   1
0  5980  17
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_17.png
better model found
persisted
after epoch: 17,now: 2024-06-09 07:47:13.839677,epoch time: 0:28:09.962341,used: 8:05:55.818055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9823712, 'precision': 0.87789917, 'recall': 0.8380966, 'specificity': 0.8380966, 'f1': 0.85679865, 'auroc': 0.98285985, 'binary_precision': 0.7667683, 'binary_recall': 0.68342394, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.72270113}
confusion matrix:
       0     1
0  42014   306
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.89540124, 'recall': 0.8291446, 'specificity': 0.8291446, 'f1': 0.858996, 'auroc': 0.98040843, 'binary_precision': 0.80263156, 'binary_recall': 0.66407466, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7268085}
confusion matrix:
       0    1
0  18044  105
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.81894946, 'recall': 0.614357, 'specificity': 0.614357, 'f1': 0.6638413, 'auroc': 0.96202, 'binary_precision': 0.6703297, 'binary_recall': 0.23371647, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34659088}
confusion matrix:
      0   1
0  5967  30
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_18.png
early stop counter: 1
val acc:0.9829182624816895, best validation acc: 0.9839825630187988, corresponding to test acc:                         0.959092378616333 / 0.9806647300720215
after epoch: 18,now: 2024-06-09 08:15:51.602190,epoch time: 0:28:37.762513,used: 8:34:33.580568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97709626, 'precision': 0.8046717, 'recall': 0.9183158, 'specificity': 0.9183158, 'f1': 0.85160315, 'auroc': 0.9843435, 'binary_precision': 0.61444604, 'binary_recall': 0.85529894, 'binary_specificity': 0.9813327, 'binary_f1_score': 0.7151378}
confusion matrix:
       0     1
0  41530   790
1    213  1259
---- Validation: 
scalar performance:
{'acc': 0.9743508, 'precision': 0.79084873, 'recall': 0.9102154, 'specificity': 0.9102154, 'f1': 0.8392172, 'auroc': 0.97293663, 'binary_precision': 0.58740497, 'binary_recall': 0.84136856, 'binary_specificity': 0.9790622, 'binary_f1_score': 0.69181585}
confusion matrix:
       0    1
0  17769  380
1    102  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.82925034, 'recall': 0.7139719, 'specificity': 0.7139719, 'f1': 0.75808245, 'auroc': 0.94903123, 'binary_precision': 0.6826347, 'binary_recall': 0.43678162, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.53271025}
confusion matrix:
      0    1
0  5944   53
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_19.png
early stop counter: 2
val acc:0.9743508100509644, best validation acc: 0.9839825630187988, corresponding to test acc:                         0.959092378616333 / 0.9806647300720215
after epoch: 19,now: 2024-06-09 08:44:01.936597,epoch time: 0:28:10.334407,used: 9:02:43.914975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9847461, 'precision': 0.87728596, 'recall': 0.8930943, 'specificity': 0.8930943, 'f1': 0.88501364, 'auroc': 0.98899597, 'binary_precision': 0.76171875, 'binary_recall': 0.79483694, 'binary_specificity': 0.9913516, 'binary_f1_score': 0.77792555}
confusion matrix:
       0     1
0  41954   366
1    302  1170
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.8940285, 'recall': 0.8821932, 'specificity': 0.8821932, 'f1': 0.8880129, 'auroc': 0.98090035, 'binary_precision': 0.79614764, 'binary_recall': 0.7713841, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.78357023}
confusion matrix:
       0    1
0  18022  127
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7810775, 'recall': 0.61710453, 'specificity': 0.61710453, 'f1': 0.66174364, 'auroc': 0.9549171, 'binary_precision': 0.5943396, 'binary_recall': 0.2413793, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.34332424}
confusion matrix:
      0   1
0  5954  43
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 09:12:15.095289,epoch time: 0:28:13.158692,used: 9:30:57.073667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9852256, 'precision': 0.8979267, 'recall': 0.8667858, 'specificity': 0.8667858, 'f1': 0.88167, 'auroc': 0.9897556, 'binary_precision': 0.80487806, 'binary_recall': 0.7398098, 'binary_specificity': 0.99376184, 'binary_f1_score': 0.77097344}
confusion matrix:
       0     1
0  42056   264
1    383  1089
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.9075116, 'recall': 0.8218645, 'specificity': 0.8218645, 'f1': 0.859262, 'auroc': 0.9805473, 'binary_precision': 0.82738096, 'binary_recall': 0.64852256, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7271142}
confusion matrix:
       0    1
0  18062   87
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7923039, 'recall': 0.6341792, 'specificity': 0.6341792, 'f1': 0.68083704, 'auroc': 0.9564361, 'binary_precision': 0.61538464, 'binary_recall': 0.27586207, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.38095242}
confusion matrix:
      0   1
0  5952  45
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_21.png
early stop counter: 1
val acc:0.9833439588546753, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 21,now: 2024-06-09 09:40:21.501327,epoch time: 0:28:06.406038,used: 9:59:03.479705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9852256, 'precision': 0.9016596, 'recall': 0.8612122, 'specificity': 0.8612122, 'f1': 0.88027656, 'auroc': 0.9878863, 'binary_precision': 0.8127369, 'binary_recall': 0.7282609, 'binary_specificity': 0.9941635, 'binary_f1_score': 0.76818347}
confusion matrix:
       0     1
0  42073   247
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.91758144, 'recall': 0.8329989, 'specificity': 0.8329989, 'f1': 0.87015194, 'auroc': 0.9780373, 'binary_precision': 0.84675837, 'binary_recall': 0.6702955, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7482639}
confusion matrix:
       0    1
0  18071   78
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.82042676, 'recall': 0.53190005, 'specificity': 0.53190005, 'f1': 0.549138, 'auroc': 0.9466865, 'binary_precision': 0.68, 'binary_recall': 0.0651341, 'binary_specificity': 0.998666, 'binary_f1_score': 0.118881114}
confusion matrix:
      0   1
0  5989   8
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_22.png
early stop counter: 2
val acc:0.9845678806304932, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 22,now: 2024-06-09 10:08:18.228994,epoch time: 0:27:56.727667,used: 10:27:00.207372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98317045, 'precision': 0.8854853, 'recall': 0.8431002, 'specificity': 0.8431002, 'f1': 0.8629577, 'auroc': 0.9880389, 'binary_precision': 0.7816092, 'binary_recall': 0.6929348, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.73460567}
confusion matrix:
       0     1
0  42035   285
1    452  1020
---- Validation: 
scalar performance:
{'acc': 0.9798318, 'precision': 0.8724103, 'recall': 0.7975445, 'specificity': 0.7975445, 'f1': 0.8304445, 'auroc': 0.9738869, 'binary_precision': 0.7588235, 'binary_recall': 0.60186625, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.67129225}
confusion matrix:
       0    1
0  18026  123
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.81861186, 'recall': 0.5993648, 'specificity': 0.5993648, 'f1': 0.6462733, 'auroc': 0.94950736, 'binary_precision': 0.6708861, 'binary_recall': 0.20306513, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.31176472}
confusion matrix:
      0   1
0  5971  26
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_23.png
early stop counter: 3
val acc:0.9798318147659302, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 23,now: 2024-06-09 10:37:14.944156,epoch time: 0:28:56.715162,used: 10:55:56.922534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98467755, 'precision': 0.86085856, 'recall': 0.9310905, 'specificity': 0.9310905, 'f1': 0.89256847, 'auroc': 0.98917943, 'binary_precision': 0.7261434, 'binary_recall': 0.8736413, 'binary_specificity': 0.9885397, 'binary_f1_score': 0.7930928}
confusion matrix:
       0     1
0  41835   485
1    186  1286
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.8622854, 'recall': 0.9190073, 'specificity': 0.9190073, 'f1': 0.88839275, 'auroc': 0.9743724, 'binary_precision': 0.72994655, 'binary_recall': 0.84914464, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.78504676}
confusion matrix:
       0    1
0  17947  202
1     97  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.94513744, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_24.png
early stop counter: 4
val acc:0.9840889573097229, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 24,now: 2024-06-09 11:05:54.121869,epoch time: 0:28:39.177713,used: 11:24:36.100247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9870296, 'precision': 0.9186695, 'recall': 0.8728802, 'specificity': 0.8728802, 'f1': 0.8943458, 'auroc': 0.99028707, 'binary_precision': 0.845977, 'binary_recall': 0.75050986, 'binary_specificity': 0.9952506, 'binary_f1_score': 0.7953891}
confusion matrix:
       0     1
0  42120   201
1    367  1104
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.8954812, 'recall': 0.8376156, 'specificity': 0.8376156, 'f1': 0.86407673, 'auroc': 0.97682285, 'binary_precision': 0.8021978, 'binary_recall': 0.68118197, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.7367536}
confusion matrix:
       0    1
0  18041  108
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7811426, 'recall': 0.6634965, 'specificity': 0.6634965, 'f1': 0.7049695, 'auroc': 0.934196, 'binary_precision': 0.590604, 'binary_recall': 0.33716476, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.4292683}
confusion matrix:
      0   1
0  5936  61
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_25.png
early stop counter: 5
val acc:0.9833439588546753, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 25,now: 2024-06-09 11:34:32.976348,epoch time: 0:28:38.854479,used: 11:53:14.954726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98620754, 'precision': 0.9384843, 'recall': 0.83581936, 'specificity': 0.83581936, 'f1': 0.8798444, 'auroc': 0.98822784, 'binary_precision': 0.8881932, 'binary_recall': 0.6745924, 'binary_specificity': 0.9970463, 'binary_f1_score': 0.76679534}
confusion matrix:
       0    1
0  42195  125
1    479  993
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.94327044, 'recall': 0.8067194, 'specificity': 0.8067194, 'f1': 0.8616648, 'auroc': 0.97752273, 'binary_precision': 0.9, 'binary_recall': 0.61586314, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.7313019}
confusion matrix:
       0    1
0  18105   44
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.88837564, 'recall': 0.5739623, 'specificity': 0.5739623, 'f1': 0.61675185, 'auroc': 0.93796384, 'binary_precision': 0.8125, 'binary_recall': 0.14942528, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2524272}
confusion matrix:
      0   1
0  5988   9
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_26.png
early stop counter: 6
val acc:0.9845147132873535, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 26,now: 2024-06-09 12:02:59.830746,epoch time: 0:28:26.854398,used: 12:21:41.809124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9880572, 'precision': 0.9285457, 'recall': 0.87972593, 'specificity': 0.87972593, 'f1': 0.9025465, 'auroc': 0.99216413, 'binary_precision': 0.865281, 'binary_recall': 0.76358694, 'binary_specificity': 0.99586487, 'binary_f1_score': 0.8112595}
confusion matrix:
       0     1
0  42145   175
1    348  1124
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.9182174, 'recall': 0.8430526, 'specificity': 0.8430526, 'f1': 0.8766321, 'auroc': 0.98291177, 'binary_precision': 0.84732825, 'binary_recall': 0.6905132, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7609255}
confusion matrix:
       0    1
0  18069   80
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8287982, 'recall': 0.60894334, 'specificity': 0.60894334, 'f1': 0.65870833, 'auroc': 0.9587364, 'binary_precision': 0.6904762, 'binary_recall': 0.22222222, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.3362319}
confusion matrix:
      0   1
0  5971  26
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_27.png
early stop counter: 7
val acc:0.9851532578468323, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 27,now: 2024-06-09 12:32:14.310726,epoch time: 0:29:14.479980,used: 12:50:56.289104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98780596, 'precision': 0.9369923, 'recall': 0.865498, 'specificity': 0.865498, 'f1': 0.8978191, 'auroc': 0.99204254, 'binary_precision': 0.88316995, 'binary_recall': 0.734375, 'binary_specificity': 0.996621, 'binary_f1_score': 0.8019288}
confusion matrix:
       0     1
0  42177   143
1    391  1081
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.928605, 'recall': 0.8287189, 'specificity': 0.8287189, 'f1': 0.8715736, 'auroc': 0.9833746, 'binary_precision': 0.86912066, 'binary_recall': 0.66096425, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.75088346}
confusion matrix:
       0    1
0  18085   64
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8254826, 'recall': 0.5375638, 'specificity': 0.5375638, 'f1': 0.5587414, 'auroc': 0.9512347, 'binary_precision': 0.6896552, 'binary_recall': 0.07662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5988   9
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_28.png
early stop counter: 8
val acc:0.9849936366081238, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 28,now: 2024-06-09 13:02:26.241320,epoch time: 0:30:11.930594,used: 13:21:08.219698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9886281, 'precision': 0.95004463, 'recall': 0.86625123, 'specificity': 0.86625123, 'f1': 0.90352917, 'auroc': 0.99392045, 'binary_precision': 0.9092437, 'binary_recall': 0.7350544, 'binary_specificity': 0.997448, 'binary_f1_score': 0.8129226}
confusion matrix:
       0     1
0  42212   108
1    390  1082
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9314976, 'recall': 0.8118045, 'specificity': 0.8118045, 'f1': 0.86129653, 'auroc': 0.9812895, 'binary_precision': 0.87608695, 'binary_recall': 0.62674963, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.73073435}
confusion matrix:
       0    1
0  18092   57
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79867697, 'recall': 0.57096267, 'specificity': 0.57096267, 'f1': 0.60833496, 'auroc': 0.94543564, 'binary_precision': 0.6333333, 'binary_recall': 0.14559387, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.23676012}
confusion matrix:
      0   1
0  5975  22
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_29.png
early stop counter: 9
val acc:0.9841954112052917, best validation acc: 0.9854193329811096, corresponding to test acc:                         0.9614893198013306 / 0.9806647300720215
after epoch: 29,now: 2024-06-09 13:31:00.074964,epoch time: 0:28:33.833644,used: 13:49:42.053342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.9183355, 'recall': 0.925189, 'specificity': 0.925189, 'f1': 0.9217321, 'auroc': 0.9933758, 'binary_precision': 0.8416834, 'binary_recall': 0.85597825, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.8487706}
confusion matrix:
       0     1
0  42083   237
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.90184927, 'recall': 0.88252383, 'specificity': 0.88252383, 'f1': 0.8919285, 'auroc': 0.98034656, 'binary_precision': 0.81178397, 'binary_recall': 0.7713841, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7910686}
confusion matrix:
       0    1
0  18034  115
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8114029, 'recall': 0.61044216, 'specificity': 0.61044216, 'f1': 0.6585145, 'auroc': 0.950562, 'binary_precision': 0.65555555, 'binary_recall': 0.22605364, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.33618233}
confusion matrix:
      0   1
0  5966  31
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261151_30.png
better model found
persisted
after epoch: 30,now: 2024-06-09 13:59:16.424328,epoch time: 0:28:16.349364,used: 14:17:58.402706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_41_17_seed_0_21261151
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:17:58.402706 at 2024-06-09 13:59:16.424328
persisted model performance metric: 

scalar performance:
{'acc': 0.96292746, 'precision': 0.8150885, 'recall': 0.61052555, 'specificity': 0.61052555, 'f1': 0.6590367, 'auroc': 0.9580133, 'binary_precision': 0.66292137, 'binary_recall': 0.22605364, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.33714285}
confusion matrix:
      0   1
0  5967  30
1   202  59
oracle model performance metric: 

scalar performance:
{'acc': 0.97810805, 'precision': 0.8847515, 'recall': 0.8236676, 'specificity': 0.8236676, 'f1': 0.851303, 'auroc': 0.9562907, 'binary_precision': 0.7844037, 'binary_recall': 0.6551724, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.71398747}
confusion matrix:
      0    1
0  5950   47
1    90  171
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new_new/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14474 MiB |  14474 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473243 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197600 K  |  197596 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94969 K  |   94966 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197600 K  |  197596 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94969 K  |   94966 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    2804    |  132703 K  |  132703 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      42    |    2764    |   48877 K  |   48876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14474 MiB |  14474 MiB |  13566 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94969 K  |   94969 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94969 K  |   94969 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |     636    |     572    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  132705 K  |  132705 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2764    |   48878 K  |   48878 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun  9 14:02:04 2024]
Finished job 0.
1 of 1 steps (100%) done
