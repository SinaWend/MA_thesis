Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun  2 12:35:55 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737

 Experiment start at: 2024-06-02 12:44:56.399369
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9702914, 'precision': 0.7878009, 'recall': 0.67349064, 'specificity': 0.67349064, 'f1': 0.715206, 'auroc': 0.9624791, 'binary_precision': 0.5977143, 'binary_recall': 0.3552989, 'binary_specificity': 0.9916824, 'binary_f1_score': 0.44567534}
confusion matrix:
       0    1
0  41968  352
1    949  523
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.81617403, 'recall': 0.6404345, 'specificity': 0.6404345, 'f1': 0.69178057, 'auroc': 0.964819, 'binary_precision': 0.6571429, 'binary_recall': 0.28615862, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.39869988}
confusion matrix:
       0    1
0  18053   96
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.882311, 'recall': 0.679908, 'specificity': 0.679908, 'f1': 0.74147403, 'auroc': 0.95128953, 'binary_precision': 0.7916667, 'binary_recall': 0.36398467, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.49868768}
confusion matrix:
      0   1
0  5972  25
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 13:11:41.980453,epoch time: 0:26:45.581084,used: 0:26:45.581084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97396785, 'precision': 0.7894695, 'recall': 0.8694855, 'specificity': 0.8694855, 'f1': 0.82409203, 'auroc': 0.97452295, 'binary_precision': 0.58746046, 'binary_recall': 0.7574728, 'binary_specificity': 0.9814981, 'binary_f1_score': 0.66172105}
confusion matrix:
       0     1
0  41537   783
1    357  1115
---- Validation: 
scalar performance:
{'acc': 0.97573435, 'precision': 0.810074, 'recall': 0.8434267, 'specificity': 0.8434267, 'f1': 0.82581216, 'auroc': 0.97319245, 'binary_precision': 0.63076925, 'binary_recall': 0.7013997, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.66421205}
confusion matrix:
       0    1
0  17885  264
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.8699659, 'recall': 0.7946818, 'specificity': 0.7946818, 'f1': 0.8276151, 'auroc': 0.9582933, 'binary_precision': 0.75728154, 'binary_recall': 0.59770113, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6680943}
confusion matrix:
      0    1
0  5947   50
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 13:37:05.313058,epoch time: 0:25:23.332605,used: 0:52:08.913689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97531515, 'precision': 0.9008185, 'recall': 0.6675656, 'specificity': 0.6675656, 'f1': 0.73319715, 'auroc': 0.9793588, 'binary_precision': 0.82421225, 'binary_recall': 0.33763587, 'binary_specificity': 0.9974953, 'binary_f1_score': 0.47903618}
confusion matrix:
       0    1
0  42214  106
1    975  497
---- Validation: 
scalar performance:
{'acc': 0.9739783, 'precision': 0.9111725, 'recall': 0.64525306, 'specificity': 0.64525306, 'f1': 0.7106824, 'auroc': 0.97786325, 'binary_precision': 0.8468468, 'binary_recall': 0.29237947, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.43468207}
confusion matrix:
       0    1
0  18115   34
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7651576, 'recall': 0.50741273, 'specificity': 0.50741273, 'f1': 0.5043114, 'auroc': 0.9486485, 'binary_precision': 0.5714286, 'binary_recall': 0.01532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5994  3
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_3.png
early stop counter: 1
val acc:0.9739782810211182, best validation acc: 0.9757343530654907, corresponding to test acc:                         0.9752317070960999 / 0.9752317070960999
after epoch: 3,now: 2024-06-02 14:02:30.183932,epoch time: 0:25:24.870874,used: 1:17:33.784563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9829421, 'precision': 0.88282454, 'recall': 0.8422216, 'specificity': 0.8422216, 'f1': 0.8612914, 'auroc': 0.98653793, 'binary_precision': 0.7763359, 'binary_recall': 0.69136643, 'binary_specificity': 0.99307674, 'binary_f1_score': 0.73139155}
confusion matrix:
       0     1
0  42028   293
1    454  1017
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.8847919, 'recall': 0.8056787, 'specificity': 0.8056787, 'f1': 0.8403318, 'auroc': 0.9777088, 'binary_precision': 0.7830375, 'binary_recall': 0.61741835, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.69043475}
confusion matrix:
       0    1
0  18039  110
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8938107, 'recall': 0.6043635, 'specificity': 0.6043635, 'f1': 0.6587397, 'auroc': 0.9531257, 'binary_precision': 0.8208955, 'binary_recall': 0.21072797, 'binary_specificity': 0.997999, 'binary_f1_score': 0.33536586}
confusion matrix:
      0   1
0  5985  12
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 14:27:49.433551,epoch time: 0:25:19.249619,used: 1:42:53.034182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9791514, 'precision': 0.95142925, 'recall': 0.7065985, 'specificity': 0.7065985, 'f1': 0.78063995, 'auroc': 0.9894141, 'binary_precision': 0.9228442, 'binary_recall': 0.4144022, 'binary_specificity': 0.9987949, 'binary_f1_score': 0.5719644}
confusion matrix:
       0    1
0  42269   51
1    862  610
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.953598, 'recall': 0.691545, 'specificity': 0.691545, 'f1': 0.7660694, 'auroc': 0.9776703, 'binary_precision': 0.9285714, 'binary_recall': 0.38413686, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.54345435}
confusion matrix:
       0    1
0  18130   19
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7800417, 'recall': 0.5223215, 'specificity': 0.5223215, 'f1': 0.53220195, 'auroc': 0.9523814, 'binary_precision': 0.6, 'binary_recall': 0.04597701, 'binary_specificity': 0.998666, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5989   8
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_5.png
early stop counter: 1
val acc:0.9779161214828491, best validation acc: 0.9810557961463928, corresponding to test acc:                         0.9651646018028259 / 0.9752317070960999
after epoch: 5,now: 2024-06-02 14:53:11.764678,epoch time: 0:25:22.331127,used: 2:08:15.365309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.9160627, 'recall': 0.85457265, 'specificity': 0.85457265, 'f1': 0.8826724, 'auroc': 0.99086016, 'binary_precision': 0.84202087, 'binary_recall': 0.71380013, 'binary_specificity': 0.9953451, 'binary_f1_score': 0.77262694}
confusion matrix:
       0     1
0  42124   197
1    421  1050
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.9255446, 'recall': 0.7892264, 'specificity': 0.7892264, 'f1': 0.8434286, 'auroc': 0.97974396, 'binary_precision': 0.8657407, 'binary_recall': 0.5816485, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.6958139}
confusion matrix:
       0    1
0  18091   58
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.94045025, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 15:18:33.718532,epoch time: 0:25:21.953854,used: 2:33:37.319163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98659575, 'precision': 0.93097544, 'recall': 0.850446, 'specificity': 0.850446, 'f1': 0.8862471, 'auroc': 0.9918845, 'binary_precision': 0.8721615, 'binary_recall': 0.7044837, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.7794063}
confusion matrix:
       0     1
0  42168   152
1    435  1037
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.9192699, 'recall': 0.8106687, 'specificity': 0.8106687, 'f1': 0.85627425, 'auroc': 0.9828031, 'binary_precision': 0.85169494, 'binary_recall': 0.62519443, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.72107625}
confusion matrix:
       0    1
0  18079   70
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8337661, 'recall': 0.5583031, 'specificity': 0.5583031, 'f1': 0.5916893, 'auroc': 0.96249336, 'binary_precision': 0.70454544, 'binary_recall': 0.118773945, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20327869}
confusion matrix:
      0   1
0  5984  13
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_7.png
better model found
persisted
after epoch: 7,now: 2024-06-02 15:43:58.290047,epoch time: 0:25:24.571515,used: 2:59:01.890678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9818917, 'precision': 0.83253276, 'recall': 0.9506321, 'specificity': 0.9506321, 'f1': 0.88177216, 'auroc': 0.9918641, 'binary_precision': 0.66798615, 'binary_recall': 0.91711956, 'binary_specificity': 0.9841446, 'binary_f1_score': 0.77297455}
confusion matrix:
       0     1
0  41649   671
1    122  1350
---- Validation: 
scalar performance:
{'acc': 0.9796722, 'precision': 0.8244029, 'recall': 0.92347115, 'specificity': 0.92347115, 'f1': 0.8666918, 'auroc': 0.98222655, 'binary_precision': 0.65371025, 'binary_recall': 0.86314154, 'binary_specificity': 0.98380077, 'binary_f1_score': 0.74396783}
confusion matrix:
       0    1
0  17855  294
1     88  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.78178525, 'recall': 0.64125836, 'specificity': 0.64125836, 'f1': 0.6856012, 'auroc': 0.95851755, 'binary_precision': 0.59375, 'binary_recall': 0.29118773, 'binary_specificity': 0.991329, 'binary_f1_score': 0.3907455}
confusion matrix:
      0   1
0  5945  52
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_8.png
early stop counter: 1
val acc:0.9796721935272217, best validation acc: 0.9834504127502441, corresponding to test acc:                         0.9611697196960449 / 0.9752317070960999
after epoch: 8,now: 2024-06-02 16:09:19.321378,epoch time: 0:25:21.031331,used: 3:24:22.922009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.9099115, 'recall': 0.895607, 'specificity': 0.895607, 'f1': 0.90262187, 'auroc': 0.99448836, 'binary_precision': 0.8268551, 'binary_recall': 0.79700273, 'binary_specificity': 0.9942113, 'binary_f1_score': 0.81165457}
confusion matrix:
       0     1
0  42079   245
1    298  1170
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.91571414, 'recall': 0.85299623, 'specificity': 0.85299623, 'f1': 0.8815924, 'auroc': 0.9848218, 'binary_precision': 0.8416206, 'binary_recall': 0.71073097, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7706577}
confusion matrix:
       0    1
0  18063   86
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8460576, 'recall': 0.5508904, 'specificity': 0.5508904, 'f1': 0.58061874, 'auroc': 0.9542685, 'binary_precision': 0.7297297, 'binary_recall': 0.10344828, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18120806}
confusion matrix:
      0   1
0  5987  10
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 16:34:36.906766,epoch time: 0:25:17.585388,used: 3:49:40.507397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9896328, 'precision': 0.94064975, 'recall': 0.8936555, 'specificity': 0.8936555, 'f1': 0.91572714, 'auroc': 0.99552584, 'binary_precision': 0.8885496, 'binary_recall': 0.7907609, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.836808}
confusion matrix:
       0     1
0  42174   146
1    308  1164
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.93185574, 'recall': 0.8226358, 'specificity': 0.8226358, 'f1': 0.8687463, 'auroc': 0.9830791, 'binary_precision': 0.8760504, 'binary_recall': 0.64852256, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.74530834}
confusion matrix:
       0    1
0  18090   59
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.77185595, 'recall': 0.5259862, 'specificity': 0.5259862, 'f1': 0.53861666, 'auroc': 0.958719, 'binary_precision': 0.5833333, 'binary_recall': 0.053639848, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09824561}
confusion matrix:
      0   1
0  5987  10
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_10.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 10,now: 2024-06-02 16:59:57.042631,epoch time: 0:25:20.135865,used: 4:15:00.643262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9909801, 'precision': 0.9570583, 'recall': 0.8989426, 'specificity': 0.8989426, 'f1': 0.92587984, 'auroc': 0.99630785, 'binary_precision': 0.9210321, 'binary_recall': 0.80027175, 'binary_specificity': 0.99761343, 'binary_f1_score': 0.8564158}
confusion matrix:
       0     1
0  42219   101
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.9136413, 'recall': 0.80586535, 'specificity': 0.80586535, 'f1': 0.8510612, 'auroc': 0.9837734, 'binary_precision': 0.84076434, 'binary_recall': 0.61586314, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.71095157}
confusion matrix:
       0    1
0  18074   75
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8452725, 'recall': 0.5942013, 'specificity': 0.5942013, 'f1': 0.6420781, 'auroc': 0.9521974, 'binary_precision': 0.7246377, 'binary_recall': 0.19157088, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30303028}
confusion matrix:
      0   1
0  5978  19
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_11.png
early stop counter: 2
val acc:0.982865035533905, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 11,now: 2024-06-02 17:25:12.108593,epoch time: 0:25:15.065962,used: 4:40:15.709224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902037, 'precision': 0.9520739, 'recall': 0.89100015, 'specificity': 0.89100015, 'f1': 0.9191586, 'auroc': 0.9966501, 'binary_precision': 0.9116022, 'binary_recall': 0.78464675, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.8433735}
confusion matrix:
       0     1
0  42208   112
1    317  1155
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.92299485, 'recall': 0.8269984, 'specificity': 0.8269984, 'f1': 0.86838084, 'auroc': 0.9815032, 'binary_precision': 0.8580122, 'binary_recall': 0.6578538, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.74471825}
confusion matrix:
       0    1
0  18079   70
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8171095, 'recall': 0.64800596, 'specificity': 0.64800596, 'f1': 0.6987484, 'auroc': 0.94835204, 'binary_precision': 0.66386557, 'binary_recall': 0.30268198, 'binary_specificity': 0.99333, 'binary_f1_score': 0.41578948}
confusion matrix:
      0   1
0  5957  40
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_12.png
early stop counter: 3
val acc:0.9845678806304932, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 12,now: 2024-06-02 17:50:28.769100,epoch time: 0:25:16.660507,used: 5:05:32.369731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9896785, 'precision': 0.9237591, 'recall': 0.91597354, 'specificity': 0.91597354, 'f1': 0.9198273, 'auroc': 0.996324, 'binary_precision': 0.8531856, 'binary_recall': 0.8369565, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.84499305}
confusion matrix:
       0     1
0  42108   212
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.8994597, 'recall': 0.821589, 'specificity': 0.821589, 'f1': 0.85598135, 'auroc': 0.9806676, 'binary_precision': 0.81128407, 'binary_recall': 0.64852256, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7208297}
confusion matrix:
       0    1
0  18052   97
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.80322945, 'recall': 0.537397, 'specificity': 0.537397, 'f1': 0.5581855, 'auroc': 0.94783103, 'binary_precision': 0.6451613, 'binary_recall': 0.07662835, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1369863}
confusion matrix:
      0   1
0  5986  11
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_13.png
early stop counter: 4
val acc:0.9828118085861206, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 13,now: 2024-06-02 18:15:49.141711,epoch time: 0:25:20.372611,used: 5:30:52.742342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9888336, 'precision': 0.94692373, 'recall': 0.8729147, 'specificity': 0.8729147, 'f1': 0.90632886, 'auroc': 0.9965589, 'binary_precision': 0.9025389, 'binary_recall': 0.7486413, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.8184181}
confusion matrix:
       0     1
0  42201   119
1    370  1102
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.91908413, 'recall': 0.7674259, 'specificity': 0.7674259, 'f1': 0.8252808, 'auroc': 0.9786955, 'binary_precision': 0.854321, 'binary_recall': 0.5381026, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.6603053}
confusion matrix:
       0    1
0  18090   59
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8808496, 'recall': 0.6098605, 'specificity': 0.6098605, 'f1': 0.66470504, 'auroc': 0.9478898, 'binary_precision': 0.79452056, 'binary_recall': 0.22222222, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34730536}
confusion matrix:
      0   1
0  5982  15
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_14.png
early stop counter: 5
val acc:0.9810557961463928, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 14,now: 2024-06-02 18:41:05.692198,epoch time: 0:25:16.550487,used: 5:56:09.292829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9907746, 'precision': 0.95169187, 'recall': 0.9011313, 'specificity': 0.9011313, 'f1': 0.9247992, 'auroc': 0.99625766, 'binary_precision': 0.91013825, 'binary_recall': 0.8050272, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.85436195}
confusion matrix:
       0     1
0  42203   117
1    287  1185
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.93113256, 'recall': 0.79633504, 'specificity': 0.79633504, 'f1': 0.8503287, 'auroc': 0.98187417, 'binary_precision': 0.8764302, 'binary_recall': 0.5956454, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.7092593}
confusion matrix:
       0    1
0  18095   54
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8181227, 'recall': 0.6386776, 'specificity': 0.6386776, 'f1': 0.6897021, 'auroc': 0.94670606, 'binary_precision': 0.6666667, 'binary_recall': 0.2835249, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.39784947}
confusion matrix:
      0   1
0  5960  37
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_15.png
early stop counter: 6
val acc:0.9832907915115356, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9610099196434021 / 0.9752317070960999
after epoch: 15,now: 2024-06-02 19:06:24.198907,epoch time: 0:25:18.506709,used: 6:21:27.799538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9936518, 'precision': 0.9579803, 'recall': 0.94294655, 'specificity': 0.94294655, 'f1': 0.9503283, 'auroc': 0.9973887, 'binary_precision': 0.9198312, 'binary_recall': 0.88858694, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.9039392}
confusion matrix:
       0     1
0  42206   114
1    164  1308
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.921728, 'recall': 0.85938233, 'specificity': 0.85938233, 'f1': 0.88786983, 'auroc': 0.97969186, 'binary_precision': 0.853211, 'binary_recall': 0.7231726, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7828283}
confusion matrix:
       0    1
0  18069   80
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.78367287, 'recall': 0.5372303, 'specificity': 0.5372303, 'f1': 0.5576361, 'auroc': 0.949914, 'binary_precision': 0.6060606, 'binary_recall': 0.07662835, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.13605443}
confusion matrix:
      0   1
0  5984  13
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_16.png
better model found
persisted
after epoch: 16,now: 2024-06-02 19:31:42.769094,epoch time: 0:25:18.570187,used: 6:46:46.369725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9932408, 'precision': 0.95611525, 'recall': 0.93814385, 'specificity': 0.93814385, 'f1': 0.946935, 'auroc': 0.99782574, 'binary_precision': 0.9164306, 'binary_recall': 0.87907606, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.89736474}
confusion matrix:
       0     1
0  42202   118
1    178  1294
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.91858345, 'recall': 0.81527925, 'specificity': 0.81527925, 'f1': 0.85910255, 'auroc': 0.9784349, 'binary_precision': 0.85, 'binary_recall': 0.63452566, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7266251}
confusion matrix:
       0    1
0  18077   72
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.792966, 'recall': 0.61185765, 'specificity': 0.61185765, 'f1': 0.65781, 'auroc': 0.93920875, 'binary_precision': 0.6185567, 'binary_recall': 0.22988506, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.33519554}
confusion matrix:
      0   1
0  5960  37
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_17.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9594119787216187 / 0.9752317070960999
after epoch: 17,now: 2024-06-02 19:56:56.948864,epoch time: 0:25:14.179770,used: 7:12:00.549495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99330926, 'precision': 0.9769003, 'recall': 0.9175242, 'specificity': 0.9175242, 'f1': 0.94509697, 'auroc': 0.99822545, 'binary_precision': 0.95947, 'binary_recall': 0.8362772, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.8936479}
confusion matrix:
       0     1
0  42268    52
1    241  1231
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.95937186, 'recall': 0.8086878, 'specificity': 0.8086878, 'f1': 0.8682107, 'auroc': 0.9823452, 'binary_precision': 0.9320843, 'binary_recall': 0.61897355, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.7439252}
confusion matrix:
       0    1
0  18120   29
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8459687, 'recall': 0.5358148, 'specificity': 0.5358148, 'f1': 0.55602133, 'auroc': 0.94215024, 'binary_precision': 0.7307692, 'binary_recall': 0.07279693, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13240418}
confusion matrix:
      0   1
0  5990   7
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_18.png
early stop counter: 2
val acc:0.9854193329811096, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9594119787216187 / 0.9752317070960999
after epoch: 18,now: 2024-06-02 20:22:13.837086,epoch time: 0:25:16.888222,used: 7:37:17.437717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99330926, 'precision': 0.96730167, 'recall': 0.9270321, 'specificity': 0.9270321, 'f1': 0.94619215, 'auroc': 0.9974114, 'binary_precision': 0.9395973, 'binary_recall': 0.85597825, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.8958407}
confusion matrix:
       0     1
0  42239    81
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.93791014, 'recall': 0.8050264, 'specificity': 0.8050264, 'f1': 0.85871685, 'auroc': 0.9785608, 'binary_precision': 0.8893905, 'binary_recall': 0.61275274, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.7255985}
confusion matrix:
       0    1
0  18100   49
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.84152216, 'recall': 0.64492494, 'specificity': 0.64492494, 'f1': 0.6998222, 'auroc': 0.9450755, 'binary_precision': 0.712963, 'binary_recall': 0.29501915, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.41734415}
confusion matrix:
      0   1
0  5966  31
1   184  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_19.png
early stop counter: 3
val acc:0.9841421842575073, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9594119787216187 / 0.9752317070960999
after epoch: 19,now: 2024-06-02 20:47:32.272346,epoch time: 0:25:18.435260,used: 8:02:35.872977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99438256, 'precision': 0.9545924, 'recall': 0.9593632, 'specificity': 0.9593632, 'f1': 0.9569644, 'auroc': 0.9982829, 'binary_precision': 0.91190314, 'binary_recall': 0.9218219, 'binary_specificity': 0.9969046, 'binary_f1_score': 0.9168357}
confusion matrix:
       0     1
0  42190   131
1    115  1356
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.93820584, 'recall': 0.87076473, 'specificity': 0.87076473, 'f1': 0.9014565, 'auroc': 0.9769037, 'binary_precision': 0.88539743, 'binary_recall': 0.7449456, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.80912167}
confusion matrix:
       0    1
0  18087   62
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8690648, 'recall': 0.57754356, 'specificity': 0.57754356, 'f1': 0.6210666, 'auroc': 0.9420353, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5985  12
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_20.png
better model found
persisted
after epoch: 20,now: 2024-06-02 21:12:50.341399,epoch time: 0:25:18.069053,used: 8:27:53.942030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99586684, 'precision': 0.97330725, 'recall': 0.96242785, 'specificity': 0.96242785, 'f1': 0.9677995, 'auroc': 0.99920785, 'binary_precision': 0.94916433, 'binary_recall': 0.92658055, 'binary_specificity': 0.9982751, 'binary_f1_score': 0.9377365}
confusion matrix:
       0     1
0  42248    73
1    108  1363
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.9352126, 'recall': 0.8675716, 'specificity': 0.8675716, 'f1': 0.89832103, 'auroc': 0.98199475, 'binary_precision': 0.8796296, 'binary_recall': 0.7387247, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.80304307}
confusion matrix:
       0    1
0  18084   65
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.83445287, 'recall': 0.5977826, 'specificity': 0.5977826, 'f1': 0.6457419, 'auroc': 0.93655944, 'binary_precision': 0.7027027, 'binary_recall': 0.19923371, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.31044775}
confusion matrix:
      0   1
0  5975  22
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_21.png
early stop counter: 1
val acc:0.987601101398468, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 21,now: 2024-06-02 21:38:10.967953,epoch time: 0:25:20.626554,used: 8:53:14.568584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99502194, 'precision': 0.9662326, 'recall': 0.956442, 'specificity': 0.956442, 'f1': 0.96128136, 'auroc': 0.99876046, 'binary_precision': 0.93541664, 'binary_recall': 0.9150815, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.92513734}
confusion matrix:
       0     1
0  42227    93
1    125  1347
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9285228, 'recall': 0.8325794, 'specificity': 0.8325794, 'f1': 0.87404203, 'auroc': 0.98258555, 'binary_precision': 0.86868685, 'binary_recall': 0.6687403, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.75571173}
confusion matrix:
       0    1
0  18084   65
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8534349, 'recall': 0.6226034, 'specificity': 0.6226034, 'f1': 0.67724663, 'auroc': 0.94647646, 'binary_precision': 0.7386364, 'binary_recall': 0.24904214, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.37249282}
confusion matrix:
      0   1
0  5974  23
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_22.png
early stop counter: 2
val acc:0.9852064847946167, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 22,now: 2024-06-02 22:03:29.215944,epoch time: 0:25:18.247991,used: 9:18:32.816575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99340063, 'precision': 0.96741605, 'recall': 0.9283428, 'specificity': 0.9283428, 'f1': 0.9469632, 'auroc': 0.9974529, 'binary_precision': 0.93973213, 'binary_recall': 0.8585996, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.8973357}
confusion matrix:
       0     1
0  42240    81
1    208  1263
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.93753564, 'recall': 0.82821685, 'specificity': 0.82821685, 'f1': 0.8744902, 'auroc': 0.9772885, 'binary_precision': 0.8870293, 'binary_recall': 0.65940905, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.75646746}
confusion matrix:
       0    1
0  18095   54
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.89168, 'recall': 0.58537316, 'specificity': 0.58537316, 'f1': 0.63314277, 'auroc': 0.9378519, 'binary_precision': 0.8181818, 'binary_recall': 0.1724138, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.28481016}
confusion matrix:
      0   1
0  5987  10
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_23.png
early stop counter: 3
val acc:0.985472559928894, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 23,now: 2024-06-02 22:28:50.028785,epoch time: 0:25:20.812841,used: 9:43:53.629416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99561566, 'precision': 0.9763868, 'recall': 0.9551099, 'specificity': 0.9551099, 'f1': 0.965487, 'auroc': 0.99917245, 'binary_precision': 0.95584047, 'binary_recall': 0.9116848, 'binary_specificity': 0.998535, 'binary_f1_score': 0.9332406}
confusion matrix:
       0     1
0  42258    62
1    130  1342
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9444642, 'recall': 0.8524052, 'specificity': 0.8524052, 'f1': 0.8927167, 'auroc': 0.9806715, 'binary_precision': 0.8992095, 'binary_recall': 0.7076205, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.791993}
confusion matrix:
       0    1
0  18098   51
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.82738936, 'recall': 0.6389277, 'specificity': 0.6389277, 'f1': 0.6914451, 'auroc': 0.95165956, 'binary_precision': 0.6851852, 'binary_recall': 0.2835249, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.40108404}
confusion matrix:
      0   1
0  5963  34
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_24.png
early stop counter: 4
val acc:0.9872817993164062, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 24,now: 2024-06-02 22:54:10.516748,epoch time: 0:25:20.487963,used: 10:09:14.117379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928069, 'precision': 0.97452533, 'recall': 0.9116311, 'specificity': 0.9116311, 'f1': 0.9406829, 'auroc': 0.9983212, 'binary_precision': 0.9551181, 'binary_recall': 0.8246091, 'binary_specificity': 0.9986532, 'binary_f1_score': 0.88507843}
confusion matrix:
       0     1
0  42264    57
1    258  1213
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.93991566, 'recall': 0.82596666, 'specificity': 0.82596666, 'f1': 0.87383556, 'auroc': 0.9767004, 'binary_precision': 0.8919492, 'binary_recall': 0.6547434, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7551569}
confusion matrix:
       0    1
0  18098   51
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9150206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_25.png
early stop counter: 5
val acc:0.985472559928894, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 25,now: 2024-06-02 23:19:27.246134,epoch time: 0:25:16.729386,used: 10:34:30.846765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9954558, 'precision': 0.9803618, 'recall': 0.94847, 'specificity': 0.94847, 'f1': 0.9638276, 'auroc': 0.9992472, 'binary_precision': 0.9642597, 'binary_recall': 0.8980978, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.9300035}
confusion matrix:
       0     1
0  42271    49
1    150  1322
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9374379, 'recall': 0.8568229, 'specificity': 0.8568229, 'f1': 0.8927257, 'auroc': 0.98119485, 'binary_precision': 0.88483685, 'binary_recall': 0.7169518, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7920962}
confusion matrix:
       0    1
0  18089   60
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8065685, 'recall': 0.58603823, 'specificity': 0.58603823, 'f1': 0.6287052, 'auroc': 0.94613844, 'binary_precision': 0.64788735, 'binary_recall': 0.17624521, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.27710846}
confusion matrix:
      0   1
0  5972  25
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_26.png
early stop counter: 6
val acc:0.9871221780776978, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 26,now: 2024-06-02 23:44:44.110646,epoch time: 0:25:16.864512,used: 10:59:47.711277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99454236, 'precision': 0.95386016, 'recall': 0.9630789, 'specificity': 0.9630789, 'f1': 0.95841956, 'auroc': 0.9990375, 'binary_precision': 0.9101796, 'binary_recall': 0.9293478, 'binary_specificity': 0.99681, 'binary_f1_score': 0.91966385}
confusion matrix:
       0     1
0  42185   135
1    104  1368
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9119212, 'recall': 0.86288464, 'specificity': 0.86288464, 'f1': 0.8857253, 'auroc': 0.97978616, 'binary_precision': 0.8333333, 'binary_recall': 0.7309487, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.7787904}
confusion matrix:
       0    1
0  18055   94
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7979914, 'recall': 0.6045283, 'specificity': 0.6045283, 'f1': 0.65021867, 'auroc': 0.93693364, 'binary_precision': 0.6292135, 'binary_recall': 0.21455939, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.32000002}
confusion matrix:
      0   1
0  5964  33
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_27.png
early stop counter: 7
val acc:0.985791802406311, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 27,now: 2024-06-03 00:09:59.747348,epoch time: 0:25:15.636702,used: 11:25:03.347979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9943597, 'precision': 0.9791504, 'recall': 0.9321656, 'specificity': 0.9321656, 'f1': 0.9543574, 'auroc': 0.99926317, 'binary_precision': 0.962963, 'binary_recall': 0.8654891, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.9116279}
confusion matrix:
       0     1
0  42271    49
1    198  1274
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9388939, 'recall': 0.8305772, 'specificity': 0.8305772, 'f1': 0.8765427, 'auroc': 0.9763386, 'binary_precision': 0.88958335, 'binary_recall': 0.66407466, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.76046306}
confusion matrix:
       0    1
0  18096   53
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.89738846, 'recall': 0.6594188, 'specificity': 0.6594188, 'f1': 0.72338223, 'auroc': 0.93801594, 'binary_precision': 0.8235294, 'binary_recall': 0.3218391, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.46280992}
confusion matrix:
      0   1
0  5979  18
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_28.png
early stop counter: 8
val acc:0.985685408115387, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 28,now: 2024-06-03 00:35:18.456007,epoch time: 0:25:18.708659,used: 11:50:22.056638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.995981, 'precision': 0.9621082, 'recall': 0.97725093, 'specificity': 0.97725093, 'f1': 0.9695479, 'auroc': 0.999379, 'binary_precision': 0.92570674, 'binary_recall': 0.957172, 'binary_specificity': 0.99732995, 'binary_f1_score': 0.9411764}
confusion matrix:
       0     1
0  42208   113
1     63  1408
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9219439, 'recall': 0.8678809, 'specificity': 0.8678809, 'f1': 0.8929144, 'auroc': 0.97962195, 'binary_precision': 0.8530466, 'binary_recall': 0.7402799, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.79267275}
confusion matrix:
       0    1
0  18067   82
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.85926485, 'recall': 0.7075597, 'specificity': 0.7075597, 'f1': 0.7611432, 'auroc': 0.9543464, 'binary_precision': 0.7432432, 'binary_recall': 0.42145595, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.5378973}
confusion matrix:
      0    1
0  5959   38
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_29.png
early stop counter: 9
val acc:0.9867497086524963, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 29,now: 2024-06-03 01:00:42.836202,epoch time: 0:25:24.380195,used: 12:15:46.436833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99451953, 'precision': 0.9740758, 'recall': 0.9397891, 'specificity': 0.9397891, 'f1': 0.9562411, 'auroc': 0.9987376, 'binary_precision': 0.95227605, 'binary_recall': 0.8811141, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.915314}
confusion matrix:
       0     1
0  42255    65
1    175  1297
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9338826, 'recall': 0.8141924, 'specificity': 0.8141924, 'f1': 0.8637514, 'auroc': 0.9649957, 'binary_precision': 0.88069415, 'binary_recall': 0.63141525, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.7355073}
confusion matrix:
       0    1
0  18094   55
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81489533, 'recall': 0.55996865, 'specificity': 0.55996865, 'f1': 0.59352463, 'auroc': 0.9261615, 'binary_precision': 0.6666667, 'binary_recall': 0.12260536, 'binary_specificity': 0.997332, 'binary_f1_score': 0.20711973}
confusion matrix:
      0   1
0  5981  16
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_30.png
early stop counter: 10
val acc:0.9844614863395691, best validation acc: 0.9879736304283142, corresponding to test acc:                         0.9629274606704712 / 0.9752317070960999
after epoch: 30,now: 2024-06-03 01:26:16.427733,epoch time: 0:25:33.591531,used: 12:41:20.028364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_44_56_seed_0_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:41:20.028364 at 2024-06-03 01:26:16.427733
persisted model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.89589787, 'recall': 0.5816251, 'specificity': 0.5816251, 'f1': 0.6280792, 'auroc': 0.93599516, 'binary_precision': 0.8269231, 'binary_recall': 0.16475096, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.27476037}
confusion matrix:
      0   1
0  5988   9
1   218  43
oracle model performance metric: 

scalar performance:
{'acc': 0.97379357, 'precision': 0.85220265, 'recall': 0.7975961, 'specificity': 0.7975961, 'f1': 0.8223538, 'auroc': 0.95783174, 'binary_precision': 0.7214612, 'binary_recall': 0.60536397, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.6583333}
confusion matrix:
      0    1
0  5936   61
1   103  158
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |   1663 MiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |   1663 MiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    878 TiB |    878 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    867 TiB |    867 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3498 MiB |   3498 MiB |   3498 MiB |      0 B   |
|       from large pool |   3486 MiB |   3486 MiB |   3486 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258190 KiB | 293738 KiB | 504950 GiB | 504949 GiB |
|       from large pool | 254640 KiB | 290224 KiB | 493454 GiB | 493454 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     138    |       0    |
|       from large pool |     132    |     132    |     132    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |    2824    |   71463 K  |   71463 K  |
|       from large pool |      78    |     118    |   33401 K  |   33401 K  |
|       from small pool |      19    |    2746    |   38062 K  |   38062 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    878 TiB |    878 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    867 TiB |    867 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3498 MiB |   3498 MiB |   1576 MiB |
|       from large pool |   1912 MiB |   3486 MiB |   3486 MiB |   1574 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 302912 KiB | 504951 GiB | 504951 GiB |
|       from large pool |  24320 KiB | 298672 KiB | 493455 GiB | 493455 GiB |
|       from small pool |      0 KiB |   9141 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     138    |      45    |
|       from large pool |      88    |     132    |     132    |      44    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71465 K  |   71465 K  |
|       from large pool |       3    |     118    |   33401 K  |   33401 K  |
|       from small pool |       0    |    2746    |   38063 K  |   38063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    878 TiB |    878 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    867 TiB |    867 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3498 MiB |   3498 MiB |   1576 MiB |
|       from large pool |   1912 MiB |   3486 MiB |   3486 MiB |   1574 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 302912 KiB | 504951 GiB | 504951 GiB |
|       from large pool |  24320 KiB | 298672 KiB | 493455 GiB | 493455 GiB |
|       from small pool |      0 KiB |   9141 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     138    |      45    |
|       from large pool |      88    |     132    |     132    |      44    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71465 K  |   71465 K  |
|       from large pool |       3    |     118    |   33401 K  |   33401 K  |
|       from small pool |       0    |    2746    |   38063 K  |   38063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737

 Experiment start at: 2024-06-03 01:32:23.975815
before training, model accuracy: 0.12533451616764069
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9981171, 'precision': 0.9981177, 'recall': 0.99065495, 'specificity': 0.99065495, 'f1': 0.9943511, 'auroc': 0.999851, 'binary_precision': 0.9981185, 'binary_recall': 0.9814986, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.98973876}
confusion matrix:
       0     1
0  42404     8
1     80  4244
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.78535306, 'recall': 0.71569574, 'specificity': 0.71569574, 'f1': 0.74518394, 'auroc': 0.9486151, 'binary_precision': 0.59126985, 'binary_recall': 0.44279346, 'binary_specificity': 0.988598, 'binary_f1_score': 0.5063721}
confusion matrix:
       0    1
0  17861  206
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99316084, 'precision': 0.9955644, 'recall': 0.97106975, 'specificity': 0.97106975, 'f1': 0.9829016, 'auroc': 0.9985011, 'binary_precision': 0.9986413, 'binary_recall': 0.9423077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.969657}
confusion matrix:
      0    1
0  5945    1
1    45  735
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 01:52:25.797246,epoch time: 0:20:01.821431,used: 0:20:01.821431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9960416, 'precision': 0.99685097, 'recall': 0.9795471, 'specificity': 0.9795471, 'f1': 0.9880075, 'auroc': 0.9988984, 'binary_precision': 0.9978355, 'binary_recall': 0.95930636, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9781917}
confusion matrix:
       0     1
0  42402     9
1    176  4149
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.848294, 'recall': 0.5337049, 'specificity': 0.5337049, 'f1': 0.5537366, 'auroc': 0.9379005, 'binary_precision': 0.73015875, 'binary_recall': 0.068350665, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.12499999}
confusion matrix:
       0   1
0  18050  17
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99093074, 'precision': 0.9949226, 'recall': 0.96089745, 'specificity': 0.96089745, 'f1': 0.97710145, 'auroc': 0.99865174, 'binary_precision': 1.0, 'binary_recall': 0.9217949, 'binary_specificity': 1.0, 'binary_f1_score': 0.95930624}
confusion matrix:
      0    1
0  5946    0
1    61  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_2.png
early stop counter: 1
val acc:0.9656350016593933, best validation acc: 0.9689968228340149, corresponding to test acc:                         0.9931608438491821 / 0.9931608438491821
after epoch: 2,now: 2024-06-03 02:11:46.270562,epoch time: 0:19:20.473316,used: 0:39:22.294747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9979673, 'precision': 0.9988825, 'recall': 0.9890199, 'specificity': 0.9890199, 'f1': 0.9938896, 'auroc': 0.9998703, 'binary_precision': 1.0, 'binary_recall': 0.97803974, 'binary_specificity': 1.0, 'binary_f1_score': 0.988898}
confusion matrix:
       0     1
0  42410     0
1     95  4231
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.893188, 'recall': 0.6038692, 'specificity': 0.6038692, 'f1': 0.65896887, 'auroc': 0.9490427, 'binary_precision': 0.8150289, 'binary_recall': 0.20950966, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.33333334}
confusion matrix:
       0    1
0  18035   32
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9930122, 'precision': 0.9960787, 'recall': 0.96987176, 'specificity': 0.96987176, 'f1': 0.9824996, 'auroc': 0.9999149, 'binary_precision': 1.0, 'binary_recall': 0.9397436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9689359}
confusion matrix:
      0    1
0  5946    0
1    47  733
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_3.png
better model found
persisted
after epoch: 3,now: 2024-06-03 02:31:04.421804,epoch time: 0:19:18.151242,used: 0:58:40.445989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9972398, 'precision': 0.9984838, 'recall': 0.98509014, 'specificity': 0.98509014, 'f1': 0.991673, 'auroc': 0.9995579, 'binary_precision': 1.0, 'binary_recall': 0.97018033, 'binary_specificity': 1.0, 'binary_f1_score': 0.98486453}
confusion matrix:
       0     1
0  42410     0
1    129  4197
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.9739502, 'recall': 0.5386053, 'specificity': 0.5386053, 'f1': 0.56316364, 'auroc': 0.9475162, 'binary_precision': 0.9811321, 'binary_recall': 0.07726597, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.14325069}
confusion matrix:
       0   1
0  18066   1
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390423, 'precision': 0.99657595, 'recall': 0.9737179, 'specificity': 0.9737179, 'f1': 0.9847864, 'auroc': 0.99984276, 'binary_precision': 1.0, 'binary_recall': 0.9474359, 'binary_specificity': 1.0, 'binary_f1_score': 0.9730086}
confusion matrix:
      0    1
0  5946    0
1    41  739
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_4.png
new oracle model saved
early stop counter: 1
val acc:0.9668089747428894, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9939042329788208
after epoch: 4,now: 2024-06-03 02:50:28.392147,epoch time: 0:19:23.970343,used: 1:18:04.416332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9977961, 'precision': 0.9976215, 'recall': 0.98923445, 'specificity': 0.98923445, 'f1': 0.99338335, 'auroc': 0.9997523, 'binary_precision': 0.9974081, 'binary_recall': 0.9787283, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9879799}
confusion matrix:
       0     1
0  42400    11
1     92  4233
---- Validation: 
scalar performance:
{'acc': 0.96979725, 'precision': 0.85947824, 'recall': 0.6188345, 'specificity': 0.6188345, 'f1': 0.6742881, 'auroc': 0.95693135, 'binary_precision': 0.74654377, 'binary_recall': 0.24071322, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.36404493}
confusion matrix:
       0    1
0  18012   55
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99509364, 'precision': 0.9972403, 'recall': 0.9788462, 'specificity': 0.9788462, 'f1': 0.98781085, 'auroc': 0.9995183, 'binary_precision': 1.0, 'binary_recall': 0.9576923, 'binary_specificity': 1.0, 'binary_f1_score': 0.97838897}
confusion matrix:
      0    1
0  5946    0
1    33  747
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_5.png
new oracle model saved
early stop counter: 2
val acc:0.9697972536087036, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9950936436653137
after epoch: 5,now: 2024-06-03 03:10:15.188756,epoch time: 0:19:46.796609,used: 1:37:51.212941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99683326, 'precision': 0.9980454, 'recall': 0.9831017, 'specificity': 0.9831017, 'f1': 0.9904313, 'auroc': 0.9995979, 'binary_precision': 0.99952173, 'binary_recall': 0.9662506, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.98260456}
confusion matrix:
       0     1
0  42408     2
1    146  4180
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.94897956, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.99978566, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_6.png
new oracle model saved
early stop counter: 3
val acc:0.9639274477958679, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9952423572540283
after epoch: 6,now: 2024-06-03 03:30:00.924674,epoch time: 0:19:45.735918,used: 1:57:36.948859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.9988034, 'recall': 0.9939309, 'specificity': 0.9939309, 'f1': 0.99635214, 'auroc': 0.9999422, 'binary_precision': 0.9988315, 'binary_recall': 0.98797965, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99337596}
confusion matrix:
       0     1
0  42405     5
1     52  4274
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.83251464, 'recall': 0.5833116, 'specificity': 0.5833116, 'f1': 0.62789077, 'auroc': 0.94907266, 'binary_precision': 0.69512194, 'binary_recall': 0.16939078, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.27240142}
confusion matrix:
       0    1
0  18017   50
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973238, 'precision': 0.9984909, 'recall': 0.9884615, 'specificity': 0.9884615, 'f1': 0.9934078, 'auroc': 0.9998665, 'binary_precision': 1.0, 'binary_recall': 0.97692305, 'binary_specificity': 1.0, 'binary_f1_score': 0.98832685}
confusion matrix:
      0    1
0  5946    0
1    18  762
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_7.png
new oracle model saved
early stop counter: 4
val acc:0.9675026535987854, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9973238110542297
after epoch: 7,now: 2024-06-03 03:49:58.717810,epoch time: 0:19:57.793136,used: 2:17:34.741995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9978817, 'precision': 0.998729, 'recall': 0.9886587, 'specificity': 0.9886587, 'f1': 0.9936297, 'auroc': 0.99973255, 'binary_precision': 0.9997635, 'binary_recall': 0.97734106, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98842514}
confusion matrix:
       0     1
0  42410     1
1     98  4227
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.88642603, 'recall': 0.5154634, 'specificity': 0.5154634, 'f1': 0.52111167, 'auroc': 0.9571502, 'binary_precision': 0.8076923, 'binary_recall': 0.031203566, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.060085837}
confusion matrix:
       0   1
0  18062   5
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994945, 'precision': 0.99541074, 'recall': 0.9798759, 'specificity': 0.9798759, 'f1': 0.9874772, 'auroc': 0.99975765, 'binary_precision': 0.99601066, 'binary_recall': 0.9602564, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.97780675}
confusion matrix:
      0    1
0  5943    3
1    31  749
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_8.png
early stop counter: 5
val acc:0.9649413228034973, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9973238110542297
after epoch: 8,now: 2024-06-03 04:09:36.289351,epoch time: 0:19:37.571541,used: 2:37:12.313536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9991174, 'recall': 0.99133146, 'specificity': 0.99133146, 'f1': 0.9951861, 'auroc': 0.99986094, 'binary_precision': 1.0, 'binary_recall': 0.982663, 'binary_specificity': 1.0, 'binary_f1_score': 0.9912557}
confusion matrix:
       0     1
0  42410     0
1     75  4251
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.94666314, 'recall': 0.50963056, 'specificity': 0.50963056, 'f1': 0.50994015, 'auroc': 0.9426909, 'binary_precision': 0.9285714, 'binary_recall': 0.019316493, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.037845705}
confusion matrix:
       0   1
0  18066   1
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99815685, 'recall': 0.9858974, 'specificity': 0.9858974, 'f1': 0.9919246, 'auroc': 0.9998568, 'binary_precision': 1.0, 'binary_recall': 0.97179484, 'binary_specificity': 1.0, 'binary_f1_score': 0.9856957}
confusion matrix:
      0    1
0  5946    0
1    22  758
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_9.png
early stop counter: 6
val acc:0.9647278785705566, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9973238110542297
after epoch: 9,now: 2024-06-03 04:29:19.488775,epoch time: 0:19:43.199424,used: 2:56:55.512960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9985878, 'precision': 0.9992231, 'recall': 0.99236995, 'specificity': 0.99236995, 'f1': 0.9957669, 'auroc': 0.99972165, 'binary_precision': 1.0, 'binary_recall': 0.9847399, 'binary_specificity': 1.0, 'binary_f1_score': 0.9923113}
confusion matrix:
       0     1
0  42411     0
1     66  4259
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.96552277, 'recall': 0.52077466, 'specificity': 0.52077466, 'f1': 0.5311036, 'auroc': 0.9523022, 'binary_precision': 0.9655172, 'binary_recall': 0.041604754, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.079772085}
confusion matrix:
       0   1
0  18066   1
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9998697, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_10.png
new oracle model saved
early stop counter: 7
val acc:0.9655283093452454, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9974724650382996
after epoch: 10,now: 2024-06-03 04:48:49.487515,epoch time: 0:19:29.998740,used: 3:16:25.511700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.99915254, 'recall': 0.99167824, 'specificity': 0.99167824, 'f1': 0.99538016, 'auroc': 0.99969906, 'binary_precision': 1.0, 'binary_recall': 0.9833565, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916084}
confusion matrix:
       0     1
0  42410     0
1     72  4254
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73209333, 'recall': 0.5014305, 'specificity': 0.5014305, 'f1': 0.49381095, 'auroc': 0.93809056, 'binary_precision': 0.5, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0059084194}
confusion matrix:
       0  1
0  18065  2
1    671  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.99998903, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_11.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9974724650382996
after epoch: 11,now: 2024-06-03 05:08:29.883147,epoch time: 0:19:40.395632,used: 3:36:05.907332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9995289, 'recall': 0.9953768, 'specificity': 0.9953768, 'f1': 0.99744195, 'auroc': 0.9997817, 'binary_precision': 1.0, 'binary_recall': 0.9907536, 'binary_specificity': 1.0, 'binary_f1_score': 0.9953553}
confusion matrix:
       0     1
0  42410     0
1     40  4286
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.9626699, 'recall': 0.55043703, 'specificity': 0.55043703, 'f1': 0.5831226, 'auroc': 0.93363684, 'binary_precision': 0.9577465, 'binary_recall': 0.10104012, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.1827957}
confusion matrix:
       0   1
0  18064   3
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.99874187, 'recall': 0.9903846, 'specificity': 0.9903846, 'f1': 0.9945158, 'auroc': 0.9997396, 'binary_precision': 1.0, 'binary_recall': 0.9807692, 'binary_specificity': 1.0, 'binary_f1_score': 0.9902913}
confusion matrix:
      0    1
0  5946    0
1    15  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_12.png
new oracle model saved
early stop counter: 9
val acc:0.9675560593605042, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.997769832611084
after epoch: 12,now: 2024-06-03 05:28:00.013767,epoch time: 0:19:30.130620,used: 3:55:36.037952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9986734, 'precision': 0.99574554, 'recall': 0.9963629, 'specificity': 0.9963629, 'f1': 0.99605405, 'auroc': 0.9997866, 'binary_precision': 0.99215144, 'binary_recall': 0.99352753, 'binary_specificity': 0.9991983, 'binary_f1_score': 0.99283904}
confusion matrix:
       0     1
0  42376    34
1     28  4298
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.78443706, 'recall': 0.5833074, 'specificity': 0.5833074, 'f1': 0.62427664, 'auroc': 0.9035324, 'binary_precision': 0.5989583, 'binary_recall': 0.17087667, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.26589593}
confusion matrix:
       0    1
0  17990   77
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9990767, 'recall': 0.9929487, 'specificity': 0.9929487, 'f1': 0.9959873, 'auroc': 0.99995625, 'binary_precision': 1.0, 'binary_recall': 0.9858974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99289864}
confusion matrix:
      0    1
0  5946    0
1    11  769
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_13.png
new oracle model saved
early stop counter: 10
val acc:0.9661152362823486, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9983645677566528
after epoch: 13,now: 2024-06-03 05:47:22.246757,epoch time: 0:19:22.232990,used: 4:14:58.270942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9986948, 'precision': 0.9982325, 'recall': 0.9939875, 'specificity': 0.9939875, 'f1': 0.99609864, 'auroc': 0.9993591, 'binary_precision': 0.9976663, 'binary_recall': 0.9882108, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9929161}
confusion matrix:
       0     1
0  42400    10
1     51  4275
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.83603793, 'recall': 0.599435, 'specificity': 0.599435, 'f1': 0.6487372, 'auroc': 0.905934, 'binary_precision': 0.7010309, 'binary_recall': 0.20208023, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.31372547}
confusion matrix:
       0    1
0  18009   58
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.99917716, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_14.png
early stop counter: 11
val acc:0.9682497382164001, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9983645677566528
after epoch: 14,now: 2024-06-03 06:06:36.036963,epoch time: 0:19:13.790206,used: 4:34:12.061148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.9983212, 'recall': 0.99594057, 'specificity': 0.99594057, 'f1': 0.9971273, 'auroc': 0.9999144, 'binary_precision': 0.9974436, 'binary_recall': 0.99214053, 'binary_specificity': 0.9997406, 'binary_f1_score': 0.99478495}
confusion matrix:
       0     1
0  42399    11
1     34  4292
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.8812906, 'recall': 0.5316421, 'specificity': 0.5316421, 'f1': 0.5504268, 'auroc': 0.9563077, 'binary_precision': 0.7962963, 'binary_recall': 0.06389301, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.11829435}
confusion matrix:
       0   1
0  18056  11
1    630  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.9994337, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_15.png
early stop counter: 12
val acc:0.96579509973526, best validation acc: 0.9699039459228516, corresponding to test acc:                         0.9930121898651123 / 0.9983645677566528
after epoch: 15,now: 2024-06-03 06:25:50.386589,epoch time: 0:19:14.349626,used: 4:53:26.410774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.99897003, 'recall': 0.99554896, 'specificity': 0.99554896, 'f1': 0.99725217, 'auroc': 0.99975765, 'binary_precision': 0.9988353, 'binary_recall': 0.9912159, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99501103}
confusion matrix:
       0     1
0  42405     5
1     38  4288
---- Validation: 
scalar performance:
{'acc': 0.9740128, 'precision': 0.91401255, 'recall': 0.6660826, 'specificity': 0.6660826, 'f1': 0.73346466, 'auroc': 0.95662975, 'binary_precision': 0.85227275, 'binary_recall': 0.3343239, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.4802561}
confusion matrix:
       0    1
0  18028   39
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.99986374, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_16.png
better model found
persisted
after epoch: 16,now: 2024-06-03 06:45:06.927973,epoch time: 0:19:16.541384,used: 5:12:42.952158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99878037, 'precision': 0.99932885, 'recall': 0.9934119, 'specificity': 0.9934119, 'f1': 0.9963484, 'auroc': 0.99988544, 'binary_precision': 1.0, 'binary_recall': 0.98682386, 'binary_specificity': 1.0, 'binary_f1_score': 0.99336827}
confusion matrix:
       0     1
0  42410     0
1     57  4269
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.8915944, 'recall': 0.5132623, 'specificity': 0.5132623, 'f1': 0.51694185, 'auroc': 0.94875395, 'binary_precision': 0.8181818, 'binary_recall': 0.026745914, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.05179856}
confusion matrix:
       0   1
0  18063   4
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702644, 'precision': 0.9983238, 'recall': 0.9871795, 'specificity': 0.9871795, 'f1': 0.992667, 'auroc': 0.9996017, 'binary_precision': 1.0, 'binary_recall': 0.974359, 'binary_specificity': 1.0, 'binary_f1_score': 0.987013}
confusion matrix:
      0    1
0  5946    0
1    20  760
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_17.png
early stop counter: 1
val acc:0.9648345708847046, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 17,now: 2024-06-03 07:04:21.890588,epoch time: 0:19:14.962615,used: 5:31:57.914773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.9994936, 'recall': 0.9950289, 'specificity': 0.9950289, 'f1': 0.99724865, 'auroc': 0.99995077, 'binary_precision': 1.0, 'binary_recall': 0.9900578, 'binary_specificity': 1.0, 'binary_f1_score': 0.99500406}
confusion matrix:
       0     1
0  42411     0
1     43  4282
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.9566226, 'recall': 0.5392929, 'specificity': 0.5392929, 'f1': 0.5642264, 'auroc': 0.9539258, 'binary_precision': 0.9464286, 'binary_recall': 0.078751855, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.14540467}
confusion matrix:
       0   1
0  18064   3
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.99894303, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_18.png
early stop counter: 2
val acc:0.9667556285858154, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 18,now: 2024-06-03 07:23:35.041264,epoch time: 0:19:13.150676,used: 5:51:11.065449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.9994122, 'recall': 0.99536395, 'specificity': 0.99536395, 'f1': 0.99737775, 'auroc': 0.99988943, 'binary_precision': 0.9997667, 'binary_recall': 0.99075145, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99523866}
confusion matrix:
       0     1
0  42410     1
1     40  4285
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.9518167, 'recall': 0.54372287, 'specificity': 0.54372287, 'f1': 0.57175356, 'auroc': 0.9436261, 'binary_precision': 0.93650794, 'binary_recall': 0.08766716, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.1603261}
confusion matrix:
       0   1
0  18063   4
1    614  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.9988339, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_19.png
early stop counter: 3
val acc:0.9670224189758301, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 19,now: 2024-06-03 07:42:49.219093,epoch time: 0:19:14.177829,used: 6:10:25.243278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9994437, 'precision': 0.9995892, 'recall': 0.997098, 'specificity': 0.997098, 'f1': 0.9983397, 'auroc': 0.9999696, 'binary_precision': 0.9997675, 'binary_recall': 0.99421966, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9969859}
confusion matrix:
       0     1
0  42410     1
1     25  4300
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.92509556, 'recall': 0.6020002, 'specificity': 0.6020002, 'f1': 0.6587071, 'auroc': 0.9578978, 'binary_precision': 0.8789809, 'binary_recall': 0.205052, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.3325301}
confusion matrix:
       0    1
0  18048   19
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9984272, 'recall': 0.9928646, 'specificity': 0.9928646, 'f1': 0.9956249, 'auroc': 0.999769, 'binary_precision': 0.9987013, 'binary_recall': 0.9858974, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9922581}
confusion matrix:
      0    1
0  5945    1
1    11  769
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_20.png
early stop counter: 4
val acc:0.9704375863075256, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 20,now: 2024-06-03 08:02:02.120344,epoch time: 0:19:12.901251,used: 6:29:38.144529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99914414, 'precision': 0.9995289, 'recall': 0.9953747, 'specificity': 0.9953747, 'f1': 0.9974409, 'auroc': 0.99984306, 'binary_precision': 1.0, 'binary_recall': 0.9907493, 'binary_specificity': 1.0, 'binary_f1_score': 0.9953531}
confusion matrix:
       0     1
0  42412     0
1     40  4284
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.9671922, 'recall': 0.563067, 'specificity': 0.563067, 'f1': 0.60364753, 'auroc': 0.8976055, 'binary_precision': 0.96590906, 'binary_recall': 0.12630014, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.22339027}
confusion matrix:
       0   1
0  18064   3
1    588  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.99941367, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_21.png
early stop counter: 5
val acc:0.9684631824493408, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 21,now: 2024-06-03 08:21:15.655985,epoch time: 0:19:13.535641,used: 6:48:51.680170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9995406, 'recall': 0.9954913, 'specificity': 0.9954913, 'f1': 0.99750566, 'auroc': 0.99993396, 'binary_precision': 1.0, 'binary_recall': 0.99098265, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954709}
confusion matrix:
       0     1
0  42411     0
1     39  4286
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.98302317, 'recall': 0.5282318, 'specificity': 0.5282318, 'f1': 0.5448109, 'auroc': 0.9458766, 'binary_precision': 1.0, 'binary_recall': 0.056463595, 'binary_specificity': 1.0, 'binary_f1_score': 0.1068917}
confusion matrix:
       0   1
0  18067   0
1    635  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.99997544, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_22.png
early stop counter: 6
val acc:0.9661152362823486, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 22,now: 2024-06-03 08:40:29.860167,epoch time: 0:19:14.204182,used: 7:08:05.884352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99952924, 'precision': 0.9997407, 'recall': 0.99745727, 'specificity': 0.99745727, 'f1': 0.9985957, 'auroc': 0.99985504, 'binary_precision': 1.0, 'binary_recall': 0.9949145, 'binary_specificity': 1.0, 'binary_f1_score': 0.9974507}
confusion matrix:
       0     1
0  42410     0
1     22  4304
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.9733066, 'recall': 0.5363765, 'specificity': 0.5363765, 'f1': 0.5592714, 'auroc': 0.9559989, 'binary_precision': 0.98, 'binary_recall': 0.07280832, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.13554634}
confusion matrix:
       0   1
0  18066   1
1    624  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.9999771, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_23.png
early stop counter: 7
val acc:0.9666488766670227, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.995985746383667 / 0.9983645677566528
after epoch: 23,now: 2024-06-03 08:59:43.129889,epoch time: 0:19:13.269722,used: 7:27:19.154074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99762493, 'precision': 0.9892168, 'recall': 0.99682224, 'specificity': 0.99682224, 'f1': 0.9929826, 'auroc': 0.9998294, 'binary_precision': 0.9788588, 'binary_recall': 0.9958372, 'binary_specificity': 0.9978072, 'binary_f1_score': 0.987275}
confusion matrix:
       0     1
0  42319    93
1     18  4306
---- Validation: 
scalar performance:
{'acc': 0.9741729, 'precision': 0.8575245, 'recall': 0.7162344, 'specificity': 0.7162344, 'f1': 0.7680268, 'auroc': 0.95996904, 'binary_precision': 0.73566085, 'binary_recall': 0.4383358, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.54934824}
confusion matrix:
       0    1
0  17961  106
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.999554, 'precision': 0.9997479, 'recall': 0.9980769, 'specificity': 0.9980769, 'f1': 0.9989105, 'auroc': 0.99999654, 'binary_precision': 1.0, 'binary_recall': 0.99615383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9980732}
confusion matrix:
      0    1
0  5946    0
1     3  777
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_24.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-06-03 09:18:57.914981,epoch time: 0:19:14.785092,used: 7:46:33.939166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.99936503, 'recall': 0.9949015, 'specificity': 0.9949015, 'f1': 0.99712074, 'auroc': 0.9998117, 'binary_precision': 0.99976647, 'binary_recall': 0.98982656, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9947717}
confusion matrix:
       0     1
0  42410     1
1     44  4281
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.9720662, 'recall': 0.53266174, 'specificity': 0.53266174, 'f1': 0.5527127, 'auroc': 0.9482933, 'binary_precision': 0.9777778, 'binary_recall': 0.0653789, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.12256268}
confusion matrix:
       0   1
0  18066   1
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99991846, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_25.png
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 25,now: 2024-06-03 09:38:09.852725,epoch time: 0:19:11.937744,used: 8:05:45.876910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99899435, 'precision': 0.9969543, 'recall': 0.99705744, 'specificity': 0.99705744, 'f1': 0.9970059, 'auroc': 0.99984765, 'binary_precision': 0.99445087, 'binary_recall': 0.9946808, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.99456584}
confusion matrix:
       0     1
0  42388    24
1     23  4301
---- Validation: 
scalar performance:
{'acc': 0.96227324, 'precision': 0.6911339, 'recall': 0.55771095, 'specificity': 0.55771095, 'f1': 0.5844885, 'auroc': 0.9230341, 'binary_precision': 0.41414142, 'binary_recall': 0.121842496, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.18828933}
confusion matrix:
       0    1
0  17951  116
1    591   82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.9999972, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_26.png
early stop counter: 2
val acc:0.9622732400894165, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 26,now: 2024-06-03 09:57:24.391359,epoch time: 0:19:14.538634,used: 8:25:00.415544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9993153, 'precision': 0.99962306, 'recall': 0.99629974, 'specificity': 0.99629974, 'f1': 0.99795437, 'auroc': 0.99980795, 'binary_precision': 1.0, 'binary_recall': 0.9925994, 'binary_specificity': 1.0, 'binary_f1_score': 0.9962859}
confusion matrix:
       0     1
0  42412     0
1     32  4292
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.90050566, 'recall': 0.55161846, 'specificity': 0.55161846, 'f1': 0.58406955, 'auroc': 0.9535748, 'binary_precision': 0.8333333, 'binary_recall': 0.104011886, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.18494055}
confusion matrix:
       0   1
0  18053  14
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.99982727, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_27.png
early stop counter: 3
val acc:0.967075765132904, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 27,now: 2024-06-03 10:16:42.952834,epoch time: 0:19:18.561475,used: 8:44:18.977019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99903715, 'precision': 0.9992602, 'recall': 0.99500644, 'specificity': 0.99500644, 'f1': 0.99712193, 'auroc': 0.99989295, 'binary_precision': 0.99953324, 'binary_recall': 0.9900601, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99477416}
confusion matrix:
       0     1
0  42408     2
1     43  4283
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.87055975, 'recall': 0.5551118, 'specificity': 0.5551118, 'f1': 0.588958, 'auroc': 0.9131968, 'binary_precision': 0.77319586, 'binary_recall': 0.11144131, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.19480519}
confusion matrix:
       0   1
0  18045  22
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99924433, 'recall': 0.99423075, 'specificity': 0.99423075, 'f1': 0.99672055, 'auroc': 0.9999946, 'binary_precision': 1.0, 'binary_recall': 0.98846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.9941973}
confusion matrix:
      0    1
0  5946    0
1     9  771
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_28.png
early stop counter: 4
val acc:0.9669156670570374, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 28,now: 2024-06-03 10:36:04.565357,epoch time: 0:19:21.612523,used: 9:03:40.589542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.999576, 'recall': 0.9958391, 'specificity': 0.9958391, 'f1': 0.9976987, 'auroc': 0.9999502, 'binary_precision': 1.0, 'binary_recall': 0.99167824, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958217}
confusion matrix:
       0     1
0  42410     0
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.81552863, 'recall': 0.5043746, 'specificity': 0.5043746, 'f1': 0.49969387, 'auroc': 0.9568228, 'binary_precision': 0.6666667, 'binary_recall': 0.008915304, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.017595308}
confusion matrix:
       0  1
0  18064  3
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.9999808, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_29.png
early stop counter: 5
val acc:0.9642475843429565, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 29,now: 2024-06-03 10:55:25.411877,epoch time: 0:19:20.846520,used: 9:23:01.436062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9993153, 'precision': 0.99962306, 'recall': 0.99629974, 'specificity': 0.99629974, 'f1': 0.99795437, 'auroc': 0.99996424, 'binary_precision': 1.0, 'binary_recall': 0.9925994, 'binary_specificity': 1.0, 'binary_f1_score': 0.9962859}
confusion matrix:
       0     1
0  42412     0
1     32  4292
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.9112296, 'recall': 0.5177199, 'specificity': 0.5177199, 'f1': 0.52535945, 'auroc': 0.942893, 'binary_precision': 0.85714287, 'binary_recall': 0.035661217, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.06847361}
confusion matrix:
       0   1
0  18063   4
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.99965346, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_30.png
early stop counter: 6
val acc:0.965154767036438, best validation acc: 0.9741728901863098, corresponding to test acc:                         0.9995539784431458 / 0.9995539784431458
after epoch: 30,now: 2024-06-03 11:14:43.941935,epoch time: 0:19:18.530058,used: 9:42:19.966120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_01_32_23_seed_1_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:42:19.966120 at 2024-06-03 11:14:43.941935
persisted model performance metric: 

scalar performance:
{'acc': 0.99910796, 'precision': 0.999496, 'recall': 0.99615383, 'specificity': 0.99615383, 'f1': 0.99781734, 'auroc': 0.9998753, 'binary_precision': 1.0, 'binary_recall': 0.99230766, 'binary_specificity': 1.0, 'binary_f1_score': 0.996139}
confusion matrix:
      0    1
0  5946    0
1     6  774
oracle model performance metric: 

scalar performance:
{'acc': 0.99910796, 'precision': 0.99893546, 'recall': 0.9967108, 'specificity': 0.9967108, 'f1': 0.9978198, 'auroc': 0.9992163, 'binary_precision': 0.99871135, 'binary_recall': 0.99358976, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.996144}
confusion matrix:
      0    1
0  5945    1
1     5  775
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      6 MiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      6 MiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1812 TiB |   1812 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1789 TiB |   1789 TiB |
|       from small pool |      5 MiB |      9 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3480 MiB |   3498 MiB |   5056 MiB |   1576 MiB |
|       from large pool |   3468 MiB |   3486 MiB |   5042 MiB |   1574 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 240151 KiB | 302912 KiB |   1026 TiB |   1026 TiB |
|       from large pool | 236688 KiB | 298672 KiB |   1003 TiB |   1003 TiB |
|       from small pool |   3463 KiB |   9141 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6705    |  289923 K  |  289920 K  |
|       from large pool |     247    |     352    |  112421 K  |  112420 K  |
|       from small pool |    3293    |    6457    |  177502 K  |  177499 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6705    |  289923 K  |  289920 K  |
|       from large pool |     247    |     352    |  112421 K  |  112420 K  |
|       from small pool |    3293    |    6457    |  177502 K  |  177499 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     183    |      45    |
|       from large pool |     132    |     132    |     176    |      44    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    3008    |  145099 K  |  145099 K  |
|       from large pool |      77    |     118    |   69233 K  |   69233 K  |
|       from small pool |      18    |    2931    |   75865 K  |   75865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      0 KiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      0 KiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1812 TiB |   1812 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1789 TiB |   1789 TiB |
|       from small pool |      0 KiB |      9 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |   3498 MiB |   5056 MiB |   3152 MiB |
|       from large pool |   1894 MiB |   3486 MiB |   5042 MiB |   3148 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 302912 KiB |   1026 TiB |   1026 TiB |
|       from large pool |  24320 KiB | 298672 KiB |   1003 TiB |   1003 TiB |
|       from small pool |      0 KiB |   9278 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  289923 K  |  289923 K  |
|       from large pool |       2    |     352    |  112421 K  |  112421 K  |
|       from small pool |       0    |    6457    |  177502 K  |  177502 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  289923 K  |  289923 K  |
|       from large pool |       2    |     352    |  112421 K  |  112421 K  |
|       from small pool |       0    |    6457    |  177502 K  |  177502 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     183    |      90    |
|       from large pool |      88    |     132    |     176    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |  145100 K  |  145100 K  |
|       from large pool |       3    |     118    |   69233 K  |   69233 K  |
|       from small pool |       0    |    2931    |   75867 K  |   75867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      0 KiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1815 TiB |   1815 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      0 KiB |     11 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1812 TiB |   1812 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1789 TiB |   1789 TiB |
|       from small pool |      0 KiB |      9 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1904 MiB |   3498 MiB |   5056 MiB |   3152 MiB |
|       from large pool |   1894 MiB |   3486 MiB |   5042 MiB |   3148 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 302912 KiB |   1026 TiB |   1026 TiB |
|       from large pool |  24320 KiB | 298672 KiB |   1003 TiB |   1003 TiB |
|       from small pool |      0 KiB |   9278 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6705    |  289923 K  |  289923 K  |
|       from large pool |       2    |     352    |  112421 K  |  112421 K  |
|       from small pool |       0    |    6457    |  177502 K  |  177502 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6705    |  289923 K  |  289923 K  |
|       from large pool |       2    |     352    |  112421 K  |  112421 K  |
|       from small pool |       0    |    6457    |  177502 K  |  177502 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     183    |      90    |
|       from large pool |      88    |     132    |     176    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3008    |  145100 K  |  145100 K  |
|       from large pool |       3    |     118    |   69233 K  |   69233 K  |
|       from small pool |       0    |    2931    |   75867 K  |   75867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737

 Experiment start at: 2024-06-03 11:20:04.873265
before training, model accuracy: 0.18146659433841705
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9968835, 'precision': 0.9982805, 'recall': 0.9839172, 'specificity': 0.9839172, 'f1': 0.99096596, 'auroc': 0.99958694, 'binary_precision': 1.0, 'binary_recall': 0.96783435, 'binary_specificity': 1.0, 'binary_f1_score': 0.9836543}
confusion matrix:
       0     1
0  42309     0
1    146  4393
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.8591194, 'recall': 0.50492835, 'specificity': 0.50492835, 'f1': 0.501741, 'auroc': 0.9233812, 'binary_precision': 0.75, 'binary_recall': 0.009966778, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.019672131}
confusion matrix:
       0  1
0  18169  2
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9930091, 'precision': 0.99611187, 'recall': 0.96763086, 'specificity': 0.96763086, 'f1': 0.9813223, 'auroc': 0.99954194, 'binary_precision': 1.0, 'binary_recall': 0.9352617, 'binary_specificity': 1.0, 'binary_f1_score': 0.966548}
confusion matrix:
      0    1
0  5997    0
1    47  679
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 11:40:08.536254,epoch time: 0:20:03.662989,used: 0:20:03.662989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9979081, 'precision': 0.99576676, 'recall': 0.9922532, 'specificity': 0.9922532, 'f1': 0.99400204, 'auroc': 0.99960554, 'binary_precision': 0.9931157, 'binary_recall': 0.985239, 'binary_specificity': 0.9992673, 'binary_f1_score': 0.98916173}
confusion matrix:
       0     1
0  42278    31
1     67  4472
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.86594766, 'recall': 0.61257666, 'specificity': 0.61257666, 'f1': 0.66804534, 'auroc': 0.94580925, 'binary_precision': 0.7569061, 'binary_recall': 0.22757475, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.34993613}
confusion matrix:
       0    1
0  18127   44
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99796605, 'recall': 0.9888973, 'specificity': 0.9888973, 'f1': 0.9933771, 'auroc': 0.9998196, 'binary_precision': 0.9985935, 'binary_recall': 0.9779614, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9881698}
confusion matrix:
      0    1
0  5996    1
1    16  710
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-03 12:00:56.749954,epoch time: 0:20:48.213700,used: 0:40:51.876689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9969476, 'precision': 0.99821377, 'recall': 0.9843425, 'specificity': 0.9843425, 'f1': 0.99115413, 'auroc': 0.9992131, 'binary_precision': 0.99977255, 'binary_recall': 0.9687087, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98399544}
confusion matrix:
       0     1
0  42309     1
1    142  4396
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.8812691, 'recall': 0.53458107, 'specificity': 0.53458107, 'f1': 0.55638313, 'auroc': 0.9267001, 'binary_precision': 0.7924528, 'binary_recall': 0.069767445, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.12824428}
confusion matrix:
       0   1
0  18160  11
1    560  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.99850374, 'recall': 0.9876033, 'specificity': 0.9876033, 'f1': 0.9929746, 'auroc': 0.9999219, 'binary_precision': 1.0, 'binary_recall': 0.9752066, 'binary_specificity': 1.0, 'binary_f1_score': 0.9874477}
confusion matrix:
      0    1
0  5997    0
1    18  708
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_3.png
early stop counter: 1
val acc:0.9695839881896973, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9974713921546936
after epoch: 3,now: 2024-06-03 12:20:40.033083,epoch time: 0:19:43.283129,used: 1:00:35.159818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.998271, 'precision': 0.99844396, 'recall': 0.9916674, 'specificity': 0.9916674, 'f1': 0.9950263, 'auroc': 0.9998749, 'binary_precision': 0.9986577, 'binary_recall': 0.9834765, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.991009}
confusion matrix:
       0     1
0  42303     6
1     75  4464
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7917988, 'recall': 0.537408, 'specificity': 0.537408, 'f1': 0.5600133, 'auroc': 0.9405746, 'binary_precision': 0.61333334, 'binary_recall': 0.07641196, 'binary_specificity': 0.998404, 'binary_f1_score': 0.13589364}
confusion matrix:
       0   1
0  18142  29
1    556  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.99768955, 'recall': 0.9922575, 'specificity': 0.9922575, 'f1': 0.994954, 'auroc': 0.99967897, 'binary_precision': 0.9972106, 'binary_recall': 0.9848485, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.990991}
confusion matrix:
      0    1
0  5995    2
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_4.png
new oracle model saved
early stop counter: 2
val acc:0.9688382148742676, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9980663657188416
after epoch: 4,now: 2024-06-03 12:40:05.559223,epoch time: 0:19:25.526140,used: 1:20:00.685958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9962005, 'precision': 0.9829596, 'recall': 0.9958313, 'specificity': 0.9958313, 'f1': 0.9892874, 'auroc': 0.99988127, 'binary_precision': 0.96641713, 'binary_recall': 0.9953734, 'binary_specificity': 0.9962892, 'binary_f1_score': 0.9806816}
confusion matrix:
       0     1
0  42152   157
1     21  4518
---- Validation: 
scalar performance:
{'acc': 0.96052843, 'precision': 0.69521475, 'recall': 0.74030197, 'specificity': 0.74030197, 'f1': 0.71511644, 'auroc': 0.93939304, 'binary_precision': 0.40696117, 'binary_recall': 0.50498337, 'binary_specificity': 0.9756205, 'binary_f1_score': 0.45070422}
confusion matrix:
       0    1
0  17728  443
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.9962276, 'recall': 0.9968283, 'specificity': 0.9968283, 'f1': 0.9965278, 'auroc': 0.9997444, 'binary_precision': 0.9931224, 'binary_recall': 0.9944904, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.99380594}
confusion matrix:
      0    1
0  5992    5
1     4  722
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_5.png
new oracle model saved
early stop counter: 3
val acc:0.9605284333229065, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9986613392829895
after epoch: 5,now: 2024-06-03 12:59:28.000975,epoch time: 0:19:22.441752,used: 1:39:23.127710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9991035, 'precision': 0.9995042, 'recall': 0.9953714, 'specificity': 0.9953714, 'f1': 0.99742687, 'auroc': 0.9999789, 'binary_precision': 1.0, 'binary_recall': 0.9907428, 'binary_specificity': 1.0, 'binary_f1_score': 0.9953499}
confusion matrix:
       0     1
0  42311     0
1     42  4495
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.8175026, 'recall': 0.50653446, 'specificity': 0.50653446, 'f1': 0.50493336, 'auroc': 0.9266051, 'binary_precision': 0.6666667, 'binary_recall': 0.013289036, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.026058631}
confusion matrix:
       0  1
0  18167  4
1    594  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.99983954, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_6.png
early stop counter: 4
val acc:0.9681457281112671, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9986613392829895
after epoch: 6,now: 2024-06-03 13:18:47.911240,epoch time: 0:19:19.910265,used: 1:58:43.037975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9988687, 'precision': 0.9986791, 'recall': 0.99485004, 'specificity': 0.99485004, 'f1': 0.9967552, 'auroc': 0.99986625, 'binary_precision': 0.99844444, 'binary_recall': 0.9898656, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99413645}
confusion matrix:
       0     1
0  42302     7
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7091892, 'recall': 0.5071724, 'specificity': 0.5071724, 'f1': 0.5062905, 'auroc': 0.9488193, 'binary_precision': 0.45, 'binary_recall': 0.014950166, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.028938908}
confusion matrix:
       0   1
0  18160  11
1    593   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.9994378, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_7.png
early stop counter: 5
val acc:0.9678261280059814, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9986613392829895
after epoch: 7,now: 2024-06-03 13:38:20.640709,epoch time: 0:19:32.729469,used: 2:18:15.767444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9985912, 'precision': 0.9992212, 'recall': 0.99272966, 'specificity': 0.99272966, 'f1': 0.99594855, 'auroc': 0.9997932, 'binary_precision': 1.0, 'binary_recall': 0.9854593, 'binary_specificity': 1.0, 'binary_f1_score': 0.99267644}
confusion matrix:
       0     1
0  42309     0
1     66  4473
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.5673427, 'recall': 0.501386, 'specificity': 0.501386, 'f1': 0.4949989, 'auroc': 0.9341921, 'binary_precision': 0.16666667, 'binary_recall': 0.003322259, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0065146578}
confusion matrix:
       0   1
0  18161  10
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.9999552, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_8.png
early stop counter: 6
val acc:0.9675065279006958, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9986613392829895
after epoch: 8,now: 2024-06-03 13:57:41.928832,epoch time: 0:19:21.288123,used: 2:37:37.055567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99876195, 'precision': 0.9990165, 'recall': 0.9939059, 'specificity': 0.9939059, 'f1': 0.9964446, 'auroc': 0.99978817, 'binary_precision': 0.9993314, 'binary_recall': 0.9878828, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99357414}
confusion matrix:
       0     1
0  42306     3
1     55  4484
---- Validation: 
scalar performance:
{'acc': 0.97251374, 'precision': 0.8030318, 'recall': 0.67261267, 'specificity': 0.67261267, 'f1': 0.7184839, 'auroc': 0.9326286, 'binary_precision': 0.62721896, 'binary_recall': 0.35215947, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.45106384}
confusion matrix:
       0    1
0  18045  126
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.99993813, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_9.png
early stop counter: 7
val acc:0.972513735294342, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9986613392829895
after epoch: 9,now: 2024-06-03 14:17:06.589930,epoch time: 0:19:24.661098,used: 2:57:01.716665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99933827, 'precision': 0.9996339, 'recall': 0.99658513, 'specificity': 0.99658513, 'f1': 0.9981036, 'auroc': 0.9999118, 'binary_precision': 1.0, 'binary_recall': 0.9931703, 'binary_specificity': 1.0, 'binary_f1_score': 0.9965735}
confusion matrix:
       0     1
0  42309     0
1     31  4508
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.8760581, 'recall': 0.5699376, 'specificity': 0.5699376, 'f1': 0.61220634, 'auroc': 0.9578657, 'binary_precision': 0.7798165, 'binary_recall': 0.14119601, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.23909986}
confusion matrix:
       0   1
0  18147  24
1    517  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.99977374, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_10.png
new oracle model saved
early stop counter: 8
val acc:0.9711819887161255, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9974713921546936 / 0.9989588260650635
after epoch: 10,now: 2024-06-03 14:36:31.470595,epoch time: 0:19:24.880665,used: 3:16:26.597330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99918884, 'precision': 0.99925387, 'recall': 0.99610907, 'specificity': 0.99610907, 'f1': 0.9976752, 'auroc': 0.99982464, 'binary_precision': 0.9993344, 'binary_recall': 0.99228907, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9957993}
confusion matrix:
       0     1
0  42306     3
1     35  4504
---- Validation: 
scalar performance:
{'acc': 0.97331274, 'precision': 0.89228034, 'recall': 0.6087816, 'specificity': 0.6087816, 'f1': 0.66573846, 'auroc': 0.94205153, 'binary_precision': 0.80981594, 'binary_recall': 0.2192691, 'binary_specificity': 0.998294, 'binary_f1_score': 0.34509805}
confusion matrix:
       0    1
0  18140   31
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.9999049, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_11.png
better model found
persisted
after epoch: 11,now: 2024-06-03 14:56:09.886410,epoch time: 0:19:38.415815,used: 3:36:05.013145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99814296, 'precision': 0.99897397, 'recall': 0.99041426, 'specificity': 0.99041426, 'f1': 0.99464726, 'auroc': 0.99985385, 'binary_precision': 1.0, 'binary_recall': 0.9808286, 'binary_specificity': 1.0, 'binary_f1_score': 0.9903215}
confusion matrix:
       0     1
0  42310     0
1     87  4451
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.784042, 'recall': 0.50243664, 'specificity': 0.50243664, 'f1': 0.49680728, 'auroc': 0.9525343, 'binary_precision': 0.6, 'binary_recall': 0.004983389, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.00988468}
confusion matrix:
       0  1
0  18169  2
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.99995935, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_12.png
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 12,now: 2024-06-03 15:15:36.247561,epoch time: 0:19:26.361151,used: 3:55:31.374296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9990181, 'precision': 0.999457, 'recall': 0.9949328, 'specificity': 0.9949328, 'f1': 0.99718183, 'auroc': 0.9998826, 'binary_precision': 1.0, 'binary_recall': 0.9898656, 'binary_specificity': 1.0, 'binary_f1_score': 0.994907}
confusion matrix:
       0     1
0  42309     0
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.90165997, 'recall': 0.5330025, 'specificity': 0.5330025, 'f1': 0.55381405, 'auroc': 0.9472692, 'binary_precision': 0.8333333, 'binary_recall': 0.06644518, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.12307692}
confusion matrix:
       0   1
0  18163   8
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.9999968, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_13.png
early stop counter: 2
val acc:0.9696372747421265, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 13,now: 2024-06-03 15:35:05.878222,epoch time: 0:19:29.630661,used: 4:15:01.004957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9992529, 'precision': 0.9995867, 'recall': 0.99614453, 'specificity': 0.99614453, 'f1': 0.9978581, 'auroc': 0.99987435, 'binary_precision': 1.0, 'binary_recall': 0.99228907, 'binary_specificity': 1.0, 'binary_f1_score': 0.99612963}
confusion matrix:
       0     1
0  42309     0
1     35  4504
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6924227, 'recall': 0.5039602, 'specificity': 0.5039602, 'f1': 0.49996617, 'auroc': 0.9323753, 'binary_precision': 0.41666666, 'binary_recall': 0.008305647, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.016286645}
confusion matrix:
       0  1
0  18164  7
1    597  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.99977446, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_14.png
early stop counter: 3
val acc:0.9678261280059814, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 14,now: 2024-06-03 15:54:56.098015,epoch time: 0:19:50.219793,used: 4:34:51.224750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9989114, 'precision': 0.9991989, 'recall': 0.9945775, 'specificity': 0.9945775, 'f1': 0.9968746, 'auroc': 0.99976206, 'binary_precision': 0.9995547, 'binary_recall': 0.9892023, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99435157}
confusion matrix:
       0     1
0  42308     2
1     49  4489
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.9017887, 'recall': 0.53712773, 'specificity': 0.53712773, 'f1': 0.5609261, 'auroc': 0.9349627, 'binary_precision': 0.8333333, 'binary_recall': 0.07475083, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.13719513}
confusion matrix:
       0   1
0  18162   9
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.999992, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_15.png
early stop counter: 4
val acc:0.9698503017425537, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 15,now: 2024-06-03 16:14:53.169974,epoch time: 0:19:57.071959,used: 4:54:48.296709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99884737, 'precision': 0.99936265, 'recall': 0.9940516, 'specificity': 0.9940516, 'f1': 0.9966891, 'auroc': 0.99973345, 'binary_precision': 1.0, 'binary_recall': 0.9881031, 'binary_specificity': 1.0, 'binary_f1_score': 0.99401593}
confusion matrix:
       0     1
0  42309     0
1     54  4485
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.92552817, 'recall': 0.5124034, 'specificity': 0.5124034, 'f1': 0.51625746, 'auroc': 0.9374373, 'binary_precision': 0.88235295, 'binary_recall': 0.024916943, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.048465267}
confusion matrix:
       0   1
0  18169   2
1    587  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961327, 'precision': 0.9978416, 'recall': 0.9820937, 'specificity': 0.9820937, 'f1': 0.98980206, 'auroc': 0.9995289, 'binary_precision': 1.0, 'binary_recall': 0.9641873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9817672}
confusion matrix:
      0    1
0  5997    0
1    26  700
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_16.png
early stop counter: 5
val acc:0.9686251282691956, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 16,now: 2024-06-03 16:34:25.620098,epoch time: 0:19:32.450124,used: 5:14:20.746833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99763066, 'precision': 0.99327826, 'recall': 0.9931812, 'specificity': 0.9931812, 'f1': 0.99322975, 'auroc': 0.9996632, 'binary_precision': 0.9878801, 'binary_recall': 0.9876625, 'binary_specificity': 0.9987, 'binary_f1_score': 0.98777133}
confusion matrix:
       0     1
0  42254    55
1     56  4483
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.8072385, 'recall': 0.6336536, 'specificity': 0.6336536, 'f1': 0.68368274, 'auroc': 0.94952416, 'binary_precision': 0.6381323, 'binary_recall': 0.27242523, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.38183933}
confusion matrix:
       0    1
0  18078   93
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.9999087, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_17.png
early stop counter: 6
val acc:0.9717146754264832, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 17,now: 2024-06-03 16:53:49.778419,epoch time: 0:19:24.158321,used: 5:33:44.905154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9989114, 'precision': 0.99929845, 'recall': 0.9944791, 'specificity': 0.9944791, 'f1': 0.9968739, 'auroc': 0.9998208, 'binary_precision': 0.99977726, 'binary_recall': 0.9889819, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99435025}
confusion matrix:
       0     1
0  42309     1
1     50  4488
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.86563087, 'recall': 0.5443827, 'specificity': 0.5443827, 'f1': 0.5725763, 'auroc': 0.942739, 'binary_precision': 0.7605634, 'binary_recall': 0.089701, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.16047548}
confusion matrix:
       0   1
0  18154  17
1    548  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.999944, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_18.png
early stop counter: 7
val acc:0.9699035882949829, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 18,now: 2024-06-03 17:15:08.835365,epoch time: 0:21:19.056946,used: 5:55:03.962100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9990395, 'precision': 0.9988737, 'recall': 0.995633, 'specificity': 0.995633, 'f1': 0.9972466, 'auroc': 0.9997803, 'binary_precision': 0.99866843, 'binary_recall': 0.9914078, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99502486}
confusion matrix:
       0     1
0  42303     6
1     39  4500
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.82439834, 'recall': 0.5138995, 'specificity': 0.5138995, 'f1': 0.5190821, 'auroc': 0.93162423, 'binary_precision': 0.68, 'binary_recall': 0.028239202, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.054226473}
confusion matrix:
       0   1
0  18163   8
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9972531, 'recall': 0.9942402, 'specificity': 0.9942402, 'f1': 0.99574065, 'auroc': 0.9999736, 'binary_precision': 0.9958391, 'binary_recall': 0.9889807, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.992398}
confusion matrix:
      0    1
0  5994    3
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_19.png
early stop counter: 8
val acc:0.9684121012687683, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 19,now: 2024-06-03 18:43:02.014886,epoch time: 1:27:53.179521,used: 7:22:57.141621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9991035, 'precision': 0.99950415, 'recall': 0.9953724, 'specificity': 0.9953724, 'f1': 0.9974274, 'auroc': 0.99984205, 'binary_precision': 1.0, 'binary_recall': 0.9907448, 'binary_specificity': 1.0, 'binary_f1_score': 0.9953509}
confusion matrix:
       0     1
0  42310     0
1     42  4496
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.90398824, 'recall': 0.52145714, 'specificity': 0.52145714, 'f1': 0.53320444, 'auroc': 0.9468564, 'binary_precision': 0.83870965, 'binary_recall': 0.04318937, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.0821485}
confusion matrix:
       0   1
0  18166   5
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.99883544, 'recall': 0.9903581, 'specificity': 0.9903581, 'f1': 0.99454916, 'auroc': 0.99986845, 'binary_precision': 1.0, 'binary_recall': 0.9807162, 'binary_specificity': 1.0, 'binary_f1_score': 0.99026424}
confusion matrix:
      0    1
0  5997    0
1    14  712
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_20.png
early stop counter: 9
val acc:0.9690513014793396, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 20,now: 2024-06-03 19:08:39.266603,epoch time: 0:25:37.251717,used: 7:48:34.393338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9993596, 'precision': 0.99954665, 'recall': 0.9967936, 'specificity': 0.9967936, 'f1': 0.9981653, 'auroc': 0.9999233, 'binary_precision': 0.99977833, 'binary_recall': 0.9936109, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9966851}
confusion matrix:
       0     1
0  42308     1
1     29  4510
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.844425, 'recall': 0.5147576, 'specificity': 0.5147576, 'f1': 0.5207041, 'auroc': 0.9336056, 'binary_precision': 0.72, 'binary_recall': 0.029900333, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.05741627}
confusion matrix:
       0   1
0  18164   7
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.99999106, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_21.png
early stop counter: 10
val acc:0.9685186147689819, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 21,now: 2024-06-03 19:32:19.025053,epoch time: 0:23:39.758450,used: 8:12:14.151788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99852717, 'precision': 0.9989859, 'recall': 0.9925959, 'specificity': 0.9925959, 'f1': 0.9957648, 'auroc': 0.9996047, 'binary_precision': 0.99955297, 'binary_recall': 0.985239, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9923444}
confusion matrix:
       0     1
0  42307     2
1     67  4472
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.81882817, 'recall': 0.54900837, 'specificity': 0.54900837, 'f1': 0.57894486, 'auroc': 0.9086141, 'binary_precision': 0.6666667, 'binary_recall': 0.09966777, 'binary_specificity': 0.998349, 'binary_f1_score': 0.1734104}
confusion matrix:
       0   1
0  18141  30
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99734956, 'recall': 0.98950267, 'specificity': 0.98950267, 'f1': 0.9933852, 'auroc': 0.99981785, 'binary_precision': 0.99719495, 'binary_recall': 0.9793388, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9881862}
confusion matrix:
      0    1
0  5995    2
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_22.png
early stop counter: 11
val acc:0.9695307016372681, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 22,now: 2024-06-03 19:53:07.676801,epoch time: 0:20:48.651748,used: 8:33:02.803536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9978441, 'precision': 0.9984063, 'recall': 0.9892652, 'specificity': 0.9892652, 'f1': 0.99378216, 'auroc': 0.9997009, 'binary_precision': 0.9991001, 'binary_recall': 0.97862494, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.98875654}
confusion matrix:
       0     1
0  42306     4
1     97  4441
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7232007, 'recall': 0.524812, 'specificity': 0.524812, 'f1': 0.5382742, 'auroc': 0.9015174, 'binary_precision': 0.47692308, 'binary_recall': 0.051495016, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.092953525}
confusion matrix:
       0   1
0  18137  34
1    571  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.9977144, 'recall': 0.9868312, 'specificity': 0.9868312, 'f1': 0.992194, 'auroc': 0.99916506, 'binary_precision': 0.99858755, 'binary_recall': 0.9738292, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.986053}
confusion matrix:
      0    1
0  5996    1
1    19  707
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_23.png
early stop counter: 12
val acc:0.9677728414535522, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 23,now: 2024-06-03 20:13:02.258591,epoch time: 0:19:54.581790,used: 8:52:57.385326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9986552, 'precision': 0.9989572, 'recall': 0.99335515, 'specificity': 0.99335515, 'f1': 0.9961361, 'auroc': 0.9999051, 'binary_precision': 0.99933064, 'binary_recall': 0.98678124, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99301624}
confusion matrix:
       0     1
0  42306     3
1     60  4479
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.8142483, 'recall': 0.52367365, 'specificity': 0.52367365, 'f1': 0.5369242, 'auroc': 0.94235444, 'binary_precision': 0.65909094, 'binary_recall': 0.048172757, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.08978328}
confusion matrix:
       0   1
0  18156  15
1    573  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.9971797, 'recall': 0.98812526, 'specificity': 0.98812526, 'f1': 0.99259794, 'auroc': 0.9993679, 'binary_precision': 0.9971871, 'binary_recall': 0.976584, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.986778}
confusion matrix:
      0    1
0  5995    2
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_24.png
early stop counter: 13
val acc:0.9686784148216248, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 24,now: 2024-06-03 20:33:58.963215,epoch time: 0:20:56.704624,used: 9:13:54.089950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99933827, 'precision': 0.9988439, 'recall': 0.9973713, 'specificity': 0.9973713, 'f1': 0.99810624, 'auroc': 0.9998867, 'binary_precision': 0.9982313, 'binary_recall': 0.9949317, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.99657875}
confusion matrix:
       0     1
0  42302     8
1     23  4515
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.61577964, 'recall': 0.5075352, 'specificity': 0.5075352, 'f1': 0.5072253, 'auroc': 0.93347937, 'binary_precision': 0.2631579, 'binary_recall': 0.016611295, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.031249996}
confusion matrix:
       0   1
0  18143  28
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.99964345, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_25.png
early stop counter: 14
val acc:0.9669738411903381, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 25,now: 2024-06-03 20:56:21.169034,epoch time: 0:22:22.205819,used: 9:36:16.295769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9978868, 'precision': 0.99220324, 'recall': 0.99578154, 'specificity': 0.99578154, 'f1': 0.99398416, 'auroc': 0.9998236, 'binary_precision': 0.98513985, 'binary_recall': 0.9931703, 'binary_specificity': 0.99839276, 'binary_f1_score': 0.98913884}
confusion matrix:
       0     1
0  42241    68
1     31  4508
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.5256494, 'recall': 0.5005279, 'specificity': 0.5005279, 'f1': 0.49334317, 'auroc': 0.9294337, 'binary_precision': 0.083333336, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0032573289}
confusion matrix:
       0   1
0  18160  11
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9949552, 'recall': 0.9973503, 'specificity': 0.9973503, 'f1': 0.99614894, 'auroc': 0.99992573, 'binary_precision': 0.990411, 'binary_recall': 0.9958678, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.9931319}
confusion matrix:
      0    1
0  5990    7
1     3  723
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_26.png
early stop counter: 15
val acc:0.9674000144004822, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 26,now: 2024-06-03 21:18:00.088582,epoch time: 0:21:38.919548,used: 9:57:55.215317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.9994334, 'recall': 0.99471134, 'specificity': 0.99471134, 'f1': 0.99705815, 'auroc': 0.99989253, 'binary_precision': 1.0, 'binary_recall': 0.9894227, 'binary_specificity': 1.0, 'binary_f1_score': 0.9946832}
confusion matrix:
       0     1
0  42310     0
1     48  4490
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73411596, 'recall': 0.50481826, 'specificity': 0.50481826, 'f1': 0.5016219, 'auroc': 0.94319487, 'binary_precision': 0.5, 'binary_recall': 0.009966778, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.019543974}
confusion matrix:
       0  1
0  18165  6
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.9992312, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_27.png
early stop counter: 16
val acc:0.9679326415061951, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 27,now: 2024-06-03 21:37:52.059997,epoch time: 0:19:51.971415,used: 10:17:47.186732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9989754, 'precision': 0.9994334, 'recall': 0.9947125, 'specificity': 0.9947125, 'f1': 0.99705875, 'auroc': 0.9999512, 'binary_precision': 1.0, 'binary_recall': 0.989425, 'binary_specificity': 1.0, 'binary_f1_score': 0.9946844}
confusion matrix:
       0     1
0  42309     0
1     48  4491
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.9286163, 'recall': 0.506617, 'specificity': 0.506617, 'f1': 0.50503856, 'auroc': 0.9464022, 'binary_precision': 0.8888889, 'binary_recall': 0.013289036, 'binary_specificity': 0.999945, 'binary_f1_score': 0.026186578}
confusion matrix:
       0  1
0  18170  1
1    594  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.9999598, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_28.png
early stop counter: 17
val acc:0.9683055281639099, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 28,now: 2024-06-03 21:59:08.064164,epoch time: 0:21:16.004167,used: 10:39:03.190899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99927425, 'precision': 0.9994993, 'recall': 0.99635136, 'specificity': 0.99635136, 'f1': 0.9979191, 'auroc': 0.9999753, 'binary_precision': 0.99977803, 'binary_recall': 0.99272645, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9962398}
confusion matrix:
       0     1
0  42310     1
1     33  4504
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.93845904, 'recall': 0.532282, 'specificity': 0.532282, 'f1': 0.5527824, 'auroc': 0.9510125, 'binary_precision': 0.90697676, 'binary_recall': 0.06478405, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.12093023}
confusion matrix:
       0   1
0  18167   4
1    563  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9999351, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_29.png
early stop counter: 18
val acc:0.9697970747947693, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 29,now: 2024-06-03 22:19:14.905082,epoch time: 0:20:06.840918,used: 10:59:10.031817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99585897, 'precision': 0.9977178, 'recall': 0.97862965, 'specificity': 0.97862965, 'f1': 0.9879378, 'auroc': 0.99514306, 'binary_precision': 1.0, 'binary_recall': 0.9572593, 'binary_specificity': 1.0, 'binary_f1_score': 0.978163}
confusion matrix:
       0     1
0  42309     0
1    194  4345
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.9445584, 'recall': 0.519048, 'specificity': 0.519048, 'f1': 0.528814, 'auroc': 0.9576611, 'binary_precision': 0.92, 'binary_recall': 0.03820598, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.073365234}
confusion matrix:
       0   1
0  18169   2
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9930091, 'precision': 0.99611187, 'recall': 0.96763086, 'specificity': 0.96763086, 'f1': 0.9813223, 'auroc': 0.9959121, 'binary_precision': 1.0, 'binary_recall': 0.9352617, 'binary_specificity': 1.0, 'binary_f1_score': 0.966548}
confusion matrix:
      0    1
0  5997    0
1    47  679
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054737_30.png
early stop counter: 19
val acc:0.9690513014793396, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9989588260650635 / 0.9989588260650635
after epoch: 30,now: 2024-06-03 22:38:51.714161,epoch time: 0:19:36.809079,used: 11:18:46.840896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_11_20_04_seed_2_21054737
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:18:46.840896 at 2024-06-03 22:38:51.714161
persisted model performance metric: 

scalar performance:
{'acc': 0.99881005, 'precision': 0.99933386, 'recall': 0.9944904, 'specificity': 0.9944904, 'f1': 0.9968966, 'auroc': 0.9999474, 'binary_precision': 1.0, 'binary_recall': 0.9889807, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944598}
confusion matrix:
      0    1
0  5997    0
1     8  718
oracle model performance metric: 

scalar performance:
{'acc': 0.9989588, 'precision': 0.99941707, 'recall': 0.99517906, 'specificity': 0.99517906, 'f1': 0.9972862, 'auroc': 0.9999676, 'binary_precision': 1.0, 'binary_recall': 0.9903581, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951557}
confusion matrix:
      0    1
0  5997    0
1     7  719
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |   2753 TiB |   2753 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   2718 TiB |   2718 TiB |
|       from small pool |      6 MiB |     11 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |   2753 TiB |   2753 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   2718 TiB |   2718 TiB |
|       from small pool |      6 MiB |     11 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   2748 TiB |   2748 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   2713 TiB |   2713 TiB |
|       from small pool |      5 MiB |      9 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3482 MiB |   3498 MiB |   6634 MiB |   3152 MiB |
|       from large pool |   3470 MiB |   3486 MiB |   6618 MiB |   3148 MiB |
|       from small pool |     12 MiB |     12 MiB |     16 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 221719 KiB | 302912 KiB |   1559 TiB |   1559 TiB |
|       from large pool | 218256 KiB | 298672 KiB |   1524 TiB |   1524 TiB |
|       from small pool |   3463 KiB |   9278 KiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6719    |  439330 K  |  439326 K  |
|       from large pool |     247    |     352    |  170447 K  |  170447 K  |
|       from small pool |    3293    |    6471    |  268882 K  |  268879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6719    |  439330 K  |  439326 K  |
|       from large pool |     247    |     352    |  170447 K  |  170447 K  |
|       from small pool |    3293    |    6471    |  268882 K  |  268879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     139    |     229    |      90    |
|       from large pool |     133    |     133    |     221    |      88    |
|       from small pool |       6    |       6    |       8    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |    3014    |  218735 K  |  218735 K  |
|       from large pool |      77    |     118    |  105672 K  |  105672 K  |
|       from small pool |      17    |    2937    |  113063 K  |  113063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   2753 TiB |   2753 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   2718 TiB |   2718 TiB |
|       from small pool |      0 KiB |     11 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   2753 TiB |   2753 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   2718 TiB |   2718 TiB |
|       from small pool |      0 KiB |     11 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   2748 TiB |   2748 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   2713 TiB |   2713 TiB |
|       from small pool |      0 KiB |      9 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |   3498 MiB |   6634 MiB |   4748 MiB |
|       from large pool |   1876 MiB |   3486 MiB |   6618 MiB |   4742 MiB |
|       from small pool |     10 MiB |     12 MiB |     16 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 302912 KiB |   1559 TiB |   1559 TiB |
|       from large pool |  24320 KiB | 298672 KiB |   1524 TiB |   1524 TiB |
|       from small pool |      0 KiB |   9310 KiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6719    |  439330 K  |  439330 K  |
|       from large pool |       2    |     352    |  170447 K  |  170447 K  |
|       from small pool |       0    |    6471    |  268882 K  |  268882 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6719    |  439330 K  |  439330 K  |
|       from large pool |       2    |     352    |  170447 K  |  170447 K  |
|       from small pool |       0    |    6471    |  268882 K  |  268882 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     139    |     229    |     136    |
|       from large pool |      88    |     133    |     221    |     133    |
|       from small pool |       5    |       6    |       8    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3014    |  218737 K  |  218737 K  |
|       from large pool |       3    |     118    |  105672 K  |  105672 K  |
|       from small pool |       0    |    2937    |  113065 K  |  113065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 22:40:24 2024]
Finished job 0.
1 of 1 steps (100%) done
