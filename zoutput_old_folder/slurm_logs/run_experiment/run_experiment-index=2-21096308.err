Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun  4 18:41:36 2024]
rule parameter_sampling:
    input: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/conf/CAMELYON_benchmark.yaml
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    jobid: 1
    reason: Missing output files: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv; Updated input files: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/conf/CAMELYON_benchmark.yaml
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal




!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
[Tue Jun  4 18:42:33 2024]
Finished job 1.
1 of 2 steps (50%) done
Select jobs to execute...

[Tue Jun  4 18:42:33 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
    jobid: 0
    reason: Input files updated by another job: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308

 Experiment start at: 2024-06-04 18:52:58.981881
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9705654, 'precision': 0.79456306, 'recall': 0.6664195, 'specificity': 0.6664195, 'f1': 0.7111255, 'auroc': 0.9473752, 'binary_precision': 0.61172163, 'binary_recall': 0.34035325, 'binary_specificity': 0.9924858, 'binary_f1_score': 0.4373636}
confusion matrix:
       0    1
0  42002  318
1    971  501
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9683908, 'precision': 0.8331074, 'recall': 0.56660473, 'specificity': 0.56660473, 'f1': 0.60521406, 'auroc': 0.94887424, 'binary_precision': 0.696, 'binary_recall': 0.13530326, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.22656249}
confusion matrix:
       0   1
0  18111  38
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7799421, 'recall': 0.56321645, 'specificity': 0.56321645, 'f1': 0.5966706, 'auroc': 0.930882, 'binary_precision': 0.5964912, 'binary_recall': 0.1302682, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.21383649}
confusion matrix:
      0   1
0  5974  23
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-04 19:21:54.840254,epoch time: 0:28:55.858373,used: 0:28:55.858373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96873856, 'precision': 0.757738, 'recall': 0.842419, 'specificity': 0.842419, 'f1': 0.79340094, 'auroc': 0.96151316, 'binary_precision': 0.5257836, 'binary_recall': 0.70700204, 'binary_specificity': 0.9778361, 'binary_f1_score': 0.60307336}
confusion matrix:
       0     1
0  41383   938
1    431  1040
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.749714, 'recall': 0.8380208, 'specificity': 0.8380208, 'f1': 0.7864156, 'auroc': 0.9599597, 'binary_precision': 0.5102041, 'binary_recall': 0.6998445, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.59016395}
confusion matrix:
       0    1
0  17717  432
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.8945091, 'recall': 0.81275696, 'specificity': 0.81275696, 'f1': 0.8484341, 'auroc': 0.95305365, 'binary_precision': 0.80487806, 'binary_recall': 0.6321839, 'binary_specificity': 0.99333, 'binary_f1_score': 0.7081545}
confusion matrix:
      0    1
0  5957   40
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_2.png
new oracle model saved
early stop counter: 1
val acc:0.966741144657135, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9600511193275452 / 0.9782677888870239
after epoch: 2,now: 2024-06-04 19:49:43.522497,epoch time: 0:27:48.682243,used: 0:56:44.540616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9764569, 'precision': 0.8409774, 'recall': 0.7589792, 'specificity': 0.7589792, 'f1': 0.79389703, 'auroc': 0.96898663, 'binary_precision': 0.6982837, 'binary_recall': 0.52585036, 'binary_specificity': 0.9921081, 'binary_f1_score': 0.5999224}
confusion matrix:
       0    1
0  41988  334
1    697  773
---- Validation: 
scalar performance:
{'acc': 0.9744572, 'precision': 0.88996077, 'recall': 0.66650254, 'specificity': 0.66650254, 'f1': 0.73029757, 'auroc': 0.9658309, 'binary_precision': 0.802974, 'binary_recall': 0.33592534, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.4736842}
confusion matrix:
       0    1
0  18096   53
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.9090643, 'recall': 0.67674357, 'specificity': 0.67674357, 'f1': 0.7430576, 'auroc': 0.95538735, 'binary_precision': 0.8454546, 'binary_recall': 0.35632184, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5013478}
confusion matrix:
      0   1
0  5980  17
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_3.png
better model found
persisted
after epoch: 3,now: 2024-06-04 20:17:41.172769,epoch time: 0:27:57.650272,used: 1:24:42.190888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97842073, 'precision': 0.8692142, 'recall': 0.7622844, 'specificity': 0.7622844, 'f1': 0.8059739, 'auroc': 0.973346, 'binary_precision': 0.7545894, 'binary_recall': 0.5305706, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.6230554}
confusion matrix:
       0    1
0  42066  254
1    691  781
---- Validation: 
scalar performance:
{'acc': 0.97530866, 'precision': 0.8959136, 'recall': 0.67894423, 'specificity': 0.67894423, 'f1': 0.7436709, 'auroc': 0.9704275, 'binary_precision': 0.81403506, 'binary_recall': 0.3608087, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.49999994}
confusion matrix:
       0    1
0  18096   53
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8924199, 'recall': 0.67257863, 'specificity': 0.67257863, 'f1': 0.7361032, 'auroc': 0.9527612, 'binary_precision': 0.8125, 'binary_recall': 0.348659, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.48793563}
confusion matrix:
      0   1
0  5976  21
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_4.png
better model found
persisted
after epoch: 4,now: 2024-06-04 20:45:53.578426,epoch time: 0:28:12.405657,used: 1:52:54.596545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.979905, 'precision': 0.8783914, 'recall': 0.7827239, 'specificity': 0.7827239, 'f1': 0.82308406, 'auroc': 0.97600025, 'binary_precision': 0.77155966, 'binary_recall': 0.5713315, 'binary_specificity': 0.99411625, 'binary_f1_score': 0.65651834}
confusion matrix:
       0    1
0  42071  249
1    631  841
---- Validation: 
scalar performance:
{'acc': 0.9786611, 'precision': 0.9236648, 'recall': 0.7211828, 'specificity': 0.7211828, 'f1': 0.78845984, 'auroc': 0.9732209, 'binary_precision': 0.8666667, 'binary_recall': 0.44479004, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.58787256}
confusion matrix:
       0    1
0  18105   44
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8312641, 'recall': 0.55263937, 'specificity': 0.55263937, 'f1': 0.58299464, 'auroc': 0.9555701, 'binary_precision': 0.7, 'binary_recall': 0.107279696, 'binary_specificity': 0.997999, 'binary_f1_score': 0.18604651}
confusion matrix:
      0   1
0  5985  12
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_5.png
better model found
persisted
after epoch: 5,now: 2024-06-04 21:13:39.364134,epoch time: 0:27:45.785708,used: 2:20:40.382253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9803389, 'precision': 0.8698409, 'recall': 0.8051129, 'specificity': 0.8051129, 'f1': 0.8341154, 'auroc': 0.9741609, 'binary_precision': 0.75290215, 'binary_recall': 0.6172672, 'binary_specificity': 0.9929586, 'binary_f1_score': 0.6783713}
confusion matrix:
       0    1
0  42023  298
1    563  908
---- Validation: 
scalar performance:
{'acc': 0.9790868, 'precision': 0.862268, 'recall': 0.79715884, 'specificity': 0.79715884, 'f1': 0.82622373, 'auroc': 0.9685396, 'binary_precision': 0.7385496, 'binary_recall': 0.60186625, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.66323906}
confusion matrix:
       0    1
0  18012  137
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.92337, 'recall': 0.64850813, 'specificity': 0.64850813, 'f1': 0.7148841, 'auroc': 0.9588228, 'binary_precision': 0.8764045, 'binary_recall': 0.29885057, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.4457143}
confusion matrix:
      0   1
0  5986  11
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_6.png
better model found
persisted
after epoch: 6,now: 2024-06-04 21:41:12.889151,epoch time: 0:27:33.525017,used: 2:48:13.907270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9827366, 'precision': 0.8855233, 'recall': 0.83369565, 'specificity': 0.83369565, 'f1': 0.8575885, 'auroc': 0.9801489, 'binary_precision': 0.7823344, 'binary_recall': 0.67391306, 'binary_specificity': 0.99347824, 'binary_f1_score': 0.7240876}
confusion matrix:
       0    1
0  42044  276
1    480  992
---- Validation: 
scalar performance:
{'acc': 0.9795658, 'precision': 0.88757515, 'recall': 0.7711548, 'specificity': 0.7711548, 'f1': 0.81826854, 'auroc': 0.97185695, 'binary_precision': 0.7910112, 'binary_recall': 0.5474339, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.6470588}
confusion matrix:
       0    1
0  18056   93
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.85498166, 'recall': 0.62451917, 'specificity': 0.62451917, 'f1': 0.67961204, 'auroc': 0.9570296, 'binary_precision': 0.74157304, 'binary_recall': 0.25287357, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.37714285}
confusion matrix:
      0   1
0  5974  23
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_7.png
better model found
persisted
after epoch: 7,now: 2024-06-04 22:09:09.848025,epoch time: 0:27:56.958874,used: 3:16:10.866144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98364997, 'precision': 0.91945815, 'recall': 0.8089231, 'specificity': 0.8089231, 'f1': 0.8551774, 'auroc': 0.9815893, 'binary_precision': 0.8519553, 'binary_recall': 0.62160325, 'binary_specificity': 0.99624294, 'binary_f1_score': 0.71877456}
confusion matrix:
       0    1
0  42161  159
1    557  915
---- Validation: 
scalar performance:
{'acc': 0.9798318, 'precision': 0.9233676, 'recall': 0.7420404, 'specificity': 0.7420404, 'f1': 0.80626225, 'auroc': 0.97463214, 'binary_precision': 0.8646409, 'binary_recall': 0.4867807, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.6228856}
confusion matrix:
       0    1
0  18100   49
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.911217, 'recall': 0.61219305, 'specificity': 0.61219305, 'f1': 0.67008936, 'auroc': 0.95506614, 'binary_precision': 0.85507244, 'binary_recall': 0.22605364, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.35757574}
confusion matrix:
      0   1
0  5987  10
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_8.png
better model found
persisted
after epoch: 8,now: 2024-06-04 22:37:13.965779,epoch time: 0:28:04.117754,used: 3:44:14.983898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9810011, 'precision': 0.96363616, 'recall': 0.7301778, 'specificity': 0.7301778, 'f1': 0.8051741, 'auroc': 0.9839097, 'binary_precision': 0.94568247, 'binary_recall': 0.4612772, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.6200913}
confusion matrix:
       0    1
0  42281   39
1    793  679
---- Validation: 
scalar performance:
{'acc': 0.9792465, 'precision': 0.9410789, 'recall': 0.7199858, 'specificity': 0.7199858, 'f1': 0.79112685, 'auroc': 0.97510827, 'binary_precision': 0.9015873, 'binary_recall': 0.44167963, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.5929018}
confusion matrix:
       0    1
0  18118   31
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.96007776, 'recall': 0.5439779, 'specificity': 0.5439779, 'f1': 0.5709315, 'auroc': 0.95156264, 'binary_precision': 0.9583333, 'binary_recall': 0.08812261, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5996   1
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_9.png
early stop counter: 1
val acc:0.9792464971542358, best validation acc: 0.9798318147659302, corresponding to test acc:                         0.9661233425140381 / 0.9782677888870239
after epoch: 9,now: 2024-06-04 23:05:16.695715,epoch time: 0:28:02.729936,used: 4:12:17.713834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.981709, 'precision': 0.8467264, 'recall': 0.89178145, 'specificity': 0.89178145, 'f1': 0.8677499, 'auroc': 0.98296916, 'binary_precision': 0.7005988, 'binary_recall': 0.7953773, 'binary_specificity': 0.9881855, 'binary_f1_score': 0.74498564}
confusion matrix:
       0     1
0  41821   500
1    301  1170
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.8465547, 'recall': 0.87299085, 'specificity': 0.87299085, 'f1': 0.859241, 'auroc': 0.9760002, 'binary_precision': 0.7017291, 'binary_recall': 0.7573872, 'binary_specificity': 0.9885944, 'binary_f1_score': 0.7284966}
confusion matrix:
       0    1
0  17942  207
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8380296, 'recall': 0.63168174, 'specificity': 0.63168174, 'f1': 0.6853954, 'auroc': 0.9506257, 'binary_precision': 0.7070707, 'binary_recall': 0.26819924, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.38888893}
confusion matrix:
      0   1
0  5968  29
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_10.png
better model found
persisted
after epoch: 10,now: 2024-06-04 23:32:48.646850,epoch time: 0:27:31.951135,used: 4:39:49.664969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98362714, 'precision': 0.8741531, 'recall': 0.8734165, 'specificity': 0.8734165, 'f1': 0.8737844, 'auroc': 0.9846015, 'binary_precision': 0.756812, 'binary_recall': 0.7552685, 'binary_specificity': 0.99156445, 'binary_f1_score': 0.7560395}
confusion matrix:
       0     1
0  41964   357
1    360  1111
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.88640696, 'recall': 0.80342853, 'specificity': 0.80342853, 'f1': 0.8395209, 'auroc': 0.97135377, 'binary_precision': 0.78642714, 'binary_recall': 0.61275274, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.6888112}
confusion matrix:
       0    1
0  18042  107
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8818153, 'recall': 0.67232853, 'specificity': 0.67232853, 'f1': 0.7340312, 'auroc': 0.95923424, 'binary_precision': 0.79130435, 'binary_recall': 0.348659, 'binary_specificity': 0.995998, 'binary_f1_score': 0.48404253}
confusion matrix:
      0   1
0  5973  24
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_11.png
better model found
persisted
after epoch: 11,now: 2024-06-05 00:00:21.316911,epoch time: 0:27:32.670061,used: 5:07:22.335030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9861162, 'precision': 0.90413886, 'recall': 0.8754431, 'specificity': 0.8754431, 'f1': 0.8892197, 'auroc': 0.9862293, 'binary_precision': 0.81671554, 'binary_recall': 0.7567935, 'binary_specificity': 0.99409264, 'binary_f1_score': 0.7856136}
confusion matrix:
       0     1
0  42070   250
1    358  1114
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9020833, 'recall': 0.8432517, 'specificity': 0.8432517, 'f1': 0.8701564, 'auroc': 0.97270775, 'binary_precision': 0.8150183, 'binary_recall': 0.69206846, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7485282}
confusion matrix:
       0    1
0  18048  101
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.87847996, 'recall': 0.61360854, 'specificity': 0.61360854, 'f1': 0.66913277, 'auroc': 0.95805913, 'binary_precision': 0.7894737, 'binary_recall': 0.22988506, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3560831}
confusion matrix:
      0   1
0  5981  16
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_12.png
better model found
persisted
after epoch: 12,now: 2024-06-05 00:27:43.272678,epoch time: 0:27:21.955767,used: 5:34:44.290797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.9086803, 'recall': 0.88370156, 'specificity': 0.88370156, 'f1': 0.8957652, 'auroc': 0.9883224, 'binary_precision': 0.82523566, 'binary_recall': 0.7730978, 'binary_specificity': 0.9943053, 'binary_f1_score': 0.7983164}
confusion matrix:
       0     1
0  42079   241
1    334  1138
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.88533264, 'recall': 0.8702812, 'specificity': 0.8702812, 'f1': 0.87764406, 'auroc': 0.9786986, 'binary_precision': 0.7795786, 'binary_recall': 0.748056, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.76349205}
confusion matrix:
       0    1
0  18013  136
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8695172, 'recall': 0.68523824, 'specificity': 0.68523824, 'f1': 0.7439706, 'auroc': 0.9586655, 'binary_precision': 0.765625, 'binary_recall': 0.37547892, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.503856}
confusion matrix:
      0   1
0  5967  30
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_13.png
better model found
persisted
after epoch: 13,now: 2024-06-05 00:54:46.887103,epoch time: 0:27:03.614425,used: 6:01:47.905222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9861162, 'precision': 0.9270611, 'recall': 0.84572875, 'specificity': 0.84572875, 'f1': 0.8817902, 'auroc': 0.9887962, 'binary_precision': 0.8646362, 'binary_recall': 0.6952381, 'binary_specificity': 0.99621946, 'binary_f1_score': 0.7707391}
confusion matrix:
       0     1
0  42162   160
1    448  1022
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.895733, 'recall': 0.82761693, 'specificity': 0.82761693, 'f1': 0.8582064, 'auroc': 0.97568786, 'binary_precision': 0.80340266, 'binary_recall': 0.66096425, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.725256}
confusion matrix:
       0    1
0  18045  104
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.9555974, 'recall': 0.5687988, 'specificity': 0.5687988, 'f1': 0.611111, 'auroc': 0.9490795, 'binary_precision': 0.94736844, 'binary_recall': 0.13793103, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.24080269}
confusion matrix:
      0   1
0  5995   2
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_14.png
early stop counter: 1
val acc:0.982865035533905, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9691594839096069 / 0.9782677888870239
after epoch: 14,now: 2024-06-05 01:22:11.062910,epoch time: 0:27:24.175807,used: 6:29:12.081029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98732644, 'precision': 0.9342149, 'recall': 0.8600041, 'specificity': 0.8600041, 'f1': 0.89337945, 'auroc': 0.9893908, 'binary_precision': 0.87798846, 'binary_recall': 0.72350544, 'binary_specificity': 0.9965028, 'binary_f1_score': 0.7932961}
confusion matrix:
       0     1
0  42172   148
1    407  1065
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9344052, 'recall': 0.80724907, 'specificity': 0.80724907, 'f1': 0.8591236, 'auroc': 0.9785731, 'binary_precision': 0.88222224, 'binary_recall': 0.61741835, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.726441}
confusion matrix:
       0    1
0  18096   53
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.9093801, 'recall': 0.6292677, 'specificity': 0.6292677, 'f1': 0.6909946, 'auroc': 0.95839316, 'binary_precision': 0.85, 'binary_recall': 0.2605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.398827}
confusion matrix:
      0   1
0  5985  12
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_15.png
early stop counter: 2
val acc:0.9840889573097229, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9691594839096069 / 0.9782677888870239
after epoch: 15,now: 2024-06-05 01:49:37.009405,epoch time: 0:27:25.946495,used: 6:56:38.027524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9866186, 'precision': 0.9139459, 'recall': 0.87144077, 'specificity': 0.87144077, 'f1': 0.89145136, 'auroc': 0.9896122, 'binary_precision': 0.8366261, 'binary_recall': 0.74796194, 'binary_specificity': 0.99491966, 'binary_f1_score': 0.78981346}
confusion matrix:
       0     1
0  42105   215
1    371  1101
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.8984428, 'recall': 0.8292548, 'specificity': 0.8292548, 'f1': 0.8602928, 'auroc': 0.9747498, 'binary_precision': 0.8087121, 'binary_recall': 0.66407466, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7292912}
confusion matrix:
       0    1
0  18048  101
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.90712297, 'recall': 0.5855399, 'specificity': 0.5855399, 'f1': 0.6341333, 'auroc': 0.943757, 'binary_precision': 0.8490566, 'binary_recall': 0.1724138, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2866242}
confusion matrix:
      0   1
0  5989   8
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_16.png
early stop counter: 3
val acc:0.9831311106681824, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9691594839096069 / 0.9782677888870239
after epoch: 16,now: 2024-06-05 02:16:58.914623,epoch time: 0:27:21.905218,used: 7:23:59.932742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.976732, 'recall': 0.79991734, 'specificity': 0.79991734, 'f1': 0.86686766, 'auroc': 0.9926151, 'binary_precision': 0.9671773, 'binary_recall': 0.6005435, 'binary_specificity': 0.9992911, 'binary_f1_score': 0.7409891}
confusion matrix:
       0    1
0  42290   30
1    588  884
---- Validation: 
scalar performance:
{'acc': 0.98201364, 'precision': 0.9528091, 'recall': 0.7581711, 'specificity': 0.7581711, 'f1': 0.8270533, 'auroc': 0.97611344, 'binary_precision': 0.92243767, 'binary_recall': 0.5178849, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.6633466}
confusion matrix:
       0    1
0  18121   28
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.96747553, 'recall': 0.5650507, 'specificity': 0.5650507, 'f1': 0.6055359, 'auroc': 0.9496541, 'binary_precision': 0.9714286, 'binary_recall': 0.1302682, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.22972974}
confusion matrix:
      0   1
0  5996   1
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_17.png
early stop counter: 4
val acc:0.9820136427879333, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9691594839096069 / 0.9782677888870239
after epoch: 17,now: 2024-06-05 02:44:43.610185,epoch time: 0:27:44.695562,used: 7:51:44.628304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98792017, 'precision': 0.94092536, 'recall': 0.86317015, 'specificity': 0.86317015, 'f1': 0.89800644, 'auroc': 0.99093306, 'binary_precision': 0.891196, 'binary_recall': 0.72943574, 'binary_specificity': 0.9969046, 'binary_f1_score': 0.80224305}
confusion matrix:
       0     1
0  42190   131
1    398  1073
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.91518563, 'recall': 0.83677673, 'specificity': 0.83677673, 'f1': 0.87157106, 'auroc': 0.974969, 'binary_precision': 0.8416988, 'binary_recall': 0.67807156, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.7510767}
confusion matrix:
       0    1
0  18067   82
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.91932696, 'recall': 0.5666329, 'specificity': 0.5666329, 'f1': 0.6068235, 'auroc': 0.9584292, 'binary_precision': 0.875, 'binary_recall': 0.13409962, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.23255815}
confusion matrix:
      0   1
0  5992   5
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_18.png
better model found
persisted
after epoch: 18,now: 2024-06-05 03:12:30.288734,epoch time: 0:27:46.678549,used: 8:19:31.306853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98855954, 'precision': 0.9508995, 'recall': 0.8642486, 'specificity': 0.8642486, 'f1': 0.90262914, 'auroc': 0.99222994, 'binary_precision': 0.9110923, 'binary_recall': 0.73097825, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.81115717}
confusion matrix:
       0     1
0  42215   105
1    396  1076
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9382125, 'recall': 0.8065816, 'specificity': 0.8065816, 'f1': 0.8599154, 'auroc': 0.97434825, 'binary_precision': 0.88988763, 'binary_recall': 0.61586314, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.72794116}
confusion matrix:
       0    1
0  18100   49
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.9376868, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_19.png
early stop counter: 1
val acc:0.9842486381530762, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.963087260723114 / 0.9782677888870239
after epoch: 19,now: 2024-06-05 03:39:51.213530,epoch time: 0:27:20.924796,used: 8:46:52.231649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9877375, 'precision': 0.91865647, 'recall': 0.8864455, 'specificity': 0.8864455, 'f1': 0.9018551, 'auroc': 0.99105966, 'binary_precision': 0.84501845, 'binary_recall': 0.77785325, 'binary_specificity': 0.9950378, 'binary_f1_score': 0.810046}
confusion matrix:
       0     1
0  42110   210
1    327  1145
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.90218437, 'recall': 0.8139782, 'specificity': 0.8139782, 'f1': 0.85221815, 'auroc': 0.9685782, 'binary_precision': 0.8172691, 'binary_recall': 0.63297045, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.71340925}
confusion matrix:
       0    1
0  18058   91
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.91546756, 'recall': 0.5742124, 'specificity': 0.5742124, 'f1': 0.61811435, 'auroc': 0.92546564, 'binary_precision': 0.8666667, 'binary_recall': 0.14942528, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.25490195}
confusion matrix:
      0   1
0  5991   6
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_20.png
early stop counter: 2
val acc:0.9825989603996277, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.963087260723114 / 0.9782677888870239
after epoch: 20,now: 2024-06-05 04:07:15.172949,epoch time: 0:27:23.959419,used: 9:14:16.191068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9854768, 'precision': 0.97670585, 'recall': 0.7934753, 'specificity': 0.7934753, 'f1': 0.8618643, 'auroc': 0.9940177, 'binary_precision': 0.96756154, 'binary_recall': 0.5876359, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.7311919}
confusion matrix:
       0    1
0  42291   29
1    607  865
---- Validation: 
scalar performance:
{'acc': 0.98052365, 'precision': 0.9538171, 'recall': 0.7333979, 'specificity': 0.7333979, 'f1': 0.80595255, 'auroc': 0.9748942, 'binary_precision': 0.92615384, 'binary_recall': 0.4681182, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.6219008}
confusion matrix:
       0    1
0  18125   24
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.9343077, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_21.png
early stop counter: 3
val acc:0.9805236458778381, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.963087260723114 / 0.9782677888870239
after epoch: 21,now: 2024-06-05 04:34:48.965604,epoch time: 0:27:33.792655,used: 9:41:49.983723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9887879, 'precision': 0.90723985, 'recall': 0.9240371, 'specificity': 0.9240371, 'f1': 0.9154545, 'auroc': 0.9928905, 'binary_precision': 0.81954396, 'binary_recall': 0.85461956, 'binary_specificity': 0.99345464, 'binary_f1_score': 0.8367143}
confusion matrix:
       0     1
0  42043   277
1    214  1258
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.88980734, 'recall': 0.8704741, 'specificity': 0.8704741, 'f1': 0.8798739, 'auroc': 0.9780619, 'binary_precision': 0.78852457, 'binary_recall': 0.748056, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7677574}
confusion matrix:
       0    1
0  18020  129
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8763021, 'recall': 0.6173566, 'specificity': 0.6173566, 'f1': 0.673483, 'auroc': 0.9488691, 'binary_precision': 0.7848101, 'binary_recall': 0.23754789, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.36470586}
confusion matrix:
      0   1
0  5980  17
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_22.png
early stop counter: 4
val acc:0.9845147132873535, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.963087260723114 / 0.9782677888870239
after epoch: 22,now: 2024-06-05 05:02:18.692851,epoch time: 0:27:29.727247,used: 10:09:19.710970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99008954, 'precision': 0.92038137, 'recall': 0.9286449, 'specificity': 0.9286449, 'f1': 0.9244696, 'auroc': 0.99388534, 'binary_precision': 0.8455393, 'binary_recall': 0.86277175, 'binary_specificity': 0.994518, 'binary_f1_score': 0.8540686}
confusion matrix:
       0     1
0  42088   232
1    202  1270
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.90100914, 'recall': 0.8563057, 'specificity': 0.8563057, 'f1': 0.87722903, 'auroc': 0.9785051, 'binary_precision': 0.8119508, 'binary_recall': 0.718507, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.76237625}
confusion matrix:
       0    1
0  18042  107
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7976877, 'recall': 0.58587146, 'specificity': 0.58587146, 'f1': 0.6277919, 'auroc': 0.9202975, 'binary_precision': 0.63013697, 'binary_recall': 0.17624521, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.2754491}
confusion matrix:
      0   1
0  5970  27
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_23.png
better model found
persisted
after epoch: 23,now: 2024-06-05 05:29:18.554344,epoch time: 0:26:59.861493,used: 10:36:19.572463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9895415, 'precision': 0.9351648, 'recall': 0.8985261, 'specificity': 0.8985261, 'f1': 0.9159775, 'auroc': 0.9934615, 'binary_precision': 0.87723213, 'binary_recall': 0.80095106, 'binary_specificity': 0.99610114, 'binary_f1_score': 0.83735794}
confusion matrix:
       0     1
0  42155   165
1    293  1179
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.9157131, 'recall': 0.8460529, 'specificity': 0.8460529, 'f1': 0.8774451, 'auroc': 0.9792887, 'binary_precision': 0.84210527, 'binary_recall': 0.6967341, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7625532}
confusion matrix:
       0    1
0  18065   84
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.83100665, 'recall': 0.56954724, 'specificity': 0.56954724, 'f1': 0.6079999, 'auroc': 0.9449054, 'binary_precision': 0.6981132, 'binary_recall': 0.14176245, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2356688}
confusion matrix:
      0   1
0  5981  16
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_24.png
better model found
persisted
after epoch: 24,now: 2024-06-05 05:56:18.130688,epoch time: 0:26:59.576344,used: 11:03:19.148807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9890848, 'precision': 0.9487591, 'recall': 0.8753397, 'specificity': 0.8753397, 'f1': 0.90853465, 'auroc': 0.99438393, 'binary_precision': 0.90604573, 'binary_recall': 0.75339675, 'binary_specificity': 0.9972826, 'binary_f1_score': 0.82270026}
confusion matrix:
       0     1
0  42205   115
1    363  1109
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9252051, 'recall': 0.8332468, 'specificity': 0.8332468, 'f1': 0.87322223, 'auroc': 0.98044205, 'binary_precision': 0.862, 'binary_recall': 0.6702955, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7541557}
confusion matrix:
       0    1
0  18080   69
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8904933, 'recall': 0.615691, 'specificity': 0.615691, 'f1': 0.67276275, 'auroc': 0.9365395, 'binary_precision': 0.81333333, 'binary_recall': 0.23371647, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.36309525}
confusion matrix:
      0   1
0  5983  14
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_25.png
early stop counter: 1
val acc:0.9850468039512634, best validation acc: 0.9851532578468323, corresponding to test acc:                         0.9616490602493286 / 0.9782677888870239
after epoch: 25,now: 2024-06-05 06:23:25.250651,epoch time: 0:27:07.119963,used: 11:30:26.268770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9911171, 'precision': 0.93466705, 'recall': 0.9275372, 'specificity': 0.9275372, 'f1': 0.9310703, 'auroc': 0.9957005, 'binary_precision': 0.8742225, 'binary_recall': 0.859375, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.86673516}
confusion matrix:
       0     1
0  42138   182
1    207  1265
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9078988, 'recall': 0.8735232, 'specificity': 0.8735232, 'f1': 0.88989246, 'auroc': 0.9799032, 'binary_precision': 0.8245315, 'binary_recall': 0.7527216, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.78699183}
confusion matrix:
       0    1
0  18046  103
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.9072319, 'recall': 0.63493145, 'specificity': 0.63493145, 'f1': 0.6974576, 'auroc': 0.933534, 'binary_precision': 0.8452381, 'binary_recall': 0.27203065, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.41159418}
confusion matrix:
      0   1
0  5984  13
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_26.png
better model found
persisted
after epoch: 26,now: 2024-06-05 06:50:38.234182,epoch time: 0:27:12.983531,used: 11:57:39.252301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.9043678, 'recall': 0.948467, 'specificity': 0.948467, 'f1': 0.925179, 'auroc': 0.99520576, 'binary_precision': 0.81208056, 'binary_recall': 0.90421194, 'binary_specificity': 0.9927221, 'binary_f1_score': 0.85567343}
confusion matrix:
       0     1
0  42012   308
1    141  1331
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.88945246, 'recall': 0.91044116, 'specificity': 0.91044116, 'f1': 0.8996471, 'auroc': 0.9826474, 'binary_precision': 0.7849779, 'binary_recall': 0.8289269, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.806354}
confusion matrix:
       0    1
0  18003  146
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.83174473, 'recall': 0.68407094, 'specificity': 0.68407094, 'f1': 0.73463166, 'auroc': 0.9468497, 'binary_precision': 0.69014084, 'binary_recall': 0.37547892, 'binary_specificity': 0.992663, 'binary_f1_score': 0.48635238}
confusion matrix:
      0   1
0  5953  44
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_27.png
better model found
persisted
after epoch: 27,now: 2024-06-05 07:17:41.605996,epoch time: 0:27:03.371814,used: 12:24:42.624115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99120843, 'precision': 0.9425762, 'recall': 0.91900635, 'specificity': 0.91900635, 'f1': 0.93044376, 'auroc': 0.9958262, 'binary_precision': 0.8906475, 'binary_recall': 0.84160435, 'binary_specificity': 0.9964084, 'binary_f1_score': 0.86543167}
confusion matrix:
       0     1
0  42169   152
1    233  1238
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9184519, 'recall': 0.8584945, 'specificity': 0.8584945, 'f1': 0.88597524, 'auroc': 0.9800401, 'binary_precision': 0.84671533, 'binary_recall': 0.7216174, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7791772}
confusion matrix:
       0    1
0  18065   84
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.86176306, 'recall': 0.5887877, 'specificity': 0.5887877, 'f1': 0.6361202, 'auroc': 0.9264124, 'binary_precision': 0.7580645, 'binary_recall': 0.18007663, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.29102167}
confusion matrix:
      0   1
0  5982  15
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_28.png
early stop counter: 1
val acc:0.9860047101974487, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9669223427772522 / 0.9782677888870239
after epoch: 28,now: 2024-06-05 07:45:00.958622,epoch time: 0:27:19.352626,used: 12:52:01.976741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99255574, 'precision': 0.9674547, 'recall': 0.91451144, 'specificity': 0.91451144, 'f1': 0.93927574, 'auroc': 0.9958777, 'binary_precision': 0.94076926, 'binary_recall': 0.8308424, 'binary_specificity': 0.9981805, 'binary_f1_score': 0.8823953}
confusion matrix:
       0     1
0  42243    77
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9414428, 'recall': 0.83452034, 'specificity': 0.83452034, 'f1': 0.8800658, 'auroc': 0.97870773, 'binary_precision': 0.89440995, 'binary_recall': 0.6718507, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.76731795}
confusion matrix:
       0    1
0  18098   51
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.87979555, 'recall': 0.5947015, 'specificity': 0.5947015, 'f1': 0.6451347, 'auroc': 0.9346838, 'binary_precision': 0.7936508, 'binary_recall': 0.19157088, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.30864197}
confusion matrix:
      0   1
0  5984  13
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_29.png
early stop counter: 2
val acc:0.9860578775405884, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9669223427772522 / 0.9782677888870239
after epoch: 29,now: 2024-06-05 08:12:24.870052,epoch time: 0:27:23.911430,used: 13:19:25.888171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9911171, 'precision': 0.93364114, 'recall': 0.9288018, 'specificity': 0.9288018, 'f1': 0.9312068, 'auroc': 0.99659014, 'binary_precision': 0.87207705, 'binary_recall': 0.8619986, 'binary_specificity': 0.995605, 'binary_f1_score': 0.8670085}
confusion matrix:
       0     1
0  42135   186
1    203  1268
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.92227304, 'recall': 0.8879609, 'specificity': 0.8879609, 'f1': 0.90433156, 'auroc': 0.9825924, 'binary_precision': 0.852292, 'binary_recall': 0.7807154, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.8149351}
confusion matrix:
       0    1
0  18062   87
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8941233, 'recall': 0.5797094, 'specificity': 0.5797094, 'f1': 0.6252742, 'auroc': 0.91974723, 'binary_precision': 0.8235294, 'binary_recall': 0.16091955, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5988   9
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_30.png
better model found
persisted
after epoch: 30,now: 2024-06-05 08:39:51.662206,epoch time: 0:27:26.792154,used: 13:46:52.680325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_18_52_58_seed_0_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:46:52.680325 at 2024-06-05 08:39:51.662206
persisted model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.88104427, 'recall': 0.58903784, 'specificity': 0.58903784, 'f1': 0.63760966, 'auroc': 0.9150785, 'binary_precision': 0.7966102, 'binary_recall': 0.18007663, 'binary_specificity': 0.997999, 'binary_f1_score': 0.29375}
confusion matrix:
      0   1
0  5985  12
1   214  47
oracle model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.8851429, 'recall': 0.8010126, 'specificity': 0.8010126, 'f1': 0.83739746, 'auroc': 0.9514139, 'binary_precision': 0.7871287, 'binary_recall': 0.6091954, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.68682504}
confusion matrix:
      0    1
0  5954   43
1   102  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14486 MiB |  14486 MiB |  14486 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197602 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95077 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197602 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95077 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2803    |  126053 K  |  126053 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2765    |   49321 K  |   49321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     39 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197602 K  |  197602 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197602 K  |  197602 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  126055 K  |  126055 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   49322 K  |   49322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     39 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197602 K  |  197602 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197602 K  |  197602 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  126055 K  |  126055 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   49322 K  |   49322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_08_51_35_seed_1_21096308

 Experiment start at: 2024-06-05 08:51:35.470558
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97022074, 'precision': 0.7768777, 'recall': 0.6757783, 'specificity': 0.6757783, 'f1': 0.7140045, 'auroc': 0.94906765, 'binary_precision': 0.57522124, 'binary_recall': 0.36061028, 'binary_specificity': 0.9909464, 'binary_f1_score': 0.44330776}
confusion matrix:
       0    1
0  42030  384
1    922  520
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.8054824, 'recall': 0.60328376, 'specificity': 0.60328376, 'f1': 0.6503088, 'auroc': 0.94700545, 'binary_precision': 0.6396396, 'binary_recall': 0.21099554, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.31731844}
confusion matrix:
       0    1
0  17987   80
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.935709, 'recall': 0.68561345, 'specificity': 0.68561345, 'f1': 0.75636345, 'auroc': 0.94829357, 'binary_precision': 0.8981481, 'binary_recall': 0.37307692, 'binary_specificity': 0.99815, 'binary_f1_score': 0.52717394}
confusion matrix:
      0   1
0  5935  11
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 09:20:09.274632,epoch time: 0:28:33.804074,used: 0:28:33.804074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_08_51_35_seed_1_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9720905, 'precision': 0.80077606, 'recall': 0.68846834, 'specificity': 0.68846834, 'f1': 0.7306211, 'auroc': 0.9584656, 'binary_precision': 0.62219733, 'binary_recall': 0.38488212, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.4755784}
confusion matrix:
       0    1
0  42077  337
1    887  555
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.821659, 'recall': 0.621802, 'specificity': 0.621802, 'f1': 0.673086, 'auroc': 0.95515597, 'binary_precision': 0.6706827, 'binary_recall': 0.24814264, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.36225596}
confusion matrix:
       0    1
0  17985   82
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.95067704, 'recall': 0.6954811, 'specificity': 0.6954811, 'f1': 0.7687831, 'auroc': 0.9598135, 'binary_precision': 0.92727274, 'binary_recall': 0.3923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.55135137}
confusion matrix:
      0    1
0  5938    8
1   158  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 09:47:20.576682,epoch time: 0:27:11.302050,used: 0:55:45.106124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_08_51_35_seed_1_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9753739, 'precision': 0.8600799, 'recall': 0.6908358, 'specificity': 0.6908358, 'f1': 0.7475598, 'auroc': 0.9672495, 'binary_precision': 0.7406915, 'binary_recall': 0.38626906, 'binary_specificity': 0.99540246, 'binary_f1_score': 0.5077484}
confusion matrix:
       0    1
0  42219  195
1    885  557
---- Validation: 
scalar performance:
{'acc': 0.9708111, 'precision': 0.87018013, 'recall': 0.63295037, 'specificity': 0.63295037, 'f1': 0.6916413, 'auroc': 0.9665408, 'binary_precision': 0.7669492, 'binary_recall': 0.268945, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.39823982}
confusion matrix:
       0    1
0  18012   55
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8558876, 'recall': 0.54548115, 'specificity': 0.54548115, 'f1': 0.5721258, 'auroc': 0.94562554, 'binary_precision': 0.75, 'binary_recall': 0.092307694, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.16438358}
confusion matrix:
      0   1
0  5938   8
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_3.png
better model found
persisted
after epoch: 3,now: 2024-06-05 10:14:04.410069,epoch time: 0:26:43.833387,used: 1:22:28.939511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_08_51_35_seed_1_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97544235, 'precision': 0.7973154, 'recall': 0.86035687, 'specificity': 0.86035687, 'f1': 0.8255043, 'auroc': 0.9729679, 'binary_precision': 0.6036343, 'binary_recall': 0.7371706, 'binary_specificity': 0.98354316, 'binary_f1_score': 0.6637528}
confusion matrix:
       0     1
0  41716   698
1    379  1063
---- Validation: 
scalar performance:
{'acc': 0.9739061, 'precision': 0.814078, 'recall': 0.80192804, 'specificity': 0.80192804, 'f1': 0.80787086, 'auroc': 0.9707134, 'binary_precision': 0.64241487, 'binary_recall': 0.6166419, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.6292646}
confusion matrix:
       0    1
0  17836  231
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7680746, 'recall': 0.65239465, 'specificity': 0.65239465, 'f1': 0.69243336, 'auroc': 0.9561424, 'binary_precision': 0.56551725, 'binary_recall': 0.31538463, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.40493828}
confusion matrix:
      0   1
0  5883  63
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_4.png
better model found
persisted
after epoch: 4,now: 2024-06-05 10:40:33.846449,epoch time: 0:26:29.436380,used: 1:48:58.375891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_08_51_35_seed_1_21096308
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.977905, 'precision': 0.8429214, 'recall': 0.7825813, 'specificity': 0.7825813, 'f1': 0.8095938, 'auroc': 0.97260433, 'binary_precision': 0.700254, 'binary_recall': 0.57350904, 'binary_specificity': 0.9916537, 'binary_f1_score': 0.63057566}
confusion matrix:
       0    1
0  42060  354
1    615  827
---- Validation: 
scalar performance:
{'acc': 0.97801495, 'precision': 0.9003161, 'recall': 0.7468377, 'specificity': 0.7468377, 'f1': 0.8039522, 'auroc': 0.9722562, 'binary_precision': 0.8190709, 'binary_recall': 0.49777117, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.61922365}
confusion matrix:
       0    1
0  17993   74
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8794702, 'recall': 0.5665509, 'specificity': 0.5665509, 'f1': 0.6054686, 'auroc': 0.9504704, 'binary_precision': 0.79545456, 'binary_recall': 0.13461539, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.23026319}
confusion matrix:
      0   1
0  5937   9
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096308_5.png
[Wed Jun  5 11:07:30 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/2.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 85942848 vs 85942672
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
