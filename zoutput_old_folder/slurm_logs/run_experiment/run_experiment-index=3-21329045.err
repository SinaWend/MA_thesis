Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 17 02:13:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045

 Experiment start at: 2024-06-17 02:20:24.122469
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9675114, 'precision': 0.75911224, 'recall': 0.5969701, 'specificity': 0.5969701, 'f1': 0.63788295, 'auroc': 0.91889626, 'binary_precision': 0.54545456, 'binary_recall': 0.19972827, 'binary_specificity': 0.99421185, 'binary_f1_score': 0.29239187}
confusion matrix:
       0    1
0  42083  245
1   1178  294
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.78078806, 'recall': 0.56372094, 'specificity': 0.56372094, 'f1': 0.59862304, 'auroc': 0.92022306, 'binary_precision': 0.5915493, 'binary_recall': 0.13063763, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.21401274}
confusion matrix:
       0   1
0  18091  58
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.88894355, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:35:33.298323,epoch time: 0:15:09.175854,used: 0:15:09.175854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9687671, 'precision': 0.7626466, 'recall': 0.7074533, 'specificity': 0.7074533, 'f1': 0.7314783, 'auroc': 0.9374082, 'binary_precision': 0.54506063, 'binary_recall': 0.42730978, 'binary_specificity': 0.98759687, 'binary_f1_score': 0.4790556}
confusion matrix:
       0    1
0  41803  525
1    843  629
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.7871705, 'recall': 0.62755203, 'specificity': 0.62755203, 'f1': 0.6740094, 'auroc': 0.9377825, 'binary_precision': 0.6, 'binary_recall': 0.26127526, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.36403033}
confusion matrix:
       0    1
0  18037  112
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89124787, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 02:50:15.560994,epoch time: 0:14:42.262671,used: 0:29:51.438525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9702055, 'precision': 0.7832749, 'recall': 0.6840522, 'specificity': 0.6840522, 'f1': 0.72215384, 'auroc': 0.9394436, 'binary_precision': 0.5879237, 'binary_recall': 0.37729436, 'binary_specificity': 0.9908101, 'binary_f1_score': 0.45962733}
confusion matrix:
       0    1
0  41940  389
1    916  555
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.80350995, 'recall': 0.60435545, 'specificity': 0.60435545, 'f1': 0.6515232, 'auroc': 0.9395483, 'binary_precision': 0.6342593, 'binary_recall': 0.21306376, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.31897554}
confusion matrix:
       0    1
0  18070   79
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8972901, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 03:04:55.447692,epoch time: 0:14:39.886698,used: 0:44:31.325223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9706621, 'precision': 0.78937364, 'recall': 0.6861392, 'specificity': 0.6861392, 'f1': 0.7255285, 'auroc': 0.94005173, 'binary_precision': 0.6, 'binary_recall': 0.38111413, 'binary_specificity': 0.99116427, 'binary_f1_score': 0.46614042}
confusion matrix:
       0    1
0  41954  374
1    911  561
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.80991524, 'recall': 0.62504774, 'specificity': 0.62504774, 'f1': 0.6750769, 'auroc': 0.9431507, 'binary_precision': 0.6456693, 'binary_recall': 0.25505444, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.36566335}
confusion matrix:
       0    1
0  18059   90
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.98052883, 'recall': 0.5344828, 'specificity': 0.5344828, 'f1': 0.55458724, 'auroc': 0.89190304, 'binary_precision': 1.0, 'binary_recall': 0.06896552, 'binary_specificity': 1.0, 'binary_f1_score': 0.12903225}
confusion matrix:
      0   1
0  5997   0
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 03:19:40.785730,epoch time: 0:14:45.338038,used: 0:59:16.663261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.971621, 'precision': 0.7997927, 'recall': 0.69647115, 'specificity': 0.69647115, 'f1': 0.7364146, 'auroc': 0.94534457, 'binary_precision': 0.62014693, 'binary_recall': 0.40149456, 'binary_specificity': 0.99144775, 'binary_f1_score': 0.48742267}
confusion matrix:
       0    1
0  41966  362
1    881  591
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.8271873, 'recall': 0.6047687, 'specificity': 0.6047687, 'f1': 0.65456504, 'auroc': 0.94421566, 'binary_precision': 0.68159205, 'binary_recall': 0.21306376, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.32464454}
confusion matrix:
       0    1
0  18085   64
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.87578046, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_5.png
early stop counter: 1
val acc:0.9696679711341858, best validation acc: 0.9697211384773254, corresponding to test acc:                         0.9611697196960449 / 0.964205801486969
after epoch: 5,now: 2024-06-17 03:34:28.637793,epoch time: 0:14:47.852063,used: 1:14:04.515324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9721461, 'precision': 0.7959125, 'recall': 0.73215187, 'specificity': 0.73215187, 'f1': 0.75981975, 'auroc': 0.9475584, 'binary_precision': 0.6099476, 'binary_recall': 0.47486413, 'binary_specificity': 0.9894396, 'binary_f1_score': 0.53399545}
confusion matrix:
       0    1
0  41881  447
1    773  699
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.81594515, 'recall': 0.66101664, 'specificity': 0.66101664, 'f1': 0.7112386, 'auroc': 0.9471323, 'binary_precision': 0.6552795, 'binary_recall': 0.3281493, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.4373057}
confusion matrix:
       0    1
0  18038  111
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.9468845, 'recall': 0.52673656, 'specificity': 0.52673656, 'f1': 0.5405939, 'auroc': 0.8917328, 'binary_precision': 0.93333334, 'binary_recall': 0.053639848, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10144928}
confusion matrix:
      0   1
0  5996   1
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_6.png
better model found
persisted
after epoch: 6,now: 2024-06-17 03:49:12.758278,epoch time: 0:14:44.120485,used: 1:28:48.635809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9727854, 'precision': 0.8072281, 'recall': 0.72133535, 'specificity': 0.72133535, 'f1': 0.7566743, 'auroc': 0.9480189, 'binary_precision': 0.6333333, 'binary_recall': 0.4517663, 'binary_specificity': 0.9909044, 'binary_f1_score': 0.5273592}
confusion matrix:
       0    1
0  41943  385
1    807  665
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.80308366, 'recall': 0.65304774, 'specificity': 0.65304774, 'f1': 0.70129406, 'auroc': 0.9476571, 'binary_precision': 0.63009405, 'binary_recall': 0.31259722, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.41787943}
confusion matrix:
       0    1
0  18031  118
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.95267093, 'recall': 0.53248364, 'specificity': 0.53248364, 'f1': 0.55092126, 'auroc': 0.8953263, 'binary_precision': 0.9444444, 'binary_recall': 0.0651341, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5996   1
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_7.png
early stop counter: 1
val acc:0.9702000617980957, best validation acc: 0.9711047410964966, corresponding to test acc:                         0.9603707194328308 / 0.964205801486969
after epoch: 7,now: 2024-06-17 04:03:57.624089,epoch time: 0:14:44.865811,used: 1:43:33.501620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9710502, 'precision': 0.7773737, 'recall': 0.7751905, 'specificity': 0.7751905, 'f1': 0.7762773, 'auroc': 0.9475523, 'binary_precision': 0.569863, 'binary_recall': 0.5652174, 'binary_specificity': 0.9851635, 'binary_f1_score': 0.5675307}
confusion matrix:
       0    1
0  41700  628
1    640  832
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.7900915, 'recall': 0.748966, 'specificity': 0.748966, 'f1': 0.76780355, 'auroc': 0.95034045, 'binary_precision': 0.5974499, 'binary_recall': 0.5101089, 'binary_specificity': 0.987823, 'binary_f1_score': 0.55033565}
confusion matrix:
       0    1
0  17928  221
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.9596326, 'recall': 0.64334464, 'specificity': 0.64334464, 'f1': 0.71278596, 'auroc': 0.8932372, 'binary_precision': 0.9493671, 'binary_recall': 0.28735632, 'binary_specificity': 0.999333, 'binary_f1_score': 0.44117647}
confusion matrix:
      0   1
0  5993   4
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-17 04:18:46.836375,epoch time: 0:14:49.212286,used: 1:58:22.713906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97180367, 'precision': 0.79007554, 'recall': 0.7404991, 'specificity': 0.7404991, 'f1': 0.7627467, 'auroc': 0.9481156, 'binary_precision': 0.59769166, 'binary_recall': 0.4925272, 'binary_specificity': 0.988471, 'binary_f1_score': 0.5400373}
confusion matrix:
       0    1
0  41840  488
1    747  725
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.8091315, 'recall': 0.67529523, 'specificity': 0.67529523, 'f1': 0.7221329, 'auroc': 0.9504476, 'binary_precision': 0.6406685, 'binary_recall': 0.3576983, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.45908183}
confusion matrix:
       0    1
0  18020  129
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9440254, 'recall': 0.547726, 'specificity': 0.547726, 'f1': 0.5770738, 'auroc': 0.8926711, 'binary_precision': 0.9259259, 'binary_recall': 0.09578544, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1736111}
confusion matrix:
      0   1
0  5995   2
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_9.png
early stop counter: 1
val acc:0.971157968044281, best validation acc: 0.971477210521698, corresponding to test acc:                         0.9696388840675354 / 0.9696388840675354
after epoch: 9,now: 2024-06-17 04:33:32.971282,epoch time: 0:14:46.134907,used: 2:13:08.848813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9714155, 'precision': 0.7865038, 'recall': 0.7373475, 'specificity': 0.7373475, 'f1': 0.75939405, 'auroc': 0.9457613, 'binary_precision': 0.5907591, 'binary_recall': 0.48641303, 'binary_specificity': 0.98828197, 'binary_f1_score': 0.533532}
confusion matrix:
       0    1
0  41832  496
1    756  716
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.8143556, 'recall': 0.69526505, 'specificity': 0.69526505, 'f1': 0.7396834, 'auroc': 0.95060194, 'binary_precision': 0.6497462, 'binary_recall': 0.39813375, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.49373192}
confusion matrix:
       0    1
0  18011  138
1    387  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.8876809, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_10.png
better model found
persisted
after epoch: 10,now: 2024-06-17 04:48:19.341881,epoch time: 0:14:46.370599,used: 2:27:55.219412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9729452, 'precision': 0.81476426, 'recall': 0.7079757, 'specificity': 0.7079757, 'f1': 0.74951655, 'auroc': 0.9470956, 'binary_precision': 0.64932364, 'binary_recall': 0.42391303, 'binary_specificity': 0.99203837, 'binary_f1_score': 0.51294696}
confusion matrix:
       0    1
0  41991  337
1    848  624
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.82926774, 'recall': 0.6560142, 'specificity': 0.6560142, 'f1': 0.7092738, 'auroc': 0.9500427, 'binary_precision': 0.6822742, 'binary_recall': 0.31726283, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.433121}
confusion matrix:
       0    1
0  18054   95
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.95560277, 'recall': 0.5363151, 'specificity': 0.5363151, 'f1': 0.55768514, 'auroc': 0.8798248, 'binary_precision': 0.95, 'binary_recall': 0.07279693, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13523132}
confusion matrix:
      0   1
0  5996   1
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_11.png
early stop counter: 1
val acc:0.9715836644172668, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 11,now: 2024-06-17 05:02:50.735377,epoch time: 0:14:31.393496,used: 2:42:26.612908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97356164, 'precision': 0.8275077, 'recall': 0.7020653, 'specificity': 0.7020653, 'f1': 0.7486967, 'auroc': 0.9492507, 'binary_precision': 0.67522323, 'binary_recall': 0.41100544, 'binary_specificity': 0.99312514, 'binary_f1_score': 0.5109798}
confusion matrix:
       0    1
0  42037  291
1    867  605
---- Validation: 
scalar performance:
{'acc': 0.9717433, 'precision': 0.8249134, 'recall': 0.6665976, 'specificity': 0.6665976, 'f1': 0.71818876, 'auroc': 0.94870496, 'binary_precision': 0.6728395, 'binary_recall': 0.33903578, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.45087904}
confusion matrix:
       0    1
0  18043  106
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9720537, 'recall': 0.5880392, 'specificity': 0.5880392, 'f1': 0.640504, 'auroc': 0.8799962, 'binary_precision': 0.9787234, 'binary_recall': 0.17624521, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.29870132}
confusion matrix:
      0   1
0  5996   1
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_12.png
early stop counter: 2
val acc:0.9717432856559753, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 12,now: 2024-06-17 05:17:26.734249,epoch time: 0:14:35.998872,used: 2:57:02.611780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9716667, 'precision': 0.79522955, 'recall': 0.7120399, 'specificity': 0.7120399, 'f1': 0.7461835, 'auroc': 0.94703645, 'binary_precision': 0.6099426, 'binary_recall': 0.43371856, 'binary_specificity': 0.9903612, 'binary_f1_score': 0.50695276}
confusion matrix:
       0    1
0  41921  408
1    833  638
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.8448404, 'recall': 0.65101177, 'specificity': 0.65101177, 'f1': 0.70720404, 'auroc': 0.9502523, 'binary_precision': 0.7137681, 'binary_recall': 0.30637637, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.42872688}
confusion matrix:
       0    1
0  18070   79
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.8679549, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_13.png
early stop counter: 3
val acc:0.9720625877380371, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 13,now: 2024-06-17 05:32:06.515100,epoch time: 0:14:39.780851,used: 3:11:42.392631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9713014, 'precision': 0.8322952, 'recall': 0.6307335, 'specificity': 0.6307335, 'f1': 0.684415, 'auroc': 0.9454355, 'binary_precision': 0.6895943, 'binary_recall': 0.265625, 'binary_specificity': 0.995842, 'binary_f1_score': 0.38352132}
confusion matrix:
       0    1
0  42152  176
1   1081  391
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.8565229, 'recall': 0.5944608, 'specificity': 0.5944608, 'f1': 0.64438486, 'auroc': 0.9501976, 'binary_precision': 0.7409639, 'binary_recall': 0.19129083, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.30407912}
confusion matrix:
       0    1
0  18106   43
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8711059, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_14.png
early stop counter: 4
val acc:0.9700404405593872, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 14,now: 2024-06-17 05:46:49.892419,epoch time: 0:14:43.377319,used: 3:26:25.769950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97321916, 'precision': 0.8226146, 'recall': 0.7000475, 'specificity': 0.7000475, 'f1': 0.7457545, 'auroc': 0.95019245, 'binary_precision': 0.66555554, 'binary_recall': 0.40720597, 'binary_specificity': 0.99288905, 'binary_f1_score': 0.505272}
confusion matrix:
       0    1
0  42028  301
1    872  599
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.8245454, 'recall': 0.6299338, 'specificity': 0.6299338, 'f1': 0.68238056, 'auroc': 0.949444, 'binary_precision': 0.67460316, 'binary_recall': 0.2643857, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.37988827}
confusion matrix:
       0    1
0  18067   82
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8782541, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_15.png
early stop counter: 5
val acc:0.970466136932373, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 15,now: 2024-06-17 06:01:35.334894,epoch time: 0:14:45.442475,used: 3:41:11.212425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97246575, 'precision': 0.8182938, 'recall': 0.6847774, 'specificity': 0.6847774, 'f1': 0.73234195, 'auroc': 0.9471299, 'binary_precision': 0.65795726, 'binary_recall': 0.3763587, 'binary_specificity': 0.993196, 'binary_f1_score': 0.47882456}
confusion matrix:
       0    1
0  42040  288
1    918  554
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.8211161, 'recall': 0.6611544, 'specificity': 0.6611544, 'f1': 0.71244675, 'auroc': 0.95081, 'binary_precision': 0.66561514, 'binary_recall': 0.3281493, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.43958333}
confusion matrix:
       0    1
0  18043  106
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.8842699, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_16.png
early stop counter: 6
val acc:0.9713708162307739, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.9643656015396118 / 0.9696388840675354
after epoch: 16,now: 2024-06-17 06:16:25.957179,epoch time: 0:14:50.622285,used: 3:56:01.834710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97305936, 'precision': 0.7954556, 'recall': 0.7764104, 'specificity': 0.7764104, 'f1': 0.78558457, 'auroc': 0.9519639, 'binary_precision': 0.60597235, 'binary_recall': 0.56560165, 'binary_specificity': 0.98721915, 'binary_f1_score': 0.5850914}
confusion matrix:
       0    1
0  41788  541
1    639  832
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.8064726, 'recall': 0.7162941, 'specificity': 0.7162941, 'f1': 0.75289357, 'auroc': 0.9509129, 'binary_precision': 0.6325167, 'binary_recall': 0.44167963, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.5201465}
confusion matrix:
       0    1
0  17984  165
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.96007776, 'recall': 0.5439779, 'specificity': 0.5439779, 'f1': 0.5709315, 'auroc': 0.8776641, 'binary_precision': 0.9583333, 'binary_recall': 0.08812261, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.1614035}
confusion matrix:
      0   1
0  5996   1
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_17.png
better model found
persisted
after epoch: 17,now: 2024-06-17 06:31:17.289045,epoch time: 0:14:51.331866,used: 4:10:53.166576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9731735, 'precision': 0.82006747, 'recall': 0.7041595, 'specificity': 0.7041595, 'f1': 0.7482108, 'auroc': 0.94854456, 'binary_precision': 0.66019416, 'binary_recall': 0.41576087, 'binary_specificity': 0.9925581, 'binary_f1_score': 0.5102126}
confusion matrix:
       0    1
0  42013  315
1    860  612
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.8556275, 'recall': 0.62898463, 'specificity': 0.62898463, 'f1': 0.6855955, 'auroc': 0.9511088, 'binary_precision': 0.7368421, 'binary_recall': 0.26127526, 'binary_specificity': 0.996694, 'binary_f1_score': 0.38576347}
confusion matrix:
       0    1
0  18089   60
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.87132597, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_18.png
early stop counter: 1
val acc:0.9715304374694824, best validation acc: 0.9721158146858215, corresponding to test acc:                         0.9618088603019714 / 0.9696388840675354
after epoch: 18,now: 2024-06-17 06:46:01.192971,epoch time: 0:14:43.903926,used: 4:25:37.070502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97262555, 'precision': 0.7995887, 'recall': 0.7387834, 'specificity': 0.7387834, 'f1': 0.76543, 'auroc': 0.9528611, 'binary_precision': 0.6168385, 'binary_recall': 0.48810333, 'binary_specificity': 0.9894635, 'binary_f1_score': 0.5449716}
confusion matrix:
       0    1
0  41883  446
1    753  718
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.8124299, 'recall': 0.701293, 'specificity': 0.701293, 'f1': 0.7437787, 'auroc': 0.95121384, 'binary_precision': 0.64547676, 'binary_recall': 0.41057542, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.5019011}
confusion matrix:
       0    1
0  18004  145
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.8684441, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_19.png
early stop counter: 2
val acc:0.9721158146858215, best validation acc: 0.9721158146858215, corresponding to test acc:                         0.9618088603019714 / 0.9696388840675354
after epoch: 19,now: 2024-06-17 07:00:46.674825,epoch time: 0:14:45.481854,used: 4:40:22.552356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97237444, 'precision': 0.7961265, 'recall': 0.74177796, 'specificity': 0.74177796, 'f1': 0.7659451, 'auroc': 0.9485219, 'binary_precision': 0.6097152, 'binary_recall': 0.49456522, 'binary_specificity': 0.9889907, 'binary_f1_score': 0.5461365}
confusion matrix:
       0    1
0  41862  466
1    744  728
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.8285841, 'recall': 0.6674579, 'specificity': 0.6674579, 'f1': 0.7197473, 'auroc': 0.94994307, 'binary_precision': 0.6801242, 'binary_recall': 0.34059098, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.453886}
confusion matrix:
       0    1
0  18046  103
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.869329, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_20.png
early stop counter: 3
val acc:0.9719561338424683, best validation acc: 0.9721158146858215, corresponding to test acc:                         0.9618088603019714 / 0.9696388840675354
after epoch: 20,now: 2024-06-17 07:15:29.967347,epoch time: 0:14:43.292522,used: 4:55:05.844878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97378993, 'precision': 0.8046529, 'recall': 0.76891416, 'specificity': 0.76891416, 'f1': 0.78556395, 'auroc': 0.95222485, 'binary_precision': 0.6249033, 'binary_recall': 0.5492862, 'binary_specificity': 0.98854214, 'binary_f1_score': 0.5846599}
confusion matrix:
       0    1
0  41844  485
1    663  808
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.8161191, 'recall': 0.7250406, 'specificity': 0.7250406, 'f1': 0.7622268, 'auroc': 0.95214105, 'binary_precision': 0.6512141, 'binary_recall': 0.45878693, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.53832114}
confusion matrix:
       0    1
0  17991  158
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.8798796, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_21.png
better model found
persisted
after epoch: 21,now: 2024-06-17 07:30:19.162341,epoch time: 0:14:49.194994,used: 5:09:55.039872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97253424, 'precision': 0.8160463, 'recall': 0.69137, 'specificity': 0.69137, 'f1': 0.7370956, 'auroc': 0.95014185, 'binary_precision': 0.6530148, 'binary_recall': 0.38994566, 'binary_specificity': 0.9927944, 'binary_f1_score': 0.4883029}
confusion matrix:
       0    1
0  42023  305
1    898  574
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.8495516, 'recall': 0.6350126, 'specificity': 0.6350126, 'f1': 0.69136995, 'auroc': 0.95033264, 'binary_precision': 0.7242798, 'binary_recall': 0.27371696, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.39729118}
confusion matrix:
       0    1
0  18082   67
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8830966, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_22.png
early stop counter: 1
val acc:0.9715836644172668, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 22,now: 2024-06-17 07:45:10.611078,epoch time: 0:14:51.448737,used: 5:24:46.488609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9730137, 'precision': 0.8283652, 'recall': 0.6844051, 'specificity': 0.6844051, 'f1': 0.7345425, 'auroc': 0.9513041, 'binary_precision': 0.67813265, 'binary_recall': 0.375, 'binary_specificity': 0.99381024, 'binary_f1_score': 0.48293966}
confusion matrix:
       0    1
0  42066  262
1    920  552
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.8293233, 'recall': 0.65295887, 'specificity': 0.65295887, 'f1': 0.70636237, 'auroc': 0.95128626, 'binary_precision': 0.6825939, 'binary_recall': 0.31104198, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.4273504}
confusion matrix:
       0    1
0  18056   93
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8812567, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_23.png
early stop counter: 2
val acc:0.971477210521698, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 23,now: 2024-06-17 08:00:03.745913,epoch time: 0:14:53.134835,used: 5:39:39.623444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9729452, 'precision': 0.82269466, 'recall': 0.6919105, 'specificity': 0.6919105, 'f1': 0.73930377, 'auroc': 0.9492841, 'binary_precision': 0.6662804, 'binary_recall': 0.390625, 'binary_specificity': 0.993196, 'binary_f1_score': 0.49250534}
confusion matrix:
       0    1
0  42040  288
1    897  575
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.83487415, 'recall': 0.6492637, 'specificity': 0.6492637, 'f1': 0.70375586, 'auroc': 0.94830847, 'binary_precision': 0.6939502, 'binary_recall': 0.30326593, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.4220779}
confusion matrix:
       0    1
0  18063   86
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8754407, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_24.png
early stop counter: 3
val acc:0.9715836644172668, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 24,now: 2024-06-17 08:14:45.482423,epoch time: 0:14:41.736510,used: 5:54:21.359954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97280824, 'precision': 0.8203931, 'recall': 0.69183964, 'specificity': 0.69183964, 'f1': 0.7386369, 'auroc': 0.94959104, 'binary_precision': 0.6616801, 'binary_recall': 0.390625, 'binary_specificity': 0.9930543, 'binary_f1_score': 0.49124303}
confusion matrix:
       0    1
0  42034  294
1    897  575
---- Validation: 
scalar performance:
{'acc': 0.972169, 'precision': 0.84982085, 'recall': 0.6488167, 'specificity': 0.6488167, 'f1': 0.70582217, 'auroc': 0.9494097, 'binary_precision': 0.7238806, 'binary_recall': 0.30171072, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.42590556}
confusion matrix:
       0    1
0  18075   74
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9799136, 'recall': 0.5191571, 'specificity': 0.5191571, 'f1': 0.52665126, 'auroc': 0.8736354, 'binary_precision': 1.0, 'binary_recall': 0.038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.073800735}
confusion matrix:
      0   1
0  5997   0
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_25.png
early stop counter: 4
val acc:0.9721689820289612, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 25,now: 2024-06-17 08:29:33.301256,epoch time: 0:14:47.818833,used: 6:09:09.178787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9734475, 'precision': 0.80916387, 'recall': 0.74069387, 'specificity': 0.74069387, 'f1': 0.7702758, 'auroc': 0.95361036, 'binary_precision': 0.6358839, 'binary_recall': 0.49116847, 'binary_specificity': 0.99021924, 'binary_f1_score': 0.55423534}
confusion matrix:
       0    1
0  41914  414
1    749  723
---- Validation: 
scalar performance:
{'acc': 0.97243506, 'precision': 0.8135115, 'recall': 0.7097089, 'specificity': 0.7097089, 'f1': 0.7503978, 'auroc': 0.94949263, 'binary_precision': 0.64705884, 'binary_recall': 0.42768273, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.51498127}
confusion matrix:
       0    1
0  17999  150
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.96747553, 'recall': 0.5650507, 'specificity': 0.5650507, 'f1': 0.6055359, 'auroc': 0.8836634, 'binary_precision': 0.9714286, 'binary_recall': 0.1302682, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.22972974}
confusion matrix:
      0   1
0  5996   1
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_26.png
early stop counter: 5
val acc:0.9724350571632385, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 26,now: 2024-06-17 08:44:20.986786,epoch time: 0:14:47.685530,used: 6:23:56.864317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97305936, 'precision': 0.79999906, 'recall': 0.7568861, 'specificity': 0.7568861, 'f1': 0.7766142, 'auroc': 0.9491179, 'binary_precision': 0.6164274, 'binary_recall': 0.5251359, 'binary_specificity': 0.9886364, 'binary_f1_score': 0.56713134}
confusion matrix:
       0    1
0  41847  481
1    699  773
---- Validation: 
scalar performance:
{'acc': 0.97264796, 'precision': 0.8228742, 'recall': 0.69706815, 'specificity': 0.69706815, 'f1': 0.7434547, 'auroc': 0.9521605, 'binary_precision': 0.6666667, 'binary_recall': 0.40124416, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.50097084}
confusion matrix:
       0    1
0  18020  129
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.87316453, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_27.png
early stop counter: 6
val acc:0.9726479649543762, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 27,now: 2024-06-17 08:59:17.995302,epoch time: 0:14:57.008516,used: 6:38:53.872833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97280824, 'precision': 0.80043525, 'recall': 0.74429744, 'specificity': 0.74429744, 'f1': 0.76920104, 'auroc': 0.9542633, 'binary_precision': 0.6181665, 'binary_recall': 0.49932066, 'binary_specificity': 0.98927426, 'binary_f1_score': 0.5524239}
confusion matrix:
       0    1
0  41874  454
1    737  735
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.82378435, 'recall': 0.69862336, 'specificity': 0.69862336, 'f1': 0.74493426, 'auroc': 0.9516461, 'binary_precision': 0.66838044, 'binary_recall': 0.4043546, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.503876}
confusion matrix:
       0    1
0  18020  129
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.94442666, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.537102, 'auroc': 0.8790492, 'binary_precision': 0.9285714, 'binary_recall': 0.049808428, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.094545454}
confusion matrix:
      0   1
0  5996   1
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_28.png
early stop counter: 7
val acc:0.9727543592453003, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 28,now: 2024-06-17 09:14:13.304705,epoch time: 0:14:55.309403,used: 6:53:49.182236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97378993, 'precision': 0.84289896, 'recall': 0.6851346, 'specificity': 0.6851346, 'f1': 0.73861605, 'auroc': 0.94983697, 'binary_precision': 0.7071611, 'binary_recall': 0.37567934, 'binary_specificity': 0.99458987, 'binary_f1_score': 0.49068323}
confusion matrix:
       0    1
0  42099  229
1    919  553
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.8685031, 'recall': 0.6261222, 'specificity': 0.6261222, 'f1': 0.6839266, 'auroc': 0.9498661, 'binary_precision': 0.7627907, 'binary_recall': 0.25505444, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.38228437}
confusion matrix:
       0    1
0  18098   51
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.8687612, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_29.png
early stop counter: 8
val acc:0.9717965126037598, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 29,now: 2024-06-17 09:29:09.485956,epoch time: 0:14:56.181251,used: 7:08:45.363487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9730365, 'precision': 0.808787, 'recall': 0.7263832, 'specificity': 0.7263832, 'f1': 0.760669, 'auroc': 0.95054746, 'binary_precision': 0.6361085, 'binary_recall': 0.46195653, 'binary_specificity': 0.99080986, 'binary_f1_score': 0.53522235}
confusion matrix:
       0    1
0  41939  389
1    792  680
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.8285451, 'recall': 0.69037277, 'specificity': 0.69037277, 'f1': 0.7395351, 'auroc': 0.9520274, 'binary_precision': 0.6784741, 'binary_recall': 0.38724726, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.4930693}
confusion matrix:
       0    1
0  18031  118
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.8669903, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_30.png
early stop counter: 9
val acc:0.9727543592453003, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9598913192749023 / 0.9696388840675354
after epoch: 30,now: 2024-06-17 09:43:54.551279,epoch time: 0:14:45.065323,used: 7:23:30.428810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_20_24_seed_0_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:23:30.428810 at 2024-06-17 09:43:54.551279
persisted model performance metric: 

scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.8798796, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
oracle model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.9596326, 'recall': 0.64334464, 'specificity': 0.64334464, 'f1': 0.71278596, 'auroc': 0.8932372, 'binary_precision': 0.9493671, 'binary_recall': 0.28735632, 'binary_specificity': 0.999333, 'binary_f1_score': 0.44117647}
confusion matrix:
      0   1
0  5993   4
1   186  75
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |  36242 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |  35968 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 302105 GiB | 302104 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13349 K  |   13347 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8036 K  |    8035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13349 K  |   13347 K  |
|       from large pool |      36    |      76    |    5312 K  |    5312 K  |
|       from small pool |    1242    |    1864    |    8036 K  |    8035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7141 K  |    7141 K  |
|       from large pool |       5    |      10    |    1973 K  |    1973 K  |
|       from small pool |      30    |     447    |    5167 K  |    5167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302105 GiB | 302104 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8036 K  |    8036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8036 K  |    8036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 404958 GiB | 404958 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 404884 GiB | 404884 GiB |
|       from small pool |      0 KiB |     72 MiB |     74 GiB |     74 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 404935 GiB | 404935 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 404863 GiB | 404863 GiB |
|       from small pool |      0 KiB |     71 MiB |     71 GiB |     71 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 302186 GiB | 302186 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 302105 GiB | 302104 GiB |
|       from small pool |      0 KiB |  16408 KiB |     81 GiB |     81 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8036 K  |    8036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13349 K  |   13349 K  |
|       from large pool |       2    |      76    |    5312 K  |    5312 K  |
|       from small pool |       0    |    1864    |    8036 K  |    8036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7142 K  |    7142 K  |
|       from large pool |       1    |      11    |    1973 K  |    1973 K  |
|       from small pool |       0    |     447    |    5168 K  |    5168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045

 Experiment start at: 2024-06-17 09:50:37.234799
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.7658015, 'recall': 0.6486111, 'specificity': 0.6486111, 'f1': 0.68911976, 'auroc': 0.91695446, 'binary_precision': 0.554855, 'binary_recall': 0.30555555, 'binary_specificity': 0.9916667, 'binary_f1_score': 0.39408866}
confusion matrix:
       0    1
0  42007  353
1   1000  440
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.812462, 'recall': 0.6070538, 'specificity': 0.6070538, 'f1': 0.6554417, 'auroc': 0.91402435, 'binary_precision': 0.6533333, 'binary_recall': 0.21842496, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.32739422}
confusion matrix:
       0    1
0  17989   78
1    526  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9813016, 'recall': 0.5557692, 'specificity': 0.5557692, 'f1': 0.59081864, 'auroc': 0.87096107, 'binary_precision': 1.0, 'binary_recall': 0.11153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.20069206}
confusion matrix:
      0   1
0  5946   0
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 10:05:44.597003,epoch time: 0:15:07.362204,used: 0:15:07.362204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9683105, 'precision': 0.7602805, 'recall': 0.60029304, 'specificity': 0.60029304, 'f1': 0.6417428, 'auroc': 0.93491024, 'binary_precision': 0.5469613, 'binary_recall': 0.20639333, 'binary_specificity': 0.9941928, 'binary_f1_score': 0.29969725}
confusion matrix:
       0    1
0  42115  246
1   1142  297
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79098743, 'recall': 0.5790711, 'specificity': 0.5790711, 'f1': 0.6194439, 'auroc': 0.9288261, 'binary_precision': 0.6123595, 'binary_recall': 0.16196136, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.2561692}
confusion matrix:
       0    1
0  17998   69
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.88550234, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_2.png
early stop counter: 1
val acc:0.9662219882011414, best validation acc: 0.9677695035934448, corresponding to test acc:                         0.9627779722213745 / 0.9627779722213745
after epoch: 2,now: 2024-06-17 10:20:48.352155,epoch time: 0:15:03.755152,used: 0:30:11.117356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.78031015, 'recall': 0.6837219, 'specificity': 0.6837219, 'f1': 0.72104526, 'auroc': 0.94120044, 'binary_precision': 0.58154505, 'binary_recall': 0.37665045, 'binary_specificity': 0.9907934, 'binary_f1_score': 0.45719105}
confusion matrix:
       0    1
0  41971  390
1    897  542
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.80663735, 'recall': 0.6243863, 'specificity': 0.6243863, 'f1': 0.6737321, 'auroc': 0.9341492, 'binary_precision': 0.64044946, 'binary_recall': 0.25408617, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.36382976}
confusion matrix:
       0    1
0  17971   96
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8830723, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 10:37:43.487066,epoch time: 0:16:55.134911,used: 0:47:06.252267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97150683, 'precision': 0.78975415, 'recall': 0.69701624, 'specificity': 0.69701624, 'f1': 0.73375404, 'auroc': 0.94308305, 'binary_precision': 0.5995872, 'binary_recall': 0.40319222, 'binary_specificity': 0.9908402, 'binary_f1_score': 0.48215765}
confusion matrix:
       0    1
0  41971  388
1    860  581
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8237565, 'recall': 0.6342383, 'specificity': 0.6342383, 'f1': 0.6865927, 'auroc': 0.9390496, 'binary_precision': 0.6739927, 'binary_recall': 0.27340266, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.38900635}
confusion matrix:
       0    1
0  17978   89
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.883176, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_4.png
better model found
persisted
after epoch: 4,now: 2024-06-17 10:53:04.389437,epoch time: 0:15:20.902371,used: 1:02:27.154638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97084475, 'precision': 0.7920566, 'recall': 0.6581285, 'specificity': 0.6581285, 'f1': 0.7034778, 'auroc': 0.9485725, 'binary_precision': 0.6067708, 'binary_recall': 0.32338655, 'binary_specificity': 0.99287045, 'binary_f1_score': 0.42191038}
confusion matrix:
       0    1
0  42057  302
1    975  466
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.8423219, 'recall': 0.6002609, 'specificity': 0.6002609, 'f1': 0.65031105, 'auroc': 0.93665785, 'binary_precision': 0.7135417, 'binary_recall': 0.20356612, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.316763}
confusion matrix:
       0    1
0  18012   55
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8727931, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_5.png
early stop counter: 1
val acc:0.9684631824493408, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.9606832265853882 / 0.9627779722213745
after epoch: 5,now: 2024-06-17 11:07:58.737424,epoch time: 0:14:54.347987,used: 1:17:21.502625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9715753, 'precision': 0.78733385, 'recall': 0.71012354, 'specificity': 0.71012354, 'f1': 0.7421833, 'auroc': 0.9452034, 'binary_precision': 0.59386975, 'binary_recall': 0.43025675, 'binary_specificity': 0.9899903, 'binary_f1_score': 0.49899393}
confusion matrix:
       0    1
0  41935  424
1    821  620
---- Validation: 
scalar performance:
{'acc': 0.9702775, 'precision': 0.8143681, 'recall': 0.68131185, 'specificity': 0.68131185, 'f1': 0.7283731, 'auroc': 0.9381113, 'binary_precision': 0.65183246, 'binary_recall': 0.36998513, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.4720379}
confusion matrix:
       0    1
0  17934  133
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.88746685, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_6.png
better model found
persisted
after epoch: 6,now: 2024-06-17 11:22:45.183574,epoch time: 0:14:46.446150,used: 1:32:07.948775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97221464, 'precision': 0.7896235, 'recall': 0.7310219, 'specificity': 0.7310219, 'f1': 0.7567159, 'auroc': 0.9506738, 'binary_precision': 0.5970149, 'binary_recall': 0.472879, 'binary_specificity': 0.9891648, 'binary_f1_score': 0.5277455}
confusion matrix:
       0    1
0  41903  459
1    758  680
---- Validation: 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8359888, 'recall': 0.65787405, 'specificity': 0.65787405, 'f1': 0.71218693, 'auroc': 0.94026375, 'binary_precision': 0.6967742, 'binary_recall': 0.32095096, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.439471}
confusion matrix:
       0    1
0  17973   94
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.8913043, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 11:37:27.826097,epoch time: 0:14:42.642523,used: 1:46:50.591298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9718265, 'precision': 0.7885896, 'recall': 0.7170995, 'specificity': 0.7170995, 'f1': 0.7473229, 'auroc': 0.9499372, 'binary_precision': 0.59590316, 'binary_recall': 0.44444445, 'binary_specificity': 0.9897545, 'binary_f1_score': 0.5091488}
confusion matrix:
       0    1
0  41926  434
1    800  640
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.8357152, 'recall': 0.6826913, 'specificity': 0.6826913, 'f1': 0.7347016, 'auroc': 0.94237673, 'binary_precision': 0.6944444, 'binary_recall': 0.37147102, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.4840271}
confusion matrix:
       0    1
0  17957  110
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.8740126, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_8.png
better model found
persisted
after epoch: 8,now: 2024-06-17 11:51:57.397070,epoch time: 0:14:29.570973,used: 2:01:20.162271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.973105, 'precision': 0.80195266, 'recall': 0.7271522, 'specificity': 0.7271522, 'f1': 0.75878954, 'auroc': 0.94931203, 'binary_precision': 0.62197393, 'binary_recall': 0.46388888, 'binary_specificity': 0.9904155, 'binary_f1_score': 0.531424}
confusion matrix:
       0    1
0  41954  406
1    772  668
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.81954896, 'recall': 0.73314744, 'specificity': 0.73314744, 'f1': 0.76895547, 'auroc': 0.9452567, 'binary_precision': 0.65843624, 'binary_recall': 0.4754829, 'binary_specificity': 0.990812, 'binary_f1_score': 0.5522002}
confusion matrix:
       0    1
0  17901  166
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8825135, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 12:06:25.075339,epoch time: 0:14:27.678269,used: 2:15:47.840540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9715753, 'precision': 0.77496445, 'recall': 0.790622, 'specificity': 0.790622, 'f1': 0.7825539, 'auroc': 0.94937134, 'binary_precision': 0.5636483, 'binary_recall': 0.5969423, 'binary_specificity': 0.9843016, 'binary_f1_score': 0.5798177}
confusion matrix:
       0    1
0  41696  665
1    580  859
---- Validation: 
scalar performance:
{'acc': 0.97171825, 'precision': 0.80353093, 'recall': 0.76073843, 'specificity': 0.76073843, 'f1': 0.7803463, 'auroc': 0.94293433, 'binary_precision': 0.6243478, 'binary_recall': 0.53343236, 'binary_specificity': 0.9880445, 'binary_f1_score': 0.5753205}
confusion matrix:
       0    1
0  17851  216
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.98247325, 'recall': 0.5846154, 'specificity': 0.5846154, 'f1': 0.6358171, 'auroc': 0.8898493, 'binary_precision': 1.0, 'binary_recall': 0.16923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.28947368}
confusion matrix:
      0   1
0  5946   0
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_10.png
new oracle model saved
early stop counter: 1
val acc:0.9717182517051697, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 10,now: 2024-06-17 12:20:52.460955,epoch time: 0:14:27.385616,used: 2:30:15.226156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.973105, 'precision': 0.811634, 'recall': 0.7011942, 'specificity': 0.7011942, 'f1': 0.7435138, 'auroc': 0.9479401, 'binary_precision': 0.6430903, 'binary_recall': 0.41013184, 'binary_specificity': 0.99225664, 'binary_f1_score': 0.5008474}
confusion matrix:
       0    1
0  42031  328
1    850  591
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.8299922, 'recall': 0.6854417, 'specificity': 0.6854417, 'f1': 0.7356929, 'auroc': 0.94430375, 'binary_precision': 0.6827957, 'binary_recall': 0.37741455, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.48612443}
confusion matrix:
       0    1
0  17949  118
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.88646686, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_11.png
early stop counter: 2
val acc:0.9713447093963623, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 11,now: 2024-06-17 12:35:23.244211,epoch time: 0:14:30.783256,used: 2:44:46.009412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97237444, 'precision': 0.80348396, 'recall': 0.6920153, 'specificity': 0.6920153, 'f1': 0.73413604, 'auroc': 0.9497727, 'binary_precision': 0.62736374, 'binary_recall': 0.39193884, 'binary_specificity': 0.9920918, 'binary_f1_score': 0.48246363}
confusion matrix:
       0    1
0  42026  335
1    875  564
---- Validation: 
scalar performance:
{'acc': 0.97129136, 'precision': 0.83498716, 'recall': 0.67683077, 'specificity': 0.67683077, 'f1': 0.72941226, 'auroc': 0.94365823, 'binary_precision': 0.69340974, 'binary_recall': 0.35958394, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.47358122}
confusion matrix:
       0    1
0  17960  107
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8942088, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_12.png
early stop counter: 3
val acc:0.9712913632392883, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 12,now: 2024-06-17 12:49:59.384013,epoch time: 0:14:36.139802,used: 2:59:22.149214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9721918, 'precision': 0.8003485, 'recall': 0.6929279, 'specificity': 0.6929279, 'f1': 0.73392755, 'auroc': 0.9505737, 'binary_precision': 0.62102956, 'binary_recall': 0.39402363, 'binary_specificity': 0.99183214, 'binary_f1_score': 0.48214287}
confusion matrix:
       0    1
0  42015  346
1    872  567
---- Validation: 
scalar performance:
{'acc': 0.97129136, 'precision': 0.83095556, 'recall': 0.68255293, 'specificity': 0.68255293, 'f1': 0.73346615, 'auroc': 0.9452633, 'binary_precision': 0.6849315, 'binary_recall': 0.37147102, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.48169553}
confusion matrix:
       0    1
0  17952  115
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9508759, 'recall': 0.5306851, 'specificity': 0.5306851, 'f1': 0.5476669, 'auroc': 0.8975399, 'binary_precision': 0.9411765, 'binary_recall': 0.06153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.11552346}
confusion matrix:
      0   1
0  5945   1
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_13.png
early stop counter: 4
val acc:0.9712913632392883, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 13,now: 2024-06-17 13:04:52.664903,epoch time: 0:14:53.280890,used: 3:14:15.430104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97333336, 'precision': 0.8022914, 'recall': 0.73565567, 'specificity': 0.73565567, 'f1': 0.76447225, 'auroc': 0.9541694, 'binary_precision': 0.6220826, 'binary_recall': 0.48125, 'binary_specificity': 0.9900614, 'binary_f1_score': 0.5426782}
confusion matrix:
       0    1
0  41939  421
1    747  693
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.8165263, 'recall': 0.7119342, 'specificity': 0.7119342, 'f1': 0.75291586, 'auroc': 0.94458234, 'binary_precision': 0.6539326, 'binary_recall': 0.43239227, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.5205724}
confusion matrix:
       0    1
0  17913  154
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.94679916, 'recall': 0.52683896, 'specificity': 0.52683896, 'f1': 0.5407336, 'auroc': 0.8949399, 'binary_precision': 0.93333334, 'binary_recall': 0.053846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5945   1
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_14.png
early stop counter: 5
val acc:0.9713980555534363, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 14,now: 2024-06-17 13:19:31.397664,epoch time: 0:14:38.732761,used: 3:28:54.162865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97312784, 'precision': 0.82583296, 'recall': 0.67506224, 'specificity': 0.67506224, 'f1': 0.72597295, 'auroc': 0.948936, 'binary_precision': 0.6732283, 'binary_recall': 0.35600278, 'binary_specificity': 0.9941217, 'binary_f1_score': 0.46572858}
confusion matrix:
       0    1
0  42110  249
1    928  513
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.8305789, 'recall': 0.653361, 'specificity': 0.653361, 'f1': 0.70684725, 'auroc': 0.9443689, 'binary_precision': 0.6862745, 'binary_recall': 0.31203565, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.42900917}
confusion matrix:
       0    1
0  17971   96
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8842255, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_15.png
early stop counter: 6
val acc:0.9701707363128662, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 15,now: 2024-06-17 13:34:03.542650,epoch time: 0:14:32.144986,used: 3:43:26.307851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9723288, 'precision': 0.78513706, 'recall': 0.7613121, 'specificity': 0.7613121, 'f1': 0.7726543, 'auroc': 0.9511787, 'binary_precision': 0.585997, 'binary_recall': 0.5354659, 'binary_specificity': 0.9871583, 'binary_f1_score': 0.5595931}
confusion matrix:
       0    1
0  41818  544
1    668  770
---- Validation: 
scalar performance:
{'acc': 0.97230524, 'precision': 0.8186619, 'recall': 0.73529327, 'specificity': 0.73529327, 'f1': 0.7701074, 'auroc': 0.9458214, 'binary_precision': 0.6565041, 'binary_recall': 0.47994056, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.5545064}
confusion matrix:
       0    1
0  17898  169
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.89757013, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_16.png
early stop counter: 7
val acc:0.9723052382469177, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 16,now: 2024-06-17 13:49:11.932341,epoch time: 0:15:08.389691,used: 3:58:34.697542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9741096, 'precision': 0.8123762, 'recall': 0.7359017, 'specificity': 0.7359017, 'f1': 0.7683357, 'auroc': 0.95197296, 'binary_precision': 0.6422613, 'binary_recall': 0.48091602, 'binary_specificity': 0.9908874, 'binary_f1_score': 0.55}
confusion matrix:
       0    1
0  41973  386
1    748  693
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8440486, 'recall': 0.6836556, 'specificity': 0.6836556, 'f1': 0.73745227, 'auroc': 0.9444004, 'binary_precision': 0.7110482, 'binary_recall': 0.3729569, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.48927873}
confusion matrix:
       0    1
0  17965  102
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.89754426, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_17.png
early stop counter: 8
val acc:0.9720384478569031, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 17,now: 2024-06-17 14:05:32.137426,epoch time: 0:16:20.205085,used: 4:14:54.902627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97212327, 'precision': 0.8414556, 'recall': 0.6282884, 'specificity': 0.6282884, 'f1': 0.68312913, 'auroc': 0.94995415, 'binary_precision': 0.7075472, 'binary_recall': 0.26023594, 'binary_specificity': 0.9963408, 'binary_f1_score': 0.3805175}
confusion matrix:
       0    1
0  42204  155
1   1066  375
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.9054735, 'recall': 0.5745113, 'specificity': 0.5745113, 'f1': 0.61930984, 'auroc': 0.9393411, 'binary_precision': 0.84166664, 'binary_recall': 0.15007429, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.25472888}
confusion matrix:
       0    1
0  18048   19
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.87135136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_18.png
early stop counter: 9
val acc:0.9684631824493408, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 18,now: 2024-06-17 14:23:04.393576,epoch time: 0:17:32.256150,used: 4:32:27.158777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97331053, 'precision': 0.8161534, 'recall': 0.6971985, 'specificity': 0.6971985, 'f1': 0.74174786, 'auroc': 0.95113814, 'binary_precision': 0.6523702, 'binary_recall': 0.40166783, 'binary_specificity': 0.9927292, 'binary_f1_score': 0.49720433}
confusion matrix:
       0    1
0  42053  308
1    861  578
---- Validation: 
scalar performance:
{'acc': 0.9715048, 'precision': 0.8407146, 'recall': 0.6747957, 'specificity': 0.6747957, 'f1': 0.7288445, 'auroc': 0.9420907, 'binary_precision': 0.70501477, 'binary_recall': 0.3551263, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.472332}
confusion matrix:
       0    1
0  17967  100
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8904986, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_19.png
early stop counter: 10
val acc:0.971504807472229, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 19,now: 2024-06-17 14:38:34.169213,epoch time: 0:15:29.775637,used: 4:47:56.934414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.973516, 'precision': 0.80896056, 'recall': 0.7231933, 'specificity': 0.7231933, 'f1': 0.7585589, 'auroc': 0.9507079, 'binary_precision': 0.6362755, 'binary_recall': 0.45523942, 'binary_specificity': 0.9911471, 'binary_f1_score': 0.5307444}
confusion matrix:
       0    1
0  41984  375
1    785  656
---- Validation: 
scalar performance:
{'acc': 0.9722519, 'precision': 0.8452027, 'recall': 0.68734264, 'specificity': 0.68734264, 'f1': 0.7409286, 'auroc': 0.9422014, 'binary_precision': 0.7130919, 'binary_recall': 0.38038632, 'binary_specificity': 0.994299, 'binary_f1_score': 0.496124}
confusion matrix:
       0    1
0  17964  103
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.884002, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_20.png
early stop counter: 11
val acc:0.9722518920898438, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 20,now: 2024-06-17 14:55:02.129681,epoch time: 0:16:27.960468,used: 5:04:24.894882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9727854, 'precision': 0.79598296, 'recall': 0.7352171, 'specificity': 0.7352171, 'f1': 0.76180303, 'auroc': 0.9510674, 'binary_precision': 0.6094987, 'binary_recall': 0.48091602, 'binary_specificity': 0.98951817, 'binary_f1_score': 0.537626}
confusion matrix:
       0    1
0  41915  444
1    748  693
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.83742565, 'recall': 0.6871213, 'specificity': 0.6871213, 'f1': 0.738909, 'auroc': 0.94536865, 'binary_precision': 0.6975477, 'binary_recall': 0.38038632, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.49230766}
confusion matrix:
       0    1
0  17956  111
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.88338834, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_21.png
early stop counter: 12
val acc:0.9718249440193176, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 21,now: 2024-06-17 15:11:43.506175,epoch time: 0:16:41.376494,used: 5:21:06.271376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9742922, 'precision': 0.82842696, 'recall': 0.70670164, 'specificity': 0.70670164, 'f1': 0.7525927, 'auroc': 0.9498496, 'binary_precision': 0.67633927, 'binary_recall': 0.42024964, 'binary_specificity': 0.9931536, 'binary_f1_score': 0.5183918}
confusion matrix:
       0    1
0  42068  290
1    836  606
---- Validation: 
scalar performance:
{'acc': 0.97145146, 'precision': 0.8432342, 'recall': 0.6704764, 'specificity': 0.6704764, 'f1': 0.72543424, 'auroc': 0.9422345, 'binary_precision': 0.71036583, 'binary_recall': 0.346211, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.46553445}
confusion matrix:
       0    1
0  17972   95
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.88832587, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_22.png
early stop counter: 13
val acc:0.971451461315155, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 22,now: 2024-06-17 15:28:17.819314,epoch time: 0:16:34.313139,used: 5:37:40.584515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9724201, 'precision': 0.7883487, 'recall': 0.7514519, 'specificity': 0.7514519, 'f1': 0.7685179, 'auroc': 0.9521445, 'binary_precision': 0.5931255, 'binary_recall': 0.5149202, 'binary_specificity': 0.98798364, 'binary_f1_score': 0.551263}
confusion matrix:
       0    1
0  41850  509
1    699  742
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.8384186, 'recall': 0.6951829, 'specificity': 0.6951829, 'f1': 0.7459289, 'auroc': 0.9424657, 'binary_precision': 0.69895285, 'binary_recall': 0.39673105, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.5061611}
confusion matrix:
       0    1
0  17952  115
1    406  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8844583, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_23.png
early stop counter: 14
val acc:0.972198486328125, best validation acc: 0.9723052382469177, corresponding to test acc:                         0.9613277316093445 / 0.9651950001716614
after epoch: 23,now: 2024-06-17 15:44:56.964959,epoch time: 0:16:39.145645,used: 5:54:19.730160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9739726, 'precision': 0.8096485, 'recall': 0.7352641, 'specificity': 0.7352641, 'f1': 0.76693046, 'auroc': 0.9532923, 'binary_precision': 0.6367837, 'binary_recall': 0.47980502, 'binary_specificity': 0.99072325, 'binary_f1_score': 0.54725975}
confusion matrix:
       0    1
0  41971  393
1    747  689
---- Validation: 
scalar performance:
{'acc': 0.97241193, 'precision': 0.83627224, 'recall': 0.70387685, 'specificity': 0.70387685, 'f1': 0.75243413, 'auroc': 0.94305956, 'binary_precision': 0.69402987, 'binary_recall': 0.41456166, 'binary_specificity': 0.993192, 'binary_f1_score': 0.51906973}
confusion matrix:
       0    1
0  17944  123
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.880108, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_24.png
better model found
persisted
after epoch: 24,now: 2024-06-17 16:01:08.245534,epoch time: 0:16:11.280575,used: 6:10:31.010735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9739498, 'precision': 0.8289571, 'recall': 0.6943825, 'specificity': 0.6943825, 'f1': 0.7429844, 'auroc': 0.94996214, 'binary_precision': 0.6781883, 'binary_recall': 0.3951389, 'binary_specificity': 0.99362606, 'binary_f1_score': 0.49934182}
confusion matrix:
       0    1
0  42090  270
1    871  569
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.85900927, 'recall': 0.66280216, 'specificity': 0.66280216, 'f1': 0.72116375, 'auroc': 0.94226635, 'binary_precision': 0.7424749, 'binary_recall': 0.32986626, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.4567901}
confusion matrix:
       0    1
0  17990   77
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8748145, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_25.png
early stop counter: 1
val acc:0.9718249440193176, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9592329859733582 / 0.9651950001716614
after epoch: 25,now: 2024-06-17 16:16:27.783935,epoch time: 0:15:19.538401,used: 6:25:50.549136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9738813, 'precision': 0.8073318, 'recall': 0.7407937, 'specificity': 0.7407937, 'f1': 0.7696618, 'auroc': 0.95339525, 'binary_precision': 0.6318141, 'binary_recall': 0.4913134, 'binary_specificity': 0.9902741, 'binary_f1_score': 0.5527756}
confusion matrix:
       0    1
0  41949  412
1    732  707
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.8364822, 'recall': 0.698044, 'specificity': 0.698044, 'f1': 0.74778557, 'auroc': 0.9422319, 'binary_precision': 0.6948718, 'binary_recall': 0.4026746, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.50987774}
confusion matrix:
       0    1
0  17948  119
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8753561, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_26.png
early stop counter: 2
val acc:0.972198486328125, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9592329859733582 / 0.9651950001716614
after epoch: 26,now: 2024-06-17 16:32:02.799660,epoch time: 0:15:35.015725,used: 6:41:25.564861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9727626, 'precision': 0.8099781, 'recall': 0.69120896, 'specificity': 0.69120896, 'f1': 0.73533845, 'auroc': 0.95500636, 'binary_precision': 0.64041096, 'binary_recall': 0.38985407, 'binary_specificity': 0.9925639, 'binary_f1_score': 0.48466522}
confusion matrix:
       0    1
0  42046  315
1    878  561
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.85163516, 'recall': 0.64579755, 'specificity': 0.64579755, 'f1': 0.7028595, 'auroc': 0.94121015, 'binary_precision': 0.72893775, 'binary_recall': 0.29569092, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.42071882}
confusion matrix:
       0    1
0  17993   74
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8797409, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_27.png
early stop counter: 3
val acc:0.9707577228546143, best validation acc: 0.9724119305610657, corresponding to test acc:                         0.9592329859733582 / 0.9651950001716614
after epoch: 27,now: 2024-06-17 16:47:56.986792,epoch time: 0:15:54.187132,used: 6:57:19.751993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97442925, 'precision': 0.81647056, 'recall': 0.73640215, 'specificity': 0.73640215, 'f1': 0.77013344, 'auroc': 0.95358, 'binary_precision': 0.65042174, 'binary_recall': 0.48161, 'binary_specificity': 0.9911943, 'binary_f1_score': 0.55342907}
confusion matrix:
       0    1
0  41986  373
1    747  694
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.8318884, 'recall': 0.71832055, 'specificity': 0.71832055, 'f1': 0.76233065, 'auroc': 0.9443319, 'binary_precision': 0.68421054, 'binary_recall': 0.44427934, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.5387388}
confusion matrix:
       0    1
0  17929  138
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.9424446, 'recall': 0.5459857, 'specificity': 0.5459857, 'f1': 0.57410246, 'auroc': 0.89692926, 'binary_precision': 0.9230769, 'binary_recall': 0.092307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.16783217}
confusion matrix:
      0   1
0  5944   2
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_28.png
better model found
persisted
after epoch: 28,now: 2024-06-17 17:03:17.262038,epoch time: 0:15:20.275246,used: 7:12:40.027239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97408676, 'precision': 0.843681, 'recall': 0.67678887, 'specificity': 0.67678887, 'f1': 0.7314746, 'auroc': 0.95133233, 'binary_precision': 0.7087912, 'binary_recall': 0.35858235, 'binary_specificity': 0.9949954, 'binary_f1_score': 0.47623444}
confusion matrix:
       0    1
0  42149  212
1    923  516
---- Validation: 
scalar performance:
{'acc': 0.9705976, 'precision': 0.84845245, 'recall': 0.64499927, 'specificity': 0.64499927, 'f1': 0.7015401, 'auroc': 0.9419481, 'binary_precision': 0.72262776, 'binary_recall': 0.29420504, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.41816258}
confusion matrix:
       0    1
0  17991   76
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.884589, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_29.png
early stop counter: 1
val acc:0.9705976247787476, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.961650013923645 / 0.9651950001716614
after epoch: 29,now: 2024-06-17 17:18:46.146727,epoch time: 0:15:28.884689,used: 7:28:08.911928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9736758, 'precision': 0.8145663, 'recall': 0.71403056, 'specificity': 0.71403056, 'f1': 0.753922, 'auroc': 0.95391893, 'binary_precision': 0.64809084, 'binary_recall': 0.43611112, 'binary_specificity': 0.99195, 'binary_f1_score': 0.5213782}
confusion matrix:
       0    1
0  42019  341
1    812  628
---- Validation: 
scalar performance:
{'acc': 0.97145146, 'precision': 0.8166219, 'recall': 0.71339244, 'specificity': 0.71339244, 'f1': 0.7540166, 'auroc': 0.94326866, 'binary_precision': 0.65401787, 'binary_recall': 0.43536404, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.5227475}
confusion matrix:
       0    1
0  17912  155
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.95463324, 'recall': 0.59590155, 'specificity': 0.59590155, 'f1': 0.650942, 'auroc': 0.89986944, 'binary_precision': 0.9433962, 'binary_recall': 0.1923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5943   3
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_30.png
new oracle model saved
early stop counter: 2
val acc:0.971451461315155, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.961650013923645 / 0.9656783938407898
after epoch: 30,now: 2024-06-17 17:35:40.707093,epoch time: 0:16:54.560366,used: 7:45:03.472294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_09_50_37_seed_1_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:45:03.472294 at 2024-06-17 17:35:40.707093
persisted model performance metric: 

scalar performance:
{'acc': 0.96165, 'precision': 0.9424446, 'recall': 0.5459857, 'specificity': 0.5459857, 'f1': 0.57410246, 'auroc': 0.89692926, 'binary_precision': 0.9230769, 'binary_recall': 0.092307694, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.16783217}
confusion matrix:
      0   1
0  5944   2
1   236  24
oracle model performance metric: 

scalar performance:
{'acc': 0.9656784, 'precision': 0.95463324, 'recall': 0.59590155, 'specificity': 0.59590155, 'f1': 0.650942, 'auroc': 0.89986944, 'binary_precision': 0.9433962, 'binary_recall': 0.1923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5943   3
1   210  50
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   26698 K  |   26697 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16074 K  |   16073 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   26698 K  |   26697 K  |
|       from large pool |      36    |      76    |   10623 K  |   10623 K  |
|       from small pool |    1242    |    1864    |   16074 K  |   16073 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   15155 K  |   15155 K  |
|       from large pool |       5    |      11    |    4127 K  |    4127 K  |
|       from small pool |      30    |     448    |   11028 K  |   11028 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26698 K  |   26698 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16074 K  |   16074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26698 K  |   26698 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16074 K  |   16074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15156 K  |   15156 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11028 K  |   11028 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    790 TiB |    790 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 617915 GiB | 617915 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 617753 GiB | 617753 GiB |
|       from small pool |      0 KiB |  16408 KiB |    161 GiB |    161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   26698 K  |   26698 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16074 K  |   16074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   26698 K  |   26698 K  |
|       from large pool |       2    |      76    |   10623 K  |   10623 K  |
|       from small pool |       0    |    1864    |   16074 K  |   16074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15156 K  |   15156 K  |
|       from large pool |       1    |      11    |    4127 K  |    4127 K  |
|       from small pool |       0    |     448    |   11028 K  |   11028 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045

 Experiment start at: 2024-06-17 17:44:17.531211
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.75402665, 'recall': 0.6255859, 'specificity': 0.6255859, 'f1': 0.6659682, 'auroc': 0.92678773, 'binary_precision': 0.53405994, 'binary_recall': 0.25925925, 'binary_specificity': 0.9919126, 'binary_f1_score': 0.34906498}
confusion matrix:
       0    1
0  41946  342
1   1120  392
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7716006, 'recall': 0.57531637, 'specificity': 0.57531637, 'f1': 0.61369777, 'auroc': 0.9121692, 'binary_precision': 0.5705522, 'binary_recall': 0.15448505, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.24313724}
confusion matrix:
       0   1
0  18101  70
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9837071, 'recall': 0.58264464, 'specificity': 0.58264464, 'f1': 0.63356256, 'auroc': 0.8786919, 'binary_precision': 1.0, 'binary_recall': 0.16528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.28368792}
confusion matrix:
      0   1
0  5997   0
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 18:01:53.403072,epoch time: 0:17:35.871861,used: 0:17:35.871861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96906394, 'precision': 0.7887142, 'recall': 0.6489419, 'specificity': 0.6489419, 'f1': 0.694519, 'auroc': 0.9356456, 'binary_precision': 0.6018277, 'binary_recall': 0.30509597, 'binary_specificity': 0.9927877, 'binary_f1_score': 0.4049188}
confusion matrix:
       0    1
0  41984  305
1   1050  461
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.8141457, 'recall': 0.57916147, 'specificity': 0.57916147, 'f1': 0.62177813, 'auroc': 0.92768806, 'binary_precision': 0.6554054, 'binary_recall': 0.16112956, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.25866663}
confusion matrix:
       0   1
0  18120  51
1    505  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.981919, 'recall': 0.53512394, 'specificity': 0.53512394, 'f1': 0.5564301, 'auroc': 0.8812691, 'binary_precision': 1.0, 'binary_recall': 0.07024793, 'binary_specificity': 1.0, 'binary_f1_score': 0.13127413}
confusion matrix:
      0   1
0  5997   0
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_2.png
better model found
persisted
after epoch: 2,now: 2024-06-17 18:18:40.174482,epoch time: 0:16:46.771410,used: 0:34:22.643271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.7863946, 'recall': 0.6878938, 'specificity': 0.6878938, 'f1': 0.725945, 'auroc': 0.9444436, 'binary_precision': 0.59448415, 'binary_recall': 0.38517538, 'binary_specificity': 0.9906122, 'binary_f1_score': 0.46746987}
confusion matrix:
       0    1
0  41892  397
1    929  582
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.8157398, 'recall': 0.5971312, 'specificity': 0.5971312, 'f1': 0.64456725, 'auroc': 0.9316453, 'binary_precision': 0.65745854, 'binary_recall': 0.19767442, 'binary_specificity': 0.996588, 'binary_f1_score': 0.30395916}
confusion matrix:
       0    1
0  18109   62
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.8822192, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_3.png
better model found
persisted
after epoch: 3,now: 2024-06-17 18:38:26.742405,epoch time: 0:19:46.567923,used: 0:54:09.211194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.7848777, 'recall': 0.7278007, 'specificity': 0.7278007, 'f1': 0.75284374, 'auroc': 0.94689727, 'binary_precision': 0.5886761, 'binary_recall': 0.46728355, 'binary_specificity': 0.9883179, 'binary_f1_score': 0.5210022}
confusion matrix:
       0    1
0  41793  494
1    806  707
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.7784207, 'recall': 0.6710116, 'specificity': 0.6710116, 'f1': 0.71075094, 'auroc': 0.93686354, 'binary_precision': 0.5780822, 'binary_recall': 0.35049835, 'binary_specificity': 0.99152493, 'binary_f1_score': 0.43640125}
confusion matrix:
       0    1
0  18017  154
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.967378, 'recall': 0.5639662, 'specificity': 0.5639662, 'f1': 0.60445297, 'auroc': 0.89054877, 'binary_precision': 0.96875, 'binary_recall': 0.12809917, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.22627737}
confusion matrix:
      0   1
0  5996   1
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_4.png
early stop counter: 1
val acc:0.9709689617156982, best validation acc: 0.9709689617156982, corresponding to test acc:                         0.9624940156936646 / 0.9676229953765869
after epoch: 4,now: 2024-06-17 19:00:04.076177,epoch time: 0:21:37.333772,used: 1:15:46.544966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9706621, 'precision': 0.7929772, 'recall': 0.70930797, 'specificity': 0.70930797, 'f1': 0.74350834, 'auroc': 0.94689995, 'binary_precision': 0.606174, 'binary_recall': 0.42857143, 'binary_specificity': 0.9900445, 'binary_f1_score': 0.502131}
confusion matrix:
       0    1
0  41867  421
1    864  648
---- Validation: 
scalar performance:
{'acc': 0.97150165, 'precision': 0.8296864, 'recall': 0.6014216, 'specificity': 0.6014216, 'f1': 0.6510889, 'auroc': 0.9341905, 'binary_precision': 0.68508285, 'binary_recall': 0.20598006, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.31673053}
confusion matrix:
       0    1
0  18114   57
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.91864264, 'recall': 0.51437944, 'specificity': 0.51437944, 'f1': 0.51835, 'auroc': 0.88548887, 'binary_precision': 0.875, 'binary_recall': 0.02892562, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.055999998}
confusion matrix:
      0  1
0  5996  1
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 19:17:11.823682,epoch time: 0:17:07.747505,used: 1:32:54.292471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.970548, 'precision': 0.7861402, 'recall': 0.73284477, 'specificity': 0.73284477, 'f1': 0.75648165, 'auroc': 0.94768906, 'binary_precision': 0.5908347, 'binary_recall': 0.47751322, 'binary_specificity': 0.9881763, 'binary_f1_score': 0.52816385}
confusion matrix:
       0    1
0  41788  500
1    790  722
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.7756419, 'recall': 0.68790317, 'specificity': 0.68790317, 'f1': 0.7227144, 'auroc': 0.93810284, 'binary_precision': 0.5714286, 'binary_recall': 0.38538206, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.46031746}
confusion matrix:
       0    1
0  17997  174
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9711492, 'precision': 0.9510894, 'recall': 0.6380129, 'specificity': 0.6380129, 'f1': 0.7059769, 'auroc': 0.8895865, 'binary_precision': 0.9305556, 'binary_recall': 0.2768595, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.42675158}
confusion matrix:
      0   1
0  5992   5
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_6.png
new oracle model saved
early stop counter: 1
val acc:0.9710221886634827, best validation acc: 0.9715016484260559, corresponding to test acc:                         0.9621734023094177 / 0.971149206161499
after epoch: 6,now: 2024-06-17 19:37:26.364090,epoch time: 0:20:14.540408,used: 1:53:08.832879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9711644, 'precision': 0.8131385, 'recall': 0.6766177, 'specificity': 0.6766177, 'f1': 0.72421134, 'auroc': 0.9462662, 'binary_precision': 0.64880955, 'binary_recall': 0.3602115, 'binary_specificity': 0.9930239, 'binary_f1_score': 0.46323842}
confusion matrix:
       0    1
0  41992  295
1    968  545
---- Validation: 
scalar performance:
{'acc': 0.97214085, 'precision': 0.8287806, 'recall': 0.62102497, 'specificity': 0.62102497, 'f1': 0.6735881, 'auroc': 0.93771696, 'binary_precision': 0.68202764, 'binary_recall': 0.24584718, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.36141637}
confusion matrix:
       0    1
0  18102   69
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.981919, 'recall': 0.53512394, 'specificity': 0.53512394, 'f1': 0.5564301, 'auroc': 0.8810483, 'binary_precision': 1.0, 'binary_recall': 0.07024793, 'binary_specificity': 1.0, 'binary_f1_score': 0.13127413}
confusion matrix:
      0   1
0  5997   0
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 20:00:54.072617,epoch time: 0:23:27.708527,used: 2:16:36.541406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97084475, 'precision': 0.8016984, 'recall': 0.6894304, 'specificity': 0.6894304, 'f1': 0.73156995, 'auroc': 0.94982576, 'binary_precision': 0.625, 'binary_recall': 0.3871608, 'binary_specificity': 0.9917, 'binary_f1_score': 0.47813648}
confusion matrix:
       0    1
0  41938  351
1    926  585
---- Validation: 
scalar performance:
{'acc': 0.97235394, 'precision': 0.8293586, 'recall': 0.62675637, 'specificity': 0.62675637, 'f1': 0.67990464, 'auroc': 0.9379377, 'binary_precision': 0.68281937, 'binary_recall': 0.25747508, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.3739445}
confusion matrix:
       0    1
0  18099   72
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.8795734, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_8.png
better model found
persisted
after epoch: 8,now: 2024-06-17 20:21:19.179966,epoch time: 0:20:25.107349,used: 2:37:01.648755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.971758, 'precision': 0.7929306, 'recall': 0.7620034, 'specificity': 0.7620034, 'f1': 0.776518, 'auroc': 0.9516391, 'binary_precision': 0.6023739, 'binary_recall': 0.53668207, 'binary_specificity': 0.9873247, 'binary_f1_score': 0.5676337}
confusion matrix:
       0    1
0  41751  536
1    701  812
---- Validation: 
scalar performance:
{'acc': 0.9738454, 'precision': 0.8091544, 'recall': 0.7102408, 'specificity': 0.7102408, 'f1': 0.74948776, 'auroc': 0.9418115, 'binary_precision': 0.63703704, 'binary_recall': 0.42857143, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.51241314}
confusion matrix:
       0    1
0  18024  147
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9816867, 'recall': 0.5289256, 'specificity': 0.5289256, 'f1': 0.5453601, 'auroc': 0.8758975, 'binary_precision': 1.0, 'binary_recall': 0.05785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.10937501}
confusion matrix:
      0   1
0  5997   0
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 20:38:14.874298,epoch time: 0:16:55.694332,used: 2:53:57.343087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.971621, 'precision': 0.79199356, 'recall': 0.75811625, 'specificity': 0.75811625, 'f1': 0.77390647, 'auroc': 0.9495586, 'binary_precision': 0.6007519, 'binary_recall': 0.52878886, 'binary_specificity': 0.98744357, 'binary_f1_score': 0.562478}
confusion matrix:
       0    1
0  41758  531
1    712  799
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.79561245, 'recall': 0.71218216, 'specificity': 0.71218216, 'f1': 0.7464422, 'auroc': 0.94148386, 'binary_precision': 0.6098131, 'binary_recall': 0.43355483, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.5067961}
confusion matrix:
       0    1
0  18004  167
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.94881546, 'recall': 0.5823945, 'specificity': 0.5823945, 'f1': 0.6319444, 'auroc': 0.8824948, 'binary_precision': 0.9302326, 'binary_recall': 0.16528925, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.28070176}
confusion matrix:
      0   1
0  5994   3
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_10.png
early stop counter: 1
val acc:0.9729398488998413, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 10,now: 2024-06-17 20:58:50.401645,epoch time: 0:20:35.527347,used: 3:14:32.870434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9725114, 'precision': 0.8132482, 'recall': 0.72160697, 'specificity': 0.72160697, 'f1': 0.7588609, 'auroc': 0.95262897, 'binary_precision': 0.6458923, 'binary_recall': 0.45208195, 'binary_specificity': 0.991132, 'binary_f1_score': 0.5318818}
confusion matrix:
       0    1
0  41912  375
1    829  684
---- Validation: 
scalar performance:
{'acc': 0.97278005, 'precision': 0.81098413, 'recall': 0.66632587, 'specificity': 0.66632587, 'f1': 0.7150047, 'auroc': 0.942718, 'binary_precision': 0.6435331, 'binary_recall': 0.33887044, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.44396085}
confusion matrix:
       0    1
0  18058  113
1    398  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9397851, 'recall': 0.52264386, 'specificity': 0.52264386, 'f1': 0.5338175, 'auroc': 0.87856674, 'binary_precision': 0.9166667, 'binary_recall': 0.045454547, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08661417}
confusion matrix:
      0   1
0  5996   1
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_11.png
early stop counter: 2
val acc:0.9727800488471985, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 11,now: 2024-06-17 21:21:06.594499,epoch time: 0:22:16.192854,used: 3:36:49.063288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9713242, 'precision': 0.8307642, 'recall': 0.65275604, 'specificity': 0.65275604, 'f1': 0.7064117, 'auroc': 0.9500722, 'binary_precision': 0.6856725, 'binary_recall': 0.31059602, 'binary_specificity': 0.9949161, 'binary_f1_score': 0.42752963}
confusion matrix:
       0    1
0  42075  215
1   1041  469
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.8537602, 'recall': 0.60584956, 'specificity': 0.60584956, 'f1': 0.65873843, 'auroc': 0.9408429, 'binary_precision': 0.73295456, 'binary_recall': 0.21428572, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.33161953}
confusion matrix:
       0    1
0  18124   47
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.87382376, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_12.png
early stop counter: 3
val acc:0.97230064868927, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 12,now: 2024-06-17 21:44:27.949996,epoch time: 0:23:21.355497,used: 4:00:10.418785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97171235, 'precision': 0.8042214, 'recall': 0.71654797, 'specificity': 0.71654797, 'f1': 0.7523179, 'auroc': 0.9536554, 'binary_precision': 0.628169, 'binary_recall': 0.44246033, 'binary_specificity': 0.99063563, 'binary_f1_score': 0.5192084}
confusion matrix:
       0    1
0  41892  396
1    843  669
---- Validation: 
scalar performance:
{'acc': 0.97278005, 'precision': 0.81273854, 'recall': 0.6631137, 'specificity': 0.6631137, 'f1': 0.71256477, 'auroc': 0.9402721, 'binary_precision': 0.64724916, 'binary_recall': 0.33222592, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.43907794}
confusion matrix:
       0    1
0  18062  109
1    402  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.9468972, 'recall': 0.55355227, 'specificity': 0.55355227, 'f1': 0.5873678, 'auroc': 0.87876153, 'binary_precision': 0.9285714, 'binary_recall': 0.10743801, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19259258}
confusion matrix:
      0   1
0  5995   2
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_13.png
early stop counter: 4
val acc:0.9727800488471985, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 13,now: 2024-06-17 22:07:22.742919,epoch time: 0:22:54.792923,used: 4:23:05.211708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9719863, 'precision': 0.79298985, 'recall': 0.770283, 'specificity': 0.770283, 'f1': 0.78113216, 'auroc': 0.9521793, 'binary_precision': 0.60187185, 'binary_recall': 0.5536424, 'binary_specificity': 0.98692364, 'binary_f1_score': 0.5767506}
confusion matrix:
       0    1
0  41737  553
1    674  836
---- Validation: 
scalar performance:
{'acc': 0.9738454, 'precision': 0.805091, 'recall': 0.72148347, 'specificity': 0.72148347, 'f1': 0.75607795, 'auroc': 0.94103855, 'binary_precision': 0.6281755, 'binary_recall': 0.45182723, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.52560383}
confusion matrix:
       0    1
0  18010  161
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.9426907, 'recall': 0.5699978, 'specificity': 0.5699978, 'f1': 0.6132155, 'auroc': 0.8725302, 'binary_precision': 0.9189189, 'binary_recall': 0.14049587, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2437276}
confusion matrix:
      0   1
0  5994   3
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_14.png
early stop counter: 5
val acc:0.9738454222679138, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 14,now: 2024-06-17 22:26:50.162789,epoch time: 0:19:27.419870,used: 4:42:32.631578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97212327, 'precision': 0.80060244, 'recall': 0.745623, 'specificity': 0.745623, 'f1': 0.77007675, 'auroc': 0.9528438, 'binary_precision': 0.6188925, 'binary_recall': 0.50231326, 'binary_specificity': 0.9889328, 'binary_f1_score': 0.55454206}
confusion matrix:
       0    1
0  41819  468
1    753  760
---- Validation: 
scalar performance:
{'acc': 0.97331274, 'precision': 0.8091552, 'recall': 0.68988943, 'specificity': 0.68988943, 'f1': 0.7341032, 'auroc': 0.9416566, 'binary_precision': 0.63835615, 'binary_recall': 0.38704318, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.48190278}
confusion matrix:
       0    1
0  18039  132
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.9308846, 'recall': 0.5534689, 'specificity': 0.5534689, 'f1': 0.5869707, 'auroc': 0.87585926, 'binary_precision': 0.8965517, 'binary_recall': 0.10743801, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19188192}
confusion matrix:
      0   1
0  5994   3
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_15.png
early stop counter: 6
val acc:0.9733127355575562, best validation acc: 0.9738454222679138, corresponding to test acc:                         0.9634556770324707 / 0.971149206161499
after epoch: 15,now: 2024-06-17 22:48:04.381539,epoch time: 0:21:14.218750,used: 5:03:46.850328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9726712, 'precision': 0.8044725, 'recall': 0.7530762, 'specificity': 0.7530762, 'f1': 0.77617615, 'auroc': 0.9549365, 'binary_precision': 0.6261009, 'binary_recall': 0.51719576, 'binary_specificity': 0.9889567, 'binary_f1_score': 0.5664614}
confusion matrix:
       0    1
0  41821  467
1    730  782
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.8302367, 'recall': 0.67662287, 'specificity': 0.67662287, 'f1': 0.72839, 'auroc': 0.94252527, 'binary_precision': 0.681388, 'binary_recall': 0.358804, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.47007617}
confusion matrix:
       0    1
0  18070  101
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.98184156, 'recall': 0.53305787, 'specificity': 0.53305787, 'f1': 0.55276835, 'auroc': 0.87473726, 'binary_precision': 1.0, 'binary_recall': 0.0661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.124031}
confusion matrix:
      0   1
0  5997   0
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 23:04:02.981271,epoch time: 0:15:58.599732,used: 5:19:45.450060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97118723, 'precision': 0.79299784, 'recall': 0.7334947, 'specificity': 0.7334947, 'f1': 0.75955373, 'auroc': 0.95226836, 'binary_precision': 0.6045151, 'binary_recall': 0.4781746, 'binary_specificity': 0.9888148, 'binary_f1_score': 0.53397346}
confusion matrix:
       0    1
0  41815  473
1    789  723
---- Validation: 
scalar performance:
{'acc': 0.97246045, 'precision': 0.799802, 'recall': 0.6782065, 'specificity': 0.6782065, 'f1': 0.7222548, 'auroc': 0.9386493, 'binary_precision': 0.6203966, 'binary_recall': 0.36378738, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.45863876}
confusion matrix:
       0    1
0  18037  134
1    383  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.93887997, 'recall': 0.56379944, 'specificity': 0.56379944, 'f1': 0.60354984, 'auroc': 0.86577606, 'binary_precision': 0.9117647, 'binary_recall': 0.12809917, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.22463769}
confusion matrix:
      0   1
0  5994   3
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_17.png
early stop counter: 1
val acc:0.9724604487419128, best validation acc: 0.9740585088729858, corresponding to test acc:                         0.9637762308120728 / 0.971149206161499
after epoch: 17,now: 2024-06-17 23:23:15.011742,epoch time: 0:19:12.030471,used: 5:38:57.480531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.973105, 'precision': 0.8233298, 'recall': 0.717772, 'specificity': 0.717772, 'f1': 0.75934696, 'auroc': 0.95138174, 'binary_precision': 0.66633564, 'binary_recall': 0.44348976, 'binary_specificity': 0.9920543, 'binary_f1_score': 0.5325397}
confusion matrix:
       0    1
0  41951  336
1    842  671
---- Validation: 
scalar performance:
{'acc': 0.97395194, 'precision': 0.82001203, 'recall': 0.69021964, 'specificity': 0.69021964, 'f1': 0.7372971, 'auroc': 0.9422785, 'binary_precision': 0.66005665, 'binary_recall': 0.38704318, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.4879581}
confusion matrix:
       0    1
0  18051  120
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9816867, 'recall': 0.5289256, 'specificity': 0.5289256, 'f1': 0.5453601, 'auroc': 0.8653662, 'binary_precision': 1.0, 'binary_recall': 0.05785124, 'binary_specificity': 1.0, 'binary_f1_score': 0.10937501}
confusion matrix:
      0   1
0  5997   0
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_18.png
early stop counter: 2
val acc:0.9739519357681274, best validation acc: 0.9740585088729858, corresponding to test acc:                         0.9637762308120728 / 0.971149206161499
after epoch: 18,now: 2024-06-17 23:44:41.987882,epoch time: 0:21:26.976140,used: 6:00:24.456671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9725799, 'precision': 0.82003725, 'recall': 0.70724034, 'specificity': 0.70724034, 'f1': 0.7505151, 'auroc': 0.9541943, 'binary_precision': 0.66045547, 'binary_recall': 0.42223692, 'binary_specificity': 0.9922438, 'binary_f1_score': 0.5151393}
confusion matrix:
       0    1
0  41961  328
1    873  638
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.82967365, 'recall': 0.6806931, 'specificity': 0.6806931, 'f1': 0.7317812, 'auroc': 0.94116104, 'binary_precision': 0.68, 'binary_recall': 0.36710963, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.4768069}
confusion matrix:
       0    1
0  18067  104
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9312972, 'recall': 0.51851165, 'specificity': 0.51851165, 'f1': 0.5261445, 'auroc': 0.87090254, 'binary_precision': 0.9, 'binary_recall': 0.037190083, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.071428575}
confusion matrix:
      0  1
0  5996  1
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_19.png
better model found
persisted
after epoch: 19,now: 2024-06-18 00:02:15.331835,epoch time: 0:17:33.343953,used: 6:17:57.800624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_17_44_17_seed_2_21329045
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9730137, 'precision': 0.82139575, 'recall': 0.7184974, 'specificity': 0.7184974, 'f1': 0.7592713, 'auroc': 0.95511234, 'binary_precision': 0.66240156, 'binary_recall': 0.44510582, 'binary_specificity': 0.99188894, 'binary_f1_score': 0.5324367}
confusion matrix:
       0    1
0  41945  343
1    839  673
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.8420971, 'recall': 0.6613649, 'specificity': 0.6613649, 'f1': 0.71696836, 'auroc': 0.9398165, 'binary_precision': 0.7060932, 'binary_recall': 0.32724252, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.4472191}
confusion matrix:
       0    1
0  18089   82
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.92566437, 'recall': 0.5164455, 'specificity': 0.5164455, 'f1': 0.5222626, 'auroc': 0.8695913, 'binary_precision': 0.8888889, 'binary_recall': 0.03305785, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.063745014}
confusion matrix:
      0  1
0  5996  1
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21329045_20.png
[Tue Jun 18 00:18:41 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre3/rule_results/3.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 87218176 vs 87218008
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
