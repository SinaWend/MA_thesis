Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982

 Experiment start at: 2024-06-05 22:52:07.424990
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97326, 'precision': 0.79371744, 'recall': 0.79699016, 'specificity': 0.79699016, 'f1': 0.79534376, 'auroc': 0.96608126, 'binary_precision': 0.6010746, 'binary_recall': 0.6080163, 'binary_specificity': 0.98596406, 'binary_f1_score': 0.60452545}
confusion matrix:
       0    1
0  41726  594
1    577  895
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.8199359, 'recall': 0.74195504, 'specificity': 0.74195504, 'f1': 0.7750442, 'auroc': 0.9635821, 'binary_precision': 0.65767634, 'binary_recall': 0.49300155, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.56355554}
confusion matrix:
       0    1
0  17984  165
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.92488706, 'recall': 0.6009489, 'specificity': 0.6009489, 'f1': 0.6562939, 'auroc': 0.9485444, 'binary_precision': 0.8833333, 'binary_recall': 0.20306513, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.33021805}
confusion matrix:
      0   1
0  5990   7
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:31:05.319958,epoch time: 0:38:57.894968,used: 0:38:57.894968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.979905, 'precision': 0.8539263, 'recall': 0.8245738, 'specificity': 0.8245738, 'f1': 0.8385594, 'auroc': 0.9785507, 'binary_precision': 0.7197026, 'binary_recall': 0.6580557, 'binary_specificity': 0.9910919, 'binary_f1_score': 0.6875}
confusion matrix:
       0    1
0  41944  377
1    503  968
---- Validation: 
scalar performance:
{'acc': 0.9780226, 'precision': 0.8605284, 'recall': 0.7748562, 'specificity': 0.7748562, 'f1': 0.8114302, 'auroc': 0.97262335, 'binary_precision': 0.7366255, 'binary_recall': 0.55676514, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.63418955}
confusion matrix:
       0    1
0  18021  128
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8845907, 'recall': 0.53981304, 'specificity': 0.53981304, 'f1': 0.56315356, 'auroc': 0.9562792, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5992   5
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_2.png
better model found
persisted
after epoch: 2,now: 2024-06-06 00:08:27.049438,epoch time: 0:37:21.729480,used: 1:16:19.624448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9804302, 'precision': 0.8327205, 'recall': 0.9009625, 'specificity': 0.9009625, 'f1': 0.8633558, 'auroc': 0.9846939, 'binary_precision': 0.6718925, 'binary_recall': 0.8157716, 'binary_specificity': 0.9861534, 'binary_f1_score': 0.73687446}
confusion matrix:
       0     1
0  41735   586
1    271  1200
---- Validation: 
scalar performance:
{'acc': 0.9808429, 'precision': 0.8423141, 'recall': 0.8903248, 'specificity': 0.8903248, 'f1': 0.8645934, 'auroc': 0.9778539, 'binary_precision': 0.69199455, 'binary_recall': 0.7931571, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.7391304}
confusion matrix:
       0    1
0  17922  227
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8596641, 'recall': 0.63593006, 'specificity': 0.63593006, 'f1': 0.69292176, 'auroc': 0.957541, 'binary_precision': 0.75, 'binary_recall': 0.27586207, 'binary_specificity': 0.995998, 'binary_f1_score': 0.40336132}
confusion matrix:
      0   1
0  5973  24
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 00:45:47.071282,epoch time: 0:37:20.021844,used: 1:53:39.646292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98239404, 'precision': 0.85185313, 'recall': 0.8957448, 'specificity': 0.8957448, 'f1': 0.8723903, 'auroc': 0.9871368, 'binary_precision': 0.71058965, 'binary_recall': 0.8028552, 'binary_specificity': 0.98863447, 'binary_f1_score': 0.75391}
confusion matrix:
       0     1
0  41840   481
1    290  1181
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.8867332, 'recall': 0.85880995, 'specificity': 0.85880995, 'f1': 0.87220407, 'auroc': 0.97803426, 'binary_precision': 0.7831933, 'binary_recall': 0.7247278, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.75282717}
confusion matrix:
       0    1
0  18020  129
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.88423884, 'recall': 0.57771033, 'specificity': 0.57771033, 'f1': 0.6219871, 'auroc': 0.9562053, 'binary_precision': 0.8039216, 'binary_recall': 0.15708812, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2628205}
confusion matrix:
      0   1
0  5987  10
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 01:23:12.050147,epoch time: 0:37:24.978865,used: 2:31:04.625157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9844264, 'precision': 0.8856822, 'recall': 0.8699788, 'specificity': 0.8699788, 'f1': 0.8776535, 'auroc': 0.9902154, 'binary_precision': 0.78014183, 'binary_recall': 0.7472826, 'binary_specificity': 0.9926749, 'binary_f1_score': 0.7633588}
confusion matrix:
       0     1
0  42010   310
1    372  1100
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.89438593, 'recall': 0.8706669, 'specificity': 0.8706669, 'f1': 0.8821275, 'auroc': 0.98282516, 'binary_precision': 0.7976783, 'binary_recall': 0.748056, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.7720706}
confusion matrix:
       0    1
0  18027  122
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.9544456, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 02:00:51.447952,epoch time: 0:37:39.397805,used: 3:08:44.022962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98819417, 'precision': 0.93127984, 'recall': 0.87865114, 'specificity': 0.87865114, 'f1': 0.90312326, 'auroc': 0.99279046, 'binary_precision': 0.8708171, 'binary_recall': 0.7612245, 'binary_specificity': 0.9960777, 'binary_f1_score': 0.81234115}
confusion matrix:
       0     1
0  42156   166
1    351  1119
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.91615665, 'recall': 0.8445252, 'specificity': 0.8445252, 'f1': 0.87670124, 'auroc': 0.9808608, 'binary_precision': 0.8431002, 'binary_recall': 0.69362366, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7610921}
confusion matrix:
       0    1
0  18066   83
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.871239, 'recall': 0.5794593, 'specificity': 0.5794593, 'f1': 0.6238669, 'auroc': 0.9541564, 'binary_precision': 0.7777778, 'binary_recall': 0.16091955, 'binary_specificity': 0.997999, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5985  12
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 02:38:08.941812,epoch time: 0:37:17.493860,used: 3:46:01.516822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98753196, 'precision': 0.89835596, 'recall': 0.9134953, 'specificity': 0.9134953, 'f1': 0.90577245, 'auroc': 0.9937818, 'binary_precision': 0.8024853, 'binary_recall': 0.8341265, 'binary_specificity': 0.9928641, 'binary_f1_score': 0.8180001}
confusion matrix:
       0     1
0  42019   302
1    244  1227
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.90825117, 'recall': 0.8750784, 'specificity': 0.8750784, 'f1': 0.8909044, 'auroc': 0.9809711, 'binary_precision': 0.82512736, 'binary_recall': 0.755832, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.7889611}
confusion matrix:
       0    1
0  18046  103
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.92794454, 'recall': 0.5781272, 'specificity': 0.5781272, 'f1': 0.62433594, 'auroc': 0.95410573, 'binary_precision': 0.8913044, 'binary_recall': 0.15708812, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.26710096}
confusion matrix:
      0   1
0  5992   5
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 03:15:35.404944,epoch time: 0:37:26.463132,used: 4:23:27.979954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847461, 'precision': 0.8644116, 'recall': 0.9228809, 'specificity': 0.9228809, 'f1': 0.8912746, 'auroc': 0.99208504, 'binary_precision': 0.7338381, 'binary_recall': 0.8565602, 'binary_specificity': 0.9892016, 'binary_f1_score': 0.79046416}
confusion matrix:
       0     1
0  41864   457
1    211  1260
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.8684751, 'recall': 0.89328504, 'specificity': 0.89328504, 'f1': 0.88043904, 'auroc': 0.9818074, 'binary_precision': 0.74418604, 'binary_recall': 0.7962675, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.7693463}
confusion matrix:
       0    1
0  17973  176
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.81986356, 'recall': 0.5356481, 'specificity': 0.5356481, 'f1': 0.55547976, 'auroc': 0.9354254, 'binary_precision': 0.6785714, 'binary_recall': 0.07279693, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13148788}
confusion matrix:
      0   1
0  5988   9
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_8.png
early stop counter: 1
val acc:0.9836632609367371, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9640460014343262 / 0.9659635424613953
after epoch: 8,now: 2024-06-06 03:53:11.739069,epoch time: 0:37:36.334125,used: 5:01:04.314079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9898383, 'precision': 0.96708226, 'recall': 0.8704838, 'specificity': 0.8704838, 'f1': 0.91281235, 'auroc': 0.996129, 'binary_precision': 0.9430544, 'binary_recall': 0.7425272, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.8308628}
confusion matrix:
       0     1
0  42254    66
1    379  1093
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.96032065, 'recall': 0.79941165, 'specificity': 0.79941165, 'f1': 0.86164284, 'auroc': 0.9798762, 'binary_precision': 0.9346247, 'binary_recall': 0.60031104, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.73106056}
confusion matrix:
       0    1
0  18122   27
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.9164597, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_9.png
early stop counter: 2
val acc:0.9848871827125549, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9640460014343262 / 0.9659635424613953
after epoch: 9,now: 2024-06-06 04:30:25.900863,epoch time: 0:37:14.161794,used: 5:38:18.475873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.95137894, 'recall': 0.89902556, 'specificity': 0.89902556, 'f1': 0.9234688, 'auroc': 0.9961721, 'binary_precision': 0.90965253, 'binary_recall': 0.80081576, 'binary_specificity': 0.9972354, 'binary_f1_score': 0.8517715}
confusion matrix:
       0     1
0  42204   117
1    293  1178
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9228026, 'recall': 0.83394176, 'specificity': 0.83394176, 'f1': 0.87275124, 'auroc': 0.98045266, 'binary_precision': 0.85714287, 'binary_recall': 0.6718507, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7532693}
confusion matrix:
       0    1
0  18077   72
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.92529994, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_10.png
early stop counter: 3
val acc:0.9849404096603394, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9640460014343262 / 0.9659635424613953
after epoch: 10,now: 2024-06-06 05:07:57.915420,epoch time: 0:37:32.014557,used: 6:15:50.490430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.9419663, 'recall': 0.9419663, 'specificity': 0.9419663, 'f1': 0.9419663, 'auroc': 0.9973862, 'binary_precision': 0.8878314, 'binary_recall': 0.8878314, 'binary_specificity': 0.9961012, 'binary_f1_score': 0.88783145}
confusion matrix:
       0     1
0  42156   165
1    165  1306
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9212117, 'recall': 0.85318905, 'specificity': 0.85318905, 'f1': 0.88397706, 'auroc': 0.9824583, 'binary_precision': 0.85261196, 'binary_recall': 0.71073097, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.77523327}
confusion matrix:
       0    1
0  18070   79
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7735176, 'recall': 0.53156656, 'specificity': 0.53156656, 'f1': 0.5481512, 'auroc': 0.9364068, 'binary_precision': 0.5862069, 'binary_recall': 0.0651341, 'binary_specificity': 0.997999, 'binary_f1_score': 0.11724138}
confusion matrix:
      0   1
0  5985  12
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_11.png
early stop counter: 4
val acc:0.9858982563018799, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9640460014343262 / 0.9659635424613953
after epoch: 11,now: 2024-06-06 05:45:27.998996,epoch time: 0:37:30.083576,used: 6:53:20.574006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9909116, 'precision': 0.97052133, 'recall': 0.8847314, 'specificity': 0.8847314, 'f1': 0.92301285, 'auroc': 0.99693376, 'binary_precision': 0.948954, 'binary_recall': 0.7709041, 'binary_specificity': 0.99855864, 'binary_f1_score': 0.85071266}
confusion matrix:
       0     1
0  42260    61
1    337  1134
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.94765866, 'recall': 0.7959982, 'specificity': 0.7959982, 'f1': 0.8552668, 'auroc': 0.98070455, 'binary_precision': 0.9095238, 'binary_recall': 0.5940902, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7187206}
confusion matrix:
       0    1
0  18111   38
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.91611844, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_12.png
early stop counter: 5
val acc:0.9840889573097229, best validation acc: 0.9861643314361572, corresponding to test acc:                         0.9640460014343262 / 0.9659635424613953
after epoch: 12,now: 2024-06-06 06:22:38.048141,epoch time: 0:37:10.049145,used: 7:30:30.623151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.993355, 'precision': 0.9755802, 'recall': 0.919515, 'specificity': 0.919515, 'f1': 0.94566256, 'auroc': 0.99836874, 'binary_precision': 0.9566899, 'binary_recall': 0.84035325, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.8947559}
confusion matrix:
       0     1
0  42264    56
1    235  1237
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.94250137, 'recall': 0.86162627, 'specificity': 0.86162627, 'f1': 0.89768696, 'auroc': 0.98287225, 'binary_precision': 0.89463603, 'binary_recall': 0.7262831, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.80171674}
confusion matrix:
       0    1
0  18094   55
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.88427603, 'recall': 0.5473925, 'specificity': 0.5473925, 'f1': 0.57571787, 'auroc': 0.939754, 'binary_precision': 0.8064516, 'binary_recall': 0.09578544, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.17123288}
confusion matrix:
      0   1
0  5991   6
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_13.png
better model found
persisted
after epoch: 13,now: 2024-06-06 07:00:00.724713,epoch time: 0:37:22.676572,used: 8:07:53.299723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9935148, 'precision': 0.96330166, 'recall': 0.9346792, 'specificity': 0.9346792, 'f1': 0.9484996, 'auroc': 0.99816763, 'binary_precision': 0.9310595, 'binary_recall': 0.87160325, 'binary_specificity': 0.99775517, 'binary_f1_score': 0.90035087}
confusion matrix:
       0     1
0  42225    95
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.98696256, 'precision': 0.92137825, 'recall': 0.8724914, 'specificity': 0.8724914, 'f1': 0.89530885, 'auroc': 0.98166597, 'binary_precision': 0.8515901, 'binary_recall': 0.7496112, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.79735315}
confusion matrix:
       0    1
0  18065   84
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.93437874, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_14.png
early stop counter: 1
val acc:0.9869625568389893, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 14,now: 2024-06-06 07:37:22.924481,epoch time: 0:37:22.199768,used: 8:45:15.499491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99257857, 'precision': 0.9517805, 'recall': 0.9318998, 'specificity': 0.9318998, 'f1': 0.94159913, 'auroc': 0.99760634, 'binary_precision': 0.90818506, 'binary_recall': 0.8668478, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.8870351}
confusion matrix:
       0     1
0  42191   129
1    196  1276
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9275185, 'recall': 0.85263187, 'specificity': 0.85263187, 'f1': 0.88620096, 'auroc': 0.98226297, 'binary_precision': 0.86527514, 'binary_recall': 0.70917577, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.77948713}
confusion matrix:
       0    1
0  18078   71
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7800417, 'recall': 0.5223215, 'specificity': 0.5223215, 'f1': 0.53220195, 'auroc': 0.89166296, 'binary_precision': 0.6, 'binary_recall': 0.04597701, 'binary_specificity': 0.998666, 'binary_f1_score': 0.085409254}
confusion matrix:
      0   1
0  5989   8
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_15.png
early stop counter: 2
val acc:0.9862707257270813, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 15,now: 2024-06-06 08:14:25.452758,epoch time: 0:37:02.528277,used: 9:22:18.027768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9938345, 'precision': 0.9665129, 'recall': 0.9364414, 'specificity': 0.9364414, 'f1': 0.9509386, 'auroc': 0.99864066, 'binary_precision': 0.93736345, 'binary_recall': 0.874915, 'binary_specificity': 0.9979679, 'binary_f1_score': 0.9050633}
confusion matrix:
       0     1
0  42235    86
1    184  1287
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.92969346, 'recall': 0.8511593, 'specificity': 0.8511593, 'f1': 0.88617116, 'auroc': 0.98305273, 'binary_precision': 0.8697318, 'binary_recall': 0.7060653, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7793991}
confusion matrix:
       0    1
0  18081   68
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.9333351, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_16.png
early stop counter: 3
val acc:0.9863239526748657, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 16,now: 2024-06-06 08:51:47.862062,epoch time: 0:37:22.409304,used: 9:59:40.437072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99529594, 'precision': 0.9738113, 'recall': 0.9526495, 'specificity': 0.9526495, 'f1': 0.9629705, 'auroc': 0.9990802, 'binary_precision': 0.9508547, 'binary_recall': 0.9069294, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.9283728}
confusion matrix:
       0     1
0  42251    69
1    137  1335
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.9245634, 'recall': 0.87337923, 'specificity': 0.87337923, 'f1': 0.8971988, 'auroc': 0.98389804, 'binary_precision': 0.8579041, 'binary_recall': 0.7511664, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.800995}
confusion matrix:
       0    1
0  18069   80
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.9345942, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_17.png
early stop counter: 4
val acc:0.9872286319732666, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 17,now: 2024-06-06 09:29:09.962280,epoch time: 0:37:22.100218,used: 10:37:02.537290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928982, 'precision': 0.92382187, 'recall': 0.97665405, 'specificity': 0.97665405, 'f1': 0.9485574, 'auroc': 0.99891794, 'binary_precision': 0.8490679, 'binary_recall': 0.9592391, 'binary_specificity': 0.994069, 'binary_f1_score': 0.9007975}
confusion matrix:
       0     1
0  42069   251
1     60  1412
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.88388413, 'recall': 0.8971117, 'specificity': 0.8971117, 'f1': 0.890376, 'auroc': 0.98099923, 'binary_precision': 0.7747748, 'binary_recall': 0.8024883, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.7883881}
confusion matrix:
       0    1
0  17999  150
1    127  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7999648, 'recall': 0.5653823, 'specificity': 0.5653823, 'f1': 0.6006775, 'auroc': 0.89648527, 'binary_precision': 0.6363636, 'binary_recall': 0.13409962, 'binary_specificity': 0.996665, 'binary_f1_score': 0.221519}
confusion matrix:
      0   1
0  5977  20
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_18.png
early stop counter: 5
val acc:0.9852597117424011, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 18,now: 2024-06-06 10:06:22.297219,epoch time: 0:37:12.334939,used: 11:14:14.872229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99568415, 'precision': 0.98357064, 'recall': 0.948916, 'specificity': 0.948916, 'f1': 0.9655516, 'auroc': 0.9994859, 'binary_precision': 0.970653, 'binary_recall': 0.8987772, 'binary_specificity': 0.99905485, 'binary_f1_score': 0.93333334}
confusion matrix:
       0     1
0  42280    40
1    149  1323
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9496263, 'recall': 0.8510153, 'specificity': 0.8510153, 'f1': 0.89379597, 'auroc': 0.9843009, 'binary_precision': 0.9096386, 'binary_recall': 0.7045101, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.7940404}
confusion matrix:
       0    1
0  18104   45
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.9169134, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_19.png
early stop counter: 6
val acc:0.987494707107544, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 19,now: 2024-06-06 10:43:38.895729,epoch time: 0:37:16.598510,used: 11:51:31.470739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9941313, 'precision': 0.96973526, 'recall': 0.93790746, 'specificity': 0.93790746, 'f1': 0.9532213, 'auroc': 0.99906075, 'binary_precision': 0.9437134, 'binary_recall': 0.8776343, 'binary_specificity': 0.99818057, 'binary_f1_score': 0.9094752}
confusion matrix:
       0     1
0  42244    77
1    180  1291
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.9158211, 'recall': 0.83602667, 'specificity': 0.83602667, 'f1': 0.8713565, 'auroc': 0.9828759, 'binary_precision': 0.84302324, 'binary_recall': 0.67651635, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.7506471}
confusion matrix:
       0    1
0  18068   81
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8245397, 'recall': 0.56946385, 'specificity': 0.56946385, 'f1': 0.60758406, 'auroc': 0.9294189, 'binary_precision': 0.6851852, 'binary_recall': 0.14176245, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23492064}
confusion matrix:
      0   1
0  5980  17
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_20.png
early stop counter: 7
val acc:0.9846211075782776, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9613295197486877 / 0.9659635424613953
after epoch: 20,now: 2024-06-06 11:21:41.667958,epoch time: 0:38:02.772229,used: 12:29:34.242968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9969629, 'precision': 0.97559094, 'recall': 0.9777735, 'specificity': 0.9777735, 'f1': 0.97667956, 'auroc': 0.9995741, 'binary_precision': 0.95267075, 'binary_recall': 0.95720106, 'binary_specificity': 0.9983459, 'binary_f1_score': 0.95493054}
confusion matrix:
       0     1
0  42250    70
1     63  1409
---- Validation: 
scalar performance:
{'acc': 0.9890379, 'precision': 0.9349812, 'recall': 0.8930673, 'specificity': 0.8930673, 'f1': 0.91287935, 'auroc': 0.98478985, 'binary_precision': 0.87737477, 'binary_recall': 0.79004663, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.8314239}
confusion matrix:
       0    1
0  18078   71
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.81368303, 'recall': 0.52998435, 'specificity': 0.52998435, 'f1': 0.54579777, 'auroc': 0.92903894, 'binary_precision': 0.6666667, 'binary_recall': 0.06130268, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1122807}
confusion matrix:
      0   1
0  5989   8
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_21.png
better model found
persisted
after epoch: 21,now: 2024-06-06 12:00:35.403794,epoch time: 0:38:53.735836,used: 13:08:27.978804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9952731, 'precision': 0.961268, 'recall': 0.9664077, 'specificity': 0.9664077, 'f1': 0.96382254, 'auroc': 0.9993136, 'binary_precision': 0.92478174, 'binary_recall': 0.93546194, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.9300912}
confusion matrix:
       0     1
0  42208   112
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.90600324, 'recall': 0.87730104, 'specificity': 0.87730104, 'f1': 0.8910825, 'auroc': 0.98278725, 'binary_precision': 0.8204698, 'binary_recall': 0.7604977, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7893463}
confusion matrix:
       0    1
0  18042  107
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8461988, 'recall': 0.5998651, 'specificity': 0.5998651, 'f1': 0.64932454, 'auroc': 0.92284524, 'binary_precision': 0.72602737, 'binary_recall': 0.20306513, 'binary_specificity': 0.996665, 'binary_f1_score': 0.31736523}
confusion matrix:
      0   1
0  5977  20
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_22.png
early stop counter: 1
val acc:0.9861111044883728, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 22,now: 2024-06-06 12:38:04.013432,epoch time: 0:37:28.609638,used: 13:45:56.588442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9966204, 'precision': 0.9894526, 'recall': 0.9579247, 'specificity': 0.9579247, 'f1': 0.97312534, 'auroc': 0.99970496, 'binary_precision': 0.98180497, 'binary_recall': 0.9164402, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.9479972}
confusion matrix:
       0     1
0  42295    25
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.95696115, 'recall': 0.8434872, 'specificity': 0.8434872, 'f1': 0.89159435, 'auroc': 0.98370856, 'binary_precision': 0.92484343, 'binary_recall': 0.688958, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.7896612}
confusion matrix:
       0    1
0  18113   36
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.833902, 'recall': 0.54514325, 'specificity': 0.54514325, 'f1': 0.5712503, 'auroc': 0.93265295, 'binary_precision': 0.7058824, 'binary_recall': 0.09195402, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16271184}
confusion matrix:
      0   1
0  5987  10
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_23.png
early stop counter: 2
val acc:0.9874414801597595, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 23,now: 2024-06-06 13:18:13.994029,epoch time: 0:40:09.980597,used: 14:26:06.569039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99607235, 'precision': 0.9580917, 'recall': 0.9838699, 'specificity': 0.9838699, 'f1': 0.97060007, 'auroc': 0.99966216, 'binary_precision': 0.9172015, 'binary_recall': 0.97078806, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.9432343}
confusion matrix:
       0     1
0  42191   129
1     43  1429
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.89996946, 'recall': 0.91015947, 'specificity': 0.91015947, 'f1': 0.90499485, 'auroc': 0.9854883, 'binary_precision': 0.8060606, 'binary_recall': 0.8273717, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.81657714}
confusion matrix:
       0    1
0  18021  128
1    111  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8106981, 'recall': 0.6029461, 'specificity': 0.6029461, 'f1': 0.6497662, 'auroc': 0.9153806, 'binary_precision': 0.6547619, 'binary_recall': 0.21072797, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31884056}
confusion matrix:
      0   1
0  5968  29
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_24.png
early stop counter: 3
val acc:0.9872817993164062, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 24,now: 2024-06-06 13:59:16.852995,epoch time: 0:41:02.858966,used: 15:07:09.428005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.995844, 'precision': 0.9923522, 'recall': 0.94309723, 'specificity': 0.94309723, 'f1': 0.9663337, 'auroc': 0.99970174, 'binary_precision': 0.9886364, 'binary_recall': 0.88654894, 'binary_specificity': 0.99964553, 'binary_f1_score': 0.9348138}
confusion matrix:
       0     1
0  42305    15
1    167  1305
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9610632, 'recall': 0.83740413, 'specificity': 0.83740413, 'f1': 0.88896906, 'auroc': 0.98344433, 'binary_precision': 0.9334764, 'binary_recall': 0.67651635, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.7844905}
confusion matrix:
       0    1
0  18118   31
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.9022899, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_25.png
early stop counter: 4
val acc:0.9872817993164062, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 25,now: 2024-06-06 14:36:27.889553,epoch time: 0:37:11.036558,used: 15:44:20.464563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99712276, 'precision': 0.9881914, 'recall': 0.9670147, 'specificity': 0.9670147, 'f1': 0.97735083, 'auroc': 0.99978256, 'binary_precision': 0.9786477, 'binary_recall': 0.9347383, 'binary_specificity': 0.9992911, 'binary_f1_score': 0.95618916}
confusion matrix:
       0     1
0  42291    30
1     96  1375
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.9482877, 'recall': 0.85407066, 'specificity': 0.85407066, 'f1': 0.89523345, 'auroc': 0.9839371, 'binary_precision': 0.90674603, 'binary_recall': 0.71073097, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.79686147}
confusion matrix:
       0    1
0  18102   47
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8302531, 'recall': 0.55638736, 'specificity': 0.55638736, 'f1': 0.58869404, 'auroc': 0.88881636, 'binary_precision': 0.6976744, 'binary_recall': 0.11494253, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.19736843}
confusion matrix:
      0   1
0  5984  13
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_26.png
early stop counter: 5
val acc:0.987601101398468, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 26,now: 2024-06-06 15:13:11.033662,epoch time: 0:36:43.144109,used: 16:21:03.608672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9965519, 'precision': 0.98837566, 'recall': 0.9578609, 'specificity': 0.9578609, 'f1': 0.97258985, 'auroc': 0.99967057, 'binary_precision': 0.97965115, 'binary_recall': 0.9163834, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.9469617}
confusion matrix:
       0     1
0  42293    28
1    123  1348
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.94939005, 'recall': 0.8494601, 'specificity': 0.8494601, 'f1': 0.89270985, 'auroc': 0.98358977, 'binary_precision': 0.9092742, 'binary_recall': 0.7013997, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.79192275}
confusion matrix:
       0    1
0  18104   45
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.85619575, 'recall': 0.5509738, 'specificity': 0.5509738, 'f1': 0.5809656, 'auroc': 0.91894114, 'binary_precision': 0.75, 'binary_recall': 0.10344828, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5988   9
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_27.png
early stop counter: 6
val acc:0.9873882532119751, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 27,now: 2024-06-06 15:50:08.153720,epoch time: 0:36:57.120058,used: 16:58:00.728730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99682593, 'precision': 0.96746784, 'recall': 0.9849155, 'specificity': 0.9849155, 'f1': 0.9760194, 'auroc': 0.99967027, 'binary_precision': 0.9359058, 'binary_recall': 0.97214675, 'binary_specificity': 0.9976843, 'binary_f1_score': 0.95368207}
confusion matrix:
       0     1
0  42222    98
1     41  1431
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9075607, 'recall': 0.8781337, 'specificity': 0.8781337, 'f1': 0.8922505, 'auroc': 0.98605895, 'binary_precision': 0.8235294, 'binary_recall': 0.7620529, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7915994}
confusion matrix:
       0    1
0  18044  105
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7504852, 'recall': 0.56638086, 'specificity': 0.56638086, 'f1': 0.59925395, 'auroc': 0.9199496, 'binary_precision': 0.53731346, 'binary_recall': 0.13793103, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.21951218}
confusion matrix:
      0   1
0  5966  31
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_28.png
early stop counter: 7
val acc:0.9862707257270813, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 28,now: 2024-06-06 16:28:02.163344,epoch time: 0:37:54.009624,used: 17:35:54.738354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976023, 'precision': 0.9807904, 'recall': 0.9823665, 'specificity': 0.9823665, 'f1': 0.98157704, 'auroc': 0.99980867, 'binary_precision': 0.96276236, 'binary_recall': 0.9660326, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.96439475}
confusion matrix:
       0     1
0  42265    55
1     50  1422
---- Validation: 
scalar performance:
{'acc': 0.9886654, 'precision': 0.9405797, 'recall': 0.8801235, 'specificity': 0.8801235, 'f1': 0.907952, 'auroc': 0.98298913, 'binary_precision': 0.88949275, 'binary_recall': 0.7636081, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.8217574}
confusion matrix:
       0    1
0  18088   61
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8595511, 'recall': 0.5585532, 'specificity': 0.5585532, 'f1': 0.5928242, 'auroc': 0.9155868, 'binary_precision': 0.75609756, 'binary_recall': 0.118773945, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.205298}
confusion matrix:
      0   1
0  5987  10
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_29.png
early stop counter: 8
val acc:0.9886654019355774, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 29,now: 2024-06-06 17:05:48.911056,epoch time: 0:37:46.747712,used: 18:13:41.486066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99803615, 'precision': 0.98396575, 'recall': 0.9858695, 'specificity': 0.9858695, 'f1': 0.9849156, 'auroc': 0.99987864, 'binary_precision': 0.96887684, 'binary_recall': 0.97282606, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.9708474}
confusion matrix:
       0     1
0  42274    46
1     40  1432
---- Validation: 
scalar performance:
{'acc': 0.98845255, 'precision': 0.9291731, 'recall': 0.8897641, 'specificity': 0.8897641, 'f1': 0.90844446, 'auroc': 0.9837477, 'binary_precision': 0.8659794, 'binary_recall': 0.7838258, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.82285714}
confusion matrix:
       0    1
0  18071   78
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.91932696, 'recall': 0.5666329, 'specificity': 0.5666329, 'f1': 0.6068235, 'auroc': 0.91844404, 'binary_precision': 0.875, 'binary_recall': 0.13409962, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.23255815}
confusion matrix:
      0   1
0  5992   5
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_30.png
early stop counter: 9
val acc:0.9884525537490845, best validation acc: 0.9890378713607788, corresponding to test acc:                         0.9595717191696167 / 0.9659635424613953
after epoch: 30,now: 2024-06-06 17:44:09.858786,epoch time: 0:38:20.947730,used: 18:52:02.433796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:52:02.433796 at 2024-06-06 17:44:09.858786
persisted model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.8081609, 'recall': 0.5355647, 'specificity': 0.5355647, 'f1': 0.5552113, 'auroc': 0.9265146, 'binary_precision': 0.6551724, 'binary_recall': 0.07279693, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.13103448}
confusion matrix:
      0   1
0  5987  10
1   242  19
oracle model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.87340575, 'recall': 0.6324321, 'specificity': 0.6324321, 'f1': 0.69075775, 'auroc': 0.95255053, 'binary_precision': 0.7777778, 'binary_recall': 0.26819924, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3988604}
confusion matrix:
      0   1
0  5977  20
1   191  70
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |   1663 MiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   3518 MiB |   3518 MiB |      0 B   |
|       from large pool |   3506 MiB |   3506 MiB |   3506 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258190 KiB | 316551 KiB | 479312 GiB | 479311 GiB |
|       from large pool | 254640 KiB | 313088 KiB | 467816 GiB | 467816 GiB |
|       from small pool |   3550 KiB |   5495 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140836 K  |  140833 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140836 K  |  140833 K  |
|       from large pool |     247    |     352    |   54522 K  |   54522 K  |
|       from small pool |    3119    |    6089    |   86313 K  |   86310 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     140    |     140    |     140    |       0    |
|       from large pool |     134    |     134    |     134    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2824    |   71764 K  |   71764 K  |
|       from large pool |      78    |     119    |   33483 K  |   33483 K  |
|       from small pool |      17    |    2746    |   38280 K  |   38280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479313 GiB | 479313 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467817 GiB | 467817 GiB |
|       from small pool |      0 KiB |   9140 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71765 K  |   71765 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   38281 K  |   38281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3198 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3191 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1922 MiB |   3518 MiB |   3518 MiB |   1596 MiB |
|       from large pool |   1912 MiB |   3506 MiB |   3506 MiB |   1594 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 316551 KiB | 479313 GiB | 479313 GiB |
|       from large pool |  24320 KiB | 313088 KiB | 467817 GiB | 467817 GiB |
|       from small pool |      0 KiB |   9140 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54522 K  |   54522 K  |
|       from small pool |       0    |    6089    |   86313 K  |   86313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     140    |     140    |      47    |
|       from large pool |      88    |     134    |     134    |      46    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2824    |   71765 K  |   71765 K  |
|       from large pool |       3    |     119    |   33483 K  |   33483 K  |
|       from small pool |       0    |    2746    |   38281 K  |   38281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982

 Experiment start at: 2024-06-06 17:54:01.560580
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97202206, 'precision': 0.7783175, 'recall': 0.7956176, 'specificity': 0.7956176, 'f1': 0.78667986, 'auroc': 0.9638881, 'binary_precision': 0.5700326, 'binary_recall': 0.60679615, 'binary_specificity': 0.9844391, 'binary_f1_score': 0.58784014}
confusion matrix:
       0    1
0  41754  660
1    567  875
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.7754592, 'recall': 0.79588866, 'specificity': 0.79588866, 'f1': 0.7852665, 'auroc': 0.9653671, 'binary_precision': 0.56551725, 'binary_recall': 0.60921246, 'binary_specificity': 0.9825649, 'binary_f1_score': 0.5865522}
confusion matrix:
       0    1
0  17752  315
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8965044, 'recall': 0.60860634, 'specificity': 0.60860634, 'f1': 0.66435546, 'auroc': 0.94229364, 'binary_precision': 0.82608694, 'binary_recall': 0.21923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.34650457}
confusion matrix:
      0   1
0  5934  12
1   203  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 18:33:10.807574,epoch time: 0:39:09.246994,used: 0:39:09.246994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97573876, 'precision': 0.8587906, 'recall': 0.70107293, 'specificity': 0.70107293, 'f1': 0.7560636, 'auroc': 0.97461295, 'binary_precision': 0.7374372, 'binary_recall': 0.4070735, 'binary_specificity': 0.99507236, 'binary_f1_score': 0.5245755}
confusion matrix:
       0    1
0  42205  209
1    855  587
---- Validation: 
scalar performance:
{'acc': 0.9705443, 'precision': 0.83797055, 'recall': 0.65427005, 'specificity': 0.65427005, 'f1': 0.709072, 'auroc': 0.9697525, 'binary_precision': 0.7009967, 'binary_recall': 0.31352153, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.43326485}
confusion matrix:
       0    1
0  17977   90
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8862329, 'recall': 0.5723201, 'specificity': 0.5723201, 'f1': 0.614237, 'auroc': 0.9488666, 'binary_precision': 0.80851066, 'binary_recall': 0.14615385, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.247557}
confusion matrix:
      0   1
0  5937   9
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_2.png
better model found
persisted
after epoch: 2,now: 2024-06-06 19:10:51.069337,epoch time: 0:37:40.261763,used: 1:16:49.508757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98292136, 'precision': 0.91706836, 'recall': 0.7907252, 'specificity': 0.7907252, 'f1': 0.84180963, 'auroc': 0.98535085, 'binary_precision': 0.8480885, 'binary_recall': 0.5850104, 'binary_specificity': 0.99643993, 'binary_f1_score': 0.6924024}
confusion matrix:
       0    1
0  42264  151
1    598  843
---- Validation: 
scalar performance:
{'acc': 0.97876203, 'precision': 0.90748906, 'recall': 0.75366247, 'specificity': 0.75366247, 'f1': 0.8112908, 'auroc': 0.9795778, 'binary_precision': 0.8329298, 'binary_recall': 0.5111441, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.6335175}
confusion matrix:
       0    1
0  17998   69
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8134465, 'recall': 0.52633446, 'specificity': 0.52633446, 'f1': 0.53939426, 'auroc': 0.9579054, 'binary_precision': 0.6666667, 'binary_recall': 0.053846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.099644125}
confusion matrix:
      0   1
0  5939   7
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 19:49:18.233379,epoch time: 0:38:27.164042,used: 1:55:16.672799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9843807, 'precision': 0.92613363, 'recall': 0.809376, 'specificity': 0.809376, 'f1': 0.85782105, 'auroc': 0.9865302, 'binary_precision': 0.8649952, 'binary_recall': 0.6220527, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.7236789}
confusion matrix:
       0    1
0  42274  140
1    545  897
---- Validation: 
scalar performance:
{'acc': 0.9784952, 'precision': 0.90953517, 'recall': 0.7470867, 'specificity': 0.7470867, 'f1': 0.8066741, 'auroc': 0.97567976, 'binary_precision': 0.8375, 'binary_recall': 0.49777117, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.62441754}
confusion matrix:
       0    1
0  18002   65
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.9506215, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_4.png
early stop counter: 1
val acc:0.978495180606842, best validation acc: 0.9787620306015015, corresponding to test acc:                         0.9592329859733582 / 0.9653561115264893
after epoch: 4,now: 2024-06-06 20:27:32.126982,epoch time: 0:38:13.893603,used: 2:33:30.566402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.983195, 'precision': 0.89762086, 'recall': 0.81847656, 'specificity': 0.81847656, 'f1': 0.853338, 'auroc': 0.98682535, 'binary_precision': 0.80732346, 'binary_recall': 0.64216363, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.71533406}
confusion matrix:
       0    1
0  42193  221
1    516  926
---- Validation: 
scalar performance:
{'acc': 0.97726786, 'precision': 0.8741226, 'recall': 0.7614708, 'specificity': 0.7614708, 'f1': 0.8069685, 'auroc': 0.97610986, 'binary_precision': 0.7655914, 'binary_recall': 0.5289747, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.625659}
confusion matrix:
       0    1
0  17958  109
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8717631, 'recall': 0.612032, 'specificity': 0.612032, 'f1': 0.66656905, 'auroc': 0.96303153, 'binary_precision': 0.7763158, 'binary_recall': 0.22692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.35119048}
confusion matrix:
      0   1
0  5929  17
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_5.png
early stop counter: 2
val acc:0.977267861366272, best validation acc: 0.9787620306015015, corresponding to test acc:                         0.9592329859733582 / 0.9653561115264893
after epoch: 5,now: 2024-06-06 21:04:57.738012,epoch time: 0:37:25.611030,used: 3:10:56.177432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98517877, 'precision': 0.9290751, 'recall': 0.8211769, 'specificity': 0.8211769, 'f1': 0.86680645, 'auroc': 0.9907652, 'binary_precision': 0.87009346, 'binary_recall': 0.6456311, 'binary_specificity': 0.99672276, 'binary_f1_score': 0.741242}
confusion matrix:
       0    1
0  42275  139
1    511  931
---- Validation: 
scalar performance:
{'acc': 0.98233724, 'precision': 0.9316134, 'recall': 0.79342586, 'specificity': 0.79342586, 'f1': 0.8483366, 'auroc': 0.9818373, 'binary_precision': 0.8783186, 'binary_recall': 0.58989596, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.70577776}
confusion matrix:
       0    1
0  18012   55
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.9266951, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 21:41:32.393665,epoch time: 0:36:34.655653,used: 3:47:30.833085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9891463, 'precision': 0.9208714, 'recall': 0.9056263, 'specificity': 0.9056263, 'f1': 0.91309714, 'auroc': 0.993721, 'binary_precision': 0.8479827, 'binary_recall': 0.81622744, 'binary_specificity': 0.9950252, 'binary_f1_score': 0.8318022}
confusion matrix:
       0     1
0  42203   211
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.9159961, 'recall': 0.8585514, 'specificity': 0.8585514, 'f1': 0.8849634, 'auroc': 0.9809541, 'binary_precision': 0.8422877, 'binary_recall': 0.72213966, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.7776}
confusion matrix:
       0    1
0  17976   91
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.95768595, 'recall': 0.57483184, 'specificity': 0.57483184, 'f1': 0.62036157, 'auroc': 0.9548902, 'binary_precision': 0.9512195, 'binary_recall': 0.15, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5944   2
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 22:18:12.449748,epoch time: 0:36:40.056083,used: 4:24:10.889168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98718536, 'precision': 0.9607698, 'recall': 0.8279085, 'specificity': 0.8279085, 'f1': 0.8823834, 'auroc': 0.9943856, 'binary_precision': 0.93307084, 'binary_recall': 0.6574203, 'binary_specificity': 0.99839675, 'binary_f1_score': 0.7713589}
confusion matrix:
       0    1
0  42346   68
1    494  948
---- Validation: 
scalar performance:
{'acc': 0.9814301, 'precision': 0.9348047, 'recall': 0.775789, 'specificity': 0.775789, 'f1': 0.8361686, 'auroc': 0.9788818, 'binary_precision': 0.88598573, 'binary_recall': 0.55423474, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.6819013}
confusion matrix:
       0    1
0  18019   48
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.88511765, 'recall': 0.53235596, 'specificity': 0.53235596, 'f1': 0.5503177, 'auroc': 0.9382091, 'binary_precision': 0.8095238, 'binary_recall': 0.06538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.120996445}
confusion matrix:
      0   1
0  5942   4
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_8.png
early stop counter: 1
val acc:0.9814301133155823, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 8,now: 2024-06-06 22:55:00.089465,epoch time: 0:36:47.639717,used: 5:00:58.528885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98962516, 'precision': 0.94017005, 'recall': 0.8901311, 'specificity': 0.8901311, 'f1': 0.91352963, 'auroc': 0.99471426, 'binary_precision': 0.88766694, 'binary_recall': 0.7836338, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.8324125}
confusion matrix:
       0     1
0  42271   143
1    312  1130
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.9192866, 'recall': 0.8395117, 'specificity': 0.8395117, 'f1': 0.8748592, 'auroc': 0.9819238, 'binary_precision': 0.85027725, 'binary_recall': 0.68350667, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7578253}
confusion matrix:
       0    1
0  17986   81
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.95999813, 'recall': 0.54414666, 'specificity': 0.54414666, 'f1': 0.5711739, 'auroc': 0.9226618, 'binary_precision': 0.9583333, 'binary_recall': 0.08846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16197182}
confusion matrix:
      0   1
0  5945   1
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_9.png
early stop counter: 2
val acc:0.9843116402626038, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9640670418739319 / 0.9653561115264893
after epoch: 9,now: 2024-06-06 23:31:38.270708,epoch time: 0:36:38.181243,used: 5:37:36.710128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9902408, 'precision': 0.9366058, 'recall': 0.9055223, 'specificity': 0.9055223, 'f1': 0.9204465, 'auroc': 0.995887, 'binary_precision': 0.87949103, 'binary_recall': 0.8148405, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.8459323}
confusion matrix:
       0     1
0  42253   161
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.92757076, 'recall': 0.8567654, 'specificity': 0.8567654, 'f1': 0.8887087, 'auroc': 0.9823535, 'binary_precision': 0.8655914, 'binary_recall': 0.717682, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.7847279}
confusion matrix:
       0    1
0  17992   75
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.90900797, 'recall': 0.5343631, 'specificity': 0.5343631, 'f1': 0.55395883, 'auroc': 0.93582207, 'binary_precision': 0.85714287, 'binary_recall': 0.06923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.12811388}
confusion matrix:
      0   1
0  5943   3
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 00:08:10.744851,epoch time: 0:36:32.474143,used: 6:14:09.184271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9910616, 'precision': 0.95592654, 'recall': 0.8982428, 'specificity': 0.8982428, 'f1': 0.92499423, 'auroc': 0.9971431, 'binary_precision': 0.9186603, 'binary_recall': 0.7988904, 'binary_specificity': 0.99759513, 'binary_f1_score': 0.85459936}
confusion matrix:
       0     1
0  42312   102
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9357861, 'recall': 0.83194816, 'specificity': 0.83194816, 'f1': 0.8762882, 'auroc': 0.9816881, 'binary_precision': 0.88385826, 'binary_recall': 0.66716194, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.76037264}
confusion matrix:
       0    1
0  18008   59
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.90382123, 'recall': 0.5419713, 'specificity': 0.5419713, 'f1': 0.56694454, 'auroc': 0.93223, 'binary_precision': 0.84615386, 'binary_recall': 0.08461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5942   4
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127982_11.png
early stop counter: 1
val acc:0.9848986268043518, best validation acc: 0.9858590960502625, corresponding to test acc:                         0.9605220556259155 / 0.9653561115264893
after epoch: 11,now: 2024-06-07 00:44:45.817324,epoch time: 0:36:35.072473,used: 6:50:44.256744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_17_54_01_seed_1_21127982
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9915861, 'precision': 0.92036724, 'recall': 0.953781, 'specificity': 0.953781, 'f1': 0.93638337, 'auroc': 0.99739593, 'binary_precision': 0.8436899, 'binary_recall': 0.9133148, 'binary_specificity': 0.9942472, 'binary_f1_score': 0.8771228}
confusion matrix:
       0     1
0  42170   244
1    125  1317
---- Validation: 
slurmstepd: error: *** JOB 21127982 ON gpusrv38 CANCELLED AT 2024-06-07T01:15:57 ***
