Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 10:05:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972

 Experiment start at: 2024-06-22 10:16:05.209355
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90547943, 'precision': 0.4527688, 'recall': 0.49996454, 'specificity': 0.49996454, 'f1': 0.47519767, 'auroc': 0.4696618, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42304  3
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.31214282, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.32280236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:34:09.871175,epoch time: 0:18:04.661820,used: 0:18:04.661820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.52889675, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3174529, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.28430596, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 10:51:32.767689,epoch time: 0:17:22.896514,used: 0:35:27.558334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.63353693, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.34637028, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3599335, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 11:08:22.070565,epoch time: 0:16:49.302876,used: 0:52:16.861210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.45278254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4752213, 'auroc': 0.6879045, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42308  0
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.34993714, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.38949215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 11:24:55.132994,epoch time: 0:16:33.062429,used: 1:08:49.923639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90547943, 'precision': 0.45273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4751977, 'auroc': 0.73412716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42304  0
1   4416  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3709555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4194634, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_5.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:40:59.200580,epoch time: 0:16:04.067586,used: 1:24:53.991225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90488017, 'precision': 0.4922499, 'recall': 0.49992636, 'specificity': 0.49992636, 'f1': 0.47570506, 'auroc': 0.7745197, 'binary_precision': 0.078947365, 'binary_recall': 0.00067996373, 'binary_specificity': 0.99917275, 'binary_f1_score': 0.0013483147}
confusion matrix:
       0   1
0  42273  35
1   4409   3
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.48288527, 'recall': 0.49980715, 'specificity': 0.49980715, 'f1': 0.4912005, 'auroc': 0.3895359, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18142  7
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5143689, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_6.png
early stop counter: 4
val acc:0.9654108285903931, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:56:48.882553,epoch time: 0:15:49.681973,used: 1:40:43.673198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9058005, 'precision': 0.95288515, 'recall': 0.5016984, 'specificity': 0.5016984, 'f1': 0.478663, 'auroc': 0.82425904, 'binary_precision': 1.0, 'binary_recall': 0.003396739, 'binary_specificity': 1.0, 'binary_f1_score': 0.0067704804}
confusion matrix:
       0   1
0  42304   0
1   4401  15
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3981765, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4871981, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_7.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 12:13:06.708039,epoch time: 0:16:17.825486,used: 1:57:01.498684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90785533, 'precision': 0.9324981, 'recall': 0.51263356, 'specificity': 0.51263356, 'f1': 0.50051993, 'auroc': 0.8599994, 'binary_precision': 0.95726496, 'binary_recall': 0.025385313, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.049459044}
confusion matrix:
       0    1
0  42303    5
1   4300  112
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.42465192, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.549297, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 12:29:36.360578,epoch time: 0:16:29.652539,used: 2:13:31.151223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9084118, 'precision': 0.792786, 'recall': 0.5283902, 'specificity': 0.5283902, 'f1': 0.5307811, 'auroc': 0.8762306, 'binary_precision': 0.6751918, 'binary_recall': 0.05978261, 'binary_specificity': 0.9969979, 'binary_f1_score': 0.10983981}
confusion matrix:
       0    1
0  42177  127
1   4152  264
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.4828707, 'recall': 0.49936634, 'specificity': 0.49936634, 'f1': 0.49098, 'auroc': 0.4441778, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18126  23
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.61090505, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_9.png
early stop counter: 7
val acc:0.9645593762397766, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 12:46:02.987628,epoch time: 0:16:26.627050,used: 2:29:57.778273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91603166, 'precision': 0.94420826, 'recall': 0.5570389, 'specificity': 0.5570389, 'f1': 0.58020973, 'auroc': 0.8936832, 'binary_precision': 0.973025, 'binary_recall': 0.1144087, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.20474358}
confusion matrix:
       0    1
0  42292   14
1   3909  505
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.45948106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.59857833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_10.png
early stop counter: 8
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-22 13:02:23.704165,epoch time: 0:16:20.716537,used: 2:46:18.494810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92163956, 'precision': 0.94950724, 'recall': 0.58683443, 'specificity': 0.58683443, 'f1': 0.6270337, 'auroc': 0.90261686, 'binary_precision': 0.97834396, 'binary_recall': 0.17407072, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.29555514}
confusion matrix:
       0    1
0  42291   17
1   3644  768
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.4728353, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.638937, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_11.png
early stop counter: 9
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-22 13:18:36.512582,epoch time: 0:16:12.808417,used: 3:02:31.303227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9292594, 'precision': 0.9519962, 'recall': 0.6282956, 'specificity': 0.6282956, 'f1': 0.68478024, 'auroc': 0.905679, 'binary_precision': 0.9759243, 'binary_recall': 0.25725296, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.4071749}
confusion matrix:
       0     1
0  42280    28
1   3277  1135
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.48288438, 'recall': 0.4997796, 'specificity': 0.4997796, 'f1': 0.49118674, 'auroc': 0.4924119, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18141  8
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7103529, 'recall': 0.51091063, 'specificity': 0.51091063, 'f1': 0.511197, 'auroc': 0.6726575, 'binary_precision': 0.46153846, 'binary_recall': 0.022988506, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.04379562}
confusion matrix:
      0  1
0  5990  7
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_12.png
early stop counter: 10
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-22 13:34:22.831109,epoch time: 0:15:46.318527,used: 3:18:17.621754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9371575, 'precision': 0.937948, 'recall': 0.6777992, 'specificity': 0.6777992, 'f1': 0.7423792, 'auroc': 0.92078304, 'binary_precision': 0.93879974, 'binary_recall': 0.3580331, 'binary_specificity': 0.9975654, 'binary_f1_score': 0.5183727}
confusion matrix:
       0     1
0  42204   103
1   2833  1580
---- Validation: 
scalar performance:
{'acc': 0.96408045, 'precision': 0.4975932, 'recall': 0.49986845, 'specificity': 0.49986845, 'f1': 0.49233246, 'auroc': 0.5283733, 'binary_precision': 0.029411765, 'binary_recall': 0.00155521, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.00295421}
confusion matrix:
       0   1
0  18116  33
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8081609, 'recall': 0.5355647, 'specificity': 0.5355647, 'f1': 0.5552113, 'auroc': 0.72172993, 'binary_precision': 0.6551724, 'binary_recall': 0.07279693, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.13103448}
confusion matrix:
      0   1
0  5987  10
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_13.png
new oracle model saved
early stop counter: 11
val acc:0.9640804529190063, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 13,now: 2024-06-22 13:50:17.430528,epoch time: 0:15:54.599419,used: 3:34:12.221173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9363656, 'precision': 0.91601276, 'recall': 0.68291336, 'specificity': 0.68291336, 'f1': 0.74484575, 'auroc': 0.92008734, 'binary_precision': 0.8939311, 'binary_recall': 0.37041232, 'binary_specificity': 0.9954144, 'binary_f1_score': 0.52378666}
confusion matrix:
       0     1
0  42112   194
1   2779  1635
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.5135392, 'recall': 0.50106555, 'specificity': 0.50106555, 'f1': 0.49503785, 'auroc': 0.52927756, 'binary_precision': 0.06122449, 'binary_recall': 0.00466563, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.00867052}
confusion matrix:
       0   1
0  18103  46
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78954333, 'recall': 0.539146, 'specificity': 0.539146, 'f1': 0.56083536, 'auroc': 0.73969555, 'binary_precision': 0.61764705, 'binary_recall': 0.08045977, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.14237289}
confusion matrix:
      0   1
0  5984  13
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_14.png
early stop counter: 12
val acc:0.9634950757026672, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 14,now: 2024-06-22 14:06:13.262675,epoch time: 0:15:55.832147,used: 3:50:08.053320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94477737, 'precision': 0.935555, 'recall': 0.7242067, 'specificity': 0.7242067, 'f1': 0.78892195, 'auroc': 0.93859965, 'binary_precision': 0.9253939, 'binary_recall': 0.4522192, 'binary_specificity': 0.9961942, 'binary_f1_score': 0.60754484}
confusion matrix:
       0     1
0  42143   161
1   2419  1997
---- Validation: 
scalar performance:
{'acc': 0.9630694, 'precision': 0.51684284, 'recall': 0.5015952, 'specificity': 0.5015952, 'f1': 0.49628958, 'auroc': 0.58522713, 'binary_precision': 0.06779661, 'binary_recall': 0.00622084, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.011396012}
confusion matrix:
       0   1
0  18094  55
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7916062, 'recall': 0.57271165, 'specificity': 0.57271165, 'f1': 0.6102818, 'auroc': 0.75905573, 'binary_precision': 0.61904764, 'binary_recall': 0.14942528, 'binary_specificity': 0.995998, 'binary_f1_score': 0.24074075}
confusion matrix:
      0   1
0  5973  24
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_15.png
new oracle model saved
early stop counter: 13
val acc:0.9630693793296814, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9606903195381165
after epoch: 15,now: 2024-06-22 14:22:13.449494,epoch time: 0:16:00.186819,used: 4:06:08.240139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94877994, 'precision': 0.933926, 'recall': 0.7491659, 'specificity': 0.7491659, 'f1': 0.8110786, 'auroc': 0.93791246, 'binary_precision': 0.91735536, 'binary_recall': 0.50305915, 'binary_specificity': 0.99527264, 'binary_f1_score': 0.64978784}
confusion matrix:
       0     1
0  42107   200
1   2193  2220
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.49876052, 'recall': 0.49987468, 'specificity': 0.49987468, 'f1': 0.49331498, 'auroc': 0.53710294, 'binary_precision': 0.031746034, 'binary_recall': 0.00311042, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.005665723}
confusion matrix:
       0   1
0  18088  61
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.7233336, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_16.png
early stop counter: 14
val acc:0.9626436829566956, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9606903195381165
after epoch: 16,now: 2024-06-22 14:38:15.060142,epoch time: 0:16:01.610648,used: 4:22:09.850787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9525471, 'precision': 0.9268864, 'recall': 0.777379, 'specificity': 0.777379, 'f1': 0.8325697, 'auroc': 0.9440558, 'binary_precision': 0.89778906, 'binary_recall': 0.56142336, 'binary_specificity': 0.9933346, 'binary_f1_score': 0.6908381}
confusion matrix:
       0     1
0  42026   282
1   1935  2477
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.5060747, 'recall': 0.5010504, 'specificity': 0.5010504, 'f1': 0.49659887, 'auroc': 0.5992265, 'binary_precision': 0.046296295, 'binary_recall': 0.00777605, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.01331558}
confusion matrix:
       0    1
0  18046  103
1    638    5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.78671277, 'recall': 0.61169094, 'specificity': 0.61169094, 'f1': 0.656795, 'auroc': 0.7683605, 'binary_precision': 0.6060606, 'binary_recall': 0.22988506, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.33333334}
confusion matrix:
      0   1
0  5958  39
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_17.png
new oracle model saved
early stop counter: 15
val acc:0.9605683088302612, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9616490602493286
after epoch: 17,now: 2024-06-22 14:54:28.887238,epoch time: 0:16:13.827096,used: 4:38:23.677883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9525471, 'precision': 0.94998026, 'recall': 0.76211023, 'specificity': 0.76211023, 'f1': 0.82591164, 'auroc': 0.94269407, 'binary_precision': 0.9471115, 'binary_recall': 0.5272933, 'binary_specificity': 0.9969271, 'binary_f1_score': 0.67743343}
confusion matrix:
       0     1
0  42175   130
1   2087  2328
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.52141243, 'recall': 0.501788, 'specificity': 0.501788, 'f1': 0.49644366, 'auroc': 0.5888803, 'binary_precision': 0.07692308, 'binary_recall': 0.00622084, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.011510791}
confusion matrix:
       0   1
0  18101  48
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.80863667, 'recall': 0.5842059, 'specificity': 0.5842059, 'f1': 0.6265163, 'auroc': 0.7497325, 'binary_precision': 0.65217394, 'binary_recall': 0.1724138, 'binary_specificity': 0.995998, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5973  24
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_18.png
early stop counter: 16
val acc:0.9634419083595276, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9616490602493286
after epoch: 18,now: 2024-06-22 15:10:35.025002,epoch time: 0:16:06.137764,used: 4:54:29.815647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9524401, 'precision': 0.94064665, 'recall': 0.7670675, 'specificity': 0.7670675, 'f1': 0.82784504, 'auroc': 0.9479176, 'binary_precision': 0.92740047, 'binary_recall': 0.5385313, 'binary_specificity': 0.9956037, 'binary_f1_score': 0.681388}
confusion matrix:
       0     1
0  42122   186
1   2036  2376
---- Validation: 
scalar performance:
{'acc': 0.9618987, 'precision': 0.5232291, 'recall': 0.5032393, 'specificity': 0.5032393, 'f1': 0.49987504, 'auroc': 0.60902584, 'binary_precision': 0.08045977, 'binary_recall': 0.01088647, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.019178083}
confusion matrix:
       0   1
0  18069  80
1    636   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7935728, 'recall': 0.6006969, 'specificity': 0.6006969, 'f1': 0.64531046, 'auroc': 0.7728143, 'binary_precision': 0.62068963, 'binary_recall': 0.20689656, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.31034485}
confusion matrix:
      0   1
0  5964  33
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_19.png
early stop counter: 17
val acc:0.961898684501648, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9616490602493286
after epoch: 19,now: 2024-06-22 15:26:46.221134,epoch time: 0:16:11.196132,used: 5:10:41.011779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95432365, 'precision': 0.9334763, 'recall': 0.7837832, 'specificity': 0.7837832, 'f1': 0.8393922, 'auroc': 0.9516953, 'binary_precision': 0.9098095, 'binary_recall': 0.57349944, 'binary_specificity': 0.9940669, 'binary_f1_score': 0.7035287}
confusion matrix:
       0     1
0  42054   251
1   1883  2532
---- Validation: 
scalar performance:
{'acc': 0.96168584, 'precision': 0.56590366, 'recall': 0.5121297, 'specificity': 0.5121297, 'f1': 0.51529026, 'auroc': 0.6231768, 'binary_precision': 0.16521738, 'binary_recall': 0.02954899, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.05013193}
confusion matrix:
       0   1
0  18053  96
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.83614737, 'recall': 0.650422, 'specificity': 0.650422, 'f1': 0.70447904, 'auroc': 0.7852362, 'binary_precision': 0.7017544, 'binary_recall': 0.3065134, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.42666668}
confusion matrix:
      0   1
0  5963  34
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_20.png
new oracle model saved
early stop counter: 18
val acc:0.961685836315155, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 20,now: 2024-06-22 15:42:34.131030,epoch time: 0:15:47.909896,used: 5:26:28.921675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9569777, 'precision': 0.920259, 'recall': 0.81178224, 'specificity': 0.81178224, 'f1': 0.85598624, 'auroc': 0.95461214, 'binary_precision': 0.87774986, 'binary_recall': 0.6327594, 'binary_specificity': 0.9908051, 'binary_f1_score': 0.7353871}
confusion matrix:
       0     1
0  41917   389
1   1621  2793
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.5494414, 'recall': 0.5137249, 'specificity': 0.5137249, 'f1': 0.5176668, 'auroc': 0.6215695, 'binary_precision': 0.13218391, 'binary_recall': 0.035769828, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.05630355}
confusion matrix:
       0    1
0  17998  151
1    620   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7665297, 'recall': 0.64991975, 'specificity': 0.64991975, 'f1': 0.68996775, 'auroc': 0.7830304, 'binary_precision': 0.5625, 'binary_recall': 0.31034482, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.39999998}
confusion matrix:
      0   1
0  5934  63
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_21.png
early stop counter: 19
val acc:0.9589719176292419, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 21,now: 2024-06-22 15:58:43.882876,epoch time: 0:16:09.751846,used: 5:42:38.673521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95616436, 'precision': 0.93765306, 'recall': 0.79210263, 'specificity': 0.79210263, 'f1': 0.8469938, 'auroc': 0.9463744, 'binary_precision': 0.91657865, 'binary_recall': 0.58980745, 'binary_specificity': 0.9943978, 'binary_f1_score': 0.7177508}
confusion matrix:
       0     1
0  42068   237
1   1811  2604
---- Validation: 
scalar performance:
{'acc': 0.9608344, 'precision': 0.5557997, 'recall': 0.5116889, 'specificity': 0.5116889, 'f1': 0.5145505, 'auroc': 0.619521, 'binary_precision': 0.14503817, 'binary_recall': 0.02954899, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.04909561}
confusion matrix:
       0    1
0  18037  112
1    624   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8230145, 'recall': 0.6631649, 'specificity': 0.6631649, 'f1': 0.71417046, 'auroc': 0.7982389, 'binary_precision': 0.6744186, 'binary_recall': 0.33333334, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.44615388}
confusion matrix:
      0   1
0  5955  42
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_22.png
early stop counter: 20
val acc:0.9608343839645386, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 22,now: 2024-06-22 16:14:31.080489,epoch time: 0:15:47.197613,used: 5:58:25.871134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95749146, 'precision': 0.93066615, 'recall': 0.80583394, 'specificity': 0.80583394, 'f1': 0.85512805, 'auroc': 0.94509447, 'binary_precision': 0.8998352, 'binary_recall': 0.6188534, 'binary_specificity': 0.9928144, 'binary_f1_score': 0.73335123}
confusion matrix:
       0     1
0  42003   304
1   1682  2731
---- Validation: 
scalar performance:
{'acc': 0.96030223, 'precision': 0.5882426, 'recall': 0.52491444, 'specificity': 0.52491444, 'f1': 0.5349762, 'auroc': 0.6184186, 'binary_precision': 0.20903955, 'binary_recall': 0.057542767, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.090243906}
confusion matrix:
       0    1
0  18009  140
1    606   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7629926, 'recall': 0.6719078, 'specificity': 0.6719078, 'f1': 0.7067311, 'auroc': 0.7984464, 'binary_precision': 0.5535714, 'binary_recall': 0.35632184, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.4335664}
confusion matrix:
      0   1
0  5922  75
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_23.png
early stop counter: 21
val acc:0.9603022336959839, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 23,now: 2024-06-22 16:30:13.926732,epoch time: 0:15:42.846243,used: 6:14:08.717377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9559503, 'precision': 0.92373896, 'recall': 0.80183697, 'specificity': 0.80183697, 'f1': 0.85005975, 'auroc': 0.9477588, 'binary_precision': 0.8866995, 'binary_recall': 0.6118287, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.7240547}
confusion matrix:
       0     1
0  41962   345
1   1713  2700
---- Validation: 
scalar performance:
{'acc': 0.95828015, 'precision': 0.55635273, 'recall': 0.5178671, 'specificity': 0.5178671, 'f1': 0.52377284, 'auroc': 0.64615566, 'binary_precision': 0.14572865, 'binary_recall': 0.045101088, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.068883605}
confusion matrix:
       0    1
0  17979  170
1    614   29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7498916, 'recall': 0.68406713, 'specificity': 0.68406713, 'f1': 0.7113275, 'auroc': 0.8111048, 'binary_precision': 0.5263158, 'binary_recall': 0.38314176, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.443459}
confusion matrix:
      0    1
0  5907   90
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_24.png
early stop counter: 22
val acc:0.9582801461219788, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 24,now: 2024-06-22 16:45:49.872328,epoch time: 0:15:35.945596,used: 6:29:44.662973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9598245, 'precision': 0.91454256, 'recall': 0.8367552, 'specificity': 0.8367552, 'f1': 0.8705729, 'auroc': 0.95381606, 'binary_precision': 0.86125356, 'binary_recall': 0.6850215, 'binary_specificity': 0.9884889, 'binary_f1_score': 0.7630947}
confusion matrix:
       0     1
0  41820   487
1   1390  3023
---- Validation: 
scalar performance:
{'acc': 0.95540655, 'precision': 0.5524152, 'recall': 0.5223799, 'specificity': 0.5223799, 'f1': 0.5291445, 'auroc': 0.632524, 'binary_precision': 0.13754646, 'binary_recall': 0.057542767, 'binary_specificity': 0.98721695, 'binary_f1_score': 0.08114035}
confusion matrix:
       0    1
0  17917  232
1    606   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7391373, 'recall': 0.6797354, 'specificity': 0.6797354, 'f1': 0.7046475, 'auroc': 0.7925974, 'binary_precision': 0.5051546, 'binary_recall': 0.37547892, 'binary_specificity': 0.983992, 'binary_f1_score': 0.43076923}
confusion matrix:
      0   1
0  5901  96
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_25.png
early stop counter: 23
val acc:0.9554065465927124, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 25,now: 2024-06-22 17:01:44.730347,epoch time: 0:15:54.858019,used: 6:45:39.520992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9614298, 'precision': 0.93490237, 'recall': 0.8273667, 'specificity': 0.8273667, 'f1': 0.8716893, 'auroc': 0.95625615, 'binary_precision': 0.9041138, 'binary_recall': 0.66206115, 'binary_specificity': 0.99267226, 'binary_f1_score': 0.76438284}
confusion matrix:
       0     1
0  41995   310
1   1492  2923
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.5796909, 'recall': 0.52514106, 'specificity': 0.52514106, 'f1': 0.5347741, 'auroc': 0.64231193, 'binary_precision': 0.1919192, 'binary_recall': 0.05909798, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.090368606}
confusion matrix:
       0    1
0  17989  160
1    605   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.761659, 'recall': 0.6976439, 'specificity': 0.6976439, 'f1': 0.72461593, 'auroc': 0.79984504, 'binary_precision': 0.548718, 'binary_recall': 0.4099617, 'binary_specificity': 0.985326, 'binary_f1_score': 0.46929827}
confusion matrix:
      0    1
0  5909   88
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_26.png
early stop counter: 24
val acc:0.9592911601066589, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 26,now: 2024-06-22 17:17:45.933491,epoch time: 0:16:01.203144,used: 7:01:40.724136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9587971, 'precision': 0.9122835, 'recall': 0.83209205, 'specificity': 0.83209205, 'f1': 0.86674404, 'auroc': 0.9593519, 'binary_precision': 0.8576359, 'binary_recall': 0.67588395, 'binary_specificity': 0.9883001, 'binary_f1_score': 0.7559893}
confusion matrix:
       0     1
0  41813   495
1   1430  2982
---- Validation: 
scalar performance:
{'acc': 0.95881224, 'precision': 0.5909873, 'recall': 0.5331437, 'specificity': 0.5331437, 'f1': 0.54565114, 'auroc': 0.6762141, 'binary_precision': 0.2139738, 'binary_recall': 0.07620529, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.112385325}
confusion matrix:
       0    1
0  17969  180
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8067491, 'recall': 0.71671945, 'specificity': 0.71671945, 'f1': 0.7531125, 'auroc': 0.83118445, 'binary_precision': 0.63736266, 'binary_recall': 0.44444445, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.523702}
confusion matrix:
      0    1
0  5931   66
1   145  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_27.png
new oracle model saved
early stop counter: 25
val acc:0.9588122367858887, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 27,now: 2024-06-22 17:33:26.098092,epoch time: 0:15:40.164601,used: 7:17:20.888737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96070206, 'precision': 0.92006946, 'recall': 0.8369051, 'specificity': 0.8369051, 'f1': 0.87274396, 'auroc': 0.9639859, 'binary_precision': 0.872365, 'binary_recall': 0.6842582, 'binary_specificity': 0.9895521, 'binary_f1_score': 0.76694596}
confusion matrix:
       0     1
0  41863   442
1   1394  3021
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.61031663, 'recall': 0.5348029, 'specificity': 0.5348029, 'f1': 0.54936945, 'auroc': 0.68755317, 'binary_precision': 0.25252524, 'binary_recall': 0.077760495, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.11890606}
confusion matrix:
       0    1
0  18001  148
1    593   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.77962446, 'recall': 0.6912316, 'specificity': 0.6912316, 'f1': 0.72613585, 'auroc': 0.8178981, 'binary_precision': 0.58522725, 'binary_recall': 0.394636, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.47139585}
confusion matrix:
      0    1
0  5924   73
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_28.png
early stop counter: 26
val acc:0.9605683088302612, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 28,now: 2024-06-22 17:49:15.623357,epoch time: 0:15:49.525265,used: 7:33:10.414002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9582192, 'precision': 0.9040778, 'recall': 0.83759403, 'specificity': 0.83759403, 'f1': 0.8670585, 'auroc': 0.9561337, 'binary_precision': 0.84001106, 'binary_recall': 0.68887377, 'binary_specificity': 0.9863143, 'binary_f1_score': 0.7569721}
confusion matrix:
       0     1
0  41728   579
1   1373  3040
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.5855912, 'recall': 0.5401546, 'specificity': 0.5401546, 'f1': 0.552723, 'auroc': 0.65319085, 'binary_precision': 0.2027027, 'binary_recall': 0.0933126, 'binary_specificity': 0.98699653, 'binary_f1_score': 0.12779553}
confusion matrix:
       0    1
0  17913  236
1    583   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7683099, 'recall': 0.7257125, 'specificity': 0.7257125, 'f1': 0.7449357, 'auroc': 0.8286915, 'binary_precision': 0.559633, 'binary_recall': 0.46743295, 'binary_specificity': 0.983992, 'binary_f1_score': 0.5093945}
confusion matrix:
      0    1
0  5901   96
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_29.png
early stop counter: 27
val acc:0.9564176201820374, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 29,now: 2024-06-22 18:05:22.852271,epoch time: 0:16:07.228914,used: 7:49:17.642916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96541095, 'precision': 0.92442745, 'recall': 0.8639208, 'specificity': 0.8639208, 'f1': 0.8912405, 'auroc': 0.9655044, 'binary_precision': 0.8756713, 'binary_recall': 0.7387857, 'binary_specificity': 0.98905593, 'binary_f1_score': 0.8014254}
confusion matrix:
       0     1
0  41843   463
1   1153  3261
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.59648603, 'recall': 0.5470704, 'specificity': 0.5470704, 'f1': 0.56145865, 'auroc': 0.6976942, 'binary_precision': 0.22402598, 'binary_recall': 0.10730949, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.14511041}
confusion matrix:
       0    1
0  17910  239
1    574   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.77944493, 'recall': 0.7319598, 'specificity': 0.7319598, 'f1': 0.75321966, 'auroc': 0.821957, 'binary_precision': 0.5813953, 'binary_recall': 0.4789272, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5252101}
confusion matrix:
      0    1
0  5907   90
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_30.png
early stop counter: 28
val acc:0.9567369222640991, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 30,now: 2024-06-22 18:21:56.726028,epoch time: 0:16:33.873757,used: 8:05:51.516673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_05_seed_0_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:05:51.516673 at 2024-06-22 18:21:56.726028
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.28430596, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.8067491, 'recall': 0.71671945, 'specificity': 0.71671945, 'f1': 0.7531125, 'auroc': 0.83118445, 'binary_precision': 0.63736266, 'binary_recall': 0.44444445, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.523702}
confusion matrix:
      0    1
0  5931   66
1   145  116
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 452727 GiB | 452726 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 331857 GiB | 331857 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3689    |   49205 K  |   49203 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32557 K  |   32555 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3689    |   49205 K  |   49203 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32557 K  |   32555 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1476    |   22384 K  |   22384 K  |
|       from large pool |       5    |      10    |    6195 K  |    6195 K  |
|       from small pool |      46    |    1470    |   16188 K  |   16188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331857 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49205 K  |   49205 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32557 K  |   32557 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49205 K  |   49205 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32557 K  |   32557 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331857 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49205 K  |   49205 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32557 K  |   32557 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49205 K  |   49205 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32557 K  |   32557 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972

 Experiment start at: 2024-06-22 18:29:22.698708
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.905244, 'precision': 0.46740973, 'recall': 0.49909678, 'specificity': 0.49909678, 'f1': 0.4758079, 'auroc': 0.39010397, 'binary_precision': 0.027522936, 'binary_recall': 0.000693802, 'binary_specificity': 0.99749976, 'binary_f1_score': 0.0013534852}
confusion matrix:
       0    1
0  42290  106
1   4321    3
---- Validation: 
scalar performance:
{'acc': 0.95533615, 'precision': 0.4990806, 'recall': 0.49975294, 'specificity': 0.49975294, 'f1': 0.4956424, 'auroc': 0.31226975, 'binary_precision': 0.03409091, 'binary_recall': 0.008915304, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.014134275}
confusion matrix:
       0    1
0  17897  170
1    667    6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.4789098, 'recall': 0.49646822, 'specificity': 0.49646822, 'f1': 0.48753095, 'auroc': 0.20918328, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5904  42
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 18:46:26.582966,epoch time: 0:17:03.884258,used: 0:17:03.884258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90714896, 'precision': 0.4537493, 'recall': 0.49978775, 'specificity': 0.49978775, 'f1': 0.47565714, 'auroc': 0.4606849, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995755, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42382  18
1   4320   0
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.48203513, 'recall': 0.49975094, 'specificity': 0.49975094, 'f1': 0.4907332, 'auroc': 0.33082318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18058  9
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.22865258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 19:02:35.245823,epoch time: 0:16:08.662857,used: 0:33:12.547115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90639985, 'precision': 0.453666, 'recall': 0.4994339, 'specificity': 0.4994339, 'f1': 0.47545105, 'auroc': 0.60776985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9988678, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42347  48
1   4325   0
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.48202264, 'recall': 0.49939117, 'specificity': 0.49939117, 'f1': 0.49055323, 'auroc': 0.35428008, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18045  22
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.23699917, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_3.png
early stop counter: 1
val acc:0.9629135727882385, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-22 19:18:46.700109,epoch time: 0:16:11.454286,used: 0:49:24.001401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9072346, 'precision': 0.45370468, 'recall': 0.49989384, 'specificity': 0.49989384, 'f1': 0.47568065, 'auroc': 0.60617924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997877, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42386  9
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.33904094, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26677012, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_4.png
better model found
persisted
after epoch: 4,now: 2024-06-22 19:35:02.273770,epoch time: 0:16:15.573661,used: 1:05:39.575062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9072346, 'precision': 0.45372412, 'recall': 0.49987027, 'specificity': 0.49987027, 'f1': 0.47568065, 'auroc': 0.71746635, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99974054, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42386  11
1   4323   0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.35246712, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.27802336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_5.png
better model found
persisted
after epoch: 5,now: 2024-06-22 19:51:16.183054,epoch time: 0:16:13.909284,used: 1:21:53.484346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90678513, 'precision': 0.45367417, 'recall': 0.49965796, 'specificity': 0.49965796, 'f1': 0.47555703, 'auroc': 0.7686759, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993159, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42365  29
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.48203513, 'recall': 0.49975094, 'specificity': 0.49975094, 'f1': 0.4907332, 'auroc': 0.3666115, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18058  9
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3297438, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_6.png
early stop counter: 1
val acc:0.9636072516441345, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 20:07:41.011072,epoch time: 0:16:24.828018,used: 1:38:18.312364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9055651, 'precision': 0.48312062, 'recall': 0.499562, 'specificity': 0.499562, 'f1': 0.47657415, 'auroc': 0.8270005, 'binary_precision': 0.05882353, 'binary_recall': 0.0013882462, 'binary_specificity': 0.99773574, 'binary_f1_score': 0.0027124775}
confusion matrix:
       0   1
0  42302  96
1   4316   6
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.40512943, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.35737437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_7.png
early stop counter: 2
val acc:0.9634471535682678, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 20:23:48.308415,epoch time: 0:16:07.297343,used: 1:54:25.609707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90747005, 'precision': 0.70411074, 'recall': 0.5044663, 'specificity': 0.5044663, 'f1': 0.48547474, 'auroc': 0.8563134, 'binary_precision': 0.5, 'binary_recall': 0.009946796, 'binary_specificity': 0.99898577, 'binary_f1_score': 0.019505555}
confusion matrix:
       0   1
0  42354  43
1   4280  43
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.48203897, 'recall': 0.49986163, 'specificity': 0.49986163, 'f1': 0.49078858, 'auroc': 0.42894578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18062  5
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.48455215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_8.png
early stop counter: 3
val acc:0.9638206958770752, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-22 20:39:57.502997,epoch time: 0:16:09.194582,used: 2:10:34.804289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90819776, 'precision': 0.7398735, 'recall': 0.51526195, 'specificity': 0.51526195, 'f1': 0.5071247, 'auroc': 0.8421674, 'binary_precision': 0.5697211, 'binary_recall': 0.03307123, 'binary_specificity': 0.9974526, 'binary_f1_score': 0.062513664}
confusion matrix:
       0    1
0  42288  108
1   4181  143
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.4196609, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.50168264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_9.png
early stop counter: 4
val acc:0.9638740420341492, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 20:56:23.877464,epoch time: 0:16:26.374467,used: 2:27:01.178756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9145762, 'precision': 0.81136334, 'recall': 0.5633274, 'specificity': 0.5633274, 'f1': 0.5887946, 'auroc': 0.8913015, 'binary_precision': 0.7044335, 'binary_recall': 0.13231552, 'binary_specificity': 0.9943392, 'binary_f1_score': 0.22278482}
confusion matrix:
       0    1
0  42157  240
1   3751  572
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.48199862, 'recall': 0.49869928, 'specificity': 0.49869928, 'f1': 0.49020675, 'auroc': 0.46110237, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18020  47
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5145912, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_10.png
early stop counter: 5
val acc:0.9615795016288757, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 21:12:42.204558,epoch time: 0:16:18.327094,used: 2:43:19.505850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9197774, 'precision': 0.8538447, 'recall': 0.5890439, 'specificity': 0.5890439, 'f1': 0.6272678, 'auroc': 0.89218247, 'binary_precision': 0.7849356, 'binary_recall': 0.18320611, 'binary_specificity': 0.9948817, 'binary_f1_score': 0.2970743}
confusion matrix:
       0    1
0  42180  217
1   3531  792
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.48202074, 'recall': 0.4993358, 'specificity': 0.4993358, 'f1': 0.4905255, 'auroc': 0.47730908, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18043  24
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.62951857, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_11.png
early stop counter: 6
val acc:0.9628068208694458, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 21:28:52.592171,epoch time: 0:16:10.387613,used: 2:59:29.893463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.935381, 'precision': 0.89307153, 'recall': 0.68095374, 'specificity': 0.68095374, 'f1': 0.7395805, 'auroc': 0.9271654, 'binary_precision': 0.8470526, 'binary_recall': 0.3687009, 'binary_specificity': 0.99320656, 'binary_f1_score': 0.51377034}
confusion matrix:
       0     1
0  42106   288
1   2731  1595
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.4819909, 'recall': 0.49847788, 'specificity': 0.49847788, 'f1': 0.4900958, 'auroc': 0.51161706, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18012  55
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.630799, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_12.png
early stop counter: 7
val acc:0.9611526131629944, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 21:45:06.996368,epoch time: 0:16:14.404197,used: 3:15:44.297660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9318921, 'precision': 0.88280046, 'recall': 0.6627636, 'specificity': 0.6627636, 'f1': 0.71916467, 'auroc': 0.910615, 'binary_precision': 0.829775, 'binary_recall': 0.33248556, 'binary_specificity': 0.99304163, 'binary_f1_score': 0.47474417}
confusion matrix:
       0     1
0  42100   295
1   2887  1438
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.4819967, 'recall': 0.49864393, 'specificity': 0.49864393, 'f1': 0.49017897, 'auroc': 0.48938, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18018  49
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6133218, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_13.png
early stop counter: 8
val acc:0.9614728093147278, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-22 22:01:27.117542,epoch time: 0:16:20.121174,used: 3:32:04.418834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93730736, 'precision': 0.8896878, 'recall': 0.69619924, 'specificity': 0.69619924, 'f1': 0.7540257, 'auroc': 0.91705036, 'binary_precision': 0.83744556, 'binary_recall': 0.40032378, 'binary_specificity': 0.9920747, 'binary_f1_score': 0.54169923}
confusion matrix:
       0     1
0  42060   336
1   2593  1731
---- Validation: 
scalar performance:
{'acc': 0.960619, 'precision': 0.48198125, 'recall': 0.49820113, 'specificity': 0.49820113, 'f1': 0.48995697, 'auroc': 0.51756036, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18002  65
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.8793582, 'recall': 0.50760823, 'specificity': 0.50760823, 'f1': 0.50451565, 'auroc': 0.6816031, 'binary_precision': 0.8, 'binary_recall': 0.015384615, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.03018868}
confusion matrix:
      0  1
0  5945  1
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_14.png
new oracle model saved
early stop counter: 9
val acc:0.9606189727783203, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9585884809494019
after epoch: 14,now: 2024-06-22 22:17:55.235114,epoch time: 0:16:28.117572,used: 3:48:32.536406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93974745, 'precision': 0.895325, 'recall': 0.7093439, 'specificity': 0.7093439, 'f1': 0.76743776, 'auroc': 0.92328167, 'binary_precision': 0.8463303, 'binary_recall': 0.4265896, 'binary_specificity': 0.99209815, 'binary_f1_score': 0.567256}
confusion matrix:
       0     1
0  42060   335
1   2480  1845
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.49163595, 'recall': 0.49933153, 'specificity': 0.49933153, 'f1': 0.49154392, 'auroc': 0.53982496, 'binary_precision': 0.01923077, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.0027586208}
confusion matrix:
       0   1
0  18016  51
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6667675, 'recall': 0.5053488, 'specificity': 0.5053488, 'f1': 0.50040686, 'auroc': 0.70675015, 'binary_precision': 0.375, 'binary_recall': 0.011538462, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.02238806}
confusion matrix:
      0  1
0  5941  5
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_15.png
early stop counter: 10
val acc:0.961419403553009, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9585884809494019
after epoch: 15,now: 2024-06-22 22:34:23.769114,epoch time: 0:16:28.534000,used: 4:05:01.070406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9399829, 'precision': 0.9062966, 'recall': 0.70376384, 'specificity': 0.70376384, 'f1': 0.7642839, 'auroc': 0.9236165, 'binary_precision': 0.86935407, 'binary_recall': 0.41387284, 'binary_specificity': 0.9936549, 'binary_f1_score': 0.56077695}
confusion matrix:
       0     1
0  42126   269
1   2535  1790
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.4820063, 'recall': 0.49892068, 'specificity': 0.49892068, 'f1': 0.49031764, 'auroc': 0.5184994, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18028  39
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.68222785, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_16.png
early stop counter: 11
val acc:0.9620063900947571, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9585884809494019
after epoch: 16,now: 2024-06-22 22:50:44.515208,epoch time: 0:16:20.746094,used: 4:21:21.816500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94541955, 'precision': 0.90296364, 'recall': 0.7426788, 'specificity': 0.7426788, 'f1': 0.7983848, 'auroc': 0.9289893, 'binary_precision': 0.8554265, 'binary_recall': 0.49387282, 'binary_specificity': 0.9914848, 'binary_f1_score': 0.62620926}
confusion matrix:
       0     1
0  42034   361
1   2189  2136
---- Validation: 
scalar performance:
{'acc': 0.96029884, 'precision': 0.48884964, 'recall': 0.49875036, 'specificity': 0.49875036, 'f1': 0.49121362, 'auroc': 0.5598041, 'binary_precision': 0.01369863, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.0026809652}
confusion matrix:
       0   1
0  17995  72
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7773577, 'recall': 0.5354453, 'specificity': 0.5354453, 'f1': 0.5545899, 'auroc': 0.73443615, 'binary_precision': 0.59375, 'binary_recall': 0.073076926, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.130137}
confusion matrix:
      0   1
0  5933  13
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_17.png
new oracle model saved
early stop counter: 12
val acc:0.9602988362312317, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 17,now: 2024-06-22 23:07:07.245674,epoch time: 0:16:22.730466,used: 4:37:44.546966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9499572, 'precision': 0.9142301, 'recall': 0.76448834, 'specificity': 0.76448834, 'f1': 0.8190484, 'auroc': 0.9389993, 'binary_precision': 0.87391794, 'binary_recall': 0.5368786, 'binary_specificity': 0.99209815, 'binary_f1_score': 0.6651389}
confusion matrix:
       0     1
0  42060   335
1   2003  2322
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.50178784, 'recall': 0.50020856, 'specificity': 0.50020856, 'f1': 0.49389124, 'auroc': 0.6013176, 'binary_precision': 0.039473683, 'binary_recall': 0.004457652, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.00801068}
confusion matrix:
       0   1
0  17994  73
1    670   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.79665846, 'recall': 0.5449766, 'specificity': 0.5449766, 'f1': 0.57021827, 'auroc': 0.75279045, 'binary_precision': 0.6315789, 'binary_recall': 0.092307694, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.16107383}
confusion matrix:
      0   1
0  5932  14
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_18.png
new oracle model saved
early stop counter: 13
val acc:0.9603521823883057, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9597163796424866
after epoch: 18,now: 2024-06-22 23:23:22.810515,epoch time: 0:16:15.564841,used: 4:54:00.111807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9478168, 'precision': 0.91666543, 'recall': 0.74846375, 'specificity': 0.74846375, 'f1': 0.80656075, 'auroc': 0.94274247, 'binary_precision': 0.8818292, 'binary_recall': 0.50381505, 'binary_specificity': 0.9931124, 'binary_f1_score': 0.6412596}
confusion matrix:
       0     1
0  42103   292
1   2146  2179
---- Validation: 
scalar performance:
{'acc': 0.9609925, 'precision': 0.51239043, 'recall': 0.5012559, 'specificity': 0.5012559, 'f1': 0.4954647, 'auroc': 0.61221474, 'binary_precision': 0.060606062, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.010825439}
confusion matrix:
       0   1
0  18005  62
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8418865, 'recall': 0.5586063, 'specificity': 0.5586063, 'f1': 0.59235895, 'auroc': 0.7684052, 'binary_precision': 0.7209302, 'binary_recall': 0.11923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.20462047}
confusion matrix:
      0   1
0  5934  12
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_19.png
new oracle model saved
early stop counter: 14
val acc:0.9609925150871277, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9611666202545166
after epoch: 19,now: 2024-06-22 23:39:42.306922,epoch time: 0:16:19.496407,used: 5:10:19.608214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_22_seed_1_21546972
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9505137, 'precision': 0.90145564, 'recall': 0.7793333, 'specificity': 0.7793333, 'f1': 0.82678926, 'auroc': 0.9417714, 'binary_precision': 0.8454139, 'binary_recall': 0.56928056, 'binary_specificity': 0.989386, 'binary_f1_score': 0.68039805}
confusion matrix:
       0     1
0  41947   450
1   1862  2461
---- Validation: 
scalar performance:
{'acc': 0.9592316, 'precision': 0.48735735, 'recall': 0.49819687, 'specificity': 0.49819687, 'f1': 0.49090073, 'auroc': 0.571777, 'binary_precision': 0.010752688, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.002610966}
confusion matrix:
       0   1
0  17975  92
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7950504, 'recall': 0.55057764, 'specificity': 0.55057764, 'f1': 0.57882726, 'auroc': 0.73316336, 'binary_precision': 0.627907, 'binary_recall': 0.103846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.17821783}
confusion matrix:
      0   1
0  5930  16
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546972_20.png
[Sat Jun 22 23:55:37 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/0.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 92718208 vs 92718040
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
