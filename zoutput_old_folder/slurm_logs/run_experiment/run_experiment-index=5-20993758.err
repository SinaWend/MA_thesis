Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 30 20:39:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758

 Experiment start at: 2024-05-30 20:48:39.481642
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97054255, 'precision': 0.7820856, 'recall': 0.710013, 'specificity': 0.710013, 'f1': 0.74026394, 'auroc': 0.94853956, 'binary_precision': 0.58379376, 'binary_recall': 0.43070653, 'binary_specificity': 0.98931944, 'binary_f1_score': 0.49569976}
confusion matrix:
       0    1
0  41868  452
1    838  634
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.77530074, 'recall': 0.66505486, 'specificity': 0.66505486, 'f1': 0.7050711, 'auroc': 0.94718397, 'binary_precision': 0.5736842, 'binary_recall': 0.33903578, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.4261975}
confusion matrix:
       0    1
0  17987  162
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.92695016, 'recall': 0.68282413, 'specificity': 0.68282413, 'f1': 0.75213194, 'auroc': 0.9316325, 'binary_precision': 0.88073397, 'binary_recall': 0.3678161, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.51891893}
confusion matrix:
      0   1
0  5984  13
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 21:28:22.478087,epoch time: 0:39:42.996445,used: 0:39:42.996445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97463006, 'precision': 0.8216404, 'recall': 0.7468711, 'specificity': 0.7468711, 'f1': 0.77890265, 'auroc': 0.965358, 'binary_precision': 0.66041106, 'binary_recall': 0.5027211, 'binary_specificity': 0.9910212, 'binary_f1_score': 0.5708767}
confusion matrix:
       0    1
0  41942  380
1    731  739
---- Validation: 
scalar performance:
{'acc': 0.9743508, 'precision': 0.8676088, 'recall': 0.6821986, 'specificity': 0.6821986, 'f1': 0.7413283, 'auroc': 0.9590455, 'binary_precision': 0.7571885, 'binary_recall': 0.36858475, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.49581593}
confusion matrix:
       0    1
0  18073   76
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.87211984, 'recall': 0.5737955, 'specificity': 0.5737955, 'f1': 0.61585665, 'auroc': 0.9376643, 'binary_precision': 0.78, 'binary_recall': 0.14942528, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.25080386}
confusion matrix:
      0   1
0  5986  11
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 2,now: 2024-05-30 22:06:34.401495,epoch time: 0:38:11.923408,used: 1:17:54.919853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97631985, 'precision': 0.8158699, 'recall': 0.8243594, 'specificity': 0.8243594, 'f1': 0.8200529, 'auroc': 0.9725977, 'binary_precision': 0.6435185, 'binary_recall': 0.6614548, 'binary_specificity': 0.987264, 'binary_f1_score': 0.65236336}
confusion matrix:
       0    1
0  41782  539
1    498  973
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.8512337, 'recall': 0.7699151, 'specificity': 0.7699151, 'f1': 0.804795, 'auroc': 0.9655942, 'binary_precision': 0.71836734, 'binary_recall': 0.5474339, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.6213592}
confusion matrix:
       0    1
0  18011  138
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.897883, 'recall': 0.61011064, 'specificity': 0.61011064, 'f1': 0.66640425, 'auroc': 0.93927646, 'binary_precision': 0.82857144, 'binary_recall': 0.22222222, 'binary_specificity': 0.997999, 'binary_f1_score': 0.35045317}
confusion matrix:
      0   1
0  5985  12
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 3,now: 2024-05-30 22:44:27.950046,epoch time: 0:37:53.548551,used: 1:55:48.468404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9796081, 'precision': 0.8894715, 'recall': 0.76257086, 'specificity': 0.76257086, 'f1': 0.8127331, 'auroc': 0.9768603, 'binary_precision': 0.795107, 'binary_recall': 0.5298913, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.6359559}
confusion matrix:
       0    1
0  42119  201
1    692  780
---- Validation: 
scalar performance:
{'acc': 0.97467005, 'precision': 0.9320204, 'recall': 0.64786136, 'specificity': 0.64786136, 'f1': 0.7161303, 'auroc': 0.96891177, 'binary_precision': 0.88837206, 'binary_recall': 0.2970451, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.44522145}
confusion matrix:
       0    1
0  18125   24
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.9498803, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9746700525283813, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9656440019607544 / 0.9715564250946045
after epoch: 4,now: 2024-05-30 23:22:30.027773,epoch time: 0:38:02.077727,used: 2:33:50.546131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9806814, 'precision': 0.84680355, 'recall': 0.8627059, 'specificity': 0.8627059, 'f1': 0.85456, 'auroc': 0.9790652, 'binary_precision': 0.7027904, 'binary_recall': 0.73623383, 'binary_specificity': 0.98917794, 'binary_f1_score': 0.7191234}
confusion matrix:
       0     1
0  41863   458
1    388  1083
---- Validation: 
scalar performance:
{'acc': 0.98068327, 'precision': 0.87508935, 'recall': 0.81223637, 'specificity': 0.81223637, 'f1': 0.8405469, 'auroc': 0.97369254, 'binary_precision': 0.7631579, 'binary_recall': 0.63141525, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.6910638}
confusion matrix:
       0    1
0  18023  126
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8717683, 'recall': 0.63618016, 'specificity': 0.63618016, 'f1': 0.6947564, 'auroc': 0.94445527, 'binary_precision': 0.7741935, 'binary_recall': 0.27586207, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.40677965}
confusion matrix:
      0   1
0  5976  21
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 5,now: 2024-05-31 00:00:25.553784,epoch time: 0:37:55.526011,used: 3:11:46.072142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.9302728, 'recall': 0.7825614, 'specificity': 0.7825614, 'f1': 0.8400252, 'auroc': 0.9826828, 'binary_precision': 0.8753927, 'binary_recall': 0.5679348, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.6889164}
confusion matrix:
       0    1
0  42201  119
1    636  836
---- Validation: 
scalar performance:
{'acc': 0.9758408, 'precision': 0.9298369, 'recall': 0.66871893, 'specificity': 0.66871893, 'f1': 0.73875755, 'auroc': 0.9744899, 'binary_precision': 0.88259107, 'binary_recall': 0.33903578, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.48988762}
confusion matrix:
       0    1
0  18120   29
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.9435939, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9758408069610596, best validation acc: 0.9806832671165466, corresponding to test acc:                         0.9664429426193237 / 0.9715564250946045
after epoch: 6,now: 2024-05-31 00:38:37.899813,epoch time: 0:38:12.346029,used: 3:49:58.418171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9845406, 'precision': 0.8809352, 'recall': 0.88118505, 'specificity': 0.88118505, 'f1': 0.88106006, 'auroc': 0.984442, 'binary_precision': 0.7698574, 'binary_recall': 0.77038044, 'binary_specificity': 0.9919896, 'binary_f1_score': 0.7701188}
confusion matrix:
       0     1
0  41981   339
1    338  1134
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.8805032, 'recall': 0.8639226, 'specificity': 0.8639226, 'f1': 0.87201214, 'auroc': 0.97593033, 'binary_precision': 0.7703583, 'binary_recall': 0.7356143, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.7525855}
confusion matrix:
       0    1
0  18008  141
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.876506, 'recall': 0.57762694, 'specificity': 0.57762694, 'f1': 0.6215255, 'auroc': 0.9505858, 'binary_precision': 0.78846157, 'binary_recall': 0.15708812, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.26198083}
confusion matrix:
      0   1
0  5986  11
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 7,now: 2024-05-31 01:16:55.790127,epoch time: 0:38:17.890314,used: 4:28:16.308485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9823027, 'precision': 0.9338939, 'recall': 0.77150583, 'specificity': 0.77150583, 'f1': 0.8327053, 'auroc': 0.9863967, 'binary_precision': 0.88338834, 'binary_recall': 0.5455163, 'binary_specificity': 0.9974953, 'binary_f1_score': 0.6745065}
confusion matrix:
       0    1
0  42214  106
1    669  803
---- Validation: 
scalar performance:
{'acc': 0.9792997, 'precision': 0.9091103, 'recall': 0.7440151, 'specificity': 0.7440151, 'f1': 0.80418086, 'auroc': 0.9768999, 'binary_precision': 0.83597887, 'binary_recall': 0.49144635, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.619001}
confusion matrix:
       0    1
0  18087   62
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9410341, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9792997241020203, best validation acc: 0.9834504127502441, corresponding to test acc:                         0.963087260723114 / 0.9715564250946045
after epoch: 8,now: 2024-05-31 01:55:12.864035,epoch time: 0:38:17.073908,used: 5:06:33.382393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98556817, 'precision': 0.8852166, 'recall': 0.89581466, 'specificity': 0.89581466, 'f1': 0.8904375, 'auroc': 0.98674315, 'binary_precision': 0.7774108, 'binary_recall': 0.7995924, 'binary_specificity': 0.9920369, 'binary_f1_score': 0.7883456}
confusion matrix:
       0     1
0  41983   337
1    295  1177
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.90325135, 'recall': 0.8479173, 'specificity': 0.8479173, 'f1': 0.87337995, 'auroc': 0.9787248, 'binary_precision': 0.817029, 'binary_recall': 0.7013997, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.75481176}
confusion matrix:
       0    1
0  18048  101
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.84831804, 'recall': 0.5622179, 'specificity': 0.5622179, 'f1': 0.5980151, 'auroc': 0.94093585, 'binary_precision': 0.73333335, 'binary_recall': 0.12643678, 'binary_specificity': 0.997999, 'binary_f1_score': 0.21568628}
confusion matrix:
      0   1
0  5985  12
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 9,now: 2024-05-31 02:33:26.529697,epoch time: 0:38:13.665662,used: 5:44:47.048055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98620754, 'precision': 0.932582, 'recall': 0.8416144, 'specificity': 0.8416144, 'f1': 0.881354, 'auroc': 0.9894514, 'binary_precision': 0.8759757, 'binary_recall': 0.6866078, 'binary_specificity': 0.9966211, 'binary_f1_score': 0.7698171}
confusion matrix:
       0     1
0  42178   143
1    461  1010
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9346014, 'recall': 0.8033886, 'specificity': 0.8033886, 'f1': 0.8564745, 'auroc': 0.97778875, 'binary_precision': 0.8828829, 'binary_recall': 0.6096423, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.72125113}
confusion matrix:
       0    1
0  18097   52
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.9341469, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.98387610912323, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9616490602493286 / 0.9715564250946045
after epoch: 10,now: 2024-05-31 03:11:34.873360,epoch time: 0:38:08.343663,used: 6:22:55.391718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9867784, 'precision': 0.928491, 'recall': 0.8563458, 'specificity': 0.8563458, 'f1': 0.888849, 'auroc': 0.9893883, 'binary_precision': 0.8667763, 'binary_recall': 0.71651936, 'binary_specificity': 0.99617213, 'binary_f1_score': 0.78451806}
confusion matrix:
       0     1
0  42159   162
1    417  1054
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.9223062, 'recall': 0.823888, 'specificity': 0.823888, 'f1': 0.86610866, 'auroc': 0.97675514, 'binary_precision': 0.85685074, 'binary_recall': 0.65163296, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7402827}
confusion matrix:
       0    1
0  18079   70
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.9155953, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9843550324440002, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9616490602493286 / 0.9715564250946045
after epoch: 11,now: 2024-05-31 03:49:46.822019,epoch time: 0:38:11.948659,used: 7:01:07.340377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9881257, 'precision': 0.9215225, 'recall': 0.889925, 'specificity': 0.889925, 'f1': 0.9050595, 'auroc': 0.99086094, 'binary_precision': 0.8505155, 'binary_recall': 0.78464675, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.81625444}
confusion matrix:
       0     1
0  42117   203
1    317  1155
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.92228913, 'recall': 0.8732966, 'specificity': 0.8732966, 'f1': 0.8961635, 'auroc': 0.9791403, 'binary_precision': 0.8533569, 'binary_recall': 0.7511664, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.7990074}
confusion matrix:
       0    1
0  18066   83
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.91725993, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 12,now: 2024-05-31 04:28:09.850653,epoch time: 0:38:23.028634,used: 7:39:30.369011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9885139, 'precision': 0.9399884, 'recall': 0.8747164, 'specificity': 0.8747164, 'f1': 0.90453917, 'auroc': 0.9918939, 'binary_precision': 0.88853246, 'binary_recall': 0.7527174, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.8150055}
confusion matrix:
       0     1
0  42181   139
1    364  1108
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9337209, 'recall': 0.84124327, 'specificity': 0.84124327, 'f1': 0.88154405, 'auroc': 0.97948134, 'binary_precision': 0.87848604, 'binary_recall': 0.6858476, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.77030563}
confusion matrix:
       0    1
0  18088   61
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.92560637, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9860047101974487, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9605305194854736 / 0.9715564250946045
after epoch: 13,now: 2024-05-31 05:06:29.450246,epoch time: 0:38:19.599593,used: 8:17:49.968604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98906195, 'precision': 0.9519683, 'recall': 0.8717214, 'specificity': 0.8717214, 'f1': 0.90764666, 'auroc': 0.9923365, 'binary_precision': 0.9127182, 'binary_recall': 0.74592394, 'binary_specificity': 0.9975189, 'binary_f1_score': 0.8209346}
confusion matrix:
       0     1
0  42215   105
1    374  1098
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.94067454, 'recall': 0.81438524, 'specificity': 0.81438524, 'f1': 0.8661947, 'auroc': 0.9785756, 'binary_precision': 0.8942731, 'binary_recall': 0.63141525, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7402005}
confusion matrix:
       0    1
0  18101   48
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.92480063, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9848339557647705, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9605305194854736 / 0.9715564250946045
after epoch: 14,now: 2024-05-31 05:44:46.699879,epoch time: 0:38:17.249633,used: 8:56:07.218237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9885824, 'precision': 0.9054296, 'recall': 0.92294717, 'specificity': 0.92294717, 'f1': 0.9139875, 'auroc': 0.9937068, 'binary_precision': 0.8159948, 'binary_recall': 0.8525815, 'binary_specificity': 0.99331284, 'binary_f1_score': 0.83388704}
confusion matrix:
       0     1
0  42037   283
1    217  1255
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.8868393, 'recall': 0.8926389, 'specificity': 0.8926389, 'f1': 0.8897156, 'auroc': 0.9803855, 'binary_precision': 0.78101075, 'binary_recall': 0.7931571, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.7870371}
confusion matrix:
       0    1
0  18006  143
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.822322, 'recall': 0.55630404, 'specificity': 0.55630404, 'f1': 0.5883287, 'auroc': 0.90150326, 'binary_precision': 0.6818182, 'binary_recall': 0.11494253, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19672132}
confusion matrix:
      0   1
0  5983  14
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 3
val acc:0.9853128790855408, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9605305194854736 / 0.9715564250946045
after epoch: 15,now: 2024-05-31 06:23:02.423377,epoch time: 0:38:15.723498,used: 9:34:22.941735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99045485, 'precision': 0.9303298, 'recall': 0.92129314, 'specificity': 0.92129314, 'f1': 0.9257597, 'auroc': 0.9941164, 'binary_precision': 0.8659722, 'binary_recall': 0.84714675, 'binary_specificity': 0.9954395, 'binary_f1_score': 0.85645604}
confusion matrix:
       0     1
0  42127   193
1    225  1247
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.91649103, 'recall': 0.86691046, 'specificity': 0.86691046, 'f1': 0.89000523, 'auroc': 0.98131144, 'binary_precision': 0.8421986, 'binary_recall': 0.7387247, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.7870754}
confusion matrix:
       0    1
0  18060   89
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8918451, 'recall': 0.5607191, 'specificity': 0.5607191, 'f1': 0.5970072, 'auroc': 0.91710114, 'binary_precision': 0.82051283, 'binary_recall': 0.12260536, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.21333332}
confusion matrix:
      0   1
0  5990   7
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 4
val acc:0.9863239526748657, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9605305194854736 / 0.9715564250946045
after epoch: 16,now: 2024-05-31 07:01:01.274734,epoch time: 0:37:58.851357,used: 10:12:21.793092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.95277846, 'recall': 0.88290703, 'specificity': 0.88290703, 'f1': 0.91470397, 'auroc': 0.99456644, 'binary_precision': 0.9135703, 'binary_recall': 0.7683424, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.83468634}
confusion matrix:
       0     1
0  42213   107
1    341  1131
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9375752, 'recall': 0.8576005, 'specificity': 0.8576005, 'f1': 0.8932578, 'auroc': 0.97777265, 'binary_precision': 0.88505745, 'binary_recall': 0.718507, 'binary_specificity': 0.996694, 'binary_f1_score': 0.793133}
confusion matrix:
       0    1
0  18089   60
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9079269, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 17,now: 2024-05-31 07:39:00.062640,epoch time: 0:37:58.787906,used: 10:50:20.580998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9907746, 'precision': 0.94695854, 'recall': 0.906377, 'specificity': 0.906377, 'f1': 0.9256288, 'auroc': 0.99565697, 'binary_precision': 0.90029985, 'binary_recall': 0.81589675, 'binary_specificity': 0.9968573, 'binary_f1_score': 0.85602283}
confusion matrix:
       0     1
0  42187   133
1    271  1201
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9344936, 'recall': 0.8590455, 'specificity': 0.8590455, 'f1': 0.89290583, 'auroc': 0.9824016, 'binary_precision': 0.8787879, 'binary_recall': 0.7216174, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.79248506}
confusion matrix:
       0    1
0  18085   64
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.81986356, 'recall': 0.5356481, 'specificity': 0.5356481, 'f1': 0.55547976, 'auroc': 0.91773725, 'binary_precision': 0.6785714, 'binary_recall': 0.07279693, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.13148788}
confusion matrix:
      0   1
0  5988   9
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9870689511299133, best validation acc: 0.9871754050254822, corresponding to test acc:                         0.960210919380188 / 0.9715564250946045
after epoch: 18,now: 2024-05-31 08:17:02.720641,epoch time: 0:38:02.658001,used: 11:28:23.238999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9912541, 'precision': 0.93847394, 'recall': 0.92493564, 'specificity': 0.92493564, 'f1': 0.93159026, 'auroc': 0.99497646, 'binary_precision': 0.8820225, 'binary_recall': 0.85384095, 'binary_specificity': 0.99603033, 'binary_f1_score': 0.86770296}
confusion matrix:
       0     1
0  42153   168
1    215  1256
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9323838, 'recall': 0.8782928, 'specificity': 0.8782928, 'f1': 0.9033915, 'auroc': 0.98162323, 'binary_precision': 0.8732143, 'binary_recall': 0.7604977, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.8129676}
confusion matrix:
       0    1
0  18078   71
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82936835, 'recall': 0.54322755, 'specificity': 0.54322755, 'f1': 0.5680857, 'auroc': 0.9080565, 'binary_precision': 0.6969697, 'binary_recall': 0.08812261, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5987  10
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 19,now: 2024-05-31 08:55:06.516092,epoch time: 0:38:03.795451,used: 12:06:27.034450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99093443, 'precision': 0.9666506, 'recall': 0.8887553, 'specificity': 0.8887553, 'f1': 0.9238974, 'auroc': 0.996095, 'binary_precision': 0.9409352, 'binary_recall': 0.77921194, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.8524712}
confusion matrix:
       0     1
0  42248    72
1    325  1147
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.9484849, 'recall': 0.8316303, 'specificity': 0.8316303, 'f1': 0.8806639, 'auroc': 0.9798758, 'binary_precision': 0.9087049, 'binary_recall': 0.66562986, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.7684021}
confusion matrix:
       0    1
0  18106   43
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.91310245, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9862707257270813, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.9603707194328308 / 0.9715564250946045
after epoch: 20,now: 2024-05-31 09:33:03.226365,epoch time: 0:37:56.710273,used: 12:44:23.744723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99159664, 'precision': 0.9348414, 'recall': 0.9359818, 'specificity': 0.9359818, 'f1': 0.93541086, 'auroc': 0.99601173, 'binary_precision': 0.87398374, 'binary_recall': 0.8763587, 'binary_specificity': 0.99560493, 'binary_f1_score': 0.87516963}
confusion matrix:
       0     1
0  42134   186
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.9237509, 'recall': 0.89187646, 'specificity': 0.89187646, 'f1': 0.9071404, 'auroc': 0.9826933, 'binary_precision': 0.8549747, 'binary_recall': 0.7884914, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8203883}
confusion matrix:
       0    1
0  18063   86
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.837801, 'recall': 0.5376472, 'specificity': 0.5376472, 'f1': 0.55902183, 'auroc': 0.8769029, 'binary_precision': 0.71428573, 'binary_recall': 0.07662835, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1384083}
confusion matrix:
      0   1
0  5989   8
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 21,now: 2024-05-31 10:10:58.410627,epoch time: 0:37:55.184262,used: 13:22:18.928985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9881257, 'precision': 0.8813549, 'recall': 0.96135277, 'specificity': 0.96135277, 'f1': 0.9172108, 'auroc': 0.99633443, 'binary_precision': 0.765067, 'binary_recall': 0.93265307, 'binary_specificity': 0.99005246, 'binary_f1_score': 0.84058857}
confusion matrix:
       0     1
0  41901   421
1     99  1371
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.87350214, 'recall': 0.9242239, 'specificity': 0.9242239, 'f1': 0.8971015, 'auroc': 0.9819218, 'binary_precision': 0.7520436, 'binary_recall': 0.8584759, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.801743}
confusion matrix:
       0    1
0  17967  182
1     91  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.83486986, 'recall': 0.58087474, 'specificity': 0.58087474, 'f1': 0.62386346, 'auroc': 0.9169378, 'binary_precision': 0.704918, 'binary_recall': 0.16475096, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.26708075}
confusion matrix:
      0   1
0  5979  18
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.985472559928894, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.960210919380188 / 0.9715564250946045
after epoch: 22,now: 2024-05-31 10:49:03.656784,epoch time: 0:38:05.246157,used: 14:00:24.175142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9917565, 'precision': 0.9506881, 'recall': 0.9189619, 'specificity': 0.9189619, 'f1': 0.93420184, 'auroc': 0.9967989, 'binary_precision': 0.9068915, 'binary_recall': 0.84092456, 'binary_specificity': 0.99699914, 'binary_f1_score': 0.8726632}
confusion matrix:
       0     1
0  42194   127
1    234  1237
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.93738174, 'recall': 0.8753752, 'specificity': 0.8753752, 'f1': 0.90382904, 'auroc': 0.9815738, 'binary_precision': 0.8834244, 'binary_recall': 0.7542768, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.8137584}
confusion matrix:
       0    1
0  18085   64
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8845907, 'recall': 0.53981304, 'specificity': 0.53981304, 'f1': 0.56315356, 'auroc': 0.85554194, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5992   5
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9881864786148071, best validation acc: 0.9881864786148071, corresponding to test acc:                         0.960210919380188 / 0.9715564250946045
after epoch: 23,now: 2024-05-31 11:27:15.565993,epoch time: 0:38:11.909209,used: 14:38:36.084351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.9462551, 'recall': 0.9310196, 'specificity': 0.9310196, 'f1': 0.9384947, 'auroc': 0.9976139, 'binary_precision': 0.8971831, 'binary_recall': 0.8654891, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.88105124}
confusion matrix:
       0     1
0  42174   146
1    198  1274
---- Validation: 
scalar performance:
{'acc': 0.98887825, 'precision': 0.9390835, 'recall': 0.8854841, 'specificity': 0.8854841, 'f1': 0.9104055, 'auroc': 0.98085684, 'binary_precision': 0.886121, 'binary_recall': 0.7744945, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.826556}
confusion matrix:
       0    1
0  18085   64
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8845907, 'recall': 0.53981304, 'specificity': 0.53981304, 'f1': 0.56315356, 'auroc': 0.9177264, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5992   5
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 24,now: 2024-05-31 12:06:11.854355,epoch time: 0:38:56.288362,used: 15:17:32.372713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9919392, 'precision': 0.96130806, 'recall': 0.910586, 'specificity': 0.910586, 'f1': 0.934361, 'auroc': 0.9971398, 'binary_precision': 0.9287356, 'binary_recall': 0.82336956, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.8728844}
confusion matrix:
       0     1
0  42227    93
1    260  1212
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.939598, 'recall': 0.8344652, 'specificity': 0.8344652, 'f1': 0.87935793, 'auroc': 0.9811183, 'binary_precision': 0.8907217, 'binary_recall': 0.6718507, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7659574}
confusion matrix:
       0    1
0  18096   53
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7798174, 'recall': 0.5167411, 'specificity': 0.5167411, 'f1': 0.5220695, 'auroc': 0.85771346, 'binary_precision': 0.6, 'binary_recall': 0.03448276, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.06521738}
confusion matrix:
      0  1
0  5991  6
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9859514832496643, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9608501195907593 / 0.9715564250946045
after epoch: 25,now: 2024-05-31 12:44:08.327533,epoch time: 0:37:56.473178,used: 15:55:28.845891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9927841, 'precision': 0.9665052, 'recall': 0.9192196, 'specificity': 0.9192196, 'f1': 0.9415058, 'auroc': 0.9973923, 'binary_precision': 0.93854326, 'binary_recall': 0.84035325, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.8867383}
confusion matrix:
       0     1
0  42239    81
1    235  1237
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.9412482, 'recall': 0.8693197, 'specificity': 0.8693197, 'f1': 0.9018471, 'auroc': 0.9815482, 'binary_precision': 0.8915888, 'binary_recall': 0.7418352, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.8098472}
confusion matrix:
       0    1
0  18091   58
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.8538271, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9880800247192383, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9608501195907593 / 0.9715564250946045
after epoch: 26,now: 2024-05-31 13:21:58.658236,epoch time: 0:37:50.330703,used: 16:33:19.176594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99349195, 'precision': 0.9682054, 'recall': 0.92909384, 'specificity': 0.92909384, 'f1': 0.94773316, 'auroc': 0.9978695, 'binary_precision': 0.9412639, 'binary_recall': 0.8600544, 'binary_specificity': 0.99813324, 'binary_f1_score': 0.8988285}
confusion matrix:
       0     1
0  42241    79
1    206  1266
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.94086194, 'recall': 0.8569331, 'specificity': 0.8569331, 'f1': 0.89414674, 'auroc': 0.98222136, 'binary_precision': 0.8916828, 'binary_recall': 0.7169518, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7948276}
confusion matrix:
       0    1
0  18093   56
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.6387253, 'recall': 0.51215935, 'specificity': 0.51215935, 'f1': 0.5137401, 'auroc': 0.8725964, 'binary_precision': 0.3181818, 'binary_recall': 0.026819924, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.049469966}
confusion matrix:
      0   1
0  5982  15
1   254   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 3
val acc:0.9873350262641907, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9608501195907593 / 0.9715564250946045
after epoch: 27,now: 2024-05-31 13:59:12.101043,epoch time: 0:37:13.442807,used: 17:10:32.619401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9924187, 'precision': 0.94211894, 'recall': 0.9409584, 'specificity': 0.9409584, 'f1': 0.94153786, 'auroc': 0.9970571, 'binary_precision': 0.8882072, 'binary_recall': 0.88579196, 'binary_specificity': 0.99612486, 'binary_f1_score': 0.8869979}
confusion matrix:
       0     1
0  42157   164
1    168  1303
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.9259305, 'recall': 0.89581954, 'specificity': 0.89581954, 'f1': 0.9102787, 'auroc': 0.9828185, 'binary_precision': 0.8590604, 'binary_recall': 0.7962675, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.826473}
confusion matrix:
       0    1
0  18065   84
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7617351, 'recall': 0.53331554, 'specificity': 0.53331554, 'f1': 0.5509205, 'auroc': 0.84809613, 'binary_precision': 0.5625, 'binary_recall': 0.06896552, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.12286689}
confusion matrix:
      0   1
0  5983  14
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 4
val acc:0.9885589480400085, best validation acc: 0.9888782501220703, corresponding to test acc:                         0.9608501195907593 / 0.9715564250946045
after epoch: 28,now: 2024-05-31 14:37:01.417332,epoch time: 0:37:49.316289,used: 17:48:21.935690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9934691, 'precision': 0.9518249, 'recall': 0.9470794, 'specificity': 0.9470794, 'f1': 0.9494387, 'auroc': 0.998055, 'binary_precision': 0.9072165, 'binary_recall': 0.89734876, 'binary_specificity': 0.9968101, 'binary_f1_score': 0.90225565}
confusion matrix:
       0     1
0  42186   135
1    151  1320
---- Validation: 
scalar performance:
{'acc': 0.9890911, 'precision': 0.93265384, 'recall': 0.8968451, 'specificity': 0.8968451, 'f1': 0.9139148, 'auroc': 0.9820355, 'binary_precision': 0.872449, 'binary_recall': 0.7978227, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.83346874}
confusion matrix:
       0    1
0  18074   75
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8132309, 'recall': 0.51874024, 'specificity': 0.51874024, 'f1': 0.52577436, 'auroc': 0.88486886, 'binary_precision': 0.6666667, 'binary_recall': 0.038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5992   5
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 29,now: 2024-05-31 15:14:50.770119,epoch time: 0:37:49.352787,used: 18:26:11.288477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9946109, 'precision': 0.9629768, 'recall': 0.95324767, 'specificity': 0.95324767, 'f1': 0.95805657, 'auroc': 0.9985559, 'binary_precision': 0.92911744, 'binary_recall': 0.9089055, 'binary_specificity': 0.9975898, 'binary_f1_score': 0.9189004}
confusion matrix:
       0     1
0  42219   102
1    134  1337
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9288105, 'recall': 0.87971026, 'specificity': 0.87971026, 'f1': 0.902651, 'auroc': 0.9828428, 'binary_precision': 0.8659612, 'binary_recall': 0.7636081, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.8115703}
confusion matrix:
       0    1
0  18073   76
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.80635965, 'recall': 0.5280686, 'specificity': 0.5280686, 'f1': 0.5424343, 'auroc': 0.8884511, 'binary_precision': 0.65217394, 'binary_recall': 0.057471264, 'binary_specificity': 0.998666, 'binary_f1_score': 0.105633795}
confusion matrix:
      0   1
0  5989   8
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9878671765327454, best validation acc: 0.9890910983085632, corresponding to test acc:                         0.959092378616333 / 0.9715564250946045
after epoch: 30,now: 2024-05-31 15:52:39.025176,epoch time: 0:37:48.255057,used: 19:03:59.543534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_48_39_seed_0_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:03:59.543534 at 2024-05-31 15:52:39.025176
persisted model performance metric: 

scalar performance:
{'acc': 0.9600511, 'precision': 0.89197624, 'recall': 0.5265698, 'specificity': 0.5265698, 'f1': 0.5401456, 'auroc': 0.88875663, 'binary_precision': 0.8235294, 'binary_recall': 0.053639848, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.10071943}
confusion matrix:
      0   1
0  5994   3
1   247  14
oracle model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.9186251, 'recall': 0.6598357, 'specificity': 0.6598357, 'f1': 0.7268231, 'auroc': 0.9381295, 'binary_precision': 0.8659794, 'binary_recall': 0.3218391, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.46927372}
confusion matrix:
      0   1
0  5984  13
1   177  84
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413549 GiB | 413549 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400661 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152170 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152170 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |    2872    |   90174 K  |   90174 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      38    |    2760    |   42898 K  |   42898 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90175 K  |   90175 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   42900 K  |   42900 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152170 K  |  152170 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90175 K  |   90175 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   42900 K  |   42900 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758

 Experiment start at: 2024-05-31 16:02:50.988704
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9699927, 'precision': 0.77559197, 'recall': 0.66661674, 'specificity': 0.66661674, 'f1': 0.7064576, 'auroc': 0.945098, 'binary_precision': 0.57325584, 'binary_recall': 0.34188628, 'binary_specificity': 0.9913472, 'binary_f1_score': 0.42832324}
confusion matrix:
       0    1
0  42047  367
1    949  493
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.78044367, 'recall': 0.70174587, 'specificity': 0.70174587, 'f1': 0.73401195, 'auroc': 0.9478129, 'binary_precision': 0.58246344, 'binary_recall': 0.41456166, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.48437497}
confusion matrix:
       0    1
0  17867  200
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.69882774, 'recall': 0.52540946, 'specificity': 0.52540946, 'f1': 0.5370541, 'auroc': 0.9238125, 'binary_precision': 0.4375, 'binary_recall': 0.053846154, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.09589041}
confusion matrix:
      0   1
0  5928  18
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 16:42:09.634743,epoch time: 0:39:18.646039,used: 0:39:18.646039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9721361, 'precision': 0.7774879, 'recall': 0.81229997, 'specificity': 0.81229997, 'f1': 0.7937585, 'auroc': 0.96029115, 'binary_precision': 0.56721914, 'binary_recall': 0.64122134, 'binary_specificity': 0.9833785, 'binary_f1_score': 0.60195434}
confusion matrix:
       0    1
0  41710  705
1    517  924
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.7910011, 'recall': 0.7976556, 'specificity': 0.7976556, 'f1': 0.7942866, 'auroc': 0.96280694, 'binary_precision': 0.59651667, 'binary_recall': 0.61069834, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.60352415}
confusion matrix:
       0    1
0  17789  278
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7907145, 'recall': 0.61595124, 'specificity': 0.61595124, 'f1': 0.66191196, 'auroc': 0.94025207, 'binary_precision': 0.6138614, 'binary_recall': 0.23846154, 'binary_specificity': 0.993441, 'binary_f1_score': 0.3434903}
confusion matrix:
      0   1
0  5907  39
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 17:20:11.366817,epoch time: 0:38:01.732074,used: 1:17:20.378113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9769929, 'precision': 0.8482704, 'recall': 0.74760973, 'specificity': 0.74760973, 'f1': 0.78875077, 'auroc': 0.96948636, 'binary_precision': 0.71330047, 'binary_recall': 0.50208044, 'binary_specificity': 0.993139, 'binary_f1_score': 0.5893366}
confusion matrix:
       0    1
0  42123  291
1    718  724
---- Validation: 
scalar performance:
{'acc': 0.9754002, 'precision': 0.850603, 'recall': 0.75478005, 'specificity': 0.75478005, 'f1': 0.794432, 'auroc': 0.9696524, 'binary_precision': 0.71900827, 'binary_recall': 0.51708764, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.6015557}
confusion matrix:
       0    1
0  17931  136
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.71290046, 'recall': 0.51278883, 'specificity': 0.51278883, 'f1': 0.51470226, 'auroc': 0.9396792, 'binary_precision': 0.46666667, 'binary_recall': 0.026923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.05090909}
confusion matrix:
      0  1
0  5938  8
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 3,now: 2024-05-31 17:58:08.280152,epoch time: 0:37:56.913335,used: 1:55:17.291448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97754014, 'precision': 0.8655396, 'recall': 0.7358344, 'specificity': 0.7358344, 'f1': 0.78563166, 'auroc': 0.97202957, 'binary_precision': 0.7486398, 'binary_recall': 0.47711512, 'binary_specificity': 0.9945537, 'binary_f1_score': 0.5828039}
confusion matrix:
       0    1
0  42183  231
1    754  688
---- Validation: 
scalar performance:
{'acc': 0.97604054, 'precision': 0.8968867, 'recall': 0.7136267, 'specificity': 0.7136267, 'f1': 0.775668, 'auroc': 0.97220373, 'binary_precision': 0.8146067, 'binary_recall': 0.4309064, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.563654}
confusion matrix:
       0    1
0  18001   66
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9464884, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 4,now: 2024-05-31 18:35:55.848466,epoch time: 0:37:47.568314,used: 2:33:04.859762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98061836, 'precision': 0.9099679, 'recall': 0.75350356, 'specificity': 0.75350356, 'f1': 0.811991, 'auroc': 0.9797069, 'binary_precision': 0.8363636, 'binary_recall': 0.5104022, 'binary_specificity': 0.9966049, 'binary_f1_score': 0.6339362}
confusion matrix:
       0    1
0  42270  144
1    706  736
---- Validation: 
scalar performance:
{'acc': 0.97577375, 'precision': 0.9195199, 'recall': 0.6927455, 'specificity': 0.6927455, 'f1': 0.76119953, 'auroc': 0.9759798, 'binary_precision': 0.8613861, 'binary_recall': 0.38781574, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.53483605}
confusion matrix:
       0    1
0  18025   42
1    412  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.9505948, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9757737517356873, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.9581050872802734 / 0.9618111252784729
after epoch: 5,now: 2024-05-31 19:13:40.294090,epoch time: 0:37:44.445624,used: 3:10:49.305386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98223734, 'precision': 0.87349164, 'recall': 0.8340591, 'specificity': 0.8340591, 'f1': 0.8525859, 'auroc': 0.97999126, 'binary_precision': 0.75797665, 'binary_recall': 0.67545074, 'binary_specificity': 0.9926675, 'binary_f1_score': 0.7143381}
confusion matrix:
       0    1
0  42103  311
1    468  974
---- Validation: 
scalar performance:
{'acc': 0.9800427, 'precision': 0.90082264, 'recall': 0.78365266, 'specificity': 0.78365266, 'f1': 0.83139205, 'auroc': 0.97832906, 'binary_precision': 0.81740975, 'binary_recall': 0.57206535, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.67307687}
confusion matrix:
       0    1
0  17981   86
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9541271, 'recall': 0.5345313, 'specificity': 0.5345313, 'f1': 0.5545021, 'auroc': 0.94889647, 'binary_precision': 0.94736844, 'binary_recall': 0.06923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.12903227}
confusion matrix:
      0   1
0  5945   1
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 6,now: 2024-05-31 19:51:23.925000,epoch time: 0:37:43.630910,used: 3:48:32.936296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9820777, 'precision': 0.9508023, 'recall': 0.7488988, 'specificity': 0.7488988, 'f1': 0.8188529, 'auroc': 0.98178995, 'binary_precision': 0.9183673, 'binary_recall': 0.49930653, 'binary_specificity': 0.99849105, 'binary_f1_score': 0.6469003}
confusion matrix:
       0    1
0  42350   64
1    722  720
---- Validation: 
scalar performance:
{'acc': 0.975667, 'precision': 0.9559738, 'recall': 0.6726627, 'specificity': 0.6726627, 'f1': 0.74647486, 'auroc': 0.97824866, 'binary_precision': 0.935743, 'binary_recall': 0.346211, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.505423}
confusion matrix:
       0    1
0  18051   16
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.9484256, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9756669998168945, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9608443379402161 / 0.9618111252784729
after epoch: 7,now: 2024-05-31 20:29:08.293972,epoch time: 0:37:44.368972,used: 4:26:17.305268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98394746, 'precision': 0.8775699, 'recall': 0.8664288, 'specificity': 0.8664288, 'f1': 0.87190896, 'auroc': 0.9839858, 'binary_precision': 0.7639485, 'binary_recall': 0.740638, 'binary_specificity': 0.99221957, 'binary_f1_score': 0.75211275}
confusion matrix:
       0     1
0  42084   330
1    374  1068
---- Validation: 
scalar performance:
{'acc': 0.9792956, 'precision': 0.87055695, 'recall': 0.80973005, 'specificity': 0.80973005, 'f1': 0.8371804, 'auroc': 0.9779432, 'binary_precision': 0.75491947, 'binary_recall': 0.62704307, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.6850649}
confusion matrix:
       0    1
0  17930  137
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8519697, 'recall': 0.5908782, 'specificity': 0.5908782, 'f1': 0.63821936, 'auroc': 0.9559678, 'binary_precision': 0.73846155, 'binary_recall': 0.18461539, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.29538462}
confusion matrix:
      0   1
0  5929  17
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
early stop counter: 2
val acc:0.9792956113815308, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9608443379402161 / 0.963100254535675
after epoch: 8,now: 2024-05-31 21:07:05.601240,epoch time: 0:37:57.307268,used: 5:04:14.612536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9852016, 'precision': 0.8903657, 'recall': 0.87176645, 'specificity': 0.87176645, 'f1': 0.8808205, 'auroc': 0.9855931, 'binary_precision': 0.78920496, 'binary_recall': 0.7503467, 'binary_specificity': 0.99318624, 'binary_f1_score': 0.7692854}
confusion matrix:
       0     1
0  42125   289
1    360  1082
---- Validation: 
scalar performance:
{'acc': 0.97940236, 'precision': 0.8759744, 'recall': 0.80334806, 'specificity': 0.80334806, 'f1': 0.8354376, 'auroc': 0.9787189, 'binary_precision': 0.76623374, 'binary_recall': 0.6136701, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.6815182}
confusion matrix:
       0    1
0  17941  126
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.87551343, 'recall': 0.570313, 'specificity': 0.570313, 'f1': 0.61089706, 'auroc': 0.9536128, 'binary_precision': 0.78723407, 'binary_recall': 0.1423077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.24104236}
confusion matrix:
      0   1
0  5936  10
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 3
val acc:0.9794023633003235, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9608443379402161 / 0.963100254535675
after epoch: 9,now: 2024-05-31 21:45:23.820548,epoch time: 0:38:18.219308,used: 5:42:32.831844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98711693, 'precision': 0.93872917, 'recall': 0.84663045, 'specificity': 0.84663045, 'f1': 0.8868879, 'auroc': 0.9882417, 'binary_precision': 0.88771, 'binary_recall': 0.6962552, 'binary_specificity': 0.9970057, 'binary_f1_score': 0.78041196}
confusion matrix:
       0     1
0  42287   127
1    438  1004
---- Validation: 
scalar performance:
{'acc': 0.9796158, 'precision': 0.9327482, 'recall': 0.7476679, 'specificity': 0.7476679, 'f1': 0.8131978, 'auroc': 0.9804292, 'binary_precision': 0.883905, 'binary_recall': 0.49777117, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.63688207}
confusion matrix:
       0    1
0  18023   44
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8401816, 'recall': 0.54347396, 'specificity': 0.54347396, 'f1': 0.5686186, 'auroc': 0.9500227, 'binary_precision': 0.71875, 'binary_recall': 0.08846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.15753426}
confusion matrix:
      0   1
0  5937   9
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 4
val acc:0.9796158075332642, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9608443379402161 / 0.963100254535675
after epoch: 10,now: 2024-05-31 22:23:08.946624,epoch time: 0:37:45.126076,used: 6:20:17.957920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872081, 'precision': 0.9319839, 'recall': 0.8553864, 'specificity': 0.8553864, 'f1': 0.8896833, 'auroc': 0.9897945, 'binary_precision': 0.8736217, 'binary_recall': 0.71428573, 'binary_specificity': 0.996487, 'binary_f1_score': 0.78595954}
confusion matrix:
       0     1
0  42265   149
1    412  1030
---- Validation: 
scalar performance:
{'acc': 0.97950906, 'precision': 0.91293573, 'recall': 0.7619179, 'specificity': 0.7619179, 'f1': 0.81922054, 'auroc': 0.9798016, 'binary_precision': 0.8432304, 'binary_recall': 0.5274888, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.6489945}
confusion matrix:
       0    1
0  18001   66
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.94496524, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 5
val acc:0.9795090556144714, best validation acc: 0.9800426959991455, corresponding to test acc:                         0.9608443379402161 / 0.963100254535675
after epoch: 11,now: 2024-05-31 23:00:54.061665,epoch time: 0:37:45.115041,used: 6:58:03.072961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9882114, 'precision': 0.9133596, 'recall': 0.898109, 'specificity': 0.898109, 'f1': 0.90557957, 'auroc': 0.98921317, 'binary_precision': 0.8334535, 'binary_recall': 0.80166435, 'binary_specificity': 0.9945537, 'binary_f1_score': 0.81724995}
confusion matrix:
       0     1
0  42183   231
1    286  1156
---- Validation: 
scalar performance:
{'acc': 0.9828709, 'precision': 0.89553034, 'recall': 0.84377134, 'specificity': 0.84377134, 'f1': 0.8676809, 'auroc': 0.98121476, 'binary_precision': 0.8024055, 'binary_recall': 0.69390786, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.7442231}
confusion matrix:
       0    1
0  17952  115
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.90382123, 'recall': 0.5419713, 'specificity': 0.5419713, 'f1': 0.56694454, 'auroc': 0.94723666, 'binary_precision': 0.84615386, 'binary_recall': 0.08461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5942   4
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 12,now: 2024-05-31 23:38:29.292305,epoch time: 0:37:35.230640,used: 7:35:38.303601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9879378, 'precision': 0.9079696, 'recall': 0.90058035, 'specificity': 0.90058035, 'f1': 0.90423846, 'auroc': 0.98956764, 'binary_precision': 0.8224894, 'binary_recall': 0.8070784, 'binary_specificity': 0.9940823, 'binary_f1_score': 0.814711}
confusion matrix:
       0     1
0  42164   251
1    278  1163
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.88362753, 'recall': 0.8616253, 'specificity': 0.8616253, 'f1': 0.87227213, 'auroc': 0.98084474, 'binary_precision': 0.7772512, 'binary_recall': 0.73105496, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.7534456}
confusion matrix:
       0    1
0  17926  141
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9104014, 'recall': 0.56872624, 'specificity': 0.56872624, 'f1': 0.609709, 'auroc': 0.94184196, 'binary_precision': 0.85714287, 'binary_recall': 0.13846155, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5940   6
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.982817530632019, best validation acc: 0.982870876789093, corresponding to test acc:                         0.961005449295044 / 0.963100254535675
after epoch: 13,now: 2024-06-01 00:16:15.200480,epoch time: 0:37:45.908175,used: 8:13:24.211776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98857623, 'precision': 0.9286648, 'recall': 0.88456464, 'specificity': 0.88456464, 'f1': 0.9053277, 'auroc': 0.99244344, 'binary_precision': 0.86501163, 'binary_recall': 0.7732316, 'binary_specificity': 0.9958976, 'binary_f1_score': 0.81655073}
confusion matrix:
       0     1
0  42240   174
1    327  1115
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.9030155, 'recall': 0.83744466, 'specificity': 0.83744466, 'f1': 0.8670789, 'auroc': 0.98124814, 'binary_precision': 0.81785715, 'binary_recall': 0.6805349, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.7429034}
confusion matrix:
       0    1
0  17965  102
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.94896, 'recall': 0.52876204, 'specificity': 0.52876204, 'f1': 0.5442127, 'auroc': 0.938685, 'binary_precision': 0.9375, 'binary_recall': 0.057692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.108695656}
confusion matrix:
      0   1
0  5945   1
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 14,now: 2024-06-01 00:53:51.595427,epoch time: 0:37:36.394947,used: 8:51:00.606723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98992157, 'precision': 0.94265103, 'recall': 0.892629, 'specificity': 0.892629, 'f1': 0.9160302, 'auroc': 0.9930742, 'binary_precision': 0.8924647, 'binary_recall': 0.7884882, 'binary_specificity': 0.9967699, 'binary_f1_score': 0.8372607}
confusion matrix:
       0     1
0  42277   137
1    305  1137
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.9226152, 'recall': 0.8403653, 'specificity': 0.8403653, 'f1': 0.876693, 'auroc': 0.9826282, 'binary_precision': 0.8568773, 'binary_recall': 0.68499255, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.76135427}
confusion matrix:
       0    1
0  17990   77
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9478843, 'recall': 0.553678, 'specificity': 0.553678, 'f1': 0.5868999, 'auroc': 0.95685995, 'binary_precision': 0.93333334, 'binary_recall': 0.10769231, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.19310346}
confusion matrix:
      0   1
0  5944   2
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 15,now: 2024-06-01 01:31:13.352602,epoch time: 0:37:21.757175,used: 9:28:22.363898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99005836, 'precision': 0.94446224, 'recall': 0.89303476, 'specificity': 0.89303476, 'f1': 0.9170518, 'auroc': 0.9944092, 'binary_precision': 0.89606297, 'binary_recall': 0.7891817, 'binary_specificity': 0.9968878, 'binary_f1_score': 0.839233}
confusion matrix:
       0     1
0  42282   132
1    304  1138
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.9214548, 'recall': 0.81672955, 'specificity': 0.81672955, 'f1': 0.86106545, 'auroc': 0.9826687, 'binary_precision': 0.8562874, 'binary_recall': 0.63744426, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.7308347}
confusion matrix:
       0    1
0  17995   72
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8680254, 'recall': 0.5645437, 'specificity': 0.5645437, 'f1': 0.6020965, 'auroc': 0.945532, 'binary_precision': 0.77272725, 'binary_recall': 0.13076924, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.22368422}
confusion matrix:
      0   1
0  5936  10
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9831376671791077, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9622945785522461 / 0.963100254535675
after epoch: 16,now: 2024-06-01 02:08:49.810896,epoch time: 0:37:36.458294,used: 10:05:58.822192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98996717, 'precision': 0.9128704, 'recall': 0.9338517, 'specificity': 0.9338517, 'f1': 0.92307985, 'auroc': 0.9944587, 'binary_precision': 0.8300395, 'binary_recall': 0.8737864, 'binary_specificity': 0.9939171, 'binary_f1_score': 0.8513513}
confusion matrix:
       0     1
0  42156   258
1    182  1260
---- Validation: 
scalar performance:
{'acc': 0.9855923, 'precision': 0.89895636, 'recall': 0.89095986, 'specificity': 0.89095986, 'f1': 0.89491403, 'auroc': 0.98245174, 'binary_precision': 0.8057663, 'binary_recall': 0.78900445, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.7972973}
confusion matrix:
       0    1
0  17939  128
1    142  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.96638095, 'recall': 0.56145436, 'specificity': 0.56145436, 'f1': 0.599767, 'auroc': 0.9392119, 'binary_precision': 0.969697, 'binary_recall': 0.12307692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5945   1
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 17,now: 2024-06-01 02:46:52.939827,epoch time: 0:38:03.128931,used: 10:44:01.951123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99099326, 'precision': 0.93925095, 'recall': 0.9159599, 'specificity': 0.9159599, 'f1': 0.927264, 'auroc': 0.99471134, 'binary_precision': 0.8840792, 'binary_recall': 0.83564496, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.85918003}
confusion matrix:
       0     1
0  42256   158
1    237  1205
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9130878, 'recall': 0.87096006, 'specificity': 0.87096006, 'f1': 0.8907949, 'auroc': 0.98355263, 'binary_precision': 0.83554816, 'binary_recall': 0.7473997, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.7890196}
confusion matrix:
       0    1
0  17968   99
1    170  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.94394696, 'recall': 0.5479087, 'specificity': 0.5479087, 'f1': 0.5773349, 'auroc': 0.9287488, 'binary_precision': 0.9259259, 'binary_recall': 0.09615385, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.17421603}
confusion matrix:
      0   1
0  5944   2
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 18,now: 2024-06-01 03:24:47.723550,epoch time: 0:37:54.783723,used: 11:21:56.734846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99103886, 'precision': 0.94322, 'recall': 0.91196406, 'specificity': 0.91196406, 'f1': 0.9269776, 'auroc': 0.9952458, 'binary_precision': 0.8922962, 'binary_recall': 0.82732314, 'binary_specificity': 0.9966049, 'binary_f1_score': 0.85858226}
confusion matrix:
       0     1
0  42270   144
1    249  1193
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.91072345, 'recall': 0.863503, 'specificity': 0.863503, 'f1': 0.88554955, 'auroc': 0.98338616, 'binary_precision': 0.83136594, 'binary_recall': 0.73254085, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.77883095}
confusion matrix:
       0    1
0  17967  100
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9123324, 'recall': 0.5362862, 'specificity': 0.5362862, 'f1': 0.5573182, 'auroc': 0.9400038, 'binary_precision': 0.8636364, 'binary_recall': 0.073076926, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.13475178}
confusion matrix:
      0   1
0  5943   3
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9850587248802185, best validation acc: 0.9856456518173218, corresponding to test acc:                         0.9618111252784729 / 0.963100254535675
after epoch: 19,now: 2024-06-01 04:02:40.831653,epoch time: 0:37:53.108103,used: 11:59:49.842949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99117565, 'precision': 0.9380834, 'recall': 0.92074347, 'specificity': 0.92074347, 'f1': 0.92922497, 'auroc': 0.9954833, 'binary_precision': 0.8814172, 'binary_recall': 0.84535366, 'binary_specificity': 0.9961333, 'binary_f1_score': 0.86300886}
confusion matrix:
       0     1
0  42250   164
1    223  1219
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.920713, 'recall': 0.87052155, 'specificity': 0.87052155, 'f1': 0.89389074, 'auroc': 0.9832368, 'binary_precision': 0.8508475, 'binary_recall': 0.7459138, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7949327}
confusion matrix:
       0    1
0  17979   88
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.944417, 'recall': 0.5709016, 'specificity': 0.5709016, 'f1': 0.6140038, 'auroc': 0.9355769, 'binary_precision': 0.925, 'binary_recall': 0.1423077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.24666667}
confusion matrix:
      0   1
0  5943   3
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-01 04:40:26.586605,epoch time: 0:37:45.754952,used: 12:37:35.597901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9903776, 'precision': 0.98110414, 'recall': 0.864059, 'specificity': 0.864059, 'f1': 0.91392565, 'auroc': 0.9959167, 'binary_precision': 0.97134936, 'binary_recall': 0.7288488, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.83280504}
confusion matrix:
       0     1
0  42383    31
1    391  1051
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.9561111, 'recall': 0.7859454, 'specificity': 0.7859454, 'f1': 0.85009813, 'auroc': 0.98262775, 'binary_precision': 0.92788464, 'binary_recall': 0.57355124, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.70890725}
confusion matrix:
       0    1
0  18037   30
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.92138326, 'recall': 0.528678, 'specificity': 0.528678, 'f1': 0.5439744, 'auroc': 0.9410932, 'binary_precision': 0.88235295, 'binary_recall': 0.057692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5944   2
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9830843210220337, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 21,now: 2024-06-01 05:17:55.665480,epoch time: 0:37:29.078875,used: 13:15:04.676776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9916773, 'precision': 0.925112, 'recall': 0.94813395, 'specificity': 0.94813395, 'f1': 0.93629515, 'auroc': 0.9966526, 'binary_precision': 0.85357845, 'binary_recall': 0.9015257, 'binary_specificity': 0.9947423, 'binary_f1_score': 0.87689716}
confusion matrix:
       0     1
0  42191   223
1    142  1300
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.9111, 'recall': 0.88634044, 'specificity': 0.88634044, 'f1': 0.8983022, 'auroc': 0.9843041, 'binary_precision': 0.8304279, 'binary_recall': 0.77860326, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.8036809}
confusion matrix:
       0    1
0  17960  107
1    149  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8922125, 'recall': 0.57808936, 'specificity': 0.57808936, 'f1': 0.62283814, 'auroc': 0.9470974, 'binary_precision': 0.82, 'binary_recall': 0.15769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.26451614}
confusion matrix:
      0   1
0  5937   9
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 22,now: 2024-06-01 05:55:24.593572,epoch time: 0:37:28.928092,used: 13:52:33.604868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9923842, 'precision': 0.96681285, 'recall': 0.90964496, 'specificity': 0.90964496, 'f1': 0.93622947, 'auroc': 0.9967041, 'binary_precision': 0.93968254, 'binary_recall': 0.8210818, 'binary_specificity': 0.99820817, 'binary_f1_score': 0.87638783}
confusion matrix:
       0     1
0  42338    76
1    258  1184
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.94593394, 'recall': 0.861089, 'specificity': 0.861089, 'f1': 0.8986956, 'auroc': 0.9825107, 'binary_precision': 0.90203327, 'binary_recall': 0.7251114, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.8039538}
confusion matrix:
       0    1
0  18014   53
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.9278196, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 23,now: 2024-06-01 06:33:15.255809,epoch time: 0:37:50.662237,used: 14:30:24.267105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9913353, 'precision': 0.9583893, 'recall': 0.90039396, 'specificity': 0.90039396, 'f1': 0.9272903, 'auroc': 0.9956144, 'binary_precision': 0.923445, 'binary_recall': 0.8030513, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.85905045}
confusion matrix:
       0     1
0  42318    96
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.93277186, 'recall': 0.8340663, 'specificity': 0.8340663, 'f1': 0.87655866, 'auroc': 0.98122257, 'binary_precision': 0.87766993, 'binary_recall': 0.6716196, 'binary_specificity': 0.996513, 'binary_f1_score': 0.76094276}
confusion matrix:
       0    1
0  18004   63
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.96638095, 'recall': 0.56145436, 'specificity': 0.56145436, 'f1': 0.599767, 'auroc': 0.93773186, 'binary_precision': 0.969697, 'binary_recall': 0.12307692, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5945   1
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9848452210426331, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9626168012619019 / 0.9635836482048035
after epoch: 24,now: 2024-06-01 07:11:17.576293,epoch time: 0:38:02.320484,used: 15:08:26.587589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.992977, 'precision': 0.95297146, 'recall': 0.9347379, 'specificity': 0.9347379, 'f1': 0.9436532, 'auroc': 0.99655247, 'binary_precision': 0.910275, 'binary_recall': 0.87239945, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.8909349}
confusion matrix:
       0     1
0  42290   124
1    184  1258
---- Validation: 
scalar performance:
{'acc': 0.9878335, 'precision': 0.9396399, 'recall': 0.8763863, 'specificity': 0.8763863, 'f1': 0.90536106, 'auroc': 0.98355985, 'binary_precision': 0.88830715, 'binary_recall': 0.756315, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.81701446}
confusion matrix:
       0    1
0  18003   64
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.91692543, 'recall': 0.5764185, 'specificity': 0.5764185, 'f1': 0.62138474, 'auroc': 0.9265728, 'binary_precision': 0.8695652, 'binary_recall': 0.15384616, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.2614379}
confusion matrix:
      0   1
0  5940   6
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 25,now: 2024-06-01 07:49:22.846411,epoch time: 0:38:05.270118,used: 15:46:31.857707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99185973, 'precision': 0.9507487, 'recall': 0.9177476, 'specificity': 0.9177476, 'f1': 0.9335741, 'auroc': 0.9974495, 'binary_precision': 0.90697676, 'binary_recall': 0.83841884, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.8713513}
confusion matrix:
       0     1
0  42290   124
1    233  1209
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.93379736, 'recall': 0.86510384, 'specificity': 0.86510384, 'f1': 0.89625514, 'auroc': 0.98318356, 'binary_precision': 0.8774423, 'binary_recall': 0.73402673, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.79935277}
confusion matrix:
       0    1
0  17998   69
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9304397, 'recall': 0.5344472, 'specificity': 0.5344472, 'f1': 0.5542297, 'auroc': 0.91524196, 'binary_precision': 0.9, 'binary_recall': 0.06923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5944   2
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9867662787437439, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 26,now: 2024-06-01 08:27:07.980449,epoch time: 0:37:45.134038,used: 16:24:16.991745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9915405, 'precision': 0.9540223, 'recall': 0.90853894, 'specificity': 0.90853894, 'f1': 0.92999256, 'auroc': 0.99629056, 'binary_precision': 0.91415316, 'binary_recall': 0.8196949, 'binary_specificity': 0.99738294, 'binary_f1_score': 0.864351}
confusion matrix:
       0     1
0  42303   111
1    260  1182
---- Validation: 
scalar performance:
{'acc': 0.9871398, 'precision': 0.9470291, 'recall': 0.8574296, 'specificity': 0.8574296, 'f1': 0.8968437, 'auroc': 0.9810418, 'binary_precision': 0.9044944, 'binary_recall': 0.717682, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.80033135}
confusion matrix:
       0    1
0  18016   51
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.92128956, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9871398210525513, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 27,now: 2024-06-01 09:04:26.650620,epoch time: 0:37:18.670171,used: 17:01:35.661916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.992749, 'precision': 0.9771615, 'recall': 0.9058142, 'specificity': 0.9058142, 'f1': 0.938401, 'auroc': 0.9981358, 'binary_precision': 0.96065575, 'binary_recall': 0.81276006, 'binary_specificity': 0.9988683, 'binary_f1_score': 0.88054097}
confusion matrix:
       0     1
0  42366    48
1    270  1172
---- Validation: 
scalar performance:
{'acc': 0.9859125, 'precision': 0.9473309, 'recall': 0.83748084, 'specificity': 0.83748084, 'f1': 0.88411915, 'auroc': 0.9808593, 'binary_precision': 0.90656066, 'binary_recall': 0.67756313, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.7755102}
confusion matrix:
       0    1
0  18020   47
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9304397, 'recall': 0.5344472, 'specificity': 0.5344472, 'f1': 0.5542297, 'auroc': 0.9143834, 'binary_precision': 0.9, 'binary_recall': 0.06923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5944   2
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 3
val acc:0.9859125018119812, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 28,now: 2024-06-01 09:41:52.570032,epoch time: 0:37:25.919412,used: 17:39:01.581328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9928174, 'precision': 0.9719028, 'recall': 0.9118787, 'specificity': 0.9118787, 'f1': 0.93970585, 'auroc': 0.9979474, 'binary_precision': 0.9497207, 'binary_recall': 0.8252427, 'binary_specificity': 0.99851465, 'binary_f1_score': 0.8831169}
confusion matrix:
       0     1
0  42351    63
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.94491446, 'recall': 0.8337108, 'specificity': 0.8337108, 'f1': 0.88075215, 'auroc': 0.9798315, 'binary_precision': 0.902, 'binary_recall': 0.6701337, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.7689684}
confusion matrix:
       0    1
0  18018   49
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.9253475, 'recall': 0.5459016, 'specificity': 0.5459016, 'f1': 0.573768, 'auroc': 0.9229847, 'binary_precision': 0.8888889, 'binary_recall': 0.092307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16724738}
confusion matrix:
      0   1
0  5943   3
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 4
val acc:0.9855389595031738, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.9635836482048035 / 0.9635836482048035
after epoch: 29,now: 2024-06-01 10:19:37.785010,epoch time: 0:37:45.214978,used: 18:16:46.796306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99356985, 'precision': 0.96292216, 'recall': 0.9337046, 'specificity': 0.9337046, 'f1': 0.947802, 'auroc': 0.99825466, 'binary_precision': 0.93026704, 'binary_recall': 0.8696255, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.8989247}
confusion matrix:
       0     1
0  42320    94
1    188  1254
---- Validation: 
scalar performance:
{'acc': 0.9883138, 'precision': 0.9413945, 'recall': 0.88235754, 'specificity': 0.88235754, 'f1': 0.90958714, 'auroc': 0.98338103, 'binary_precision': 0.8913793, 'binary_recall': 0.76820207, 'binary_specificity': 0.996513, 'binary_f1_score': 0.82521945}
confusion matrix:
       0    1
0  18004   63
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8727505, 'recall': 0.52090156, 'specificity': 0.52090156, 'f1': 0.52976537, 'auroc': 0.93698835, 'binary_precision': 0.78571427, 'binary_recall': 0.042307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.08029198}
confusion matrix:
      0   1
0  5943   3
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 30,now: 2024-06-01 10:57:30.310784,epoch time: 0:37:52.525774,used: 18:54:39.322080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_16_02_50_seed_1_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:54:39.322080 at 2024-06-01 10:57:30.310784
persisted model performance metric: 

scalar performance:
{'acc': 0.9597164, 'precision': 0.8862985, 'recall': 0.5247477, 'specificity': 0.5247477, 'f1': 0.5368015, 'auroc': 0.93941194, 'binary_precision': 0.8125, 'binary_recall': 0.05, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.094202906}
confusion matrix:
      0   1
0  5943   3
1   247  13
oracle model performance metric: 

scalar performance:
{'acc': 0.9621334, 'precision': 0.9206834, 'recall': 0.55543286, 'specificity': 0.55543286, 'f1': 0.5892806, 'auroc': 0.93630886, 'binary_precision': 0.8787879, 'binary_recall': 0.11153846, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5942   4
1   231  29
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |  19946 KiB |     24 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304805 K  |  304802 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179884 K  |  179881 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304805 K  |  304802 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179884 K  |  179881 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |    2872    |  179940 K  |  179940 K  |
|       from large pool |     107    |     516    |   93732 K  |   93732 K  |
|       from small pool |      35    |    2763    |   86208 K  |   86208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |  179941 K  |  179941 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2763    |   86209 K  |   86209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |  179941 K  |  179941 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2763    |   86209 K  |   86209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758

 Experiment start at: 2024-06-01 11:07:18.928138
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96784866, 'precision': 0.7594259, 'recall': 0.7446791, 'specificity': 0.7446791, 'f1': 0.75181293, 'auroc': 0.944332, 'binary_precision': 0.53651685, 'binary_recall': 0.504957, 'binary_specificity': 0.9844012, 'binary_f1_score': 0.5202588}
confusion matrix:
       0    1
0  41651  660
1    749  764
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7503436, 'recall': 0.73664653, 'specificity': 0.73664653, 'f1': 0.7432823, 'auroc': 0.9412218, 'binary_precision': 0.51760566, 'binary_recall': 0.4883721, 'binary_specificity': 0.98492104, 'binary_f1_score': 0.50256413}
confusion matrix:
       0    1
0  17897  274
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.8763343, 'recall': 0.6919638, 'specificity': 0.6919638, 'f1': 0.75173074, 'auroc': 0.92629826, 'binary_precision': 0.7768595, 'binary_recall': 0.38842976, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.51790637}
confusion matrix:
      0   1
0  5970  27
1   148  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 11:46:29.439849,epoch time: 0:39:10.511711,used: 0:39:10.511711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97275466, 'precision': 0.80483925, 'recall': 0.75518614, 'specificity': 0.75518614, 'f1': 0.77759826, 'auroc': 0.95961666, 'binary_precision': 0.6266878, 'binary_recall': 0.5214805, 'binary_specificity': 0.9888918, 'binary_f1_score': 0.56926405}
confusion matrix:
       0    1
0  41841  470
1    724  789
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.78678274, 'recall': 0.73533297, 'specificity': 0.73533297, 'f1': 0.7582883, 'auroc': 0.95442516, 'binary_precision': 0.59063137, 'binary_recall': 0.48172757, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.5306496}
confusion matrix:
       0    1
0  17970  201
1    312  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8649476, 'recall': 0.553052, 'specificity': 0.553052, 'f1': 0.58502406, 'auroc': 0.9336989, 'binary_precision': 0.7647059, 'binary_recall': 0.10743801, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1884058}
confusion matrix:
      0   1
0  5989   8
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 2,now: 2024-06-01 12:23:52.352903,epoch time: 0:37:22.913054,used: 1:16:33.424765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9771586, 'precision': 0.85808957, 'recall': 0.76288396, 'specificity': 0.76288396, 'f1': 0.8025719, 'auroc': 0.965466, 'binary_precision': 0.7327273, 'binary_recall': 0.53271645, 'binary_specificity': 0.99305147, 'binary_f1_score': 0.6169154}
confusion matrix:
       0    1
0  42017  294
1    707  806
---- Validation: 
scalar performance:
{'acc': 0.97645557, 'precision': 0.87072814, 'recall': 0.6915129, 'specificity': 0.6915129, 'f1': 0.7505759, 'auroc': 0.9588436, 'binary_precision': 0.7614379, 'binary_recall': 0.38704318, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.51321584}
confusion matrix:
       0    1
0  18098   73
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.83850837, 'recall': 0.5203277, 'specificity': 0.5203277, 'f1': 0.52940774, 'auroc': 0.93078804, 'binary_precision': 0.71428573, 'binary_recall': 0.041322313, 'binary_specificity': 0.999333, 'binary_f1_score': 0.078125}
confusion matrix:
      0   1
0  5993   4
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 3,now: 2024-06-01 13:01:43.978967,epoch time: 0:37:51.626064,used: 1:54:25.050829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.979623, 'precision': 0.87459254, 'recall': 0.7934762, 'specificity': 0.7934762, 'f1': 0.8286977, 'auroc': 0.9749068, 'binary_precision': 0.7636054, 'binary_recall': 0.5935228, 'binary_specificity': 0.9934296, 'binary_f1_score': 0.6679063}
confusion matrix:
       0    1
0  42033  278
1    615  898
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.8727684, 'recall': 0.7712247, 'specificity': 0.7712247, 'f1': 0.8133835, 'auroc': 0.9713024, 'binary_precision': 0.76036865, 'binary_recall': 0.5481728, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.6370656}
confusion matrix:
       0    1
0  18067  104
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.75035834, 'recall': 0.51396257, 'specificity': 0.51396257, 'f1': 0.51759255, 'auroc': 0.94481367, 'binary_precision': 0.53846157, 'binary_recall': 0.02892562, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.05490196}
confusion matrix:
      0  1
0  5991  6
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 4,now: 2024-06-01 13:39:30.564827,epoch time: 0:37:46.585860,used: 2:32:11.636689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98126596, 'precision': 0.9040008, 'recall': 0.7892286, 'specificity': 0.7892286, 'f1': 0.8363734, 'auroc': 0.97888744, 'binary_precision': 0.8227612, 'binary_recall': 0.5829478, 'binary_specificity': 0.99550945, 'binary_f1_score': 0.68239844}
confusion matrix:
       0    1
0  42121  190
1    631  882
---- Validation: 
scalar performance:
{'acc': 0.97826666, 'precision': 0.87103736, 'recall': 0.7334039, 'specificity': 0.7334039, 'f1': 0.7854053, 'auroc': 0.97148895, 'binary_precision': 0.7593583, 'binary_recall': 0.4717608, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.5819672}
confusion matrix:
       0    1
0  18081   90
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7475003, 'recall': 0.5338733, 'specificity': 0.5338733, 'f1': 0.5522109, 'auroc': 0.9358555, 'binary_precision': 0.53125, 'binary_recall': 0.07024793, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.12408758}
confusion matrix:
      0   1
0  5982  15
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9782666563987732, best validation acc: 0.9799712300300598, corresponding to test acc:                         0.9613720178604126 / 0.9719506502151489
after epoch: 5,now: 2024-06-01 14:17:06.244809,epoch time: 0:37:35.679982,used: 3:09:47.316671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98172235, 'precision': 0.906431, 'recall': 0.7952007, 'specificity': 0.7952007, 'f1': 0.84131163, 'auroc': 0.97948736, 'binary_precision': 0.8272059, 'binary_recall': 0.5948447, 'binary_specificity': 0.9955567, 'binary_f1_score': 0.6920416}
confusion matrix:
       0    1
0  42123  188
1    613  900
---- Validation: 
scalar performance:
{'acc': 0.97927874, 'precision': 0.8843646, 'recall': 0.7411542, 'specificity': 0.7411542, 'f1': 0.7951944, 'auroc': 0.9711534, 'binary_precision': 0.78552276, 'binary_recall': 0.48671097, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.60102564}
confusion matrix:
       0    1
0  18091   80
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8103225, 'recall': 0.5424713, 'specificity': 0.5424713, 'f1': 0.56713724, 'auroc': 0.9394177, 'binary_precision': 0.65625, 'binary_recall': 0.08677686, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.15328467}
confusion matrix:
      0   1
0  5986  11
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9792787432670593, best validation acc: 0.9799712300300598, corresponding to test acc:                         0.9613720178604126 / 0.9719506502151489
after epoch: 6,now: 2024-06-01 14:54:29.221359,epoch time: 0:37:22.976550,used: 3:47:10.293221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98366195, 'precision': 0.92095125, 'recall': 0.8153243, 'specificity': 0.8153243, 'f1': 0.859977, 'auroc': 0.98313797, 'binary_precision': 0.8548531, 'binary_recall': 0.634501, 'binary_specificity': 0.9961476, 'binary_f1_score': 0.7283763}
confusion matrix:
       0    1
0  42148  163
1    553  960
---- Validation: 
scalar performance:
{'acc': 0.9819954, 'precision': 0.9134519, 'recall': 0.76825505, 'specificity': 0.76825505, 'f1': 0.82432455, 'auroc': 0.9732239, 'binary_precision': 0.8419689, 'binary_recall': 0.5398671, 'binary_specificity': 0.996643, 'binary_f1_score': 0.65789473}
confusion matrix:
       0    1
0  18110   61
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.91864264, 'recall': 0.51437944, 'specificity': 0.51437944, 'f1': 0.51835, 'auroc': 0.9355399, 'binary_precision': 0.875, 'binary_recall': 0.02892562, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.055999998}
confusion matrix:
      0  1
0  5996  1
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 7,now: 2024-06-01 15:32:08.017330,epoch time: 0:37:38.795971,used: 4:24:49.089192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98525923, 'precision': 0.9045597, 'recall': 0.8652239, 'specificity': 0.8652239, 'f1': 0.88380295, 'auroc': 0.9856491, 'binary_precision': 0.8185158, 'binary_recall': 0.7362855, 'binary_specificity': 0.99416226, 'binary_f1_score': 0.7752262}
confusion matrix:
       0     1
0  42064   247
1    399  1114
---- Validation: 
scalar performance:
{'acc': 0.98311406, 'precision': 0.89639676, 'recall': 0.80978835, 'specificity': 0.80978835, 'f1': 0.8473854, 'auroc': 0.9738182, 'binary_precision': 0.8051392, 'binary_recall': 0.62458473, 'binary_specificity': 0.994992, 'binary_f1_score': 0.70346117}
confusion matrix:
       0    1
0  18080   91
1    226  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.8627794, 'recall': 0.532641, 'specificity': 0.532641, 'f1': 0.55138093, 'auroc': 0.94287765, 'binary_precision': 0.7619048, 'binary_recall': 0.0661157, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.121673}
confusion matrix:
      0   1
0  5992   5
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 8,now: 2024-06-01 16:09:49.817857,epoch time: 0:37:41.800527,used: 5:02:30.889719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9860122, 'precision': 0.89938605, 'recall': 0.88791955, 'specificity': 0.88791955, 'f1': 0.8935621, 'auroc': 0.9868773, 'binary_precision': 0.80653954, 'binary_recall': 0.7825512, 'binary_specificity': 0.9932878, 'binary_f1_score': 0.79436433}
confusion matrix:
       0     1
0  42027   284
1    329  1184
---- Validation: 
scalar performance:
{'acc': 0.98359346, 'precision': 0.88600457, 'recall': 0.83493054, 'specificity': 0.83493054, 'f1': 0.85851717, 'auroc': 0.9768766, 'binary_precision': 0.7826923, 'binary_recall': 0.67607975, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.7254902}
confusion matrix:
       0    1
0  18058  113
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.88557875, 'recall': 0.56751484, 'specificity': 0.56751484, 'f1': 0.6077107, 'auroc': 0.9405248, 'binary_precision': 0.80487806, 'binary_recall': 0.13636364, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23321557}
confusion matrix:
      0   1
0  5989   8
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 9,now: 2024-06-01 16:47:07.954193,epoch time: 0:37:18.136336,used: 5:39:49.026055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9870391, 'precision': 0.9084661, 'recall': 0.8938684, 'specificity': 0.8938684, 'f1': 0.9010232, 'auroc': 0.98825365, 'binary_precision': 0.8242965, 'binary_recall': 0.7937872, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.80875415}
confusion matrix:
       0     1
0  42055   256
1    312  1201
---- Validation: 
scalar performance:
{'acc': 0.98359346, 'precision': 0.8705733, 'recall': 0.8622341, 'specificity': 0.8622341, 'f1': 0.8663523, 'auroc': 0.97912216, 'binary_precision': 0.75, 'binary_recall': 0.73255813, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.7411764}
confusion matrix:
       0    1
0  18024  147
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8511658, 'recall': 0.5570175, 'specificity': 0.5570175, 'f1': 0.59081817, 'auroc': 0.9439823, 'binary_precision': 0.7368421, 'binary_recall': 0.11570248, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.20000002}
confusion matrix:
      0   1
0  5987  10
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9835934638977051, best validation acc: 0.9835934638977051, corresponding to test acc:                         0.9652187824249268 / 0.9719506502151489
after epoch: 10,now: 2024-06-01 17:24:38.884860,epoch time: 0:37:30.930667,used: 6:17:19.956722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873585, 'precision': 0.93626714, 'recall': 0.86408055, 'specificity': 0.86408055, 'f1': 0.89666426, 'auroc': 0.9885902, 'binary_precision': 0.88207173, 'binary_recall': 0.73165894, 'binary_specificity': 0.9965021, 'binary_f1_score': 0.7998555}
confusion matrix:
       0     1
0  42163   148
1    406  1107
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.91828, 'recall': 0.81869936, 'specificity': 0.81869936, 'f1': 0.8612792, 'auroc': 0.97959816, 'binary_precision': 0.84835166, 'binary_recall': 0.641196, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.7303689}
confusion matrix:
       0    1
0  18102   69
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.86130476, 'recall': 0.5509859, 'specificity': 0.5509859, 'f1': 0.58169, 'auroc': 0.94453615, 'binary_precision': 0.75757575, 'binary_recall': 0.10330579, 'binary_specificity': 0.998666, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5989   8
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 11,now: 2024-06-01 18:02:16.493309,epoch time: 0:37:37.608449,used: 6:54:57.565171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.987678, 'precision': 0.9282469, 'recall': 0.878904, 'specificity': 0.878904, 'f1': 0.90194607, 'auroc': 0.9898248, 'binary_precision': 0.8649662, 'binary_recall': 0.76206213, 'binary_specificity': 0.9957458, 'binary_f1_score': 0.81026}
confusion matrix:
       0     1
0  42131   180
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.90618867, 'recall': 0.83727956, 'specificity': 0.83727956, 'f1': 0.86830163, 'auroc': 0.978845, 'binary_precision': 0.8229376, 'binary_recall': 0.679402, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.744313}
confusion matrix:
       0    1
0  18083   88
1    193  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8857484, 'recall': 0.55115265, 'specificity': 0.55115265, 'f1': 0.5824395, 'auroc': 0.9443783, 'binary_precision': 0.8064516, 'binary_recall': 0.10330579, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.18315019}
confusion matrix:
      0   1
0  5991   6
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 12,now: 2024-06-01 18:40:00.415300,epoch time: 0:37:43.921991,used: 7:32:41.487162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98824847, 'precision': 0.9209491, 'recall': 0.8986372, 'specificity': 0.8986372, 'f1': 0.90946424, 'auroc': 0.9907422, 'binary_precision': 0.84895104, 'binary_recall': 0.80237937, 'binary_specificity': 0.9948949, 'binary_f1_score': 0.82500845}
confusion matrix:
       0     1
0  42095   216
1    299  1214
---- Validation: 
scalar performance:
{'acc': 0.98444575, 'precision': 0.9038873, 'recall': 0.82814336, 'specificity': 0.82814336, 'f1': 0.8618042, 'auroc': 0.97734493, 'binary_precision': 0.81893003, 'binary_recall': 0.6611296, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.7316176}
confusion matrix:
       0    1
0  18083   88
1    204  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.84743834, 'recall': 0.53867257, 'specificity': 0.53867257, 'f1': 0.56147707, 'auroc': 0.93952596, 'binary_precision': 0.7307692, 'binary_recall': 0.0785124, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14179105}
confusion matrix:
      0   1
0  5990   7
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 1
val acc:0.9844457507133484, best validation acc: 0.9850317239761353, corresponding to test acc:                         0.9642571210861206 / 0.9719506502151489
after epoch: 13,now: 2024-06-01 19:17:19.849153,epoch time: 0:37:19.433853,used: 8:10:00.921015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9885223, 'precision': 0.92973363, 'recall': 0.8920873, 'specificity': 0.8920873, 'f1': 0.90997845, 'auroc': 0.9909365, 'binary_precision': 0.8670058, 'binary_recall': 0.78849965, 'binary_specificity': 0.9956749, 'binary_f1_score': 0.8258914}
confusion matrix:
       0     1
0  42128   183
1    320  1193
---- Validation: 
scalar performance:
{'acc': 0.98375326, 'precision': 0.8904264, 'recall': 0.8318009, 'specificity': 0.8318009, 'f1': 0.85855067, 'auroc': 0.9786681, 'binary_precision': 0.7917485, 'binary_recall': 0.6694352, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.7254725}
confusion matrix:
       0    1
0  18065  106
1    199  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8556253, 'recall': 0.57131356, 'specificity': 0.57131356, 'f1': 0.6121237, 'auroc': 0.93759966, 'binary_precision': 0.7446808, 'binary_recall': 0.1446281, 'binary_specificity': 0.997999, 'binary_f1_score': 0.24221452}
confusion matrix:
      0   1
0  5985  12
1   207  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
early stop counter: 2
val acc:0.9837532639503479, best validation acc: 0.9850317239761353, corresponding to test acc:                         0.9642571210861206 / 0.9719506502151489
after epoch: 14,now: 2024-06-01 19:54:49.621735,epoch time: 0:37:29.772582,used: 8:47:30.693597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9892981, 'precision': 0.9261545, 'recall': 0.9106523, 'specificity': 0.9106523, 'f1': 0.91824794, 'auroc': 0.9932008, 'binary_precision': 0.85851645, 'binary_recall': 0.8261732, 'binary_specificity': 0.9951313, 'binary_f1_score': 0.8420344}
confusion matrix:
       0     1
0  42105   206
1    263  1250
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.8986622, 'recall': 0.85430866, 'specificity': 0.85430866, 'f1': 0.8750783, 'auroc': 0.9802564, 'binary_precision': 0.80675423, 'binary_recall': 0.71428573, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.75770926}
confusion matrix:
       0    1
0  18068  103
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.88885033, 'recall': 0.5532187, 'specificity': 0.5532187, 'f1': 0.58579516, 'auroc': 0.9429656, 'binary_precision': 0.8125, 'binary_recall': 0.10743801, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.18978101}
confusion matrix:
      0   1
0  5991   6
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993758.png
better model found
persisted
after epoch: 15,now: 2024-06-01 20:32:27.933565,epoch time: 0:37:38.311830,used: 9:25:09.005427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_11_07_18_seed_2_20993758
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 20993758 ON gpusrv27 CANCELLED AT 2024-06-01T20:38:20 DUE TO TIME LIMIT ***
