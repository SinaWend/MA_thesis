Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 19 22:57:33 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109

 Experiment start at: 2024-06-19 23:10:44.364583
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.5405098, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.32255006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2653811, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 23:29:12.353336,epoch time: 0:18:27.988753,used: 0:18:27.988753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.74754643, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3453226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3499459, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-19 23:46:21.834633,epoch time: 0:17:09.481297,used: 0:35:37.470050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9080265, 'precision': 0.94142705, 'recall': 0.5132268, 'specificity': 0.5132268, 'f1': 0.50165695, 'auroc': 0.8729433, 'binary_precision': 0.975, 'binary_recall': 0.026524598, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.051644232}
confusion matrix:
       0    1
0  42306    3
1   4294  117
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41395357, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5205381, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-20 00:05:04.838142,epoch time: 0:18:43.003509,used: 0:54:20.473559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9217894, 'precision': 0.9421872, 'recall': 0.58894736, 'specificity': 0.58894736, 'f1': 0.6299573, 'auroc': 0.9005432, 'binary_precision': 0.9633252, 'binary_recall': 0.17860381, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.30133843}
confusion matrix:
       0    1
0  42278   30
1   3624  788
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.4828862, 'recall': 0.49983472, 'specificity': 0.49983472, 'f1': 0.4912143, 'auroc': 0.4866029, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18143  6
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.6781763, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_4.png
early stop counter: 3
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-20 00:22:20.171018,epoch time: 0:17:15.332876,used: 1:11:35.806435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93760705, 'precision': 0.9486738, 'recall': 0.6760011, 'specificity': 0.6760011, 'f1': 0.7417372, 'auroc': 0.924752, 'binary_precision': 0.9605669, 'binary_recall': 0.35351473, 'binary_specificity': 0.99848735, 'binary_f1_score': 0.5168241}
confusion matrix:
       0     1
0  42246    64
1   2851  1559
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.48287344, 'recall': 0.499449, 'specificity': 0.499449, 'f1': 0.49102136, 'auroc': 0.51744187, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998898, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18129  20
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74090165, 'recall': 0.52207136, 'specificity': 0.52207136, 'f1': 0.5316256, 'auroc': 0.6973182, 'binary_precision': 0.5217391, 'binary_recall': 0.04597701, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.08450704}
confusion matrix:
      0   1
0  5986  11
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_5.png
new oracle model saved
early stop counter: 4
val acc:0.9647190570831299, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 5,now: 2024-06-20 00:41:03.198473,epoch time: 0:18:43.027455,used: 1:30:18.833890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9468536, 'precision': 0.9466121, 'recall': 0.73044413, 'specificity': 0.73044413, 'f1': 0.79688644, 'auroc': 0.93006426, 'binary_precision': 0.946346, 'binary_recall': 0.46363017, 'binary_specificity': 0.9972581, 'binary_f1_score': 0.6223574}
confusion matrix:
       0     1
0  42191   116
1   2367  2046
---- Validation: 
scalar performance:
{'acc': 0.9638676, 'precision': 0.50790846, 'recall': 0.5005083, 'specificity': 0.5005083, 'f1': 0.49372795, 'auroc': 0.5438903, 'binary_precision': 0.05, 'binary_recall': 0.00311042, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.0058565154}
confusion matrix:
       0   1
0  18111  38
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78559375, 'recall': 0.5521391, 'specificity': 0.5521391, 'f1': 0.58092594, 'auroc': 0.72220516, 'binary_precision': 0.6086956, 'binary_recall': 0.107279696, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.18241042}
confusion matrix:
      0   1
0  5979  18
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_6.png
new oracle model saved
early stop counter: 5
val acc:0.9638676047325134, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9598913192749023
after epoch: 6,now: 2024-06-20 00:57:05.149158,epoch time: 0:16:01.950685,used: 1:46:20.784575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9535959, 'precision': 0.9401406, 'recall': 0.7743547, 'specificity': 0.7743547, 'f1': 0.8336934, 'auroc': 0.942557, 'binary_precision': 0.9249716, 'binary_recall': 0.55338925, 'binary_specificity': 0.99532014, 'binary_f1_score': 0.69248223}
confusion matrix:
       0     1
0  42111   198
1   1970  2441
---- Validation: 
scalar performance:
{'acc': 0.9620051, 'precision': 0.5138154, 'recall': 0.5017942, 'specificity': 0.5017942, 'f1': 0.4972208, 'auroc': 0.58265454, 'binary_precision': 0.061728396, 'binary_recall': 0.00777605, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.0138121545}
confusion matrix:
       0   1
0  18073  76
1    638   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7941382, 'recall': 0.6100253, 'specificity': 0.6100253, 'f1': 0.6559441, 'auroc': 0.75607276, 'binary_precision': 0.6210526, 'binary_recall': 0.22605364, 'binary_specificity': 0.993997, 'binary_f1_score': 0.33146065}
confusion matrix:
      0   1
0  5961  36
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_7.png
new oracle model saved
early stop counter: 6
val acc:0.962005078792572, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9619686603546143
after epoch: 7,now: 2024-06-20 01:15:55.005375,epoch time: 0:18:49.856217,used: 2:05:10.640792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9578553, 'precision': 0.9424691, 'recall': 0.79887444, 'specificity': 0.79887444, 'f1': 0.8535427, 'auroc': 0.94414127, 'binary_precision': 0.9249218, 'binary_recall': 0.60285455, 'binary_specificity': 0.9948943, 'binary_f1_score': 0.72994107}
confusion matrix:
       0     1
0  42090   216
1   1753  2661
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.5269146, 'recall': 0.5049109, 'specificity': 0.5049109, 'f1': 0.5032038, 'auroc': 0.6041971, 'binary_precision': 0.0877193, 'binary_recall': 0.0155521, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.02642008}
confusion matrix:
       0    1
0  18045  104
1    633   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7865025, 'recall': 0.64142513, 'specificity': 0.64142513, 'f1': 0.68669486, 'auroc': 0.77304554, 'binary_precision': 0.6031746, 'binary_recall': 0.29118773, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.39276487}
confusion matrix:
      0   1
0  5947  50
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_8.png
new oracle model saved
early stop counter: 7
val acc:0.9607811570167542, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9624480605125427
after epoch: 8,now: 2024-06-20 01:31:03.150067,epoch time: 0:15:08.144692,used: 2:20:18.785484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95862585, 'precision': 0.94493484, 'recall': 0.8016019, 'specificity': 0.8016019, 'f1': 0.8563286, 'auroc': 0.94806796, 'binary_precision': 0.92931396, 'binary_recall': 0.6080254, 'binary_specificity': 0.99517834, 'binary_f1_score': 0.73509663}
confusion matrix:
       0     1
0  42105   204
1   1729  2682
---- Validation: 
scalar performance:
{'acc': 0.96099406, 'precision': 0.5602314, 'recall': 0.5125216, 'specificity': 0.5125216, 'f1': 0.51591694, 'auroc': 0.6229882, 'binary_precision': 0.15384616, 'binary_recall': 0.0311042, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.051746447}
confusion matrix:
       0    1
0  18039  110
1    623   20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8042182, 'recall': 0.65133715, 'specificity': 0.65133715, 'f1': 0.6994456, 'auroc': 0.78948545, 'binary_precision': 0.63779527, 'binary_recall': 0.31034482, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.41752577}
confusion matrix:
      0   1
0  5951  46
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_9.png
new oracle model saved
early stop counter: 8
val acc:0.9609940648078918, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 9,now: 2024-06-20 01:47:25.235428,epoch time: 0:16:22.085361,used: 2:36:40.870845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96113014, 'precision': 0.9399729, 'recall': 0.8210756, 'specificity': 0.8210756, 'f1': 0.86900514, 'auroc': 0.9564478, 'binary_precision': 0.915547, 'binary_recall': 0.6483915, 'binary_specificity': 0.99375975, 'binary_f1_score': 0.75915116}
confusion matrix:
       0     1
0  42042   264
1   1552  2862
---- Validation: 
scalar performance:
{'acc': 0.95950407, 'precision': 0.58167297, 'recall': 0.5252512, 'specificity': 0.5252512, 'f1': 0.5350457, 'auroc': 0.6562994, 'binary_precision': 0.19587629, 'binary_recall': 0.05909798, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.09080047}
confusion matrix:
       0    1
0  17993  156
1    605   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7827628, 'recall': 0.6784053, 'specificity': 0.6784053, 'f1': 0.71739936, 'auroc': 0.8123104, 'binary_precision': 0.5925926, 'binary_recall': 0.3678161, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.45390072}
confusion matrix:
      0   1
0  5931  66
1   165  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_10.png
early stop counter: 9
val acc:0.9595040678977966, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 10,now: 2024-06-20 02:02:54.687515,epoch time: 0:15:29.452087,used: 2:52:10.322932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96185786, 'precision': 0.9313007, 'recall': 0.8333479, 'specificity': 0.8333479, 'f1': 0.874487, 'auroc': 0.9575961, 'binary_precision': 0.8956705, 'binary_recall': 0.674898, 'binary_specificity': 0.99179786, 'binary_f1_score': 0.7697674}
confusion matrix:
       0     1
0  41959   347
1   1435  2979
---- Validation: 
scalar performance:
{'acc': 0.9601426, 'precision': 0.5958501, 'recall': 0.5293321, 'specificity': 0.5293321, 'f1': 0.54130626, 'auroc': 0.66188645, 'binary_precision': 0.22395833, 'binary_recall': 0.06687403, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.10299402}
confusion matrix:
       0    1
0  18000  149
1    600   43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7640853, 'recall': 0.68856555, 'specificity': 0.68856555, 'f1': 0.7192309, 'auroc': 0.8146387, 'binary_precision': 0.5543478, 'binary_recall': 0.3908046, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.45842695}
confusion matrix:
      0    1
0  5915   82
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_11.png
early stop counter: 10
val acc:0.9601426124572754, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 11,now: 2024-06-20 02:20:51.410476,epoch time: 0:17:56.722961,used: 3:10:07.045893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96393406, 'precision': 0.9250889, 'recall': 0.8532959, 'specificity': 0.8532959, 'f1': 0.88502216, 'auroc': 0.9642178, 'binary_precision': 0.87916666, 'binary_recall': 0.7168743, 'binary_specificity': 0.98971754, 'binary_f1_score': 0.78976923}
confusion matrix:
       0     1
0  41870   435
1   1250  3165
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.59986526, 'recall': 0.5473183, 'specificity': 0.5473183, 'f1': 0.5622774, 'auroc': 0.690954, 'binary_precision': 0.23076923, 'binary_recall': 0.10730949, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.14649682}
confusion matrix:
       0    1
0  17919  230
1    574   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74257374, 'recall': 0.7220459, 'specificity': 0.7220459, 'f1': 0.7317918, 'auroc': 0.822399, 'binary_precision': 0.50840336, 'binary_recall': 0.46360153, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.4849699}
confusion matrix:
      0    1
0  5880  117
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_12.png
early stop counter: 11
val acc:0.9572158455848694, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 12,now: 2024-06-20 02:35:13.115079,epoch time: 0:14:21.704603,used: 3:24:28.750496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9638271, 'precision': 0.94169295, 'recall': 0.8363919, 'specificity': 0.8363919, 'f1': 0.88017774, 'auroc': 0.9585779, 'binary_precision': 0.9159535, 'binary_recall': 0.6792838, 'binary_specificity': 0.99350005, 'binary_f1_score': 0.7800625}
confusion matrix:
       0     1
0  42033   275
1   1415  2997
---- Validation: 
scalar performance:
{'acc': 0.9604619, 'precision': 0.61276865, 'recall': 0.5369979, 'specificity': 0.5369979, 'f1': 0.5523134, 'auroc': 0.6781199, 'binary_precision': 0.25728154, 'binary_recall': 0.08242613, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.12485277}
confusion matrix:
       0    1
0  17996  153
1    590   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7765101, 'recall': 0.6984776, 'specificity': 0.6984776, 'f1': 0.7302997, 'auroc': 0.81789047, 'binary_precision': 0.5783784, 'binary_recall': 0.4099617, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.47982064}
confusion matrix:
      0    1
0  5919   78
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_13.png
early stop counter: 12
val acc:0.9604619145393372, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 13,now: 2024-06-20 02:50:16.538048,epoch time: 0:15:03.422969,used: 3:39:32.173465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96543235, 'precision': 0.9301164, 'recall': 0.8577831, 'specificity': 0.8577831, 'f1': 0.8897737, 'auroc': 0.96480316, 'binary_precision': 0.8883643, 'binary_recall': 0.725068, 'binary_specificity': 0.99049824, 'binary_f1_score': 0.7984525}
confusion matrix:
       0     1
0  41906   402
1   1213  3199
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.6055052, 'recall': 0.5435618, 'specificity': 0.5435618, 'f1': 0.55917615, 'auroc': 0.6906037, 'binary_precision': 0.2423077, 'binary_recall': 0.09797823, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.13953488}
confusion matrix:
       0    1
0  17952  197
1    580   63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.76759744, 'recall': 0.7201321, 'specificity': 0.7201321, 'f1': 0.74125576, 'auroc': 0.82182664, 'binary_precision': 0.5586854, 'binary_recall': 0.4559387, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.50210965}
confusion matrix:
      0    1
0  5903   94
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_14.png
early stop counter: 13
val acc:0.9586526155471802, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 14,now: 2024-06-20 03:05:17.764109,epoch time: 0:15:01.226061,used: 3:54:33.399526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9644906, 'precision': 0.91686255, 'recall': 0.86642766, 'specificity': 0.86642766, 'f1': 0.8895845, 'auroc': 0.9641783, 'binary_precision': 0.8599059, 'binary_recall': 0.7455246, 'binary_specificity': 0.9873307, 'binary_f1_score': 0.7986406}
confusion matrix:
       0     1
0  41771   536
1   1123  3290
---- Validation: 
scalar performance:
{'acc': 0.9580141, 'precision': 0.61786133, 'recall': 0.5582323, 'specificity': 0.5582323, 'f1': 0.5761409, 'auroc': 0.70011175, 'binary_precision': 0.26602563, 'binary_recall': 0.12908243, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.173822}
confusion matrix:
       0    1
0  17920  229
1    560   83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7676097, 'recall': 0.74595153, 'specificity': 0.74595153, 'f1': 0.756263, 'auroc': 0.8342984, 'binary_precision': 0.55648535, 'binary_recall': 0.5095785, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.532}
confusion matrix:
      0    1
0  5891  106
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_15.png
early stop counter: 14
val acc:0.9580140709877014, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 15,now: 2024-06-20 03:21:49.580710,epoch time: 0:16:31.816601,used: 4:11:05.216127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96440494, 'precision': 0.91907674, 'recall': 0.8633228, 'specificity': 0.8633228, 'f1': 0.8886832, 'auroc': 0.96276283, 'binary_precision': 0.86502254, 'binary_recall': 0.73867756, 'binary_specificity': 0.987968, 'binary_f1_score': 0.7968731}
confusion matrix:
       0     1
0  41795   509
1   1154  3262
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.6140164, 'recall': 0.5607642, 'specificity': 0.5607642, 'f1': 0.57776576, 'auroc': 0.6957364, 'binary_precision': 0.25816023, 'binary_recall': 0.13530326, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.177551}
confusion matrix:
       0    1
0  17899  250
1    556   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7397993, 'recall': 0.75469434, 'specificity': 0.75469434, 'f1': 0.7469891, 'auroc': 0.8352145, 'binary_precision': 0.5, 'binary_recall': 0.532567, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.51576996}
confusion matrix:
      0    1
0  5858  139
1   122  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_16.png
early stop counter: 15
val acc:0.9571093916893005, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 16,now: 2024-06-20 03:36:47.601247,epoch time: 0:14:58.020537,used: 4:26:03.236664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9682363, 'precision': 0.92753124, 'recall': 0.879482, 'specificity': 0.879482, 'f1': 0.9016949, 'auroc': 0.9731333, 'binary_precision': 0.8787487, 'binary_recall': 0.77004987, 'binary_specificity': 0.9889141, 'binary_f1_score': 0.8208162}
confusion matrix:
       0     1
0  41837   469
1   1015  3399
---- Validation: 
scalar performance:
{'acc': 0.95875907, 'precision': 0.63333875, 'recall': 0.56836873, 'specificity': 0.56836873, 'f1': 0.5886936, 'auroc': 0.7174094, 'binary_precision': 0.2962963, 'binary_recall': 0.14930016, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.19855222}
confusion matrix:
       0    1
0  17921  228
1    547   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.79015666, 'recall': 0.75486493, 'specificity': 0.75486493, 'f1': 0.7712254, 'auroc': 0.84382427, 'binary_precision': 0.60087717, 'binary_recall': 0.5249042, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.56032723}
confusion matrix:
      0    1
0  5906   91
1   124  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_17.png
new oracle model saved
early stop counter: 16
val acc:0.958759069442749, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 17,now: 2024-06-20 03:51:31.611573,epoch time: 0:14:44.010326,used: 4:40:47.246990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9659675, 'precision': 0.91881835, 'recall': 0.87413776, 'specificity': 0.87413776, 'f1': 0.89487934, 'auroc': 0.96887267, 'binary_precision': 0.8622462, 'binary_recall': 0.76094353, 'binary_specificity': 0.9873319, 'binary_f1_score': 0.8084338}
confusion matrix:
       0     1
0  41775   536
1   1054  3355
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.62363005, 'recall': 0.5649277, 'specificity': 0.5649277, 'f1': 0.5835556, 'auroc': 0.70634115, 'binary_precision': 0.27710843, 'binary_recall': 0.14307931, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.18871795}
confusion matrix:
       0    1
0  17909  240
1    551   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.7784853, 'recall': 0.75594693, 'specificity': 0.75594693, 'f1': 0.76667905, 'auroc': 0.83778113, 'binary_precision': 0.57740587, 'binary_recall': 0.52873564, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.552}
confusion matrix:
      0    1
0  5896  101
1   123  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_18.png
early stop counter: 17
val acc:0.9579076170921326, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 18,now: 2024-06-20 04:05:53.889469,epoch time: 0:14:22.277896,used: 4:55:09.524886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.9047079, 'recall': 0.892169, 'specificity': 0.892169, 'f1': 0.89831156, 'auroc': 0.9725493, 'binary_precision': 0.83004695, 'binary_recall': 0.8014506, 'binary_specificity': 0.9828874, 'binary_f1_score': 0.8154982}
confusion matrix:
       0     1
0  41584   724
1    876  3536
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.6210921, 'recall': 0.5823016, 'specificity': 0.5823016, 'f1': 0.5973195, 'auroc': 0.72109365, 'binary_precision': 0.27083334, 'binary_recall': 0.18195957, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.21767442}
confusion matrix:
       0    1
0  17834  315
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74821675, 'recall': 0.75910944, 'specificity': 0.75910944, 'f1': 0.7535292, 'auroc': 0.84312594, 'binary_precision': 0.51648355, 'binary_recall': 0.54022986, 'binary_specificity': 0.977989, 'binary_f1_score': 0.52808994}
confusion matrix:
      0    1
0  5865  132
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_19.png
early stop counter: 18
val acc:0.9552469253540039, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 19,now: 2024-06-20 04:21:03.624633,epoch time: 0:15:09.735164,used: 5:10:19.260050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96791524, 'precision': 0.9187951, 'recall': 0.8879826, 'specificity': 0.8879826, 'f1': 0.9026387, 'auroc': 0.9726722, 'binary_precision': 0.85936344, 'binary_recall': 0.7894379, 'binary_specificity': 0.9865274, 'binary_f1_score': 0.8229179}
confusion matrix:
       0     1
0  41738   570
1    929  3483
---- Validation: 
scalar performance:
{'acc': 0.95737547, 'precision': 0.6274504, 'recall': 0.57365286, 'specificity': 0.57365286, 'f1': 0.59212226, 'auroc': 0.71558976, 'binary_precision': 0.284153, 'binary_recall': 0.16174184, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.20614472}
confusion matrix:
       0    1
0  17887  262
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.76132107, 'recall': 0.7565286, 'specificity': 0.7565286, 'f1': 0.7588996, 'auroc': 0.84351313, 'binary_precision': 0.54296875, 'binary_recall': 0.532567, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.5377176}
confusion matrix:
      0    1
0  5880  117
1   122  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_20.png
early stop counter: 19
val acc:0.9573754668235779, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 20,now: 2024-06-20 04:35:29.513748,epoch time: 0:14:25.889115,used: 5:24:45.149165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9673159, 'precision': 0.9174075, 'recall': 0.8854715, 'specificity': 0.8854715, 'f1': 0.90062976, 'auroc': 0.9706726, 'binary_precision': 0.85707206, 'binary_recall': 0.78458047, 'binary_specificity': 0.9863626, 'binary_f1_score': 0.8192257}
confusion matrix:
       0     1
0  41733   577
1    950  3460
---- Validation: 
scalar performance:
{'acc': 0.9563644, 'precision': 0.6269181, 'recall': 0.58138007, 'specificity': 0.58138007, 'f1': 0.5983014, 'auroc': 0.7257122, 'binary_precision': 0.28255528, 'binary_recall': 0.17884915, 'binary_specificity': 0.983911, 'binary_f1_score': 0.2190476}
confusion matrix:
       0    1
0  17857  292
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7641081, 'recall': 0.7641081, 'specificity': 0.7641081, 'f1': 0.7641081, 'auroc': 0.8477904, 'binary_precision': 0.54789275, 'binary_recall': 0.54789275, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.54789275}
confusion matrix:
      0    1
0  5879  118
1   118  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_21.png
early stop counter: 20
val acc:0.9563643932342529, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 21,now: 2024-06-20 04:50:12.397261,epoch time: 0:14:42.883513,used: 5:39:28.032678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9683219, 'precision': 0.9144143, 'recall': 0.8968139, 'specificity': 0.8968139, 'f1': 0.9053695, 'auroc': 0.9754546, 'binary_precision': 0.84867954, 'binary_recall': 0.80866015, 'binary_specificity': 0.9849677, 'binary_f1_score': 0.82818663}
confusion matrix:
       0     1
0  41673   636
1    844  3567
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.62354153, 'recall': 0.58813673, 'specificity': 0.58813673, 'f1': 0.6023402, 'auroc': 0.72580266, 'binary_precision': 0.2753304, 'binary_recall': 0.19440125, 'binary_specificity': 0.98187226, 'binary_f1_score': 0.22789426}
confusion matrix:
       0    1
0  17820  329
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.75681436, 'recall': 0.7690215, 'specificity': 0.7690215, 'f1': 0.7627561, 'auroc': 0.84694576, 'binary_precision': 0.5328467, 'binary_recall': 0.55938697, 'binary_specificity': 0.978656, 'binary_f1_score': 0.54579437}
confusion matrix:
      0    1
0  5869  128
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_22.png
early stop counter: 21
val acc:0.9549276232719421, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 22,now: 2024-06-20 05:05:24.440905,epoch time: 0:15:12.043644,used: 5:54:40.076322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9687928, 'precision': 0.9161217, 'recall': 0.8979501, 'specificity': 0.8979501, 'f1': 0.9067763, 'auroc': 0.9746206, 'binary_precision': 0.85190475, 'binary_recall': 0.8106026, 'binary_specificity': 0.9852976, 'binary_f1_score': 0.8307407}
confusion matrix:
       0     1
0  41684   622
1    836  3578
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6164298, 'recall': 0.5846682, 'specificity': 0.5846682, 'f1': 0.5975605, 'auroc': 0.7303971, 'binary_precision': 0.2613391, 'binary_recall': 0.1881804, 'binary_specificity': 0.981156, 'binary_f1_score': 0.2188065}
confusion matrix:
       0    1
0  17807  342
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7626201, 'recall': 0.7731864, 'specificity': 0.7731864, 'f1': 0.76778454, 'auroc': 0.85049677, 'binary_precision': 0.5441176, 'binary_recall': 0.5670498, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.5553471}
confusion matrix:
      0    1
0  5873  124
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_23.png
early stop counter: 22
val acc:0.954023003578186, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 23,now: 2024-06-20 05:20:01.751108,epoch time: 0:14:37.310203,used: 6:09:17.386525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96791524, 'precision': 0.9163786, 'recall': 0.8912538, 'specificity': 0.8912538, 'f1': 0.90331686, 'auroc': 0.9733952, 'binary_precision': 0.8538125, 'binary_recall': 0.7967369, 'binary_specificity': 0.9857707, 'binary_f1_score': 0.8242879}
confusion matrix:
       0     1
0  41705   602
1    897  3516
---- Validation: 
scalar performance:
{'acc': 0.95647085, 'precision': 0.6308799, 'recall': 0.5859355, 'specificity': 0.5859355, 'f1': 0.60295284, 'auroc': 0.72661954, 'binary_precision': 0.29016787, 'binary_recall': 0.1881804, 'binary_specificity': 0.98369056, 'binary_f1_score': 0.22830188}
confusion matrix:
       0    1
0  17853  296
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.76692224, 'recall': 0.76985526, 'specificity': 0.76985526, 'f1': 0.7683796, 'auroc': 0.85438055, 'binary_precision': 0.5530303, 'binary_recall': 0.55938697, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.5561905}
confusion matrix:
      0    1
0  5879  118
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_24.png
early stop counter: 23
val acc:0.9564708471298218, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 24,now: 2024-06-20 05:34:30.830754,epoch time: 0:14:29.079646,used: 6:23:46.466171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97065496, 'precision': 0.9217582, 'recall': 0.90342224, 'specificity': 0.90342224, 'f1': 0.9123298, 'auroc': 0.975044, 'binary_precision': 0.86214286, 'binary_recall': 0.82053024, 'binary_specificity': 0.9863143, 'binary_f1_score': 0.840822}
confusion matrix:
       0     1
0  41728   579
1    792  3621
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.628005, 'recall': 0.58641005, 'specificity': 0.58641005, 'f1': 0.60246724, 'auroc': 0.7374942, 'binary_precision': 0.28438228, 'binary_recall': 0.18973562, 'binary_specificity': 0.98308444, 'binary_f1_score': 0.22761194}
confusion matrix:
       0    1
0  17842  307
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.77166927, 'recall': 0.7646917, 'specificity': 0.7646917, 'f1': 0.768129, 'auroc': 0.85019714, 'binary_precision': 0.56299216, 'binary_recall': 0.54789275, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.5553398}
confusion matrix:
      0    1
0  5886  111
1   118  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_25.png
early stop counter: 24
val acc:0.9559386968612671, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 25,now: 2024-06-20 05:49:08.202398,epoch time: 0:14:37.371644,used: 6:38:23.837815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97011983, 'precision': 0.9182743, 'recall': 0.9044659, 'specificity': 0.9044659, 'f1': 0.9112217, 'auroc': 0.97618175, 'binary_precision': 0.85489184, 'binary_recall': 0.8235161, 'binary_specificity': 0.98541576, 'binary_f1_score': 0.8389107}
confusion matrix:
       0     1
0  41689   617
1    779  3635
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.628338, 'recall': 0.5864376, 'specificity': 0.5864376, 'f1': 0.60258746, 'auroc': 0.7291453, 'binary_precision': 0.28504673, 'binary_recall': 0.18973562, 'binary_specificity': 0.9831396, 'binary_f1_score': 0.22782446}
confusion matrix:
       0    1
0  17843  306
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7529745, 'recall': 0.76868796, 'specificity': 0.76868796, 'f1': 0.7605606, 'auroc': 0.85480285, 'binary_precision': 0.52517986, 'binary_recall': 0.55938697, 'binary_specificity': 0.977989, 'binary_f1_score': 0.541744}
confusion matrix:
      0    1
0  5865  132
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_26.png
early stop counter: 25
val acc:0.9559919238090515, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 26,now: 2024-06-20 06:06:34.734777,epoch time: 0:17:26.532379,used: 6:55:50.370194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9680865, 'precision': 0.9107883, 'recall': 0.9005023, 'specificity': 0.9005023, 'f1': 0.90556157, 'auroc': 0.9741862, 'binary_precision': 0.8405966, 'binary_recall': 0.81717265, 'binary_specificity': 0.98383206, 'binary_f1_score': 0.82871914}
confusion matrix:
       0     1
0  41622   684
1    807  3607
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.6331198, 'recall': 0.5896582, 'specificity': 0.5896582, 'f1': 0.6064319, 'auroc': 0.72792184, 'binary_precision': 0.29439253, 'binary_recall': 0.19595645, 'binary_specificity': 0.98336, 'binary_f1_score': 0.23529412}
confusion matrix:
       0    1
0  17847  302
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7677227, 'recall': 0.77360326, 'specificity': 0.77360326, 'f1': 0.77062666, 'auroc': 0.85460293, 'binary_precision': 0.5543071, 'binary_recall': 0.5670498, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.560606}
confusion matrix:
      0    1
0  5878  119
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_27.png
early stop counter: 26
val acc:0.9564176201820374, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 27,now: 2024-06-20 06:21:41.116378,epoch time: 0:15:06.381601,used: 7:10:56.751795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96885705, 'precision': 0.91491866, 'recall': 0.89993155, 'specificity': 0.89993155, 'f1': 0.9072485, 'auroc': 0.9762118, 'binary_precision': 0.84904325, 'binary_recall': 0.81496596, 'binary_specificity': 0.9848972, 'binary_f1_score': 0.8316556}
confusion matrix:
       0     1
0  41671   639
1    816  3594
---- Validation: 
scalar performance:
{'acc': 0.95705616, 'precision': 0.6326868, 'recall': 0.5832383, 'specificity': 0.5832383, 'f1': 0.6013501, 'auroc': 0.72412527, 'binary_precision': 0.29396984, 'binary_recall': 0.18195957, 'binary_specificity': 0.98451704, 'binary_f1_score': 0.22478385}
confusion matrix:
       0    1
0  17868  281
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7681063, 'recall': 0.7681063, 'specificity': 0.7681063, 'f1': 0.7681063, 'auroc': 0.85242176, 'binary_precision': 0.5555556, 'binary_recall': 0.5555556, 'binary_specificity': 0.980657, 'binary_f1_score': 0.5555556}
confusion matrix:
      0    1
0  5881  116
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_28.png
early stop counter: 27
val acc:0.9570561647415161, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 28,now: 2024-06-20 06:37:32.664793,epoch time: 0:15:51.548415,used: 7:26:48.300210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96748716, 'precision': 0.90314496, 'recall': 0.9079651, 'specificity': 0.9079651, 'f1': 0.90553653, 'auroc': 0.9764825, 'binary_precision': 0.8235689, 'binary_recall': 0.83457965, 'binary_specificity': 0.9813506, 'binary_f1_score': 0.8290377}
confusion matrix:
       0     1
0  41518   789
1    730  3683
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.6314782, 'recall': 0.5980252, 'specificity': 0.5980252, 'f1': 0.6118897, 'auroc': 0.7300295, 'binary_precision': 0.29052633, 'binary_recall': 0.21461898, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.24686942}
confusion matrix:
       0    1
0  17812  337
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7587228, 'recall': 0.7710206, 'specificity': 0.7710206, 'f1': 0.76470876, 'auroc': 0.8550782, 'binary_precision': 0.53649634, 'binary_recall': 0.5632184, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.5495327}
confusion matrix:
      0    1
0  5870  127
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_29.png
early stop counter: 28
val acc:0.9551936984062195, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 29,now: 2024-06-20 06:51:54.937543,epoch time: 0:14:22.272750,used: 7:41:10.572960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96902823, 'precision': 0.9097961, 'recall': 0.9088805, 'specificity': 0.9088805, 'f1': 0.90933764, 'auroc': 0.97638285, 'binary_precision': 0.83681816, 'binary_recall': 0.83473134, 'binary_specificity': 0.9830296, 'binary_f1_score': 0.8357734}
confusion matrix:
       0     1
0  41591   718
1    729  3682
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.6290523, 'recall': 0.5879102, 'specificity': 0.5879102, 'f1': 0.6039016, 'auroc': 0.7317935, 'binary_precision': 0.28637412, 'binary_recall': 0.19284603, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.23048326}
confusion matrix:
       0    1
0  17840  309
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7625395, 'recall': 0.77501875, 'specificity': 0.77501875, 'f1': 0.768614, 'auroc': 0.85436654, 'binary_precision': 0.54379565, 'binary_recall': 0.57088125, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.55700934}
confusion matrix:
      0    1
0  5872  125
1   112  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_30.png
early stop counter: 29
val acc:0.9559386968612671, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9656440019607544
after epoch: 30,now: 2024-06-20 07:07:04.901232,epoch time: 0:15:09.963689,used: 7:56:20.536649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_23_10_44_seed_0_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:56:20.536649 at 2024-06-20 07:07:04.901232
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2653811, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.965644, 'precision': 0.79015666, 'recall': 0.75486493, 'specificity': 0.75486493, 'f1': 0.7712254, 'auroc': 0.84382427, 'binary_precision': 0.60087717, 'binary_recall': 0.5249042, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.56032723}
confusion matrix:
      0    1
0  5906   91
1   124  137
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |  36161 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 424345 GiB | 424345 GiB |
|       from small pool |  35968 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |   1876 MiB |   1876 MiB |      0 B   |
|       from large pool |   1802 MiB |   1802 MiB |   1802 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 301036 GiB | 301036 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 300912 GiB | 300911 GiB |
|       from small pool |   6846 KiB |  12716 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   12613 K  |   12612 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8583 K  |    8582 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   12613 K  |   12612 K  |
|       from large pool |      36    |      76    |    4030 K  |    4030 K  |
|       from small pool |    1158    |    1780    |    8583 K  |    8582 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |     382    |    7244 K  |    7244 K  |
|       from large pool |       5    |      10    |    1595 K  |    1595 K  |
|       from small pool |      36    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424345 GiB | 424345 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301036 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300911 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12613 K  |   12613 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8583 K  |    8583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12613 K  |   12613 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8583 K  |    8583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7244 K  |    7244 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 424468 GiB | 424468 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 424349 GiB | 424349 GiB |
|       from small pool |      0 KiB |     72 MiB |    119 GiB |    119 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 424463 GiB | 424463 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 424345 GiB | 424345 GiB |
|       from small pool |      0 KiB |     71 MiB |    117 GiB |    117 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   1876 MiB |   1282 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   1802 MiB |   1250 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 301036 GiB | 301036 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 300912 GiB | 300911 GiB |
|       from small pool |      0 KiB |  14441 KiB |    124 GiB |    124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   12613 K  |   12613 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8583 K  |    8583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   12613 K  |   12613 K  |
|       from large pool |       2    |      76    |    4030 K  |    4030 K  |
|       from small pool |       0    |    1780    |    8583 K  |    8583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      50    |      20    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |    7244 K  |    7244 K  |
|       from large pool |       1    |      11    |    1595 K  |    1595 K  |
|       from small pool |       0    |     377    |    5649 K  |    5649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109

 Experiment start at: 2024-06-20 07:13:35.046454
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.907256, 'precision': 0.4537057, 'recall': 0.49990565, 'specificity': 0.49990565, 'f1': 0.47568652, 'auroc': 0.49871594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998113, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42387  8
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.3277327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21902378, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 07:28:38.504461,epoch time: 0:15:03.458007,used: 0:15:03.458007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9072132, 'precision': 0.45371342, 'recall': 0.49987027, 'specificity': 0.49987027, 'f1': 0.47567475, 'auroc': 0.69989705, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99974054, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42385  11
1   4324   0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.34374312, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2369872, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_2.png
better model found
persisted
after epoch: 2,now: 2024-06-20 07:43:29.302716,epoch time: 0:14:50.798255,used: 0:29:54.256262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9059289, 'precision': 0.5554924, 'recall': 0.50180715, 'specificity': 0.50180715, 'f1': 0.48115373, 'auroc': 0.83481133, 'binary_precision': 0.203125, 'binary_recall': 0.006019912, 'binary_specificity': 0.9975944, 'binary_f1_score': 0.011693276}
confusion matrix:
       0    1
0  42299  102
1   4293   26
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.48203224, 'recall': 0.4996679, 'specificity': 0.4996679, 'f1': 0.49069163, 'auroc': 0.3994291, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18055  12
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.44007993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_3.png
early stop counter: 1
val acc:0.9634471535682678, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-20 07:57:55.569784,epoch time: 0:14:26.267068,used: 0:44:20.523330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91534674, 'precision': 0.8341717, 'recall': 0.5620807, 'specificity': 0.5620807, 'f1': 0.58735293, 'auroc': 0.8851371, 'binary_precision': 0.75033736, 'binary_recall': 0.1285252, 'binary_specificity': 0.99563617, 'binary_f1_score': 0.21945925}
confusion matrix:
       0    1
0  42209  185
1   3770  556
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.48201784, 'recall': 0.4992528, 'specificity': 0.4992528, 'f1': 0.49048397, 'auroc': 0.44208878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18040  27
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5309148, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_4.png
early stop counter: 2
val acc:0.9626467227935791, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-20 08:12:47.388356,epoch time: 0:14:51.818572,used: 0:59:12.341902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9290454, 'precision': 0.8842268, 'recall': 0.6419511, 'specificity': 0.6419511, 'f1': 0.69624054, 'auroc': 0.91594446, 'binary_precision': 0.83633935, 'binary_recall': 0.2896807, 'binary_specificity': 0.99422145, 'binary_f1_score': 0.43031448}
confusion matrix:
       0     1
0  42153   245
1   3070  1252
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.48201495, 'recall': 0.49916977, 'specificity': 0.49916977, 'f1': 0.4904424, 'auroc': 0.50752616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18037  30
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6715978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_5.png
early stop counter: 3
val acc:0.9624866843223572, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-20 08:30:50.382846,epoch time: 0:18:02.994490,used: 1:17:15.336392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94088185, 'precision': 0.9103319, 'recall': 0.706965, 'specificity': 0.706965, 'f1': 0.7680839, 'auroc': 0.9147922, 'binary_precision': 0.8768116, 'binary_recall': 0.41994447, 'binary_specificity': 0.9939856, 'binary_f1_score': 0.5678974}
confusion matrix:
       0     1
0  42143   255
1   2507  1815
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.4936571, 'recall': 0.4995806, 'specificity': 0.4995806, 'f1': 0.49168608, 'auroc': 0.51125544, 'binary_precision': 0.023255814, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.002793296}
confusion matrix:
       0   1
0  18025  42
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7296446, 'recall': 0.5147119, 'specificity': 0.5147119, 'f1': 0.5182736, 'auroc': 0.6572143, 'binary_precision': 0.5, 'binary_recall': 0.03076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.057971016}
confusion matrix:
      0  1
0  5938  8
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_6.png
early stop counter: 4
val acc:0.9618996977806091, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-20 08:49:00.282797,epoch time: 0:18:09.899951,used: 1:35:25.236343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9471319, 'precision': 0.92559177, 'recall': 0.7380164, 'specificity': 0.7380164, 'f1': 0.79961073, 'auroc': 0.9316821, 'binary_precision': 0.90168905, 'binary_recall': 0.4813873, 'binary_specificity': 0.9946456, 'binary_f1_score': 0.62767565}
confusion matrix:
       0     1
0  42168   227
1   2243  2082
---- Validation: 
scalar performance:
{'acc': 0.9608324, 'precision': 0.49741942, 'recall': 0.4997424, 'specificity': 0.4997424, 'f1': 0.49272144, 'auroc': 0.572502, 'binary_precision': 0.03076923, 'binary_recall': 0.0029717681, 'binary_specificity': 0.996513, 'binary_f1_score': 0.0054200543}
confusion matrix:
       0   1
0  18004  63
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7701806, 'recall': 0.5409622, 'specificity': 0.5409622, 'f1': 0.56334174, 'auroc': 0.73227555, 'binary_precision': 0.57894737, 'binary_recall': 0.08461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.147651}
confusion matrix:
      0   1
0  5930  16
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_7.png
new oracle model saved
early stop counter: 5
val acc:0.960832417011261, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9590718746185303
after epoch: 7,now: 2024-06-20 09:07:39.133252,epoch time: 0:18:38.850455,used: 1:54:04.086798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9519906, 'precision': 0.9284111, 'recall': 0.767009, 'specificity': 0.767009, 'f1': 0.8248081, 'auroc': 0.9370533, 'binary_precision': 0.9018926, 'binary_recall': 0.54000926, 'binary_specificity': 0.99400884, 'binary_f1_score': 0.67553884}
confusion matrix:
       0     1
0  42142   254
1   1989  2335
---- Validation: 
scalar performance:
{'acc': 0.9602455, 'precision': 0.50707394, 'recall': 0.5008685, 'specificity': 0.5008685, 'f1': 0.4951697, 'auroc': 0.59924215, 'binary_precision': 0.05, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.01062417}
confusion matrix:
       0   1
0  17991  76
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.77501166, 'recall': 0.57640755, 'specificity': 0.57640755, 'f1': 0.6139792, 'auroc': 0.76695776, 'binary_precision': 0.5857143, 'binary_recall': 0.15769231, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.24848486}
confusion matrix:
      0   1
0  5917  29
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_8.png
new oracle model saved
early stop counter: 6
val acc:0.9602454900741577, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9600386619567871
after epoch: 8,now: 2024-06-20 09:26:30.403826,epoch time: 0:18:51.270574,used: 2:12:55.357372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9563142, 'precision': 0.93459755, 'recall': 0.7901511, 'specificity': 0.7901511, 'f1': 0.8447089, 'auroc': 0.9441768, 'binary_precision': 0.909939, 'binary_recall': 0.5862228, 'binary_specificity': 0.99407935, 'binary_f1_score': 0.71306056}
confusion matrix:
       0     1
0  42143   251
1   1790  2536
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.531648, 'recall': 0.5044171, 'specificity': 0.5044171, 'f1': 0.501621, 'auroc': 0.61256707, 'binary_precision': 0.0989011, 'binary_recall': 0.013372957, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.02356021}
confusion matrix:
       0   1
0  17985  82
1    664   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7994255, 'recall': 0.6124415, 'specificity': 0.6124415, 'f1': 0.65926874, 'auroc': 0.7738583, 'binary_precision': 0.6315789, 'binary_recall': 0.23076923, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.3380282}
confusion matrix:
      0   1
0  5911  35
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_9.png
new oracle model saved
early stop counter: 7
val acc:0.960192084312439, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 9,now: 2024-06-20 09:45:44.403347,epoch time: 0:19:13.999521,used: 2:32:09.356893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95971745, 'precision': 0.92761743, 'recall': 0.81784964, 'specificity': 0.81784964, 'f1': 0.8627145, 'auroc': 0.95190287, 'binary_precision': 0.89056, 'binary_recall': 0.6437659, 'binary_specificity': 0.9919334, 'binary_f1_score': 0.74731475}
confusion matrix:
       0     1
0  42055   342
1   1540  2783
---- Validation: 
scalar performance:
{'acc': 0.9574173, 'precision': 0.56737936, 'recall': 0.5194292, 'specificity': 0.5194292, 'f1': 0.5262267, 'auroc': 0.6616825, 'binary_precision': 0.16931216, 'binary_recall': 0.04754829, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.07424594}
confusion matrix:
       0    1
0  17910  157
1    641   32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7579186, 'recall': 0.67412615, 'specificity': 0.67412615, 'f1': 0.7068638, 'auroc': 0.80974025, 'binary_precision': 0.5433526, 'binary_recall': 0.36153847, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.43418014}
confusion matrix:
      0   1
0  5867  79
1   166  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_10.png
early stop counter: 8
val acc:0.9574173092842102, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 10,now: 2024-06-20 10:02:41.032317,epoch time: 0:16:56.628970,used: 2:49:05.985863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96106595, 'precision': 0.92754066, 'recall': 0.8269799, 'specificity': 0.8269799, 'f1': 0.8689315, 'auroc': 0.9551263, 'binary_precision': 0.8886476, 'binary_recall': 0.6624277, 'binary_specificity': 0.991532, 'binary_f1_score': 0.75904095}
confusion matrix:
       0     1
0  42036   359
1   1460  2865
---- Validation: 
scalar performance:
{'acc': 0.9583778, 'precision': 0.5867157, 'recall': 0.5242189, 'specificity': 0.5242189, 'f1': 0.5337438, 'auroc': 0.67123663, 'binary_precision': 0.20765027, 'binary_recall': 0.056463595, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.088785045}
confusion matrix:
       0    1
0  17922  145
1    635   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7804293, 'recall': 0.6882604, 'specificity': 0.6882604, 'f1': 0.724197, 'auroc': 0.81311643, 'binary_precision': 0.5872093, 'binary_recall': 0.38846153, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.46759257}
confusion matrix:
      0    1
0  5875   71
1   159  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_11.png
new oracle model saved
early stop counter: 9
val acc:0.9583777785301208, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9629390835762024
after epoch: 11,now: 2024-06-20 10:20:16.340224,epoch time: 0:17:35.307907,used: 3:06:41.293770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96074486, 'precision': 0.9256027, 'recall': 0.8267381, 'specificity': 0.8267381, 'f1': 0.8680897, 'auroc': 0.9497001, 'binary_precision': 0.88480544, 'binary_recall': 0.6622746, 'binary_specificity': 0.9912016, 'binary_f1_score': 0.7575357}
confusion matrix:
       0     1
0  42021   373
1   1461  2865
---- Validation: 
scalar performance:
{'acc': 0.95805764, 'precision': 0.5865622, 'recall': 0.5254834, 'specificity': 0.5254834, 'f1': 0.5354558, 'auroc': 0.67278683, 'binary_precision': 0.20725389, 'binary_recall': 0.059435364, 'binary_specificity': 0.99153155, 'binary_f1_score': 0.09237876}
confusion matrix:
       0    1
0  17914  153
1    633   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.7947689, 'recall': 0.6889331, 'specificity': 0.6889331, 'f1': 0.7289483, 'auroc': 0.8173185, 'binary_precision': 0.61585367, 'binary_recall': 0.38846153, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.47641513}
confusion matrix:
      0    1
0  5883   63
1   159  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_12.png
new oracle model saved
early stop counter: 10
val acc:0.9580576419830322, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9642281532287598
after epoch: 12,now: 2024-06-20 10:37:35.450749,epoch time: 0:17:19.110525,used: 3:24:00.404295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9633776, 'precision': 0.91613775, 'recall': 0.8547977, 'specificity': 0.8547977, 'f1': 0.88239634, 'auroc': 0.9611957, 'binary_precision': 0.86021507, 'binary_recall': 0.7215541, 'binary_specificity': 0.98804134, 'binary_f1_score': 0.7848069}
confusion matrix:
       0     1
0  41889   507
1   1204  3120
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.60688657, 'recall': 0.53951204, 'specificity': 0.53951204, 'f1': 0.55461717, 'auroc': 0.68927634, 'binary_precision': 0.24691358, 'binary_recall': 0.089153044, 'binary_specificity': 0.989871, 'binary_f1_score': 0.13100436}
confusion matrix:
       0    1
0  17884  183
1    613   60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.7839978, 'recall': 0.7089097, 'specificity': 0.7089097, 'f1': 0.7400392, 'auroc': 0.8180858, 'binary_precision': 0.5925926, 'binary_recall': 0.43076923, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.49888644}
confusion matrix:
      0    1
0  5869   77
1   148  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_13.png
early stop counter: 11
val acc:0.9575240015983582, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9642281532287598
after epoch: 13,now: 2024-06-20 10:55:30.567766,epoch time: 0:17:55.117017,used: 3:41:55.521312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96541095, 'precision': 0.9204673, 'recall': 0.8639877, 'specificity': 0.8639877, 'f1': 0.88966805, 'auroc': 0.9643216, 'binary_precision': 0.8671006, 'binary_recall': 0.7395327, 'binary_specificity': 0.9884426, 'binary_f1_score': 0.79825217}
confusion matrix:
       0     1
0  41907   490
1   1126  3197
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.5999975, 'recall': 0.55471355, 'specificity': 0.55471355, 'f1': 0.5692648, 'auroc': 0.7058127, 'binary_precision': 0.2320442, 'binary_recall': 0.124814264, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.16231884}
confusion matrix:
       0    1
0  17789  278
1    589   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73988986, 'recall': 0.7354744, 'specificity': 0.7354744, 'f1': 0.73765856, 'auroc': 0.8335222, 'binary_precision': 0.5019608, 'binary_recall': 0.4923077, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.4970874}
confusion matrix:
      0    1
0  5819  127
1   132  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_14.png
early stop counter: 12
val acc:0.9537353515625, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9642281532287598
after epoch: 14,now: 2024-06-20 11:14:54.907689,epoch time: 0:19:24.339923,used: 4:01:19.861235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96571064, 'precision': 0.936443, 'recall': 0.84915984, 'specificity': 0.84915984, 'f1': 0.8867657, 'auroc': 0.9640157, 'binary_precision': 0.90221566, 'binary_recall': 0.70612717, 'binary_specificity': 0.99219245, 'binary_f1_score': 0.7922179}
confusion matrix:
       0     1
0  42064   331
1   1271  3054
---- Validation: 
scalar performance:
{'acc': 0.9579509, 'precision': 0.6089276, 'recall': 0.5383029, 'specificity': 0.5383029, 'f1': 0.55338717, 'auroc': 0.696797, 'binary_precision': 0.25108224, 'binary_recall': 0.086181276, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.12831858}
confusion matrix:
       0    1
0  17894  173
1    615   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.79432535, 'recall': 0.71317625, 'specificity': 0.71317625, 'f1': 0.7464962, 'auroc': 0.82896423, 'binary_precision': 0.61290324, 'binary_recall': 0.43846154, 'binary_specificity': 0.987891, 'binary_f1_score': 0.51121074}
confusion matrix:
      0    1
0  5874   72
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_15.png
new oracle model saved
early stop counter: 13
val acc:0.9579508900642395, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 15,now: 2024-06-20 11:34:10.993802,epoch time: 0:19:16.086113,used: 4:20:35.947348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96498287, 'precision': 0.9178126, 'recall': 0.864227, 'specificity': 0.864227, 'f1': 0.8887054, 'auroc': 0.9628484, 'binary_precision': 0.86171645, 'binary_recall': 0.74057806, 'binary_specificity': 0.98787594, 'binary_f1_score': 0.79656804}
confusion matrix:
       0     1
0  41881   514
1   1122  3203
---- Validation: 
scalar performance:
{'acc': 0.95533615, 'precision': 0.6057241, 'recall': 0.5512522, 'specificity': 0.5512522, 'f1': 0.56708, 'auroc': 0.69956076, 'binary_precision': 0.24375, 'binary_recall': 0.11589896, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.1570997}
confusion matrix:
       0    1
0  17825  242
1    595   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.76911414, 'recall': 0.7432618, 'specificity': 0.7432618, 'f1': 0.75544906, 'auroc': 0.83383596, 'binary_precision': 0.55982906, 'binary_recall': 0.50384617, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.5303644}
confusion matrix:
      0    1
0  5843  103
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_16.png
early stop counter: 14
val acc:0.9553361535072327, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 16,now: 2024-06-20 11:53:20.975148,epoch time: 0:19:09.981346,used: 4:39:45.928694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96427655, 'precision': 0.9125261, 'recall': 0.86570644, 'specificity': 0.86570644, 'f1': 0.8873352, 'auroc': 0.9631996, 'binary_precision': 0.850766, 'binary_recall': 0.7447399, 'binary_specificity': 0.98667294, 'binary_f1_score': 0.79423004}
confusion matrix:
       0     1
0  41830   565
1   1104  3221
---- Validation: 
scalar performance:
{'acc': 0.9545891, 'precision': 0.61602056, 'recall': 0.56588537, 'specificity': 0.56588537, 'f1': 0.582696, 'auroc': 0.7143998, 'binary_precision': 0.2632979, 'binary_recall': 0.14710252, 'binary_specificity': 0.9846682, 'binary_f1_score': 0.1887512}
confusion matrix:
       0    1
0  17790  277
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7481227, 'recall': 0.750859, 'specificity': 0.750859, 'f1': 0.7494823, 'auroc': 0.845386, 'binary_precision': 0.5171103, 'binary_recall': 0.52307695, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.5200765}
confusion matrix:
      0    1
0  5819  127
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_17.png
early stop counter: 15
val acc:0.9545891284942627, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 17,now: 2024-06-20 12:14:24.137717,epoch time: 0:21:03.162569,used: 5:00:49.091263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9662243, 'precision': 0.9182284, 'recall': 0.87243354, 'specificity': 0.87243354, 'f1': 0.8936561, 'auroc': 0.9659847, 'binary_precision': 0.86089927, 'binary_recall': 0.7573444, 'binary_specificity': 0.9875227, 'binary_f1_score': 0.8058085}
confusion matrix:
       0     1
0  41868   529
1   1049  3274
---- Validation: 
scalar performance:
{'acc': 0.95490927, 'precision': 0.61750335, 'recall': 0.5653361, 'specificity': 0.5653361, 'f1': 0.5825455, 'auroc': 0.7133714, 'binary_precision': 0.26630434, 'binary_recall': 0.14561664, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.1882805}
confusion matrix:
       0    1
0  17797  270
1    575   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7511423, 'recall': 0.7455943, 'specificity': 0.7455943, 'f1': 0.748333, 'auroc': 0.83976525, 'binary_precision': 0.52362204, 'binary_recall': 0.51153845, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.5175097}
confusion matrix:
      0    1
0  5825  121
1   127  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_18.png
early stop counter: 16
val acc:0.9549092650413513, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 18,now: 2024-06-20 12:33:01.309718,epoch time: 0:18:37.172001,used: 5:19:26.263264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96425515, 'precision': 0.9082844, 'recall': 0.87106496, 'specificity': 0.87106496, 'f1': 0.88854676, 'auroc': 0.9655807, 'binary_precision': 0.8411311, 'binary_recall': 0.7567068, 'binary_specificity': 0.98542315, 'binary_f1_score': 0.7966885}
confusion matrix:
       0     1
0  41778   618
1   1052  3272
---- Validation: 
scalar performance:
{'acc': 0.95533615, 'precision': 0.6211238, 'recall': 0.5662728, 'specificity': 0.5662728, 'f1': 0.5841691, 'auroc': 0.71041393, 'binary_precision': 0.27348065, 'binary_recall': 0.14710252, 'binary_specificity': 0.98544306, 'binary_f1_score': 0.19130433}
confusion matrix:
       0    1
0  17804  263
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.74817395, 'recall': 0.75637597, 'specificity': 0.75637597, 'f1': 0.75219864, 'auroc': 0.8393594, 'binary_precision': 0.51672864, 'binary_recall': 0.5346154, 'binary_specificity': 0.97813654, 'binary_f1_score': 0.52551985}
confusion matrix:
      0    1
0  5816  130
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_19.png
early stop counter: 17
val acc:0.9553361535072327, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 19,now: 2024-06-20 12:50:59.547007,epoch time: 0:17:58.237289,used: 5:37:24.500553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9673373, 'precision': 0.9180728, 'recall': 0.88068104, 'specificity': 0.88068104, 'f1': 0.89826906, 'auroc': 0.9690844, 'binary_precision': 0.8589382, 'binary_recall': 0.77433527, 'binary_specificity': 0.98702675, 'binary_f1_score': 0.81444556}
confusion matrix:
       0     1
0  41845   550
1    976  3349
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.62330866, 'recall': 0.5650913, 'specificity': 0.5650913, 'f1': 0.5835564, 'auroc': 0.7178216, 'binary_precision': 0.27793697, 'binary_recall': 0.14413075, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.18982388}
confusion matrix:
       0    1
0  17815  252
1    576   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7561991, 'recall': 0.7533707, 'specificity': 0.7533707, 'f1': 0.75477594, 'auroc': 0.8433996, 'binary_precision': 0.5330739, 'binary_recall': 0.52692306, 'binary_specificity': 0.97981834, 'binary_f1_score': 0.52998066}
confusion matrix:
      0    1
0  5826  120
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_20.png
early stop counter: 18
val acc:0.9558164477348328, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 20,now: 2024-06-20 13:09:00.693802,epoch time: 0:18:01.146795,used: 5:55:25.647348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9651541, 'precision': 0.9098402, 'recall': 0.87561005, 'specificity': 0.87561005, 'f1': 0.89177823, 'auroc': 0.9662303, 'binary_precision': 0.843352, 'binary_recall': 0.7657262, 'binary_specificity': 0.9854939, 'binary_f1_score': 0.8026667}
confusion matrix:
       0     1
0  41781   615
1   1013  3311
---- Validation: 
scalar performance:
{'acc': 0.9546425, 'precision': 0.62200695, 'recall': 0.57235044, 'specificity': 0.57235044, 'f1': 0.589642, 'auroc': 0.7122219, 'binary_precision': 0.27480915, 'binary_recall': 0.16047548, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.20262663}
confusion matrix:
       0    1
0  17782  285
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7445258, 'recall': 0.76155657, 'specificity': 0.76155657, 'f1': 0.7527122, 'auroc': 0.84200704, 'binary_precision': 0.50896055, 'binary_recall': 0.54615384, 'binary_specificity': 0.9769593, 'binary_f1_score': 0.52690166}
confusion matrix:
      0    1
0  5809  137
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_21.png
early stop counter: 19
val acc:0.9546424746513367, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 21,now: 2024-06-20 13:29:20.766264,epoch time: 0:20:20.072462,used: 6:15:45.719810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9683861, 'precision': 0.91743684, 'recall': 0.889021, 'specificity': 0.889021, 'f1': 0.9025937, 'auroc': 0.9699129, 'binary_precision': 0.855964, 'binary_recall': 0.7916281, 'binary_specificity': 0.98641384, 'binary_f1_score': 0.8225399}
confusion matrix:
       0     1
0  41820   576
1    901  3423
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.62958175, 'recall': 0.572244, 'specificity': 0.572244, 'f1': 0.5913254, 'auroc': 0.71302086, 'binary_precision': 0.2899729, 'binary_recall': 0.1589896, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.20537427}
confusion matrix:
       0    1
0  17805  262
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.7664723, 'recall': 0.7615676, 'specificity': 0.7615676, 'f1': 0.763994, 'auroc': 0.84070367, 'binary_precision': 0.5529412, 'binary_recall': 0.5423077, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.5475728}
confusion matrix:
      0    1
0  5832  114
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_22.png
early stop counter: 20
val acc:0.9558164477348328, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 22,now: 2024-06-20 13:49:19.637499,epoch time: 0:19:58.871235,used: 6:35:44.591045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96791524, 'precision': 0.9116435, 'recall': 0.89368725, 'specificity': 0.89368725, 'f1': 0.9024103, 'auroc': 0.9711764, 'binary_precision': 0.8433325, 'binary_recall': 0.802589, 'binary_specificity': 0.98478556, 'binary_f1_score': 0.82245654}
confusion matrix:
       0     1
0  41749   645
1    854  3472
---- Validation: 
scalar performance:
{'acc': 0.9554429, 'precision': 0.62566733, 'recall': 0.57061976, 'specificity': 0.57061976, 'f1': 0.5890197, 'auroc': 0.72763216, 'binary_precision': 0.28225806, 'binary_recall': 0.15601783, 'binary_specificity': 0.9852217, 'binary_f1_score': 0.20095694}
confusion matrix:
       0    1
0  17800  267
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.76716864, 'recall': 0.76716864, 'specificity': 0.76716864, 'f1': 0.76716864, 'auroc': 0.8487606, 'binary_precision': 0.5538462, 'binary_recall': 0.5538462, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.5538462}
confusion matrix:
      0    1
0  5830  116
1   116  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_23.png
early stop counter: 21
val acc:0.9554429054260254, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 23,now: 2024-06-20 14:14:39.422212,epoch time: 0:25:19.784713,used: 7:01:04.375758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96999145, 'precision': 0.92158675, 'recall': 0.89512014, 'specificity': 0.89512014, 'f1': 0.9078096, 'auroc': 0.97335637, 'binary_precision': 0.8631056, 'binary_recall': 0.803237, 'binary_specificity': 0.9870032, 'binary_f1_score': 0.8320958}
confusion matrix:
       0     1
0  41844   551
1    851  3474
---- Validation: 
scalar performance:
{'acc': 0.95533615, 'precision': 0.63448143, 'recall': 0.5827239, 'specificity': 0.5827239, 'f1': 0.6013609, 'auroc': 0.7341967, 'binary_precision': 0.2990196, 'binary_recall': 0.18127786, 'binary_specificity': 0.98417, 'binary_f1_score': 0.22571693}
confusion matrix:
       0    1
0  17781  286
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.76114714, 'recall': 0.76114714, 'specificity': 0.76114714, 'f1': 0.76114714, 'auroc': 0.8500918, 'binary_precision': 0.5423077, 'binary_recall': 0.5423077, 'binary_specificity': 0.97998655, 'binary_f1_score': 0.5423077}
confusion matrix:
      0    1
0  5827  119
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_24.png
early stop counter: 22
val acc:0.9553361535072327, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 24,now: 2024-06-20 14:42:01.687000,epoch time: 0:27:22.264788,used: 7:28:26.640546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9670805, 'precision': 0.9128314, 'recall': 0.8856809, 'specificity': 0.8856809, 'f1': 0.8986697, 'auroc': 0.97325414, 'binary_precision': 0.8473435, 'binary_recall': 0.7857969, 'binary_specificity': 0.985565, 'binary_f1_score': 0.81541055}
confusion matrix:
       0     1
0  41785   612
1    926  3397
---- Validation: 
scalar performance:
{'acc': 0.95538956, 'precision': 0.62826836, 'recall': 0.5741684, 'specificity': 0.5741684, 'f1': 0.5926907, 'auroc': 0.7305342, 'binary_precision': 0.28720626, 'binary_recall': 0.16344725, 'binary_specificity': 0.98488957, 'binary_f1_score': 0.20833333}
confusion matrix:
       0    1
0  17794  273
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76539063, 'recall': 0.76148343, 'specificity': 0.76148343, 'f1': 0.7634206, 'auroc': 0.84552723, 'binary_precision': 0.55078125, 'binary_recall': 0.5423077, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.54651165}
confusion matrix:
      0    1
0  5831  115
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_25.png
early stop counter: 23
val acc:0.9553895592689514, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 25,now: 2024-06-20 15:09:51.589284,epoch time: 0:27:49.902284,used: 7:56:16.542830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97099745, 'precision': 0.92244875, 'recall': 0.90117645, 'specificity': 0.90117645, 'f1': 0.91146386, 'auroc': 0.97362864, 'binary_precision': 0.8636141, 'binary_recall': 0.8154913, 'binary_specificity': 0.98686165, 'binary_f1_score': 0.8388631}
confusion matrix:
       0     1
0  41838   557
1    798  3527
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.6497484, 'recall': 0.5817128, 'specificity': 0.5817128, 'f1': 0.60416675, 'auroc': 0.7429504, 'binary_precision': 0.32963988, 'binary_recall': 0.1768202, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.23017408}
confusion matrix:
       0    1
0  17825  242
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7906179, 'recall': 0.7670114, 'specificity': 0.7670114, 'f1': 0.7782515, 'auroc': 0.85687274, 'binary_precision': 0.60084033, 'binary_recall': 0.55, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.57429725}
confusion matrix:
      0    1
0  5851   95
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_26.png
new oracle model saved
early stop counter: 24
val acc:0.9575240015983582, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9658395051956177
after epoch: 26,now: 2024-06-20 15:32:07.883495,epoch time: 0:22:16.294211,used: 8:18:32.837041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96956336, 'precision': 0.91420007, 'recall': 0.90210974, 'specificity': 0.90210974, 'f1': 0.90804076, 'auroc': 0.9754994, 'binary_precision': 0.8467607, 'binary_recall': 0.81933844, 'binary_specificity': 0.984881, 'binary_f1_score': 0.83282393}
confusion matrix:
       0     1
0  41756   641
1    781  3542
---- Validation: 
scalar performance:
{'acc': 0.95490927, 'precision': 0.63659793, 'recall': 0.5896552, 'specificity': 0.5896552, 'f1': 0.6074097, 'auroc': 0.75190115, 'binary_precision': 0.3027523, 'binary_recall': 0.1961367, 'binary_specificity': 0.9831737, 'binary_f1_score': 0.2380523}
confusion matrix:
       0    1
0  17763  304
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.77610505, 'recall': 0.77712035, 'specificity': 0.77712035, 'f1': 0.7766116, 'auroc': 0.8635359, 'binary_precision': 0.57088125, 'binary_recall': 0.5730769, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.571977}
confusion matrix:
      0    1
0  5834  112
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_27.png
early stop counter: 25
val acc:0.9549092650413513, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9658395051956177
after epoch: 27,now: 2024-06-20 15:55:26.872127,epoch time: 0:23:18.988632,used: 8:41:51.825673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.90220034, 'recall': 0.91019684, 'specificity': 0.91019684, 'f1': 0.90614796, 'auroc': 0.9768995, 'binary_precision': 0.820855, 'binary_recall': 0.83907515, 'binary_specificity': 0.98131853, 'binary_f1_score': 0.82986504}
confusion matrix:
       0     1
0  41603   792
1    696  3629
---- Validation: 
scalar performance:
{'acc': 0.95298827, 'precision': 0.6293022, 'recall': 0.59509635, 'specificity': 0.59509635, 'f1': 0.60910887, 'auroc': 0.7516104, 'binary_precision': 0.2877551, 'binary_recall': 0.20950966, 'binary_specificity': 0.980683, 'binary_f1_score': 0.24247636}
confusion matrix:
       0    1
0  17718  349
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.75559425, 'recall': 0.7901504, 'specificity': 0.7901504, 'f1': 0.77161837, 'auroc': 0.86698943, 'binary_precision': 0.5286195, 'binary_recall': 0.60384613, 'binary_specificity': 0.97645473, 'binary_f1_score': 0.56373435}
confusion matrix:
      0    1
0  5806  140
1   103  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_28.png
early stop counter: 26
val acc:0.9529882669448853, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9658395051956177
after epoch: 28,now: 2024-06-20 16:20:23.943147,epoch time: 0:24:57.071020,used: 9:06:48.896693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9670591, 'precision': 0.9018909, 'recall': 0.90214115, 'specificity': 0.90214115, 'f1': 0.9020159, 'auroc': 0.9740455, 'binary_precision': 0.8218988, 'binary_recall': 0.8224688, 'binary_specificity': 0.9818135, 'binary_f1_score': 0.8221837}
confusion matrix:
       0     1
0  41623   771
1    768  3558
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.63075536, 'recall': 0.5911922, 'specificity': 0.5911922, 'f1': 0.6068055, 'auroc': 0.73501843, 'binary_precision': 0.29094827, 'binary_recall': 0.20059435, 'binary_specificity': 0.98179, 'binary_f1_score': 0.237467}
confusion matrix:
       0    1
0  17738  329
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76418626, 'recall': 0.78355134, 'specificity': 0.78355134, 'f1': 0.77347815, 'auroc': 0.85678864, 'binary_precision': 0.54642856, 'binary_recall': 0.5884615, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.56666666}
confusion matrix:
      0    1
0  5819  127
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_29.png
early stop counter: 27
val acc:0.9537353515625, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9658395051956177
after epoch: 29,now: 2024-06-20 16:47:43.611667,epoch time: 0:27:19.668520,used: 9:34:08.565213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.967637, 'precision': 0.9059626, 'recall': 0.9000516, 'specificity': 0.9000516, 'f1': 0.9029793, 'auroc': 0.97340214, 'binary_precision': 0.8305523, 'binary_recall': 0.8171098, 'binary_specificity': 0.9829933, 'binary_f1_score': 0.8237762}
confusion matrix:
       0     1
0  41674   721
1    791  3534
---- Validation: 
scalar performance:
{'acc': 0.95357525, 'precision': 0.6268827, 'recall': 0.58681756, 'specificity': 0.58681756, 'f1': 0.60239536, 'auroc': 0.7404879, 'binary_precision': 0.2835165, 'binary_recall': 0.19167905, 'binary_specificity': 0.98195606, 'binary_f1_score': 0.2287234}
confusion matrix:
       0    1
0  17741  326
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7538806, 'recall': 0.77527034, 'specificity': 0.77527034, 'f1': 0.7640805, 'auroc': 0.85818064, 'binary_precision': 0.5265018, 'binary_recall': 0.5730769, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.548803}
confusion matrix:
      0    1
0  5812  134
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_30.png
early stop counter: 28
val acc:0.9535752534866333, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9581050872802734 / 0.9658395051956177
after epoch: 30,now: 2024-06-20 17:16:18.677996,epoch time: 0:28:35.066329,used: 10:02:43.631542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_07_13_35_seed_1_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:02:43.631542 at 2024-06-20 17:16:18.677996
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2369872, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9658395, 'precision': 0.7906179, 'recall': 0.7670114, 'specificity': 0.7670114, 'f1': 0.7782515, 'auroc': 0.85687274, 'binary_precision': 0.60084033, 'binary_recall': 0.55, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.57429725}
confusion matrix:
      0    1
0  5851   95
1   117  143
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   3084 MiB |   1282 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   2978 MiB |   1250 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 626014 GiB | 626014 GiB |
|       from large pool | 397312 KiB |    899 MiB | 625765 GiB | 625765 GiB |
|       from small pool |   6849 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   25228 K  |   25226 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17167 K  |   17166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   25228 K  |   25226 K  |
|       from large pool |      36    |      76    |    8060 K  |    8060 K  |
|       from small pool |    1158    |    1780    |   17167 K  |   17166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      69    |      20    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |     382    |   14477 K  |   14477 K  |
|       from large pool |       5    |      11    |    3213 K  |    3213 K  |
|       from small pool |      44    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625765 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25228 K  |   25227 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17167 K  |   17167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25228 K  |   25227 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17167 K  |   17167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   3084 MiB |   2490 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   2978 MiB |   2426 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 626015 GiB | 626014 GiB |
|       from large pool | 384768 KiB |    899 MiB | 625765 GiB | 625765 GiB |
|       from small pool |      0 KiB |     14 MiB |    249 GiB |    249 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   25228 K  |   25227 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17167 K  |   17167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   25228 K  |   25227 K  |
|       from large pool |       2    |      76    |    8060 K  |    8060 K  |
|       from small pool |       0    |    1780    |   17167 K  |   17167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      69    |      39    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     382    |   14477 K  |   14477 K  |
|       from large pool |       1    |      11    |    3213 K  |    3213 K  |
|       from small pool |       0    |     377    |   11264 K  |   11264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109

 Experiment start at: 2024-06-20 17:27:39.540496
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.5055673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3348517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2741977, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-20 17:50:06.125189,epoch time: 0:22:26.584693,used: 0:22:26.584693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.73041433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.37909806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.41983113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-20 18:12:14.854355,epoch time: 0:22:08.729166,used: 0:44:35.313859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9047985, 'precision': 0.91940373, 'recall': 0.5092924, 'specificity': 0.5092924, 'f1': 0.49332094, 'auroc': 0.84234166, 'binary_precision': 0.93406594, 'binary_recall': 0.018726591, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.03671706}
confusion matrix:
       0   1
0  42303   6
1   4454  85
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.43252364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.55559254, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_3.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-20 18:31:52.378991,epoch time: 0:19:37.524636,used: 1:04:12.838495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9193989, 'precision': 0.93726563, 'recall': 0.58768785, 'specificity': 0.58768785, 'f1': 0.6274327, 'auroc': 0.8884746, 'binary_precision': 0.9557945, 'binary_recall': 0.17625028, 'binary_specificity': 0.9991255, 'binary_f1_score': 0.29761904}
confusion matrix:
       0    1
0  42272   37
1   3739  800
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.4839578, 'recall': 0.49972484, 'specificity': 0.49972484, 'f1': 0.49171495, 'auroc': 0.48976916, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18161  10
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.6405165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_4.png
early stop counter: 3
val acc:0.9674000144004822, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-20 18:55:22.654333,epoch time: 0:23:30.275342,used: 1:27:43.113837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9373506, 'precision': 0.94589746, 'recall': 0.6843903, 'specificity': 0.6843903, 'f1': 0.75023526, 'auroc': 0.91338396, 'binary_precision': 0.9551391, 'binary_recall': 0.37064785, 'binary_specificity': 0.9981328, 'binary_f1_score': 0.53405297}
confusion matrix:
       0     1
0  42231    79
1   2856  1682
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.48393723, 'recall': 0.49906445, 'specificity': 0.49906445, 'f1': 0.49138442, 'auroc': 0.5196352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18137  34
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.85009307, 'recall': 0.5285087, 'specificity': 0.5285087, 'f1': 0.5441039, 'auroc': 0.69311327, 'binary_precision': 0.7368421, 'binary_recall': 0.05785124, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.107279696}
confusion matrix:
      0   1
0  5992   5
1   228  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_5.png
new oracle model saved
early stop counter: 4
val acc:0.9661215543746948, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9626542925834656
after epoch: 5,now: 2024-06-20 19:19:26.577069,epoch time: 0:24:03.922736,used: 1:51:47.036573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9468921, 'precision': 0.94668335, 'recall': 0.7380265, 'specificity': 0.7380265, 'f1': 0.8037003, 'auroc': 0.92809606, 'binary_precision': 0.9464519, 'binary_recall': 0.47896013, 'binary_specificity': 0.99709284, 'binary_f1_score': 0.63604444}
confusion matrix:
       0     1
0  42186   123
1   2365  2174
---- Validation: 
scalar performance:
{'acc': 0.96516275, 'precision': 0.49320605, 'recall': 0.49937218, 'specificity': 0.49937218, 'f1': 0.4926602, 'auroc': 0.5768775, 'binary_precision': 0.018518519, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.0030487804}
confusion matrix:
       0   1
0  18118  53
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.8004174, 'recall': 0.5665977, 'specificity': 0.5665977, 'f1': 0.60288835, 'auroc': 0.7372412, 'binary_precision': 0.63461536, 'binary_recall': 0.13636364, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.22448981}
confusion matrix:
      0   1
0  5978  19
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_6.png
new oracle model saved
early stop counter: 5
val acc:0.9651627540588379, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9634556770324707
after epoch: 6,now: 2024-06-20 19:42:21.633892,epoch time: 0:22:55.056823,used: 2:14:42.093396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94960296, 'precision': 0.9315771, 'recall': 0.7630303, 'specificity': 0.7630303, 'f1': 0.8220991, 'auroc': 0.930251, 'binary_precision': 0.91125375, 'binary_recall': 0.5316149, 'binary_specificity': 0.9944456, 'binary_f1_score': 0.67149013}
confusion matrix:
       0     1
0  42074   235
1   2126  2413
---- Validation: 
scalar performance:
{'acc': 0.9632451, 'precision': 0.49481046, 'recall': 0.49918464, 'specificity': 0.49918464, 'f1': 0.49352008, 'auroc': 0.5822133, 'binary_precision': 0.02173913, 'binary_recall': 0.003322259, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.005763689}
confusion matrix:
       0   1
0  18081  90
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.77583796, 'recall': 0.6063359, 'specificity': 0.6063359, 'f1': 0.6498138, 'auroc': 0.7437837, 'binary_precision': 0.5824176, 'binary_recall': 0.21900827, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.3183183}
confusion matrix:
      0   1
0  5959  38
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_7.png
new oracle model saved
early stop counter: 6
val acc:0.9632450938224792, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9636159539222717
after epoch: 7,now: 2024-06-20 20:03:45.728097,epoch time: 0:21:24.094205,used: 2:36:06.187601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9535946, 'precision': 0.9321238, 'recall': 0.78687465, 'specificity': 0.78687465, 'f1': 0.84129584, 'auroc': 0.9368279, 'binary_precision': 0.90761805, 'binary_recall': 0.5800837, 'binary_specificity': 0.99366564, 'binary_f1_score': 0.7077957}
confusion matrix:
       0     1
0  42041   268
1   1906  2633
---- Validation: 
scalar performance:
{'acc': 0.9630853, 'precision': 0.536363, 'recall': 0.5071326, 'specificity': 0.5071326, 'f1': 0.50732803, 'auroc': 0.6059443, 'binary_precision': 0.104347825, 'binary_recall': 0.019933555, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.033472802}
confusion matrix:
       0    1
0  18068  103
1    590   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8023318, 'recall': 0.6291465, 'specificity': 0.6291465, 'f1': 0.6777302, 'auroc': 0.75897527, 'binary_precision': 0.63366336, 'binary_recall': 0.2644628, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.37317783}
confusion matrix:
      0   1
0  5960  37
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_8.png
new oracle model saved
early stop counter: 7
val acc:0.9630852937698364, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9655393362045288
after epoch: 8,now: 2024-06-20 20:23:48.532441,epoch time: 0:20:02.804344,used: 2:56:08.991945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9556011, 'precision': 0.93434596, 'recall': 0.7974261, 'specificity': 0.7974261, 'f1': 0.8499615, 'auroc': 0.94552124, 'binary_precision': 0.90997, 'binary_recall': 0.6012338, 'binary_specificity': 0.99361837, 'binary_f1_score': 0.72406477}
confusion matrix:
       0     1
0  42039   270
1   1810  2729
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.562139, 'recall': 0.5170219, 'specificity': 0.5170219, 'f1': 0.52307343, 'auroc': 0.644183, 'binary_precision': 0.1552795, 'binary_recall': 0.04152824, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.0655308}
confusion matrix:
       0    1
0  18035  136
1    577   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.7858137, 'recall': 0.6728502, 'specificity': 0.6728502, 'f1': 0.7139491, 'auroc': 0.7878636, 'binary_precision': 0.5972222, 'binary_recall': 0.3553719, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.44559586}
confusion matrix:
      0   1
0  5939  58
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_9.png
new oracle model saved
early stop counter: 8
val acc:0.9620199203491211, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 9,now: 2024-06-20 20:45:31.622788,epoch time: 0:21:43.090347,used: 3:17:52.082292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95645493, 'precision': 0.92808354, 'recall': 0.8078309, 'specificity': 0.8078309, 'f1': 0.8556714, 'auroc': 0.94381225, 'binary_precision': 0.8952863, 'binary_recall': 0.6234853, 'binary_specificity': 0.9921766, 'binary_f1_score': 0.73506486}
confusion matrix:
       0     1
0  41978   331
1   1709  2830
---- Validation: 
scalar performance:
{'acc': 0.96132743, 'precision': 0.55837727, 'recall': 0.51746726, 'specificity': 0.51746726, 'f1': 0.52354634, 'auroc': 0.6221672, 'binary_precision': 0.14772727, 'binary_recall': 0.04318937, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.06683805}
confusion matrix:
       0    1
0  18021  150
1    576   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.76640236, 'recall': 0.67201644, 'specificity': 0.67201644, 'f1': 0.7079017, 'auroc': 0.76593804, 'binary_precision': 0.5584416, 'binary_recall': 0.3553719, 'binary_specificity': 0.988661, 'binary_f1_score': 0.43434343}
confusion matrix:
      0   1
0  5929  68
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_10.png
early stop counter: 9
val acc:0.9613274335861206, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 10,now: 2024-06-20 21:05:32.663219,epoch time: 0:20:01.040431,used: 3:37:53.122723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9326256, 'recall': 0.8156563, 'specificity': 0.8156563, 'f1': 0.86270857, 'auroc': 0.9473281, 'binary_precision': 0.902834, 'binary_recall': 0.63868695, 'binary_specificity': 0.99262565, 'binary_f1_score': 0.748129}
confusion matrix:
       0     1
0  41997   312
1   1640  2899
---- Validation: 
scalar performance:
{'acc': 0.9613807, 'precision': 0.57199275, 'recall': 0.5231161, 'specificity': 0.5231161, 'f1': 0.5318567, 'auroc': 0.6415523, 'binary_precision': 0.17460318, 'binary_recall': 0.054817274, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.08343868}
confusion matrix:
       0    1
0  18015  156
1    569   33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.75761867, 'recall': 0.6915104, 'specificity': 0.6915104, 'f1': 0.7191171, 'auroc': 0.78231263, 'binary_precision': 0.53932583, 'binary_recall': 0.3966942, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.45714286}
confusion matrix:
      0   1
0  5915  82
1   146  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_11.png
early stop counter: 10
val acc:0.9613807201385498, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 11,now: 2024-06-20 21:24:31.360093,epoch time: 0:18:58.696874,used: 3:56:51.819597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96014774, 'precision': 0.91582245, 'recall': 0.8438023, 'specificity': 0.8438023, 'f1': 0.87547326, 'auroc': 0.9549439, 'binary_precision': 0.8632409, 'binary_recall': 0.6994933, 'binary_specificity': 0.98811126, 'binary_f1_score': 0.77278817}
confusion matrix:
       0     1
0  41806   503
1   1364  3175
---- Validation: 
scalar performance:
{'acc': 0.95930326, 'precision': 0.5851916, 'recall': 0.53890693, 'specificity': 0.53890693, 'f1': 0.5515105, 'auroc': 0.68735933, 'binary_precision': 0.2, 'binary_recall': 0.089701, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.123853214}
confusion matrix:
       0    1
0  17955  216
1    548   54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.76407105, 'recall': 0.719769, 'specificity': 0.719769, 'f1': 0.73964643, 'auroc': 0.8080516, 'binary_precision': 0.55, 'binary_recall': 0.45454547, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.49773756}
confusion matrix:
      0    1
0  5907   90
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_12.png
early stop counter: 11
val acc:0.9593032598495483, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 12,now: 2024-06-20 21:42:58.137045,epoch time: 0:18:26.776952,used: 4:15:18.596549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96142846, 'precision': 0.9307698, 'recall': 0.8367426, 'specificity': 0.8367426, 'f1': 0.8765054, 'auroc': 0.95675445, 'binary_precision': 0.8947977, 'binary_recall': 0.68208855, 'binary_specificity': 0.9913966, 'binary_f1_score': 0.7740967}
confusion matrix:
       0     1
0  41945   364
1   1443  3096
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.60533863, 'recall': 0.5408932, 'specificity': 0.5408932, 'f1': 0.55636644, 'auroc': 0.6812008, 'binary_precision': 0.24017467, 'binary_recall': 0.091362126, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.13237064}
confusion matrix:
       0    1
0  17997  174
1    547   55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.7771523, 'recall': 0.7105223, 'specificity': 0.7105223, 'f1': 0.73876476, 'auroc': 0.7984695, 'binary_precision': 0.5769231, 'binary_recall': 0.4338843, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.49528304}
confusion matrix:
      0    1
0  5920   77
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_13.png
early stop counter: 12
val acc:0.9615938067436218, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 13,now: 2024-06-20 22:01:15.799738,epoch time: 0:18:17.662693,used: 4:33:36.259242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9631361, 'precision': 0.91905534, 'recall': 0.86020756, 'specificity': 0.86020756, 'f1': 0.8867993, 'auroc': 0.9607054, 'binary_precision': 0.86633664, 'binary_recall': 0.7325402, 'binary_specificity': 0.9878749, 'binary_f1_score': 0.7938402}
confusion matrix:
       0     1
0  41796   513
1   1214  3325
---- Validation: 
scalar performance:
{'acc': 0.9552549, 'precision': 0.59370834, 'recall': 0.56572545, 'specificity': 0.56572545, 'f1': 0.5767366, 'auroc': 0.7177839, 'binary_precision': 0.215311, 'binary_recall': 0.14950167, 'binary_specificity': 0.98194927, 'binary_f1_score': 0.1764706}
confusion matrix:
       0    1
0  17843  328
1    512   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.7283705, 'recall': 0.7527069, 'specificity': 0.7527069, 'f1': 0.7398349, 'auroc': 0.83497465, 'binary_precision': 0.47583643, 'binary_recall': 0.5289256, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.50097847}
confusion matrix:
      0    1
0  5856  141
1   114  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_14.png
early stop counter: 13
val acc:0.9552549123764038, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 14,now: 2024-06-20 22:19:55.176795,epoch time: 0:18:39.377057,used: 4:52:15.636299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9656549, 'precision': 0.9227004, 'recall': 0.8727861, 'specificity': 0.8727861, 'f1': 0.8957443, 'auroc': 0.9683949, 'binary_precision': 0.8710413, 'binary_recall': 0.75760245, 'binary_specificity': 0.98796976, 'binary_f1_score': 0.8103713}
confusion matrix:
       0     1
0  41801   509
1   1100  3438
---- Validation: 
scalar performance:
{'acc': 0.957865, 'precision': 0.60658664, 'recall': 0.56546766, 'specificity': 0.56546766, 'f1': 0.5801909, 'auroc': 0.73170686, 'binary_precision': 0.24109589, 'binary_recall': 0.14617941, 'binary_specificity': 0.98475593, 'binary_f1_score': 0.18200621}
confusion matrix:
       0    1
0  17894  277
1    514   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7398316, 'recall': 0.73792887, 'specificity': 0.73792887, 'f1': 0.7388759, 'auroc': 0.82981837, 'binary_precision': 0.5, 'binary_recall': 0.49586776, 'binary_specificity': 0.97999, 'binary_f1_score': 0.4979253}
confusion matrix:
      0    1
0  5877  120
1   122  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_15.png
early stop counter: 14
val acc:0.9578649997711182, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 15,now: 2024-06-20 22:37:51.579247,epoch time: 0:17:56.402452,used: 5:10:12.038751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9224148, 'recall': 0.8677417, 'specificity': 0.8677417, 'f1': 0.8926666, 'auroc': 0.96635413, 'binary_precision': 0.87153137, 'binary_recall': 0.74730116, 'binary_specificity': 0.9881822, 'binary_f1_score': 0.8046495}
confusion matrix:
       0     1
0  41809   500
1   1147  3392
---- Validation: 
scalar performance:
{'acc': 0.95919675, 'precision': 0.6025316, 'recall': 0.5533068, 'specificity': 0.5533068, 'f1': 0.5686667, 'auroc': 0.71062404, 'binary_precision': 0.23376623, 'binary_recall': 0.11960133, 'binary_specificity': 0.98701227, 'binary_f1_score': 0.15824176}
confusion matrix:
       0    1
0  17935  236
1    530   72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.75183487, 'recall': 0.74082875, 'specificity': 0.74082875, 'f1': 0.74619293, 'auroc': 0.8204503, 'binary_precision': 0.52380955, 'binary_recall': 0.5, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.5116279}
confusion matrix:
      0    1
0  5887  110
1   121  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_16.png
early stop counter: 15
val acc:0.9591967463493347, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 16,now: 2024-06-20 22:56:02.278519,epoch time: 0:18:10.699272,used: 5:28:22.738023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96349895, 'precision': 0.912048, 'recall': 0.87132406, 'specificity': 0.87132406, 'f1': 0.89032745, 'auroc': 0.9634737, 'binary_precision': 0.84986395, 'binary_recall': 0.7569949, 'binary_specificity': 0.98565316, 'binary_f1_score': 0.8007457}
confusion matrix:
       0     1
0  41702   607
1   1103  3436
---- Validation: 
scalar performance:
{'acc': 0.957652, 'precision': 0.59752727, 'recall': 0.55732715, 'specificity': 0.55732715, 'f1': 0.57115674, 'auroc': 0.7013221, 'binary_precision': 0.2234957, 'binary_recall': 0.1295681, 'binary_specificity': 0.98508614, 'binary_f1_score': 0.16403785}
confusion matrix:
       0    1
0  17900  271
1    524   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7372628, 'recall': 0.74759245, 'specificity': 0.74759245, 'f1': 0.7423024, 'auroc': 0.8266916, 'binary_precision': 0.49407116, 'binary_recall': 0.5165289, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5050505}
confusion matrix:
      0    1
0  5869  128
1   117  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_17.png
early stop counter: 16
val acc:0.9576519727706909, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 17,now: 2024-06-20 23:14:54.285074,epoch time: 0:18:52.006555,used: 5:47:14.744578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96507853, 'precision': 0.9239098, 'recall': 0.86757666, 'specificity': 0.86757666, 'f1': 0.8931893, 'auroc': 0.96720386, 'binary_precision': 0.8745806, 'binary_recall': 0.7466402, 'binary_specificity': 0.9885131, 'binary_f1_score': 0.80556214}
confusion matrix:
       0     1
0  41823   486
1   1150  3389
---- Validation: 
scalar performance:
{'acc': 0.95925, 'precision': 0.6011098, 'recall': 0.55172825, 'specificity': 0.55172825, 'f1': 0.56690896, 'auroc': 0.7111161, 'binary_precision': 0.2310231, 'binary_recall': 0.11627907, 'binary_specificity': 0.9871774, 'binary_f1_score': 0.15469614}
confusion matrix:
       0    1
0  17938  233
1    532   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.75652367, 'recall': 0.7391795, 'specificity': 0.7391795, 'f1': 0.74750966, 'auroc': 0.8286747, 'binary_precision': 0.53333336, 'binary_recall': 0.49586776, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.51391864}
confusion matrix:
      0    1
0  5892  105
1   122  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_18.png
early stop counter: 17
val acc:0.9592499732971191, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 18,now: 2024-06-20 23:33:24.889508,epoch time: 0:18:30.604434,used: 6:05:45.349012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96375513, 'precision': 0.91604334, 'recall': 0.868024, 'specificity': 0.868024, 'f1': 0.89015245, 'auroc': 0.9649181, 'binary_precision': 0.85862154, 'binary_recall': 0.74928397, 'binary_specificity': 0.9867641, 'binary_f1_score': 0.80023533}
confusion matrix:
       0     1
0  41749   560
1   1138  3401
---- Validation: 
scalar performance:
{'acc': 0.9577585, 'precision': 0.5981729, 'recall': 0.5573821, 'specificity': 0.5573821, 'f1': 0.57135755, 'auroc': 0.6940273, 'binary_precision': 0.22478387, 'binary_recall': 0.1295681, 'binary_specificity': 0.9851962, 'binary_f1_score': 0.16438356}
confusion matrix:
       0    1
0  17902  269
1    524   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.73260707, 'recall': 0.7491583, 'specificity': 0.7491583, 'f1': 0.7405585, 'auroc': 0.82129216, 'binary_precision': 0.4846154, 'binary_recall': 0.5206612, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.50199205}
confusion matrix:
      0    1
0  5863  134
1   116  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_19.png
early stop counter: 18
val acc:0.9577584862709045, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 19,now: 2024-06-20 23:57:55.276727,epoch time: 0:24:30.387219,used: 6:30:15.736231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9652066, 'precision': 0.91113293, 'recall': 0.88453823, 'specificity': 0.88453823, 'f1': 0.8972628, 'auroc': 0.97060573, 'binary_precision': 0.8452042, 'binary_recall': 0.78448653, 'binary_specificity': 0.98458993, 'binary_f1_score': 0.8137143}
confusion matrix:
       0     1
0  41658   652
1    978  3560
---- Validation: 
scalar performance:
{'acc': 0.9578118, 'precision': 0.61710227, 'recall': 0.5782889, 'specificity': 0.5782889, 'f1': 0.5931643, 'auroc': 0.72801125, 'binary_precision': 0.26130652, 'binary_recall': 0.17275748, 'binary_specificity': 0.9838204, 'binary_f1_score': 0.20799999}
confusion matrix:
       0    1
0  17877  294
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.7339386, 'recall': 0.7551899, 'specificity': 0.7551899, 'f1': 0.74403775, 'auroc': 0.8362115, 'binary_precision': 0.48679245, 'binary_recall': 0.53305787, 'binary_specificity': 0.977322, 'binary_f1_score': 0.5088758}
confusion matrix:
      0    1
0  5861  136
1   113  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_20.png
early stop counter: 19
val acc:0.9578117728233337, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 20,now: 2024-06-21 00:21:55.621200,epoch time: 0:24:00.344473,used: 6:54:16.080704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9653347, 'precision': 0.9089712, 'recall': 0.88856626, 'specificity': 0.88856626, 'f1': 0.89843154, 'auroc': 0.96874416, 'binary_precision': 0.8399813, 'binary_recall': 0.7933465, 'binary_specificity': 0.9837859, 'binary_f1_score': 0.81599814}
confusion matrix:
       0     1
0  41623   686
1    938  3601
---- Validation: 
scalar performance:
{'acc': 0.9577585, 'precision': 0.61739665, 'recall': 0.5790644, 'specificity': 0.5790644, 'f1': 0.5938357, 'auroc': 0.72922516, 'binary_precision': 0.26184538, 'binary_recall': 0.1744186, 'binary_specificity': 0.9837103, 'binary_f1_score': 0.20937188}
confusion matrix:
       0    1
0  17875  296
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.72296417, 'recall': 0.7659191, 'specificity': 0.7659191, 'f1': 0.7422745, 'auroc': 0.8395782, 'binary_precision': 0.46391752, 'binary_recall': 0.55785125, 'binary_specificity': 0.973987, 'binary_f1_score': 0.5065666}
confusion matrix:
      0    1
0  5841  156
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_21.png
early stop counter: 20
val acc:0.9577584862709045, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 21,now: 2024-06-21 00:45:21.184641,epoch time: 0:23:25.563441,used: 7:17:41.644145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9659537, 'precision': 0.91947633, 'recall': 0.8787801, 'specificity': 0.8787801, 'f1': 0.8977995, 'auroc': 0.96836066, 'binary_precision': 0.8632774, 'binary_recall': 0.7706543, 'binary_specificity': 0.9869059, 'binary_f1_score': 0.8143406}
confusion matrix:
       0     1
0  41755   554
1   1041  3498
---- Validation: 
scalar performance:
{'acc': 0.9586108, 'precision': 0.6106655, 'recall': 0.5650498, 'specificity': 0.5650498, 'f1': 0.58086646, 'auroc': 0.72297764, 'binary_precision': 0.24928367, 'binary_recall': 0.14451827, 'binary_specificity': 0.9855814, 'binary_f1_score': 0.18296531}
confusion matrix:
       0    1
0  17909  262
1    515   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.74753654, 'recall': 0.7563572, 'specificity': 0.7563572, 'f1': 0.7518594, 'auroc': 0.8360337, 'binary_precision': 0.5139442, 'binary_recall': 0.53305787, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.5233266}
confusion matrix:
      0    1
0  5875  122
1   113  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_22.png
early stop counter: 21
val acc:0.9586107730865479, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 22,now: 2024-06-21 01:12:47.319344,epoch time: 0:27:26.134703,used: 7:45:07.778848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9647584, 'precision': 0.9047448, 'recall': 0.8905853, 'specificity': 0.8905853, 'f1': 0.8975018, 'auroc': 0.9712206, 'binary_precision': 0.83100206, 'binary_recall': 0.7985897, 'binary_specificity': 0.98258096, 'binary_f1_score': 0.8144736}
confusion matrix:
       0     1
0  41573   737
1    914  3624
---- Validation: 
scalar performance:
{'acc': 0.9575987, 'precision': 0.6119327, 'recall': 0.57336056, 'specificity': 0.57336056, 'f1': 0.5879023, 'auroc': 0.7337573, 'binary_precision': 0.25128207, 'binary_recall': 0.1627907, 'binary_specificity': 0.9839304, 'binary_f1_score': 0.19758067}
confusion matrix:
       0    1
0  17879  292
1    504   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.741455, 'recall': 0.7538742, 'specificity': 0.7538742, 'f1': 0.74748766, 'auroc': 0.84005845, 'binary_precision': 0.5019608, 'binary_recall': 0.5289256, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.5150905}
confusion matrix:
      0    1
0  5870  127
1   114  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_23.png
early stop counter: 22
val acc:0.9575986862182617, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 23,now: 2024-06-21 01:41:50.495751,epoch time: 0:29:03.176407,used: 8:14:10.955255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9666581, 'precision': 0.9122573, 'recall': 0.8933308, 'specificity': 0.8933308, 'f1': 0.90250707, 'auroc': 0.97111917, 'binary_precision': 0.8456002, 'binary_recall': 0.80237937, 'binary_specificity': 0.9842823, 'binary_f1_score': 0.823423}
confusion matrix:
       0     1
0  41644   665
1    897  3642
---- Validation: 
scalar performance:
{'acc': 0.9580781, 'precision': 0.61621994, 'recall': 0.5752143, 'specificity': 0.5752143, 'f1': 0.5905537, 'auroc': 0.7296314, 'binary_precision': 0.25974026, 'binary_recall': 0.16611296, 'binary_specificity': 0.9843157, 'binary_f1_score': 0.20263425}
confusion matrix:
       0    1
0  17886  285
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7496216, 'recall': 0.7604894, 'specificity': 0.7604894, 'f1': 0.7549244, 'auroc': 0.8431771, 'binary_precision': 0.51778656, 'binary_recall': 0.5413223, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.52929294}
confusion matrix:
      0    1
0  5875  122
1   111  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_24.png
early stop counter: 23
val acc:0.9580780863761902, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 24,now: 2024-06-21 02:09:57.853251,epoch time: 0:28:07.357500,used: 8:42:18.312755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96586835, 'precision': 0.9098582, 'recall': 0.89112353, 'specificity': 0.89112353, 'f1': 0.90020776, 'auroc': 0.9719902, 'binary_precision': 0.8412256, 'binary_recall': 0.79841375, 'binary_specificity': 0.98383325, 'binary_f1_score': 0.8192608}
confusion matrix:
       0     1
0  41625   684
1    915  3624
---- Validation: 
scalar performance:
{'acc': 0.958451, 'precision': 0.6166543, 'recall': 0.5729978, 'specificity': 0.5729978, 'f1': 0.5889254, 'auroc': 0.7293138, 'binary_precision': 0.26075268, 'binary_recall': 0.16112956, 'binary_specificity': 0.984866, 'binary_f1_score': 0.19917864}
confusion matrix:
       0    1
0  17896  275
1    505   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7418205, 'recall': 0.76378787, 'specificity': 0.76378787, 'f1': 0.7522614, 'auroc': 0.84136426, 'binary_precision': 0.5018868, 'binary_recall': 0.5495868, 'binary_specificity': 0.977989, 'binary_f1_score': 0.5246548}
confusion matrix:
      0    1
0  5865  132
1   109  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_25.png
early stop counter: 24
val acc:0.958450973033905, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 25,now: 2024-06-21 02:37:38.162976,epoch time: 0:27:40.309725,used: 9:09:58.622480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96377647, 'precision': 0.90039617, 'recall': 0.8900417, 'specificity': 0.8900417, 'f1': 0.8951309, 'auroc': 0.9694462, 'binary_precision': 0.8223281, 'binary_recall': 0.7985897, 'binary_specificity': 0.9814937, 'binary_f1_score': 0.8102851}
confusion matrix:
       0     1
0  41527   783
1    914  3624
---- Validation: 
scalar performance:
{'acc': 0.9573323, 'precision': 0.61544764, 'recall': 0.57964736, 'specificity': 0.57964736, 'f1': 0.59367704, 'auroc': 0.7331068, 'binary_precision': 0.25790754, 'binary_recall': 0.17607974, 'binary_specificity': 0.98321503, 'binary_f1_score': 0.20927937}
confusion matrix:
       0    1
0  17866  305
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.732959, 'recall': 0.7669196, 'specificity': 0.7669196, 'f1': 0.7486211, 'auroc': 0.8431943, 'binary_precision': 0.48387095, 'binary_recall': 0.55785125, 'binary_specificity': 0.975988, 'binary_f1_score': 0.51823413}
confusion matrix:
      0    1
0  5853  144
1   107  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_26.png
early stop counter: 25
val acc:0.9573323130607605, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 26,now: 2024-06-21 03:04:57.038458,epoch time: 0:27:18.875482,used: 9:37:17.497962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9652493, 'precision': 0.8977701, 'recall': 0.9057282, 'specificity': 0.9057282, 'f1': 0.90169764, 'auroc': 0.9757669, 'binary_precision': 0.81361777, 'binary_recall': 0.8319013, 'binary_specificity': 0.9795552, 'binary_f1_score': 0.82265794}
confusion matrix:
       0     1
0  41444   865
1    763  3776
---- Validation: 
scalar performance:
{'acc': 0.9559474, 'precision': 0.62358874, 'recall': 0.60222036, 'specificity': 0.60222036, 'f1': 0.61171824, 'auroc': 0.756606, 'binary_precision': 0.27272728, 'binary_recall': 0.22425249, 'binary_specificity': 0.9801882, 'binary_f1_score': 0.2461258}
confusion matrix:
       0    1
0  17811  360
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.73868716, 'recall': 0.7753508, 'specificity': 0.7753508, 'f1': 0.7555276, 'auroc': 0.8537878, 'binary_precision': 0.49466193, 'binary_recall': 0.57438016, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.53154874}
confusion matrix:
      0    1
0  5855  142
1   103  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_27.png
early stop counter: 26
val acc:0.9559473991394043, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 27,now: 2024-06-21 03:31:29.765361,epoch time: 0:26:32.726903,used: 10:03:50.224865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96456623, 'precision': 0.8988199, 'recall': 0.89866304, 'specificity': 0.89866304, 'f1': 0.8987415, 'auroc': 0.97269636, 'binary_precision': 0.8172801, 'binary_recall': 0.81692004, 'binary_specificity': 0.98040605, 'binary_f1_score': 0.81710005}
confusion matrix:
       0     1
0  41480   829
1    831  3708
---- Validation: 
scalar performance:
{'acc': 0.9565333, 'precision': 0.61449146, 'recall': 0.5840529, 'specificity': 0.5840529, 'f1': 0.5965161, 'auroc': 0.7405257, 'binary_precision': 0.25570777, 'binary_recall': 0.18604651, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.21538463}
confusion matrix:
       0    1
0  17845  326
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.72357196, 'recall': 0.77186733, 'specificity': 0.77186733, 'f1': 0.7450153, 'auroc': 0.8484614, 'binary_precision': 0.46464646, 'binary_recall': 0.57024795, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.51205933}
confusion matrix:
      0    1
0  5838  159
1   104  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_28.png
early stop counter: 27
val acc:0.9565333127975464, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 28,now: 2024-06-21 03:59:12.914059,epoch time: 0:27:43.148698,used: 10:31:33.373563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.965847, 'precision': 0.9014105, 'recall': 0.9040924, 'specificity': 0.9040924, 'f1': 0.90274566, 'auroc': 0.975554, 'binary_precision': 0.82134265, 'binary_recall': 0.82749504, 'binary_specificity': 0.9806897, 'binary_f1_score': 0.8244074}
confusion matrix:
       0     1
0  41492   817
1    783  3756
---- Validation: 
scalar performance:
{'acc': 0.9560006, 'precision': 0.62037754, 'recall': 0.5966265, 'specificity': 0.5966265, 'f1': 0.6069732, 'auroc': 0.7525897, 'binary_precision': 0.26666668, 'binary_recall': 0.21262458, 'binary_specificity': 0.9806285, 'binary_f1_score': 0.2365989}
confusion matrix:
       0    1
0  17819  352
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7451254, 'recall': 0.77989995, 'specificity': 0.77989995, 'f1': 0.76120234, 'auroc': 0.85600376, 'binary_precision': 0.5071942, 'binary_recall': 0.58264464, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.5423077}
confusion matrix:
      0    1
0  5860  137
1   101  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_29.png
early stop counter: 28
val acc:0.9560006260871887, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 29,now: 2024-06-21 04:31:15.638915,epoch time: 0:32:02.724856,used: 11:03:36.098419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9651853, 'precision': 0.8959616, 'recall': 0.90844625, 'specificity': 0.90844625, 'f1': 0.9020771, 'auroc': 0.9730985, 'binary_precision': 0.8093617, 'binary_recall': 0.83807003, 'binary_specificity': 0.97882247, 'binary_f1_score': 0.82346576}
confusion matrix:
       0     1
0  41413   896
1    735  3804
---- Validation: 
scalar performance:
{'acc': 0.95408297, 'precision': 0.6094898, 'recall': 0.5932268, 'specificity': 0.5932268, 'f1': 0.60058045, 'auroc': 0.74335253, 'binary_precision': 0.24509804, 'binary_recall': 0.2076412, 'binary_specificity': 0.9788124, 'binary_f1_score': 0.22482014}
confusion matrix:
       0    1
0  17786  385
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.73308617, 'recall': 0.78071547, 'specificity': 0.78071547, 'f1': 0.7543744, 'auroc': 0.8517244, 'binary_precision': 0.4829932, 'binary_recall': 0.58677685, 'binary_specificity': 0.974654, 'binary_f1_score': 0.52985066}
confusion matrix:
      0    1
0  5845  152
1   100  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21512109_30.png
early stop counter: 29
val acc:0.9540829658508301, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9656996130943298
after epoch: 30,now: 2024-06-21 05:07:31.573794,epoch time: 0:36:15.934879,used: 11:39:52.033298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_20_17_27_39_seed_2_21512109
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:39:52.033298 at 2024-06-21 05:07:31.573794
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2741977, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9656996, 'precision': 0.7858137, 'recall': 0.6728502, 'specificity': 0.6728502, 'f1': 0.7139491, 'auroc': 0.7878636, 'binary_precision': 0.5972222, 'binary_recall': 0.3553719, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.44559586}
confusion matrix:
      0   1
0  5939  58
1   156  86
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_irm_resnet_different_bs128_lre4_classbalancing/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1243 TiB |   1243 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1242 TiB |   1242 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1802 MiB |   1876 MiB |   4292 MiB |   2490 MiB |
|       from large pool |   1728 MiB |   1802 MiB |   4154 MiB |   2426 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |    929 TiB |    929 TiB |
|       from large pool | 397312 KiB |    899 MiB |    929 TiB |    929 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   37854 K  |   37853 K  |
|       from large pool |      36    |      76    |   12094 K  |   12094 K  |
|       from small pool |    1158    |    1780    |   25760 K  |   25759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   37854 K  |   37853 K  |
|       from large pool |      36    |      76    |   12094 K  |   12094 K  |
|       from small pool |    1158    |    1780    |   25760 K  |   25759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      88    |      39    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |     383    |   21745 K  |   21745 K  |
|       from large pool |       5    |      11    |    4833 K  |    4833 K  |
|       from small pool |      43    |     378    |   16912 K  |   16912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1243 TiB |   1243 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1242 TiB |   1242 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   1876 MiB |   4292 MiB |   3698 MiB |
|       from large pool | 565248 KiB |   1802 MiB |   4154 MiB |   3602 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |    929 TiB |    929 TiB |
|       from large pool | 384768 KiB |    899 MiB |    929 TiB |    929 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   37854 K  |   37854 K  |
|       from large pool |       2    |      76    |   12094 K  |   12094 K  |
|       from small pool |       0    |    1780    |   25760 K  |   25760 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   37854 K  |   37854 K  |
|       from large pool |       2    |      76    |   12094 K  |   12094 K  |
|       from small pool |       0    |    1780    |   25760 K  |   25760 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      50    |      88    |      58    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     383    |   21745 K  |   21745 K  |
|       from large pool |       1    |      11    |    4833 K  |    4833 K  |
|       from small pool |       0    |     378    |   16912 K  |   16912 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 21 05:09:08 2024]
Finished job 0.
1 of 1 steps (100%) done
