Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753

 Experiment start at: 2024-05-29 13:38:03.316358
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.73334247, 'recall': 0.50459003, 'specificity': 0.50459003, 'f1': 0.50078356, 'auroc': 0.84169245, 'binary_precision': 0.5, 'binary_recall': 0.009510869, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.018666666}
confusion matrix:
       0   1
0  42306  14
1   1458  14
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.76079434, 'recall': 0.5037778, 'specificity': 0.5037778, 'f1': 0.49897707, 'auroc': 0.8199476, 'binary_precision': 0.5555556, 'binary_recall': 0.00777605, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.015337423}
confusion matrix:
       0  1
0  18145  4
1    638  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.81185675, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:04:25.453133,epoch time: 0:26:22.136775,used: 0:26:22.136775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7611219, 'recall': 0.5201412, 'specificity': 0.5201412, 'f1': 0.5300706, 'auroc': 0.900511, 'binary_precision': 0.55454546, 'binary_recall': 0.04144022, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.07711758}
confusion matrix:
       0   1
0  42271  49
1   1411  61
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7783411, 'recall': 0.51744413, 'specificity': 0.51744413, 'f1': 0.5251069, 'auroc': 0.89382327, 'binary_precision': 0.5897436, 'binary_recall': 0.035769828, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.06744868}
confusion matrix:
       0   1
0  18133  16
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.86690724, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:24:22.899113,epoch time: 0:19:57.445980,used: 0:46:19.582755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96734565, 'precision': 0.76037407, 'recall': 0.57721525, 'specificity': 0.57721525, 'f1': 0.61494327, 'auroc': 0.9177582, 'binary_precision': 0.5492958, 'binary_recall': 0.15896739, 'binary_specificity': 0.99546313, 'binary_f1_score': 0.24657536}
confusion matrix:
       0    1
0  42128  192
1   1238  234
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7731689, 'recall': 0.571944, 'specificity': 0.571944, 'f1': 0.60917205, 'auroc': 0.90902394, 'binary_precision': 0.57575756, 'binary_recall': 0.14774494, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.2351485}
confusion matrix:
       0   1
0  18079  70
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.88263977, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 14:44:59.534449,epoch time: 0:20:36.635336,used: 1:06:56.218091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96752834, 'precision': 0.751817, 'recall': 0.6545501, 'specificity': 0.6545501, 'f1': 0.6903861, 'auroc': 0.9231812, 'binary_precision': 0.5269663, 'binary_recall': 0.31904763, 'binary_specificity': 0.99005246, 'binary_f1_score': 0.39745763}
confusion matrix:
       0    1
0  41901  421
1   1001  469
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7371291, 'recall': 0.6447331, 'specificity': 0.6447331, 'f1': 0.67856973, 'auroc': 0.92164683, 'binary_precision': 0.498708, 'binary_recall': 0.30015552, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.37475726}
confusion matrix:
       0    1
0  17955  194
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.94001126, 'recall': 0.56296825, 'specificity': 0.56296825, 'f1': 0.60165864, 'auroc': 0.89704, 'binary_precision': 0.9166667, 'binary_recall': 0.12643678, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.22222224}
confusion matrix:
      0   1
0  5994   3
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.963087260723114
after epoch: 4,now: 2024-05-29 15:05:57.935746,epoch time: 0:20:58.401297,used: 1:27:54.619388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.7383254, 'recall': 0.6969606, 'specificity': 0.6969606, 'f1': 0.7154602, 'auroc': 0.9324503, 'binary_precision': 0.49710503, 'binary_recall': 0.40828803, 'binary_specificity': 0.98563325, 'binary_f1_score': 0.44834018}
confusion matrix:
       0    1
0  41712  608
1    871  601
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7322369, 'recall': 0.69085085, 'specificity': 0.69085085, 'f1': 0.7092874, 'auroc': 0.92957413, 'binary_precision': 0.4857143, 'binary_recall': 0.39657855, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.43664384}
confusion matrix:
       0    1
0  17879  270
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9367465, 'recall': 0.64301115, 'specificity': 0.64301115, 'f1': 0.71005416, 'auroc': 0.895741, 'binary_precision': 0.90361446, 'binary_recall': 0.28735632, 'binary_specificity': 0.998666, 'binary_f1_score': 0.4360465}
confusion matrix:
      0   1
0  5989   8
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 2
val acc:0.9649850726127625, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9689996838569641
after epoch: 5,now: 2024-05-29 15:27:53.890803,epoch time: 0:21:55.955057,used: 1:49:50.574445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672771, 'precision': 0.7480564, 'recall': 0.7224214, 'specificity': 0.7224214, 'f1': 0.73446393, 'auroc': 0.93743306, 'binary_precision': 0.5148289, 'binary_recall': 0.45991847, 'binary_specificity': 0.9849244, 'binary_f1_score': 0.48582706}
confusion matrix:
       0    1
0  41682  638
1    795  677
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7313724, 'recall': 0.6975187, 'specificity': 0.6975187, 'f1': 0.7129544, 'auroc': 0.93521726, 'binary_precision': 0.48351648, 'binary_recall': 0.41057542, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.44407067}
confusion matrix:
       0    1
0  17867  282
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.94616616, 'recall': 0.6565045, 'specificity': 0.6565045, 'f1': 0.7266415, 'auroc': 0.9118962, 'binary_precision': 0.92134833, 'binary_recall': 0.31417623, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.46857145}
confusion matrix:
      0   1
0  5990   7
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 3
val acc:0.964825451374054, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9702780246734619
after epoch: 6,now: 2024-05-29 15:48:17.651711,epoch time: 0:20:23.760908,used: 2:10:14.335353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9682362, 'precision': 0.7564001, 'recall': 0.72685194, 'specificity': 0.72685194, 'f1': 0.7406261, 'auroc': 0.936236, 'binary_precision': 0.5312259, 'binary_recall': 0.46807066, 'binary_specificity': 0.98563325, 'binary_f1_score': 0.49765262}
confusion matrix:
       0    1
0  41712  608
1    783  689
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7361067, 'recall': 0.7179906, 'specificity': 0.7179906, 'f1': 0.7266452, 'auroc': 0.93766403, 'binary_precision': 0.49155405, 'binary_recall': 0.4525661, 'binary_specificity': 0.98341507, 'binary_f1_score': 0.47125503}
confusion matrix:
       0    1
0  17848  301
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.94066334, 'recall': 0.6716634, 'specificity': 0.6716634, 'f1': 0.74259627, 'auroc': 0.92045194, 'binary_precision': 0.90909094, 'binary_recall': 0.3448276, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5}
confusion matrix:
      0   1
0  5988   9
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 4
val acc:0.9652511477470398, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9712368249893188
after epoch: 7,now: 2024-05-29 16:09:41.760705,epoch time: 0:21:24.108994,used: 2:31:38.444347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9665921, 'precision': 0.7427988, 'recall': 0.7455061, 'specificity': 0.7455061, 'f1': 0.7441441, 'auroc': 0.9428836, 'binary_precision': 0.50268817, 'binary_recall': 0.5084976, 'binary_specificity': 0.9825146, 'binary_f1_score': 0.5055762}
confusion matrix:
       0    1
0  41581  740
1    723  748
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7410735, 'recall': 0.74974084, 'specificity': 0.74974084, 'f1': 0.74532163, 'auroc': 0.943438, 'binary_precision': 0.49925038, 'binary_recall': 0.5178849, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.508397}
confusion matrix:
       0    1
0  17815  334
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.92541957, 'recall': 0.73604715, 'specificity': 0.73604715, 'f1': 0.8012942, 'auroc': 0.92414963, 'binary_precision': 0.87323946, 'binary_recall': 0.47509578, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6153846}
confusion matrix:
      0    1
0  5979   18
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 5
val acc:0.9657300710678101, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 8,now: 2024-05-29 16:36:24.131086,epoch time: 0:26:42.370381,used: 2:58:20.814728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96828187, 'precision': 0.7566552, 'recall': 0.7308099, 'specificity': 0.7308099, 'f1': 0.7429739, 'auroc': 0.94425607, 'binary_precision': 0.5314632, 'binary_recall': 0.4762228, 'binary_specificity': 0.985397, 'binary_f1_score': 0.50232893}
confusion matrix:
       0    1
0  41702  618
1    771  701
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7461723, 'recall': 0.7306251, 'specificity': 0.7306251, 'f1': 0.73811644, 'auroc': 0.9430198, 'binary_precision': 0.5108153, 'binary_recall': 0.47744945, 'binary_specificity': 0.98380077, 'binary_f1_score': 0.49356914}
confusion matrix:
       0    1
0  17855  294
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.93653035, 'recall': 0.70206463, 'specificity': 0.70206463, 'f1': 0.77280354, 'auroc': 0.91708964, 'binary_precision': 0.89830506, 'binary_recall': 0.40613025, 'binary_specificity': 0.997999, 'binary_f1_score': 0.55936676}
confusion matrix:
      0    1
0  5985   12
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 6
val acc:0.9664750695228577, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9752317070960999
after epoch: 9,now: 2024-05-29 16:56:48.531749,epoch time: 0:20:24.400663,used: 3:18:45.215391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.74793005, 'recall': 0.77129084, 'specificity': 0.77129084, 'f1': 0.7590245, 'auroc': 0.94468915, 'binary_precision': 0.5111524, 'binary_recall': 0.56122446, 'binary_specificity': 0.9813572, 'binary_f1_score': 0.53501946}
confusion matrix:
       0    1
0  41533  789
1    645  825
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74452865, 'recall': 0.76646245, 'specificity': 0.76646245, 'f1': 0.7549691, 'auroc': 0.9481287, 'binary_precision': 0.50497866, 'binary_recall': 0.5520995, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.5274889}
confusion matrix:
       0    1
0  17801  348
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.9375568, 'recall': 0.76111805, 'specificity': 0.76111805, 'f1': 0.8251337, 'auroc': 0.92418975, 'binary_precision': 0.89542484, 'binary_recall': 0.5249042, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6618357}
confusion matrix:
      0    1
0  5981   16
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 7
val acc:0.9661558270454407, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9776286482810974
after epoch: 10,now: 2024-05-29 17:17:10.317072,epoch time: 0:20:21.785323,used: 3:39:07.000714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.7512928, 'recall': 0.75837076, 'specificity': 0.75837076, 'f1': 0.7547771, 'auroc': 0.9474031, 'binary_precision': 0.5188119, 'binary_recall': 0.5339674, 'binary_specificity': 0.9827741, 'binary_f1_score': 0.5262806}
confusion matrix:
       0    1
0  41591  729
1    686  786
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7477869, 'recall': 0.7652103, 'specificity': 0.7652103, 'f1': 0.7561681, 'auroc': 0.94855744, 'binary_precision': 0.5115942, 'binary_recall': 0.5489891, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.5296324}
confusion matrix:
       0    1
0  17812  337
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.9515011, 'recall': 0.7367141, 'specificity': 0.7367141, 'f1': 0.8078602, 'auroc': 0.9302921, 'binary_precision': 0.92537314, 'binary_recall': 0.47509578, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.6278481}
confusion matrix:
      0    1
0  5987   10
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 8
val acc:0.9666347503662109, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9776286482810974
after epoch: 11,now: 2024-05-29 17:38:58.380737,epoch time: 0:21:48.063665,used: 4:00:55.064379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9679165, 'precision': 0.7529014, 'recall': 0.7742261, 'specificity': 0.7742261, 'f1': 0.7630836, 'auroc': 0.9487003, 'binary_precision': 0.52092445, 'binary_recall': 0.56657606, 'binary_specificity': 0.9818762, 'binary_f1_score': 0.5427921}
confusion matrix:
       0    1
0  41553  767
1    638  834
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7490607, 'recall': 0.78029406, 'specificity': 0.78029406, 'f1': 0.7636473, 'auroc': 0.95097107, 'binary_precision': 0.5130674, 'binary_recall': 0.5800933, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.54452556}
confusion matrix:
       0    1
0  17795  354
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.93420696, 'recall': 0.75911903, 'specificity': 0.75911903, 'f1': 0.82263565, 'auroc': 0.9346482, 'binary_precision': 0.8888889, 'binary_recall': 0.5210728, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.65700483}
confusion matrix:
      0    1
0  5980   17
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 9
val acc:0.9667943716049194, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9776286482810974
after epoch: 12,now: 2024-05-29 18:01:43.917949,epoch time: 0:22:45.537212,used: 4:23:40.601591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9691496, 'precision': 0.7615471, 'recall': 0.7866671, 'specificity': 0.7866671, 'f1': 0.7734676, 'auroc': 0.9512545, 'binary_precision': 0.5373688, 'binary_recall': 0.5910326, 'binary_specificity': 0.98230153, 'binary_f1_score': 0.5629247}
confusion matrix:
       0    1
0  41571  749
1    602  870
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75042117, 'recall': 0.76840335, 'specificity': 0.76840335, 'f1': 0.7590645, 'auroc': 0.95159644, 'binary_precision': 0.5166426, 'binary_recall': 0.55520993, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.5352324}
confusion matrix:
       0    1
0  17815  334
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.952544, 'recall': 0.7233876, 'specificity': 0.7233876, 'f1': 0.79601836, 'auroc': 0.929029, 'binary_precision': 0.9285714, 'binary_recall': 0.44827586, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.60465115}
confusion matrix:
      0    1
0  5988    9
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 10
val acc:0.9670072197914124, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9776286482810974
after epoch: 13,now: 2024-05-29 18:22:03.780140,epoch time: 0:20:19.862191,used: 4:44:00.463782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9690583, 'precision': 0.76049507, 'recall': 0.7946832, 'specificity': 0.7946832, 'f1': 0.77641827, 'auroc': 0.95502234, 'binary_precision': 0.534689, 'binary_recall': 0.6077498, 'binary_specificity': 0.9816167, 'binary_f1_score': 0.56888324}
confusion matrix:
       0    1
0  41543  778
1    577  894
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7490176, 'recall': 0.77654374, 'specificity': 0.77654374, 'f1': 0.76197517, 'auroc': 0.95209074, 'binary_precision': 0.51324964, 'binary_recall': 0.57231724, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.54117644}
confusion matrix:
       0    1
0  17800  349
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.94383407, 'recall': 0.74795824, 'specificity': 0.74795824, 'f1': 0.8158377, 'auroc': 0.9331479, 'binary_precision': 0.90909094, 'binary_recall': 0.49808428, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6435644}
confusion matrix:
      0    1
0  5984   13
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 11
val acc:0.9667943716049194, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9586129784584045 / 0.9776286482810974
after epoch: 14,now: 2024-05-29 18:47:03.320964,epoch time: 0:24:59.540824,used: 5:09:00.004606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.969926, 'precision': 0.7678959, 'recall': 0.7754468, 'specificity': 0.7754468, 'f1': 0.77161324, 'auroc': 0.9574445, 'binary_precision': 0.5508587, 'binary_recall': 0.5669612, 'binary_specificity': 0.9839323, 'binary_f1_score': 0.558794}
confusion matrix:
       0    1
0  41641  680
1    637  834
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.75628674, 'recall': 0.7628162, 'specificity': 0.7628162, 'f1': 0.75950575, 'auroc': 0.9541507, 'binary_precision': 0.52878785, 'binary_recall': 0.5427683, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.53568685}
confusion matrix:
       0    1
0  17838  311
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.9409351, 'recall': 0.73454833, 'specificity': 0.73454833, 'f1': 0.8035938, 'auroc': 0.9349239, 'binary_precision': 0.9044118, 'binary_recall': 0.47126436, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6196474}
confusion matrix:
      0    1
0  5984   13
1   138  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 15,now: 2024-05-29 19:06:49.972912,epoch time: 0:19:46.651948,used: 5:28:46.656554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9701772, 'precision': 0.76865304, 'recall': 0.7963788, 'specificity': 0.7963788, 'f1': 0.7817612, 'auroc': 0.95797384, 'binary_precision': 0.55092025, 'binary_recall': 0.6100544, 'binary_specificity': 0.9827032, 'binary_f1_score': 0.57898134}
confusion matrix:
       0    1
0  41588  732
1    574  898
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7536974, 'recall': 0.7889028, 'specificity': 0.7889028, 'f1': 0.77002466, 'auroc': 0.95538634, 'binary_precision': 0.5217391, 'binary_recall': 0.59720063, 'binary_specificity': 0.980605, 'binary_f1_score': 0.5569253}
confusion matrix:
       0    1
0  17797  352
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.92851114, 'recall': 0.77036315, 'specificity': 0.77036315, 'f1': 0.8299503, 'auroc': 0.93564284, 'binary_precision': 0.8765432, 'binary_recall': 0.5440613, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6713948}
confusion matrix:
      0    1
0  5977   20
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9758709073066711 / 0.9777884483337402
after epoch: 16,now: 2024-05-29 19:27:04.614089,epoch time: 0:20:14.641177,used: 5:49:01.297731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9694008, 'precision': 0.76269716, 'recall': 0.8051571, 'specificity': 0.8051571, 'f1': 0.7821611, 'auroc': 0.95720786, 'binary_precision': 0.5383721, 'binary_recall': 0.62907606, 'binary_specificity': 0.9812382, 'binary_f1_score': 0.5802005}
confusion matrix:
       0    1
0  41526  794
1    546  926
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7498764, 'recall': 0.7908499, 'specificity': 0.7908499, 'f1': 0.7686266, 'auroc': 0.9554026, 'binary_precision': 0.5139442, 'binary_recall': 0.60186625, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.5544413}
confusion matrix:
       0    1
0  17783  366
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.9432385, 'recall': 0.7746115, 'specificity': 0.7746115, 'f1': 0.8374008, 'auroc': 0.9232255, 'binary_precision': 0.9056604, 'binary_recall': 0.55172414, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6857143}
confusion matrix:
      0    1
0  5982   15
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9758709073066711 / 0.9789069890975952
after epoch: 17,now: 2024-05-29 19:47:07.937225,epoch time: 0:20:03.323136,used: 6:09:04.620867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96981186, 'precision': 0.76590884, 'recall': 0.7975012, 'specificity': 0.7975012, 'f1': 0.7807213, 'auroc': 0.9587153, 'binary_precision': 0.5453446, 'binary_recall': 0.61277175, 'binary_specificity': 0.9822306, 'binary_f1_score': 0.5770953}
confusion matrix:
       0    1
0  41568  752
1    570  902
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.75833046, 'recall': 0.7922612, 'specificity': 0.7922612, 'f1': 0.7741298, 'auroc': 0.95767856, 'binary_precision': 0.5307798, 'binary_recall': 0.60342145, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.56477433}
confusion matrix:
       0    1
0  17806  343
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.9233804, 'recall': 0.7607012, 'specificity': 0.7607012, 'f1': 0.8209758, 'auroc': 0.933723, 'binary_precision': 0.8670886, 'binary_recall': 0.5249042, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.65393794}
confusion matrix:
      0    1
0  5976   21
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 18,now: 2024-05-29 20:07:20.452275,epoch time: 0:20:12.515050,used: 6:29:17.135917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9700174, 'precision': 0.7659859, 'recall': 0.8256918, 'specificity': 0.8256918, 'f1': 0.79248583, 'auroc': 0.95923257, 'binary_precision': 0.5435022, 'binary_recall': 0.6709721, 'binary_specificity': 0.9804116, 'binary_f1_score': 0.6005476}
confusion matrix:
       0    1
0  41492  829
1    484  987
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.756742, 'recall': 0.8034018, 'specificity': 0.8034018, 'f1': 0.7779012, 'auroc': 0.9586955, 'binary_precision': 0.5267974, 'binary_recall': 0.62674963, 'binary_specificity': 0.980054, 'binary_f1_score': 0.57244325}
confusion matrix:
       0    1
0  17787  362
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98066473, 'precision': 0.9471767, 'recall': 0.7956842, 'specificity': 0.7956842, 'f1': 0.8546226, 'auroc': 0.94332993, 'binary_precision': 0.9117647, 'binary_recall': 0.59386975, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.71925753}
confusion matrix:
      0    1
0  5982   15
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9679650664329529, best validation acc: 0.9681779742240906, corresponding to test acc:                         0.9768296480178833 / 0.9806647300720215
after epoch: 19,now: 2024-05-29 20:27:24.192056,epoch time: 0:20:03.739781,used: 6:49:20.875698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9701772, 'precision': 0.7678983, 'recall': 0.8046503, 'specificity': 0.8046503, 'f1': 0.78496456, 'auroc': 0.96117043, 'binary_precision': 0.5488095, 'binary_recall': 0.62721086, 'binary_specificity': 0.9820897, 'binary_f1_score': 0.5853968}
confusion matrix:
       0    1
0  41564  758
1    548  922
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.7661498, 'recall': 0.7935898, 'specificity': 0.7935898, 'f1': 0.77912164, 'auroc': 0.9583523, 'binary_precision': 0.54634833, 'binary_recall': 0.60497665, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.57416975}
confusion matrix:
       0    1
0  17826  323
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9795462, 'precision': 0.95493066, 'recall': 0.7749449, 'specificity': 0.7749449, 'f1': 0.8408646, 'auroc': 0.93331265, 'binary_precision': 0.92903227, 'binary_recall': 0.55172414, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.6923077}
confusion matrix:
      0    1
0  5986   11
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 20,now: 2024-05-29 20:47:34.140390,epoch time: 0:20:09.948334,used: 7:09:30.824032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9705882, 'precision': 0.7703576, 'recall': 0.81548834, 'specificity': 0.81548834, 'f1': 0.7909925, 'auroc': 0.9641091, 'binary_precision': 0.55298203, 'binary_recall': 0.6492182, 'binary_specificity': 0.9817585, 'binary_f1_score': 0.59724826}
confusion matrix:
       0    1
0  41549  772
1    516  955
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.76304436, 'recall': 0.8053978, 'specificity': 0.8053978, 'f1': 0.78246224, 'auroc': 0.95881844, 'binary_precision': 0.53928095, 'binary_recall': 0.62986004, 'binary_specificity': 0.9809356, 'binary_f1_score': 0.58106166}
confusion matrix:
       0    1
0  17803  346
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.94247675, 'recall': 0.77078, 'specificity': 0.77078, 'f1': 0.8341748, 'auroc': 0.9415244, 'binary_precision': 0.9044586, 'binary_recall': 0.5440613, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.67942584}
confusion matrix:
      0    1
0  5982   15
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9692954421043396, corresponding to test acc:                         0.9795461893081665 / 0.9806647300720215
after epoch: 21,now: 2024-05-29 21:07:35.072067,epoch time: 0:20:00.931677,used: 7:29:31.755709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9699488, 'precision': 0.7659511, 'recall': 0.8182272, 'specificity': 0.8182272, 'f1': 0.789487, 'auroc': 0.96029556, 'binary_precision': 0.54396844, 'binary_recall': 0.6555706, 'binary_specificity': 0.9808837, 'binary_f1_score': 0.5945779}
confusion matrix:
       0    1
0  41511  809
1    507  965
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7567341, 'recall': 0.8041519, 'specificity': 0.8041519, 'f1': 0.7782039, 'auroc': 0.958385, 'binary_precision': 0.5267275, 'binary_recall': 0.62830484, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.5730496}
confusion matrix:
       0    1
0  17786  363
1    239  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.9495826, 'recall': 0.7614516, 'specificity': 0.7614516, 'f1': 0.8285293, 'auroc': 0.9313763, 'binary_precision': 0.9194631, 'binary_recall': 0.5249042, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6682927}
confusion matrix:
      0    1
0  5985   12
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.9679650664329529, best validation acc: 0.9692954421043396, corresponding to test acc:                         0.9795461893081665 / 0.9806647300720215
after epoch: 22,now: 2024-05-29 21:27:21.321613,epoch time: 0:19:46.249546,used: 7:49:18.005255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9718213, 'precision': 0.7802905, 'recall': 0.8073931, 'specificity': 0.8073931, 'f1': 0.7931503, 'auroc': 0.9639455, 'binary_precision': 0.57345676, 'binary_recall': 0.6311141, 'binary_specificity': 0.983672, 'binary_f1_score': 0.60090554}
confusion matrix:
       0    1
0  41629  691
1    543  929
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.7721113, 'recall': 0.8038088, 'specificity': 0.8038088, 'f1': 0.7869909, 'auroc': 0.9618833, 'binary_precision': 0.55755895, 'binary_recall': 0.62519443, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.58944285}
confusion matrix:
       0    1
0  17830  319
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9795462, 'precision': 0.9377129, 'recall': 0.7877713, 'specificity': 0.7877713, 'f1': 0.8458674, 'auroc': 0.94305325, 'binary_precision': 0.89349115, 'binary_recall': 0.5785441, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.70232564}
confusion matrix:
      0    1
0  5979   18
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 23,now: 2024-05-29 21:47:29.451607,epoch time: 0:20:08.129994,used: 8:09:26.135249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9717985, 'precision': 0.7798821, 'recall': 0.80824035, 'specificity': 0.80824035, 'f1': 0.7933047, 'auroc': 0.964123, 'binary_precision': 0.57257074, 'binary_recall': 0.6329028, 'binary_specificity': 0.9835779, 'binary_f1_score': 0.60122705}
confusion matrix:
       0    1
0  41626  695
1    540  931
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.7788907, 'recall': 0.7997493, 'specificity': 0.7997493, 'f1': 0.78890336, 'auroc': 0.96123236, 'binary_precision': 0.5714286, 'binary_recall': 0.61586314, 'binary_specificity': 0.9836355, 'binary_f1_score': 0.5928144}
confusion matrix:
       0    1
0  17852  297
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9404067, 'recall': 0.774528, 'specificity': 0.774528, 'f1': 0.83654463, 'auroc': 0.94327974, 'binary_precision': 0.9, 'binary_recall': 0.55172414, 'binary_specificity': 0.997332, 'binary_f1_score': 0.68408555}
confusion matrix:
      0    1
0  5981   16
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 24,now: 2024-05-29 22:07:18.750939,epoch time: 0:19:49.299332,used: 8:29:15.434581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9703827, 'precision': 0.7683525, 'recall': 0.8213862, 'specificity': 0.8213862, 'f1': 0.7922186, 'auroc': 0.96328783, 'binary_precision': 0.5485327, 'binary_recall': 0.6616746, 'binary_specificity': 0.98109776, 'binary_f1_score': 0.5998149}
confusion matrix:
       0    1
0  41523  800
1    497  972
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.764547, 'recall': 0.8235644, 'specificity': 0.8235644, 'f1': 0.7907516, 'auroc': 0.96165407, 'binary_precision': 0.5409836, 'binary_recall': 0.66718507, 'binary_specificity': 0.9799438, 'binary_f1_score': 0.597493}
confusion matrix:
       0    1
0  17785  364
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.93839204, 'recall': 0.7649495, 'specificity': 0.7649495, 'f1': 0.8284321, 'auroc': 0.93759376, 'binary_precision': 0.8967742, 'binary_recall': 0.532567, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6682692}
confusion matrix:
      0    1
0  5981   16
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9787471890449524 / 0.9806647300720215
after epoch: 25,now: 2024-05-29 22:27:25.037390,epoch time: 0:20:06.286451,used: 8:49:21.721032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9705882, 'precision': 0.76932085, 'recall': 0.83822954, 'specificity': 0.83822954, 'f1': 0.79942584, 'auroc': 0.9650049, 'binary_precision': 0.5493033, 'binary_recall': 0.6963315, 'binary_specificity': 0.9801276, 'binary_f1_score': 0.6141402}
confusion matrix:
       0     1
0  41479   841
1    447  1025
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.77244663, 'recall': 0.8332263, 'specificity': 0.8332263, 'f1': 0.79944015, 'auroc': 0.96370286, 'binary_precision': 0.55611604, 'binary_recall': 0.6858476, 'binary_specificity': 0.980605, 'binary_f1_score': 0.61420614}
confusion matrix:
       0    1
0  17797  352
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9800256, 'precision': 0.9304157, 'recall': 0.80084777, 'specificity': 0.80084777, 'f1': 0.85310066, 'auroc': 0.9468361, 'binary_precision': 0.87777776, 'binary_recall': 0.60536397, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.71655333}
confusion matrix:
      0    1
0  5975   22
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.9705193638801575, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9787471890449524 / 0.9806647300720215
after epoch: 26,now: 2024-05-29 22:47:17.865869,epoch time: 0:19:52.828479,used: 9:09:14.549511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9717528, 'precision': 0.7785225, 'recall': 0.820472, 'specificity': 0.820472, 'f1': 0.7978695, 'auroc': 0.9651419, 'binary_precision': 0.5689959, 'binary_recall': 0.65828806, 'binary_specificity': 0.98265594, 'binary_f1_score': 0.61039376}
confusion matrix:
       0    1
0  41586  734
1    503  969
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.7785791, 'recall': 0.8155831, 'specificity': 0.8155831, 'f1': 0.7958022, 'auroc': 0.9635652, 'binary_precision': 0.5696721, 'binary_recall': 0.64852256, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.6065454}
confusion matrix:
       0    1
0  17834  315
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.939613, 'recall': 0.77069664, 'specificity': 0.77069664, 'f1': 0.8333222, 'auroc': 0.9419694, 'binary_precision': 0.89873415, 'binary_recall': 0.5440613, 'binary_specificity': 0.997332, 'binary_f1_score': 0.67780423}
confusion matrix:
      0    1
0  5981   16
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 27,now: 2024-05-29 23:07:28.456271,epoch time: 0:20:10.590402,used: 9:29:25.139913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97138745, 'precision': 0.77507794, 'recall': 0.8311023, 'specificity': 0.8311023, 'f1': 0.8002156, 'auroc': 0.9671656, 'binary_precision': 0.56134456, 'binary_recall': 0.6807065, 'binary_specificity': 0.9814981, 'binary_f1_score': 0.6152901}
confusion matrix:
       0     1
0  41537   783
1    470  1002
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.77405083, 'recall': 0.8303363, 'specificity': 0.8303363, 'f1': 0.79927695, 'auroc': 0.9643149, 'binary_precision': 0.5595391, 'binary_recall': 0.67962676, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.6137641}
confusion matrix:
       0    1
0  17805  344
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.93650866, 'recall': 0.78202415, 'specificity': 0.78202415, 'f1': 0.84118605, 'auroc': 0.9412465, 'binary_precision': 0.8915663, 'binary_recall': 0.5670498, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.69320846}
confusion matrix:
      0    1
0  5979   18
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9707322120666504, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9784275889396667 / 0.9806647300720215
after epoch: 28,now: 2024-05-29 23:27:30.923385,epoch time: 0:20:02.467114,used: 9:49:27.607027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97241503, 'precision': 0.7823888, 'recall': 0.82846224, 'specificity': 0.82846224, 'f1': 0.80350137, 'auroc': 0.97037935, 'binary_precision': 0.5761628, 'binary_recall': 0.67414963, 'binary_specificity': 0.9827749, 'binary_f1_score': 0.6213166}
confusion matrix:
       0    1
0  41593  729
1    479  991
---- Validation: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.80086005, 'recall': 0.8193209, 'specificity': 0.8193209, 'f1': 0.8097874, 'auroc': 0.9660791, 'binary_precision': 0.61403507, 'binary_recall': 0.65318817, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.63300675}
confusion matrix:
       0    1
0  17885  264
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.934257, 'recall': 0.7838565, 'specificity': 0.7838565, 'f1': 0.84190035, 'auroc': 0.94377905, 'binary_precision': 0.8869048, 'binary_recall': 0.57088125, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.6946387}
confusion matrix:
      0    1
0  5978   19
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 29,now: 2024-05-29 23:47:29.378173,epoch time: 0:19:58.454788,used: 10:09:26.061815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9745616, 'precision': 0.8049433, 'recall': 0.80094224, 'specificity': 0.80094224, 'f1': 0.8029282, 'auroc': 0.96941054, 'binary_precision': 0.62327826, 'binary_recall': 0.6148098, 'binary_specificity': 0.9870747, 'binary_f1_score': 0.61901504}
confusion matrix:
       0    1
0  41773  547
1    567  905
---- Validation: 
scalar performance:
{'acc': 0.975149, 'precision': 0.8212848, 'recall': 0.78011906, 'specificity': 0.78011906, 'f1': 0.79916084, 'auroc': 0.96457195, 'binary_precision': 0.6577061, 'binary_recall': 0.57076204, 'binary_specificity': 0.989476, 'binary_f1_score': 0.6111573}
confusion matrix:
       0    1
0  17958  191
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.9585151, 'recall': 0.7368809, 'specificity': 0.7368809, 'f1': 0.8095412, 'auroc': 0.94203806, 'binary_precision': 0.93939394, 'binary_recall': 0.47509578, 'binary_specificity': 0.998666, 'binary_f1_score': 0.63104326}
confusion matrix:
      0    1
0  5989    8
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 30,now: 2024-05-30 00:07:29.605823,epoch time: 0:20:00.227650,used: 10:29:26.289465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:29:26.289465 at 2024-05-30 00:07:29.605823
persisted model performance metric: 

scalar performance:
{'acc': 0.97746885, 'precision': 0.9477838, 'recall': 0.7518731, 'specificity': 0.7518731, 'f1': 0.82010484, 'auroc': 0.9448724, 'binary_precision': 0.9166667, 'binary_recall': 0.50574714, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6518519}
confusion matrix:
      0    1
0  5985   12
1   129  132
oracle model performance metric: 

scalar performance:
{'acc': 0.9787472, 'precision': 0.9311987, 'recall': 0.7818574, 'specificity': 0.7818574, 'f1': 0.83948654, 'auroc': 0.9415835, 'binary_precision': 0.88095236, 'binary_recall': 0.5670498, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6899767}
confusion matrix:
      0    1
0  5977   20
1   113  148
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |  88733 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2108 MiB |   2108 MiB |   2108 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    849 MiB |    866 MiB | 687699 GiB | 687698 GiB |
|       from large pool |    842 MiB |    863 MiB | 684083 GiB | 684083 GiB |
|       from small pool |      6 MiB |     18 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  129130 K  |  129126 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73607 K  |   73603 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  129130 K  |  129126 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73607 K  |   73603 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |      96    |      96    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    2764    |   53022 K  |   53022 K  |
|       from large pool |      18    |      22    |   19255 K  |   19254 K  |
|       from small pool |      34    |    2746    |   33767 K  |   33767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687699 GiB | 687699 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684084 GiB | 684084 GiB |
|       from small pool |      0 KiB |     26 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129130 K  |  129130 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73607 K  |   73607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129130 K  |  129130 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73607 K  |   73607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53024 K  |   53024 K  |
|       from large pool |       4    |      25    |   19255 K  |   19255 K  |
|       from small pool |       0    |    2746    |   33769 K  |   33769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687699 GiB | 687699 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684084 GiB | 684084 GiB |
|       from small pool |      0 KiB |     26 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129130 K  |  129130 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73607 K  |   73607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129130 K  |  129130 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73607 K  |   73607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53024 K  |   53024 K  |
|       from large pool |       4    |      25    |   19255 K  |   19255 K  |
|       from small pool |       0    |    2746    |   33769 K  |   33769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753

 Experiment start at: 2024-05-30 00:15:59.359178
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.84915143, 'recall': 0.50650555, 'specificity': 0.50650555, 'f1': 0.5046523, 'auroc': 0.8334254, 'binary_precision': 0.7307692, 'binary_recall': 0.013176144, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.025885558}
confusion matrix:
       0   1
0  42407   7
1   1423  19
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.8004019, 'recall': 0.5050899, 'specificity': 0.5050899, 'f1': 0.5011297, 'auroc': 0.81597245, 'binary_precision': 0.6363636, 'binary_recall': 0.010401188, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.020467836}
confusion matrix:
       0  1
0  18063  4
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7924694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 00:36:48.423387,epoch time: 0:20:49.064209,used: 0:20:49.064209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7361557, 'recall': 0.52245355, 'specificity': 0.52245355, 'f1': 0.53417504, 'auroc': 0.88912714, 'binary_precision': 0.5037594, 'binary_recall': 0.046463244, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.085079364}
confusion matrix:
       0   1
0  42348  66
1   1375  67
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.787256, 'recall': 0.5514758, 'specificity': 0.5514758, 'f1': 0.5810427, 'auroc': 0.8973808, 'binary_precision': 0.60683763, 'binary_recall': 0.10549777, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.17974682}
confusion matrix:
       0   1
0  18021  46
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.8656291, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 00:56:50.521984,epoch time: 0:20:02.098597,used: 0:40:51.162806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.73975694, 'recall': 0.5600703, 'specificity': 0.5600703, 'f1': 0.59148175, 'auroc': 0.90935826, 'binary_precision': 0.50852275, 'binary_recall': 0.12421929, 'binary_specificity': 0.99592125, 'binary_f1_score': 0.19966535}
confusion matrix:
       0    1
0  42242  173
1   1262  179
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.76614064, 'recall': 0.6103492, 'specificity': 0.6103492, 'f1': 0.65297467, 'auroc': 0.9099806, 'binary_precision': 0.5604396, 'binary_recall': 0.22734027, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.32346722}
confusion matrix:
       0    1
0  17947  120
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8864835, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 01:16:42.887852,epoch time: 0:19:52.365868,used: 1:00:43.528674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96684605, 'precision': 0.7319171, 'recall': 0.60543257, 'specificity': 0.60543257, 'f1': 0.64266145, 'auroc': 0.9196156, 'binary_precision': 0.48989114, 'binary_recall': 0.2185982, 'binary_specificity': 0.9922669, 'binary_f1_score': 0.30230328}
confusion matrix:
       0    1
0  42087  328
1   1126  315
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75298333, 'recall': 0.6738419, 'specificity': 0.6738419, 'f1': 0.7052735, 'auroc': 0.92072165, 'binary_precision': 0.5295405, 'binary_recall': 0.35958394, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.4283186}
confusion matrix:
       0    1
0  17852  215
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.9291108, 'recall': 0.5803488, 'specificity': 0.5803488, 'f1': 0.62759674, 'auroc': 0.8948201, 'binary_precision': 0.89361703, 'binary_recall': 0.16153847, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.27361563}
confusion matrix:
      0   1
0  5941   5
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9640670418739319
after epoch: 4,now: 2024-05-30 01:36:44.582275,epoch time: 0:20:01.694423,used: 1:20:45.223097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.7324366, 'recall': 0.6534719, 'specificity': 0.6534719, 'f1': 0.68402994, 'auroc': 0.924635, 'binary_precision': 0.48777896, 'binary_recall': 0.3183079, 'binary_specificity': 0.98863584, 'binary_f1_score': 0.3852287}
confusion matrix:
       0    1
0  41932  482
1    983  459
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7411325, 'recall': 0.7053924, 'specificity': 0.7053924, 'f1': 0.72166204, 'auroc': 0.9264712, 'binary_precision': 0.50350875, 'binary_recall': 0.42644873, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.46178597}
confusion matrix:
       0    1
0  17784  283
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.93465555, 'recall': 0.63778883, 'specificity': 0.63778883, 'f1': 0.7036468, 'auroc': 0.9093411, 'binary_precision': 0.9, 'binary_recall': 0.2769231, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.42352945}
confusion matrix:
      0   1
0  5938   8
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 2
val acc:0.9643009901046753, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9684176445007324
after epoch: 5,now: 2024-05-30 01:56:28.540906,epoch time: 0:19:43.958631,used: 1:40:29.181728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96700567, 'precision': 0.73783696, 'recall': 0.6749, 'specificity': 0.6749, 'f1': 0.7010647, 'auroc': 0.9340258, 'binary_precision': 0.49714285, 'binary_recall': 0.36224845, 'binary_specificity': 0.98755157, 'binary_f1_score': 0.41910878}
confusion matrix:
       0    1
0  41887  528
1    919  522
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.73446715, 'recall': 0.70852596, 'specificity': 0.70852596, 'f1': 0.720644, 'auroc': 0.93111014, 'binary_precision': 0.4899329, 'binary_recall': 0.43387815, 'binary_specificity': 0.9831737, 'binary_f1_score': 0.46020487}
confusion matrix:
       0    1
0  17763  304
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.9556202, 'recall': 0.62658674, 'specificity': 0.62658674, 'f1': 0.691806, 'auroc': 0.9047487, 'binary_precision': 0.94285715, 'binary_recall': 0.25384617, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.40000004}
confusion matrix:
      0   1
0  5942   4
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 3
val acc:0.9634471535682678, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9684176445007324
after epoch: 6,now: 2024-05-30 02:16:36.166748,epoch time: 0:20:07.625842,used: 2:00:36.807570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9667776, 'precision': 0.73741233, 'recall': 0.70849836, 'specificity': 0.70849836, 'f1': 0.72191495, 'auroc': 0.93847644, 'binary_precision': 0.49405235, 'binary_recall': 0.43203884, 'binary_specificity': 0.9849578, 'binary_f1_score': 0.4609693}
confusion matrix:
       0    1
0  41776  638
1    819  623
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.73724955, 'recall': 0.7514696, 'specificity': 0.7514696, 'f1': 0.7441265, 'auroc': 0.9351451, 'binary_precision': 0.4923077, 'binary_recall': 0.5230312, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.5072046}
confusion matrix:
       0    1
0  17704  363
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.92786586, 'recall': 0.69882274, 'specificity': 0.69882274, 'f1': 0.7680689, 'auroc': 0.91521144, 'binary_precision': 0.88135594, 'binary_recall': 0.4, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.55026454}
confusion matrix:
      0    1
0  5932   14
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 4
val acc:0.9635005593299866, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9726071357727051
after epoch: 7,now: 2024-05-30 02:36:37.710920,epoch time: 0:20:01.544172,used: 2:20:38.351742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.74338424, 'recall': 0.73293316, 'specificity': 0.73293316, 'f1': 0.73803145, 'auroc': 0.94146615, 'binary_precision': 0.5043541, 'binary_recall': 0.48196948, 'binary_specificity': 0.98389685, 'binary_f1_score': 0.49290776}
confusion matrix:
       0    1
0  41731  683
1    747  695
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.73724955, 'recall': 0.7514696, 'specificity': 0.7514696, 'f1': 0.7441265, 'auroc': 0.93654335, 'binary_precision': 0.4923077, 'binary_recall': 0.5230312, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.5072046}
confusion matrix:
       0    1
0  17704  363
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.95108455, 'recall': 0.6974042, 'specificity': 0.6974042, 'f1': 0.7707764, 'auroc': 0.91155267, 'binary_precision': 0.9279279, 'binary_recall': 0.39615384, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.555256}
confusion matrix:
      0    1
0  5938    8
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 5
val acc:0.9635005593299866, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.973412811756134
after epoch: 8,now: 2024-05-30 02:57:04.188142,epoch time: 0:20:26.477222,used: 2:41:04.828964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.74443626, 'recall': 0.73032427, 'specificity': 0.73032427, 'f1': 0.73714757, 'auroc': 0.946345, 'binary_precision': 0.50663716, 'binary_recall': 0.47642162, 'binary_specificity': 0.9842269, 'binary_f1_score': 0.49106503}
confusion matrix:
       0    1
0  41745  669
1    755  687
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.7347646, 'recall': 0.7384565, 'specificity': 0.7384565, 'f1': 0.7365943, 'auroc': 0.9381708, 'binary_precision': 0.4883041, 'binary_recall': 0.4962853, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.49226236}
confusion matrix:
       0    1
0  17717  350
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.9673923, 'recall': 0.6900483, 'specificity': 0.6900483, 'f1': 0.7658802, 'auroc': 0.9156097, 'binary_precision': 0.9611651, 'binary_recall': 0.38076922, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.54545456}
confusion matrix:
      0   1
0  5942   4
1   161  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 6
val acc:0.9632337093353271, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.973412811756134
after epoch: 9,now: 2024-05-30 03:17:18.237845,epoch time: 0:20:14.049703,used: 3:01:18.878667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.74351966, 'recall': 0.7225732, 'specificity': 0.7225732, 'f1': 0.7325245, 'auroc': 0.94676304, 'binary_precision': 0.5053272, 'binary_recall': 0.46047157, 'binary_specificity': 0.9846749, 'binary_f1_score': 0.48185775}
confusion matrix:
       0    1
0  41764  650
1    778  664
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7430004, 'recall': 0.75548875, 'specificity': 0.75548875, 'f1': 0.7490687, 'auroc': 0.9395621, 'binary_precision': 0.5035261, 'binary_recall': 0.5304606, 'binary_specificity': 0.98051697, 'binary_f1_score': 0.5166425}
confusion matrix:
       0    1
0  17715  352
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.9553045, 'recall': 0.6974883, 'specificity': 0.6974883, 'f1': 0.7715689, 'auroc': 0.9320377, 'binary_precision': 0.93636364, 'binary_recall': 0.39615384, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.55675673}
confusion matrix:
      0    1
0  5939    7
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 7
val acc:0.9643543362617493, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9735739827156067
after epoch: 10,now: 2024-05-30 03:37:24.147530,epoch time: 0:20:05.909685,used: 3:21:24.788352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96812296, 'precision': 0.749431, 'recall': 0.76044154, 'specificity': 0.76044154, 'f1': 0.75480425, 'auroc': 0.9461614, 'binary_precision': 0.51458883, 'binary_recall': 0.5381415, 'binary_specificity': 0.98274153, 'binary_f1_score': 0.5261017}
confusion matrix:
       0    1
0  41682  732
1    666  776
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.744655, 'recall': 0.7770298, 'specificity': 0.7770298, 'f1': 0.7597111, 'auroc': 0.94256604, 'binary_precision': 0.5052219, 'binary_recall': 0.5750371, 'binary_specificity': 0.9790225, 'binary_f1_score': 0.53787345}
confusion matrix:
       0    1
0  17688  379
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.95907766, 'recall': 0.7186421, 'specificity': 0.7186421, 'f1': 0.7928541, 'auroc': 0.9297452, 'binary_precision': 0.94214875, 'binary_recall': 0.43846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.5984252}
confusion matrix:
      0    1
0  5939    7
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 8
val acc:0.964514434337616, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9603609442710876 / 0.9753464460372925
after epoch: 11,now: 2024-05-30 03:57:28.632020,epoch time: 0:20:04.484490,used: 3:41:29.272842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.968579, 'precision': 0.75285614, 'recall': 0.7487855, 'specificity': 0.7487855, 'f1': 0.7508025, 'auroc': 0.95098644, 'binary_precision': 0.5222301, 'binary_recall': 0.5135323, 'binary_specificity': 0.98403865, 'binary_f1_score': 0.5178447}
confusion matrix:
       0    1
0  41738  677
1    701  740
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.75432265, 'recall': 0.77065206, 'specificity': 0.77065206, 'f1': 0.7622026, 'auroc': 0.94506735, 'binary_precision': 0.52506965, 'binary_recall': 0.5601783, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.542056}
confusion matrix:
       0    1
0  17726  341
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.9596019, 'recall': 0.69757235, 'specificity': 0.69757235, 'f1': 0.77236533, 'auroc': 0.9267769, 'binary_precision': 0.94495416, 'binary_recall': 0.39615384, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.55826557}
confusion matrix:
      0    1
0  5940    6
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 12,now: 2024-05-30 04:17:24.813522,epoch time: 0:19:56.181502,used: 4:01:25.454344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.7484032, 'recall': 0.78580356, 'specificity': 0.78580356, 'f1': 0.7656455, 'auroc': 0.9509809, 'binary_precision': 0.51079136, 'binary_recall': 0.59084606, 'binary_specificity': 0.98076105, 'binary_f1_score': 0.54791}
confusion matrix:
       0    1
0  41598  816
1    590  852
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74803174, 'recall': 0.7973064, 'specificity': 0.7973064, 'f1': 0.77016056, 'auroc': 0.94757825, 'binary_precision': 0.51045513, 'binary_recall': 0.6166419, 'binary_specificity': 0.9779709, 'binary_f1_score': 0.5585464}
confusion matrix:
       0    1
0  17669  398
1    258  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.9185381, 'recall': 0.75391924, 'specificity': 0.75391924, 'f1': 0.81427205, 'auroc': 0.931184, 'binary_precision': 0.85806453, 'binary_recall': 0.51153845, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.64096385}
confusion matrix:
      0    1
0  5924   22
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9737350940704346 / 0.9759909510612488
after epoch: 13,now: 2024-05-30 04:37:39.742948,epoch time: 0:20:14.929426,used: 4:21:40.383770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9687842, 'precision': 0.75422037, 'recall': 0.76799756, 'specificity': 0.76799756, 'f1': 0.7609073, 'auroc': 0.95135045, 'binary_precision': 0.5236531, 'binary_recall': 0.5530881, 'binary_specificity': 0.982907, 'binary_f1_score': 0.5379683}
confusion matrix:
       0    1
0  41690  725
1    644  797
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.75317276, 'recall': 0.7820133, 'specificity': 0.7820133, 'f1': 0.76672053, 'auroc': 0.9474907, 'binary_precision': 0.52191234, 'binary_recall': 0.5839524, 'binary_specificity': 0.98007417, 'binary_f1_score': 0.55119216}
confusion matrix:
       0    1
0  17707  360
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.9618226, 'recall': 0.71103394, 'specificity': 0.71103394, 'f1': 0.7860726, 'auroc': 0.93379986, 'binary_precision': 0.94827586, 'binary_recall': 0.42307693, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.5851064}
confusion matrix:
      0    1
0  5940    6
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.965848445892334, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9737350940704346 / 0.9759909510612488
after epoch: 14,now: 2024-05-30 04:57:46.052201,epoch time: 0:20:06.309253,used: 4:41:46.693023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9677353, 'precision': 0.74725235, 'recall': 0.7964159, 'specificity': 0.7964159, 'f1': 0.7693555, 'auroc': 0.9531368, 'binary_precision': 0.50775415, 'binary_recall': 0.61303747, 'binary_specificity': 0.9797944, 'binary_f1_score': 0.5554508}
confusion matrix:
       0    1
0  41557  857
1    558  884
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7509999, 'recall': 0.8075692, 'specificity': 0.8075692, 'f1': 0.7760575, 'auroc': 0.9500642, 'binary_precision': 0.515625, 'binary_recall': 0.63744426, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.57009965}
confusion matrix:
       0    1
0  17664  403
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.93213296, 'recall': 0.7390392, 'specificity': 0.7390392, 'f1': 0.80543476, 'auroc': 0.9347714, 'binary_precision': 0.8865248, 'binary_recall': 0.48076922, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.62344134}
confusion matrix:
      0    1
0  5930   16
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 3
val acc:0.9654749035835266, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9737350940704346 / 0.9759909510612488
after epoch: 15,now: 2024-05-30 05:17:57.567391,epoch time: 0:20:11.515190,used: 5:01:58.208213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9695139, 'precision': 0.7595769, 'recall': 0.78159267, 'specificity': 0.78159267, 'f1': 0.77008826, 'auroc': 0.95920277, 'binary_precision': 0.5334608, 'binary_recall': 0.5804438, 'binary_specificity': 0.98274153, 'binary_f1_score': 0.5559615}
confusion matrix:
       0    1
0  41682  732
1    605  837
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7572286, 'recall': 0.7923591, 'specificity': 0.7923591, 'f1': 0.7735338, 'auroc': 0.9492788, 'binary_precision': 0.5292588, 'binary_recall': 0.6047548, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.5644937}
confusion matrix:
       0    1
0  17705  362
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.9667406, 'recall': 0.71688724, 'specificity': 0.71688724, 'f1': 0.7926264, 'auroc': 0.9278383, 'binary_precision': 0.9576271, 'binary_recall': 0.43461537, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.59788364}
confusion matrix:
      0    1
0  5941    5
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 16,now: 2024-05-30 05:37:57.990357,epoch time: 0:20:00.422966,used: 5:21:58.631179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96962786, 'precision': 0.75988436, 'recall': 0.80107886, 'specificity': 0.80107886, 'f1': 0.7788019, 'auroc': 0.9589722, 'binary_precision': 0.5327381, 'binary_recall': 0.6206657, 'binary_specificity': 0.981492, 'binary_f1_score': 0.5733504}
confusion matrix:
       0    1
0  41629  785
1    547  895
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7564063, 'recall': 0.80517864, 'specificity': 0.80517864, 'f1': 0.7784122, 'auroc': 0.94981676, 'binary_precision': 0.5266419, 'binary_recall': 0.6315007, 'binary_specificity': 0.9788565, 'binary_f1_score': 0.57432437}
confusion matrix:
       0    1
0  17685  382
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764744, 'precision': 0.9484385, 'recall': 0.73945963, 'specificity': 0.73945963, 'f1': 0.80958134, 'auroc': 0.9338796, 'binary_precision': 0.9191176, 'binary_recall': 0.48076922, 'binary_specificity': 0.99815, 'binary_f1_score': 0.63131315}
confusion matrix:
      0    1
0  5935   11
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.966488778591156, corresponding to test acc:                         0.9755075573921204 / 0.976474404335022
after epoch: 17,now: 2024-05-30 05:58:09.461623,epoch time: 0:20:11.471266,used: 5:42:10.102445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9701523, 'precision': 0.76463187, 'recall': 0.7779033, 'specificity': 0.7779033, 'f1': 0.771088, 'auroc': 0.96139467, 'binary_precision': 0.54383653, 'binary_recall': 0.57212204, 'binary_specificity': 0.98368466, 'binary_f1_score': 0.5576208}
confusion matrix:
       0    1
0  41722  692
1    617  825
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.758916, 'recall': 0.7946433, 'specificity': 0.7946433, 'f1': 0.7754864, 'auroc': 0.9510058, 'binary_precision': 0.53246754, 'binary_recall': 0.60921246, 'binary_specificity': 0.98007417, 'binary_f1_score': 0.56826055}
confusion matrix:
       0    1
0  17707  360
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.9618226, 'recall': 0.71103394, 'specificity': 0.71103394, 'f1': 0.7860726, 'auroc': 0.9383663, 'binary_precision': 0.94827586, 'binary_recall': 0.42307693, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.5851064}
confusion matrix:
      0    1
0  5940    6
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 18,now: 2024-05-30 06:18:17.538894,epoch time: 0:20:08.077271,used: 6:02:18.179716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9698103, 'precision': 0.7613406, 'recall': 0.795144, 'specificity': 0.795144, 'f1': 0.77710336, 'auroc': 0.95926213, 'binary_precision': 0.53606355, 'binary_recall': 0.6081831, 'binary_specificity': 0.98210496, 'binary_f1_score': 0.56985056}
confusion matrix:
       0    1
0  41655  759
1    565  877
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.7599891, 'recall': 0.8083441, 'specificity': 0.8083441, 'f1': 0.7818571, 'auroc': 0.95332503, 'binary_precision': 0.5335821, 'binary_recall': 0.63744426, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.5809072}
confusion matrix:
       0    1
0  17692  375
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766355, 'precision': 0.9615139, 'recall': 0.7340268, 'specificity': 0.7340268, 'f1': 0.8075946, 'auroc': 0.9382657, 'binary_precision': 0.9457364, 'binary_recall': 0.46923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.62724936}
confusion matrix:
      0    1
0  5939    7
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-05-30 06:38:21.606856,epoch time: 0:20:04.067962,used: 6:22:22.247678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96928585, 'precision': 0.7572879, 'recall': 0.8216691, 'specificity': 0.8216691, 'f1': 0.78549325, 'auroc': 0.95768046, 'binary_precision': 0.5261133, 'binary_recall': 0.6636616, 'binary_specificity': 0.97967654, 'binary_f1_score': 0.58693653}
confusion matrix:
       0    1
0  41552  862
1    485  957
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.75251263, 'recall': 0.83414483, 'specificity': 0.83414483, 'f1': 0.7869188, 'auroc': 0.95365405, 'binary_precision': 0.5166297, 'binary_recall': 0.692422, 'binary_specificity': 0.9758676, 'binary_f1_score': 0.59174603}
confusion matrix:
       0    1
0  17631  436
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9769578, 'precision': 0.935825, 'recall': 0.75442374, 'specificity': 0.75442374, 'f1': 0.8192265, 'auroc': 0.93670094, 'binary_precision': 0.89261746, 'binary_recall': 0.51153845, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.6503667}
confusion matrix:
      0    1
0  5930   16
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9766355156898499 / 0.9769577980041504
after epoch: 20,now: 2024-05-30 06:58:30.433427,epoch time: 0:20:08.826571,used: 6:42:31.074249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97017515, 'precision': 0.762928, 'recall': 0.8268181, 'specificity': 0.8268181, 'f1': 0.7910261, 'auroc': 0.9616792, 'binary_precision': 0.5370575, 'binary_recall': 0.6733703, 'binary_specificity': 0.980266, 'binary_f1_score': 0.5975385}
confusion matrix:
       0    1
0  41577  837
1    471  971
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.76040703, 'recall': 0.820559, 'specificity': 0.820559, 'f1': 0.7869836, 'auroc': 0.95445824, 'binary_precision': 0.5334928, 'binary_recall': 0.6627043, 'binary_specificity': 0.9784137, 'binary_f1_score': 0.59111995}
confusion matrix:
       0    1
0  17677  390
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9788914, 'precision': 0.94574296, 'recall': 0.7738228, 'specificity': 0.7738228, 'f1': 0.83746505, 'auroc': 0.9482641, 'binary_precision': 0.91082805, 'binary_recall': 0.55, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.6858514}
confusion matrix:
      0    1
0  5932   14
1   117  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-05-30 07:18:32.189546,epoch time: 0:20:01.756119,used: 7:02:32.830368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9707224, 'precision': 0.7671665, 'recall': 0.8126981, 'specificity': 0.8126981, 'f1': 0.7879503, 'auroc': 0.9640847, 'binary_precision': 0.5465253, 'binary_recall': 0.64355063, 'binary_specificity': 0.9818456, 'binary_f1_score': 0.5910828}
confusion matrix:
       0    1
0  41644  770
1    514  928
---- Validation: 
scalar performance:
{'acc': 0.9685165, 'precision': 0.7695807, 'recall': 0.8162993, 'specificity': 0.8162993, 'f1': 0.79085463, 'auroc': 0.95583224, 'binary_precision': 0.5522013, 'binary_recall': 0.6523031, 'binary_specificity': 0.98029554, 'binary_f1_score': 0.5980927}
confusion matrix:
       0    1
0  17711  356
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764744, 'precision': 0.9612216, 'recall': 0.7321037, 'specificity': 0.7321037, 'f1': 0.8057845, 'auroc': 0.93807995, 'binary_precision': 0.9453125, 'binary_recall': 0.4653846, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.62371135}
confusion matrix:
      0    1
0  5939    7
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 22,now: 2024-05-30 07:38:40.558770,epoch time: 0:20:08.369224,used: 7:22:41.199592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9710872, 'precision': 0.7699697, 'recall': 0.807065, 'specificity': 0.807065, 'f1': 0.7871971, 'auroc': 0.9649495, 'binary_precision': 0.55251974, 'binary_recall': 0.6315059, 'binary_specificity': 0.98262405, 'binary_f1_score': 0.58937824}
confusion matrix:
       0    1
0  41678  737
1    531  910
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.7661182, 'recall': 0.8167379, 'specificity': 0.8167379, 'f1': 0.788964, 'auroc': 0.9573251, 'binary_precision': 0.54522926, 'binary_recall': 0.653789, 'binary_specificity': 0.97968674, 'binary_f1_score': 0.5945946}
confusion matrix:
       0    1
0  17700  367
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9751853, 'precision': 0.94847536, 'recall': 0.72223604, 'specificity': 0.72223604, 'f1': 0.79411536, 'auroc': 0.9436232, 'binary_precision': 0.9206349, 'binary_recall': 0.44615385, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.6010363}
confusion matrix:
      0    1
0  5936   10
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9679829478263855, best validation acc: 0.9685165286064148, corresponding to test acc:                         0.976474404335022 / 0.9788913726806641
after epoch: 23,now: 2024-05-30 07:58:43.221297,epoch time: 0:20:02.662527,used: 7:42:43.862119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9702891, 'precision': 0.763654, 'recall': 0.82754695, 'specificity': 0.82754695, 'f1': 0.79176337, 'auroc': 0.9623425, 'binary_precision': 0.53846157, 'binary_recall': 0.6747573, 'binary_specificity': 0.98033667, 'binary_f1_score': 0.59895355}
confusion matrix:
       0    1
0  41580  834
1    469  973
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.763868, 'recall': 0.8359117, 'specificity': 0.8359117, 'f1': 0.79502726, 'auroc': 0.95683426, 'binary_precision': 0.539261, 'binary_recall': 0.69390786, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.6068876}
confusion matrix:
       0    1
0  17668  399
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.9385145, 'recall': 0.7392074, 'specificity': 0.7392074, 'f1': 0.8070816, 'auroc': 0.93435633, 'binary_precision': 0.89928055, 'binary_recall': 0.48076922, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.6265664}
confusion matrix:
      0    1
0  5932   14
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.9677160978317261, best validation acc: 0.9685165286064148, corresponding to test acc:                         0.976474404335022 / 0.9788913726806641
after epoch: 24,now: 2024-05-30 08:18:58.523939,epoch time: 0:20:15.302642,used: 8:02:59.164761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97138363, 'precision': 0.7713536, 'recall': 0.8220837, 'specificity': 0.8220837, 'f1': 0.7943158, 'auroc': 0.9628764, 'binary_precision': 0.5542658, 'binary_recall': 0.6622746, 'binary_specificity': 0.98189276, 'binary_f1_score': 0.6034755}
confusion matrix:
       0    1
0  41646  768
1    487  955
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.7737291, 'recall': 0.8230965, 'specificity': 0.8230965, 'f1': 0.79612887, 'auroc': 0.9562626, 'binary_precision': 0.56, 'binary_recall': 0.66567606, 'binary_specificity': 0.98051697, 'binary_f1_score': 0.6082824}
confusion matrix:
       0    1
0  17715  352
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9766355, 'precision': 0.9518445, 'recall': 0.7395437, 'specificity': 0.7395437, 'f1': 0.81042254, 'auroc': 0.9311295, 'binary_precision': 0.9259259, 'binary_recall': 0.48076922, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.6329114}
confusion matrix:
      0    1
0  5936   10
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 25,now: 2024-05-30 08:39:11.533785,epoch time: 0:20:13.009846,used: 8:23:12.174607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9698787, 'precision': 0.76108456, 'recall': 0.8229804, 'specificity': 0.8229804, 'f1': 0.7883856, 'auroc': 0.96349823, 'binary_precision': 0.5336298, 'binary_recall': 0.66574204, 'binary_specificity': 0.98021877, 'binary_f1_score': 0.59240973}
confusion matrix:
       0    1
0  41575  839
1    482  960
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7677728, 'recall': 0.8333827, 'specificity': 0.8333827, 'f1': 0.79656076, 'auroc': 0.9573822, 'binary_precision': 0.5472813, 'binary_recall': 0.6879643, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.6096116}
confusion matrix:
       0    1
0  17684  383
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764744, 'precision': 0.9484385, 'recall': 0.73945963, 'specificity': 0.73945963, 'f1': 0.80958134, 'auroc': 0.94197035, 'binary_precision': 0.9191176, 'binary_recall': 0.48076922, 'binary_specificity': 0.99815, 'binary_f1_score': 0.63131315}
confusion matrix:
      0    1
0  5935   11
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9683564305305481, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9766355156898499 / 0.9788913726806641
after epoch: 26,now: 2024-05-30 08:59:24.627188,epoch time: 0:20:13.093403,used: 8:43:25.268010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9722501, 'precision': 0.7801591, 'recall': 0.7945937, 'specificity': 0.7945937, 'f1': 0.7871765, 'auroc': 0.9650563, 'binary_precision': 0.5737813, 'binary_recall': 0.60444134, 'binary_specificity': 0.984746, 'binary_f1_score': 0.5887124}
confusion matrix:
       0    1
0  41768  647
1    570  871
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.8043164, 'recall': 0.78904897, 'specificity': 0.78904897, 'f1': 0.7964657, 'auroc': 0.9582499, 'binary_precision': 0.6238245, 'binary_recall': 0.59138185, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.6071701}
confusion matrix:
       0    1
0  17827  240
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.9689402, 'recall': 0.7015867, 'specificity': 0.7015867, 'f1': 0.7779515, 'auroc': 0.9382804, 'binary_precision': 0.96330273, 'binary_recall': 0.40384614, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.5691057}
confusion matrix:
      0    1
0  5942    4
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 27,now: 2024-05-30 09:19:44.543660,epoch time: 0:20:19.916472,used: 9:03:45.184482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97256935, 'precision': 0.77967775, 'recall': 0.8260462, 'specificity': 0.8260462, 'f1': 0.8008998, 'auroc': 0.9680331, 'binary_precision': 0.5706682, 'binary_recall': 0.6692094, 'binary_specificity': 0.98288304, 'binary_f1_score': 0.61602294}
confusion matrix:
       0    1
0  41688  726
1    477  965
---- Validation: 
scalar performance:
{'acc': 0.9720918, 'precision': 0.7963234, 'recall': 0.81028557, 'specificity': 0.81028557, 'f1': 0.8031262, 'auroc': 0.96004033, 'binary_precision': 0.6062323, 'binary_recall': 0.6359584, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.62073964}
confusion matrix:
       0    1
0  17789  278
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764744, 'precision': 0.95148766, 'recall': 0.73762065, 'specificity': 0.73762065, 'f1': 0.80864656, 'auroc': 0.9484726, 'binary_precision': 0.92537314, 'binary_recall': 0.47692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.6294416}
confusion matrix:
      0    1
0  5936   10
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.972091794013977, best validation acc: 0.9725186824798584, corresponding to test acc:                         0.9743796586990356 / 0.9788913726806641
after epoch: 28,now: 2024-05-30 09:39:44.833308,epoch time: 0:20:00.289648,used: 9:23:45.474130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9734358, 'precision': 0.78709155, 'recall': 0.8194602, 'specificity': 0.8194602, 'f1': 0.8023236, 'auroc': 0.9697139, 'binary_precision': 0.5859715, 'binary_recall': 0.65464634, 'binary_specificity': 0.9842741, 'binary_f1_score': 0.6184082}
confusion matrix:
       0    1
0  41747  667
1    498  944
---- Validation: 
scalar performance:
{'acc': 0.9727321, 'precision': 0.80318356, 'recall': 0.80274975, 'specificity': 0.80274975, 'f1': 0.8029665, 'auroc': 0.96024036, 'binary_precision': 0.62053573, 'binary_recall': 0.61961365, 'binary_specificity': 0.98588586, 'binary_f1_score': 0.62007433}
confusion matrix:
       0    1
0  17812  255
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.9545076, 'recall': 0.7147119, 'specificity': 0.7147119, 'f1': 0.78825414, 'auroc': 0.94562274, 'binary_precision': 0.93333334, 'binary_recall': 0.43076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.58947366}
confusion matrix:
      0    1
0  5938    8
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 29,now: 2024-05-30 09:59:47.567404,epoch time: 0:20:02.734096,used: 9:43:48.208226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9736638, 'precision': 0.78694355, 'recall': 0.8356558, 'specificity': 0.8356558, 'f1': 0.8091958, 'auroc': 0.9684479, 'binary_precision': 0.584561, 'binary_recall': 0.68793344, 'binary_specificity': 0.9833781, 'binary_f1_score': 0.6320484}
confusion matrix:
       0    1
0  41709  705
1    450  992
---- Validation: 
scalar performance:
{'acc': 0.9728922, 'precision': 0.8019123, 'recall': 0.81570756, 'specificity': 0.81570756, 'f1': 0.8086393, 'auroc': 0.96054476, 'binary_precision': 0.61702126, 'binary_recall': 0.64635956, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.6313498}
confusion matrix:
       0    1
0  17797  270
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767966, 'precision': 0.9618031, 'recall': 0.7359498, 'specificity': 0.7359498, 'f1': 0.8093956, 'auroc': 0.9501198, 'binary_precision': 0.9461538, 'binary_recall': 0.4730769, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.63076925}
confusion matrix:
      0    1
0  5939    7
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 30,now: 2024-05-30 10:19:42.181010,epoch time: 0:19:54.613606,used: 10:03:42.821832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_15_59_seed_1_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:03:42.821832 at 2024-05-30 10:19:42.181010
persisted model performance metric: 

scalar performance:
{'acc': 0.97599095, 'precision': 0.9535974, 'recall': 0.7300124, 'specificity': 0.7300124, 'f1': 0.80228686, 'auroc': 0.94312704, 'binary_precision': 0.9302326, 'binary_recall': 0.46153846, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.6169666}
confusion matrix:
      0    1
0  5937    9
1   140  120
oracle model performance metric: 

scalar performance:
{'acc': 0.9776023, 'precision': 0.94270146, 'recall': 0.7584381, 'specificity': 0.7584381, 'f1': 0.8242831, 'auroc': 0.9415797, 'binary_precision': 0.90604025, 'binary_recall': 0.5192308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.6601467}
confusion matrix:
      0    1
0  5932   14
1   125  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486863 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |  89807 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486863 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |  89807 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |  88730 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2028 MiB |   2108 MiB |   2810 MiB |    782 MiB |
|       from large pool |   1904 MiB |   1982 MiB |   2654 MiB |    750 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1122 MiB |   1127 MiB |   1457 TiB |   1457 TiB |
|       from large pool |   1116 MiB |   1118 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      6 MiB |     26 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6708    |  258301 K  |  258297 K  |
|       from large pool |      87    |     178    |  111065 K  |  111065 K  |
|       from small pool |    3618    |    6620    |  147236 K  |  147232 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6708    |  258301 K  |  258297 K  |
|       from large pool |      87    |     178    |  111065 K  |  111065 K  |
|       from small pool |    3618    |    6620    |  147236 K  |  147232 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |      96    |     116    |      26    |
|       from large pool |      28    |      33    |      38    |      10    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2771    |  108244 K  |  108244 K  |
|       from large pool |      21    |      25    |   40086 K  |   40086 K  |
|       from small pool |      33    |    2750    |   68158 K  |   68158 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1598 MiB |   2108 MiB |   2810 MiB |   1212 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   1457 TiB |   1457 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     27 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  258301 K  |  258301 K  |
|       from large pool |       2    |     178    |  111065 K  |  111065 K  |
|       from small pool |       0    |    6620    |  147236 K  |  147236 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  258301 K  |  258301 K  |
|       from large pool |       2    |     178    |  111065 K  |  111065 K  |
|       from small pool |       0    |    6620    |  147236 K  |  147236 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     116    |      44    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  108246 K  |  108246 K  |
|       from large pool |       4    |      27    |   40086 K  |   40086 K  |
|       from small pool |       0    |    2750    |   68159 K  |   68159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1598 MiB |   2108 MiB |   2810 MiB |   1212 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   1457 TiB |   1457 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     27 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  258301 K  |  258301 K  |
|       from large pool |       2    |     178    |  111065 K  |  111065 K  |
|       from small pool |       0    |    6620    |  147236 K  |  147236 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  258301 K  |  258301 K  |
|       from large pool |       2    |     178    |  111065 K  |  111065 K  |
|       from small pool |       0    |    6620    |  147236 K  |  147236 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     116    |      44    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  108246 K  |  108246 K  |
|       from large pool |       4    |      27    |   40086 K  |   40086 K  |
|       from small pool |       0    |    2750    |   68159 K  |   68159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753

 Experiment start at: 2024-05-30 10:28:35.372941
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.8009951, 'recall': 0.502266, 'specificity': 0.502266, 'f1': 0.49582678, 'auroc': 0.8388854, 'binary_precision': 0.6363636, 'binary_recall': 0.00462657, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.009186352}
confusion matrix:
       0  1
0  42307  4
1   1506  7
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.82728255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7867205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 10:49:39.063837,epoch time: 0:21:03.690896,used: 0:21:03.690896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9657037, 'precision': 0.75882673, 'recall': 0.5173254, 'specificity': 0.5173254, 'f1': 0.5247849, 'auroc': 0.8941213, 'binary_precision': 0.5510204, 'binary_recall': 0.03569068, 'binary_specificity': 0.9989601, 'binary_f1_score': 0.0670391}
confusion matrix:
       0   1
0  42267  44
1   1459  54
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.85552114, 'recall': 0.5188829, 'specificity': 0.5188829, 'f1': 0.5283838, 'auroc': 0.896829, 'binary_precision': 0.7419355, 'binary_recall': 0.03820598, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.07266983}
confusion matrix:
       0   1
0  18163   8
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.85881233, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 11:09:43.024624,epoch time: 0:20:03.960787,used: 0:41:07.651683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661829, 'precision': 0.7581011, 'recall': 0.55804235, 'specificity': 0.55804235, 'f1': 0.5895202, 'auroc': 0.9201349, 'binary_precision': 0.5468278, 'binary_recall': 0.119629875, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.19631237}
confusion matrix:
       0    1
0  42161  150
1   1332  181
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.768209, 'recall': 0.54532844, 'specificity': 0.54532844, 'f1': 0.571893, 'auroc': 0.91688776, 'binary_precision': 0.56565654, 'binary_recall': 0.093023255, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.15977176}
confusion matrix:
       0   1
0  18128  43
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.88255084, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9686251282691956, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9613720178604126 / 0.9616925716400146
after epoch: 3,now: 2024-05-30 11:29:55.247560,epoch time: 0:20:12.222936,used: 1:01:19.874619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96520174, 'precision': 0.731481, 'recall': 0.6005522, 'specificity': 0.6005522, 'f1': 0.63758075, 'auroc': 0.92217755, 'binary_precision': 0.49068323, 'binary_recall': 0.20885658, 'binary_specificity': 0.9922479, 'binary_f1_score': 0.29299957}
confusion matrix:
       0    1
0  41983  328
1   1197  316
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.75803965, 'recall': 0.6380092, 'specificity': 0.6380092, 'f1': 0.6781951, 'auroc': 0.9244951, 'binary_precision': 0.53943217, 'binary_recall': 0.28405315, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.37214363}
confusion matrix:
       0    1
0  18025  146
1    431  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.95567775, 'recall': 0.5371067, 'specificity': 0.5371067, 'f1': 0.55975705, 'auroc': 0.9080341, 'binary_precision': 0.94736844, 'binary_recall': 0.07438017, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5996   1
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-30 11:50:04.203896,epoch time: 0:20:08.956336,used: 1:21:28.830955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96463126, 'precision': 0.72889745, 'recall': 0.65506494, 'specificity': 0.65506494, 'f1': 0.6840862, 'auroc': 0.9308988, 'binary_precision': 0.4817374, 'binary_recall': 0.32253802, 'binary_specificity': 0.98759186, 'binary_f1_score': 0.38638166}
confusion matrix:
       0    1
0  41786  525
1   1025  488
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7448054, 'recall': 0.6761153, 'specificity': 0.6761153, 'f1': 0.70429516, 'auroc': 0.9283496, 'binary_precision': 0.5104895, 'binary_recall': 0.36378738, 'binary_specificity': 0.98844314, 'binary_f1_score': 0.42483026}
confusion matrix:
       0    1
0  17961  210
1    383  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.9647975, 'recall': 0.6010729, 'specificity': 0.6010729, 'f1': 0.65923387, 'auroc': 0.9107372, 'binary_precision': 0.9607843, 'binary_recall': 0.20247933, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.33447096}
confusion matrix:
      0   1
0  5995   2
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 1
val acc:0.9684121012687683, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9687449932098389
after epoch: 5,now: 2024-05-30 12:10:36.233137,epoch time: 0:20:32.029241,used: 1:42:00.860196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7385185, 'recall': 0.6873319, 'specificity': 0.6873319, 'f1': 0.7095027, 'auroc': 0.9381951, 'binary_precision': 0.49872774, 'binary_recall': 0.38863185, 'binary_specificity': 0.986032, 'binary_f1_score': 0.43684992}
confusion matrix:
       0    1
0  41720  591
1    925  588
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.73304194, 'recall': 0.71953994, 'specificity': 0.71953994, 'f1': 0.7260674, 'auroc': 0.93368584, 'binary_precision': 0.48409894, 'binary_recall': 0.4551495, 'binary_specificity': 0.9839304, 'binary_f1_score': 0.46917808}
confusion matrix:
       0    1
0  17879  292
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.9509632, 'recall': 0.66065675, 'specificity': 0.66065675, 'f1': 0.73226905, 'auroc': 0.9119415, 'binary_precision': 0.9285714, 'binary_recall': 0.32231405, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.4785276}
confusion matrix:
      0   1
0  5991   6
1   164  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 2
val acc:0.9669738411903381, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.972752034664154
after epoch: 6,now: 2024-05-30 12:30:53.786791,epoch time: 0:20:17.553654,used: 2:02:18.413850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663883, 'precision': 0.74780756, 'recall': 0.7056846, 'specificity': 0.7056846, 'f1': 0.7245726, 'auroc': 0.93904924, 'binary_precision': 0.51602566, 'binary_recall': 0.42564443, 'binary_specificity': 0.98572475, 'binary_f1_score': 0.46649766}
confusion matrix:
       0    1
0  41707  604
1    869  644
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.73695743, 'recall': 0.7197876, 'specificity': 0.7197876, 'f1': 0.7280148, 'auroc': 0.93228793, 'binary_precision': 0.491921, 'binary_recall': 0.4551495, 'binary_specificity': 0.9844257, 'binary_f1_score': 0.4728214}
confusion matrix:
       0    1
0  17888  283
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.94868875, 'recall': 0.6729701, 'specificity': 0.6729701, 'f1': 0.7454593, 'auroc': 0.9090048, 'binary_precision': 0.9230769, 'binary_recall': 0.34710744, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5045045}
confusion matrix:
      0   1
0  5990   7
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 3
val acc:0.9674532413482666, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.973553478717804
after epoch: 7,now: 2024-05-30 12:51:37.729166,epoch time: 0:20:43.942375,used: 2:23:02.356225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7415403, 'recall': 0.7355311, 'specificity': 0.7355311, 'f1': 0.7384934, 'auroc': 0.9400965, 'binary_precision': 0.50135684, 'binary_recall': 0.48843357, 'binary_specificity': 0.98262864, 'binary_f1_score': 0.49481082}
confusion matrix:
       0    1
0  41576  735
1    774  739
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.72494686, 'recall': 0.7540761, 'specificity': 0.7540761, 'f1': 0.7385218, 'auroc': 0.9395832, 'binary_precision': 0.46559298, 'binary_recall': 0.5282392, 'binary_specificity': 0.97991306, 'binary_f1_score': 0.49494162}
confusion matrix:
       0    1
0  17806  365
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.93275523, 'recall': 0.7261055, 'specificity': 0.7261055, 'f1': 0.79451936, 'auroc': 0.91739, 'binary_precision': 0.88709676, 'binary_recall': 0.45454547, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6010929}
confusion matrix:
      0    1
0  5983   14
1   132  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 4
val acc:0.9654290676116943, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9765987992286682
after epoch: 8,now: 2024-05-30 13:11:56.157269,epoch time: 0:20:18.428103,used: 2:43:20.784328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.74703753, 'recall': 0.7585099, 'specificity': 0.7585099, 'f1': 0.7526282, 'auroc': 0.9453524, 'binary_precision': 0.51071876, 'binary_recall': 0.5353602, 'binary_specificity': 0.9816596, 'binary_f1_score': 0.5227493}
confusion matrix:
       0    1
0  41535  776
1    703  810
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.73312366, 'recall': 0.755512, 'specificity': 0.755512, 'f1': 0.7437465, 'auroc': 0.9411961, 'binary_precision': 0.48187312, 'binary_recall': 0.5299003, 'binary_specificity': 0.98112375, 'binary_f1_score': 0.5047468}
confusion matrix:
       0    1
0  17828  343
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.93584996, 'recall': 0.72412276, 'specificity': 0.72412276, 'f1': 0.7934245, 'auroc': 0.92318904, 'binary_precision': 0.89344263, 'binary_recall': 0.45041323, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.5989011}
confusion matrix:
      0    1
0  5984   13
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 5
val acc:0.9666542410850525, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9765987992286682
after epoch: 9,now: 2024-05-30 13:32:08.506652,epoch time: 0:20:12.349383,used: 3:03:33.133711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96670777, 'precision': 0.7503568, 'recall': 0.7743602, 'specificity': 0.7743602, 'f1': 0.76174474, 'auroc': 0.9497528, 'binary_precision': 0.51622593, 'binary_recall': 0.5677462, 'binary_specificity': 0.9809742, 'binary_f1_score': 0.5407617}
confusion matrix:
       0    1
0  41506  805
1    654  859
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7423485, 'recall': 0.79142404, 'specificity': 0.79142404, 'f1': 0.7643744, 'auroc': 0.9433144, 'binary_precision': 0.4979424, 'binary_recall': 0.60299003, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.54545456}
confusion matrix:
       0    1
0  17805  366
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785222, 'precision': 0.9415827, 'recall': 0.74891615, 'specificity': 0.74891615, 'f1': 0.81627226, 'auroc': 0.9300675, 'binary_precision': 0.9029851, 'binary_recall': 0.5, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.64361703}
confusion matrix:
      0    1
0  5984   13
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 6
val acc:0.9677728414535522, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9785221815109253
after epoch: 10,now: 2024-05-30 13:52:34.019772,epoch time: 0:20:25.513120,used: 3:23:58.646831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9658863, 'precision': 0.7450708, 'recall': 0.7809451, 'specificity': 0.7809451, 'f1': 0.76163673, 'auroc': 0.94923437, 'binary_precision': 0.50516057, 'binary_recall': 0.58228683, 'binary_specificity': 0.9796034, 'binary_f1_score': 0.5409887}
confusion matrix:
       0    1
0  41448  863
1    632  881
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7392081, 'recall': 0.79596716, 'specificity': 0.79596716, 'f1': 0.76423115, 'auroc': 0.9446312, 'binary_precision': 0.49134487, 'binary_recall': 0.6129568, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.5454545}
confusion matrix:
       0    1
0  17789  382
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.9463853, 'recall': 0.7387523, 'specificity': 0.7387523, 'f1': 0.80870616, 'auroc': 0.92074704, 'binary_precision': 0.9133858, 'binary_recall': 0.47933885, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.6287263}
confusion matrix:
      0    1
0  5986   11
1   126  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 7
val acc:0.9672402143478394, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9785221815109253
after epoch: 11,now: 2024-05-30 14:12:41.124619,epoch time: 0:20:07.104847,used: 3:44:05.751678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9679399, 'precision': 0.759081, 'recall': 0.7730864, 'specificity': 0.7730864, 'f1': 0.7658784, 'auroc': 0.9514694, 'binary_precision': 0.53379226, 'binary_recall': 0.56378055, 'binary_specificity': 0.9823923, 'binary_f1_score': 0.5483767}
confusion matrix:
       0    1
0  41566  745
1    660  853
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7453166, 'recall': 0.7860503, 'specificity': 0.7860503, 'f1': 0.76394784, 'auroc': 0.9453624, 'binary_precision': 0.5042493, 'binary_recall': 0.5913621, 'binary_specificity': 0.9807385, 'binary_f1_score': 0.5443425}
confusion matrix:
       0    1
0  17821  350
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.9306654, 'recall': 0.7445338, 'specificity': 0.7445338, 'f1': 0.80990654, 'auroc': 0.9325374, 'binary_precision': 0.88148147, 'binary_recall': 0.49173555, 'binary_specificity': 0.997332, 'binary_f1_score': 0.63129973}
confusion matrix:
      0    1
0  5981   16
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 8
val acc:0.9682523012161255, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9785221815109253
after epoch: 12,now: 2024-05-30 14:32:46.878174,epoch time: 0:20:05.753555,used: 4:04:11.505233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9680084, 'precision': 0.7589648, 'recall': 0.7963835, 'specificity': 0.7963835, 'f1': 0.7762666, 'auroc': 0.9562038, 'binary_precision': 0.53187823, 'binary_recall': 0.6120291, 'binary_specificity': 0.98073786, 'binary_f1_score': 0.5691457}
confusion matrix:
       0    1
0  41496  815
1    587  926
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.746738, 'recall': 0.78535736, 'specificity': 0.78535736, 'f1': 0.7644906, 'auroc': 0.9471437, 'binary_precision': 0.50714284, 'binary_recall': 0.589701, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.5453149}
confusion matrix:
       0    1
0  17826  345
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9794839, 'precision': 0.94997334, 'recall': 0.75734735, 'specificity': 0.75734735, 'f1': 0.82539856, 'auroc': 0.922578, 'binary_precision': 0.9191176, 'binary_recall': 0.5165289, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.66137564}
confusion matrix:
      0    1
0  5986   11
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 9
val acc:0.9684653282165527, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9794839024543762
after epoch: 13,now: 2024-05-30 14:52:52.278136,epoch time: 0:20:05.399962,used: 4:24:16.905195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9683279, 'precision': 0.76101357, 'recall': 0.8003727, 'specificity': 0.8003727, 'f1': 0.77915317, 'auroc': 0.95837665, 'binary_precision': 0.5356939, 'binary_recall': 0.61996037, 'binary_specificity': 0.98078513, 'binary_f1_score': 0.57475495}
confusion matrix:
       0    1
0  41498  813
1    575  938
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7456991, 'recall': 0.80050516, 'specificity': 0.80050516, 'f1': 0.7700422, 'auroc': 0.9471452, 'binary_precision': 0.5040431, 'binary_recall': 0.62126243, 'binary_specificity': 0.97974795, 'binary_f1_score': 0.5565476}
confusion matrix:
       0    1
0  17803  368
1    228  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.9212651, 'recall': 0.76684415, 'specificity': 0.76684415, 'f1': 0.8252861, 'auroc': 0.92580867, 'binary_precision': 0.86092716, 'binary_recall': 0.5371901, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6615776}
confusion matrix:
      0    1
0  5976   21
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 10
val acc:0.9682523012161255, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9794839024543762
after epoch: 14,now: 2024-05-30 15:12:46.398760,epoch time: 0:19:54.120624,used: 4:44:11.025819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96823657, 'precision': 0.76030874, 'recall': 0.80414927, 'specificity': 0.80414927, 'f1': 0.7803276, 'auroc': 0.95805234, 'binary_precision': 0.53400785, 'binary_recall': 0.6278916, 'binary_specificity': 0.980407, 'binary_f1_score': 0.5771567}
confusion matrix:
       0    1
0  41482  829
1    563  950
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7482395, 'recall': 0.8079252, 'specificity': 0.8079252, 'f1': 0.77451944, 'auroc': 0.95190537, 'binary_precision': 0.5086321, 'binary_recall': 0.63621265, 'binary_specificity': 0.97963786, 'binary_f1_score': 0.56531364}
confusion matrix:
       0    1
0  17801  370
1    219  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.92901284, 'recall': 0.75064874, 'specificity': 0.75064874, 'f1': 0.8145474, 'auroc': 0.92171395, 'binary_precision': 0.8776978, 'binary_recall': 0.5041322, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.64041996}
confusion matrix:
      0    1
0  5980   17
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 11
val acc:0.9686251282691956, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9794839024543762
after epoch: 15,now: 2024-05-30 15:32:53.587292,epoch time: 0:20:07.188532,used: 5:04:18.214351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9677574, 'precision': 0.75709885, 'recall': 0.81250477, 'specificity': 0.81250477, 'f1': 0.7817866, 'auroc': 0.95839024, 'binary_precision': 0.5269687, 'binary_recall': 0.64573693, 'binary_specificity': 0.97927254, 'binary_f1_score': 0.58033854}
confusion matrix:
       0    1
0  41434  877
1    536  977
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7383253, 'recall': 0.8158783, 'specificity': 0.8158783, 'f1': 0.77103865, 'auroc': 0.9508742, 'binary_precision': 0.488228, 'binary_recall': 0.65448505, 'binary_specificity': 0.9772715, 'binary_f1_score': 0.55926186}
confusion matrix:
       0    1
0  17758  413
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98044556, 'precision': 0.9268752, 'recall': 0.7895714, 'specificity': 0.7895714, 'f1': 0.84395766, 'auroc': 0.92877, 'binary_precision': 0.8703704, 'binary_recall': 0.58264464, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.69801974}
confusion matrix:
      0    1
0  5976   21
1   101  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
early stop counter: 12
val acc:0.9669205546379089, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9639365077018738 / 0.9804455637931824
after epoch: 16,now: 2024-05-30 15:52:53.107742,epoch time: 0:19:59.520450,used: 5:24:17.734801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9688527, 'precision': 0.7647315, 'recall': 0.7971394, 'specificity': 0.7971394, 'f1': 0.77989393, 'auroc': 0.9594929, 'binary_precision': 0.5433763, 'binary_recall': 0.61269003, 'binary_specificity': 0.9815887, 'binary_f1_score': 0.5759553}
confusion matrix:
       0    1
0  41532  779
1    586  927
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.7601752, 'recall': 0.7975906, 'specificity': 0.7975906, 'f1': 0.7774937, 'auroc': 0.95134497, 'binary_precision': 0.533237, 'binary_recall': 0.6129568, 'binary_specificity': 0.9822244, 'binary_f1_score': 0.5703246}
confusion matrix:
       0    1
0  17848  323
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.94288576, 'recall': 0.75511444, 'specificity': 0.75511444, 'f1': 0.8217631, 'auroc': 0.9322392, 'binary_precision': 0.90510947, 'binary_recall': 0.5123967, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.65435356}
confusion matrix:
      0    1
0  5984   13
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 17,now: 2024-05-30 16:13:02.216907,epoch time: 0:20:09.109165,used: 5:44:26.843966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96901244, 'precision': 0.7649603, 'recall': 0.8185718, 'specificity': 0.8185718, 'f1': 0.7890167, 'auroc': 0.96088284, 'binary_precision': 0.54228044, 'binary_recall': 0.6569729, 'binary_specificity': 0.98017067, 'binary_f1_score': 0.59414226}
confusion matrix:
       0    1
0  41472  839
1    519  994
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7497352, 'recall': 0.81686884, 'specificity': 0.81686884, 'f1': 0.7788767, 'auroc': 0.9532348, 'binary_precision': 0.51102465, 'binary_recall': 0.65448505, 'binary_specificity': 0.97925264, 'binary_f1_score': 0.57392573}
confusion matrix:
       0    1
0  17794  377
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.9341491, 'recall': 0.7589966, 'specificity': 0.7589966, 'f1': 0.8226677, 'auroc': 0.93595475, 'binary_precision': 0.8873239, 'binary_recall': 0.5206612, 'binary_specificity': 0.997332, 'binary_f1_score': 0.65625}
confusion matrix:
      0    1
0  5981   16
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9688382148742676, best validation acc: 0.9703829884529114, corresponding to test acc:                         0.9790030717849731 / 0.9804455637931824
after epoch: 18,now: 2024-05-30 16:33:16.224604,epoch time: 0:20:14.007697,used: 6:04:40.851663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9697426, 'precision': 0.7697312, 'recall': 0.8199059, 'specificity': 0.8199059, 'f1': 0.79243904, 'auroc': 0.9615449, 'binary_precision': 0.5517432, 'binary_recall': 0.6589557, 'binary_specificity': 0.98085606, 'binary_f1_score': 0.6006024}
confusion matrix:
       0    1
0  41501  810
1    516  997
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7548218, 'recall': 0.8108572, 'specificity': 0.8108572, 'f1': 0.77975833, 'auroc': 0.9551702, 'binary_precision': 0.52162164, 'binary_recall': 0.641196, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.5752608}
confusion matrix:
       0    1
0  17817  354
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.9420222, 'recall': 0.7509822, 'specificity': 0.7509822, 'f1': 0.818112, 'auroc': 0.9333248, 'binary_precision': 0.9037037, 'binary_recall': 0.5041322, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.64721483}
confusion matrix:
      0    1
0  5984   13
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.9696372747421265, best validation acc: 0.9703829884529114, corresponding to test acc:                         0.9790030717849731 / 0.9804455637931824
after epoch: 19,now: 2024-05-30 16:53:30.500518,epoch time: 0:20:14.275914,used: 6:24:55.127577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97202444, 'precision': 0.7866442, 'recall': 0.8150332, 'specificity': 0.8150332, 'f1': 0.8000965, 'auroc': 0.9637346, 'binary_precision': 0.58597964, 'binary_recall': 0.6463979, 'binary_specificity': 0.98366857, 'binary_f1_score': 0.61470777}
confusion matrix:
       0    1
0  41620  691
1    535  978
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.7736788, 'recall': 0.8130361, 'specificity': 0.8130361, 'f1': 0.79190063, 'auroc': 0.956048, 'binary_precision': 0.55924857, 'binary_recall': 0.64285713, 'binary_specificity': 0.98321503, 'binary_f1_score': 0.59814525}
confusion matrix:
       0    1
0  17866  305
1    215  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.927423, 'recall': 0.7444504, 'specificity': 0.7444504, 'f1': 0.8090297, 'auroc': 0.9300532, 'binary_precision': 0.875, 'binary_recall': 0.49173555, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6296296}
confusion matrix:
      0    1
0  5980   17
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 20,now: 2024-05-30 17:13:44.145958,epoch time: 0:20:13.645440,used: 6:45:08.773017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96894395, 'precision': 0.7642981, 'recall': 0.825228, 'specificity': 0.825228, 'f1': 0.7912453, 'auroc': 0.9613654, 'binary_precision': 0.5404686, 'binary_recall': 0.6708526, 'binary_specificity': 0.9796034, 'binary_f1_score': 0.5986435}
confusion matrix:
       0     1
0  41448   863
1    498  1015
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7490158, 'recall': 0.83043814, 'specificity': 0.83043814, 'f1': 0.7833534, 'auroc': 0.95490074, 'binary_precision': 0.50866336, 'binary_recall': 0.68272424, 'binary_specificity': 0.978152, 'binary_f1_score': 0.58297867}
confusion matrix:
       0    1
0  17774  397
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793236, 'precision': 0.94661736, 'recall': 0.75726396, 'specificity': 0.75726396, 'f1': 0.8244843, 'auroc': 0.937014, 'binary_precision': 0.91240877, 'binary_recall': 0.5165289, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6596306}
confusion matrix:
      0    1
0  5985   12
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9686784148216248, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9775605201721191 / 0.9804455637931824
after epoch: 21,now: 2024-05-30 17:33:53.556586,epoch time: 0:20:09.410628,used: 7:05:18.183645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97138554, 'precision': 0.7818057, 'recall': 0.81470233, 'specificity': 0.81470233, 'f1': 0.7972473, 'auroc': 0.9662216, 'binary_precision': 0.5763111, 'binary_recall': 0.6463979, 'binary_specificity': 0.9830068, 'binary_f1_score': 0.6093458}
confusion matrix:
       0    1
0  41592  719
1    535  978
---- Validation: 
scalar performance:
{'acc': 0.9715549, 'precision': 0.7676622, 'recall': 0.82228744, 'specificity': 0.82228744, 'f1': 0.7921767, 'auroc': 0.9579219, 'binary_precision': 0.54657537, 'binary_recall': 0.6627907, 'binary_specificity': 0.98178416, 'binary_f1_score': 0.5990991}
confusion matrix:
       0    1
0  17840  331
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97980446, 'precision': 0.942201, 'recall': 0.7674278, 'specificity': 0.7674278, 'f1': 0.83157754, 'auroc': 0.9341227, 'binary_precision': 0.9027778, 'binary_recall': 0.5371901, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6735751}
confusion matrix:
      0    1
0  5983   14
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 2
val acc:0.9715548753738403, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9775605201721191 / 0.9804455637931824
after epoch: 22,now: 2024-05-30 17:54:00.403122,epoch time: 0:20:06.846536,used: 7:25:25.030181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9713399, 'precision': 0.7798879, 'recall': 0.83124864, 'specificity': 0.83124864, 'f1': 0.8031684, 'auroc': 0.96360743, 'binary_precision': 0.5712701, 'binary_recall': 0.6807667, 'binary_specificity': 0.9817305, 'binary_f1_score': 0.6212304}
confusion matrix:
       0     1
0  41538   773
1    483  1030
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.7680938, 'recall': 0.8376279, 'specificity': 0.8376279, 'f1': 0.7984406, 'auroc': 0.95869124, 'binary_precision': 0.54640526, 'binary_recall': 0.69435215, 'binary_specificity': 0.9809036, 'binary_f1_score': 0.61155814}
confusion matrix:
       0    1
0  17824  347
1    184  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9796442, 'precision': 0.92669034, 'recall': 0.77725816, 'specificity': 0.77725816, 'f1': 0.8347942, 'auroc': 0.9344876, 'binary_precision': 0.87096775, 'binary_recall': 0.55785125, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6801008}
confusion matrix:
      0    1
0  5977   20
1   107  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 3
val acc:0.9717146754264832, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9775605201721191 / 0.9804455637931824
after epoch: 23,now: 2024-05-30 18:13:53.979832,epoch time: 0:19:53.576710,used: 7:45:18.606891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97197884, 'precision': 0.7848433, 'recall': 0.82743704, 'specificity': 0.82743704, 'f1': 0.8044958, 'auroc': 0.9668823, 'binary_precision': 0.58147514, 'binary_recall': 0.6721745, 'binary_specificity': 0.9826995, 'binary_f1_score': 0.62354386}
confusion matrix:
       0     1
0  41579   732
1    496  1017
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.77430856, 'recall': 0.81550026, 'specificity': 0.81550026, 'f1': 0.79331696, 'auroc': 0.95655334, 'binary_precision': 0.5603448, 'binary_recall': 0.64784056, 'binary_specificity': 0.98315996, 'binary_f1_score': 0.6009245}
confusion matrix:
       0    1
0  17865  306
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.95513266, 'recall': 0.7471835, 'specificity': 0.7471835, 'f1': 0.81804, 'auroc': 0.933296, 'binary_precision': 0.9302326, 'binary_recall': 0.49586776, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.6469003}
confusion matrix:
      0    1
0  5988    9
1   122  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 24,now: 2024-05-30 18:34:10.244810,epoch time: 0:20:16.264978,used: 8:05:34.871869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9682822, 'precision': 0.75985605, 'recall': 0.8522894, 'specificity': 0.8522894, 'f1': 0.79824615, 'auroc': 0.9648514, 'binary_precision': 0.52958155, 'binary_recall': 0.7276933, 'binary_specificity': 0.97688544, 'binary_f1_score': 0.613029}
confusion matrix:
       0     1
0  41333   978
1    412  1101
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7463839, 'recall': 0.86383593, 'specificity': 0.86383593, 'f1': 0.7924727, 'auroc': 0.95869297, 'binary_precision': 0.5011062, 'binary_recall': 0.7524917, 'binary_specificity': 0.9751802, 'binary_f1_score': 0.6015936}
confusion matrix:
       0    1
0  17720  451
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9796442, 'precision': 0.94178057, 'recall': 0.76536167, 'specificity': 0.76536167, 'f1': 0.82981396, 'auroc': 0.93684924, 'binary_precision': 0.9020979, 'binary_recall': 0.53305787, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6701299}
confusion matrix:
      0    1
0  5983   14
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9680392146110535, best validation acc: 0.9724071621894836, corresponding to test acc:                         0.9790030717849731 / 0.9804455637931824
after epoch: 25,now: 2024-05-30 18:54:08.969111,epoch time: 0:19:58.724301,used: 8:25:33.596170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97191036, 'precision': 0.78266597, 'recall': 0.84429014, 'specificity': 0.84429014, 'f1': 0.81011, 'auroc': 0.9691514, 'binary_precision': 0.57588804, 'binary_recall': 0.7072042, 'binary_specificity': 0.981376, 'binary_f1_score': 0.6348265}
confusion matrix:
       0     1
0  41523   788
1    443  1070
---- Validation: 
scalar performance:
{'acc': 0.97315294, 'precision': 0.77737737, 'recall': 0.84800744, 'specificity': 0.84800744, 'f1': 0.80828446, 'auroc': 0.96251684, 'binary_precision': 0.5643045, 'binary_recall': 0.71428573, 'binary_specificity': 0.98172915, 'binary_f1_score': 0.6304985}
confusion matrix:
       0    1
0  17839  332
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.92653483, 'recall': 0.7649448, 'specificity': 0.7649448, 'f1': 0.8253093, 'auroc': 0.93583155, 'binary_precision': 0.8716216, 'binary_recall': 0.53305787, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.6615384}
confusion matrix:
      0    1
0  5978   19
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 26,now: 2024-05-30 19:14:36.471934,epoch time: 0:20:27.502823,used: 8:46:01.098993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97225267, 'precision': 0.7862661, 'recall': 0.83267725, 'specificity': 0.83267725, 'f1': 0.8075404, 'auroc': 0.9682921, 'binary_precision': 0.58394575, 'binary_recall': 0.6827495, 'binary_specificity': 0.982605, 'binary_f1_score': 0.62949425}
confusion matrix:
       0     1
0  41575   736
1    480  1033
---- Validation: 
scalar performance:
{'acc': 0.9736856, 'precision': 0.78301084, 'recall': 0.82820636, 'specificity': 0.82820636, 'f1': 0.80376756, 'auroc': 0.962714, 'binary_precision': 0.5769231, 'binary_recall': 0.67275745, 'binary_specificity': 0.9836553, 'binary_f1_score': 0.62116563}
confusion matrix:
       0    1
0  17874  297
1    197  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98108673, 'precision': 0.95641804, 'recall': 0.7760258, 'specificity': 0.7760258, 'f1': 0.842271, 'auroc': 0.94029284, 'binary_precision': 0.9305556, 'binary_recall': 0.553719, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.6943005}
confusion matrix:
      0    1
0  5987   10
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-05-30 19:35:07.365749,epoch time: 0:20:30.893815,used: 9:06:31.992808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97421503, 'precision': 0.80080914, 'recall': 0.8359241, 'specificity': 0.8359241, 'f1': 0.8172962, 'auroc': 0.96910477, 'binary_precision': 0.6128462, 'binary_recall': 0.6873761, 'binary_specificity': 0.9844721, 'binary_f1_score': 0.6479751}
confusion matrix:
       0     1
0  41654   657
1    473  1040
---- Validation: 
scalar performance:
{'acc': 0.9751238, 'precision': 0.79492474, 'recall': 0.8265402, 'specificity': 0.8265402, 'f1': 0.80984944, 'auroc': 0.9642994, 'binary_precision': 0.60089684, 'binary_recall': 0.6677741, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.63257277}
confusion matrix:
       0    1
0  17904  267
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9778811, 'precision': 0.9428157, 'recall': 0.7386689, 'specificity': 0.7386689, 'f1': 0.8078148, 'auroc': 0.9260982, 'binary_precision': 0.90625, 'binary_recall': 0.47933885, 'binary_specificity': 0.997999, 'binary_f1_score': 0.62702703}
confusion matrix:
      0    1
0  5985   12
1   126  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 28,now: 2024-05-30 19:55:23.956099,epoch time: 0:20:16.590350,used: 9:26:48.583158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97364455, 'precision': 0.7983712, 'recall': 0.82320124, 'specificity': 0.82320124, 'f1': 0.8102381, 'auroc': 0.9702046, 'binary_precision': 0.60888076, 'binary_recall': 0.66159946, 'binary_specificity': 0.984803, 'binary_f1_score': 0.6341464}
confusion matrix:
       0     1
0  41668   643
1    512  1001
---- Validation: 
scalar performance:
{'acc': 0.9756033, 'precision': 0.8029898, 'recall': 0.80590856, 'specificity': 0.80590856, 'f1': 0.8044416, 'auroc': 0.96221817, 'binary_precision': 0.6184211, 'binary_recall': 0.62458473, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.6214877}
confusion matrix:
       0    1
0  17939  232
1    226  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783619, 'precision': 0.94721705, 'recall': 0.7428845, 'specificity': 0.7428845, 'f1': 0.812484, 'auroc': 0.93399525, 'binary_precision': 0.9147287, 'binary_recall': 0.4876033, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.6361186}
confusion matrix:
      0    1
0  5986   11
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
better model found
persisted
after epoch: 29,now: 2024-05-30 20:15:37.263740,epoch time: 0:20:13.307641,used: 9:47:01.890799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97250366, 'precision': 0.78631926, 'recall': 0.84873986, 'specificity': 0.84873986, 'f1': 0.81412065, 'auroc': 0.96856344, 'binary_precision': 0.58288485, 'binary_recall': 0.7157964, 'binary_specificity': 0.98168325, 'binary_f1_score': 0.6425393}
confusion matrix:
       0     1
0  41536   775
1    430  1083
---- Validation: 
scalar performance:
{'acc': 0.97443134, 'precision': 0.78819025, 'recall': 0.8342129, 'specificity': 0.8342129, 'f1': 0.80932873, 'auroc': 0.9634547, 'binary_precision': 0.5868946, 'binary_recall': 0.68438536, 'binary_specificity': 0.9840405, 'binary_f1_score': 0.6319018}
confusion matrix:
       0    1
0  17881  290
1    190  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.9336691, 'recall': 0.7569305, 'specificity': 0.7569305, 'f1': 0.8208726, 'auroc': 0.93860424, 'binary_precision': 0.8865248, 'binary_recall': 0.5165289, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6527415}
confusion matrix:
      0    1
0  5981   16
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993753.png
early stop counter: 1
val acc:0.9744313359260559, best validation acc: 0.9756032824516296, corresponding to test acc:                         0.9783619046211243 / 0.9810867309570312
after epoch: 30,now: 2024-05-30 20:35:49.615446,epoch time: 0:20:12.351706,used: 10:07:14.242505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_10_28_35_seed_2_20993753
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:07:14.242505 at 2024-05-30 20:35:49.615446
persisted model performance metric: 

scalar performance:
{'acc': 0.97980446, 'precision': 0.9600359, 'recall': 0.7555313, 'specificity': 0.7555313, 'f1': 0.8263459, 'auroc': 0.941618, 'binary_precision': 0.93939394, 'binary_recall': 0.5123967, 'binary_specificity': 0.998666, 'binary_f1_score': 0.6631016}
confusion matrix:
      0    1
0  5989    8
1   118  124
oracle model performance metric: 

scalar performance:
{'acc': 0.9794839, 'precision': 0.94997334, 'recall': 0.75734735, 'specificity': 0.75734735, 'f1': 0.82539856, 'auroc': 0.9361888, 'binary_precision': 0.9191176, 'binary_recall': 0.5165289, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.66137564}
confusion matrix:
      0    1
0  5986   11
1   117  125
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486101 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |  89813 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486101 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |  89813 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |   1821 MiB |   4204 TiB |   4204 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   4194 TiB |   4194 TiB |
|       from small pool |  88732 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2044 MiB |   2108 MiB |   3256 MiB |   1212 MiB |
|       from large pool |   1920 MiB |   1982 MiB |   3070 MiB |   1150 MiB |
|       from small pool |    124 MiB |    126 MiB |    186 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1011 MiB |   1198 MiB |   2214 TiB |   2214 TiB |
|       from large pool |   1005 MiB |   1178 MiB |   2203 TiB |   2203 TiB |
|       from small pool |      6 MiB |     27 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6708    |  387456 K  |  387452 K  |
|       from large pool |      87    |     178    |  166600 K  |  166600 K  |
|       from small pool |    3630    |    6620    |  220855 K  |  220851 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6708    |  387456 K  |  387452 K  |
|       from large pool |      87    |     178    |  166600 K  |  166600 K  |
|       from small pool |    3630    |    6620    |  220855 K  |  220851 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |      96    |     134    |      44    |
|       from large pool |      28    |      33    |      41    |      13    |
|       from small pool |      62    |      63    |      93    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    2771    |  162624 K  |  162624 K  |
|       from large pool |      18    |      27    |   60482 K  |   60482 K  |
|       from small pool |      34    |    2750    |  102142 K  |  102142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |      0 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |      0 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   4204 TiB |   4204 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   4194 TiB |   4194 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1486 MiB |   2108 MiB |   3256 MiB |   1770 MiB |
|       from large pool |   1392 MiB |   1982 MiB |   3070 MiB |   1678 MiB |
|       from small pool |     94 MiB |    126 MiB |    186 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   2214 TiB |   2214 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   2203 TiB |   2203 TiB |
|       from small pool |      0 KiB |     27 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  387456 K  |  387456 K  |
|       from large pool |       2    |     178    |  166600 K  |  166600 K  |
|       from small pool |       0    |    6620    |  220855 K  |  220855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  387456 K  |  387456 K  |
|       from large pool |       2    |     178    |  166600 K  |  166600 K  |
|       from small pool |       0    |    6620    |  220855 K  |  220855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      96    |     134    |      63    |
|       from large pool |      24    |      33    |      41    |      17    |
|       from small pool |      47    |      63    |      93    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  162625 K  |  162625 K  |
|       from large pool |       4    |      27    |   60482 K  |   60482 K  |
|       from small pool |       0    |    2750    |  102143 K  |  102143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu May 30 20:37:47 2024]
Finished job 0.
1 of 1 steps (100%) done
