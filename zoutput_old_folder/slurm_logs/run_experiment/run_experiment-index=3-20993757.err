Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu May 30 19:40:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757

 Experiment start at: 2024-05-30 19:50:46.966958
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9681677, 'precision': 0.7909295, 'recall': 0.57141125, 'specificity': 0.57141125, 'f1': 0.6097455, 'auroc': 0.94728947, 'binary_precision': 0.61079544, 'binary_recall': 0.14605978, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.23574561}
confusion matrix:
       0    1
0  42183  137
1   1257  215
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.785015, 'recall': 0.563776, 'specificity': 0.563776, 'f1': 0.5989239, 'auroc': 0.9494202, 'binary_precision': 0.6, 'binary_recall': 0.13063763, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.21455938}
confusion matrix:
       0   1
0  18093  56
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.9654547, 'recall': 0.60328156, 'specificity': 0.60328156, 'f1': 0.6617807, 'auroc': 0.93430895, 'binary_precision': 0.96428573, 'binary_recall': 0.20689656, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.340694}
confusion matrix:
      0   1
0  5995   2
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 20:19:31.711130,epoch time: 0:28:44.744172,used: 0:28:44.744172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9745159, 'precision': 0.8384675, 'recall': 0.71056294, 'specificity': 0.71056294, 'f1': 0.7584051, 'auroc': 0.9602136, 'binary_precision': 0.696567, 'binary_recall': 0.42760026, 'binary_specificity': 0.9935257, 'binary_f1_score': 0.52990735}
confusion matrix:
       0    1
0  42047  274
1    842  629
---- Validation: 
scalar performance:
{'acc': 0.97349936, 'precision': 0.8511565, 'recall': 0.6795076, 'specificity': 0.6795076, 'f1': 0.7354361, 'auroc': 0.9646244, 'binary_precision': 0.7244582, 'binary_recall': 0.36391914, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.48447207}
confusion matrix:
       0    1
0  18060   89
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.9740331, 'recall': 0.6607528, 'specificity': 0.6607528, 'f1': 0.7347202, 'auroc': 0.9443379, 'binary_precision': 0.9767442, 'binary_recall': 0.3218391, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.48414984}
confusion matrix:
      0   1
0  5995   2
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 20:46:48.074911,epoch time: 0:27:16.363781,used: 0:56:01.107953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97453874, 'precision': 0.7945758, 'recall': 0.8602729, 'specificity': 0.8602729, 'f1': 0.8237789, 'auroc': 0.9694979, 'binary_precision': 0.5983471, 'binary_recall': 0.73777175, 'binary_specificity': 0.9827741, 'binary_f1_score': 0.6607849}
confusion matrix:
       0     1
0  41591   729
1    386  1086
---- Validation: 
scalar performance:
{'acc': 0.9735526, 'precision': 0.7899798, 'recall': 0.867049, 'specificity': 0.867049, 'f1': 0.8234954, 'auroc': 0.9664184, 'binary_precision': 0.58880776, 'binary_recall': 0.7527216, 'binary_specificity': 0.9813764, 'binary_f1_score': 0.66075087}
confusion matrix:
       0    1
0  17811  338
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.9030476, 'recall': 0.81500614, 'specificity': 0.81500614, 'f1': 0.85309696, 'auroc': 0.9507899, 'binary_precision': 0.8217822, 'binary_recall': 0.6360153, 'binary_specificity': 0.993997, 'binary_f1_score': 0.7170626}
confusion matrix:
      0    1
0  5961   36
1    95  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 21:14:26.693973,epoch time: 0:27:38.619062,used: 1:23:39.727015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9782837, 'precision': 0.84525806, 'recall': 0.8009009, 'specificity': 0.8009009, 'f1': 0.82142305, 'auroc': 0.971908, 'binary_precision': 0.70399374, 'binary_recall': 0.6107337, 'binary_specificity': 0.99106807, 'binary_f1_score': 0.654056}
confusion matrix:
       0    1
0  41942  378
1    573  899
---- Validation: 
scalar performance:
{'acc': 0.9770647, 'precision': 0.8254725, 'recall': 0.8298644, 'specificity': 0.8298644, 'f1': 0.82765234, 'auroc': 0.96898186, 'binary_precision': 0.6625767, 'binary_recall': 0.6718507, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.66718143}
confusion matrix:
       0    1
0  17929  220
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.91338325, 'recall': 0.7072282, 'specificity': 0.7072282, 'f1': 0.77315533, 'auroc': 0.94931614, 'binary_precision': 0.8515625, 'binary_recall': 0.41762453, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.56041133}
confusion matrix:
      0    1
0  5978   19
1   152  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 4,now: 2024-05-30 21:42:00.417391,epoch time: 0:27:33.723418,used: 1:51:13.450433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9775301, 'precision': 0.91808605, 'recall': 0.69789106, 'specificity': 0.69789106, 'f1': 0.7660404, 'auroc': 0.9747635, 'binary_precision': 0.85672516, 'binary_recall': 0.3980978, 'binary_specificity': 0.9976843, 'binary_f1_score': 0.54359925}
confusion matrix:
       0    1
0  42222   98
1    886  586
---- Validation: 
scalar performance:
{'acc': 0.9780226, 'precision': 0.925393, 'recall': 0.70885134, 'specificity': 0.70885134, 'f1': 0.7776785, 'auroc': 0.97234976, 'binary_precision': 0.87096775, 'binary_recall': 0.41990668, 'binary_specificity': 0.997796, 'binary_f1_score': 0.5666316}
confusion matrix:
       0    1
0  18109   40
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84009373, 'recall': 0.59411794, 'specificity': 0.59411794, 'f1': 0.64157856, 'auroc': 0.9445954, 'binary_precision': 0.71428573, 'binary_recall': 0.19157088, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3021148}
confusion matrix:
      0   1
0  5977  20
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 5,now: 2024-05-30 22:09:19.089566,epoch time: 0:27:18.672175,used: 2:18:32.122608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9809554, 'precision': 0.8468826, 'recall': 0.8704779, 'specificity': 0.8704779, 'f1': 0.8582562, 'auroc': 0.97647405, 'binary_precision': 0.7024112, 'binary_recall': 0.75203806, 'binary_specificity': 0.98891777, 'binary_f1_score': 0.726378}
confusion matrix:
       0     1
0  41851   469
1    365  1107
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.8561424, 'recall': 0.8620155, 'specificity': 0.8620155, 'f1': 0.8590527, 'auroc': 0.9764005, 'binary_precision': 0.7217125, 'binary_recall': 0.7340591, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.72783345}
confusion matrix:
       0    1
0  17967  182
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.84763813, 'recall': 0.69023496, 'specificity': 0.69023496, 'f1': 0.74365735, 'auroc': 0.95086753, 'binary_precision': 0.7214286, 'binary_recall': 0.38697317, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.5037406}
confusion matrix:
      0    1
0  5958   39
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 6,now: 2024-05-30 22:36:41.069473,epoch time: 0:27:21.979907,used: 2:45:54.102515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98305625, 'precision': 0.91479397, 'recall': 0.80271447, 'specificity': 0.80271447, 'f1': 0.8493444, 'auroc': 0.9810336, 'binary_precision': 0.8430451, 'binary_recall': 0.609375, 'binary_specificity': 0.9960539, 'binary_f1_score': 0.7074133}
confusion matrix:
       0    1
0  42153  167
1    575  897
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.8983026, 'recall': 0.7884275, 'specificity': 0.7884275, 'f1': 0.83388877, 'auroc': 0.97518146, 'binary_precision': 0.81127983, 'binary_recall': 0.5816485, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.67753625}
confusion matrix:
       0    1
0  18062   87
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.90774095, 'recall': 0.57604474, 'specificity': 0.57604474, 'f1': 0.62053204, 'auroc': 0.95282185, 'binary_precision': 0.85106385, 'binary_recall': 0.1532567, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.25974026}
confusion matrix:
      0   1
0  5990   7
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9810557961463928, best validation acc: 0.9812154173851013, corresponding to test acc:                         0.96820068359375 / 0.979066789150238
after epoch: 7,now: 2024-05-30 23:03:50.587600,epoch time: 0:27:09.518127,used: 3:13:03.620642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9831476, 'precision': 0.8855946, 'recall': 0.8424326, 'specificity': 0.8424326, 'f1': 0.8626282, 'auroc': 0.98052263, 'binary_precision': 0.78187406, 'binary_recall': 0.69157606, 'binary_specificity': 0.99328923, 'binary_f1_score': 0.7339582}
confusion matrix:
       0     1
0  42036   284
1    454  1018
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.9015764, 'recall': 0.81472826, 'specificity': 0.81472826, 'f1': 0.85246867, 'auroc': 0.9749696, 'binary_precision': 0.816, 'binary_recall': 0.63452566, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.71391076}
confusion matrix:
       0    1
0  18057   92
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8843163, 'recall': 0.67049617, 'specificity': 0.67049617, 'f1': 0.7326529, 'auroc': 0.96264887, 'binary_precision': 0.79646015, 'binary_recall': 0.3448276, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.48128337}
confusion matrix:
      0   1
0  5974  23
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 8,now: 2024-05-30 23:31:12.287341,epoch time: 0:27:21.699741,used: 3:40:25.320383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98383266, 'precision': 0.8735491, 'recall': 0.87942845, 'specificity': 0.87942845, 'f1': 0.8764638, 'auroc': 0.9823022, 'binary_precision': 0.75518394, 'binary_recall': 0.7675051, 'binary_specificity': 0.9913518, 'binary_f1_score': 0.76129466}
confusion matrix:
       0     1
0  41955   366
1    342  1129
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.8835921, 'recall': 0.8163999, 'specificity': 0.8163999, 'f1': 0.8465037, 'auroc': 0.9762316, 'binary_precision': 0.7798861, 'binary_recall': 0.63919127, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.7025641}
confusion matrix:
       0    1
0  18033  116
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.880387, 'recall': 0.67607653, 'specificity': 0.67607653, 'f1': 0.7374317, 'auroc': 0.961969, 'binary_precision': 0.7881356, 'binary_recall': 0.35632184, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.49076518}
confusion matrix:
      0   1
0  5972  25
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9814814925193787, best validation acc: 0.9825989603996277, corresponding to test acc:                         0.9689996838569641 / 0.979066789150238
after epoch: 9,now: 2024-05-30 23:58:41.945485,epoch time: 0:27:29.658144,used: 4:07:54.978527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9845406, 'precision': 0.9156786, 'recall': 0.8297111, 'specificity': 0.8297111, 'f1': 0.86735713, 'auroc': 0.98437625, 'binary_precision': 0.84296805, 'binary_recall': 0.6637228, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.74268335}
confusion matrix:
       0    1
0  42138  182
1    495  977
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.9216505, 'recall': 0.7813952, 'specificity': 0.7813952, 'f1': 0.8365017, 'auroc': 0.97763425, 'binary_precision': 0.8584906, 'binary_recall': 0.5660964, 'binary_specificity': 0.996694, 'binary_f1_score': 0.6822868}
confusion matrix:
       0    1
0  18089   60
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8228915, 'recall': 0.65566885, 'specificity': 0.65566885, 'f1': 0.7071613, 'auroc': 0.95947444, 'binary_precision': 0.67479676, 'binary_recall': 0.31800765, 'binary_specificity': 0.99333, 'binary_f1_score': 0.43229166}
confusion matrix:
      0   1
0  5957  40
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9819604158401489, best validation acc: 0.9825989603996277, corresponding to test acc:                         0.9689996838569641 / 0.979066789150238
after epoch: 10,now: 2024-05-31 00:25:55.868287,epoch time: 0:27:13.922802,used: 4:35:08.901329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98467755, 'precision': 0.9197972, 'recall': 0.82725513, 'specificity': 0.82725513, 'f1': 0.8673599, 'auroc': 0.9841031, 'binary_precision': 0.85136324, 'binary_recall': 0.6585034, 'binary_specificity': 0.9960068, 'binary_f1_score': 0.74261606}
confusion matrix:
       0    1
0  42153  169
1    502  968
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.91211593, 'recall': 0.8204745, 'specificity': 0.8204745, 'f1': 0.8601154, 'auroc': 0.9759687, 'binary_precision': 0.8366935, 'binary_recall': 0.64541215, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.7287094}
confusion matrix:
       0    1
0  18068   81
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.87992525, 'recall': 0.61552423, 'specificity': 0.61552423, 'f1': 0.67160493, 'auroc': 0.9545836, 'binary_precision': 0.7922078, 'binary_recall': 0.23371647, 'binary_specificity': 0.997332, 'binary_f1_score': 0.36094677}
confusion matrix:
      0   1
0  5981  16
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 11,now: 2024-05-31 00:53:20.135569,epoch time: 0:27:24.267282,used: 5:02:33.168611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9861162, 'precision': 0.92506564, 'recall': 0.848129, 'specificity': 0.848129, 'f1': 0.882477, 'auroc': 0.9844387, 'binary_precision': 0.86048454, 'binary_recall': 0.70020396, 'binary_specificity': 0.996054, 'binary_f1_score': 0.772114}
confusion matrix:
       0     1
0  42154   167
1    441  1030
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.93749183, 'recall': 0.79263985, 'specificity': 0.79263985, 'f1': 0.8496605, 'auroc': 0.97929454, 'binary_precision': 0.88941175, 'binary_recall': 0.58786935, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.7078652}
confusion matrix:
       0    1
0  18102   47
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8717783, 'recall': 0.5927025, 'specificity': 0.5927025, 'f1': 0.64196616, 'auroc': 0.9518292, 'binary_precision': 0.7777778, 'binary_recall': 0.18773946, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3024691}
confusion matrix:
      0   1
0  5983  14
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9654842019081116 / 0.979066789150238
after epoch: 12,now: 2024-05-31 01:20:53.055384,epoch time: 0:27:32.919815,used: 5:30:06.088426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9862532, 'precision': 0.90265584, 'recall': 0.88043183, 'specificity': 0.88043183, 'f1': 0.8912025, 'auroc': 0.98476267, 'binary_precision': 0.81340057, 'binary_recall': 0.7669837, 'binary_specificity': 0.99388, 'binary_f1_score': 0.7895104}
confusion matrix:
       0     1
0  42061   259
1    343  1129
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.88365686, 'recall': 0.86867094, 'specificity': 0.86867094, 'f1': 0.8760017, 'auroc': 0.97839504, 'binary_precision': 0.7763371, 'binary_recall': 0.7449456, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.7603175}
confusion matrix:
       0    1
0  18011  138
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8454648, 'recall': 0.64126027, 'specificity': 0.64126027, 'f1': 0.69663244, 'auroc': 0.95346904, 'binary_precision': 0.72115386, 'binary_recall': 0.28735632, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.41095892}
confusion matrix:
      0   1
0  5968  29
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 13,now: 2024-05-31 01:48:57.710102,epoch time: 0:28:04.654718,used: 5:58:10.743144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9860477, 'precision': 0.9534178, 'recall': 0.8196716, 'specificity': 0.8196716, 'f1': 0.8741605, 'auroc': 0.98657596, 'binary_precision': 0.91918206, 'binary_recall': 0.6413044, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.75550216}
confusion matrix:
       0    1
0  42237   83
1    528  944
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.94590116, 'recall': 0.75492287, 'specificity': 0.75492287, 'f1': 0.82262003, 'auroc': 0.9803674, 'binary_precision': 0.90883976, 'binary_recall': 0.5116641, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.6547264}
confusion matrix:
       0    1
0  18116   33
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8211576, 'recall': 0.5750442, 'specificity': 0.5750442, 'f1': 0.6151607, 'auroc': 0.949316, 'binary_precision': 0.6779661, 'binary_recall': 0.1532567, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24999999}
confusion matrix:
      0   1
0  5978  19
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9815347194671631, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9656440019607544 / 0.979066789150238
after epoch: 14,now: 2024-05-31 02:16:26.193804,epoch time: 0:27:28.483702,used: 6:25:39.226846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.985591, 'precision': 0.89011675, 'recall': 0.88730216, 'specificity': 0.88730216, 'f1': 0.88870394, 'auroc': 0.9869262, 'binary_precision': 0.7878166, 'binary_recall': 0.7819294, 'binary_specificity': 0.9926749, 'binary_f1_score': 0.7848619}
confusion matrix:
       0     1
0  42010   310
1    321  1151
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.87663853, 'recall': 0.8675903, 'specificity': 0.8675903, 'f1': 0.8720546, 'auroc': 0.97834504, 'binary_precision': 0.76236045, 'binary_recall': 0.7433904, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.75275594}
confusion matrix:
       0    1
0  18000  149
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8106981, 'recall': 0.6029461, 'specificity': 0.6029461, 'f1': 0.6497662, 'auroc': 0.95000505, 'binary_precision': 0.6547619, 'binary_recall': 0.21072797, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31884056}
confusion matrix:
      0   1
0  5968  29
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9832907915115356, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9656440019607544 / 0.979066789150238
after epoch: 15,now: 2024-05-31 02:43:28.659583,epoch time: 0:27:02.465779,used: 6:52:41.692625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9870068, 'precision': 0.9501804, 'recall': 0.83830976, 'specificity': 0.83830976, 'f1': 0.88573754, 'auroc': 0.9888896, 'binary_precision': 0.9114155, 'binary_recall': 0.67891157, 'binary_specificity': 0.997708, 'binary_f1_score': 0.77816767}
confusion matrix:
       0    1
0  42225   97
1    472  998
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.91839993, 'recall': 0.81450164, 'specificity': 0.81450164, 'f1': 0.8585215, 'auroc': 0.9753397, 'binary_precision': 0.84968686, 'binary_recall': 0.63297045, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.72549015}
confusion matrix:
       0    1
0  18077   72
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.84191, 'recall': 0.57721007, 'specificity': 0.57721007, 'f1': 0.6192571, 'auroc': 0.94884145, 'binary_precision': 0.71929824, 'binary_recall': 0.15708812, 'binary_specificity': 0.997332, 'binary_f1_score': 0.2578616}
confusion matrix:
      0   1
0  5981  16
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9836100339889526, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9656440019607544 / 0.979066789150238
after epoch: 16,now: 2024-05-31 03:10:25.762432,epoch time: 0:26:57.102849,used: 7:19:38.795474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9886281, 'precision': 0.91574585, 'recall': 0.9075614, 'specificity': 0.9075614, 'f1': 0.91160965, 'auroc': 0.989278, 'binary_precision': 0.8377254, 'binary_recall': 0.8206522, 'binary_specificity': 0.9944707, 'binary_f1_score': 0.82910085}
confusion matrix:
       0     1
0  42086   234
1    264  1208
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9114316, 'recall': 0.85746896, 'specificity': 0.85746896, 'f1': 0.8824036, 'auroc': 0.9801372, 'binary_precision': 0.8327338, 'binary_recall': 0.7200622, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.77231026}
confusion matrix:
       0    1
0  18056   93
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.851447, 'recall': 0.63009953, 'specificity': 0.63009953, 'f1': 0.6854443, 'auroc': 0.9595345, 'binary_precision': 0.7340425, 'binary_recall': 0.26436782, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3887324}
confusion matrix:
      0   1
0  5972  25
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 17,now: 2024-05-31 03:37:39.029245,epoch time: 0:27:13.266813,used: 7:46:52.062287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9873721, 'precision': 0.94282305, 'recall': 0.8518313, 'specificity': 0.8518313, 'f1': 0.8917319, 'auroc': 0.9868864, 'binary_precision': 0.8957795, 'binary_recall': 0.70652175, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.78997344}
confusion matrix:
       0     1
0  42199   121
1    432  1040
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.9358182, 'recall': 0.79955566, 'specificity': 0.79955566, 'f1': 0.85414207, 'auroc': 0.9785376, 'binary_precision': 0.8855835, 'binary_recall': 0.60186625, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7166667}
confusion matrix:
       0    1
0  18099   50
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8536277, 'recall': 0.6075279, 'specificity': 0.6075279, 'f1': 0.6594422, 'auroc': 0.9282727, 'binary_precision': 0.74025977, 'binary_recall': 0.21839081, 'binary_specificity': 0.996665, 'binary_f1_score': 0.33727813}
confusion matrix:
      0   1
0  5977  20
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9837164878845215, best validation acc: 0.985472559928894, corresponding to test acc:                         0.9653244018554688 / 0.979066789150238
after epoch: 18,now: 2024-05-31 04:04:49.440675,epoch time: 0:27:10.411430,used: 8:14:02.473717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98732644, 'precision': 0.9495107, 'recall': 0.84448993, 'specificity': 0.84448993, 'f1': 0.8895509, 'auroc': 0.991382, 'binary_precision': 0.9096601, 'binary_recall': 0.69136643, 'binary_specificity': 0.9976135, 'binary_f1_score': 0.78563154}
confusion matrix:
       0     1
0  42220   101
1    454  1017
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.93811226, 'recall': 0.83132726, 'specificity': 0.83132726, 'f1': 0.87675536, 'auroc': 0.97714835, 'binary_precision': 0.8879668, 'binary_recall': 0.66562986, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.7608889}
confusion matrix:
       0    1
0  18095   54
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8641654, 'recall': 0.57937586, 'specificity': 0.57937586, 'f1': 0.6234032, 'auroc': 0.95976067, 'binary_precision': 0.76363635, 'binary_recall': 0.16091955, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.2658228}
confusion matrix:
      0   1
0  5984  13
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 19,now: 2024-05-31 04:32:06.084119,epoch time: 0:27:16.643444,used: 8:41:19.117161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98629886, 'precision': 0.8850608, 'recall': 0.9122578, 'specificity': 0.9122578, 'f1': 0.89815485, 'auroc': 0.9902013, 'binary_precision': 0.77594936, 'binary_recall': 0.83288044, 'binary_specificity': 0.99163514, 'binary_f1_score': 0.8034076}
confusion matrix:
       0     1
0  41966   354
1    246  1226
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.88445944, 'recall': 0.89022344, 'specificity': 0.89022344, 'f1': 0.88731813, 'auroc': 0.97820306, 'binary_precision': 0.77641654, 'binary_recall': 0.7884914, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.78240734}
confusion matrix:
       0    1
0  18003  146
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8184335, 'recall': 0.64617366, 'specificity': 0.64617366, 'f1': 0.69720435, 'auroc': 0.9573208, 'binary_precision': 0.6666667, 'binary_recall': 0.29885057, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4126984}
confusion matrix:
      0   1
0  5958  39
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9849936366081238, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9629274606704712 / 0.979066789150238
after epoch: 20,now: 2024-05-31 04:59:05.228263,epoch time: 0:26:59.144144,used: 9:08:18.261305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9886509, 'precision': 0.9254619, 'recall': 0.89438874, 'specificity': 0.89438874, 'f1': 0.90928984, 'auroc': 0.99034834, 'binary_precision': 0.85808825, 'binary_recall': 0.7933379, 'binary_specificity': 0.9954396, 'binary_f1_score': 0.82444376}
confusion matrix:
       0     1
0  42128   193
1    304  1167
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9019104, 'recall': 0.88560677, 'specificity': 0.88560677, 'f1': 0.8935756, 'auroc': 0.97884357, 'binary_precision': 0.8116883, 'binary_recall': 0.777605, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.79428124}
confusion matrix:
       0    1
0  18033  116
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8378846, 'recall': 0.61852187, 'specificity': 0.61852187, 'f1': 0.670794, 'auroc': 0.9555378, 'binary_precision': 0.7078652, 'binary_recall': 0.2413793, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.35999998}
confusion matrix:
      0   1
0  5971  26
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 21,now: 2024-05-31 05:25:59.961740,epoch time: 0:26:54.733477,used: 9:35:12.994782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98771465, 'precision': 0.9675679, 'recall': 0.8355043, 'specificity': 0.8355043, 'f1': 0.8899221, 'auroc': 0.990898, 'binary_precision': 0.9464115, 'binary_recall': 0.67233175, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.7861685}
confusion matrix:
       0    1
0  42265   56
1    482  989
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9448608, 'recall': 0.7804461, 'specificity': 0.7804461, 'f1': 0.8427108, 'auroc': 0.975253, 'binary_precision': 0.905, 'binary_recall': 0.562986, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.6941515}
confusion matrix:
       0    1
0  18111   38
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.88104427, 'recall': 0.58903784, 'specificity': 0.58903784, 'f1': 0.63760966, 'auroc': 0.94964826, 'binary_precision': 0.7966102, 'binary_recall': 0.18007663, 'binary_specificity': 0.997999, 'binary_f1_score': 0.29375}
confusion matrix:
      0   1
0  5985  12
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.964205801486969 / 0.979066789150238
after epoch: 22,now: 2024-05-31 05:53:02.480940,epoch time: 0:27:02.519200,used: 10:02:15.513982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9880115, 'precision': 0.93457407, 'recall': 0.8718337, 'specificity': 0.8718337, 'f1': 0.90057635, 'auroc': 0.99158806, 'binary_precision': 0.87789303, 'binary_recall': 0.7472826, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.80733943}
confusion matrix:
       0     1
0  42167   153
1    372  1100
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.89496225, 'recall': 0.83297753, 'specificity': 0.83297753, 'f1': 0.8611143, 'auroc': 0.97766703, 'binary_precision': 0.8014842, 'binary_recall': 0.6718507, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7309644}
confusion matrix:
       0    1
0  18042  107
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8410519, 'recall': 0.648673, 'specificity': 0.648673, 'f1': 0.70355463, 'auroc': 0.9615574, 'binary_precision': 0.7117117, 'binary_recall': 0.30268198, 'binary_specificity': 0.994664, 'binary_f1_score': 0.42473117}
confusion matrix:
      0   1
0  5965  32
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.983077883720398, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.964205801486969 / 0.979066789150238
after epoch: 23,now: 2024-05-31 06:20:03.274981,epoch time: 0:27:00.794041,used: 10:29:16.308023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902722, 'precision': 0.9479339, 'recall': 0.8966092, 'specificity': 0.8966092, 'f1': 0.9205934, 'auroc': 0.9931781, 'binary_precision': 0.9029276, 'binary_recall': 0.7961956, 'binary_specificity': 0.9970227, 'binary_f1_score': 0.8462094}
confusion matrix:
       0     1
0  42194   126
1    300  1172
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.92570007, 'recall': 0.8556596, 'specificity': 0.8556596, 'f1': 0.8872946, 'auroc': 0.9767801, 'binary_precision': 0.8614232, 'binary_recall': 0.7153966, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7816483}
confusion matrix:
       0    1
0  18075   74
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8649466, 'recall': 0.6322654, 'specificity': 0.6322654, 'f1': 0.68954426, 'auroc': 0.9459923, 'binary_precision': 0.76086956, 'binary_recall': 0.26819924, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.39660057}
confusion matrix:
      0   1
0  5975  22
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 24,now: 2024-05-31 06:46:53.611334,epoch time: 0:26:50.336353,used: 10:56:06.644376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9901352, 'precision': 0.92700535, 'recall': 0.9197105, 'specificity': 0.9197105, 'f1': 0.923324, 'auroc': 0.9939072, 'binary_precision': 0.8594183, 'binary_recall': 0.84421766, 'binary_specificity': 0.99520344, 'binary_f1_score': 0.8517502}
confusion matrix:
       0     1
0  42119   203
1    229  1241
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.91682416, 'recall': 0.86846566, 'specificity': 0.86846566, 'f1': 0.8910358, 'auroc': 0.97986233, 'binary_precision': 0.8427562, 'binary_recall': 0.7418352, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.78908193}
confusion matrix:
       0    1
0  18060   89
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.852034, 'recall': 0.59053665, 'specificity': 0.59053665, 'f1': 0.63780534, 'auroc': 0.9387702, 'binary_precision': 0.73846155, 'binary_recall': 0.18390805, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29447854}
confusion matrix:
      0   1
0  5980  17
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 25,now: 2024-05-31 07:13:31.667297,epoch time: 0:26:38.055963,used: 11:22:44.700339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9886966, 'precision': 0.91435254, 'recall': 0.9108169, 'specificity': 0.9108169, 'f1': 0.9125765, 'auroc': 0.992223, 'binary_precision': 0.83470505, 'binary_recall': 0.8273283, 'binary_specificity': 0.99430543, 'binary_f1_score': 0.8310003}
confusion matrix:
       0     1
0  42080   241
1    254  1217
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.8906905, 'recall': 0.89127654, 'specificity': 0.89127654, 'f1': 0.8909833, 'auroc': 0.97642046, 'binary_precision': 0.78881985, 'binary_recall': 0.79004663, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.78943276}
confusion matrix:
       0    1
0  18013  136
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.91669476, 'recall': 0.55139065, 'specificity': 0.55139065, 'f1': 0.5827308, 'auroc': 0.9553695, 'binary_precision': 0.87096775, 'binary_recall': 0.10344828, 'binary_specificity': 0.999333, 'binary_f1_score': 0.18493152}
confusion matrix:
      0   1
0  5993   4
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9855789542198181, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9632470607757568 / 0.979066789150238
after epoch: 26,now: 2024-05-31 07:40:17.974304,epoch time: 0:26:46.307007,used: 11:49:31.007346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99168795, 'precision': 0.9420525, 'recall': 0.92811286, 'specificity': 0.92811286, 'f1': 0.9349623, 'auroc': 0.99368507, 'binary_precision': 0.888967, 'binary_recall': 0.8599592, 'binary_specificity': 0.9962666, 'binary_f1_score': 0.8742226}
confusion matrix:
       0     1
0  42163   158
1    206  1265
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.90230215, 'recall': 0.87021995, 'specificity': 0.87021995, 'f1': 0.8855394, 'auroc': 0.9823185, 'binary_precision': 0.8135593, 'binary_recall': 0.7465008, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.77858883}
confusion matrix:
       0    1
0  18039  110
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8694062, 'recall': 0.5964505, 'specificity': 0.5964505, 'f1': 0.64673364, 'auroc': 0.95655, 'binary_precision': 0.77272725, 'binary_recall': 0.1954023, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3119266}
confusion matrix:
      0   1
0  5982  15
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.985472559928894, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9632470607757568 / 0.979066789150238
after epoch: 27,now: 2024-05-31 08:07:06.187199,epoch time: 0:26:48.212895,used: 12:16:19.220241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99066037, 'precision': 0.95176506, 'recall': 0.899105, 'specificity': 0.899105, 'f1': 0.9236822, 'auroc': 0.9944951, 'binary_precision': 0.9104247, 'binary_recall': 0.80095106, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.85218656}
confusion matrix:
       0     1
0  42204   116
1    293  1179
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.91801584, 'recall': 0.8600222, 'specificity': 0.8600222, 'f1': 0.8866849, 'auroc': 0.97652507, 'binary_precision': 0.845735, 'binary_recall': 0.7247278, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7805695}
confusion matrix:
       0    1
0  18064   85
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.9142183, 'recall': 0.60652936, 'specificity': 0.60652936, 'f1': 0.6630014, 'auroc': 0.9149295, 'binary_precision': 0.86153847, 'binary_recall': 0.21455939, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.34355828}
confusion matrix:
      0   1
0  5988   9
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9860578775405884, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.9632470607757568 / 0.979066789150238
after epoch: 28,now: 2024-05-31 08:33:58.575213,epoch time: 0:26:52.388014,used: 12:43:11.608255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9910943, 'precision': 0.9277373, 'recall': 0.93670547, 'specificity': 0.93670547, 'f1': 0.9321711, 'auroc': 0.9944566, 'binary_precision': 0.8597075, 'binary_recall': 0.87839675, 'binary_specificity': 0.9950142, 'binary_f1_score': 0.8689517}
confusion matrix:
       0     1
0  42109   211
1    179  1293
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9104835, 'recall': 0.88827014, 'specificity': 0.88827014, 'f1': 0.89904225, 'auroc': 0.97911215, 'binary_precision': 0.82866555, 'binary_recall': 0.7822706, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.8048}
confusion matrix:
       0    1
0  18045  104
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.88937885, 'recall': 0.59861636, 'specificity': 0.59861636, 'f1': 0.65093595, 'auroc': 0.9425297, 'binary_precision': 0.8125, 'binary_recall': 0.19923371, 'binary_specificity': 0.997999, 'binary_f1_score': 0.32}
confusion matrix:
      0   1
0  5985  12
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 29,now: 2024-05-31 09:00:47.943536,epoch time: 0:26:49.368323,used: 13:10:00.976578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9915738, 'precision': 0.9566, 'recall': 0.9094134, 'specificity': 0.9094134, 'f1': 0.931624, 'auroc': 0.99476385, 'binary_precision': 0.91939163, 'binary_recall': 0.8213315, 'binary_specificity': 0.9974953, 'binary_f1_score': 0.86759955}
confusion matrix:
       0     1
0  42214   106
1    263  1209
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9209449, 'recall': 0.8740191, 'specificity': 0.8740191, 'f1': 0.8959857, 'auroc': 0.9772073, 'binary_precision': 0.85061514, 'binary_recall': 0.7527216, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7986798}
confusion matrix:
       0    1
0  18064   85
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.9030491, 'recall': 0.6272686, 'specificity': 0.6272686, 'f1': 0.68797994, 'auroc': 0.9417033, 'binary_precision': 0.8375, 'binary_recall': 0.256705, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.39296192}
confusion matrix:
      0   1
0  5984  13
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9870157241821289, best validation acc: 0.9870157241821289, corresponding to test acc:                         0.9646852016448975 / 0.979066789150238
after epoch: 30,now: 2024-05-31 09:27:25.799322,epoch time: 0:26:37.855786,used: 13:36:38.832364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_19_50_46_seed_0_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:36:38.832364 at 2024-05-31 09:27:25.799322
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.8834357, 'recall': 0.6061125, 'specificity': 0.6061125, 'f1': 0.66019785, 'auroc': 0.94752634, 'binary_precision': 0.8, 'binary_recall': 0.21455939, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3383686}
confusion matrix:
      0   1
0  5983  14
1   205  56
oracle model performance metric: 

scalar performance:
{'acc': 0.9782678, 'precision': 0.89175165, 'recall': 0.8164216, 'specificity': 0.8164216, 'f1': 0.8496741, 'auroc': 0.9564744, 'binary_precision': 0.79904306, 'binary_recall': 0.63984674, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.71063834}
confusion matrix:
      0    1
0  5955   42
1    94  167
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14476 MiB |  14476 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 471195 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |   9512 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197547 K  |  197544 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94917 K  |   94913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197547 K  |  197544 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102630 K  |
|       from small pool |    3301    |    6290    |   94917 K  |   94913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2805    |  133107 K  |  133107 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      41    |    2765    |   49280 K  |   49280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14476 MiB |  14476 MiB |  13570 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     39 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94917 K  |   94917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94917 K  |   94917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  133108 K  |  133108 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   49281 K  |   49281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    906 MiB |  14476 MiB |  14476 MiB |  13570 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     39 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94917 K  |   94917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197547 K  |  197547 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94917 K  |   94917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  133108 K  |  133108 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   49281 K  |   49281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757

 Experiment start at: 2024-05-31 09:36:57.193806
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96810013, 'precision': 0.84514797, 'recall': 0.52395356, 'specificity': 0.52395356, 'f1': 0.5373667, 'auroc': 0.95102274, 'binary_precision': 0.72164947, 'binary_recall': 0.048543688, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.09096816}
confusion matrix:
       0   1
0  42387  27
1   1372  70
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7778244, 'recall': 0.5094092, 'specificity': 0.5094092, 'f1': 0.50961167, 'auroc': 0.9467356, 'binary_precision': 0.59090906, 'binary_recall': 0.019316493, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.03741007}
confusion matrix:
       0   1
0  18058   9
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.95142245, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 10:05:02.760171,epoch time: 0:28:05.566365,used: 0:28:05.566365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.74586, 'recall': 0.873783, 'specificity': 0.873783, 'f1': 0.79499936, 'auroc': 0.9580934, 'binary_precision': 0.49955237, 'binary_recall': 0.7739251, 'binary_specificity': 0.9736408, 'binary_f1_score': 0.6071817}
confusion matrix:
       0     1
0  41296  1118
1    326  1116
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.7685368, 'recall': 0.8233967, 'specificity': 0.8233967, 'f1': 0.79311776, 'auroc': 0.956874, 'binary_precision': 0.5495716, 'binary_recall': 0.66716194, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.60268456}
confusion matrix:
       0    1
0  17699  368
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97921365, 'precision': 0.8887005, 'recall': 0.8383554, 'specificity': 0.8383554, 'f1': 0.8616024, 'auroc': 0.9580744, 'binary_precision': 0.7911111, 'binary_recall': 0.6846154, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.73402065}
confusion matrix:
      0    1
0  5899   47
1    82  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 10:31:58.259798,epoch time: 0:26:55.499627,used: 0:55:01.065992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97564757, 'precision': 0.82206655, 'recall': 0.7629919, 'specificity': 0.7629919, 'f1': 0.789284, 'auroc': 0.9669962, 'binary_precision': 0.6598291, 'binary_recall': 0.53536755, 'binary_specificity': 0.9906163, 'binary_f1_score': 0.5911179}
confusion matrix:
       0    1
0  42016  398
1    670  772
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.8358495, 'recall': 0.6352303, 'specificity': 0.6352303, 'f1': 0.6894562, 'auroc': 0.96173835, 'binary_precision': 0.6981132, 'binary_recall': 0.27488855, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.3944563}
confusion matrix:
       0    1
0  17987   80
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.82825744, 'recall': 0.61687624, 'specificity': 0.61687624, 'f1': 0.6677746, 'auroc': 0.95862395, 'binary_precision': 0.6888889, 'binary_recall': 0.23846154, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.35428572}
confusion matrix:
      0   1
0  5918  28
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 3,now: 2024-05-31 10:59:10.350631,epoch time: 0:27:12.090833,used: 1:22:13.156825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97667366, 'precision': 0.8230095, 'recall': 0.7950079, 'specificity': 0.7950079, 'f1': 0.8083168, 'auroc': 0.96985996, 'binary_precision': 0.65955824, 'binary_recall': 0.60055476, 'binary_specificity': 0.989461, 'binary_f1_score': 0.6286751}
confusion matrix:
       0    1
0  41967  447
1    576  866
---- Validation: 
scalar performance:
{'acc': 0.9726254, 'precision': 0.8277379, 'recall': 0.7247303, 'specificity': 0.7247303, 'f1': 0.7657516, 'auroc': 0.9666326, 'binary_precision': 0.6754386, 'binary_recall': 0.4576523, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.5456156}
confusion matrix:
       0    1
0  17919  148
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8742552, 'recall': 0.6405418, 'specificity': 0.6405418, 'f1': 0.6998665, 'auroc': 0.953405, 'binary_precision': 0.77894735, 'binary_recall': 0.2846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.41690144}
confusion matrix:
      0   1
0  5925  21
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 4,now: 2024-05-31 11:26:21.422893,epoch time: 0:27:11.072262,used: 1:49:24.229087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97904503, 'precision': 0.8695258, 'recall': 0.76575327, 'specificity': 0.76575327, 'f1': 0.8085018, 'auroc': 0.9727937, 'binary_precision': 0.75462514, 'binary_recall': 0.537448, 'binary_specificity': 0.99405855, 'binary_f1_score': 0.62778455}
confusion matrix:
       0    1
0  42162  252
1    667  775
---- Validation: 
scalar performance:
{'acc': 0.9764141, 'precision': 0.88568026, 'recall': 0.7309868, 'specificity': 0.7309868, 'f1': 0.7873882, 'auroc': 0.9705602, 'binary_precision': 0.790932, 'binary_recall': 0.4665676, 'binary_specificity': 0.995406, 'binary_f1_score': 0.5869159}
confusion matrix:
       0    1
0  17984   83
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7548739, 'recall': 0.52039707, 'specificity': 0.52039707, 'f1': 0.52865267, 'auroc': 0.95880234, 'binary_precision': 0.55, 'binary_recall': 0.042307694, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.07857143}
confusion matrix:
      0   1
0  5937   9
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 5,now: 2024-05-31 11:53:38.564764,epoch time: 0:27:17.141871,used: 2:16:41.370958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9787486, 'precision': 0.8463613, 'recall': 0.7982885, 'specificity': 0.7982885, 'f1': 0.8203795, 'auroc': 0.97541225, 'binary_precision': 0.70607287, 'binary_recall': 0.6051353, 'binary_specificity': 0.9914417, 'binary_f1_score': 0.651719}
confusion matrix:
       0    1
0  42052  363
1    569  872
---- Validation: 
scalar performance:
{'acc': 0.97321236, 'precision': 0.8373263, 'recall': 0.7228889, 'specificity': 0.7228889, 'f1': 0.7673789, 'auroc': 0.9713702, 'binary_precision': 0.6947608, 'binary_recall': 0.45319465, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.54856116}
confusion matrix:
       0    1
0  17933  134
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.7026683, 'recall': 0.5926111, 'specificity': 0.5926111, 'f1': 0.6242558, 'auroc': 0.94717455, 'binary_precision': 0.43965518, 'binary_recall': 0.19615385, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.27127656}
confusion matrix:
      0   1
0  5881  65
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9732123613357544, best validation acc: 0.9764140844345093, corresponding to test acc:                         0.9584273099899292 / 0.9792136549949646
after epoch: 6,now: 2024-05-31 12:21:45.512992,epoch time: 0:28:06.948228,used: 2:44:48.319186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98052716, 'precision': 0.8418975, 'recall': 0.8606411, 'specificity': 0.8606411, 'f1': 0.8509965, 'auroc': 0.9772583, 'binary_precision': 0.6929134, 'binary_recall': 0.73231626, 'binary_specificity': 0.9889659, 'binary_f1_score': 0.71207017}
confusion matrix:
       0     1
0  41946   468
1    386  1056
---- Validation: 
scalar performance:
{'acc': 0.97860193, 'precision': 0.8493496, 'recall': 0.8358352, 'specificity': 0.8358352, 'f1': 0.8424462, 'auroc': 0.974293, 'binary_precision': 0.7105263, 'binary_recall': 0.6820208, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.69598174}
confusion matrix:
       0    1
0  17880  187
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.81737244, 'recall': 0.6973822, 'specificity': 0.6973822, 'f1': 0.7418832, 'auroc': 0.95720977, 'binary_precision': 0.6603774, 'binary_recall': 0.40384614, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.5011933}
confusion matrix:
      0    1
0  5892   54
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 7,now: 2024-05-31 12:50:10.536970,epoch time: 0:28:25.023978,used: 3:13:13.343164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98394746, 'precision': 0.893934, 'recall': 0.83929765, 'specificity': 0.83929765, 'f1': 0.8644191, 'auroc': 0.9816365, 'binary_precision': 0.7985437, 'binary_recall': 0.684466, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.7371173}
confusion matrix:
       0    1
0  42165  249
1    455  987
---- Validation: 
scalar performance:
{'acc': 0.98132336, 'precision': 0.90159595, 'recall': 0.8064901, 'specificity': 0.8064901, 'f1': 0.8471246, 'auroc': 0.9723685, 'binary_precision': 0.8172888, 'binary_recall': 0.61812776, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.70389163}
confusion matrix:
       0    1
0  17974   93
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.792909, 'recall': 0.6122733, 'specificity': 0.6122733, 'f1': 0.6582373, 'auroc': 0.96009, 'binary_precision': 0.6185567, 'binary_recall': 0.23076923, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.33613446}
confusion matrix:
      0   1
0  5909  37
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 8,now: 2024-05-31 13:18:13.066376,epoch time: 0:28:02.529406,used: 3:41:15.872570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9821689, 'precision': 0.9180522, 'recall': 0.7757421, 'specificity': 0.7757421, 'f1': 0.83127, 'auroc': 0.9817629, 'binary_precision': 0.85106385, 'binary_recall': 0.554785, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.6717045}
confusion matrix:
       0    1
0  42274  140
1    642  800
---- Validation: 
scalar performance:
{'acc': 0.9788154, 'precision': 0.94538647, 'recall': 0.72651005, 'specificity': 0.72651005, 'f1': 0.79782784, 'auroc': 0.9770156, 'binary_precision': 0.91071427, 'binary_recall': 0.45468053, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.6065411}
confusion matrix:
       0    1
0  18037   30
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.84655684, 'recall': 0.5208175, 'specificity': 0.5208175, 'f1': 0.5295773, 'auroc': 0.9483125, 'binary_precision': 0.73333335, 'binary_recall': 0.042307694, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5942   4
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9788153767585754, best validation acc: 0.9813233613967896, corresponding to test acc:                         0.9618111252784729 / 0.9792136549949646
after epoch: 9,now: 2024-05-31 13:47:31.971643,epoch time: 0:29:18.905267,used: 4:10:34.777837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9830582, 'precision': 0.89526844, 'recall': 0.8187408, 'specificity': 0.8187408, 'f1': 0.8525856, 'auroc': 0.98128617, 'binary_precision': 0.8025974, 'binary_recall': 0.64285713, 'binary_specificity': 0.99462444, 'binary_f1_score': 0.71390057}
confusion matrix:
       0    1
0  42186  228
1    515  927
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.8648676, 'recall': 0.76994336, 'specificity': 0.76994336, 'f1': 0.8096883, 'auroc': 0.9744306, 'binary_precision': 0.7464503, 'binary_recall': 0.5468053, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.6312179}
confusion matrix:
       0    1
0  17942  125
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.77111506, 'recall': 0.59864354, 'specificity': 0.59864354, 'f1': 0.6403692, 'auroc': 0.95077217, 'binary_precision': 0.57608694, 'binary_recall': 0.20384616, 'binary_specificity': 0.993441, 'binary_f1_score': 0.30113637}
confusion matrix:
      0   1
0  5907  39
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9770544171333313, best validation acc: 0.9813233613967896, corresponding to test acc:                         0.9618111252784729 / 0.9792136549949646
after epoch: 10,now: 2024-05-31 14:16:11.519889,epoch time: 0:28:39.548246,used: 4:39:14.326083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.985498, 'precision': 0.910133, 'recall': 0.84880805, 'specificity': 0.84880805, 'f1': 0.87680197, 'auroc': 0.98501676, 'binary_precision': 0.83032787, 'binary_recall': 0.7024965, 'binary_specificity': 0.9951195, 'binary_f1_score': 0.7610819}
confusion matrix:
       0     1
0  42207   207
1    429  1013
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.9000345, 'recall': 0.84247917, 'specificity': 0.84247917, 'f1': 0.86883366, 'auroc': 0.97747844, 'binary_precision': 0.8115183, 'binary_recall': 0.6909361, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.7463884}
confusion matrix:
       0    1
0  17959  108
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.76275504, 'recall': 0.5408782, 'specificity': 0.5408782, 'f1': 0.5630527, 'auroc': 0.9537207, 'binary_precision': 0.5641026, 'binary_recall': 0.08461539, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.14715718}
confusion matrix:
      0   1
0  5929  17
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 11,now: 2024-05-31 14:44:58.806025,epoch time: 0:28:47.286136,used: 5:08:01.612219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98271614, 'precision': 0.91433114, 'recall': 0.7897581, 'specificity': 0.7897581, 'f1': 0.84022754, 'auroc': 0.9850927, 'binary_precision': 0.84268534, 'binary_recall': 0.58321774, 'binary_specificity': 0.9962984, 'binary_f1_score': 0.6893443}
confusion matrix:
       0    1
0  42257  157
1    601  841
---- Validation: 
scalar performance:
{'acc': 0.98052293, 'precision': 0.9168306, 'recall': 0.77603376, 'specificity': 0.77603376, 'f1': 0.83101046, 'auroc': 0.9775591, 'binary_precision': 0.85, 'binary_recall': 0.5557206, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.67205745}
confusion matrix:
       0    1
0  18001   66
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.86008686, 'recall': 0.6478137, 'specificity': 0.6478137, 'f1': 0.70565355, 'auroc': 0.9589839, 'binary_precision': 0.75, 'binary_recall': 0.3, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.42857146}
confusion matrix:
      0   1
0  5920  26
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9805229306221008, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9589107036590576 / 0.9792136549949646
after epoch: 12,now: 2024-05-31 15:13:57.399295,epoch time: 0:28:58.593270,used: 5:37:00.205489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9842211, 'precision': 0.9557734, 'recall': 0.78182733, 'specificity': 0.78182733, 'f1': 0.8469385, 'auroc': 0.98836553, 'binary_precision': 0.9261364, 'binary_recall': 0.5651872, 'binary_specificity': 0.9984675, 'binary_f1_score': 0.701981}
confusion matrix:
       0    1
0  42349   65
1    627  815
---- Validation: 
scalar performance:
{'acc': 0.9782284, 'precision': 0.9595243, 'recall': 0.70975447, 'specificity': 0.70975447, 'f1': 0.78496635, 'auroc': 0.97968245, 'binary_precision': 0.9401993, 'binary_recall': 0.4205052, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.5811088}
confusion matrix:
       0    1
0  18049   18
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8700882, 'recall': 0.5531734, 'specificity': 0.5531734, 'f1': 0.58469033, 'auroc': 0.96023846, 'binary_precision': 0.7777778, 'binary_recall': 0.10769231, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5938   8
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9782283902168274, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9589107036590576 / 0.9792136549949646
after epoch: 13,now: 2024-05-31 15:42:08.548729,epoch time: 0:28:11.149434,used: 6:05:11.354923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9855664, 'precision': 0.92577493, 'recall': 0.8317609, 'specificity': 0.8317609, 'f1': 0.8725054, 'auroc': 0.9871243, 'binary_precision': 0.8627803, 'binary_recall': 0.667129, 'binary_specificity': 0.9963927, 'binary_f1_score': 0.75244427}
confusion matrix:
       0    1
0  42261  153
1    480  962
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.95134425, 'recall': 0.79026467, 'specificity': 0.79026467, 'f1': 0.8520206, 'auroc': 0.9802936, 'binary_precision': 0.91803277, 'binary_recall': 0.58246654, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.71272725}
confusion matrix:
       0    1
0  18032   35
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.85565716, 'recall': 0.539796, 'specificity': 0.539796, 'f1': 0.5627715, 'auroc': 0.9599841, 'binary_precision': 0.75, 'binary_recall': 0.08076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.14583333}
confusion matrix:
      0   1
0  5939   7
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9831376671791077, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9589107036590576 / 0.9792136549949646
after epoch: 14,now: 2024-05-31 16:10:15.154303,epoch time: 0:28:06.605574,used: 6:33:17.960497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98727655, 'precision': 0.9036853, 'recall': 0.8939412, 'specificity': 0.8939412, 'f1': 0.8987489, 'auroc': 0.98907954, 'binary_precision': 0.814367, 'binary_recall': 0.7940361, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.80407304}
confusion matrix:
       0     1
0  42153   261
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.91609025, 'recall': 0.8187647, 'specificity': 0.8187647, 'f1': 0.8604567, 'auroc': 0.9792161, 'binary_precision': 0.84540117, 'binary_recall': 0.6419019, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.7297298}
confusion matrix:
       0    1
0  17988   79
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.86829686, 'recall': 0.613871, 'specificity': 0.613871, 'f1': 0.66848713, 'auroc': 0.96245486, 'binary_precision': 0.7692308, 'binary_recall': 0.23076923, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.35502958}
confusion matrix:
      0   1
0  5928  18
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 4
val acc:0.982924222946167, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9589107036590576 / 0.9792136549949646
after epoch: 15,now: 2024-05-31 16:38:30.968572,epoch time: 0:28:15.814269,used: 7:01:33.774766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98702574, 'precision': 0.9592124, 'recall': 0.8264862, 'specificity': 0.8264862, 'f1': 0.8808713, 'auroc': 0.98925483, 'binary_precision': 0.93004924, 'binary_recall': 0.65464634, 'binary_specificity': 0.998326, 'binary_f1_score': 0.76841676}
confusion matrix:
       0    1
0  42343   71
1    498  944
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.9426868, 'recall': 0.76120687, 'specificity': 0.76120687, 'f1': 0.8268515, 'auroc': 0.9785894, 'binary_precision': 0.9028133, 'binary_recall': 0.52451706, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.6635338}
confusion matrix:
       0    1
0  18029   38
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.88001215, 'recall': 0.5741591, 'specificity': 0.5741591, 'f1': 0.61667055, 'auroc': 0.9587164, 'binary_precision': 0.79591835, 'binary_recall': 0.15, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2524272}
confusion matrix:
      0   1
0  5936  10
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 5
val acc:0.9808964729309082, best validation acc: 0.9831376671791077, corresponding to test acc:                         0.9589107036590576 / 0.9792136549949646
after epoch: 16,now: 2024-05-31 17:06:37.334502,epoch time: 0:28:06.365930,used: 7:29:40.140696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9870485, 'precision': 0.8943208, 'recall': 0.9048767, 'specificity': 0.9048767, 'f1': 0.89952326, 'auroc': 0.98963714, 'binary_precision': 0.7948718, 'binary_recall': 0.81692094, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.80574554}
confusion matrix:
       0     1
0  42110   304
1    264  1178
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.8798411, 'recall': 0.884186, 'specificity': 0.884186, 'f1': 0.8820001, 'auroc': 0.9816105, 'binary_precision': 0.76798826, 'binary_recall': 0.7771174, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.7725258}
confusion matrix:
       0    1
0  17909  158
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8057988, 'recall': 0.64446104, 'specificity': 0.64446104, 'f1': 0.69324, 'auroc': 0.9578581, 'binary_precision': 0.64166665, 'binary_recall': 0.29615384, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.40526316}
confusion matrix:
      0   1
0  5903  43
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 17,now: 2024-05-31 17:34:40.870890,epoch time: 0:28:03.536388,used: 7:57:43.677084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98757297, 'precision': 0.89541686, 'recall': 0.9141916, 'specificity': 0.9141916, 'f1': 0.9045683, 'auroc': 0.9910045, 'binary_precision': 0.79643095, 'binary_recall': 0.83564496, 'binary_specificity': 0.99273825, 'binary_f1_score': 0.81556684}
confusion matrix:
       0     1
0  42106   308
1    237  1205
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9068893, 'recall': 0.8589346, 'specificity': 0.8589346, 'f1': 0.881281, 'auroc': 0.98127973, 'binary_precision': 0.82402706, 'binary_recall': 0.72362554, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.77056956}
confusion matrix:
       0    1
0  17963  104
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.85404384, 'recall': 0.61361873, 'specificity': 0.61361873, 'f1': 0.6667989, 'auroc': 0.95699847, 'binary_precision': 0.7407407, 'binary_recall': 0.23076923, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.35190615}
confusion matrix:
      0   1
0  5925  21
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 18,now: 2024-05-31 18:02:43.100271,epoch time: 0:28:02.229381,used: 8:25:45.906465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9889867, 'precision': 0.9473276, 'recall': 0.8710438, 'specificity': 0.8710438, 'f1': 0.90537137, 'auroc': 0.9924218, 'binary_precision': 0.9032801, 'binary_recall': 0.7447989, 'binary_specificity': 0.99728864, 'binary_f1_score': 0.81641966}
confusion matrix:
       0     1
0  42299   115
1    368  1074
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.93514454, 'recall': 0.81494355, 'specificity': 0.81494355, 'f1': 0.8646605, 'auroc': 0.982875, 'binary_precision': 0.88381743, 'binary_recall': 0.6329866, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7376624}
confusion matrix:
       0    1
0  18011   56
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.855427, 'recall': 0.53411084, 'specificity': 0.53411084, 'f1': 0.553156, 'auroc': 0.9589823, 'binary_precision': 0.75, 'binary_recall': 0.06923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12676057}
confusion matrix:
      0   1
0  5940   6
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9838314056396484, best validation acc: 0.9845250844955444, corresponding to test acc:                         0.9643893241882324 / 0.9792136549949646
after epoch: 19,now: 2024-05-31 18:30:45.961094,epoch time: 0:28:02.860823,used: 8:53:48.767288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98857623, 'precision': 0.9372283, 'recall': 0.874516, 'specificity': 0.874516, 'f1': 0.9032693, 'auroc': 0.99157953, 'binary_precision': 0.8828316, 'binary_recall': 0.75242716, 'binary_specificity': 0.9966049, 'binary_f1_score': 0.81242985}
confusion matrix:
       0     1
0  42270   144
1    357  1085
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9294729, 'recall': 0.83026856, 'specificity': 0.83026856, 'f1': 0.87287444, 'auroc': 0.9811799, 'binary_precision': 0.87134504, 'binary_recall': 0.6641902, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.75379425}
confusion matrix:
       0    1
0  18001   66
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.9046725, 'recall': 0.562957, 'specificity': 0.562957, 'f1': 0.6007501, 'auroc': 0.95686936, 'binary_precision': 0.84615386, 'binary_recall': 0.12692308, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.22073579}
confusion matrix:
      0   1
0  5940   6
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9844183325767517, best validation acc: 0.9845250844955444, corresponding to test acc:                         0.9643893241882324 / 0.9792136549949646
after epoch: 20,now: 2024-05-31 18:58:54.342262,epoch time: 0:28:08.381168,used: 9:21:57.148456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98937434, 'precision': 0.9277154, 'recall': 0.90071994, 'specificity': 0.90071994, 'f1': 0.91374373, 'auroc': 0.9922921, 'binary_precision': 0.8620178, 'binary_recall': 0.80582523, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.83297485}
confusion matrix:
       0     1
0  42228   186
1    280  1162
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9133673, 'recall': 0.85329545, 'specificity': 0.85329545, 'f1': 0.8807787, 'auroc': 0.98065484, 'binary_precision': 0.8374126, 'binary_recall': 0.71173847, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.76947784}
confusion matrix:
       0    1
0  17974   93
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8495655, 'recall': 0.64756143, 'specificity': 0.64756143, 'f1': 0.7037753, 'auroc': 0.96340835, 'binary_precision': 0.72897196, 'binary_recall': 0.3, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.42506817}
confusion matrix:
      0   1
0  5917  29
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 21,now: 2024-05-31 19:27:04.705613,epoch time: 0:28:10.363351,used: 9:50:07.511807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98882705, 'precision': 0.9312762, 'recall': 0.88603413, 'specificity': 0.88603413, 'f1': 0.90730774, 'auroc': 0.9921601, 'binary_precision': 0.87013996, 'binary_recall': 0.77600557, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.82038116}
confusion matrix:
       0     1
0  42247   167
1    323  1119
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9343401, 'recall': 0.8333787, 'specificity': 0.8333787, 'f1': 0.8766922, 'auroc': 0.981727, 'binary_precision': 0.8808594, 'binary_recall': 0.6701337, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.7611815}
confusion matrix:
       0    1
0  18006   61
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8677186, 'recall': 0.6309264, 'specificity': 0.6309264, 'f1': 0.6883549, 'auroc': 0.94645727, 'binary_precision': 0.76666665, 'binary_recall': 0.2653846, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.39428568}
confusion matrix:
      0   1
0  5925  21
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 22,now: 2024-05-31 19:55:06.991984,epoch time: 0:28:02.286371,used: 10:18:09.798178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9902864, 'precision': 0.9311858, 'recall': 0.91324973, 'specificity': 0.91324973, 'f1': 0.92201257, 'auroc': 0.9936273, 'binary_precision': 0.86811596, 'binary_recall': 0.8307906, 'binary_specificity': 0.99570894, 'binary_f1_score': 0.84904325}
confusion matrix:
       0     1
0  42232   182
1    244  1198
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.91361105, 'recall': 0.8415191, 'specificity': 0.8415191, 'f1': 0.87383556, 'auroc': 0.98219705, 'binary_precision': 0.8387681, 'binary_recall': 0.6879643, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.7559183}
confusion matrix:
       0    1
0  17978   89
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.89033425, 'recall': 0.62373865, 'specificity': 0.62373865, 'f1': 0.68247867, 'auroc': 0.95727885, 'binary_precision': 0.8125, 'binary_recall': 0.25, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.38235295}
confusion matrix:
      0   1
0  5931  15
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9658395051956177 / 0.9792136549949646
after epoch: 23,now: 2024-05-31 20:23:04.750181,epoch time: 0:27:57.758197,used: 10:46:07.556375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9888499, 'precision': 0.9288375, 'recall': 0.88932014, 'specificity': 0.88932014, 'f1': 0.9080514, 'auroc': 0.99174106, 'binary_precision': 0.86503065, 'binary_recall': 0.7827897, 'binary_specificity': 0.9958505, 'binary_f1_score': 0.82185787}
confusion matrix:
       0     1
0  42239   176
1    313  1128
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9175106, 'recall': 0.84534454, 'specificity': 0.84534454, 'f1': 0.87772965, 'auroc': 0.98132086, 'binary_precision': 0.846293, 'binary_recall': 0.69539374, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.7634584}
confusion matrix:
       0    1
0  17982   85
1    205  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.95678866, 'recall': 0.53837746, 'specificity': 0.53837746, 'f1': 0.56124115, 'auroc': 0.94422126, 'binary_precision': 0.95238096, 'binary_recall': 0.07692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.14234877}
confusion matrix:
      0   1
0  5945   1
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9845250844955444, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9658395051956177 / 0.9792136549949646
after epoch: 24,now: 2024-05-31 20:51:01.555727,epoch time: 0:27:56.805546,used: 11:14:04.361921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9876414, 'precision': 0.91655195, 'recall': 0.88240653, 'specificity': 0.88240653, 'f1': 0.8986926, 'auroc': 0.99328375, 'binary_precision': 0.84090906, 'binary_recall': 0.76976424, 'binary_specificity': 0.9950488, 'binary_f1_score': 0.8037654}
confusion matrix:
       0     1
0  42204   210
1    332  1110
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.9178419, 'recall': 0.84683037, 'specificity': 0.84683037, 'f1': 0.8787639, 'auroc': 0.9819567, 'binary_precision': 0.8468468, 'binary_recall': 0.6983655, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.7654723}
confusion matrix:
       0    1
0  17982   85
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8293196, 'recall': 0.5603612, 'specificity': 0.5603612, 'f1': 0.5945801, 'auroc': 0.9353765, 'binary_precision': 0.6956522, 'binary_recall': 0.12307692, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.20915034}
confusion matrix:
      0   1
0  5932  14
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9846317768096924, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9658395051956177 / 0.9792136549949646
after epoch: 25,now: 2024-05-31 21:19:08.730315,epoch time: 0:28:07.174588,used: 11:42:11.536509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9914037, 'precision': 0.93862617, 'recall': 0.9242109, 'specificity': 0.9242109, 'f1': 0.93128884, 'auroc': 0.99454105, 'binary_precision': 0.8822685, 'binary_recall': 0.8522885, 'binary_specificity': 0.9961333, 'binary_f1_score': 0.8670194}
confusion matrix:
       0     1
0  42250   164
1    213  1229
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.8998368, 'recall': 0.84982556, 'specificity': 0.84982556, 'f1': 0.8730181, 'auroc': 0.983269, 'binary_precision': 0.8105802, 'binary_recall': 0.70579493, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.75456715}
confusion matrix:
       0    1
0  17956  111
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8390082, 'recall': 0.6114434, 'specificity': 0.6114434, 'f1': 0.6626903, 'auroc': 0.9450047, 'binary_precision': 0.7108434, 'binary_recall': 0.22692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.34402335}
confusion matrix:
      0   1
0  5922  24
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 4
val acc:0.983511209487915, best validation acc: 0.9848986268043518, corresponding to test acc:                         0.9658395051956177 / 0.9792136549949646
after epoch: 26,now: 2024-05-31 21:47:07.028267,epoch time: 0:27:58.297952,used: 12:10:09.834461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9906284, 'precision': 0.93360376, 'recall': 0.9164412, 'specificity': 0.9164412, 'f1': 0.9248358, 'auroc': 0.9938172, 'binary_precision': 0.87274045, 'binary_recall': 0.8370319, 'binary_specificity': 0.99585044, 'binary_f1_score': 0.8545133}
confusion matrix:
       0     1
0  42238   176
1    235  1207
---- Validation: 
scalar performance:
{'acc': 0.9866595, 'precision': 0.92040956, 'recall': 0.87935376, 'specificity': 0.87935376, 'f1': 0.8987381, 'auroc': 0.9827591, 'binary_precision': 0.8495868, 'binary_recall': 0.7637444, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.8043819}
confusion matrix:
       0    1
0  17976   91
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.88486403, 'recall': 0.60843813, 'specificity': 0.60843813, 'f1': 0.6632244, 'auroc': 0.9547576, 'binary_precision': 0.8028169, 'binary_recall': 0.21923077, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.34441087}
confusion matrix:
      0   1
0  5932  14
1   203  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 27,now: 2024-05-31 22:15:05.060107,epoch time: 0:27:58.031840,used: 12:38:07.866301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99092484, 'precision': 0.9487566, 'recall': 0.9034654, 'specificity': 0.9034654, 'f1': 0.92481786, 'auroc': 0.9949078, 'binary_precision': 0.90395045, 'binary_recall': 0.80985427, 'binary_specificity': 0.9970765, 'binary_f1_score': 0.85431916}
confusion matrix:
       0     1
0  42291   124
1    274  1167
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.9341184, 'recall': 0.8540427, 'specificity': 0.8540427, 'f1': 0.88968265, 'auroc': 0.9825251, 'binary_precision': 0.8788991, 'binary_recall': 0.71173847, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.78653526}
confusion matrix:
       0    1
0  18001   66
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8743383, 'recall': 0.58929145, 'specificity': 0.58929145, 'f1': 0.63752997, 'auroc': 0.9263632, 'binary_precision': 0.78333336, 'binary_recall': 0.18076923, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.29375002}
confusion matrix:
      0   1
0  5933  13
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9861259460449219, best validation acc: 0.9866595268249512, corresponding to test acc:                         0.9650338292121887 / 0.9792136549949646
after epoch: 28,now: 2024-05-31 22:43:01.010616,epoch time: 0:27:55.950509,used: 13:06:03.816810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99097043, 'precision': 0.9560735, 'recall': 0.89652085, 'specificity': 0.89652085, 'f1': 0.92406523, 'auroc': 0.9946162, 'binary_precision': 0.91907054, 'binary_recall': 0.79542303, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.85278815}
confusion matrix:
       0     1
0  42313   101
1    295  1147
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.9343941, 'recall': 0.8555286, 'specificity': 0.8555286, 'f1': 0.89070463, 'auroc': 0.98275167, 'binary_precision': 0.87934184, 'binary_recall': 0.71471024, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.78852457}
confusion matrix:
       0    1
0  18001   66
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.82874024, 'recall': 0.6093521, 'specificity': 0.6093521, 'f1': 0.65915823, 'auroc': 0.9594021, 'binary_precision': 0.6904762, 'binary_recall': 0.22307692, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.3372093}
confusion matrix:
      0   1
0  5920  26
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9862326383590698, best validation acc: 0.9866595268249512, corresponding to test acc:                         0.9650338292121887 / 0.9792136549949646
after epoch: 29,now: 2024-05-31 23:10:54.187758,epoch time: 0:27:53.177142,used: 13:33:56.993952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99224734, 'precision': 0.95660794, 'recall': 0.917948, 'specificity': 0.917948, 'f1': 0.93636, 'auroc': 0.99572796, 'binary_precision': 0.918693, 'binary_recall': 0.83841884, 'binary_specificity': 0.99747723, 'binary_f1_score': 0.8767223}
confusion matrix:
       0     1
0  42307   107
1    233  1209
---- Validation: 
scalar performance:
{'acc': 0.9874066, 'precision': 0.94062555, 'recall': 0.868297, 'specificity': 0.868297, 'f1': 0.90096545, 'auroc': 0.9835538, 'binary_precision': 0.8908766, 'binary_recall': 0.73997027, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.8084416}
confusion matrix:
       0    1
0  18006   61
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8530662, 'recall': 0.5549283, 'specificity': 0.5549283, 'f1': 0.58704203, 'auroc': 0.94760066, 'binary_precision': 0.74358976, 'binary_recall': 0.11153846, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.19397993}
confusion matrix:
      0   1
0  5936  10
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 30,now: 2024-05-31 23:38:50.058153,epoch time: 0:27:55.870395,used: 14:01:52.864347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_09_36_57_seed_1_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:01:52.864347 at 2024-05-31 23:38:50.058153
persisted model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.84961426, 'recall': 0.5530053, 'specificity': 0.5530053, 'f1': 0.58397126, 'auroc': 0.9565098, 'binary_precision': 0.7368421, 'binary_recall': 0.10769231, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5936  10
1   232  28
oracle model performance metric: 

scalar performance:
{'acc': 0.9788914, 'precision': 0.88639474, 'recall': 0.8363483, 'specificity': 0.8363483, 'f1': 0.8594567, 'auroc': 0.9546495, 'binary_precision': 0.7866667, 'binary_recall': 0.6807692, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.7298969}
confusion matrix:
      0    1
0  5898   48
1    83  177
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28048 MiB |  13570 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446689 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |  11572 KiB |     39 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395728 K  |  395724 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190048 K  |  190044 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395728 K  |  395724 K  |
|       from large pool |     187    |    1413    |  205680 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190048 K  |  190044 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1209    |     574    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2807    |  261242 K  |  261242 K  |
|       from large pool |      38    |     605    |  162402 K  |  162402 K  |
|       from small pool |      45    |    2769    |   98839 K  |   98839 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28048 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1209    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  261243 K  |  261243 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2769    |   98840 K  |   98840 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28048 MiB |  27166 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395728 K  |  395728 K  |
|       from large pool |       2    |    1413    |  205680 K  |  205680 K  |
|       from small pool |       0    |    6298    |  190048 K  |  190048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1209    |    1146    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  261243 K  |  261243 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2769    |   98840 K  |   98840 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757

 Experiment start at: 2024-05-31 23:48:55.673378
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9693775, 'precision': 0.80734944, 'recall': 0.6254119, 'specificity': 0.6254119, 'f1': 0.6750473, 'auroc': 0.9522511, 'binary_precision': 0.6407285, 'binary_recall': 0.2559524, 'binary_specificity': 0.99487144, 'binary_f1_score': 0.36578453}
confusion matrix:
       0    1
0  42095  217
1   1125  387
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.7623273, 'recall': 0.74458945, 'specificity': 0.74458945, 'f1': 0.7531166, 'auroc': 0.9390959, 'binary_precision': 0.5410714, 'binary_recall': 0.50332224, 'binary_specificity': 0.9858566, 'binary_f1_score': 0.5215146}
confusion matrix:
       0    1
0  17914  257
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.91489136, 'recall': 0.6703204, 'specificity': 0.6703204, 'f1': 0.73771197, 'auroc': 0.93010896, 'binary_precision': 0.8556701, 'binary_recall': 0.3429752, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4896755}
confusion matrix:
      0   1
0  5983  14
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 00:18:08.957949,epoch time: 0:29:13.284571,used: 0:29:13.284571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9683279, 'precision': 0.8654841, 'recall': 0.55947185, 'specificity': 0.55947185, 'f1': 0.5958017, 'auroc': 0.9635109, 'binary_precision': 0.76150626, 'binary_recall': 0.120290816, 'binary_specificity': 0.9986528, 'binary_f1_score': 0.20776255}
confusion matrix:
       0    1
0  42254   57
1   1331  182
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.89355755, 'recall': 0.540395, 'specificity': 0.540395, 'f1': 0.5663726, 'auroc': 0.95142573, 'binary_precision': 0.81666666, 'binary_recall': 0.08139535, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.14803626}
confusion matrix:
       0   1
0  18160  11
1    553  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.9598923, 'recall': 0.58247787, 'specificity': 0.58247787, 'f1': 0.6324803, 'auroc': 0.93381715, 'binary_precision': 0.95238096, 'binary_recall': 0.16528925, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28169015}
confusion matrix:
      0   1
0  5995   2
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9699568748474121, best validation acc: 0.9703829884529114, corresponding to test acc:                         0.972271203994751 / 0.972271203994751
after epoch: 2,now: 2024-06-01 00:46:19.143884,epoch time: 0:28:10.185935,used: 0:57:23.470506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9757667, 'precision': 0.8414001, 'recall': 0.7570647, 'specificity': 0.7570647, 'f1': 0.7927693, 'auroc': 0.9686701, 'binary_precision': 0.6997343, 'binary_recall': 0.52214146, 'binary_specificity': 0.9919879, 'binary_f1_score': 0.5980318}
confusion matrix:
       0    1
0  41972  339
1    723  790
---- Validation: 
scalar performance:
{'acc': 0.974964, 'precision': 0.85026467, 'recall': 0.67628753, 'specificity': 0.67628753, 'f1': 0.7324762, 'auroc': 0.954672, 'binary_precision': 0.7214765, 'binary_recall': 0.35714287, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.4777778}
confusion matrix:
       0    1
0  18088   83
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.95243204, 'recall': 0.6668551, 'specificity': 0.6668551, 'f1': 0.7393276, 'auroc': 0.94580936, 'binary_precision': 0.9310345, 'binary_recall': 0.33471075, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.49240124}
confusion matrix:
      0   1
0  5991   6
1   161  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 01:14:17.347217,epoch time: 0:27:58.203333,used: 1:25:21.673839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.972207, 'precision': 0.90255576, 'recall': 0.62138736, 'specificity': 0.62138736, 'f1': 0.68186134, 'auroc': 0.9712795, 'binary_precision': 0.83146065, 'binary_recall': 0.24454726, 'binary_specificity': 0.9982274, 'binary_f1_score': 0.37793666}
confusion matrix:
       0    1
0  42236   75
1   1143  370
---- Validation: 
scalar performance:
{'acc': 0.9743781, 'precision': 0.8631526, 'recall': 0.6494843, 'specificity': 0.6494843, 'f1': 0.70883167, 'auroc': 0.96286726, 'binary_precision': 0.74897116, 'binary_recall': 0.30232558, 'binary_specificity': 0.996643, 'binary_f1_score': 0.43076923}
confusion matrix:
       0    1
0  18110   61
1    420  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.91596174, 'recall': 0.62726545, 'specificity': 0.62726545, 'f1': 0.6896423, 'auroc': 0.94190294, 'binary_precision': 0.8611111, 'binary_recall': 0.25619835, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.39490446}
confusion matrix:
      0   1
0  5987  10
1   180  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9743781089782715, best validation acc: 0.9749640226364136, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 4,now: 2024-06-01 01:42:18.020437,epoch time: 0:28:00.673220,used: 1:53:22.347059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757439, 'precision': 0.93645805, 'recall': 0.66751164, 'specificity': 0.66751164, 'f1': 0.73838246, 'auroc': 0.97621316, 'binary_precision': 0.89612675, 'binary_recall': 0.3364177, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.4891879}
confusion matrix:
       0    1
0  42252   59
1   1004  509
---- Validation: 
scalar performance:
{'acc': 0.97427154, 'precision': 0.92467004, 'recall': 0.6148982, 'specificity': 0.6148982, 'f1': 0.67608917, 'auroc': 0.9633878, 'binary_precision': 0.8742138, 'binary_recall': 0.23089701, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.36530876}
confusion matrix:
       0    1
0  18151   20
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.81469584, 'recall': 0.5202443, 'specificity': 0.5202443, 'f1': 0.529214, 'auroc': 0.9455962, 'binary_precision': 0.6666667, 'binary_recall': 0.041322313, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07782101}
confusion matrix:
      0   1
0  5992   5
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9742715358734131, best validation acc: 0.9749640226364136, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 5,now: 2024-06-01 02:10:21.973432,epoch time: 0:28:03.952995,used: 2:21:26.300054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9823156, 'precision': 0.8951994, 'recall': 0.8203628, 'specificity': 0.8203628, 'f1': 0.85354733, 'auroc': 0.9791366, 'binary_precision': 0.8029557, 'binary_recall': 0.6463979, 'binary_specificity': 0.9943277, 'binary_f1_score': 0.71622115}
confusion matrix:
       0    1
0  42071  240
1    535  978
---- Validation: 
scalar performance:
{'acc': 0.9808235, 'precision': 0.8879968, 'recall': 0.77086186, 'specificity': 0.77086186, 'f1': 0.81825495, 'auroc': 0.9703995, 'binary_precision': 0.79086536, 'binary_recall': 0.54651165, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.6463654}
confusion matrix:
       0    1
0  18084   87
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7702621, 'recall': 0.6041864, 'specificity': 0.6041864, 'f1': 0.64672846, 'auroc': 0.9468336, 'binary_precision': 0.5714286, 'binary_recall': 0.21487603, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.31231233}
confusion matrix:
      0   1
0  5958  39
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 6,now: 2024-06-01 02:38:24.057611,epoch time: 0:28:02.084179,used: 2:49:28.384233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9817908, 'precision': 0.92627114, 'recall': 0.77707297, 'specificity': 0.77707297, 'f1': 0.8346869, 'auroc': 0.9809637, 'binary_precision': 0.8681771, 'binary_recall': 0.55717117, 'binary_specificity': 0.99697477, 'binary_f1_score': 0.67874396}
confusion matrix:
       0    1
0  42183  128
1    670  843
---- Validation: 
scalar performance:
{'acc': 0.9814627, 'precision': 0.90440047, 'recall': 0.7663738, 'specificity': 0.7663738, 'f1': 0.82018936, 'auroc': 0.970114, 'binary_precision': 0.8239796, 'binary_recall': 0.53654486, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.6498994}
confusion matrix:
       0    1
0  18102   69
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.93202436, 'recall': 0.57198054, 'specificity': 0.57198054, 'f1': 0.61590546, 'auroc': 0.9409977, 'binary_precision': 0.8974359, 'binary_recall': 0.1446281, 'binary_specificity': 0.999333, 'binary_f1_score': 0.24911033}
confusion matrix:
      0   1
0  5993   4
1   207  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 7,now: 2024-06-01 03:06:30.356629,epoch time: 0:28:06.299018,used: 3:17:34.683251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98256665, 'precision': 0.9008525, 'recall': 0.8179436, 'specificity': 0.8179436, 'f1': 0.8542307, 'auroc': 0.9823921, 'binary_precision': 0.8144416, 'binary_recall': 0.64111036, 'binary_specificity': 0.9947768, 'binary_f1_score': 0.71745557}
confusion matrix:
       0    1
0  42090  221
1    543  970
---- Validation: 
scalar performance:
{'acc': 0.97837317, 'precision': 0.83135056, 'recall': 0.80894554, 'specificity': 0.80894554, 'f1': 0.8197218, 'auroc': 0.9679314, 'binary_precision': 0.675, 'binary_recall': 0.627907, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.6506024}
confusion matrix:
       0    1
0  17989  182
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.75513244, 'recall': 0.5479193, 'specificity': 0.5479193, 'f1': 0.57415557, 'auroc': 0.931632, 'binary_precision': 0.54545456, 'binary_recall': 0.09917355, 'binary_specificity': 0.996665, 'binary_f1_score': 0.16783218}
confusion matrix:
      0   1
0  5977  20
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9783731698989868, best validation acc: 0.9814627170562744, corresponding to test acc:                         0.9661805033683777 / 0.9732328653335571
after epoch: 8,now: 2024-06-01 03:34:28.732696,epoch time: 0:27:58.376067,used: 3:45:33.059318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9818821, 'precision': 0.92022645, 'recall': 0.7841306, 'specificity': 0.7841306, 'f1': 0.8380462, 'auroc': 0.98398143, 'binary_precision': 0.85558856, 'binary_recall': 0.57171184, 'binary_specificity': 0.99654937, 'binary_f1_score': 0.68542}
confusion matrix:
       0    1
0  42165  146
1    648  865
---- Validation: 
scalar performance:
{'acc': 0.9805572, 'precision': 0.92251873, 'recall': 0.732981, 'specificity': 0.732981, 'f1': 0.7985682, 'auroc': 0.97477317, 'binary_precision': 0.86238533, 'binary_recall': 0.46843854, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.6071044}
confusion matrix:
       0    1
0  18126   45
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6953299, 'recall': 0.5117297, 'specificity': 0.5117297, 'f1': 0.5134555, 'auroc': 0.9381819, 'binary_precision': 0.42857143, 'binary_recall': 0.024793388, 'binary_specificity': 0.998666, 'binary_f1_score': 0.046875}
confusion matrix:
      0  1
0  5989  8
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9805572032928467, best validation acc: 0.9814627170562744, corresponding to test acc:                         0.9661805033683777 / 0.9732328653335571
after epoch: 9,now: 2024-06-01 04:02:40.664372,epoch time: 0:28:11.931676,used: 4:13:44.990994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98274916, 'precision': 0.92564046, 'recall': 0.7944579, 'specificity': 0.7944579, 'f1': 0.8472065, 'auroc': 0.9827696, 'binary_precision': 0.8657005, 'binary_recall': 0.59220093, 'binary_specificity': 0.99671483, 'binary_f1_score': 0.70329666}
confusion matrix:
       0    1
0  42172  139
1    617  896
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.9298866, 'recall': 0.7760879, 'specificity': 0.7760879, 'f1': 0.8351095, 'auroc': 0.9742662, 'binary_precision': 0.87434554, 'binary_recall': 0.55481726, 'binary_specificity': 0.99735844, 'binary_f1_score': 0.6788618}
confusion matrix:
       0    1
0  18123   48
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8674731, 'recall': 0.5938741, 'specificity': 0.5938741, 'f1': 0.64369434, 'auroc': 0.9489283, 'binary_precision': 0.76666665, 'binary_recall': 0.19008264, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.30463573}
confusion matrix:
      0   1
0  5983  14
1   196  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 10,now: 2024-06-01 04:30:38.688367,epoch time: 0:27:58.023995,used: 4:41:43.014989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9859438, 'precision': 0.9318774, 'recall': 0.84422874, 'specificity': 0.84422874, 'f1': 0.8827207, 'auroc': 0.985708, 'binary_precision': 0.8746867, 'binary_recall': 0.69200265, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.77269375}
confusion matrix:
       0     1
0  42161   150
1    466  1047
---- Validation: 
scalar performance:
{'acc': 0.9830075, 'precision': 0.9283554, 'recall': 0.77439916, 'specificity': 0.77439916, 'f1': 0.83337927, 'auroc': 0.97600615, 'binary_precision': 0.87139106, 'binary_recall': 0.551495, 'binary_specificity': 0.99730337, 'binary_f1_score': 0.67548317}
confusion matrix:
       0    1
0  18122   49
1    270  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.84463114, 'recall': 0.5894917, 'specificity': 0.5894917, 'f1': 0.63638496, 'auroc': 0.9368913, 'binary_precision': 0.72131145, 'binary_recall': 0.18181819, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29042903}
confusion matrix:
      0   1
0  5980  17
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9830074906349182, best validation acc: 0.983167290687561, corresponding to test acc:                         0.9663407802581787 / 0.9732328653335571
after epoch: 11,now: 2024-06-01 04:58:22.044842,epoch time: 0:27:43.356475,used: 5:09:26.371464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98133445, 'precision': 0.9703875, 'recall': 0.73955435, 'specificity': 0.73955435, 'f1': 0.8150333, 'auroc': 0.98701143, 'binary_precision': 0.95904887, 'binary_recall': 0.47984138, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.6396476}
confusion matrix:
       0    1
0  42280   31
1    787  726
---- Validation: 
scalar performance:
{'acc': 0.97959834, 'precision': 0.9617009, 'recall': 0.69313633, 'specificity': 0.69313633, 'f1': 0.7692221, 'auroc': 0.9764069, 'binary_precision': 0.94331986, 'binary_recall': 0.38704318, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.548881}
confusion matrix:
       0    1
0  18157   14
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9312972, 'recall': 0.51851165, 'specificity': 0.51851165, 'f1': 0.5261445, 'auroc': 0.9315534, 'binary_precision': 0.9, 'binary_recall': 0.037190083, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.071428575}
confusion matrix:
      0  1
0  5996  1
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.979598343372345, best validation acc: 0.983167290687561, corresponding to test acc:                         0.9663407802581787 / 0.9732328653335571
after epoch: 12,now: 2024-06-01 05:26:09.696016,epoch time: 0:27:47.651174,used: 5:37:14.022638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9848485, 'precision': 0.8768997, 'recall': 0.9051614, 'specificity': 0.9051614, 'f1': 0.8904732, 'auroc': 0.98719406, 'binary_precision': 0.76026976, 'binary_recall': 0.8195638, 'binary_specificity': 0.9907589, 'binary_f1_score': 0.78880405}
confusion matrix:
       0     1
0  41920   391
1    273  1240
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.8750429, 'recall': 0.8599626, 'specificity': 0.8599626, 'f1': 0.86733544, 'auroc': 0.97392166, 'binary_precision': 0.75909877, 'binary_recall': 0.72757477, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.74300253}
confusion matrix:
       0    1
0  18032  139
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.8479228, 'recall': 0.5976728, 'specificity': 0.5976728, 'f1': 0.64713424, 'auroc': 0.9409004, 'binary_precision': 0.72727275, 'binary_recall': 0.1983471, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5979  18
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 13,now: 2024-06-01 05:53:57.238008,epoch time: 0:27:47.541992,used: 6:05:01.564630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847116, 'precision': 0.9492362, 'recall': 0.80726427, 'specificity': 0.80726427, 'f1': 0.8639662, 'auroc': 0.9878862, 'binary_precision': 0.9120235, 'binary_recall': 0.61665565, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.73580444}
confusion matrix:
       0    1
0  42221   90
1    580  933
---- Validation: 
scalar performance:
{'acc': 0.9812497, 'precision': 0.9367231, 'recall': 0.73574793, 'specificity': 0.73574793, 'f1': 0.8043051, 'auroc': 0.9712796, 'binary_precision': 0.890625, 'binary_recall': 0.47342193, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.6182213}
confusion matrix:
       0    1
0  18136   35
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8777007, 'recall': 0.61238575, 'specificity': 0.61238575, 'f1': 0.6679802, 'auroc': 0.9415052, 'binary_precision': 0.78571427, 'binary_recall': 0.22727273, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3525641}
confusion matrix:
      0   1
0  5982  15
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9812496900558472, best validation acc: 0.9838597774505615, corresponding to test acc:                         0.9660201668739319 / 0.9732328653335571
after epoch: 14,now: 2024-06-01 06:21:52.033113,epoch time: 0:27:54.795105,used: 6:32:56.359735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98706186, 'precision': 0.9481489, 'recall': 0.8470384, 'specificity': 0.8470384, 'f1': 0.89068234, 'auroc': 0.9884821, 'binary_precision': 0.9070568, 'binary_recall': 0.6966292, 'binary_specificity': 0.9974475, 'binary_f1_score': 0.7880374}
confusion matrix:
       0     1
0  42203   108
1    459  1054
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.91956514, 'recall': 0.81213737, 'specificity': 0.81213737, 'f1': 0.8574041, 'auroc': 0.9745371, 'binary_precision': 0.8513514, 'binary_recall': 0.627907, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.7227534}
confusion matrix:
       0    1
0  18105   66
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8609873, 'recall': 0.5693308, 'specificity': 0.5693308, 'f1': 0.60948485, 'auroc': 0.93784714, 'binary_precision': 0.75555557, 'binary_recall': 0.14049587, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.23693381}
confusion matrix:
      0   1
0  5986  11
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 15,now: 2024-06-01 06:50:04.431075,epoch time: 0:28:12.397962,used: 7:01:08.757697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9871532, 'precision': 0.939342, 'recall': 0.85728246, 'specificity': 0.85728246, 'f1': 0.8937598, 'auroc': 0.99048305, 'binary_precision': 0.88870704, 'binary_recall': 0.7177792, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.7941499}
confusion matrix:
       0     1
0  42175   136
1    427  1086
---- Validation: 
scalar performance:
{'acc': 0.98460555, 'precision': 0.9277682, 'recall': 0.8049375, 'specificity': 0.8049375, 'f1': 0.85534203, 'auroc': 0.97502136, 'binary_precision': 0.8682353, 'binary_recall': 0.6129568, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.7185978}
confusion matrix:
       0    1
0  18115   56
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8503708, 'recall': 0.6160177, 'specificity': 0.6160177, 'f1': 0.6696532, 'auroc': 0.9394108, 'binary_precision': 0.7307692, 'binary_recall': 0.23553719, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.35625002}
confusion matrix:
      0   1
0  5976  21
1   185  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 16,now: 2024-06-01 07:18:15.144575,epoch time: 0:28:10.713500,used: 7:29:19.471197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9800566, 'precision': 0.8243215, 'recall': 0.9441045, 'specificity': 0.9441045, 'f1': 0.8738811, 'auroc': 0.98950076, 'binary_precision': 0.65207046, 'binary_recall': 0.9054858, 'binary_specificity': 0.9827232, 'binary_f1_score': 0.75816274}
confusion matrix:
       0     1
0  41580   731
1    143  1370
---- Validation: 
scalar performance:
{'acc': 0.9798647, 'precision': 0.82288504, 'recall': 0.89082384, 'specificity': 0.89082384, 'f1': 0.8533133, 'auroc': 0.9741108, 'binary_precision': 0.65258855, 'binary_recall': 0.79568106, 'binary_specificity': 0.9859666, 'binary_f1_score': 0.7170659}
confusion matrix:
       0    1
0  17916  255
1    123  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.7815554, 'recall': 0.69672644, 'specificity': 0.69672644, 'f1': 0.73078454, 'auroc': 0.9455265, 'binary_precision': 0.5868263, 'binary_recall': 0.40495867, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.4792176}
confusion matrix:
      0   1
0  5928  69
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9798647165298462, best validation acc: 0.9846055507659912, corresponding to test acc:                         0.9669818878173828 / 0.9732328653335571
after epoch: 17,now: 2024-06-01 07:46:36.769395,epoch time: 0:28:21.624820,used: 7:57:41.096017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9859894, 'precision': 0.9666482, 'recall': 0.8142991, 'specificity': 0.8142991, 'f1': 0.8745682, 'auroc': 0.99131143, 'binary_precision': 0.94637537, 'binary_recall': 0.6298744, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.7563492}
confusion matrix:
       0    1
0  42257   54
1    560  953
---- Validation: 
scalar performance:
{'acc': 0.982102, 'precision': 0.9560126, 'recall': 0.7385973, 'specificity': 0.7385973, 'f1': 0.8112036, 'auroc': 0.9680567, 'binary_precision': 0.92903227, 'binary_recall': 0.47840533, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.631579}
confusion matrix:
       0    1
0  18149   22
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9343771, 'recall': 0.5576011, 'specificity': 0.5576011, 'f1': 0.5936743, 'auroc': 0.92602885, 'binary_precision': 0.9032258, 'binary_recall': 0.11570248, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.20512821}
confusion matrix:
      0   1
0  5994   3
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9821019768714905, best validation acc: 0.9846055507659912, corresponding to test acc:                         0.9669818878173828 / 0.9732328653335571
after epoch: 18,now: 2024-06-01 08:14:51.778068,epoch time: 0:28:15.008673,used: 8:25:56.104690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98713034, 'precision': 0.93597233, 'recall': 0.8604572, 'specificity': 0.8604572, 'f1': 0.89435595, 'auroc': 0.99168396, 'binary_precision': 0.8817377, 'binary_recall': 0.72438866, 'binary_specificity': 0.9965257, 'binary_f1_score': 0.7953556}
confusion matrix:
       0     1
0  42164   147
1    417  1096
---- Validation: 
scalar performance:
{'acc': 0.98428595, 'precision': 0.93012273, 'recall': 0.79674196, 'specificity': 0.79674196, 'f1': 0.8503555, 'auroc': 0.97269464, 'binary_precision': 0.8734793, 'binary_recall': 0.59634554, 'binary_specificity': 0.9971383, 'binary_f1_score': 0.70878583}
confusion matrix:
       0    1
0  18119   52
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7953783, 'recall': 0.56048274, 'specificity': 0.56048274, 'f1': 0.59401274, 'auroc': 0.8861412, 'binary_precision': 0.625, 'binary_recall': 0.12396694, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20689656}
confusion matrix:
      0   1
0  5979  18
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9842859506607056, best validation acc: 0.9846055507659912, corresponding to test acc:                         0.9669818878173828 / 0.9732328653335571
after epoch: 19,now: 2024-06-01 08:42:49.206637,epoch time: 0:27:57.428569,used: 8:53:53.533259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98571557, 'precision': 0.96024585, 'recall': 0.8147946, 'specificity': 0.8147946, 'f1': 0.8728998, 'auroc': 0.9900682, 'binary_precision': 0.93352884, 'binary_recall': 0.6311963, 'binary_specificity': 0.9983929, 'binary_f1_score': 0.7531546}
confusion matrix:
       0    1
0  42243   68
1    558  955
---- Validation: 
scalar performance:
{'acc': 0.9830608, 'precision': 0.95339066, 'recall': 0.75675964, 'specificity': 0.75675964, 'f1': 0.8261471, 'auroc': 0.9729091, 'binary_precision': 0.92261904, 'binary_recall': 0.51495016, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.6609808}
confusion matrix:
       0    1
0  18145   26
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.83711964, 'recall': 0.5447042, 'specificity': 0.5447042, 'f1': 0.5712047, 'auroc': 0.9205582, 'binary_precision': 0.7096774, 'binary_recall': 0.09090909, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16117217}
confusion matrix:
      0   1
0  5988   9
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 4
val acc:0.9830607771873474, best validation acc: 0.9846055507659912, corresponding to test acc:                         0.9669818878173828 / 0.9732328653335571
after epoch: 20,now: 2024-06-01 09:10:46.193587,epoch time: 0:27:56.986950,used: 9:21:50.520209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9906444, 'precision': 0.94620454, 'recall': 0.9091189, 'specificity': 0.9091189, 'f1': 0.92679393, 'auroc': 0.99310863, 'binary_precision': 0.8987708, 'binary_recall': 0.8215466, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.85842544}
confusion matrix:
       0     1
0  42171   140
1    270  1243
---- Validation: 
scalar performance:
{'acc': 0.98476535, 'precision': 0.90391225, 'recall': 0.83473283, 'specificity': 0.83473283, 'f1': 0.8658398, 'auroc': 0.97559595, 'binary_precision': 0.8185484, 'binary_recall': 0.6744186, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.7395264}
confusion matrix:
       0    1
0  18081   90
1    196  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7479588, 'recall': 0.59558845, 'specificity': 0.59558845, 'f1': 0.634387, 'auroc': 0.9328125, 'binary_precision': 0.52747256, 'binary_recall': 0.1983471, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.2882883}
confusion matrix:
      0   1
0  5954  43
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 21,now: 2024-06-01 09:38:43.066281,epoch time: 0:27:56.872694,used: 9:49:47.392903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9887961, 'precision': 0.90692073, 'recall': 0.9304673, 'specificity': 0.9304673, 'f1': 0.9183341, 'auroc': 0.9931184, 'binary_precision': 0.81857854, 'binary_recall': 0.8678123, 'binary_specificity': 0.99312234, 'binary_f1_score': 0.8424767}
confusion matrix:
       0     1
0  42020   291
1    200  1313
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.87976027, 'recall': 0.86754775, 'specificity': 0.86754775, 'f1': 0.8735461, 'auroc': 0.97484916, 'binary_precision': 0.76804125, 'binary_recall': 0.7425249, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.7550676}
confusion matrix:
       0    1
0  18036  135
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8020868, 'recall': 0.655339, 'specificity': 0.655339, 'f1': 0.7028708, 'auroc': 0.95144165, 'binary_precision': 0.63114756, 'binary_recall': 0.3181818, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.42307693}
confusion matrix:
      0   1
0  5952  45
1   165  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.984552264213562, best validation acc: 0.984765350818634, corresponding to test acc:                         0.9620131254196167 / 0.9732328653335571
after epoch: 22,now: 2024-06-01 10:06:52.983893,epoch time: 0:28:09.917612,used: 10:17:57.310515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98790616, 'precision': 0.9391093, 'recall': 0.87041855, 'specificity': 0.87041855, 'f1': 0.90162224, 'auroc': 0.9919964, 'binary_precision': 0.8873128, 'binary_recall': 0.7442168, 'binary_specificity': 0.99662024, 'binary_f1_score': 0.8094896}
confusion matrix:
       0     1
0  42168   143
1    387  1126
---- Validation: 
scalar performance:
{'acc': 0.98263466, 'precision': 0.8936111, 'recall': 0.8031163, 'specificity': 0.8031163, 'f1': 0.8420483, 'auroc': 0.9747168, 'binary_precision': 0.8, 'binary_recall': 0.6112957, 'binary_specificity': 0.994937, 'binary_f1_score': 0.693032}
confusion matrix:
       0    1
0  18079   92
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7515033, 'recall': 0.5737783, 'specificity': 0.5737783, 'f1': 0.6092316, 'auroc': 0.92630285, 'binary_precision': 0.5362319, 'binary_recall': 0.15289256, 'binary_specificity': 0.994664, 'binary_f1_score': 0.2379421}
confusion matrix:
      0   1
0  5965  32
1   205  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.9826346635818481, best validation acc: 0.984765350818634, corresponding to test acc:                         0.9620131254196167 / 0.9732328653335571
after epoch: 23,now: 2024-06-01 10:34:55.257951,epoch time: 0:28:02.274058,used: 10:45:59.584573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98934376, 'precision': 0.9391732, 'recall': 0.8950619, 'specificity': 0.8950619, 'f1': 0.91585857, 'auroc': 0.9921625, 'binary_precision': 0.8856932, 'binary_recall': 0.7937872, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.83722556}
confusion matrix:
       0     1
0  42156   155
1    312  1201
---- Validation: 
scalar performance:
{'acc': 0.9837, 'precision': 0.8918551, 'recall': 0.8285612, 'specificity': 0.8285612, 'f1': 0.8572146, 'auroc': 0.97437936, 'binary_precision': 0.7948207, 'binary_recall': 0.6627907, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.7228261}
confusion matrix:
       0    1
0  18068  103
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7853141, 'recall': 0.5884912, 'specificity': 0.5884912, 'f1': 0.63035095, 'auroc': 0.919755, 'binary_precision': 0.60273975, 'binary_recall': 0.18181819, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.2793651}
confusion matrix:
      0   1
0  5968  29
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 3
val acc:0.9836999773979187, best validation acc: 0.984765350818634, corresponding to test acc:                         0.9620131254196167 / 0.9732328653335571
after epoch: 24,now: 2024-06-01 11:02:58.019210,epoch time: 0:28:02.761259,used: 11:14:02.345832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98751825, 'precision': 0.900372, 'recall': 0.9164222, 'specificity': 0.9164222, 'f1': 0.90822566, 'auroc': 0.9932195, 'binary_precision': 0.80647206, 'binary_recall': 0.8400529, 'binary_specificity': 0.9927915, 'binary_f1_score': 0.8229201}
confusion matrix:
       0     1
0  42006   305
1    242  1271
---- Validation: 
scalar performance:
{'acc': 0.9833804, 'precision': 0.861166, 'recall': 0.87738204, 'specificity': 0.87738204, 'f1': 0.8690808, 'auroc': 0.9764415, 'binary_precision': 0.73015875, 'binary_recall': 0.7641196, 'binary_specificity': 0.99064445, 'binary_f1_score': 0.7467532}
confusion matrix:
       0    1
0  18001  170
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.76873225, 'recall': 0.5641147, 'specificity': 0.5641147, 'f1': 0.5977766, 'auroc': 0.91055137, 'binary_precision': 0.5714286, 'binary_recall': 0.1322314, 'binary_specificity': 0.995998, 'binary_f1_score': 0.21476509}
confusion matrix:
      0   1
0  5973  24
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 4
val acc:0.9833803772926331, best validation acc: 0.984765350818634, corresponding to test acc:                         0.9620131254196167 / 0.9732328653335571
after epoch: 25,now: 2024-06-01 11:31:01.984828,epoch time: 0:28:03.965618,used: 11:42:06.311450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.990188, 'precision': 0.91531366, 'recall': 0.9432969, 'specificity': 0.9432969, 'f1': 0.9288099, 'auroc': 0.995141, 'binary_precision': 0.83446574, 'binary_recall': 0.89292794, 'binary_specificity': 0.99366593, 'binary_f1_score': 0.86270756}
confusion matrix:
       0     1
0  42043   268
1    162  1351
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.8810208, 'recall': 0.89141405, 'specificity': 0.89141405, 'f1': 0.88614166, 'auroc': 0.973387, 'binary_precision': 0.76898223, 'binary_recall': 0.7906977, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.7796887}
confusion matrix:
       0    1
0  18028  143
1    126  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7417095, 'recall': 0.6112836, 'specificity': 0.6112836, 'f1': 0.6496901, 'auroc': 0.8877442, 'binary_precision': 0.51376146, 'binary_recall': 0.23140496, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.3190883}
confusion matrix:
      0   1
0  5944  53
1   186  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 26,now: 2024-06-01 11:59:06.255940,epoch time: 0:28:04.271112,used: 12:10:10.582562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98984575, 'precision': 0.9652187, 'recall': 0.8765214, 'specificity': 0.8765214, 'f1': 0.91584814, 'auroc': 0.994949, 'binary_precision': 0.93914473, 'binary_recall': 0.7547918, 'binary_specificity': 0.998251, 'binary_f1_score': 0.83693653}
confusion matrix:
       0     1
0  42237    74
1    371  1142
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.91828, 'recall': 0.81869936, 'specificity': 0.81869936, 'f1': 0.8612792, 'auroc': 0.97261035, 'binary_precision': 0.84835166, 'binary_recall': 0.641196, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.7303689}
confusion matrix:
       0    1
0  18102   69
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73201907, 'recall': 0.5376721, 'specificity': 0.5376721, 'f1': 0.5579375, 'auroc': 0.8963311, 'binary_precision': 0.5, 'binary_recall': 0.0785124, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.13571428}
confusion matrix:
      0   1
0  5978  19
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9848186373710632, best validation acc: 0.9856709241867065, corresponding to test acc:                         0.9616925716400146 / 0.9732328653335571
after epoch: 27,now: 2024-06-01 12:27:09.019868,epoch time: 0:28:02.763928,used: 12:38:13.346490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9921504, 'precision': 0.95534325, 'recall': 0.9239195, 'specificity': 0.9239195, 'f1': 0.9390255, 'auroc': 0.99524736, 'binary_precision': 0.91601425, 'binary_recall': 0.8506279, 'binary_specificity': 0.9972111, 'binary_f1_score': 0.8821111}
confusion matrix:
       0     1
0  42193   118
1    226  1287
---- Validation: 
scalar performance:
{'acc': 0.9867895, 'precision': 0.9235853, 'recall': 0.85103637, 'specificity': 0.85103637, 'f1': 0.8836653, 'auroc': 0.97610277, 'binary_precision': 0.85685486, 'binary_recall': 0.70598006, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.7741348}
confusion matrix:
       0    1
0  18100   71
1    177  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.82848716, 'recall': 0.58114386, 'specificity': 0.58114386, 'f1': 0.62430066, 'auroc': 0.9152939, 'binary_precision': 0.6896552, 'binary_recall': 0.16528925, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.26666665}
confusion matrix:
      0   1
0  5979  18
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
better model found
persisted
after epoch: 28,now: 2024-06-01 12:55:20.398016,epoch time: 0:28:11.378148,used: 13:06:24.724638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99023366, 'precision': 0.9057934, 'recall': 0.9608464, 'specificity': 0.9608464, 'f1': 0.9314153, 'auroc': 0.9958722, 'binary_precision': 0.8141285, 'binary_recall': 0.92927957, 'binary_specificity': 0.99241334, 'binary_f1_score': 0.8679012}
confusion matrix:
       0     1
0  41990   321
1    107  1406
---- Validation: 
scalar performance:
{'acc': 0.9850317, 'precision': 0.8690274, 'recall': 0.9015234, 'specificity': 0.9015234, 'f1': 0.8845316, 'auroc': 0.97663987, 'binary_precision': 0.74429226, 'binary_recall': 0.81229234, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.776807}
confusion matrix:
       0    1
0  18003  168
1    113  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.74536914, 'recall': 0.6332605, 'specificity': 0.6332605, 'f1': 0.6708052, 'auroc': 0.9040069, 'binary_precision': 0.51937985, 'binary_recall': 0.2768595, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.36118594}
confusion matrix:
      0   1
0  5935  62
1   175  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 1
val acc:0.9850317239761353, best validation acc: 0.9867895245552063, corresponding to test acc:                         0.9647379517555237 / 0.9732328653335571
after epoch: 29,now: 2024-06-01 13:23:23.781018,epoch time: 0:28:03.383002,used: 13:34:28.107640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99082696, 'precision': 0.9275856, 'recall': 0.93629885, 'specificity': 0.93629885, 'f1': 0.9318946, 'auroc': 0.9956153, 'binary_precision': 0.8595469, 'binary_recall': 0.8777264, 'binary_specificity': 0.9948713, 'binary_f1_score': 0.86854154}
confusion matrix:
       0     1
0  42094   217
1    185  1328
---- Validation: 
scalar performance:
{'acc': 0.98572415, 'precision': 0.89690506, 'recall': 0.8649409, 'specificity': 0.8649409, 'f1': 0.8802, 'auroc': 0.9757679, 'binary_precision': 0.80253625, 'binary_recall': 0.7358804, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.76776433}
confusion matrix:
       0    1
0  18062  109
1    159  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.728071, 'recall': 0.55345064, 'specificity': 0.55345064, 'f1': 0.5809345, 'auroc': 0.89507496, 'binary_precision': 0.4909091, 'binary_recall': 0.11157025, 'binary_specificity': 0.995331, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5969  28
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993757.png
early stop counter: 2
val acc:0.985724151134491, best validation acc: 0.9867895245552063, corresponding to test acc:                         0.9647379517555237 / 0.9732328653335571
after epoch: 30,now: 2024-06-01 13:51:10.585301,epoch time: 0:27:46.804283,used: 14:02:14.911923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_23_48_55_seed_2_20993757
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:02:14.911923 at 2024-06-01 13:51:10.585301
persisted model performance metric: 

scalar performance:
{'acc': 0.96473795, 'precision': 0.83536035, 'recall': 0.57717836, 'specificity': 0.57717836, 'f1': 0.61934865, 'auroc': 0.91856015, 'binary_precision': 0.7037037, 'binary_recall': 0.1570248, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25675678}
confusion matrix:
      0   1
0  5981  16
1   204  38
oracle model performance metric: 

scalar performance:
{'acc': 0.97371376, 'precision': 0.9586662, 'recall': 0.6710707, 'specificity': 0.6710707, 'f1': 0.74476504, 'auroc': 0.9415034, 'binary_precision': 0.9431818, 'binary_recall': 0.3429752, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5030303}
confusion matrix:
      0   1
0  5992   5
1   159  83
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41644 MiB |  27166 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446683 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |  11566 KiB |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  592985 K  |  592982 K  |
|       from large pool |     187    |    1413    |  308145 K  |  308145 K  |
|       from small pool |    3289    |    6298    |  284840 K  |  284837 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  592985 K  |  592982 K  |
|       from large pool |     187    |    1413    |  308145 K  |  308145 K  |
|       from small pool |    3289    |    6298    |  284840 K  |  284837 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      79    |    2807    |  388584 K  |  388584 K  |
|       from large pool |      38    |     605    |  240391 K  |  240391 K  |
|       from small pool |      41    |    2769    |  148193 K  |  148193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41644 MiB |  40762 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |      0 KiB |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  592985 K  |  592985 K  |
|       from large pool |       2    |    1413    |  308145 K  |  308145 K  |
|       from small pool |       0    |    6298    |  284840 K  |  284840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  592985 K  |  592985 K  |
|       from large pool |       2    |    1413    |  308145 K  |  308145 K  |
|       from small pool |       0    |    6298    |  284840 K  |  284840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1781    |    1718    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2807    |  388585 K  |  388585 K  |
|       from large pool |       4    |     605    |  240391 K  |  240391 K  |
|       from small pool |       0    |    2769    |  148194 K  |  148194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  1 13:53:50 2024]
Finished job 0.
1 of 1 steps (100%) done
